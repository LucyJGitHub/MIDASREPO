     H        1                                                           S01486
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Bank Investment Policy List')                 *
     H***********                                                         S01486
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management Module                      *
     F*                                                               *
     F*  PM0300  - PM BANK INVESTMENT POLICY LIST                     *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01486             Date 30Aug94               *
      *                 47153              Date 16Nov92               *
     F*                 R00824             DATE 12DEC90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CRE026 - Consumer Banking                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines (Recompile)                            *
     F*  S01486 - Portfolio Management Upgrade to R10                 *
     F*  47153  - 'END OF REPORT' TRAILER MISSING                     *
     F*  R00824 - IF MINIMUM RANGE 100% OUTPUT BLANK MAXIMUM RANGE    *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F**PMBIPNPPIF**E                    DISK                             S01486
     FPMBIPNPDIF  E                    DISK                               S01486
     F** FILE PREFIX 'PS'
     F                                              KINFSR *PSSR
     FPMBIPNLCIF  E           K        DISK
     F** FILE PREFIX 'PS'
     F            PMBIPNP0                          KRENAMEPMBIPNL0
     F                                              KINFSR *PSSR
     FPMBIIPLLIF  E           K        DISK
     F** FILE PREFIX 'PT'
     F                                              KINFSR *PSSR
     F**PMPGHIPPIF**E           K        DISK                             S01486
     FPMPGHIPDIF  E           K        DISK                               S01486
     F** FILE PREFIX 'PF'
     F                                              KINFSR *PSSR
     F**SDPLINPDIF**E           K        DISK                             S01486
     F***FILE*PREFIX 'PD'                                                 S01486
     F**********                                    KINFSR *PSSR          S01486
     FPMBCIPLLIF  E           K        DISK
     F** FILE PREFIX 'PU'
     F                                              KINFSR *PSSR
     F**PMPGHCPPIF  E           K        DISK                             S01486
     FPMPGHCPDIF  E           K        DISK                               S01486
     F** FILE PREFIX 'PH'
     F                                              KINFSR *PSSR
     F**SDCURRL0IF**E           K        DISK                             S01486
     F***FILE PREFIX 'A6'                                                 S01486
     F**********                                    KINFSR *PSSR          S01486
     FPMBRIPLLIF  E           K        DISK
     F** FILE PREFIX 'PX'
     F                                              KINFSR *PSSR
     F**PMPGHRPPIF**E           K        DISK                             S01486
     FPMPGHRPDIF  E           K        DISK                               S01486
     F** FILE PREFIX 'PJ'
     F                                              KINFSR *PSSR
     F**SDCTRYL1IF**E           K        DISK                             S01486
     F***FILE*PREFIX 'A4'                                                 S01486
     F**********                                    KINFSR *PSSR          S01486
     FPMBDIPLLIF  E           K        DISK
     F** FILE PREFIX 'PW'
     F                                              KINFSR *PSSR
     F**PMPGHDPPIF**E           K        DISK                             S01486
     FPMPGHDPDIF  E           K        DISK                               S01486
     F** FILE PREFIX 'PL'
     F                                              KINFSR *PSSR
     F**SDINDSL1IF**E           K        DISK                             S01486
     F***FILE PREFIX 'AO'                                                 S01486
     F**********                                    KINFSR *PSSR          S01486
     F**PMBIPNZZIF**E           K        DISK                             S01486
     FPMBIPNPAIF  E           K        DISK                               S01486
     F** FILE PREFIX 'PS'
     F                                              KINFSR *PSSR
     F**SDBANKL1IF**E           K        DISK                             S01486
     F***FILE*PREFIX 'BJ'                                                 S01486
     F**********                                    KINFSR *PSSR          S01486
     F***PM0300P1O***E             70     PRINTER                         S01486
     F***PM0300AUO***E                    PRINTER                         S01486
     FPM0300P1O   E             70     PRINTER      KINFDS SPOOL      UC  S01486
     FPM0300AUO   E                    PRINTER      KINFDS SPOOLU         S01486
     E                    CPY@    1   1 80
      /EJECT
      *
      *   INDICATOR USAGE
      *   ---------------
      *
      *   21      LAST CHANGE TYPE IS 'INSERT'
      *   22      LAST CHANGE TYPE IS 'AMEND '
      *   23      LAST CHANGE TYPE IS 'DELETE'
      *   24      'GROUPS' FROM INSTRUMENT POLICY PRINT
      *   25      'INSTRUMENTS' FROM INSTRUMENT POLICY PRINT
      *   26      'GROUPS' FROM CURRENCY POLICY PRINT
      *   27      'CURRENCIES' FROM CURRENCY POLICY PRINT
      *   28      'GROUPS' FROM COUNTRY POLICY PRINT
      *   29      'COUNTRIES' FROM COUNTRY POLICY PRINT
      *   30      'GROUPS' FROM INDUSTRY POLICY PRINT
      *   31      'INDUSTRIES' FROM INDUSTRY POLICY PRINT
      *   32      AUDIT/LIST MODE INDICATOR FOR AUDIT HEADER
      *   40      PRINT 'INSTRUMENT POLICY'
      *   41      PRINT 'CURRENCY POLICY'
      *   42      PRINT 'COUNTRY POLICY'
      *   43      PRINT 'INDUSTRY POLICY'
      *   44      MAX AND MIN RANGES ARE BOTH ZERO, SO ONLY OUTPUT MAX
      *   70      OVERFLOW ON PRINTER FILE PM0300P1
      ****71      ACCESS ON SDBANKL1                                      S01486
      *   72      ACCESS ON PMBIIPLL
      ****73      ACCESS ON PMPGHIPP                                      S01486
      *   73      ACCESS ON PMPGHIPD                                      S01486
      ****74      ACCESS ON SDPLINPD                                      S01486
      *   75      ACCESS ON PMBCIPLL
      ****76      ACCESS ON PMPGHCPP                                      S01486
      *   76      ACCESS ON PMPGHCPD                                      S01486
      ****77      ACCESS ON SDCURRL0                                      S01486
      *   78      ACCESS ON PMBRIPLL
      ****79      ACCESS ON PMPGHRPP                                      S01486
      *   79      ACCESS ON PMPGHRPD                                      S01486
      ****80      ACCESS ON SDCTRYL1                                      S01486
      *   81      ACCESS ON PMBDIPLL
      ****82      ACCESS ON PMPGHDPP                                      S01486
      ****83      ACCESS ON SDINDSL1                                      S01486
      ****84      ACCESS ON PMBIPNZZ                                      S01486
      ****89      END OF FILE PMBIPNLC OR PMBIPNPP                        S01486
      *   82      ACCESS ON PMPGHDPD                                      S01486
      *   84      ACCESS ON PMBIPNPA                                      S01486
      *   89      END OF FILE PMBIPNLC OR PMBIPNPD                        S01486
      *
      /EJECT
      *
      ** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
      *
     I**LDA        UDS                            256                     S01486
     I***********                           132 183 DBLOT                 S01486
     I***********                           132 141 DBFILE                S01486
     ILDA        UDS                            256                       S01486
     I                                      134 183 DBLOT                 S01486
     I                                      134 141 DBFILE                S01486
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     ISDBANK    E DSSDBANKPD                                              S01486
     I** EXTERNAL DS FOR BANK DETAILS                                     S01486
     ISDINDS    E DSSDINDSPD                                              S01486
     I** EXTERNAL DS FOR INDUSTRY DETAILS                                 S01486
     ISDPLIN    E DSSDPLINPD                                              S01486
     I** EXTERNAL DS FOR INSTRUMENT DETAILS                               S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01486
     ISDCTRY    E DSSDCTRYPD                                              S01486
     I** EXTERNAL DS FOR COUNTRY DETAILS                                  S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, LONG  DATA STRUCTURE                S01486
     ISPOOL       DS                                                      S01486
     I                                       83  92 SFILE                 S01486
     I                                    B 123 1240SFNUM                 S01486
     ISPOOLU      DS                                                      S01486
     I                                       83  92 SFILEU                S01486
     I                                    B 123 1240SFNUMU                S01486
     I**                                                                  S01486
     ICPYR@#      DS                                                      S01486
     I                                        1  80 CPY@                  S01486
     I                                        1  20 CPY@##                S01486
     C**                                                                  S01486
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * INDEX OF SUBROUTINES                                                   *
      * MAIN     - BANK INVESTMENT POLICY LIST                                 *
      * PA01     - PROCESS AUDIT REPORT                                        *
      * PL01     - PROCESS FULL BANK INVESTMENT POLICY LIST                    *
      * PR01     - PRINT INSTRUMENT POLICY DETAILS                             *
      * PR02     - PRINT CURRENCY POLICY DETAILS                               *
      * PR03     - PRINT COUNTRY POLICY DETAILS                                *
      * PR04     - PRINT INDUSTRY POLICY DETAILS                               *
      * AU01     - AUDIT PROCESSING                                            *
      * W01      - PRINT BANK INVESTMENT POLICY HEADER                         *
      * W02      - PRINT BANK INSTRUMENT INVESTMENT POLICY DETAILS             *
      * W03      - PRINT BANK CURRENCY INVESTMENT POLICY DETAILS               *
      * W04      - PRINT BANK COUNTRY INVESTMENT POLICY DETAILS                *
      * W05      - PRINT BANK INDUSTRY INVESTMENT POLICY DETAILS               *
      * W06      - PRINT AUDIT                                                 *
      * OVERP1   - OVERFLOW PROCESSING ON PM0300P1                             *
      * *PSSR    - DATA BASE ERROR SUBROUTINE                                  *
      *                                                                        *
      * EXTERNAL ROUTINES CALLED                                               *
      *                                                                        *
      **************************************************************************
     C           PLIST     KLIST
     C                     KFLD           BJRDNB
     C                     KFLD           PSPOLC
     C           *ENTRY    PLIST
     C                     PARM           WWMODE
     C                     PARM           RSEQ    5                       S01486
     C           *LIKE     DEFN PSRECI    WWMODE
     C           *LIKE     DEFN AOLICD    WWLIND
      *****************************************************************
      *                                                               *
      *  P R O G R A M   S T A R T                                    *
      *                                                               *
      *****************************************************************
      *
      * PROCESS INIT
      *
     C***********          MOVEACPY@      BIS@   80                       S01486
     C                     MOVEACPY@      ACT@   80                       S01486
     C           *NAMVAR   DEFN           LDA                             S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVE *BLANKS   DBLOT
     C                     MOVEL'PM0300'  DBPGM
     C                     OUT  LDA                                       S01486
     C                     Z-ADD0         RRINSE
     C                     Z-ADD0         RRAMEN
     C                     Z-ADD0         RRDELE
     C                     Z-ADD0         RRCNT
     C                     MOVE RSEQ      SEQ                             S01486
     C*                                                                   S01486
     C**  ENSURE AUDIT SPOOL FILE RECORDED BY RCF                         S01486
     C*                                                                   S01486
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01486
     C*                                                                   S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ                             S01486
     C                     PARM *BLANKS   SENTY                           S01486
     C                     PARM           SFILEU                          S01486
     C                     PARM           ZSNUMU                          S01486
     C                     PARM *BLANK    ZSERR                           S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C*                                                                   S01486
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01486
     C*                                                                   S01486
     C                     SETON                     U7U8LR               S01486
     C                     RETRN                                          S01486
     C                     END                                            S01486
      *
      * READ ICD1 FROM LF/SDBANKL1
      *
     C***********          READ SDBANKL1                 71               S01486
     C************IN71     IFEQ '1'                        - B1           S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*MSG   ' WWRTCD  7                       S01486
     C                     PARM '*FIRST ' WWOPTN  7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD01        DBASE            ***************
     C***********          MOVE 'SDBANKL1'DBFILE           **DB ERROR 01**S01486
     C                     MOVE 'SDBANKPD'DBFILE           **DB ERROR 01**S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                      ***************
     C                     END                             - E1
      *
      * CHECK THE PROGRAM RUNNING MODE
      *
     C           WWMODE    IFEQ '1'                        - B1
     C                     MOVE '1'       *IN32
     C                     EXSR PA01
     C                     ELSE                            - X1
     C           WWMODE    IFEQ '2'                        - B2
     C                     MOVE '0'       *IN32
     C                     EXSR PL01
     C                     ELSE                            - X2
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD02        DBASE            ***************
     C                     MOVE 'WWMODE  'DBFILE           **DB ERROR 02**
     C                     MOVELWWMODE    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E2
     C                     END                             - E1
      *
     C                     EXSR AU01
      *
     C                     SETON                     LR
     C                     RETRN
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * PA01     - PROCESS AUDIT REPORT                                        *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * W01      - PRINT BANK INVESTMENT POLICY HEADER                         *
      * PR01     - PRINT INSTRUMENT POLICY DETAILS                             *
      * PR02     - PRINT CURRENCY POLICY DETAILS                               *
      * PR03     - PRINT COUNTRY POLICY DETAILS                                *
      * PR04     - PRINT INDUSTRY POLICY DETAILS                               *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - BANK INVESTMENT POLICY LIST                                 *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           PA01      BEGSR                           **PA01 BSR**
      *
      * ACCESS BANK INVESTMENT POLICY NARRATIVE FILE BEGINNING AT THE RUN DATE
      *
     C                     MOVE *LOVAL    PSPOLC
     C           PLIST     SETLLPMBIPNLC
     C                     READ PMBIPNLC                 89
     C           *IN89     IFEQ '1'                                       S01486
     C                     MOVE '1'       *IN88                           S01486
     C                     GOTO END01                                     S01486
     C                     ELSE                                           S01486
     C                     OPEN PM0300P1                                  S01486
     C*                                                                   S01486
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01486
     C*                                                                   S01486
     C                     Z-ADDSFNUM     ZSNUM   60                      S01486
     C*                                                                   S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ     5                       S01486
     C                     PARM *BLANKS   SENTY   3                       S01486
     C                     PARM           SFILE                           S01486
     C                     PARM           ZSNUM                           S01486
     C                     PARM           ZSERR   1                       S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C*                                                                   S01486
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01486
     C*                                                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     SETON                     U7U8LR               S01486
     C                     RETRN                                          S01486
     C                     END                                            S01486
     C                     END                                            S01486
      *
     C************IN89     IFEQ '1'                        - B1           S01486
     C************         MOVEL*BLANKS   PSPOLC                          S01486
     C************         MOVEL*BLANKS   PSPOLN                          S01486
     C************         EXSR W01                                       S01486
     C************         WRITEENDP1                                     S01486
     C************         ELSE                                           S01486
     C           PSLCD     DOWEQBJRDNB                     - B2
     C           *IN89     ANDEQ'0'
      *
      * SET INDICATOR FOR PRINTING FIELDS
      *
     C                     MOVE '1'       *IN24
     C                     MOVE '1'       *IN25
     C                     MOVE '1'       *IN26
     C                     MOVE '1'       *IN27
     C                     MOVE '1'       *IN28
     C                     MOVE '1'       *IN29
     C                     MOVE '1'       *IN30
     C                     MOVE '1'       *IN31
     C                     MOVE '1'       *IN40
     C                     MOVE '1'       *IN41
     C                     MOVE '1'       *IN42
     C                     MOVE '1'       *IN43
      *
      * CHECK THE LAST CHANGE TYPE
      *
     C           PSCHTP    IFEQ 'I'                        - B3
     C                     ADD  1         RRINSE
     C                     END                             - E3
      *
     C           PSCHTP    IFEQ 'A'                        - B3
     C                     ADD  1         RRAMEN
     C                     END                             - E3
      *
     C           PSCHTP    IFEQ 'D'                        - B3
     C                     ADD  1         RRDELE
     C                     END                             - E3
      *
     C                     EXSR W01
      *
      * CHECK THE INDICATOR FOR INSTRUMENT, CURRENCY, COUNTRY AND INDUSTRY
      *
     C                     EXSR PR01
      *
     C                     EXSR PR02
      *
     C                     EXSR PR03
      *
     C                     EXSR PR04
      *
     C                     READ PMBIPNLC                 89
      *
     C                     END                             - E2
      *
     C                     WRITEENDP1                  60                 47153
     C                     CLOSEPM0300P1                                  S01486
      *
     C***********          END                             - E1           S01486
      *
     C***********          ENDSR                           **PA01 ESR**   S01486
     C           END01     ENDSR                           **PA01 ESR**   S01486
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * PL01     - PROCESS FULL BANK INVESTMENT POLICY LIST                    *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * W01      - PRINT BANK INVESTMENT POLICY HEADER                         *
      * PR01     - PRINT INSTRUMENT POLICY DETAILS                             *
      * PR02     - PRINT CURRENCY POLICY DETAILS                               *
      * PR03     - PRINT COUNTRY POLICY DETAILS                                *
      * PR04     - PRINT INDUSTRY POLICY DETAILS                               *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - BANK INVESTMENT POLICY LIST                                 *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           PL01      BEGSR                           **PL01 BSR**
      *
      * ACCESS ALL THE BANK INVESTMENT POLICY FILE
      *
     C************         READ PMBIPNPP                 89               S01486
     C                     READ PMBIPNPD                 89               S01486
     C           *IN89     IFEQ '1'                                       S01486
     C                     MOVE '1'       *IN88                           S01486
     C                     GOTO END02                                     S01486
     C                     ELSE                                           S01486
     C                     OPEN PM0300P1                                  S01486
     C*                                                                   S01486
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01486
     C*                                                                   S01486
     C                     Z-ADDSFNUM     ZSNUM   60                      S01486
     C*                                                                   S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ     5                       S01486
     C                     PARM *BLANKS   SENTY   3                       S01486
     C                     PARM           SFILE                           S01486
     C                     PARM           ZSNUM                           S01486
     C                     PARM           ZSERR   1                       S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C*                                                                   S01486
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01486
     C*                                                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     SETON                     U7U8LR               S01486
     C                     RETRN                                          S01486
     C                     END                                            S01486
     C                     END                                            S01486
     C************IN89     IFEQ '1'                                       S01486
     C************         MOVEL*BLANKS   PSPOLC                          S01486
     C************         MOVEL*BLANKS   PSPOLN                          S01486
     C************         EXSR W01                                       S01486
     C************         WRITEENDP1                                     S01486
     C************         END                                            S01486
      *
     C           *IN89     DOWEQ'0'                        - B1
      *
      * SET INDICATOR FOR PRINTING FIELDS
      *
     C                     MOVE '1'       *IN24
     C                     MOVE '1'       *IN25
     C                     MOVE '1'       *IN26
     C                     MOVE '1'       *IN27
     C                     MOVE '1'       *IN28
     C                     MOVE '1'       *IN29
     C                     MOVE '1'       *IN30
     C                     MOVE '1'       *IN31
     C                     MOVE '1'       *IN40
     C                     MOVE '1'       *IN41
     C                     MOVE '1'       *IN42
     C                     MOVE '1'       *IN43
      *
      * PROCESS ONLY THE LIVE RECORD
      *
     C           PSRECI    IFEQ 'D'                        - B2
      *
     C                     ADD  1         RRCNT
      *
     C                     EXSR W01
      *
      * CHECK THE INDICATOR FOR INSTRUMENT, CURRENCY, COUNTRY AND INDUSTRY
      *
     C                     EXSR PR01
      *
     C                     EXSR PR02
      *
     C                     EXSR PR03
      *
     C                     EXSR PR04
      *
     C                     END                             - E2
      *
     C************         READ PMBIPNPP                 89               S01486
     C                     READ PMBIPNPD                 89               S01486
      *
     C                     END                             - E1
      *
     C                     WRITEENDP1                  60                 47153
     C                     CLOSEPM0300P1                                  S01486
      *
     C***********          ENDSR                           **PL01 ESR**   S01486
     C           END02     ENDSR                           **PL01 ESR**   S01486
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * PR01     - PRINT INSTRUMENT POLICY DETAILS                             *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - DATA BASE ERROR SUBROUTINE                                  *
      * W02      - PRINT BANK INSTRUMENT INVESTMENT POLICY DETAILS             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * PA01     - PROCESS AUDIT REPORT                                        *
      * PL01     - PROCESS FULL BANK INVESTMENT POLICY LIST                    *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           PR01      BEGSR                           **PR01 BSR**
      *
     C* INITIALISE POLICY WRITTEN FLAG
     C                     MOVE *BLANK    WWFLAG  1
      * PROCESS ALL THE BANK INSTRUMENT INVESTMENT POLICY WITH THE SAME
      * POLICY CODE UNLESS POLICIES PRESENT INDICATOR IS NOT 'Y' AND THE
      * LAST CHANGE DATE IS NOT EQUAL TO THE RUN DATE (FOR THE AUDIT)
      *
     C           PSIPIN    IFNE 'Y'
     C           PSLCD     ANDNEBJRDNB
     C           WWMODE    ANDEQ'1'
     C           PSIPIN    ORNE 'Y'
     C           WWMODE    ANDNE'1'
     C                     WRITEPM03001N
     C                     ELSE
     C*
     C           PSPOLC    CHAINPMBIIPLL             72
      *
     C           *IN72     DOWEQ'0'                        - B1
      *
      * PROCESS ONLY THE LIVE RECORD
      *
     C           PTRECI    IFEQ 'D'                        - B2
     C           PTLCD     OREQ BJRDNB
     C           WWMODE    ANDEQ'1'
     C           PTCHTP    ANDEQ'D'
     C* IF AT LEAST ONE RECORD IS READ, PREVENT ** NO POLICY DEFINED **
     C* MESSAGE FROM BEING WRITTEN
     C                     MOVE 'Y'       WWFLAG
      *
      * IF INSTRUMENT TYPE IS BLANK PROCESS WITH INSTRUMENT GROUP CODE
      *
     C           PTINNR    IFEQ *BLANKS                    - B3
      *
      * ACCESS INSTRUMENT TYPE GROUP NARRATIVE WITH INSTRUMENT GROUP CODE
      *
     C***********PTINTG    CHAINPMPGHIPP             73                   S01486
     C           PTINTG    CHAINPMPGHIPD             73                   S01486
     C           *IN73     IFEQ '1'                        - B4
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD03        DBASE            ***************
     C***********          MOVE 'PMPGHIPP'DBFILE           **DB ERROR 03**S01486
     C                     MOVE 'PMPGHIPD'DBFILE           **DB ERROR 03**S01486
     C                     MOVELPTINTG    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
      *
     C                     ELSE                            - X3
      *
      * ACCESS INSTRUMENT TYPES WITH INSTRUMENT TYPE
      *
     C***********PTINNR    CHAINSDPLINPD             74                   S01486
     C************IN74     IFEQ '1'                        - B4           S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*VERIFY 'WWOPTN  7                       S01486
     C                     PARM PTINNR    WWKEY3  3                       S01486
     C           SDPLIN    PARM SDPLIN    DSSDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD04        DBASE            ***************
     C                     MOVE 'SDPLINPD'DBFILE           **DB ERROR 04**
     C                     MOVELPTINNR    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
      *
     C                     END                             - E3
      *
     C                     EXSR W02
     C* IF AT LEAST ONE RECORD IS READ, PREVENT ** NO POLICY DEFINED **
     C* MESSAGE FROM BEING WRITTEN
     C                     MOVE 'Y'       WWFLAG
      *
     C                     END                             - E2
      *
     C           PSPOLC    READEPMBIIPLL                 72
      *
     C                     END                             - E1
      *
     C*  TEST TO SEE IF A POLICY IS THERE OR NOT. IF NOT, WRITE MESSAGE
     C           WWFLAG    IFNE 'Y'
     C                     WRITEPM03001N
     C                     END
      *
     C                     END
     C*
     C                     ENDSR                           **PR01 ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * PR02     - PRINT CURRENCY POLICY DETAILS                               *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - DATA BASE ERROR SUBROUTINE                                  *
      * W03      - PRINT BANK CURRENCY INVESTMENT POLICY DETAILS               *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * PA01     - PROCESS AUDIT REPORT                                        *
      * PL01     - PROCESS FULL BANK INVESTMENT POLICY LIST                    *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           PR02      BEGSR                           **PR02 BSR**
      *
     C* INITIALISE POLICY WRITTEN FLAG
     C                     MOVE *BLANK    WWFLAG
      * PROCESS ALL THE BANK CURRENCY INVESTMENT POLICY WITH THE SAME
      * POLICY CODE UNLESS POLICY PRESENT INDICATOR EQUALS 'N'
      *
     C           PSCYIN    IFNE 'Y'
     C           PSLCD     ANDNEBJRDNB
     C           WWMODE    ANDEQ'1'
     C           PSCYIN    ORNE 'Y'
     C           WWMODE    ANDNE'1'
     C                     WRITEPM03002N
     C                     ELSE
      *
     C           PSPOLC    CHAINPMBCIPLL             75
      *
     C           *IN75     DOWEQ'0'                        - B1
      *
      * PROCESS ONLY THE LIVE RECORD
      *
     C           PURECI    IFEQ 'D'                        - B2
     C           PULCD     OREQ BJRDNB
     C           WWMODE    ANDEQ'1'
     C           PUCHTP    ANDEQ'D'
      *
      * IF CURRENCY CODE IS BLANK PROCESS WITH CURRENCY GROUP CODE
      *
     C           PUCCY     IFEQ *BLANKS                    - B3
      *
      * ACCESS CURRENCY GROUPS NARRATIVE WITH CURRENCY GROUP CODE
      *
     C***********PUCCYG    CHAINPMPGHCPP             76                   S01486
     C           PUCCYG    CHAINPMPGHCPD             76                   S01486
     C           *IN76     IFEQ '1'                        - B4
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD05        DBASE            ***************
     C***********          MOVE 'PMPGHCPP'DBFILE           **DB ERROR 05**S01486
     C                     MOVE 'PMPGHCPD'DBFILE           **DB ERROR 05**S01486
     C                     MOVELPUCCYG    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
      *
     C                     ELSE                            - X3
      *
      * ACCESS CURRENCIES WITH CURRENCY CODE
      *
     C***********PUCCY     CHAINSDCURRL0             77                   S01486
     C************IN77     IFEQ '1'                        - B4           S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7        B:Return code  S01486
     C                     PARM '*VERIFY 'WWOPTN  7        I:Option       S01486
     C                     PARM PUCCY     WWKEY3  3        I:Key field    S01486
     C           SDCURR    PARM SDCURR    DSSDY            O:Format       S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD06        DBASE            ***************
     C***********          MOVE 'SDCURRL0'DBFILE           **DB ERROR 06**S01486
     C                     MOVE 'SDCURRPD'DBFILE           **DB ERROR 06**S01486
     C                     MOVELPUCCY     DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
      *
     C                     END                             - E3
      *
     C                     EXSR W03
     C* IF AT LEAST ONE RECORD IS READ, PREVENT ** NO POLICY DEFINED **
     C* MESSAGE FROM BEING WRITTEN
     C                     MOVE 'Y'       WWFLAG
      *
     C                     END                             - E2
      *
     C           PSPOLC    READEPMBCIPLL                 75
      *
     C                     END                             - E1
     C*  TEST TO SEE IF A POLICY IS THERE OR NOT. IF NOT, WRITE MESSAGE
     C           WWFLAG    IFNE 'Y'
     C                     WRITEPM03002N
     C                     END
      *
     C                     END
      *
     C                     ENDSR                           **PR02 ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * PR03     - PRINT COUNTRY POLICY DETAILS                                *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - DATA BASE ERROR SUBROUTINE                                  *
      * W04      - PRINT BANK COUNTRY INVESTMENT POLICY DETAILS                *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * PA01     - PROCESS AUDIT REPORT                                        *
      * PL01     - PROCESS FULL BANK INVESTMENT POLICY LIST                    *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           PR03      BEGSR                           **PR03 BSR**
      *
     C* INITIALISE POLICY WRITTEN FLAG
     C                     MOVE *BLANK    WWFLAG
      * PROCESS ALL THE BANK COUNTRY INVESTMENT POLICY WITH THE SAME
      * POLICY CODE UNLESS POLICY PRESENT INDICATOR EQUALS 'N'
      *
     C           PSYPIN    IFNE 'Y'
     C           PSLCD     ANDNEBJRDNB
     C           WWMODE    ANDEQ'1'
     C           PSYPIN    ORNE 'Y'
     C           WWMODE    ANDNE'1'
     C                     WRITEPM03003N
     C                     ELSE
     C*
     C           PSPOLC    CHAINPMBRIPLL             78
      *
     C           *IN78     DOWEQ'0'                        - B1
      *
      * PROCESS ONLY THE LIVE RECORD
      *
     C           PXRECI    IFEQ 'D'                        - B2
     C           PXLCD     OREQ BJRDNB
     C           WWMODE    ANDEQ'1'
     C           PXCHTP    ANDEQ'D'
      *
      * IF COUNTRY CODE IS BLANK PROCESS WITH COUNTRY GROUP CODE
      *
     C           PXCCOD    IFEQ *BLANKS                    - B3
      *
      * ACCESS COUNTRY GROUPS NARRATIVE WITH COUNTRY GROUP CODE
      *
     C***********PXCCDG    CHAINPMPGHRPP             79                   S01486
     C           PXCCDG    CHAINPMPGHRPD             79                   S01486
     C           *IN79     IFEQ '1'                        - B4
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD07        DBASE            ***************
     C***********          MOVE 'PMPGHRPP'DBFILE           **DB ERROR 07**S01486
     C                     MOVE 'PMPGHRPD'DBFILE           **DB ERROR 07**S01486
     C                     MOVELPXCCDG    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
      *
     C                     ELSE                            - X3
      *
      * ACCESS COUNTRY CODES WITH COUNTRY CODE
      *
     C***********PXCCOD    CHAINSDCTRYL1             80                   S01486
     C************IN80     IFEQ '1'                        - B4           S01486
     C                     CALL 'AOCTRYR0'                                S01486
     C                     PARM '*MSG    'WWRTCD                          S01486
     C                     PARM '*VERIFY 'WWOPTN                          S01486
     C                     PARM PXCCOD    WWKEY2  2                       S01486
     C           SDCTRY    PARM SDCTRY    DSSDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD08        DBASE            ***************
     C***********          MOVE 'SDCTRYL1'DBFILE           **DB ERROR 08**S01486
     C                     MOVE 'SDCTRYPD'DBFILE           **DB ERROR 08**S01486
     C                     MOVELPXCCOD    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
      *
     C                     END                             - E3
      *
     C                     EXSR W04
     C* IF AT LEAST ONE RECORD IS READ, PREVENT ** NO POLICY DEFINED **
     C* MESSAGE FROM BEING WRITTEN
     C                     MOVE 'Y'       WWFLAG
      *
     C                     END                             - E2
      *
     C           PSPOLC    READEPMBRIPLL                 78
      *
     C                     END                             - E1
     C*  TEST TO SEE IF A POLICY IS THERE OR NOT. IF NOT, WRITE MESSAGE
     C           WWFLAG    IFNE 'Y'
     C                     WRITEPM03003N
     C                     END
      *
     C                     END
      *
     C                     ENDSR                           **PR03 ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * PR04     - PRINT INDUSTRY POLICY DETAILS                               *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - DATA BASE ERROR SUBROUTINE                                  *
      * W05      - PRINT BANK INDUSTRY INVESTMENT POLICY DETAILS               *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * PA01     - PROCESS AUDIT REPORT                                        *
      * PL01     - PROCESS FULL BANK INVESTMENT POLICY LIST                    *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWLIND   - INDUSTRY CODE                                               *
      *                                                                        *
      **************************************************************************
     C           PR04      BEGSR                           **PR04 BSR**
      *
     C* INITIALISE POLICY WRITTEN FLAG
     C                     MOVE *BLANK    WWFLAG
      * PROCESS ALL THE BANK INDUSTRY INVESTMENT POLICY WITH THE SAME
      * POLICY CODE UNLESS POLICY PRESENT INDICATOR EQUALS 'N'
      *
     C           PSNPIN    IFNE 'Y'
     C           PSLCD     ANDNEBJRDNB
     C           WWMODE    ANDEQ'1'
     C           PSNPIN    ORNE 'Y'
     C           WWMODE    ANDNE'1'
     C                     WRITEPM03004N
     C                     ELSE
     C*
     C           PSPOLC    CHAINPMBDIPLL             81
      *
     C           *IN81     DOWEQ'0'                        - B1
      *
      * PROCESS ONLY THE LIVE RECORD
      *
     C           PWRECI    IFEQ 'D'                        - B2
     C           PWLCD     OREQ BJRDNB
     C           WWMODE    ANDEQ'1'
     C           PWCHTP    ANDEQ'D'
      *
      * IF INDUSTRY CODE IS BLANK PROCESS WITH INDUSTRY GROUP CODE
      *
     C********** PWLIND    IFEQ *ZEROS                     - B3                               CER020
     C           PWLOIC    IFEQ *BLANKS                    - B3                               CER020
      *
      * ACCESS INDUSTRY GROUPS NARRATIVE WITH INDUSTRY GROUP CODE
      *
     C***********PWLING    CHAINPMPGHDPP             82                   S01486
     C           PWLING    CHAINPMPGHDPD             82                   S01486
     C           *IN82     IFEQ '1'                        - B4
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD09        DBASE            ***************
     C***********          MOVE 'PMPGHDPP'DBFILE           **DB ERROR 09**S01486
     C                     MOVE 'PMPGHDPD'DBFILE           **DB ERROR 09**S01486
     C                     MOVELPWLING    DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
      *
     C                     ELSE                            - X3
      *
      * ACCESS INDUSTRY CODES WITH INDUSTRY CODE
      *
     C**********           MOVE PWLIND    WWLIND                                              CER020
     C                     MOVE PWLOIC    WWLIND                                              CER020
     C***********WWLIND    CHAINSDINDSL1             83                   S01486
     C************IN83     IFEQ '1'                        - B4           S01486
     C                     CALL 'AOINDSR0'                                S01486
     C                     PARM '*MSG    'WWRTCD                          S01486
     C                     PARM '*VERIFY 'WWOPTN                          S01486
     C                     PARM WWLIND    WWKEY3                          S01486
     C           SDINDS    PARM SDINDS    DSSDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD10        DBASE            ***************
     C***********          MOVE 'SDINDSL1'DBFILE           **DB ERROR 10**S01486
     C                     MOVE 'SDINDSPD'DBFILE           **DB ERROR 10**S01486
     C**********           MOVELPWLIND    DBKEY            ***************                    CER020
     C                     MOVELPWLOIC    DBKEY            ***************                    CER020
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
      *
     C                     END                             - E3
      *
     C                     EXSR W05
     C* IF AT LEAST ONE RECORD IS READ, PREVENT ** NO POLICY DEFINED **
     C* MESSAGE FROM BEING WRITTEN
     C                     MOVE 'Y'       WWFLAG
      *
     C                     END                             - E2
      *
     C           PSPOLC    READEPMBDIPLL                 81
      *
     C                     END                             - E1
     C*  TEST TO SEE IF A POLICY IS THERE OR NOT. IF NOT, WRITE MESSAGE
     C           WWFLAG    IFNE 'Y'
     C                     WRITEPM03004N
     C                     END
      *
     C                     END
      *
     C                     ENDSR                           **PR04 ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * AU01     - AUDIT PROCESSING                                            *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - DATA BASE ERROR SUBROUTINE                                  *
      * W06      - PRINT AUDIT                                                 *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - BANK INVESTMENT POLICY LIST                                 *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWMODE   - MODE IN WHICH THE PROGRAM RUN                               *
      *                                                                        *
      **************************************************************************
     C           AU01      BEGSR                           **AU01 BSR**
      *
     C***********          READ PMBIPNZZ                 84               S01486
     C                     READ PMBIPNPA                 84               S01486
      *
     C           *IN84     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD11        DBASE            ***************
     C***********          MOVE 'PMBIPNZZ'DBFILE           **DB ERROR 11**S01486
     C                     MOVE 'PMBIPNPA'DBFILE           **DB ERROR 11**S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                      ***************
     C                     END                             - E1
      *
      * CHECK THE SAME NUMBER OF RECORD IF MODE = 2
      *
     C           WWMODE    IFEQ '2'                        - B1
     C           RRCNT     ANDNEPSNORE
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C                     EXSR W06
      *
     C                     ENDSR                           **AU01 ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * W01      - PRINT BANK INVESTMENT POLICY HEADER                         *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * PA01     - PROCESS AUDIT REPORT                                        *
      * PL01     - PROCESS FULL BANK INVESTMENT POLICY LIST                    *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           W01       BEGSR                           **W01  BSR**
      *
      * POLICY CODE AND POLICY NARRATIVE
      *
     C                     MOVE PSPOLC    RRPOLC
     C                     MOVELPSPOLN    RRPOLN
      *
     C                     WRITEHEADP1
      *
     C                     ENDSR                           **W01  ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * W02      - PRINT BANK INSTRUMENT INVESTMENT POLICY DETAILS             *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * OVERP1   - OVERFLOW PROCESSING ON PM0300P1                             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * PR01     - PRINT INSTRUMENT POLICY DETAILS                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           W02       BEGSR                           **W02  BSR**
      *
     C           PTMINR    IFEQ 0
     C           PTMAXR    ANDEQ0
     C                     MOVE '1'       *IN44
     C                     ELSE
     C                     MOVE '0'       *IN44
     C                     END
     C*
     C                     Z-ADDPTMINR    RRMINR
     C                     Z-ADDPTMAXR    RRMAXR
     C*                                                                   R00824
     C** IF MINIMUM RANGE IS 100% OUTPUT BLANK MAXIMUM RANGE              R00824
     C           PTMINR    IFEQ 100                                       R00824
     C                     MOVE '0'       *IN20                           R00824
     C                     ELSE                                           R00824
     C                     MOVE '1'       *IN20                           R00824
     C                     END                                            R00824
      *
      * CHECK LAST CHANGE TYPE
      *
     C           PTCHTP    IFEQ 'I'                        - B1
     C                     MOVE '1'       *IN21
     C                     END                             - E1
     C           PTCHTP    IFEQ 'A'                        - B1
     C                     MOVE '1'       *IN22
     C                     END                             - E1
     C           PTCHTP    IFEQ 'D'                        - B1
     C                     MOVE '1'       *IN23
     C                     END                             - E1
     C                     MOVE PTDLUP    RRDLUP
     C                     MOVE PTMLUP    RRMLUP
     C                     MOVE PTYLUP    RRYLUP
     C                     Z-ADDPTTLUP    RRTLUP
      *
     C           PTINNR    IFEQ *BLANKS                    - B1
     C                     MOVE PTINTG    RRINTG
     C                     MOVE PFINGN    RRINGN
     C           *IN70     IFEQ '1'                        - B2
     C                     EXSR OVERP1
     C                     END                             - E2
     C                     WRITEPM03001G
     C                     MOVE '0'       *IN24
     C                     ELSE                            - X1
     C                     MOVE PTINNR    RRINNR
     C                     MOVE PDISTN    RRISTN
     C           *IN70     IFEQ '1'                        - B2
     C                     EXSR OVERP1
     C                     END                             - E2
     C                     WRITEPM03001I
     C                     MOVE '0'       *IN25
     C                     END                             - E1
     C                     MOVE '0'       *IN40
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN22
     C                     MOVE '0'       *IN23
      *
     C                     ENDSR                           **W02  ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * W03      - PRINT BANK CURRENCY INVESTMENT POLICY DETAILS               *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * OVERP1   - OVERFLOW PROCESSING ON PM0300P1                             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * PR02     - PRINT CURRENCY POLICY DETAILS                               *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           W03       BEGSR                           **W03  BSR**
      *
     C           PUMINR    IFEQ 0
     C           PUMAXR    ANDEQ0
     C                     MOVE '1'       *IN44
     C                     ELSE
     C                     MOVE '0'       *IN44
     C                     END
     C*
     C                     Z-ADDPUMINR    RRMINR
     C                     Z-ADDPUMAXR    RRMAXR
     C*                                                                   R00824
     C** IF MINIMUM RANGE IS 100% OUTPUT BLANK MAXIMUM RANGE              R00824
     C           PUMINR    IFEQ 100                                       R00824
     C                     MOVE '0'       *IN20                           R00824
     C                     ELSE                                           R00824
     C                     MOVE '1'       *IN20                           R00824
     C                     END                                            R00824
      *
      * CHECK LAST CHANGE TYPE
      *
     C           PUCHTP    IFEQ 'I'                        - B1
     C                     MOVE '1'       *IN21
     C                     END                             - E1
     C           PUCHTP    IFEQ 'A'                        - B1
     C                     MOVE '1'       *IN22
     C                     END                             - E1
     C           PUCHTP    IFEQ 'D'                        - B1
     C                     MOVE '1'       *IN23
     C                     END                             - E1
     C                     MOVE PUDLUP    RRDLUP
     C                     MOVE PUMLUP    RRMLUP
     C                     MOVE PUYLUP    RRYLUP
     C                     Z-ADDPUTLUP    RRTLUP
      *
     C           PUCCY     IFEQ *BLANKS                    - B1
     C                     MOVE PUCCYG    RRCCYG
     C                     MOVE PHCCGN    RRCCGN
     C           *IN70     IFEQ '1'                        - B2
     C                     EXSR OVERP1
     C                     END                             - E2
     C                     WRITEPM03002G
     C                     MOVE '0'       *IN26
     C                     ELSE                            - X1
     C                     MOVE PUCCY     RRCCY
     C                     MOVE A6CYNM    RRCYNM
     C           *IN70     IFEQ '1'                        - B2
     C                     EXSR OVERP1
     C                     END                             - E2
     C                     WRITEPM03002I
     C                     MOVE '0'       *IN27
     C                     END                             - E1
     C                     MOVE '0'       *IN41
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN22
     C                     MOVE '0'       *IN23
      *
     C                     ENDSR                           **W03  ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * W04      - PRINT BANK COUNTRY INVESTMENT POLICY DETAILS                *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * OVERP1   - OVERFLOW PROCESSING ON PM0300P1                             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * PR03     - PRINT COUNTRY POLICY DETAILS                                *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           W04       BEGSR                           **W04  BSR**
      *
     C           PXMINR    IFEQ 0
     C           PXMAXR    ANDEQ0
     C                     MOVE '1'       *IN44
     C                     ELSE
     C                     MOVE '0'       *IN44
     C                     END
     C*
     C                     Z-ADDPXMINR    RRMINR
     C                     Z-ADDPXMAXR    RRMAXR
     C*                                                                   R00824
     C** IF MINIMUM RANGE IS 100% OUTPUT BLANK MAXIMUM RANGE              R00824
     C           PXMINR    IFEQ 100                                       R00824
     C                     MOVE '0'       *IN20                           R00824
     C                     ELSE                                           R00824
     C                     MOVE '1'       *IN20                           R00824
     C                     END                                            R00824
      *
      * CHECK LAST CHANGE TYPE
      *
     C           PXCHTP    IFEQ 'I'                        - B1
     C                     MOVE '1'       *IN21
     C                     END                             - E1
     C           PXCHTP    IFEQ 'A'                        - B1
     C                     MOVE '1'       *IN22
     C                     END                             - E1
     C           PXCHTP    IFEQ 'D'                        - B1
     C                     MOVE '1'       *IN23
     C                     END                             - E1
     C                     MOVE PXDLUP    RRDLUP
     C                     MOVE PXMLUP    RRMLUP
     C                     MOVE PXYLUP    RRYLUP
     C                     Z-ADDPXTLUP    RRTLUP
      *
     C           PXCCOD    IFEQ *BLANKS                    - B1
     C                     MOVE PXCCDG    RRCCDG
     C                     MOVE PJCOGN    RRCOGN
     C           *IN70     IFEQ '1'                        - B2
     C                     EXSR OVERP1
     C                     END                             - E2
     C                     WRITEPM03003G
     C                     MOVE '0'       *IN28
     C                     ELSE                            - X1
     C                     MOVE PXCCOD    RRCCOD
     C                     MOVE A4CNNM    RRCNNM
     C           *IN70     IFEQ '1'                        - B2
     C                     EXSR OVERP1
     C                     END                             - E2
     C                     WRITEPM03003I
     C                     MOVE '0'       *IN29
     C                     END                             - E1
     C                     MOVE '0'       *IN42
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN22
     C                     MOVE '0'       *IN23
      *
     C                     ENDSR                           **W04  ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * W05      - PRINT BANK INDUSTRY INVESTMENT POLICY DETAILS               *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * OVERP1   - OVERFLOW PROCESSING ON PM0300P1                             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * PR04     - PRINT INDUSTRY POLICY DETAILS                               *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           W05       BEGSR                           **W05  BSR**
      *
     C           PWMINR    IFEQ 0
     C           PWMAXR    ANDEQ0
     C                     MOVE '1'       *IN44
     C                     ELSE
     C                     MOVE '0'       *IN44
     C                     END
     C*
     C                     Z-ADDPWMINR    RRMINR
     C                     Z-ADDPWMAXR    RRMAXR
     C*                                                                   R00824
     C** IF MINIMUM RANGE IS 100% OUTPUT BLANK MAXIMUM RANGE              R00824
     C           PWMINR    IFEQ 100                                       R00824
     C                     MOVE '0'       *IN20                           R00824
     C                     ELSE                                           R00824
     C                     MOVE '1'       *IN20                           R00824
     C                     END                                            R00824
      *
      * CHECK LAST CHANGE TYPE
      *
     C           PWCHTP    IFEQ 'I'                        - B1
     C                     MOVE '1'       *IN21
     C                     END                             - E1
     C           PWCHTP    IFEQ 'A'                        - B1
     C                     MOVE '1'       *IN22
     C                     END                             - E1
     C           PWCHTP    IFEQ 'D'                        - B1
     C                     MOVE '1'       *IN23
     C                     END                             - E1
     C                     MOVE PWDLUP    RRDLUP
     C                     MOVE PWMLUP    RRMLUP
     C                     MOVE PWYLUP    RRYLUP
     C                     Z-ADDPWTLUP    RRTLUP
      *
     C********** PWLIND    IFEQ *ZEROS                     - B1                               CER020
     C           PWLOIC    IFEQ *BLANKS                    - B1                               CER020
     C                     MOVE PWLING    RRLING
     C                     MOVE PLLINN    RRLINN
     C           *IN70     IFEQ '1'                        - B2
     C                     EXSR OVERP1
     C                     END                             - E2
     C                     WRITEPM03004G
     C                     MOVE '0'       *IN30
     C                     ELSE                            - X1
     C**********           MOVE PWLIND    RRLIND                                              CER020
     C                     MOVE PWLOIC    RRLIND                                              CER020
     C                     MOVE AOLINA    RRLINA
     C           *IN70     IFEQ '1'                        - B2
     C                     EXSR OVERP1
     C                     END                             - E2
     C                     WRITEPM03004I
     C                     MOVE '0'       *IN31
     C                     END                             - E1
     C                     MOVE '0'       *IN43
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN22
     C                     MOVE '0'       *IN23
      *
     C                     ENDSR                           **W05  ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * W06      - PRINT AUDIT                                                 *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * AU01     - AUDIT PROCESSING                                            *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWMODE   - MODE IN WHICH THE PROGRAM RUN                               *
      *                                                                        *
      **************************************************************************
     C           W06       BEGSR                           **W06  BSR**
      *
     C                     WRITEHEADAU
     C                     Z-ADDPSNORE    RRNORE
     C           WWMODE    IFEQ '1'                        - B1
     C                     WRITEPM0300A1
     C                     ELSE                            - X1
     C                     WRITEPM0300A2
     C                     END                             - E1
     C***********          WRITEENDAU                                     S01486
     C   88                WRITENODETAIL                                  S01486
      *
     C                     ENDSR                           **W06  ESR**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * OVERP1   - OVERFLOW PROCESSING ON PM0300P1                             *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * W02      - PRINT BANK INSTRUMENT INVESTMENT POLICY DETAILS             *
      * W03      - PRINT BANK CURRENCY INVESTMENT POLICY DETAILS               *
      * W04      - PRINT BANK COUNTRY INVESTMENT POLICY DETAILS                *
      * W05      - PRINT BANK INDUSTRY INVESTMENT POLICY DETAILS               *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           OVERP1    BEGSR                           **OVERP1 B**
      *
     C                     MOVE '0'       *IN70
     C                     WRITEHEADP1
     C                     MOVE '1'       *IN24
     C                     MOVE '1'       *IN25
     C                     MOVE '1'       *IN26
     C                     MOVE '1'       *IN27
     C                     MOVE '1'       *IN28
     C                     MOVE '1'       *IN29
     C                     MOVE '1'       *IN30
     C                     MOVE '1'       *IN31
     C                     MOVE '1'       *IN40
     C                     MOVE '1'       *IN41
     C                     MOVE '1'       *IN42
     C                     MOVE '1'       *IN43
      *
     C                     ENDSR                           **OVERP1 E**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * *PSSR    - DATA BASE ERROR SUBROUTINE                                  *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - BANK INVESTMENT POLICY LIST                                 *
      * MAIN     - BANK INVESTMENT POLICY LIST                                 *
      * PR01     - PRINT INSTRUMENT POLICY DETAILS                             *
      * PR02     - PRINT CURRENCY POLICY DETAILS                               *
      * PR03     - PRINT COUNTRY POLICY DETAILS                                *
      * PR04     - PRINT INDUSTRY POLICY DETAILS                               *
      * AU01     - AUDIT PROCESSING                                            *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           *PSSR     BEGSR                           ** *PSRR BSR**
     C**
     C** ROLL BACK CHANGES , DUMP AND RETURN TO THE CALLING PROGRAM
     C**
     C                     SETON                     LRU7U8
     C                     WRITEHEADAU
     C                     WRITEERRORAU
     C***********          WRITEENDAU                                     S01486
     C                     DUMP
     C                     RETRN
     C**
     C                     ENDSR                            ** *PSRR ESR**
     C*=========================================================================
**  CPY@
(c) Finastra International Limited 2001
