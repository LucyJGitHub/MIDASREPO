     H        1                                                           S01486
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Transfer report')                             *
     H***********                                                         S01486
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management Module                          *
     F*                                                               *
     F*  PM0340  - PORTFOLIO TRANSFER REPORT                          *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD061957           Date 26Oct23               *
      *  Prev Amend No. CSD103             Date 10Aug20               *
      *                 MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CGL165             Date 15Feb17               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 11Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CDL038             Date 10May05               *
      *                 237063             Date 20Nov05               *
      *                 CSE071             Date 19Jul05               *
      *                 BUG7411            Date 01Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 229544             Date 15Sep04               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CGL029             Date 01Sep03               *
      *                 222727             Date 05Nov03               *
      *                 CPK016             Date 03Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 179412             Date 14Jun01               *
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSE015             Date 06Dec99               *
      *                 CSE017             Date 20Oct99               *
      *                 CSE012             Date 16Aug99               *
      *                 154338             Date 04Feb99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CPL002             Date 08Mar99               *
      *                 CSD005             Date 02Mar99               *
      *                 CTI002 Exposure Management / TI Interface     *
     F*                 CFF004             DATE 11SEP96               *
     F*                 S71062             DATE 25JAN96               *
     F*                 CPM004             DATE 08FEB96               *
     F*                 095249             DATE 06NOV95               *
     F*                 094529             DATE 13OCT95               *
     F*                 085862             DATE 16MAR95               *
     F*                 S01486             DATE 31AUG94               *
     F*                 59998  ADI         DATE 27AUG93               *
     F*                 59581              DATE 17AUG93               *
     F*                 59473              DATE 11AUG93               *
     F*                 56555              DATE 08JUL93               *
     F*                 58162              DATE 01JUL93               *
     F*                 49914              DATE 22JAN93               *
     F*                 47840              DATE 26NOV92               *
     F*                 48219              DATE 19OCT92               *
     F*                 S01313             DATE 15JUN92               *
     F*                 B08196             DATE 25OCT91               *
     F*                 B08196             DATE 27AUG91               *
     F*                 B08108             DATE 22JUL91               *
     F*                 R10038             DATE 16SEP90               *
     F*                 R10010             DATE 15AUG90               *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  MD061957 - DLBHISPD contains 188 fields, whereas DEALSDB     *
      *             contains 194 fields.                              *
      *           - Recompile due to DLBHISPD changes.                *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *             (Recompile)                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c             *
      *           (Recompile)                                         *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  237063 - EU Tax fixes upgrade to MP build 103 (Recompile).   *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  BUG7411- CDL028 fields missing from DLGHISPD (Recompile)     *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  229544 - Inserted fields in DLCHISPD.                        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  CPK016 - Release 5 packaging.  Clash of field names.         *
      *  179412 - From and To portfolio not loaded correctly.         *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CSE015 - Forward Valued Depot Movements (Recompile)          *
      *  CSE017 - Cum/Ex Indicator on Depot Movements (Recompile)     *
      *  CSE012 - SE Depot Movement Narratives (Recompiled).          *
      *  154338 - Nominal amount has incorrect decimal places.  Use   *
      *           correct value (*KEY) for parameter passed to call   *
      *           access object AOCURRR0.                             *
      *  CPL002 - Midas-Plato Interface                               *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*  CFF004 - Increase in size of Price Fields                    *
     F*  S71062 - FF/PM interface                                     *
     F*           Re-activate FF coding                               *
     F*  CPM004 - Bank Portfolios (Recompiled due to change           *
     F*           in PF/PMTRSFPD)                                     *
     F*  095249 - Add branch for accounts                             *
     F*  094529 - Historic deals are now kept on DLBHISPD / DLCHISPD  *
     F*  085862 - INCLUDE BRANCH IN ACCOUNT IDENTIFIER                *
     F*  S01486 - Portfolio Management Upgrade to R10                 *
     F*  59998  - WRONG ACCESS ON FF TRANS FILE (MULTI MEMBER FILE)   *
     F*  59581  - YEAR & MONTH ARE ZEROES FOR OTC INSTRUMENTS -       *
     F*           ALTER STANDARD FF DEFINITION OUTPUT                 *
     F*  59473  - CORRECT OUTPUT OF PAGE TITLES                       *
     F*  56555  - TRANSFER OF POSITIONS                               *
     F*  58162  - CORRECT SECURITY INFORMATION OUTPUT                 *
     F*  49914  - ACCESS FIDUCIARY DETAILS FROM FIDEPOL0              *
     F*  48219  - CHANGE TO KEEP PM POSITIONS TO TRADE RETENTION DATE *
     F*  47840  - SHOW DETAILS CORRECTLY ON REPORT                    *
     F*  S01313 - PORTFOLIO PERFORMANCE CHANGES                       *
     F*  B08275 - DEALSPT ALTERED. REPLACE BY LF/DEALS AND LF/DLDEALL *
     F*  B08196 - ACCESS DEALSH FOR DETAILS OF HISTORIC DEALS         *
     F*  B08108 - REPLACE FILE FIDPLNPT BY FIDPLNP2                   *
     F*  R10038 - OUTPUT TEXT FOR FX DEAL IN DIFFERENT FORMAT         *
     F*                                                               *
     F*****************************************************************
     F*
     F*PMHPOSLLIF**E           K        DISK                              48219
     F****                                          KINFSR *PSSR          48219
     FPMPTRFLLIF  E           K        DISK                               56555
     F                                              KINFSR *PSSR          56555
     F**
     FSECTY   IF  E           K        DISK
     F                                              KINFSR *PSSR
     F**                                                                  58162
     FINVTP   IF  E           K        DISK                               58162
     F                                              KINFSR *PSSR          58162
     F** PREFIX '  ' **
     F**
     FTRADS   IF  E           K        DISK
     F                                              KINFSR *PSSR
     F** PREFIX '  ' **
     F**
     FDPTMV   IF  E           K        DISK
     F                                              KINFSR *PSSR
     F** PREFIX '  ' **
     F**
     F*RANS   IF  E           K        DISK                               59998
     F***TRANSPT*IF**E           K        DISK                   59998    S01486
     F************                                  KINFSR *PSSR          S01486
     FTRANSPT IF  E           K        DISK                               S71062
     F                                              KINFSR *PSSR          S71062
     F***PREFIX*'  '***                                                   S01486
     F***********                                                         S01486
     F***INTYP***IF  E           K        DISK                            S01486
     F***********                                   KINFSR *PSSR          S01486
     F***PREFIX*'  ' **                                                   S01486
     FINTYP   IF  E           K        DISK                               S71062
     F                                              KINFSR *PSSR          S71062
     F** PREFIX '  ' **                                                   S71062
     F**
     FDEALS   IF  E           K        DISK
     F            DEALSDAF                          KIGNORE
     F            DEALSDDF                          KIGNORE
     F            DEALSDEF                          KIGNORE
     F            DEALSDFF                          KIGNORE
     F                                              KINFSR *PSSR
     F** PREFIX '  ' **                                                   B08196
     F**                                                                  B08196
     FDEALSH  IF  E           K        DISK                               B08196
     F            DEALSDBF                          KRENAMEDEALSDBH       B08196
     F            DEALSDCF                          KRENAMEDEALSDCH       B08196
     F            DEALSDDF                          KIGNORE               B08196
     F            DEALSDEF                          KIGNORE               B08196
     F            DEALSDGF                          KRENAMEDEALSDGH       B08196
     F            DLDHISD0                          KIGNORE               094529
     F            DLEHISD0                          KIGNORE               094529
     F            DLGHISD0                          KIGNORE               094529
     F                                              KINFSR *PSSR          B08196
     F** PREFIX '  ' **
     F**
     F*IDPLNPTI***E***        K        DISK                               B08108
     F*IDPLNP2IF**E***        K        DISK                         B08275B08108
     F*IDPLNPTIF**E***        K        DISK                         B08275 49914
     F**FIDEPOL0IF  E           K        DISK                       49914 S01486
     F*********                                     KINFSR *PSSR          S01486
     F***PREFIX*'  ' **                                                   S01486
     F***********                                                         S01486
     F**SDDTSTPPIF  E           K        DISK                             S01486
     FFDDTSTL0IF  E           K        DISK                               S01486
     F                                              KINFSR *PSSR          S01486
     F***PREFIX*'  ' **                                                   S01486
     F**
     FCLOAN   IF  E           K        DISK
     F            CLOANHHF                          KIGNORE
     F            CLOANCKF                          KIGNORE
     F            CLOANZ1F                          KIGNORE
     F                                              KINFSR *PSSR
     F** PREFIX '  ' **
     F**
     F**SDLOANL1IF  E           K        DISK                             S01486
     F**********                                    KINFSR *PSSR          S01486
     F***PREFIX*'A4' **                                                   S01486
     F**
     FACCNT   IF  E           K        DISK
     F            ACCNTAAF                          KIGNORE
     F            ACCNTACF                          KIGNORE
     F                                              KINFSR *PSSR
     F** PREFIX '  ' **
     F**
     F**SDACODL0IF  E           K        DISK                             S01486
     F**********                                    KINFSR *PSSR          S01486
     F***PREFIX*'A5' **                                                   S01486
     F***********                                                         S01486
     F**SDBANKL1IF  E           K        DISK                             S01486
     F**********                                    KINFSR *PSSR          S01486
     F***PREFIX*'BJ' **                                                   S01486
     F***********                                                         S01486
     F**SDPORTPDIF  E           K        DISK                             S01486
     F**********                                    KINFSR *PSSR          S01486
     F***PREFIX*'P9' **                                                   S01486
     F**
     F**PMTRSFZZUF  E           K        DISK                             S01486
     FPMTRSFPAUF  E           K        DISK                               S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'P8' **
     F**
     F**SDCURRL0IF  E           K        DISK                             S01486
     F**********                                    KINFSR *PSSR          S01486
     F***PREFIX*'A6' **                                                   S01486
     F**
     F***PMACCCUSIF  E           K        DISK                            S01486
     FPMACCUL0IF  E           K        DISK                               S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'P8' **
     F**
     F**PM0340P1O   E             50     PRINTER                        UCS01486
     FPM0340P1O   E             50     PRINTER      KINFDS SPOOL      UC  S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'RR' **
     F**
     F**PM0340AUO   E                    PRINTER                        UCS01486
     FPM0340AUO   E                    PRINTER      KINFDS SPOOLU         S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'RR' **
     F**
     F******************************************************************
     F**                                                              **
     F**    F U N C T I O N   O F   I N D I C A T O R S               **
     F**                                                              **
     F******************************************************************
     F**  LR - END OF PROGRAM
     F**  U7 - PROGRAM ERROR
     F**  U8 - DATA BASE ERROR
     F**
     F**  01-03 - TO DETERMINE WHICH FORMAT HAS BEEN READ (LF/DEALS)
     F**  50    - OVERFLOW PRINTER FILE PM0340P1
     F**  60    - PRINTER FILE INDICATOR
     F**  65-69 - PRINTER FILE INDICATOR
     F**  71    - FILE PROCESSING
     F**  73    - FILE PROCESSING
     F**  74    - FILE PROCESSING
     F**  80    - WORK INDICATOR
     F**
     F**  90-99 - STANDARD SUBROUTINES
     F**
     F**               UNUSED INDICATORS
     F**               -----------------
     F**      ..  ..  ..  04  05  06  07  08  09  10
     F**      11  12  13  14  15  16  17  18  19  20
     F**      21  22  23  24  25  26  27  28  29  30
     F**      31  32  33  34  35  36  37  38  39  40
     F**      41  42  43  44  45  46  47  48  49  ..
     F**      51  52  53  54  55  56  57  58  59  ..
     F**      61  62  63  64  ..  ..  ..  68  ..  70
     F**      ..  72  ..  ..  75  76  77  78  79  ..
     F**      81  82  83  84  85  86  87  ..  89  ..                      S01486
     F**      ..  ..  ..  ..  ..  96  97  ..  ..
     F**
     F**
     F******************************************************************
     E**
      /COPY ZSRSRC,ZDATE2Z1
     E*
     E***********         CMD     1   1 39               QCMDEXC ARRAY    S01486
     E**
      /COPY ZSRSRC,ZSEDITZ1
     E** ARRAY FOR FORMATTING DL DETAILS FOR OUTPUT SR/ZFDLLN
     E                    ZLI        20  1
     E*
     E**   Array for copyright
     E                    CPY@    1   1 80               COPYRIGHT
     I********************************************************************
     I**
     ITRADSDF                                                                                 CPK016
     I              CRSK                            TDCRSK                                    CPK016
     I** IDENTIFICATION OF RECORD FORMATS OF LF/DEALS
     I**
     IDEALSDBF    01
     IDEALSDCF    02
     IDLBHISD0    01                                                      094529
     IDLCHISD0    02                                                      094529
     I***DEALSDGF****03                                                   S01486
     I**                                                                  B08196
     IDEALSDBH    01                                                      B08196
     IDEALSDCH    02                                                      B08196
     I***DEALSDGH****03                                            B08196 S01486
     ICLOANCLF                                                                                229544
     I              CRSK                            DLCRSK                                    229544
     I**
     I***RENAME*P8RECI*ON PMTRSFZZ                                        S01486
     I** RENAME P8RECI ON PMTRSFPA                                        S01486
     I**
     IPMTRSFZ0
     I              P8RECI                          PXRECI
     I*                                                                   CPL002
     IINVTPDF                                                             CPL002
     I*                                                                   CPL002
     I** Rename PLDPCD to avoid confusion with PLDPCD on PF/FDDTSTPD      CPL002
     I              PLDPCD                          INDPCD                CPL002
     I*                                                                   CPL002
     I**
     I** DATA STRUCTURE FOR SUBROUTINE ZSEDIT
     I**
      /COPY ZSRSRC,ZSEDITZ2
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     I**LDA        UDS                            256                     S01486
     I***********                           132 183 DBLOT                 S01486
     I***********                           132 141 DBFILE                S01486
     ILDA         DS                            256                       S01486
     I                                      134 183 DBLOT                 S01486
     I                                      134 141 DBFILE                S01486
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I**
     I** DATA STRUCTURE FOR USER ID
     I**
     IPSDS       SDS
     I                                      247 249 WSID
     I                                      254 263 USID
     ISDBANK    E DSSDBANKPD                                              S01486
     I** EXTERNAL DS FOR BANK DETAILS                                     S01486
     ISDLOAN    E DSSDLOANPD                                              S01486
     I** EXTERNAL DS FOR LOAN     DETAILS                                 S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01486
     ISDPORT    E DSSDPORTPD                                              S01486
     I** EXTERNAL DS FOR PORTOLIO ICD                                     S01486
     ISDACOD    E DSSDACODPD                                              S01486
     I** EXTERNAL DS FOR ACCOUNT CODES DETAILS                            S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, LONG  DATA STRUCTURE                S01486
     ISPOOL       DS                                                      S01486
     I                                       83  92 SFILE                 S01486
     I                                    B 123 1240SFNUM                 S01486
     ISPOOLU      DS                                                      S01486
     I                                       83  92 SFILEU                S01486
     I                                    B 123 1240SFNUMU                S01486
     I**
     I** DATA STRUCTURE FOR COMPILATION
     I**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * INDEX OF SUBROUTINES                                                   *
      * MAIN     - MAIN PROCESSING                                             *
      * #PAA     - TO INITIALIZE WORK FIELDS AND ACCESS STANDING DATA          *
      * #PA01    - TO PRINT AUDIT REPORT                                       *
      * #PR01    - FORMAT DETAILS FOR OUTPUT                                   *
      * #PR02    - DETERMINE TYPE OF TRANSFER                                  *
      * #PR03    - PROCESS SE DETAILS                                          *
      * #PR04    - PROCESS FF DETAILS                                          *
      * #PR05    - PROCESS DL DETAILS                                          *
      * #PR06    - PROCESS LE DETAILS                                          *
      * #PR07    - PROCESS RE DETAILS                                          *
      * #PR08    - PROCESS SE POSITION DETAILS                                 *
      * #PR09    - PORCESS SE TRADES AND DEPOT MOVEMENT DETAILS                *
      * #PR10    - PROCESS FX DEALS                                            *
      * #PR11    - PROCESS MM DEALS                                            *
      * #PR12    - PROCESS FRA/IRS DEALS                                       *
      **#PR13****- PROCESS FIDUCIARY DETAILS                              S01486
      **#PR14****- PROCESS FIDUCIARY DEPOSITS                             S01486
      **#PR15****- PROCESS FIDUCIARY LOANS                                S01486
      * #AU01    -                                                             *
      * #RSET    - RESET PRINTER FILE FIELDS                                   *
      * ZSEDIT   - TO EDIT A NUMBER WITH DECIMAL POINT                         *
      * ZFDLLN   - TO PROCESS NARRATIVE FOR DEALS                              *
      * ZFSELN   - TO PROCESS NARRATIVE FOR TRADES                             *
      * ZFFFLN   - TO PROCESS NARRATIVE FOR FF                                 *
      * ZFLELN   - TO PROCESS NARRATIVE FOR LOANS                              *
      * ZFRELN   - TO PROCESS NARRATIVE FOR RETAILS                            *
      * ZDATE2   - TO CONVERT A MIDAS DATE IN 6 ALPHA                          *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * EXTERNAL ROUTINES CALLED                                               *
      * QCMDEXC  - SYSTEM PROGRAM TO EXECUTE SOME CL FUNCTIONS                 *
      *                                                                        *
      **************************************************************************
     C******************************************************************
     C**                                                              **
     C**              C A L C U L A T I O N S                         **
     C**                                                              **
     C******************************************************************
     C**
     C** ENTRY OF PARAMETERS
     C**
     C           *ENTRY    PLIST
     C                     PARM           WWMODE  1
     C                     PARM           RSEQ    5                       S01486
     C***********          PARM           WWACOF  4                       S01486
     C***********          PARM           WWPNP8  6                       S01486
     C***********          PARM           WWPORF  4                       S01486
     C**
     C** KEY LISTS
     C**
     C           PMDEAL    KLIST
     C                     KFLD           DTYP
     C                     KFLD           DLST
     C**
     C***********PMLOAN****KLIST                                                              CLE042
     C*********************KFLD           LTYP                                                CLE042
     C*********************KFLD           SUTP                                                CLE042
     C**
     C           PMACCN    KLIST
     C                     KFLD           P8CNUM
     C                     KFLD           P8CCY
     C                     KFLD           P8ACOD
     C                     KFLD           P8ACSQ
     C                     KFLD           P8BRCA                          095249
     C**
     C****       PMHPOS    KLIST                                          48219
     C****                 KFLD           P8CNUM                          48219
     C****                 KFLD           P8FPTF                          48219
     C****                 KFLD           P8SESN                          48219
     C**
     C           PMDPOS    KLIST                                          56555
     C                     KFLD           P8CNUM                          56555
     C                     KFLD           P8FPTF                          56555
     C                     KFLD           P8SESN                          56555
     C**
     C           PMDPTM    KLIST
     C                     KFLD           P8SESN
     C                     KFLD           WWTRNB  6
     C**
     C           PMFIDL    KLIST
     C                     KFLD           P8CNUM
     C                     KFLD           P8FPTF
     C                     KFLD           WWRECI  1                       B08275
     C                     KFLD           P8TRNB
     C**                                                                  58162
     C           PMINVT    KLIST                                          58162
     C                     KFLD           WWCCYI  3                       58162
     C                     KFLD           WWINVT  3                       58162
     C**
     C*************************************
     C** PROGRAM START - MAIN PROCESSING **
     C*************************************
     C**
      ***  Copyright Statement.                                           S01486
     C                     MOVEACPY@      CPY2@  80
     C                     EXSR #PAA
     C**
     C                     EXSR #PA01
     C**
     C** AUDIT PROCESSING
     C**
     C                     EXSR #AU01
     C**
     C                     MOVE '1'       *INLR
     C                     RETRN
     C**
     C** *******************************
     C** ** PROGRAM END               **
     C** *******************************
     C**
     C*********************************************************************
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PAA     - TO INITIALIZE WORK FIELDS AND ACCESS STANDING DATA          *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWACOD   - ACOUNT  CODE                                                *
      * WWTRAN   - TRANSACTION NUMBER                                          *
      * WWSPRT   - PRINTER LOCATION CODE                                       *
      * WWCODA   - ACCOUNT OFFICER CODE                                        *
      * WWCUSR   - CUSTOMER NUMBER                                             *
      * WWREAD   - NUMBER OF RECORDS READ                                      *
      * WWCMD    - COMMAND                                                     *
      * WWPRTL   - PRINTER LOCATION CODE                                       *
      *                                                                        *
      **************************************************************************
     C           #PAA      BEGSR
     C*
     C** INITIALIZE WORK FIELDS
     C**
     C**********           MOVEL*BLANKS   WWACOD  4                                           CGL029
     C                     MOVEL*BLANKS   WWACOD 10                                           CGL029
     C                     MOVEL*BLANKS   WWTRAN  6
     C                     MOVEL*BLANKS   WWSPRT  3
     C                     MOVEL*BLANKS   WWCODA  2
     C**********           Z-ADD0         WWCUSR  60                                          CSD027
     C                     MOVE *BLANKS   WWCUSR  6                                           CSD027
     C                     Z-ADD0         WWREAD  50
     C**
     C** PREPARE FIELD ZECODE FOR SUBROUTINE ZSEDIT
     C**
     C                     MOVEL'J'       ZECODE
     C** PREPARE LDA
     C*
     C           *NAMVAR   DEFN           LDA                             S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'PM0340'  DBPGM
     C                     OUT  LDA                                       S01486
     C*
     C** GET INSTALLATION CONTROL DATA RECORD 1
     C*
     C***********          READ SDBANKL1                 71               S01486
     C************IN71     IFEQ '1'                                       S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*MSG   ' WWRTCD  7                       S01486
     C                     PARM '*FIRST ' WWOPTN  7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C*                                                    ***************
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                        ***************S01486
     C                     Z-ADD1         DBASE            **DB ERROR 01**
     C***********          MOVEL'SDBANKL1'DBFILE           ***************S01486
     C                     MOVE 'SDBANKPD'DBFILE           ***************S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     ELSE
     C*
     C* LOAD RUNA  AND TITLE
     C*
     C                     MOVELBJMRDT    RRRUNA
     C                     MOVELBJURPT    RRTITL
     C**
     C           BJDFIN    IFEQ 'M'
     C                     MOVE '1'       *IN98
     C                     END
     C*
     C                     END
     C*
     C** GET PM INSTALLATION CONTROL DATA
     C*
     C***********          READ SDPORTPD                 71               S01486
     C************IN71     IFEQ '1'                                       S01486
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM '*MSG   ' WWRTCD  7                       S01486
     C                     PARM '*FIRST ' WWOPTN  7                       S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C*
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          Z-ADD1         DBASE            ***************S01486
     C                     Z-ADD2         DBASE            **DB ERROR 02**S01486
     C***********          MOVEL'SDPORTPD'DBFILE           ***************S01486
     C                     MOVE 'SDPORTPD'DBFILE                          S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C*
     C***********                                                         S01486
     C***BUILT*COMMAND EXPRESSION FOR QCMDEXEC                            S01486
     C***********                                                         S01486
     C***********          MOVELCMD,1     WWCMD  43                       S01486
     C***********          MOVE ')'       WWPRTL  4                       S01486
     C**
     C** INITIALIZE WWSPRT
     C**
     C***********          MOVE *LOVAL    WWSPRT  3                       S01486
     C                     MOVE RSEQ      SEQ                             S01486
     C*                                                                   S01486
     C**  ENSURE AUDIT SPOOL FILE RECORDED BY RCF                         S01486
     C*                                                                   S01486
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01486
     C*                                                                   S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ                             S01486
     C                     PARM *BLANKS   SENTY                           S01486
     C                     PARM           SFILEU                          S01486
     C                     PARM           ZSNUMU                          S01486
     C                     PARM *BLANK    ZSERR                           S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C*                                                                   S01486
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01486
     C*                                                                   S01486
     C                     SETON                     U7U8LR               S01486
     C                     RETRN                                          S01486
     C                     END                                            S01486
     C**
     C                     ENDSR
     C**
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PA01    - TO PRINT AUDIT REPORT                                       *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #PR01    - FORMAT DETAILS FOR OUTPUT                                   *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWSPRT   - PRINTER LOCATION CODE                                       *
      * WWCUSR   - CUSTOMER NUMBER                                             *
      *                                                                        *
      **************************************************************************
     C           #PA01     BEGSR
     C**
     C***********          READ PMACCCUS                 71               S01486
     C                     READ PMACCUL0                 71               S01486
     C***********          MOVELAZPRTL    WWSPRT                          S01486
     C**********           Z-ADDP8CNUM    WWCUSR                                              CSD027
     C                     MOVE P8CNUM    WWCUSR                                              CSD027
     C           *IN71     IFEQ '0'                                       S01486
     C                     OPEN PM0340P1                                  S01486
     C*                                                                   S01486
     C**  ENSURE REPORT SPOOL FILE RECORDED BY RCF                        S01486
     C*                                                                   S01486
     C                     Z-ADDSFNUM     ZSNUM   60                      S01486
     C*                                                                   S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ     5                       S01486
     C                     PARM *BLANKS   SENTY   3                       S01486
     C                     PARM           SFILE                           S01486
     C                     PARM           ZSNUM                           S01486
     C                     PARM           ZSERR   1                       S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C*                                                                   S01486
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01486
     C*                                                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     SETON                     U7U8LR               S01486
     C                     RETRN                                          S01486
     C                     END                                            S01486
     C                     ELSE                                           S01486
     C                     MOVE '1'       *IN88                           S01486
     C                     GOTO END01                                     S01486
     C                     END                                            S01486
     C**
     C           *IN71     DOWEQ'0'
     C**
     C** ON OVERFLOW CHANGE PAGE -PRINT HEADER
     C**
     C           *IN50     IFEQ '1'
     C***********AZPRTL    ANDEQWWSPRT                              59473 S01486
     C           AZACOC    ANDEQWWCODA                                    59473
     C                     WRITEHEADER
     C                     WRITEHEADR1
     C                     WRITEHEADR2
     C                     WRITEHEADR3
     C                     MOVE '0'       *IN50
     C                     END
     C**
     C                     EXSR #PR01
     C**
     C***********          READ PMACCCUS                 71               S01486
     C                     READ PMACCUL0                 71               S01486
     C**
     C                     END
     C***********                                                         S01486
     C***********WWREAD    IFEQ *ZERO                                     S01486
     C***********          MOVEL'1  '     WWPRTL                          S01486
     C***********          MOVE WWPRTL    WWCMD                           S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM WWCMD     QCAA   43                       S01486
     C***********          PARM 43        QCAN   155                      S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C***********          OPEN PM0340P1                                  S01486
     C***********          WRITEHEADER                                    S01486
     C***********          WRITERRNDET                                    S01486
     C***********          END                                            S01486
     C**
     C                     WRITEENDRE
     C                     CLOSEPM0340P1                                  S01486
     C**
     C***********          ENDSR                                          S01486
     C           END01     ENDSR                                          S01486
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PR01    - FORMAT DETAILS FOR OUTPUT                                   *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * QCMDEXC  - SYSTEM PROGRAM TO EXECUTE SOME CL FUNCTIONS                 *
      * #PR02    - DETERMINE TYPE OF TRANSFER                                  *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PA01    - TO PRINT AUDIT REPORT                                       *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWREAD   - NUMBER OF RECORDS READ                                      *
      * WWPRTL   - PRINTER LOCATION CODE                                       *
      * WWCMD    - COMMAND                                                     *
      * WWSPRT   - PRINTER LOCATION CODE                                       *
      * WWCUSR   - CUSTOMER NUMBER                                             *
      * WWCODA   - ACCOUNT OFFICER CODE                                        *
      *                                                                        *
      **************************************************************************
     C           #PR01     BEGSR
     C***********                                                         S01486
     C***IF*IT*IS THE FIRST RECORD READ                                   S01486
     C***OPEN*PRINTER FILE                                                S01486
     C***********                                                         S01486
     C           WWREAD    IFEQ 0                                         S01486
     C***********                                                         S01486
     C***OVERRIDE TO PRINTER FILE PM0340PXXX (XXX = PRINTER LOCATION CODE)S01486
     C***********                                                         S01486
     C***********          MOVELAZPRTL    WWPRTL                          S01486
     C***********          MOVE WWPRTL    WWCMD                           S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM WWCMD     QCAA   43                       S01486
     C***********          PARM 43        QCAN   155                      S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C***********          OPEN PM0340P1                                  S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********AZPRTL    IFNE WWSPRT                                    S01486
     C***********                                                         S01486
     C***PRINT*END OF REPORT                                              S01486
     C***********                                                         S01486
     C***********          WRITEENDRE                                     S01486
     C***********                                                         S01486
     C***SAVE*NEW PRINTER LOCATION CODE READ                              S01486
     C***********                                                         S01486
     C***********          MOVELAZPRTL    WWSPRT                          S01486
     C***********                                                         S01486
     C***ON*EACH*CHANGE OF A/C OFFICER LOCATION CODE                      S01486
     C***CLOSE*PRINTER FILE AND OVERRIDE A NEW ONE                        S01486
     C***********                                                         S01486
     C***********          CLOSEPM0340P1                                  S01486
     C***********                                                         S01486
     C***********          MOVELAZPRTL    WWPRTL                          S01486
     C***********          MOVE WWPRTL    WWCMD                           S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM WWCMD     QCAA   43                       S01486
     C***********          PARM 43        QCAN   155                      S01486
     C***********                                                         S01486
     C***OPEN*PRINTER FILE                                                S01486
     C***********                                                         S01486
     C***********          OPEN PM0340P1                                  S01486
     C**
     C** PREPARE HEADER AND PRINT IT
     C**
     C                     MOVELAZACON    RRACON
     C                     MOVELBBCRNM    RRCRNM
     C                     MOVELAZACOC    RRACOC
     C                     MOVELP8CNUM    RRCNUM
     C**
     C                     WRITEHEADER
     C                     WRITEHEADR1
     C                     WRITEHEADR2
     C                     WRITEHEADR3
     C**
     C** LOAD NEW DATA
     C**
     C**********           Z-ADDP8CNUM    WWCUSR                                              CSD027
     C                     MOVE P8CNUM    WWCUSR                                              CSD027
     C                     MOVELAZACOC    WWCODA
     C                     MOVE '0'       *IN50
     C**
     C                     ELSE
     C**
     C** FOR EACH CHANGE OF A/C OFFICER CODE START NEW PAGE
     C**
     C           AZACOC    IFNE WWCODA
     C**
     C** SAVE NEW OFFICER CODE
     C**
     C                     MOVELAZACOC    WWCODA
     C**
     C** CHANGE PAGE
     C**
     C                     MOVE '1'       *IN50
     C**
     C**
     C** PREPARE HEADER AND PRINT IT
     C**
     C                     MOVELAZACON    RRACON
     C                     MOVELBBCRNM    RRCRNM
     C                     MOVELAZACOC    RRACOC
     C                     MOVELP8CNUM    RRCNUM
     C**
     C                     WRITEHEADER
     C                     WRITEHEADR1
     C                     WRITEHEADR2
     C                     WRITEHEADR3
     C**
     C                     MOVE '0'       *IN50
     C**********           Z-ADDP8CNUM    WWCUSR                                        59473 CSD027
     C                     MOVE P8CNUM    WWCUSR                                              CSD027
     C**
     C                     ELSE
     C           P8CNUM    IFNE WWCUSR
     C**
     C** SAVE NEW CUSTOMER NUMBER
     C**
     C**********           Z-ADDP8CNUM    WWCUSR                                              CSD027
     C                     MOVE P8CNUM    WWCUSR                                              CSD027
     C** PREPARE HEADER
     C                     MOVELP8CNUM    RRCNUM
     C                     MOVELBBCRNM    RRCRNM
     C**
     C** IF CUSTOMER NUMBER CHANGED SIMPLY PRINT CUSTOMER NUMBER
     C**
     C                     WRITEHEADR2
     C**
     C                     END
     C**
     C                     END
     C**
     C                     END
     C**
     C** ADD 1 TO THE NUMBER OF RECORDS READ
     C**
     C                     ADD  1         WWREAD
     C**
     C                     EXSR #PR02
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PR02    - DETERMINE TYPE OF TRANSFER                                  *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #PR03    - PROCESS SE DETAILS                                          *
      **#PR04****- PROCESS FF DETAILS                                     S01486
      * #PR04    - PROCESS FF DETAILS                                     S71062
      * #PR05    - PROCESS DL DETAILS                                          *
      * #PR06    - PROCESS LE DETAILS                                          *
      * #PR07    - PROCESS RE DETAILS                                          *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PR01    - FORMAT DETAILS FOR OUTPUT                                   *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #PR02     BEGSR
     C**
     C** TEST THE MODULE ID TO PROCESS THE GOOD SUBROUTINE
     C**
     C           P8MODI    IFEQ 'SE'
     C                     EXSR #PR03
     C                     ELSE
     C***********P8MODI    IFEQ 'FF'                                      S01486
     C***********          EXSR #PR04                                     S01486
     C***********          ELSE                                           S01486
     C           P8MODI    IFEQ 'FF'                                      S71062
     C                     EXSR #PR04                                     S71062
     C                     ELSE                                           S71062
     C           P8MODI    IFEQ 'DL'
     C                     EXSR #PR05
     C                     ELSE
     C           P8MODI    IFEQ 'LE'
     C                     EXSR #PR06
     C                     ELSE
     C           P8MODI    IFEQ 'RE'
     C                     EXSR #PR07
     C***********          ELSE                                           S01486
     C***********P8MODI    IFEQ 'FD'                                      S01486
     C***********P8MODI    OREQ 'FL'                                      S01486
     C***********          EXSR #PR13                                     S01486
     C***********          END                                            S01486
     C***********          END                                            S01486
     C                     END
     C                     END
     C                     END
     C                     END                                            S71062
     C                     END
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PR03    - PROCESS SE DETAILS                                          *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #PR08    - PROCESS SE POSITION DETAILS                                 *
      * #PR09    - PORCESS SE TRADES AND DEPOT MOVEMENT DETAILS                *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PR02    - DETERMINE TYPE OF TRANSFER                                  *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #PR03     BEGSR
     C**
     C** TEST THE POSITION/TRANSACTION INDICATOR
     C**
     C           P8POTI    IFEQ 'P'                                 48219 56555
     C                     EXSR #PR08                               48219 56555
     C                     ELSE                                     48219 56555
     C           P8POTI    IFEQ 'D'
     C           P8POTI    OREQ 'T'
     C                     EXSR #PR09
     C                     END
     C                     END                                      48219 56555
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      ***/EJECT**                                                         S01486
      ********************************************************************S01486
      ***********                                                         S01486
      **#PR04****- PROCESS FF DETAILS                                     S01486
      ***********                                                         S01486
      **SUBROUTINE CALLS:                                                 S01486
      **#RSET****- RESET PRINTER FILE FIELDS                              S01486
      ***PSSR****- TO PROCESS DATA BASE ERRORS                            S01486
      **ZSEDIT***- TO EDIT A NUMBER WITH DECIMAL POINT                    S01486
      **ZFFFLN***- TO PROCESS NARRATIVE FOR FF                            S01486
      ***********                                                         S01486
      **SUBROUTINE CALLED FROM:                                           S01486
      **#PR02****- DETERMINE TYPE OF TRANSFER                             S01486
      ***********                                                         S01486
      **ROUTINE*USES VARIABLES:                                           S01486
      ***********                                                         S01486
      ********************************************************************S01486
     C***********#PR04     BEGSR                                          S01486
     C***********                                                         S01486
     C***RESET*FIELDS                                                     S01486
     C***********                                                         S01486
     C***********          EXSR #RSET                                     S01486
     C***********                                                         S01486
     C***********TRANSK    KLIST                                   59998  S01486
     C***********          KFLD           P8CNUM                   59998  S01486
     C***********          KFLD           P8TPTF                   59998  S01486
     C***********          KFLD           P8TRNB                   59998  S01486
     C***********P8TRNB    CHAINTRANS                73            59998  S01486
     C***********TRANSK    CHAINTRANSPT              73            59998  S01486
     C***********                                                         S01486
     C************IN73     IFEQ '1'                                       S01486
     C***********                                          ***************S01486
     C***********          Z-ADD2         DBASE            **DB ERROR 02**S01486
     C***********          MOVEL'TRANS   'DBFILE           ***************59998
     C***********          MOVE P8TRNB    DBKEY                    59998  S01486
     C***********          MOVEL'TRANSPT 'DBFILE                   59998  S01486
     C***********          MOVEL*BLANKS   WKKEY  50                59998  S01486
     C***********          MOVELP8TRNB    WKKEY                    59998  S01486
     C***********          MOVELP8CNUM    ACNUM   6                59998  S01486
     C***********WKKEY     CAT  ACNUM:1   WKKEY                    59998  S01486
     C***********WKKEY     CAT  P8TPTF:1  WKKEY                    59998  S01486
     C***********          MOVELWKKEY     DBKEY                    59998  S01486
     C***********          EXSR *PSSR                                     S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********ISTT      CHAININTYP                73                   S01486
     C***********                                                         S01486
     C***********          MOVELISTN      RRDES1                          S01486
     C***********          MOVELISCY      RRCCY1                          S01486
     C***********                                                         S01486
     C***EDIT*NUMBER OF CONTRACTS                                         S01486
     C***********                                                         S01486
     C***********          Z-ADDNUCO      ZFLD15                          S01486
     C***********          Z-ADD0         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVELZOUT21    RRAMO1                          S01486
     C***********                                                         S01486
     C***TRANSACTION NUMBER AND INDICATOR                                 S01486
     C***********                                                         S01486
     C***********          MOVE P8TRNB    RRTRNB                          S01486
     C***********          MOVELTRTY      RRIND1                          S01486
     C***********                                                         S01486
     C***FORMAT*FF LINE DESCRIPTION BY THE MEAN OF                        S01486
     C***STANDARD SUBROUTINE ZFFFLN                                       S01486
     C***PREPARE*PARAMETERS FOR SUBROUTINE                                S01486
     C***********                                                         S01486
     C***********          MOVELISCY      ZISCY                           S01486
     C***********          Z-ADDMTHN      ZMTHN                           S01486
     C***********          Z-ADDYRNO      ZYRNO                           S01486
     C***********          MOVELPCAL      ZPCAL                           S01486
     C***********          Z-ADDSTRP      ZSTRP                           S01486
     C***********                                                         S01486
     C***********          EXSR ZFFFLN                                    S01486
     C***********                                                         S01486
     C***LOAD*OUTPUT FROM SUBROUTINE                                      S01486
     C***********                                                         S01486
     C***********          MOVELZLIN      RRDES2                          S01486
     C***********                                                         S01486
     C***LOAD*FROM AND TO PORTFOLIO                                       S01486
     C***********                                                         S01486
     C***********P8FPTF    IFEQ '9997'                                    S01486
     C***********          MOVE P9R997    RRFPTF                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVELP8FPTF    RRFPTF                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********P8TPTF    IFEQ '9997'                                    S01486
     C***********          MOVE P9R997    RRTPTF                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVELP8TPTF    RRTPTF                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          MOVEL'FF'      RRMODI                          S01486
     C***********                                                         S01486
     C***WRITE*RESULTS                                                    S01486
     C***********                                                         S01486
     C***********P8DTCL    IFEQ 'Y'                                       S01486
     C***********          MOVE '1'       *IN66                           S01486
     C***********          ELSE                                           S01486
     C***********P8TBPR    IFEQ 'N'                                       S01486
     C***********P8RECI    ORNE 'D'                                       S01486
     C***********          MOVE '1'       *IN67                           S01486
     C***********          END                                            S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          WRITERRDET1                                    S01486
     C***********          WRITERRDET2                                    S01486
     C***********                                                         S01486
     C***********          MOVE '0'       *IN66                           S01486
     C***********          MOVE '0'       *IN67                           S01486
     C***********          MOVE '0'       *IN69                           S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C***********                                                         S01486
     C********************************************************************S01486
      /EJECT                                                              S71062
      ********************************************************************S71062
      *                                                                   S71062
      * #PR04    - PROCESS FF DETAILS                                     S71062
      *                                                                   S71062
      * SUBROUTINE CALLS:                                                 S71062
      * #RSET    - RESET PRINTER FILE FIELDS                              S71062
      * *PSSR    - TO PROCESS DATA BASE ERRORS                            S71062
      * ZSEDIT   - TO EDIT A NUMBER WITH DECIMAL POINT                    S71062
      * ZFFFLN   - TO PROCESS NARRATIVE FOR FF                            S71062
      *                                                                   S71062
      * SUBROUTINE CALLED FROM:                                           S71062
      * #PR02    - DETERMINE TYPE OF TRANSFER                             S71062
      *                                                                   S71062
      * ROUTINE USES VARIABLES:                                           S71062
      *                                                                   S71062
      ********************************************************************S71062
     C           #PR04     BEGSR                                          S71062
     C**                                                                  S71062
     C** RESET FIELDS                                                     S71062
     C**                                                                  S71062
     C                     EXSR #RSET                                     S71062
     C**                                                                  S71062
     C           TRANSK    KLIST                                          S71062
     C                     KFLD           P8CNUM                          S71062
     C                     KFLD           P8TPTF                          S71062
     C**********           KFLD           P8TRNB                                       S71062 CLE148
     C                     KFLD           WTRNB2  60                                          CLE148
     C                     MOVELP8TRNB    WTRNB2                                              CLE148
     C           TRANSK    CHAINTRANSPT              73                   S71062
     C**                                                                  S71062
     C           *IN73     IFEQ '1'                                       S71062
     C           *LOCK     IN   LDA                                       S71062
     C*                                                    ***************S71062
     C                     Z-ADD2         DBASE            **DB ERROR 02**S71062
     C                     MOVEL'TRANSPT 'DBFILE           ***************S71062
     C                     MOVEL*BLANKS   WKKEY  50                       S71062
     C                     MOVELP8TRNB    WKKEY                           S71062
     C                     MOVELP8CNUM    ACNUM   6                       S71062
     C           WKKEY     CAT  ACNUM:1   WKKEY                           S71062
     C           WKKEY     CAT  P8TPTF:1  WKKEY                           S71062
     C                     MOVELWKKEY     DBKEY                           S71062
     C                     OUT  LDA                                       S71062
     C                     EXSR *PSSR                                     S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C           ISTT      CHAININTYP                73                   S71062
     C**                                                                  S71062
     C                     MOVELISTN      RRDES1                          S71062
     C                     MOVELISCY      RRCCY1                          S71062
     C**                                                                  S71062
     C** EDIT NUMBER OF CONTRACTS                                         S71062
     C**                                                                  S71062
     C                     Z-ADDNUCO      ZFLD15                          S71062
     C                     Z-ADD0         ZDECS                           S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVELZOUT21    RRAMO1                          S71062
     C**                                                                  S71062
     C** TRANSACTION NUMBER AND INDICATOR                                 S71062
     C**                                                                  S71062
     C                     MOVE P8TRNB    RRTRNB                          S71062
     C                     MOVELTRTY      RRIND1                          S71062
     C**                                                                  S71062
     C** FORMAT FF LINE DESCRIPTION BY THE MEAN OF                        S71062
     C** STANDARD SUBROUTINE ZFFFLN                                       S71062
     C** PREPARE PARAMETERS FOR SUBROUTINE                                S71062
     C**                                                                  S71062
     C                     MOVELISCY      ZISCY                           S71062
     C                     Z-ADDMTHN      ZMTHN                           S71062
     C                     Z-ADDYRNO      ZYRNO                           S71062
     C                     MOVELPCAL      ZPCAL                           S71062
     C                     Z-ADDSTRP      ZSTRP                           S71062
     C**                                                                  S71062
     C                     EXSR ZFFFLN                                    S71062
     C**                                                                  S71062
     C** LOAD OUTPUT FROM SUBROUTINE                                      S71062
     C**                                                                  S71062
     C                     MOVELZLIN      RRDES2                          S71062
     C**                                                                  S71062
     C** LOAD FROM AND TO PORTFOLIO                                       S71062
     C**                                                                  S71062
     C           P8FPTF    IFEQ '9997'                                    S71062
     C                     MOVE FCR997    RRFPTF                          S71062
     C                     ELSE                                           S71062
     C                     MOVELP8FPTF    RRFPTF                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C           P8TPTF    IFEQ '9997'                                    S71062
     C                     MOVE FCR997    RRTPTF                          S71062
     C                     ELSE                                           S71062
     C                     MOVELP8TPTF    RRTPTF                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C                     MOVEL'FF'      RRMODI                          S71062
     C**                                                                  S71062
     C** WRITE RESULTS                                                    S71062
     C**                                                                  S71062
     C           P8DTCL    IFEQ 'Y'                                       S71062
     C                     MOVE '1'       *IN66                           S71062
     C                     ELSE                                           S71062
     C           P8TBPR    IFEQ 'N'                                       S71062
     C           P8RECI    ORNE 'D'                                       S71062
     C                     MOVE '1'       *IN67                           S71062
     C                     END                                            S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C                     WRITERRDET1                                    S71062
     C                     WRITERRDET2                                    S71062
     C**                                                                  S71062
     C                     MOVE '0'       *IN66                           S71062
     C                     MOVE '0'       *IN67                           S71062
     C                     MOVE '0'       *IN69                           S71062
     C**                                                                  S71062
     C                     ENDSR                                          S71062
     C**                                                                  S71062
     C********************************************************************S71062
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PR05    - PROCESS DL DETAILS                                          *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #RSET    - RESET PRINTER FILE FIELDS                                   *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      * #PR10    - PROCESS FX DEALS                                            *
      * #PR11    - PROCESS MM DEALS                                            *
      * #PR12    - PROCESS FRA/IRS DEALS                                       *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PR02    - DETERMINE TYPE OF TRANSFER                                  *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #PR05     BEGSR
     C**
     C** RESET FIELDS
     C**
     C                     EXSR #RSET
     C**
     C** LOAD FROM AND TO PORTFOLIO
     C*
     C           P8FPTF    IFEQ '9997'
     C***********          MOVE P9R997    RRFPTF                          S01486
     C                     MOVE FCR997    RRFPTF                          S01486
     C                     ELSE
     C                     MOVELP8FPTF    RRFPTF
     C                     END
     C*
     C           P8TPTF    IFEQ '9997'
     C***********          MOVE P9R997    RRFPTF                          S01486
     C**********           MOVE FCR997    RRFPTF                   S01486 179412
     C                     MOVE FCR997    RRTPTF                          179412
     C                     ELSE
     C                     MOVELP8TPTF    RRTPTF
     C                     END
     C**
     C** LOAD MODULE ID
     C**
     C                     MOVEL'DL'      RRMODI
     C**
     C********** P8TRNB    CHAINDEALS                73                                       CLE148
     C                     MOVE P8TRNB    DLNO                                                CLE148
     C           DLNO      CHAINDEALS                73                                       CLE148
     C**
     C** RECORD NOT FOUND CHECK IF HISTORIC DEAL
     C           *IN73     IFEQ '1'
     C*                                                                   B08196
     C********** P8TRNB    CHAINDEALSH               73                                B08196 CLE148
     C                     MOVE P8TRNB    DLNO                                                CLE148
     C           DLNO      CHAINDEALSH               73                                       CLE148
     C**                                                                  B08196
     C           *IN73     IFEQ '1'                                       B08196
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD3         DBASE            **DB ERROR 03**
     C***********          MOVEL'DEALS   'DBFILE           ***************S01486
     C                     MOVE 'DEALS   'DBFILE           ***************S01486
     C                     MOVE P8TRNB    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C                     END                                            B08196
     C**
     C***********PMDEAL    CHAINSDDTSTPP             73                   S01486
     C           PMDEAL    CHAINFDDTSTL0             73                   S01486
     C**
     C           *IN01     IFEQ '1'                                       R10038
     C***********          MOVELP7DTNR    WWWK16 16                R10038 S01486
     C                     MOVELNARR11    WWWK16 16                       S01486
     C                     MOVE *BLANKS   RRDES1                          R10038
     C                     MOVELPUCY      RRDES1                          R10038
     C                     MOVE WWWK16    RRDES1                          R10038
     C                     ELSE                                           R10038
     C***********          MOVELP7DTNR    RRDES1                          S01486
     C                     MOVELNARR11    RRDES1                          S01486
     C                     END                                            R10038
     C**
     C** DETECT WHICH FORMAT HAS BEEN READ FROM DEALS
     C**
     C           *IN01     IFEQ '1'
     C                     MOVE '0'       *IN01
     C                     EXSR #PR10
     C                     ELSE
     C           *IN02     IFEQ '1'
     C                     MOVE '0'       *IN02
     C                     EXSR #PR11
     C                     ELSE
     C************IN03     IFEQ '1'                                       S01486
     C***********          MOVE '0'       *IN03                           S01486
     C***********          EXSR #PR12                                     S01486
     C***********          END                                            S01486
     C                     END
     C                     END
     C**
     C           P8DTCL    IFEQ 'Y'
     C                     MOVE '1'       *IN66
     C                     ELSE
     C           P8TBPR    IFEQ 'N'
     C           P8RECI    ORNE 'D'
     C                     MOVE '1'       *IN67
     C                     END
     C                     END
     C**
     C                     WRITERRDET1
     C                     WRITERRDET2
     C**
     C                     MOVE '0'       *IN66
     C                     MOVE '0'       *IN67
     C                     MOVE '0'       *IN69
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PR06    - PROCESS LE DETAILS                                          *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #RSET    - RESET PRINTER FILE FIELDS                                   *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      * ZSEDIT   - TO EDIT A NUMBER WITH DECIMAL POINT                         *
      * ZFLELN   - TO PROCESS NARRATIVE FOR LOANS                              *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PR02    - DETERMINE TYPE OF TRANSFER                                  *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #PR06     BEGSR
     C**
     C** RESET FIELDS
     C**
     C                     EXSR #RSET
     C**
     C           P8TRNB    CHAINCLOAN                73
     C**
     C           *IN73     IFEQ '1'
     C*                                                    ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD4         DBASE            **DB ERROR 04**
     C***********          MOVEL'CLOAN   'DBFILE           ***************S01486
     C                     MOVE 'CLOAN   'DBFILE           ***************S01486
     C                     MOVE P8TRNB    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C***********PMLOAN    CHAINSDLOANL1             73                   S01486
     C                     CALL 'AOLOANR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM LTYP      WWLTYP  2                       S01486
     C                     PARM SUTP      WWSTYP  2                       S01486
     C                     PARM CLAS      WWCLAS  4                                           CLE042
     C           SDLOAN    PARM SDLOAN    DSSDY                           S01486
     C**
     C** LOAD FROM AND TO PORTFOLIO
     C**
     C           P8FPTF    IFEQ '9997'
     C***********          MOVE P9R997    RRFPTF                          S01486
     C                     MOVE FCR997    RRFPTF                          S01486
     C                     ELSE
     C                     MOVELP8FPTF    RRFPTF
     C                     END
     C*
     C           P8TPTF    IFEQ '9997'
     C***********          MOVE P9R997    RRFPTF                          S01486
     C**********           MOVE FCR997    RRFPTF                   S01486 179412
     C                     MOVE FCR997    RRTPTF                          179412
     C                     ELSE
     C                     MOVELP8TPTF    RRTPTF
     C                     END
     C**
     C** LOAD MODULE ID
     C**
     C                     MOVEL'LE'      RRMODI
     C**
     C** LOAD NARRATIVE
     C**
     C                     MOVELAYLNTD    RRDES1
     C**
     C** LOAD CURRENCY CODE
     C**
     C                     MOVELCCY       RRCCY1
     C**
     C** EDIT AMOUNT
     C**
     C**
     C** ACCESS SDCURRL0 TO GET NUMBER OF DECIMAL PLACES
     C**
     C***********CCY       CHAINSDCURRL0             73                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG    'WWRTCD                          S01486
     C***********          PARM '*VERIFY 'WWOPTN                   S01486 154338
     C                     PARM '*KEY    'WWOPTN                          154338
     C                     PARM CCY       WWKEY3  3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C                     Z-ADDA6NBDP    ZDECS
     C                     Z-ADDCPAM      ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVELZOUT21    RRAMO1
     C**
     C** LOAD TRANSACTION NUMBER
     C**
     C                     MOVE P8TRNB    RRTRNB
     C**
     C** EXECUTE STANDARD SR ZFLELN TO FORMAT LE LINE DESCRIPTION
     C**
     C                     MOVELCCY       ZCCY
     C                     Z-ADDINTR      ZINRT
     C                     Z-ADDMDAT      ZMDAT
     C***
     C                     EXSR ZFLELN
     C**
     C** LOAD FORMATTED LINE DESCRIPTION
     C**
     C                     MOVELZLIN      RRDES2
     C**
     C           P8DTCL    IFEQ 'Y'
     C                     MOVE '1'       *IN66
     C                     ELSE
     C           P8TBPR    IFEQ 'N'
     C           P8RECI    ORNE 'D'
     C                     MOVE '1'       *IN67
     C                     END
     C                     END
     C**
     C                     WRITERRDET1
     C                     WRITERRDET2
     C**
     C                     MOVE '0'       *IN66
     C                     MOVE '0'       *IN67
     C                     MOVE '0'       *IN69
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PR07    - PROCESS RE DETAILS                                          *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #RSET    - RESET PRINTER FILE FIELDS                                   *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      * ZSEDIT   - TO EDIT A NUMBER WITH DECIMAL POINT                         *
      * ZFRELN   - TO PROCESS NARRATIVE FOR RETAILS                            *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PR02    - DETERMINE TYPE OF TRANSFER                                  *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWACOD   - ACOUNT  CODE                                                *
      *                                                                        *
      **************************************************************************
     C           #PR07     BEGSR
     C**
     C** RESET FIELDS
     C**
     C                     EXSR #RSET
     C**
     C           PMACCN    CHAINACCNT                73
     C**
     C           *IN73     IFEQ '1'
     C*                                                    ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD5         DBASE            **DB ERROR 05**
     C***********          MOVEL'ACCNT   'DBFILE           ***************S01486
     C                     MOVE 'ACCNT   'DBFILE           ***************S01486
     C                     MOVE 'PMACCN'  DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C** ACCESS LF/SDACODL0 USING ACCOUNT CODE FROM LF/ACCNT
     C**
     C                     MOVELACOD      WWACOD
     C***********WWACOD    CHAINSDACODL0             73                   S01486
     C                     CALL 'AOACODR0'                                S01486
     C                     PARM '*MSG    'WWRTCD                          S01486
     C                     PARM '*VERIFY 'WWOPTN                          S01486
     C**********           PARM WWACOD    WWKEY4  4                                    S01486 CGL029
     C                     PARM WWACOD    WWKEY4 10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                           S01486
     C**
     C** LOAD ACCOUNT CODE NAME FROM SDACODL0
     C**
     C                     MOVELA5ACCN    RRDES1
     C**
     C** LOAD CURRENCY FROM ACCNT
     C**
     C                     MOVELCCY       RRCCY1
     C**
     C** EDIT LEDGER BALANCE USING ZEDIT SUBROUTINE
     C**
     C**
     C** ACCESS SDCURRL0 TO GET NUMBER OF DECIMAL PLACES
     C**
     C***********CCY       CHAINSDCURRL0             73                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG    'WWRTCD                          S01486
     C***********          PARM '*VERIFY 'WWOPTN                   S01486 154338
     C                     PARM '*KEY    'WWOPTN                          154338
     C                     PARM CCY       WWKEY3  3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C                     Z-ADDA6NBDP    ZDECS
     C                     Z-ADDLDBL      ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVELZOUT21    RRAMO1
     C**
     C** LOAD FROM AND TO PORTFOLIO
     C**
     C           P8FPTF    IFEQ '9997'
     C***********          MOVE P9R997    RRFPTF                          S01486
     C                     MOVE FCR997    RRFPTF                          S01486
     C                     ELSE
     C                     MOVELP8FPTF    RRFPTF
     C                     END
     C*
     C           P8TPTF    IFEQ '9997'
     C***********          MOVE P9R997    RRFPTF                          S01486
     C**********           MOVE FCR997    RRFPTF                   S01486 179412
     C                     MOVE FCR997    RRTPTF                          179412
     C                     ELSE
     C                     MOVELP8TPTF    RRTPTF
     C                     END
     C**
     C** LOAD TRANSACTION NUMBER
     C**
     C****                 MOVE P8TRNB    RRTRNB                          47840
     C**
     C** LOAD MODULE ID
     C**
     C                     MOVEL'RE'      RRMODI
     C**
     C** USE STANDARD SUBROUTINE ZFRELN TO FORMAT LINE DESCRIPTION
     C**
     C**********           Z-ADDCNUM      ZCNUM                                               CSD027
     C                     MOVE CNUM      ZCNUM                                               CSD027
     C                     MOVELCCY       ZCCY
     C                     Z-ADDACOD      ZACOD
     C                     Z-ADDACSQ      ZACSQ
     C                     MOVELBRCA      ZBRCA   3                       085862
     C**
     C                     EXSR ZFRELN
     C**
     C** OUTPUT LINE FROM ZFRELN
     C**
     C                     MOVELZLIN      RRDES2
     C**
     C** EDIT CLEARED BALANCE USING ZEDIT
     C**
     C                     Z-ADDA6NBDP    ZDECS
     C                     Z-ADDCLBL      ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVELZOUT21    RRAMO2
     C**
     C           P8DTCL    IFEQ 'Y'
     C                     MOVE '1'       *IN66
     C                     ELSE
     C           P8TBPR    IFEQ 'N'
     C           P8RECI    ORNE 'D'
     C                     MOVE '1'       *IN67
     C                     END
     C                     END
     C**
     C** WRITE TO PRINTER FILE
     C**
     C                     WRITERRDET1
     C                     WRITERRDET2
     C**
     C                     MOVE '0'       *IN66
     C                     MOVE '0'       *IN67
     C                     MOVE '0'       *IN69
     C**
     C                     ENDSR
     C**
     C********************************************************************48219
      ****CT                                                              48219
      ********************************************************************48219
      ****                                                                48219
      ****R08    - PROCESS SE POSITION DETAILS                            48219
      ****                                                                48219
      ****BROUTINE CALLS:                                                 48219
      ****SET    - RESET PRINTER FILE FIELDS                              48219
      ****SSR    - TO PROCESS DATA BASE ERRORS                            48219
      ****EDIT   - TO EDIT A NUMBER WITH DECIMAL POINT                    48219
      ****SELN   - TO PROCESS NARRATIVE FOR TRADES                        48219
      ****                                                                48219
      ****BROUTINE CALLED FROM:                                           48219
      ****R03    - PROCESS SE DETAILS                                     48219
      ****                                                                48219
      ****UTINE USES VARIABLES:                                           48219
      ****                                                                48219
      ********************************************************************48219
     C****       #PR08     BEGSR                                          48219
     C****                                                                48219
     C****ESET FIELDS                                                     48219
     C****                                                                48219
     C****                 EXSR #RSET                                     48219
     C****                                                                48219
     C****UTPUT THE SECURITY SHORTNAME FROM PMACCCUS                      48219
     C****                                                                48219
     C****                 MOVE '1'       *IN65                           48219
     C****                 MOVELP8SESN    RRSESN                          48219
     C****                                                                48219
     C****CCESS LF/SECTY USING SECURITY SHORTNAME                         48219
     C****                                                                48219
     C****       P8SESN    CHAINSECTY                73                   48219
     C****                                                                48219
     C****       *IN73     IFEQ '1'                                       48219
     C****                                                 ***************48219
     C****                 Z-ADD6         DBASE            **DB ERROR 06**48219
     C****                 MOVEL'SECTY   'DBFILE           ***************48219
     C****                 MOVE P8SESN    DBKEY                           48219
     C****                 EXSR *PSSR                                     48219
     C****                 END                                            48219
     C****                                                                48219
     C****                 MOVELSRPN      RRDES1                          48219
     C****                                                                48219
     C****OAD FROM AND TO PORTFOLIO                                       48219
     C****                                                                48219
     C****       P8FPTF    IFEQ '9997'                                    48219
     C****                 MOVE P9R997    RRFPTF                          48219
     C****                 ELSE                                           48219
     C****                 MOVELP8FPTF    RRFPTF                          48219
     C****                 END                                            48219
     C****                                                                48219
     C****       P8TPTF    IFEQ '9997'                                    48219
     C****                 MOVE P9R997    RRTPTF                          48219
     C****                 ELSE                                           48219
     C****                 MOVELP8TPTF    RRTPTF                          48219
     C****                 END                                            48219
     C****                                                                48219
     C****OAD MODULE ID                                                   48219
     C****                                                                48219
     C****                 MOVEL'SE'      RRMODI                          48219
     C****                                                                48219
     C****ET LOWER LIMITS ON LF/PMHPOSLL                                  48219
     C****SING CUSTOMER NUMBER, FROM PORTFOLIO REFERENCE                  48219
     C****ND SECURITY SHORT NAME                                          48219
     C****                                                                48219
     C****       PMHPOS    SETLLPMHPOSLL                                  48219
     C****                                                                48219
     C****O WHILE SAME CUSTOMER, PORTFOLIO REFERENCE AND SECURITY         48219
     C****HORTNAME                                                        48219
     C****                                                                48219
     C****       *IN74     DOUEQ'1'                                       48219
     C****                                                                48219
     C****       PMHPOS    READEPMHPOSLL                 74               48219
     C****                                                                48219
     C****       *IN74     IFEQ '0'                                       48219
     C****                                                                48219
     C****OAD CURRENCY                                                    48219
     C****                                                                48219
     C****                 MOVELQATNMC    RRCCY1                          48219
     C****                                                                48219
     C****DIT NOMINAL FOR OUTPUT                                          48219
     C****                                                                48219
     C****                                                                48219
     C****                 Z-ADDQANOML    ZFLD15                          48219
     C****                 Z-ADDQATNMD    ZDECS                           48219
     C****                 EXSR ZSEDIT                                    48219
     C****                 MOVELZOUT21    RRAMO1                          48219
     C****                                                                48219
     C****ORMAT SE LINE DESCRIPTION WITH FOLLOWING PARAMETERS             48219
     C****                                                                48219
     C****                 MOVELNMCY      ZNMCY                           48219
     C****                 Z-ADDCPNR      ZCPNR                           48219
     C****                 Z-ADDMATY      ZMATY                           48219
     C****                                                                48219
     C****                 EXSR ZFSELN                                    48219
     C****                                                                48219
     C****UTPUT FORMATTED LINE                                            48219
     C****                                                                48219
     C****                 MOVELZLIN      RRDES2                          48219
     C****                                                                48219
     C****       P8DTCL    IFEQ 'Y'                                       48219
     C****                 MOVE '1'       *IN66                           48219
     C****                 ELSE                                           48219
     C****       P8TBPR    IFEQ 'N'                                       48219
     C****       P8RECI    ORNE 'D'                                       48219
     C****                 MOVE '1'       *IN67                           48219
     C****                 END                                            48219
     C****                 END                                            48219
     C****                                                                48219
     C****                 WRITERRDET1                                    48219
     C****                 WRITERRDET2                                    48219
     C****                                                                48219
     C****                 MOVE '0'       *IN65                           48219
     C****                 MOVE '0'       *IN66                           48219
     C****                 MOVE '0'       *IN67                           48219
     C****                 MOVE '0'       *IN69                           48219
     C****                                                                48219
     C****                 END                                            48219
     C****                                                                48219
     C****                 END                                            48219
     C****                                                                48219
     C****                 ENDSR                                          48219
     C****                                                                48219
     C********************************************************************56555
     C*                                                                   56555
     C*  PR08    - PROCESS SE POSITION DETAILS                            56555
     C*                                                                   56555
     C* SUBROUTINE CALLS:                                                 56555
     C* RESET    - RESET PRINTER FILE FIELDS                              56555
     C*   SSR    - TO PROCESS DATA BASE ERRORS                            56555
     C*   EDIT   - TO EDIT A NUMBER WITH DECIMAL POINT                    56555
     C*   SELN   - TO PROCESS NARRATIVE FOR TRADES                        56555
     C*                                                                   56555
     C*SUBBROUTINE CALLED FROM:                                           56555
     C*SUBR03    - PROCESS SE DETAILS                                     56555
     C*                                                                   56555
     C* ROUTINE USES VARIABLES:                                           56555
     C*                                                                   56555
     C********************************************************************56555
     C           #PR08     BEGSR                                          56555
     C*                                                                   56555
     C*  RESET FIELDS                                                     56555
     C*                                                                   56555
     C                     EXSR #RSET                                     56555
     C*                                                                   56555
     C***OUTPUT*THE SECURITY SHORTNAME FROM PMACCCUS                56555 S01486
     C*  OUTPUT THE SECURITY SHORTNAME FROM PMACCUL0                      S01486
     C*                                                                   56555
     C                     MOVE '1'       *IN65                           56555
     C                     MOVELP8SESN    RRSESN                          56555
     C*                                                                   56555
     C*  ACCESS LF/SECTY USING SECURITY SHORTNAME                         56555
     C*                                                                   56555
     C           P8SESN    CHAINSECTY                73                   56555
     C*                                                                   56555
     C           *IN73     IFEQ '1'                                       56555
     C*                                                    ***************56555
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD6         DBASE            **DB ERROR 06**56555
     C***********          MOVEL'SECTY   'DBFILE           *********56555 S01486
     C                     MOVE 'SECTY   'DBFILE           ***************S01486
     C                     MOVE P8SESN    DBKEY                           56555
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     56555
     C                     END                                            56555
     C*                                                                   56555
     C                     MOVELSRPN      RRDES1                          56555
     C*                                                                   56555
     C*  LOAD FROM AND TO PORTFOLIO                                       56555
     C*                                                                   56555
     C           P8FPTF    IFEQ '9997'                                    56555
     C***********          MOVE P9R997    RRFPTF                          S01486
     C                     MOVE FCR997    RRFPTF                          S01486
     C                     ELSE                                           56555
     C***********          MOVE P9R997    RRFPTF                          S01486
     C                     MOVE FCR997    RRFPTF                          S01486
     C                     END                                            56555
     C*                                                                   56555
     C           P8TPTF    IFEQ '9997'                                    56555
     C***********          MOVE P9R997    RRFPTF                          S01486
     C**********           MOVE FCR997    RRFPTF                   S01486 179412
     C                     MOVE FCR997    RRTPTF                          179412
     C                     ELSE                                           56555
     C                     MOVELP8TPTF    RRTPTF                          56555
     C                     END                                            56555
     C*                                                                   56555
     C*  LOAD MODULE ID                                                   56555
     C*                                                                   56555
     C                     MOVEL'SE'      RRMODI                          56555
     C*                                                                   56555
     C*  SET LOWER LIMITS ON LF/PMPTRFLL                                  56555
     C*  USING CUSTOMER NUMBER, FROM PORTFOLIO REFERENCE                  56555
     C*  AND SECURITY SHORT NAME                                          56555
     C*                                                                   56555
     C           PMDPOS    SETLLPMPTRFLL                                  56555
     C*                                                                   56555
     C*  DO WHILE SAME CUSTOMER, PORTFOLIO REFERENCE AND SECURITY         56555
     C*  SHORTNAME                                                        56555
     C*                                                                   56555
     C           *IN74     DOUEQ'1'                                       56555
     C*                                                                   56555
     C           PMDPOS    READEPMPTRFLL                 74               56555
     C*                                                                   56555
     C           *IN74     IFEQ '0'                                       56555
     C*                                                                   56555
     C                     MOVELP8POTI    RRIND1                          56555
     C*                                                                   56555
     C*  LOAD CURRENCY                                                    56555
     C*                                                                   56555
     C***                  MOVELQATNMC    RRCCY1                          56555
     C                     MOVELNMCY      RRCCY1                          56555
     C*                                                                   56555
     C*  EDIT NOMINAL FOR OUTPUT                                          56555
     C*                                                                   56555
     C***                  Z-ADDQANOML    ZFLD15                          56555
     C                     Z-ADDP8NOML    ZFLD15                          56555
     C***                  Z-ADDQATNMD    ZDECS                           56555
     C                     Z-ADDNMDP      ZDECS                           56555
     C                     EXSR ZSEDIT                                    56555
     C                     MOVELZOUT21    RRAMO1                          56555
     C*                                                                   56555
     C*  FORMAT SE LINE DESCRIPTION WITH FOLLOWING PARAMETERS             56555
     C*                                                                   56555
     C                     MOVELNMCY      ZNMCY                           56555
     C                     Z-ADDCPNR      ZCPNR                           56555
     C                     Z-ADDMATY      ZMATY                           56555
     C*                                                                   56555
     C                     EXSR ZFSELN                                    56555
     C*                                                                   56555
     C*  OUTPUT FORMATTED LINE                                            56555
     C*                                                                   56555
     C                     MOVELZLIN      RRDES2                          56555
     C*                                                                   56555
     C           P8DTCL    IFEQ 'Y'                                       56555
     C                     MOVE '1'       *IN66                           56555
     C                     ELSE                                           56555
     C           P8TBPR    IFEQ 'N'                                       56555
     C           P8RECI    ORNE 'D'                                       56555
     C                     MOVE '1'       *IN67                           56555
     C                     END                                            56555
     C                     END                                            56555
     C*                                                                   56555
     C                     WRITERRDET1                                    56555
     C                     WRITERRDET2                                    56555
     C*                                                                   56555
     C                     MOVE '0'       *IN65                           56555
     C                     MOVE '0'       *IN66                           56555
     C                     MOVE '0'       *IN67                           56555
     C                     MOVE '0'       *IN69                           56555
     C*                                                                   56555
     C                     END                                            56555
     C*                                                                   56555
     C                     END                                            56555
     C*                                                                   56555
     C                     ENDSR                                          56555
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PR09    - PROCESS SE TRADES AND DEPOT MOVEMENT DETAILS                *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #RSET    - RESET PRINTER FILE FIELDS                                   *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      * ZSEDIT   - TO EDIT A NUMBER WITH DECIMAL POINT                         *
      * ZFSELN   - TO PROCESS NARRATIVE FOR TRADES                             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PR03    - PROCESS SE DETAILS                                          *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWTRNB   - TRANSACTION NUMBER                                          *
      * WWTRAN   - TRANSACTION NUMBER                                          *
      *                                                                        *
      **************************************************************************
     C           #PR09     BEGSR
     C**
     C** RESET FIELDS
     C**
     C                     EXSR #RSET
     C**
     C** LOAD FROM AND TO PORTFOLIO
     C**
     C           P8FPTF    IFEQ '9997'
     C***********          MOVE P9R997    RRFPTF                          S01486
     C                     MOVE FCR997    RRFPTF                          S01486
     C                     ELSE
     C                     MOVELP8FPTF    RRFPTF
     C                     END
     C*
     C           P8TPTF    IFEQ '9997'
     C***********          MOVE P9R997    RRFPTF                          S01486
     C**********           MOVE FCR997    RRFPTF                   S01486 179412
     C                     MOVE FCR997    RRTPTF                          179412
     C                     ELSE
     C                     MOVELP8TPTF    RRTPTF
     C                     END
     C**
     C** LOAD MODULE ID
     C**
     C                     MOVEL'SE'      RRMODI
     C**
     C           P8POTI    IFEQ 'D'
     C**
     C                     MOVE '1'       *IN65
     C**
     C                     MOVELP8SESN    RRSESN
     C                     MOVE P8TRNB    RRTRN2
     C**
     C                     MOVELP8TRNB    WWTRNB
     C           PMDPTM    CHAINDPTMV                73
     C**
     C           *IN73     IFEQ '1'
     C*                                                    ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD7         DBASE            **DB ERROR 07**
     C***********          MOVEL'DPTMV   'DBFILE           ***************S01486
     C                     MOVE 'DPTMV   'DBFILE           ***************S01486
     C                     MOVE 'PMDPTM'  DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C           P8SESN    CHAINSECTY                73
     C*                                                                   58162
     C** OBTAIN PROCESSING TYPE                                           58162
     C                     MOVE SITP      WWINVT                          58162
     C                     MOVE NMCY      WWCCYI                          58162
     C           PMINVT    CHAININVTP                73                   58162
     C*                                                                   58162
     C           *IN73     IFEQ '1'                                       58162
     C*                                                    ***************58162
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD6         DBASE            **DB ERROR 06**58162
     C***********          MOVEL'INVTP   'DBFILE           *********58162 S01486
     C                     MOVE 'INVTP   'DBFILE           ***************S01486
     C                     MOVELWWCCYI    DBKEY                           58162
     C                     MOVE WWINVT    DBKEY                           58162
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     58162
     C                     END                                            58162
     C**
     C                     MOVELNMCY      RRCCY1
     C                     MOVELSRPN      RRDES1
     C**
     C** EDIT NOMINAL AMOUNT FROM LF/DPTMV
     C**
     C                     Z-ADDNMDP      ZDECS
     C                     Z-ADDDPNA      ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVELZOUT21    RRAMO1
     C**
     C** LOAD DEPOT MOVEMENT TYPE
     C**
     C                     MOVELDPMV      RRIND1
     C**
     C** FORMAT SE LINE DESCRIPTION USING SUBROUTINE ZFSELN
     C**
     C                     MOVELNMCY      ZNMCY
     C                     Z-ADDCPNR      ZCPNR
     C                     Z-ADDMATY      ZMATY
     C                     MOVE PROT      ZPROT                           58162
     C**
     C                     EXSR ZFSELN
     C**
     C                     MOVELZLIN      RRDES2
     C**
     C                     ELSE
     C**
     C** IF POSITION INDICATOR SET TO 'T'
     C**
     C                     MOVE P8TRNB    RRTRNB
     C**
     C** ACCESS TRADS - SE TRADES
     C**
     C                     MOVELP8TRNB    WWTRAN
     C           WWTRAN    CHAINTRADS                73
     C**
     C           *IN73     IFEQ '1'
     C*                                                    ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD8         DBASE            **DB ERROR 08**
     C***********          MOVEL'TRADS   'DBFILE           ***************S01486
     C                     MOVE 'TRADS   'DBFILE           ***************S01486
     C                     MOVE P8TRNB    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C** ACCESS LF/SECTY - SECURITIES FILE
     C**
     C           TDSS      CHAINSECTY                73
     C*                                                                   58162
     C** OBTAIN PROCESSING TYPE                                           58162
     C                     MOVE SITP      WWINVT                          58162
     C                     MOVE NMCY      WWCCYI                          58162
     C           PMINVT    CHAININVTP                73                   58162
     C*                                                                   58162
     C           *IN73     IFEQ '1'                                       58162
     C*                                                    ***************58162
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD6         DBASE            **DB ERROR 06**58162
     C***********          MOVEL'INVTP   'DBFILE           *********58162 S01486
     C                     MOVE 'INVTP   'DBFILE           ***************S01486
     C                     MOVELWWCCYI    DBKEY                           58162
     C                     MOVE WWINVT    DBKEY                           58162
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     58162
     C                     END                                            58162
     C**
     C                     MOVELSRPN      RRDES1
     C                     MOVELTNMC      RRCCY1
     C**
     C** EDIT NOMINAL FOR OUTPUT
     C**
     C                     Z-ADDTNMD      ZDECS
     C                     Z-ADDNOML      ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVELZOUT21    RRAMO1
     C**
     C** LOAD TRADE TYPE
     C**
     C                     MOVELTDTP      RRIND1
     C**
     C** FORMAT SE LINE DESCRIPTION USING SUBROUTINE ZFSELN
     C**
     C                     MOVELNMCY      ZNMCY
     C                     Z-ADDCPNR      ZCPNR
     C                     Z-ADDMATY      ZMATY
     C                     MOVE PROT      ZPROT                           58162
     C**
     C                     EXSR ZFSELN
     C**
     C                     MOVELZLIN      RRDES2
     C**
     C** LOAD SECURITY SHORT NAME AND TRANSACTION
     C** REFERENCE IN REFERENCE 1 AND 2
     C**
     C                     MOVELP8SESN    RRSESN
     C                     MOVE P8TRNB    RRTRN2
     C**
     C                     END
     C**
     C** SETON INDICATOR TO OUTPUT VALID FIELD
     C**
     C                     MOVE '1'       *IN65
     C**
     C**
     C           P8DTCL    IFEQ 'Y'
     C                     MOVE '1'       *IN66
     C                     ELSE
     C           P8TBPR    IFEQ 'N'
     C           P8RECI    ORNE 'D'
     C                     MOVE '1'       *IN67
     C                     END
     C                     END
     C                     WRITERRDET1
     C                     WRITERRDET2
     C**
     C** RESET INDICATOR
     C**
     C                     MOVE '0'       *IN65
     C                     MOVE '0'       *IN66
     C                     MOVE '0'       *IN67
     C                     MOVE '0'       *IN69
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PR10    - PROCESS FX DEALS                                            *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * ZSEDIT   - TO EDIT A NUMBER WITH DECIMAL POINT                         *
      * ZFDLLN   - TO PROCESS NARRATIVE FOR DEALS                              *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PR05    - PROCESS DL DETAILS                                          *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #PR10     BEGSR
     C**
     C                     MOVELPUCY      RRCCY1
     C**
     C** ACCESS SDCURRL0 TO GET NUMBER OF DECIMAL PLACES
     C**
     C***********PUCY      CHAINSDCURRL0             73                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG    'WWRTCD                          S01486
     C                     PARM '*KEY    'WWOPTN                          S01486
     C                     PARM PUCY      WWKEY3  3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C** EDIT PURCHASE AMOUNT
     C**
     C                     MOVE *BLANKS   ZFLD15                          B08196
     C                     Z-ADDA6NBDP    ZDECS
     C                     MOVE PUAM      ZFLD15
     C                     EXSR ZSEDIT
     C                     MOVELZOUT21    RRAMO1
     C**
     C** LOAD INDICATOR
     C**
     C                     MOVEL'B'       RRIND1
     C**
     C** LOAD DEAL NUMBER
     C**
     C                     MOVE DLNO      RRTRNB
     C**
     C** FORMAT DL LINE DESCRIPTION
     C**
     C********             MOVELPUCY      ZPUCY                           R10038
     C********             MOVELSLCY      ZSLCY                           R10038
     C                     MOVELSLCY      ZPUCY                           R10038
     C                     Z-ADDVDAT      ZVDAT
     C                     Z-ADDDDAT      ZDDAT   50                      R10038
     C**
     C                     EXSR ZFDLLN
     C**
     C                     MOVELZLIN      RRDES2
     C**
     C** LOAD SELL CURRENCY
     C**
     C                     MOVELSLCY      RRCCY2
     C**
     C***********SLCY      CHAINSDCURRL0             73                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG    'WWRTCD                          S01486
     C                     PARM '*KEY    'WWOPTN                          S01486
     C                     PARM SLCY      WWKEY3  3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C** EDIT SELL AMOUNT
     C**
     C                     MOVE *BLANKS   ZFLD15                          B08196
     C                     Z-ADDA6NBDP    ZDECS
     C****                 Z-ADDSLAM      ZFLD15                          B08196
     C                     MOVE SLAM      ZFLD15                          B08196
     C                     EXSR ZSEDIT
     C                     MOVELZOUT21    RRAMO2
     C**
     C** LOAD INDICATOR
     C**
     C                     MOVEL'S'       RRIND2
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PR11    - PROCESS MM DEALS                                            *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * ZSEDIT   - TO EDIT A NUMBER WITH DECIMAL POINT                         *
      * ZFDLLN   - TO PROCESS NARRATIVE FOR DEALS                              *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PR05    - PROCESS DL DETAILS                                          *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #PR11     BEGSR
     C**
     C                     MOVELCCY       RRCCY1
     C**
     C** LOAD DEAL TYPE
     C**
     C                     MOVELDTYP      RRIND1
     C**
     C** LOAD DEAL NUMBER
     C**
     C                     MOVE DLNO      RRTRNB
     C**
     C** ACCESS SDCURRL0 TO GET NUMBER OF DECIMAL PLACES
     C**
     C***********CCY       CHAINSDCURRL0             73                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG    'WWRTCD                          S01486
     C***********          PARM '*VERIFY 'WWOPTN                   S01486 154338
     C                     PARM '*KEY    'WWOPTN                          154338
     C                     PARM CCY       WWKEY3  3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C** EDIT PRINCIPAL FOR OUTPUT
     C**
     C**
     C                     Z-ADDPCPL      ZFLD15
     C                     Z-ADDA6NBDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVELZOUT21    RRAMO1
     C**
     C** FORMAT DL LINE DESCRIPTION USING ZFDLLN
     C**
     C                     MOVELCCY       ZCCY
     C                     Z-ADDINTR      ZINRT
     C                     Z-ADDMDAT      ZMDAT
     C                     Z-ADDNOTD      ZNOTD
     C**
     C                     EXSR ZFDLLN
     C**
     C                     MOVELZLIN      RRDES2
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      ***/EJECT**                                                         S01486
      ********************************************************************S01486
      ***********                                                         S01486
      **#PR12****- PROCESS FRA/IRS DEALS                                  S01486
      ***********                                                         S01486
      **SUBROUTINE CALLS:                                                 S01486
      **ZSEDIT***- TO EDIT A NUMBER WITH DECIMAL POINT                    S01486
      **ZFDLLN***- TO PROCESS NARRATIVE FOR DEALS                         S01486
      ***********                                                         S01486
      **SUBROUTINE CALLED FROM:                                           S01486
      **#PR05****- PROCESS DL DETAILS                                     S01486
      ***********                                                         S01486
      **ROUTINE*USES VARIABLES:                                           S01486
      ***********                                                         S01486
      ********************************************************************S01486
     C***********#PR12     BEGSR                                          S01486
     C***********                                                         S01486
     C***LOAD*OUR CURRENCY                                                S01486
     C***********                                                         S01486
     C***********          MOVELUCUCY     RRCCY1                          S01486
     C***********                                                         S01486
     C***ACCESS*SDCURRL0 TO GET NUMBER OF DECIMAL PLACES                  S01486
     C***********                                                         S01486
     C***********UCUCY     CHAINSDCURRL0             73                   S01486
     C***********          CALL 'AOCURRR0'                                S01486
     C***********          PARM '*MSG    'WWRTCD                          S01486
     C***********          PARM '*KEY    'WWOPTN                          S01486
     C***********          PARM UCUCY     WWKEY3  3                       S01486
     C***********SDCURR    PARM SDCURR    DSSDY                           S01486
     C***********                                                         S01486
     C***EDIT*AMOUNT FOR OUTPUT                                           S01486
     C***********                                                         S01486
     C***********          Z-ADDA6NBDP    ZDECS                           S01486
     C***********          Z-ADDUPAMT     ZFLD15                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVELZOUT21    RRAMO1                          S01486
     C***********                                                         S01486
     C***LOAD*DEAL NUMBER                                                 S01486
     C***********                                                         S01486
     C***********          MOVE DLNO      RRTRNB                          S01486
     C***********                                                         S01486
     C***IF*DEAL*TYPE IS 'FR', 'RS' OR 'RL'                               S01486
     C***FORMAT*DL LINE DESCRIPTION WITH FOLLOWING PARAMETERS             S01486
     C***ZUCUCY,*ZUEINR, ZMDAT                                            S01486
     C***********                                                         S01486
     C***********DTYP      IFEQ 'FR'                                      S01486
     C***********DTYP      OREQ 'RS'                                      S01486
     C***********DTYP      OREQ 'RL'                                      S01486
     C***********                                                         S01486
     C***********          MOVELUCUCY     ZUCUCY                          S01486
     C***********          Z-ADDUEINR     ZUEINR                          S01486
     C***********          Z-ADDMDAT      ZMDAT                           S01486
     C***********                                                         S01486
     C***********          EXSR ZFDLLN                                    S01486
     C***********                                                         S01486
     C***********          MOVELZLIN      RRDES2                          S01486
     C***********                                                         S01486
     C***********          ELSE                                           S01486
     C***********                                                         S01486
     C***********DTYP      IFEQ 'RX'                                      S01486
     C***********                                                         S01486
     C***FORMAT*DL LINE USING FOLLOWING PARAMETERS                        S01486
     C***ZUCUCY,*ZTCUCY, ZMDAT                                            S01486
     C***********                                                         S01486
     C***********          MOVELUCUCY     ZUCUCY                          S01486
     C***********          MOVELTCUCY     ZTCUCY                          S01486
     C***********          Z-ADDMDAT      ZMDAT                           S01486
     C***********                                                         S01486
     C***********          EXSR ZFDLLN                                    S01486
     C***********          MOVELZLIN      RRDES2                          S01486
     C***********                                                         S01486
     C***LOAD*THEIR CURRENCY                                              S01486
     C***********                                                         S01486
     C***********          MOVELTCUCY     RRCCY2                          S01486
     C***********                                                         S01486
     C***ACCESS*SDCURRL0 TO GET NUMBER OF DECIMAL PLACES                  S01486
     C***********                                                         S01486
     C***********TCUCY     CHAINSDCURRL0             73                   S01486
     C***********          CALL 'AOCURRR0'                                S01486
     C***********          PARM '*MSG    'WWRTCD                          S01486
     C***********          PARM '*KEY    'WWOPTN                          S01486
     C***********          PARM TCUCY     WWKEY3  3                       S01486
     C***********SDCURR    PARM SDCURR    DSSDY                           S01486
     C***********                                                         S01486
     C***EDIT*AMOUNT FOR OUTPUT                                           S01486
     C***********                                                         S01486
     C***********          Z-ADDA6NBDP    ZDECS                           S01486
     C***********          Z-ADDTPAMT     ZFLD15                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVELZOUT21    RRAMO2                          S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C***********                                                         S01486
     C********************************************************************S01486
      ***/EJECT**                                                         S01486
      ********************************************************************S01486
      ************                                                        S01486
      **#PR13****- PROCESS FI DETAILS                                     S01486
      ************                                                        S01486
      **SUBROUTINE CALLS:                                                 S01486
      **#RSET****- RESET PRINTER FILE FIELDS                              S01486
      ***PSSR****- TO PROCESS DATA BASE ERRORS                            S01486
      **#PR14****- PROCESS FIDUCIARY DEPOSITS                             S01486
      **#PR15****- PROCESS FIDUCIARY LOANS                                S01486
      ************                                                        S01486
      **SUBROUTINE CALLED FROM:                                           S01486
      **#PR02****- DETERMINE TYPE OF TRANSFER                             S01486
      ************                                                        S01486
      **ROUTINE*USES VARIABLES:                                           S01486
      ************                                                        S01486
      ********************************************************************S01486
     C***********#PR13     BEGSR                                          S01486
     C***********                                                         S01486
     C***RESET*FIELDS                                                     S01486
     C***********                                                         S01486
     C***********          EXSR #RSET                                     S01486
     C***********                                                         S01486
     C***LOAD*FROM AND TO PORTFOLIO                                       S01486
     C***********                                                         S01486
     C***********P8FPTF    IFEQ '9997'                                    S01486
     C***********          MOVE P9R997    RRFPTF                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVELP8FPTF    RRFPTF                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********P8TPTF    IFEQ '9997'                                    S01486
     C***********          MOVE P9R997    RRTPTF                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVELP8TPTF    RRTPTF                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***LOAD*MODULE ID                                                   S01486
     C***********                                                         S01486
     C***********          MOVE P8MODI    RRMODI                          S01486
     C***********                                                         S01486
     C*****      PMFIDL    CHAINFIDPLNPT             73                   B08108
     C*****      PMFIDL    CHAINFIDPLNP2             73             B08275B08108
     C***********P8TRNB    CHAINFIDEPOL0             73             49914 S01486
     C***********                                                  B08275 S01486
     C** OBTAIN FIDUCIARY LOAN / DEPOSIT DETAILS                          B08275
     C**********           MOVE *BLANKS   WWRECI                    B08275 49914
     C********** PMFIDL    CHAINFIDPLNPT             73             B08275 49914
     C**********                                                    B08275 49914
     C********** *IN73     IFEQ '1'                                 B08275 49914
     C**********           MOVE 'M'       WWRECI                    B08275 49914
     C********** PMFIDL    CHAINFIDPLNPT             73             B08275 49914
     C**********                                                    B08275 49914
     C********** *IN73     IFEQ '1'                                 B08275 49914
     C**********           MOVE 'N'       WWRECI                    B08275 49914
     C********** PMFIDL    CHAINFIDPLNPT             73             B08275 49914
     C**********                                                          S01486
     C********** *IN73     IFEQ '1'                                       S01486
     C**********                                           ***************S01486
     C**********           Z-ADD10        DBASE            **DB ERROR 03**S01486
     C*****                MOVEL'FIDPLNPT'DBFILE           ***************B08108
     C**********           MOVEL'FIDPLNP2'DBFILE           *********B08108 49914
     C**********           MOVEL'FIDEPOL0'DBFILE           *********49914 S01486
     C**********           MOVE P8TRNB    DBKEY                           S01486
     C**********           EXSR *PSSR                                     S01486
     C**********           END                                            S01486
     C**********           END                                      B08275 49914
     C**********           END                                      B08275 49914
     C**********                                                          S01486
     C********** P8MODI    IFEQ 'FD'                                      S01486
     C**********           MOVE FDDEDT    DTYP                            S01486
     C**********           MOVE FDSTRT    DLST                            S01486
     C**********           END                                            S01486
     C**********                                                          S01486
     C********** P8MODI    IFEQ 'FL'                                       49914
     C********** FLPTYP    IFEQ 71                                         49914
     C**********           MOVE 'CD'      DTYP                             49914
     C**********           ELSE                                            49914
     C**********           MOVE 'TD'      DTYP                             49914
     C**********           END                                             49914
     C**********           MOVE FLSUTP    DLST                             49914
     C**********           END                                             49914
     C**********                                                          S01486
     C********** PMDEAL    CHAINSDDTSTPP             73                   S01486
     C**********                                                          S01486
     C**********           MOVELP7DTNR    RRDES1                          S01486
     C**********                                                          S01486
     C***DETECT*WHICH FORMAT HAS BEEN READ FROM DEALS                     S01486
     C**********                                                          S01486
     C********** P8MODI    IFEQ 'FD'                                       49914
     C**********           EXSR #PR14                                      49914
     C**********           ELSE                                            49914
     C**********           EXSR #PR15                                      49914
     C**********           END                                             49914
     C**********                                                          S01486
     C********** P8DTCL    IFEQ 'Y'                                       S01486
     C**********           MOVE '1'       *IN66                           S01486
     C**********           ELSE                                           S01486
     C********** P8TBPR    IFEQ 'N'                                       S01486
     C********** P8RECI    ORNE 'D'                                       S01486
     C**********           MOVE '1'       *IN67                           S01486
     C**********           END                                            S01486
     C**********           END                                            S01486
     C**********                                                          S01486
     C**********           WRITERRDET1                                    S01486
     C**********           WRITERRDET2                                    S01486
     C**********                                                          S01486
     C**********           MOVE '0'       *IN66                           S01486
     C**********           MOVE '0'       *IN67                           S01486
     C**********           MOVE '0'       *IN69                           S01486
     C**********                                                          S01486
     C**********           ENDSR                                          S01486
     C**********                                                          S01486
     C********************************************************************S01486
      ***/EJECT**                                                         S01486
      ********************************************************************S01486
      **********                                                          S01486
      **#PR14*** - PROCESS FIDUCIARY DEPOSITS                             S01486
      **********                                                          S01486
      **SUBROUTINE CALLS:                                                 S01486
      **ZSEDIT** - TO EDIT A NUMBER WITH DECIMAL POINT                    S01486
      **ZFDLLN** - TO PROCESS NARRATIVE FOR DEALS                         S01486
      **********                                                          S01486
      **SUBROUTINE CALLED FROM:                                           S01486
      **#PR13*** - PROCESS FI DETAILS                                     S01486
      **********                                                          S01486
      **ROUTINE*USES VARIABLES:                                           S01486
      **********                                                          S01486
      ********************************************************************S01486
     C********** #PR14     BEGSR                                          S01486
     C**********                                                          S01486
     C**********           MOVERFDCCY     RRCCY1                          S01486
     C**********                                                          S01486
     C***LOAD*DEALPTYPE                                                   S01486
     C**********                                                          S01486
     C**********           MOVELFDDEDT    RRIND1                          S01486
     C**********                                                          S01486
     C***LOAD*DEALPNUMBER                                                 S01486
     C**********                                                          S01486
     C**********           MOVERFDDENR    RRTRNB                          S01486
     C**********                                                          S01486
     C***ACCESS*SDCURRL0 TOBGETRNUMBER OF DECIMAL PLACES                  S01486
     C**********                                                          S01486
     C********** FDCCY     CHAINSDCURRL0             73                   S01486
     C**********                                                          S01486
     C***EDIT*PRINCIPAL FORBOUTPUT                                        S01486
     C**********                                                          S01486
     C**********                                                          S01486
     C**********           Z-ADDFDPCPL    ZFLD15                          S01486
     C**********           Z-ADDA6NBDP    ZDECS                           S01486
     C**********           EXSR ZSEDIT                                    S01486
     C**********           MOVELZOUT21    RRAMO1                          S01486
     C**********                                                          S01486
     C***FORMAT*DL LINE DESCRIPTION USING ZFDLLN                          S01486
     C**********                                                          S01486
     C**********           MOVELFDCCY     ZCCY                            S01486
     C**********           Z-ADDFDINTR    ZINTR                           S01486
     C**********           Z-ADDFDMDAT    ZMDAT                           S01486
     C**********           Z-ADDFDNOTD    ZNOTD                           S01486
     C**********                                                          S01486
     C**********           EXSR ZFFDLN                                    S01486
     C**********                                                          S01486
     C**********           MOVELZLIN      RRDES2                          S01486
     C**********                                                          S01486
     C**********           ENDSR                                          S01486
     C**********                                                          S01486
     C********************************************************************S01486
      **********                                                           49914
      ******************************************************************** 49914
      **********                                                         * 49914
      ********** - PROCESS FIDUCIARY LOANS                               * 49914
      **********                                                         * 49914
      **********NE CALLS:                                                * 49914
      ********** - TO EDIT A NUMBER WITH DECIMAL POINT                   * 49914
      ********** - TO PROCESS NARRATIVE FOR DEALS                        * 49914
      **********                                                         * 49914
      **********NE CALLED FROM:                                          * 49914
      ********** - PROCESS FI DETAILS                                    * 49914
      **********                                                         * 49914
      **********USES VARIABLES:                                          * 49914
      **********                                                         * 49914
      ******************************************************************** 49914
     C********** #PR15     BEGSR                                           49914
     C**********                                                           49914
     C**********           MOVE FLLCCY    RRCCY1                           49914
     C**********                                                           49914
     C**********AL TYPE                                                    49914
     C**********                                                           49914
     C********** FLPTYP    IFEQ 71                                         49914
     C**********           MOVE 'CD'      RRIND1                           49914
     C**********           ELSE                                            49914
     C**********           MOVE 'TD'      RRIND1                           49914
     C**********           END                                             49914
     C**********                                                           49914
     C**********AL NUMBER                                                  49914
     C**********                                                           49914
     C**********           MOVE FLLONR    RRTRNB                           49914
     C**********                                                           49914
     C**********SDCURRL0 TO GET NUMBER OF DECIMAL PLACES                   49914
     C**********                                                           49914
     C********** FLLCCY    CHAINSDCURRL0             73                    49914
     C**********                                                           49914
     C** EDIT PRINCIPAL FOR OUTPUT
     C**********                                                           49914
     C**********                                                           49914
     C**********           Z-ADDFLCPAM    ZFLD15                           49914
     C**********           Z-ADDA6NBDP    ZDECS                            49914
     C**********           EXSR ZSEDIT                                     49914
     C**********           MOVELZOUT21    RRAMO1                           49914
     C**********                                                           49914
     C**********DL LINE DESCRIPTION USING ZFDLLN                           49914
     C**********                                                           49914
     C**********           MOVELFLLCCY    ZCCY                             49914
     C**********           Z-ADDFLINTR    ZINTR                            49914
     C**********           Z-ADDFLMDAT    ZMDAT                            49914
     C**********           Z-ADD0         ZNOTD                            49914
     C**********                                                           49914
     C**********           EXSR ZFFDLN                                     49914
     C**********                                                           49914
     C**********           MOVELZLIN      RRDES2                           49914
     C**********                                                           49914
     C**********           ENDSR                                           49914
     C**********                                                           49914
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #AU01    -                                                             *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWACOF   - ACCOUNT OFFICER CODE                                        *
      * WWMODE   - MODE OF PROCESSING                                          *
      * WWREAD   - NUMBER OF RECORDS READ                                      *
      *                                                                        *
      **************************************************************************
     C           #AU01     BEGSR
     C**
     C***********          READ PMTRSFZZ                 73               S01486
     C                     READ PMTRSFPA                 73               S01486
     C**
     C           *IN73     IFEQ '1'
     C*                                                    ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD9         DBASE            **DB ERROR 09**
     C***********          MOVEL'PMTRSFZZ'DBFILE           ***************S01486
     C                     MOVE 'PMTRSFPA'DBFILE           ***************S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C***********WWACOF    IFEQ '*ALL'                                    S01486
     C**
     C           WWMODE    IFEQ '2'
     C           WWREAD    ANDNEP8NORE
     C**
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *IN60
     C**
     C                     END
     C**
     C***********          END                                            S01486
     C**
     C** OUTPUT TO AUDIT PRINTER FILE
     C**
     C***********          OPEN PM0340AU                                  S01486
     C**
     C** COMPUTE DIFFERENCE BETWEEN RECORDS READ
     C** AND NUMBER OF RECORDS ON FILE
     C**
     C                     Z-ADDWWREAD    RRREAD
     C                     Z-ADDP8NORE    RRNORE
     C           RRNORE    IFGT RRREAD
     C           RRNORE    SUB  RRREAD    RRDIFF
     C                     ELSE
     C           RRREAD    SUB  RRNORE    RRDIFF
     C                     END
     C**
     C** TEST MODE
     C**
     C           WWMODE    IFEQ '1'
     C                     WRITEHEADAU
     C                     WRITEPM0340A1
     C***********          WRITEENDAU                                     S01486
     C   88                WRITENODETAIL                                  S01486
     C                     END
     C**
     C           WWMODE    IFEQ '2'
     C                     WRITEHEADAU
     C                     WRITEPM0340A2
     C***********          WRITEENDAU                                     S01486
     C   88                WRITENODETAIL                                  S01486
     C                     END
     C*
     C** IF PROGRAM COMPLETED SUCCESSFULLY RESET FILE TRAILER TO ZERO
     C           WWMODE    IFEQ '1'
     C           *INU8     ANDEQ'0'
     C                     Z-ADD0         P8NORE
     C                     MOVE 'Z'       P8RECI
     C                     UPDATPMTRSFZ0
     C                     END
     C**
     C***********          CLOSEPM0340AU                                  S01486
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #RSET    - RESET PRINTER FILE FIELDS                                   *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PR04    - PROCESS FF DETAILS                                          *
      * #PR05    - PROCESS DL DETAILS                                          *
      * #PR06    - PROCESS LE DETAILS                                          *
      * #PR07    - PROCESS RE DETAILS                                          *
      * #PR08    - PROCESS SE POSITION DETAILS                                 *
      * #PR09    - PORCESS SE TRADES AND DEPOT MOVEMENT DETAILS                *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #RSET     BEGSR
     C**
     C                     MOVEL*BLANKS   RRFPTF
     C                     MOVEL*BLANKS   RRTPTF
     C                     MOVEL*BLANKS   RRMODI
     C                     MOVEL*BLANKS   RRDES1
     C                     MOVEL*BLANKS   RRCCY1
     C                     MOVEL*BLANKS   RRAMO1
     C                     MOVEL*BLANKS   RRIND1
     C                     MOVEL*BLANKS   RRSESN
     C                     MOVE *BLANKS   RRTRNB
     C**
     C                     MOVEL*BLANKS   RRPART
     C                     MOVEL*BLANKS   RRDES2
     C                     MOVEL*BLANKS   RRCCY2
     C                     MOVEL*BLANKS   RRAMO2
     C                     MOVEL*BLANKS   RRIND2
     C                     MOVE *BLANKS   RRTRN2
     C**
     C                     ENDSR
     C**
     C**************************************************************************
      /EJECT
      /COPY ZSRSRC,ZSEDITZ3
      /EJECT
     C********************************************************************
     C*
     C*  ZFDLLN SR. TO FORMAT THE 20A PORTFOLIO MANAGMENT LINE DESCRIPTION
     C*                                 FOR DEALING
     C*
     C*  CASE 1 FX DEALS (DEALSDB)        FORMAT: YYY VVVVVVV(DDDDDDD)
     C*          YYY = CUSTOMER SELL CURRENCY (IE BANK BUY CURRENCY)
     C*          VVVVVVV = VALUE DATE IN DDMMMYY FORMAT
     C*          DDDDDDD = DEAL DATE IN DDMMMYY FORMAT
     C*
     C*  CASE 2 MM DEALS (DEALSDC)        FORMAT: XXX 999.9999 DDMMMYY
     C*                                        OR: XXX 999.9999 999
     C*          XXX = CURRENCY
     C*          999.9999 = INTEREST RATE
     C*          DDMMMYY = MATURITY DATE (IF MATURITY DATE NOT = 0)
     C*          999 = NOTICE DAYS       (IF MATURITY DATE = 0 )
     C*
     C*  CASE 3 FRA/IRS DEALS (DEALSDG) DEAL TYPES FR, RS AND RL
     C*                                    FORMAT: XXX 999.9999 DDMMMYY
     C*          XXX = CURRENCY
     C*          999.9999 = INTEREST RATE
     C*          DDMMMYY = MATURITY DATE
     C*
     C*  CASE 4 FRA/IRS DEALS (DEALSDG) DEAL TYPE  RX
     C*                                    FORMAT: XXX XXX DDMMMYY
     C*          XXX = OUR AND THEIR CURRENCY
     C*          DDMMMYY = MATURITY DATE
     C*
     C*
     C*  INPUT  FIELDS
     C*       ZPUCY   3A     PURCHASE CURRENCY
     C*       ZDDAT   50     DEAL DATE
     C*       ZVDAT   50     VALUE DATE
     C*       ZCCY    3A     CURRENCY
     C*       ZINRT  117     INTEREST RATE
     C*       ZMDAT   50     MATURITY DATE
     C*       ZNOTD   30     NOTICE DAYS
     C********ZUCUCY**3A*****FRA/IRS*OUR*CURRENCY**********************   S01486
     C********ZUEINR*117*****FRA/IRS*OUR*INTEREST*RATE*****************   S01486
     C********ZTCUCY**3A*****FRA/IRS*THEIR*CURRENCY********************   S01486
     C*
     C*  OUTPUT  FIELDS
     C*       ZLIN   20A     LINE DESCRIPTION
     C*
     C*  ARRAY USED
     C*       ZLI    20 ELEMENTS, EACH 1 CHARACTER LONG
     C*
     C********************************************************************
     C           ZFDLLN    BEGSR                           *** ZFDLLN ***
     C*
     C** CLEAR LINE DESCRIPTION .
     C                     MOVEA*BLANKS   ZLI
     C*
     C** FORMAT DETAIL OUTPUT FOR DEAL TYPE CASE 1
     C           ZDDAT     IFNE 0
     C                     MOVEAZPUCY     ZLI,01
     C                     Z-ADDZVDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C*
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,05
     C                     MOVEA'('       ZLI,12
     C*
     C                     Z-ADDZDDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C*
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,13
     C                     MOVEA')'       ZLI,20
     C                     END
     C*
     C** FORMAT DETAIL OUTPUT FOR DEAL TYPE CASE 2
     C           ZCCY      IFNE *BLANKS
     C                     MOVEAZCCY      ZLI,01
     C                     Z-ADDZINRT     ZWRKN   74
     C                     MOVELZWRKN     ZWRKA3  3
     C                     MOVELZWRKA3    ZWRKA2  2
     C*
     C** SUPPRESS LEADING ZEROES
     C           ZWRKA2    IFEQ '00'
     C                     MOVEL'  '      ZWRKA3
     C                     END
     C*
     C                     MOVELZWRKA3    ZWRKA1  1
     C           ZWRKA1    IFEQ '0'
     C                     MOVEL' '       ZWRKA3
     C                     END
     C*
     C**********           MOVE ZWRKN     ZWRKA4  4                                           CGL029
     C                     MOVE ZWRKN     ZWRKA4 10                                           CGL029
     C                     MOVEAZWRKA3    ZLI,05
     C                     MOVEA'.'       ZLI,08
     C                     MOVEAZWRKA4    ZLI,09
     C*
     C** IF MATURITY DATE ZERO OUTPUT NOTICE DAYS TO FORMATTED LINE
     C           ZMDAT     IFEQ *ZERO
     C                     MOVE ZNOTD     ZWRKA3  3
     C                     MOVEAZWRKA3    ZLI,14
     C                     ELSE
     C*
     C** OTHERWISE OUTPUT MATURITY DATE
     C                     Z-ADDZMDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,14
     C                     END
     C*
     C                     END
     C***********                                                         S01486
     C***FORMAT*DETAIL OUTPUT FOR DEAL TYPE CASE 3                        S01486
     C***********ZUCUCY    IFNE *BLANKS                                   S01486
     C***********ZTCUCY    ANDEQ*BLANKS                                   S01486
     C***********          MOVEAZUCUCY    ZLI,01                          S01486
     C***********          Z-ADDZUEINR    ZWRKN   74                      S01486
     C***********          MOVELZWRKN     ZWRKA3  3                       S01486
     C***********          MOVELZWRKA3    ZWRKA2  2                       S01486
     C***********                                                         S01486
     C***SUPPRESS LEADING ZEROES                                          S01486
     C***********ZWRKA2    IFEQ '00'                                      S01486
     C***********          MOVEL'  '      ZWRKA3                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          MOVELZWRKA3    ZWRKA1  1                       S01486
     C***********ZWRKA1    IFEQ '0'                                       S01486
     C***********          MOVEL' '       ZWRKA3                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          MOVE ZWRKN     ZWRKA4  4                       S01486
     C***********          MOVEAZWRKA3    ZLI,05                          S01486
     C***********          MOVEA'.'       ZLI,08                          S01486
     C***********          MOVEAZWRKA4    ZLI,09                          S01486
     C***********                                                         S01486
     C***********          Z-ADDZMDAT     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    ZWRKA1  1                       S01486
     C***********ZWRKA1    IFEQ ' '                                       S01486
     C***********          MOVEL'0'       ZADATE                          S01486
     C***********          END                                            S01486
     C***********          MOVEAZADATE    ZLI,14                          S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***FORMAT*DETAIL OUTPUT FOR DEAL TYPE CASE 4                        S01486
     C***********ZUCUCY    IFNE *BLANKS                                   S01486
     C***********ZTCUCY    ANDNE*BLANKS                                   S01486
     C***********          MOVEAZUCUCY    ZLI,01                          S01486
     C***********          MOVEAZTCUCY    ZLI,05                          S01486
     C***********          Z-ADDZMDAT     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    ZWRKA1  1                       S01486
     C***********ZWRKA1    IFEQ ' '                                       S01486
     C***********          MOVEL'0'       ZADATE                          S01486
     C***********          END                                            S01486
     C***********          MOVEAZADATE    ZLI,09                          S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C*
     C** SET ALL  FIELDS TO BLANK OR ZERO
     C                     MOVE *BLANKS   ZCCY    3
     C                     MOVE *BLANKS   ZSLCY   3
     C                     Z-ADD*ZEROS    ZVDAT   50
     C                     MOVE *BLANKS   ZPUCY   3
     C                     Z-ADD*ZEROS    ZINRT  117
     C                     Z-ADD*ZEROS    ZDDAT   50
     C                     Z-ADD*ZEROS    ZMDAT   50
     C                     Z-ADD*ZEROS    ZNOTD   30
     C***********          MOVE *BLANKS   ZUCUCY  3                       S01486
     C***********          Z-ADD*ZEROS    ZUEINR 117                      S01486
     C***********          MOVE *BLANKS   ZTCUCY  3                       S01486
     C*
     C                     MOVEAZLI       ZLIN   20
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C********************************************************************
      /EJECT
     C********************************************************************
     C*
     C*  ZFSELN SR. TO FORMAT THE 20A PORTFOLIO MANAGMENT LINE DESCRIPTION
     C*                                 FOR SECURITIES TRADING REL.2
     C*
     C*  FORMAT: XXX 999.9999 DDMMMYY
     C*          XXX =  NOMINAL CURRENCY
     C*          999.9999 = CONPON RATE
     C*          DDMMMYY = MATURITY DATE
     C*
     C*  INPUT  FIELDS
     C*       ZNMCY   3A     NOMINAL CURRENCY
     C*       ZCPNR  117     COUPON RATE
     C*       ZMATY   50     MATURITY DATE
     C*       ZPROT   1A     PROCESSING TYPE
     C*
     C*  OUTPUT  FIELDS
     C*       ZLIN   20A     LINE DESCRIPTION
     C*
     C*  ARRAY USED
     C*       ZLI    20 ELEMENTS, EACH 1 CHARACTER LONG
     C*
     C********************************************************************
     C           ZFSELN    BEGSR                           *** ZFSELN ***
     C*
     C** CLEAR LINE DESCRIPTION .
     C                     MOVEA*BLANKS   ZLI
     C*
     C** MOVE NOMINNAL CURRENCY TO LINE DESCRIPTION
     C                     MOVEAZNMCY     ZLI,01
     C*
     C** IF PROCESSING TYPE     NOT COMMODITIES ZPROT = 2
     C**                        NOT EQUITIES    ZPROT = 4
     C**                        NOT UNIT TRUSTS ZPROT = 7
     C           ZPROT     IFNE '2'
     C           ZPROT     ANDNE'4'
     C           ZPROT     ANDNE'7'
     C*
     C** MOVE COUPON  RATE  TO LINE DESCRIPTION
     C                     Z-ADDZCPNR     ZWRKN   74
     C                     MOVELZWRKN     ZWRKA3  3
     C**********           MOVE ZWRKN     ZWRKA4  4                                           CGL029
     C                     MOVE ZWRKN     ZWRKA4                                              CGL029
     C                     MOVELZWRKA3    ZWRKA2  2
     C*
     C** SUPRESS LEADING ZEROES
     C           ZWRKA2    IFEQ '00'
     C                     MOVEL'  '      ZWRKA3
     C                     END
     C                     MOVELZWRKA3    ZWRKA1  1
     C           ZWRKA1    IFEQ '0'
     C                     MOVEL' '       ZWRKA3
     C                     END
     C                     MOVEAZWRKA3    ZLI,05
     C                     MOVEA'.'       ZLI,08
     C                     MOVEAZWRKA4    ZLI,09
     C*
     C** MOVE MATURITY DATE TO LINE DESCRIPTION
     C                     Z-ADDZMATY     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C           ZADATE    IFNE *BLANK
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,14
     C                     END
     C                     END
     C*
     C** SET ALL   FIELDS TO BLANKS OR ZEROS
     C                     MOVE *BLANKS   ZNMCY   3
     C                     MOVE *BLANKS   ZPROT   1
     C                     Z-ADD*ZEROS    ZCPNR  117
     C                     Z-ADD*ZEROS    ZMATY   50
     C*
     C                     MOVEAZLI       ZLIN   20
     C*
     C                     ENDSR
     C*******************************************************************
      ***/EJECT**                                                         S01486
     C********************************************************************S01486
     C***********                                                         S01486
     C***ZFFFLN*SR. TO FORMAT THE 20A PORTFOLIO MANAGMENT LINE DESCRIPTIONS01486
     C***********                       FOR FUTURE & OPTIONS              S01486
     C***********                                                         S01486
     C***FORMAT:*XXX MMMYY X 9999.999                                     S01486
     C***********XXX = INSTRUMENT CURRENCY                                S01486
     C***********MMMYY = MONTH/YEAR                                       S01486
     C***********X = PUT/CALL INDICATOR                                   S01486
     C***********999.9999 = STRIKE PRICE                                  S01486
     C***********                                                         S01486
     C***INPUT**FIELDS                                                    S01486
     C********ZISCY   3A     INSTRUMENT CURRENCY                          S01486
     C********ZMTHN   20     MONTH NUMBER                                 S01486
     C********ZYRNO   20     YEAR NUMBER                                  S01486
     C********ZPCAL   1A     PUT/CALL INDICATOR                           S01486
     C********ZSTRP  117     STRIKE PRICE                                 S01486
     C***********                                                         S01486
     C***OUTPUT**FIELDS                                                   S01486
     C********ZLIN   20A     LINE DESCRIPTION                             S01486
     C***********                                                         S01486
     C***ARRAY*USED                                                       S01486
     C********ZLI    20 ELEMENTS, EACH 1 CHARACTER LONG                   S01486
     C***********                                                         S01486
     C********************************************************************S01486
     C***********ZFFFLN    BEGSR                           *** ZFFFLN *** S01486
     C***********                                                         S01486
     C***CLEAR*LINE DESCRIPTION .                                         S01486
     C***********          MOVEA*BLANKS   ZLI                             S01486
     C***********                                                         S01486
     C***MOVE*INTRUMENT CURRENCY TO LINE DESCRIPTION                      S01486
     C***********          MOVEAZISCY     ZLI,01                          S01486
     C***********                                                 59581   S01486
     C***IF*MARKET INSTRUMENT, RETRIEVE DATE                      59581   S01486
     C***********ISTI      IFEQ 'N'                               59581   S01486
     C***********                                                         S01486
     C***MOVE*MONTH NAME TO LINE DESCRIPTION                              S01486
     C***********          Z-ADDZMTHN     ZC      30                      S01486
     C***********          MOVEAZMNM,ZC   ZWRKA3                          S01486
     C***********          MOVEAZWRKA3    ZLI,05                          S01486
     C***********                                                         S01486
     C***MOVE*YEAR  NAME TO LINE DESCRIPTION                              S01486
     C***********          MOVE ZYRNO     ZWRKA2  2                       S01486
     C***********          MOVEAZWRKA2    ZLI,08                          S01486
     C***********          END                                    59581   S01486
     C***********                                                         S01486
     C***MOVE*PUT/CALL INDICATOR TO LINE DESCRIPTION                      S01486
     C***********          MOVEAZPCAL     ZLI,11                          S01486
     C***********                                                         S01486
     C***IF*OPTION (STRIKE PRICE NOT ZERO) OUTPUT STRIKE PRICE IN ARRAY   S01486
     C***OTHERWISE LEAVE SECTION OF ARRAY BLANK                           S01486
     C***********ZSTRP     IFNE 0                                         S01486
     C***********                                                         S01486
     C***********          Z-ADDZSTRP     ZWRKN   74                      S01486
     C***********          MOVELZWRKN     ZWRKA3  3                       S01486
     C***********          MOVELZWRKA3    ZWRKA2  2                       S01486
     C***********                                                         S01486
     C***SUPRESS*LEADING ZEROES                                           S01486
     C***********ZWRKA2    IFEQ '00'                                      S01486
     C***********          MOVEL'  '      ZWRKA3                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          MOVELZWRKA3    ZWRKA1  1                       S01486
     C***********ZWRKA1    IFEQ '0'                                       S01486
     C***********          MOVEL' '       ZWRKA3                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZWRKN     ZWRKA4  4                       S01486
     C***********          MOVEAZWRKA3    ZLI,13                          S01486
     C***********          MOVEA'.'       ZLI,16                          S01486
     C***********          MOVEAZWRKA4    ZLI,17                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***SET*ALL*  FIELDS TO BLANKS OR ZEROS                              S01486
     C***********          MOVE *BLANKS   ZISCY   3                       S01486
     C***********          Z-ADD*ZEROS    ZYRNO   20                      S01486
     C***********          Z-ADD*ZEROS    ZMTHN   20                      S01486
     C***********          MOVE *BLANKS   ZPCAL   1                       S01486
     C***********          Z-ADD*ZEROS    ZSTRP  117                      S01486
     C***********                                                         S01486
     C***********          MOVEAZLI       ZLIN   20                       S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C********************************************************************S01486
      /EJECT                                                              S71062
     C********************************************************************S71062
     C*                                                                   S71062
     C*  ZFFFLN SR. TO FORMAT THE 20A PORTFOLIO MANAGMENT LINE DESCRIPTIONS71062
     C*                                 FOR FUTURE & OPTIONS              S71062
     C*                                                                   S71062
     C*  FORMAT: XXX MMMYY X 9999.999                                     S71062
     C*          XXX = INSTRUMENT CURRENCY                                S71062
     C*          MMMYY = MONTH/YEAR                                       S71062
     C*          X = PUT/CALL INDICATOR                                   S71062
     C*          999.9999 = STRIKE PRICE                                  S71062
     C*                                                                   S71062
     C*  INPUT  FIELDS                                                    S71062
     C*       ZISCY   3A     INSTRUMENT CURRENCY                          S71062
     C*       ZMTHN   20     MONTH NUMBER                                 S71062
     C*       ZYRNO   20     YEAR NUMBER                                  S71062
     C*       ZPCAL   1A     PUT/CALL INDICATOR                           S71062
     C********ZSTRP**117*****STRIKE*PRICE***************************S71062CFF004
     C*       ZSTRP  158     STRIKE PRICE                                 CFF004
     C*                                                                   S71062
     C*  OUTPUT  FIELDS                                                   S71062
     C*       ZLIN   20A     LINE DESCRIPTION                             S71062
     C*                                                                   S71062
     C*  ARRAY USED                                                       S71062
     C*       ZLI    20 ELEMENTS, EACH 1 CHARACTER LONG                   S71062
     C*                                                                   S71062
     C********************************************************************S71062
     C           ZFFFLN    BEGSR                           *** ZFFFLN *** S71062
     C*                                                                   S71062
     C** CLEAR LINE DESCRIPTION .                                         S71062
     C                     MOVEA*BLANKS   ZLI                             S71062
     C*                                                                   S71062
     C** MOVE INTRUMENT CURRENCY TO LINE DESCRIPTION                      S71062
     C                     MOVEAZISCY     ZLI,01                          S71062
     C*                                                                   S71062
     C** IF MARKET INSTRUMENT, RETRIEVE DATE                              S71062
     C           ISTI      IFEQ 'N'                                       S71062
     C*                                                                   S71062
     C** MOVE MONTH NAME TO LINE DESCRIPTION                              S71062
     C                     Z-ADDZMTHN     ZC      30                      S71062
     C                     MOVEAZMNM,ZC   ZWRKA3                          S71062
     C                     MOVEAZWRKA3    ZLI,05                          S71062
     C*                                                                   S71062
     C** MOVE YEAR  NAME TO LINE DESCRIPTION                              S71062
     C                     MOVE ZYRNO     ZWRKA2  2                       S71062
     C                     MOVEAZWRKA2    ZLI,08                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C** MOVE PUT/CALL INDICATOR TO LINE DESCRIPTION                      S71062
     C                     MOVEAZPCAL     ZLI,11                          S71062
     C*                                                                   S71062
     C** IF OPTION (STRIKE PRICE NOT ZERO) OUTPUT STRIKE PRICE IN ARRAY   S71062
     C** OTHERWISE LEAVE SECTION OF ARRAY BLANK                           S71062
     C           ZSTRP     IFNE 0                                         S71062
     C*                                                                   S71062
     C                     Z-ADDZSTRP     ZWRKN   74                      S71062
     C                     MOVELZWRKN     ZWRKA3  3                       S71062
     C                     MOVELZWRKA3    ZWRKA2  2                       S71062
     C*                                                                   S71062
     C** SUPRESS LEADING ZEROES                                           S71062
     C           ZWRKA2    IFEQ '00'                                      S71062
     C                     MOVEL'  '      ZWRKA3                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C                     MOVELZWRKA3    ZWRKA1  1                       S71062
     C           ZWRKA1    IFEQ '0'                                       S71062
     C                     MOVEL' '       ZWRKA3                          S71062
     C                     END                                            S71062
     C**********           MOVE ZWRKN     ZWRKA4  4                                    S71062 CGL029
     C                     MOVE ZWRKN     ZWRKA4                                              CGL029
     C                     MOVEAZWRKA3    ZLI,13                          S71062
     C                     MOVEA'.'       ZLI,16                          S71062
     C                     MOVEAZWRKA4    ZLI,17                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C** SET ALL   FIELDS TO BLANKS OR ZEROS                              S71062
     C                     MOVE *BLANKS   ZISCY   3                       S71062
     C                     Z-ADD*ZEROS    ZYRNO   20                      S71062
     C                     Z-ADD*ZEROS    ZMTHN   20                      S71062
     C                     MOVE *BLANKS   ZPCAL   1                       S71062
     C***********          Z-ADD*ZEROS    ZSTRP  117                S71062CFF004
     C           *LIKE     DEFN STRP      ZSTRP                           CFF004
     C                     Z-ADD*ZEROS    ZSTRP                           CFF004
     C*                                                                   S71062
     C                     MOVEAZLI       ZLIN   20                       S71062
     C*                                                                   S71062
     C                     ENDSR                                          S71062
     C********************************************************************S71062
      /EJECT
     C********************************************************************
     C*
     C*  ZFLELN SR. TO FORMAT THE 20A PORTFOLIO MANAGMENT LINE DESCRIPTION
     C*                                 FOR LENDING
     C*
     C*  FORMAT: XXX 999.9999 DDMMMYY
     C*          XXX =  LOAN CURRENCY
     C*          999.9999 = INTEREST RATE
     C*          DDMMMYY = MATURITY DATE
     C*
     C*  INPUT  FIELDS
     C*       ZCCY    3A     LOAN CURRENCY
     C*       ZINRT  117     INTEREST RATE
     C*       ZMDAT   50     MATURITY DATE
     C*
     C*  OUTPUT  FIELDS
     C*       ZLIN   20A     LINE DESCRIPTION
     C*
     C*  ARRAY USED
     C*       ZLI    20 ELEMENTS, EACH 1 CHARACTER LONG
     C*
     C********************************************************************
     C           ZFLELN    BEGSR
     C*
     C** CLEAR LINE DESCRIPTION .
     C                     MOVEA*BLANKS   ZLI
     C*
     C**   BUILD FORMAT
     C*
     C** MOVE LOAN CURRENCY TO LINE DESCRIPTION
     C                     MOVEAZCCY      ZLI,01
     C*
     C** MOVE INTEREST RATE TO LINE DESCRIPTION
     C                     Z-ADDZINRT     ZWRKN   74
     C                     MOVELZWRKN     ZWRKA3  3
     C                     MOVELZWRKA3    ZWRKA2  2
     C*
     C** SUPRESS LEADING ZEROES
     C           ZWRKA2    IFEQ '00'
     C                     MOVEL'  '      ZWRKA3
     C                     END
     C*
     C                     MOVELZWRKA3    ZWRKA1  1
     C           ZWRKA1    IFEQ '0'
     C                     MOVEL' '       ZWRKA3
     C                     END
     C*
     C** MOVE INTEREST DETAILS INTO OUTPUT ARRAY
     C**********           MOVE ZWRKN     ZWRKA4  4                                           CGL029
     C                     MOVE ZWRKN     ZWRKA4                                              CGL029
     C                     MOVEAZWRKA3    ZLI,05
     C                     MOVEA'.'       ZLI,08
     C                     MOVEAZWRKA4    ZLI,09
     C*
     C** MOVE MATURITY DATE TO LINE DESCRIPTION
     C                     Z-ADDZMDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C*
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,14
     C**
     C** SET ALL   FIELDS TO BLANKS OR ZEROS
     C                     MOVE *BLANKS   ZCCY    3
     C                     Z-ADD*ZEROS    ZINRT  117
     C                     Z-ADD*ZEROS    ZMDAT   50
     C**
     C                     MOVEAZLI       ZLIN   20
     C**
     C                     ENDSR
     C*******************************************************************
      /EJECT
     C********************************************************************
     C*
     C*    ZFRELN SR. TO FORMAT THE 20A PORTFOLIO MANAGMENT LINE DESCRIPTION
     C*                                 FOR RETAIL
     C*
     C*  FORMAT: 999999 XXX 9999 99
     C*
     C*          999999 CUSTOMER NUMBER
     C*          XXX = CURRENCY
     C*          9999 = ACCOUNT CODE
     C*          99 = ACCOUNT SEQUENCE
     C*
     C*  INPUT  FIELDS
     C*       ZCNUM   60     CUSTOMER NUMBER
     C*       ZCCY    3A     CURRENCY
     C*       ZACOD   40     ACCOUNT CODE
     C*       ZACSQ   20     ACCOUNT SEQUENCE
     C*
     C*  OUTPUT  FIELDS
     C*       ZLIN   20A     LINE DESCRIPTION
     C*
     C*  ARRAY USED
     C*      ZLI    20 ELEMENTS, EACH 1 CHARACTER LONG
     C*
     C********************************************************************
     C           ZFRELN    BEGSR                           *** ZFRELN ***
     C*
     C** CLEAR LINE DESCRIPTION .
     C                     MOVEA*BLANKS   ZLI
     C*
     C** MOVE CUSTOMER NUMBER TO LINE DESCRIPTION
     C                     MOVE ZCNUM     ZWRKA6  6
     C                     MOVEAZWRKA6    ZLI,01
     C*
     C** MOVE CURRENCY TO LINE DESCRIPTION
     C***********          MOVEAZCCY      ZLI,08                          085862
     C                     MOVEAZCCY      ZLI,07                          085862
     C*
     C** MOVE ACCUONT CODE TO LINE DESCRIPTION
     C**********           MOVE ZACOD     ZWRKA4  4                                           CGL029
     C                     MOVE ZACOD     ZWRKA4                                              CGL029
     C***********          MOVEAZWRKA4    ZLI,12                          085862
     C                     MOVEAZWRKA4    ZLI,10                          085862
     C*
     C** MOVE ACCUONT SEQUENCE TO LINE DESCRIPTION
     C                     MOVE ZACSQ     ZWRKA2  2
     C***********          MOVEAZWRKA2    ZLI,17                          085862
     C                     MOVEAZWRKA2    ZLI,14                          085862
     C                     MOVEAZBRCA     ZLI,16                          085862
     C**
     C**  SET ALL   FIELDS TO BLANKS OR ZEROS
     C**********           Z-ADD*ZEROS    ZCNUM   60                                          CSD027
     C                     MOVE *BLANKS   ZCNUM   6                                           CSD027
     C                     MOVE *BLANKS   ZCCY    3
     C**********           Z-ADD*ZEROS    ZACOD   40                                          CGL029
     C                     Z-ADD*ZEROS    ZACOD  100                                          CGL029
     C                     Z-ADD*ZEROS    ZACSQ   20
     C                     MOVE *BLANKS   ZBRCA                           085862
     C**
     C                     MOVEAZLI       ZLIN   20
     C**
     C                     ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
     C*
     C** ZFFDLN SR. TO FORMAT THE 20A PORTFOLIO MANAGEMENT LINE DESC.
     C*
     C**                                  FORMAT: XXX 999.9999 DDMMMYY
     C**                                       OR: XXX 999.9999 999
     C**         XXX = CURRENCY
     C**         999.9999 = INTEREST RATE
     C**         DDMMMYY = MATURITY DATE (IF MATURITY DATE NOT = 0)
     C**         999 = NOTICE DAYS       (IF MATURITY DATE = 0 )
     C*
     C*
     C** INPUT  FIELDS
     C**      ZCCY    3A     CURRENCY
     C**      ZINTR  117     INTEREST RATE
     C**      ZMDAT   50     MATURITY DATE
     C**      ZNOTD   30     NOTICE DAYS
     C*
     C** OUTPUT  FIELDS
     C**      ZLIN   20A     LINE DESCRIPTION
     C*
     C** ARRAY USED
     C*       ZLI    20 ELEMENTS, EACH 1 CHARACTER LONG
     C*
     C********************************************************************
     C           ZFFDLN    BEGSR                           *** ZFFDLN ***
     C*
     C** CLEAR LINE DESCRIPTION .
     C                     MOVEA*BLANKS   ZLI
     C*
     C                     MOVEAZCCY      ZLI,01
     C                     Z-ADDZINTR     ZWRKN   74
     C                     MOVELZWRKN     ZWRKA3  3
     C                     MOVELZWRKA3    ZWRKA2  2
     C*
     C** SUPPRESS LEADING ZEROES
     C           ZWRKA2    IFEQ '00'
     C                     MOVEL'  '      ZWRKA3
     C                     END
     C*
     C                     MOVELZWRKA3    ZWRKA1  1
     C*
     C           ZWRKA1    IFEQ '0'
     C                     MOVEL' '       ZWRKA3
     C                     END
     C*
     C**********           MOVE ZWRKN     ZWRKA4  4                                           CGL029
     C                     MOVE ZWRKN     ZWRKA4                                              CGL029
     C                     MOVEAZWRKA3    ZLI,05
     C                     MOVEA'.'       ZLI,08
     C                     MOVEAZWRKA4    ZLI,09
     C*
     C** IF MATURITY DATE ZERO OUTPUT NOTICE DAYS TO FORMATTED LINE
     C           ZMDAT     IFEQ *ZERO
     C                     MOVE ZNOTD     ZWRKA3  3
     C                     MOVEAZWRKA3    ZLI,14
     C*
     C** OTHERWISE OUTPUT MATURITY DATE
     C                     ELSE
     C                     Z-ADDZMDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C*
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C*
     C                     MOVEAZADATE    ZLI,14
     C                     END
     C*
     C** SET ALL  FIELDS TO BLANK OR ZERO
     C                     MOVE *BLANKS   ZCCY    3
     C                     Z-ADD*ZEROS    ZINTR  117
     C                     Z-ADD*ZEROS    ZMDAT   50
     C                     Z-ADD*ZEROS    ZNOTD   30
     C*
     C                     MOVEAZLI       ZLIN   20
     C*
     C                     ENDSR
     C**************************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      **************************************************************************
      *                                                                        *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PAA     - TO INITIALIZE WORK FIELDS AND ACCESS STANDING DATA          *
      * #PR04    - PROCESS FF DETAILS                                          *
      * #PR05    - PROCESS DL DETAILS                                          *
      * #PR06    - PROCESS LE DETAILS                                          *
      * #PR07    - PROCESS RE DETAILS                                          *
      * #PR08    - PROCESS SE POSITION DETAILS                                 *
      * #PR09    - PORCESS SE TRADES AND DEPOT MOVEMENT DETAILS                *
      * #AU01    -                                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           *PSSR     BEGSR
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C**
     C** ROLL BACK CHANGES, PRINT DUMP AND CANCEL PROGRAM
     C**
     C                     DUMP
     C**
     C                     RETRN
     C**
     C                     ENDSR
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  CPY@
(c) Finastra International Limited 2001
