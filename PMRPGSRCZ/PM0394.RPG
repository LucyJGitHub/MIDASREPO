     H        1                                                           S01486
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM DL daily transactions extract')               *
     H***********                                                         S01486
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management Module                          *
     F*                                                               *
     F*  PM0394  - DL DAILY TRANSACTION EXTRACT                       *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CGL165             Date 15Feb17               *
      *  Prev Amend No. CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 11Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CDL020             Date 03Feb04               *
      *                 CDL019             Date 03Feb04               *
      *                 CDL018             Date 03Feb04               *
      *                 CDL017             Date 03Feb04               *
      *                 CDL016             Date 03Feb04               *
      *                 CGL029             Date 01Sep03               *
      *                 222727             Date 05Nov03               *
      *                 CDL010             Date 02Aug02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 182961             Date 21Apr01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CPM004             Date 08Feb96               *
      *                 086386             Date 21Mar95               *
     F*                 085867             DATE 16MAR95               *
     F*                 082664             DATE 09MAR95               *
     F*                 081353             DATE 09JAN95               *
     F*                 S01486             DATE 04OCT94               *
     F*                 58933              DATE 30JUL93               *
     F*                 56452              DATE 12JUN93               *
     F*                 B9991      DT      DATE 13NOV91               *
     F*                 B9930      ADIF    DATE 13NOV91               *
     F*                 B8931      FG      DATE 13NOV91               *
     F*                 R05913             DATE 30APR91               *
     F*                 R05880             DATE 24APR91               *
     F*                 R05658             DATE 11MAR91               *
     F*                 R10040             DATE 19SEP90               *
     F*                 R10038             DATE 16SEP90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CDL020 - Apply Base Rate at Value Date (Recompile)           *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *           (Recompile)                                         *
      *  CDL018 - Multiple Settlement Accounts on Loans/Deposits      *
      *           (Recompile)                                         *
      *  CDL017 - Penalty Fee & Early Maturity of Fixed Term Loan/Dep *
      *           (Recompile)                                         *
      *  CDL016 - Automatic rollover of Fixed Term Loans/Deposits     *
      *           (Recompile)                                         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  CDL010 - Prevent last user that actioned the trade from      *
      *           authorising it.Recompile due to changes in MMDELDPP *
      *  182961 - Database error occurred due to a blank key field    *
      *           (Instrument Type).  The default Instrument type in  *
      *           PF/SDPORTPD is taken if a blank instrument type is  *
      *           encountered.                                        *
      *  CDL006 - Dealing Fiduciary                                   *
     F*  CPM004 - Bank Portfolios.                                    *
     F*  086386 - Fix on upgrade PM                                   *
     F*  085867 - Change Pay A/C and Rec A/C to have the branch code  *
     F*  082664 - REMOVE DETAILS OF FRA/IRS FROM TOTALS               *
     F*  081353 - Remove ZSFILE coding                                *
     F*  S01486 - Portfolio Management Upgrade to R10                 *
     F*  58933  - REMOVE FRA/IRS DEALS FROM PROGRAM                   *
     F*  56452  - UNSURE DETAILS OUTPUT FROM CUSTOMER PERSPECTIVE     *
     F*  B9991  - ADDING OF SOME FIELDS TO IMPROVE PM0400P1 REPORT    *
     F*  B9930  - WRONG ACCOUNT NAME ON REPORT PM0400P1               *
     F*           FIELD ANAM NOT DEFINED IN FILE ACNUM                *
     F*  B8931  - IF DEAL TYPE CD ISSUED, ORIGINAL CUSTOMER NUMBER    *
     F*           REPLACED BY BRANCH INTERNAL CUSTOMER NUMBER.        *
     F*           RETRIEVE THE ORIGINAL CUSTOMER NUMBER.              *
     F*  R05913 - CHANGE TEXT TO BE 30 CHARACTERS LONG                *
     F*  R05880 - TRANSACTIONS INSERTED AND DELETED ON SAME DAY       *
     F*           SHOULD NOT BE OUPUT ON REPORT                       *
     F*  R05658 - FOR AMENDMENTS SHOW TYPE OF ORIGINAL INSTRUMENT IN  *
     F*           TEXT                                                *
     F*  R10040 - OUTPUT ACCOUNT NAME                                 *
     F*  R10038 - OUTPUT TEXT FOR FX DEAL IN DIFFERENT FORMAT         *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FSDPORTPDIF  E                    DISK         KINFSR *PSSR          182961
     F***PM0394AUO***E                    PRINTER                         S01486
     F***PM0394AUO   E                    PRINTER      KINFDS SPOOLUS01486081353
     FPM0394AUO   E                    PRINTER                            081353
     F***SDBANKPDIF**E                    DISK                            S01486
     F***PREFIX BJ***                                                     S01486
     F***************                               KINFSR *PSSR          S01486
     F***PMTRCNZZUF**E           K        DISK                      A     S01486
     FPMTRCNPAUF  E           K        DISK                      A        S01486
     F** PREFIX SA
     F                                              KINFSR *PSSR
     F***PMTRCNPPO***E           K        DISK                            S01486
     FPMTRCNPDO   E           K        DISK                               S01486
     F** PREFIX SA
     F                                              KINFSR *PSSR
     FDEALS   IF  E           K        DISK
     F                                              KINFSR *PSSR
     F***SDCUSTL0IF**E           K        DISK                            S01486
     F***PREFIX BB***                                                     S01486
     F***************                               KINFSR *PSSR          S01486
     F***SDPLINPDIF**E           K        DISK                            S01486
     F***PREFIX*PD***                                                     S01486
     F***************                               KINFSR *PSSR          S01486
     F***SDDTSTPPIF**E           K        DISK                            S01486
     FFDDTSTL1IF  E           K        DISK                               S01486
     F** PREFIX P7
     F                                              KINFSR *PSSR
     F***DEAMSQI*IS**E           K        DISK                            S01486
     FPMDEAML0IS  E           K        DISK                               S01486
     F            DEAMSDIF                          KRENAMEDEAMSQIF
     F                                              KINFSR *PSSR
     F*DEALSQG*IS**E           K        DISK                              58933
     F***         DEALSDGF                          KRENAMEDEALSQGF       58933
     F***                                           KINFSR *PSSR          58933
     F***DEALSQC*IS**E           K        DISK                            S01486
     FPMDEALL7IS  E           K        DISK                               S01486
     F            DEALSDCF                          KRENAMEDEALSQCF
     F                                              KINFSR *PSSR
     F***DEALSQB*IP**E           K        DISK                            S01486
     FPMDEALL6IP  E           K        DISK                               S01486
     F            DEALSDBF                          KRENAMEDEALSQBF
     F                                              KINFSR *PSSR
     FACCNT   IF  E           K        DISK                               R10040
     F            ACCNTAAF                          KIGNORE               R10040
     F            ACCNTACF                          KIGNORE               R10040
     F                                              KINFSR *PSSR          R10040
     F*ACNUM   IF  E           K        DISK                        R10040B9930
     FACNUMA  IF  E           K        DISK                               B9930
     F                                              KINFSR *PSSR          R10040
     F            ACCNTABF                          KRENAMEACNUMTBF       R10040
     F***SDACOFL0IF**E           K        DISK                      B9991 S01486
     F***PREFIX*AZ***                                               B9991 S01486
     F***************                               KINFSR *PSSR    B9991 S01486
     FPMDSPGL3IF  E           K        DISK                               B9991
     F** PREFIX PA                                                        B9991
     F                                              KINFSR *PSSR          B9991
     F***MMDELDL1IF**E           K        DISK                      B8931 S01486
     FMMDELDL2IF  E           K        DISK                               S01486
     F** PREFIX HK                                                        B8931
     F                                              KINFSR *PSSR          B8931
      /EJECT
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F*    UNUSED INDICATORS
     F*    -----------------
     F*       ..  ..  ..  ..  05  06  07  08  09  10
     F*       11  12  13  14  15  16  17  18  19  20
     F*       21  22  23  24  25  26  27  28  29  30
     F*       31  32  33  34  35  36  37  38  39  40
     F*       41  42  43  44  45  46  47  48  49  50
     F*       51  52  53  54  55  56  57  58  59  60
     F*       61  62  63  64  65  66  67  68  69  70
     F*       ..  ..  ..  74  75  76  77  78  79  80
     F*       81  82  83  84  85  86  87  88  89  90
     F*       91  92  93  94  95  96  97  98  99
     F*
     F**   INDICATOR USAGE
     F**   ---------------
     F*
     F**   01      FX DEALS PROCESSING
     F**   02      MM DEALS PROCESSING
     F**   03      FRA/IRS DEALS PROCESSING
     F**   04      DEAL AMENDMENTS PROCESSING
     F**   41      RETRIEVE ORIGINAL CUSTOMER NUMBER                       B8931
     F**   71      INITIAL PROCESSING
     F**   72      FILES ACCESS INDICATOR
     F**   73      DEAL AMENDMENT TYPE LOKUP INDICATOR
     F*
      /EJECT
     F*
     F*   SUB-ROUTINE DEFINITIONS
     F*   -----------------------
     F*
     F**   #INIT    INITIAL PROCESSING
     F**   #P01     FX DEAL PROCESSING
     F**   #P02     MM DEAL PROCESSING
     F**   #P03     FRA/IRS DEAL PROCESSING
     F**   #P04     DEAL AMENDMENT PROCESSING
     F**   #W01     WRITE FX DEALS TO TRANSACTION FILE
     F**   #W02     WRITE MM DEALS TO TRANSACTION FILE
     F**   #W0301   WRITE FR,RS,RL FRA/IRS DEALS TO TRANSACTION FILE
     F**   #W0302   WRITE RX FRA/IRS DEALS TO TRANSACTION FILE
     F**   #W0401   WRITE PI,PD DEAL AMENDMENTS  TO TRANSACTION FILE
     F**   #W0402   WRITE SC,CI,SI DEAL AMENDMENT TO TRANSACTION FILE
     F**   #P05     AUDIT PROCESSING
     F**   #W0501   WRITE TO TRANSACTION REPORT CONTROL FILE
     F**   #W0502   WRITE TO RE DAILY TRANSACTION EXTRACT AUDIT REPORT
     F**   #DTST    ACCESS DEAL TYPE/SUB-TYPE RECORD
     F**   #INST    ACCESS INSTRUMENT TYPE RECORD
     F**   #CUST    ACCESS CUSTOMER DETAILS
     F**   #DEAL    ACCESS DEAL RECORD
     F*
      /EJECT
     E** FORMAT DL DETAILS FOR OUTPUT  (SR/ZFDLLN)
     E                    ZLI        20  1
     E                    AMTPAR  5   5  2               AMEND TYPES
     E                    NRDEPO  1   5 20               AMEND NARR.
     E                    NRLOAN  1   5 20               AMEND NARR.
      /COPY ZSRSRC,ZDATE2Z1
     E*
     E**   Array for copyright
     E                    CPY@    1   1 80               COPYRIGHT
      /EJECT
     I*
     I***DEALSQBF****01                                                   S01486
     I***DEALSQCF****02                                                   S01486
     I*DEALSQGF****03                                                     58933
     I***DEALSDCF****01                                             S01486086386
     I***DEALSDBF****02                                             S01486086386
     IDEALSQBF    01                                                      086386
     IDEALSQCF    02                                                      086386
     IDEAMSQIF    04
     I*
     I** DATA STRUCTURE TO DEFINE DEAL TYPE/SUB-TYPE
     I            DS
     I                                        1   4 DSDTST
     I                                        1   2 DTYP
     I                                        3   4 DLST
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I***LDA********UDS                            256
     I**************                        132 183 DBLOT
     I**************                        132 141 DBFILE
     ILDA         DS                            256
     I                                      134 183 DBLOT
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 183 DBASE
     I*                                                                   CPM004
     I** Input parameters on call to AOPLCSR1                             CPM004
     II@PARM      DS                            256                       CPM004
     I                                        1   1 I#PORS                CPM004
     I                                        2   5 I#R997                CPM004
     I                                        6  15 I#CUST                CPM004
     I                                       16  18 I#BRCA                CPM004
     I                                       19  20 I#BOOK                CPM004
     I                                       21  24 I#PTFR                CPM004
     I                                       25  34 I#CPGM                CPM004
     I*                                                                   CPM004
     I** Output parameters on call to AOPLCSR1                            CPM004
     IO@PARM      DS                            256                       CPM004
     I                                        1   2 O#BOOK                CPM004
     I                                        3   6 O#PTFR                CPM004
     I                                        7  12 O#BICN                CPM004
     I                                       13  22 O#CRNM                CPM004
     I                                       23  24 O#ACOF                CPM004
     ISDBANK    E DSSDBANKPD                                              S01486
     I** EXTERNAL DS FOR BANK DETAILS                                     S01486
     ISDPORT    E DSSDPORTPD                                              CPM004
     I** EXTERNAL DS FOR PORTFOLIO DETAILS                                CPM004
     ISDPLIN    E DSSDPLINPD                                              S01486
     I** EXTERNAL DS FOR INSTRUMENT DETAILS                               S01486
     ISDCUST    E DSSDCUSTPD                                              S01486
     I** EXTERNAL DS FOR CUSTOMER DETAILS                                 S01486
     ISDPLCS    E DSSDPLCSPD                                              CPM004
     I**  SD Portfolio Management Customer details                        CPM004
     ISCSARD    E DSSCSARDPD                                              CDL006
      ** External Data Structure for Switchable Features                  CDL006
      *                                                                   CDL006
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, LONG  DATA STRUCTURE                S01486
     I****SPOOLU      DS                                           S01486 081353
     I************************************** 83  92 SFILEU         S01486 081353
     I*********************************** B 123 1240SFNUMU         S01486 081353
     I*********************************** B 367 3680LINE1          S01486 081353
     I*
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  P R O G R A M     I N I T I A L I S A T I O N                *
     C*                                                               *
     C*****************************************************************
     C*
     C***DISPLAY*NON-PORTFOLIO*DISPALY*PICTURE*FROM*PF/PMICD1PP********   S01486
     C***Display*non-portfolio display picture from PF/SDPORTPD    S01486 CPM004
     C************ENTRY    PLIST                                          CPM004
     C***********          PARM           P9DP97  1                       S01486
     C***********          PARM           FCDP97  1                S01486 CPM004
     C*
     C** KEY TO ACCESS DEAL TYPE/SUB-TYPE FILE
     C           P1KEY     KLIST
     C                     KFLD           DTYP
     C                     KFLD           DLST
     C*
     C** PERFORM INITIAL PROCESSING
     C           WW394     IFEQ *BLANK
     C                     EXSR #INIT
     C                     END
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C*
     C**              MAIN  PROCESSING
     C*========================================================================
     C*
     C** SAVE LAST CHANGE TYPE
     C                     MOVE CHTP      WWCHTP
     C*
     C** PROCESS FX DEALS
     C           *IN01     IFEQ '1'
     C                     EXSR #P01
     C                     END
     C*
     C** PROCESS MM DEALS
     C           *IN02     IFEQ '1'
     C                     EXSR #P02
     C                     END
     C****                                                                58933
     C***PROCESS FRA/IRS DEALS                                            58933
     C****       *IN03     IFEQ '1'                                       58933
     C****                 EXSR #P03                                      58933
     C****                 END                                            58933
     C*
     C** PROCESS DEAL AMENDMENTS
     C           *IN04     IFEQ '1'
     C                     EXSR #P04
     C                     END
     C*
     C** PERFORM AUDIT PROCESSING
     CLR                   EXSR #P05
     C*
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #P01          -  PROCESS FX DEALS
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS         -  #W01   - WRITE FX DEAL TO TRANSACTIONS FILE
     C**                    #DTST  - ACCESS DEAL TYPE/SUB-TYPE DETAILS
     C**                    #INST  - ACCESS PM INSTRUMENT TYPE DETAILS
     C**                    #CUST  - ACCESS CUSTOMER DETAILS
     C**
     C*=========================================================================
     C*
     C           #P01      BEGSR                           *** #P01   ***
     C*
     C***WHEN*CHANGE*OF*DEAL*TYPE*OR*SUB-TYPE,*ACCESS*PF/SDDTSTPP******   S01486
     C** When change of deal type or sub-type, access PF/FDDTSTL1         S01486
     C** TO GET PM INSTRUMENT TYPE DETAILS
     C           DTYP      IFNE WWDTYP
     C           DLST      ORNE WWDLST
     C                     EXSR #DTST
     C                     EXSR #INST
     C                     MOVE DTYP      WWDTYP
     C                     MOVE DLST      WWDLST
     C                     END
     C*
     C** WHEN CHANGE OF CUSTOMER, ACCESS THE NEW CUSTOMER DETAILS
     C           CNUM      IFNE WWCNUM
     C                     MOVE CNUM      WWPNP8
     C                     EXSR #CUST
     C**********           Z-ADDCNUM      WWCNUM                                              CSD027
     C                     MOVE CNUM      WWCNUM                                              CSD027
     C                     END
     C*                                                                   CPM004
     C** When change of booking branch, access branch internal customer   CPM004
     C** number, branch customer report name and branch a/c officer       CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C           BRCA      ANDNEWWBRCA                                    CPM004
     C                     EXSR #BRCA                                     CPM004
     C                     MOVELBRCA      WWBRCA  3                       CPM004
     C                     END                                            CPM004
     C*
     C** WRITE FX DEAL TO TRANSACTION REPORT CONTROL FILE
     C                     EXSR #W01
     C                     ADD  1         FXCPT   50
     C*
     C                     ENDSR                           *** #P01 END **
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #P02          -  PROCESS MM DEALS
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS         -  #W02   - WRITE MM DEAL TO TRANSACTIONS FILE
     C**                    #DTST  - ACCESS DEAL TYPE/SUB-TYPE DETAILS
     C**                    #INST  - ACCESS PM INSTRUMENT TYPE DETAILS
     C**                    #CUST  - ACCESS CUSTOMER DETAILS
     C**
     C*=========================================================================
     C*
     C           #P02      BEGSR                           *** #P02   ***
     C*
     C***WHEN*CHANGE*OF*DEAL*TYPE*OR*SUB-TYPE,*ACCESS*PF/SDDTSTPP******   S01486
     C** When change of deal type or sub-type, access PF/FDDTSTL1         S01486
     C** TO GET PM INSTRUMENT TYPE DETAILS
     C           DTYP      IFNE WWDTYP
     C           DLST      ORNE WWDLST
     C                     EXSR #DTST
     C                     EXSR #INST
     C                     MOVE DTYP      WWDTYP
     C                     MOVE DLST      WWDLST
     C                     END
     C**                                                                  B8931
     C**  If deal type CD issued, original customer number replaced       B8931
     C**  by branch internal customer number. Retrieve the original       B8931
     C**  customer number.                                                B8931
     C**                                                                  B8931
     C           DTYP      IFEQ 'CI'                                      B8931
     C***********DLNO      CHAINMMDELDL1             41             B8931 S01486
     C           DLNO      CHAINMMDELDL2             41                   S01486
     C**N41*****           Z-ADDHKCNUM    CNUM                                          B8931 CSD027
     C  N41                MOVE HKCNUM    CNUM                                                CSD027
     C                     END                                            B8931
     C**                                                                  B8931
     C*
     C** WHEN CHANGE OF CUSTOMER, ACCESS THE NEW CUSTOMER DETAILS
     C           CNUM      IFNE WWCNUM
     C                     MOVE CNUM      WWPNP8
     C                     EXSR #CUST
     C**********           Z-ADDCNUM      WWCNUM                                              CSD027
     C                     MOVE CNUM      WWCNUM                                              CSD027
     C                     END
     C*                                                                   CPM004
     C** When change of booking branch, access branch internal customer   CPM004
     C** number, branch customer report name and branch a/c officer       CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C           BRCA      ANDNEWWBRCA                                    CPM004
     C                     EXSR #BRCA                                     CPM004
     C                     MOVELBRCA      WWBRCA                          CPM004
     C                     END                                            CPM004
     C*
     C** WRITE MM DEAL TO TRANSACTION REPORT CONTROL FILE
     C                     EXSR #W02
     C                     ADD  1         MMCPT   50
     C*
     C                     ENDSR                           *** #P02 END **
     C********************************************************************58933
      ****/EJECT                                                          58933
     C********************************************************************58933
     C****                                                                58933
     C**** #P03          -  PROCESS FRA/IRS DEALS                         58933
     C****                                                                58933
     C**** CALLED BY     -  MAIN PROCESSING                               58933
     C****                                                                58933
     C**** CALLS         -  #W0301 - WRITE FR, RS, RL DEAL TO             58933
     C****                           TRANSACTION REPORT CONTROL FILE      58933
     C****                  #W0302 - WRITE RX DEAL TO TRANSACTION         58933
     C****                           REPORT CONTROL FILE                  58933
     C****                  #DTST  - ACCESS DEAL TYPE/SUB-TYPE DETAILS    58933
     C****                  #INST  - ACCESS PM INSTRUMENT TYPE DETAILS    58933
     C****                  #CUST  - ACCESS CUSTOMER DETAILS              58933
     C****                                                                58933
     C****================================================================58933
     C****                                                                58933
     C****       #P03      BEGSR                           *** #P03   *** 58933
     C****                                                                58933
     C****HEN CHANGE OF DEAL TYPE OR SUB-TYPE, ACCESS PF/SDDTSTPP         58933
     C****O GET PM INSTRUMENT TYPE DETAILS                                58933
     C****       DTYP      IFNE WWDTYP                                    58933
     C****       DLST      ORNE WWDLST                                    58933
     C****                 EXSR #DTST                                     58933
     C****                 EXSR #INST                                     58933
     C****                 MOVE DTYP      WWDTYP                          58933
     C****                 MOVE DLST      WWDLST                          58933
     C****                 END                                            58933
     C****                                                                58933
     C****HEN CHANGE OF CUSTOMER, ACCESS THE NEW CUSTOMER DETAILS         58933
     C****       CNUM      IFNE WWCNUM                                    58933
     C****                 MOVE CNUM      WWPNP8                          58933
     C****                 EXSR #CUST                                     58933
     C****                 Z-ADDCNUM      WWCNUM                          58933
     C****                 END                                            58933
     C****                                                                58933
     C****RITE FRA/IRS DEALS TO TRANSACTION REPORT CONTROL FILE           58933
     C****       DTYP      IFEQ 'FR'                                      58933
     C****       DTYP      OREQ 'RS'                                      58933
     C****       DTYP      OREQ 'RL'                                      58933
     C****                 EXSR #W0301                                    58933
     C****                 ADD  1         FR1CPT  50                      58933
     C****                 ELSE                                           58933
     C****                 EXSR #W0302                                    58933
     C****                 ADD  1         FR2CPT  50                      58933
     C****                 END                                            58933
     C****                                                                58933
     C****                 ENDSR                           *** #P03 END **58933
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #P04          -  PROCESS DEAL AMENDMENTS
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS         -  #W0401 - WRITE PI, PD DEAL AMENDMENT TO
     C**                             TRANSACTION REPORT CONTROL FILE
     C**                    #W0402 - WRITE SC, CI, SI DEAL AMENDMENT
     C**                             TO TRANSACTION REPORT CONTROL FILE
     C**                    #DEAL  - ACCESS DEAL DETAILS
     C**                    #DTST  - ACCESS DEAL TYPE/SUB-TYPE DETAILS
     C**                    #INST  - ACCESS PM INSTRUMENT TYPE DETAILS
     C**                    #CUST  - ACCESS CUSTOMER DETAILS
     C**
     C*=========================================================================
     C*
     C           #P04      BEGSR                           *** #P04   ***
     C*
     C** SAVE DEAL AMENDMENT FIELDS
     C                     Z-ADDVDAT      WWVDAT
     C***********          MOVE BRCD      WWBRCD                          S01486
     C                     MOVE BRCA      WWBRCD                          S01486
     C*
     C** ACCESS DEALS FILE TO GET PORTFOLIO REFERENCE AND BRANCH CODE
     C                     EXSR #DEAL
     C*                                                                   R05658
     C** SET UP AMENDMENT NARRATIVE                                       R05658
     C                     MOVE '0'       *IN73                           R05658
     C                     Z-ADD1         I       10                      R05658
     C           AMTP      LOKUPAMTPAR,I                 73               R05658
     C           *IN73     IFEQ '1'                                       R05658
     C           DTYP      IFEQ 'IT'                                      R05658
     C           DTYP      OREQ 'TD'                                      R05658
     C           DTYP      OREQ 'CD'                                      R05658
     C           DTYP      OREQ 'CI'                                      R05658
      *                                                                   CDL006
      ** Include condition on deal types FT,DT and LT if CDL006 is ON.    CDL006
      *                                                                   CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
     C                     MOVELNRDEPO,I  WWDESI                          R05658
     C                     ELSE                                           R05658
     C                     MOVELNRLOAN,I  WWDESI                          R05658
     C                     END                                            R05658
     C*********************MOVELAMNAAR,I  WWDESI                          R05658
     C                     END                                            R05658
     C*
     C** EXTRACT DEAL AMENDMENT IF DISPLAY NON-PORTFOLIO PICTURE
     C** (9997) INDICATOR IS NOT 'N' AND IF PORTFOLIO REFERENCE
     C** NOT BLANK
     C           PTFR      IFEQ *BLANKS
     C                     GOTO #P041
     C                     END
     C*
     C           PTFR      IFEQ '9997'
     C***********P9DP97    ANDEQ'N'                                       S01486
     C           FCDP97    ANDEQ'N'                                       S01486
     C                     GOTO #P041
     C                     END
     C*
     C***WHEN*CHANGE*OF*DEAL*TYPE*OR*SUB-TYPE,*ACCESS*PF/SDDTSTPP******   S01486
     C** When change of deal type or sub-type, access PF/FDDTSTL1         S01486
     C** TO GET PM INSTRUMENT TYPE DETAILS
     C           DTYP      IFNE WWDTYP
     C           DLST      ORNE WWDLST
     C                     EXSR #DTST
     C                     EXSR #INST
     C                     MOVE DTYP      WWDTYP
     C                     MOVE DLST      WWDLST
     C                     END
     C**                                                                  B8931
     C**  If deal type CD issued, original customer number replaced       B8931
     C**  by branch internal customer number. Retrieve the original       B8931
     C**  customer number.                                                B8931
     C**                                                                  B8931
     C           DTYP      IFEQ 'CI'                                      B8931
     C***********DLNO      CHAINMMDELDL1             41             B8931 S01486
     C           DLNO      CHAINMMDELDL2             41                   S01486
     C**N41*****           Z-ADDHKCNUM    CNUM                                          B8931 CSD027
     C  N41                MOVE HKCNUM    CNUM                                                CSD027
     C                     END                                            B8931
     C*
     C** WHEN CHANGE OF CUSTOMER, ACCESS THE NEW CUSTOMER DETAILS
     C           CNUM      IFNE WWCNUM
     C                     MOVE CNUM      WWPNP8
     C                     EXSR #CUST
     C**********           Z-ADDCNUM      WWCNUM                                              CSD027
     C                     MOVE CNUM      WWCNUM                                              CSD027
     C                     END
     C*                                                                   CPM004
     C** When change of booking branch, access branch internal customer   CPM004
     C** number, branch customer report name and branch a/c officer       CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C           BRCA      ANDNEWWBRCA                                    CPM004
     C                     EXSR #BRCA                                     CPM004
     C                     MOVELBRCA      WWBRCA                          CPM004
     C                     END                                            CPM004
     C*
     C** WRITE DEAL AMEDMENT TO TRANSACTION REPORT CONTROL FILE
     C           AMTP      IFEQ 'PI'
     C           AMTP      OREQ 'PD'
     C                     EXSR #W0401
     C                     ADD  1         DM1CPT  50
     C                     ELSE
     C                     EXSR #W0402
     C                     ADD  1         DM2CPT  50
     C                     END
     C*
     C           #P041     ENDSR                           *** #P04 END **
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #W01          -  WRITE FX DEAL TO TRANSACTIONS FILE
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #W01      BEGSR                           *** #W01   ***
     C*
     C                     MOVE 'D'       SARECI
     C                     MOVE BBACOC    SAACOC
     C**********           Z-ADDCNUM      SACNUM                                              CSD027
     C                     MOVE CNUM      SACNUM                                              CSD027
     C                     MOVE PTFR      SAPTFR
     C**********           MOVE P7INNR    SAINNR                          S01486
     C                     MOVE INNR      SAINNR                          S01486
     C                     MOVE 'DB'      SAMODI
     C                     MOVE DLNO      SATRNB
     C                     MOVE DTYP      SATRTP
     C                     MOVE DLST      SATRST
     C                     MOVE *BLANKS   SATDSS
     C                     Z-ADD*ZEROS    SANMDP
     C                     MOVE *BLANKS   SASPBS
     C                     Z-ADD*ZEROS    SASEQA
     C                     Z-ADDDDAT      SADDAT
     C                     Z-ADDVDAT      SAVDAT
     C                     Z-ADDOTDT      SAMDAT
     C**********           Z-ADDBRCD      SABRCD                          S01486
     C                     MOVELBRCA      SABRCD                          S01486
     C                     Z-ADDPUAM      SAAMT1
     C                     Z-ADDSLAM      SAAMT2
     C                     MOVE PUCY      SACCY1
     C                     MOVE SLCY      SACCY2
     C                     Z-ADD*ZEROS    SAPRC1
     C                     Z-ADD*ZEROS    SAPRC2
     C                     Z-ADDEXRT      SARATA
     C                     Z-ADD*ZEROS    SARATB
     C                     MOVE *BLANKS   SAMDV1
     C                     MOVE *BLANKS   SAMDV2
     C                     Z-ADD*ZEROS    SABRT1
     C                     Z-ADD*ZEROS    SABRT2
     C                     Z-ADD*ZEROS    SARAI1
     C                     Z-ADD*ZEROS    SARAI2
     C                     MOVE *BLANKS   SAFRQ1
     C                     MOVE *BLANKS   SAFRQ2
     C                     Z-ADD*ZEROS    SAIPD1
     C                     Z-ADD*ZEROS    SAIPD2
     C                     Z-ADD*ZEROS    SANDYS
     C                     Z-ADD*ZEROS    SAAINT
     C                     MOVE *BLANKS   SABROK
     C                     Z-ADDSODN      SASWOD
     C                     MOVE *BLANKS   SAACRI
     C                     Z-ADD*ZEROS    SAPURI
     C                     Z-ADDBCEQ      SAVAL1
     C                     Z-ADD*ZEROS    SAVAL2
     C                     MOVE PDDSPG    SARCOA
     C                     MOVE PDITDS    SARSEA
     C           *IN01     IFEQ '1'                                       R10038
     C***********          MOVELP7DTNR    WWWK16 16                R10038 S01486
     C                     MOVELNARR11    WWWK16 16                       S01486
     C                     MOVE *BLANKS   SAT1XT                          R10038
     C****                 MOVELPUCY      SAT1XT                    R05913R10038
     C****                 MOVE WWWK16    SAT1XT                    R05913R10038
     C                     MOVELPUCY      WWWK20 20                       R05913
     C                     MOVE WWWK16    WWWK20                          R05913
     C                     MOVELWWWK20    SAT1XT                          R05913
     C                     ELSE                                           R10038
     C***********          MOVELP7DTNR    SAT1XT                          S01486
     C                     MOVELNARR11    SAT1XT                          S01486
     C                     END                                            R10038
     C                     MOVELSLCY      ZPUCY                           R10038
     C***********          MOVELSLCY      ZSLCY                           R10038
     C                     Z-ADDVDAT      ZVDAT
     C                     Z-ADDDDAT      ZDDAT   50                      R10038
     C                     EXSR ZFDLLN
     C                     MOVELZLIN      SAT2XT
     C                     MOVE *BLANKS   SACOMC
     C                     MOVE *BLANKS   SACFRQ
     C                     Z-ADD0         SANCDT
     C****                 MOVE SCST      SAPAYM                          56452
     C****                 MOVE OSCA      SAPYAC                          56452
     C                     MOVE PCST      SAPAYM                          56452
     C                     MOVE OPCA      SAPYAC                          56452
     C                     MOVE POBR      SAPYBR                          085867
     C*
     C                     MOVE SLCY      WWCCY1                          R10040
     C                     MOVE SAPAYM    WWSETM                          R10040
     C                     MOVE SAPYAC    WWSTAC                          R10040
     C                     MOVE SAPYBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SAPYNM                          R10040
     C*
     C****                 MOVE PCST      SARCVM                          56452
     C****                 MOVE OPCA      SARCAC                          56452
     C                     MOVE SCST      SARCVM                          56452
     C                     MOVE OSCA      SARCAC                          56452
     C                     MOVE ROBR      SARCBR                          085867
     C*
     C                     MOVE PUCY      WWCCY1                          R10040
     C                     MOVE SARCVM    WWSETM                          R10040
     C                     MOVE SARCAC    WWSTAC                          R10040
     C                     MOVE SARCBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SARCNM                          R10040
     C*
     C                     MOVE *BLANKS   SACGST
     C                     MOVE *BLANKS   SACGAD
     C                     MOVE WWCHTP    SACHTP
     C                     MOVE BBCRNM    SACRNM
     C                     MOVE PDISTN    SAISTN
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C                     MOVELO#ACOF    SABACO                          CPM004
     C                     MOVELO#BICN    SABCNM                          CPM004
     C                     MOVELO#CRNM    SABCRN                          CPM004
     C                     END                                            CPM004
     C*
     C** IF TRANSACTION INSERTED & DELETED TODAY DO NOT OUTPUT DETAILS    R05880
     C           SACHTP    IFNE 'D'                                       R05880
     C           ORED      ORNE BJRDNB                                    R05880
     C                     WRITEPMTRCNP0
     C                     END                                            R05880
     C*
     C                     ENDSR                           *** #W01 END **
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #W02          -  WRITE MM DEAL TO TRANSACTIONS FILE
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #W02      BEGSR                           *** #W02   ***
     C*
     C                     MOVE 'D'       SARECI
     C                     MOVE BBACOC    SAACOC
     C**********           Z-ADDCNUM      SACNUM                                              CSD027
     C                     MOVE CNUM      SACNUM                                              CSD027
     C                     MOVE PTFR      SAPTFR
     C***********          MOVE P7INNR    SAINNR                          S01486
     C                     MOVE INNR      SAINNR                          S01486
     C                     MOVE 'DC'      SAMODI
     C                     MOVE DLNO      SATRNB
     C                     MOVE DTYP      SATRTP
     C                     MOVE DLST      SATRST
     C                     MOVE *BLANKS   SATDSS
     C                     Z-ADD*ZEROS    SANMDP
     C                     MOVE *BLANKS   SASPBS
     C                     Z-ADD*ZEROS    SASEQA
     C                     Z-ADDDDAT      SADDAT
     C                     Z-ADDVDAT      SAVDAT
     C           MDAT      IFEQ 0
     C                     Z-SUBNOTD      SAMDAT
     C                     ELSE
     C                     Z-ADDMDAT      SAMDAT
     C                     END
     C**********           Z-ADDBRCD      SABRCD                          S01486
     C                     MOVELBRCA      SABRCD                          S01486
     C                     Z-ADDPCPL      SAAMT1
     C                     Z-ADD*ZEROS    SAAMT2
     C                     MOVE CCY       SACCY1
     C                     MOVE CCY       WWCCY1  3                       R10040
     C                     MOVE *BLANKS   SACCY2
     C                     Z-ADD*ZEROS    SAPRC1
     C                     Z-ADD*ZEROS    SAPRC2
     C                     Z-ADD*ZEROS    SARATA
     C                     Z-ADD*ZEROS    SARATB
     C                     MOVE *BLANKS   SAMDV1
     C                     MOVE *BLANKS   SAMDV2
     C                     Z-ADDBRTT      SABRT1
     C                     Z-ADD*ZEROS    SABRT2
     C                     Z-ADDINTR      SARAI1
     C                     Z-ADD*ZEROS    SARAI2
     C                     MOVE IPFR      SAFRQ1
     C                     MOVE *BLANKS   SAFRQ2
     C                     Z-ADDNIDT      SAIPD1
     C                     Z-ADD*ZEROS    SAIPD2
     C                     Z-ADD*ZEROS    SANDYS
     C                     Z-ADD*ZEROS    SAAINT
     C                     MOVE *BLANKS   SABROK
     C                     Z-ADD*ZEROS    SASWOD
     C                     MOVE *BLANKS   SAACRI
     C                     Z-ADD*ZEROS    SAPURI
     C                     Z-ADD*ZEROS    SAVAL1
     C                     Z-ADD*ZEROS    SAVAL2
     C                     MOVE PDDSPG    SARCOA
     C                     MOVE PDITDS    SARSEA
     C***********          MOVELP7DTNR    SAT1XT                          S01486
     C                     MOVELNARR11    SAT1XT                          S01486
     C                     MOVELCCY       ZCCY
     C                     Z-ADDINTR      ZINRT
     C                     Z-ADDMDAT      ZMDAT
     C                     Z-ADDNOTD      ZNOTD
     C                     EXSR ZFDLLN
     C                     MOVELZLIN      SAT2XT
     C                     MOVE *BLANKS   SACOMC
     C                     MOVE *BLANKS   SACFRQ
     C                     Z-ADD0         SANCDT
     C*
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'TD'
     C           DTYP      OREQ 'CD'
      *                                                                   CDL006
      ** Include condition on deal types FT,DT and LT if CDL006 is ON.    CDL006
      *                                                                   CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
     C****                 MOVE MDST      SAPAYM                          56452
     C****                 MOVE OMDA      SAPYAC                          56452
     C                     MOVE SDST      SAPAYM                          56452
     C                     MOVE OSDA      SAPYAC                          56452
     C                     MOVE POBR      SAPYBR                          085867
     C*
     C                     MOVE SAPAYM    WWSETM                          R10040
     C                     MOVE SAPYAC    WWSTAC                          R10040
     C                     MOVE SAPYBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SAPYNM                          R10040
     C*
     C                     ELSE
     C****                 MOVE SDST      SAPAYM                          56452
     C****                 MOVE OSDA      SAPYAC                          56452
     C                     MOVE MDST      SAPAYM                          56452
     C                     MOVE OMDA      SAPYAC                          56452
     C                     MOVE POBR      SAPYBR                          085867
     C*
     C                     MOVE SAPAYM    WWSETM                          R10040
     C                     MOVE SAPYAC    WWSTAC                          R10040
     C                     MOVE SAPYBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SAPYNM                          R10040
     C*
     C                     END
     C*
     C           DTYP      IFEQ 'LN'
     C           DTYP      OREQ 'DL'
     C           DTYP      OREQ 'TI'
     C           DTYP      OREQ 'IP'
     C           DTYP      OREQ 'CL'
      *                                                                   CDL006
      ** Include condition on deal types FL,DP and LP if CDL006 is ON.    CDL006
      *                                                                   CDL006
     C           DTYP      OREQ 'FL'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
     C****                 MOVE MDST      SARCVM                          56452
     C****                 MOVE OMDA      SARCAC                          56452
     C                     MOVE SDST      SARCVM                          56452
     C                     MOVE OSDA      SARCAC                          56452
     C                     MOVE ROBR      SARCBR                          085867
     C*
     C                     MOVE SARCVM    WWSETM                          R10040
     C                     MOVE SARCAC    WWSTAC                          R10040
     C                     MOVE SARCBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SARCNM                          R10040
     C*
     C                     ELSE
     C****                 MOVE SDST      SARCVM                          56452
     C****                 MOVE OSDA      SARCAC                          56452
     C                     MOVE MDST      SARCVM                          56452
     C                     MOVE OMDA      SARCAC                          56452
     C                     MOVE ROBR      SARCBR                          085867
     C*
     C                     MOVE SARCVM    WWSETM                          R10040
     C                     MOVE SARCAC    WWSTAC                          R10040
     C                     MOVE SARCBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SARCNM                          R10040
     C*
     C                     END
     C*
     C                     MOVE *BLANKS   SACGST
     C                     MOVE *BLANKS   SACGAD
     C                     MOVE WWCHTP    SACHTP
     C                     MOVE BBCRNM    SACRNM
     C                     MOVE PDISTN    SAISTN
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C                     MOVELO#ACOF    SABACO                          CPM004
     C                     MOVELO#BICN    SABCNM                          CPM004
     C                     MOVELO#CRNM    SABCRN                          CPM004
     C                     END                                            CPM004
     C*
     C** IF TRANSACTION INSERTED & DELETED TODAY DO NOT OUTPUT DETAILS    R05880
     C           SACHTP    IFNE 'D'                                       R05880
     C           ORED      ORNE BJRDNB                                    R05880
     C                     WRITEPMTRCNP0
     C                     END                                            R05880
     C*
     C                     ENDSR                           *** #W02 END **
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #W0301        -  WRITE FR, RS,RL DEAL TO TRANSACTIONS FILE
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #W0301    BEGSR                           *** #W0301 ***
     C*
     C                     MOVE 'D'       SARECI
     C                     MOVE BBACOC    SAACOC
     C**********           Z-ADDCNUM      SACNUM                                              CSD027
     C                     MOVE CNUM      SACNUM                                              CSD027
     C                     MOVE PTFR      SAPTFR
     C**********           MOVE P7INNR    SAINNR                          S01486
     C                     MOVE INNR      SAINNR                          S01486
     C                     MOVE 'DG'      SAMODI
     C                     MOVE DLNO      SATRNB
     C                     MOVE DTYP      SATRTP
     C                     MOVE DLST      SATRST
     C                     MOVE *BLANKS   SATDSS
     C                     Z-ADD*ZEROS    SANMDP
     C                     MOVE *BLANKS   SASPBS
     C                     Z-ADD*ZEROS    SASEQA
     C                     Z-ADDDDAT      SADDAT
     C                     Z-ADDVDAT      SAVDAT
     C                     Z-ADDMDAT      SAMDAT
     C**********           Z-ADDBRCD      SABRCD                          S01486
     C                     MOVELBRCA      SABRCD                          S01486
     C                     Z-ADDUPAMT     SAAMT1
     C                     Z-ADD*ZEROS    SAAMT2
     C                     MOVE UCUCY     SACCY1
     C                     MOVE UCUCY     WWCCY1                          R10040
     C                     MOVE *BLANKS   SACCY2
     C                     Z-ADD*ZEROS    SAPRC1
     C                     Z-ADD*ZEROS    SAPRC2
     C                     Z-ADD*ZEROS    SARATA
     C                     Z-ADD*ZEROS    SARATB
     C                     MOVE *BLANKS   SAMDV1
     C                     MOVE *BLANKS   SAMDV2
     C                     Z-ADDUBRTT     SABRT1
     C                     Z-ADD*ZEROS    SABRT2
     C                     Z-ADDUEINR     SARAI1
     C                     Z-ADD*ZEROS    SARAI2
     C                     MOVE UIPFR     SAFRQ1
     C                     MOVE *BLANKS   SAFRQ2
     C                     Z-ADDUNIPD     SAIPD1
     C                     Z-ADD*ZEROS    SAIPD2
     C                     Z-ADD*ZEROS    SANDYS
     C                     Z-ADD*ZEROS    SAAINT
     C                     MOVE *BLANKS   SABROK
     C                     Z-ADD*ZEROS    SASWOD
     C                     MOVE *BLANKS   SAACRI
     C                     Z-ADD*ZEROS    SAPURI
     C                     Z-ADD*ZEROS    SAVAL1
     C                     Z-ADD*ZEROS    SAVAL2
     C                     MOVE PDDSPG    SARCOA
     C                     MOVE PDITDS    SARSEA
     C**********           MOVELP7DTNR    SAT1XT                          S01486
     C                     MOVELNARR11    SAT1XT                          S01486
     C                     MOVELUCUCY     ZUCUCY
     C                     Z-ADDUEINR     ZUEINR
     C                     Z-ADDMDAT      ZMDAT
     C                     EXSR ZFDLLN
     C                     MOVELZLIN      SAT2XT
     C                     MOVE *BLANKS   SACOMC
     C                     MOVE *BLANKS   SACFRQ
     C                     Z-ADD0         SANCDT
     C                     MOVE PSETM     SAPAYM
     C                     MOVE UPACC     SAPYAC
     C                     MOVE POBR      SAPYBR                          085867
     C*
     C                     MOVE SAPAYM    WWSETM                          R10040
     C                     MOVE SAPYAC    WWSTAC                          R10040
     C                     MOVE SAPYBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SAPYNM                          R10040
     C*
     C                     MOVE RSETM     SARCVM
     C                     MOVE URACC     SARCAC
     C                     MOVE ROBR      SARCBR                          085867
     C*
     C                     MOVE SARCVM    WWSETM                          R10040
     C                     MOVE SARCAC    WWSTAC                          R10040
     C                     MOVE SARCBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SARCNM                          R10040
     C*
     C                     MOVE *BLANKS   SACGST
     C                     MOVE *BLANKS   SACGAD
     C                     MOVE WWCHTP    SACHTP
     C                     MOVE BBCRNM    SACRNM
     C                     MOVE PDISTN    SAISTN
     C*
     C** IF TRANSACTION INSERTED & DELETED TODAY DO NOT OUTPUT DETAILS    R05880
     C           SACHTP    IFNE 'D'                                       R05880
     C           ORED      ORNE BJRDNB                                    R05880
     C                     WRITEPMTRCNP0
     C                     END                                            R05880
     C*
     C                     ENDSR                           * #W0301 END *
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #W0302        -  WRITE RX DEAL TO TRANSACTIONS FILE
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #W0302    BEGSR                           *** #W0302 ***
     C*
     C                     MOVE 'D'       SARECI
     C                     MOVE BBACOC    SAACOC
     C**********           Z-ADDCNUM      SACNUM                                              CSD027
     C                     MOVE CNUM      SACNUM                                              CSD027
     C                     MOVE PTFR      SAPTFR
     C**********           MOVE P7INNR    SAINNR                          S01486
     C                     MOVE INNR      SAINNR                          S01486
     C                     MOVE 'DG'      SAMODI
     C                     MOVE DLNO      SATRNB
     C                     MOVE DTYP      SATRTP
     C                     MOVE DLST      SATRST
     C                     MOVE *BLANKS   SATDSS
     C                     Z-ADD*ZEROS    SANMDP
     C                     MOVE *BLANKS   SASPBS
     C                     Z-ADD*ZEROS    SASEQA
     C                     Z-ADDDDAT      SADDAT
     C                     Z-ADDVDAT      SAVDAT
     C                     Z-ADDMDAT      SAMDAT
     C**********           Z-ADDBRCD      SABRCD                          S01486
     C                     MOVELBRCA      SABRCD                          S01486
     C                     Z-ADDUPAMT     SAAMT1
     C                     Z-ADDTPAMT     SAAMT2
     C                     MOVE UCUCY     SACCY1
     C                     MOVE TCUCY     SACCY2
     C                     Z-ADD*ZEROS    SAPRC1
     C                     Z-ADD*ZEROS    SAPRC2
     C                     Z-ADD*ZEROS    SARATA
     C                     Z-ADD*ZEROS    SARATB
     C                     MOVE *BLANKS   SAMDV1
     C                     MOVE *BLANKS   SAMDV2
     C                     Z-ADDUBRTT     SABRT1
     C                     Z-ADDTBRTT     SABRT2
     C                     Z-ADDUEINR     SARAI1
     C                     Z-ADDTEINR     SARAI2
     C                     MOVE UIPFR     SAFRQ1
     C                     MOVE TIPFR     SAFRQ2
     C                     Z-ADDUNIPD     SAIPD1
     C                     Z-ADDTNIPD     SAIPD2
     C                     Z-ADD*ZEROS    SANDYS
     C                     Z-ADD*ZEROS    SAAINT
     C                     MOVE *BLANKS   SABROK
     C                     Z-ADD*ZEROS    SASWOD
     C                     MOVE *BLANKS   SAACRI
     C                     Z-ADD*ZEROS    SAPURI
     C                     Z-ADD*ZEROS    SAVAL1
     C                     Z-ADD*ZEROS    SAVAL2
     C                     MOVE PDDSPG    SARCOA
     C                     MOVE PDITDS    SARSEA
     C***********          MOVELP7DTNR    SAT1XT                          S01486
     C                     MOVELNARR11    SAT1XT                          S01486
     C                     MOVELUCUCY     ZUCUCY
     C                     MOVELTCUCY     ZTCUCY
     C                     Z-ADDMDAT      ZMDAT
     C                     EXSR ZFDLLN
     C                     MOVELZLIN      SAT2XT
     C                     MOVE *BLANKS   SACOMC
     C                     MOVE *BLANKS   SACFRQ
     C                     Z-ADD0         SANCDT
     C                     MOVE PSETM     SAPAYM
     C                     MOVE UPACC     SAPYAC
     C                     MOVELPOBR      SAPYBR                          085867
     C*
     C                     MOVE UCUCY     WWCCY1                          R10040
     C                     MOVE SAPAYM    WWSETM                          R10040
     C                     MOVE SAPYAC    WWSTAC                          R10040
     C                     MOVE SAPYBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SAPYNM                          R10040
     C*
     C                     MOVE RSETM     SARCVM
     C                     MOVE URACC     SARCAC
     C                     MOVE ROBR      SARCBR                          085867
     C*
     C                     MOVE TCUCY     WWCCY1                          R10040
     C                     MOVE SARCVM    WWSETM                          R10040
     C                     MOVE SARCAC    WWSTAC                          R10040
     C                     MOVE SARCBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SARCNM                          R10040
     C*
     C                     MOVE *BLANKS   SACGST
     C                     MOVE *BLANKS   SACGAD
     C                     MOVE WWCHTP    SACHTP
     C                     MOVE BBCRNM    SACRNM
     C                     MOVE PDISTN    SAISTN
     C*
     C** IF TRANSACTION INSERTED & DELETED TODAY DO NOT OUTPUT DETAILS    R05880
     C           SACHTP    IFNE 'D'                                       R05880
     C           ORED      ORNE BJRDNB                                    R05880
     C                     WRITEPMTRCNP0
     C                     END                                            R05880
     C*
     C                     ENDSR                           * #W0302 END *
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #W0401        -  WRITE PI, DL DEAL AMENDMENT TO TRANS. FILE
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #W0401    BEGSR                           *** #W0401 ***
     C*
     C                     MOVE 'D'       SARECI
     C                     MOVE BBACOC    SAACOC
     C**********           Z-ADDCNUM      SACNUM                                              CSD027
     C                     MOVE CNUM      SACNUM                                              CSD027
     C                     MOVE PTFR      SAPTFR
     C**********           MOVE P7INNR    SAINNR                          S01486
     C                     MOVE INNR      SAINNR                          S01486
     C                     MOVE 'DI'      SAMODI
     C                     MOVE DLNO      SATRNB
     C                     MOVE AMTP      SATRTP
     C                     MOVE *BLANKS   SATRST
     C                     MOVE *BLANKS   SATDSS
     C                     Z-ADD*ZEROS    SANMDP
     C                     MOVE *BLANKS   SASPBS
     C                     Z-ADDDASN      SASEQA
     C                     Z-ADD*ZEROS    SADDAT
     C                     Z-ADDWWVDAT    SAVDAT
     C                     Z-ADD*ZEROS    SAMDAT
     C**********           Z-ADDWWBRCD    SABRCD                          S01486
     C                     MOVELWWBRCD    SABRCD                          S01486
     C                     Z-ADDDAAM      SAAMT1
     C                     Z-ADD*ZEROS    SAAMT2
     C                     MOVE CCY       SACCY1
     C                     MOVE CCY       WWCCY1                          R10040
     C                     MOVE *BLANKS   SACCY2
     C                     Z-ADD*ZEROS    SAPRC1
     C                     Z-ADD*ZEROS    SAPRC2
     C                     Z-ADD*ZEROS    SARATA
     C                     Z-ADD*ZEROS    SARATB
     C                     MOVE *BLANKS   SAMDV1
     C                     MOVE *BLANKS   SAMDV2
     C                     Z-ADD*ZEROS    SABRT1
     C                     Z-ADD*ZEROS    SABRT2
     C                     Z-ADD*ZEROS    SARAI1
     C                     Z-ADD*ZEROS    SARAI2
     C                     MOVE *BLANKS   SAFRQ1
     C                     MOVE *BLANKS   SAFRQ2
     C                     Z-ADD*ZEROS    SAIPD1
     C                     Z-ADD*ZEROS    SAIPD2
     C                     Z-ADD*ZEROS    SANDYS
     C                     Z-ADD*ZEROS    SAAINT
     C                     MOVE *BLANKS   SABROK
     C                     Z-ADD*ZEROS    SASWOD
     C                     MOVE *BLANKS   SAACRI
     C                     Z-ADD*ZEROS    SAPURI
     C                     Z-ADD*ZEROS    SAVAL1
     C                     Z-ADD*ZEROS    SAVAL2
     C                     MOVE PDDSPG    SARCOA
     C                     MOVE PDITDS    SARSEA
     C***********          MOVELP7DTNR    SAT1XT                          S01486
     C                     MOVELNARR11    SAT1XT                          S01486
     C                     MOVELCCY       ZCCY
     C                     Z-ADDINTR      ZINRT
     C                     Z-ADDMDAT      ZMDAT
     C                     Z-ADDNOTD      ZNOTD
     C                     EXSR ZFDLLN
     C                     MOVELZLIN      SAT2XT
     C                     MOVE *BLANKS   SACOMC
     C                     MOVE *BLANKS   SACFRQ
     C                     Z-ADD0         SANCDT
     C*
     C           DTYP      IFEQ 'LN'
     C           DTYP      OREQ 'DL'
     C           DTYP      OREQ 'TI'
     C           DTYP      OREQ 'IP'
     C           DTYP      OREQ 'CL'
      *                                                                   CDL006
      ** Include condition on deal types FL,DP and LP if CDL006 is ON.    CDL006
      *                                                                   CDL006
     C           DTYP      OREQ 'FL'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
     C*
     C           AMTP      IFEQ 'PI'
     C                     MOVE SETP      SAPAYM
     C                     MOVE OSAC      SAPYAC
     C                     MOVE OSBR      SAPYBR                          085867
     C*
     C                     MOVE SAPAYM    WWSETM                          R10040
     C                     MOVE SAPYAC    WWSTAC                          R10040
     C                     MOVE SAPYBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SAPYNM                          R10040
     C*
     C                     MOVE *BLANKS   SARCVM
     C                     MOVE *BLANKS   SARCAC
     C                     MOVE *BLANKS   SARCNM                          R10040
     C                     MOVE *BLANKS   SARCBR                          085867
     C                     END
     C*
     C           AMTP      IFEQ 'PD'
     C                     MOVE *BLANKS   SAPAYM
     C                     MOVE *BLANKS   SAPYAC
     C                     MOVE *BLANKS   SAPYNM                          R10040
     C                     MOVE *BLANKS   SAPYBR                          085867
     C                     MOVE SETP      SARCVM
     C                     MOVE OSAC      SARCAC
     C                     MOVE OSBR      SARCBR                          085867
     C*
     C                     MOVE SARCVM    WWSETM                          R10040
     C                     MOVE SARCAC    WWSTAC                          R10040
     C                     MOVE SARCBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SARCNM                          R10040
     C*
     C                     END
     C*
     C                     END
     C*
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'TD'
     C           DTYP      OREQ 'CD'
      *                                                                   CDL006
      ** Include condition on deal types FT,DT and LT if CDL006 is ON.    CDL006
      *                                                                   CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
     C*
     C           AMTP      IFEQ 'PI'
     C                     MOVE *BLANKS   SAPAYM
     C                     MOVE *BLANKS   SAPYAC
     C                     MOVE *BLANKS   SAPYNM                          R10040
     C                     MOVE *BLANKS   SAPYBR                          085867
     C                     MOVE SETP      SARCVM
     C                     MOVE OSAC      SARCAC
     C                     MOVE OSBR      SARCBR                          085867
     C*
     C                     MOVE SARCVM    WWSETM                          R10040
     C                     MOVE SARCAC    WWSTAC                          R10040
     C                     MOVE SARCBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SARCNM                          R10040
     C*
     C                     END
     C*
     C           AMTP      IFEQ 'PD'
     C                     MOVE SETP      SAPAYM
     C                     MOVE OSAC      SAPYAC
     C                     MOVE OSBR      SAPYBR                          085867
     C*
     C                     MOVE SAPAYM    WWSETM                          R10040
     C                     MOVE SAPYAC    WWSTAC                          R10040
     C                     MOVE SAPYBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SAPYNM                          R10040
     C*
     C                     MOVE *BLANKS   SARCVM
     C                     MOVE *BLANKS   SARCAC
     C                     MOVE *BLANKS   SARCNM                          R10040
     C                     MOVE *BLANKS   SARCBR                          085867
     C                     END
     C*
     C                     END
     C*
     C                     MOVE *BLANKS   SACGST
     C                     MOVE *BLANKS   SACGAD
     C                     MOVE WWCHTP    SACHTP
     C                     MOVE BBCRNM    SACRNM
     C                     MOVE PDISTN    SAISTN
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C                     MOVELO#ACOF    SABACO                          CPM004
     C                     MOVELO#BICN    SABCNM                          CPM004
     C                     MOVELO#CRNM    SABCRN                          CPM004
     C                     END                                            CPM004
     C*
     C** IF TRANSACTION INSERTED & DELETED TODAY DO NOT OUTPUT DETAILS    R05880
     C           SACHTP    IFNE 'D'                                       R05880
     C           ORED      ORNE BJRDNB                                    R05880
     C                     WRITEPMTRCNP0
     C                     END                                            R05880
     C*
     C                     ENDSR                           * #W0401 END *
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #W0402        -  WRITE SC, CI DEAL AMENDMENT TO TRANS. FILE
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #W0402    BEGSR                           *** #W0402 ***
     C*
     C                     MOVE 'D'       SARECI
     C                     MOVE BBACOC    SAACOC
     C**********           Z-ADDCNUM      SACNUM                                              CSD027
     C                     MOVE CNUM      SACNUM                                              CSD027
     C                     MOVE PTFR      SAPTFR
     C**********           MOVE P7INNR    SAINNR                          S01486
     C                     MOVE INNR      SAINNR                          S01486
     C                     MOVE 'DI'      SAMODI
     C                     MOVE DLNO      SATRNB
     C                     MOVE AMTP      SATRTP
     C                     MOVE *BLANKS   SATRST
     C                     MOVE *BLANKS   SATDSS
     C                     Z-ADD*ZEROS    SANMDP
     C                     MOVE *BLANKS   SASPBS
     C                     Z-ADDDASN      SASEQA
     C                     Z-ADD*ZEROS    SADDAT
     C                     Z-ADDWWVDAT    SAVDAT
     C                     Z-ADD*ZEROS    SAMDAT
     C**********           Z-ADDWWBRCD    SABRCD                          S01486
     C                     MOVELWWBRCD    SABRCD                          S01486
     C                     Z-ADD*ZEROS    SAAMT1
     C                     Z-ADD*ZEROS    SAAMT2
     C                     MOVE *BLANKS   SACCY1
     C                     MOVE CCY       WWCCY1                          R10040
     C                     MOVE *BLANKS   SACCY2
     C                     Z-ADD*ZEROS    SAPRC1
     C                     Z-ADD*ZEROS    SAPRC2
     C                     Z-ADD*ZEROS    SARATA
     C                     Z-ADD*ZEROS    SARATB
     C                     MOVE *BLANKS   SAMDV1
     C                     MOVE *BLANKS   SAMDV2
     C                     Z-ADDBRTT      SABRT1
     C                     Z-ADD*ZEROS    SABRT2
     C                     Z-ADDRTSP      SARAI1
     C                     Z-ADD*ZEROS    SARAI2
     C                     MOVE *BLANKS   SAFRQ1
     C                     MOVE *BLANKS   SAFRQ2
     C                     Z-ADD*ZEROS    SAIPD1
     C                     Z-ADD*ZEROS    SAIPD2
     C                     Z-ADD*ZEROS    SANDYS
     C                     Z-ADD*ZEROS    SAAINT
     C                     MOVE *BLANKS   SABROK
     C                     Z-ADD*ZEROS    SASWOD
     C                     MOVE *BLANKS   SAACRI
     C                     Z-ADD*ZEROS    SAPURI
     C                     Z-ADD*ZEROS    SAVAL1
     C                     Z-ADD*ZEROS    SAVAL2
     C                     MOVE PDDSPG    SARCOA
     C                     MOVE PDITDS    SARSEA
     C***********          MOVELP7DTNR    SAT1XT                          S01486
     C                     MOVELNARR11    SAT1XT                          S01486
     C                     MOVELCCY       ZCCY
     C                     Z-ADDINTR      ZINRT
     C                     Z-ADDMDAT      ZMDAT
     C                     Z-ADDNOTD      ZNOTD
     C                     EXSR ZFDLLN
     C                     MOVELZLIN      SAT2XT
     C                     MOVE *BLANKS   SACOMC
     C                     MOVE *BLANKS   SACFRQ
     C                     Z-ADD0         SANCDT
     C*
     C           AMTP      IFEQ 'SI'
     C*
     C           DTYP      IFEQ 'LN'
     C           DTYP      OREQ 'DL'
     C           DTYP      OREQ 'TI'
     C           DTYP      OREQ 'IP'
     C           DTYP      OREQ 'CL'
      *                                                                   CDL006
      ** Include condition on deal types FL,DP and LP if CDL006 is ON.    CDL006
      *                                                                   CDL006
     C           DTYP      OREQ 'FL'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LP'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
     C                     MOVE *BLANKS   SAPAYM
     C                     MOVE *BLANKS   SAPYAC
     C                     MOVE *BLANKS   SAPYNM                          R10040
     C                     MOVE *BLANKS   SAPYBR                          085867
     C                     MOVE SETP      SARCVM
     C                     MOVE OSAC      SARCAC
     C                     MOVE OSBR      SARCBR                          085867
     C*
     C                     MOVE SARCVM    WWSETM                          R10040
     C                     MOVE SARCAC    WWSTAC                          R10040
     C                     MOVE SARCBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SARCNM                          R10040
     C*
     C                     END
     C*
     C           DTYP      IFEQ 'IT'
     C           DTYP      OREQ 'TD'
     C           DTYP      OREQ 'CD'
      *                                                                   CDL006
      ** Include condition on deal types FT,DT and LT if CDL006 is ON.    CDL006
      *                                                                   CDL006
     C           DTYP      OREQ 'FT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
     C                     MOVE SETP      SAPAYM
     C                     MOVE OSAC      SAPYAC
     C                     MOVE OSBR      SAPYBR                          085867
     C*
     C                     MOVE SAPAYM    WWSETM                          R10040
     C                     MOVE SAPYAC    WWSTAC                          R10040
     C                     MOVE SAPYBR    WWBRCA                          085867
     C                     EXSR #P40                                      R10040
     C                     MOVE WWANAM    SAPYNM                          R10040
     C*
     C                     MOVE *BLANKS   SARCVM
     C                     MOVE *BLANKS   SARCAC
     C                     MOVE *BLANKS   SARCNM                          R10040
     C                     MOVE *BLANKS   SARCBR                          085867
     C                     END
     C*
     C                     END
     C*
     C                     MOVE *BLANKS   SACGST
     C                     MOVE *BLANKS   SACGAD
     C                     MOVE WWCHTP    SACHTP
     C                     MOVE BBCRNM    SACRNM
     C                     MOVE PDISTN    SAISTN
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C                     MOVELO#ACOF    SABACO                          CPM004
     C                     MOVELO#BICN    SABCNM                          CPM004
     C                     MOVELO#CRNM    SABCRN                          CPM004
     C                     END                                            CPM004
     C*
     C** IF TRANSACTION INSERTED & DELETED TODAY DO NOT OUTPUT DETAILS    R05880
     C           SACHTP    IFNE 'D'                                       R05880
     C           ORED      ORNE BJRDNB                                    R05880
     C                     WRITEPMTRCNP0
     C                     END                                            R05880
     C*
     C                     ENDSR                           * #W0402 END *
     C**************************************************************************
      /EJECT
     C**************************************************************************
     C**
     C**   #DTST           -  ACCESS DEAL TYPE/SUB-TYPE DETAILS
     C**
     C**   CALLED BY #P01  -  FX DEALS EXTRACT
     C**             #P02  -  MM DEALS EXTRACT
     C**             #P03  -  FRA/IRS DEALS EXTRACT
     C**             #P04  -  DEAL AMENDMENTS EXTRACT
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #DTST     BEGSR                           * #DTST BEGS *
     C*
     C***********P1KEY     CHAINSDDTSTPP             72                   S01486
     C           P1KEY     CHAINFDDTSTL1             72                   S01486
     C*
     C**   PERFORM DATABASE IN ERROR PROCESSING IF NO LIVE RECORD FOUND
     C           *IN72     IFEQ '0'
     C***********P7RECI    ANDEQ'*'                                       S01486
     C           RCID11    ANDEQ'*'                                       S01486
     C                     MOVE '1'       *IN72
     C                     END
     C*
     C           *IN72     IFEQ '1'
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVELDSDTST    DBKEY
     C                     MOVEL'02'      DBASE            ***************
     C************         MOVEL'SDDTSTPP'DBFILE           * DB ERROR 02 *S01486
     C                     MOVE 'FDDTSTL1'DBFILE           * DB ERROR 02 *S01486
     C                     OUT  LDA                        ***************S01486
     C                     EXSR *PSSR                      ***************
     C                     END
     C*
     C                     ENDSR                           * #INST ENDS**
     C**************************************************************************
      /EJECT
     C**************************************************************************
     C**
     C**   #INST           -  ACCESS PM INSTRUMENT TYPE DETAILS
     C**
     C**   CALLED BY #P01  -  FX DEALS EXTRACT
     C**             #P02  -  MM DEALS EXTRACT
     C**             #P03  -  FRA/IRS DEALS EXTRACT
     C**             #P04  -  DEAL AMENDMENTS EXTRACT
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #INST     BEGSR                           * #INST BEGS *
      *                                                                   182961
      ** Instrument type is defaulted from PF/SDPORTPD if a blank         182961
      ** instrument type is found.                                        182961
      ** Indicator 35 was used as the operation's resulting indicator.    182961
      *                                                                   182961
     C           INNR      IFEQ *BLANKS                                   182961
     C           1         SETLLSDPORTPD                                  182961
     C                     READ SDPORTPD                 35               182961
     C                     MOVE FCDINR    INNR                            182961
     C                     ENDIF                                          182961
     C*
     C**   ACCESS THE INSTRUMENT TYPES FILE USING THE PM INSTRUMENT TYPE
     C**   FROM THE DEAL TYPE/SUB-TYPE
     C***********P7INNR    CHAINSDPLINPD             72                   S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM INNR      WWKEY3  3                       S01486
     C           SDPLIN    PARM SDPLIN    DSSDY                           S01486
     C*
     C**   PERFORM DATABASE IN ERROR PROCESSING IF NO LIVE RECORD FOUND
     C************IN72     IFEQ '0'                                       S01486
     C           WWRTCD    IFEQ *BLANKS                                   S01486
     C           PDRECI    ANDEQ'*'
     C***********          MOVE '1'       *IN72                           S01486
     C                     MOVEL'*ERROR  'WWRTCD                          S01486
     C                     END
     C*
     C************IN72     IFEQ '1'                                       S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVELP7INNR    DBKEY                           S01486
     C                     MOVELINNR      DBKEY                           S01486
     C                     MOVEL'03'      DBASE
     C***********          MOVEL'SDPLINPD'DBFILE           * *************S01486
     C                     MOVE 'SDPLINPD'DBFILE           * DB ERROR 03 *S01486
     C                     OUT  LDA                        ***************S01486
     C                     EXSR *PSSR
     C                     END
     C*                                                                   B9991
     C**   ACCESS THE DISPLAY GROUPS FILE                                 B9991
     C*                                                                   B9991
     C           PDDSPG    CHAINPMDSPGL3             72                   B9991
     C*                                                                   B9991
     C           *IN72     IFEQ '0'                                       B9991
     C                     MOVE PADSPS    SADSPS                          B9991
     C                     ELSE                                           B9991
     C                     MOVE *BLANKS   SADSPS                          B9991
     C                     END                                            B9991
     C*
     C                     ENDSR                           * #INST ENDS**
     C**************************************************************************
      /EJECT
     C**************************************************************************
     C**
     C**   #CUST           -  ACCESS CUSTOMER DETAILS
     C**
     C**   CALLED BY #P01  -  FX DEALS EXTRACT
     C**             #P02  -  MM DEALS EXTRACT
     C**             #P03  -  FRA/IRS DEALS EXTRACT
     C**             #P04  -  DEAL AMENDMENTS EXTRACT
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #CUST     BEGSR                           * #CUST BEGS *
     C*
     C**   ACCESS THE CUSTOMER DETAILS FILE USING THE DEAL CUSTOMER
     C***********WWPNP8    CHAINSDCUSTL0             72                   S01486
     C***********                                                         S01486
     C************IN72     IFEQ '1'                                       S01486
     C                     MOVEL'*CNUM'   WWSORT  7                       S01486
     C                     MOVELWWPNP8    WWCSNM 10                       S01486
     C                     CALL 'AOCUSTR0'                                S01486
     C                     PARM '*MSG    'WWRTCD  7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM WWCSNM    WWKY10 10                       S01486
     C                     PARM WWSORT    WWKE7   7                       S01486
     C           SDCUST    PARM SDCUST    DSSDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVELWWPNP8    DBKEY
     C                     MOVEL'04'      DBASE
     C***********          MOVEL'SDCUSTL0'DBFILE           ***************S01486
     C                     MOVE 'SDCUSTPD'DBFILE           * DB ERROR 04 *S01486
     C                     OUT  LDA                        ***************S01486
     C                     EXSR *PSSR
     C                     END
     C***********                                                 B9991   S01486
     C*****ACCESS THE ACCOUNT OFFICERS FILE                       B9991   S01486
     C***********                                                 B9991   S01486
     C***********BBACOC    CHAINSDACOFL0             72           B9991   S01486
     C***********                                                 B9991   S01486
     C************IN72     IFEQ '0'                               B9991   S01486
     C***********          MOVE AZPRTL    SAPRTL                  B9991   S01486
     C***********          ELSE                                   B9991   S01486
     C***********          MOVE *BLANKS   SAPRTL                  B9991   S01486
     C***********          END                                    B9991   S01486
     C*
     C                     ENDSR                           * #CUST ENDS**
     C**************************************************************************
      /EJECT
     C**************************************************************************
     C**
     C**   #DEAL           -  ACCESS DEAL DETAILS
     C**
     C**   CALLED BY #P04  -  DEAL AMENDMENTS EXTRACT
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #DEAL     BEGSR                           * #DEAL BEGS *
     C*
     C           DLNO      CHAINDEALS                72
     C*
     C**   PERFORM DATABASE IN ERROR PROCESSING IF NO RECORD FOUND
     C           *IN72     IFEQ '1'
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVELDLNO      DBKEY
     C                     MOVEL'05'      DBASE            ***************
     C***********          MOVEL'DEALS   'DBFILE           * DB ERROR 05 *S01486
     C                     MOVE 'DEALS   'DBFILE           * DB ERROR 05 *S01486
     C                     OUT  LDA                        ***************S01486
     C                     EXSR *PSSR                      ***************
     C                     END
     C*
     C                     ENDSR                           * #INST ENDS**
     C*************************************************************************
      /EJECT                                                              CPM004
     C********************************************************************CPM004
     C**                                                                  CPM004
     C**   #BRCA           -  Access Branch Details                       CPM004
     C**                                                                  CPM004
     C**   CALLED BY #P01  -  FX Deal Processing                          CPM004
     C**             #P02  -  MM Deal Processing                          CPM004
     C**             #P03  -  Deal Amendment Processing                   CPM004
     C**                                                                  CPM004
     C**   CALLS     AOPLCSR1                                             CPM004
     C**                                                                  CPM004
     C*===================================================================CPM004
     C*                                                                   CPM004
     C           #BRCA     BEGSR                           * #BRCA BEGS * CPM004
     C*                                                                   CPM004
     C**   Access Branch Internal Customer, Branch Customer Report        CPM004
     C**   Name and Branch Account Officer.                               CPM004
     C*                                                                   CPM004
     C                     MOVEL'B'       I#PORS                          CPM004
     C                     MOVELBRCA      I#BRCA                          CPM004
      *                                                                   CPM004
     C                     CALL 'AOPLCSR1'                                CPM004
     C                     PARM *BLANKS   @RTCD   7                       CPM004
     C                     PARM '*KEY   ' @OPTN   7                       CPM004
     C                     PARM           I@PARM                          CPM004
     C                     PARM *BLANKS   O@PARM                          CPM004
     C           SDPLCS    PARM SDPLCS    DSFDY                           CPM004
      *                                                                   CPM004
     C           @RTCD     IFEQ 'PMA0007'                                 CPM004
     C           *LOCK     IN   LDA                                       CPM004
     C                     MOVEL'06'      DBASE            ***************CPM004
     C                     MOVE 'SDBRCHPD'DBFILE           * DB ERROR 06 *CPM004
     C                     MOVELI#BRCA    DBKEY            ***************CPM004
     C                     OUT  LDA                                       CPM004
     C                     EXSR *PSSR                                     CPM004
     C                     ENDIF                                          CPM004
      *                                                                   CPM004
     C                     ENDSR                           * #BRCA ENDS** CPM004
     C********************************************************************CPM004
      /EJECT
     C*************************************************************************
     C**
     C**   #P05          -  AUDIT PROCESSING
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS         -  #W0501 - WRITE TO TRANSACTION REPORT CONTROL
     C**                             AUDIT FILE
     C**                 -  #W0502 - WRITE TO DL DAILY TRANSACTIONS
     C**                             EXTRACT AUDIT REPORT
     C**
     C*=========================================================================
     C*
     C           #P05      BEGSR                           *** #P05 ***
     C*
     C***ACCESS*PF/PMTRCNZZ***TRANSACTION*REPORT*CONTROL*AUDIT*FILE       S01486
     C** ACCESS PF/PMTRCNPA - TRANSACTION REPORT CONTROL AUDIT FILE       S01486
     C***********          READ PMTRCNZZ                 72               S01486
     C                     READ PMTRCNPA                 72               S01486
     C                     ADD  FXCPT     SANORE
     C                     ADD  MMCPT     SANORE
     C***********          ADD  FR1CPT    SANORE                          082664
     C***********          ADD  FR2CPT    SANORE                          082664
     C                     ADD  DM1CPT    SANORE
     C                     ADD  DM2CPT    SANORE
     C                     MOVE 'D'       SARECI
     C*
     C** WRITE TO TRANSACTION REPORT CONTROL AUDIT FILE
     C                     EXSR #W0501
     C*
     C** WRITE TO LE DAILY TRANSACTIONS EXTRACT AUDIT REPORT
     C                     EXSR #W0502
     C*
     C                     ENDSR                           *** #P05 END **
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #W0501        -  WRITE TO TRANSACTION REPORT CONTROL AUDIT FILE
     C**
     C**   CALLED BY     -  #P05 - AUDIT PROCESSING
     C**
     C**   CALLS         -
     C**
     C*=========================================================================
     C*
     C           #W0501    BEGSR                           *** #W0501 **
     C*
     C           *IN72     IFEQ '0'
     C                     UPDATPMTRCNZ0
     C                     ELSE
     C                     WRITEPMTRCNZ0
     C                     END
     C*
     C                     ENDSR                           * #W0501 END *
     C*************************************************************************
      /EJECT
     C*************************************************************************
     C**
     C**   #W0502        -  WRITE TO DL DAILY TRANSACTION EXTRACT AUDIT
     C**                    REPORT
     C**
     C**   CALLED BY     -  #P05 - AUDIT PROCESSING
     C**
     C**   CALLS         -
     C**
     C*=========================================================================
     C*
     C           #W0502    BEGSR                           *** #W0502 **
     C*
     C                     WRITEPM0394P1
     C*
     C                     ENDSR                           * #W0502 END *
     C*************************************************************************
      /EJECT
     C********************************************************************
     C*
     C*  ZFDLLN SR. TO FORMAT THE 20A PORTFOLIO MANAGMENT LINE DESCRIPTION
     C*                                 FOR DEALING
     C*
     C*  CASE 1 FX DEALS (DEALSDB)        FORMAT: YYY VVVVVVV(DDDDDDD)
     C*          YYY = CUSTOMER SELL CURRENCY (IE BANK BUY CURRENCY)
     C*          VVVVVVV = VALUE DATE IN DDMMMYY FORMAT
     C*          DDDDDDD = DEAL DATE IN DDMMMYY FORMAT
     C*
     C*  CASE 2 MM DEALS (DEALSDC)        FORMAT: XXX 999.9999 DDMMMYY
     C*                                        OR: XXX 999.9999 999
     C*          XXX = CURRENCY
     C*          999.9999 = INTEREST RATE
     C*          DDMMMYY = MATURITY DATE (IF MATURITY DATE NOT = 0)
     C*          999 = NOTICE DAYS       (IF MATURITY DATE = 0 )
     C*
     C*  CASE 3 FRA/IRS DEALS (DEALSDG) DEAL TYPES FR, RS AND RL
     C*                                    FORMAT: XXX 999.9999 DDMMMYY
     C*          XXX = CURRENCY
     C*          999.9999 = INTEREST RATE
     C*          DDMMMYY = MATURITY DATE
     C*
     C*  CASE 4 FRA/IRS DEALS (DEALSDG) DEAL TYPE  RX
     C*                                    FORMAT: XXX XXX DDMMMYY
     C*          XXX = OUR AND THEIR CURRENCY
     C*          DDMMMYY = MATURITY DATE
     C*
     C*
     C*  INPUT  FIELDS
     C*       ZPUCY   3A     PURCHASE CURRENCY
     C*       ZDDAT   50     DEAL DATE
     C*       ZVDAT   50     VALUE DATE
     C*       ZCCY    3A     CURRENCY
     C*       ZINRT  117     INTEREST RATE
     C*       ZMDAT   50     MATURITY DATE
     C*       ZNOTD   30     NOTICE DAYS
     C*       ZUCUCY  3A     FRA/IRS OUR CURRENCY
     C*       ZUEINR 117     FRA/IRS OUR INTEREST RATE
     C*       ZTCUCY  3A     FRA/IRS THEIR CURRENCY
     C*
     C*  OUTPUT  FIELDS
     C*       ZLIN   20A     LINE DESCRIPTION
     C*
     C*  ARRAY USED
     C*       ZLI    20 ELEMENTS, EACH 1 CHARACTER LONG
     C*
     C********************************************************************
     C           ZFDLLN    BEGSR                           *** ZFDLLN ***
     C*
     C** CLEAR LINE DESCRIPTION .
     C                     MOVEA*BLANKS   ZLI
     C*
     C** FORMAT DETAIL OUTPUT FOR DEAL TYPE CASE 1
     C           ZDDAT     IFNE 0
     C                     MOVEAZPUCY     ZLI,01
     C                     Z-ADDZVDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C*
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,05
     C                     MOVEA'('       ZLI,12
     C*
     C                     Z-ADDZDDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C*
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,13
     C                     MOVEA')'       ZLI,20
     C                     END
     C*
     C** FORMAT DETAIL OUTPUT FOR DEAL TYPE CASE 2
     C           ZCCY      IFNE *BLANKS
     C                     MOVEAZCCY      ZLI,01
     C                     Z-ADDZINRT     ZWRKN   74
     C                     MOVELZWRKN     ZWRKA3  3
     C                     MOVELZWRKA3    ZWRKA2  2
     C*
     C** SUPPRESS LEADING ZEROES
     C           ZWRKA2    IFEQ '00'
     C                     MOVEL'  '      ZWRKA3
     C                     END
     C*
     C                     MOVELZWRKA3    ZWRKA1  1
     C           ZWRKA1    IFEQ '0'
     C                     MOVEL' '       ZWRKA3
     C                     END
     C*
     C                     MOVE ZWRKN     ZWRKA4  4
     C                     MOVEAZWRKA3    ZLI,05
     C                     MOVEA'.'       ZLI,08
     C                     MOVEAZWRKA4    ZLI,09
     C*
     C** IF MATURITY DATE ZERO OUTPUT NOTICE DAYS TO FORMATTED LINE
     C           ZMDAT     IFEQ *ZERO
     C                     MOVE ZNOTD     ZWRKA3  3
     C                     MOVEAZWRKA3    ZLI,14
     C                     ELSE
     C*
     C** OTHERWISE OUTPUT MATURITY DATE
     C                     Z-ADDZMDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,14
     C                     END
     C*
     C                     END
     C*
     C** FORMAT DETAIL OUTPUT FOR DEAL TYPE CASE 3
     C           ZUCUCY    IFNE *BLANKS
     C           ZTCUCY    ANDEQ*BLANKS
     C                     MOVEAZUCUCY    ZLI,01
     C                     Z-ADDZUEINR    ZWRKN   74
     C                     MOVELZWRKN     ZWRKA3  3
     C                     MOVELZWRKA3    ZWRKA2  2
     C*
     C** SUPPRESS LEADING ZEROES
     C           ZWRKA2    IFEQ '00'
     C                     MOVEL'  '      ZWRKA3
     C                     END
     C*
     C                     MOVELZWRKA3    ZWRKA1  1
     C           ZWRKA1    IFEQ '0'
     C                     MOVEL' '       ZWRKA3
     C                     END
     C*
     C                     MOVE ZWRKN     ZWRKA4  4
     C                     MOVEAZWRKA3    ZLI,05
     C                     MOVEA'.'       ZLI,08
     C                     MOVEAZWRKA4    ZLI,09
     C*
     C                     Z-ADDZMDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,14
     C*
     C                     END
     C*
     C** FORMAT DETAIL OUTPUT FOR DEAL TYPE CASE 4
     C           ZUCUCY    IFNE *BLANKS
     C           ZTCUCY    ANDNE*BLANKS
     C                     MOVEAZUCUCY    ZLI,01
     C                     MOVEAZTCUCY    ZLI,05
     C                     Z-ADDZMDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,09
     C*
     C                     END
     C*
     C** SET ALL  FIELDS TO BLANK OR ZERO
     C                     MOVE *BLANKS   ZCCY    3
     C                     MOVE *BLANKS   ZSLCY   3
     C                     Z-ADD*ZEROS    ZVDAT   50
     C                     MOVE *BLANKS   ZPUCY   3
     C                     Z-ADD*ZEROS    ZINRT  117
     C                     Z-ADD*ZEROS    ZDDAT   50
     C                     Z-ADD*ZEROS    ZMDAT   50
     C                     Z-ADD*ZEROS    ZNOTD   30
     C                     MOVE *BLANKS   ZUCUCY  3
     C                     Z-ADD*ZEROS    ZUEINR 117
     C                     MOVE *BLANKS   ZTCUCY  3
     C*
     C                     MOVEAZLI       ZLIN   20
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C********************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
     C********************************************************************
     C**
     C**   #INIT         -  INITIAL PROCESSING
     C**
     C**   CALLED BY     -  MAIN PROCESSING
     C**
     C**   CALLS         -
     C**
     C*=========================================================================
     C*
     C           #INIT     BEGSR                           *** #INIT ***
     C*
     C** INITIALIZE WORK FIELDS
     C           *LIKE     DEFN DTYP      WWDTYP
     C           *LIKE     DEFN CHTP      WWCHTP
     C           *LIKE     DEFN DLST      WWDLST
     C           *LIKE     DEFN BBCUST    WWPNP8
     C           *LIKE     DEFN CNUM      WWCNUM
     C           *LIKE     DEFN VDAT      WWVDAT
     C************LIKE     DEFN BRCD      WWBRCD                          S01486
     C           *LIKE     DEFN BRCA      WWBRCD                          S01486
     C           *LIKE     DEFN SAT1XT    WWDESI
     C*
      ***  Copyright Statement.                                           S01486
     C                     MOVEACPY@      CPY2@  80
     C           *NAMVAR   DEFN           LDA                             S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVE *BLANKS   DBLOT
     C                     MOVEL'PM0394'  DBPGM
     C                     OUT  LDA                                       S01486
     C*
     C** ACCESS BANK DETAILS
     C************         READ SDBANKPD                 99               S01486
     C************                                                        S01486
     C***IF*NOT*FOUND, ABORT PROGRAM                                      S01486
     C************IN99     IFEQ '1'                                       S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*MSG   ' WWRTCD  7                       S01486
     C                     PARM '*FIRST ' WWOPTN  7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVE '01'      DBASE
     C***********          MOVEL'SDBANKPD'DBFILE            ************  S01486
     C                     MOVE 'SDBANKPD'DBFILE            * DATABASE *  S01486
     C                     EXSR *PSSR                       * ERROR 01 *
     C                     OUT  LDA                         ************  S01486
     C                     END
     C                     MOVEL'Y'       WW394   1
     C*
     C** TEST DATE FORMAT FOR SR/ZDATE2
     C           BJDFIN    IFEQ 'M'
     C                     MOVE '1'       *IN98
     C                     END
     C*                                                                   CPM004
     C** ACCESS PM ICD                                                    CPM004
     C*                                                                   CPM004
     C                     CALL 'AOPORTR0'                                CPM004
     C                     PARM *BLANKS   WWRTCD                          CPM004
     C                     PARM '*FIRST  'WWOPTN                          CPM004
     C           SDPORT    PARM SDPORT    DSFDY                           CPM004
     C           WWRTCD    IFNE *BLANKS                                   CPM004
     C           *LOCK     IN   LDA                                       CPM004
     C                     MOVEL'50'      DBASE            ***************CPM004
     C                     MOVE 'SDPORTPD'DBFILE           * DB ERROR 50 *CPM004
     C                     OUT  LDA                        ***************CPM004
     C                     EXSR *PSSR                                     CPM004
     C                     END                                            CPM004
     C********************                                         S01486 081353
     C****ENSURE*AUDIT*SPOOL*FILE*RECORDED*BY*RCF                  S01486 081353
     C********************                                         S01486 081353
     C******************** Z-ADDSFNUMU    ZSNUMU  60               S01486 081353
     C********************                                         S01486 081353
     C******************** CALL 'ZSFILE'                           S01486 081353
     C******************** PARM           SEQ     5                S01486 081353
     C******************** PARM *BLANKS   SENTY   3                S01486 081353
     C******************** PARM           SFILEU                   S01486 081353
     C******************** PARM           ZSNUMU                   S01486 081353
     C******************** PARM *BLANK    ZSERR   1                S01486 081353
     C********************                                         S01486 081353
     C********** ZSERR     IFEQ 'Y'                                S01486 081353
     C********************                                         S01486 081353
     C****ERROR*DURING*ZSFILE*PROCESSING,*RETURN*TO*CALLING*PROGRAMS01486 081353
     C********************                                         S01486 081353
     C******************** SETON                     U7U8LR        S01486 081353
     C******************** RETRN                                   S01486 081353
     C******************** END                                     S01486 081353
      *                                                                   CDL006
      **  Check if CDL006 is installed.                                   CDL006
      *                                                                   CDL006
     C                     MOVEL'N'       CDL006  1                       CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM '       ' PRTCD   7                       CDL006
     C                     PARM '*VERIFY' POPTN   7                       CDL006
     C                     PARM 'CDL006'  PSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
      *                                                                   CDL006
     C           PRTCD     IFEQ *BLANK                                    CDL006
     C                     MOVE 'Y'       CDL006                          CDL006
     C                     ELSE                                           CDL006
     C           PRTCD     IFNE '*NRF   '                                 CDL006
     C           *LOCK     IN   LDA                                       CDL006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CDL006
     C                     MOVEL'CDL006'  DBKEY            * DBERR 07 *   CDL006
     C                     MOVEL'07'      DBASE            ************   CDL006
     C                     MOVE *ON       *INU7                           CDL006
     C                     MOVE *ON       *INU8                           CDL006
     C                     MOVE *ON       *INLR                           CDL006
     C                     OUT  LDA                                       CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDSR                           * #INIT END *
     C*****************************************************************   R10040
     C/EJECT                                                              R10040
     C*****************************************************************   R10040
     C*                                                                   R10040
     C*    #P40   - OBTAIN ACCOUNT NAME                                   R10040
     C*                                                                   R10040
     C*    INPUT PARAMETERS OF ACCOUNT NUMBER AND CURRENCY                R10040
     C*                                                                   R10040
     C*    OUTPUTS ACCOUNT NAME                                           R10040
     C*                                                                   R10040
     C*****************************************************************   R10040
     C           #P40      BEGSR                           * #P40   BSR * R10040
     C*                                                                   R10040
     C                     MOVE *BLANKS   WWANAM 20                       R10040
     C           ACNKEY    KLIST                                          R10040
     C                     KFLD           WWCNUK                          R10040
     C                     KFLD           WWCCY1                          R10040
     C                     KFLD           WWACOK                          R10040
     C                     KFLD           WWACSK                          R10040
     C                     KFLD           WWBRCA                          085867
     C*                                                                   R10040
     C** IF SETTLED ACROSS A RETAIL ACCOUNT OBTAIN ACCOUNT NAME           R10040
     C           WWSETM    IFEQ '04'                                      R10040
     C           WWSETM    OREQ '05'                                      R10040
     C           WWSETM    OREQ '14'                                      R10040
     C           WWSETM    OREQ '15'                                      R10040
     C*                                                                   R10040
     C                     MOVE WWSTAC    WWCHK2  2                       R10040
     C*                                                                   R10040
     C** IF 10N ACCOUNT CODE ACCESS LF/ACNUM TO GET RETAIL ACCOUNT        R10040
     C** DETAILS                                                          R10040
     C           WWCHK2    IFEQ *BLANKS                                   R10040
     C           WWSTAC    ANDNE*BLANKS                                   R10040
     C                     MOVELWWSTAC    WWWK10 100                      R10040
     C*                                                                   R10040
     C***********WWWK10    CHAINACNUM                73             R10040B9930
     C           WWWK10    CHAINACNUMA               73                   B9930
     C           *IN73     IFEQ '0'                                       R10040
     C                     MOVE ANAM      WWANAM                          R10040
     C                     END                                            R10040
     C*                                                                   R10040
     C** IF 12A ACCOUNT CODE ACCESS LF/ACCNT TO GET RETAIL ACCOUNT        R10040
     C** DETAILS                                                          R10040
     C                     ELSE                                           R10040
     C                     MOVELWWSTAC    WWWK1A 10                       R10040
     C                     MOVE WWSTAC    WWACSK  20                      R10040
     C**********           MOVELWWSTAC    WWCNUK  60                                   R10040 CSD027
     C                     MOVELWWSTAC    WWCNUK  6                                           CSD027
     C**********           MOVE WWWK1A    WWACOK  40                                   R10040 CGL029
     C                     MOVE WWWK1A    WWACOK 100                                          CGL029
     C*                                                                   R10040
     C           ACNKEY    CHAINACCNT                73                   R10040
     C           *IN73     IFEQ '0'                                       R10040
     C                     MOVE ANAM      WWANAM                          R10040
     C                     END                                            R10040
     C                     END                                            R10040
     C                     END                                            R10040
     C*                                                                   R10040
     C                     MOVE *BLANKS   WWSETM  2                       R10040
     C                     MOVE *BLANKS   WWSTAC 12                       R10040
     C                     MOVE *BLANKS   WWBRCA  3                       085867
     C*                                                                   R10040
     C                     ENDSR                           * #P40   ESR * R10040
     C**************************************************************************
      /EJECT
     C**************************************************************************
      ** *PSSR       :      FILE EXCEPTION ERROR HANDLING SUBROUTINE
      ** CALLED FROM : MAIN
      ** CALLS       :
     C*=========================================================================
     C           *PSSR     BEGSR                            ** *PSRR BSR**
     C**
     C** ROLL BACK CHANGES , DUMP AND RETURN TO THE CALLING PROGRAM
     C**
     C                     MOVE '1'       *INLR
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C*                    ROLBK
     C                     DUMP
     C                     RETRN
     C**
     C                     ENDSR                            ** *PSRR ESR**
     C*=========================================================================
**  DEAL AMENDMENT TYPES
SCCISIPIPD
**  DEAL AMENDMENT NARRATIVES
DEPOT RATE CHANGE
DEPOT INT CAPITLN
DEPOT INT SETTLEMNT
DEPOT PRINC INCR
DEPOT PRINC DECR
**  LOAN AMENDMENT NARRATIVES
LOAN RATE CHANGE
LOAN INT CAPITLN
LOAN INT SETTLEMNT
LOAN PRINC INCR
LOAN PRINC DECR
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
