     H        1
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Daily transaction report')                    *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management Module                          *
     F*                                                               *
     F*  PM0400 - DAILY TRANSACTION REPORT                            *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CGL165             Date 15Feb17               *
      *  Prev Amend No. CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 11Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CSW037A            Date 02May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 182961             Date 21Apr01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CFF004             Date 11Sep96               *
      *                 103081             Date 24Apr96               *
     F*                 S71062             DATE 27NOV95               *
     F*                 S01408             DATE 01APR96               *
     F*                 CPM004             DATE 08FEB96               *
     F*                 085867             DATE 16MAR95               *
     F*                 S01496             DATE 09NOV94               *
     F*                 S01486             DATE 20SEP94               *
     F*                 062353             DATE 21OCT93               *
     F*                 049421             DATE 22JAN93               *
     F*                 058883             DATE 23JUL93               *
     F*                 056452      LJ     DATE 14JUN93               *
     F*                 47719              DATE 24NOV92               *
     F*                 ROLLOV             DATE 30SEP91               *
     F*                 B07958             DATE 10/06/91              *
     F*                 B07949             DATE 06/06/91              *
     F*                 R05913             DATE 30/04/91              *
     F*                 R05581             DATE 04/03/91              *
     F*                 R0041              DATE 16/09/90              *
     F*                 R10040             DATE 16/09/90              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CLE148 - Alpha Loan Reference                                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  182961 - Database error occurred due to a blank key field    *
      *           (Instrument Type).  The default Instrument type in  *
      *           PF/SDPORTPD is taken if a blank instrument type is  *
      *           encountered.                                        *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  CFF004 - Increase in size of Price Fields,(Recompiled only)  *
     F*  103081 - FX Purchase/Sale narrative needs to be reversed for *
     F*           Bank Portfolios.                                    *
     F*  S71062 - FF/PM Interface.                                    *
     F*  S01408 - Addition of core hook PM0400CCP4                    *
     F*         - Addition of core hook PM0400CCP3                    *
     F*         - Addition of core hook PM0400CCP2                    *
     F*         - Addition of core hook PM0400CCP1                    *
     F*  CPM004 - Bank Portfolios                                     *
     F*  085867 - Change Pay A/C and Rec A/C to have the branch code  *
     F*  S01496 - Incorporation of PB SE Enhancements (S10978)        *
     F*  S01486 - PORTFOLIO MANAGEMENT UPGRADE TO R10                 *
     F*  062353 - OUTPUT ROLLOVER DATE FOR LOANS                      *
     F*  049421 - HEADER BOX STANDARDISATION                          *
     F*  058883 - CORRECT REPORTING OF CASH POSTING                   *
     F*  056452 - TRANSACTIONS DISPLAYED FROM CUSTOMER POINT OF VIEW. *
     F*           FOR FX DEALS, ADD 'CCY' IN CURRENT ACCOUNT.         *
     F*  47719  - CORRECT CONVERSION OF AMOUNTS BETWEEN CURRENCIES    *
     F*  ROLLOV - PRINT OF ROLLOVER DETAILS FOR MMDEALS               *
     F*  B07958 - CORRECT B07949                                      *
     F*  B07949 - OUTPUT CHARGE AMOUNT FOR FIDUCIARY LOANS AND DEPOSIT*
     F*  R05913 - OUTPUT 30A POSTING NARRATIVE                        *
     F*  R05581 - OUTPUT TEXT DELETED FOR REVERSED (SACHTP = R) TRANS *
     F*  R10041 - OUTPUT DETAILS OF ALL POSTINGS ON DAILY             *
     F*           TRANSACTIONS REPORT                                 *
     F*  R10040 - OUTPUT ACCOUNT NAME ON DAILY TRANSACTIONS REPORT    *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,PM0400F001
     FSDPORTPDIF  E                    DISK         KINFSR *PSSR          182961
     F***PM0400AUO   E                    PRINTER                         S01486
     F***PM0400P1O   E                    PRINTER                     UC  S01486
     FPM0400AUO   E                    PRINTER      KINFDS SPOOLU         S01486
     FPM0400P1O   E                    PRINTER      KINFDS SPOOL      UC  S01486
     F***PMTRCNZZIF  E           K        DISK                            S01486
     FPMTRCNPAIF  E           K        DISK                               S01486
     F** PREFIX  SA
     F                                              KINFSR *PSSR
     F***********                                                         S01486
     F***SDBANKPDIF  E                    DISK                            S01486
     F***PREFIX**BJ                                                       S01486
     F***********                                   KINFSR *PSSR          S01486
     F***SDPORTPDIF  E                    DISK                            S01486
     F***PREFIX**P9                                                       S01486
     F***********                                   KINFSR *PSSR          S01486
     F***SDPLCSPDIF  E           K        DISK                            S01486
     F***PREFIX**QB                                                       S01486
     F***********                                   KINFSR *PSSR          S01486
     F***SDPLINPDIF  E           K        DISK                            S01486
     F***PREFIX**PD                                                       S01486
     F***********                                   KINFSR *PSSR          S01486
     F***SDCUSTL0IF  E           K        DISK                            S01486
     F***PREFIX**BB                                                       S01486
     F***********                                   KINFSR *PSSR          S01486
     F***PMPORTPPIF  E           K        DISK                            S01486
     FPMPORTPDIF  E           K        DISK                               S01486
     F** PREFIX  PN
     F                                              KINFSR *PSSR
     F***MMDELDY0IF  E           K        DISK                        ROL S01486
     F***PREFIX**MM                                                 ROLLOVS01486
     F***********                                   KINFSR *PSSR       ROLS01486
     F***SDCURRL0IF  E           K        DISK                            S01486
     F***PREFIX**A6                                                       S01486
     F***********                                   KINFSR *PSSR          S01486
     F***PMTRCNJFIP  E           K        DISK                            S01486
     F***PMTRCNL0IP  E           K        DISK                     S01486 CPM004
     F*                                                                   CPM004
     FPMTRCNL0IP  E           K        DISK                           U1  CPM004
     F                                              KINFSR *PSSR
     FPMTRCNL1IS  E           K        DISK                           U2  CPM004
     F                                              KINFSR *PSSR          CPM004
     F**  Prefix VC                                                       S01496
     FSEERALL5IF  E           K        DISK                               S01496
     F                                              KINFSR *PSSR          S01496
     FDEALS   IF  E           K        DISK                           UC  CDL006
     F            DEALSDAF                          KIGNORE               CDL006
     F            DEALSDBF                          KIGNORE               CDL006
     F            DEALSDDF                          KIGNORE               CDL006
     F            DEALSDEF                          KIGNORE               CDL006
     F            DEALSDFF                          KIGNORE               CDL006
     F            DEALSDGF                          KIGNORE               CDL006
      /EJECT
     F*
     F** ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F**    UNUSED INDICATORS
     F**    -----------------
     F*
     F**       01  02  03  04  05  06  07  08  09  10
     F**       11  12  13  14  15  16  17  18  19  20
     F**       ..  ..  ..  24  25  26  27  28  29  30
     F**       31  32  33  34  35  36  37  38  39  40
     F**       41  42  43  44  45  46  47  48  49  ..
     F**       51  52  53  54  55  56  57  58  59  60
     F**       61  62  63  64  65  66  67  68  69  70
     F**       ..  ..  73  74  ..  76  77  78  79  80
     F**       81  82  83  84  85  86  87  88  89  90
     F**       91  92  93  94  95  96  97  98  99
     F*
     F**   INDICATOR USAGE
     F**   ---------------
     F*
     F**  21      PRINT OF MATURITY DATE OR CALL/NOTICE DAYS IN MM DEALS
     F**  22      PRINT 'PAYMENT DETAILS' OR 'RECEIPT DETAILS'
     F**  23      MODULE ID IS 'FD' OR 'FL'
     F**  30      PRINT OF ROLLOVER DETAILS FOR MM DEALS
     F**  50      Bank Portfolio is supported                             CPM004
     F**  71      INITIAL PROCESSING
     F**  72      FILES ACCESS INDICATOR
     F**  75      I/O ERROR DURING END FORMAT PRINTING (OVERFLOW ERROR)
      *  88 - Used by Dealing Fiduciary to control fields on PRTF     *   CDL006
     F*
      /EJECT
      /COPY ZSRSRC,ZSEDITZ1
     E                    ZS3        21  1               #MVLED ARRAY
      /COPY ZSRSRC,ZDATE2Z1
      /COPY ZSRSRC,ZPOWER8Z1
      /COPY ZSRSRC,ZPOWERZ1
     E************        CMD     1   1 39               QCMDEXC  ARRAY   S01486
     E* ARRAY CONTENTS LINE DELETED AT BOTTOM OF THE PGM , CONTAINING :   S01486
     E* OVRPRTF FILE(PM0400P1) SPLFNAME(PM0400P                           S01486
     E*
     E**   Array for copyright
     E                    CPY@    1   1 80               COPYRIGHT
     E*                                                                   S71062
     E**   Array for standard subroutines FFPRCS                          S71062
      /COPY ZSRSRC,FFPRCSZ2                                               S71062
      /EJECT
     I*
     I** DAILY TRANSACTION INPUT FILE
     I** Bank Portfolio not supported                                     CPM004
     IPMTRCNP1
     I************                                  AZPRTLL6              S01486
     I                                              SAACOCL5
     I                                              SACNUML4
     I                                              SAPTFRL3
     I                                              PADSPSL2
     I                                              SAINNRL1
     I*                                                                   CPM004
     I** Bank Portfolio supported                                         CPM004
     IPMTRCNP2                                                            CPM004
     I              SABACO                          SAACOCL5              CPM004
     I              SABCNM                          SACNUML4              CPM004
     I              SABCRN                          SACRNM                CPM004
     I              SAACOC                          SATCAC                CPM004
     I              SACNUM                          SATCNM                CPM004
     I              SACRNM                          SATCRN                CPM004
     I                                              SAPTFRL3              CPM004
     I                                              PADSPSL2              CPM004
     I                                              SAINNRL1              CPM004
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I***LDA        UDS                            256                    S01486
     I**********                            132 183 DBLOT                 S01486
     I**********                            132 141 DBFILE                S01486
     ILDA         DS                            256                       S01486
     I                                      134 183 DBLOT                 S01486
     I                                      134 141 DBFILE                S01486
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I**********                            181 183 DBASE                 S01486
     I                                      181 1830DBASE                 S01486
     I*
     I            DS
     I                                        1  10 FFDS
     I                                        1   5 RRFFNM
     I                                        6   70YRN
     I                                        8   90MTH
     I                                       10  10 PCAL
     I*
     I            DS
     I                                        1  10 LEDS
     I                                        1   3 RRFTYP
     I                                        9  10 RRFSEQ
     I*
     I            DS
     I**********                              1   60RETRNB                                    CGL029
     I**********                              1   4 RRACOD                                    CGL029
     I**********                              5   6 RRACSQ                                    CGL029
     I                                        1  120RETRNB                                    CGL029
     I                                        1  10 RRACOD                                    CGL029
     I                                       11  12 RRACSQ                                    CGL029
     I*
     I** DATA STRUCTURE USED IN SR/ZSEDIT
      /COPY ZSRSRC,ZSEDITZ2
     I*
     I** DATA STRUCTURE TO REDIFINED ZADATE FIELD
     I            DS
     I                                        1   7 ZADATE
     I                                        1   1 WWDAT1
     ISDBANK    E DSSDBANKPD                                              S01486
     I** EXTERNAL DS FOR BANK DETAILS                                     S01486
     ISDPLIN    E DSSDPLINPD                                              S01486
     I** EXTERNAL DS FOR PM/LB INSTRUMENT TYPE DETAILS                    S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01486
     ISDPORT    E DSSDPORTPD                                              S01486
     I** EXTERNAL DS FOR PORTOLIO ICD                                     S01486
     ISDPLCS    E DSSDPLCSPD                                              S01486
     I** EXTERNAL DS FOR PM CUSTOMER DETAILS                              S01486
     ISDCUST    E DSSDCUSTPD                                              S01486
     I** EXTERNAL DS FOR CUSTOMER DETAILS                                 S01486
     ISCSARD    E DSSCSARDPD                                              S01496
     I** External DS for switchable features file detials                 S01496
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* SECOND DS FOR ACCESS PROGRAMS, LONG  DATA STRUCTURE               S01486
      *                                                                   S01486
     ISPOOL       DS                                                      S01486
     I                                       83  92 SFILE                 S01486
     I                                    B 123 1240SFNUM                 S01486
     I                                    B 367 3680LINE                  S01486
     ISPOOLU      DS                                                      S01486
     I                                       83  92 SFILEU                S01486
     I                                    B 123 1240SFNUMU                S01486
     I                                    B 367 3680LINE1                 S01486
     I*                                                                   S71062
     I            DS                                                      S71062
     I                                        1  16 RRAM1R                S71062
     I                                        6  10 RROPCT                S71062
     I** Data structures for standard subroutines FFPRCS                  S71062
      /COPY ZSRSRC,FFSRDSZ1                                               S71062
      /COPY ZSRSRC,FFPRCSZ3                                               S71062
     I*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #P01     - TRANSACTIONS PROCESSING                               *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      * #P04     - PROCESS SE TRADES                                     *
      * #P05     - PROCESS SE DEPOT MOVEMENTS                            *
      **#P06*****-*PROCESS*FF*TRANSACTIONS********************************S01486
      * #P06     - PROCESS FF TRANSACTIONS                               *S71062
      * #P07     - PROCESS FX DEALS                                      *
      * #P08     - PROCESS MM DEALS                                      *S01486
      **#P08*****-*PROCESS*MM*DEALS*AND*FIDUCIARY*DEPOSITS****************S01486
      **#P09*****-*PROCESS*FR,*RS,*RL*DEALS*******************************S01486
      **#P10*****-*PROCESS*RX*DEALS***************************************S01486
      **#P11*****-*PROCESS*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS***S01486
      **#P12*****-*PROCESS*SC,*CI,*SI*DEAL*AND*FID.*DEPOSIT*AMENDMENTS****S01486
      **#P13*****-*PROCESS*LE*LOANS*AND*FIDUCIARY*LOANS*******************S01486
      **#P14*****-*PROCESS*PI,*MR*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS******S01486
      **#P15*****-*PROCESS*SC,*CI,*SI*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS**S01486
      * #P11     - PROCESS PI, PD DEAL AMENDMENTS                        *S01486
      * #P12     - PROCESS SC, CI, SI DEAL AMENDMENTS                    *S01486
      * #P13     - PROCESS LE LOANS                                      *S01486
      * #P14     - PROCESS PI, MR LOAN AMENDMENTS                        *S01486
      * #P15     - PROCESS SC, CI, SI LOAN AMENDMENTS                    *S01486
      * #P16     - PROCESS MANUAL POSTINGS                               *
      **#P17*****-*PROCESS*SA*FIDUCIARY*LOAN*AMENDMENTS*******************S01486
      * #CURR    - ACCESS CURRENCY DETAILS
      * #CUST    - ACCESS CUSTOMER DETAILS
      * #PORT    - ACCESS PORTFOLIO DETAILS
      * #INST    - ACCESS INSTRUMENT TYPE DETAILS
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * #W02     - WRITE TO DAILY TRANSACTIONS AUDIT REPORT              *
      * #W04     - WRITE SE TRADES TO DAILY TRANSACTIONS REPORT          *
      * #W05     - WRITE SE DEPOT MOVEMENTS TO DAILY TRANS. REPORT       *
      **#W06*****-*WRITE*FF*TRANSACTIONS*TO*DAILY*TRANSACTIONS*REPORT*****S01486
      * #W06     - WRITE FF TRANSACTIONS TO DAILY TRANSACTIONS REPORT    *S71062
      * #W07     - WRITE FX DEALS TO DAILY TRANSACTIONS REPORT           *
      * #W08     - WRITE MM DEALS                                        *S01486
      **#W08*****-*WRITE*MM*DEALS*AND*FID.*DEPOSITS*TRANSACTIONS*REPORT***S01486
      **#W09*****-*WRITE*FR,*RS,*RL*DEALS*TO*DAILY*TRANS.*REPORT**********S01486
      **#W10*****-*WRITE*RX*DEALS*TO*DAILY*TRANSACTIONS*REPORT************S01486
      **#W11*****-*WRITE*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS*****S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W12*****-*WRITE*SC,*CI,*SI*DEAL*AND*FIDUCIARY*DEPOSIT************S01486
      *************AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT****************S01486
      **#W13*****-*WRITE*LE*AND*FID.*LOANS*TO*DAILY*TRANSACTIONS*REPORT***S01486
      **#W14*****-*WRITE*PI,*MR*LOAN*ANDS*FIDUCIARY*LOAN*AMENDMENTS*******S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W15*****-*WRITE*SC,*CI,*SI*LOAN*AMEND.*AND*SC,*BC*FIDUCIARY******S01486
      *************LOAN*AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT***********S01486
      * #W11     - WRITE PI, PD DEAL AMENDMENTS TO DAILY TRANSACTIONS    *S01486
      *            REPORT                                                *S01486
      * #W12     - WRITE SC, CI, SI DEAL AMENDMENTS TO DAILY             *S01486
      *            TRANSACTIONS REPORT                                   *S01486
      * #W13     - WRITE LE LOANS TO DAILY TRANSACTIONS REPORT           *S01486
      * #W14     - WRITE PI, MR LOAN AMENDMENTS TO DAILY TRANSACTION     *S01486
      *            REPORT                                                *S01486
      * #W15     - WRITE SC, CI, SI LOAN AMEND. TO DAILY TRANSACTION     *S01486
      *            REPORT                                                *S01486
      * #W16     - WRITE MANUAL POSTINGS TO DAILY TRANSACTIONS REPORT    *
      **#W17*****-*WRITE*SA*FIDUCIARY*LOAN*AMENDMENTS*TO*DAILY*REPORT*****S01486
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      * ZAPNUM   - TO CALCULATE AVERAGE PRICE NUMERATOR                  *
      * ZCCYXR   - TO CONVERT NOMINAL CCY AMT TO SETTLEMENT CCY AMT      *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      * #P02     - AUDIT PROCESSING                                      *
      * #INIT    - INITIAL PROCESSING
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      * QCMDEXC  -                                                       *
      *                                                                  *
      ********************************************************************
     C*
     C                     MOVEACPY@      CPY2@  80
     C*
     C***Define*key*list*for*file*SDPORTPP********************************S01486
     C** Define key list for file SDPORTPD                                S01486
     C           PKEY      KLIST
     C                     KFLD           SACNUM
     C                     KFLD           SAPTFR
      /EJECT
     C*****************************************************************
     C*                                                               *
     C*  M A I N   P R O C E S S I N G                                *
     C*                                                               *
     C*****************************************************************
     C*
     C*
     C** PERFORM INITIAL PROCESSING
     C           *IN71     IFEQ '0'
     C                     EXSR #INIT
     C                     END
     C*
     C** EXSR #P01 - TRANSACTIONS PROCESSING
     C                     EXSR #P01
     C*
     C** EXSR #P02 - AUDIT PROCESSING
     CLR                   Z-ADD*ZERO     PAGE
     CLR                   EXSR #P02
     CLR                   CLOSEPM0400P1
     C*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P01     - TRANSACTIONS PROCESSING                               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * QCMDEXC  -                                                       *
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      * #CUST    - ACCESS CUSTOMER DETAILS
      * #PORT    - ACCESS PORTFOLIO DETAILS
      * #INST    - ACCESS INSTRUMENT TYPE DETAILS
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWPRTL   -                                                       *
      * WWCMDP   -                                                       *
      *                                                                  *
      ********************************************************************
     C           #P01      BEGSR                           *** #P01    ***
     C*
     C**  Process records only if PB SE Enhancements is installed or      S01496
     C**  module ID is not equal to 'ER'                                  S01496
     C*                                                                   S01496
     C           S01496    IFEQ 'Y'                                       S01496
     C           SAMODI    ORNE 'ER'                                      S01496
     C*
     C** ADD 1 TO NUMBER OF RECORDS READ
     C                     ADD  1         TRACPT  50
     C*
     C***USE*THE*ADEQUATE*ACCOUNT*OFFICER*PRINTER*FILE*WHEN*CHANGE****    S01486
     C***OF*ACCOUNT*OFFICER*PRINTER*LOCATION*(NOT*FIRST*CYCLE)********    S01486
     C************INL6     IFEQ '1'                                       S01486
     C************IN71     ANDEQ'1'                                       S01486
     C***********          MOVE '0'       *IN75                           S01486
     C***********          WRITEPM0400EN               75                 S01486
     C***********          CLOSEPM0400P1                                  S01486
     C***********          MOVELAZPRTL    WWPRTL                          S01486
     C***********          MOVE WWPRTL    WWCMDP                          S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM WWCMDP    QCAA   43                       S01486
     C***********          PARM 43        QCAN   155                      S01486
     C***********          OPEN PM0400P1                                  S01486
     C***********          Z-ADD*ZERO     PAGE                            S01486
     C***********          END                                            S01486
     C*                                                                   S01486
     C** ONLY PROCESS RECORDS REQUESTED                                   S01486
     C*                                                                   S01486
     C           *INL5     IFNE '1'                                       S01486
     C           *INL5     OREQ '1'                                       S01486
     C           SAACOC    ANDEQRENT                                      S01486
     C           *INL5     OREQ '1'                                       S01486
     C           RENT      ANDEQ'ALL'                                     S01486
     C*
     C** NEW SPOOL FILE IF CHANGE IN ACCOUNT OFFICER                      S01486
     C           *INL5     IFEQ '1'                                       S01486
     C                     MOVE '0'       *IN75                           S01486
     C*
     C           WLOPN     IFEQ 'Y'                                       S01486
     C                     WRITEPM0400EN               75                 S01486
     C                     CLOSEPM0400P1                                  S01486
     C                     MOVE *BLANK    WLOPN                           S01486
     C                     END                                            S01486
     C*
     C                     EXSR #NEWP1                                    S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C** ACCESS CUSTOMER DETAILS WHEN CHANGE OF CUSTOMER
     C           *INL4     IFEQ '1'
     C                     EXSR #CUST
     C                     END
     C*
     C** ACCESS  PORTFOLIO REFERENCE DETAILS WHEN CHANGE AND PRINT
     C** PORTFOLIO HEADINGS
     C           *INL3     IFEQ '1'
     C                     EXSR #PORT
     C                     EXSR #W0101
     C                     END
     C*
     C** PRINT GROUP HEADINGS WHEN CHANGE OF GROUP
     C           *INL2     IFEQ '1'
     C                     EXSR #W0102
     C                     END
     C*
     C** ACCESS THE INSTRUMENT DETAILS WHEN CHANGE AND PRINT
     C** INSTRUMENT HEADINGS
     C           *INL1     IFEQ '1'
     C                     EXSR #INST
     C                     EXSR #W0103
     C                     END
     C*
     C**  EXECUTE #P03  TO DETERMINE TYPE OF TRANSACTION
     C                     EXSR #P03
     C*                                                                   S01496
     C                     END                                            S01496
     C                     END                                            S01486
     C*
     C**  POSITION INITIAL PROCESSING INDICATOR
     C           *IN71     IFEQ '0'
     C                     MOVE '1'       *IN71
     C                     END
     C*
     C                     ENDSR                           *** #P01 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P04     - PROCESS SE TRADES                                     *
      * #P05     - PROCESS SE DEPOT MOVEMENTS                            *
      **#P06*****-*PROCESS*FF*TRANSACTIONS********************************S01486
      * #P06     - PROCESS FF TRANSACTIONS                               *S71062
      * #P07     - PROCESS FX DEALS                                      *
      * #P08     - PROCESS MM DEALS                                      *S01486
      **#P08*****-*PROCESS*MM*DEALS*AND*FIDUCIARY*DEPOSITS****************S01486
      **#P09*****-*PROCESS*FR,*RS,*RL*DEALS*******************************S01486
      **#P10*****-*PROCESS*RX*DEALS***************************************S01486
      **#P11*****-*PROCESS*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS***S01486
      **#P12*****-*PROCESS*SC,*CI,*SI*DEAL*AND*FID.*DEPOSIT*AMENDMENTS****S01486
      **#P13*****-*PROCESS*LE*LOANS*AND*FIDUCIARY*LOANS*******************S01486
      **#P14*****-*PROCESS*PI,*MR*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS******S01486
      **#P15*****-*PROCESS*SC,*CI,*SI*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS**S01486
      * #P11     - PROCESS PI, PD DEAL                                   *S01486
      * #P12     - PROCESS SC, CI, SI DEAL                               *S01486
      * #P13     - PROCESS LE LOANS                                      *S01486
      * #P14     - PROCESS PI, MR LOAN                                   *S01486
      * #P15     - PROCESS SC, CI, SI LOAN                               *S01486
      * #P16     - PROCESS MANUAL POSTINGS                               *
      **#P17*****-*PROCESS*SA*FIDUCIARY*LOAN*AMENDMENTS*******************S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - TRANSACTIONS PROCESSING                               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P03      BEGSR                           *** #P03   ***
     C*
     C** TEST MODULE ID   SE  SEII TRANSACTIONS
     C           SAMODI    IFEQ 'SE'
     C*
     C** TEST TRANSACTION TYPE
     C           SATRTP    IFEQ 'TP'
     C           SATRTP    OREQ 'TS'
     C                     EXSR #P04
     C                     END
     C           SATRTP    IFEQ 'WI'
     C           SATRTP    OREQ 'WO'
     C                     EXSR #P05
     C                     END
     C                     END
     C*                                                                   S01496
     C** Test feature ER Early Redemptions                                S01496
     C           S01496    IFEQ 'Y'                                       S01496
     C           SAMODI    ANDEQ'ER'                                      S01496
     C                     EXSR #P05                                      S01496
     C                     END                                            S01496
     C***********                                                         S01486
     C***TEST*MODULE*ID**FF*FUTURE*&*OPTIONS******************************S01486
     C***********SAMODI    IFEQ 'FF'                                      S01486
     C***********          EXSR #P06                                      S01486
     C***********          END                                            S01486
     C**                                                                  S71062
     C** TEST MODULE ID  FF FUTURE & OPTIONS                              S71062
     C           SAMODI    IFEQ 'FF'                                      S71062
     C                     EXSR #P06                                      S71062
     C                     ENDIF                                          S71062
     C*
     C** TEST MODULE ID  DB  FX DEALS
     C           SAMODI    IFEQ 'DB'
     C                     EXSR #P07
     C                     END
     C*
     C** TEST MODULE ID  DC   MM DEALS
     C           SAMODI    IFEQ 'DC'
     C                     MOVE '0'       *IN23
     C                     EXSR #P08
     C                     END
     C***********                                                         S01486
     C***TEST*MODULE*ID**DG*FRA/IRS***************************************S01486
     C***********SAMODI    IFEQ 'DG'                                      S01486
     C***********                                                         S01486
     C***TEST*TRANSACTION*TYPE********************************************S01486
     C***********SATRTP    IFEQ 'FR'                                      S01486
     C***********SATRTP    OREQ 'RS'                                      S01486
     C***********SATRTP    OREQ 'RL'                                      S01486
     C***********          EXSR #P09                                      S01486
     C***********          END                                            S01486
     C***********SATRTP    IFEQ 'RX'                                      S01486
     C***********          EXSR #P10                                      S01486
     C***********          END                                            S01486
     C***********          END                                            S01486
     C** TEST MODULE ID  DI DEAL AMENDMENTS
     C           SAMODI    IFEQ 'DI'
     C*
     C** TEST TRANSACTION TYPE
     C           SATRTP    IFEQ 'PI'
     C           SATRTP    OREQ 'PD'
     C                     MOVE '0'       *IN23
     C                     EXSR #P11
     C                     END
     C           SATRTP    IFEQ 'SC'
     C           SATRTP    OREQ 'CI'
     C           SATRTP    OREQ 'SI'
     C                     MOVE '0'       *IN23
     C                     EXSR #P12
     C                     END
     C                     END
     C*
     C** TEST MODULE ID   CL CUSTOMER LENDING
     C           SAMODI    IFEQ 'CL'
     C                     MOVE '0'       *IN23
     C                     EXSR #P13
     C                     END
     C** TEST MODULE ID  DK LOAN AMENDMENTS
     C           SAMODI    IFEQ 'DK'
     C*
     C** TEST TRANSACTION TYPE
     C           SATRTP    IFEQ 'PI'
     C           SATRTP    OREQ 'MR'
     C                     MOVE '0'       *IN23
     C                     EXSR #P14
     C                     END
     C           SATRTP    IFEQ 'SC'
     C           SATRTP    OREQ 'CI'
     C           SATRTP    OREQ 'SI'
     C                     MOVE '0'       *IN23
     C                     EXSR #P15
     C                     END
     C                     END
     C*
     C** TEST MODULE ID   GL MANUAL POSTINGS
     C           SAMODI    IFEQ 'GL'
     C                     EXSR #P16
     C                     END
     C***********                                                         S01486
     C***TEST*MODULE*ID***FD*FIDUCIARY*DEPOSITS***************************S01486
     C***********SAMODI    IFEQ 'FD'                                      S01486
     C***********          MOVE '1'       *IN23                           S01486
     C***********          EXSR #P08                                      S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***TEST*MODULE*ID***FL*FIDUCIARY*LOANS******************************S01486
     C***********SAMODI    IFEQ 'FL'                                      S01486
     C***********          MOVE '1'       *IN23                           S01486
     C***********          EXSR #P13                                      S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***TEST*MODULE*ID***FA*FIDUCIARY*DEPOSIT*AMENDMENTS*****************S01486
     C***********SAMODI    IFEQ 'FA'                                      S01486
     C***********          MOVE '1'       *IN23                           S01486
     C***********                                                         S01486
     C***********SATRTP    IFEQ 'PI'                                      S01486
     C***********SATRTP    OREQ 'PD'                                      S01486
     C***********          EXSR #P11                                      S01486
     C***********          ELSE                                           S01486
     C***********          EXSR #P12                                      S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***TEST*MODULE*ID***FM*FIDUCIARY*LOAN*AMENDMENTS********************S01486
     C***********SAMODI    IFEQ 'FM'                                      S01486
     C***********          MOVE '1'       *IN23                           S01486
     C***********                                                         S01486
     C***********SATRTP    IFEQ 'PI'                                      S01486
     C***********SATRTP    OREQ 'MR'                                      S01486
     C***********          EXSR #P14                                      S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********SATRTP    IFEQ 'SC'                                      S01486
     C***********SATRTP    OREQ 'BC'                                      S01486
     C***********          EXSR #P15                                      S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********SATRTP    IFEQ 'SA'                                      S01486
     C***********          EXSR #P17                                      S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM0400CCP1                                           S01408
     C*                                                                   S01408
     C                     ENDSR                           *** #P03 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P04     - PROCESS SE TRADES                                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #CURR    - ACCESS CURRENCY DETAILS
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      * ZAPNUM   - TO CALCULATE AVERAGE PRICE NUMERATOR                  *
      * ZCCYXR   - TO CONVERT NOMINAL CCY AMT TO SETTLEMENT CCY AMT      *
      * #W04     - WRITE SE TRADES TO DAILY TRANSACTIONS REPORT          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCDP1   -                                                       *
      * WWCDP2   -                                                       *
      * WWTOT    -                                                       *
      *                                                                  *
      ********************************************************************
     C           #P04      BEGSR                           *** #P04   ***
     C*
     C                     MOVE SATRNB    RRTRNB
     C                     MOVE SATDSS    RRTDSS
     C                     MOVELSAT1XT    RRT1XT
     C                     MOVELSAT2XT    RRT2XT
     C           FCPORS    IFNE 'B'                                       CPM004
     C           SATRTP    IFEQ 'TS'
     C                     MOVE 'PURCHASE'RRCHT1
     C                     MOVE 'PUR'     RRTRN1
     C                     END
     C           SATRTP    IFEQ 'TP'
     C                     MOVE 'SALE    'RRCHT1
     C                     MOVE 'SAL'     RRTRN1
     C                     END
     C                     ELSE                                           CPM004
     C           SATRTP    IFEQ 'TS'                                      CPM004
     C                     MOVE 'SALE    'RRCHT1                          CPM004
     C                     MOVE 'SAL'     RRTRN1                          CPM004
     C                     END                                            CPM004
     C           SATRTP    IFEQ 'TP'                                      CPM004
     C                     MOVE 'PURCHASE'RRCHT1                          CPM004
     C                     MOVE 'PUR'     RRTRN1                          CPM004
     C                     END                                            CPM004
     C                     END                                            CPM004
     C                     MOVE SACCY1    RRCCY1
     C                     MOVE SABRCD    RRBRCD
     C           SAPURI    IFNE *ZERO
     C           SAACRI    IFEQ 'C'
     C                     MOVEL'(CUM)'   RRAINT
     C                     END
     C           SAACRI    IFEQ 'X'
     C                     MOVEL'(EX)'    RRAINT
     C                     END
     C           SAACRI    IFEQ 'F'
     C                     MOVEL'(FLAT)'  RRAINT
     C                     END
     C                     END
     C                     MOVE SACCY2    RRCCY2
     C                     MOVE SAMDV1    RRTAS1
     C                     MOVE SAMDV2    RRTBS1
     C                     MOVE SAPAYM    RRPAYM
     C                     MOVE SAPYAC    RRPYAC
     C                     MOVE SAPYNM    RRPYNM                          R10040
     C                     MOVE SARCVM    RRRCVM
     C                     MOVE SARCAC    RRRCAC
     C                     MOVE SARCNM    RRRCNM                          R10040
     C                     MOVE SAPYBR    RRPYBR                          085867
     C                     MOVE SARCBR    RRRCBR                          085867
     C*
     C           SAPAYM    IFEQ *BLANKS
     C                     MOVE '0'       *IN22
     C                     ELSE
     C                     MOVE '1'       *IN22
     C                     END
     C*
     C           SARCVM    IFEQ *BLANKS
     C                     MOVE '0'       *IN24
     C                     ELSE
     C                     MOVE '1'       *IN24
     C                     END
     C*
     C**  TEST PRICE BASIS
     C           SASPBS    IFEQ 'P'
     C                     MOVE '%'       WWBAS1  1
     C                     ELSE
     C                     MOVE ' '       WWBAS1
     C                     END
     C*
     C**  EDIT PRICE
     C                     MOVE SAPRC2    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE WWBAS1    ZOUT21
     C                     MOVE ZOUT21    RRPR2R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRPR2L           LEFT-ADJUSTED
     C*
     C**  EDIT AMOUNT 1
     C                     MOVE SAAMT1    ZFLD15
     C                     Z-ADDSANMDP    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRAM1L           LEFT-ADJUSTED
     C*
     C** ACCESS CURRENCY 1 DETAILS  (NOMINAL CURRENCY)
     C                     MOVE SACCY1    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP1
     C*
     C** ACCESS CURRENCY 2 DETAILS  (SETTLEMENT CURRENCY)
     C                     MOVE SACCY2    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP2
     C*
     C**  EDIT PURCHASED INTEREST
     C           SAPURI    IFNE *ZERO
     C                     MOVE SAPURI    ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRPUIR           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRPUIL           LEFT-ADJUSTED
     C                     ELSE
     C                     MOVEL*BLANK    RRPUIR
     C                     MOVEL*BLANK    RRPUIL
     C                     END
     C*
     C**  EDIT TRADE DATE
     C                     Z-ADDSADDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRDDAT
     C*
     C**  EDIT REALLOWANCE
     C           SAVAL1    IFNE 0
     C                     MOVE SAVAL1    ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRVLGL                       ED R05915
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRVL1L
     C*                                                                   R05915
     C                     MOVE '(RALL)'  RRALLW                          R05915
     C                     ELSE                                           R05915
     C                     MOVE *BLANKS   RRALLW                          R05915
     C                     MOVE *BLANKS   RRVLGL                          R05915
     C                     END                                            R05915
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C**  EDIT CHARGES & COMMISSIONS
     C           SAVAL2    IFNE *ZERO
     C                     MOVE SAVAL2    ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRVL2R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRVL2L           LEFT-ADJUSTED
     C                     ELSE
     C                     MOVEL*BLANK    RRVL2R
     C                     MOVEL*BLANK    RRVL2L
     C                     END
     C*
     C**  EDIT PRICE/DISCOUNT/YIELD
     C           SAPRC1    IFNE SAPRC2
     C                     MOVE SAPRC1    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE '%'       ZOUT21
     C                     MOVE ZOUT21    RRPR1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRPR1L           LEFT-ADJUSTED
     C                     ELSE
     C                     MOVE *BLANKS   RRPR1R
     C                     MOVE *BLANKS   RRPR1L
     C                     END
     C*
     C**  CALCULATE BOOK COST IE AP NUMERATOR
     C                     Z-ADDSAAMT1    ZNOML
     C                     Z-ADDSAPRC2    ZAVPR
     C                     Z-ADDSANMDP    ZNMDP
     C                     Z-ADDWWCDP1    ZNMCD
     C                     MOVE SASPBS    ZPRCB
     C                     EXSR ZAPNUM
     C*
     C**  EDIT AP NUMERATOR (NOMINAL X PRICE)
     C                     MOVE ZVALU     ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAPNM
     C*
     C**  CALCULATE TOTAL COST
     C                     Z-ADDZVALU     WWTOT  150
     C                     ADD  SAPURI    WWTOT
     C                     ADD  SAVAL1    WWTOT
     C                     ADD  SAVAL2    WWTOT
     C                     Z-ADDWWTOT     ZAMTF
     C                     Z-ADDSARATA    ZCRSRT
     C                     MOVE SAMDV1    ZCRSMD
     C                     Z-ADDWWCDP1    ZCDPF
     C                     Z-ADDWWCDP2    ZCDPT
     C                     EXSR ZCCYXR
     C*
     C**  EDIT TOTAL AMOUNT
     C                     MOVE SACCY2    RRSETC
     C                     MOVE ZAMTT     ZFLD15
     C                     Z-ADDWWCDP2    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRTOTR           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRTOTL           LEFT-ADJUSTED
     C*
     C**  EDIT EXCHANGE RATE NOMINAL TO SETTLEMENT
     C           SARATA    IFNE 1
     C                     MOVE SARATA    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRRTAR           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRRTAL           LEFT-ADJUSTED
     C                     ELSE
     C                     MOVEL*BLANK    RRRTAR
     C                     MOVEL*BLANK    RRRTAL
     C                     MOVEL*BLANK    RRTAS1
     C                     END
     C*
     C**  EDIT EXCHANGE RATE SETTLEMENT TO PORTFOLIO
     C                     MOVE SARATB    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRRTBL           LEFT-ADJUSTED
     C*
     C**  WRITE SE TRADE TO REPORT
     C                     EXSR #W04
     C                     ENDSR                           *** #P04 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P05     - PROCESS SE DEPOT MOVEMENTS                            *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      * #W05     - WRITE SE DEPOT MOVEMENTS TO DAILY TRANS. REPORT       *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P05      BEGSR                           *** #P05 ***
     C*
     C                     MOVE SATRNB    RRTRNB
     C                     MOVE SATDSS    RRTDSS
     C                     MOVELSAT1XT    RRT1XT
     C                     MOVELSAT2XT    RRT2XT
     C*                                                                   S01496
     C           S01496    IFEQ 'Y'                                       S01496
     C           SAMODI    ANDEQ'ER'                                      S01496
     C           SATRTP    IFEQ 'WI'
     C***********          MOVE 'WALK IN 'RRWALK                          S01496
     C***********          MOVE 'WIN'     RRTRN1                          S01496
     C                     MOVE 'ALOC IN 'RRWALK                          S01496
     C                     MOVE 'AIN'     RRTRN1                          S01496
     C                     END
     C           SATRTP    IFEQ 'WO'
     C***********          MOVE 'WALK OUT'RRWALK                          S01496
     C***********          MOVE 'WOU'     RRTRN1                          S01496
     C                     MOVE 'ALOC OUT'RRWALK                          S01496
     C                     MOVE 'AOU'     RRTRN1                          S01496
     C                     END
     C                     END                                            S01496
     C*                                                                   S01496
     C           SAMODI    IFEQ 'SE'                                      S01496
     C*                                                                   S01496
     C**  Chain to SEERALL5 only if feature is on                         S01496
     C*                                                                   S01496
     C           S01496    IFEQ 'Y'                                       S01496
     C*                                                                   S01496
     C                     MOVE SATRNB    WWTRNB  6                       S01496
     C                     MOVE SATDSS    WWTDSS 10                       S01496
     C*                                                                   S01496
     C           KEY1      KLIST                                          S01496
     C                     KFLD           WWTDSS                          S01496
     C                     KFLD           WWTRNB                          S01496
     C*                                                                   S01496
     C           KEY1      CHAINSEERALL5             89                   S01496
     C*                                                                   S01496
     C                     END                                            S01496
     C*                                                                   S01496
     C** If record not found                                              S01496
     C           *IN89     IFEQ '1'                                       S01496
     C           S01496    ORNE 'Y'                                       S01496
     C*                                                                   S01496
     C           SATRTP    IFEQ 'WI'                                      S01496
     C                     MOVE 'WALK IN 'RRWALK                          S01496
     C                     MOVE 'WIN'     RRTRN1                          S01496
     C                     ELSE                                           S01496
     C                     MOVE 'WALK OUT'RRWALK                          S01496
     C                     MOVE 'WOU'     RRTRN1                          S01496
     C                     END                                            S01496
     C*                                                                   S01496
     C** If record found                                                  S01496
     C                     ELSE                                           S01496
     C*                                                                   S01496
     C           SATRTP    IFEQ 'WI'                                      S01496
     C                     MOVE 'RDPT IN 'RRWALK                          S01496
     C                     MOVE 'RIN'     RRTRN1                          S01496
     C                     ELSE                                           S01496
     C                     MOVE 'RDPT OUT'RRWALK                          S01496
     C                     MOVE 'ROU'     RRTRN1                          S01496
     C                     END                                            S01496
     C*                                                                   S01496
     C                     END                                            S01496
     C                     END                                            S01496
     C*                                                                   S01496
     C                     MOVE SACCY1    RRCCY1
     C                     MOVE SABRCD    RRBRCD
     C*
     C**  TEST PRICE BASIS
     C           SASPBS    IFEQ 'P'
     C                     MOVE '%'       WWBAS1  1
     C                     ELSE
     C                     MOVE ' '       WWBAS1  1
     C                     END
     C*
     C**  EDIT PRICE
     C                     MOVE SAPRC1    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE WWBAS1    ZOUT21
     C                     MOVE ZOUT21    RRPR1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRPR1L           LEFT-ADJUSTED
     C*
     C**  EDIT AMOUNT 1
     C                     MOVE SAAMT1    ZFLD15
     C                     Z-ADDSANMDP    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRAM1L           LEFT-ADJUSTED
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C** ACCESS CURRENCY 1 DETAILS (NOMINAL CURRENCY)
     C                     MOVE SACCY1    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP1
     C*
     C**  CALCULATE BOOK COST IE AP NUMERATOR
     C                     Z-ADDSAAMT1    ZNOML
     C                     Z-ADDSAPRC1    ZAVPR
     C                     Z-ADDSANMDP    ZNMDP
     C                     Z-ADDWWCDP1    ZNMCD
     C                     MOVE SASPBS    ZPRCB
     C                     EXSR ZAPNUM
     C*
     C**  EDIT AP NUMERATOR (NOMINAL X PRICE)
     C                     MOVE ZVALU     ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAPNM
     C*
     C**  EDIT TOTAL AMOUNT
     C                     MOVE SACCY1    RRSETC
     C                     MOVE RRAPNM    RRTOTR           RIGHT-ADJUSTED
     C*
     C**  WRITE SE DEPOTS MOVEMENT TO DAILY TRANSACTIONS REPORT
     C                     EXSR #W05
     C*
     C                     ENDSR                           *** #P05 END ***
      ********************************************************************
      ***/EJECT*******                                                    S01486
      ********************************************************************S01486
      ***********                                                        *S01486
      **#P06*****-*PROCESS*FF*TRANSACTIONS********************************S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLS:*************************************************S01486
      **#MVLED***-*TO*SUPRESS*LEADING*BLANKS*AND*NON*SIGNIFICANT*ZEROS*****01486
      **ZSEDIT***-*TO*EDIT*AMOUNT*TO*OUTPUT********************************01486
      **ZDATE2***-*TO*CONVERT*A*MIDAS*DATE*TO*A*6*DIGITS*DATE*************S01486
      **#W06*****-*WRITE*FF*TRANSACTIONS*TO*DAILY*TRANSACTIONS*REPORT*****S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLED*FROM:*******************************************S01486
      **#P03*****-*DETERMINE*TYPE*OF*TRANSACTION**************************S01486
      ***********                                                        *S01486
      **ROUTINE*USES*VARIABLES:*******************************************S01486
      ***********                                                        *S01486
      ********************************************************************S01486
     C***********#P06      BEGSR                           *** #P06 ***   S01486
     C***********                                                         S01486
     C***********          MOVE SATRNB    RRTRNB                          S01486
     C***********          MOVELSAT1XT    RRT1XT                          S01486
     C***********          MOVELSAT2XT    RRT2XT                          S01486
     C***********SATRTP    IFEQ ' P'                                      S01486
     C***********          MOVE 'PURCHASE'RRWALK                          S01486
     C***********          MOVE 'PUR'     RRTRN1                          S01486
     C***********          MOVEL'CONTRACT'RRTRTD                          S01486
     C***********          MOVE ' PRICE'  RRTRTD                          S01486
     C***********          END                                            S01486
     C***********SATRTP    IFEQ ' S'                                      S01486
     C***********          MOVE 'SALE    'RRWALK                          S01486
     C***********          MOVE 'SAL'     RRTRN1                          S01486
     C***********          MOVEL'CONTRACT'RRTRTD                          S01486
     C***********          MOVE ' PRICE'  RRTRTD                          S01486
     C***********          END                                            S01486
     C***********SATRTP    IFEQ ' E'                                      S01486
     C***********          MOVE 'EXERCISE'RRWALK                          S01486
     C***********          MOVEL'EXERCISE'RRTRTD                          S01486
     C***********          MOVE ' PRICE'  RRTRTD                          S01486
     C***********          END                                            S01486
     C***********          MOVE SACCY1    RRCCY1                          S01486
     C***********          MOVE SABRCD    RRBRCD                          S01486
     C***********          MOVE SACGST    RRCGST                          S01486
     C***********          MOVE SACGAD    RRCGAD                          S01486
     C***********          MOVE SAPAYM    RRPAYM                          S01486
     C***********          MOVE SAPYAC    RRPYAC                          S01486
     C***********          MOVE SAPYNM    RRPYNM                    R10040S01486
     C***********                                                         S01486
     C****EDIT*AMOUNT*1***************************************************S01486
     C***********          MOVE SAAMT1    ZFLD15                          S01486
     C***********          Z-ADD0         ZDECS                           S01486
     C***********          MOVE 'J'       ZECODE                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED S01486
     C***********          MOVEAZOUT21    ZS2                             S01486
     C***********          EXSR #MVLED                                    S01486
     C***********          MOVEAZS3       RRAM1L           LEFT-ADJUSTED  S01486
     C***********                                                         S01486
     C****WRITE**INSTRUMENT***********************************************S01486
     C***********          MOVELSATDSS    FFDS                            S01486
     C***********PCAL      IFNE *BLANK                                    S01486
     C***********                                                         S01486
     C****EDIT*PRICE**2***************************************************S01486
     C***********          MOVE SAPRC2    ZFLD15                          S01486
     C***********          Z-ADD8         ZDECS                           S01486
     C***********          MOVE ' '       ZECODE                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    RRPR2R           RIGHT-ADJUSTED S01486
     C***********          MOVEAZOUT21    ZS2                             S01486
     C***********          EXSR #MVLED                                    S01486
     C***********          MOVEAZS3       RRPR2L           LEFT-ADJUSTED  S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C****EDIT*PRICE**1***************************************************S01486
     C***********          MOVE SAPRC1    ZFLD15                          S01486
     C***********          Z-ADD8         ZDECS                           S01486
     C***********          MOVE ' '       ZECODE                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    RRPR1R           RIGHT-ADJUSTED S01486
     C***********          MOVEAZOUT21    ZS2                             S01486
     C***********          EXSR #MVLED                                    S01486
     C***********          MOVEAZS3       RRPR1L           LEFT-ADJUSTED  S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C****EDIT*DEAL**DATE*************************************************S01486
     C***********          Z-ADDSADDAT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRDDAT                          S01486
     C***********                                                         S01486
     C****WRITE*FF*TRANSACTION**TO*DAILY*TRANSACTIONS*REPORT**************S01486
     C***********          EXSR #W06                                      S01486
     C***********          ENDSR                           *** #P06 END **S01486
     C********************************************************************S01486
      /EJECT                                                              S71062
     C********************************************************************S71062
     C*                                                                  *S71062
     C* #P06     - Process FF transactions                               *S71062
     C*                                                                  *S71062
     C* Subroutine calls:                                                *S71062
     C* #MVLED   - To suppress leading zeros and non significant zeros   *S71062
     C* ZSEDIT   - To edit amount to output                              *S71062
     C* ZDATE2   - To convert a midas date to a 6 digits date            *S71062
     C* #W06     - Write FF transactions to daily transactions report    *S71062
     C*                                                                  *S71062
     C* Subroutine called from:                                          *S71062
     C* #P03     - Determine type of transaction                         *S71062
     C*                                                                  *S71062
     C* Routine uses variables                                           *S71062
     C*                                                                  *S71062
     C********************************************************************S71062
     C           #P06      BEGSR                           *** #P06 ***   S71062
     C*                                                                   S71062
     C                     MOVE SATRNB    RRTRNB                          S71062
     C                     MOVELSAT1XT    RRT1XT                          S71062
     C                     MOVELSAT2XT    RRT2XT                          S71062
     C           SATRTP    IFEQ ' P'                                      S71062
     C                     MOVE 'PURCHASE'RRWALK                          S71062
     C                     MOVE 'PUR'     RRTRN1                          S71062
     C                     MOVEL'CONTRACT'RRTRTD                          S71062
     C                     MOVE ' PRICE'  RRTRTD                          S71062
     C                     ENDIF                                          S71062
     C           SATRTP    IFEQ ' S'                                      S71062
     C                     MOVE 'SALE    'RRWALK                          S71062
     C                     MOVE 'SAL'     RRTRN1                          S71062
     C                     MOVEL'CONTRACT'RRTRTD                          S71062
     C                     MOVE ' PRICE'  RRTRTD                          S71062
     C                     ENDIF                                          S71062
     C           SATRTP    IFEQ ' E'                                      S71062
     C                     MOVE 'EXERCISE'RRWALK                          S71062
     C                     MOVEL'EXERCISE'RRTRTD                          S71062
     C                     MOVE ' PRICE'  RRTRTD                          S71062
     C                     ENDIF                                          S71062
     C                     MOVE SACCY1    RRCCY1                          S71062
     C                     MOVE SABRCD    RRBRCD                          S71062
     C                     MOVE SACGST    RRCGST                          S71062
     C                     MOVE SACGAD    RRCGAD                          S71062
     C                     MOVE SAPAYM    RRPAYM                          S71062
     C                     MOVE SAPYAC    RRPYAC                          S71062
     C                     MOVE SAPYNM    RRPYNM                          S71062
     C*                                                                   S71062
     C**  Edit amount 1 (Number of open contracts)                        S71062
     C           SATRTP    IFEQ ' S'                                      S71062
     C                     Z-SUBSAAMT1    ZFLD15                          S71062
     C                     ELSE                                           S71062
     C                     MOVE SAAMT1    ZFLD15                          S71062
     C                     ENDIF                                          S71062
     C*                                                                   S71062
     C                     Z-ADD0         ZDECS                           S71062
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    RROPCT                          S71062
     C                     MOVEAZOUT21    ZS2                             S71062
     C                     EXSR #MVLED                                    S71062
     C                     MOVEAZS3       RRAM1L           LEFT-ADJUSTED  S71062
     C*                                                                   S71062
     C**  WRITE  INSTRUMENT                                               S71062
     C                     MOVELSATDSS    FFDS                            S71062
     C           PCAL      IFNE *BLANK                                    S71062
     C*                                                                   S71062
     C**  EDIT PRICE  2                                                   S71062
     C                     MOVE SAPRC2    ZFLD15                          S71062
     C                     Z-ADD8         ZDECS                           S71062
     C                     MOVE ' '       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    RRPR2R           RIGHT-ADJUSTED S71062
     C                     MOVEAZOUT21    ZS2                             S71062
     C                     EXSR #MVLED                                    S71062
     C                     MOVEAZS3       RRPR2L           LEFT-ADJUSTED  S71062
     C                     ENDIF                                          S71062
     C*                                                                   S71062
     C**  Edit price  1                                                   S71062
     C                     Z-ADDSAPRC1    FFPRIC                          S71062
     C                     Z-ADDSASEQA    FFTKDM                          S71062
     C                     Z-ADDSARATA    FFMNPF                          S71062
     C                     EXSR FFPRCS                                    S71062
     C                     MOVE FFSPRC    RRPR1R           RIGHT-ADJUSTED S71062
     C                     MOVEAFFSPRC    ZS2                             S71062
     C                     EXSR #MVLED                                    S71062
     C                     MOVEAZS3       RRPR1L           LEFT-ADJUSTED  S71062
     C*                                                                   S71062
     C*                                                                   S71062
     C**  Edit deal date                                                  S71062
     C                     Z-ADDSADDAT    ZDAYNO                          S71062
     C                     EXSR ZDATE2                                    S71062
     C           WWDAT1    IFEQ *BLANK                                    S71062
     C           ZADATE    ANDNE*BLANK                                    S71062
     C                     MOVE *ZERO     WWDAT1                          S71062
     C                     ENDIF                                          S71062
     C                     MOVE ZADATE    RRDDAT                          S71062
     C*                                                                   S71062
     C**  Edit value date                                                 S71062
     C                     Z-ADDSAVDAT    ZDAYNO                          S71062
     C                     EXSR ZDATE2                                    S71062
     C           WWDAT1    IFEQ *BLANK                                    S71062
     C           ZADATE    ANDNE*BLANK                                    S71062
     C                     MOVE *ZERO     WWDAT1                          S71062
     C                     ENDIF                                          S71062
     C                     MOVE ZADATE    RRVDAT                          S71062
     C*                                                                   S71062
     C** Access currency 1 details  (Instrument currency)                 S71062
     C                     MOVE SACCY1    WWCURR                          S71062
     C                     EXSR #CURR                                     S71062
     C*                                                                   S71062
     C**  Edit initial margin                                             S71062
     C           SAAINT    IFNE *ZEROS                                    S71062
     C                     MOVE SAAINT    ZFLD15                          S71062
     C                     Z-ADDA6NBDP    ZDECS                           S71062
     C                     MOVEL'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    RRIMAR           RIGHT-ADJUSTED S71062
     C                     MOVE *OFF      *IN80                           S71062
     C                     ELSE                                           S71062
     C                     MOVE '1'       *IN80                           S71062
     C                     MOVE *BLANKS   RRIMAR                          S71062
     C                     ENDIF                                          S71062
     C*                                                                   S71062
     C**  Edit premium                                                    S71062
     C           SAAMT2    IFNE *ZEROS                                    S71062
     C                     MOVE SAAMT2    ZFLD15                          S71062
     C                     Z-ADDA6NBDP    ZDECS                           S71062
     C                     MOVEL'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    RRAMT2           RIGHT-ADJUSTED S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   RRAMT2                          S71062
     C                     ENDIF                                          S71062
     C*                                                                   S71062
     C**  Edit charges amount                                             S71062
     C           SAVAL2    IFNE *ZEROS                                    S71062
     C                     MOVE SAVAL2    ZFLD15                          S71062
     C                     Z-ADDA6NBDP    ZDECS                           S71062
     C                     MOVEL'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    RRVAL1           RIGHT-ADJUSTED S71062
     C                     MOVE *OFF      *IN76                           S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   RRVAL1                          S71062
     C                     MOVE *ON       *IN76                           S71062
     C                     ENDIF                                          S71062
     C*                                                                   S71062
     C**  EDIT COMMISSIONS AMOUNT                                         S71062
     C           SAVAL1    IFNE *ZEROS                                    S71062
     C                     MOVE SAVAL1    ZFLD15                          S71062
     C                     Z-ADDA6NBDP    ZDECS                           S71062
     C                     MOVEL'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    RRVAL2           RIGHT-ADJUSTED S71062
     C                     MOVE *OFF      *IN77                           S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   RRVAL2                          S71062
     C                     MOVE *ON       *IN77                           S71062
     C                     ENDIF                                          S71062
     C*                                                                   S71062
     C**  Edit settlement value (Charges+Commissions+Premium)             S71062
     C                     Z-ADD*ZEROS    WWSETV 150                      S71062
     C           SAVAL1    ADD  SAVAL2    WWSETV                          S71062
     C                     ADD  SAAMT2    WWSETV                          S71062
     C*                                                                   S71062
     C           WWSETV    IFNE *ZEROS                                    S71062
     C                     MOVE WWSETV    ZFLD15                          S71062
     C                     Z-ADDA6NBDP    ZDECS                           S71062
     C                     MOVEL'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    RRSETV           Right adjusted S71062
     C                     MOVE SACCY1    RRCCY2                          S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   RRSETV                          S71062
     C                     MOVE *BLANKS   RRCCY2                          S71062
     C                     ENDIF                                          S71062
     C*                                                                   S71062
     C**  Write FF transaction  to daily transactions report              S71062
     C                     EXSR #W06                                      S71062
     C                     ENDSR                           *** #P06 End **S71062
      ********************************************************************S71062
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P07     - PROCESS FX DEALS                                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #CURR    - ACCESS CURRENCY DETAILS
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      * #W07     - WRITE FX DEALS TO DAILY TRANSACTIONS REPORT           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCDP1   -                                                       *
      * WWCDP2   -                                                       *
      * WWCDP3   -                                                       *
      *                                                                  *
      ********************************************************************
     C           #P07      BEGSR                           *** #P07   ***
     C*
     C                     MOVE SATRNB    RRTRNB
     C                     MOVELSAT1XT    RRT1XT
     C                     MOVELSAT2XT    RRT2XT
     C                     MOVE SATRTP    RRTRTP
     C                     MOVE SATRST    RRTRST
      *                                                                   103081
      * If bank portfolios reverse picture                                103081
      *                                                                   103081
     C           FCPORS    IFNE 'B'                                       103081
     C                     MOVEL'PUR'     RRTRN1
     C                     MOVEL'SAL'     RRTRN2
     C                     ELSE                                           103081
     C                     MOVEL'SAL'     RRTRN1                          103081
     C                     MOVEL'PUR'     RRTRN2                          103081
     C                     ENDIF                                          103081
     C                     MOVE SACCY1    RRCCY1
     C                     MOVE SACCY2    RRCCY2
     C                     MOVE SABRCD    RRBRCD
     C*** ADD CCY IN CURRENT RETAIL ACCOUNT FOR FX DEALS ***              056452
     C*                                                                   056452
     C                     MOVE SAPAYM    RRPAYM
     C                     MOVELSAPYAC    WORK1   9                       056452
     C                     MOVE RRCCY1    WORK1                           056452
     C**********           MOVE SAPYAC    WORK2   6                                    056452 CGL029
     C                     MOVE SAPYAC    WORK2  12                                           CGL029
     C                     MOVELWORK1     RPYAC1                          056452
     C                     MOVE WORK2     RPYAC1                          056452
     C***                  MOVE SAPYAC    RRPYAC                          056452
     C                     MOVE SAPYNM    RRPYNM                          R10040
     C                     MOVE SARCVM    RRRCVM
     C                     MOVELSARCAC    WORK3   9                       056452
     C                     MOVE RRCCY2    WORK3                           056452
     C**********           MOVE SARCAC    WORK4   6                                    056452 CGL029
     C                     MOVE SARCAC    WORK4  12                                           CGL029
     C                     MOVELWORK3     RRCAC1                          056452
     C                     MOVE WORK4     RRCAC1                          056452
     C***                  MOVE SARCAC    RRRCAC                          056452
     C                     MOVE SARCNM    RRRCNM                          R10040
     C           SASWOD    IFEQ *ZEROS
     C                     MOVE *BLANKS   RRSWOD
     C                     ELSE
     C                     MOVE SASWOD    RRSWOD
     C                     END
     C*
     C**  EDIT EXCHANGE RATE
     C                     MOVE SARATA    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRRTAR           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRRTAL           LEFT-ADJUSTED
     C*
     C** ACCESS CURRENCY 1 DETAILS
     C                     MOVE SACCY1    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP1
     C*
     C** ACCESS CURRENCY 2 DETAILS
     C                     MOVE SACCY2    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP2
     C*
     C**  EDIT AMOUNT 1
     C                     MOVE SAAMT1    ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRAM1L           LEFT-ADJUSTED
     C*
     C**  EDIT AMOUNT 2
     C                     MOVE SAAMT2    ZFLD15
     C                     Z-ADDWWCDP2    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAM2R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRAM2L           LEFT-ADJUSTED
     C*
     C**  EDIT DEAL  DATE
     C                     Z-ADDSADDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRDDAT
     C*
     C**  EDIT VALUE 1
     C                     MOVE SAVAL1    ZFLD15
     C                     Z-ADDWWCDP3    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRVL1L           LEFT-ADJUSTED
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C**  EDIT MATURITY  DATE
     C                     Z-ADDSAMDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRMDAT
     C*
     C**  WRITE FX DEAL TO REPORT
     C                     EXSR #W07
     C                     ENDSR                           *** #P07 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#P08*****-*PROCESS*MM*DEALS*AND*FIDUCIARY*DEPOSITS****************S01486
      * #P08     - PROCESS MM DEALS                                      *S01486
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #CURR    - ACCESS CURRENCY DETAILS
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      **#W08*****-*WRITE*MM*DEALS*AND*FID.*DEPOSITS*TRANSACTIONS*REPORT***S01486
      * #W08     - WRITE MM DEALS TRANSACTIONS REPORT                    *S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCDP1   -                                                       *
      *                                                                  *
      ********************************************************************
     C           #P08      BEGSR                           *** #P08   ***
     C***********                                                   ROLLOVS01486
     C***ROLLOVER DETAILS INTEGRATION FOR MM                        ROLLOVS01486
     C***********          MOVE '0'       *IN30                     ROLLOVS01486
     C***********SAMODI    IFEQ 'DC'                       - B1     ROLLOVS01486
     C***********SATRNB    CHAINMMDELDY0             72             ROLLOVS01486
     C************IN72     IFEQ '0'                        - B2     ROLLOVS01486
     C***********          MOVE '1'       *IN30                     ROLLOVS01486
     C***********                                                   ROLLOVS01486
     C***SET*UP*ROLLOVER FIELDS                                     ROLLOVS01486
     C***********MMCUMA    IFEQ *ZEROS                     - B3     ROLLOVS01486
     C***********          MOVE *BLANKS   RRCUMA                    ROLLOVS01486
     C***********          ELSE                            - X3     ROLLOVS01486
     C***********          MOVE MMCUMA    ZFLD15                    ROLLOVS01486
     C***********          Z-ADD7         ZDECS                     ROLLOVS01486
     C***********          MOVE ' '       ZECODE                    ROLLOVS01486
     C***********          EXSR ZSEDIT                              ROLLOVS01486
     C***********          MOVE ZOUT21    RRCUMA                    ROLLOVS01486
     C***********          END                             - E3     ROLLOVS01486
     C***********                                                   ROLLOVS01486
     C***********          MOVE MMAURO    RRAURO                    ROLLOVS01486
     C***********          MOVE MMINPS    RRINPS                    ROLLOVS01486
     C***********          MOVE MMFREQ    RRFREQ                    ROLLOVS01486
     C***********MMDNUM    IFEQ 0                          - B3     ROLLOVS01486
     C***********          MOVE *BLANKS   RRDNUM                    ROLLOVS01486
     C***********          ELSE                            - X3     ROLLOVS01486
     C***********          MOVE MMDNUM    RRDNUM                    ROLLOVS01486
     C***********          END                             - E3     ROLLOVS01486
     C***********          MOVE MMIMET    RRIMET                    ROLLOVS01486
     C***********          MOVE MMISAC    RRISAC                    ROLLOVS01486
     C***********          MOVE MMINOS    RRINOS                    ROLLOVS01486
     C***********          END                             - E2     ROLLOVS01486
     C***********          END                             - E1     ROLLOVS01486
     C*
     C                     MOVE SATRNB    RRTRNB
     C                     MOVELSAT1XT    RRT1XT
     C                     MOVELSAT2XT    RRT2XT
     C                     MOVE SATRTP    RRTRTP
     C                     MOVELSATRTP    RRTRN1
     C                     MOVE SATRST    RRTRST
     C           SABRT1    IFNE *ZEROS
     C                     MOVE SABRT1    RRBRT1
     C                     ELSE
     C                     MOVE *BLANKS   RRBRT1
     C                     END
     C                     MOVE SAFRQ1    RRFRQ1
     C                     MOVE SACCY1    RRCCY1
     C           SASWOD    IFEQ *ZEROS
     C                     MOVE *BLANKS   RRSWOD
     C                     ELSE
     C                     MOVE SASWOD    RRSWOD
     C                     END
     C                     MOVE SABRCD    RRBRCD
     C*
     C***********SAMODI    IFEQ 'FD'                                      S01486
     C***********          MOVE SAFINR    RRFINR                          S01486
     C***********          MOVE SABNUM    RRBNUM                          S01486
     C***********          MOVE SAPOOL    RRPOOL                          S01486
     C***********          MOVE SACOMC    RRCOMC                          S01486
     C***********          MOVE SACFRQ    RRCFRQ                          S01486
     C***********                                                         S01486
     C***NEXT*COMMISION*DATE**********************************************S01486
     C***********          Z-ADDSANCDT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRNCDT                          S01486
     C***********                                                         S01486
     C***********          MOVE SACGST    RRCGST                          S01486
     C***********          MOVE SACGAD    RRCGAD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C                     MOVE SAPAYM    RRPAYM
     C                     MOVE SAPYAC    RRPYAC
     C                     MOVE SAPYNM    RRPYNM                          R10040
     C                     MOVE SARCVM    RRRCVM
     C                     MOVE SARCAC    RRRCAC
     C                     MOVE SARCNM    RRRCNM                          R10040
     C                     MOVE SAPYBR    RRPYBR                          085867
     C                     MOVE SARCBR    RRRCBR                          085867
     C*
     C**  EDIT INTEREST RATE 1
     C                     MOVE SARAI1    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRRAI1
     C*
     C**  EDIT INTEREST PAYMENT DATE
     C                     Z-ADDSAIPD1    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRIPD1
     C*                                                                   062353
     C**  EDIT ROLLOVER DATE                                              062353
     C           SAIPD2    IFNE 0                                         062353
     C                     Z-ADDSAIPD2    ZDAYNO                          062353
     C                     EXSR ZDATE2                                    062353
     C           WWDAT1    IFEQ *BLANK                                    062353
     C           ZADATE    ANDNE*BLANK                                    062353
     C                     MOVE *ZERO     WWDAT1                          062353
     C                     END                                            062353
     C                     MOVE ZADATE    RRRLDT                          062353
     C                     ELSE                                           062353
     C                     MOVE *BLANKS   RRRLDT                          062353
     C                     END                                            062353
     C*
     C**  ACCESS CURRENCY 1 DETAILS
     C                     MOVE SACCY1    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP1
     C*
     C**  EDIT AMOUNT 1
     C**         SAAMT1    ADD  SAVAL1    SAAMT1                    B07949B07958
     C                     MOVE SAAMT1    ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRAM1L           LEFT-ADJUSTED
      *                                                                   CDL006
      ** Format Fiduciary charges and commissions                         CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           SATRTP    ANDEQ'FL'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           SATRTP    ANDEQ'DP'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           SATRTP    ANDEQ'LP'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           SATRTP    ANDEQ'FT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           SATRTP    ANDEQ'DT'                                      CDL006
     C           CDL006    OREQ 'Y'                                       CDL006
     C           SATRTP    ANDEQ'LT'                                      CDL006
      *                                                                   CDL006
     C                     MOVE *ON       *IN88                           CDL006
     C                     ADD  2         WLNCTR                          CDL006
     C           WLNCTR    IFGE 8                                         CDL006
     C                     ADD  1         LINOUT                          CDL006
     C                     Z-ADD0         WLNCTR                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C********** SATRNB    CHAINDEALS                89                                CDL006 CLE148
     C                     MOVE SATRNB    DLNO                                                CLE148
     C           DLNO      CHAINDEALS                89                                       CLE148
     C           *IN89     IFEQ '1'                                       CDL006
     C                     MOVEL'DEALS   'DBFILE           ************   CDL006
     C                     Z-ADD11        DBASE            * DBERR 11 *   CDL006
     C                     MOVELSATRNB    DBKEY            ************   CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     MOVE *BLANKS   ZFLD15                          CDL006
     C                     MOVE FCGA      ZFLD15                          CDL006
     C                     Z-ADDWWCDP1    ZDECS                           CDL006
     C                     MOVE 'J'       ZECODE                          CDL006
     C                     EXSR ZSEDIT                                    CDL006
     C                     MOVE ZOUT21    RFCGA                           CDL006
      *                                                                   CDL006
     C                     MOVE *BLANKS   ZFLD15                          CDL006
     C                     MOVE FCMA      ZFLD15                          CDL006
     C                     Z-ADDWWCDP1    ZDECS                           CDL006
     C                     MOVE 'J'       ZECODE                          CDL006
     C                     EXSR ZSEDIT                                    CDL006
     C                     MOVE ZOUT21    RFCMA                           CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C*                                                                   B07949
     C**  EDIT CHARGE AMOUNT                                              B07949
     C           SAVAL1    IFNE 0                                         B07949
     C                     MOVE '1'       *IN60                           B07949
     C                     MOVE SAVAL1    ZFLD15                          B07949
     C                     Z-ADDWWCDP1    ZDECS                           B07949
     C                     MOVE 'J'       ZECODE                          B07949
     C                     EXSR ZSEDIT                                    B07949
     C                     MOVE ZOUT21    RRVAL1           RIGHT-ADJUSTED B07949
     C                     ELSE                                           B07949
     C                     MOVE '0'       *IN60                           B07949
     C                     END                                            B07949
     C*
     C**  EDIT DEAL  DATE
     C                     Z-ADDSADDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRDDAT
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C**  EDIT MATURITY  DATE
     C           SAMDAT    IFLT 0
     C                     Z-SUBSAMDAT    SAMDAT
     C                     MOVE SAMDAT    WWMDAT  5
     C*
     C** EDIT NOTICE DAYS
     C** INITIALIZE WORK FIELDS
     C                     MOVE *BLANKS   ZS2
     C                     MOVE *BLANKS   ZS3
     C                     MOVEAWWMDAT    ZS2
     C                     Z-ADD1         I
     C*
     C** COUNT LEADIND ZEROS
     C           ZS2,I     DOWEQ*ZERO
     C                     ADD  1         I
     C                     END
     C                     Z-ADD1         J
     C*
     C** FILL OUTPUT FIELD WITH NO ZERO VALUES
     C           I         DOWLE21
     C                     MOVE ZS2,I     ZS3,J
     C                     ADD  1         I
     C                     ADD  1         J
     C                     END
     C*
     C                     MOVEAZS3       RRMDA2
     C                     MOVE '1'       *IN21
     C                     ELSE
     C                     MOVE '0'       *IN21
     C                     Z-ADDSAMDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRMDA1
     C                     END
     C*
     C**  EDIT TOTAL AMOUNT
     C           SAAMT1    ADD  SAVAL1    SAAMT1                          B07958
     C                     MOVE SAAMT1    ZFLD15                          B07958
     C                     Z-ADDWWCDP1    ZDECS                           B07958
     C                     MOVE 'J'       ZECODE                          B07958
     C                     EXSR ZSEDIT                                    B07958
     C                     MOVE ZOUT21    RRTOTR           RIGHT-ADJUSTED B07958
     C                     MOVEAZOUT21    ZS2                             B07958
     C                     EXSR #MVLED                                    B07958
     C                     MOVEAZS3       RRTOTL           LEFT-ADJUSTED  B07958
     C*                                                                   B07958
     C                     MOVE SACCY1    RRSETC
     C**                   MOVE RRAM1R    RRTOTR           RIGHT-ADJUSTED B07958
     C/COPY WNCPYSRC,PM0400C001
     C*
     C**  WRITE MM DEAL TO REPORT
     C                     EXSR #W08
      *                                                                   CDL006
      ** Format Fiduciary charges and commissions                         CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C           *IN88     ANDEQ'1'                                       CDL006
     C                     MOVE *OFF      *IN88                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDSR                           *** #P08 END ***
      ********************************************************************
      ***/EJECT*****                                                     *S01486
      ********************************************************************S01486
      ***********                                                        *S01486
      **#P09*****-*PROCESS*FR,*RS,*RL*DEALS*******************************S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLS:S*FR,*RS,*RL*DEALS*******************************S01486
      **#CURR****-*ACCESSSCURRENCY*DETAILSS*******************************S01486
      **#MVLED***-*TOOSUPRESS,LEADING*BLANKS*AND*NON*SIGNIFICANT*ZEROS*****01486
      **ZSEDIT***-*TOOEDIT*AMOUNT,TOLOUTPUT********************************01486
      **ZDATE2***-*TOOCONVERT,ARMIDAS*DATESTO*A*6*DIGITS*DATE*************S01486
      ***PSSR****-*DATAEBASERERROR*MANAGEMENT*****************************S01486
      **#W09*****-*WRITESFR,RRS,SRLRDEALSLTO*DAILY*TRANS.*REPORT**********S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLED*FROM:*******************************************S01486
      **#P03*****-*DETERMINE*TYPE*OF*TRANSACTION**************************S01486
      ***********                                                        *S01486
      **ROUTINE*USES*VARIABLES:*******************************************S01486
      **WWCDP1***-********************************************************S01486
      ***********                                                        *S01486
      ********************************************************************S01486
     C***********#P09      BEGSR                           *** #P09    ***S01486
     C***********                                                         S01486
     C***********          MOVE SATRNB    RRTRNB                          S01486
     C***********          MOVELSAT1XT    RRT1XT                          S01486
     C***********          MOVELSAT2XT    RRT2XT                          S01486
     C***********          MOVE SATRTP    RRTRTP                          S01486
     C***********          MOVE SATRST    RRTRST                          S01486
     C***********          MOVELSATRTP    RRTRN1                          S01486
     C***********SABRT1    IFNE *ZEROS                                    S01486
     C***********          MOVE SABRT1    RRBRT1                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVE *BLANKS   RRBRT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE SAFRQ1    RRFRQ1                          S01486
     C***********          MOVE SACCY1    RRCCY1                          S01486
     C***********SASWOD    IFEQ *ZEROS                                    S01486
     C***********          MOVE *BLANKS   RRSWOD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVE SASWOD    RRSWOD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          MOVE SAPAYM    RRPAYM                          S01486
     C***********          MOVE SAPYAC    RRPYAC                          S01486
     C***********          MOVE SAPYNM    RRPYNM                    R10040S01486
     C***********          MOVE SARCVM    RRRCVM                          S01486
     C***********          MOVE SARCAC    RRRCAC                          S01486
     C***********          MOVE SARCNM    RRRCNM                    R10040S01486
     C***********                                                         S01486
     C****EDIT*INTEREST*RATE*1********************************************S01486
     C***********          MOVE SARAI1    ZFLD15                          S01486
     C***********          Z-ADD8         ZDECS                           S01486
     C***********          MOVE ' '       ZECODE                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVEAZOUT21    ZS2                             S01486
     C***********          EXSR #MVLED                                    S01486
     C***********          MOVEAZS3       RRRAI1                          S01486
     C***********                                                         S01486
     C****EDIT*INTEREST*PAYMENT*DATE**************************************S01486
     C***********          Z-ADDSAIPD1    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRIPD1                          S01486
     C***********                                                         S01486
     C****ACCESS*CURRENCY*1*DETAILS***************************************S01486
     C***********          MOVE SACCY1    WWCURR                          S01486
     C***********          EXSR #CURR                                     S01486
     C***********          Z-ADDA6NBDP    WWCDP1                          S01486
     C***********                                                         S01486
     C****EDIT*AMOUNT*1***************************************************S01486
     C***********          MOVE SAAMT1    ZFLD15                          S01486
     C***********          Z-ADDWWCDP1    ZDECS                           S01486
     C***********          MOVE 'J'       ZECODE                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED S01486
     C***********          MOVEAZOUT21    ZS2                             S01486
     C***********          EXSR #MVLED                                    S01486
     C***********          MOVEAZS3       RRAM1L           LEFT-ADJUSTED  S01486
     C***********                                                         S01486
     C****EDIT*DEAL**DATE*************************************************S01486
     C***********          Z-ADDSADDAT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRDDAT                          S01486
     C***********                                                         S01486
     C****EDIT*VALUE*DATE*************************************************S01486
     C***********          Z-ADDSAVDAT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRVDAT                          S01486
     C***********          Z-ADDSAMDAT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRMDAT                          S01486
     C***********                                                         S01486
     C****WRITE*FR*RS**RL*DEAL*TO*REPORT**********************************S01486
     C***********          EXSR #W09                                      S01486
     C***********          ENDSR                           *** #P09 END **S01486
     C********************************************************************S01486
      ***/EJECT*****                                                      S01486
     C********************************************************************S01486
     C***********                                                        *S01486
     C**#P10*****-*PROCESS*RX*DEALS***************************************S01486
     C***********                                                        *S01486
     C**SUBROUTINE*CALLS:*************************************************S01486
     C**#CURR****-*ACCESS*CURRENCY*DETAILS********************************S01486
     C**#MVLED***-*TO*SUPRESS*LEADING*BLANKS*AND*NON*SIGNIFICANT*ZEROS*****01486
     C**ZSEDIT***-*TO*EDIT*AMOUNT*TO*OUTPUT********************************01486
     C***PSSR****-*DATA*BASE*ERROR*MANAGEMENT*****************************S01486
     C**ZDATE2***-*TO*CONVERT*A*MIDAS*DATE*TO*A*6*DIGITS*DATE*************S01486
     C**#W10*****-*WRITE*RX*DEALS*TO*DAILY*TRANSACTIONS*REPORT************S01486
     C***********                                                        *S01486
     C**SUBROUTINE*CALLED*FROM:*******************************************S01486
     C**#P03*****-*DETERMINE*TYPE*OF*TRANSACTION**************************S01486
     C***********                                                        *S01486
     C**ROUTINE*USES*VARIABLES:*******************************************S01486
     C**WWCDP1***-********************************************************S01486
     C**WWCDP2***-********************************************************S01486
     C***********                                                        *S01486
     C********************************************************************S01486
     C***********#P10      BEGSR                           *** #P10    ***S01486
     C***********                                                         S01486
     C***********          MOVE SATRNB    RRTRNB                          S01486
     C***********          MOVELSAT1XT    RRT1XT                          S01486
     C***********          MOVELSAT2XT    RRT2XT                          S01486
     C***********          MOVE SATRTP    RRTRTP                          S01486
     C***********          MOVE SATRST    RRTRST                          S01486
     C***********          MOVEL'PUR'     RRTRN1                          S01486
     C***********          MOVEL'SAL'     RRTRN2                          S01486
     C***********SABRT1    IFNE *ZEROS                                    S01486
     C***********          MOVE SABRT1    RRBRT1                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVE *BLANKS   RRBRT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE SAFRQ1    RRFRQ1                          S01486
     C***********SABRT2    IFNE *ZEROS                                    S01486
     C***********          MOVE SABRT2    RRBRT2                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVE *BLANKS   RRBRT2                          S01486
     C***********          END                                            S01486
     C***********          MOVE SAFRQ2    RRFRQ2                          S01486
     C***********          MOVE SACCY1    RRCCY1                          S01486
     C***********          MOVE SACCY2    RRCCY2                          S01486
     C***********          MOVE SABRCD    RRBRCD                          S01486
     C***********          MOVE SAPAYM    RRPAYM                          S01486
     C***********          MOVE SAPYAC    RRPYAC                          S01486
     C***********          MOVE SAPYNM    RRPYNM                    R10040S01486
     C***********          MOVE SARCVM    RRRCVM                          S01486
     C***********          MOVE SARCAC    RRRCAC                          S01486
     C***********          MOVE SARCNM    RRRCNM                    R10040S01486
     C***********                                                         S01486
     C****EDIT*INTEREST*RATE*1********************************************S01486
     C***********          MOVE SARAI1    ZFLD15                          S01486
     C***********          Z-ADD8         ZDECS                           S01486
     C***********          MOVE ' '       ZECODE                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVEAZOUT21    ZS2                             S01486
     C***********          EXSR #MVLED                                    S01486
     C***********          MOVEAZS3       RRRAI1                          S01486
     C***********                                                         S01486
     C****EDIT*INTEREST*RATE*2********************************************S01486
     C***********          MOVE SARAI2    ZFLD15                          S01486
     C***********          Z-ADD8         ZDECS                           S01486
     C***********          MOVE ' '       ZECODE                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVEAZOUT21    ZS2                             S01486
     C***********          EXSR #MVLED                                    S01486
     C***********          MOVEAZS3       RRRAI2                          S01486
     C***********                                                         S01486
     C****ACCESS*CURRENCY*1*DETAILS***************************************S01486
     C***********          MOVE SACCY1    WWCURR                          S01486
     C***********          EXSR #CURR                                     S01486
     C***********          Z-ADDA6NBDP    WWCDP1                          S01486
     C***********                                                         S01486
     C****ACCESS*CURRENCY*2*DETAILS***************************************S01486
     C***********          MOVE SACCY2    WWCURR                          S01486
     C***********          EXSR #CURR                                     S01486
     C***********          Z-ADDA6NBDP    WWCDP2                          S01486
     C***********                                                         S01486
     C****EDIT*AMOUNT*1***************************************************S01486
     C***********          MOVE SAAMT1    ZFLD15                          S01486
     C***********          Z-ADDWWCDP1    ZDECS                           S01486
     C***********          MOVE 'J'       ZECODE                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED S01486
     C***********          MOVEAZOUT21    ZS2                             S01486
     C***********          EXSR #MVLED                                    S01486
     C***********          MOVEAZS3       RRAM1L           LEFT-ADJUSTED  S01486
     C***********                                                         S01486
     C****EDIT*AMOUNT*2***************************************************S01486
     C***********          MOVE SAAMT2    ZFLD15                          S01486
     C***********          Z-ADDWWCDP2    ZDECS                           S01486
     C***********          MOVE 'J'       ZECODE                          S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    RRAM2R           RIGHT-ADJUSTED S01486
     C***********          MOVEAZOUT21    ZS2                             S01486
     C***********          EXSR #MVLED                                    S01486
     C***********          MOVEAZS3       RRAM2L           LEFT-ADJUSTED  S01486
     C***********                                                         S01486
     C****EDIT*INTEREST*REPAYMENT*DATE*1**********************************S01486
     C***********          Z-ADDSAIPD1    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRIPD1                          S01486
     C***********                                                         S01486
     C****EDIT*INTEREST*REPAYMENT*DATE*2**********************************S01486
     C***********          Z-ADDSAIPD2    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRIPD2                          S01486
     C***********                                                         S01486
     C****EDIT*DEAL**DATE*************************************************S01486
     C***********          Z-ADDSADDAT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRDDAT                          S01486
     C***********                                                         S01486
     C****EDIT*VALUE*DATE*************************************************S01486
     C***********          Z-ADDSAVDAT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRVDAT                          S01486
     C***********                                                         S01486
     C****EDIT*MATURITY*DATE**********************************************S01486
     C***********          Z-ADDSAMDAT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRMDAT                          S01486
     C***********                                                         S01486
     C****WRITE*RX*DEAL*TO*REPORT*****************************************S01486
     C***********          EXSR #W10                                      S01486
     C***********          ENDSR                           *** #P10 END **S01486
     C********************************************************************S01486
      /EJECT
      ********************************************************************
      *                                                                  *
      **#P11*****-*PROCESS*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS***S01486
      * #P11     - PROCESS PI, PD DEAL AMENDMENTS                        *S01486
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #CURR    - ACCESS CURRENCY DETAILS
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      **#W11*****-*WRITE*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS*****S01486
      * #W11     - WRITE PI, PD DEAL AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCDP1   -                                                       *
      *                                                                  *
      ********************************************************************
     C           #P11      BEGSR                           *** #P11   ***
     C*
     C                     MOVE SATRNB    RRTRNB
     C                     MOVELSAT1XT    RRT1XT
     C                     MOVELSAT2XT    RRT2XT
     C                     MOVE SATRTP    RRTRTP
     C                     MOVELSATRTP    RRTRN1
     C                     MOVE SASEQA    RRSQNO
     C                     MOVE SACCY1    RRCCY1
     C                     MOVE SABRCD    RRBRCD
     C                     MOVE SAPAYM    RRPAYM
     C                     MOVE SAPYAC    RRPYAC
     C                     MOVE SAPYNM    RRPYNM                          R10040
     C                     MOVE SARCVM    RRRCVM
     C                     MOVE SARCAC    RRRCAC
     C                     MOVE SARCNM    RRRCNM                          R10040
     C                     MOVE SAPYBR    RRPYBR                          085867
     C                     MOVE SARCBR    RRRCBR                          085867
     C*
     C           SAPAYM    IFEQ *BLANKS
     C                     MOVE '0'       *IN22
     C                     ELSE
     C                     MOVE '1'       *IN22
     C                     END
     C*
     C           SARCVM    IFEQ *BLANKS
     C                     MOVE '0'       *IN24
     C                     ELSE
     C                     MOVE '1'       *IN24
     C                     END
     C*
     C**  ACCESS CURRENCY 1 DETAILS
     C                     MOVE SACCY1    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP1
     C*
     C**  EDIT AMOUNT 1
     C                     MOVE SAAMT1    ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRAM1L           LEFT-ADJUSTED
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C**  WRITE PI PD  DEAL AMENDMENT TO REPORT
     C                     EXSR #W11
     C                     ENDSR                           *** #P11 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#P12*****-*PROCESS*SC,*CI,*SI*DEAL*AND*FID.*DEPOSIT*AMENDMENTS****S01486
      * #P12     - PROCESS SC, CI, SI DEAL AMENDMENTS                    *S01486
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      **#W12*****-*WRITE*SC,*CI,*SI*DEAL*AND*FIDUCIARY*DEPOSIT************S01486
      * #W12     - WRITE SC, CI, SI DEAL                                 *S01486
      *            AMENDMENTS TO DAILY TRANSACTIONS REPORT               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P12      BEGSR                           *** #P12   ***
     C*
     C                     MOVE SATRNB    RRTRNB
     C                     MOVELSAT1XT    RRT1XT
     C                     MOVELSAT2XT    RRT2XT
     C                     MOVE SATRTP    RRTRTP
     C                     MOVELSATRTP    RRTRN1
     C                     MOVE SASEQA    RRSQNO
     C           SABRT1    IFNE *ZEROS
     C                     MOVE SABRT1    RRBRT1
     C                     ELSE
     C                     MOVE *BLANKS   RRBRT1
     C                     END
     C                     MOVE SABRCD    RRBRCD
     C                     MOVE SAPAYM    RRPAYM
     C                     MOVE SAPYAC    RRPYAC
     C                     MOVE SAPYNM    RRPYNM                          R10040
     C                     MOVE SARCVM    RRRCVM
     C                     MOVE SARCAC    RRRCAC
     C                     MOVE SARCNM    RRRCNM                          R10040
     C                     MOVE SAPYBR    RRPYBR                          085867
     C                     MOVE SARCBR    RRRCBR                          085867
     C*
     C           SAPAYM    IFEQ *BLANKS
     C                     MOVE '0'       *IN22
     C                     ELSE
     C                     MOVE '1'       *IN22
     C                     END
     C*
     C           SARCVM    IFEQ *BLANKS
     C                     MOVE '0'       *IN24
     C                     ELSE
     C                     MOVE '1'       *IN24
     C                     END
     C*
     C**  EDIT INTEREST RATE 1
     C                     MOVE SARAI1    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRRAI1
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C**  WRITE SC CI SI   DEAL AMENDMENT TO REPORT
     C                     EXSR #W12
     C                     ENDSR                           *** #P12 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#P13*****-*PROCESS*LE*LOANS*AND*FIDUCIARY*LOANS*******************S01486
      * #P13     - PROCESS LE LOANS                                      *S01486
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #CURR    - ACCESS CURRENCY DETAILS
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      **#W13*****-*WRITE*LE*AND*FID.*LOANS*TO*DAILY*TRANSACTIONS*REPORT***S01486
      * #W13     - WRITE LE LOANS TO DAILY TRANSACTIONS REPORT           *S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCDP1   -                                                       *
      *                                                                  *
      ********************************************************************
     C           #P13      BEGSR                           *** #P13 ***
     C*
     C                     MOVE SATRNB    RRTRNB
     C                     MOVELSAT1XT    RRT1XT
     C                     MOVELSAT2XT    RRT2XT
     C                     MOVE SATRTP    RRTRTP
     C                     MOVE SATRST    RRTRST
     C                     MOVELSATRTP    RRTRN1
     C           SABRT1    IFNE *ZEROS
     C                     MOVE SABRT1    RRBRT1
     C                     ELSE
     C                     MOVE *BLANKS   RRBRT1
     C                     END
     C                     MOVE SAFRQ1    RRFRQ1
     C                     MOVE SACCY1    RRCCY1
     C                     MOVE SABRCD    RRBRCD
     C***********                                                         S01486
     C***********SAMODI    IFEQ 'FL'                                      S01486
     C***********          MOVE SAFINR    RRFINR                          S01486
     C***********          MOVE SABNUM    RRBNUM                          S01486
     C***********          MOVE SACOMC    RRCOMC                          S01486
     C***********          MOVE SACFRQ    RRCFRQ                          S01486
     C***********                                                         S01486
     C***NEXT*COMMISION*DATE*******************************************   S01486
     C***********          Z-ADDSANCDT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********WWDAT1    IFEQ *BLANK                                    S01486
     C***********ZADATE    ANDNE*BLANK                                    S01486
     C***********          MOVE *ZERO     WWDAT1                          S01486
     C***********          END                                            S01486
     C***********          MOVE ZADATE    RRNCDT                          S01486
     C***********                                                         S01486
     C***********          MOVE SACGST    RRCGST                          S01486
     C***********          MOVE SACGAD    RRCGAD                          S01486
     C***********          END                                            S01486
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM0400CCP2                                           S01408
     C*                                                                   S01408
     C                     MOVE SAPAYM    RRPAYM
     C                     MOVE SAPYAC    RRPYAC
     C                     MOVE SAPYNM    RRPYNM                          R10040
     C                     MOVE SARCVM    RRRCVM
     C                     MOVE SARCAC    RRRCAC
     C                     MOVE SARCNM    RRRCNM                          R10040
     C                     MOVE SAPYBR    RRPYBR                          085867
     C                     MOVE SARCBR    RRRCBR                          085867
     C                     MOVE SATDSS    LEDS
     C*
     C**  EDIT INTEREST RATE 1
     C                     MOVE SARAI1    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRRAI1
     C*
     C**  EDIT INTEREST REPAYMENT DATE 1
     C                     Z-ADDSAIPD1    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRIPD1
     C*
     C**  ACCESS CURRENCY 1 DETAILS
     C                     MOVE SACCY1    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP1
     C*
     C**  EDIT AMOUNT 1
     C**         SAAMT1    ADD  SAVAL1    SAAMT1                    B07949B07958
     C                     MOVE SAAMT1    ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRAM1L           LEFT-ADJUSTED
     C*                                                                   B07949
     C**  EDIT CHARGE AMOUNT                                              B07949
     C           SAVAL1    IFNE 0                                         B07949
     C                     MOVE '1'       *IN60                           B07949
     C                     MOVE SAVAL1    ZFLD15                          B07949
     C                     Z-ADDWWCDP1    ZDECS                           B07949
     C                     MOVE 'J'       ZECODE                          B07949
     C                     EXSR ZSEDIT                                    B07949
     C                     MOVE ZOUT21    RRVAL1           RIGHT-ADJUSTED B07949
     C                     ELSE                                           B07949
     C                     MOVE '0'       *IN60                           B07949
     C                     END                                            B07949
     C*
     C**  EDIT DEAL  DATE
     C                     Z-ADDSADDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRDDAT
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C**  EDIT MATURITY  DATE
     C           SAMDAT    IFLT 0
     C                     Z-SUBSAMDAT    SAMDAT
     C                     MOVE SAMDAT    RRMDA2
     C                     ELSE
     C                     Z-ADDSAMDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRMDAT
     C                     END
     C*
     C**  EDIT TOTAL AMOUNT
     C                     MOVE SACCY1    RRSETC
     C           SAAMT1    ADD  SAVAL1    SAAMT1                    B07949B07958
     C                     MOVE SAAMT1    ZFLD15                          B07958
     C                     Z-ADDWWCDP1    ZDECS                           B07958
     C                     MOVE 'J'       ZECODE                          B07958
     C                     EXSR ZSEDIT                                    B07958
     C                     MOVE ZOUT21    RRTOTR           RIGHT-ADJUSTED B07958
     C                     MOVEAZOUT21    ZS2                             B07958
     C                     EXSR #MVLED                                    B07958
     C                     MOVEAZS3       RRTOTL           LEFT-ADJUSTED  B07958
     C**                   MOVE RRAM1R    RRTOTR           RIGHT-ADJUSTED B07958
     C*
     C**  WRITE LE LOAN TO REPORT
     C                     EXSR #W13
     C                     ENDSR                           *** #P13 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#P14*****-*PROCESS*PI,*MR*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS******S01486
      * #P14     - PROCESS PI, MR LOAN AMENDMENTS                        *S01486
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #CURR    - ACCESS CURRENCY DETAILS
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      **#W14*****-*WRITE*PI,*MR*LOAN*ANDS*FIDUCIARY*LOAN*AMENDMENTS*******S01486
      * #W14     - WRITE PI, MR LOAN AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCDP1   -                                                       *
      *                                                                  *
      ********************************************************************
     C           #P14      BEGSR                           *** #P14 ***
     C*
     C                     MOVE SATRNB    RRTRNB
     C                     MOVELSAT1XT    RRT1XT
     C                     MOVELSAT2XT    RRT2XT
     C                     MOVE SATRTP    RRTRTP
     C                     MOVE SASEQA    RRSQNO
     C                     MOVELSATRTP    RRTRN1
     C                     MOVE SACCY1    RRCCY1
     C                     MOVE SABRCD    RRBRCD
     C                     MOVE SAPAYM    RRPAYM
     C                     MOVE SAPYAC    RRPYAC
     C                     MOVE SAPYNM    RRPYNM                          R10040
     C                     MOVE SARCVM    RRRCVM
     C                     MOVE SARCAC    RRRCAC
     C                     MOVE SARCNM    RRRCNM                          R10040
     C                     MOVE SAPYBR    RRPYBR                          085867
     C                     MOVE SARCBR    RRRCBR                          085867
     C*
     C           SAPAYM    IFEQ *BLANKS
     C                     MOVE '0'       *IN22
     C                     ELSE
     C                     MOVE '1'       *IN22
     C                     END
     C*
     C           SARCVM    IFEQ *BLANKS
     C                     MOVE '0'       *IN24
     C                     ELSE
     C                     MOVE '1'       *IN24
     C                     END
     C*
     C**  ACCESS CURRENCY 1 DETAILS
     C                     MOVE SACCY1    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP1
     C*
     C**  EDIT AMOUNT 1
     C                     MOVE SAAMT1    ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRAM1L           LEFT-ADJUSTED
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C**  WRITE PI MR LOAN AMENDMENT TO REPORT
     C                     EXSR #W14
     C                     ENDSR                           *** #P14 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#P15*****-*PROCESS*SC,*CI,*SI*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS**S01486
      * #P15     - PROCESS SC, CI, SI LOAN AMENDMENTS                    *S01486
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      **#W15*****-*WRITE*SC,*CI,*SI*LOAN*AMEND.*AND*SC,*BC*FIDUCIARY******S01486
      * #W15     - WRITE SC, CI, SI LOAN AMENDMENTS TO DAILY             *S01486
      *            TRANSACTIONS REPORT                                   *S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P15      BEGSR                           *** #P15 ***
     C*
     C                     MOVE SATRNB    RRTRNB
     C                     MOVELSAT1XT    RRT1XT
     C                     MOVELSAT2XT    RRT2XT
     C                     MOVE SATRTP    RRTRTP
     C                     MOVE SASEQA    RRSQNO
     C                     MOVELSATRTP    RRTRN1
     C           SABRT1    IFNE *ZEROS
     C                     MOVE SABRT1    RRBRT1
     C                     ELSE
     C                     MOVE *BLANKS   RRBRT1
     C                     END
     C                     MOVE SABRCD    RRBRCD
     C                     MOVE SAPAYM    RRPAYM
     C                     MOVE SAPYAC    RRPYAC
     C                     MOVE SAPYNM    RRPYNM                          R10040
     C                     MOVE SARCVM    RRRCVM
     C                     MOVE SARCAC    RRRCAC
     C                     MOVE SARCNM    RRRCNM                          R10040
     C                     MOVE SAPYBR    RRPYBR                          085867
     C                     MOVE SARCBR    RRRCBR                          085867
     C*
     C           SAPAYM    IFEQ *BLANKS
     C                     MOVE '0'       *IN22
     C                     ELSE
     C                     MOVE '1'       *IN22
     C                     END
     C*
     C           SARCVM    IFEQ *BLANKS
     C                     MOVE '0'       *IN24
     C                     ELSE
     C                     MOVE '1'       *IN24
     C                     END
     C*
     C**  EDIT INTEREST RATE 1
     C                     MOVE SARAI1    ZFLD15
     C                     Z-ADD8         ZDECS
     C                     MOVE ' '       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRRAI1
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C**  WRITE SC CI SI  LOAN AMENDMENT TO REPORT
     C                     EXSR #W15
     C                     ENDSR                           *** #P15 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P16     - PROCESS MANUAL POSTINGS                               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #CURR    - ACCESS CURRENCY DETAILS
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      * #MVLED   - TO SUPRESS LEADING BLANKS AND NON SIGNIFICANT ZEROS    *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      * #W16     - WRITE MANUAL POSTINGS TO DAILY TRANSACTIONS REPORT    *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - DETERMINE TYPE OF TRANSACTION                         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCDP1   -                                                       *
      *                                                                  *
      ********************************************************************
     C           #P16      BEGSR                           *** #P16 ***
     C*
     C                     MOVE SACNUM    RRCNUM
     C******               MOVELSAT1XT    RRT1XT                          R05913
     C                     MOVELSAT1XT    RRT1X1                          R05913
     C                     MOVELSAT2XT    RRT2XT
     C                     MOVE SATRTP    RRTRTP
     C                     MOVELSATRTP    RRTRN1
     C                     MOVE SACCY1    RRCCY1
     C                     MOVE SABRCD    RRBRCD
     C                     MOVE SATRNB    RETRNB
     C*
     C**  ACCESS CURRENCY 1 DETAILS
     C                     MOVE SACCY1    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP1
     C*
     C**  EDIT AMOUNT 1
     C           SAAMT1    IFLT 0
     C                     Z-SUBSAAMT1    SAAMT1
     C                     MOVE 'CR'      WWDRCR  2
     C                     ELSE
     C                     MOVE 'DR'      WWDRCR
     C                     END
     C                     MOVE SAAMT1    ZFLD15
     C                     Z-ADDWWCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVELWWDRCR    WWFLD1  1
     C                     MOVE WWFLD1    ZOUT21
     C                     MOVE ZOUT21    RRAM1R           RIGHT-ADJUSTED
     C                     MOVEAZOUT21    ZS2
     C                     EXSR #MVLED
     C                     MOVEAZS3       RRAM1L           LEFT-ADJUSTED
     C*
     C**  EDIT DEAL  DATE
     C                     Z-ADDSADDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRDDAT
     C*
     C**  EDIT VALUE DATE
     C                     Z-ADDSAVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C           WWDAT1    IFEQ *BLANK
     C           ZADATE    ANDNE*BLANK
     C                     MOVE *ZERO     WWDAT1
     C                     END
     C                     MOVE ZADATE    RRVDAT
     C*
     C**  EDIT TOTAL AMOUNT
     C                     MOVE SACCY1    RRSETC
     C                     MOVE RRAM1R    RRTOTR           RIGHT-ADJUSTED
     C                     MOVE ' '       RRTOTR                          058883
     C*
     C**  WRITE RE MANUAL POSTINGS TO DAILY TRANSACTIONS REPORT
     C                     EXSR #W16
     C                     ENDSR                           *** #P16 END ***
     C**************************************************************************
      ***/EJECT*****                                                      S01486
      ********************************************************************S01486
      ***********                                                        *S01486
      **#P17*****-*PROCESS*SA*FIDUCIARY*LOAN*AMENDMENTS*******************S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLS:*************************************************S01486
      **ZDATE2***-*TO*CONVERT*A*MIDAS*DATE*TO*A*6*DIGITS*DATE*************S01486
      **#W17*****-*WRITE*SA*FIDUCIARY*LOAN*AMENDMENTS*TO*DAILY*REPORT*****S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLED*FROM:*******************************************S01486
      **#P03*****-*DETERMINE*TYPE*OF*TRANSACTION**************************S01486
      ***********                                                        *S01486
      **ROUTINE*USES*VARIABLES:*******************************************S01486
      ***********                                                        *S01486
      ********************************************************************S01486
     C***********#P17      BEGSR                           *** #P17 ***   S01486
     C***********                                                         S01486
     C***********          MOVE SATRNB    RRTRNB                          S01486
     C***********                                                         S01486
     C***********          MOVELSAT1XT    RRT1XT                          S01486
     C***********          MOVELSAT2XT    RRT2XT                          S01486
     C***********          MOVE SATRTP    RRTRTP                          S01486
     C***********          MOVELSATRTP    RRTRN1                          S01486
     C***********          MOVE SASEQA    RRSQNO                          S01486
     C***********          MOVE SABRCD    RRBRCD                          S01486
     C***********          Z-ADDSAVDAT    ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    RRVDAT                          S01486
     C***********          EXSR #W17                                      S01486
     C***********                                                         S01486
     C***********          ENDSR                           *** #P17 END **S01486
     C********************************************************************S01486
      /EJECT
     C**************************************************************************
     C**
     C**   #CURR           -  ACCESS CURRENCY DETAILS
     C**
     C**   CALLED BY #P04  -  PROCESS SE TRADES
     C**             #P07     - PROCESS FX DEALS
     C**             #P08     - PROCESS MM DEALS                          S01486
     C***************#P08*****-*PROCESS*MM*DEALS*AND*FIDUCIARY*DEPOSITS***S01486
     C***************#P09*****-*PROCESS*FR,*RS,*RL*DEALS******************S01486
     C***************#P10*****-*PROCESS*RX*DEALS**************************S01486
     C***************#P11*****-*PROCESS*PI,*PD*DEAL*AND*FID.*DEP.*AMEND.**S01486
     C***************#P13*****-*PROCESS*LE*LOANS*AND*FIDUCIARY*LOANS******S01486
     C***************#P14*****-*PROCESS*PI,*MR*LOAN*AND*FID.LOANS*AMEND.**S01486
     C**             #P11     - PROCESS PI, PD DEAL AMEND.                S01486
     C**             #P13     - PROCESS LE LOANS                          S01486
     C**             #P14     - PROCESS PI, MR LOAN AMEND.                S01486
     C**             #P16     - PROCESS MANUAL POSTINGS
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #CURR     BEGSR                           * #CURR BEGS *
     C*
     C**   ACCESS THE CURRENCY DETAILS RECORD
     C***********WWCURR    CHAINSDCURRL0             72                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY'    P@OPTN                          S01486
     C                     PARM WWCURR    P@KEY3  3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C*                                                                   S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVELWWCURR    DBKEY                           S01486
     C***********          MOVEL'04'      DBASE            ***************S01486
     C***********          MOVEL'SDCURRL0'DBFILE           * DB ERROR 04 *S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVELWWCURR    DBKEY                           S01486
     C                     Z-ADD4         DBASE            ***************S01486
     C                     MOVEL'SDCURRPD'DBFILE           * DB ERROR 04 *S01486
     C                     OUT  LDA                                       S01486
     C                     WRITEPM0400ER                                  S01486
     C                     EXSR *PSSR                      ***************
     C                     END
     C*
     C                     ENDSR                           * #CURR ENDS**
     C**************************************************************************
      /EJECT
     C**************************************************************************
     C**
     C**   #INST           -  ACCESS PM INSTRUMENT TYPE DETAILS
     C**
     C**   CALLED BY #P01  -  TRANSACTIONS PROCESSING
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #INST     BEGSR                           * #INST BEGS *
      *                                                                   182961
      ** Instrument type is defaulted from PF/SDPORTPD if a blank         182961
      ** instrument type is found.                                        182961
      ** Indicator 35 was used as the operation's resulting indicator.    182961
      *                                                                   182961
     C           SAINNR    IFEQ *BLANKS                                   182961
     C           1         SETLLSDPORTPD                                  182961
     C                     READ SDPORTPD                 35               182961
     C                     MOVE FCDINR    SAINNR                          182961
     C                     ENDIF                                          182961
     C*
     C**   ACCESS THE INSTRUMENT TYPES FILE USING THE PM INSTRUMENT TYPE
     C**   FROM THE INSTRUMENT TYPE
     C***********SAINNR    CHAINSDPLINPD             72                   S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*KEY'    P@OPTN  7                       S01486
     C                     PARM SAINNR    P@INNR  3                       S01486
     C           SDPLIN    PARM SDPLIN    DSFDY                           S01486
     C*
     C**   PERFORM DATABASE IN ERROR PROCESSING IF NO LIVE RECORD FOUND
     C************IN72     IFEQ '0'                                       S01486
     C***********PDRECI    ANDEQ'*'                                       S01486
     C***********          MOVE '1'       *IN72                           S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVELSAINNR    DBKEY                           S01486
     C***********          MOVEL'03'      DBASE            ***************S01486
     C***********          MOVEL'SDPLINPD'DBFILE           * DB ERROR 03 *S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD3         DBASE                           S01486
     C                     MOVELSAINNR    DBKEY            ***************S01486
     C                     MOVEL'SDPLINPD'DBFILE           * DB ERROR 03 *S01486
     C                     OUT  LDA                        ***************S01486
     C                     WRITEPM0400ER                                  S01486
     C                     EXSR *PSSR                      ***************
     C                     END
     C*
     C                     ENDSR                           * #INST ENDS**
     C**************************************************************************
      /EJECT
     C**************************************************************************
     C**
     C**   #PORT           -  ACCESS PORTFOLIO DETAILS
     C**
     C**   CALLED BY #P01  -  TRANSACTIONS PROCESSING
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #PORT     BEGSR                           * #PORT BEGSR *
     C*
     C**   ACCESS THE PORTFOLIO DETAILS FILE USING THE CUSTOMER NUMBER
     C**   AND PORTFOLIO REFERENCE
     C           SAPTFR    IFNE '9997'
     C***********PKEY      CHAINPMPORTPP             72                   S01486
     C           PKEY      CHAINPMPORTPD             72                   S01486
     C*
     C**   PERFORM DATABASE IN ERROR PROCESSING IF NO RECORD FOUND
     C           *IN72     IFEQ '1'
     C***********          MOVEL'02'      DBASE            ***************S01486
     C***********          MOVEL'PMPORTPP'DBFILE           * DB ERROR 02 *S01486
     C                     Z-ADD2         DBASE            ***************S01486
     C                     MOVEL'PMPORTPD'DBFILE           * DB ERROR 02 *S01486
     C                     MOVELSACNUM    DBKE1  10        ***************
     C                     MOVE SAPTFR    DBKE1
     C                     MOVELDBKE1     DBKEY
     C                     WRITEPM0400ER                                  S01486
     C                     EXSR *PSSR
     C                     END
     C                     ELSE
     C*
     C                     MOVE SACNUM    WWCNUM  6
     C***********WWCNUM    CHAINSDPLCSPD             72                   S01486
     C                     CALL 'AOPLCSR0'                                S01486
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*KEY'    P@OPTN  7                       S01486
     C                     PARM WWCNUM    P@KEY1 10                       S01486
     C           SDPLCS    PARM SDPLCS    DSSDY                           S01486
     C*
     C**   PERFORM DATABASE IN ERROR PROCESSING IF NO RECORD FOUND
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'06'      DBASE            ***************S01486
     C***********          MOVEL'SDPLCSPD'DBFILE           * DB ERROR 06 *S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD6         DBASE                           S01486
     C                     MOVELWWCNUM    DBKEY            ***************S01486
     C                     MOVEL'SDPLCSPD'DBFILE           * DB ERROR 06 *S01486
     C                     OUT  LDA                        ***************S01486
     C                     WRITEPM0400ER                                  S01486
     C                     EXSR *PSSR
     C                     END
     C                     END
     C*
     C                     ENDSR                           * #PORT ENDSR *
     C*
     C**************************************************************************
      /EJECT
     C**************************************************************************
     C**
     C**   #CUST           -  ACCESS CUSTOMER DETAILS
     C**
     C**   CALLED BY #P01  -  TRANSACTIONS PROCESSING
     C**
     C**   CALLS
     C**
     C*=========================================================================
     C*
     C           #CUST     BEGSR                           * #CUST BEGS *
     C*
     C**   ACCESS THE CUSTOMER DETAILS FILE USING THE CUSTOMER
     C**   FROM THE TRANSACTION
     C                     MOVE SACNUM    WWPNP8                          S01486
     C***********WWPNP8    CHAINSDCUSTL0             72                   S01486
     C                     CALL 'AOCUSTR0'                                S01486
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*KEY'    P@OPTN  7                       S01486
     C                     PARM WWPNP8    P@KEY1 10                       S01486
     C                     PARM           P@KYST  7                       S01486
     C           SDCUST    PARM SDCUST    DSSDY                           S01486
     C*
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVELWWPNP8    DBKEY                           S01486
     C***********          MOVEL'04'      DBASE            ***************S01486
     C***********          MOVEL'SDCUSTL0'DBFILE           * DB ERROR 04 *S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD7         DBASE                           S01486
     C                     MOVELWWPNP8    DBKEY            ***************S01486
     C                     MOVEL'SDCUSTPD'DBFILE           *  DATABASE   *S01486
     C                     OUT  LDA                        *  ERROR 07   *S01486
     C                     WRITEPM0400ER                                  S01486
     C                     EXSR *PSSR                      ***************
     C                     END
     C*
     C                     ENDSR                           * #CUST ENDS**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - TRANSACTIONS PROCESSING                               *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * #W04     - WRITE SE TRADES TO DAILY TRANSACTIONS REPORT          *
      * #W05     - WRITE SE DEPOT MOVEMENTS TO DAILY TRANS. REPORT       *
      **#W06*****-*WRITE*FF*TRANSACTIONS*TO*DAILY*TRANSACTIONS*REPORT*****S01486
      * #W06     - WRITE FF TRANSACTIONS TO DAILY TRANSACTIONS REPORT    *S71062
      * #W07     - WRITE FX DEALS TO DAILY TRANSACTIONS REPORT           *
      * #W08     - WRITE MM DEALS TRANSACTIONS REPORT                    *S01486
      **#W08*****-*WRITE*MM*DEALS*AND*FID.*DEPOSITS*TRANSACTIONS*REPORT***S01486
      **#W09*****-*WRITE*FR,*RS,*RL*DEALS*TO*DAILY*TRANS.*REPORT**********S01486
      **#W10*****-*WRITE*RX*DEALS*TO*DAILY*TRANSACTIONS*REPORT************S01486
      **#W11*****-*WRITE*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS*****S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W12*****-*WRITE*SC,*CI,*SI*DEAL*AND*FIDUCIARY*DEPOSIT************S01486
      *************AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT****************S01486
      **#W13*****-*WRITE*LE*AND*FID.*LOANS*TO*DAILY*TRANSACTIONS*REPORT***S01486
      **#W14*****-*WRITE*PI,*MR*LOAN*ANDS*FIDUCIARY*LOAN*AMENDMENTS*******S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W15*****-*WRITE*SC,*CI,*SI*LOAN*AMEND.*AND*SC,*BC*FIDUCIARY******S01486
      *************LOAN*AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT***********S01486
      * #W11     - WRITE PI, PD DEAL AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W12     - WRITE SC, CI, SI DEAL AMENDMENTS                      *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W13     - WRITE LE LOANS TO DAILY TRANSACTIONS REPORT           *S01486
      * #W14     - WRITE PI, MR LOAN AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W15     - WRITE SC, CI, SI LOAN AMEND.                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W16     - WRITE MANUAL POSTINGS TO DAILY TRANSACTIONS REPORT    *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W0101    BEGSR                           *** #W01    ***
     C*
     C** IF PORTFOLIO REFERENCE OF '9997' SET UP POTRTFOLIO DETAILS
     C** WITH DETAILS FROM ICD AND CUSTOMER
     C           SAPTFR    IFEQ '9997'
     C***********          MOVE P9N997    PNPTFN                          S01486
     C***********          MOVE P9R997    SAPTFR                          S01486
     C                     MOVE FCN997    PNPTFN                          S01486
     C                     MOVE FCR997    SAPTFR                          S01486
     C                     MOVE QBCSBY    PNPTCY
     C                     END
     C*
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     Z-ADD0         WLNCTR  10                      CDL006
     C                     ENDIF                                          CDL006
     C                     Z-ADD0         LINOUT  10
     C                     WRITEPM0400HD               75
     C                     WRITEPM0400F1               75
     C*
     C* IF COMPRESSED REPORT,WRITE HEADINGS
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM0400F4               75
     C                     END
     C                     ENDSR                           *** #W0101 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - TRANSACTIONS PROCESSING                               *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * #W04     - WRITE SE TRADES TO DAILY TRANSACTIONS REPORT          *
      * #W05     - WRITE SE DEPOT MOVEMENTS TO DAILY TRANS. REPORT       *
      **#W06*****-*WRITE*FF*TRANSACTIONS*TO*DAILY*TRANSACTIONS*REPORT*****S01486
      * #W06     - WRITE FF TRANSACTIONS TO DAILY TRANSACTIONS REPORT    *S71062
      * #W07     - WRITE FX DEALS TO DAILY TRANSACTIONS REPORT           *
      * #W08     - WRITE MM DEALS TRANSACTIONS REPORT                    *S01486
      **#W08*****-*WRITE*MM*DEALS*AND*FID.*DEPOSITS*TRANSACTIONS*REPORT***S01486
      **#W09*****-*WRITE*FR,*RS,*RL*DEALS*TO*DAILY*TRANS.*REPORT**********S01486
      **#W10*****-*WRITE*RX*DEALS*TO*DAILY*TRANSACTIONS*REPORT************S01486
      **#W11*****-*WRITE*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS*****S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W12*****-*WRITE*SC,*CI,*SI*DEAL*AND*FIDUCIARY*DEPOSIT************S01486
      *************AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT****************S01486
      **#W13*****-*WRITE*LE*AND*FID.*LOANS*TO*DAILY*TRANSACTIONS*REPORT***S01486
      **#W14*****-*WRITE*PI,*MR*LOAN*ANDS*FIDUCIARY*LOAN*AMENDMENTS*******S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W15*****-*WRITE*SC,*CI,*SI*LOAN*AMEND.*AND*SC,*BC*FIDUCIARY******S01486
      *************LOAN*AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT***********S01486
      * #W11     - WRITE PI, PD DEAL TO DAILY TRANSACTIONS REPORT        *S01486
      * #W12     - WRITE SC, CI, SI DEAL TO DAILY TRANSACTIONS REPORT    *S01486
      * #W13     - WRITE LE LOANS TO DAILY TRANSACTIONS REPORT           *S01486
      * #W14     - WRITE PI, MR LOAN AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W15     - WRITE SC, CI, SI LOAN AMEND.                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W16     - WRITE MANUAL POSTINGS TO DAILY TRANSACTIONS REPORT    *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W0102    BEGSR                           *** #W0102  ***
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     END
     C*
     C* ONLY WRITE DISPLAY GROUP DETAILS IF NOT COMPRESSED REPORT
     C*
     C           FULCOM    IFNE 'C'
     C                     WRITEPM0400F2               75
     C                     END
     C                     ENDSR                           *** #W0102 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - TRANSACTIONS PROCESSING                               *
      * #W04     - WRITE SE TRADES TO DAILY TRANSACTIONS REPORT          *
      * #W05     - WRITE SE DEPOT MOVEMENTS TO DAILY TRANS. REPORT       *
      **#W06*****-*WRITE*FF*TRANSACTIONS*TO*DAILY*TRANSACTIONS*REPORT*****S01486
      * #W06     - WRITE FF TRANSACTIONS TO DAILY TRANSACTIONS REPORT    *S71062
      * #W07     - WRITE FX DEALS TO DAILY TRANSACTIONS REPORT           *
      * #W08     - WRITE MM DEALS TRANSACTIONS REPORT                    *S01486
      **#W08*****-*WRITE*MM*DEALS*AND*FID.*DEPOSITS*TRANSACTIONS*REPORT***S01486
      **#W09*****-*WRITE*FR,*RS,*RL*DEALS*TO*DAILY*TRANS.*REPORT**********S01486
      **#W10*****-*WRITE*RX*DEALS*TO*DAILY*TRANSACTIONS*REPORT************S01486
      **#W11*****-*WRITE*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS*****S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W12*****-*WRITE*SC,*CI,*SI*DEAL*AND*FIDUCIARY*DEPOSIT************S01486
      *************AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT****************S01486
      **#W13*****-*WRITE*LE*AND*FID.*LOANS*TO*DAILY*TRANSACTIONS*REPORT***S01486
      **#W14*****-*WRITE*PI,*MR*LOAN*ANDS*FIDUCIARY*LOAN*AMENDMENTS*******S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W15*****-*WRITE*SC,*CI,*SI*LOAN*AMEND.*AND*SC,*BC*FIDUCIARY******S01486
      *************LOAN*AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT***********S01486
      * #W11     - WRITE PI, PD DEAL TO DAILY TRANSACTIONS REPORT        *S01486
      * #W12     - WRITE SC, CI, SI DEAL AMENDMENTS                      *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W13     - WRITE LE LOANS TO DAILY TRANSACTIONS REPORT           *S01486
      * #W14     - WRITE PI, MR LOAN AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W15     - WRITE SC, CI, SI LOAN AMEND. AMENDMENTS               *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W16     - WRITE MANUAL POSTINGS TO DAILY TRANSACTIONS REPORT    *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W0103    BEGSR                           *** #W0103  ***
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     END
     C*
     C* ONLY WRITE INSTRUMENT TYPE DETAILS IF NOT COMPRESSED REPORT
     C*
     C           FULCOM    IFNE 'C'
     C                     WRITEPM0400F3               75
     C                     END
     C                     ENDSR                           *** #W0103 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W02     - WRITE TO DAILY TRANSACTIONS AUDIT REPORT              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P02     - AUDIT PROCESSING                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W02      BEGSR                           *** #W02  ***
     C*
     C** IF EMPTY INPUT FILE, ACCESS BANK DETAIL AND PRINT
     C** ADEQUATE HEADINGS
     C***********TRACPT    IFEQ *ZERO                                     S01486
     C***********          MOVE '1  '     AZPRTL                          S01486
     C***********          EXSR #INIT                                     S01486
     C***********          WRITEPM0400HD               75                 S01486
     C***********          WRITEPM0400ND               75                 S01486
     C***********          END                                            S01486
     C***********          MOVE '0'       *IN75                           S01486
     C***********          WRITEPM0400EN               75                 S01486
     C***********          WRITEPM0400Z1               75                 S01486
     C           TRACPT    IFEQ 0                                         S01486
     C                     EXSR #INIT                                     S01486
     C                     ENDIF                                          S01486
     C*                                                                   S01486
     C**  WRITE AUDIT FILE HEADER                                         S01486
     C*                                                                   S01486
     C                     WRITEPM0400Z1                                  S01486
     C*                                                                   S01486
     C**  ENSURE AUDIT SPOOL FILE RECORDED BY RCF                         S01486
     C*                                                                   S01486
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01486
     C*                                                                   S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ                             S01486
     C                     PARM *BLANKS   SENTY                           S01486
     C                     PARM           SFILEU                          S01486
     C                     PARM           ZSNUMU                          S01486
     C                     PARM *BLANK    ZSERR                           S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C*                                                                   S01486
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01486
     C*                                                                   S01486
     C                     SETON                     U7U8LR               S01486
     C                     RETRN                                          S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C                     WRITEPM0400Z2                                  S01486
     C*                                                                   S01486
     C           TRACPT    IFEQ 0                                         S01486
     C                     WRITEPM0400ND                                  S01486
     C                     ELSE                                           S01486
     C*                                                                   S01486
     C**  If printer file is open, output report footer                   S01486
     C*                                                                   S01486
     C           WLOPN     IFEQ 'Y'                                       S01486
     C                     WRITEPM0400EN               75                 S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C                     ENDIF                                          S01486
     C*
     C                     ENDSR                           *** #W02 END*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W04     - WRITE SE TRADES TO DAILY TRANSACTIONS REPORT          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P04     - PROCESS SE TRADES                                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W04      BEGSR                           *** #W04  ***
     C*
     C           SACHTP    IFEQ 'I'
     C                     MOVE 'INSERTED'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'A'
     C           SACHTP    OREQ 'C'
     C                     MOVE 'AMENDED 'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'D'
     C           SACHTP    OREQ 'R'                                       R05581
     C                     MOVE 'DELETED 'RRCHTP
     C                     END
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400TPC               75
     C                     ELSE
     C                     WRITEPM400TPF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W04 END*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W05     - WRITE SE DEPOT MOVEMENTS TO DAILY TRANS. REPORT       *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P05     - PROCESS SE DEPOT MOVEMENTS                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W05      BEGSR                           *** #W05  ***
     C           SACHTP    IFEQ 'I'
     C                     MOVE 'INSERTED'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'A'
     C                     MOVE 'AMENDED 'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'D'
     C           SACHTP    OREQ 'R'                                       R05581
     C                     MOVE 'DELETED 'RRCHTP
     C                     END
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400WIC               75
     C                     ELSE
     C                     WRITEPM400WIF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W05 END*
      ********************************************************************
      ***/EJECT*****                                                      S01486
      ********************************************************************S01486
      ***********                                                        *S01486
      **#W06*****-*WRITE*FF*TRANSACTIONS*TO*DAILY*TRANSACTIONS*REPORT*****S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLS:*************************************************S01486
      **#W0101***-*WRITE*REPORT*HEADING*TO*DAILY*TRANSACTIONS*REPORT******S01486
      **#W0102***-*WRITE*DISPLAY*GROUP*HEADING*TO*DAILY*TRANS.*REPORT*****S01486
      **#W0103***-*WRITE*INSTRUMENT*TYPE*HEADING*TO*DAILY*REPORT**********S01486
      **BLKSR****-*OUTPUT*FIELDS*INITIALISATION***************************S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLED*FROM:*******************************************S01486
      **#P06*****-*PROCESS*FF*TRANSACTIONS********************************S01486
      ***********                                                        *S01486
      **ROUTINE*USES*VARIABLES:*******************************************S01486
      ***********                                                        *S01486
      ********************************************************************S01486
     C***********#W06      BEGSR                           *** #W06  ***  S01486
     C***********                                                         S01486
     C***********SACHTP    IFEQ 'I'                                       S01486
     C***********          MOVE 'INSERTED'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********SACHTP    IFEQ 'A'                                       S01486
     C***********          MOVE 'AMENDED 'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********SACHTP    IFEQ 'D'                                       S01486
     C***********SACHTP    OREQ 'R'                                 R05581S01486
     C***********          MOVE 'DELETED 'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********LINOUT    IFEQ 3                                         S01486
     C***********FULCOM    ANDNE'C'                                       S01486
     C***********LINOUT    OREQ 8                                         S01486
     C***********FULCOM    ANDEQ'C'                                       S01486
     C***********          EXSR #W0101                                    S01486
     C***********          EXSR #W0102                                    S01486
     C***********          EXSR #W0103                                    S01486
     C***********          END                                            S01486
     C***********          ADD  1         LINOUT                          S01486
     C***********                                                         S01486
     C**COMPRESSED/FULL*REPORT********************************************S01486
     C***********                                                         S01486
     C***********FULCOM    IFEQ 'C'                                       S01486
     C***********          WRITEPM400FFC               75                 S01486
     C***********          ELSE                                           S01486
     C***********          WRITEPM400FFF               75                 S01486
     C***********          END                                            S01486
     C***********          EXSR BLKSR                                     S01486
     C***********                                                         S01486
     C***********          ENDSR                           *** #W06 END*  S01486
     C********************************************************************S01486
     C/EJECT                                                              S71062
     C********************************************************************S71062
     C*                                                                  *S71062
     C* #W06     - Write FF transactions to daily transactions report    *S71062
     C*                                                                  *S71062
     C* Subroutine calls                                                 *S71062
     C* #W0101   - Write report heading to daily transactions report     *S71062
     C* #W0102   - Write display group heading to daily trans. report    *S71062
     C* #W0103   - Write instrument type heading to daily report         *S71062
     C* BLKSR    - Output fields initialisation                          *S71062
     C*                                                                  *S71062
     C* Subroutine called from:                                          *S71062
     C* #P06     - Process FF transactions                               *S71062
     C*                                                                  *S71062
     C* Routine uses variables:                                          *S71062
     C*                                                                  *S71062
     C********************************************************************S71062
     C           #W06      BEGSR                           *** #W06  ***  S71062
     C*                                                                   S71062
     C           SACHTP    IFEQ 'I'                                       S71062
     C                     MOVE 'INSERTED'RRCHTP                          S71062
     C                     ENDIF                                          S71062
     C           SACHTP    IFEQ 'A'                                       S71062
     C                     MOVE 'AMENDED 'RRCHTP                          S71062
     C                     ENDIF                                          S71062
     C           SACHTP    IFEQ 'D'                                       S71062
     C           SACHTP    OREQ 'R'                                       S71062
     C                     MOVE 'DELETED 'RRCHTP                          S71062
     C                     ENDIF                                          S71062
     C*                                                                   S71062
     C           LINOUT    IFEQ 3                                         S71062
     C           FULCOM    ANDNE'C'                                       S71062
     C           LINOUT    OREQ 8                                         S71062
     C           FULCOM    ANDEQ'C'                                       S71062
     C                     EXSR #W0101                                    S71062
     C                     EXSR #W0102                                    S71062
     C                     EXSR #W0103                                    S71062
     C                     ENDIF                                          S71062
     C                     ADD  1         LINOUT                          S71062
     C*                                                                   S71062
     C* Compressed/Full report                                            S71062
     C*                                                                   S71062
     C           FULCOM    IFEQ 'C'                                       S71062
     C                     WRITEPM400FFC               75                 S71062
     C                     ELSE                                           S71062
     C                     WRITEPM400FFF               75                 S71062
     C                     ENDIF                                          S71062
     C                     EXSR BLKSR                                     S71062
     C*                                                                   S71062
     C                     ENDSR                           *** #W06 END*  S71062
      ********************************************************************S71062
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W07     - WRITE FX DEALS TO DAILY TRANSACTIONS REPORT           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P07     - PROCESS FX DEALS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W07      BEGSR                           *** #W07  ***
     C           SACHTP    IFEQ 'I'
     C                     MOVE 'INSERTED'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'A'
     C                     MOVE 'AMENDED 'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'D'
     C           SACHTP    OREQ 'R'                                       R05581
     C                     MOVE 'DELETED 'RRCHTP
     C                     END
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400FXC               75
     C                     ELSE
     C                     WRITEPM400FXF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W07 END*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#W08*****-*WRITE*MM*DEALS*AND*FID.*DEPOSITS*TRANSACTIONS*REPORT***S01486
      * #W08     - WRITE MM DEALS TRANSACTIONS REPORT                    *S01486
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      **#P08*****-*PROCESS*MM*DEALS*AND*FIDUCIARY*DEPOSITS****************S01486
      * #P08     - PROCESS MM DEALS                                      *S01486
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W08      BEGSR                           *** #W08  ***
     C           SACHTP    IFEQ 'I'
     C                     MOVE 'INSERTED'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'A'
     C                     MOVE 'AMENDED 'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'D'
     C           SACHTP    OREQ 'R'                                       R05581
     C                     MOVE 'DELETED 'RRCHTP
     C                     END
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400MMC               75
     C                     ELSE
     C                     WRITEPM400MMF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W08 END*
      ********************************************************************
      ***/EJECT*****                                                      S01486
      ********************************************************************S01486
      ***********                                                        *S01486
      **#W09*****-*WRITE*FR,*RS,*RL*DEALS*TO*DAILY*TRANS.*REPORT**********S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLS:*************************************************S01486
      **#W0101***-*WRITE*REPORT*HEADING*TO*DAILY*TRANSACTIONS*REPORT******S01486
      **#W0102***-*WRITE*DISPLAY*GROUP*HEADING*TO*DAILY*TRANS.*REPORT*****S01486
      **#W0103***-*WRITE*INSTRUMENT*TYPE*HEADING*TO*DAILY*REPORT**********S01486
      **BLKSR****-*OUTPUT*FIELDS*INITIALISATION***************************S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLED*FROM:*******************************************S01486
      **#P09*****-*PROCESS*FR,*RS,*RL*DEALS*******************************S01486
      ***********                                                        *S01486
      **ROUTINE*USES*VARIABLES:*******************************************S01486
      ***********                                                        *S01486
      ********************************************************************S01486
     C***********#W09      BEGSR                           *** #W09  ***  S01486
     C***********SACHTP    IFEQ 'I'                                       S01486
     C***********          MOVE 'INSERTED'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********SACHTP    IFEQ 'A'                                       S01486
     C***********          MOVE 'AMENDED 'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********SACHTP    IFEQ 'D'                                       S01486
     C***********SACHTP    OREQ 'R'                                 R05581S01486
     C***********          MOVE 'DELETED 'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********LINOUT    IFEQ 3                                         S01486
     C***********FULCOM    ANDNE'C'                                       S01486
     C***********LINOUT    OREQ 8                                         S01486
     C***********FULCOM    ANDEQ'C'                                       S01486
     C***********          EXSR #W0101                                    S01486
     C***********          EXSR #W0102                                    S01486
     C***********          EXSR #W0103                                    S01486
     C***********          END                                            S01486
     C***********          ADD  1         LINOUT                          S01486
     C***********                                                         S01486
     C**COMPRESSED/FULL*REPORT********************************************S01486
     C***********                                                         S01486
     C***********FULCOM    IFEQ 'C'                                       S01486
     C***********          WRITEPM400FRC               75                 S01486
     C***********          ELSE                                           S01486
     C***********          WRITEPM400FRF               75                 S01486
     C***********          END                                            S01486
     C***********          EXSR BLKSR                                     S01486
     C***********                                                         S01486
     C***********          ENDSR                           *** #W08 END*  S01486
     C********************************************************************S01486
      ***/EJECT*****                                                      S01486
     C********************************************************************S01486
     C***********                                                        *S01486
     C**#W10*****-*WRITE*RX*DEALS*TO*DAILY*TRANSACTIONS*REPORT************S01486
     C***********                                                        *S01486
     C**SUBROUTINE*CALLS:*************************************************S01486
     C**#W0101***-*WRITE*REPORT*HEADING*TO*DAILY*TRANSACTIONS*REPORT******S01486
     C**#W0102***-*WRITE*DISPLAY*GROUP*HEADING*TO*DAILY*TRANS.*REPORT*****S01486
     C**#W0103***-*WRITE*INSTRUMENT*TYPE*HEADING*TO*DAILY*REPORT**********S01486
     C**BLKSR****-*OUTPUT*FIELDS*INITIALISATION***************************S01486
     C***********                                                        *S01486
     C**SUBROUTINE*CALLED*FROM:*******************************************S01486
     C**#P10*****-*PROCESS*RX*DEALS***************************************S01486
     C***********                                                        *S01486
     C**ROUTINE*USES*VARIABLES:*******************************************S01486
     C***********                                                        *S01486
     C********************************************************************S01486
     C***********#W10      BEGSR                           *** #W10  ***  S01486
     C***********                                                         S01486
     C***********SACHTP    IFEQ 'I'                                       S01486
     C***********          MOVE 'INSERTED'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********SACHTP    IFEQ 'A'                                       S01486
     C***********          MOVE 'AMENDED 'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********SACHTP    IFEQ 'D'                                       S01486
     C***********SACHTP    OREQ 'R'                                 R05581S01486
     C***********          MOVE 'DELETED 'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********LINOUT    IFEQ 3                                         S01486
     C***********FULCOM    ANDNE'C'                                       S01486
     C***********LINOUT    OREQ 8                                         S01486
     C***********FULCOM    ANDEQ'C'                                       S01486
     C***********          EXSR #W0101                                    S01486
     C***********          EXSR #W0102                                    S01486
     C***********          EXSR #W0103                                    S01486
     C***********          END                                            S01486
     C***********          ADD  1         LINOUT                          S01486
     C***********                                                         S01486
     C**COMPRESSED/FULL*REPORT********************************************S01486
     C***********                                                         S01486
     C***********FULCOM    IFEQ 'C'                                       S01486
     C***********          WRITEPM400RXC               75                 S01486
     C***********          ELSE                                           S01486
     C***********          WRITEPM400RXF               75                 S01486
     C***********          END                                            S01486
     C***********          EXSR BLKSR                                     S01486
     C***********                                                         S01486
     C***********          ENDSR                           *** #W10 END*  S01486
     C********************************************************************S01486
      /EJECT
      ********************************************************************
      *                                                                  *
      **#W11*****-*WRITE*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS*****S01486
      * #W11     - WRITE PI, PD DEAL AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      **#P11*****-*PROCESS*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS***S01486
      * #P11     - PROCESS PI, PD DEAL AMENDMENTS                        *S01486
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W11      BEGSR                           *** #W11  ***
     C*
     C           SACHTP    IFEQ 'I'
     C                     MOVE 'INSERTED'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'A'
     C                     MOVE 'AMENDED 'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'D'
     C           SACHTP    OREQ 'R'                                       R05581
     C                     MOVE 'DELETED 'RRCHTP
     C                     END
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400PIC               75
     C                     ELSE
     C                     WRITEPM400PIF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W11 END*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#W12*****-*WRITE*SC,*CI,*SI*DEAL*AND*FIDUCIARY*DEPOSIT************S01486
      * #W12     - WRITE SC, CI, SI DEAL                                 *S01486
      *            AMENDMENTS TO DAILY TRANSACTIONS REPORT               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      **#P12*****-*PROCESS*SC,*CI,*SI*DEAL*AND*FID.*DEPOSIT*AMENDMENTS****S01486
      * #P12     - PROCESS SC, CI, SI DEAL AMENDMENTS                    *S01486
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W12      BEGSR                           *** #W12  ***
     C*
     C           SACHTP    IFEQ 'I'
     C                     MOVE 'INSERTED'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'A'
     C                     MOVE 'AMENDED 'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'D'
     C           SACHTP    OREQ 'R'                                       R05581
     C                     MOVE 'DELETED 'RRCHTP
     C                     END
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400SCC               75
     C                     ELSE
     C                     WRITEPM400SCF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W11 END*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#W13*****-*WRITE*LE*AND*FID.*LOANS*TO*DAILY*TRANSACTIONS*REPORT***S01486
      * #W13     - WRITE LE LOANS TO DAILY TRANSACTIONS REPORT           *S01486
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      **#P13*****-*PROCESS*LE*LOANS*AND*FIDUCIARY*LOANS*******************S01486
      * #P13     - PROCESS LE LOANS                                      *S01486
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W13      BEGSR                           *** #W13  ***
     C*
     C           SACHTP    IFEQ 'I'
     C                     MOVE 'INSERTED'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'A'
     C                     MOVE 'AMENDED 'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'D'
     C           SACHTP    OREQ 'R'                                       R05581
     C                     MOVE 'DELETED 'RRCHTP
     C                     END
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400LEC               75
     C                     ELSE
     C                     WRITEPM400LEF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W13 END*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#W14*****-*WRITE*PI,*MR*LOAN*ANDS*FIDUCIARY*LOAN*AMENDMENTS*******S01486
      * #W14     - WRITE PI, MR LOAN AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      **#P14*****-*PROCESS*PI,*MR*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS******S01486
      * #P14     - PROCESS PI, MR LOAN AMENDMENTS                        *S01486
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W14      BEGSR                           *** #W14  ***
     C*
     C           SACHTP    IFEQ 'I'
     C                     MOVE 'INSERTED'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'A'
     C                     MOVE 'AMENDED 'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'D'
     C           SACHTP    OREQ 'R'                                       R05581
     C                     MOVE 'DELETED 'RRCHTP
     C                     END
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400MRC               75
     C                     ELSE
     C                     WRITEPM400MRF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W14 END*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#W15*****-*WRITE*SC,*CI,*SI*LOAN*AMEND.*AND*SC,*BC*FIDUCIARY******S01486
      * #W15     - WRITE SC, CI, SI                                      *S01486
      *            LOAN AMENDMENTS TO DAILY TRANSACTIONS REPORT          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      **#P15*****-*PROCESS*SC,*CI,*SI*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS**S01486
      * #P15     - PROCESS SC, CI, SI LOAN AMENDMENTS                    *S01486
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W15      BEGSR                           *** #W15  ***
     C*
     C           SACHTP    IFEQ 'I'
     C                     MOVE 'INSERTED'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'A'
     C                     MOVE 'AMENDED 'RRCHTP
     C                     END
     C           SACHTP    IFEQ 'D'
     C           SACHTP    OREQ 'R'                                       R05581
     C                     MOVE 'DELETED 'RRCHTP
     C                     END
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400SIC               75
     C                     ELSE
     C                     WRITEPM400SIF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W15 END*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W16     - WRITE MANUAL POSTINGS TO DAILY TRANSACTIONS REPORT    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W0101   - WRITE REPORT HEADING TO DAILY TRANSACTIONS REPORT     *
      * #W0102   - WRITE DISPLAY GROUP HEADING TO DAILY TRANS. REPORT    *
      * #W0103   - WRITE INSTRUMENT TYPE HEADING TO DAILY REPORT         *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P16     - PROCESS MANUAL POSTINGS                               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W16      BEGSR                           *** #W16  ***
     C*
     C           LINOUT    IFEQ 3
     C           FULCOM    ANDNE'C'
     C           LINOUT    OREQ 8
     C           FULCOM    ANDEQ'C'
     C                     EXSR #W0101
     C                     EXSR #W0102
     C                     EXSR #W0103
     C                     END
     C                     ADD  1         LINOUT
     C*
     C* COMPRESSED/FULL REPORT
     C*
     C           FULCOM    IFEQ 'C'
     C                     WRITEPM400REC               75
     C                     ELSE
     C                     WRITEPM400REF               75
     C                     END
     C                     EXSR BLKSR
     C*
     C                     ENDSR                           *** #W16 END*
     C**************************************************************************
      ***/EJECT*****                                                      S01486
      ********************************************************************S01486
      ***********                                                        *S01486
      **#W17*****-*WRITE*SA*FIDUCIARY*LOAN*AMENDMENTS*TO*DAILY*REPORT*****S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLS:*************************************************S01486
      **#W0101***-*WRITE*REPORT*HEADING*TO*DAILY*TRANSACTIONS*REPORT******S01486
      **#W0102***-*WRITE*DISPLAY*GROUP*HEADING*TO*DAILY*TRANS.*REPORT*****S01486
      **#W0103***-*WRITE*INSTRUMENT*TYPE*HEADING*TO*DAILY*REPORT**********S01486
      **BLKSR****-*OUTPUT*FIELDS*INITIALISATION***************************S01486
      ***********                                                        *S01486
      **SUBROUTINE*CALLED*FROM:*******************************************S01486
      **#P17*****-*PROCESS*SA*FIDUCIARY*LOAN*AMENDMENTS*******************S01486
      ***********                                                        *S01486
      **ROUTINE*USES*VARIABLES:*******************************************S01486
      ***********                                                        *S01486
      ********************************************************************S01486
     C***********#W17      BEGSR                           *** #W17  ***  S01486
     C***********                                                         S01486
     C***********SACHTP    IFEQ 'I'                                       S01486
     C***********          MOVE 'INSERTED'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********SACHTP    IFEQ 'A'                                       S01486
     C***********          MOVE 'AMENDED 'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********SACHTP    IFEQ 'D'                                       S01486
     C***********SACHTP    OREQ 'R'                                 R05581S01486
     C***********          MOVE 'DELETED 'RRCHTP                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********LINOUT    IFEQ 3                                         S01486
     C***********FULCOM    ANDNE'C'                                       S01486
     C***********LINOUT    OREQ 8                                         S01486
     C***********FULCOM    ANDEQ'C'                                       S01486
     C***********          EXSR #W0101                                    S01486
     C***********          EXSR #W0102                                    S01486
     C***********          EXSR #W0103                                    S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          ADD  1         LINOUT                          S01486
     C***********                                                         S01486
     C**COMPRESSED/FULL*REPORT********************************************S01486
     C***********                                                         S01486
     C***********FULCOM    IFEQ 'C'                                       S01486
     C***********          WRITEPM400FIC               75                 S01486
     C***********          ELSE                                           S01486
     C***********          WRITEPM400FIF               75                 S01486
     C***********          END                                            S01486
     C***********          EXSR BLKSR                                     S01486
     C***********                                                         S01486
     C***********          ENDSR                           *** #W17 END*  S01486
     C********************************************************************S01486
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM0400CCP3                                           S01408
     C*                                                                   S01408
      /EJECT
     C**************************************************************************
      ** *PSSR       :      FILE EXCEPTION ERROR HANDLING SUBROUTINE
      ** CALLED FROM : MAIN
      ** CALLS       :
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      * #P01     - TRANSACTIONS PROCESSING                               *
      * #P02     - AUDIT PROCESSING                                      *
      * #P04     - PROCESS SE TRADES                                     *
      * #P07     - PROCESS FX DEALS                                      *
      * #P08     - PROCESS MM DEALS                                      *S01486
      **#P08*****-*PROCESS*MM*DEALS*AND*FIDUCIARY*DEPOSITS****************S01486
      **#P09*****-*PROCESS*FR,*RS,*RL*DEALS*******************************S01486
      **#P10*****-*PROCESS*RX*DEALS***************************************S01486
      **#P11*****-*PROCESS*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS***S01486
      **#P13*****-*PROCESS*LE*LOANS*AND*FIDUCIARY*LOANS*******************S01486
      **#P14*****-*PROCESS*PI,*MR*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS******S01486
      * #P11     - PROCESS PI, PD DEAL AMENDMENTS                        *S01486
      * #P13     - PROCESS LE LOANS                                      *S01486
      * #P14     - PROCESS PI, MR LOAN AMENDMENTS                        *S01486
      * #P16     - PROCESS MANUAL POSTINGS                               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           *PSSR     BEGSR                            ** *PSRR BSR**
     C**
     C** ROLL BACK CHANGES , DUMP AND RETURN TO THE CALLING PROGRAM
     C**
     C                     MOVE '1'       *INLR
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C*                    ROLBK
     C                     DUMP
     C*                                                                   S01486
     C**  If printer file is open, print database error reference         S01486
     C*                                                                   S01486
     C           WLOPN     IFEQ 'Y'                                       S01486
     C                     WRITEPM0400DB               75                 S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C                     RETRN
     C**
     C                     ENDSR                            ** *PSRR ESR**
      ********************************************************************
      /EJECT
      ********************************************************************
     C**                                                                 *
     C** #MVLED subroutine to suppress blanks preceeding significant     *
     C** digit and to suppress non significant zeros following decimal   *
     C** point (last character is deplaced)                              *
     C**     Input fields:   ZS2    21/1                                 *
     C**                                                                 *
     C**     Arrays:         ZS2    21/1                                 *
     C**                     ZS3    21/1                                 *
     C**                                                                 *
     C**     Output fields:  ZS3    21/1                                 *
     C**                                                                 *
     C**===============================================================
     C*
     C           #MVLED    BEGSR                           **  #MVLED   *
     C*
     C**   Replace non sigificant zeros following decimal point
     C**   by the last character (-,% ...) aand replace this last
     C**   by a blank
     C                     MOVE *BLANK    ZS3
     C*
     C**   Suppress zeros for rates only
     C           ZECODE    IFEQ *BLANK
     C*
     C**   Perform processing for decimal positions only
     C                     Z-ADD1         I
     C           '.'       LOKUPZS2,I                    72
     C           *IN72     IFEQ '1'
     C                     Z-ADD20        I       20
     C                     Z-ADD21        J       20
     C*
     C           ZS2,I     DOWEQ*ZERO
     C           I         ANDGT13
     C                     MOVE ZS2,J     ZS2,I
     C                     MOVE *BLANK    ZS2,J
     C                     SUB  1         I
     C                     SUB  1         J
     C                     END
     C                     END
     C                     END
     C*
     C**   Count number of leading blanks
     C                     Z-ADD1         I
     C*
     C           ZS2,I     DOWEQ*BLANK
     C                     ADD  1         I
     C                     END
     C*
     C**   Load output array starting with the first significant digit
     C**   of the input array
     C                     Z-ADD1         J
     C*
     C           I         DOWLE21
     C                     MOVE ZS2,I     ZS3,J
     C                     ADD  1         I
     C                     ADD  1         J
     C                     END
     C                     Z-ADD1         I
     C*
     C                     MOVE '0'       *IN72
     C*
     C**   If last character is 'D' or 'C', move 'R'in the following
     C**   character
     C           'D'       LOKUPZS3,I                    72
     C           *IN72     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE 'R'       ZS3,I
     C                     END
     C*
     C           *IN72     IFEQ '0'
     C                     Z-ADD1         I
     C           'C'       LOKUPZS3,I                    72
     C           *IN72     IFEQ '1'
     C                     ADD  1         I
     C                     MOVE 'R'       ZS3,I
     C                     END
     C                     END
     C*
     C                     MOVE '0'       *IN72
     C*
     C                     ENDSR                           * #MVLED ES *
     C*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * ZSEDIT   - TO EDIT AMOUNT TO OUTPUT                               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P04     - PROCESS SE TRADES                                     *
      * #P05     - PROCESS SE DEPOT MOVEMENTS                            *
      **#P06*****-*PROCESS*FF*TRANSACTIONS********************************S01486
      * #P06     - PROCESS FF TRANSACTIONS                               *S71062
      * #P07     - PROCESS FX DEALS                                      *
      * #P08     - PROCESS MM DEALS                                      *S01486
      **#P08*****-*PROCESS*MM*DEALS*AND*FIDUCIARY*DEPOSITS****************S01486
      **#P09*****-*PROCESS*FR,*RS,*RL*DEALS*******************************S01486
      **#P10*****-*PROCESS*RX*DEALS***************************************S01486
      **#P11*****-*PROCESS*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS***S01486
      **#P12*****-*PROCESS*SC,*CI,*SI*DEAL*AND*FID.*DEPOSIT*AMENDMENTS****S01486
      **#P13*****-*PROCESS*LE*LOANS*AND*FIDUCIARY*LOANS*******************S01486
      **#P14*****-*PROCESS*PI,*MR*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS******S01486
      **#P15*****-*PROCESS*SC,*CI,*SI*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS**S01486
      * #P11     - PROCESS PI, PD DEAL AMENDMENTS                        *S01486
      * #P12     - PROCESS SC, CI, SI DEAL AMENDMENTS                    *S01486
      * #P13     - PROCESS LE LOANS                                      *S01486
      * #P14     - PROCESS PI, MR LOAN AMENDMENTS                        *S01486
      * #P15     - PROCESS SC, CI, SI LOAN AMENDMENTS                    *S01486
      * #P16     - PROCESS MANUAL POSTINGS                               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
      /COPY ZSRSRC,ZSEDITZ3
      /EJECT
      /COPY ZSRSRC,ZCCYXR
      /EJECT
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
     C**
      ********************************************************************
      *                                                                  *
      * ZDATE2   - TO CONVERT A MIDAS DATE TO A 6 DIGITS DATE            *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P04     - PROCESS SE TRADES                                     *
      * #P05     - PROCESS SE DEPOT MOVEMENTS                            *
      **#P06*****-*PROCESS*FF*TRANSACTIONS********************************S01486
      * #P06     - PROCESS FF TRANSACTIONS                               *S71062
      * #P07     - PROCESS FX DEALS                                      *
      * #P08     - PROCESS MM DEALS                                      *S01486
      **#P08*****-*PROCESS*MM*DEALS*AND*FIDUCIARY*DEPOSITS****************S01486
      **#P09*****-*PROCESS*FR,*RS,*RL*DEALS*******************************S01486
      **#P10*****-*PROCESS*RX*DEALS***************************************S01486
      **#P11*****-*PROCESS*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS***S01486
      **#P12*****-*PROCESS*SC,*CI,*SI*DEAL*AMENDMENTS*********************S01486
      **#P13*****-*PROCESS*LE*LOANS*AND*FIDUCIARY*LOANS*******************S01486
      **#P14*****-*PROCESS*PI,*MR*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS******S01486
      **#P15*****-*PROCESS*SC,*CI,*SI*LOAN*AND*FIDUCIARY*LOAN*AMENDMENTS**S01486
      * #P11     - PROCESS PI, PD DEAL AMENDMENTS                        *S01486
      * #P12     - PROCESS SC, CI, SI DEAL AMENDMENTS                    *S01486
      * #P13     - PROCESS LE LOANS                                      *S01486
      * #P14     - PROCESS PI, MR LOAN AMENDMENTS                        *S01486
      * #P15     - PROCESS SC, CI, SI LOAN AMENDMENT                     *S01486
      * #P16     - PROCESS MANUAL POSTINGS                               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
     C**************************************************************************
     C*                                                                        *
     C*  ZAPNUM - CALCULATE AP NUMERATOR                                       *
     C*                                                                        *
     C*  PURPOSE : TO MULTIPLY A NOMINAL POSITION BY THE PRICE OF THE          *
     C*  POSITION TO GIVE A VALUE OF THE POSITION WITH THE CORRECT NUMBER      *
     C*  OF DECIMAL PLACES FOR THE NOMINAL CURRENCY                            *
     C*                                                                        *
     C*  INPUT  FIELDS                                                         *
     C*       ZNOML  11 0     NOMINAL                                          *
     C*       ZAVPR  15 8     AVERAGE PRICE                                    *
     C*       ZNMDP   1 0     NOMINAL DECIMAL PLACES (0-4)                     *
     C*       ZNMCD   1 0     NOMINAL CURRENCY DECIMAL PLACES (0-3)            *
     C*       ZPRCB   1 A     PRICE BASIS (P/U)                                *
     C*                                                                        *
     C*  OUTPUT  FIELDS                                                        *
     C*       ZVALU  15 0     VALUE                                            *
     C*                                                                        *
     C*  ALSO REQUIRED                                                         *
     C*       POWER8 ARRAY OF MULTIPLYING FACTORS FOR NOMINAL DECIMAL PLACES   *
     C*                                                                        *
     C*  WORK FIELDS:                                                          *
     C*       ZVAL0  15 0 - AVERAGE PRICE WITH 0 DECIMAL PLACES                *
     C*       ZVAL1  15 1 - --------------- '' ----------------                *
     C*       ZVAL2  15 2 - --------------- '' ----------------                *
     C*       ZVAL3  15 3 - --------------- '' ----------------                *
     C*       ZI      1 0 - POWER ARRAY                                        *
     C*                                                                        *
     C*  CALLED FROM:                                                          *
     C*                                                                        *
     C*************************************************************************
     C           ZAPNUM    BEGSR                           *** ZAPNUM ***
     C*
     C** DEFINE ALL FIELDS
     C                     Z-ADDZNOML     ZNOML  110
     C                     Z-ADDZAVPR     ZAVPR  158
     C                     Z-ADDZNMDP     ZNMDP   10
     C                     Z-ADDZNMCD     ZNMCD   10
     C                     MOVE ZPRCB     ZPRCB   1
     C                     Z-ADDZVALU     ZVALU  150
     C*
     C** IF NUMBER OF CURRENCY DECIMAL PLACES I = 0
     C           ZNMCD     IFEQ 0
     C           ZNOML     MULT ZAVPR     ZVAL0  150H
     C                     MOVE ZVAL0     ZVALU
     C                     END
     C*
     C** IF NUMBER OF CURRENCY DECIMAL PLACES I = 1
     C           ZNMCD     IFEQ 1
     C           ZNOML     MULT ZAVPR     ZVAL1  151H
     C                     MOVE ZVAL1     ZVALU
     C                     END
     C*
     C** IF NUMBER OF CURRENCY DECIMAL PLACES I = 2
     C           ZNMCD     IFEQ 2
     C           ZNOML     MULT ZAVPR     ZVAL2  152H
     C                     MOVE ZVAL2     ZVALU
     C                     END
     C*
     C** IF NUMBER OF CURRENCY DECIMAL PLACES I = 3
     C           ZNMCD     IFEQ 3
     C           ZNOML     MULT ZAVPR     ZVAL3  153H
     C                     MOVE ZVAL3     ZVALU
     C                     END
     C*
     C** SET INDEX ZI EQUAL TO 5 -. NOMINAL DECIMAL PLACES )
     C           5         SUB  ZNMDP     ZI      10
     C*
     C** MULTIPLY ZVALU BY  POWER8,ZI TO GET AMOUNT WITH NOMINAL DECIMAL PLACES
     C           ZVALU     MULT POWER8,ZI ZVALU
     C*
     C** PRICE BASIS IF = PERCENTAGE
     C           ZPRCB     IFEQ 'P'
     C           ZVALU     DIV  100       ZVALU     H
     C                     END
     C*
     C                     ENDSR
     C*************************************************************************
      /EJECT
     C********************************************************************
     C**
     C**   BLKSR  SR. MOVE *BLANKS IN PRINTER FILE
     C**   CURRENCY USING AN EXCHANGE RATE BETWEEN THE TWO CURRENCIES
     C**
     C**
     C**
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * BLKSR    - OUTPUT FIELDS INITIALISATION                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #W04     - WRITE SE TRADES TO DAILY TRANSACTIONS REPORT          *
      * #W05     - WRITE SE DEPOT MOVEMENTS TO DAILY TRANS. REPORT       *
      **#W06*****-*WRITE*FF*TRANSACTIONS*TO*DAILY*TRANSACTIONS*REPORT*****S01486
      * #W06     - WRITE FF TRANSACTIONS TO DAILY TRANSACTIONS REPORT    *S71062
      * #W07     - WRITE FX DEALS TO DAILY TRANSACTIONS REPORT           *
      * #W08     - WRITE MM DEALS TRANSACTIONS REPORT                    *S01486
      **#W08*****-*WRITE*MM*DEALS*AND*FID.*DEPOSITS*TRANSACTIONS*REPORT***S01486
      **#W09*****-*WRITE*FR,*RS,*RL*DEALS*TO*DAILY*TRANS.*REPORT**********S01486
      **#W10*****-*WRITE*RX*DEALS*TO*DAILY*TRANSACTIONS*REPORT************S01486
      **#W11*****-*WRITE*PI,*PD*DEAL*AND*FIDUCIARY*DEPOSIT*AMENDMENTS*****S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W12*****-*WRITE*SC,*CI,*SI*DEAL*AND*FIDUCIARY*DEPOSIT************S01486
      *************AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT****************S01486
      **#W13*****-*WRITE*LE*AND*FID.*LOANS*TO*DAILY*TRANSACTIONS*REPORT***S01486
      **#W14*****-*WRITE*PI,*MR*LOAN*ANDS*FIDUCIARY*LOAN*AMENDMENTS*******S01486
      *************TO*DAILY*TRANSACTIONS*REPORT***************************S01486
      **#W15*****-*WRITE*SC,*CI,*SI*LOAN*AMEND.*AND*SC,*BC*FIDUCIARY******S01486
      *************LOAN*AMENDMENTS*TO*DAILY*TRANSACTIONS*REPORT***********S01486
      * #W11     - WRITE PI, PD DEAL AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W12     - WRITE SC, CI, SI DEAL AMENDMENTS                      *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W13     - WRITE LE TO DAILY TRANSACTIONS REPORT                 *S01486
      * #W14     - WRITE PI, MR LOAN AMENDMENTS                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W15     - WRITE SC, CI, SI LOAN AMEND.                          *S01486
      *            TO DAILY TRANSACTIONS REPORT                          *S01486
      * #W16     - WRITE MANUAL POSTINGS TO DAILY TRANSACTIONS REPORT    *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           BLKSR     BEGSR                           *** BLKSR  ***
     C*
     C                     MOVE *BLANKS   RRACOD
     C                     MOVE *BLANKS   RRACSQ
     C                     MOVE *BLANKS   RRAINT
     C                     MOVE *BLANKS   RRAM1L
     C                     MOVE *BLANKS   RRAM1R
     C                     MOVE *BLANKS   RRAM2L
     C                     MOVE *BLANKS   RRAM2R
     C                     MOVE *BLANKS   RRBRCD
     C                     MOVE *BLANKS   RRBRT1
     C***********          MOVE *BLANKS   RRBRT2                          S01486
     C                     MOVE *BLANKS   RRCCY1
     C                     MOVE *BLANKS   RRCCY2
     C                     MOVE *BLANKS   RRCHTP
     C                     MOVE *BLANKS   RRCHT1
     C                     MOVE *BLANKS   RRTRN1
     C                     MOVE *BLANKS   RRTRN2
     C                     MOVE *BLANKS   RRCNUM
     C                     MOVE *BLANKS   RRDDAT
     C                     MOVE *BLANKS   RRT1XT
     C                     MOVE *BLANKS   RRT2XT
     C                     MOVE *BLANKS   RRFFNM
     C                     MOVE *BLANKS   RRFRQ1
     C***********          MOVE *BLANKS   RRFRQ2                          S01486
     C                     MOVE *BLANKS   RRFSEQ
     C                     MOVE *BLANKS   RRFTYP
     C                     MOVE *BLANKS   RRIPD1
     C***********          MOVE *BLANKS   RRIPD2                          S01486
     C                     MOVE *BLANKS   RRMDAT
     C                     MOVE *BLANKS   RRMDA1
     C                     MOVE *BLANKS   RRMDA2
     C                     MOVE *BLANKS   RRPR1L
     C                     MOVE *BLANKS   RRPR1R
     C                     MOVE *BLANKS   RRPR2L
     C                     MOVE *BLANKS   RRPR2R
     C                     MOVE *BLANKS   RRPAYM
     C                     MOVE *BLANKS   RRPYAC
     C                     MOVE *BLANKS   RRPYNM                          R10040
     C                     MOVE *BLANKS   RRRCVM
     C                     MOVE *BLANKS   RRRCAC
     C                     MOVE *BLANKS   RRRCNM                          R10040
     C                     MOVE *BLANKS   RRPUIL
     C                     MOVE *BLANKS   RRPUIR
     C                     MOVE *BLANKS   RRRAI1
     C***********          MOVE *BLANKS   RRRAI2                          S01486
     C                     MOVE *BLANKS   RRRTAL
     C                     MOVE *BLANKS   RRRTAR
     C                     MOVE *BLANKS   RRRTBL
     C                     MOVE *BLANKS   RRSETC
     C                     MOVE *BLANKS   RRSQNO
     C                     MOVE *BLANKS   RRSWOD
     C                     MOVE *BLANKS   RRTAS1
     C                     MOVE *BLANKS   RRTBS1
     C                     MOVE *BLANKS   RRTDSS
     C                     MOVE *BLANKS   RRTOTL
     C                     MOVE *BLANKS   RRTOTR
     C                     MOVE *BLANKS   RRTRNB
     C                     MOVE *BLANKS   RRTRST
     C                     MOVE *BLANKS   RRTRTP
     C                     MOVE *BLANKS   RRVL1L
     C                     MOVE *BLANKS   RRVL2L
     C                     MOVE *BLANKS   RRVL2R
     C                     MOVE *BLANKS   RRVDAT
     C                     MOVE *BLANKS   RRWALK
     C                     MOVE *BLANKS   RRPYBR                          085867
     C                     MOVE *BLANKS   RRRCBR                          085867
     C***********          MOVE *BLANKS   RRCUMA                    ROLLOVS01486
     C***********          MOVE *BLANKS   RRAURO                    ROLLOVS01486
     C***********          MOVE *BLANKS   RRINPS                    ROLLOVS01486
     C***********          MOVE *BLANKS   RRFREQ                    ROLLOVS01486
     C***********          MOVE *BLANKS   RRDNUM                    ROLLOVS01486
     C***********          MOVE *BLANKS   RRIMET                    ROLLOVS01486
     C***********          MOVE *BLANKS   RRISAC                    ROLLOVS01486
     C***********          MOVE *BLANKS   RRINOS                    ROLLOVS01486
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P02     - AUDIT PROCESSING                                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - DATA BASE ERROR MANAGEMENT                            *
      * #W02     - WRITE TO DAILY TRANSACTIONS AUDIT REPORT              *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P02      BEGSR                           *** #P02    ***
     C***********          READ PMTRCNZZ                 72               S01486
     C                     READ PMTRCNPA                 72               S01486
     C*
     C** ABORT PROGRAM IF RECORD NOT FOUND
     C           *IN72     IFEQ '1'
     C***********          MOVE '04'      DBASE             ************  S01486
     C                     Z-ADD8         DBASE             ************  S01486
     C***********          MOVEL'PMTRCNZZ'DBFILE            * DATABASE *  S01486
     C***********          EXSR *PSSR                       * ERROR 04 *  S01486
     C                     MOVEL'PMTRCNPA'DBFILE            * DATABASE *  S01486
     C                     WRITEPM0400ER                                  S01486
     C                     EXSR *PSSR                       * ERROR 08 *  S01486
     C                     END                              ************
     C*
     C*
     C** PRODUCE DAILY TRANSACTION AUDIT REPORT AS PER #W02
     C                     EXSR #W02
     C*
     C**
     C                     ENDSR                           *** #P02 END ***
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #INIT - INITIAL PROCESSING
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     CSR         #INIT     BEGSR                           *** #INIT   ***
     C*
     C** INITIALIZE WORK FIELDS
     C           *LIKE     DEFN A6NBDP    WWCDP1           CCY1 DEC PLACES
     C           *LIKE     DEFN A6NBDP    WWCDP2           CCY2 DEC PLACES
     C           *LIKE     DEFN A6NBDP    WWCDP3           BASE CCY DEC PL
     C           *LIKE     DEFN SACCY1    WWCURR           CCY CODE
     C           *LIKE     DEFN BBCUST    WWPNP8           CNUM ALPHA
     C*
     C           *ENTRY    PLIST                           Entry parameter
     C                     PARM           FULCOM  1
     C                     PARM           SEQ     5                       S01486
     C                     PARM           RENT    3                       S01486
     C*
     C           *NAMVAR   DEFN           LDA                             S01486
     C                     MOVE *BLANKS   DBLOT
     C                     MOVEL'PM0400'  DBPGM
     C*
     C***BUILT*COMMAND*EXPRESSION*FOR*QCMDEXC**************************   S01486
     C***********          MOVELCMD,1     WWCMDP 43                       S01486
     C***********          MOVE ')'       WWPRTL  4                       S01486
     C*
     C** ACCESS BANK DETAILS
     C***********          READ SDBANKPD                 72               S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*FIRST ' P@OPTN  7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C*
     C** IF RECORD NOT FOUND, ABORT PROGRAM
     C************IN72     IFEQ '1'                                       S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVE '01'      DBASE             ************  S01486
     C                     Z-ADD1         DBASE             ************  S01486
     C                     MOVEL'SDBANKPD'DBFILE            * DATABASE *
     C                     OUT  LDA                                       S01486
     C                     WRITEPM0400ER                                  S01486
     C                     EXSR *PSSR                       * ERROR 01 *
     C                     END                              ************
     C*
     C**  CHECK SYSTEM DATE FORMAT (DDMMYY OR MMDDYY):
     C           BJDFIN    IFEQ 'M'                        - B2
     C                     MOVE '1'       *IN98            ON => MMDDYY
     C                     END                             - E2
     C*
     C** ACCESS PORTFOLIO ICD
     C***********          READ SDPORTPD                 72               S01486
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*FIRST ' P@OPTN  7                       S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C*
     C** IF RECORD NOT FOUND, ABORT PROGRAM
     C************IN72     IFEQ '1'                                       S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C***********          MOVE '05'      DBASE             ************  S01486
     C                     Z-ADD5         DBASE             ************  S01486
     C                     MOVEL'SDPORTPD'DBFILE            * DATABASE *
     C                     OUT  LDA                                       S01486
     C***********          EXSR *PSSR                       * ERROR 01 *  S01486
     C                     WRITEPM0400ER                                  S01486
     C                     EXSR *PSSR                       * ERROR 05 *  S01486
     C                     END                              ************
     C*                                                                   CPM004
     C** If Bank Portfolios are supported, set on indicator to            CPM004
     C** trigger printing of some fields in the report.                   CPM004
     C*                                                                   CPM004
     C           *INU2     IFEQ *ON                                       CPM004
     C                     MOVE *ON       *IN50                           CPM004
     C                     ENDIF                                          CPM004
     C*
     C** ACCESS BASE CURRENCY DETAILS
     C                     MOVE BJCYCD    WWCURR
     C                     EXSR #CURR
     C                     Z-ADDA6NBDP    WWCDP3
     C***********                                                         S01486
     C***USE*THE*ADEQUATE*ACCOUNT*OFFICER*PRINTER*FILE****************    S01486
     C***********          MOVELAZPRTL    WWPRTL                          S01486
     C***********          MOVE WWPRTL    WWCMDP                          S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM WWCMDP    QCAA   43                       S01486
     C***********          PARM 43        QCAN   155                      S01486
     C***********          OPEN PM0400P1                                  S01486
     C***********          Z-ADD*ZERO     PAGE                            S01486
     C*                                                                   S01496
     C**  Check if feature "PB SE Enhancements" is on                     S01496
     C*                                                                   S01496
     C                     CALL 'AOSARDR0'                                S01496
     C                     PARM *BLANKS   WLRTCD  7                       S01496
     C                     PARM '*VERIFY' WLOPTN  7                       S01496
     C                     PARM 'S01496'  WLSARD  6                       S01496
     C           SCSARD    PARM SCSARD    DSSDY                           S01496
     C                     MOVE 'N'       S01496  1                       S01496
     C*                                                                   S01496
     C           WLRTCD    IFEQ *BLANKS                                   S01496
     C                     MOVE 'Y'       S01496                          S01496
     C                     ELSE                                           S01496
     C*                                                                   S01496
     C**  Return code other than *NRF                                     S01496
     C*                                                                   S01496
     C           WLRTCD    IFNE '*NRF'                                    S01496
     C           *LOCK     IN   LDA                                       S01496
     C                     Z-ADD9         DBASE            ***************S01496
     C                     MOVE 'SCSARDPD'DBFILE           * DB ERROR 09 *S01496
     C                     MOVELWLOPTN    DBKEY            ***************S01496
     C                     OUT  LDA                                       S01496
     C                     WRITEPM0400ER                                  S01496
     C                     EXSR *PSSR                                     S01496
     C                     END                                            S01496
     C                     END                                            S01496
      *                                                                   CDL006
      ** Check if Dealing Fiduciary is switched ON                        CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   WRTCD   7                       CDL006
     C                     PARM '*VERIFY' WOPTN   7                       CDL006
     C                     PARM 'CDL006'  WSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSFDY                           CDL006
     C           WRTCD     IFEQ *BLANKS                                   CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     OPEN DEALS                                     CDL006
     C                     ELSE                                           CDL006
     C           WRTCD     IFNE '*NRF   '                                 CDL006
     C                     MOVEL'SCSARDPD'DBFILE           ************   CDL006
     C                     Z-ADD10        DBASE            * DBERR 10 *   CDL006
     C                     MOVEL'CDL006'  DBKEY            ************   CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
     C                     MOVE 'N'       CDL006                          CDL006
     C                     ENDIF                                          CDL006
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM0400CCP4                                           S01408
     C*                                                                   S01408
     CSR                   ENDSR                            * #INIT ESR *
     C*
      /EJECT                                                              S01486
     C*****************************************************************   S01486
     C*                                                               *   S01486
     C* #NEWP1 - OPEN NEW PM0400P1 SPOOL FILE AND REGISTER IT IN RCF  *   S01486
     C*                                                               *   S01486
     C* SUBROUTINE CALLS:                                             *   S01486
     C*                                                               *   S01486
     C* SUBROUTINE CALLED FROM:                                       *   S01486
     C* #P01     - TRANSACTIONS PROCESSING                            *   S01486
     C*                                                               *   S01486
     C*****************************************************************   S01486
     CSR         #NEWP1    BEGSR                                          S01486
     C*                                                                   S01486
     C                     OPEN PM0400P1                                  S01486
     C                     MOVE 'Y'       WLOPN   1                       S01486
     C*                                                                   S01486
     C**      ENSURE REPORT SPOOL FILE RECORDED BY RCF                    S01486
     C*                                                                   S01486
     C                     Z-ADDSFNUM     ZSNUM   60                      S01486
     C*                                                                   S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ     5                       S01486
     C                     PARM SAACOC    SENTY   3                       S01486
     C                     PARM           SFILE                           S01486
     C                     PARM           ZSNUM                           S01486
     C                     PARM           ZSERR   1                       S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C*                                                                   S01486
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01486
     C*                                                                   S01486
     C                     SETON                     U7U8LR               S01486
     C                     RETRN                                          S01486
     C                     END                                            S01486
     C*                                                                   S01486
     C                     Z-ADD0         PAGE                            S01486
     C*                                                                   S01486
     CSR                   ENDSR                                          S01486
     C*                                                                   S01486
     C*************************************************************************
      /EJECT                                                              S71062
      /COPY ZSRSRC,FFPRCSZ4                                               S71062
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  POWER8 - ARRAY OF POWERS FOR CURRENCY CONVERSION
00000001
00000010
00000100
00001000
00010000
00100000
01000000
10000000
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
