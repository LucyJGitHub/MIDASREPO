     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Investment Policy Details - File upd')        *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management                             *
     F*                                                               *
     F*  PM0445 - INVESTMENT POLICY DETAILS - FILE UPDATE             *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CER059             Date 19Jul10               *
      *                 CER020             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CAC003             Date 25Feb97               *
      *                 107047             Date 14Oct96               *
     F*                 103048             DATE 14OCT96               *
     F*                 102189             DATE 14OCT96               *
     F*                 096563             DATE 14OCT96               *
     F*                 S01486             DATE 08JUL94               *
     F*                 049467             DATE 26JAN93               *
     F*                 B08040             DATE 10JUL91               *
     F*                 B07823             DATE 22MAY91               *
     F*                 R05938             DATE 02MAY91               *
     F*                 R05861             DATE 22APR91               *
     F*                 R05788             DATE 04APR91               *
     F*                 R0113      BZ      DATE 07FEB91               *
     F*                 R0107      BZ      DATE 06FEB91               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus                                          *
      *  CRE026 - Consumer Banking                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines (Recompile)                            *
     F*  CAC003 - Profit Centre Accounting Development Phase 3.       *
     F*         - Recompiled due to changes in PF/PMPORTPD.           *
     F*  107047 - COMPLETE FIX 103048; WRONG AMOUNT OUTSIDE           *
     F*  103048 - take always the absolute value from actual perc.    *
     F*  102189 - WRONG CURRENT VALUE IN PM0450P1                     *
     F*  096563 - NARRATIVE WRONG FOR POLICY NARRATIVE IN SEVERAL CASE*
     F*  S01486 - Portfolio Management Upgrade                        *
     F*  049467 - RECOMPILED FOR RELEASE 3 PTF 02                     *
     F*  B08040 - SUNDRY FIXES TO SPEED UP COB                        *
     F*  B07823 - AS ALL TRANSACTIONS NOW HAVE A COUNTRY AND INDUSTRY *
     F*           OF RISK CHECKING SHOULD ALWAYS BE AGAINST THE TOTAL *
     F*           PORTFOLIO VALUE                                     *
     F*  R05938 - AMOUNT OUTSIDE POLICY NOT CORRECTLY CALCULATED      *
     F*  R05861 - ACTUAL PERCENTAGE IN INVESTMENT CATEGORY NOT HALF   *
     F*           ADJUSTED CORRECTLY                                  *
     F*  R05788 - NO AUDIT CONTROLS REPORTED                          *
     F*  R0113  - EXCEPTION AMOUNT CALCULATION SUPPRESSED FROM        *
     F*           PM0450 AND ADDED IN PM0445.                         *
     F*  R0107  - HALF ADJUST SPECIFICATION CAUSED NUMERIC FIELD      *
     F*           TO BE ROUNDED TO 0.(IF VALUE LOWER THAN .5)         *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*
     F**************
     F** SYNON FILES
     F**************
     F*****SDPLINPDIF  E           K        DISK                          S01486
     F***PREFIX*'PD' **                                                   S01486
     F********************************************* KINFSR *PSSR          S01486
     F*****SDCTRYL1IF  E           K        DISK                          S01486
     F***PREFIX*'A4' **                                                   S01486
     F********************************************* KINFSR *PSSR          S01486
     F*****SDINDSL1IF  E           K        DISK                          S01486
     F***PREFIX*'AO' **                                                   S01486
     F********************************************* KINFSR *PSSR          S01486
     F*****SDCURRL0IF  E           K        DISK                          S01486
     F***PREFIX*'A6' **                                                   S01486
     F********************************************* KINFSR *PSSR          S01486
     F*
     F*****************************
     F** PORTFOLIO MANAGEMENT FILES
     F*****************************
     F*****PMPOTTPPIF  E           K        DISK                          S01486
     FPMPOTTPDIF  E           K        DISK                               S01486
     F** PREFIX 'QC' **      PORTFOLIO TOTALS
     F                                              KINFSR *PSSR
     F******PMBIPNPPIF  E           K        DISK                         S01486
     F***PREFIX 'PS'*********BANK*INVESTMENT*POLICY*NARRATIVE             S01486
     F********************************************* KINFSR *PSSR          S01486
     FPMCIIPLLIF  E           K        DISK
     F** PREFIX 'PY' **      CUSTOMER INSTRUMENT INVESTMENT POLICY
     F                                              KINFSR *PSSR
     F******PMPGHIPPIF  E           K        DISK                         S01486
     FPMPGHIPDIF  E           K        DISK                               S01486
     F** PREFIX 'PF' **      INSTRUMENT TYPE GROUPS NARRATIVE
     F                                              KINFSR *PSSR
     F******PMPGDIPPIF  E           K        DISK                         S01486
     FPMPGDIPDIF  E           K        DISK                               S01486
     F** PREFIX 'PG' **      INSTRUMENT TYPE GROUP DETAILS BY INSTRUMENT GROUP
     F                                              KINFSR *PSSR
     FPMCCIPLLIF  E           K        DISK
     F** PREFIX 'PZ' **      CUSTOMER CURRENCY INVESTMENT POLICY
     F                                              KINFSR *PSSR
     F******PMPGHCPPIF  E           K        DISK                         S01486
     FPMPGHCPDIF  E           K        DISK                               S01486
     F** PREFIX 'PH' **      CURRENCY GROUPS NARRATIVE
     F                                              KINFSR *PSSR
     F*****PMPGDCPPIF  E           K        DISK                          S01486
     FPMPGDCPDIF  E           K        DISK                               S01486
     F** PREFIX 'PI' **      CURRENCY GROUP DETAILS BY CURRENCY GROUP
     F                                              KINFSR *PSSR
     FPMCRIPLLIF  E           K        DISK
     F** PREFIX 'P2' **      CUSTOMER COUNTRY INVESTMENT POLICY
     F                                              KINFSR *PSSR
     F*****PMPGHRPPIF  E           K        DISK                          S01486
     FPMPGHRPDIF  E           K        DISK                               S01486
     F** PREFIX 'PJ' **      COUNTRY GROUPS NARRATIVES
     F                                              KINFSR *PSSR
     F*****PMPGDRPPIF  E           K        DISK                          S01486
     FPMPGDRPDIF  E           K        DISK                               S01486
     F** PREFIX 'PK' **      COUNTRY GROUPS DETAILS
     F                                              KINFSR *PSSR
     FPMCDIPLLIF  E           K        DISK
     F** PREFIX 'P1' **      CUSTOMER INDUSTRY INVESTMENT POLICY
     F                                              KINFSR *PSSR
     F******PMPGHDPPIF  E           K        DISK                         S01486
     FPMPGHDPDIF  E           K        DISK                               S01486
     F** PREFIX 'PL' **      INDUSTRY GROUP NARRATIVES
     F                                              KINFSR *PSSR
     F******PMPGDDPPIF  E           K        DISK                         S01486
     FPMPGDDPDIF  E           K        DISK                               S01486
     F** PREFIX 'PM' **      INDUSTRY GROUP DETAILS BY INDUSTRY GROUP
     F                                              KINFSR *PSSR
     FPMBIIPLLIF  E           K        DISK
     F** PREFIX 'PT' **      BANK INSTRUMENT INVESTMENT POLICY
     F                                              KINFSR *PSSR
     FPMBCIPLLIF  E           K        DISK
     F** PREFIX 'PU' **      BANK CURRENCY INVESTMENT POLICY
     F                                              KINFSR *PSSR
     FPMBRIPLLIF  E           K        DISK
     F** PREFIX 'PX' **      BANK COUNTRY INVESTMENT POLICY
     F                                              KINFSR *PSSR
     FPMBDIPLLIF  E           K        DISK
     F** PREFIX 'PW' **      BANK INDUSTRY INVESTMENT POLICY
     F                                              KINFSR *PSSR
     FPMISTTL0IF  E           K        DISK
     F** PREFIX 'QE' **      INSTRUMENT TYPE TOTALS
     F                                              KINFSR *PSSR
     F******PMCCYTPPIF  E           K        DISK                         S01486
     FPMCCYTPDIF  E           K        DISK                               S01486
     F** PREFIX 'QG' **      CURRENCY TOTALS
     F                                              KINFSR *PSSR
     F******PMCNTTPPIF  E           K        DISK                         S01486
     FPMCNTTPDIF  E           K        DISK                               S01486
     F** PREFIX 'QH' **      COUNTRY TOTALS
     F                                              KINFSR *PSSR
     F******PMINDTPPIF  E           K        DISK                         S01486
     FPMINDTPDIF  E           K        DISK                               S01486
     F** PREFIX 'QI' **      INDUSTRY TOTALS
     F                                              KINFSR *PSSR
     F******PMIVPEPPO   E                    DISK                         S01486
     FPMIVPEPDO   E                    DISK                               S01486
     F***PREFIX*'QV' ********EXCEPTION DETAILS                            S01486
     F** PREFIX 'GI' **      EXCEPTION DETAILS                            S01486
     F                                              KINFSR *PSSR
     F*PREFIX: P9                                                         B08040
     F*******SDPORTL0IF  E           K        DISK                  B08040S01486
     F********************************************* KINFSR *PSSR    B08040S01486
     F*****************
     F** QUERY FILE
     F*****************
     F*******PMPORTPPUF  E           K        DISK                        S01486
     FPMPORTPDUF  E           K        DISK                               S01486
     F** PREFIX 'PN'
     F                                              KINFSR *PSSR
     F******SDBANKL1IF  E           K        DISK                         S01486
     F***PREFIX*'BJ'                                                      S01486
     F********************************************* KINFSR *PSSR          S01486
     FPM0445AUO   E                    PRINTER                            R05788
     F*
     F******************************************************************
     F* ID F  C  H  L    FUNCTION OF INDICATORS                        *
     F*                                                                *
     F** PROGRAM INDICATORS
     F*
     F**  70-77 -     FILE ACCESS
     F*
     F**  U7-U8 -     DATA BASE ERROR
     F*
     F**  LR    -     END PROGRAM
     F*
     F*****************************************************************
      /COPY ZSRSRC,ZPOWERZ1
     I*
     I            DS
     I                                        1  21 ZOUT21
     I                                       21  21 WWZOUT
     I*                                                                   S01486
     ISDPLIN    E DSSDPLINPD                                              S01486
     I**  Data structure for instrument types details                     S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              S01486
     I** EXTERNAL DS FOR PORTFOLIO DETAILS                                S01486
     I*                                                                   S01486
     IPMBIPN    E DSPMBIPNPD                                              S01486
     I** EXTERNAL DS FOR DOCUMENT COMMENT CODE                            S01486
     I*                                                                   S01486
     ISDCTRY    E DSSDCTRYPD                                              S01486
     I** EXTERNAL DS FOR COUNTRY DETAILS                                  S01486
     I*                                                                   S01486
     ISDINDS    E DSSDINDSPD                                              S01486
     I** EXTERNAL DS FOR INDUSTRY DETAILS                                 S01486
     I*                                                                   S01486
     ISDBANK    E DSSDBANKPD                                              S01486
     I** EXTERNAL DS FOR BANK DETAILS                                     S01486
     I*                                                                   S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I** EXTERNAL DS FOR CURRENCY DETAILS                                 S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, LONG  DATA STRUCTURE                S01486
     I*
     ILDA        UDS                            256
     I**********                            132 183 DBLOT                 S01486
     I**********                            132 141 DBFILE                S01486
     I                                      134 183 DBLOT                 S01486
     I                                      134 141 DBFILE                S01486
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     IPSDS       SDS
     I                                      247 249 WSID
     I                                      254 263 USID
     I*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      * #P03     - CALCULATE THE AMOUNT FOR CHECKING                     *
      * #P10     - PROCESS CUSTOMER INSTRUMENT POLICY                    *
      * #P11     - PROCESS CUSTOMER CURRENCY POLICY                      *
      * #P12     - PROCESS CUSTOMER COUNTRY POLICY                       *
      * #P13     - PROCESS CUSTOMER INDUSTRY POLICY                      *
      * #P20     - PROCESS BANK INSTRUMENT POLICY                        *
      * #P21     - PROCESS BANK CURRENCY POLICY                          *
      * #P22     - PROCESS BANK COUNTRY POLICY                           *
      * #P23     - PROCESS BANK INDUSTRY POLICY                          *
      * #W01     - WRITE A RECORD TO PF/PMIVPEPP                         *
      * *PSSR    - PROCESS OF DATA BASE ERRORS                           *
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      * QCMDEXC  - SYSTEM PROGRAM USED TO OVERRIDE PRINTER FILE          *
      *                                                                  *
     C           WWK2      KLIST
     C                     KFLD           PNCNUM
     C                     KFLD           PNPTFR
     C*
     C           WWKIST    KLIST
     C                     KFLD           PNCNUM
     C                     KFLD           PNPTFR
     C                     KFLD           WWTYPE  3
     C*
     C           WWKCCY    KLIST
     C                     KFLD           PNCNUM
     C                     KFLD           PNPTFR
     C                     KFLD           WWTYPE
     C*
     C           WWKCNT    KLIST
     C                     KFLD           PNCNUM
     C                     KFLD           PNPTFR
     C                     KFLD           WWCODE  2
     C*
     C           WWKIND    KLIST
     C                     KFLD           PNCNUM
     C                     KFLD           PNPTFR
     C**********           KFLD           WWLIND  30                                          CER020
     C                     KFLD           WWLOIC  3                                           CER020
     C*
     C** *************
     C** PROGRAM START
     C** *************
     C*                                                                   R05788
     C** READ INSTALLATION CONTROL DATA                                   R05788
     C**********           READ SDBANKL1                 70        R05788 S01486
     C**********                                                   R05788 S01486
     C********** *IN70     IFEQ '1'                        ********R05788 S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*MSG   ' WWRTCD  7                       S01486
     C                     PARM '*FIRST ' WWOPTN  7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD20        DBASE            * DB ERROR 01 *R05788
     C**********           MOVEL'SDBANKL1'DBFILE           ********R05788 S01486
     C                     MOVE 'SDBANKPD'DBFILE           **DB ERROR 01**S01486
     C                     EXSR *PSSR                                     R05788
     C                     END                                            R05788
     C*                                                                   R05938
     C** OBTAIN BASE CURRENCY INFORMATION                                 R05938
     C********** BJCYCD    CHAINSDCURRL0             71            R05938 S01486
     C**********                                                   R05938 S01486
     C********** *IN71     IFEQ '1'                                R05938 S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   WWRTCD           B:Return code  S01486
     C                     PARM '*KEY'    WWOPTN           I:Option       S01486
     C                     PARM BJCYCD    WWKEY3  3        I:Key field    S01486
     C           SDCURR    PARM SDCURR    DSSDY            O:Format       S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD16        DBASE            * DB ERROR 16 *R05938
     C**********           MOVEL'SDCURRL0'DBFILE           ********R05938 S01486
     C                     MOVE 'SDCURRPD'DBFILE           ***************S01486
     C                     MOVELBJCYCD    DBKEY                           R05938
     C                     EXSR *PSSR                                     R05938
     C                     END                                            R05938
     C*                                                                   R05938
     C                     Z-ADDA6NBDP    ZCDPT                           R05938
      *                                                                   B08040
      ***READ*LF/SDPORTL0*TO*GET*THE*PORTFOLIO*MANAGEMENT*ICD      B08040 S01486
      ************                                                 B08040 S01486
     C******************** READ SDPORTL0                 83        B08040 S01486
     C********** *IN83     IFEQ '1'                        - B1    B08040 S01486
      ***READ*THE*PORTFOLIO*MANAGEMENT*ICD                                S01486
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM *BLANKS   WWRTCD  7                       S01486
     C                     PARM '*FIRST ' WWOPTN  7                       S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD24        DBASE            ***************B08040
     C******************** MOVEL'SDPORTL0'DBFILE           **DB ER**B08040S01486
     C                     MOVE 'SDPORTPD'DBFILE           **DB ERROR 24**S01486
     C                     MOVEL*BLANKS   DBKEY            ***************B08040
     C                     EXSR *PSSR                                     B08040
     C                     END                             - E1           B08040
     C*
     C***READ*FIRST*RECORD*FROM*QRYF/PMPORTPP                             S01486
     C** READ FIRST RECORD FROM QRYF/PMPORTPD                             S01486
     C                     READ PMPORTP0                 70
     C*
     C** DO WHILE NOT END OF FILE
     C           *IN70     DOWEQ'0'
     C*
     C** RESET EXCEPTION INDICATOR
     C                     MOVE 'N'       PNXPTN
     C*
     C** PROCESS SINGLE PORTFOLIO/S                                      *
     C                     EXSR #P01
     C*
     C***UPDATE*RECORD*FROM*QRYF/PMPORTPP WITH EXCEPTION INDICATOR        S01486
     C** UPDATE RECORD FROM QRYF/PMPORTPP WITH EXCEPTION INDICATOR        S01486
     C                     UPDATPMPORTP0
     C*
     C***READ*NEXT*RECORD*FROM*QRYF/PMPORTPP                              S01486
     C** READ NEXT RECORD FROM QRYF/PMPORTPD                              S01486
     C                     READ PMPORTP0                 70
     C                     END
     C*
     C** WRITE AUDIT REPORT
     C                     WRITEHEADAU
     C                     WRITEAUDIT
     C**********           WRITEENDAU                                     S01486
     C*
     C                     MOVE '1'       *INLR
     C*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - PROCESS OF DATA BASE ERRORS                           *
      * #P03     - CALCULATE THE AMOUNT FOR CHECKING                     *
      * #P10     - PROCESS CUSTOMER INSTRUMENT POLICY                    *
      * #P11     - PROCESS CUSTOMER CURRENCY POLICY                      *
      * #P12     - PROCESS CUSTOMER COUNTRY POLICY                       *
      * #P13     - PROCESS CUSTOMER INDUSTRY POLICY                      *
      * #P20     - PROCESS BANK INSTRUMENT POLICY                        *
      * #P21     - PROCESS BANK CURRENCY POLICY                          *
      * #P22     - PROCESS BANK COUNTRY POLICY                           *
      * #P23     - PROCESS BANK INDUSTRY POLICY                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P01      BEGSR
     C*
     C** CALCULATE THE AMOUNT FOR CHECKING
     C                     EXSR #P03
     C*
     C** PROCESS CALCULATIONS AND OUTPUT RESULTS
     C           PNIPIN    IFEQ 'Y'
     C**********           MOVE '1'       QVPCOD                          S01486
     C                     MOVE '1'       GIPCOD                          S01486
     C                     EXSR #P10
     C                     END
     C*
     C           PNCYIN    IFEQ 'Y'
     C**********           MOVE '2'       QVPCOD                          S01486
     C                     MOVE '2'       GIPCOD                          S01486
     C                     EXSR #P11
     C                     END
     C*
     C           PNYPIN    IFEQ 'Y'
     C**********           MOVE '3'       QVPCOD                          S01486
     C                     MOVE '3'       GIPCOD                          S01486
     C                     EXSR #P12
     C                     END
     C*
     C           PNNPIN    IFEQ 'Y'
     C**********           MOVE '4'       QVPCOD                          S01486
     C                     MOVE '4'       GIPCOD                          S01486
     C                     EXSR #P13
     C                     END
     C*
     C** IF INVESTMENT POLICY CODE IS NOT BLANK
     C           PNPOLC    IFNE *BLANKS
     C********** PNPOLC    CHAINPMBIPNPP             70                   S01486
     C**********                                                          S01486
     C********** *IN70     IFEQ '1'                                       S01486
     C                     CALL 'AOBIPNR0'                                S01486
     C                     PARM *BLANKS   WWRTCD                          S01486
     C                     PARM '*KEY   ' WWOPTN                          S01486
     C                     PARM PNPOLC    WWPOLC  2                       S01486
     C           PMBIPN    PARM PMBIPN    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD1         DBASE            * DB ERROR 01 *
     C**********           MOVEL'PMBIPNPP'DBFILE           ***************S01486
     C                     MOVE 'PMBIPNPD'DBFILE           ***************S01486
     C                     MOVELPSPOLC    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C           PSIPIN    IFEQ 'Y'
     C**********           MOVE '1'       QVPCOD                          S01486
     C                     MOVE '1'       GIPCOD                          S01486
     C                     EXSR #P20
     C                     END
     C*
     C           PSCYIN    IFEQ 'Y'
     C**********           MOVE '2'       QVPCOD                          S01486
     C                     MOVE '2'       GIPCOD                          S01486
     C                     EXSR #P21
     C                     END
     C*
     C           PSYPIN    IFEQ 'Y'
     C**********           MOVE '3'       QVPCOD                          S01486
     C                     MOVE '3'       GIPCOD                          S01486
     C                     EXSR #P22
     C                     END
     C*
     C           PSNPIN    IFEQ 'Y'
     C**********           MOVE '4'       QVPCOD                          S01486
     C                     MOVE '4'       GIPCOD                          S01486
     C                     EXSR #P23
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR                           * #P01
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #W01     - WRITE A RECORD TO PF/PMIVPEPP                         *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P10     - PROCESS CUSTOMER INSTRUMENT POLICY                    *
      * #P11     - PROCESS CUSTOMER CURRENCY POLICY                      *
      * #P12     - PROCESS CUSTOMER COUNTRY POLICY                       *
      * #P13     - PROCESS CUSTOMER INDUSTRY POLICY                      *
      * #P20     - PROCESS BANK INSTRUMENT POLICY                        *
      * #P21     - PROCESS BANK CURRENCY POLICY                          *
      * #P22     - PROCESS BANK COUNTRY POLICY                           *
      * #P23     - PROCESS BANK INDUSTRY POLICY                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWACTR   - ACTUAL RATE CALCULATION
      *                                                                  *
      ********************************************************************
     C           #P02      BEGSR
     C*
     C**********           MOVE 'N'       QVXPTN                          S01486
     C**********           Z-ADD0         QVXAMT                    R0113 S01486
     C                     MOVE 'N'       GIXPTN                          S01486
     C                     Z-ADD0         GIXAMT                          S01486
     C*
     C** CALCULATE ACTUAL RANGE
     C********** QVCAMT    IFNE 0                          - B1           S01486
     C           GICAMT    IFNE 0                          - B1
     C***********QVIAMT****DIV  QVCAMT    WWACTR 157H                     R0107
     C***********WWACTR****MULT 100       QVACTR    H                     R0107
     C***********QVIAMT    DIV  QVCAMT    WWACTR 157                      R0107
     C***********WWACTR    MULT 100       WWACTR                          R0107
     C***********          Z-ADDWWACTR    QVACTR                          R05860
     C********** QVIAMT    DIV  QVCAMT    WWACTR 157H              R05860 S01486
     C********** WWACTR    MULT 100       QVACTR    H              R05860 S01486
     C           GIIAMT    DIV  GICAMT    WWACTR 157H                     S01486
     C********** WWACTR    MULT 100       GIACTR    H               S01486107047
     C                     Z-ADDWWACTR    W1ACTR 157H                     107047
     C* TAKE ALWAYS THE ABSOLUTE VALUE FROM ACTUAL PERCENTAGE             107047
     C           WWACTR    IFLT 0                                         107047
     C                     Z-SUBWWACTR    WWACTR                          107047
     C                     END                                            107047
     C           W1ACTR    MULT 100       GIACTR    H                     107047
     C*
     C** SET EXCEPTION INDICATOR TO 'Y' IF ACTUAL RANGE
     C** IS LESS THAN MINIMUM OR GREATER THAN MAXIMUM RANGE
     C* TAKE ALWAYS THE ABSOLUTE VALUE FROM ACTUAL PERCENTAGE             103048
     C********** QVACTR    IFLT QVMINR                     - B2           S01486
     C********** QVACTR    ORGT QVMAXR                                    S01486
     C********** QVMINR    ANDNE100                                       S01486
     C********** GIACTR    IFLT GIMINR                     - B2     S01486103048
     C********** GIACTR    ORGT GIMAXR                              S01486103048
     C           GIACTR    IFLT 0                                         103048
     C                     Z-SUBGIACTR    ABACTR  41                      103048
     C                     ELSE                                           103048
     C                     Z-ADDGIACTR    ABACTR                          103048
     C                     END                                            103048
     C           ABACTR    IFLT GIMINR                     - B2           103048
     C           ABACTR    ORGT GIMAXR                                    103048
     C           GIMINR    ANDNE100                                       S01486
     C**********           MOVE 'Y'       QVXPTN                          S01486
     C                     MOVE 'Y'       GIXPTN                          S01486
     C                     MOVE 'Y'       PNXPTN
     C**                                                                  R0113
     C** COMPUTE EXCEPTION AMOUNT                                         R0113
     C**                                                                  R0113
     C                     Z-ADD0         WWMINR 157                      R0113
     C                     Z-ADD0         WWMAXR 157                      R0113
     C*                                                                   R05938
     C** CALCULATE EXCEPTION PERCENTAGE AND AMOUNT IF *LT MINIMUM RANGE   R05938
     C********** QVACTR    IFLT QVMINR                     B3      R05938 S01486
     C********** QVMINR    DIV  100       WWRANG 157                      S01486
     C********** GIACTR    IFLT GIMINR                     B3      S01486 103048
     C           ABACTR    IFLT GIMINR                     B3             103048
     C           GIMINR    DIV  100       WWRANG 157                      S01486
     C           WWACTR    SUB  WWRANG    WWMINR                          R05938
     C*                                                                   R05938
     C********** QVMINR    IFEQ 0                          B4      R05938 S01486
     C**********           Z-ADDQVIAMT    QVXAMT                   R05938 S01486
     C           GIMINR    IFEQ 0                          B4             S01486
     C                     Z-ADDGIIAMT    GIXAMT                          S01486
     C                     ELSE                            X4             R05938
     C********** QVCAMT    MULT WWMINR    QVXAMT                   R05938 S01486
     C           GICAMT    MULT WWMINR    GIXAMT                          S01486
     C                     END                             E4             R05938
     C*                                                                   R05938
     C                     END                             E3             R05938
     C*                                                                   R05938
     C** CALCULATE EXCEPTION PERCENTAGE AND AMOUNT IF *GT MAXIMUM RANGE   R05938
     C********** QVACTR    IFGT QVMAXR                     B3      R05938 S01486
     C********** QVMINR    ANDNE100                                R05938 S01486
     C********** GIACTR    IFGT GIMAXR                     B3      S01486 103048
     C           ABACTR    IFGT GIMAXR                     B3             103048
     C           GIMINR    ANDNE100                                       S01486
     C*                                                                   R05938
     C********** QVMAXR    IFEQ 100                        B4      R05938 S01486
     C********** QVIAMT    SUB  QVCAMT    QVXAMT                   R05938 S01486
     C           GIMAXR    IFEQ 100                        B4             S01486
     C           GIIAMT    SUB  GICAMT    GIXAMT                          S01486
     C                     ELSE                            X4             R05938
     C********** QVMAXR    DIV  100       WWRANG                          S01486
     C           GIMAXR    DIV  100       WWRANG                          S01486
     C           WWACTR    SUB  WWRANG    WWMAXR                          R05938
     C********** QVCAMT    MULT WWMAXR    QVXAMT                   R05938 S01486
     C           GICAMT    MULT WWMAXR    GIXAMT                          S01486
     C                     END                             E4             R05938
     C**                                                                  R05938
     C                     END                             E3             R05938
     C**                                                                  R05938
     C                     END                             E2             R05938
     C*
     C                     ELSE                            X1
     C*
     C********** QVIAMT    IFEQ 0                          - B2           S01486
     C**********           Z-ADD0         QVACTR                          S01486
     C**********           Z-ADD0         QVXAMT                    R0113 S01486
     C           GIIAMT    IFEQ 0                          - B2           S01486
     C                     Z-ADD0         ABACTR                          107047
     C                     Z-ADD0         GIACTR                          S01486
     C                     Z-ADD0         GIXAMT                          S01486
     C                     ELSE
     C**********           Z-SUB999.9     QVACTR                          S01486
     C**********           MOVE 'Y'       QVXPTN                          S01486
     C                     Z-SUB999.9     ABACTR                          107047
     C                     Z-SUB999.9     GIACTR                          S01486
     C                     MOVE 'Y'       GIXPTN                          S01486
     C                     MOVE 'Y'       PNXPTN
     C**********           Z-ADDQVIAMT    QVXAMT                    R0113 S01486
     C                     Z-ADDGIIAMT    GIXAMT                          S01486
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*                                                                   R05938
     C** CONVERT EXCEPTION AMOUNT FROM PORTFOLIO CURRENCY TO BASE         R05938
     C** CURRENCY FOR ACCOUNTING                                          R05938
     C********** QVXPTN    IFEQ 'Y'                        B1      R05938 S01486
     C           GIXPTN    IFEQ 'Y'                        B1             S01486
     C           BJCYCD    IFNE PNPTCY                                    R05938
 1   C********** PNPTCY    CHAINSDCURRL0             71            R05938 S01486
     C**********                                                   R05938 S01486
     C********** *IN71     IFEQ '1'                                R05938 S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   WWRTCD           B:Return code  S01486
     C                     PARM '*KEY'    WWOPTN           I:Option       S01486
     C                     PARM PNPTCY    WWKEY3  3        I:Key field    S01486
     C           SDCURR    PARM SDCURR    DSSDY            O:Format       S01486
     C***********WWRTCD    IFEQ *BLANKS                             S01486S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD15        DBASE            * DB ERROR 15 *R05938
     C**********           MOVEL'SDCURRL0'DBFILE           ********R05938 S01486
     C                     MOVE 'SDCURRPD'DBFILE           ***************S01486
     C                     MOVELPNPTCY    DBKEY                           R05938
     C                     EXSR *PSSR                                     R05938
     C                     END                                            R05938
     C*                                                                   R05938
     C**********           Z-ADDQVXAMT    ZAMTF                    R05938 S01486
     C                     Z-ADDGIXAMT    ZAMTF                           S01486
     C                     Z-ADDA6NBDP    ZCDPF                           R05938
     C                     Z-ADDA6SPRT    ZCRSRT                          R05938
     C                     MOVE A6MDIN    ZCRSMD                          R05938
     C                     EXSR ZCCYXR                                    R05938
     C**********           Z-ADDZAMTT     QVXAMT                   R05938 S01486
     C                     Z-ADDZAMTT     GIXAMT                          S01486
     C                     END                                            R05938
     C                     END                                            R05927
     C*                                                                   R05938
     C** WRITE A RECORD TO PF/PMIVPEPP
     C                     EXSR #W01
     C**********           Z-ADD0         QVIAMT                          S01486
     C**********           MOVE *BLANKS   QVGCOD                          S01486
     C**********           MOVE *BLANKS   QVICOD                          S01486
     C                     Z-ADD0         GIIAMT                          S01486
     C                     MOVE *BLANKS   GIGCOD                          S01486
     C                     MOVE *BLANKS   GIICOD                          S01486
     C*
     C                     ENDSR                           * #P02
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P03     - CALCULATE THE AMOUNT FOR CHECKING                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WW1CHK   - INSTRUMENT/CURRENCY AMOUNT FOR CHECKING
      * WWSCHK   - SECURITY AMOUNT FOR CHECKING
      *                                                                  *
      ********************************************************************
     C           #P03      BEGSR
     C*
     C********** WWK2      CHAINPMPOTTPP             70                   S01486
     C           WWK2      CHAINPMPOTTPD             70                   S01486
     C*
     C** SET AMOUNTS FOR CHECKING
     C           *IN70     IFEQ '0'
     C*
     C** USE TRADE OR VALUE DATE TOTALS AS APPROPRIATE                    B08040
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C           QCPTPA    SUB  QCPTNA    WW1CHK
     C                     SUB  QCPTMV    WW1CHK
     C                     ADD  QCPTAI    WW1CHK
     C                     ADD  QCPTNI    WW1CHK                          102189
     C******     QCPTMS    ADD  QCTAIS    WWSCHK                          B07823
     C                     ELSE                                           B08040
     C           QCPVPA    SUB  QCPVNA    WW1CHK                          B08040
     C                     SUB  QCPVMV    WW1CHK                          B08040
     C*******              ADD  QCPVAI    WW1CHK                          B08040
     C                     ADD  QCPTAI    WW1CHK                          B08040
     C                     ADD  QCPTNI    WW1CHK                          102189
     C                     END                                            B08040
     C*                                                                   B08040
     C                     ELSE
     C                     Z-ADD0         WW1CHK 150
     C******               Z-ADD0         WWSCHK 150                      B07823
     C                     END
     C*                                                                   102189
     C*MUST TAKE THE INTEREST IN FOWARD POSITIONS                         102189
     C*                                                                   102189
     C                     MOVEL'FW'      WVGCOD  2                       102189
     C           WVGCOD    SETLLPMPGDIPD                                  102189
     C           WVGCOD    READEPMPGDIPD               7171               102189
     C*                                                                   102189
     C           *IN71     DOWEQ'0'                        - B3           102189
     C                     MOVELGBINNR    WWTYPE                          102189
     C           WWKIST    CHAINPMISTTL0             72                   102189
     C*                                                                   102189
     C           *IN72     IFEQ '0'                                       102189
     C           FCTVPS    IFEQ 'T'                                       102189
     C                     SUB  QEPTNA    WW1CHK                          102189
     C                     ELSE                                           102189
     C                     SUB  QEPVNA    WW1CHK                          102189
     C                     END                                            102189
     C                     END                                            102189
     C           WVGCOD    READEPMPGDIPD               7171               102189
     C*                                                                   102189
     C                     ENDDO                                          102189
     C*
     C                     ENDSR                           * #P03
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10     - PROCESS CUSTOMER INSTRUMENT POLICY                    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WW1CHK   - INSTRUMENT/CURRENCY AMOUNT FOR CHECKING
      * WWTYPE   - KEY FIELD FOR INSTRUMENT AND CURRENCY
      *                                                                  *
      ********************************************************************
     C           #P10      BEGSR
     C*
     C**********           Z-ADDWW1CHK    QVCAMT                          S01486
     C                     Z-ADDWW1CHK    GICAMT                          S01486
     C           WWK2      SETLLPMCIIPLL
     C           WWK2      READEPMCIIPLL               7070
     C*
     C** ACCESS INSTRUMENT GROUPS/TYPES FOR CUSTOMER + PORTFOLIO
     C           *IN70     DOWEQ'0'                        - B1
     C**********           Z-ADDPYMINR    QVMINR                          S01486
     C**********           Z-ADDPYMAXR    QVMAXR                          S01486
     C                     Z-ADDPYMINR    GIMINR                          S01486
     C                     Z-ADDPYMAXR    GIMAXR                          S01486
     C*
     C** ACCESS INSTRUMENT GROUP DETAILS
     C           PYINTG    IFNE *BLANKS                    - B2
     C********** PYINTG    CHAINPMPGHIPP             71                   S01486
     C           PYINTG    CHAINPMPGHIPD             71                   S01486
     C*
     C           *IN71     IFEQ '1'
     C                     Z-ADD2         DBASE            * DB ERROR 02 *
     C**********           MOVEL'PMPGHIPP'DBFILE           ***************S01486
     C                     MOVE 'PMPGHIPD'DBFILE           ***************S01486
     C                     MOVELPYINTG    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE PFINGN    QVINAR                          S01486
     C**********           MOVELPYINTG    QVGCOD                          S01486
     C                     MOVE PFINGN    GIINAR                          S01486
     C                     MOVELPYINTG    GIGCOD                          S01486
     C********** PYINTG    SETLLPMPGDIPP                                  S01486
     C********** PYINTG    READEPMPGDIPP               7171               S01486
     C           PYINTG    SETLLPMPGDIPD                                  S01486
     C           PYINTG    READEPMPGDIPD               7171               S01486
     C*
     C           *IN71     DOWEQ'0'                        - B3
     C**********           MOVELPGINNR    WWTYPE                          S01486
     C                     MOVELGBINNR    WWTYPE                          S01486
     C           WWKIST    CHAINPMISTTL0             72
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QEPTPA    QVIAMT                          S01486
     C**********           SUB  QEPTNA    QVIAMT                          S01486
     C**********           SUB  QEPTMV    QVIAMT                          S01486
     C**********           ADD  QEPTAI    QVIAMT                          S01486
     C                     ADD  QEPTPA    GIIAMT                          S01486
     C                     SUB  QEPTNA    GIIAMT                          S01486
     C                     SUB  QEPTMV    GIIAMT                          S01486
     C                     ADD  QEPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QEPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QEPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QEPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QEPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QEPVPA    GIIAMT                          S01486
     C                     SUB  QEPVNA    GIIAMT                          S01486
     C                     SUB  QEPVMV    GIIAMT                          S01486
     C                     ADD  QEPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C********** PYINTG    READEPMPGDIPP               7171               S01486
     C           PYINTG    READEPMPGDIPD               7171               S01486
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C** ACCESS INSTRUMENT TYPE DETAILS
     C           PYINNR    IFNE *BLANKS                    - B2
     C********** PYINNR    CHAINSDPLINPD             71                   S01486
     C*                                                                   S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM *BLANKS   WLRTCD  7                       S01486
     C                     PARM '*KEY  '  WLOPTN  7                       S01486
     C                     PARM PYINNR    WLINNR  3                       S01486
     C           SDPLIN    PARM SDPLIN    DSSDY                           S01486
     C*
     C********** *IN71     IFEQ '1'                                       S01486
     C           WLRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD3         DBASE            * DB ERROR 03 *
     C**********           MOVEL'SDPLINPD'DBFILE           ***************S01486
     C                     MOVE 'SDPLINPD'DBFILE                          S01486
     C                     MOVELPYINNR    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVELPDISTN    QVINAR                          S01486
     C**********           MOVELPYINNR    QVICOD                          S01486
     C                     MOVELPDISTN    GIINAR                          S01486
     C                     MOVELPYINNR    GIICOD                          S01486
     C                     MOVELPYINNR    WWTYPE
     C           WWKIST    CHAINPMISTTL0             72
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QEPTPA    QVIAMT                          S01486
     C**********           SUB  QEPTNA    QVIAMT                          S01486
     C**********           SUB  QEPTMV    QVIAMT                          S01486
     C**********           ADD  QEPTAI    QVIAMT                          S01486
     C                     ADD  QEPTPA    GIIAMT                          S01486
     C                     SUB  QEPTNA    GIIAMT                          S01486
     C                     SUB  QEPTMV    GIIAMT                          S01486
     C                     ADD  QEPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QEPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QEPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QEPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QEPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QEPVPA    GIIAMT                          S01486
     C                     SUB  QEPVNA    GIIAMT                          S01486
     C                     SUB  QEPVMV    GIIAMT                          S01486
     C                     ADD  QEPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C                     END                             - E2
     C*
     C                     EXSR #P02
     C           WWK2      READEPMCIIPLL               7070
     C                     END                             - E1
     C*
     C                     ENDSR                           * #P10
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P11     - PROCESS CUSTOMER CURRENCY POLICY                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WW1CHK   - CURRENCY AMOUNT FOR CHECKING
      * WWTYPE   - KEY FIELD FOR INSTRUMENT AND CURRENCY
      *                                                                  *
      ********************************************************************
     C           #P11      BEGSR
     C*
     C**********           Z-ADDWW1CHK    QVCAMT                          S01486
     C                     Z-ADDWW1CHK    GICAMT                          S01486
     C           WWK2      SETLLPMCCIPLL
     C           WWK2      READEPMCCIPLL               7070
     C*
     C** ACCESS CURRENCY GROUPS/TYPES FOR CUSTOMER + PORTFOLIO
     C           *IN70     DOWEQ'0'                        - B1
     C**********           Z-ADDPZMINR    QVMINR                          S01486
     C**********           Z-ADDPZMAXR    QVMAXR                          S01486
     C                     Z-ADDPZMINR    GIMINR                          S01486
     C                     Z-ADDPZMAXR    GIMAXR                          S01486
     C*
     C** ACCESS CURRENCY GROUP DETAILS
     C           PZCCYG    IFNE *BLANKS                    - B2
     C********** PZCCYG    CHAINPMPGHCPP             71                   S01486
     C           PZCCYG    CHAINPMPGHCPD             71                   S01486
     C*
     C           *IN71     IFEQ '1'
     C                     Z-ADD4         DBASE            * DB ERROR 04 *
     C**********           MOVEL'PMPGHCPP'DBFILE           ***************S01486
     C                     MOVE 'PMPGHCPD'DBFILE           ***************S01486
     C                     MOVELPZCCYG    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE *BLANKS   QVINAR                          S01486
     C**********           MOVE PHCCGN    QVINAR                          S01486
     C**********           MOVELPZCCYG    QVGCOD                          S01486
     C                     MOVE *BLANKS   GIINAR                          S01486
     C                     MOVE PHCCGN    GIINAR                          S01486
     C                     MOVELPZCCYG    GIGCOD                          S01486
     C********** PZCCYG    SETLLPMPGDCPP                                  S01486
     C********** PZCCYG    READEPMPGDCPP               7171               S01486
     C           PZCCYG    SETLLPMPGDCPD                                  S01486
     C           PZCCYG    READEPMPGDCPD               7171               S01486
     C*
     C           *IN71     DOWEQ'0'                        - B3
     C                     MOVELPICCY     WWTYPE
     C********** WWKCCY    CHAINPMCCYTPP             72                   S01486
     C           WWKCCY    CHAINPMCCYTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                 B08040S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QGPTPA    QVIAMT                          S01486
     C**********           SUB  QGPTNA    QVIAMT                          S01486
     C**********           SUB  QGPTMV    QVIAMT                          S01486
     C**********           ADD  QGPTAI    QVIAMT                          S01486
     C                     ADD  QGPTPA    GIIAMT                          S01486
     C                     SUB  QGPTNA    GIIAMT                          S01486
     C                     SUB  QGPTMV    GIIAMT                          S01486
     C                     ADD  QGPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QGPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QGPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QGPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QGPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QGPVPA    GIIAMT                          S01486
     C                     SUB  QGPVNA    GIIAMT                          S01486
     C                     SUB  QGPVMV    GIIAMT                          S01486
     C                     ADD  QGPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END                                            B08040
     C*
     C********** PZCCYG    READEPMPGDCPP               7171               S01486
     C           PZCCYG    READEPMPGDCPD               7171               S01486
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C** ACCESS CURRENCY TYPE DETAILS
     C           PZCCY     IFNE *BLANKS                    - B2
     C********** PZCCY     CHAINSDCURRL0             71                   S01486
     C**********                                                          S01486
     C********** *IN71     IFEQ '1'                                       S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   WWRTCD           B:Return code  S01486
     C                     PARM '*KEY'    WWOPTN           I:Option       S01486
     C                     PARM PZCCY     WWKEY3  3        I:Key field    S01486
     C           SDCURR    PARM SDCURR    DSSDY            O:Format       S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD5         DBASE            * DB ERROR 05 *
     C**********           MOVEL'SDCURRL0'DBFILE           ***************S01486
     C                     MOVE 'SDCURRPD'DBFILE           ***************S01486
     C                     MOVELPZCCY     DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE *BLANKS   QVINAR                          S01486
     C**********           MOVELA6CYNM    QVINAR                          S01486
     C**********           MOVELPZCCY     QVICOD                          S01486
     C                     MOVE *BLANKS   GIINAR                          S01486
     C                     MOVELA6CYNM    GIINAR                          S01486
     C                     MOVELPZCCY     GIICOD                          S01486
     C                     MOVELPZCCY     WWTYPE
     C********** WWKCCY    CHAINPMCCYTPP             72                   S01486
     C           WWKCCY    CHAINPMCCYTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QGPTPA    QVIAMT                          S01486
     C**********           SUB  QGPTNA    QVIAMT                          S01486
     C**********           SUB  QGPTMV    QVIAMT                          S01486
     C**********           ADD  QGPTAI    QVIAMT                          S01486
     C                     ADD  QGPTPA    GIIAMT                          S01486
     C                     SUB  QGPTNA    GIIAMT                          S01486
     C                     SUB  QGPTMV    GIIAMT                          S01486
     C                     ADD  QGPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QGPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QGPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QGPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QGPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QGPVPA    GIIAMT                          S01486
     C                     SUB  QGPVNA    GIIAMT                          S01486
     C                     SUB  QGPVMV    GIIAMT                          S01486
     C                     ADD  QGPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C                     END                             - E2
     C*
     C                     EXSR #P02
     C           WWK2      READEPMCCIPLL               7070
     C                     END                             - E1
     C*
     C                     ENDSR                           * #P11
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P12     - PROCESS CUSTOMER COUNTRY POLICY                       *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSCHK   - SECURITY AMOUNT FOR CHECKING
      * WWCODE   - KEY FIELD FOR COUNTRY
      *                                                                  *
      ********************************************************************
     C           #P12      BEGSR
     C*
     C***********          Z-ADDWWSCHK    QVCAMT                          B07823
     C**********           Z-ADDWW1CHK    QVCAMT                   B07823 S01486
     C                     Z-ADDWW1CHK    GICAMT                          S01486
     C           WWK2      SETLLPMCRIPLL
     C           WWK2      READEPMCRIPLL               7070
     C*
     C** ACCESS COUNTRY GROUPS/TYPES FOR CUSTOMER + PORTFOLIO
     C           *IN70     DOWEQ'0'                        - B1
     C**********           Z-ADDP2MINR    QVMINR                          S01486
     C**********           Z-ADDP2MAXR    QVMAXR                          S01486
     C                     Z-ADDP2MINR    GIMINR                          S01486
     C                     Z-ADDP2MAXR    GIMAXR                          S01486
     C*
     C** ACCESS COUNTRY GROUP DETAILS
     C           P2CCDG    IFNE *BLANKS                    - B2
     C********** P2CCDG    CHAINPMPGHRPP             71                   S01486
     C           P2CCDG    CHAINPMPGHRPD             71                   S01486
     C*
     C           *IN71     IFEQ '1'
     C                     Z-ADD6         DBASE            * DB ERROR 06 *
     C**********           MOVEL'PMPGHRPP'DBFILE           ***************S01486
     C                     MOVE 'PMPGHRPD'DBFILE           ***************S01486
     C                     MOVELP2CCDG    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE PJCOGN    QVINAR                          S01486
     C**********           MOVELP2CCDG    QVGCOD                          S01486
     C                     MOVE PJCOGN    GIINAR                          S01486
     C                     MOVELP2CCDG    GIGCOD                          S01486
     C********** P2CCDG    SETLLPMPGDRPP                                  S01486
     C********** P2CCDG    READEPMPGDRPP               7171               S01486
     C           P2CCDG    SETLLPMPGDRPD                                  S01486
     C           P2CCDG    READEPMPGDRPD               7171               S01486
     C*
     C           *IN71     DOWEQ'0'                        - B3
     C                     MOVELPKCCOD    WWCODE
     C********** WWKCNT    CHAINPMCNTTPP             72                   S01486
     C           WWKCNT    CHAINPMCNTTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QHPTPA    QVIAMT                          S01486
     C**********           SUB  QHPTNA    QVIAMT                          S01486
     C**********           SUB  QHPTMV    QVIAMT                          S01486
     C**********           ADD  QHPTAI    QVIAMT                          S01486
     C                     ADD  QHPTPA    GIIAMT                          S01486
     C                     SUB  QHPTNA    GIIAMT                          S01486
     C                     SUB  QHPTMV    GIIAMT                          S01486
     C                     ADD  QHPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QHPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QHPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QHPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QHPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QHPVPA    GIIAMT                          S01486
     C                     SUB  QHPVNA    GIIAMT                          S01486
     C                     SUB  QHPVMV    GIIAMT                          S01486
     C                     ADD  QHPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C********** P2CCDG    READEPMPGDRPP               7171               S01486
     C           P2CCDG    READEPMPGDRPD               7171               S01486
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C** ACCESS COUNTRY TYPE DETAILS
     C           P2CCOD    IFNE *BLANKS                    - B2
     C********** P2CCOD    CHAINSDCTRYL1             71                   S01486
     C*
     C********** *IN71     IFEQ '1'                                       S01486
     C                     CALL 'AOCTRYR0'                                S01486
     C                     PARM *BLANKS   WWRTCD                          S01486
     C                     PARM '*KEY'    WWOPTN                          S01486
     C                     PARM P2CCOD    P@KEY2  2                       S01486
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD7         DBASE            * DB ERROR 07 *
     C**********           MOVEL'SDCTRYL1'DBFILE           ***************S01486
     C                     MOVE 'SDCTRYPD'DBFILE           ***************S01486
     C                     MOVELP2CCOD    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVELA4CNNM    QVINAR                          S01486
     C**********           MOVELP2CCOD    QVICOD                          S01486
     C                     MOVELA4CNNM    GIINAR                          S01486
     C                     MOVELP2CCOD    GIICOD                          S01486
     C                     MOVELP2CCOD    WWCODE
     C********** WWKCNT    CHAINPMCNTTPP             72                   S01486
     C           WWKCNT    CHAINPMCNTTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QHPTPA    QVIAMT                          S01486
     C**********           SUB  QHPTNA    QVIAMT                          S01486
     C**********           SUB  QHPTMV    QVIAMT                          S01486
     C**********           ADD  QHPTAI    QVIAMT                          S01486
     C                     ADD  QHPTPA    GIIAMT                          S01486
     C                     SUB  QHPTNA    GIIAMT                          S01486
     C                     SUB  QHPTMV    GIIAMT                          S01486
     C                     ADD  QHPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QHPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QHPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QHPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QHPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QHPVPA    GIIAMT                          S01486
     C                     SUB  QHPVNA    GIIAMT                          S01486
     C                     SUB  QHPVMV    GIIAMT                          S01486
     C                     ADD  QHPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C                     END                             - E2
     C*
     C                     EXSR #P02
     C           WWK2      READEPMCRIPLL               7070
     C                     END                             - E1
     C*
     C                     ENDSR                           * #P12
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P13     - PROCESS CUSTOMER INDUSTRY POLICY                       *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSCHK   - SECURITY AMOUNT FOR CHECKING
      * WWLIND   - KEY FIELD FOR INDUSTRY
      *                                                                  *
      ********************************************************************
     C           #P13      BEGSR
     C*
     C***********          Z-ADDWWSCHK    QVCAMT                          B07823
     C**********           Z-ADDWW1CHK    QVCAMT                   B07823 S01486
     C                     Z-ADDWW1CHK    GICAMT                          S01486
     C           WWK2      SETLLPMCDIPLL
     C           WWK2      READEPMCDIPLL               7070
     C*
     C** ACCESS INDUSTRY GROUPS/TYPES FOR CUSTOMER + PORTFOLIO
     C           *IN70     DOWEQ'0'                        - B1
     C**********           Z-ADDP1MINR    QVMINR                          S01486
     C**********           Z-ADDP1MAXR    QVMAXR                          S01486
     C                     Z-ADDP1MINR    GIMINR                          S01486
     C                     Z-ADDP1MAXR    GIMAXR                          S01486
     C*
     C** ACCESS INDUSTRY GROUP DETAILS
     C           P1LING    IFNE *BLANKS                    - B2
     C********** P1LING    CHAINPMPGHDPP             71                   S01486
     C           P1LING    CHAINPMPGHDPD             71                   S01486
     C*
     C           *IN71     IFEQ '1'
     C                     Z-ADD8         DBASE            * DB ERROR 08 *
     C**********           MOVEL'PMPGHDPP'DBFILE           ***************S01486
     C                     MOVE 'PMPGHDPD'DBFILE           ***************S01486
     C                     MOVELP1LING    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE PLLING    QVINAR                          S01486
     C**********           MOVELP1LING    QVGCOD                          S01486
     C**********           MOVE PLLING    GIINAR                    S01486096563
     C                     MOVE PLLINN    GIINAR                          096563
     C                     MOVELP1LING    GIGCOD                          S01486
     C********** P1LING    SETLLPMPGDDPP                                  S01486
     C********** P1LING    READEPMPGDDPP               7171               S01486
     C           P1LING    SETLLPMPGDDPD                                  S01486
     C           P1LING    READEPMPGDDPD               7171               S01486
     C*
     C           *IN71     DOWEQ'0'                        - B3
     C**********           MOVELPMLIND    WWLIND                                              CER020
     C                     MOVELPMLOIC    WWLOIC                                              CER020
     C********** WWKIND    CHAINPMINDTPP             72                   S01486
     C           WWKIND    CHAINPMINDTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QIPTPA    QVIAMT                          S01486
     C**********           SUB  QIPTNA    QVIAMT                          S01486
     C**********           SUB  QIPTMV    QVIAMT                          S01486
     C**********           ADD  QIPTAI    QVIAMT                          S01486
     C                     ADD  QIPTPA    GIIAMT                          S01486
     C                     SUB  QIPTNA    GIIAMT                          S01486
     C                     SUB  QIPTMV    GIIAMT                          S01486
     C                     ADD  QIPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QIPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QIPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QIPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QIPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QIPVPA    GIIAMT                          S01486
     C                     SUB  QIPVNA    GIIAMT                          S01486
     C                     SUB  QIPVMV    GIIAMT                          S01486
     C                     ADD  QIPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C********** P1LING    READEPMPGDDPP               7171               S01486
     C           P1LING    READEPMPGDDPD               7171               S01486
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C** ACCESS INDUSTRY TYPE DETAILS
     C********** P1LIND    IFNE 0                          - B2                               CER020
     C**********           MOVE P1LIND    AOLICD                                              CER020
     C           P1LOIC    IFNE *BLANKS                                                       CER020
     C                     MOVE P1LOIC    AOLICD                                              CER020
1    C********** AOLICD    CHAINSDINDSL1             71                   S01486
     C**********                                                          S01486
     C********** *IN71     IFEQ '1'                                       S01486
     C                     CALL 'AOINDSR0'                                S01486
     C                     PARM *BLANKS   WWRTCD                          S01486
     C                     PARM '*KEY'    WWOPTN                          S01486
     C                     PARM AOLICD    WWKEY3  3                       S01486
     C           SDINDS    PARM SDINDS    DSSDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD9         DBASE            * DB ERROR 09 *
     C**********           MOVEL'SDINDSL1'DBFILE           ***************S01486
     C                     MOVE 'SDINDSPD'DBFILE           ***************S01486
     C**********           MOVELP1LIND    DBKEY                                               CER020
     C                     MOVELP1LOIC    DBKEY                                               CER020
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVELAOLINA    QVINAR                          S01486
     C**********           MOVELP1LIND    QVICOD                          S01486
     C                     MOVELAOLINA    GIINAR                          S01486
     C**********           MOVELP1LIND    GIICOD                                       S01486 CER020
     C**********           MOVELP1LIND    WWLIND                                              CER020
     C                     MOVELP1LOIC    GIICOD                                              CER020
     C                     MOVELP1LOIC    WWLOIC                                              CER020
     C********** WWKIND    CHAINPMINDTPP             72                   S01486
     C           WWKIND    CHAINPMINDTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QIPTPA    QVIAMT                          S01486
     C**********           SUB  QIPTNA    QVIAMT                          S01486
     C**********           SUB  QIPTMV    QVIAMT                          S01486
     C**********           ADD  QIPTAI    QVIAMT                          S01486
     C                     ADD  QIPTPA    GIIAMT                          S01486
     C                     SUB  QIPTNA    GIIAMT                          S01486
     C                     SUB  QIPTMV    GIIAMT                          S01486
     C                     ADD  QIPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QIPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QIPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QIPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QIPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QIPVPA    GIIAMT                          S01486
     C                     SUB  QIPVNA    GIIAMT                          S01486
     C                     SUB  QIPVMV    GIIAMT                          S01486
     C                     ADD  QIPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C                     END                             - E2
     C*
     C                     EXSR #P02
     C           WWK2      READEPMCDIPLL               7070
     C                     END                             - E1
     C*
     C                     ENDSR                           * #P13
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P20     - PROCESS BANK INSTRUMENT POLICY                        *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WW1CHK   - INSTRUMENT/CURRENCY AMOUNT FOR CHECKING
      * WWTYPE   - KEY FIELD FOR INSTRUMENT AND CURRENCY
      *                                                                  *
      ********************************************************************
     C           #P20      BEGSR
     C*
     C**********           Z-ADDWW1CHK    QVCAMT                          S01486
     C                     Z-ADDWW1CHK    GICAMT                          S01486
     C           PNPOLC    SETLLPMBIIPLL
     C           PNPOLC    READEPMBIIPLL               7070
     C*
     C** ACCESS INSTRUMENT GROUPS/TYPES FOR CUSTOMER + PORTFOLIO
     C           *IN70     DOWEQ'0'                        - B1
     C**********           Z-ADDPTMINR    QVMINR                          S01486
     C**********           Z-ADDPTMAXR    QVMAXR                          S01486
     C                     Z-ADDPTMINR    GIMINR                          S01486
     C                     Z-ADDPTMAXR    GIMAXR                          S01486
     C*
     C** ACCESS INSTRUMENT GROUP DETAILS
     C           PTINTG    IFNE *BLANKS                    - B2
     C********** PTINTG    CHAINPMPGHIPP             71                   S01486
     C           PTINTG    CHAINPMPGHIPD             71                   S01486
     C*
     C           *IN71     IFEQ '1'
     C                     Z-ADD10        DBASE            * DB ERROR 10 *
     C**********           MOVEL'PMPGHIPP'DBFILE           ***************S01486
     C                     MOVE 'PMPGHIPD'DBFILE           ***************S01486
     C                     MOVELPTINTG    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE PFINGN    QVINAR                          S01486
     C**********           MOVELPTINTG    QVGCOD                          S01486
     C                     MOVE PFINGN    GIINAR                          S01486
     C                     MOVELPTINTG    GIGCOD                          S01486
     C********** PTINTG    SETLLPMPGDIPP                                  S01486
     C********** PTINTG    READEPMPGDIPP               7171               S01486
     C           PTINTG    SETLLPMPGDIPD                                  S01486
     C           PTINTG    READEPMPGDIPD               7171               S01486
     C*
     C           *IN71     DOWEQ'0'                        - B3
     C**********           MOVELPGINNR    WWTYPE                          S01486
     C                     MOVELGBINNR    WWTYPE                          S01486
     C           WWKIST    CHAINPMISTTL0             72
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QEPTPA    QVIAMT                          S01486
     C**********           SUB  QEPTNA    QVIAMT                          S01486
     C**********           SUB  QEPTMV    QVIAMT                          S01486
     C**********           ADD  QEPTAI    QVIAMT                          S01486
     C                     ADD  QEPTPA    GIIAMT                          S01486
     C                     SUB  QEPTNA    GIIAMT                          S01486
     C                     SUB  QEPTMV    GIIAMT                          S01486
     C                     ADD  QEPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QEPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QEPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QEPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QEPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QEPVPA    GIIAMT                          S01486
     C                     SUB  QEPVNA    GIIAMT                          S01486
     C                     SUB  QEPVMV    GIIAMT                          S01486
     C                     ADD  QEPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C********** PTINTG    READEPMPGDIPP               7171               S01486
     C           PTINTG    READEPMPGDIPD               7171               S01486
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C** ACCESS INSTRUMENT TYPE DETAILS
     C           PTINNR    IFNE *BLANKS                    - B2
     C********** PTINNR    CHAINSDPLINPD             71                   S01486
     C**********                                                          S01486
     C********** *IN71     IFEQ '1'                                       S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM *BLANKS   WLRTCD  7                       S01486
     C                     PARM '*KEY  '  WLOPTN  7                       S01486
     C                     PARM PTINNR    WLINNR  3                       S01486
     C           SDPLIN    PARM SDPLIN    DSSDY                           S01486
     C           WLRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD11        DBASE            * DB ERROR 11 *
     C**********           MOVEL'SDPLINPD'DBFILE           ***************S01486
     C                     MOVE 'SDPLINPD'DBFILE           ***************S01486
     C                     MOVELPTINNR    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVELPDISTN    QVINAR                          S01486
     C**********           MOVELPTINNR    QVICOD                          S01486
     C                     MOVELPDISTN    GIINAR                          S01486
     C                     MOVELPTINNR    GIICOD                          S01486
     C                     MOVELPTINNR    WWTYPE
     C           WWKIST    CHAINPMISTTL0             72
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QEPTPA    QVIAMT                          S01486
     C**********           SUB  QEPTNA    QVIAMT                          S01486
     C**********           SUB  QEPTMV    QVIAMT                          S01486
     C**********           ADD  QEPTAI    QVIAMT                          S01486
     C                     ADD  QEPTPA    GIIAMT                          S01486
     C                     SUB  QEPTNA    GIIAMT                          S01486
     C                     SUB  QEPTMV    GIIAMT                          S01486
     C                     ADD  QEPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QEPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QEPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QEPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QEPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QEPVPA    GIIAMT                          S01486
     C                     SUB  QEPVNA    GIIAMT                          S01486
     C                     SUB  QEPVMV    GIIAMT                          S01486
     C                     ADD  QEPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C                     END                             - E2
     C*
     C                     EXSR #P02
     C           PNPOLC    READEPMBIIPLL               7070
     C                     END                             - E1
     C*
     C                     ENDSR                           * #P20
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P21     - PROCESS BANK CURRENCY POLICY                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WW1CHK   - CURRENCY AMOUNT FOR CHECKING
      * WWTYPE   - KEY FIELD FOR INSTRUMENT AND CURRENCY
      *                                                                  *
      ********************************************************************
     C           #P21      BEGSR
     C*
     C**********           Z-ADDWW1CHK    QVCAMT                          S01486
     C                     Z-ADDWW1CHK    GICAMT                          S01486
     C           PNPOLC    SETLLPMBCIPLL
     C           PNPOLC    READEPMBCIPLL               7070
     C*
     C** ACCESS CURRENCY GROUPS/TYPES FOR CUSTOMER + PORTFOLIO
     C           *IN70     DOWEQ'0'                        - B1
     C**********           Z-ADDPUMINR    QVMINR                          S01486
     C**********           Z-ADDPUMAXR    QVMAXR                          S01486
     C                     Z-ADDPUMINR    GIMINR                          S01486
     C                     Z-ADDPUMAXR    GIMAXR                          S01486
     C*
     C** ACCESS CURRENCY GROUP DETAILS
     C           PUCCYG    IFNE *BLANKS                    - B2
     C********** PUCCYG    CHAINPMPGHCPP             71                   S01486
     C           PUCCYG    CHAINPMPGHCPD             71                   S01486
     C*
     C           *IN71     IFEQ '1'
     C                     Z-ADD12        DBASE            * DB ERROR 12 *
     C**********           MOVEL'PMPGHCPP'DBFILE           ***************S01486
     C                     MOVE 'PMPGHCPD'DBFILE           ***************S01486
     C                     MOVELPUCCYG    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE PHCCGN    QVINAR                          S01486
     C**********           MOVELPUCCYG    QVGCOD                          S01486
     C                     MOVE PHCCGN    GIINAR                          S01486
     C                     MOVELPUCCYG    GIGCOD                          S01486
     C********** PUCCYG    SETLLPMPGDCPP                                  S01486
     C********** PUCCYG    READEPMPGDCPP               7171               S01486
     C           PUCCYG    SETLLPMPGDCPD                                  S01486
     C           PUCCYG    READEPMPGDCPD               7171               S01486
     C*
     C           *IN71     DOWEQ'0'                        - B3
     C                     MOVELPICCY     WWTYPE
     C********** WWKCCY    CHAINPMCCYTPP             72                   S01486
     C           WWKCCY    CHAINPMCCYTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QGPTPA    QVIAMT                          S01486
     C**********           SUB  QGPTNA    QVIAMT                          S01486
     C**********           SUB  QGPTMV    QVIAMT                          S01486
     C**********           ADD  QGPTAI    QVIAMT                          S01486
     C                     ADD  QGPTPA    GIIAMT                          S01486
     C                     SUB  QGPTNA    GIIAMT                          S01486
     C                     SUB  QGPTMV    GIIAMT                          S01486
     C                     ADD  QGPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QGPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QGPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QGPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QGPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QGPVPA    GIIAMT                          S01486
     C                     SUB  QGPVNA    GIIAMT                          S01486
     C                     SUB  QGPVMV    GIIAMT                          S01486
     C                     ADD  QGPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C********** PUCCYG    READEPMPGDCPP               7171               S01486
     C           PUCCYG    READEPMPGDCPD               7171               S01486
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C** ACCESS CURRENCY TYPE DETAILS
     C           PUCCY     IFNE *BLANKS                    - B2
     C********** PUCCY     CHAINSDCURRL0             71                   S01486
     C**********                                                          S01486
     C********** *IN71     IFEQ '1'                                       S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   WWRTCD           B:Return code  S01486
     C                     PARM '*KEY'    WWOPTN           I:Option       S01486
     C                     PARM PUCCY     WWKEY3  3        I:Key field    S01486
     C           SDCURR    PARM SDCURR    DSSDY            O:Format       S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD13        DBASE            * DB ERROR 13 *
     C**********           MOVEL'SDCURRL0'DBFILE           ***************S01486
     C                     MOVE 'SDCURRPD'DBFILE           ***************S01486
     C                     MOVELPUCCY     DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE *BLANKS   QVINAR                          S01486
     C**********           MOVELA6CYNM    QVINAR                          S01486
     C**********           MOVELPUCCY     QVICOD                          S01486
     C                     MOVE *BLANKS   GIINAR                          S01486
     C                     MOVELA6CYNM    GIINAR                          S01486
     C                     MOVELPUCCY     GIICOD                          S01486
     C                     MOVELPUCCY     WWTYPE
     C********** WWKCCY    CHAINPMCCYTPP             72                   S01486
     C           WWKCCY    CHAINPMCCYTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QGPTPA    QVIAMT                          S01486
     C**********           SUB  QGPTNA    QVIAMT                          S01486
     C**********           SUB  QGPTMV    QVIAMT                          S01486
     C**********           ADD  QGPTAI    QVIAMT                          S01486
     C                     ADD  QGPTPA    GIIAMT                          S01486
     C                     SUB  QGPTNA    GIIAMT                          S01486
     C                     SUB  QGPTMV    GIIAMT                          S01486
     C                     ADD  QGPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QGPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QGPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QGPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QGPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QGPVPA    GIIAMT                          S01486
     C                     SUB  QGPVNA    GIIAMT                          S01486
     C                     SUB  QGPVMV    GIIAMT                          S01486
     C                     ADD  QGPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C                     END                             - E2
     C*
     C                     EXSR #P02
     C           PNPOLC    READEPMBCIPLL               7070
     C                     END                             - E1
     C*
     C                     ENDSR                           * #P21
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P22     - PROCESS BANK COUNTRY POLICY                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSCHK   - COUNTRY AMOUNT FOR CHECKING
      * WWCODE   - KEY FIELD FOR COUNTRY
      *                                                                  *
      ********************************************************************
     C           #P22      BEGSR
     C*
     C***********          Z-ADDWWSCHK    QVCAMT                          B07823
     C**********           Z-ADDWW1CHK    QVCAMT                    B07823S01486
     C                     Z-ADDWW1CHK    GICAMT                          S01486
     C           PNPOLC    SETLLPMBRIPLL
     C           PNPOLC    READEPMBRIPLL               7070
     C*
     C** ACCESS COUNTRY GROUPS/TYPES FOR CUSTOMER + PORTFOLIO
     C           *IN70     DOWEQ'0'                        - B1
     C**********           Z-ADDPXMINR    QVMINR                          S01486
     C**********           Z-ADDPXMAXR    QVMAXR                          S01486
     C                     Z-ADDPXMINR    GIMINR                          S01486
     C                     Z-ADDPXMAXR    GIMAXR                          S01486
     C*
     C** ACCESS COUNTRY GROUP DETAILS
     C           PXCCDG    IFNE *BLANKS                    - B2
     C********** PXCCDG    CHAINPMPGHRPP             71                   S01486
     C           PXCCDG    CHAINPMPGHRPD             71                   S01486
     C*
     C           *IN71     IFEQ '1'
     C                     Z-ADD14        DBASE            * DB ERROR 14 *
     C**********           MOVEL'PMPGHRPP'DBFILE           ***************S01486
     C                     MOVE 'PMPGHRPD'DBFILE           ***************S01486
     C                     MOVELPXCCDG    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE PJCOGN    QVINAR                          S01486
     C**********           MOVELPXCCDG    QVGCOD                          S01486
     C                     MOVE PJCOGN    GIINAR                          S01486
     C                     MOVELPXCCDG    GIGCOD                          S01486
     C********** PXCCDG    SETLLPMPGDRPP                                  S01486
     C********** PXCCDG    READEPMPGDRPP               7171               S01486
     C           PXCCDG    SETLLPMPGDRPD                                  S01486
     C           PXCCDG    READEPMPGDRPD               7171               S01486
     C*
     C           *IN71     DOWEQ'0'                        - B3
     C                     MOVELPKCCOD    WWCODE
     C********** WWKCNT    CHAINPMCNTTPP             72                   S01486
     C           WWKCNT    CHAINPMCNTTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QHPTPA    QVIAMT                          S01486
     C**********           SUB  QHPTNA    QVIAMT                          S01486
     C**********           SUB  QHPTMV    QVIAMT                          S01486
     C**********           ADD  QHPTAI    QVIAMT                          S01486
     C                     ADD  QHPTPA    GIIAMT
     C                     SUB  QHPTNA    GIIAMT
     C                     SUB  QHPTMV    GIIAMT
     C                     ADD  QHPTAI    GIIAMT
     C                     ELSE                                           B08040
     C**********           ADD  QHPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QHPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QHPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QHPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QHPVPA    GIIAMT                          S01486
     C                     SUB  QHPVNA    GIIAMT                          S01486
     C                     SUB  QHPVMV    GIIAMT                          S01486
     C                     ADD  QHPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C********** PXCCDG    READEPMPGDRPP               7171               S01486
     C           PXCCDG    READEPMPGDRPD               7171               S01486
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C** ACCESS COUNTRY TYPE DETAILS
     C           PXCCOD    IFNE *BLANKS                    - B2
     C********** PXCCOD    CHAINSDCTRYL1             71                   S01486
     C**********                                                          S01486
     C********** *IN71     IFEQ '1'                                       S01486
     C                     CALL 'AOCTRYR0'                                S01486
     C                     PARM *BLANKS   WWRTCD                          S01486
     C                     PARM '*KEY'    WWOPTN                          S01486
     C                     PARM PXCCOD    P@KEY2  2                       S01486
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD15        DBASE            * DB ERROR 15 *
     C**********           MOVEL'SDCTRYL1'DBFILE           ***************S01486
     C                     MOVE 'SDCTRYPD'DBFILE           ***************S01486
     C                     MOVELPXCCOD    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVELA4CNNM    QVINAR                          S01486
     C                     MOVELA4CNNM    GIINAR                          S01486
     C**********           MOVELPXCCOD    QVICOD                          S01486
     C                     MOVELPXCCOD    GIICOD                          S01486
     C                     MOVELPXCCOD    WWCODE
     C********** WWKCNT    CHAINPMCNTTPP             72                   S01486
     C           WWKCNT    CHAINPMCNTTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QHPTPA    QVIAMT                          S01486
     C**********           SUB  QHPTNA    QVIAMT                          S01486
     C**********           SUB  QHPTMV    QVIAMT                          S01486
     C**********           ADD  QHPTAI    QVIAMT                          S01486
     C                     ADD  QHPTPA    GIIAMT                          S01486
     C                     SUB  QHPTNA    GIIAMT                          S01486
     C                     SUB  QHPTMV    GIIAMT                          S01486
     C                     ADD  QHPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QHPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QHPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QHPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QHPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QHPVPA    GIIAMT                          S01486
     C                     SUB  QHPVNA    GIIAMT                          S01486
     C                     SUB  QHPVMV    GIIAMT                          S01486
     C                     ADD  QHPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C                     END                             - E2
     C*
     C                     EXSR #P02
     C           PNPOLC    READEPMBRIPLL               7070
     C                     END                             - E1
     C*
     C                     ENDSR                           * #P22
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P23     - PROCESS BANK INDUSTRY POLICY                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS SINGLE PORTFOLIO/S                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSCHK   - INDUSTRY AMOUNT FOR CHECKING
      * WWLIND   - KEY FIELD FOR INDUSTRY
      *                                                                  *
      ********************************************************************
     C           #P23      BEGSR
     C*
     C***********          Z-ADDWWSCHK    QVCAMT                          B07823
     C******************** Z-ADDWW1CHK    QVCAMT                          B07823
     C                     Z-ADDWW1CHK    GICAMT                   B07823 S01486
     C           PNPOLC    SETLLPMBDIPLL
     C           PNPOLC    READEPMBDIPLL               7070
     C*
     C** ACCESS INDUSTRY GROUPS/TYPES FOR CUSTOMER + PORTFOLIO
     C           *IN70     DOWEQ'0'                        - B1
     C**********           Z-ADDPWMINR    QVMINR                          S01486
     C                     Z-ADDPWMINR    GIMINR                          S01486
     C**********           Z-ADDPWMAXR    QVMAXR                          S01486
     C                     Z-ADDPWMAXR    GIMAXR                          S01486
     C*
     C** ACCESS INDUSTRY GROUP DETAILS
     C           PWLING    IFNE *BLANKS                    - B2
     C********** PWLING    CHAINPMPGHDPP             71                   S01486
     C           PWLING    CHAINPMPGHDPD             71                   S01486
     C*
     C           *IN71     IFEQ '1'
     C                     Z-ADD16        DBASE            * DB ERROR 16 *
     C**********           MOVEL'PMPGHDPP'DBFILE           ***************S01486
     C                     MOVE 'PMPGHDPD'DBFILE           ***************S01486
     C                     MOVELPWLING    DBKEY
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVE PLLINN    QVINAR                          S01486
     C                     MOVE PLLINN    GIINAR                          S01486
     C**********           MOVELPWLING    QVGCOD                          S01486
     C                     MOVELPWLING    GIGCOD                          S01486
     C********** PWLING    SETLLPMPGDDPP                                  S01486
     C********** PWLING    READEPMPGDDPP               7171               S01486
     C           PWLING    SETLLPMPGDDPD                                  S01486
     C           PWLING    READEPMPGDDPD               7171               S01486
     C*
     C           *IN71     DOWEQ'0'                        - B3
     C**********           MOVELPMLIND    WWLIND                                              CER020
     C                     MOVELPMLOIC    WWLOIC                                              CER020
     C********** WWKIND    CHAINPMINDTPP             72                   S01486
     C           WWKIND    CHAINPMINDTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QIPTPA    QVIAMT                          S01486
     C**********           SUB  QIPTNA    QVIAMT                          S01486
     C**********           SUB  QIPTMV    QVIAMT                          S01486
     C**********           ADD  QIPTAI    QVIAMT                          S01486
     C                     ADD  QIPTPA    GIIAMT                          S01486
     C                     SUB  QIPTNA    GIIAMT                          S01486
     C                     SUB  QIPTMV    GIIAMT                          S01486
     C                     ADD  QIPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QIPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QIPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QIPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QIPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QIPVPA    GIIAMT                          S01486
     C                     SUB  QIPVNA    GIIAMT                          S01486
     C                     SUB  QIPVMV    GIIAMT                          S01486
     C                     ADD  QIPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C********** PWLING    READEPMPGDDPP               7171               S01486
     C           PWLING    READEPMPGDDPD               7171               S01486
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C** ACCESS INDUSTRY TYPE DETAILS
     C********** PWLIND    IFNE 0                          - B2                               CER020
     C**********           MOVE PWLIND    AOLICD                                              CER020
     C           PWLOIC    IFNE *BLANKS                                                       CER020
     C                     MOVE PWLOIC    AOLICD                                              CER020
     C********** AOLICD    CHAINSDINDSL1             71                   S01486
     C**********                                                          S01486
     C********** *IN71     IFEQ '1'                                       S01486
     C                     CALL 'AOINDSR0'                                S01486
     C                     PARM *BLANKS   WWRTCD                          S01486
     C                     PARM '*KEY'    WWOPTN                          S01486
     C                     PARM AOLICD    WWKEY3  3                       S01486
     C           SDINDS    PARM SDINDS    DSSDY                           S01486
     C           WWRTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD17        DBASE            * DB ERROR 17 *
     C**********           MOVEL'SDINDSL1'DBFILE           ***************S01486
     C                     MOVE 'SDINDSPD'DBFILE           ***************S01486
     C**********           MOVELPWLIND    DBKEY                                               CER020
     C                     MOVELPWLOIC    DBKEY                                               CER020
     C                     EXSR *PSSR
     C                     END
     C*
     C**********           MOVELAOLINA    QVINAR                          S01486
     C                     MOVELAOLINA    GIINAR                          S01486
     C**********           MOVELPWLIND    QVICOD                          S01486
     C**********           MOVELPWLIND    GIICOD                                       S01486 CER020
     C**********           MOVELPWLIND    WWLIND                                              CER020
     C                     MOVELPWLOIC    GIICOD                                              CER020
     C                     MOVELPWLOIC    WWLOIC                                              CER020
     C********** WWKIND    CHAINPMINDTPP             72                   S01486
     C           WWKIND    CHAINPMINDTPD             72                   S01486
     C*
     C           *IN72     IFEQ '0'
     C********** P9TVPS    IFEQ 'T'                                B08040 S01486
     C           FCTVPS    IFEQ 'T'                                       S01486
     C**********           ADD  QIPTPA    QVIAMT                          S01486
     C**********           SUB  QIPTNA    QVIAMT                          S01486
     C**********           SUB  QIPTMV    QVIAMT                          S01486
     C**********           ADD  QIPTAI    QVIAMT                          S01486
     C                     ADD  QIPTPA    GIIAMT                          S01486
     C                     SUB  QIPTNA    GIIAMT                          S01486
     C                     SUB  QIPTMV    GIIAMT                          S01486
     C                     ADD  QIPTAI    GIIAMT                          S01486
     C                     ELSE                                           B08040
     C**********           ADD  QIPVPA    QVIAMT                   B08040 S01486
     C**********           SUB  QIPVNA    QVIAMT                   B08040 S01486
     C**********           SUB  QIPVMV    QVIAMT                   B08040 S01486
     C**********           ADD  QIPTAI    QVIAMT                   B08040 S01486
     C                     ADD  QIPVPA    GIIAMT                          S01486
     C                     SUB  QIPVNA    GIIAMT                          S01486
     C                     SUB  QIPVMV    GIIAMT                          S01486
     C                     ADD  QIPTAI    GIIAMT                          S01486
     C                     END                                            B08040
     C                     END
     C*
     C                     END                             - E2
     C*
     C                     EXSR #P02
     C           PNPOLC    READEPMBDIPLL               7070
     C                     END                             - E1
     C*
     C                     ENDSR                           * #P23
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W01     -                                                       *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P02     - CALCULATE EXCEPTIONS AND OUTPUT DETAILS               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W01      BEGSR
     C*
     C**********           MOVE 'D'       QVRECI                          S01486
     C**********           MOVE PNCNUM    QVCNUM                          S01486
     C**********           MOVE PNPTFR    QVPTFR                          S01486
     C                     MOVE 'D'       GIRECI                          S01486
     C                     MOVE PNCNUM    GICNUM                          S01486
     C                     MOVE PNPTFR    GIPTFR                          S01486
     C                     ADD  1         RRIVPT                          R05788
     C                     WRITEPMIVPEP0
     C*
     C                     ENDSR                           * #W01
     C***************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - PROCESS OF DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           *PSSR     BEGSR
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C*                                                                   S01486
     C** WRITE AUDIT REPORT                                               S01486
     C*                                                                   S01486
     C                     WRITEHEADAU                                    S01486
     C                     WRITEAUDIT                                     S01486
     C*
     C** PRINT DUMP AND CANCEL PROGRAM
     C                     DUMP
     C                     MOVE '1'       *INLR
     C*
     C                     RETRN
     C*
     C                     ENDSR
     C***************************************************************
      /COPY ZSRSRC,ZCCYXR                                                 R05927
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
