     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Customer Selection')                          *
     F*****************************************************************
     F*                                                               *
     F*  Midas - PORTFOLIO MANAGEMENT                                 *
     F*                                                               *
     F*  PM0620 - CUSTOMER SELECTION SCREEN                           *
     F*                                                               *
     F*  Called By: PMC0620                                           *
     F*                                                               *
     F*  Calls:     NONE                                              *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 CLE025             Date 20Oct03               *
      *                 TDA035             Date 02Apr04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CGL008             Date 03Mar99               *
      *                 110004             Date 22Oct96               *
      *                 087575             Date 02Jul96               *
     F*                 CPM005             DATE 02JUL96               *
     F*                 103082             DATE 24APR96               *
     F*                 103083             DATE 24APR96               *
     F*                 CPM004             DATE 07FEB96               *
     F*                 092955             DATE 13SEP95               *
     F*                 085817             DATE 13MAR95               *
     F*                 085815             DATE 13MAR95               *
     F*                 081239             DATE 03FEB95               *
     F*                 082390             DATE 30JAN95               *
     F*                 080701             DATE 18JAN95               *
     F*                 083547             DATE 20FEB95               *
     F*                 S01486             DATE 03JUN94               *
     F*                 049421             DATE 25NOV93               *
     F*                 SA9108             DATE 03OCT91               *
     F*                 038430             DATE 19MAI93               *
     F*                 R37467             DATE 25/03/92              *
     F*                 B08275             DATE 25/10/91              *
     F*                 R05661             DATE 11MAR91               *
     F*                 R0775_DC           DATE 19NOV90               *
     F*                 R0761              DATE 20NOV90               *
     F*                 R00951             DATE 20NOV90               *
     F*                 R10036             DATE 20SEP90               *
     F*                 R00300             DATE 16AUG90               *
     F*                 CFFX05             DATE 25JUL90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CRE026 - Consumer Banking                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  CLE025 - Credit Lines (Recompile)                            *
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CGL008 - Security on Journal Entry. Recompile.               *
     F*  110004 - Fix 103083 only applies to Bank Portfolios          *
     F*  087575 - The Secret Code is reported from one customer to    *
     F*           an other. Correction of CPM005                      *
     F*  CPM005 - Private Banking Phase 2                             *
     F*           Focus Group Changes upgraded to DBA                 *
     F*           PBFG/5 - INSTRUMENT ASSET/LIABILITY SPLIT           *
     F*           PBFG/6 - ADDITIONAL CUSTOMER DETAILS                *
     F*           PBFG/7 - NET COMMITMENT BY CURRENCY                 *
     F*           PBFG/8 - DISPLAY POSITIONS SPLIT BY CURRENCY        *
     F*  103082 - Total portfolio is displayed even though pool       *
     F*           portfolio's are displayed - update Pool Portfolio   *
     F*           Customer Indicator on LDA.                          *
     F*  103083 - If no portfolios are defined for a customer then    *
     F*           customer cannot be selected, since pgm cannot       *
     F*           handle customers with no portfolio.         t       *
     F*  CPM004 - Bank Portfolios                                     *
     F*  092955 - Complete 085815 to output birth date as 7A          *
     F*  085817 - Recompile due to changes in PMLDAPD                 *
     F*  085815 - CORRECT FORMATTING OF DATE OF BIRTH                 *
     F*  081239 - R10 Private Banking Rework                          *
     F*  082390 - Mismatch between customer shortname entered &       *
     F*           customer number retrieved by the program.           *
     F*  080701 - If firstly wrong customer entered, unable           *
     F*           to access next screen                               *
     F*  083547 - Correcting Account Officer name on MUSERDD          *
     F*  S01486 - Portfolio Management Upgarde                        *
     F*  049421 - HEADER BOX STANDARDISATION                          *
     F*  SA9108 - POOL SECURITIES TRANSACTIONS                        *
     F*  038430 - Client Portfolio still display when he's            *
     F*           deleted.                                            *
     F*  R37467 - ONLY DISPLAY DELETED PORTFOLIO CUSTOMERS WHO        *
     F*           HAVE LEFT BANK (DATE DELETED, SDCUSTPD *NE 0)       *
     F*  B08275 - DELETED CUSTOMERS MAY BE SELECTED                   *
     F*  R05661 - OUTPUT 9997 REFERENCE TO PMLDAPP                    *
     F*  R0775  - DO NOT SHOW THE SUBFILE IF THERE'S NO RECORD.       *
     F*  R0761  - OUTPUT ERROR IF SHORTNAME ENTERED AFTER LAST NAME   *
     F*           ON FILE LF/SDPLCSL3                                 *
     F*  R00951 - CUSTOMER REPORT TOWN NOT OUTPUT TO DTAARA/*LDA      *
     F*  R10036 - CAN CHANGE THE DEFAULT USER LANGUAGE                *
     F*  R00300 - Message file changes.                               *
     F*  CFFX05 - ADD CUSTOMER SELECTION SCREEN                       *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F**
     F**SDBANKL1IF  E           K        DISK                             S01486
     F********************************************* KINFSR *PSSR          S01486
     F** PREFIX 'BJ' **
     F**                                                                  R10036
     F**SDLANGL0IF  E           K        DISK                      R10036 S01486
     F********************************************* KINFSR *PSSR   R10036 S01486
     F**
     F**SDACOFL1IF  E           K        DISK                             S01486
     F********************************************* KINFSR *PSSR          S01486
     F** PREFIX 'AZ' **
     F**
     F*DPLCSL2IF**E           K        DISK                               B08275
     F**SDPLCSL0IF  E           K        DISK                      B08275 S01486
     F********************************************* KINFSR *PSSR          S01486
     F** PREFIX 'QB' **
     F**
     F*DPLCSL3IF**E           K        DISK                               B08275
     F**SDPLCSL1IF  E           K        DISK                       B08275S01486
     FPMPLCSLJIF  E           K        DISK                               S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'QB' **
     F**
     F**MUSER   IF  E           K        DISK                             S01486
     F********************************************* KINFSR *PSSR          S01486
     F**
     F**SDPORTL1IF  E           K        DISK                             S01486
     F********************************************* KINFSR *PSSR          S01486
     F** PREFIX 'P9' **
     F**
     F**SDCTRYL1IF  E           K        DISK                             S01486
     F********************************************* KINFSR *PSSR          S01486
     F** PREFIX 'A4' **
     F**
     F*
     F**PM0620DDCF  E                    WORKSTN                          S01486
     FPM0620DFCF  E                    WORKSTN                            S01486
     F                                        SFLRR2KSFILE PM0620S2       CFFX05
     F                                              KINFDS FIDS01         CFFX05
     FPMPORTPDIF  E           K        DISK                               103083
     F                                              KINFSR *PSSR          103083
     FPMCNSDLLIF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     F******************************************************************
     F**
     F** FUNCTION OF INDICATORS
     F**
     F******************************************************************
     F**
     F** LR      : END OF PROGRAM
     F**
     F** U7      : DATA BASE ERROR
     F** U8      : DATA BASE ERROR
     F** KC      : EXIT OF PROGRAM
     F**
     F** 27      : ROLLUP                                                 CFFX05
     F** 28      : SFLDSP                                                 CFFX05
     F** 29      : SFLDSPCTL                                              CFFX05
     F** 30      : SFLCLR                                                 CFFX05
     F** 31      : SFLEND                                                 CFFX05
     F** 32      : SFLNXTCHG                                              CFFX05
     F**                                                                  CFFX05
     F** 43      : AT LEAST ONE SELECTION ON SCREEN 2                     CFFX05
     F** 44      : AT LEAST ONE INVALID SELECTION ON SCREEN 2             CFFX05
     F** 45      : MORE THAN ONE SELECTION ON SCREEN 2                    CFFX05
     F**                                                                  CFFX05
     F** 50      : (RI PC) ON SCREEN 2 SELECTION FIELD                    CFFX05
     F** 51      : (RI PC) ON SCREEN 2 CUSTOMER FIELD                     CFFX05
     F**
     F** 55      : RECORD TO BE WRITTEN TO SUBFILE                        CFFX05
     F**                                                                  CFFX05
     F** 70 - 73 : FILE PROCESSING
     F**
     F** 80 - 83 : WORK INDICATORS
     F** 90      : Records found on PMPORTPD                              103083
     F**           OR Records found on PMCNSDPD                           CPM005
     F**
     F******************************************************************
      /COPY ZSRSRC,ZDATE2Z1
     E**
     E                    CPY@    1   1 80
     E*
     I******************************************************************
     I*                                                                   CPM005
     IZMUSER      DS                             17                       CPM005
     I** Data area ZMUSER                                                 CPM005
     I                                       11  13 USRBCH                CPM005
     I**
     I** EXTERNAL FORMAT FOR GROUP DATA AREA
     I**
     I**WWGDA     E DSPMGRDAPP                                            S01486
     I**
     I***WWLDA     E DSPMLDAPP                                            S01486
     IWWLDA     E DSPMLDAPD                                               S01486
     I**
     ISDBANK    E DSSDBANKPD                                              S01486
     I* Bank Details Accesses Via Access Program                          S01486
     I*                                                                   S01486
     ID@USER    E DSMUSERDD                                               S01486
     I*                                                                   S01486
     ISDPLCS    E DSSDPLCSPD                                              S01486
     I* Portfolio Customer Details Accessed Via Access Program            S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              S01486
     I* Portfolio Definition Via Access Program                           S01486
     I*                                                                   S01486
     ISDACOF    E DSSDACOFPD                                              S01486
      **  EXTERNAL DS FOR ACCOUNT OFFICER DETAILS                         S01486
     I*                                                                   S01486
     ISDCTRY    E DSSDCTRYPD                                              S01486
      **  EXTERNAL DS FOR COUNTRY DETAILS                                 S01486
     I*                                                                   S01486
     ISDCUST    E DSSDCUSTPD                                              S01486
     I** DUMMY RECORD FORMAT FOR CUSTOMER DETAILS                         S01486
     I*                                                                   CPM005
     ISDPATT    E DSSDPATTPD                                              CPM005
     I* External DS for Power of Attorney details                         CPM005
     I**                                                                  CPM005
     ISDJUSR    E DSSDJUSRPD                                              CPM005
     I* External DS Joint Account details                                 CPM005
     I*                                                                   CPM005
     ISDCCRD    E DSSDCCRDPD                                              CPM005
     I* External DS for Customer Credit Card details                      CPM005
     I**                                                                  CPM005
     ISDRELC    E DSSDRELCPD                                              CPM005
     I* External DS Related Customers details                             CPM005
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* First DS For Access Programs, Short Data Structure                S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* Second DS For Access Programs, Long Data Structure                S01486
     I*                                                                   S01486
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     I****LDA        UDS                            256                   S01486
     IMILDA       DS                            256                       S01486
     I************************************* 132 183 DBLOT                 S01486
     I                                      134 183 DBLOT                 S01486
     I************************************* 132 141 DBFILE                S01486
     I                                      134 141 DBFILE                S01486
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I*
     IPSDS       SDS
     I************************************* 244 253 WSID                  S01486
     I************************************* 254 263 USID                  S01486
     I                                      244 253 WKSTN                 S01486
     I                                      254 263 USER                  S01486
     I*                                                                   CFFX05
     I** FILE INFORMATION DATA STRUCTURE                                  CFFX05
     I*                                                                   CFFX05
     IFIDS01      DS                                                      CFFX05
     I                                    B 378 3790DSLRR2                CFFX05
     I**
     I** DATA STRUCTURE FOR CUSTOMER NUMBER
     I**
     I            DS
     I                                        1  10 WWCNUM
     I                                        1   6 WWCNM1
     I                                        7  10 WWCNM2
     I**********                                                          S01486
     I            DS                                                      S01486
     I                                        1  10 DDCNUM                S01486
     I                                        1   1 WWPTMK                S01486
     I**********                                                          S01486
     I**
     I** DATA STRUCTURE FOR DATE OF BIRTH (READ FROM FILE)
     I**
     I            DS
     I                                        1   60WWDAT1
     I                                        1   20WWDAY1
     I                                        3   40WWMON1
     I                                        5   60WWYER1
     I**
     I** DATA STRUCTURE FOR DATE OF BIRTH (CONVERTED AS PARAMETER)
     I**
     I            DS
     I                                        1   7 WWDAT2
     I                                        1   20WWDAY2
     I                                        3   5 WWMON2
     I                                        6   70WWYER2
     I**                                                                  038430
     I** DATA STRUCTURE FOR SHOW A BLINK MESSAGE FOR DELETED PORTFOLIO    038430
     I**                                                                  038430
     I            DS                                                      038430
     I                                        1   1 BLS                   038430
     I                                        2   9 DELETE                038430
     I                                       10  10 BLE                   038430
     I                                        1  10 TOWN                  038430
     I*                                                                   085815
     IRUNDAT      DS                                                      085815
     I                                        1   7 MRDT                  085815
     I                                    P   8  100RDNB                  085815
     I                                       11  11 SUC                   085815
     I                                       12  12 DFF                   085815
     I                                       13  13 MBIN                  085815
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #P1001   - TO ACCESS STANDING DATA AND INITIALIZE WORK FIELDS    *
      * #P1002   - TO PROCESS SCREEN                                     *
      * #P1003   - TO PROCESS SCREEN 2 - CUSTOMER SELECTION              *CFFX05
      * #P1004   - TO PROCESS ENTER ON SCREEN 2                          *CFFX05
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *CFFX05
      * #L1002   - CHECKS IF VALID RECORD TO BE WRITTEN TO SUBFILE       *CFFX05
      * #V1001   - TO VALIDATE CUSTOMER SELECTION SCREEN                 *
      * #V1002   - TO VALIDATE SELECTIONS ON SCREEN 2                    *CFFX05
      * #W1002   - TO FORMAT DETAILS FOR OUTPUT TO DTAARA *GDA           *
      * ZDATE2   - TO CONVERT A MIDAS DATE IN ALPHA DATE                 *
      * ZASNMS   - TO SEND MESSAGE TO PROGRAM MESSAGE QUEUE              *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      * PMC1001  - TO OUTPUT DETAILS TO DTAARA *LDA                      *
      **PMC1002**-*TO*OUTPUT*DETAILS*TO*DTAARA**GDA                      *S01486
      **PMC0621**-*TO*START*GROUP*JOB                                    *S01486
      **PMC1004**-*TO*RETRIEVE*CONTENTS*OF*DTAARA**GDA                   *S01486
      *********ZA0240   - TO SEND ERROR MESSAGE TO SUBFILE MESSAGE       *
      * Y2SNMGC  - TO SEND ERROR MESSAGE TO PROGRAM MESSAGE QUEUE        *
      * Y2CLMSC  - TO CLEAR PROGRAM MESSAGE QUEUE                        *
      *                                                                  *
      ********************************************************************
     C****************************************************************
     C**   PROGRAM    START
     C****************************************************************
     C*
     C                     MOVEACPY@      CPY2@  80
     C*
     C           *ENTRY    PLIST
     C                     PARM           WWNAME 10
     C**
     C** PROCESS INITIALIZATION
     C**
     C                     EXSR #P1001
     C**
     C** PROCESS UNTIL F3 TAKEN OR F12 TAKEN OR END ENQUIRIES REQUESTED
     C**
     C           *INKC     DOUEQ'1'
     C           QMENQT    OREQ 'Y'
     C**
     C                     EXSR #P1002
     C**
     C                     END
     C**
     C                     MOVE '1'       *INLR
     C**
     C****************************************************************
     C**   PROGRAM    END
     C****************************************************************
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1002   - TO PROCESS SCREEN                                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #V1001   - TO VALIDATE CUSTOMER SELECTION SCREEN                 *
      * #W1002   - TO FORMAT DETAILS FOR OUTPUT TO DTAARA *GDA           *
      **PMC1001**-*TO*OUTPUT*DETAILS*TO*DTAARA**LDA                      *S01486
      * PMC1002  - TO OUTPUT DETAILS TO DTAARA *GDA                      *
      **PMC0621**-*TO*START*GROUP*JOB                                    *S01486
      **PMC1004**-*TO*RETRIEVE*CONTENTS*OF*DTAARA**GDA                   *S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWPARM   - PARAMETER FOR CALLED PROGRAMS - DATAS OF *GDA         *
      *                                                                  *
      ********************************************************************
     C           #P1002    BEGSR
     C**
     C******************** MOVELBJMRDT    DDRUNA                          S01486
     C**
     C                     WRITEPM0620F0
     C*                                                                   CPM005
     C*  IF PROGRAM HAVE BEEN CALLED FROM FORMAT PM0620F1, REDISPLAY IT   CPM005
     C*  (*IN12 USED)                                                     CPM005
     C           *IN12     IFEQ *OFF                                      CPM005
     C           *IN13     ANDEQ*OFF                                      CPM005
     C                     EXFMTPM0620F1
     C                     MOVE '0'       *IN12                           CPM005
     C                     END                                            CPM005
     C                     MOVE '0'       *IN60
     C******************** MOVE '0'       *IN61                    R10036 S01486
     C******************** MOVE '0'       *IN80                           S01486
     C                     MOVE '0'       *IN62                           CPM005
     C                     MOVE '0'       *IN80                           080701
     C                     MOVE '0'       *IN81
     C                     MOVE '0'       *IN82
     C*********************CALL 'ZA0250'                                  R00300
     C*                                                                   R00300
     C**  Clear program message queue.                                    R00300
     C                     CALL 'Y2CLMSC'                                 R00300
     C                     PARM           TOPQ   10                       R00300
     C                     PARM           TOPRQ   5                       R00300
     C*                                                                   CPM005
     C** IF F6 TAKEN OR ENTER PRESSED                                     CPM005
     C           *INKF     IFEQ '1'                        - B1           CPM005
     C           *INKC     OREQ '0'                                       CPM005
     C*                                                                   CPM005
     C           MBIN      IFNE 'Y'                        - B2           CPM005
     C           WLERR     ANDNE*ZERO                                     CPM005
     C                     MOVEL'PM51117' ZAMSID                          CPM005
     C                     EXSR ZASNMS                                    CPM005
     C                     ELSE                            - X2           CPM005
     C*                                                                   CPM005
     C           WLERR     IFEQ 1                          - B3           CPM005
     C                     MOVEL'PM51115' ZAMSID                          CPM005
     C                     EXSR ZASNMS                                    CPM005
     C                     ELSE                            - X3           CPM005
     C           WLERR     IFEQ 2                          - B4           CPM005
     C                     MOVEL'PM51116' ZAMSID                          CPM005
     C                     EXSR ZASNMS                                    CPM005
     C                     END                             - E4           CPM005
     C                     END                             - E3           CPM005
     C                     END                             - E2           CPM005
     C                     END                             - E1           CPM005
     C*                                                                   CPM005
     C           *INKC     IFEQ '0'                        - B0           CPM005
     C           WLERR     ANDEQ*ZERO                                     CPM005
     C*                                                                   CPM005
     C** IF F6 TAKEN, CALL USER IDENTIFICATION                            CPM005
     C                     MOVEL*BLANKS   PAR1                            CPM005
     C                     MOVEL*BLANKS   PAR2                            CPM005
     C                     MOVEL*BLANKS   PAR3                            CPM005
     C                     MOVEL*BLANKS   PAR4                            CPM005
     C                     MOVEL*BLANKS   PAR5                            CPM005
     C                     MOVE '0'       *IN14                           CPM005
     C           *INKF     IFEQ '1'                        - B1           CPM005
     C                     MOVE '0'       *INKF                           CPM005
     C                     MOVE '0'       *IN12                           CPM005
     C                     MOVE '0'       *IN11                           CPM005
     C                     MOVE '0'       *IN13                           CPM005
     C                     MOVE '1'       *IN14                           CPM005
     C                     CALL 'PM3180'                                  CPM005
     C                     PARM           PAR1    1        Customer/Port  CPM005
     C                     PARM           PAR2   20        User Id        CPM005
     C                     PARM           PAR3    6        Customer numberCPM005
     C                     PARM           PAR4    1        Type           CPM005
     C                     PARM           PAR5    2        Return code    CPM005
      *                                                                   CPM005
     C           PAR5      IFEQ 'RA'                       - B2           CPM005
     C                     MOVELPAR1      DDCUPD                          CPM005
     C                     MOVELPAR3      DDCNUM                          CPM005
     C                     END                             - E2           CPM005
      *                                                                   CPM005
     C           PAR5      IFEQ '03'                       - B2           CPM005
     C                     MOVE '1'       *INKC                           CPM005
     C                     END                             - E2           CPM005
      *                                                                   CPM005
     C           PAR5      IFEQ '12'                       - B2           CPM005
     C                     MOVE '1'       *INKL                           CPM005
     C                     END                             - E2           CPM005
      *                                                                   CPM005
     C                     END                             - E1           CPM005
     C**
     C** IF F3 NOT TAKEN, ENTER PRESSED
     C**
     C           *INKC     IFEQ '0'
     C**                                                                  R10036
     C** CHECK VALIDITY OF USER LANGUAGE CODE                             R10036
     C**                                                                  R10036
     C********** DDMULT    CHAINSDLANGL0             74            R10036 S01486
     C********** *IN74     IFEQ '1'                                R10036 S01486
     C******************** MOVEL'PM62001' ZAMSID                   R10036 S01486
     C******************** EXSR ZASNMS                             R10036 S01486
     C******************** MOVE '1'       *IN61                    R10036 S01486
     C******************** MOVE '1'       *IN80                    R10036 S01486
     C**                                                           R10036 S01486
     C******************** ELSE                                    R10036 S01486
     C**                                                                  CFFX05
     C** IF CUSTOMER NUMBER/SHORTNAME NOT ENTERED                         CFFX05
     C**                                                                  CFFX05
     C           DDCNUM    IFEQ *BLANKS                                   CFFX05
     C           WWPTMK    OREQ '?'                                       S01486
     C**                                                                  CPM005
     C** IF DISPLAY CUSTOMER/PORTFOLIO DETAILS IS ENTERED                 CPM005
     C**                                                                  CPM005
     C           DDCUPD    IFEQ *BLANKS                                   CPM005
     C                     MOVELFCDCPD    DDCUPD                          CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C           DDCUPD    IFNE 'C'                                       CPM005
     C           DDCUPD    ANDNE'P'                                       CPM005
     C                     MOVEL'PM62002' ZAMSID                          CPM005
     C                     EXSR ZASNMS                                    CPM005
     C                     MOVE '1'       *IN62                           CPM005
     C                     MOVE '1'       *IN80                           CPM005
     C**                                                                  CPM005
     C                     ELSE                                           CPM005
     C**                                                                  CFFX05
     C** PROCESS SCREEN 2 - CUSTOMER SELECTION                            CFFX05
     C** ONLY IF F6 NOT TAKEN                                             CPM005
     C**                                                                  CFFX05
     C           *INKF     IFEQ '0'                                       CPM005
     C           *IN13     ANDEQ'0'                                       CPM005
     C                     EXSR #P1003                                    CFFX05
     C*                                                                   CFFX05
     C** CLEAR SUBFILE                                                    CFFX05
     C*                                                                   CFFX05
     C                     MOVEA'001'     *IN,28           OFF 28-29 ON 30CFFX05
     C                     WRITEPM0620C2                                  CFFX05
     C                     MOVEA'110'     *IN,28           ON 28-29 OFF 30CFFX05
     C                     Z-ADD0         LSTRR2                          CFFX05
     C**                                                                  CFFX05
     C                     END                                            CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     ELSE                                           CFFX05
     C**
     C** VALIDATE CUSTOMER NUMBER OR SHORTNAME
     C**
     C                     EXSR #V1001
     C**                                                                  CPM005
     C** IF CUSTOMER IS VALID, TEST 'DISPLAY CUSTOMER/PORTFOLIO DETAILS'  CPM005
     C**                                                                  CPM005
     C           *IN80     IFEQ *OFF                                      CPM005
     C                     EXSR #V100B                                    CPM005
     C                     END                                            CPM005
     C**                                                                  CFFX05
     C                     END                                            CFFX05
     C**                                                                  R10036
     C******************** END                                     R10036 S01486
     C**                                                                  CFFX05
     C                     END                                            CFFX05
     C**                                                                  CFFX05
     C** IF F3 OR F12 NOT TAKEN                                           CFFX05
     C**                                                                  CFFX05
     C           *INKC     IFEQ '0'                                       CFFX05
     C           *INKL     ANDEQ'0'                                       CFFX05
     C**
     C** IF INPUT IS VALID  FORMAT DETAILS FOR OUTPUT TO
     C** DTAARA/*LDA AND CALL PROGRAMS TO UPDATE DTAARA
     C** AND TO START GROUP JOB
     C**
     C           *IN80     IFEQ '0'
     C**
     C           *IN13     IFEQ *OFF                                      CPM005
     C                     EXSR #W1002
     C                     END                                            CPM005
     C**
     C                     CALL 'PMC1001'
     C                     PARM           WWLDA
     C**
     C**********           CALL 'PMC1002'                                 S01486
     C**********           PARM           WWGDA                           S01486
     C**
     C** IF SELECTION IS 'C', SCREEN 'CUSTOMER SUMMARY DETAILS' DISPLAYED CPM005
     C**    BEFORE 'PORTFOLIO SUMMARY'                                    CPM005
     C** IF SELECTION IS 'P', SCREEN 'PORTFOLIO SUMMARY' DISPLAYED        CPM005
     C**                                                                  CPM005
     C                     MOVE *OFF      *IN11                           CPM005
     C**                                                                  CPM005
     C           DD2SEL    IFEQ 'C'                                       CPM005
     C           DDCUPD    OREQ 'C'                                       CPM005
     C           DDCUPD    OREQ *BLANKS                                   CPM005
     C           FCDCPD    ANDEQ'C'                                       CPM005
     C           DD2SEL    ANDNE'P'                                       CPM005
     C           *IN13     OREQ *ON                                       CPM005
     C                     MOVE *OFF      *IN13                           CPM005
     C                     MOVEL'PM0620'  PGMNAM 10                       CPM005
     C                     CALL 'PMC0600'                                 CPM005
     C                     PARM           PGMNAM                          CPM005
     C** GET DATA FROM GROUP DATA AREA                                    CPM005
     C                     CALL 'PMC1003'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C                     MOVE *ON       *IN11                           CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C           *IN11     IFEQ *ON                                       CPM005
     C           QMENQT    ANDEQ' '                                       CPM005
     C           *IN11     OREQ *OFF                                      CPM005
     C******************** CALL 'PMC0621'                                 S01486
     C                     CALL 'PM0630'                                  S01486
     C                     PARM           WWNAME                          S01486
     C                     END                                            CPM005
     C**
     C                     MOVEL*BLANKS   DDCNUM
     C                     MOVELFCDCPD    DDCUPD                          CPM005
     C**
     C** RETRIEVE CONTENTS OF DTAARA *GDA
     C**
     C**********           CALL 'PMC1004'                                 S01486
     C**********           PARM           WWGDA                           S01486
     C                     CALL 'PMC1003'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C           QMDBER    IFEQ 'Y'                        ****************
     C           *LOCK     IN   MILDA                                     S01486
     C                     Z-ADDQMERRN    DBASE            **DB ERROR 03 **
     C                     MOVELQMPGM     DBPGM            ****************
     C                     MOVELQMFILE    DBFILE
     C                     MOVELQMKEY     DBKEY
     C                     OUT  MILDA                                     S01486
     C                     END
     C**
     C                     END
     C**
     C                     END
     C**                                                                  CPM005
     C                     END                             - E0           CPM005
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************CFFX05
      ** NEW SUBROUTINE #P1003 INSERTED                                   CFFX05
      ********************************************************************CFFX05
      ********************************************************************
      *                                                                  *
      * #P1003   - TO PROCESS SCREEN 2 - CUSTOMER SELECTION              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      * #P1004   - TO PROCESS ENTER ON SCREEN 2                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1002   - TO PROCESS SCREEN                                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWVALD   - SCREEN VALID FLAG                                     *
      * WWSTRN   - STORES RRN OF CURRENT SCREEN                          *
      *                                                                  *
      ********************************************************************
     C           #P1003    BEGSR
     C*
     C** LOAD FIRST PAGE OF SUBFILE RECORDS
     C*
     C****       *LOVAL    SETLLSDPLCSL3                                  B08275
     C****                 READ SDPLCSL3                 31               B08275
     C********** *LOVAL    SETLLSDPLCSL1                            B08275S01486
     C**********           READ SDPLCSL1                 31         B08275S01486
     C           *LOVAL    SETLLPMPLCSLJ                                  S01486
     C                     READ PMPLCSLJ                 31               S01486
     C                     EXSR #L1001
     C*
     C                     MOVE '0'       *IN80
     C                     MOVE 'N'       WWVALD
     C*
     C** PROCESS SCREEN 2 UNTIL CMD-3 OR SCREEN VALID
     C*
     C           *IN14     IFEQ *OFF                                      CPM005
     C*                                                                   CPM005
     C           *INKC     DOWEQ'0'
     C           WWVALD    ANDEQ'N'
      *                                                                   R0775
      ** DO NOT SHOW THE SUBFILE IF THERE'S NO RECORD                     R0775
      *                                                                   R0775
     C           SFLRR2    IFEQ 0                                         R0775
     C                     SETOF                     28                   R0775
     C                     ELSE                                           R0775
     C                     SETON                     28                   R0775
     C                     END                                            R0775
     C*
     C                     WRITEPM0620F2
     C                     WRITEPM0620C2
     C           *IN80     IFEQ '1'
     C                     WRITEPM0620F0
     C                     END
     C*                    READ PM0620C2                 99               R0775
     C                     EXFMTPM0620C2                                  R0775
     C*
     C           DSLRR2    IFEQ 0
     C                     Z-ADDSFLRR2    WWSTRN  40
     C                     ELSE
     C                     Z-ADDDSLRR2    WWSTRN
     C                     END
     C*
     C           *INKC     IFEQ '0'                        CMD-3
     C*
     C           *INKL     IFEQ '1'                        CMD-12
     C*
     C                     MOVE *BLANKS   DDCNUM
     C                     MOVE '0'       *IN80
     C                     MOVE '0'       *IN12                           CPM005
     C                     MOVE 'Y'       WWVALD
     C                     CALL 'ZA0250'
     C*
     C                     ELSE
     C*
     C           *IN27     CASEQ'1'       #L1001           ROLLUP
     C                     CAS            #P1004           ENTER
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*                                                                   CPM005
     C                     END                                            CPM005
     C*
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************CFFX05
      ** END OF NEW SUBROUTINE #P1003                                     CFFX05
      ********************************************************************CFFX05
      /EJECT
      ********************************************************************CFFX05
      ** NEW SUBROUTINE #L1001 INSERTED                                   CFFX05
      ********************************************************************CFFX05
      ********************************************************************
      *                                                                  *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1003   - TO PROCESS SCREEN 2 - CUSTOMER SELECTION              *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSFCT   - COUNT OF RECORDS WRITTEN TO SUBFILE                   *
      *                                                                  *
      ********************************************************************
     C           #L1001    BEGSR
     C*
     C                     Z-ADDLSTRR2    SFLRR2
     C                     Z-ADD0         WWSFCT  40
     C                     MOVE *BLANK    DD2SEL
     C                     MOVE '0'       *IN50
     C                     MOVE '0'       *IN55
     C*
     C           *IN31     DOWEQ'0'
     C           WWSFCT    ANDLT15
     C*
     C** CHECK IF VALID PORTFOLIO RECORD
     C*
     C                     EXSR #L1002
     C*
     C** IF VALID WRITE TO SUBFILE
     C*
     C           *IN55     IFEQ '0'
     C           QBRECI    ANDEQ'D'                                       038430
     C*
     C           QBRECI    IFEQ 'D'                                       B08275
     C                     MOVE *BLANKS   DDSTAT                          B08275
     C                     ELSE                                           B08275
     C                     MOVE 'D'       DDSTAT                          B08275
     C                     END                                            B08275
     C*                                                                   B08275
     C                     MOVE BBCSSN    DD2SSN
     C                     MOVE BBCUST    DD2UST
     C                     MOVE BBCRNM    DD2RNM
     C                     MOVE BBCRTN    DD2RTN
     C*
     C                     ADD  1         WWSFCT
     C                     ADD  1         SFLRR2
     C                     WRITEPM0620S2
     C*
     C                     END
     C*
     C****                 READ SDPLCSL3                 31               B08275
     C**********           READ SDPLCSL1                 31         B08275S01486
     C                     READ PMPLCSLJ                 31               S01486
     C*
     C                     END
     C*
     C                     Z-ADDSFLRR2    LSTRR2
     C*
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************CFFX05
      ** END OF NEW SUBROUTINE #L1001                                     CFFX05
      ********************************************************************CFFX05
      /EJECT
      ********************************************************************CFFX05
      ** NEW SUBROUTINE #L1002 INSERTED                                   CFFX05
      ********************************************************************CFFX05
      ********************************************************************
      *                                                                  *
      * #L1002   - TO CHECK IF RECORD SHOULD BE WRITTEN TO THE SUBFILE   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #L1002    BEGSR
     C*
     C                     MOVE '0'       *IN55
      *                                                                   103083
      ** If no portfolios for customer do not allow selection             103083
      *                                                                   103083
     C           *LIKE     DEFN PNCNUM    ##CNUM                          103083
     C           KCHKP     KLIST                                          103083
     C                     KFLD           ##CNUM                          103083
      *                                                                   103083
     C           FCPORS    IFEQ 'B'                                       110004
     C                     MOVELBBCUST    ##CNUM                          103083
     C           KCHKP     SETLLPMPORTP0                 90               103083
     C           *IN90     IFEQ '0'                                       103083
     C           KCHKP     SETLLPMCNSDD0                 90               CPM005
     C           *IN90     IFEQ '0'                                       CPM005
     C                     MOVEL*ON       *IN55                           103083
     C                     ENDIF                                          CPM005
     C                     ENDIF                                          103083
     C                     ENDIF                                          110004
     C****                                                                B08275
     C****ALID CHECK PORTFOLIO INDICATOR                                  B08275
     C****                                                                B08275
     C****       QBPCUS    IFNE 'Y'                                       B08275
     C****                 MOVE '1'       *IN55                           B08275
     C****                 END                                            B08275
     C****                                                                R37467
     C***DELETED PORTFOLIO CUSTOMERS SHOULD ONLY BE SHOWN IF THEY HAVE    R37467
     C***LEFT THE BANK                                                    R37467
     C****       QBRECI    IFEQ '*'                                       R37467
     C****       BBDTDL    ANDEQ0                                         R37467
     C****                 MOVE '1'       *IN55                           R37467
     C****                 END                                            R37467
     C*
     C** IF THE 'HIGH LEVEL SECURITY' FIELD ON LF/SDPORTL1
     C** IS EQUAL TO 'Y'. ACCESS LF/MUSER WITH THE USER PROFILE
     C** TO OBTAIN THE ACCOUNT OFFICER OR DEPARTMENT ASSIGNED
     C** TO THAT PROFILE.
     C*
     C********** P9HLVS    IFEQ 'Y'                                       S01486
     C           FCHLVS    IFEQ 'Y'                                       S01486
     C*
     C********** WWNAME    CHAINMUSER                71                   S01486
     C                     CALL 'AOUSERR0'                                S01486
     C                     PARM           WUAPRC  7        B:Return Cde   S01486
     C                     PARM '*KEY'    UUAPOP  7        I:Option       S01486
     C                     PARM WWNAME    UUUSID 10        I:User ProfiancS01486
     C           D@USER    PARM D@USER    DSSDY            O:MUSER fmt    S01486
     C*
     C** IF ACCOUNT OFFICER CODE NOT BLANK
     C** TEST IF ACCOUNT OFFICER CODE NOT EQUAL *A
     C** AND NOT EQUAL TO CUSTOMER ACCOUNT OFFICER
     C*
     C********** ACOC      IFNE *BLANKS                                   S01486
     C***********ACOF      IFNE *BLANKS                             S01486083547
     C           ACFA      IFNE *BLANKS                                   083547
     C*
     C********** ACOC      IFNE '*A'                                      S01486
     C********** ACOC      ANDNEBBACOC                                    S01486
     C***********ACOF      IFNE 'ALL'                               S01486083547
     C***********ACOF      ANDNEBBACOC                              S01486083547
     C           ACFA      IFNE 'ALL'                                     083547
     C           ACFA      ANDNEBBACOC                                    083547
     C                     MOVE '1'       *IN55
     C                     END
     C*
     C** IF ACCOUNT OFFICER CODE BLANK
     C** ACCESS SDACOFL1 TO OBTAIN DEPARTMENT OF ACCOUNT
     C** OFFICER ASSIGNED TO CUSTOMER
     C*
     C                     ELSE
     C*
     C********** BBACOC    CHAINSDACOFL1             72                   S01486
     C                     CALL 'AOACOFR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBACOC    ACOKEY  2                       S01486
     C           SDACOF    PARM SDACOF    DSFDY                           S01486
     C*
     C********** AZDPCD    IFNE DEPC                                      S01486
     C           AZDPCD    IFNE DPPT                                      S01486
     C                     MOVE '1'       *IN55
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************CFFX05
      ** END OF NEW SUBROUTINE #L1002                                     CFFX05
      ********************************************************************CFFX05
      /EJECT
      ********************************************************************CFFX05
      ** NEW SUBROUTINE #P1004 INSERTED                                   CFFX05
      ********************************************************************CFFX05
      ********************************************************************
      *                                                                  *
      * #P1004   - TO PROCESS ENTER ON SCREEN 2                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      * #V1002   - TO VALIDATE SELECTIONS ON SCREEN 2                    *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1003   - TO PROCESS SCREEN 2 - SUBFILE SELECTION               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSFCT   - COUNT OF RECORDS WRITTEN TO SUBFILE                   *
      *                                                                  *
      ********************************************************************
     C           #P1004    BEGSR
     C*
     C*
     C                     CALL 'ZA0250'
     C                     MOVE '0'       *IN80
     C                     MOVE 'N'       WWVALD
     C*
     C** IF CUSTOMER ENTERED
     C*
     C           DD2CNS    IFNE *BLANKS
     C*
     C** CLEAR SELECTION FIELDS
     C*
     C                     MOVE '0'       *IN50
     C*
     C                     DO   LSTRR2    WWSFCT
     C           WWSFCT    CHAINPM0620S2             99
     C                     MOVE *BLANK    DD2SEL
     C                     UPDATPM0620S2
     C                     END
     C*
     C** RELOAD THE FIRST PAGE OF SUBFILE
     C*
     C           *IN51     IFEQ '0'
     C                     MOVE '1'       *IN30
     C                     WRITEPM0620C2
     C                     MOVE '0'       *IN30
     C*
     C                     Z-ADD0         LSTRR2
     C****       DD2CNS    SETLLSDPLCSL3                                  B08275
     C****                 READ SDPLCSL3                 31               B08275
     C********** DD2CNS    SETLLSDPLCSL1                            B08275S01486
     C**********           READ SDPLCSL1                 31         B08275S01486
     C           DD2CNS    SETLLPMPLCSLJ                                  S01486
     C                     READ PMPLCSLJ                 31               S01486
     C                     END
     C*
     C** IF SHORTNAME ENTERED ON PROMPT AFTER LAST NAME ON FILE OUTPUT
     C** ERROR
     C                     MOVE '1'       *IN30
     C                     WRITEPM0620C2
     C                     MOVE '0'       *IN30
     C                     EXSR #L1001
     C                     MOVE *BLANKS   DD2CNS
     C*
     C                     ELSE
     C*
     C** VALIDATE AND PROCESS THE SELECT FIELDS
     C*
     C                     EXSR #V1002
     C*
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      ********************************************************************CFFX05
      ** END OF NEW SUBROUTINE #P1004                                     CFFX05
      ********************************************************************CFFX05
      /EJECT
      ********************************************************************CFFX05
      ** NEW SUBROUTINE #V1002 INSERTED                                   CFFX05
      ********************************************************************CFFX05
      ********************************************************************
      *                                                                  *
      * #V1002   - TO VALIDATE SELECTIONS ON SCREEN 2                    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1004   - TO PROCESS ENTER ON SCREEN 2                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSFCT   - COUNT OF RECORDS WRITTEN TO SUBFILE                   *
      *                                                                  *
      ********************************************************************
     C           #V1002    BEGSR
     C*
     C                     MOVEA'000'     *IN,43           OFF 43-45
     C                     Z-ADD0         WWFISL  40
     C*
     C                     DO   LSTRR2    WWSFCT
     C*
     C           WWSFCT    CHAINPM0620S2             99
     C                     MOVE '0'       *IN50
     C*
     C           DD2SEL    IFNE ' '
     C*
     C********** DD2SEL    IFNE 'X'                                       CPM005
     C           DD2SEL    IFNE 'P'                                       CPM005
     C           DD2SEL    ANDNE'C'                                       CPM005
     C                     MOVE '1'       *IN50
     C                     MOVE '1'       *IN44
     C                     END
     C*
     C           *IN43     IFEQ '1'
     C                     MOVE '1'       *IN50
     C                     MOVE '1'       *IN45
     C                     END
     C*
     C           *IN43     IFEQ '0'
     C                     Z-ADDSFLRR2    WWFISL
     C                     MOVE '1'       *IN43
     C                     END
     C*
     C                     END
     C*
     C                     UPDATPM0620S2
     C*
     C                     END
     C*
     C** IF MORE THAN ONE SLECTION REVERSE IMAGE FIRST SELECTION
     C*
     C           *IN45     IFEQ '1'
     C*
     C           WWFISL    CHAINPM0620S2             99
     C                     MOVE '1'       *IN50
     C                     UPDATPM0620S2
     C                     MOVE '1'       *IN80
     C*********************MOVEL'PM62202' MSGID                           R00300
     C*********************CALL 'ZA0240'                                  R00300
     C*********************PARM           MSGID                           R00300
     C                     MOVEL'PM62202' ZAMSID                          R00300
     C                     EXSR ZASNMS                                    R00300
     C*
     C                     ELSE
     C*
     C** IF AN INVALID SELECTION - DISPLAY MESSAGE ON PAGE IN ERROR
     C*
     C           *IN44     IFEQ '1'
     C*
     C                     MOVE '1'       *IN80
     C*********************MOVEL'PM62201' MSGID                           R00300
     C*********************CALL 'ZA0240'                                  R00300
     C*********************PARM           MSGID                           R00300
     C**********           MOVEL'PM62201' ZAMSID                    R00300CPM005
     C                     MOVEL'PM62003' ZAMSID                          CPM005
     C                     EXSR ZASNMS                                    R00300
     C                     Z-ADDWWFISL    SFLRR2
     C*
     C                     ELSE
     C*
     C** IF VALID SELECTION SET UP CUSTOMER
     C*
     C           WWFISL    IFNE 0
     C           WWFISL    CHAINPM0620S2             99
     C                     MOVE DD2SSN    WWCNUM
     C****       DD2SSN    CHAINSDPLCSL3             99                   B08275
     C********** DD2SSN    CHAINSDPLCSL1             99             B08275S01486
     C                     MOVELDD2SSN    PLCUS                           S01486
     C                     CALL 'AOPLCSR0'                                S01486
     C                     PARM *BLANKS   PRTCD   7                       S01486
     C                     PARM '*KEY'    POPTN   7                       S01486
     C                     PARM           PLCUS  10                       S01486
     C           SDPLCS    PARM SDPLCS    DSFDY                           S01486
     C                     CALL 'AOCUSTR0'                                S01486
     C                     PARM *BLANKS   PRTCD                           S01486
     C                     PARM '*KEY'    POPTN                           S01486
     C                     PARM           PLCUS                           S01486
     C                     PARM           KEYST   7                       S01486
     C           SDCUST    PARM SDCUST    DSSDY                           S01486
     C                     MOVE 'Y'       WWVALD
     C*
     C                     ELSE
     C*
     C** NO SELECTIONS - RE-DISPLAY SCREEN
     C*
     C                     Z-ADDWWSTRN    SFLRR2
     C*
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************CFFX05
      ** END OF NEW SUBROUTINE #V1002                                     CFFX05
      ********************************************************************CFFX05
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V1001   - TO VALIDATE CUSTOMER SELECTION SCREEN                 *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **********ZA0240   - TO SEND ERROR MESSAGE TO SUBFILE MESSAGE      *
      * ZASNMS   - TO SEND MESSAGE TO MESSAGE QUEUE                      *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1002   - TO PROCESS SCREEN                                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCNUM   - DATA STRUCTURE FOR CUSTOMER NUMBER OR SHORTNAME       *
      * WWCNM1   - FIELD OF DATA STRUCTURE WWCNUM                        *
      * WWCNM2   - FIELD OF DATA STRUCTURE WWCNUM                        *
      * WWCUST   - CUSTOMER NUMBER                                       *
      * WWNAME   - PARAMETER FOR USER PROFILE                            *
      *                                                                  *
      ********************************************************************
     C           #V1001    BEGSR
     C**
     C                     MOVELDDCNUM    WWCNUM
     C********** WWCNUM    IFNE *BLANKS                                   S01486
     C           DDCNUM    IFNE *BLANKS                                   S01486
     C**                                                                  S01486
     C***CHECK*IF*SHORT*NAME*OR*CUSTOMER*NUMBER*ENTERED                   S01486
     C**                                                                  S01486
     C**********           TESTN          WWCNM1     83                   S01486
     C********** WWCNM2    IFEQ *BLANKS                                   S01486
     C********** *IN83     ANDEQ'1'                                       S01486
     C**                                                                  S01486
     C** CUSTOMER*NUMBER*ENTERED*MUST*REFER*TO*CURRENT*PORTFOLIO          S01486
     C** CUSTOMER OR TO A PORTFOLIO CUSTOMER WHO HAS LEFT THE BANK
     C****       WWCNM1    CHAINSDPLCSL2             72                   B08275
     C********** WWCNM1    CHAINSDPLCSL0             72             B08275S01486
     C                     MOVELDDCNUM    PLCUS                           S01486
     C                     CALL 'AOPLCSR0'                                S01486
     C                     PARM *BLANKS   PRTCD   7                       S01486
     C                     PARM '*KEY'    POPTN   7                       S01486
     C                     PARM           PLCUS  10                       S01486
     C           SDPLCS    PARM SDPLCS    DSFDY                           S01486
     C           PRTCD     IFEQ *BLANKS                                   S01486
     C                     CALL 'AOCUSTR0'                                S01486
     C                     PARM *BLANKS   PRTCD                           S01486
     C                     PARM '*KEY'    POPTN                           S01486
     C                     PARM           PLCUS                           S01486
     C                     PARM           KEYST   7                       S01486
     C           SDCUST    PARM SDCUST    DSSDY                           S01486
      *                                                                   103083
      ** If no portfolios for customer do not allow selection             103083
      *                                                                   103083
     C           PRTCD     IFEQ *BLANKS                                   103083
     C           FCPORS    ANDEQ'B'                                       110004
     C                     MOVELBBCUST    ##CNUM                          103083
     C           KCHKP     SETLLPMPORTP0                 90               103083
     C           *IN90     IFEQ '0'                                       103083
     C           KCHKP     SETLLPMCNSDD0                 90               CPM005
     C           *IN90     IFEQ '0'                                       CPM005
     C                     MOVEL'*NRF   ' PRTCD                           103083
     C                     ENDIF                                          CPM005
     C                     ENDIF                                          103083
     C                     ENDIF                                          103083
      *                                                                   103083
     C                     END                                            S01486
     C           PRTCD     IFNE *BLANKS                                   S01486
     C********** *IN72     IFEQ '1'                                       S01486
     C********** QBRECI    OREQ '*'                                 038430S01486
     C****       QBRECI    OREQ '*'                                       R37467
     C****       BBDTDL    ANDEQ0                                         R37467
     C*********************MOVEL'PM62101' MSGID                           R00300
     C*********************CALL 'ZA0240'                                  R00300
     C*********************PARM           MSGID                           R00300
     C                     MOVEL'PM62101' ZAMSID                          R00300
     C                     EXSR ZASNMS                                    R00300
     C                     MOVE '1'       *IN60
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN81
     C                     ELSE
     C                     MOVE '1'       *IN82
     C                     END
     C*
     C**********           ELSE                                           S01486
     C**
     C** SHORT NAME ENTERED
     C**
     C****       WWCNUM    CHAINSDPLCSL3             72                   B08275
     C********** WWCNUM    CHAINSDPLCSL1             72             B08275S01486
     C********** *IN72     IFEQ '1'                                       S01486
     C********** QBRECI    OREQ '*'                                 038430S01486
     C****       QBRECI    OREQ '*'                                       R37467
     C****       BBDTDL    ANDEQ0                                         R37467
     C*********************MOVEL'PM62101' MSGID                           R00300
     C*********************CALL 'ZA0240'                                  R00300
     C*********************PARM           MSGID                           R00300
     C**********           MOVEL'PM62101' ZAMSID                    R00300S01486
     C**********           EXSR ZASNMS                              R00300S01486
     C**********           MOVE '1'       *IN60                           S01486
     C**********           MOVE '1'       *IN80                           S01486
     C**********           MOVE '1'       *IN81                           S01486
     C**********           END                                            S01486
     C**********                                                          S01486
     C**********           END                                            S01486
     C**
     C** IF ENTRIES ARE VALID CHECK PORTFOLIO INDICATOR
     C**
     C****       *IN81     IFEQ '0'                                       B08275
     C****       QBPCUS    ANDNE'Y'                                       B08275
     C*********************MOVEL'PM62102' MSGID                           R00300
     C*********************CALL 'ZA0240'                                  R00300
     C*********************PARM           MSGID                           R00300
     C****                 MOVEL'PM62102' ZAMSID                          B08275
     C****                 EXSR ZASNMS                                    B08275
     C****                 MOVE '1'       *IN60                           B08275
     C****                 MOVE '1'       *IN80                           B08275
     C****                 END                                            B08275
     C**
     C                     END
     C*
     C** IF THE 'HIGH LEVEL SECURITY' FIELD ON LF/SDPORTL1
     C** IS EQUAL TO 'Y'. ACCESS LF/MUSER WITH THE USER PROFILE
     C** TO OBTAIN THE ACCOUNT OFFICER OR DEPARTMENT ASSIGNED
     C** TO THAT PROFILE.
     C**
     C********** P9HLVS    IFEQ 'Y'                                       S01486
     C           FCHLVS    IFEQ 'Y'                                       S01486
     C**
     C********** WWNAME    CHAINMUSER                71                   S01486
     C                     CALL 'AOUSERR0'                                S01486
     C                     PARM           WUAPRC  7        B:Return Cde   S01486
     C                     PARM '*KEY'    UUAPOP  7        I:Option       S01486
     C                     PARM WWNAME    UUUSID 10        I:User ProfiancS01486
     C           D@USER    PARM D@USER    DSSDY            O:MUSER fmt    S01486
     C**
     C** IF ACCOUNT OFFICER CODE NOT BLANK
     C***TEST*IF*ACCOUNT*OFFICER*CODE*NOT*EQUAL *A                        S01486
     C** TEST IF ACCOUNT OFFICER CODE NOT EQUAL "ALL"                     S01486
     C** AND NOT EQUAL TO CUSTOMER ACCOUNT OFFICER
     C**
     C********** ACOC      IFNE *BLANKS                                   S01486
     C***********ACOF      IFNE *BLANKS                             S01486083547
     C           ACFA      IFNE *BLANKS                                   083547
     C**
     C********** ACOC      IFNE '*A'                                      S01486
     C********** ACOC      ANDNEBBACOC                                    S01486
     C***********ACOF      IFNE 'ALL'                               S01486083547
     C***********ACOF      ANDNEBBACOC                              S01486083547
     C           ACFA      IFNE 'ALL'                                     083547
     C           ACFA      ANDNEBBACOC                                    083547
     C*********************MOVEL'PM62103' MSGID  10                       R00300
     C*********************CALL 'ZA0240'                                  R00300
     C*********************PARM           MSGID                           R00300
     C                     MOVEL'PM62103' ZAMSID                          R00300
     C                     EXSR ZASNMS                                    R00300
     C                     MOVE '1'       *IN80
     C                     END
     C**
     C** IF ACCOUNT OFFICER CODE BLANK
     C** ACCESS SDACOFL1 TO OBTAIN DEPARTMENT OF ACCOUNT
     C** OFFICER ASSIGNED TO CUSTOMER
     C**
     C                     ELSE
     C**
     C********** BBACOC    CHAINSDACOFL1             72                   S01486
     C                     CALL 'AOACOFR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBACOC    ACOKEY  2                       S01486
     C           SDACOF    PARM SDACOF    DSFDY                           S01486
     C**
     C********** AZDPCD    IFNE DEPC                                      S01486
     C           AZDPCD    IFNE DPPT                                      S01486
     C*********************MOVEL'PM62103' MSGID  10                       R00300
     C*********************CALL 'ZA0240'                                  R00300
     C*********************PARM           MSGID                           R00300
     C                     MOVEL'PM62103' ZAMSID                          R00300
     C                     EXSR ZASNMS                                    R00300
     C                     MOVE '1'       *IN80
     C                     END
     C**
     C                     END
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************CPM005
      /EJECT                                                              CPM005
      ********************************************************************CPM005
      *                                                                  *CPM005
      * #V100B   - TO VALIDATE DISPLAY CUSTOMER/PORTFOLIO DETAILS        *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLS:                                                *CPM005
      * ZASNMS   - TO SEND MESSAGE TO MESSAGE QUEUE                      *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLED FROM:                                          *CPM005
      * #P1002   - TO PROCESS SCREEN                                     *CPM005
      *                                                                  *CPM005
      * ROUTINE USES VARIABLES:                                          *CPM005
      *                                                                  *CPM005
      ********************************************************************CPM005
     C**                                                                  CPM005
     C           #V100B    BEGSR                                          CPM005
     C**                                                                  CPM005
     C** DISPLAY CUSTOMER/PORTFOLIO DETAILS MUST BE 'C' OR 'P' OR ' '     CPM005
     C**                                                                  CPM005
     C           DDCUPD    IFNE 'C'                                       CPM005
     C           DDCUPD    ANDNE'P'                                       CPM005
     C           DDCUPD    ANDNE*BLANKS                                   CPM005
     C                     MOVEL'PM62002' ZAMSID                          CPM005
     C                     EXSR ZASNMS                                    CPM005
     C                     MOVE '1'       *IN62                           CPM005
     C                     MOVE '1'       *IN80                           CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     ENDSR                                          CPM005
     C**                                                                  CPM005
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W1002   - TO FORMAT DETAILS FOR OUTPUT TO DTAARA *GDA           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - TO CONVERT A MIDAS DATE IN ALPHA DATE                 *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1002   - TO PROCESS SCREEN                                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCNM1   - FIELD OF DATA STRUCTURE WWCNUM                        *
      *                                                                  *
      ********************************************************************
     C           #W1002    BEGSR
     C**
     C** RUN DATE
     C**
     C                     MOVELBJMRDT    QMRUNA
     C                     Z-ADDBJRDNB    QMRDNB
     C                     MOVELBJCYCD    QMCYCD
     C**
     C** CUSTOMER NUMBER
     C**
     C**********           Z-ADD0         QMCNUM                                              CSD027
     C                     MOVE *BLANKS   QMCNUM                                              CSD027
     C**
     C           *IN82     IFEQ '1'
     C***********          MOVE WWCNM1    QMCNUM                          082390
     C                     MOVELBBCUST    QMCNUM                          082390
     C*************        MOVE QBSECO    QMSCCD                    CPM005087575
     C*************        MOVE QBINSU    QMS9VR                    CPM005087575
     C*************        MOVE QBCYSU    QMS0VR                    CPM005087575
     C                     ELSE
     C                     MOVE QBCUST    QMCNUM
     C                     END
     C**                                                                  087575
     C                     MOVE QBSECO    QMSCCD                          087575
     C                     MOVE QBINSU    QMS9VR                          087575
     C                     MOVE QBCYSU    QMS0VR                          087575
     C**                                                                  CPM005
     C                     MOVE QMCNUM    KCUST   6                       CPM005
     C**                                                                  CPM005
     C** ACCESS JOINT ACCOUNT USERS FILE                                  CPM005
     C**                                                                  CPM005
     C                     CALL 'AOJUSRR0'                                CPM005
     C                     PARM *BLANKS   @RTCD                           CPM005
     C                     PARM '*KEY   ' @OPTN                           CPM005
     C                     PARM KCUST     @CUST                           CPM005
     C                     PARM *BLANKS   @USID                           CPM005
     C           SDJUSR    PARM SDJUSR    DSFDY                           CPM005
     C**                                                                  CPM005
     C           @RTCD     IFEQ *BLANKS                    - B3           CPM005
     C                     MOVE 'Y'       QMJAID                          CPM005
     C                     ELSE                                           CPM005
     C                     MOVE 'N'       QMJAID                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** ACCESS POWER OF ATTORNEY FILE                                    CPM005
     C**                                                                  CPM005
     C                     CALL 'AOPATTR0'                                CPM005
     C                     PARM *BLANKS   @RTCD                           CPM005
     C                     PARM '*KEY   ' @OPTN                           CPM005
     C                     PARM KCUST     @CUST                           CPM005
     C                     PARM *BLANKS   @USID                           CPM005
     C           SDPATT    PARM SDPATT    DSFDY                           CPM005
     C**                                                                  CPM005
     C           @RTCD     IFEQ *BLANKS                    - B3           CPM005
     C                     MOVE 'Y'       QMPAID                          CPM005
     C                     ELSE                                           CPM005
     C                     MOVE 'N'       QMPAID                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** ACCESS CUSTOMER CREDIT CARD FILE                                 CPM005
     C**                                                                  CPM005
     C                     CALL 'AOCCRDR0'                                CPM005
     C                     PARM *BLANKS   @RTCD                           CPM005
     C                     PARM '*KEY   ' @OPTN                           CPM005
     C                     PARM KCUST     @CUST                           CPM005
     C                     PARM *BLANKS   @CANB  25                       CPM005
     C           SDCCRD    PARM SDCCRD    DSFDY                           CPM005
     C**                                                                  CPM005
     C           @RTCD     IFEQ *BLANKS                    - B3           CPM005
     C                     MOVE 'Y'       QMCCID                          CPM005
     C                     ELSE                                           CPM005
     C                     MOVE 'N'       QMCCID                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** ACCESS RELATED CUSTOMER NUMBERS FILE                             CPM005
     C**                                                                  CPM005
     C                     CALL 'AORELCR0'                                CPM005
     C                     PARM *BLANKS   @RTCD                           CPM005
     C                     PARM '*KEY   ' @OPTN                           CPM005
     C                     PARM *BLANKS   @USID                           CPM005
     C                     PARM KCUST     @CUST                           CPM005
     C           SDRELC    PARM SDRELC    DSFDY                           CPM005
     C**                                                                  CPM005
     C           @RTCD     IFEQ *BLANKS                    - B3           CPM005
     C                     MOVE 'Y'       QMREID                          CPM005
     C                     ELSE                                           CPM005
     C                     MOVE 'N'       QMREID                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     MOVE *BLANKS   QMACHD                          CPM005
     C                     MOVE *BLANKS   QMPATT                          CPM005
     C                     MOVE *BLANKS   QMSIGN                          CPM005
     C                     MOVE *BLANKS   QMCVER                          CPM005
     C                     MOVE *BLANKS   QMWRIT                          CPM005
     C                     MOVE *BLANKS   QMDOCU                          CPM005
     C**                                                                  CPM005
     C** IF F6 TAKEN AND CUSTOMER SELECTED, ACCESS POWER OF ATTORNEY      CPM005
     C** OR JOINT ACCOUNT USER TO SETUP DATA AREA                         CPM005
     C           PAR3      IFNE *BLANKS                    - B1           CPM005
     C           PAR4      ANDNE*BLANKS                                   CPM005
     C**                                                                  CPM005
     C           PAR4      IFEQ 'P'                        - B2           CPM005
     C                     CALL 'AOPATTR0'                                CPM005
     C                     PARM *BLANKS   @RTCD   7                       CPM005
     C                     PARM '*KEY   ' @OPTN   7                       CPM005
     C                     PARM PAR3      @CUST   6                       CPM005
     C                     PARM PAR2      @USID  20                       CPM005
     C           SDPATT    PARM SDPATT    DSFDY                           CPM005
     C*                                                                   CPM005
     C           @RTCD     IFEQ *BLANKS                    - B3           CPM005
     C                     MOVE F2ACHO    QMACHD                          CPM005
     C                     MOVE F2POWA    QMPATT                          CPM005
     C                     MOVE F2SIGN    QMSIGN                          CPM005
     C                     MOVE F2VECO    QMCVER                          CPM005
     C                     MOVE F2WRCO    QMWRIT                          CPM005
     C                     MOVE F2DOCI    QMDOCU                          CPM005
     C                     END                             - E3           CPM005
     C                     ELSE                            - X2           CPM005
     C                     CALL 'AOJUSRR0'                                CPM005
     C                     PARM *BLANKS   @RTCD                           CPM005
     C                     PARM '*KEY   ' @OPTN                           CPM005
     C                     PARM PAR3      @CUST                           CPM005
     C                     PARM PAR2      @USID                           CPM005
     C           SDJUSR    PARM SDJUSR    DSFDY                           CPM005
     C*                                                                   CPM005
     C           @RTCD     IFEQ *BLANKS                    - B3           CPM005
     C                     MOVE F3ACHO    QMACHD                          CPM005
     C                     MOVE F3POWA    QMPATT                          CPM005
     C                     MOVE F3SIGN    QMSIGN                          CPM005
     C                     MOVE F3VECO    QMCVER                          CPM005
     C                     MOVE F3WRCO    QMWRIT                          CPM005
     C                     MOVE F3DOCI    QMDOCU                          CPM005
     C                     END                             - E3           CPM005
     C                     END                             - E2           CPM005
     C                     END                             - E1           CPM005
     C**                                                                  CPM005
     C**
     C** TRADE / VALUE DATE POSITION
     C**
     C**********           MOVELP9TVPS    QMTVPS                          S01486
     C                     MOVELFCTVPS    QMTVPS                          S01486
     C**
     C** CUSTOMER REPORT NAME
     C**
     C                     MOVELBBCRNM    QMCRNM
     C                     MOVELBBCSSN    QMCSSN
      **                                                                  038430
      ** SHOW A BLINK MESSAGE IF THE PORFOLIO IS DELETED.                 038430
      **                                                                  038430
     C           QBRECI    IFEQ '*'                                       038430
     C                     MOVE *LOVAL    BLS                             038430
     C                     MOVE *LOVAL    BLE                             038430
     C                     BITON'246'     BLS                             038430
     C                     BITON'2'       BLE                             038430
     C                     MOVE 'DELETED 'DELETE                          038430
     C                     MOVE TOWN      QMCRTN
     C                     ELSE                                           038430
     C                     MOVELBBCRTN    QMCRTN                          R00951
     C                     END                                            038430
     C**
     C** CUSTOMER BASE CURRENCY
     C**
     C                     MOVELQBCSBY    QMCSBY
     C**
     C** CUSTOMER CURRENCY DECIMAL PLACES
     C**
     C                     Z-ADDQBBYDP    QMBYDP
     C**
     C** NATIONALITY
     C**
     C********** BBCNCZ    CHAINSDCTRYL1             72                   S01486
     C                     CALL 'AOCTRYR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBCNCZ    CTRYKY  2                       S01486
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01486
     C           @RTCD     IFEQ *BLANKS                                   S01486
     C**
     C********** *IN72     IFEQ '0'                                       S01486
     C                     MOVELA4CNNM    QMNCTX
     C                     END
     C**
     C** COUNTRY OF DOMICILE
     C**
     C********** BBCOLC    CHAINSDCTRYL1             72                   S01486
     C                     CALL 'AOCTRYR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBCOLC    CTRYKY  2                       S01486
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01486
     C           @RTCD     IFEQ *BLANKS                                   S01486
     C**
     C********** *IN72     IFEQ '0'                                       S01486
     C                     MOVELA4CNNM    QMDCTX
     C                     END
     C**
     C** LANGUAGE SPOKEN
     C**
     C                     MOVELQBLANG    QMLANG
     C**
     C** DATE OF BIRTH
     C**
     C***********          Z-ADDQBBDAT    WWDAT1                          085815
     C***********                                                         085815
     C***********WWMON1    IFGT 0                                         085815
     C***********                                                         085815
     C***********          Z-ADDWWMON1    X       20                      085815
     C***********          Z-ADDWWDAY1    WWDAY2                          085815
     C***********          Z-ADDWWYER1    WWYER2                          085815
     C***********          MOVELZMNM,X    WWMON2                          085815
     C***********                                                         085815
     C***********          MOVE WWDAT2    QMBDA1                          085815
     C***********          ELSE                                           085815
     C***********          MOVEL*BLANKS   QMBDA1                          085815
     C***********          END                                            085815
     C*                                                                   085815
     C** CASE: DB1.Date of Birth (Portfolio) is Zero                      085815
     C*                                                                   085815
     C           QBBDAT    IFEQ *ZERO                                     085815
     C                     MOVEL*BLANKS   QMBDA1                          085815
     C                     ELSE                                           085815
     C*                                                                   085815
     C** CASE: Check File Date - Rundate  *                               085815
     C*                                                                   085815
     C                     Z-ADDQBBDAT    ZDAYNO  50                      085815
     C                     EXSR ZDATE2                                    085815
     C*******              MOVELZDATE     QMBDA1                    085815092955
     C                     MOVELZADATE    QMBDA1                          092955
     C                     END                                            085815
     C**
     C** ACCOUNT OFFICER
     C**
     C                     MOVELBBACOC    QMACOC
     C**
     C** ACCOUNT OFFICER NAME
     C**
     C********** BBACOC    CHAINSDACOFL1             72                   S01486
     C                     CALL 'AOACOFR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBACOC    ACOKEY  2                       S01486
     C           SDACOF    PARM SDACOF    DSFDY                           S01486
     C**
     C********** *IN72     IFEQ '0'                                       S01486
     C           @RTCD     IFEQ *BLANKS                                   S01486
     C                     MOVELAZACON    QMACON
     C                     END
     C**
     C** SAFE INDICATOR
     C**
     C                     MOVELQBSAFI    QMSAFI
     C**
     C** DOCUMENTATION STATUS
     C**
     C                     MOVELQBDCMS    QMDCMS
     C**
     C** ATTENTION KEY ALLOWED
     C**
     C                     MOVEL'N'       QMATTN
     C**                                                                  TA0000
     C** USER LANGUAGE CODE                                               TA0000
     C**                                                                  TA0000
     C**********           MOVE DDMULT    QMMULT                    R10036S01486
     C**                                                                  SA9108
     C** POOL PORTFOLIO CUSTOMER INDICATOR                                SA9108
     C**                                                                  SA9108
     C***********FCPORS    IFNE 'B'                                 CPM004103082
     C                     MOVE QBPPCS    QMPPCS                          SA9108
     C***********          END                                      CPM004103082
     C**                                                                  S01486
     C** Customer Branch Code                                             S01486
     C**                                                                  S01486
     C                     MOVELBBBRCD    QMBRCA                          S01486
     C**
     C** ALL OTHER FIELDS BLANK OR ZERO
     C**
     C                     MOVEL*BLANKS   QMRECI
     C                     MOVEL*BLANKS   QMPTF1
     C                     MOVEL*BLANKS   QMPTF2
     C                     MOVEL*BLANKS   QMPTFN
     C                     MOVEL*BLANKS   QMTPMV
     C                     MOVEL*BLANKS   QMVPMV
     C                     MOVEL*BLANKS   QMPTAI
     C                     MOVEL*BLANKS   QMPVAI
     C                     MOVEL*BLANKS   QMPTCY
     C                     MOVEL*BLANKS   QMPTFT
     C                     MOVEL*BLANKS   QMDPO1
     C                     MOVEL*BLANKS   QMPPDG
     C                     MOVEL*BLANKS   QMDSPG
     C                     MOVEL*BLANKS   QMNDSP
     C                     MOVEL*BLANKS   QMDSPT
     C                     MOVEL*BLANKS   QMDGMV
     C                     MOVEL*BLANKS   QMDGAI
     C                     MOVEL*BLANKS   QMINNR
     C                     MOVEL*BLANKS   QMISTN
     C                     MOVEL*BLANKS   QMTIMV
     C                     MOVEL*BLANKS   QMVIMV
     C                     MOVEL*BLANKS   QMITAI
     C                     MOVEL*BLANKS   QMIVAI
     C                     MOVEL*BLANKS   QMMODI
     C                     MOVEL*BLANKS   QMSESN
     C                     MOVEL*BLANKS   QMENQT
     C                     MOVEL*BLANKS   QMDBER
     C                     MOVEL*BLANKS   QMFILE
     C                     MOVEL*BLANKS   QMPGM
     C                     MOVEL*BLANKS   QMKEY
     C                     MOVEL*BLANKS   QMUSID                          CPM005
     C                     Z-ADD0         QMPCDP
     C                     Z-ADD0         QMDSPS
     C                     Z-ADD0         QMITDS
     C**********           Z-ADD0         QMTRNB                                              CLE148
     C                     MOVEL*BLANKS   QMTRNB                                              CLE148
     C                     Z-ADD0         QMERRN
     C                     MOVEL*BLANKS   QMCPGM                          081239
     C**                                                                  CPM004
     C** PORTFOLIOS SUPPORTED INDICATOR                                   CPM004
     C**                                                                  CPM004
     C                     MOVELFCPORS    QMPORS                          CPM004
     C**
     C                     MOVEL*BLANKS   QMACTP                          CPM005
     C**                                                                  CPM005
     C                     ENDSR
     C**
     C**
      ********************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1001   - TO MAINTAIN CUSTOMER SELECTION SCREEN                 *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1001    BEGSR
     C**
     C                     MOVEL'*'       DDPGMQ
     C                     MOVE '0'       *IN98
     C                     MOVE '0'       *IN12                           CPM005
     C*                                                                   R00300
     C**   Select the program MSGQ for error msg.                         R00300
     C                     MOVEL'*'       TOPQ                            R00300
     C                     MOVEL'*PRV'    TOPRQ                           R00300
     C*                                                                   R00300
     C**   Fill in fields for subroutine ZASNMS                           R00300
     C                     MOVEL*BLANK    ZAPGM  10        Message queue  R00300
     C                     MOVEL'PMUSRMSG'ZAMSGF 10        Message file   R00300
     C                     MOVEL*BLANK    ZAPGRL  5        Rel queue      R00300
     C                     MOVEL*BLANK    ZAMSID  7        Message Id.    R00300
     C                     MOVEL*BLANK    ZAMSDA132        Message data.  R00300
     C                     MOVEL*BLANK    ZAMSTP  7        Message type.  R00300
     C*
     C** PREPARE LDA
     C*
     C           *NAMVAR   DEFN LDA       MILDA                           S01486
     C           *LOCK     IN   MILDA                                     S01486
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'PM0620'  DBPGM
     C                     OUT  MILDA                                     S01486
     C**
     C** ACCESS ICD1 FROM LF/SDBANKL1
     C**
     C**********           READ SDBANKL1                 70               S01486
     C**
     C** IF RECORD NOT FOUND DATA BASE ERROR
     C**
     C********** *IN70     IFEQ '1'                                       S01486
     C**********                                           ***************S01486
     C**********           Z-ADD1         DBASE            **DB ERROR 01**S01486
     C**********           MOVEL'SDBANKL1'DBFILE           ***************S01486
     C**********           EXSR *PSSR                                     S01486
     C**********           END                                            S01486
      *                                                                   S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*DBERR ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C*                                                                   S01486
     C**
     C** ACCESS PM INSTALLATION CONTROL DATA LF/SDPORTL1
     C**
     C**********           READ SDPORTL1                 70               S01486
     C**
     C** IF RECORD NOT FOUND DATA BASE ERROR
     C**
     C********** *IN70     IFEQ '1'                                       S01486
     C*                                                    ***************
     C**********           Z-ADD2         DBASE            **DB ERROR 02**S01486
     C**********           MOVEL'SDPORTL1'DBFILE           ***************S01486
     C**********           EXSR *PSSR                                     S01486
     C**********           END                                            S01486
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM '*DBERR ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C**
     C**********           MOVE P9R997    QMR997                          S01486
     C                     MOVE FCR997    QMR997                          S01486
     C**                                                                  CPM005
     C** DISPLAY CUSTOMER/PORTFOLIO DEFAULT                               CPM005
     C                     MOVE FCDCPD    DDCUPD                          CPM005
     C**
     C                     MOVEA'11'      *IN,28           ON 28-29       CFFX05
     C                     MOVEA'000'     *IN,43           OFF 43-45      CFFX05
     C                     MOVEA'00'      *IN,50           OFF 50-51      CFFX05
     C                     MOVE 'N'       WWVALD  1                       CFFX05
     C                     Z-ADD*ZEROS    LSTRR2  40                      CFFX05
     C*                                                                   085815
     C** ACCESS FORMAT OF RUN DATE                                        085815
     C*                                                                   085815
     C           *NAMVAR   DEFN           RUNDAT                          085815
     C                     IN   RUNDAT                                    085815
     C           DFF       IFEQ 'M'                                       085815
     C                     SETON                     98                   085815
     C                     END                                            085815
     C**                                                                  R10036
     C** ACCESS LF/MUSER WITH THE USER PROFILE                            R10036
     C** TO OBTAIN THE DEFAULT USER LANGUAGE CODE                         R10036
     C**                                                                  R10036
     C********** WWNAME    CHAINMUSER                71             R10036S01486
     C**********           MOVE MULT      DDMULT                    R10036S01486
     C**
     C*                                                                   CPM005
     C**  READ IN ZMUSER                                                  CPM005
     C*                                                                   CPM005
     C           *NAMVAR   DEFN           ZMUSER                          CPM005
     C                     IN   ZMUSER                                    CPM005
     C*                                                                   CPM005
     C**  CHECK IF USER IS AUTHORISED TO ACTION 'ENQUIRY'                 CPM005
     C*                                                                   CPM005
     C           MBIN      IFNE 'Y'                                       CPM005
     C*                                                                   CPM005
     C**  IF SINGLE BRANCH ENVIRONMENT                                    CPM005
     C*                                                                   CPM005
     C                     CALL 'ZVACTU'                                  CPM005
     C                     PARM 'E'       WLACTN  1                       CPM005
     C                     PARM *ZERO     WLERR   10                      CPM005
     C*                                                                   CPM005
     C                     ELSE                                           CPM005
     C*                                                                   CPM005
     C**  IF MULTIBRANCHING ENVIRONMENT                                   CPM005
     C*                                                                   CPM005
     C                     CALL 'ZVACTBU'                                 CPM005
     C                     PARM 'E'       WLACTN  1                       CPM005
     C                     PARM USRBCH    WLBRCH  3                       CPM005
     C                     PARM *ZERO     WLERR   10                      CPM005
     C*                                                                   CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C                     ENDSR
     C**
      /EJECT
      ********************************************************************
     C*                                                               *   R00300
     C* ZASNMS   - Send message to program message queue              *   R00300
     C*                                                               *   R00300
     C* CALLS    Y2SNMSGC                                             *   R00300
     C*                                                               *   R00300
     C* CALLED BY  #V1001 - Validate customer selection screen.       *   R00300
     C*                                                               *   R00300
     C*****************************************************************   R00300
     C           ZASNMS    BEGSR                                          R00300
     C*                                                                   R00300
     C                     CALL 'Y2SNMGC'                                 R00300
     C                     PARM           ZAPGM            Program queue  R00300
     C                     PARM           ZAPGRL           Rel queue      R00300
     C                     PARM           ZAMSID           Message Id.    R00300
     C                     PARM           ZAMSGF           Message file.  R00300
     C                     PARM           ZAMSDA           Message data.  R00300
     C                     PARM           ZAMSTP           Message type.  R00300
     C*                                                                   R00300
     C** Clear all fields for default mechanism next time.                R00300
     C                     MOVEL*BLANK    ZAPGM            Message queue  R00300
     C                     MOVEL*BLANK    ZAPGRL           Rel queue      R00300
     C                     MOVEL*BLANK    ZAMSDA           Message data.  R00300
     C                     MOVEL*BLANK    ZAMSTP           Message type.  R00300
     C*                                                                   R00300
     C           ZASNM9    ENDSR                           ZASNM9 TAG     R00300
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1001   - TO MAINTAIN CUSTOMER SELECTION SCREEN                 *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           *PSSR     BEGSR
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     DUMP
     C**
     C                     MOVE '1'       *INLR
     C**
     C                     ENDSR
     C********************************************************************
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  CPY@
(c) Finastra International Limited 2001
