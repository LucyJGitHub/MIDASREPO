     H
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Deleted Customer Selection')                  *
     F*****************************************************************
     F*                                                               *
     F*  Midas - PORTFOLIO MANAGEMENT                                 *
     F*                                                               *
     F*  PM0625 - DELETED CUSTOMER SELECTION SCREEN                   *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *  Prev Amend No. CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 TDA035             Date 02Apr04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CGL008             Date 03Mar99               *
      *                 CPM005             Date 29Jul96               *
      *                 101497             Date 28Mar96               *
     F*                 CPM004             Date 16Feb96               *
     F*                 092955             DATE 13SEP95               *
     F*                 092513             DATE  2AUG95               *
     F*                 085815             DATE  4JUN95               *
     F*                 085817             DATE 13MAR95               *
     F*                 083547             DATE 20FEB95               *
     F*                 S01486             DATE 08JUL94               *
     F*                 038430             DATE 03AUG93               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CRE026 - Consumer Banking                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  TDA035 - RTS Signon changes for MidasPlus. (Recompile)       *
      *  CGL008 - Security on Journal Entry. Recompile.               *
     F*  CPM005 - Private Banking Phase II                            *
     F*           Focus Group Changes Upgraded to DBA                 *
     F*           Just Recompiled because of PM File(s) changes       *
     F*  101497 - Branch needs to be output to PMLDAPD                *
     F*  CPM004 - Bank Portfolios                                     *
     F*  092955 - CORRECT FORMATTING OF DATE OF BIRTH                 *
     F*  092513 - Account Officer can equal ALL not *A                *
     F*  085817 - Recompile due to changes in PMLDAPD                 *
     F*  083547 - Correcting Account Officer name on MUSERDD          *
     F*  S01486 - Portfolio Management Upgrade                        *
     F*  038430 - CREATED FOR 38430  CUSTOMER INSERTION/DELETION      *
     F*           PROCESSING CHGS                                     *
     F*                                                               *
     F*****************************************************************
     F**
     F****SDBANKL1IF  E           K        DISK                           S01486
     F********************************************* KINFSR *PSSR          S01486
     F***PREFIX*'BJ' **                                                   S01486
     F**
     F****SDLANGL0IF  E           K        DISK                           S01486
     F********************************************* KINFSR *PSSR          S01486
     F**
     F****SDACOFL1IF  E           K        DISK                           S01486
     F********************************************* KINFSR *PSSR          S01486
     F***PREFIX*'AZ' **                                                   S01486
     F**
     F****SDPCSDL0IF  E           K        DISK                           S01486
     FPMPCSDL0IF  E           K        DISK                               S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'QB' **
     F**
     F***SDPCSDL1IF  E           K        DISK                            S01486
     FPMPCSDL1IF  E           K        DISK                               S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'QB' **
     F**
     F****MUSER   IF  E           K        DISK                           S01486
     F********************************************* KINFSR *PSSR          S01486
     F**
     F****SDPORTL1IF  E           K        DISK                           S01486
     F********************************************* KINFSR *PSSR          S01486
     F***PREFIX*'P9'***                                                   S01486
     F**
     F****SDCTRYL1IF  E           K        DISK                           S01486
     F********************************************* KINFSR *PSSR          S01486
     F***PREFIX*'A4'***                                                   S01486
     F**
     F*
     F****PM0625DDCF  E                    WORKSTN                        S01486
     FPM0625DFCF  E                    WORKSTN                            S01486
     F                                        SFLRR2KSFILE PM0625S2
     F                                              KINFDS FIDS01
     F******************************************************************
     F**
     F** FUNCTION OF INDICATORS
     F**
     F******************************************************************
     F**
     F** LR      : END OF PROGRAM
     F**
     F** U7      : DATA BASE ERROR
     F** U8      : DATA BASE ERROR
     F** KC      : EXIT OF PROGRAM
     F**
     F** 27      : ROLLUP
     F** 28      : SFLDSP
     F** 29      : SFLDSPCTL
     F** 30      : SFLCLR
     F** 31      : SFLEND
     F** 32      : SFLNXTCHG
     F**
     F** 43      : AT LEAST ONE SELECTION ON SCREEN 2
     F** 44      : AT LEAST ONE INVALID SELECTION ON SCREEN 2
     F** 45      : MORE THAN ONE SELECTION ON SCREEN 2
     F**
     F** 50      : (RI PC) ON SCREEN 2 SELECTION FIELD
     F** 51      : (RI PC) ON SCREEN 2 CUSTOMER FIELD
     F**
     F** 55      : RECORD TO BE WRITTEN TO SUBFILE
     F**
     F** 70 - 73 : FILE PROCESSING
     F**
     F** 80 - 83 : WORK INDICATORS
     F**
     F******************************************************************
      /COPY ZSRSRC,ZDATE2Z1
     E**
     E                    CPY@    1   1 80
     E*
     E** Array containing Copyright statement
     E*
     I******************************************************************
     I**
     I** EXTERNAL FORMAT FOR GROUP DATA AREA
     I**
     I****WWGDA     E DSPMGRDAPP                                          S01486
     I**
     I****WWLDA     E DSPMLDAPP                                           S01486
     IWWLDA     E DSPMLDAPD                                               S01486
     I**
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     ILDA        UDS                            256
     I************************************* 132 183 DBLOT                 S01486
     I                                      134 183 DBLOT                 S01486
     I**********                            132 141 DBFILE                S01486
     I                                      134 141 DBFILE                S01486
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I*
     IPSDS       SDS
     I************************************* 244 253 WSID                  S01486
     I************************************* 254 263 USID                  S01486
     I                                      244 253 WKSTN                 S01486
     I                                      254 263 USER                  S01486
     I*
     I** FILE INFORMATION DATA STRUCTURE
     I*
     IFIDS01      DS
     I                                    B 378 3790DSLRR2
     I**
     I** DATA STRUCTURE FOR CUSTOMER NUMBER
     I**
     I            DS
     I                                        1  10 WWCNUM
     I**********                                                          S01486
     I                                        1   1 WWPTMK
     I**********                                                          S01486
     I                                        1   6 WWCNM1
     I                                        7  10 WWCNM2
     I**
     I** DATA STRUCTURE FOR DATE OF BIRTH (READ FROM FILE)
     I**
     I            DS
     I                                        1   60WWDAT1
     I                                        1   20WWDAY1
     I                                        3   40WWMON1
     I                                        5   60WWYER1
     I**
     I** DATA STRUCTURE FOR DATE OF BIRTH (CONVERTED AS PARAMETER)
     I**
     I            DS
     I                                        1   7 WWDAT2
     I                                        1   20WWDAY2
     I                                        3   5 WWMON2
     I                                        6   70WWYER2
     I**
     I** DATA STRUCTURE FOR SHOW A BLINK MESSAGE FOR DELETED PORTFOLIO
     I**
     I            DS
     I                                        1   1 BLS
     I                                        2   9 DELETE
     I                                       10  10 BLE
     I                                        1  10 TOWN
     I*                                                                   085815
     IRUNDAT      DS                                                      085815
     I                                        1   7 MRDT                  085815
     I                                    P   8  100RDNB                  085815
     I                                       11  11 SUC                   085815
     I                                       12  12 DFF                   085815
     I                                       13  13 MBIN                  085815
     I*                                                                   085815
     ISDBANK    E DSSDBANKPD                                              S01486
     I* Bank Details Accesses Via Access Program                          S01486
     I*                                                                   S01486
     ID@USER    E DSMUSERDD                                               S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              S01486
     I* Portfolio Definition Via Access Program                           S01486
     I*                                                                   S01486
     ISDACOF    E DSSDACOFPD                                              S01486
      **  EXTERNAL DS FOR ACCOUNT OFFICER DETAILS                         S01486
     I*                                                                   S01486
     ISDCTRY    E DSSDCTRYPD                                              S01486
      **  EXTERNAL DS FOR COUNTRY DETAILS                                 S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* First DS For Access Programs, Short Data Structure                S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* Second DS For Access Programs, Long Data Structure                S01486
     I*                                                                   S01486
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #P1001   - TO ACCESS STANDING DATA AND INITIALIZE WORK FIELDS    *
      * #P1002   - TO PROCESS SCREEN                                     *
      * #P1003   - TO PROCESS SCREEN 2 - CUSTOMER SELECTION              *
      * #P1004   - TO PROCESS ENTER ON SCREEN 2                          *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      * #L1002   - CHECKS IF VALID RECORD TO BE WRITTEN TO SUBFILE       *
      * #V1001   - TO VALIDATE CUSTOMER SELECTION SCREEN                 *
      * #V1002   - TO VALIDATE SELECTIONS ON SCREEN 2                    *
      **#W1002***-*TO*FORMAT*DETAILS*FOR*OUTPUT*TO*DTAARA *GDA************S01486
      * #W1002   - TO FORMAT DETAILS FOR OUTPUT TO DTAARA *LDA           *S01486
      * ZDATE2   - TO CONVERT A MIDAS DATE IN ALPHA DATE                 *
      * ZASNMS   - TO SEND MESSAGE TO PROGRAM MESSAGE QUEUE              *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      * PMC1001  - TO OUTPUT DETAILS TO DTAARA *LDA                      *
      **PMC1002**-*TO*OUTPUT*DETAILS*TO*DTAARA *GDA***********************S01486
      * PMC1002  - TO OUTPUT DETAILS TO DTAARA *LDA                      *S01486
      * PMC0621  - TO START GROUP JOB                                    *
      **PMC1004**-*TO*RETRIEVE*CONTENTS*OF*DTAARA *GDA********************S01486
      *********ZA0240   - TO SEND ERROR MESSAGE TO SUBFILE MESSAGE       *
      * Y2SNMGC  - TO SEND ERROR MESSAGE TO PROGRAM MESSAGE QUEUE        *
      * Y2CLMSC  - TO CLEAR PROGRAM MESSAGE QUEUE                        *
      *                                                                  *
      ********************************************************************
     C****************************************************************
     C**   PROGRAM    START
     C****************************************************************
     C*
     C                     MOVEACPY@      CPY2@  80
     C           *ENTRY    PLIST
     C                     PARM           WWNAME 10
     C**
     C** PROCESS INITIALIZATION
     C**
     C                     EXSR #P1001
     C**
     C** PROCESS UNTIL F3 TAKEN OR F12 TAKEN OR END ENQUIRIES REQUESTED
     C**
     C           *INKC     DOUEQ'1'
     C           QMENQT    OREQ 'Y'
     C**
     C                     EXSR #P1002
     C**
     C                     END
     C**
     C                     MOVE '1'       *INLR
     C**
     C****************************************************************
     C**   PROGRAM    END
     C****************************************************************
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1002   - TO PROCESS SCREEN                                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #V1001   - TO VALIDATE CUSTOMER SELECTION SCREEN                 *
      **#W1002***-*TO*FORMAT*DETAILS*FOR*OUTPUT*TO*DTAARA *GDA************S01486
      * #W1002   - TO FORMAT DETAILS FOR OUTPUT TO DTAARA *LDA           *S01486
      * PMC1001  - TO OUTPUT DETAILS TO DTAARA *LDA                      *
      **PMC1002**-*TO*OUTPUT*DETAILS*TO*DTAARA *GDA***********************S01486
      * PMC1002  - TO OUTPUT DETAILS TO DTAARA *LDA                      *S01486
      * PMC0621  - TO START GROUP JOB                                    *
      **PMC1004**-*TO*RETRIEVE*CONTENTS*OF*DTAARA *GDA********************S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      **WWPARM***-*PARAMETER*FOR*CALLED*PROGRAMS*-*DATAS*OF *GDA**********S01486
      * WWPARM   - PARAMETER FOR CALLED PROGRAMS - DATAS OF *LDA         *S01486
      *                                                                  *
      ********************************************************************
     C           #P1002    BEGSR
     C**
     C                     MOVELBJMRDT    DDRUNA
     C**
     C                     WRITEPM0625F0
     C                     EXFMTPM0625F1
     C                     MOVE '0'       *IN60
     C                     MOVE '0'       *IN61
     C                     MOVE '0'       *IN80
     C                     MOVE '0'       *IN81
     C                     MOVE '0'       *IN82
     C*
     C**  Clear program message queue.
     C                     CALL 'Y2CLMSC'
     C                     PARM           TOPQ   10
     C                     PARM           TOPRQ   5
     C**
     C** IF F3 NOT TAKEN, ENTER PRESSED
     C**
     C           *INKC     IFEQ '0'
     C**
     C** CHECK VALIDITY OF USER LANGUAGE CODE
     C**
     C********** DDMULT    CHAINSDLANGL0             74                   S01486
     C********** *IN74     IFEQ '1'                                       S01486
     C**********           MOVEL'PM62001' ZAMSID                          S01486
     C**********           EXSR ZASNMS                                    S01486
     C**********           MOVE '1'       *IN61                           S01486
     C**********           MOVE '1'       *IN80                           S01486
     C**
     C**********           ELSE                                           S01486
     C**
     C** IF CUSTOMER NUMBER/SHORTNAME NOT ENTERED
     C**
     C           DDCNUM    IFEQ *BLANKS
     C           WWPTMK    OREQ '?'                                       S01486
     C**
     C** PROCESS SCREEN 2 - CUSTOMER SELECTION
     C**
     C                     EXSR #P1003
     C*
     C** CLEAR SUBFILE
     C*
     C                     MOVEA'001'     *IN,28           OFF 28-29 ON 30
     C                     WRITEPM0625C2
     C                     MOVEA'110'     *IN,28           ON 28-29 OFF 30
     C                     Z-ADD0         LSTRR2
     C**
     C                     ELSE
     C**
     C** VALIDATE CUSTOMER NUMBER OR SHORTNAME
     C**
     C                     EXSR #V1001
     C**
     C                     END
     C**
     C                     END
     C**
     C**********           END                                            S01486
     C**
     C** IF F3 OR F12 NOT TAKEN
     C**
     C           *INKC     IFEQ '0'
     C           *INKL     ANDEQ'0'
     C**
     C** IF INPUT IS VALID  FORMAT DETAILS FOR OUTPUT TO
     C** DTAARA/*LDA AND CALL PROGRAMS TO UPDATE DTAARA
     C** AND TO START GROUP JOB
     C**
     C           *IN80     IFEQ '0'
     C**
     C                     EXSR #W1002
     C**
     C                     CALL 'PMC1001'
     C                     PARM           WWLDA
     C**
     C**********           CALL 'PMC1002'                                 S01486
     C**********           PARM           WWGDA                           S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C**********           CALL 'PMC0626'                                 S01486
     C                     CALL 'PMC0635'                                 S01486
     C**
     C                     MOVEL*BLANKS   DDCNUM
     C**
     C***RETRIEVE*CONTENTS*OF*DTAARA *GDA                                 S01486
     C** RETRIEVE CONTENTS OF DTAARA *LDA                                 S01486
     C**
     C**********           CALL 'PMC1004'                                 S01486
     C**********           PARM           WWGDA                           S01486
     C                     CALL 'PMC1003'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C           QMDBER    IFEQ 'Y'                        ****************
     C                     Z-ADDQMERRN    DBASE            **DB ERROR 03 **
     C                     MOVELQMPGM     DBPGM            ****************
     C                     MOVELQMFILE    DBFILE
     C                     MOVELQMKEY     DBKEY
     C                     END
     C**
     C                     END
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      ** NEW SUBROUTINE #P1003 INSERTED
      ********************************************************************
      ********************************************************************
      *                                                                  *
      * #P1003   - TO PROCESS SCREEN 2 - CUSTOMER SELECTION              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      * #P1004   - TO PROCESS ENTER ON SCREEN 2                          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1002   - TO PROCESS SCREEN                                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWVALD   - SCREEN VALID FLAG                                     *
      * WWSTRN   - STORES RRN OF CURRENT SCREEN                          *
      *                                                                  *
      ********************************************************************
     C           #P1003    BEGSR
     C*
     C** LOAD FIRST PAGE OF SUBFILE RECORDS
     C*
     C********** *LOVAL    SETLLSDPCSDL1                                  S01486
     C**********           READ SDPCSDL1                 31               S01486
     C           *LOVAL    SETLLPMPCSDL1                                  S01486
     C                     READ PMPCSDL1                 31               S01486
     C                     EXSR #L1001
     C*
     C                     MOVE '0'       *IN80
     C                     MOVE 'N'       WWVALD
     C*
     C** PROCESS SCREEN 2 UNTIL CMD-3 OR SCREEN VALID
     C*
     C           *INKC     DOWEQ'0'
     C           WWVALD    ANDEQ'N'
      *
      ** DO NOT SHOW THE SUBFILE IF THERE'S NO RECORD
      *
     C           SFLRR2    IFEQ 0
     C                     SETOF                     28
     C                     ELSE
     C                     SETON                     28
     C                     END
     C*
     C                     WRITEPM0625F2
     C                     WRITEPM0625C2
     C           *IN80     IFEQ '1'
     C                     WRITEPM0625F0
     C                     END
     C*                    READ PM0625C2                 99
     C                     EXFMTPM0625C2
     C*
     C           DSLRR2    IFEQ 0
     C                     Z-ADDSFLRR2    WWSTRN  40
     C                     ELSE
     C                     Z-ADDDSLRR2    WWSTRN
     C                     END
     C*
     C           *INKC     IFEQ '0'                        CMD-3
     C*
     C           *INKL     IFEQ '1'                        CMD-12
     C*
     C                     MOVE *BLANKS   DDCNUM
     C                     MOVE '0'       *IN80
     C                     MOVE 'Y'       WWVALD
     C                     CALL 'ZA0250'
     C*
     C                     ELSE
     C*
     C           *IN27     CASEQ'1'       #L1001           ROLLUP
     C                     CAS            #P1004           ENTER
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      ** END OF NEW SUBROUTINE #P1003
      ********************************************************************
      /EJECT
      ********************************************************************
      ** NEW SUBROUTINE #L1001 INSERTED
      ********************************************************************
      ********************************************************************
      *                                                                  *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1003   - TO PROCESS SCREEN 2 - CUSTOMER SELECTION              *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSFCT   - COUNT OF RECORDS WRITTEN TO SUBFILE                   *
      *                                                                  *
      ********************************************************************
     C           #L1001    BEGSR
     C*
     C                     Z-ADDLSTRR2    SFLRR2
     C                     Z-ADD0         WWSFCT  40
     C                     MOVE *BLANK    DD2SEL
     C                     MOVE '0'       *IN50
     C                     MOVE '0'       *IN55
     C*
     C           *IN31     DOWEQ'0'
     C           WWSFCT    ANDLT15
     C*
     C** CHECK IF VALID PORTFOLIO RECORD
     C*
     C                     EXSR #L1002
     C*
     C** IF VALID WRITE TO SUBFILE
     C*
     C           *IN55     IFEQ '0'
     C           QBRECI    ANDEQ'D'
     C*
     C           QBRECI    IFEQ 'D'
     C                     MOVE *BLANKS   DDSTAT
     C                     ELSE
     C                     MOVE 'D'       DDSTAT
     C                     END
     C*
     C                     MOVE BBCSSN    DD2SSN
     C                     MOVE BBCUST    DD2UST
     C                     MOVE BBCRNM    DD2RNM
     C                     MOVE BBCRTN    DD2RTN
     C*
     C                     ADD  1         WWSFCT
     C                     ADD  1         SFLRR2
     C                     WRITEPM0625S2
     C*
     C                     END
     C*
     C**********           READ SDPCSDL1                 31               S01486
     C                     READ PMPCSDL1                 31               S01486
     C*
     C                     END
     C*
     C                     Z-ADDSFLRR2    LSTRR2
     C*
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      ** END OF NEW SUBROUTINE #L1001
      ********************************************************************
      /EJECT
      ********************************************************************
      ** NEW SUBROUTINE #L1002 INSERTED
      ********************************************************************
      ********************************************************************
      *                                                                  *
      * #L1002   - TO CHECK IF RECORD SHOULD BE WRITTEN TO THE SUBFILE   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #L1002    BEGSR
     C*
     C                     MOVE '0'       *IN55
     C*
     C** IF THE 'HIGH LEVEL SECURITY' FIELD ON LF/SDPORTL1
     C** IS EQUAL TO 'Y'. ACCESS LF/MUSER WITH THE USER PROFILE
     C** TO OBTAIN THE ACCOUNT OFFICER OR DEPARTMENT ASSIGNED
     C** TO THAT PROFILE.
     C*
     C********** P9HLVS    IFEQ 'Y'                                       S01486
     C           FCHLVS    IFEQ 'Y'
     C*
     C********** WWNAME    CHAINMUSER                71                   S01486
     C                     CALL 'AOUSERR0'                                S01486
     C                     PARM           WUAPRC  7        B:Return Cde   S01486
     C                     PARM '*KEY'    UUAPOP  7        I:Option       S01486
     C                     PARM WWNAME    UUUSID 10        I:User ProfiancS01486
     C           D@USER    PARM D@USER    DSSDY            O:MUSER fmt    S01486
     C*
     C** IF ACCOUNT OFFICER CODE NOT BLANK
     C***TEST*IF*ACCOUNT*OFFICER*CODE*NOT*EQUAL**A************************092513
     C** TEST IF ACCOUNT OFFICER CODE NOT EQUAL ALL                       092513
     C** AND NOT EQUAL TO CUSTOMER ACCOUNT OFFICER
     C*
     C********** ACOC      IFNE *BLANKS                                   S01486
     C***********ACOF      IFNE *BLANKS                             S01486083547
     C           ACFA      IFNE *BLANKS                                   083547
     C*
     C********** ACOC      IFNE '*A'                                      S01486
     C********** ACOC      ANDNEBBACOC                                    S01486
     C***********ACOF      IFNE '*A'                                S01486083547
     C***********ACOF      ANDNEBBACOC                              S01486083547
     C***********ACFA      IFNE '*A'                                083547092513
     C           ACFA      IFNE 'ALL'                                     092513
     C           ACFA      ANDNEBBACOC                                    083547
     C                     MOVE '1'       *IN55
     C                     END
     C*
     C** IF ACCOUNT OFFICER CODE BLANK
     C** ACCESS SDACOFL1 TO OBTAIN DEPARTMENT OF ACCOUNT
     C** OFFICER ASSIGNED TO CUSTOMER
     C*
     C                     ELSE
     C*
     C********** BBACOC    CHAINSDACOFL1             72                   S01486
     C                     CALL 'AOACOFR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBACOC    ACOKEY  2                       S01486
     C           SDACOF    PARM SDACOF    DSFDY                           S01486
     C*
     C********** AZDPCD    IFNE DEPC                                      S01486
     C           AZDPCD    IFNE DPPT                                      S01486
     C                     MOVE '1'       *IN55
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      ** END OF NEW SUBROUTINE #L1002
      ********************************************************************
      /EJECT
      ********************************************************************
      ** NEW SUBROUTINE #P1004 INSERTED
      ********************************************************************
      ********************************************************************
      *                                                                  *
      * #P1004   - TO PROCESS ENTER ON SCREEN 2                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      * #V1002   - TO VALIDATE SELECTIONS ON SCREEN 2                    *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1003   - TO PROCESS SCREEN 2 - SUBFILE SELECTION               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSFCT   - COUNT OF RECORDS WRITTEN TO SUBFILE                   *
      *                                                                  *
      ********************************************************************
     C           #P1004    BEGSR
     C*
     C*
     C                     CALL 'ZA0250'
     C                     MOVE '0'       *IN80
     C                     MOVE 'N'       WWVALD
     C*
     C** IF CUSTOMER ENTERED
     C*
     C           DD2CNS    IFNE *BLANKS
     C*
     C** CLEAR SELECTION FIELDS
     C*
     C                     MOVE '0'       *IN50
     C*
     C                     DO   LSTRR2    WWSFCT
     C           WWSFCT    CHAINPM0625S2             99
     C                     MOVE *BLANK    DD2SEL
     C                     UPDATPM0625S2
     C                     END
     C*
     C** RELOAD THE FIRST PAGE OF SUBFILE
     C*
     C           *IN51     IFEQ '0'
     C                     MOVE '1'       *IN30
     C                     WRITEPM0625C2
     C                     MOVE '0'       *IN30
     C*
     C                     Z-ADD0         LSTRR2
     C********** DD2CNS    SETLLSDPCSDL1                                  S01486
     C**********           READ SDPCSDL1                 31               S01486
     C           DD2CNS    SETLLPMPCSDL1                                  S01486
     C                     READ PMPCSDL1                 31               S01486
     C                     END
     C*
     C** IF SHORTNAME ENTERED ON PROMPT AFTER LAST NAME ON FILE OUTPUT
     C** ERROR
     C                     MOVE '1'       *IN30
     C                     WRITEPM0625C2
     C                     MOVE '0'       *IN30
     C                     EXSR #L1001
     C                     MOVE *BLANKS   DD2CNS
     C*
     C                     ELSE
     C*
     C** VALIDATE AND PROCESS THE SELECT FIELDS
     C*
     C                     EXSR #V1002
     C*
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      ********************************************************************
      ** END OF NEW SUBROUTINE #P1004
      ********************************************************************
      /EJECT
      ********************************************************************
      ** NEW SUBROUTINE #V1002 INSERTED
      ********************************************************************
      ********************************************************************
      *                                                                  *
      * #V1002   - TO VALIDATE SELECTIONS ON SCREEN 2                    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #L1001   - TO LOAD A PAGE OF SUBFILE RECORDS                     *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1004   - TO PROCESS ENTER ON SCREEN 2                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWSFCT   - COUNT OF RECORDS WRITTEN TO SUBFILE                   *
      *                                                                  *
      ********************************************************************
     C           #V1002    BEGSR
     C*
     C                     MOVEA'000'     *IN,43           OFF 43-45
     C                     Z-ADD0         WWFISL  40
     C*
     C                     DO   LSTRR2    WWSFCT
     C*
     C           WWSFCT    CHAINPM0625S2             99
     C                     MOVE '0'       *IN50
     C*
     C           DD2SEL    IFNE ' '
     C*
     C           DD2SEL    IFNE 'X'
     C                     MOVE '1'       *IN50
     C                     MOVE '1'       *IN44
     C                     END
     C*
     C           *IN43     IFEQ '1'
     C                     MOVE '1'       *IN50
     C                     MOVE '1'       *IN45
     C                     END
     C*
     C           *IN43     IFEQ '0'
     C                     Z-ADDSFLRR2    WWFISL
     C                     MOVE '1'       *IN43
     C                     END
     C*
     C                     END
     C*
     C                     UPDATPM0625S2
     C*
     C                     END
     C*
     C** IF MORE THAN ONE SLECTION REVERSE IMAGE FIRST SELECTION
     C*
     C           *IN45     IFEQ '1'
     C*
     C           WWFISL    CHAINPM0625S2             99
     C                     MOVE '1'       *IN50
     C                     UPDATPM0625S2
     C                     MOVE '1'       *IN80
     C                     MOVEL'PM62202' ZAMSID
     C                     EXSR ZASNMS
     C*
     C                     ELSE
     C*
     C** IF AN INVALID SELECTION - DISPLAY MESSAGE ON PAGE IN ERROR
     C*
     C           *IN44     IFEQ '1'
     C*
     C                     MOVE '1'       *IN80
     C                     MOVEL'PM62201' ZAMSID
     C                     EXSR ZASNMS
     C                     Z-ADDWWFISL    SFLRR2
     C*
     C                     ELSE
     C*
     C** IF VALID SELECTION SET UP CUSTOMER
     C*
     C           WWFISL    IFNE 0
     C           WWFISL    CHAINPM0625S2             99
     C                     MOVE DD2SSN    WWCNUM
     C********** DD2SSN    CHAINSDPCSDL1             99                   S01486
     C           DD2SSN    CHAINPMPCSDL1             99                   S01486
     C                     MOVE 'Y'       WWVALD
     C*
     C                     ELSE
     C*
     C** NO SELECTIONS - RE-DISPLAY SCREEN
     C*
     C                     Z-ADDWWSTRN    SFLRR2
     C*
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      ** END OF NEW SUBROUTINE #V1002
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V1001   - TO VALIDATE CUSTOMER SELECTION SCREEN                 *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZASNMS   - TO SEND MESSAGE TO MESSAGE QUEUE                      *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1002   - TO PROCESS SCREEN                                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCNUM   - DATA STRUCTURE FOR CUSTOMER NUMBER OR SHORTNAME       *
      * WWCNM1   - FIELD OF DATA STRUCTURE WWCNUM                        *
      * WWCNM2   - FIELD OF DATA STRUCTURE WWCNUM                        *
      * WWCUST   - CUSTOMER NUMBER                                       *
      * WWNAME   - PARAMETER FOR USER PROFILE                            *
      *                                                                  *
      ********************************************************************
     C           #V1001    BEGSR
     C**
     C                     MOVELDDCNUM    WWCNUM
     C           WWCNUM    IFNE *BLANKS
     C**
     C** CHECK IF SHORT NAME OR CUSTOMER NUMBER ENTERED
     C**
     C**********           TESTN          WWCNM1     83                                       CSD027
     C           WWCNM2    IFEQ *BLANKS
     C********** *IN83     ANDEQ'1'                                                           CSD027
     C**
     C** CUSTOMER NUMBER ENTERED MUST REFER TO CURRENT PORTFOLIO
     C** CUSTOMER
     C********** WWCNM1    CHAINSDPCSDL0             72                   S01486
     C           WWCNM1    CHAINPMPCSDL0             72                   S01486
     C           *IN72     IFEQ '1'
     C                     MOVEL'PM62501' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN81
     C                     ELSE
     C                     MOVE '1'       *IN82
     C                     END
     C*
     C                     ELSE
     C**
     C** SHORT NAME ENTERED
     C**
     C********** WWCNUM    CHAINSDPCSDL1             72                   S01486
     C           WWCNUM    CHAINPMPCSDL1             72                   S01486
     C           *IN72     IFEQ '1'
     C                     MOVEL'PM62501' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN60
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN81
     C                     END
     C*
     C                     END
     C                     END
     C*
     C** IF THE 'HIGH LEVEL SECURITY' FIELD ON LF/SDPORTL1
     C** IS EQUAL TO 'Y'. ACCESS LF/MUSER WITH THE USER PROFILE
     C** TO OBTAIN THE ACCOUNT OFFICER OR DEPARTMENT ASSIGNED
     C** TO THAT PROFILE.
     C**
     C********** P9HLVS    IFEQ 'Y'                                       S01486
     C           FCHLVS    IFEQ 'Y'                                       S01486
     C**
     C********** WWNAME    CHAINMUSER                71                   S01486
     C                     CALL 'AOUSERR0'                                S01486
     C                     PARM           WUAPRC  7        B:Return Cde   S01486
     C                     PARM '*KEY'    UUAPOP  7        I:Option       S01486
     C                     PARM WWNAME    UUUSID 10        I:User ProfiancS01486
     C           D@USER    PARM D@USER    DSSDY            O:MUSER fmt    S01486
     C**
     C** IF ACCOUNT OFFICER CODE NOT BLANK
     C***TEST*IF*ACCOUNT*OFFICER*CODE*NOT*EQUAL**A************************092513
     C** TEST IF ACCOUNT OFFICER CODE NOT EQUAL ALL                       092513
     C** AND NOT EQUAL TO CUSTOMER ACCOUNT OFFICER
     C**
     C********** ACOC      IFNE *BLANKS                                   S01486
     C***********ACOF      IFNE *BLANKS                             S01486083547
     C           ACFA      IFNE *BLANKS                                   083547
     C**
     C********** ACOC      IFNE '*A'                                      S01486
     C********** ACOC      ANDNEBBACOC                                    S01486
     C***********ACOF      IFNE '*A'                                S01486083547
     C***********ACOF      ANDNEBBACOC                              S01486083547
     C           ACFA      IFNE 'ALL'                                     083547
     C           ACFA      ANDNEBBACOC                                    083547
     C                     MOVEL'PM62103' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN80
     C                     END
     C**
     C** IF ACCOUNT OFFICER CODE BLANK
     C** ACCESS SDACOFL1 TO OBTAIN DEPARTMENT OF ACCOUNT
     C** OFFICER ASSIGNED TO CUSTOMER
     C**
     C                     ELSE
     C**
     C********** BBACOC    CHAINSDACOFL1             72                   S01486
     C                     CALL 'AOACOFR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBACOC    ACOKEY  2                       S01486
     C           SDACOF    PARM SDACOF    DSFDY                           S01486
     C**
     C********** AZDPCD    IFNE DEPC                                      S01486
     C           AZDPCD    IFNE DPPT                                      S01486
     C                     MOVEL'PM62103' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVE '1'       *IN80
     C                     END
     C**
     C                     END
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      **#W1002***-*TO*FORMAT*DETAILS*FOR*OUTPUT*TO*DTAARA *GDA************S01486
      * #W1002   - TO FORMAT DETAILS FOR OUTPUT TO DTAARA *LDA           *S01486
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - TO CONVERT A MIDAS DATE IN ALPHA DATE                 *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1002   - TO PROCESS SCREEN                                     *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCNM1   - FIELD OF DATA STRUCTURE WWCNUM                        *
      *                                                                  *
      ********************************************************************
     C           #W1002    BEGSR
     C**
     C** RUN DATE
     C**
     C                     MOVELBJMRDT    QMRUNA
     C                     Z-ADDBJRDNB    QMRDNB
     C                     MOVELBJCYCD    QMCYCD
     C**
     C** CUSTOMER NUMBER
     C**
     C**********           Z-ADD0         QMCNUM                                              CSD027
     C                     MOVE *BLANKS   QMCNUM                                              CSD027
     C**
     C           *IN82     IFEQ '1'
     C                     MOVE WWCNM1    QMCNUM
     C                     ELSE
     C                     MOVE QBCUST    QMCNUM
     C                     END
     C**
     C** TRADE / VALUE DATE POSITION
     C**
     C**********           MOVELP9TVPS    QMTVPS                          S01486
     C                     MOVELFCTVPS    QMTVPS                          S01486
     C**
     C** CUSTOMER REPORT NAME
     C**
     C                     MOVELBBCRNM    QMCRNM
     C                     MOVELBBCSSN    QMCSSN
      **
      ** SHOW A BLINK MESSAGE IF THE PORFOLIO IS DELETED.
      **
     C           QBRECI    IFEQ '*'
     C                     MOVE *LOVAL    BLS
     C                     MOVE *LOVAL    BLE
     C                     BITON'246'     BLS
     C                     BITON'2'       BLE
     C                     MOVE 'DELETED 'DELETE
     C                     MOVE TOWN      QMCRTN
     C                     ELSE
     C                     MOVELBBCRTN    QMCRTN
     C                     END
     C**
     C** CUSTOMER BASE CURRENCY
     C**
     C                     MOVELQBCSBY    QMCSBY
     C**
     C** CUSTOMER CURRENCY DECIMAL PLACES
     C**
     C                     Z-ADDQBBYDP    QMBYDP
     C**
     C** NATIONALITY
     C**
     C********** BBCNCZ    CHAINSDCTRYL1             72                   S01486
     C                     CALL 'AOCTRYR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBCNCZ    CTRYKY  2                       S01486
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01486
     C           @RTCD     IFEQ *BLANKS                                   S01486
     C**
     C********** *IN72     IFEQ '0'                                       S01486
     C                     MOVELA4CNNM    QMNCTX
     C                     END
     C**
     C** COUNTRY OF DOMICILE
     C**
     C********** BBCOLC    CHAINSDCTRYL1             72                   S01486
     C                     CALL 'AOCTRYR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBCOLC    CTRYKY  2                       S01486
     C           SDCTRY    PARM SDCTRY    DSFDY                           S01486
     C           @RTCD     IFEQ *BLANKS                                   S01486
     C**
     C********** *IN72     IFEQ '0'                                       S01486
     C                     MOVELA4CNNM    QMDCTX
     C                     END
     C**
     C** LANGUAGE SPOKEN
     C**
     C                     MOVELQBLANG    QMLANG
     C**
     C** DATE OF BIRTH
     C**
     C***********          Z-ADDQBBDAT    WWDAT1                          085815
     C***********                                                         085815
     C***********WWMON1    IFGT 0                                         085815
     C***********                                                         085815
     C***********          Z-ADDWWMON1    X       20                      085815
     C***********          Z-ADDWWDAY1    WWDAY2                          085815
     C***********          Z-ADDWWYER1    WWYER2                          085815
     C***********          MOVELZMNM,X    WWMON2                          085815
     C***********                                                         085815
     C***********          MOVE WWDAT2    QMBDA1                          085815
     C***********          ELSE                                           085815
     C***********          MOVEL*BLANKS   QMBDA1                          085815
     C***********          END                                            085815
     C*                                                                   085815
     C** CASE: DB1.Date of Birth (Portfolio) is Zero                      085815
     C*                                                                   085815
     C           QBBDAT    IFEQ *ZERO                                     085815
     C                     MOVEL*BLANKS   QMBDA1                          085815
     C                     ELSE                                           085815
     C*                                                                   085815
     C** CASE: Check File Date - Rundate  *                               085815
     C*                                                                   085815
     C                     Z-ADDQBBDAT    ZDAYNO  50                      085815
     C                     EXSR ZDATE2                                    085815
     C************         MOVELZDATE     QMBDA1                    085815092955
     C                     MOVELZADATE    QMBDA1                          092955
     C                     END                                            085815
     C**
     C** ACCOUNT OFFICER
     C**
     C                     MOVELBBACOC    QMACOC
     C**
     C** ACCOUNT OFFICER NAME
     C**
     C********** BBACOC    CHAINSDACOFL1             72                   S01486
     C                     CALL 'AOACOFR0'                                S01486
     C                     PARM '*MSG   ' @RTCD                           S01486
     C                     PARM '*KEY   ' @OPTN                           S01486
     C                     PARM BBACOC    ACOKEY  2                       S01486
     C           SDACOF    PARM SDACOF    DSFDY                           S01486
     C**
     C********** *IN72     IFEQ '0'                                       S01486
     C           @RTCD     IFEQ *BLANKS                                   S01486
     C                     MOVELAZACON    QMACON
     C                     END
     C**
     C** SAFE INDICATOR
     C**
     C                     MOVELQBSAFI    QMSAFI
     C**
     C** DOCUMENTATION STATUS
     C**
     C                     MOVELQBDCMS    QMDCMS
     C**
     C** ATTENTION KEY ALLOWED
     C**
     C                     MOVEL'N'       QMATTN
     C**
     C** USER LANGUAGE CODE
     C**
     C**********           MOVE DDMULT    QMMULT                          S01486
     C**
     C** POOL PORTFOLIO CUSTOMER INDICATOR
     C**
     C                     MOVE QBPPCS    QMPPCS
     C**                                                                  101497
     C** Customer Branch Code                                             101497
     C**                                                                  101497
     C                     MOVELBBBRCD    QMBRCA                          101497
     C**
     C** ALL OTHER FIELDS BLANK OR ZERO
     C**
     C                     MOVEL*BLANKS   QMRECI
     C                     MOVEL*BLANKS   QMPTF1
     C                     MOVEL*BLANKS   QMPTF2
     C                     MOVEL*BLANKS   QMPTFN
     C                     MOVEL*BLANKS   QMTPMV
     C                     MOVEL*BLANKS   QMVPMV
     C                     MOVEL*BLANKS   QMPTAI
     C                     MOVEL*BLANKS   QMPVAI
     C                     MOVEL*BLANKS   QMPTCY
     C                     MOVEL*BLANKS   QMPTFT
     C                     MOVEL*BLANKS   QMDPO1
     C                     MOVEL*BLANKS   QMPPDG
     C                     MOVEL*BLANKS   QMDSPG
     C                     MOVEL*BLANKS   QMNDSP
     C                     MOVEL*BLANKS   QMDSPT
     C                     MOVEL*BLANKS   QMDGMV
     C                     MOVEL*BLANKS   QMDGAI
     C                     MOVEL*BLANKS   QMINNR
     C                     MOVEL*BLANKS   QMISTN
     C                     MOVEL*BLANKS   QMTIMV
     C                     MOVEL*BLANKS   QMVIMV
     C                     MOVEL*BLANKS   QMITAI
     C                     MOVEL*BLANKS   QMIVAI
     C                     MOVEL*BLANKS   QMMODI
     C                     MOVEL*BLANKS   QMSESN
     C                     MOVEL*BLANKS   QMENQT
     C                     MOVEL*BLANKS   QMDBER
     C                     MOVEL*BLANKS   QMFILE
     C                     MOVEL*BLANKS   QMPGM
     C                     MOVEL*BLANKS   QMKEY
     C                     Z-ADD0         QMPCDP
     C                     Z-ADD0         QMDSPS
     C                     Z-ADD0         QMITDS
     C**********           Z-ADD0         QMTRNB                                              CLE148
     C                     MOVEL*BLANKS   QMTRNB                                              CLE148
     C                     Z-ADD0         QMERRN
     C**                                                                  CPM004
     C** PORTFOLIOS SUPPORTED INDICATOR                                   CPM004
     C**                                                                  CPM004
     C                     MOVELFCPORS    QMPORS                          CPM004
     C**
     C                     ENDSR
     C**
     C**
      ********************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1001   - TO MAINTAIN CUSTOMER SELECTION SCREEN                 *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1001    BEGSR
     C**
     C                     MOVEL'*'       DDPGMQ
     C                     MOVE '0'       *IN98
     C*
     C**   Select the program MSGQ for error msg.
     C                     MOVEL'*'       TOPQ
     C                     MOVEL'*PRV'    TOPRQ
     C*
     C**   Fill in fields for subroutine ZASNMS
     C                     MOVEL*BLANK    ZAPGM  10        Message queue
     C                     MOVEL'PMUSRMSG'ZAMSGF 10        Message file
     C                     MOVEL*BLANK    ZAPGRL  5        Rel queue
     C                     MOVEL*BLANK    ZAMSID  7        Message Id.
     C                     MOVEL*BLANK    ZAMSDA132        Message data.
     C                     MOVEL*BLANK    ZAMSTP  7        Message type.
     C*
     C** PREPARE LDA
     C*
     C                     MOVEL*BLANK    DBLOT
     C                     MOVEL'PM0625'  DBPGM
     C**
     C** ACCESS ICD1 FROM LF/SDBANKL1
     C**
     C**********           READ SDBANKL1                 70               S01486
     C**
     C** IF RECORD NOT FOUND DATA BASE ERROR
     C**
     C********** *IN70     IFEQ '1'                                       S01486
     C**********                                           ***************S01486
     C**********           Z-ADD1         DBASE            **DB ERROR 01**S01486
     C**********           MOVEL'SDBANKL1'DBFILE           ***************S01486
     C**********           EXSR *PSSR                                     S01486
     C**********           END                                            S01486
      *                                                                   S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*DBERR ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C*                                                                   S01486
     C**
     C** ACCESS PM INSTALLATION CONTROL DATA LF/SDPORTL1
     C**
     C**********           READ SDPORTL1                 70               S01486
     C**
     C** IF RECORD NOT FOUND DATA BASE ERROR
     C**
     C********** *IN70     IFEQ '1'                                       S01486
     C*                                                    ***************
     C**********           Z-ADD2         DBASE            **DB ERROR 02**S01486
     C**********           MOVEL'SDPORTL1'DBFILE           ***************S01486
     C**********           EXSR *PSSR                                     S01486
     C**********           END                                            S01486
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM '*DBERR ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C**
     C**********           MOVE P9R997    QMR997                          S01486
     C                     MOVE FCR997    QMR997                          S01486
     C**
     C                     MOVEA'11'      *IN,28           ON 28-29
     C                     MOVEA'000'     *IN,43           OFF 43-45
     C                     MOVEA'00'      *IN,50           OFF 50-51
     C                     MOVE 'N'       WWVALD  1
     C                     Z-ADD*ZEROS    LSTRR2  40
     C*                                                                   085815
     C** ACCESS FORMAT OF RUN DATE                                        085815
     C*                                                                   085815
     C           *NAMVAR   DEFN           RUNDAT                          085815
     C                     IN   RUNDAT                                    085815
     C           DFF       IFEQ 'M'                                       085815
     C                     SETON                     98                   085815
     C                     END                                            085815
     C**
     C** ACCESS LF/MUSER WITH THE USER PROFILE
     C** TO OBTAIN THE DEFAULT USER LANGUAGE CODE
     C**
     C********** WWNAME    CHAINMUSER                71                   S01486
     C**********           MOVE MULT      DDMULT                          S01486
     C**
     C                     ENDSR
     C**
      /EJECT
      ********************************************************************
     C*                                                               *
     C* ZASNMS   - Send message to program message queue              *
     C*                                                               *
     C* CALLS    Y2SNMSGC                                             *
     C*                                                               *
     C* CALLED BY  #V1001 - Validate customer selection screen.       *
     C*                                                               *
     C*****************************************************************
     C           ZASNMS    BEGSR
     C*
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM            Program queue
     C                     PARM           ZAPGRL           Rel queue
     C                     PARM           ZAMSID           Message Id.
     C                     PARM           ZAMSGF           Message file.
     C                     PARM           ZAMSDA           Message data.
     C                     PARM           ZAMSTP           Message type.
     C*
     C** Clear all fields for default mechanism next time.
     C                     MOVEL*BLANK    ZAPGM            Message queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
     C*
     C           ZASNM9    ENDSR                           ZASNM9 TAG
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1001   - TO MAINTAIN CUSTOMER SELECTION SCREEN                 *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           *PSSR     BEGSR
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     DUMP
     C**
     C                     MOVE '1'       *INLR
     C**
     C                     ENDSR
     C********************************************************************
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
