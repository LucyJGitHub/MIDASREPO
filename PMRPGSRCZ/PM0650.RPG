     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Instrument Cashflow Enquiry')                 *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management                                 *
     F*                                                               *
     F*  PM0650 - PM INSTRUMENT CASHFLOW ENQUIRY                      *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CDL096             Date 22Sep14               *
      *  Prev Amend No. CDL094             Date 11Jun14               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 11Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CDL038             Date 10May05               *
      *                 CDL020             Date 03Feb04               *
      *                 CDL019             Date 03Feb04               *
      *                 CDL018             Date 03Feb04               *
      *                 CDL017             Date 03Feb04               *
      *                 CDL016             Date 03Feb04               *
      *                 222727             Date 05Nov03               *
      *                 CDL010             Date 02Aug02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 CPM005             DATE 10JUL96               *
     F*                 095245             DATE 25JUN96               *
     F*                 085817             DATE 13MAR95               *
     F*                 081239             DATE 01FEB95               *
     F*                 S01486             DATE 08JUL94               *
     F*                 S01313             DATE 06NOV92               *
     F*                 SA9108             DATE 06NOV91               *
     F*                 049421             DATE 22JAN93               *
     F*                 R10023             DATE 10SEP90               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CLE148 - Alpha Loan Reference                                *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CDL020 - Apply Base Rate at Value Date (Recompile)           *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *           (Recompile)                                         *
      *  CDL018 - Multiple Settlement Accounts on Loans/Deposits      *
      *           (Recompile)                                         *
      *  CDL017 - Penalty Fee & Early Maturity of Fixed Term Loan/Dep *
      *           (Recompile)                                         *
      *  CDL016 - Automatic rollover of Fixed Term Loans/Deposits     *
      *           (Recompile)                                         *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  CDL010 - Prevent last user that actioned the trade from      *
      *           authorising it.Recompile due to changes in MMDELDPP *
     F*           , MMDENBPP AND MMDENSPP .                           *
     F*  CPM005 - Private Banking Phase II                            *
     F*           Focus Group Changes Upgraded to DBA                 *
     F*  095245 - If displaying an interest event due to a Money      *
     F*           Market deal, make the amount negative if the        *
     F*           Negative Interest field on the deal is Yes.         *
     F*  085817 - Recompile due to changes in PMLDAPD                 *
     F*  081239 - R10 Private Banking Rework.                         *
     F*  S01486 - Portfolio Management Upgrade                        *
     F*  S01313 - RECOMPILED DUE TO PORTFOLIO PERFORMANCE             *
     F*  SA9108 - POOL SECURITIES TRANSACTIONS (ONLY RECOMPILED       *
     F*           FOR DTAARA/LDA)                                     *
     F*  049421 - HEADER BOX STANDARDISATION                          *
     F*  R10023 - TEST IF NO DETAILS TO BE DISPLAYED                  *
     F*           ACCEPT F12 WHEN DATE INPUT IS INCORRECT             *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*
     F****PM0650DDCF  E                    WORKSTN                        S01486
     FPM0650DFCF  E                    WORKSTN                            S01486
     F                                        RRN1  KSFILE PM0650S1
     F**
     F****SDBANKL1IF  E                    DISK                           S01486
     F********************************************* KINFSR *PSSR          S01486
     F** PREFIX '  ' **
     F**
     F****SDCURRL0IF  E           K        DISK                           S01486
     F********************************************* KINFSR *PSSR          S01486
     F** PREFIX 'Q9'
     F**
     FMMDEALLLIF  E           K        DISK                           UC  095245
     F                                              KINFSR *PSSR          095245
     F            MMDENSP0                          KIGNORE               095245
     F            MMDENBP0                          KIGNORE               095245
     FPMEVIPLLIF  E           K        DISK
     F                                              KINFSR *PSSR
     F** PREFIX 'Q9'
     F**
     FPMEVICLLIF  E           K        DISK
     F                                              KINFSR *PSSR
     F            PMEVNTP0                          KRENAMEPMEVICLX
     F** PREFIX 'Q9'
     F**
     FPMEVTPLLIF  E           K        DISK
     F                                              KINFSR *PSSR
     F            PMEVNTP0                          KRENAMEPMEVTPLX
     F** PREFIX 'Q9'
     F**
     FPMEVTCLLIF  E           K        DISK
     F                                              KINFSR *PSSR
     F            PMEVNTP0                          KRENAMEPMEVTCLX
     F** PREFIX 'Q9'
     F**
     FPMEVSPLLIF  E           K        DISK
     F                                              KINFSR *PSSR
     F            PMEVNTP0                          KRENAMEPMEVSPLX
     F** PREFIX 'Q9'
     F**
     FPMEVSCLLIF  E           K        DISK
     F                                              KINFSR *PSSR
     F            PMEVNTP0                          KRENAMEPMEVSCLX
     F****************************************************************
     E**
     E** TABLES AND ARRAYS
     E*********************************************************************
      ** ARRAY FOR COPYRIGHT
      *
     E                    CPY@    1   1 80
     E**
     E** ARRAY TO ENABLE ATTENTION KEY
     E**
     E**********          ATN     1   1 22                                S01486
     E**                                                                  R10023
     E** ARRAY FOR NO DETAILS MESSAGE                                     R10023
     E**                                                                  R10023
     E                    NODET   1   1 20                                R10023
     E*                                                                   095245
     E** Array for money market interest event narratives                 095245
     E*                                                                   095245
     E                    NARR    1   4 20                                095245
     E**
      /COPY ZSRSRC,ZDATE2Z1
      /COPY ZSRSRC,ZSEDITZ1
     E**
     I*************************************************************
     I**
     I** EXTERNAL FORMAT FOR GROUP DATA AREA
     I**
     I****WWGDA     E DSPMGRDAPP                                          S01486
     I**
     I****WWLDA     E DSPMLDAPP                                           S01486
     IWWLDA     E DSPMLDAPD                                               S01486
     I**
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I*
     IPSDS       SDS
     I**********                            244 253 WSID                  S01486
     I**********                            254 263 USID                  S01486
     I                                      244 253 WKSTN                 S01486
     I                                      254 263 USER                  S01486
      /COPY ZSRSRC,ZSEDITZ2
     I**
     I** DATA STRUCTURE FOR WORK DATE
     I**
     I            DS
     I                                        1   6 WWRUNA
     I                                        1   20WWDAY
     I                                        3   40WWMTH
     I                                        5   60WWYER
     ISDMMOD    E DSSDMMODPD                                              S01486
     I** EXTERNAL DS FOR LANGUAGE ID'S                                    S01486
     I*                                                                   S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I* DS FOR CURRENCIES DETAILS                                         S01486
     I*                                                                   S01486
     ISDBANK    E DSSDBANKPD                                              S01486
     I* Bank Details Accesses Via Access Program                          S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* First DS For Access Programs, Short Data Structure                S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* Second DS For Access Programs, Long Data Structure                S01486
     I*                                                                   S01486
     I**
     I**
     I*
     ICPYR@#      DS
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I**
      ********************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #INIT    - INITIAL PROCESSING                                    *
      * #P01     - PROCESS CASH FLOW SCREEN                              *
      * #P02     - POSITION POINTER ON CASH FLOW EVENTS                  *
      * #P03     - READ CASH FLOW EVENTS                                 *
      * #P04     - FORMAT DETAILS FOR OUTPUT TO SUBFILE RECORD           *
      * #P05     - FORMAT DETAILS FOR OUTPUT TO HEADER                   *
      * #V01     - VALIDATE POSITION TO DATE                             *
      * #W0101   - FORMAT CASH FLOW SUBFILE HEADER DETAILS               *
      * #W0102   - SET SUBFILE RECORD PM0650S1 TO BLANK                  *R10023
      * ZDATE1   - TO CONVERT DDMMYY DATE IN MIDAS NUMBER                *
      * ZDATE2   - TO CONVERT MIDAS NUMBER DATE IN DDMMYY                *
      * ZSEDIT   - TO FORMAT NUMERIC FIELDS WITH DECIMAL POINT           *
      * #P99     - PROCESS DATA BASE ERRORS                              *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      **PMC1000**-*PROGRAM*TO*UPDATE *GDA*********************************S01486
      * PMC1000  - PROGRAM TO UPDATE *LDA                                *S01486
      **PMC1020**-*TO*END*GROUP*JOB***************************************S01486
      **PMC1010**-*PROGRAM*TO*RETRIEVE *GDA*******************************S01486
      * PMC1010  - PROGRAM TO RETRIEVE *LDA                              *S01486
      **QCMDEXC**-*SYSTEM*PROGRAM*CALLED*TO*SET*UP*ATTENTION*KEY**********S01486
      *                                                                  *
      ********************************************************************
     C****************************************************************
     C**                                                            **
     C**       CALCULATIONS                                         **
     C**                                                            **
     C****************************************************************
     C**
     C** KEY LISTS
     C**
     C** SETLL & READE KEYS FOR LF/PMEVIPLL (INSTRUMENTS WITHIN PORTFOLIOS)
     C**
     C           PMEIP1    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMPTF1
     C                     KFLD           QMINNR
     C                     KFLD           WWDATE  50
     C**
     C           PMEIP2    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMPTF1
     C                     KFLD           QMINNR
     C**
     C** SETLL & READE KEYS FOR LF/PMEVICLL (INSTRUMENTS WITIN CUSTOMERS)
     C**
     C           PMEIC1    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMINNR
     C                     KFLD           WWDATE
     C**
     C           PMEIC2    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMINNR
     C**
     C** SETLL & READE KEYS FOR LF/PMEVTPLL (TRANSACTIONS WITHIN PORTFOLIOS)
     C**
     C           PMETP1    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMPTF1
     C                     KFLD           QMMODI
     C                     KFLD           WWSEPR 15
     C                     KFLD           WWTRNB  6
     C                     KFLD           WWDATE
     C**
     C           PMETP2    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMPTF1
     C                     KFLD           QMMODI
     C                     KFLD           WWSEPR
     C                     KFLD           WWTRNB
     C**
     C** SETLL & READE KEYS FOR LF/PMEVSPLL (SECURITIES WITHIN PORTFOLIOS)
     C**
     C           PMESP1    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMPTF1
     C                     KFLD           QMMODI
     C                     KFLD           WWSEPR
     C                     KFLD           WWDATE
     C**
     C           PMESP2    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMPTF1
     C                     KFLD           QMMODI
     C                     KFLD           WWSEPR
     C**
     C** SETLL & READE KEYS FOR LF/PMEVTCLL (TRANSACTIONS WITHIN CUSTOMER)
     C**
     C           PMETC1    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMMODI
     C                     KFLD           WWSEPR
     C                     KFLD           WWTRNB
     C                     KFLD           WWDATE
     C**
     C           PMETC2    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMMODI
     C                     KFLD           WWSEPR
     C                     KFLD           WWTRNB
     C**
     C** SETLL & READE KEYS FOR LF/PMEVSCLL (SECURITIES WITHIN CUSTOMER)
     C**
     C           PMESC1    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMMODI
     C                     KFLD           WWSEPR
     C                     KFLD           WWDATE
     C**
     C           PMESC2    KLIST
     C                     KFLD           QMCNUM
     C                     KFLD           QMMODI
     C                     KFLD           WWSEPR
     C*************************************************************
     C** PROGRAM START
     C*************************************************************
     C                     MOVE '0'       *INKL
     C                     MOVE '0'       *IN
     C**
     C                     EXSR #INIT
     C**
     C** PROCESS CASH FLOW SCREEN
     C**
     C                     EXSR #P01
     C***********                                                         081239
     C***IF*F3*TAKEN******************************************************081239
     C***********                                                         081239
     C************INKC     IFEQ '1'                                       081239
     C***********                                                         081239
     C***MOVE*'Y'*TO*ENQUIRIES*TERMINATING*ON*DTAARA *GDA                 S01486
     C***MOVE*'Y'*TO*ENQUIRIES*TERMINATING*ON*DTAARA**LDA***********S01486081239
     C***********                                                         081239
     C***********          MOVEL'Y'       QMENQT                          081239
     C***********                                                         081239
     C***UPDATE*DTAARA *GDA                                               S01486
     C***UPDATE*DTAARA**LDA*****************************************S01486081239
     C***********                                                         081239
     C**********           CALL 'PMC1002'                                 S01486
     C**********           PARM           WWGDA                           S01486
     C***********          CALL 'PMC1001'                           S01486081239
     C***********          PARM           WWLDA                     S01486081239
     C***********                                                         081239
     C***********          END                                            081239
     C**
     C                     RETRN
     C*************************************************************
     C** PROGRAM END
     C*************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #INIT    - INITIAL PROCESSING                                    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1010**-*PROGRAM*TO*RETRIEVE *GDA*******************************S01486
      * PMC1010  - PROGRAM TO RETRIEVE *LDA                              *S01486
      **QCMDEXC**-*SYSTEM*PROGRAM*CALLED*TO*SET*UP*ATTENTION*KEY**********S01486
      * #P99     - PROCESS DATA BASE ERRORS                              *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      **WWPARM***-*PARAMETER *GDA*****************************************S01486
      * WWPARM   - PARAMETER *LDA                                        *S01486
      **WWFLD****-*PARAMETER*FOR*QCMDEXC**********************************S01486
      **WWNUMB***-*PARAMETER*FOR*QCMDEXC**********************************S01486
      *                                                                  *
      ********************************************************************
     C           #INIT     BEGSR
     C**
     C                     MOVEL'J'       ZECODE
     C                     MOVE '0'       *IN72
     C                     MOVE '0'       *IN98
     C**
     C***RETRIEVE*DTAARA *GDA                                             S01486
     C** RETRIEVE DTAARA *LDA                                             S01486
     C**
     C                     CALL 'PMC1003'
     C                     PARM           WWLDA
     C*                                                                   S01486
     C                     CALL 'AOMMODR0'                                S01486
     C                     PARM '*DBERR ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C                     MOVEL*BLANKS   QMKEY                           S01486
     C**                                                   ***************S01486
     C                     Z-ADD6         QMERRN           **DB ERROR 06**S01486
     C                     EXSR *PSSR                      ***************S01486
     C                     RETRN                                          S01486
     C                     END                                            S01486
     C**
     C** SET SECURITY AND TRANSACTION REFERENCE FIELDS IN KEYS
     C**
     C                     MOVELQMSESN    WWSEPR
     C********** QMTRNB    IFNE *ZERO                                                         CLE148
     C           QMTRNB    IFNE *BLANKS                                                       CLE148
     C                     MOVELQMTRNB    WWTRNB
     C                     END
     C**
     C**  LOAD RUN DATE
     C                     MOVELQMRUNA    DDRUNA
     C**
     C** LOAD CUSTOMER NUMBER AND NAME
     C**
     C                     MOVELQMCNUM    DDCNUM
     C                     MOVELQMCRNM    DDCRNM
     C**
     C** IF ATTENTION KEY ENABLED SET THE ATTENTION PROGRAM TO
     C** PMC0610
     C**
     C********** QMATTN    IFEQ 'Y'                                       S01486
     C**
     C** ENABLE ATTENTION PROGRAM
     C**
     C**********           MOVEAATN       WWFLD  22                       S01486
     C**********           Z-ADD22        WWNUMB 155                      S01486
     C**********           CALL 'QCMDEXC'                                 S01486
     C**********           PARM           WWFLD                           S01486
     C**********           PARM           WWNUMB                          S01486
     C**
     C**********           END                                            S01486
     C**
     C** ACCESS LF/SDBANKL1
     C**
     C** POSITION FIRST TO AVOID DATA BASE ERROR
     C**
     C********** 1         SETLLSDBANKL1                                  S01486
     C**
     C**********           READ SDBANKL1                 70               S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*DBERR ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C**
     C** IF RECORD NOT FOUND - PROCESS DATA BASE ERROR
     C**
     C********** *IN70     IFEQ '1'                                       S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C                     MOVEL'SDBANKL1'QMFILE
     C                     MOVEL*BLANKS   QMKEY            ***************
     C                     Z-ADD1         QMERRN           **DB ERROR 01**
     C                     EXSR *PSSR                      ***************
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P01     - PROCESS CASH FLOW SCREEN                              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - POSITION POINTER ON CASH FLOW EVENTS                  *
      * #P05     - FORMAT DETAILS FOR OUTPUT TO HEADER                   *
      * #P03     - READ CASH FLOW EVENTS                                 *
      * #W0101   - FORMAT CASH FLOW SUBFILE HEADER DETAILS               *
      * #V01     - VALIDATE POSITION TO DATE                             *
      * ZDATE1   - TO CONVERT DDMMYY DATE IN MIDAS NUMBER                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWDATE   - PARAMETER DATE                                        *
      * WWCONT   - COUNTER                                               *
      * WWRUNA   - RUN DATE                                              *
      *                                                                  *
      ********************************************************************
     C           #P01      BEGSR
     C**
     C** SET INDICATOR TO CAUSE FIRST TIME BUILD OF SUBFILE
     C**
     C                     MOVEL'Y'       REBLDR  1
     C**
     C** POSITION POINTER ON PORTFOLIO CASH FLOW EVENTS
     C** PASSING A DATE EQUAL TO ZERO AS PARAMETER
     C**
     C                     Z-ADD0         WWDATE
     C                     EXSR #P02
     C**
     C** FORMAT DETAILS FOR OUTPUT TO SUBFILE HEADER
     C**
     C                     EXSR #P05
     C**                                                                  R10023
     C** FIRST TIME, INITIALIZE RECORD NUMBER, CLEAR SUBFILE              R10023
     C** AND POSITION FIRST TIME WORK FIELD                               R10023
     C**                                                                  R10023
     C                     Z-ADD0         RRN1    40                      R10023
     C                     MOVE '1'       *IN61                           R10023
     C                     WRITEPM0650C1                                  R10023
     C                     MOVE '0'       *IN61                           R10023
     C                     MOVE 'Y'       WW1ST   1                       R10023
     C                     MOVE *BLANK    DDDATE                          R10023
     C                     MOVE '0'       *IN86                           R10023
     C**
     C** DO WHILE F3 AND F12 HAVE NOT BEEN TAKEN
     C**
     C************INKC     DOWEQ'0'                        B1             081239
     C************INKL     ANDEQ'0'                                       081239
     C***********QMENQT    ANDNE'Y'                                       081239
     C           QMENQT    DOUEQ'Y'                                       081239
     C           QMENQT    OREQ 'C'                                       081239
     C           QMENQT    OREQ 'P'                                       081239
     C           QMENQT    OREQ 'D'                                       081239
     C           *INKL     OREQ '1'                                       081239
     C**
     C** IF REBUILD OF SUBFILE REQUIRED
     C**
     C           REBLDR    IFEQ 'Y'                        B2
     C********************                                                R10023
     C***INITIALIZE RECORD NUMBER AND CLEAR SUBFILE                       R10023
     C********************                                                R10023
     C******************** Z-ADD0         RRN1    40                      R10023
     C******************** MOVE '1'       *IN61                           R10023
     C******************** WRITEPM0650C1                                  R10023
     C******************** MOVE '0'       *IN61                           R10023
     C**
     C** READ PORTFOLIO CASH FLOW EVENTS
     C**
     C                     EXSR #P03
     C**                                                                  R10023
     C           *IN73     IFEQ '0'                        B3             R10023
     C**                                                                  R10023
     C** IF DETAILS TO BE DISPLAYED                                       R10023
     C** INITIALIZE RECORD NUMBER AND CLEAR SUBFILE                       R10023
     C**                                                                  R10023
     C                     Z-ADD0         RRN1    40                      R10023
     C                     MOVE '1'       *IN61                           R10023
     C                     WRITEPM0650C1                                  R10023
     C                     MOVE '0'       *IN61                           R10023
     C**                                                                  R10023
     C                     END                             E3             R10023
     C**                                                                  R10023
     C** IF NO DETAILS TO BE DISPLAYED, DISPLAY A MESSAGE                 R10023
     C**                                                                  R10023
     C           *IN73     IFEQ '1'                        B3             R10023
     C**                                                                  R10023
     C           WW1ST     IFEQ 'Y'                        B4             R10023
     C                     DO   3         X       30                      R10023
     C                     EXSR #W0102                                    R10023
     C                     ADD  1         RRN1                            R10023
     C                     WRITEPM0650S1                                  R10023
     C                     END                                            R10023
     C                     EXSR #W0102                                    R10023
     C                     MOVEANODET     DDISTN                          R10023
     C                     ADD  1         RRN1                            R10023
     C                     WRITEPM0650S1                                  R10023
     C                     MOVE '1'       *IN86                           R10023
     C                     ELSE                            X4             R10023
     C                     MOVE '1'       *IN85                           R10023
     C                     END                             E4             R10023
     C**                                                                  R10023
     C                     ELSE                            X3             R10023
     C**                                                                  R10023
     C                     MOVE 'N'       WW1ST                           R10023
     C**                                                                  R10023
     C                     END                             E3             R10023
     C**
     C** DO WHILE NOT END OF FILE
     C**
     C           *IN73     DOWEQ'0'                        B3
     C**
     C** FORMAT DETAILS FOR OUTPUT TO SUBFILE RECORD
     C**
     C                     EXSR #P04
     C**
     C                     ADD  1         RRN1
     C                     WRITEPM0650S1
     C**
     C** READ PORTFOLIO CASH FLOW EVENTS
     C**
     C                     EXSR #P03
     C**
     C                     END                             E3
     C**
     C** IF NO RECORDS WRITTEN TO SUBFILE,WRITE 1 WITH NON-DISPLAY IND 62 ON
     C**
     C           RRN1      IFEQ 0                          B3
     C                     ADD  1         RRN1
     C                     MOVEL'1'       *IN62
     C                     WRITEPM0650S1
     C                     MOVEL'0'       *IN62
     C                     END                             E3
     C                     MOVEL*BLANK    REBLDR
     C                     END                             E2
     C**
     C** FORMAT HEADER DETAILS
     C**
     C                     EXSR #W0101
     C**
     C                     WRITEPM0650F1
     C                     WRITEPM0650F2
     C                     EXFMTPM0650C1
     C**
     C                     MOVE '0'       *IN80
     C*                                                                   081239
     C** If F3  pressed, exit program                                     081239
     C*                                                                   081239
     C           *INKC     IFEQ '1'                                       081239
     C                     MOVE 'Y'       QMENQT                          081239
     C                     CALL 'PMC1001'                                 081239
     C                     PARM           WWLDA                           081239
     C                     END                                            081239
     C**********                                                    081239CPM005
     C***If*F22*pressed, access Enquiry selection screen            081239CPM005
     C**********                                                    081239CPM005
     C********** *INKW     IFEQ '1'                                 081239CPM005
     C**********           CALL 'PMC0610'                           081239CPM005
     C**********                                                    081239CPM005
     C***Retrieve *LDA values                                       081239CPM005
     C**********                                                    081239CPM005
     C**********           CALL 'PMC1003'                           081239CPM005
     C**********           PARM           WWLDA                     081239CPM005
     C**********           END                                      081239CPM005
     C**
     C** ENTER PRESSED,WITH POSITION TO DATE SPECIFIED
     C**
     C           *IN60     IFEQ '0'                        B2
     C           DDDATE    ANDNE*BLANKS
     C**
     C** MUST BE VALID
     C**
     C                     EXSR #V01
     C**
     C** DO WHILE INPUT IS INVALID
     C** AND F12 NOT PRESSED                                              R10023
     C**
     C           *IN80     DOWEQ'1'                        B3
     C           *INKL     ANDEQ'0'                                       R10023
     C           QMENQT    ANDNE'Y'                                       081239
     C           QMENQT    ANDNE'C'                                       081239
     C           QMENQT    ANDNE'P'                                       081239
     C           QMENQT    ANDNE'D'                                       081239
     C**
     C                     WRITEPM0650F1
     C                     WRITEPM0650F2
     C                     EXFMTPM0650C1
     C**
     C                     MOVE '0'       *IN80
     C*                                                                   081239
     C** If F3  pressed, exit program                                     081239
     C*                                                                   081239
     C           *INKC     IFEQ '1'                                       081239
     C                     MOVE 'Y'       QMENQT                          081239
     C                     CALL 'PMC1001'                                 081239
     C                     PARM           WWLDA                           081239
     C                     END                                            081239
     C**********                                                    081239CPM005
     C***If*F22*pressed, access Enquiry selection screen            081239CPM005
     C**********                                                    081239CPM005
     C********** *INKW     IFEQ '1'                                 081239CPM005
     C**********           CALL 'PMC0610'                           081239CPM005
     C**********                                                    081239CPM005
     C***Retrieve *LDA values                                       081239CPM005
     C**********                                                    081239CPM005
     C**********           CALL 'PMC1003'                           081239CPM005
     C**********           PARM           WWLDA                     081239CPM005
     C**********           END                                      081239CPM005
     C**
     C** VALIDATE DETAILS AS PER #V01
     C**
     C                     EXSR #V01
     C**
     C                     END                             E3
     C**
     C** REPOSITION FILE POINTER FOR READ FROM POSITION TO DATE
     C** IF F12 NOT PRESSED                                               R10023
     C**
     C           *INKL     IFEQ '0'                        B3             R10023
     C**                                                                  R10023
     C                     Z-ADDZDAYNO    WWDATE
     C**
     C                     EXSR #P02
     C**
     C** SET INDICATOR TO CAUSE REBUILD OF SUBFILE
     C**
     C                     MOVEL'Y'       REBLDR
     C**
     C** RESET INPUT FIELD
     C**
     C                     MOVEL*BLANKS   DDDATE
     C**                                                                  R10023
     C                     END                             E3             R10023
     C**
     C                     END                             E2
     C**
     C                     END                             E1
     C**
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P02     - POSITION POINTER ON CASH FLOW EVENTS                  *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS CASH FLOW SCREEN                              *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P02      BEGSR
     C**
     C** IF SECURITY SHORT NAME FROM DTAARA *LDA IS BLANK
     C** AND TRANSACTION REFERENCE FROM DTAARA *LDA IS ZERO
     C** ACCESS LOGICALS IN INSTRUMENT SEQUENCE
     C** (OTHERWISE IN SECURITY/TRANSACTION REF.SEQUENCE)
     C**
     C           QMSESN    IFEQ *BLANKS
     C********** QMTRNB    ANDEQ0                                                             CLE148
     C           QMTRNB    ANDEQ*BLANKS                                                       CLE148
     C**
     C** ACCESS LOGICALS ACROSS ALL PORTFOLIOS IF 9998,9999 PORTFOLIOS REQUIRED
     C** (OTHERWISE ACCESS LOGICALS FOR REQUIRED PORTFOLIO)
     C**
     C           QMPTF1    IFEQ '9998'
     C           QMPTF1    OREQ '9999'
     C           PMEIC1    SETLLPMEVICLL
     C                     ELSE
     C           PMEIP1    SETLLPMEVIPLL
     C                     END
     C**
     C                     ELSE
     C**
     C           QMPTF1    IFEQ '9998'
     C           QMPTF1    OREQ '9999'
     C           QMMODI    IFNE 'SE'
     C           PMETC1    SETLLPMEVTCLL
     C                     ELSE
     C           PMESC1    SETLLPMEVSCLL
     C                     END
     C                     ELSE
     C           QMMODI    IFNE 'SE'
     C           PMETP1    SETLLPMEVTPLL
     C                     ELSE
     C           PMESP1    SETLLPMEVSPLL
     C                     END
     C                     END
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P03     - READ CASH FLOW EVENTS                                 *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS CASH FLOW SCREEN                              *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P03      BEGSR
     C**
     C**
     C***IF*SECURITY*SHORT*NAME*FROM*DTAARA *GDA*IS*BLANK                 S01486
     C***AND*TRANSACTION*REFERENCE*FROM*DTAARA *GDA*IS*ZERO               S01486
     C** IF SECURITY SHORT NAME FROM DTAARA *LDA IS BLANK                 S01486
     C** AND TRANSACTION REFERENCE FROM DTAARA *LDA IS ZERO               S01486
     C** ACCESS LOGICALS IN INSTRUMENT SEQUENCE
     C** (OTHERWISE IN SECURITY/TRANSACTION REF.SEQUENCE)
     C**
     C           QMSESN    IFEQ *BLANKS
     C********** QMTRNB    ANDEQ0                                                             CLE148
     C           QMTRNB    ANDEQ*BLANKS                                                       CLE148
     C**
     C** ACCESS LOGICALS ACROSS ALL PORTFOLIOS IF 9998,9999 PORTFOLIOS REQUIRED
     C** (OTHERWISE ACCESS LOGICALS FOR REQUIRED PORTFOLIO)
     C**
     C           QMPTF1    IFEQ '9998'
     C**
     C** IF ALL PORTFOLIOS REQUIRED THEN OMIT 9997 (NON-PORTFOLIO) EVENTS
     C**
     C           PMEIC2    READEPMEVICLL                 73
     C           *IN73     DOWEQ'0'
     C           Q9PTFR    ANDEQ'9997'
     C           PMEIC2    READEPMEVICLL                 73
     C                     END
     C**
     C                     ELSE
     C           QMPTF1    IFEQ '9999'
     C**
     C           PMEIC2    READEPMEVICLL                 73
     C**
     C                     ELSE
     C           PMEIP2    READEPMEVIPLL                 73
     C                     END
     C                     END
     C**
     C                     ELSE
     C**
     C           QMPTF1    IFEQ '9998'
     C**
     C           QMMODI    IFNE 'SE'
     C           PMETC2    READEPMEVTCLL                 73
     C           *IN73     DOWEQ'0'
     C           Q9PTFR    ANDEQ'9997'
     C           PMETC2    READEPMEVTCLL                 73
     C                     END
     C                     ELSE
     C           PMESC2    READEPMEVSCLL                 73
     C           *IN73     DOWEQ'0'
     C           Q9PTFR    ANDEQ'9997'
     C           PMESC2    READEPMEVSCLL                 73
     C                     END
     C                     END
     C**
     C                     ELSE
     C           QMPTF1    IFEQ '9999'
     C**
     C           QMMODI    IFNE 'SE'
     C           PMETC2    READEPMEVTCLL                 73
     C                     ELSE
     C           PMESC2    READEPMEVSCLL                 73
     C                     END
     C**
     C                     ELSE
     C           QMMODI    IFNE 'SE'
     C           PMETP2    READEPMEVTPLL                 73
     C                     ELSE
     C           PMESP2    READEPMEVSPLL                 73
     C                     END
     C**
     C                     END
     C                     END
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P04     - FORMAT DETAILS FOR OUTPUT TO SUBFILE RECORD           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - TO CONVERT MIDAS NUMBER DATE IN DDMMYY                *
      * #P99     - PROCESS DATA BASE ERRORS                              *
      * ZSEDIT   - TO FORMAT NUMERIC FIELDS WITH DECIMAL POINT           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWTEMP   - WORK FIELD                                            *
      * WWAMEV   - WORK FIELD                                            *
      *                                                                  *
      ********************************************************************
     C           #P04      BEGSR
     C**
     C**
     C** CONVERT EVENT DATE
     C**
     C                     Z-ADDQ9EVTD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DDEVDT
     C                     MOVEL*BLANK    DDTRRF
     C**
     C** SECURITY SHORT NAME NOT BLANK
     C**
     C           Q9SEPR    IFNE *BLANKS
     C                     MOVELQ9SEPR    DDTRRF
     C                     ELSE
     C**
     C** SECURITY SHORT NAME *BLANK
     C**
     C                     MOVELQ9TTRF    DDTRRF
     C                     END
     C**
     C** MIDAS INSTRUMENT NAME
     C**
     C                     MOVELQ9T1XT    DDISTN
     C**
     C** EVENT CURRENCY
     C**
     C                     MOVELQ9ECCY    DDCURR
     C**
     C** ACCESS SDCURRL0 TO GET DECIMAL PLACES
     C**
     C********** Q9ECCY    CHAINSDCURRL0             75                   S01486
     C                     MOVELQ9ECCY    @AJCD                           S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*DBERR'  @RTCD   7                       S01486
     C                     PARM '*KEY   ' @OPTN   7                       S01486
     C                     PARM           @AJCD   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C** IF NOT FOUND DATA BASE ERROR
     C**
     C********** *IN75     IFEQ '1'                                       S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C                     MOVEL'SDCURRL0'QMFILE
     C                     MOVELQ9ECCY    QMKEY            ***************
     C                     Z-ADD4         QMERRN           **DB ERROR 02**
     C                     EXSR *PSSR                      ***************
     C                     END
     C**
     C** EDIT EVENT AMOUNT
     C**
     C                     Z-ADDQ9ETAM    ZFLD15
     C                     Z-ADDA6NBDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    WWTEMP 15
     C                     MOVELWWTEMP    WWAMEV 14
     C                     MOVELWWAMEV    DDAMEV
     C**
     C** CHECK IF PAY OR RECEIVE
     C**
     C           Q9AMTR    IFEQ 'P'
     C                     MOVE '-'       DDAMEV
     C                     ELSE
     C                     MOVE '+'       DDAMEV
     C                     END
     C**
     C** EVENT NARRATIVE
     C**
     C                     MOVEL*BLANK    DDEVTP
     C                     MOVELQ9ENAR    DDEVTP
     C**
     C** IF SELECT OF ALL CUSTOMER/PORTFOLIO,SHOW PORTFOLIO
     C**
     C           QMPTF1    IFEQ '9998'
     C           QMPTF1    OREQ '9999'
     C**
     C           Q9PTFR    IFNE '9997'
     C                     MOVE Q9PTFR    DDEVTP
     C                     END
     C                     END
     C**
     C** INSTRUMENT ENQUIRY DETAILS
     C**
     C                     MOVELQ9T2XT    DDINTD
     C**
     C** EDIT EVENT AMOUNT IN CUSTOMER CURRENCY
     C** OR IN PORTFOLIO CURRENCY
     C**
     C                     MOVEL*BLANKS   WWTEMP
     C                     MOVEL*BLANKS   WWAMEV
     C**
     C           QMPTF1    IFEQ '9997'
     C           QMPTF1    OREQ '9998'
     C           QMPTF1    OREQ '9999'
     C**
     C**
     C                     Z-ADDQ9CUCA    ZFLD15
     C                     Z-ADDQMBYDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    WWTEMP 15
     C                     MOVELWWTEMP    WWAMEV 14
     C                     MOVELWWAMEV    DDAMCY
     C**
     C                     ELSE
     C**
     C                     Z-ADDQ9PTFA    ZFLD15
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    WWTEMP 15
     C                     MOVELWWTEMP    WWAMEV 14
     C                     MOVELWWAMEV    DDAMCY
     C**
     C                     END
     C**
     C           Q9AMTR    IFEQ 'P'
     C                     MOVE '-'       DDAMCY
     C                     ELSE
     C                     MOVE '+'       DDAMCY
     C                     END
     C*                                                                   095245
     C** For Money market deals                                           095245
     C*                                                                   095245
     C           Q9MODI    IFEQ 'MD'                                      095245
     C           Q9MODI    OREQ 'ML'                                      095245
     C*                                                                   095245
     C** Check if an interest event                                       095245
     C*                                                                   095245
     C                     Z-ADD1         PN      10                      095245
     C           Q9ENAR    LOKUPNARR,PN                  40               095245
     C           *IN40     IFEQ '1'                                       095245
     C           FILOPN    IFNE 'Y'                                       095245
     C                     OPEN MMDEALLL                                  095245
     C                     MOVE 'Y'       FILOPN  1                       095245
     C                     END                                            095245
     C                     MOVE Q9TTRF    MMDEAL  60                      095245
     C           MMDEAL    CHAINMMDEALLL             41                   095245
     C*                                                                   095245
     C** If negative interest Yes change signs                            095245
     C*                                                                   095245
     C           HKNGVI    IFEQ 'Y'                                       095245
     C           DDAMEV    IFEQ '-'                                       095245
     C                     MOVE '+'       DDAMEV                          095245
     C                     MOVE '+'       DDAMCY                          095245
     C                     ELSE                                           095245
     C                     MOVE '-'       DDAMEV                          095245
     C                     MOVE '-'       DDAMCY                          095245
     C                     END                                            095245
     C                     END                                            095245
     C                     END                                            095245
     C                     END                                            095245
     C**
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P05     - FORMAT DETAILS FOR OUTPUT TO HEADER                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS CASH FLOW SCREEN                              *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P05      BEGSR
     C**
     C           QMSESN    IFEQ *BLANKS
     C********** QMTRNB    ANDEQ0                                                             CLE148
     C           QMTRNB    ANDEQ*BLANKS                                                       CLE148
     C**
     C                     MOVE '1'       *IN56
     C**
     C                     MOVELQMINNR    DDINNR
     C                     MOVELQMISTN    DDISTN
     C**
     C                     ELSE
     C**
     C                     MOVE '1'       *IN57
     C**
     C           QMSESN    IFNE *BLANKS
     C**
     C                     MOVELQMSESN    DDTRSE
     C**
     C                     ELSE
     C**
     C                     MOVELQMTRNB    DDTRSE
     C**
     C                     END
     C**
     C                     END
     C**
     C** IF PORTFOLIO REFERENCE ON FILE EQUAL TO '9997' OR '9998'
     C** OR '9999'.
     C**
     C           QMPTF1    IFEQ '9997'
     C           QMPTF1    OREQ '9998'
     C           QMPTF1    OREQ '9999'
     C**
     C** MOVE CUSTOMER BASE CURRENCY TO SCREEN
     C**
     C                     MOVELQMCSBY    DDCURE
     C**
     C                     ELSE
     C**
     C** MOVE PORTFOLIO CURRENCY TO SCREEN
     C**
     C                     MOVELQMPTCY    DDCURE
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #V01     - VALIDATE POSITION TO DATE                             *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE1   - TO CONVERT DDMMYY DATE IN MIDAS NUMBER                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS CASH FLOW SCREEN                              *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #V01      BEGSR
     C**
     C                     MOVE '0'       *IN85
     C                     Z-ADD*ZERO     ZDAYNO
     C**
     C** IF POSITION TO DATE ENTERED
     C**
     C           DDDATE    IFNE *BLANKS
     C**
     C**
     C                     MOVE DDDATE    ZDATE
     C                     EXSR ZDATE1
     C**
     C           *IN99     IFEQ '1'
     C**
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN85
     C**
     C                     END
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W0101   - FORMAT CASH FLOW SUBFILE HEADER DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - TO FORMAT NUMERIC FIELDS WITH DECIMAL POINT           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS CASH FLOW SCREEN                              *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W0101    BEGSR
     C**
     C                     MOVELQMCNUM    DDCNUM
     C                     MOVELQMCRNM    DDCRNM
     C**
     C                     MOVELQMPTF2    DDPTFR
     C                     MOVELQMPTFN    DDPTFN
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************R10023
      *                                                                  *R10023
      * #W0102   - SET SUBFILE RECORD PM0650S1 TO BLANK                  *R10023
      *                                                                  *R10023
      * SUBROUTINE CALLS:                                                *R10023
      *                                                                  *R10023
      * SUBROUTINE CALLED FROM:                                          *R10023
      * #P01     - PROCESS CASH FLOW SCREEN                              *R10023
      *                                                                  *R10023
      * ROUTINE USES VARIABLES:                                          *R10023
      *                                                                  *R10023
      ********************************************************************R10023
     C           #W0102    BEGSR                                          R10023
     C**                                                                  R10023
     C                     MOVE *BLANK    DDEVDT                          R10023
     C                     MOVE *BLANK    DDTRRF                          R10023
     C                     MOVE *BLANK    DDISTN                          R10023
     C                     MOVE *BLANK    DDCURR                          R10023
     C                     MOVE *BLANK    DDAMEV                          R10023
     C                     MOVE *BLANK    DDEVTP                          R10023
     C                     MOVE *BLANK    DDINTD                          R10023
     C                     MOVE *BLANK    DDAMCY                          R10023
     C**                                                                  R10023
     C                     ENDSR                                          R10023
     C**                                                                  R10023
      ********************************************************************R10023
      /EJECT
      /COPY ZSRSRC,ZDATE1Z2
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      /COPY ZSRSRC,ZSEDITZ3
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1000**-*PROGRAM*TO*UPDATE *GDA*********************************S01486
      * PMC1000  - PROGRAM TO UPDATE *LDA                                *S01486
      **PMC1020**-*TO*END*GROUP*JOB***************************************S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      **WWPARM***-*PARAMETER *GDA*****************************************S01486
      * WWPARM   - PARAMETER *LDA                                        *S01486
      **WWEND****-*PARAMETER*FOR*PMC1020**********************************S01486
      **WWGRPJ***-*PARAMETER*FOR*PMC1020**********************************S01486
      *                                                                  *
      ********************************************************************
     C           *PSSR     BEGSR
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVEL'Y'       QMDBER
     C                     MOVEL'PM0650'  QMPGM
     C                     MOVEL'Y'       QMENQT
     C**
     C***UPDATE *GDA                                                      S01486
     C** UPDATE *LDA                                                      S01486
     C**
     C**********           CALL 'PMC1002'                                 S01486
     C**********           PARM           WWGDA                           S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C                     DUMP
     C**
     C                     ENDSR
     C**
     C*******************************************************************
     C* **   ATN - ARRAY TO ENABLE ATTENTION KEY                          S01486
     C*SETATNPGM PGM(PMC0610)                                             S01486
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**  NODET - ARRAY FOR NO DETAILS MESSAGE
NO CASHFLOW DETAILS
**  NARR - Array for money market interest event narratives               095245
DEP PL/LN INT DUE                                                         095245
DEP PL/LN INTEREST                                                        095245
DEPOSIT INT DUE                                                           095245
INTEREST RECEIVABLE                                                       095245
**  ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**  ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**  ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
