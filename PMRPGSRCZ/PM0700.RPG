     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Holdings screen enquiry')                     *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management                                 *
     F*                                                               *
     F*  PM0700 - PM HOLDINGS SCREEN                                  *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *   CPM005
     F*  !--------------------------------------------------------!   *   CPM005
     F*  ! BE CAREFUL |                                           !   *   CPM005
     F*  ! When you add a Fix in this Program, may be you should  !   *   CPM005
     F*  ! put it also in the RPG/PM0701                          !   *   CPM005
     F*  !--------------------------------------------------------!   *   CPM005
     F*                                                               *
      *  Last Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 160217             Date 28Jul99               *
      *                 145934             Date 23Oct98               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 110007             DATE 24OCT96               *
     F*                 CPM005             DATE 17JUN96               *
     F*                 CFF004             DATE 11SEP96               *
     F*                 103085             DATE 20APR96               *
     F*                 CPM003             DATE 02MAY96               *
     F*                 040639             DATE 29FEB96               *
     F*                 S71062             DATE 29NOV95               *
     F*                 076371             DATE 29NOV95               *
     F*                 077485             DATE 29NOV95               *
     F*                 077457             DATE 29NOV95               *
     F*                 CPM004             DATE 08FEB96               *
     F*                 085862             DATE 16MAR95               *
     F*                 085817             DATE 13MAR95               *
     F*                 081239             DATE 01FEB95               *
     F*                 081790             DATE 18JAN95               *
     F*                 S01496             DATE 11NOV94               *
     F*                 S01486             DATE 08JUL94               *
     F*                 062021             DATE 15NOV93               *
     F*                 59481              DATE 04AUG93               *
     F*                 59468              DATE 03AUG93               *
     F*                 057400 LJ          DATE 01JUL93               *
     F*                 CH0177             DATE 18JUN93               *
     F*                 50560 MF           DATE 10FEB93               *
     F*                 50559 DDJ-MF       DATE 10FEB93               *
     F*                 46973              DATE 23NOV92               *
     F*                 56079              DATE 12MAY93               *
     F*                 47863              DATE 27NOV92               *
     F*                 47719              DATE 24NOV92               *
     F*                 46081              DATE 23OCT92               *
     F*                 SA9108             DATE 24AUG92               *
     F*                 42752              DATE 11AUG92               *
     F*                 S01313             DATE 19MAY92               *
     F*                 39440              DATE 20MAY92               *
     F*                 36854      MF      DATE 13MAR92               *
     F*                 36727      MF      DATE 05MAR92               *
     F*                 32134      ADIF    DATE 20NOV91               *
     F*                 B10529     PA      DATE 19JUL91               *
     F*                 B08253             DATE 16OCT91               *
     F*                 B08103             DATE 19JUL91               *
     F*                 B08040             DATE 07JUL91               *
     F*                 B08019             DATE 29JUN91               *
     F*                 B07939             DATE 07JUN91               *
     F*                 R05956             DATE 07MAY91               *
     F*                 R05765             DATE 27MAR91               *
     F*                 R05757             DATE 27MAR91               *
     F*                 R05662             DATE 12MAR91               *
     F*                 R05655             DATE 11MAR91               *
     F*                 R05631             DATE 07MAR91               *
     F*                 R05586             DATE 04MAR91               *
     F*                 R0147              DATE 13FEB91               *
     F*                 R01164             DATE 02JAN90               *
     F*                 R0875              DATE 10DEC90               *
     F*                 R00853             DATE 05DEC90               *
     F*                 R01150             DATE 29NOV90               *
     F*                 R00631             DATE 29OCT90               *
     F*                 R10060             DATE 02OCT90               *
     F*                 R10052             DATE 01OCT90               *
     F*                 R10022             DATE 07SEP90               *
     F*                 R10021             DATE 05SEP90               *
     F*                 R10017             DATE 05SEP90               *
     F*                 R10016             DATE 05SEP90               *
     F*                 R10013             DATE 05SEP90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  160217 - Correct loading of subfile when records in PMHOLDPD *
     F*           are very similar.                                   *
     F*  145934 - Change Key PMASLIL0 when total type is 'I'          *
     F*  110007 - Bracketing was wrong on Other Nominal Amount        *
     F*  CPM005 - Private Banking Phase 2                             *
     F*           Focus Group Changes upgraded to DBA                 *
     F*           PBFG/5 - INSTRUMENT ASSET/LIABILITY SPLIT           *
     F*           PBFG/6 - ADDITIONAL CUSTOMER DETAILS                *
     F*           PBFG/7 - NET COMMITMENT BY CURRENCY                 *
     F*           PBFG/8 - DISPLAY POSITIONS SPLIT BY CURRENCY        *
     F*  CFF004 - Increase in size of Price Fields                    *
     F*  103085 - Only access AOLOMBR0 if Portfolio Lending installed *
     F*  CPM003 - FF/PM Interface upgrade to Release 10               *
     F*  040639 - ALLOW ROLL DOWN                                     *
     F*  076371 - PM/FF Interface corrections.                        *
     F*  077457 - PM/FF Interface corrections.                        *
     F*  077485 - PM/FF Interface corrections.                        *
     F*  S71062 - PM/FF Interface.                                    *
     F*  CPM004 - Bank Portfolios                                     *
     F*  085862 - INCLUDE BRANCH CODE IN ACCOUNT IDENTIFIER           *
     F*  085817 - Recompile due to changes in PMLDAPD                 *
     F*  081239 - Rework Portfolio Management                         *
     F*  081790 - Missing parameter on call AOCUSTR0                  *
     F*  S01496 - Incorporation of Jyske Enhancements (S10978)        *
     F*  S01486 - Portfolio Management Upgrade                        *
     F*  062021 - EXTENDING FIELD 'OTHER NOMINAL AMOUNT' TO 17 LONG   *
     F*  59481  - PROTECT SELECTION FIELDS                            *
     F*  59468  - IF ENTER 'G' ON MATURE/FLAT POSITIONS OUTPUT TEXT   *
     F*           'NO OPEN POSITIONS EXIST'                           *
     F*  57400  - PLEDGE AND GUARANTEE ENQUIRY IF CUSTOMER HAS SEVERAL*
     F*           PLEDGES WITH SAME COLLATEARL AND SEQUENCE NUMBER    *
     F*           (PM0670 - PM0700- PM1136- PM2130)                   *
     F*  CH0177 - IF DDMKTP > 999999 THEN ONLY SHOW 2 DECIMAL PLACES  *
     F*  50560  - NO DETAILS POSSIBLE FOR DEPOSIT                     *
     F*  50559  - NO NOMINAL WHEN ENQUIRING ON DEPOSIT                *
     F*  46973  - MATURED DEALS SHOULD NOT BE MARKED FORWARD. ONLY    *
     F*           OUTPUT DEAL NO IN MARKET PRICE FOR FX DEALS         *
     F*  56079  - EDIT CORRECTLY AMOUNT                               *
     F*  47863  - OUTPUT MARKET VALUE & ACCRUED INTEREST USING        *
     F*           AMOUNTS ON FILE RATHER THAN DOING CONVERSION        *
     F*  47719  - CORRECT CONVERSION OF AMOUNTS BETWEEN CURRENCIES    *
     F*  46081  - FOR VALUE DATE POSITIONS MARK LOANS/DEPOSITS        *
     F*           WHICH HAVE NOT REACHED VALUE DATE AS 'FORWARD'      *
     F*  SA9108 - POOL SECURITIES TRANSACTIONS                        *
     F*  42752  - STORE GUARANTEES FOR LOMBARD CREDIT                 *
     F*  S01313 - CHANGED FOR PORTFOLIO PERFORMANCE                   *
     F*  39440  - FIXES TO DISPLAY OF MM DEALS                        *
     F*  36854  - C/C ACCOUNT ARE NOT REPORTED (A=0)                  *
     F*  36727  - ARRAY INDEX NOT VALID (DUMP)                        *
     F*  32134  - WRONG PLEDGE/GUARANTEE DETAILS DISPLAYED (DUE TO NOT*
     F*           ENOUGH PARAMETERS PASSED TO PGM PM2130)             *
     F*  B10529 - FOR DEALING, INCREASE LENGHT OF NOMINAL FIELD BY    *
     F*           REMOVE OF SIGN POSITION.                            *
     F*  B08253 - USE NEW MATURITY FILE IN PLACE OF PMHOLDL1 & L2     *
     F*  B08103 - CURRENCY 2 SHOULD NOT BE SET UP FOR FIXED PLEDGES   *
     F*  B08040 - SUNDRY FIXES TO SPEED UP COB                        *
     F*  B08019 - DO NOT SHOW UTILISED AMOUNT FOR FIXED PLEDGES       *
     F*  B07939 - HANDLE PRICES WITH 6 FIGURES BEFORE DECIMAL PLACE   *
     F*  R05956 - FOR GUARANTEE SHOULD NOT OUTPUT AMOUNT UTILISED     *
     F*  R05765 - DISTINGUISH BETWEEN PLEDGE AMOUNT GIVEN AND UTILISED*
     F*  R05757 - CORRECT VALIDATION OF ROLLUP KEY WHEN MATURE AND    *
     F*           FLAT POSITIONS ARE SHOWN ON SCREEN                  *
     F*  R05662 - ALTER YIELD CALCULATIONS TO CORRESPOND TO SE2405    *
     F*           ALSO IF YIELD 0 OR NEGATIVE OUTPUT -9999            *
     F*  R05655 - YIELDS OUTPUT 1 ORDER OF MAGNITUDE TOO SMALL        *
     F*  R05631 - OUTPUT 0.0 IF MARKET VALUE 0                        *
     F*  R05586 - FX DEALS SHOULD BE SHOWN WITH MARKET VALUE RATHER   *
     F*           THAN ACCRUED INTEREST                               *
     F*  R0147  - FX PROFIT & LOSS IS NOT SHOWED.                     *
     F*  R01164 - IF ACCRUED INTEREST OF ZERO OUTPUT 0.0 ON SCREEN    *
     F*  R0875  - PASS '9997' REFERENCE TO PM2050                     *
     F*  R00853 - OUTPUT TEXT 'FORWARD' FOR FORWARD VALUED LOANS AND  *
     F*           DEPOSITS                                            *
     F*  R01150 - DISPLAY LOANS AND ACCOUNTS WITH + OR - SIGN         *
     F*  R00631 - EXPRESS FX RATES ACCORDING TO THE RANK              *
     F*           OF THE CURRENCIES                                   *
     F*  R10060 - SHOW WHETHER GUARANTEE/PLEDGE GIVEN/RECEIVED        *
     F*  R10052 - DISPLAY 'CURRENCY 1' & 'CURRENCY 2'                 *
     F*  R10022 - TEST ROLLUP AND ROLLDOWN OUT OF PAGES               *
     F*           RESET ERROR INDICATORS                              *
     F*  R10021 - CLEAR ARRYS OF PAGE HEADINGS EACH TIME ENTER PROGRAM*
     F*  R10017 - ON F13 REMOVE MATURE FLAT POSITIONS IF LAST SCREEN  *
     F*           IS ALREADY DISPLAYED THE NEXT SCREEN DISPLAYED WILL *
     F*           BE BLANK.                                           *
     F*  R10016 - KEY TO HOLDINGS FILE CHANGED TO INCLUDE NARRATIVE   *
     F*           SO THAT POINTER MAY BE POSITIONED FOR RE ACCOUNTS   *
     F*  R10013 - WHEN REMOVING FLAT POSITIONS NEXT PAGE OF ENQUIRY   *
     F*           DISPLAYED                                           *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F**
     F****PM0700DDCF  E                    WORKSTN                        S01486
     FPM0700DFCF  E                    WORKSTN                            S01486
     F                                        RRN1  KSFILE PM0700S1
     F                                        RRN2  KSFILE PM0700S2
     F                                        RRN3  KSFILE PM0700S3
     F                                        RRN4  KSFILE PM0700S4
     F**
     F*MHOLDL1IF**E           K        DISK                               B08253
     F****                                          KINFSR *PSSR          B08253
     F***PREFIX 'QF' **                                                   B08253
     F****                                                                B08253
     F*MHOLDL2IF**E           K        DISK                               B08253
     F****                                          KINFSR *PSSR          B08253
     F****        PMHOLDP0                          KRENAMEPMHOLDP2       B08253
     F** PREFIX 'QF' **
     F**
     F***PMHOLDL4IF  E           K        DISK                            CPM005
     FPMHOLDLAIF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR
     F*******     PMHOLDP0                          KRENAMEPMHOLDP4       CPM005
     F            PMHOLDP0                          KRENAMEPMHOLDP7       CPM005
     F** PREFIX 'QF' **
     F**
     F***PMHOLDL5IF  E           K        DISK                            CPM005
     F******                                        KINFSR *PSSR          CPM005
     F*******     PMHOLDP0                          KRENAMEPMHOLDP5       CPM005
     F** PREFIX 'QF' **
     F**
     FPMHOLDL6IF  E           K        DISK
     F                                              KINFSR *PSSR
     F            PMHOLDP0                          KRENAMEPMHOLDP6
     F** PREFIX 'QF' **                                                   B08253
     F****PMMFHLPPIF  E           K        DISK                     B08253S01486
     FPMMFHLPDIF  E           K        DISK                               S01486
     F                                              KINFSR *PSSR          B08253
     F            PMHOLDP0                          KRENAMEPMMFHLP0       B08253
     F** PREFIX 'PN' **
     F**
     F****PMPORTPPIF  E           K        DISK                           S01486
     FPMPORTPDIF  E           K        DISK                               S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'P9' **
     F****SDPORTPDIF  E                    DISK                           S01486
     F**********                                    KINFSR *PSSR          S01486
     F** PREFIX 'LB' **                                              32134S01486
     F****SDLOMBPDIF  E                    DISK                      32134S01486
     F**********                                    KINFSR *PSSR     32134S01486
     F** PREFIX 'A6' **                                             R00631S01486
     F****SDCURRL0IF  E           K        DISK                     R00631S01486
     F**********                                    KINFSR *PSSR    R00631S01486
     FINTYP   IF  E           K        DISK                               S71062
     F                                              KINFSR *PSSR          S71062
     F**                                                                  CPM005
     FPMDSPGPDIF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     F** PREFIX 'QA' **                                                   CPM005
     F**                                                                  CPM005
     FPMASLIL0IF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     FPMASLIL1IF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     F            PMASLID0                          KRENAMEPMASLID1       CPM005
     FPMASLIL3IF  E           K        DISK                               CPM005
     F            PMASLID0                          KRENAMEPMASLID3       CPM005
     F                                              KINFSR *PSSR          CPM005
     FPMDSGTPDIF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     FPMISTTPDIF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     F******************************************************************
     F**
     F** FUNCTION OF INDICATORS
     F**
     F******************************************************************
     F**
     F** U7      : DATA BASE ERROR
     F** U8      : DATA BASE ERROR
     F** KC      : EXIT OF JOB
     F** KL      : EXIT OF PROGRAM
     F***KD******: SEARCH AND PROMPT                                      CPM005
     F** KI      : TRADE/VALUE DATE SWAP
     F** KK      : WINDOW RIGHT<>LEFT
     F** KX      : CASHFLOW
     F** KY      : CUSTOMER NOTEPAD
     F**
     F***51******:*PM0700DD*INDICATOR*FOR*TITLE                           S01486
     F***52******:*PM0700DD*INDICATOR*FOR*TITLE                           S01486
     F***53******:*PM0700DD*INDICATOR                                     S01486
     F***54******:*PM0700DD*INDICATOR                                     S01486
     F** 51      : PM0700DF INDICATOR FOR TITLE                           S01486
     F** 52      : PM0700DF INDICATOR FOR TITLE                           S01486
     F** 53      : PM0700DF INDICATOR                                     S01486
     F** 54      : PM0700DF INDICATOR                                     S01486
     F**
     F***59******:*PM0700DD*INDICATOR*-*PROTECT*MODE                      S01486
     F***60******:*PM0700DD*INDICATOR*-*ANY*VALID*KEY                     S01486
     F***56-58***:*PM0700DD*INDICATOR*-*ERROR*INDICATORS                  S01486
     F***67******:*PM0700DD*INDICATOR*-*ERROR*INDICATOR                   S01486
     F** 59      : PM0700DF INDICATOR - PROTECT MODE                      S01486
     F** 60      : PM0700DF INDICATOR - ANY VALID KEY                     S01486
     F** 56-58   : PM0700DF INDICATOR - ERROR INDICATORS                  S01486
     F** 67      : PM0700DF INDICATOR - ERROR INDICATOR                   S01486
     F**
     F** 70 - 72 : FILE PROCESSING
     F**
     F** 79      : CALLED FROM PM0660(SEARCH AND SELECT)
     F**
     F** 80      : PROGRAM ERROR INDICATOR
     F**
     F** 90 - 99 : STANDARD SUBROUTINES
     F**
     F******************************************************************
     E**
     E**
     E** TABLES AND ARRAYS
     E*********************************************************************
      ** ARRAY FOR COPYRIGHT
      *
     E                    CPY@    1   1 80
      ** ARRAY FOR TO TRANSMIT ORDER NUMBER AS A PARAMETER TO PM2130      057400
      *                                                                   057400
     E                    ORD        50  3                                057400
     E**                                                                  057400
     E**
     E** ARRAY TO ENABLE ATTENTION KEY
     E**
     E**********          ATN     1   1 22                                S01486
     E***********                                                         CPM005
     E***ARRAY*FOR TITLE                                                  CPM005
     E***********                                                         CPM005
     E***********         TITL    1   2  5                                CPM005
     E*
     E** PAGE HEADING ARRAYS: TRADE DATE LIVE RECORDS
     E*******             TDD       150 30  A                             R10016
     E*******             TDD       150 50  A                             R00631
     E*******             TDD       150 53  A                       R00631CPM005
     E**********          TDD       150 58  A                                          CPM005 CGL029
     E                    TDD       150 64  A                                                 CGL029
     E                    HOAR      150  5 0                              160217
     E*
     E** TRADE DATE LIVE AND MATURED RECORDS
     E*******             TDM       150 30  A                             R10016
     E*******             TDM       150 50  A                             R00631
     E****                TDM       150 53  A                       B08253R00631
     E*
     E** VALUE DATE LIVE RECORDS
     E*******             VDD       150 30  A                             R10016
     E*******             VDD       150 50  A                             R00631
     E***********         VDD       150 53  A                       R00631CPM005
     E*
     E** VALUE DATE LIVE AND MATURED RECORDS
     E*******             VDM       150 30  A                             R10016
     E*******             VDM       150 50  A                             R00631
     E****                VDM       150 53  A                       B08253R00631
     E**
     E/COPY ZSRSRC,FFPRCSZ2                                               S71062
      /COPY ZSRSRC,ZSEDITZ1
      /COPY ZSRSRC,ZEDITZ1
      /COPY ZSRSRC,ZPOWERZ1
     E/COPY ZSRSRC,ZDATE2Z1                                               S71062
     E                    BLK     1   4 25                                CPM005
     E**                                                                  CPM005
     E** ARRAY FOR NARRATIVES                                             CPM005
     E**                                                                  CPM005
     E                    NARR    1   2 15                                CPM005
     E**                                                                  CPM005
     E                    VC1    10  10  1               Valides codes    S01486
     E***********         VC2        19  1               Valides codS01486CPM005
     E********************************************************************
     I**
     I** EXTERNAL FORMAT FOR GROUP DATA AREA
     I**
     I****WWGDA     E DSPMGRDAPP                                          S01486
     I**
     I****WWLDA     E DSPMLDAPP                                           S01486
     IWWLDA     E DSPMLDAPD                                               S01486
     I**
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I*
     IPSDS       SDS
     I**********                            244 253 WSID                  S01486
     I**********                            254 263 USID                  S01486
     I                                      244 253 WKSTN                 S01486
     I                                      254 263 USER                  S01486
     I**
     I** DATA STRUCTURE FOR RETAIL PROCESSING
     I**
     I            DS
     I**********                              1  18 WWTEXT                                    CGL029
     I                                        1  24 WWTEXT                                    CGL029
     I                                        1   60WWTCNM
     I***********                             7   7 FILL1                 085862
     I***********                             8  10 WWTCCY                085862
     I***********                            11  11 FILL2                 085862
     I***********                            12  150WWTACO                085862
     I***********                            16  16 FILL3                 085862
     I***********                            17  180WWTACS                085862
     I                                        7   9 WWTCCY                085862
     I**********                             10  130WWTACO                             085862 CGL029
     I**********                             14  150WWTACS                             085862 CGL029
     I**********                             16  18 WWBRCD                             085862 CGL029
     I                                       10  190WWTACO                                    CGL029
     I                                       20  210WWTACS                                    CGL029
     I                                       22  24 WWBRCD                                    CGL029
     I**                                                                  CPM005
     I** DATA STRUCTURE TO OUTPUT FIELDS TO SUBFILE                       CPM005
     I**                                                                  CPM005
     I            DS                                                      CPM005
     I**********                              1  40 DDLIN1                             CPM005 CGL029
     I                                        1  46 DDLIN1                                    CGL029
     I*                                                                   CPM005
     I                                        1   4 DDPER1                CPM005
     I                                        1   3 FIELA1                CPM005
     I                                        4   4 FIELA2                CPM005
     I*                                                                   CPM005
     I                                        1   3 DDCCY1                CPM005
     I*                                                                   CPM005
     I**********                              5  40 DDTOG1                             CPM005 CGL029
     I                                        5  46 DDTOG1                                    CGL029
     I                                        5  19 DDNOM1                CPM005
     I                                       20  20 DDFIL1                CPM005
     I**********                             21  40 DDNARR                             CPM005 CGL029
     I                                       21  46 DDNARR                                    CGL029
     I            DS                                                      CPM005
     I**********                              1  40 DDLIN2                             CPM005 CGL029
     I                                        1  46 DDLIN2                                    CGL029
     I*                                                                   CPM005
     I                                        1   4 DDPER2                CPM005
     I                                        1   3 FIELB1                CPM005
     I                                        4   4 FIELB2                CPM005
     I*                                                                   CPM005
     I                                        1   3 DDCCY2                CPM005
     I*                                                                   CPM005
     I**********                              5  40 DDTOG2                             CPM005 CGL029
     I                                        5  46 DDTOG2                                    CGL029
     I                                        5  19 DDNOM2                CPM005
     I                                       20  20 DDFIL2                CPM005
     I**********                             21  40 DDDETA                             CPM005 CGL029
     I                                       21  46 DDDETA                                    CGL029
     I            DS                                                      CPM005
     I                                        1  21 ZOUT21                CPM005
     I                                       18  20 WWPERC                CPM005
      /COPY ZSRSRC,ZSEDITZ2
     I/COPY ZSRSRC,FFSRDSZ1                                               S71062
     I/COPY ZSRSRC,FFPRCSZ3                                               S71062
     I**
     I** DATA STRUCTURE FOR PAGE HEADING INFORMATION
     I**
     IWWPAGE      DS
     I                                        1   20QFDSPS
     I                                        3   5 QFDSPG
     I                                        6   70QFITDS
     I                                        8  10 QFINNR
     I****                                   11  12 QFMODI                S01313
     I****                                   13  13 QFRECI                S01313
     I****                                   14  23 QFTDSS                S01313
     I****************                       24  290QFTRNB                R00631
     I****************                       30  49 QFTXT2                R00631
     I****************                       50  50 WWDETT                R00631
     I****                                   24  260QFDLSQ          R00631S01313
     I****                                   27  320QFTRNB          R00631S01313
     I****                                   33  52 QFTXT2          R00631S01313
     I****                                   53  53 WWDETT          R00631S01313
     I***********                            11  130QFDLSQ          S01313CPM005
     I***********                            14  16 QFCCY1          S01313CPM005
     I                                       11  21 QFPOSQ                CPM005
     I***********                            33  380QFACNO          CPM004CPM005
     I***********                            17  26 QFTDSS          S01313CPM005
     I***********                            27  320QFTRNB          S01313CPM005
     I***********                            33  52 QFTXT2          S01313CPM005
     I***********                            33  35 WWFFMC          S71062CPM005
     I***********                            37  41 WWFFMY          S71062CPM005
     I***********                            53  53 WWDETT          R00631CPM005
     I                                       22  31 QFTDSS                CPM005
     I**********                             32  370QFTRNB                             CPM005 CLE148
     I                                       32  37 QFTRNB                                    CLE148
     I                                       38  430QFACNO                CPM005
     I**********                             38  57 QFTXT2                             CPM005 CGL029
     I                                       38  63 QFTXT2                                    CGL029
     I                                       38  40 WWFFMC                CPM005
     I                                       42  46 WWFFMY                CPM005
     I**********                             58  58 WWDETT                             CPM005 CGL029
     I                                       64  64 WWDETT                                    CGL029
     IW2SCRN      DS                                                      B08253
     I**********                              1   60W2CNUM                             B08253 CSD027
     I                                        1   6 W2CNUM                                    CSD027
     I                                        7  10 W2PTFR                B08253
     I                                       11  120W2DSPS                B08253
     I                                       13  15 W2DSPG                B08253
     I                                       16  170W2ITDS                B08253
     I                                       18  20 W2INNR                B08253
     I****                                   21  22 W2MODI          B08253S01313
     I****                                   23  23 W2RECI          B08253S01313
     I****                                   24  33 W2TDSS          B08253S01313
     I****                                   34  360W2DLSQ          B08253S01313
     I****                                   37  420W2TRNB          B08253S01313
     I****                                   43  62 W2TXT2                B08253
     I                                       21  230W2DLSQ                S01313
     I                                       24  26 W2CCY1                S01313
     I                                       27  36 W2TDSS                S01313
     I**********                             37  420W2TRNB                             S01313 CLE148
     I                                       37  42 W2TRNB                                    CLE148
     I                                       43  62 W2TXT2                S01313
     I*                                                                   S71062
     I            DS                                                      S71062
     I*                                                                   S71062
     I** DATA STRUCTURE TO DISPLAY SETTLEMENT DATE ONLY WHEN FF           S71062
     I*                                                                   S71062
     I                                        1   2 WWDDAY                S71062
     I I            '/'                       3   3 WWORK1                S71062
     I                                        4   5 WWMNTH                S71062
     I I            '/'                       6   6 WWORK2                S71062
     I                                        7   8 WWYEAR                S71062
     I                                        1   8 WWSETD                S71062
     I            DS                                                      S71062
     I                                        1   20WWDSET                S71062
     I                                        3   40WWMSET                S71062
     I                                        5   60WWYSET                S71062
     I                                        1   60WKSETD                S71062
     I            DS                                                      S71062
     I*                                                                   S71062
     I** DATA STRUCTURE TO DISPLAY DDNOM1                                 S71062
     I*                                                                   S71062
     I                                        1  15 WWNOM1                S71062
     I                                        4   4 WWNO12                S71062
     I                                        6   7 WWNO13                S71062
     I                                        8   8 WWSIGN                S71062
     I            DS                                                      S71062
     I*                                                                   S71062
     I** DATA STRUCTURE TO DISPLAY DDNAR2                                 S71062
     I*                                                                   S71062
     I**********                              1  20 WWNAR2                             S71062 CGL029
     I                                        1  26 WWNAR2                                    CGL029
     I                                        1   5 WWFOIS                S71062
     I                                        7  11 WWMTYR                S71062
     I                                       13  20 WWDATE                S71062
     I            DS                                                      S71062
     I*                                                                   S71062
     I** DATA STRUCTURE TO DISPLAY DDDET2                                 S71062
     I*                                                                   S71062
     I**********                              1  20 DDDET2                             S71062 CGL029
     I                                        1  26 DDDET2                                    CGL029
     I***************                         1   3 WWCCY1          S71062CPM005
     I                                        1   3 WWCCY2                CPM005
     I                                        4   9 WWMONT                S71062
     ISDMMOD    E DSSDMMODPD                                              S01486
     I** EXTERNAL DS FOR MODULES DETAILS                                  S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              S01486
     I** EXTERNAL DS FOR PORTFOLIO DETAILS                                S01486
     I*                                                                   S01486
     ISDLOMB    E DSSDLOMBPD                                              S01486
      ** LB MODULE ACCESSED VIA ACCESS PROGRAM                            S01486
     I*                                                                   S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I* DS FOR CURRENCIES DETAILS                                         S01486
     I*                                                                   S01486
     ISDCUST    E DSSDCUSTPD                                              S01496
     I** DUMMY RECORD FORMAT FOR CUSTOMER DETAILS                         S01496
     I*                                                                   S71062
     ISDBANK    E DSSDBANKPD                                              S71062
     I** EXTERNAL DS FOR BANK DETAILS                                     S71062
     I*                                                                   CPM005
     ISDPLIN    E DSSDPLINPD                                              CPM005
     I** EXTERNAL DS FOR INSTRUMENT DETAILS                               CPM005
     I*                                                                   S01496
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, LONG  DATA STRUCTURE                S01486
     I***********                                                   S01486CPM005
     I***Format*Valid codes                                         S01486CPM005
     I***********                                                   S01486CPM005
     I*********** DS                                                S01486CPM005
     I***********                             1  19 WWVALC          S01486CPM005
     I***********                             1   5 DDVAC1          S01486CPM005
     I**********                              7   9 DDVAC2          S01486S01496
     I**********                              7  11 DDVAC2          S01496S71062
     I***********                             7  13 DDVAC2          S71062CPM005
     I*
     ICPYR@#      DS
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I**
     I            DS                                                      S01496
     I                                        1   6 #FLD##                S01496
     I                                        1   2 #FLDG#                S01496
     I                                        4   5 #FLDS#                S01496
     I                                        1   6 #FLDB#                S01496
     I**                                                                  S01496
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #INIT    - INITIAL PROCESSING                                    *
      * #P1001   - PROCESS PM HOLDINGS SCREEN                            *
      * #P1002   - LOAD SUBFILE WITH TRADE DATE HOLDINGS                 *
      * #P1003   - LOAD SUBFILE WITH VALUE DATE HOLDINGS                 *
      * #P1004   - FORMAT 'SE' HOLDINGS FOR OUTPUT TO SUBFILE            *
      * #P1005   - FORMAT 'FF' 'DL' 'LE' AND 'RE' HOLDINGS               *
      * #P1006   - DISPLAY CUSTOMER GLOBAL POSITION                      *
      * #P1007   - LOAD SUBFILE WITH ALL POSITIONS FOR SECURITY          *
      * #P1008   - DISPLAY INSTRUMENT DETAILS OF A HOLDING               *
      * #P1009   - DISPLAY TRANSACTION DETAILS OF A HOLDING              *
      * #P1010   - DISPLAY DETAILS OF PLEDGES                            *
      * #P1011   - SET UP ARRAY OF VALUE DATE PAGE HEADINGS              *
      * #P1012   - SET UP ARRAY OF TRADE DATE PAGE HEADINGS              *
      * #V1001   - VALIDATE SUBFILE ENTRIES                              *
      * #U1001   - FILL SUBFILE HEADER                                   *
      * ZSEDIT   - TO CONVERT NUMERIC FIELD WITH DECIMAL POINT           *
      * ZEDIT    - TO CONVERT A NUMERIC FIELD WITH DECIMAL POINT         *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      **PMC1010**-*PROGRAM*CALLED*TO*RETRIEVE *GDA************************S01486
      * PMC1003  - PROGRAM CALLED TO RETRIEVE *LDA                       *S01486
      **QCMDEXC* -*SYSTEM*PORGRAM*****************************************S01486
      **PMC1000**-*PROGRAM*CALLED*TO*UPDATE *GDA**************************S01486
      * PMC1001  - PROGRAM CALLED TO UPDATE *LDA                         *S01486
      **PMC1020**-*PROGRAM*CALLED*TO*END*GROUP*JOB************************S01486
      * PM0660   - SEARCH AND PROMPT SELECT                              *
      * PM0640   - PORTFOLIO CASHFLOW                                    *
      * PM0600   - CUSTOMER NOTEPAD                                      *
      * PM0650   - INSTRUMENT CASHFLOW                                   *
      * PM2000   - DEAL DETAILS                                          *
      * PM2010   - LOAN DETAILS                                          *
      * PM2020   - SECURITY DETAILS                                      *
      * PM2030   - F&O INSTRUMENT DETAILS                                *
      * PM2040   - RETAIL ACCOUNT DETAILS                                *
      * PM2050   - PORTFOLIO MOVEMENTS (SE)                              *
      * PM2055   - PORTFOLIO MOVEMENTS (SE)                              *CPM004
      * PM2070   - DEAL AMENDMENTS PER DEAL                              *
      * PM2080   - LOAN AMENDMENTS PER LOAN                              *
      * PM2090   - F&O TRANSACTION DETAILS                               *
      *                                                                  *
      ********************************************************************
     C********************************************************
     C*
     C                     MOVEACPY@      CPY2@  80
     C*
     C**
     C** KEY LISTS
     C**
     C           PMHOLA    KLIST                                          CPM005
     C                     KFLD           QFCNUM                          CPM005
     C                     KFLD           QFPTFR                          CPM005
     C                     KFLD           QFPOST                          CPM005
     C                     KFLD           QFDSPS                          CPM005
     C                     KFLD           QFDSPG                          CPM005
     C                     KFLD           QFITDS                          CPM005
     C                     KFLD           QFINNR                          CPM005
     C                     KFLD           QFPOSQ                          CPM005
     C                     KFLD           QFTDSS                          CPM005
     C                     KFLD           QFTRNB                          CPM005
     C                     KFLD           QFTXT2                          CPM005
     C**                                                                  CPM005
     C           PMHOLD    KLIST
     C                     KFLD           QFCNUM
     C                     KFLD           QFPTFR
     C                     KFLD           QFDSPS
     C                     KFLD           QFDSPG
     C                     KFLD           QFITDS
     C                     KFLD           QFINNR
     C****                 KFLD           QFMODI                          S01313
     C****                 KFLD           QFRECI                          S01313
     C****                 KFLD           QFTDSS                          S01313
     C                     KFLD           QFDLSQ                          R00631
     C                     KFLD           QFCCY1                          S01313
     C                     KFLD           QFTDSS                          S01313
     C                     KFLD           QFTRNB
     C                     KFLD           QFTXT2                          R10016
     C**
     C           PMHOLZ    KLIST
     C                     KFLD           QFCNUM
     C                     KFLD           QFPTFR
     C                     KFLD           QFDSPS
     C                     KFLD           QFDSPG
     C                     KFLD           QFITDS
     C                     KFLD           QFINNR
     C****                 KFLD           QFMODI                          S01313
     C****                 KFLD           QFRECI                          S01313
     C****                 KFLD           QFTDSS                          S01313
     C                     KFLD           QFDLSQ                          S01313
     C                     KFLD           QFCCY1                          S01313
     C                     KFLD           QFTDSS                          S01313
     C                     KFLD           QFTRNB
     C                     KFLD           QFTXT2                          B08040
     C**
     C           PMHOLG    KLIST
     C                     KFLD           WWCNUM
     C                     KFLD           WWPTFR
     C                     KFLD           WWDSPS
     C                     KFLD           WWDSPG
     C                     KFLD           WWITDS
     C                     KFLD           WWINNR
     C**
     C           PMHOL6    KLIST
     C                     KFLD           WWTDS1 10
     C**********           KFLD           WWCNM1  60                                          CSD027
     C                     KFLD           WWCNM1  6                                           CSD027
     C                     KFLD           WWTVD1  1
     C                     KFLD           WWPTF1  4
     C**
     C           KLPORT    KLIST
     C                     KFLD           QFCNUM
     C                     KFLD           QFPTFR
      *                                                                   CPM005
      **  ACCESS PMASLIL0                                                 CPM005
     C           PMASL0    KLIST                                          CPM005
     C                     KFLD           W0CNUM                          CPM005
     C                     KFLD           W0PTF1                          CPM005
     C                     KFLD           W0POTY                          CPM005
     C                     KFLD           W0DGRS                          CPM005
     C                     KFLD           W0DGRC                          CPM005
     C                     KFLD           W0TOTT                          CPM005
      *                                                                   CPM005
      **  ACCESS PMASLIL1                                                 CPM005
     C           PMASL1    KLIST                                          CPM005
     C                     KFLD           W0CNUM                          CPM005
     C                     KFLD           W0PTF1                          CPM005
     C                     KFLD           W0POTY                          CPM005
      *                                                                   145934
      **  ACCESS PMASLIL0                                                 145934
     C           PMASL2    KLIST                                          145934
     C                     KFLD           W0CNUM                          145934
     C                     KFLD           W0PTF1                          145934
     C                     KFLD           W0POTY                          145934
     C                     KFLD           W0DGRS                          145934
     C                     KFLD           W0DGRC                          145934
     C                     KFLD           W0TOTT                          145934
     C                     KFLD           W0INSS                          145934
     C                     KFLD           W0INSC                          145934
      *                                                                   CPM005
      **  ACCESS PMASLIL3                                                 CPM005
     C           PMASL3    KLIST                                          CPM005
     C**********           KFLD           W0CNUM  60                                   CPM005 CSD027
     C                     KFLD           W0CNUM  6                                           CSD027
     C                     KFLD           W0PTF1  4                       CPM005
     C                     KFLD           W0POTY  2                       CPM005
     C                     KFLD           W0DGRC  3                       CPM005
     C                     KFLD           W0DGRS  20                      CPM005
     C                     KFLD           W0INSC  3                       CPM005
     C                     KFLD           W0INSS  20                      CPM005
     C                     KFLD           W0TOTT  1                       CPM005
      *                                                                   CPM005
      **  ACCESS PMDSGTPD                                                 CPM005
     C           PMDSGT    KLIST                                          CPM005
     C                     KFLD           QFCNUM                          CPM005
     C                     KFLD           QFPTFR                          CPM005
     C                     KFLD           QFDSPS                          CPM005
     C                     KFLD           QFDSPG                          CPM005
      *                                                                   CPM005
      **  ACCESS PMISTTPD                                                 CPM005
     C           PMISTT    KLIST                                          CPM005
     C                     KFLD           QFCNUM                          CPM005
     C                     KFLD           QFPTFR                          CPM005
     C                     KFLD           QFDSPS                          CPM005
     C                     KFLD           QFDSPG                          CPM005
     C                     KFLD           QFITDS                          CPM005
     C                     KFLD           QFINNR                          CPM005
     C********************************************************
     C** P R O G R A M   S T A R T
     C********************************************************
     C**
     C                     EXSR #INIT
     C**
     C                     EXSR #P1001
     C**
     C                     RETRN
     C********************************************************
     C** P R O G R A M   E N D
     C********************************************************
     C**
     ******************************************************************   S01496
     C/EJECT                                                              S01496
     ******************************************************************   S01496
     C* P002   : CHANGE SCREEN DETAILS                                *   S01496
     ******************************************************************   S01496
     C*                                                                   S01496
     C           P002      BEGSR                                          S01496
     C*                                                                   S01496
     C** PARAMETERS - DEFINITION AND INITIALIZATION                       S01496
     C                     MOVEL*BLANKS   ##CDBR  3                       S01496
     C                     MOVEL*BLANKS   ##CDCN  6                       S01496
     C                     MOVEL*BLANKS   ##CDSN 10                       S01496
     C                     MOVEL*BLANKS   ##PTFR  4                       S01496
     C                     MOVEL*BLANKS   ##CPBI  1                       S01496
     C                     MOVEL*BLANKS   ##CSBI  1                       S01496
     C                     MOVEL*OFF      ##FLAG  1                       S01496
     C                     MOVEL*BLANKS   HBLOCK  2                       S01496
     C                     MOVEL*BLANKS   GBLOCK  2                       S01496
     C                     MOVEL*BLANKS   SBLOCK  2                       S01496
     C*                                                                   S01496
     C** AFTER THE SECURITY INFORMATIONS WAS RECEIVED FROM BASIC FILE     S01496
     C** LF/SECTY                                                         S01496
     C*                                                                   S01496
     C** 1. SEARCH IF THERE IS A GENERAL BLOCK PURCHASED AND/OR SALES FOR S01496
     C**    SECURITY BY CALLING RPG/SE6712 WITH PARAMETERS:               S01496
     C**     - BRANCH CODE (3A)  CURRENT   FIELD NAME - CDBR - ##CDBR     S01496
     C**     - SECURITY    (10A) CURRENT   FIELD NAME - CDSN - ##CDSN     S01496
     C**     - SECURITY PURCH.GEN.BLOCK IND. (1A)  BLANK       ##CPBI     S01496
     C**     - SECURITY SALES GEN.BLOCK IND. (1A)  BLANK       ##CSBI     S01496
     C******************** MOVE BRCD      ##CDBR                          S01496
     C                     MOVE BBBRCD    ##CDBR                          S01496
     C                     MOVELQFTDSS    ##CDSN                          S01496
     C                     CALL 'SE6712'                                  S01496
     C                     PARM           ##CDBR                          S01496
     C                     PARM           ##CDSN                          S01496
     C                     PARM           ##CPBI                          S01496
     C                     PARM           ##CSBI                          S01496
     C*                                                                   S01496
     C** 2. IF 'SECURITY PURCH.GEN.BLOCK IND.' = 'Y' OR                   S01496
     C**       'SECURITY SALES GEN.BLOCK IND.' = 'Y'                      S01496
     C*                                                                   S01496
     C** 2.1 MOVE 'BLK' INTO THE FIRST CURRENCY FIELD OF THE SECOND       S01496
     C**     SUBFILE RECORD                                               S01496
     C**     MOVE LEFT 'GB', 'GP', 'GS', DEPENDING CONTENS OF THE         S01496
     C**     RECEIVED INDICATORS INTO THE SECURITY REFERENCE FIELD        S01496
     C**     OF THE SECOND LINE OF THE SUBFILE RECORD.                    S01496
     C                     SELEC                                          S01496
     C           ##CPBI    WHEQ 'Y'                                       S01496
     C           ##CSBI    ANDEQ'Y'                                       S01496
     C                     MOVEL'GB'      GBLOCK                          S01496
     C                     MOVEL*ON       ##FLAG                          S01496
     C           ##CPBI    WHEQ 'Y'                                       S01496
     C                     MOVEL'GP'      GBLOCK                          S01496
     C                     MOVEL*ON       ##FLAG                          S01496
     C           ##CSBI    WHEQ 'Y'                                       S01496
     C                     MOVEL'GS'      GBLOCK                          S01496
     C                     MOVEL*ON       ##FLAG                          S01496
     C                     OTHER                                          S01496
     C                     MOVEL*BLANKS   GBLOCK                          S01496
     C                     ENDSL                                          S01496
     C*                                                                   S01496
     C** 3. SEARCH IF THERE IS A SPECIFIC BLOCK PURCHASED AND/OR SALES    S01496
     C**    FOR CUSTOMER/SECURITY BY CALLING RPG/SE6716 WITH PARAMETERS:  S01496
     C**     - BRANCH CODE (3A)  CURRENT   FIELD NAME - CDBR - ##CDBR     S01496
     C**     - CUSTOMER    (6A)  CURRENT   FIELD NAME - CDCN - ##CDCN     S01496
     C**     - SECURITY    (10A) CURRENT   FIELD NAME - CDSN - ##CDSN     S01496
     C**     - PORTFOLIO   (4A)  CURRENT   FIELD NAME          ##PTFR     S01496
     C**     - PURCH.SPEC.BLOCK IND. (1A)  BLANK               ##CPBI     S01496
     C**     - SALES SPEC.BLOCK IND. (1A)  BLANK               ##CSBI     S01496
     C******************** MOVE BRCD      ##CDBR                          S01496
     C                     MOVE BBBRCD    ##CDBR                          S01496
     C                     MOVE QFCNUM    ##CDCN                          S01496
     C                     MOVELQFTDSS    ##CDSN                          S01496
     C                     MOVELQFPTFR    ##PTFR                          S01496
     C                     CALL 'SE6716'                                  S01496
     C                     PARM           ##CDBR                          S01496
     C                     PARM           ##CDCN                          S01496
     C                     PARM           ##CDSN                          S01496
     C                     PARM           ##PTFR                          S01496
     C                     PARM           ##CPBI                          S01496
     C                     PARM           ##CSBI                          S01496
     C*                                                                   S01496
     C** 4. IF 'PURCH.SPECIFIC BLOCK IND.' = 'Y' OR                       S01496
     C**       'SALES SPECIFIC BLOCK IND.' = 'Y'                          S01496
     C*                                                                   S01496
     C** 4.1 MOVE 'BLK' INTO THE FIRST CURRENCY FIELD OF THE SECOND       S01496
     C**     SUBFILE RECORD. IT COULD BE ALREADY DONE BY 2.1.             S01496
     C**     MOVE RIGHT 'SB', 'SP', 'SS', DEPENDING CONTENS OF THE        S01496
     C**     RECEIVED INDICATORS INTO THE SECURITY REFERENCE FIELD        S01496
     C**     OF THE SECOND LINE OF THE SUBFILE RECORD.                    S01496
     C                     SELEC                                          S01496
     C           ##CPBI    WHEQ 'Y'                                       S01496
     C           ##CSBI    ANDEQ'Y'                                       S01496
     C                     MOVEL'SB'      SBLOCK                          S01496
     C                     MOVEL*ON       ##FLAG                          S01496
     C           ##CPBI    WHEQ 'Y'                                       S01496
     C                     MOVEL'SP'      SBLOCK                          S01496
     C                     MOVEL*ON       ##FLAG                          S01496
     C           ##CSBI    WHEQ 'Y'                                       S01496
     C                     MOVEL'SS'      SBLOCK                          S01496
     C                     MOVEL*ON       ##FLAG                          S01496
     C                     OTHER                                          S01496
     C                     MOVEL*BLANKS   SBLOCK                          S01496
     C                     ENDSL                                          S01496
     C*                                                                   S01496
     C           ##FLAG    IFEQ *ON                                       S01496
     C                     MOVELDDTOG4    #FLD##                          S01496
     C                     MOVEL*BLANKS   #FLDB#                          S01496
     C                     MOVELGBLOCK    #FLDG#                          S01496
     C                     MOVELSBLOCK    #FLDS#                          S01496
     C                     MOVEL#FLD##    DDTOG4                          S01496
     C                     MOVEL'BLK'     DDCCY2                          S01496
     C                     ENDIF                                          S01496
     C*                                                                   S01496
     C                     ENDSR                                          S01496
     C* P002   : CHANGE SCREEN DETAILS                                *   S01496
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #BLANK   - RESET SCREEN FIELDS                                   *
      *                                                                  *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1004
      * #P1005                                                           *
      * #P1007                                                           *
      *                                                                  *
      ********************************************************************
     C           #BLANK    BEGSR
     C**
     C** RESET HIDDEN FIELDS
     C**
     C                     MOVEL*BLANKS   DDSHOR
     C                     MOVEL*BLANKS   DDRECH
     C                     MOVEL*BLANKS   DDMODH
     C                     MOVEL*BLANKS   DDTRNH
     C                     MOVEL*BLANKS   DDFOIH
     C                     MOVEL*BLANKS   DDCNUM                          CPM004
     C                     MOVEL*BLANKS   DDCCYH
     C                     MOVEL*BLANKS   DDACOH
     C                     MOVEL*BLANKS   DDACSH
     C                     MOVEL*BLANKS   DDBRCH                          085862
     C                     Z-ADD0         DDCLOH                          S71062
     C**
     C** RESET SUBFILE FIELDS
     C**
     C                     MOVEL*BLANKS   DDNARR
     C                     MOVEL*BLANKS   DDNAR2                          S71062
     C                     MOVEL*BLANKS   DDNOM1
     C                     MOVEL*BLANKS   DDFIL1                          CPM005
     C                     MOVE *BLANKS   DDCCY1                          R10052
     C                     MOVEL*BLANKS   DDMKTP
     C                     MOVEL*BLANKS   DDMFXR
     C                     MOVEL*BLANKS   DDMVPC
     C                     MOVEL*BLANKS   DDMVIC
     C                     MOVEL*BLANKS   DDDETA
     C                     MOVEL*BLANKS   DDDET2                          S71062
     C                     MOVEL*BLANKS   DDNOM2
     C                     MOVEL*BLANKS   DDFIL2                          CPM005
     C                     MOVE *BLANKS   DDCCY2                          R10052
     C                     MOVE *BLANKS   DDTOG4                          S01496
     C                     MOVEL*BLANKS   DDFOPR
     C                     MOVEL*BLANKS   DDFFXR
     C                     MOVEL*BLANKS   DDAIPC
     C                     MOVEL*BLANKS   DDAIIC
     C                     MOVEL*BLANKS   DDSECU
     C                     MOVEL*BLANKS   DDAMEU                          S71062
     C                     MOVEL*BLANKS   DDMKTY
     C                     MOVEL*BLANKS   DDMTPL
     C                     MOVEL*BLANKS   DDFOLY
     C                     MOVEL*BLANKS   DDEXPL
     C***************      MOVEL*BLANKS   DDXCCY                    R05586R00631
     C                     MOVEL*BLANKS   DDCOLR                          CPM005
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #INIT    - INITIAL PROCESSING                                    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1010**-*PROGRAM*CALLED*TO*RETRIEVE *GDA************************S01486
      * PMC1003  - PROGRAM CALLED TO RETRIEVE *LDA                       *S01486
      **QCMDEXC**-*SYSTEM*PORGRAM*****************************************S01486
      * #P1002   - LOAD SUBFILE WITH TRADE DATE HOLDINGS                 *
      * #P1003   - LOAD SUBFILE WITH VALUE DATE HOLDINGS                 *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      **WWPARM***- *GDA***************************************************S01486
      * WWPARM   - *LDA                                                  *S01486
      * WWCNUM   - CUSTOMER NUMBER                                       *
      * WWPTFR   - PORTFOLIO REFERENCE                                   *
      * WWDSPS   - DISPLAY SEQUENCE                                      *
      * WWDSPG   - DISPLAY GROUP                                         *
      * WWITDS   - INSTRUMENT DISPLAY SEQUENCE                           *
      * WWINNR   - INSTRUMENT TYPE                                       *
      * WWFLD    - WORK FIELD                                            *
      * WWNUMB   - PARAMETER                                             *
      * WWDISP   - DISPLAY INDICATOR                                     *
      * WWINTV   - INTERIM TRADE/VALUE INDICATOR                         *
      *                                                                  *
      ********************************************************************
     C           #INIT     BEGSR
     C*
     C                     MOVEA*BLANKS   ORD                             057400
     C                     Z-ADD0         PL                              057400
     C**                                                                  103085
     C** Acces file SDMMODPD to check if multibranching system            103085
     C**                                                                  103085
     C                     CALL 'AOMMODR0'                                103085
     C                     PARM '*DBERR ' @RTCD   7                       103085
     C                     PARM '*FIRST ' @OPTN   7                       103085
     C           SDMMOD    PARM SDMMOD    DSFDY                           103085
     C           @RTCD     IFNE *BLANKS                                   103085
     C                     MOVEL'Y'       QMDBER                          103085
     C                     MOVEL'Y'       QMENQT                          103085
     C                     MOVE 'SDMMOD'  QMFILE                          103085
     C                     MOVE 'PM0700'  QMPGM                           103085
     C                     MOVE *BLANKS   QMKEY            ***************103085
     C                     Z-ADD6         QMERRN           **DB ERROR 06**103085
     C**                                                   ***************103085
     C                     CALL 'PMC1001'                                 103085
     C                     PARM           WWLDA                           103085
     C                     RETRN                                          103085
     C                     END                                            103085
      *                                                                   S01496
      **  Access SAR details file to see if JYSKE Enhcmts is installed.   S01496
      *                                                                   S01496
     C                     CALL 'AOSARDR0'                                S01496
     C                     PARM '       ' @RTCD                           S01496
     C                     PARM '*VERIFY' @OPTN                           S01496
     C                     PARM 'S01496'  @SARD   6                       S01496
      *                                                                   S01496
     C           @RTCD     IFEQ *BLANK                                    S01496
     C                     MOVE 'Y'       S01496  1                       S01496
     C                     END                                            S01496
     C           S01496    IFEQ 'Y'                        B0             S01496
     C                     MOVE '1'       *IN51                           S01496
     C                     ELSE                            X1             S01496
     C                     MOVE '0'       *IN51                           S01496
     C                     END                             E1             S01496
     C*                                                                   S01496
     C** FIRST TIME PROGRAM CALLED OBTAIN PM ICD
     C**  AND LB ICD                                                      32134
     C           WWMAFF    IFEQ *BLANKS
     C********** 1         SETLLSDLOMBPD                             32134S01486
     C**********           READ SDLOMBPD                 73          32134S01486
     C           BGLMCR    IFEQ 'Y'                                       103085
     C                     CALL 'AOLOMBR0'                                S01486
     C                     PARM '*DBERR ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDLOMB    PARM SDLOMB    DSFDY                           S01486
     C                     ENDIF                                          103085
     C********** 1         SETLLSDPORTPD                                  S01486
     C**********           READ SDPORTPD                 73               S01486
     C                     CALL 'AOPORTR0'                                S01486
     C                     PARM '*DBERR ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDPORT    PARM SDPORT    DSFDY                           S01486
     C                     END
     C*                                                                   S71062
     C** GET INSTALLATION CONTROL DATA RECORD 1                           S71062
     C*                                                                   S71062
     C                     CALL 'AOBANKR0'                                S71062
     C                     PARM *BLANKS   WWRTCD  7                       S71062
     C                     PARM '*FIRST ' WWOPTN  7                       S71062
     C           SDBANK    PARM SDBANK    DSFDY                           S71062
     C**
     C** RESET WORK FIELDS
     C**
     C                     MOVEL*BLANKS   WWSAVR
     C                     MOVEL*BLANKS   WWSAVM
     C                     MOVEL*BLANKS   WWSAVS
     C                     MOVEL*BLANKS   WWSAVD
     C                     MOVEL*BLANKS   WWACTN  1
     C                     MOVEL*BLANKS   WWDSPO  3                       CPM005
     C                     MOVEL*BLANKS   WWINTO  3                       CPM005
     C                     MOVEL'D'       WWMAFF  1
     C                     Z-ADD0         WWPRIC 105                      R05655
     C                     Z-ADD0         WWPRI1 104                      R05655
     C                     Z-ADD0         WWPRI3 103                      B07939
     C                     Z-ADD0         WWPRI2 102                      CH0177
     C*
     C                     MOVEA*BLANKS   TDD                             R10021
     C****                 MOVEA*BLANKS   TDM                       B08253R10021
     C******               MOVEA*BLANKS   VDD                       R10021CPM005
     C****                 MOVEA*BLANKS   VDM                       B08253R10021
     C**
     C** RESET INDICATORS
     C**
     C                     MOVE '0'       *IN
     C                     MOVE '0'       *INKL
     C**
     C                     MOVEL'J'       ZECODE
     C**
     C** RETRIEVE DATA AREA *LDA
     C**
     C                     CALL 'PMC1003'
     C                     PARM           WWLDA
     C**
     C********** QMTRNB    IFNE 0                                                             CLE148
     C           QMTRNB    IFNE *BLANK                                                        CLE148
     C           QMSESN    ORNE *BLANKS
     C                     MOVE '1'       *IN79
     C                     END
     C**
     C***LOAD*DATA*AREA *GDA*INFORMATIONS                                 S01486
     C** LOAD DATA AREA *LDA INFORMATIONS                                 S01486
     C**
     C                     MOVELQMRUNA    DDRUNA
     C**********           Z-ADDQMCNUM    WWCNUM  60                                          CSD027
     C                     MOVE QMCNUM    WWCNUM  6                                           CSD027
     C                     MOVELQMPTF1    WWPTFR  4
     C                     MOVE QMPOTY    WWPOTY  2                       CPM005
     C                     Z-ADDQMDSPS    WWDSPS  20
     C                     MOVELQMDSPG    WWDSPG  3
     C                     Z-ADDQMITDS    WWITDS  20
     C                     MOVELQMINNR    WWINNR  3
     C                     MOVELQMTOTT    PPTOTT  1        TOTAL TYPE     CPM005
     C*                                                                   CPM005
     C**********           Z-ADDQMCNUM    W0CNUM                                       CPM005 CSD027
     C                     MOVE QMCNUM    W0CNUM                                              CSD027
     C                     MOVELQMPTF1    W0PTF1                          CPM005
     C                     MOVEL*BLANKS   W0POTY                          CPM005
     C*                                                                   CPM005
     C                     Z-ADD*ZEROS    PPASSV 150                      CPM005
     C                     Z-ADD*ZEROS    PPLIAV 150                      CPM005
     C*                                                                   CPM005
     C** ACCESS TO PMASLIPD                                               CPM005
     C           PMASL1    SETLLPMASLIL1                                  CPM005
     C                     READ PMASLIL1                 72               CPM005
      *                                                                   CPM005
      ** SAVE CUSTOMER NUMBER & PORTFOLIO REFERENCE                       CPM005
     C**********           Z-ADDFECNUM    WSCNUM  60                                   CPM005 CSD027
     C                     MOVE FECNUM    WSCNUM  6                                           CSD027
     C                     MOVELFEPTFR    WSPTFR  4                       CPM005
      *                                                                   CPM005
     C           *IN72     DOWEQ'0'                        *BW1           CPM005
     C           FECNUM    ANDEQWSCNUM                                    CPM005
     C           FEPTFR    ANDEQWSPTFR                                    CPM005
      *                                                                   CPM005
      **  ADD ASSET & LIABILITY VALUE                                     CPM005
     C                     ADD  FEASSV    PPASSV                          CPM005
     C                     ADD  FELIAV    PPLIAV                          CPM005
      *                                                                   CPM005
      **  READ NEXT RECORD                                                CPM005
     C                     READ PMASLIL1                 72               CPM005
      *                                                                   CPM005
     C                     ENDDO                           *EW1           CPM005
      *                                                                   CPM005
     C                     MOVELQMPOTY    W0POTY                          CPM005
     C*                                                                   CPM005
     C** ACCESS TO PMASLIPP                                               CPM005
     C           PMASL1    CHAINPMASLIL1             72                   CPM005
     C*                                                                   CPM005
     C           *IN72     IFEQ '1'                        ***************CPM005
     C                     MOVE 'PMASLIL1'QMFILE           ** DB ERROR 10*CPM005
     C                     MOVE W0POTY    QMKEY            ***************CPM005
     C                     Z-ADD10        QMERRN                          CPM005
     C                     EXSR *PSSR                                     CPM005
     C                     END                                            CPM005
      *                                                                   CPM005
      **  ADD ASSET & LIABILITY VALUE                                     CPM005
     C                     Z-ADDFEASSV    PPASVL 150                      CPM005
     C                     Z-ADDFELIAV    PPLIVL 150                      CPM005
     C**
     C***SET*ATTENTION*PROGRAM                                            S01486
     C**********                                                          S01486
     C**********           MOVEAATN       WWFLD  22                       S01486
     C**********           Z-ADD22        WWNUMB 155                      S01486
     C**********           CALL 'QCMDEXC'                                 S01486
     C**********           PARM           WWFLD                           S01486
     C**********           PARM           WWNUMB                          S01486
     C*
     C** MOVE FIELDS FROM DTAARA/*LDA TO FIELDS USED TO ACCESS HOLDINGS FILE
     C**********           Z-ADDQMCNUM    QFCNUM                                              CSD027
     C                     MOVE QMCNUM    QFCNUM                                              CSD027
     C                     MOVE QMPTF1    QFPTFR
     C                     MOVE QMPOTY    QFPOST                          CPM005
     C                     Z-ADDQMDSPS    QFDSPS
     C                     MOVE QMDSPG    QFDSPG
     C                     Z-ADDQMITDS    QFITDS
     C                     MOVE QMINNR    QFINNR
     C                     MOVE QMSESN    QFTDSS
     C**********           Z-ADDQMTRNB    QFTRNB                                              CLE148
     C                     MOVELQMTRNB    QFTRNB                                              CLE148
     C******               MOVE *ZEROS    QFDLSQ                    R00631CPM005
     C******               MOVE QMCCY1    QFCCY1                    S01313CPM005
     C                     MOVE *LOVAL    QFPOSQ                          CPM005
     C                     MOVE *LOVAL    QFTXT2                          S01313
     C*
     C** USING PARAMETERS RECEIVED FROM DTAARA/*LDA OBTAIN FULL KEY DETAILS
     C***FROM*PF/PMHOLDPP                                                 CPM005
     C** FROM PF/PMHOLDPD                                                 CPM005
     C***********QMTVPS    IFEQ 'T'                                       CPM005
     C***********PMHOLZ    SETLLPMHOLDL4                                  CPM005
     C***********          READ PMHOLDL4                 72               CPM005
     C           PMHOLA    SETLLPMHOLDLA                                  CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDEQ*BLANKS                                   CPM005
     C           *IN72     OREQ '0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDNE*BLANKS                                   CPM005
     C           QFBYSF    ANDEQ'S'                                       CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C                     END                                            CPM005
     C***********          ELSE                                           CPM005
     C***********PMHOLZ    SETLLPMHOLDL5                                  CPM005
     C***********          READ PMHOLDL5                 72               CPM005
     C***********          END                                            CPM005
     C*
     C***********QMTVPS    IFEQ 'V'                                 080700CPM005
     C***********          MOVE 'V'       WWDETT                    080700CPM005
     C***********          ELSE                                     080700CPM005
     C                     MOVE 'T'       WWDETT
     C***********          END                                      080700CPM005
     C********             MOVE WWPAGE    WWPAG1 30                       R10016
     C********             MOVE WWPAGE    WWPAG1 50                       R00631
     C***********          MOVE WWPAGE    WWPAG1 53                 R00631CPM005
     C**********           MOVE WWPAGE    WWPAG1 58                                    CPM005 CGL029
     C                     MOVE WWPAGE    WWPAG1 64                                           CGL029
     C**
     C** SET UP ARRAYS OF PAGE HEADINGS FOR TRADE / VALUE DATE AS APPROPRIATE
     C**
     C***********QMTVPS    IFEQ 'V'                                       CPM005
     C***********          EXSR #P1011                                    CPM005
     C***********          ELSE                                           CPM005
     C***********          EXSR #P1012                                    CPM005
     C***********          END                                            CPM005
     C**                                                                  CPM005
     C** POSITION TYPE EQUAL TO 'B' (BLOCK TOTAL)                         CPM005
     C**                                                                  CPM005
     C           PPTOTT    IFEQ 'B'                                       CPM005
     C                     EXSR #P102B                                    CPM005
     C                     ELSE                                           CPM005
     C**                                                                  CPM005
     C** POSITION TYPE EQUAL TO 'D' (DISPLAY GROUP TOTAL)                 CPM005
     C**                                                                  CPM005
     C           PPTOTT    IFEQ 'D'                                       CPM005
     C                     EXSR #P102D                                    CPM005
     C                     ELSE                                           CPM005
     C**                                                                  CPM005
     C** POSITION TYPE EQUAL TO 'I' (INSTRUMENT TOTAL)                    CPM005
     C**                                                                  CPM005
     C                     EXSR #P102I                                    CPM005
     C                     END                                            CPM005
     C                     END                                            CPM005
     C**
     C** SET THE SCREEN INDICATOR TO '1' - WHICH SCREEN IS OUTPUT
     C**
     C                     MOVE '1'       WWDISP  1
     C**
     C***IF*DISPLAY*TRADE/VALUE*DATE*ON*DTAARA *GDA*IS*'T'                S01486
     C** IF DISPLAY TRADE/VALUE DATE ON DTAARA *LDA IS 'T'                S01486
     C**
     C           QMTVPS    IFEQ 'T'
     C**
     C** SET INTERIM TRADE/VALUE INDICATOR TO 'T'
     C**
     C                     MOVEL'T'       WWINTV  1
     C***********          MOVELTITL,1    DDTITR                          CPM005
     C                     MOVE '1'       *IN53
     C                     ELSE                                           CPM005
     C                     MOVEL'V'       WWINTV                          CPM005
     C                     MOVE '0'       *IN53                           CPM005
     C                     END                                            CPM005
     C**
     C** FORCE POSITION IN FILE  BY SETTING ON INDICATOR OF
     C** ROLLDOWN
     C**
     C                     MOVE '1'       *IN23
     C                     MOVE 'Y'       WWFORC  1                       59481
     C                     EXSR #P1002
     C                     MOVE '0'       *IN23
     C**
     C***********          END                                            CPM005
     C***********                                                         CPM005
     C***IF*DISPLAY*TRADE/VALUE*DATE*ON*DTAARA *GDA*IS*'V'                S01486
     C***IF*DISPLAY*TRADE/VALUE DATE ON DTAARA *LDA IS 'V'          S01486CPM005
     C***********                                                         CPM005
     C***********QMTVPS    IFEQ 'V'                                       CPM005
     C***********                                                         CPM005
     C***SET*INTERIM TRADE/VALUE INDICATOR TO 'V'                         CPM005
     C***********                                                         CPM005
     C***********          MOVEL'V'       WWINTV  1                       CPM005
     C***********          MOVELTITL,2    DDTITR                          CPM005
     C***********          MOVE '0'       *IN53                           CPM005
     C***********                                                         CPM005
     C***FORCE*POSITION IN FILE  BY SETTING ON INDICATOR OF               CPM005
     C***ROLLDOWN                                                         CPM005
     C***********                                                         CPM005
     C***********          MOVE '1'       *IN23                           CPM005
     C***********          MOVE 'Y'       WWFORC  1                  59481CPM005
     C***********          EXSR #P1003                                    CPM005
     C***********          MOVE '0'       *IN23                           CPM005
     C***********                                                         CPM005
     C***********          END                                            CPM005
     C**                                                                  CPM005
     C           QMACTP    IFEQ *BLANKS                                   CPM005
     C                     MOVEL'PM0700'  QMACTP    P                     CPM005
     C                     CALL 'PMC1001'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C                     END                                            CPM005
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1001   - PROCESS PM HOLDINGS SCREEN                            *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #U1001   - FILL SUBFILE HEADER                                   *
      **PMC1000**-*PROGRAM*CALLED*TO*UPDATE *GDA**************************S01486
      * PMC1001  - PROGRAM CALLED TO UPDATE *LDA                         *S01486
      **PMC1020**-*PROGRAM*CALLED*TO*END*GROUP*JOB************************S01486
      * PM0660   - SEARCH AND PROMPT SELECT                              *
      **PMC1010**-*PROGRAM*CALLED*TO*RETRIEVE *GDA************************S01486
      * PMC1003  - PROGRAM CALLED TO RETRIEVE *LDA                       *S01486
      * #P1002   - LOAD SUBFILE WITH TRADE DATE HOLDINGS                 *
      * #P1003   - LOAD SUBFILE WITH VALUE DATE HOLDINGS                 *
      * PM0640   - PORTFOLIO CASHFLOW                                    *
      * PM0600   - CUSTOMER NOTEPAD                                      *
      * #V1001   - VALIDATE SUBFILE ENTRIES                              *
      * PM0650   - INSTRUMENT CASHFLOW                                   *
      * #P1006   - DISPLAY CUSTOMER GLOBAL POSITION                      *
      * #P1008   - DISPLAY INSTRUMENT DETAILS OF A HOLDING               *
      * #P1009   - DISPLAY TRANSACTION DETAILS OF A HOLDING              *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWFLAG   - WORK FLAG                                             *
      * WWDISP   - DISPLAY INDICATOR                                     *
      **WWPARM***- *GDA***************************************************S01486
      * WWPARM   - *LDA                                                  *S01486
      * WWEND    - END PARAMETER                                         *
      * WWGRPJ   - GROUP JOB PARAMETER                                   *
      * WWINTV   - INTERIM TRADE/VALUE INDICATOR                         *
      * WWPTFR   - PORTFOLIO REFERENCE                                   *
      *                                                                  *
      ********************************************************************
     C           #P1001    BEGSR
     C***********                                                   S01486CPM005
     C***Set*up*authorised action codes                             S01486CPM005
     C***********                                                   S01486CPM005
     C***********          MOVELQMBRCA    @BRCA                     S01486CPM005
     C***********                                                   S01486CPM005
     C***Acces*file SDMMODPD to check if multibranching system      S01486CPM005
     C***********                                                   S01486CPM005
     C***********          CALL 'AOMMODR0'                          S01486CPM005
     C***********          PARM '*DBERR ' @RTCD   7                 S01486CPM005
     C***********          PARM '*FIRST ' @OPTN   7                 S01486CPM005
     C***********SDMMOD    PARM SDMMOD    DSFDY                     S01486CPM005
     C***********@RTCD     IFNE *BLANKS                             S01486CPM005
     C***********          MOVEL'Y'       QMDBER                    S01486CPM005
     C***********          MOVEL'Y'       QMENQT                    S01486CPM005
     C***********          MOVE 'SDMMOD'  QMFILE                    S01486CPM005
     C***********          MOVE 'PM0700'  QMPGM                     S01486CPM005
     C***********          MOVE *BLANKS   QMKEY            *********S01486CPM005
     C***********          Z-ADD6         QMERRN           **DB ERROS01486CPM005
     C***********                                          *********S01486CPM005
     C***********          CALL 'PMC1001'                           S01486CPM005
     C***********          PARM           WWLDA                     S01486CPM005
     C***********          RETRN                                    S01486CPM005
     C***********          END                                      S01486CPM005
     C***If*Bank*Portfolios are supported, treat as if FF off       CPM003CPM005
     C***********BGFUOP    IFEQ 'Y'                                 S71062CPM005
     C***********FCPORS    ANDNE'B'                                 CPM003CPM005
     C***********          MOVE '1'       *IN40                     S71062CPM005
     C***********          ELSE                                     S71062CPM005
     C***********          MOVE '0'       *IN40                     S71062CPM005
     C***********          END                                      S71062CPM005
     C***********                                                   S71062CPM005
     C***********          Z-ADD0         C       20                S01486CPM005
     C***********          Z-ADD1         D       20                S01486CPM005
      ***********                                                   S01486CPM005
     C***********D         DOWLT10                                  S01486CPM005
      ***********                                                   S01486CPM005
     C***********VC1,D     IFNE *BLANKS                             S01486CPM005
      ***********                                                   S71062CPM005
     C***********BGFUOP    IFEQ 'Y'                                 S71062CPM005
     C***********FCPORS    ANDNE'B'                                 CPM003CPM005
     C***********VC1,D     ANDEQ'O'                                 S71062CPM005
     C***********          MOVEL'E'       VC1,D                     S71062CPM005
     C***********          END                                      S71062CPM005
      ***********                                                   S71062CPM005
     C***********          MOVELVC1,D     @ZACTN                    S01486CPM005
     C***********          EXSR #AUTH                               S01486CPM005
      ***********                                                   S01486CPM005
     C***********          ADD  1         C                         S01486CPM005
     C***********@ERR      IFEQ 0                                   S01486CPM005
     C***********          MOVELVC1,D     VC2,C                     S01486CPM005
     C***********S01496    IFEQ ' '                                 S01496CPM005
     C***********VC1,D     ANDEQ'D'                                 S01496CPM005
     C***********          MOVEL' '       VC2,C                     S01496CPM005
     C***********          END                                      S01496CPM005
     C***********BGFUOP    IFEQ 'Y'                                 S71062CPM005
     C***********FCPORS    ANDNE'B'                                 CPM003CPM005
     C***********VC1,D     ANDEQ'E'                                 S71062CPM005
     C***********          MOVEL'O'       VC2,C                     S71062CPM005
     C***********          END                                      S71062CPM005
     C***********BGFUOP    IFNE 'Y'                                 S71062CPM005
     C***********VC1,D     ANDEQ'E'                                 S71062CPM005
     C***********BGFUOP    OREQ 'Y'                                 CPM003CPM005
     C***********FCPORS    ANDEQ'B'                                 CPM003CPM005
     C***********VC1,D     ANDEQ'E'                                 CPM003CPM005
     C***********          MOVEL' '       VC2,C                     S71062CPM005
     C***********          END                                      S71062CPM005
     C***********          END                                      S01486CPM005
      ***********                                                   S01486CPM005
     C************IN30     IFEQ '1'                                 S01486CPM005
     C***********VC1,D     IFEQ 'C'                                 S01486CPM005
     C***********          MOVEA' '       VC2,C                     S01486CPM005
     C***********          END                                      S01486CPM005
     C***********          END                                      S01486CPM005
      ***********                                                   S01486CPM005
     C***********          ADD  1         C                         S01486CPM005
     C***********          MOVEA','       VC2,C                     S01486CPM005
      ***********                                                   S01486CPM005
     C***********          END                                      S01486CPM005
      ***********                                                   S01486CPM005
     C***********          ADD  1         D                         S01486CPM005
     C***********          END                                      S01486CPM005
      ***********                                                   S01486CPM005
     C***********          MOVEAVC2       WWVALC                    S01486CPM005
     C**
     C                     WRITEPM0700F6
     C**
     C** DO UNTIL TERMINATION FLAG IS SET TO 'Y'
     C**
     C           WWFLAG    DOUEQ'Y'
     C**
     C** SET TERMINATION FLAG TO 'N'
     C**
     C                     MOVEL'N'       WWFLAG  1
     C                     MOVEL*BLANK    DDACTN
     C**
     C** FOLLOWING DISPLAY INDICATOR SEND CORRESPONDING FORMAT
     C**
     C**
     C           WWDISP    IFEQ '1'
     C**
     C** FORMAT SUBFILE
     C**
     C                     EXSR #U1001
     C                     WRITEPM0700F3
     C                     WRITEPM0700F1
     C                     EXFMTPM0700C1
     C                     ELSE
     C**
     C** FORMAT SUBFILE
     C**
     C                     EXSR #U1001
     C                     WRITEPM0700F3
     C                     WRITEPM0700F1
     C                     EXFMTPM0700C2
     C                     END
     C**
     C                     CALL 'ZA0250'
     C                     MOVE '0'       *IN56                           R10022
     C                     MOVE '0'       *IN57                           R10022
     C                     MOVE '0'       *IN58                           R10022
     C                     MOVE *OFF      *IN63                           S71062
     C                     MOVE '0'       *IN67                           R10022
     C                     MOVE '0'       *IN66                           R10022
     C                     MOVE '0'       *IN68                           R10022
     C                     MOVE '0'       *IN74                           B08253
     C                     MOVE '0'       *IN80
     C                     MOVE '0'       *IN42                           081239
     C                     MOVE 'N'       WWGLOB
     C** +++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF F4 TAKEN - SEARCH
     C** +++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C************INKD     IFEQ '1'                        B1             CPM005
     C***********                                                         CPM005
     C***DISPLAY*SEARCH AND SELECT PROMPT                                 CPM005
     C***********                                                         CPM005
     C***********          CALL 'PMC0660'                                 CPM005
     C***********          PARM           WWF12   1                       CPM005
     C***********                                                         CPM005
     C***********WWF12     IFNE 'Y'                        B2             CPM005
     C***********                                                         CPM005
     C***RETRIEVE*DATA*AREA *GDA*TO*READ*INFORMATIONS*PASSED*BY           S01486
     C***RETRIEVE DATA AREA *LDA TO READ INFORMATIONS PASSED BY     S01486CPM005
     C***PROGRAM PM0660                                                   CPM005
     C***********                                                         CPM005
     C***********          CALL 'PMC1003'                                 CPM005
     C***********          PARM           WWLDA                           CPM005
     C***********                                                         CPM005
     C***IF*EITHER SECURITY SHORT NAME OR TRANSACTION REFERENCE           CPM005
     C***NOT*BLANK                                                        CPM005
     C***********                                                         CPM005
     C***********QMSESN    IFNE *BLANKS                    B3             CPM005
     C****       QMTRNB    ORNE 0                                         S01313
     C***********                                                         CPM005
     C***LOAD*SUBFILE WITH TRADE DATE HOLDINGS                            CPM005
     C***********                                                         CPM005
     C***********          Z-ADDQMDSPS    QFDSPS                          CPM005
     C***********          MOVELQMDSPG    QFDSPG                          CPM005
     C***********          Z-ADDQMITDS    QFITDS                          CPM005
     C***********          MOVELQMINNR    QFINNR                          CPM005
     C***********          MOVELQMSESN    QFTDSS                          CPM005
     C****                 Z-ADDQMTRNB    QFTRNB                          S01313
     C***********          Z-ADD0         QFDLSQ                    S01313CPM005
     C***********          MOVE QMCCY1    QFCCY1                    S01313CPM005
     C***********          Z-ADD0         QFTRNB                    S01313CPM005
     C***********          MOVE *BLANKS   QFTXT2                    S01313CPM005
     C***********                                                         CPM005
     C***USING*PARAMETERS RECEIVED FROM DTAARA/*LDA OBTAIN FULL KEY DETAILCPM005
     C***FROM*PF/PMHOLDPP                                                 CPM005
     C***********WWINTV    IFEQ 'T'                        B4             CPM005
     C***********PMHOLZ    SETLLPMHOLDL4                                  CPM005
     C***********          READ PMHOLDL4                 72               CPM005
     C***********          ELSE                            X4             CPM005
     C***********PMHOLZ    SETLLPMHOLDL5                                  CPM005
     C***********          READ PMHOLDL5                 72               CPM005
     C***********          END                             E4             CPM005
     C***********                                                         CPM005
     C***********          MOVE WWPAGE    WWPAG1                          CPM005
     C***********          END                             E3             CPM005
     C***********                                                         CPM005
     C***LOAD*NEXT PAGE OF TRADE / VALUE DATE HOLDINGS                    CPM005
     C***********WWINTV    IFEQ 'T'                        B3             CPM005
     C***********          EXSR #P1002                                    CPM005
     C***********          ELSE                            X3             CPM005
     C***********          EXSR #P1003                                    CPM005
     C***********          END                             E3             CPM005
     C***********                                                         CPM005
     C***********          END                             E2             CPM005
     C***********                                                         CPM005
     C***********          END                             E1             CPM005
     C****+++++++++++++++++++++++++++++++++++++++++++++++++++++++++       B08040
     C****F F9 TAKEN - TRADE/VALUE                                        B08040
     C****+++++++++++++++++++++++++++++++++++++++++++++++++++++++++       B08040
     C****                                                                B08040
     C****       *INKI     IFEQ '1'                        B1             B08040
     C****                                                                B08040
     C****F INTERIM TRADE/VALUE INDICATOR IS 'T'                          B08040
     C****       WWINTV    IFEQ 'T'                        B2             B08040
     C****                                                                B08040
     C****ET INTERIM INDICATOR TO 'V'                                     B08040
     C****                 MOVEL'V'       WWINTV                          B08040
     C****                                                                B08040
     C****AVE CURRENT PAGE OF DETAILS DISPLAYED                           B08040
     C****       A         IFEQ 0                          B3             B08040
     C****                 MOVE *BLANKS   WWPAG2                          B08040
     C****                 ELSE                                           B08040
     C****       WWMAFF    IFEQ 'D'                        B3             B08040
     C*******              MOVE TDD,A     WWPAG2 30                       B08040
     C*******              MOVE TDD,A     WWPAG2 50                       B08040
     C****                 MOVE TDD,A     WWPAG2 53                       B08040
     C****                 ELSE                            X3             B08040
     C****                 MOVE TDM,A     WWPAG2                          B08040
     C****                 END                             E3             B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****F ARRAY OF VALUE DATE PAGE HEADINGS NOT ALREADY LOADED PERFORM  B08040
     C****P1013                                                           B08040
     C****       VDM,1     IFEQ *BLANKS                    B3             B08040
     C****                 EXSR #P1011                                    B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****ETERMINE PAGE OF ENQUIRY TO BE DISPLAYED                        B08040
     C****                 Z-ADD1         A                               B08040
     C****       WWPAG2    IFNE *BLANKS                    B3             B08040
     C****       WWMAFF    IFEQ 'D'                        B3             B08040
     C****       WWPAG2    LOKUPVDD,A                72                   B08040
     C****                 ELSE                            X3             B08040
     C****       WWPAG2    LOKUPVDM,A                72                   B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****       *IN72     IFEQ '1'                        B3             B08040
     C****       A         SUB  1         A                               B08040
     C****                 ELSE                            X3             B08040
     C****                                                                B08040
     C****                 MOVE *BLANKS   WWPAG2                          B08040
     C****       WWMAFF    IFEQ 'D'                        B4             B08040
     C****       WWPAG2    LOKUPVDD,A                    72               B08040
     C****                 ELSE                            X4             B08040
     C****       WWPAG2    LOKUPVDM,A                    72               B08040
     C****                 END                             E4             B08040
     C****       A         SUB  1         A                               B08040
     C****                 END                             E3             B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****                 MOVE '0'       *IN23                           B08040
     C****                 MOVE '0'       *IN24                           B08040
     C****                                                                B08040
     C****                 EXSR #P1003                                    B08040
     C****                 MOVELTITL,2    DDTITR                          B08040
     C****                 MOVE '0'       *IN53                           B08040
     C****                                                                B08040
     C****THERWISE INTERIM TRADE/VALUE INDICATOR IS 'V'                   B08040
     C****                                                                B08040
     C****                 ELSE                            X2             B08040
     C****                                                                B08040
     C****                                                                B08040
     C****ET INTERIM INDICATOR TO 'T'                                     B08040
     C****                                                                B08040
     C****                 MOVEL'T'       WWINTV                          B08040
     C****                                                                B08040
     C****AVE CURRENT PAGE OF DETAILS DISPLAYED                           B08040
     C****       A         IFEQ 0                          B3             B08040
     C****                 MOVE *BLANKS   WWPAG2                          B08040
     C****                 ELSE                                           B08040
     C****       WWMAFF    IFEQ 'D'                        B3             B08040
     C****                 MOVE VDD,A     WWPAG2                          B08040
     C****                 ELSE                            X3             B08040
     C****                 MOVE VDM,A     WWPAG2                          B08040
     C****                 END                             E3             B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****F ARRAY OF VALUE DATE PAGE HEADINGS NOT ALREADY LOADED PERFORM  B08040
     C****P1013                                                           B08040
     C****       TDM,1     IFEQ *BLANKS                    B3             B08040
     C****                 EXSR #P1012                                    B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****ETERMINE PAGE OF ENQUIRY TO BE DISPLAYED                        B08040
     C****                 Z-ADD1         A                               B08040
     C****       WWPAG2    IFNE *BLANKS                    B3             B08040
     C****       WWMAFF    IFEQ 'D'                        B3             B08040
     C****       WWPAG2    LOKUPTDD,A                72                   B08040
     C****                 ELSE                            X3             B08040
     C****       WWPAG2    LOKUPTDM,A                72                   B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****       *IN72     IFEQ '1'                        B3             B08040
     C****       A         SUB  1         A                               B08040
     C****                 ELSE                            X3             B08040
     C****                                                                B08040
     C****                 MOVE *BLANKS   WWPAG2                          B08040
     C****       WWMAFF    IFEQ 'D'                        B4             B08040
     C****       WWPAG2    LOKUPTDD,A                    72               B08040
     C****                 ELSE                            X4             B08040
     C****       WWPAG2    LOKUPTDM,A                    72               B08040
     C****                 END                             E4             B08040
     C****       A         SUB  1         A                               B08040
     C****                 END                             E3             B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****                 MOVE '0'       *IN23                           B08040
     C****                 MOVE '0'       *IN24                           B08040
     C****                 EXSR #P1002                                    B08040
     C****                 MOVELTITL,1    DDTITR                          B08040
     C****                 MOVE '1'       *IN53                           B08040
     C****                                                                B08040
     C****                 END                             E2             B08040
     C****                                                                B08040
     C****                 END                             E1             B08040
     C** +++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF F11 TAKEN - WINDOW LEFT <> RIGHT
     C** +++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C**
     C           *INKK     IFEQ '1'
     C**
     C** IF THE SCREEN DISPLAY IS EQUAL TO '1' SET IT TO '2'
     C**
     C           WWDISP    IFEQ '1'
     C                     MOVEL'2'       WWDISP
     C                     MOVE '1'       *IN54
     C                     ELSE
     C**
     C** IF THE SCREEN DISPLAY IS EQUAL TO '2' SET IT TO '1'
     C**
     C                     MOVEL'1'       WWDISP
     C                     MOVE '0'       *IN54
     C                     END
     C**
     C                     END
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF F13 TAKEN - MATURE FLAT FLAG
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C****       *INKM     IFEQ '1'                        B1
     C****                                                                B08040
     C****       WWMAFF    IFEQ 'D'                        B2             B08040
     C****                 MOVEL'M'       WWMAFF                          B08040
     C****                 MOVE '1'       *IN65                           B08040
     C****                                                                B08040
     C****AVE CURRENT PAGE OF DETAILS DISPLAYED                           B08040
     C****       A         IFEQ 0                          B3             B08040
     C****                 MOVE *BLANKS   WWPAG2                          B08040
     C****                 ELSE                                           B08040
     C****       WWINTV    IFEQ 'T'                        B4             B08040
     C****                 MOVE TDD,A     WWPAG2                          B08040
     C****                 ELSE                            X4             B08040
     C****                 MOVE VDD,A     WWPAG2                          B08040
     C****                 END                             E4             B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****ETERMINE PAGE OF ENQUIRY TO BE DISPLAYED                        B08040
     C****                 Z-ADD1         A                               B08040
     C****       WWPAG2    IFNE *BLANKS                    B3             B08040
     C****       WWINTV    IFEQ 'T'                        B3             B08040
     C****       WWPAG2    LOKUPTDM,A                72                   B08040
     C****                 ELSE                            X3             B08040
     C****       WWPAG2    LOKUPVDM,A                72                   B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****       *IN72     IFEQ '1'                        B3             B08040
     C****       A         SUB  1         A                               B08040
     C****                 ELSE                            X3             B08040
     C****                                                                B08040
     C****                 MOVE *BLANKS   WWPAG2                          B08040
     C****       WWINTV    IFEQ 'T'                        B4             B08040
     C****       WWPAG2    LOKUPTDM,A                    72               B08040
     C****                 ELSE                            X4             B08040
     C****       WWPAG2    LOKUPVDM,A                    72               B08040
     C****                 END                             E4             B08040
     C****       A         SUB  1         A                               B08040
     C****                 END                             E3             B08040
     C****                 END                             E3             B08040
     C****                 ELSE                            X2             B08040
     C****                 MOVEL'D'       WWMAFF                          B08040
     C****                 MOVE '0'       *IN65                           B08040
     C****                                                                B08040
     C****AVE CURRENT PAGE OF DETAILS DISPLAYED                           B08040
     C****       A         IFEQ 0                          B3             B08040
     C****                 MOVE *BLANKS   WWPAG2                          B08040
     C****                 ELSE                                           B08040
     C****       WWINTV    IFEQ 'T'                        B4             B08040
     C****                 MOVE TDM,A     WWPAG2                          B08040
     C****                 ELSE                            X4             B08040
     C****                 MOVE VDM,A     WWPAG2                          B08040
     C****                 END                             E4             B08040
     C****                 END                             E3             B08040
     C****                                                                B08040
     C****ETERMINE PAGE OF ENQUIRY TO BE DISPLAYED                        B08040
     C****                 Z-ADD1         A                               B08040
     C****       WWPAG2    IFNE *BLANKS                    B3             B08040
     C****       WWINTV    IFEQ 'T'                        B3             B08040
     C****       WWPAG2    LOKUPTDD,A                72                   B08040
     C****                 ELSE                            X3             B08040
     C****       WWPAG2    LOKUPVDD,A                72                   B08040
     C****                 END                             E3             B08040
     C****       *IN72     IFEQ '1'                        B3             B08040
     C****       A         SUB  1         A                               B08040
     C****                 ELSE                            X3             B08040
     C****                 MOVE *BLANKS   WWPAG2                          B08040
     C****       WWINTV    IFEQ 'T'                        B4             B08040
     C****       WWPAG2    LOKUPTDD,A                    72               B08040
     C****                 ELSE                            X4             B08040
     C****       WWPAG2    LOKUPVDD,A                    72               B08040
     C****                 END                             E4             B08040
     C****       A         SUB  1         A                               B08040
     C****                 END                             E3             B08040
     C****                 END                             E3             B08040
     C****                 END                             E2             B08040
     C*                                                                   B08040
     C** DETERMINE SCREEN TO DISPLAY                                      B08040
     C           *INKM     IFEQ '1'                        B1
     C****                 Z-ADD1         A                         B0804059481
     C           WWMAFF    IFEQ 'D'                        B2             B08040
     C*                                                                   B08253
     C** F13 NOT ALLOWED IF NOT FLAT MATURED POSITIONS FOR CUSTOMER       B08253
     C** AND PORTFOLIO. SET FILE POINTER BEFORE FIRST RECORD ON           B08253
     C***PF/PMMFHLPP                                               B08253 S01486
     C** PF/PMMFHLPD                                                      S01486
     C                     MOVE QMCNUM    QFCNUM                          B08253
     C                     MOVE QMPTF1    QFPTFR                          B08253
     C****                 Z-ADDQMDSPS    QFDSPS                    B08253CPM005
     C****                 MOVE QMDSPG    QFDSPG                    B08253CPM005
     C****                 Z-ADDQMITDS    QFITDS                    B08253CPM005
     C****                 MOVE QMINNR    QFINNR                    B08253CPM005
     C                     Z-ADD*LOVAL    QFDSPS                          CPM005
     C                     MOVE *LOVAL    QFDSPG                          CPM005
     C                     Z-ADD*LOVAL    QFITDS                          CPM005
     C                     MOVE *LOVAL    QFINNR                          CPM005
     C****                 MOVE *LOVAL    QFMODI                    B08253S01313
     C****                 MOVE *LOVAL    QFRECI                    B08253S01313
     C                     MOVE *LOVAL    QFTDSS                          B08253
     C                     Z-ADD*LOVAL    QFDLSQ                          B08253
     C**********           Z-ADD*LOVAL    QFTRNB                                       B08253 CLE148
     C                     MOVEL*LOVAL    QFTRNB                                              CLE148
     C                     MOVE *LOVAL    QFTXT2                          B08253
     C                     MOVE *LOVAL    QFCCY1                          S01313
     C*                                                                   B08253
     C********** PMHOLD    SETLLPMMFHLPP                            B08253S01486
     C**********           READ PMMFHLPP                 72         B08253S01486
     C           PMHOLD    SETLLPMMFHLPD                                  S01486
     C                     READ PMMFHLPD                 72               S01486
     C*                                                                   B08253
     C** IF NO RECORDS EXIST FOR CUSTOMER OUTPUT ERROR MESSAGE            B08253
     C           *IN72     IFEQ '1'                        B3             B08253
     C           QFCNUM    ORNE QMCNUM                                    B08253
     C           QFPTFR    ORNE QMPTF1                                    B08253
     C***********QFDSPS    ORNE QMDSPS                              B08253CPM005
     C***********QFDSPG    ORNE QMDSPG                              B08253CPM005
     C***********QFINNR    ORNE QMINNR                              B08253CPM005
     C***********QFITDS    ORNE QMITDS                              B08253CPM005
     C                     MOVE '1'       *IN74                           B08253
     C*                                                                   B08253
     C** .....OTHERWISE SET UP VARIABLES CONTAINING DETAILS OF FIRST      B08253
     C** AND LAST POSITIONS FOR CUSTOMER                                  B08253
     C                     ELSE                            X3             B08253
     C                     EXSR #SCRN                                     B08253
     C                     MOVE W2SCRN    WWFSTR 62                       B08253
     C*                                                                   B08253
     C** OBTAIN DETAILS OF LAST FLAT / MATURE POSITION                    B08253
     C***********          Z-ADDQMDSPS    QFDSPS                    B08253CPM005
     C***********          MOVE QMDSPG    QFDSPG                    B08253CPM005
     C***********          Z-ADDQMITDS    QFITDS                    B08253CPM005
     C***********          MOVE QMINNR    QFINNR                    B08253CPM005
     C                     Z-ADD*HIVAL    QFDSPS                          CPM005
     C                     MOVE *HIVAL    QFDSPG                          CPM005
     C                     Z-ADD*HIVAL    QFITDS                          CPM005
     C                     MOVE *HIVAL    QFINNR                          CPM005
     C****                 MOVE *HIVAL    QFMODI                    B08253S01313
     C****                 MOVE *HIVAL    QFRECI                    B08253S01313
     C                     MOVE *HIVAL    QFTDSS                          B08253
     C                     Z-ADD*LOVAL    QFDLSQ                          B08253
     C**********           Z-ADD*HIVAL    QFTRNB                                       B08253 CLE148
     C                     MOVEL*HIVAL    QFTRNB                                              CLE148
     C                     MOVE *HIVAL    QFTXT2                          B08253
     C                     MOVE *HIVAL    QFCCY1                          S01313
     C*                                                                   B08253
     C********** PMHOLD    SETLLPMMFHLPP                           B08253 S01486
     C**********           READPPMMFHLPP                 72        B08253 S01486
     C           PMHOLD    SETLLPMMFHLPD                                  S01486
     C                     READPPMMFHLPD                 72               S01486
     C                     EXSR #SCRN                                     B08253
     C                     MOVE W2SCRN    WWLSTR 62                       B08253
     C*                                                                   B08253
     C                     MOVEL'M'       WWMAFF                          B08040
     C                     MOVE '1'       *IN65                           B08040
     C                     END                             E3
     C*
     C                     ELSE                            X2             B08040
     C                     MOVEL'D'       WWMAFF                          B08040
     C                     MOVE '0'       *IN65                           B08040
     C                     END                             E2             B08040
     C*****                                                               B08040
     C*****TERMINE SCREEN TO DISPLAY                                      B08040
     C*****      WWINTV    IFEQ 'T'                        B3             B08040
     C*****                MOVE TDM,A     WWPAG2 53                       B08040
     C*****                ELSE                            X3             B08040
     C*****                MOVE VDM,A     WWPAG2                          B08040
     C*****                END                             E3             B08040
     C*****                                                               B08040
     C****                                                                B08040
     C****ETERMINE SCREEN TO DISPLAY                                      B08040
     C****       WWINTV    IFEQ 'T'                        B3             B08040
     C****                 MOVE TDD,A     WWPAG2                          B08040
     C****                 ELSE                            X3             B08040
     C****                 MOVE VDD,A     WWPAG2                          B08040
     C****                 END                             E3             B08040
     C*
     C** REBUILD DISPLAY SCREENS
     C           *IN74     IFEQ '0'                        B2             B08253
     C                     MOVE 'Y'       WWF13   1
     C***********WWINTV    IFEQ 'T'                        B3             CPM005
     C                     EXSR #P1002
     C***********          ELSE                            X3             CPM005
     C***********          EXSR #P1003                                    CPM005
     C***********          END                             E3             CPM005
     C*
     C                     MOVE 'N'       WWF13
     C*
     C                     END                             E2             B08253
     C*
     C                     END                             E1
     C**                                                                  S01486
     C** +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++S01486
     C** IF F22 TAKEN                                                     S01486
     C** +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++S01486
     C**                                                                  S01486
     C           *INKW     IFEQ '1'                                       S01486
     C**                                                                  S01486
     C                     MOVEL'PM0700'  QMACTP    P                     CPM005
     C                     CALL 'PMC1001'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C**                                                                  CPM005
     C                     CALL 'PMC0610'                                 S01486
     C**                                                                  CPM005
     C                     CALL 'PMC1003'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C**                                                                  CPM005
     C           QMENQT    IFEQ 'C'                                       CPM005
     C           QMENQT    OREQ 'P'                                       CPM005
     C           QMENQT    OREQ 'Y'                                       CPM005
     C                     MOVE 'Y'       WWFLAG                          CPM005
     C                     END                                            CPM005
     C**                                                                  S01486
     C                     END                                            S01486
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF F23 TAKEN - PORTFOLIO CASHFLOW
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C           *INKX     IFEQ '1'
     C**
     C                     CALL 'PM0640'
     C**
     C                     END
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF F24 TAKEN - CUSTOMER MANAGEMENT
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C           *INKY     IFEQ '1'
     C**
     C                     MOVEL'PM0700'  PGMNAM 10                       CPM005
     C                     CALL 'PMC0600'
     C                     PARM           PGMNAM                          CPM005
     C**
     C                     END
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF ROLLUP REQUESTED
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C           *IN23     IFEQ '1'
     C*                                                                   R05757
     C** SET UP WORKFIELD CONTAINING NUMBER OF PAGES OF INFORMATION       R05757
     C           WWMAFF    IFEQ 'D'                        B2             R05757
     C                     Z-ADDWWTDLV    WWNOPG  50                      R05757
     C                     ELSE                            X2             R05757
     C                     Z-ADDWWTDFL    WWNOPG                          R05757
     C                     END                             E2             R05757
     C**                                                                  R10022
     C** IF ROLLUP ON THE LAST PAGE SEND WARNING MESSAGE                  R10022
     C**                                                                  R10022
     C****       A         IFEQ WWNOPG                                    B08253
     C           WWMAFF    IFEQ 'D'                                       B08253
     C           A         ANDEQWWNOPG                                    B08253
     C           WWMAFF    OREQ 'M'                                       B08253
     C           WWBSCR    ANDEQWWLSTR                                    B08253
     C                     MOVE '1'       *IN68                           R10022
     C**                                                                  R10022
     C                     ELSE                                           R10022
     C**
     C** IF INTERIM TRADE/VALUE INDICATOR IS EQUAL TO 'T'
     C**
     C***********WWINTV    IFEQ 'T'                                       CPM005
     C**
     C** RETRIEVE NEXT PARAMETERS
     C**
     C                     MOVELQMPTF1    WWPTFR
     C**
     C                     EXSR #P1002
     C**
     C***********          ELSE                                           CPM005
     C***********                                                         CPM005
     C***IF*INTERIM TRADE/VALUE INDICATOR IS EQUAL TO 'V'                 CPM005
     C***********                                                         CPM005
     C***********                                                         CPM005
     C***RETRIEVE NEXT PARAMETERS                                         CPM005
     C***********                                                         CPM005
     C***********          MOVELQMPTF1    WWPTFR                          CPM005
     C***********                                                         CPM005
     C***********          EXSR #P1003                                    CPM005
     C***********                                                         CPM005
     C***********          END                                            CPM005
     C**                                                                  R10022
     C                     END                                            R10022
     C**
     C                     END
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF ROLLDOWN REQUESTED
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C           *IN24     IFEQ '1'
     C**                                                                  R10022
     C** IF ROLLDOWN ON THE FIRST PAGE SEND WARNING MESSAGE               R10022
     C**                                                                  R10022
     C******     A         IFEQ 1                                         B08253
     C           WWMAFF    IFEQ 'D'                                       B08253
     C           A         ANDEQ1                                         B08253
     C           WWMAFF    OREQ 'M'                                       B08253
     C           WWFSTR    ANDEQWWTSCR                                    B08253
     C                     MOVE '1'       *IN68                           R10022
     C**                                                                  R10022
     C                     ELSE                                           R10022
     C**
     C** IF INTERIM TRADE/VALUE INDICATOR IS EQUAL TO 'T'
     C**
     C***********WWINTV    IFEQ 'T'                                       CPM005
     C**
     C** RETRIEVE CURRENT PARAMETERS
     C**
     C                     MOVELQMPTF1    WWPTFR
     C**
     C                     EXSR #P1002
     C**
     C***********          ELSE                                           CPM005
     C***********                                                         CPM005
     C***IF*INTERIM TRADE/VALUE INDICATOR IS EQUAL TO 'V'                 CPM005
     C***********                                                         CPM005
     C***********                                                         CPM005
     C***RETRIEVE CURRENT PARAMETERS                                      CPM005
     C***********                                                         CPM005
     C***********          MOVELQMPTF1    WWPTFR                          CPM005
     C***********                                                         CPM005
     C***********          EXSR #P1003                                    CPM005
     C***********                                                         CPM005
     C***********          END                                            CPM005
     C**                                                                  R10022
     C                     END                                            R10022
     C**
     C                     END
     C** +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF ENTER HAS BEEN PRESSED
     C** +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C           *IN60     IFEQ '0'
     C**
     C** TEST WHICH FORMAT IS ACTIVE
     C**
     C           WWDISP    IFEQ '1'
     C                     READCPM0700S1                 70
     C** CHANGE OCCURED
     C**
     C           *IN70     IFEQ '0'
     C                     MOVELDDACTN    WWACTN
     C                     MOVEL*BLANKS   DDACTN
     C*                                                                   CPM005
     C** IF INSTRUMENT DETAILS READ SET ON INDICATOR 51 SO THAT           CPM005
     C** DISPLAYED IN RED                                                 CPM005
     C           DDCOLR    IFEQ 'Y'                                       CPM005
     C                     MOVE '1'       *IN51                           CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C                     UPDATPM0700S1
     C                     MOVE '0'       *IN51                           CPM005
     C                     END
     C                     ELSE
     C                     READCPM0700S2                 70
     C** CHANGE OCCURED
     C**
     C           *IN70     IFEQ '0'
     C                     MOVELDDACTN    WWACTN
     C                     MOVEL*BLANKS   DDACTN
     C*                                                                   CPM005
     C** IF INSTRUMENT DETAILS READ SET ON INDICATOR 51 SO THAT           CPM005
     C** DISPLAYED IN RED                                                 CPM005
     C           DDCOLR    IFEQ 'Y'                                       CPM005
     C                     MOVE '1'       *IN51                           CPM005
     C                     END                                            CPM005
     C                     UPDATPM0700S2
     C                     MOVE '0'       *IN51                           CPM005
     C                     END
     C                     END
     C**
     C** IF A CHANGE OCCURED
     C**
     C           *IN70     IFEQ '0'
     C**
     C** VALIDATE INPUT AS PER #V1001
     C**
     C                     EXSR #V1001
     C**
     C           *IN80     IFEQ '0'
     C**
     C** ACTION 'G'
     C**
     C           WWACTN    IFEQ 'G'
     C**
     C** RESTORE FIELDS FROM RECORD
     C**
     C                     MOVELDDMODH    WWSAVM  2
     C                     MOVELDDRECH    WWSAVR  1
     C                     MOVELDDSHOR    WWSAVS 10
     C**********           MOVE DDTRNH    WWSAVT  60                                          CLE148
     C                     MOVE DDTRNH    WWSAVT  6                                           CLE148
     C                     MOVELDDTVDH    WWSAVD  1
     C**
     C                     EXSR #P1006
     C**
     C** POSITION IN FILE
     C**
     C                     MOVELQMPTF1    WWPTFR
     C**
     C**
     C****       WWINTV    IFEQ 'T'                                       59468
     C****       PMHOLD    SETLLPMHOLDL1                                  B08253
     C****       PMHOLD    SETLLPMHOLDL4                       B08553     59468
     C****                 EXSR #P1002                                    59468
     C****                 ELSE                                           59468
     C****       PMHOLD    SETLLPMHOLDL2                                  B08253
     C****       PMHOLD    SETLLPMHOLDL5                         B08253   59468
     C****                 EXSR #P1003                                    59468
     C****                 END                                            59468
     C**
     C                     END
     C**
     C***ACTION*'C'                                                       CPM005
     C** ACTION 'K'                                                       CPM005
     C**
     C********** WWACTN    IFEQ 'C'                                       S01486
     C           WWACTN    IFEQ 'K'                                       S01486
     C**                                                                  CPM005
     C           DDMODH    IFEQ 'IT'                                      CPM005
     C                     MOVELDDTYPE    QMINNR                          CPM005
     C                     END                                            CPM005
     C**
     C                     MOVELDDMODH    QMMODI
     C           DDMODH    IFEQ 'SE'
     C                     MOVELDDSHOR    QMSESN
     C**********           Z-ADD*ZERO     QMTRNB                                              CLE148
     C                     MOVEL*BLANK    QMTRNB                                              CLE148
     C                     ELSE
     C                     MOVEL*BLANKS   QMSESN
     C                     MOVELDDTRNH    QMTRNB
     C                     END
     C**
     C***UPDATE *GDA                                                      S01486
     C** UPDATE *LDA                                                      S01486
     C**
     C                     CALL 'PMC1001'
     C                     PARM           WWLDA
     C**
     C** CALL PM0650 TO DISPLAY CASHFLOW FOR HOLDINGS
     C**
     C                     CALL 'PM0650'
     C                     CALL 'PMC1003'                                 081239
     C                     PARM           WWLDA                           081239
     C**
     C** RESET FIELDS
     C**
     C                     MOVEL*BLANKS   QMINNR                          CPM005
     C                     MOVEL*BLANKS   QMMODI
     C                     MOVEL*BLANKS   QMSESN
     C**********           Z-ADD*ZERO     QMTRNB                                              CLE148
     C                     MOVEL*BLANK    QMTRNB                                              CLE148
     C**
     C                     CALL 'PMC1001'
     C                     PARM           WWLDA
     C**
     C                     END
     C**                                                                  S71062
     C** ACTION 'O'                                                       S71062
     C**                                                                  S71062
     C           WWACTN    IFEQ 'O'                        *B1            S71062
     C**                                                                  S71062
     C** UPDATE *LDA                                                      S71062
     C**                                                                  S71062
     C                     CALL 'PMC1001'                                 S71062
     C                     PARM           WWLDA                           S71062
     C**                                                                  S71062
     C                     CALL 'PM6180'                                  S71062
     C                     PARM           DDTRNH                          S71062
     C**                                                                  S71062
     C** RESET FIELDS                                                     S71062
     C**                                                                  S71062
     C                     MOVEL*BLANKS   QMINNR                          S71062
     C                     MOVEL*BLANKS   QMMODI                          S71062
     C                     MOVEL*BLANKS   QMSESN                          S71062
     C**********           Z-ADD*ZERO     QMTRNB                                       S71062 CLE148
     C                     MOVEL*BLANK    QMTRNB                                              CLE148
     C**                                                                  S71062
     C                     CALL 'PMC1001'                                 S71062
     C                     PARM           WWLDA                           S71062
     C**                                                                  S71062
     C                     END                             *E1            S71062
     C**                                                                  CPM005
     C           S01496    IFEQ 'Y'                                       CPM005
     C**                                                                  S01496
     C***ACTION*'B'                                                       S01496
     C** ACTION 'D'                                                       S01496
     C**                                                                  S01496
     C********** WWACTN    IFEQ 'B'                                       S01496
     C           WWACTN    IFEQ 'D'                                       S01496
     C**                                                                  S01496
     C                     MOVELDDMODH    QMMODI                          S01496
     C           DDMODH    IFEQ 'SE'                                      S01496
     C                     MOVELDDSHOR    QMSESN                          S01496
     C**********           Z-ADD*ZERO     QMTRNB                                       S01496 CLE148
     C                     MOVEL*BLANK    QMTRNB                                              CLE148
     C                     ELSE                                           S01496
     C                     MOVEL*BLANKS   QMSESN                          S01496
     C                     MOVELDDTRNH    QMTRNB                          S01496
     C                     END                                            S01496
     C**                                                                  S01496
     C** UPDATE *GDA                                                      S01496
     C**                                                                  S01496
     C                     CALL 'PMC1001'                                 S01496
     C                     PARM           WWLDA                           S01496
     C**                                                                  S01496
     C** READ CLIENT FILE TO OBTAIN BRANCH CODE                           S01496
     C**                                                                  S01496
     C                     MOVELQFCNUM    PLCUS  10                       S01496
     C                     CALL 'AOCUSTR0'                                S01496
     C                     PARM '*DBERR'  @RTCD                           S01496
     C                     PARM '*KEY'    @OPTN                           S01496
     C                     PARM           PLCUS                           S01496
     C                     PARM           KEYST   7                       S01496
     C           SDCUST    PARM SDCUST    DSSDY                           081790
     C**                                                                  S01496
     C** CALL SE6542 TO DISPLAY BLOCKED POSITIONS                         S01496
     C**                                                                  S01496
     C******************** MOVE BRCD      KBRCD   3                       S01496
     C                     MOVE BBBRCD    KBRCD   3                       S01496
     C                     MOVE DDCNUM    KCNUM   6                       S01496
     C                     MOVE DDPTFR    KPTFR   4                       S01496
     C                     MOVE DDSHOR    KSESN  10                       S01496
     C                     Z-ADDQMRDNB    KRUNA   50                      S01496
     C**                                                                  S01496
     C                     CALL 'SE6542'                                  S01496
     C                     PARM           KBRCD                           S01496
     C                     PARM           KCNUM                           S01496
     C                     PARM           KPTFR                           S01496
     C                     PARM           KSESN                           S01496
     C                     PARM           KRUNA                           S01496
     C                     CALL 'PMC1003'                                 081239
     C                     PARM           WWLDA                           081239
     C**                                                                  S01496
     C** RESET FIELDS                                                     S01496
     C**                                                                  S01496
     C                     MOVEL*BLANKS   QMMODI                          S01496
     C                     MOVEL*BLANKS   QMSESN                          S01496
     C***********          Z-ADD*ZERO     QMTRNB                                       S01496 CLE148
     C                     MOVEL*BLANK    QMTRNB                                              CLE148
     C**                                                                  S01496
     C                     CALL 'PMC1001'                                 S01496
     C                     PARM           WWLDA                           S01496
     C**                                                                  S01496
     C                     END                                            S01496
     C                     END                                            CPM005
     C**
     C** ACTION 'D'
     C**
     C********** WWACTN    IFEQ 'D'                                       S01486
     C           WWACTN    IFEQ 'V'                                       S01486
     C**
     C           DDMODH    IFEQ 'SE'
     C***********          MOVELDDSECU    QMSESN                          CPM005
     C                     MOVELDDAMEU    QMSESN                          CPM005
     C***********          Z-ADD*ZERO     QMTRNB                                              CLE148
     C                     MOVEL*BLANK    QMTRNB                                              CLE148
     C                     ELSE
     C                     MOVEL*BLANKS   QMSESN
     C                     MOVELDDSECU    QMTRNB
     C                     END
     C**
     C***UPDATE *GDA                                                      S01486
     C** UPDATE *LDA                                                      S01486
     C**
     C                     CALL 'PMC1001'
     C                     PARM           WWLDA
     C**
     C                     EXSR #P1008
     C**
     C                     END
     C**
     C** ACTION 'T'
     C**
     C           WWACTN    IFEQ 'T'
     C**
     C                     EXSR #P1009
     C**
     C                     END
     C**
     C**
     C** ACTION 'P'
     C**
     C           WWACTN    IFEQ 'P'
     C**
     C**
     C                     EXSR #P1010
     C**
     C                     END
     C**
     C                     END
     C**
     C                     END
     C**
     C                     END
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF F3 TAKEN
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C           *INKC     IFEQ '1'
     C**
     C***SET*ENQUIRIES*TERMINATING*FIELD*IN *GDA*TO*'Y'                   S01486
     C** SET ENQUIRIES TERMINATING FIELD IN *LDA TO 'Y'                   S01486
     C**
     C                     MOVEL'Y'       QMENQT
     C**
     C***UPDATE *GDA                                                      S01486
     C** UPDATE *LDA                                                      S01486
     C**
     C**********           CALL 'PMC1002'                                 S01486
     C**********           PARM           WWGDA                           S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C                     MOVEL'Y'       WWFLAG
     C**
     C                     END
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C** IF F12 TAKEN - RETURN TO CALLING PROGRAM
     C** ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     C           *INKL     IFEQ '1'
     C**
     C                     MOVEL'Y'       WWFLAG
     C**
     C                     END
     C**
     C***ENQUIRE*DATA*AREA *GDA                                           S01486
     C** ENQUIRE DATA AREA *LDA                                           S01486
     C**
     C**********           CALL 'PMC1004'                                 S01486
     C**********           PARM           WWGDA                           S01486
     C                     CALL 'PMC1003'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C           QMENQT    IFEQ 'Y'
     C           QMENQT    OREQ 'P'                                       S01486
     C           QMENQT    OREQ 'C'                                       S01486
     C           QMENQT    OREQ 'D'                                       081239
     C                     MOVEL'Y'       WWFLAG
     C                     END
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1002   - LOAD SUBFILE WITH TRADE DATE HOLDINGS                 *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P1004   - FORMAT 'SE' HOLDINGS FOR OUTPUT TO SUBFILE            *
      * #P1005   - FORMAT 'FF' 'DL' 'LE' AND 'RE' HOLDINGS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #INIT    - INITIAL PROCESSING                                    *
      * #P1001   - PROCESS PM HOLDINGS SCREEN                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWPTFR   - PORTFOLIO REFERENCE                                   *
      *                                                                  *
      ********************************************************************
     C           #P1002    BEGSR
     C**
     C                     Z-ADD0         RRN1    40
     C                     Z-ADD0         RRN2    40
     C                     MOVE '1'       *IN61
     C                     WRITEPM0700C1
     C                     WRITEPM0700C2
     C                     MOVE '0'       *IN61
     C**
     C                     EXSR #BLANK
     C*
     C** IF PAGE BACKWARD IS REQUIRED SET ARRAY INDEX TO PREVIOUS PAGE
     C** HEADING. PROCESSING NOT REQUIRED FOR F13 AS NEXT PAGE DETERMINED
     C** AFTER F13 TAKEN
     C           WWMAFF    IFNE 'M'                                       B08253
     C           WWF13     IFNE 'Y'                        B1
     C           *IN24     IFEQ '1'                        B2
     C           A         ANDGT1
     C           A         SUB  1         A       50
     C**********           MOVE '0'       *IN24                      59481CPM005
     C                     END                             E2
     C*
     C** SET UP WORKFIELD CONTAINING NUMBER OF PAGES OF INFORMATION
     C           WWMAFF    IFEQ 'D'                        B2
     C                     Z-ADDWWTDLV    WWNOPG  50
     C                     ELSE                            X2
     C                     Z-ADDWWTDFL    WWNOPG
     C                     END                             E2
     C*
     C** IF PAGE FORWARD IS REQUIRED SET ARRAY INDEX TO NEXT PAGE
     C** HEADING
     C           *IN23     IFEQ '1'                        B2
     C           A         ANDLTWWNOPG
     C           A         ADD  1         A
     C                     END                             E2
     C*
     C** IF DETAILS RECEIVED FROM WINDOW PROGRAM PM0660 PERFORM LOKUP
     C** TO DETERMINE WHICH PAGE OF DETAILS ARE TO BE DISPLAYED
     C           WWPAG1    IFNE *BLANKS                    B2
     C                     Z-ADD1         A
     C*
     C           WWMAFF    IFEQ 'D'                        B3
     C           WWPAG1    LOKUPTDD,A                72
     C*                                                                   S01313
     C***********          MOVELWWPAG1    WWPAGX 52                 S01313CPM005
     C***********          MOVELTDD,A     WWPAGY 52                 S01313CPM005
     C**********           MOVELWWPAG1    WWPAGX 57                                    CPM005 CGL029
     C**********           MOVELTDD,A     WWPAGY 57                                    CPM005 CGL029
     C                     MOVELWWPAG1    WWPAGX 63                                           CGL029
     C                     MOVELTDD,A     WWPAGY 63                                           CGL029
     C           WWPAGX    IFEQ WWPAGY                     B4             S01313
     C                     ADD  1         A                               S01313
     C                     END                             E4             S01313
     C                     ELSE                            X3
     C                     Z-ADD2         A                               B08040
     C                     MOVE '1'       *IN72                           B08040
     C*****      WWPAG1    LOKUPTDM,A                72                   B08040
     C                     END                             E3
     C** IF ROLL DOWN KEY USED, VALUE OF A ALREADY CACULATED.             040639
     C*                                                                   040639
     C********** *IN24     IFEQ '1'                                 040639CPM005
     C           *IN24     IFEQ '0'                                       CPM005
     C*
     C           *IN72     IFEQ '1'                        B3
     C           A         IFNE 0                                         R10017
     C           A         SUB  1         A
     C                     END                                            R10017
     C                     ELSE                            X3
     C*
     C***********          MOVE *BLANKS   WWPAG2 53                       CPM005
     C**********           MOVE *BLANKS   WWPAG2 58                                    CPM005 CGL029
     C                     MOVE *BLANKS   WWPAG2 64                                           CGL029
     C           WWMAFF    IFEQ 'D'                        B4
     C           WWPAG2    LOKUPTDD,A                    72
     C****                 ELSE                            X4             B08253
     C****       WWPAG2    LOKUPTDM,A                    72               B08253
     C                     END                             E4
     C           A         SUB  1         A
     C                     END                             E3
     C                     END                                            040639
     C*
     C                     MOVE *BLANKS   WWPAG1
     C**********                                                    059481CPM005
     C***...OTHERWISE SET TO NUMBER OF LIVE PAGES OR 1 AS APPROPRIAT059481CPM005
     C**********           ELSE                            X2       059481CPM005
     C********** WWTDLV    IFEQ 0                          B3       059481CPM005
     C**********           Z-ADD0         A                         059481CPM005
     C**********           END                             E3       059481CPM005
     C                     END                             E2
     C                     END                             E1
     C                     END                                            B08253
     C*
     C** MOVE PAGE HEADING FROM MATURE / LIVE ARRAY AS APPROPRIATE
     C** INTO DATA STRUCTURE USED TO ACCESS PMHOLDL1
     C           A         IFNE 0                          B1
     C           WWMAFF    OREQ 'M'                                       B08253
     C*
     C           WWMAFF    IFEQ 'D'                        B2
     C                     MOVE TDD,A     WWPAGE
     C****                 ELSE                                           B08253
     C****                 MOVE TDM,A     WWPAGE                          B08253
     C****                 END                                            B08253
     C*
     C** SAVE DISPLAY GROUP AND INSTRUMENT AT TOP OF PAGE
     C****                 MOVELQFDSPG    WWDSPO                          59481
     C****                 MOVELQFINNR    WWINNO                          59481
     C                     MOVELQFDSPG    WWDSPO                          CPM005
     C                     MOVELQFINNR    WWINNO                          CPM005
     C                     MOVE QMCNUM    QFCNUM
     C                     MOVE QMPTF1    QFPTFR
     C                     MOVE QMPOTY    QFPOST                          CPM005
     C*
     C** USE PAGE HEADING FROM ARRAY TO SET FILE POINTER FOR FIRST RECORD
     C** TO BE READ
     C           QFMODI    IFNE 'RE'                                      R10016
     C                     MOVE *BLANKS   QFTXT2                          R10016
     C                     END                                            R10016
     C*                                                                   R10016
     C****       PMHOLD    SETLLPMHOLDL1                                  B08253
     C****                 READ PMHOLDL1                 72               B08253
     C******     PMHOLD    SETLLPMHOLDL4                            B08253CPM005
     C*******              READ PMHOLDL4                 72         B08253CPM005
     C           PMHOLA    SETLLPMHOLDLA                                  CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDEQ*BLANKS                                   CPM005
     C           *IN72     OREQ '0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDNE*BLANKS                                   CPM005
     C           QFBYSF    ANDEQ'S'                                       CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C                     END                                            CPM005
     C*                                                                   B08253
      * Reaccess PMHOLDPD to position on the correct record.              160217
     C                     MOVEAHOAR,A    XRRN                            160217
     C           XRRN      IFNE 0                                         160217
     C           XRRN      DOUEQ0                                         160217
     C           *IN72     DOWEQ'0'                                       160217
     C           QFNOPO    ANDEQ'Y'                                       160217
     C           QFMODI    ANDEQ'FX'                                      160217
     C           QFTDSS    ANDEQ*BLANKS                                   160217
     C           *IN72     OREQ '0'                                       160217
     C           QFNOPO    ANDEQ'Y'                                       160217
     C           QFMODI    ANDEQ'FX'                                      160217
     C           QFTDSS    ANDNE*BLANKS                                   160217
     C           QFBYSF    ANDEQ'S'                                       160217
     C                     READ PMHOLDLA                 72               160217
     C                     END                                            160217
     C                     READ PMHOLDLA                 72               160217
     C                     SUB  1         XRRN                            160217
     C                     END                                            160217
     C                     END                                            160217
      *                                                                   160217
     C** SET FILE POINTER FOR FLAT / MATURED POSITIONS                    B08253
     C                     ELSE                              X2           B08253
     C*                                                                   B08253
     C** IF THIS IS THE FIRST TIME FLAT/MATURED POSITIONS DISPLAYED SET   B08253
     C** FILE POINTER BEFORE FIRST RECORD                                 B08253
     C           WWF13     IFEQ 'Y'                        B3             B08253
     C                     MOVE WWFSTR    W2SCRN                          B08253
     C                     EXSR #FILE                                     B08253
     C********** PMHOLD    SETLLPMMFHLPP                           B08253 S01486
     C**********           READ PMMFHLPP                 72        B08253 S01486
     C           PMHOLD    SETLLPMMFHLPD                                  S01486
     C                     READ PMMFHLPD                 72               S01486
     C                     EXSR #SCRN                                     B08253
     C                     MOVE W2SCRN    WWTSCR 62                       B08253
     C****                 MOVE QFINNR    WWINNO                    B0825359481
     C****                 MOVE QFDSPG    WWDSPO                    B0825359481
     C                     END                             E3             B08253
     C*                                                                   B08253
     C** IF A ROLLUP HAS BEEN REQUESTED SET FILE POINTER AFTER LAST       B08253
     C** RECORD ON PREVIOUS SCREEN                                        B08253
     C           *IN23     IFEQ '1'                        B3             B08253
     C                     MOVE WWBSCR    W2SCRN                          B08253
     C                     EXSR #FILE                                     B08253
     C********** PMHOLD    SETGTPMMFHLPP                           B08253 S01486
     C**********           READ PMMFHLPP                 72        B08253 S01486
     C           PMHOLD    SETGTPMMFHLPD                                  S01486
     C                     READ PMMFHLPD                 72               S01486
     C                     EXSR #SCRN                                     B08253
     C                     MOVE W2SCRN    WWTSCR 62                       B08253
     C****                 MOVE QFINNR    WWINNO                    B0825359481
     C****                 MOVE QFDSPG    WWDSPO                    B0825359481
     C                     END                             E3             B08253
     C*                                                                   B08253
     C** IF A ROLLDOWN HAS BEEN REQUESTED SET FILE POINTER BEFORE FIRST   B08253
     C** RECORD ON PREVIOUS SCREEN                                        B08253
     C           *IN24     IFEQ '1'                        B3             B08253
     C                     MOVE WWTSCR    W2SCRN                          B08253
     C                     EXSR #FILE                                     B08253
     C********** PMHOLD    SETLLPMMFHLPP                           B08253 S01486
     C**********           READPPMMFHLPP                 72        B08253 S01486
     C           PMHOLD    SETLLPMMFHLPD                                  S01486
     C                     READPPMMFHLPD                 72               S01486
     C                     EXSR #SCRN                                     B08253
     C                     MOVE W2SCRN    WWBSCR 62                       B08253
     C****                 MOVE QFINNR    WWINNO                    B0825359481
     C****                 MOVE QFDSPG    WWDSPO                    B0825359481
     C                     END                             E3             B08253
     C                     END                             E2             B08253
     C**
     C** SET K EQUAL TO ZERO
     C**
     C                     Z-ADD0         K
     C**                                                                  CPM005
     C           WWMAFF    IFEQ 'D'                        B0             CPM005
     C**                                                                  CPM005
     C           PPTOTT    IFEQ 'B'                                       CPM005
     C**
     C           *IN72     DOWEQ'0'                        B1
     C********** K         ANDLT7                                         080700
     C           K         ANDLT6                                         080700
     C           QFCNUM    ANDEQWWCNUM
     C           QFPTFR    ANDEQWWPTFR
     C           QFPOST    ANDEQQMPOTY                                    CPM005
     C****       QFDSPG    ANDEQWWDSPO                                    59481
     C****       QFINNR    ANDEQWWINNO                                    59481
     C****       QFDSPG    ANDEQQMDSPG                              59481 CPM005
     C****       QFINNR    ANDEQQMINNR                              59481 CPM005
     C*                                                                   CPM005
     C                     EXSR #P1016                                    CPM005
     C*                                                                   B08253
     C***SAVE*DETAILS OF FIRST AND LAST RECORD ON SCREEN            B08253CPM005
     C***********          EXSR #SCRN                               B08253CPM005
     C***********WWF13     IFEQ 'Y'                                 B08253CPM005
     C************IN23     OREQ '1'                                 B08253CPM005
     C***********          MOVE W2SCRN    WWBSCR 62                 B08253CPM005
     C***********          ELSE                                     B08253CPM005
     C***********          MOVE W2SCRN    WWTSCR 62                 B08253CPM005
     C***********          END                                      B08253CPM005
     C***********                                                         CPM005
     C***********QFRECI    IFEQ 'D'                        B2             CPM005
     C***********WWMAFF    ANDEQ'D'                                 B08040CPM005
     C***********QFRECI    ORNE 'D'                                       CPM005
     C***********WWMAFF    ANDEQ'M'                                       CPM005
     C***********                                                         CPM005
     C***IF*MODULE ID IS 'SE'                                             CPM005
     C***********                                                         CPM005
     C***********QFMODI    IFEQ 'SE'                       B3             CPM005
     C***********          EXSR #P1004                                    CPM005
     C***********                                                   S01496CPM005
     C***********S01496    IFEQ 'Y'                                 S01496CPM005
     C***READ*CLIENT FILE TO OBTAIN BRANCH CODE                     S01496CPM005
     C***********                                                   S01496CPM005
     C***********          MOVELQFCNUM    PLCUS  10                 S01496CPM005
     C***********          CALL 'AOCUSTR0'                          S01496CPM005
     C***********          PARM '*DBERR'  @RTCD                     S01496CPM005
     C***********          PARM '*KEY'    @OPTN                     S01496CPM005
     C***********          PARM           PLCUS                     S01496CPM005
     C***********          PARM           KEYST   7                 S01496CPM005
     C***********SDCUST    PARM SDCUST    DSSDY                     081790CPM005
     C***********                                                   S01496CPM005
     C***********          EXSR P002                                S01496CPM005
     C***********          END                                      S01496CPM005
     C***********          END                             E3             CPM005
     C***********                                                         CPM005
     C***IF*MODULE ID IS NOT 'SE'                                         CPM005
     C***********                                                         CPM005
     C***********QFMODI    IFNE 'SE'                       B3             CPM005
     C***********          EXSR #P1005                                    CPM005
     C***********          END                             E3             CPM005
     C***********                                                         CPM005
     C***********          ADD  1         K                               CPM005
     C***********                                                         CPM005
     C***WRITE*A RECORD TO THE SUBFILE                                    CPM005
     C***********                                                         CPM005
     C***********          ADD  1         RRN1                            CPM005
     C***********          ADD  1         RRN2                            CPM005
     C***********                                                   B08253CPM005
     C***FOR*ROLL BACKWARDS ON MATURED POSITIONS WRITE SCREEN RECOR B08253CPM005
     C***OUT*IN*REVERSE SEQUENCE                                    B08253CPM005
     C***********WWMAFF    IFEQ 'M'                        B4       B08253CPM005
     C************IN24     ANDEQ'1'                                 B08253CPM005
     C***********          Z-ADDRRN1      W1RRN1  50                B08253CPM005
     C***********          Z-ADDRRN2      W1RRN2  50                B08253CPM005
     C********** 8         SUB  RRN1      RRN1                     B08253 080700
     C********** 8         SUB  RRN2      RRN2                     B08253 080700
     C***********7         SUB  RRN1      RRN1                      080700CPM005
     C***********7         SUB  RRN2      RRN2                      080700CPM005
     C***********          END                             E4       B08253CPM005
     C***********                                                         CPM005
     C***********          WRITEPM0700S1                                  CPM005
     C***********          WRITEPM0700S2                                  CPM005
     C***********                                                   B08253CPM005
     C***RESTORE*SAVED VALUE OF RRN1 AND RRN2                       B08253CPM005
     C***********WWMAFF    IFEQ 'M'                        B4       B08253CPM005
     C************IN24     ANDEQ'1'                                 B08253CPM005
     C***********          Z-ADDW1RRN1    RRN1                      B08253CPM005
     C***********          Z-ADDW1RRN2    RRN2                      B08253CPM005
     C***********          END                             E4             CPM005
     C***********                                                   B08253CPM005
     C*********  K         CABEQ7         #P1029                          080700
     C***********K         CABEQ6         #P1029                    080700CPM005
     C***********          END                             E2             CPM005
     C***********                                                         CPM005
     C***READ*NEXT HOLDING RECORD                                         CPM005
     C****                 READ PMHOLDL1                 72               B08253
     C***********WWMAFF    IFEQ 'D'                        B2       B08253CPM005
     C***********          READ PMHOLDL4                 72         B08253CPM005
     C***********          ELSE                            X2       B08253CPM005
     C***********                                                         CPM005
     C************IN24     IFEQ '1'                        B3       B08253CPM005
     C**********           READPPMMFHLPP                 72         B08253S01486
     C***********          READPPMMFHLPD                 72         S01486CPM005
     C***********          ELSE                            X3       B08253CPM005
     C**********           READ PMMFHLPP                 72         B08253S01486
     C***********          READ PMMFHLPD                 72         S01486CPM005
     C***********          END                             E3       B08253CPM005
     C*
     C***********          END                             E2       B08253CPM005
     C                     END                             E1
     C                     END                                            CPM005
     C**                                                                  CPM005
     C           PPTOTT    IFEQ 'D'                                       CPM005
     C**                                                                  CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           K         ANDLT6                                         CPM005
     C           QFCNUM    ANDEQWWCNUM                                    CPM005
     C           QFPTFR    ANDEQWWPTFR                                    CPM005
     C           QFPOST    ANDEQQMPOTY                                    CPM005
     C           QFDSPG    ANDEQQMDSPG                                    CPM005
     C*                                                                   CPM005
     C                     EXSR #P1016                                    CPM005
     C                     END                                            CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C           PPTOTT    IFEQ 'I'                                       CPM005
     C**                                                                  CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           K         ANDLT6                                         CPM005
     C           QFCNUM    ANDEQWWCNUM                                    CPM005
     C           QFPTFR    ANDEQWWPTFR                                    CPM005
     C           QFPOST    ANDEQQMPOTY                                    CPM005
     C           QFDSPG    ANDEQQMDSPG                                    CPM005
     C           QFINNR    ANDEQQMINNR                                    CPM005
     C*                                                                   CPM005
     C                     EXSR #P1016                                    CPM005
     C                     END                                            CPM005
     C                     END                                            CPM005
     C                     ELSE                            X1             CPM005
     C**                                                                  CPM005
     C           *IN72     DOWEQ'0'                        B2             CPM005
     C           K         ANDLT6                                         CPM005
     C           QFCNUM    ANDEQWWCNUM                                    CPM005
     C           QFPTFR    ANDEQWWPTFR                                    CPM005
     C*                                                                   CPM005
     C** SAVE DETAILS OF FIRST AND LAST RECORD ON SCREEN                  CPM005
     C                     EXSR #SCRN                                     CPM005
     C           WWF13     IFEQ 'Y'                        B3             CPM005
     C           *IN23     OREQ '1'                                       CPM005
     C                     MOVE W2SCRN    WWBSCR 62                       CPM005
     C                     ELSE                            X3             CPM005
     C                     MOVE W2SCRN    WWTSCR 62                       CPM005
     C                     END                             E3             CPM005
     C**                                                                  CPM005
     C** IF MODULE ID IS 'SE'                                             CPM005
     C**                                                                  CPM005
     C           QFMODI    IFEQ 'SE'                       B3             CPM005
     C                     EXSR #P1004                                    CPM005
     C**                                                                  CPM005
     C           S01496    IFEQ 'Y'                                       CPM005
     C** READ CLIENT FILE TO OBTAIN BRANCH CODE                           CPM005
     C**                                                                  CPM005
     C                     MOVELQFCNUM    PLCUS  10                       CPM005
     C                     CALL 'AOCUSTR0'                                CPM005
     C                     PARM '*DBERR'  @RTCD                           CPM005
     C                     PARM '*KEY'    @OPTN                           CPM005
     C                     PARM           PLCUS                           CPM005
     C                     PARM           KEYST   7                       CPM005
     C           SDCUST    PARM SDCUST    DSSDY                           CPM005
     C**                                                                  CPM005
     C                     EXSR P002                                      CPM005
     C**                                                                  CPM005
     C                     END                                            CPM005
     C                     END                             E3             CPM005
     C**                                                                  CPM005
     C** IF MODULE ID IS NOT 'SE'                                         CPM005
     C**                                                                  CPM005
     C           QFMODI    IFNE 'SE'                       B3             CPM005
     C                     EXSR #P1005                                    CPM005
     C                     END                             E3             CPM005
     C**                                                                  CPM005
     C                     ADD  1         K                               CPM005
     C**                                                                  CPM005
     C** WRITE A RECORD TO THE SUBFILE                                    CPM005
     C**                                                                  CPM005
     C                     ADD  1         RRN1                            CPM005
     C                     ADD  1         RRN2                            CPM005
     C*                                                                   CPM005
     C** FOR ROLL BACKWARDS ON MATURED POSITIONS WRITE SCREEN RECORDS     CPM005
     C** OUT IN REVERSE SEQUENCE                                          CPM005
     C           WWMAFF    IFEQ 'M'                        B3             CPM005
     C           *IN24     ANDEQ'1'                                       CPM005
     C                     Z-ADDRRN1      W1RRN1  50                      CPM005
     C                     Z-ADDRRN2      W1RRN2  50                      CPM005
     C           7         SUB  RRN1      RRN1                            CPM005
     C           7         SUB  RRN2      RRN2                            CPM005
     C                     END                             E3             CPM005
     C**                                                                  CPM005
     C                     WRITEPM0700S1                                  CPM005
     C                     WRITEPM0700S2                                  CPM005
     C*                                                                   CPM005
     C** RESTORE SAVED VALUE OF RRN1 AND RRN2                             CPM005
     C           WWMAFF    IFEQ 'M'                        B3             CPM005
     C           *IN24     ANDEQ'1'                                       CPM005
     C                     Z-ADDW1RRN1    RRN1                            CPM005
     C                     Z-ADDW1RRN2    RRN2                            CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C           K         CABEQ6         #P1029                          CPM005
     C*                                                                   CPM005
     C** READ NEXT HOLDING RECORD                                         CPM005
     C*                                                                   CPM005
     C           *IN24     IFEQ '1'                        B3             CPM005
     C                     READPPMMFHLPD                 72               CPM005
     C                     ELSE                            X3             CPM005
     C                     READ PMMFHLPD                 72               CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*
     C** IF NO LIVE RECORDS TO BE DISPLAYED OUTPUT BLANKS TO SUBFILE
     C                     ELSE
     C                     ADD  1         RRN1
     C                     ADD  1         RRN2
     C                     MOVE '1'       *IN59
     C                     MOVE '0'       *IN52
     C                     MOVE *BLANKS   DDNOM1
     C                     MOVEL*BLANKS   DDFIL1                          CPM005
     C                     MOVE *BLANKS   DDCCY1                          R10052
     C                     MOVE *BLANKS   DDNARR
     C                     MOVE *BLANKS   DDNAR2                          S71062
     C                     MOVE *BLANKS   DDMKTP
     C                     MOVE *BLANKS   DDMFXR
     C                     MOVE *BLANKS   DDMVPC
     C                     MOVE *BLANKS   DDNOM2
     C                     MOVEL*BLANKS   DDFIL2                          CPM005
     C                     MOVE *BLANKS   DDCCY2                          R10052
     C                     MOVE *BLANKS   DDTOG4                          S01496
     C                     MOVE *BLANKS   DDDETA
     C                     MOVE *BLANKS   DDDET2                          S71062
     C                     MOVE *BLANKS   DDFOPR
     C                     MOVE *BLANKS   DDFFXR
     C                     MOVE *BLANKS   DDAIPC
     C                     MOVE *BLANKS   DDNARR
     C                     MOVE *BLANKS   DDSECU
     C                     MOVE *BLANKS   DDAMEU                          S71062
     C                     MOVE *BLANKS   DDMVIC
     C                     MOVE *BLANKS   DDMKTY
     C                     MOVE *BLANKS   DDMTPL
     C                     MOVE *BLANKS   DDDETA
     C                     MOVE *BLANKS   DDAIIC
     C                     MOVE *BLANKS   DDFOLY
     C                     MOVE *BLANKS   DDEXPL
     C                     MOVE *BLANKS   DDTOG1                          CPM005
     C                     MOVE *BLANKS   DDTOG2                          CPM005
     C******************   MOVEL*BLANKS   DDXCCY                    R05586R00631
     C                     WRITEPM0700S1
     C                     WRITEPM0700S2
     C                     MOVE '0'       *IN59
     C                     MOVE '0'       *IN52
     C                     MOVE '0'       *IN53                           B08040
     C                     END                             E1
     C**
     C           #P1029    ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************CPM005
      ************                                                       *CPM005
      **#P1003***- LOAD SUBFILE WITH VALUE DATE HOLDINGS                 *CPM005
      ************                                                       *CPM005
      **SUBROUTINE CALLS:                                                *CPM005
      **#P1004***- FORMAT 'SE' HOLDINGS FOR OUTPUT TO SUBFILE            *CPM005
      **#P1005***- FORMAT 'FF' 'DL' 'LE' AND 'RE' HOLDINGS               *CPM005
      ************                                                       *CPM005
      **SUBROUTINE CALLED FROM:                                          *CPM005
      **#INIT****- INITIAL PROCESSING                                    *CPM005
      **#P1001***- PROCESS PM HOLDINGS SCREEN                            *CPM005
      ************                                                       *CPM005
      **ROUTINE*USES VARIABLES:                                          *CPM005
      **WWPTFR***- PORTFOLIO REFERENCE                                   *CPM005
      ************                                                       *CPM005
      ********************************************************************CPM005
     C***********#P1003    BEGSR                                          CPM005
     C***********                                                         CPM005
     C***********          Z-ADD0         RRN1                            CPM005
     C***********          Z-ADD0         RRN2                            CPM005
     C***********          MOVE '1'       *IN61                           CPM005
     C***********          WRITEPM0700C1                                  CPM005
     C***********          WRITEPM0700C2                                  CPM005
     C***********          MOVE '0'       *IN61                           CPM005
     C***********                                                         CPM005
     C***********          EXSR #BLANK                                    CPM005
     C***********                                                         CPM005
     C***IF*PAGE*BACKWARD IS REQUIRED SET ARRAY INDEX TO PREVIOUS PAGE    CPM005
     C***HEADING. NOT REQUIRED FO F13                                     CPM005
     C***********WWMAFF    IFNE 'M'                                 B08253CPM005
     C***********WWF13     IFNE 'Y'                        B1             CPM005
     C************IN24     IFEQ '1'                        B1             CPM005
     C***********A         ANDGT1                                         CPM005
     C***********A         SUB  1         A                               CPM005
     C***********          MOVE '0'       *IN24                      59481CPM005
     C***********          END                                            CPM005
     C***********                                                         CPM005
     C***SET*UP*WORKFIELD CONTAINING NUMBER OF PAGES OF INFORMATION       CPM005
     C***********WWMAFF    IFEQ 'D'                        B1             CPM005
     C***********          Z-ADDWWVLLV    WWNOPG  50                      CPM005
     C***********          ELSE                            X1             CPM005
     C***********          Z-ADDWWVLFL    WWNOPG                          CPM005
     C***********          END                             E1             CPM005
     C***********                                                         CPM005
     C***IF*PAGE*FORWARD IS REQUIRED SET ARRAY INDEX TO NEXT PAGE         CPM005
     C***HEADING                                                          CPM005
     C************IN23     IFEQ '1'                        B3        59481CPM005
     C****       A         ANDLTWWNOPG                                    59481
     C***********A         IFLT WWNOPG                     B4        59481CPM005
     C***********A         ADD  1         A                               CPM005
     C***********          ELSE                            X4        59481CPM005
     C***********WWFORC    IFNE 'Y'                        B5        59481CPM005
     C***********          MOVE '1'       *IN68                      59481CPM005
     C***********          END                             E5        59481CPM005
     C***********          MOVE 'N'       WWFORC  1                  59481CPM005
     C***********          END                             E4        59481CPM005
     C***********          END                             E1             CPM005
     C***********                                                         CPM005
     C***IF*DETAILS RECEIVED FROM WINDOW PROGRAM PM0660 PERFORM LOKUP     CPM005
     C***TO*DETERMINE WHICH PAGE OF DETAILS ARE TO BE DISPLAYED           CPM005
     C***********WWPAG1    IFNE *BLANKS                                   CPM005
     C***********          Z-ADD1         A                               CPM005
     C***********                                                         CPM005
     C***********WWMAFF    IFEQ 'D'                                       CPM005
     C***********WWPAG1    LOKUPVDD,A                72                   CPM005
     C***********                                                   S01313CPM005
     C***********          MOVELWWPAG1    WWPAGX 52                 S01313CPM005
     C***********          MOVELVDD,A     WWPAGY 52                 S01313CPM005
     C***********WWPAGX    IFEQ WWPAGY                     B4       S01313CPM005
     C***********          ADD  1         A                         S01313CPM005
     C***********          END                             E4       S01313CPM005
     C****                 ELSE                            X4             B08253
     C****       WWPAG2    LOKUPVDM,A                    72               B08253
     C***********          END                             E4             CPM005
     C***********A         SUB  1         A                               CPM005
     C***********          END                                            CPM005
     C***********                                                         CPM005
     C***IF*ROLL*DOWN KEY USED, VALUE OF A ALREADY CACULATED.       040639CPM005
     C***********                                                   040639CPM005
     C************IN24     IFEQ '1'                        B3       040639CPM005
     C************IN72     IFEQ '1'                                       CPM005
     C***********A         IFNE 0                                   R10017CPM005
     C***********A         SUB  1         A                               CPM005
     C***********          END                                      R10017CPM005
     C***********          ELSE                                           CPM005
     C***********                                                         CPM005
     C***********          MOVE *BLANKS   WWPAG2                          CPM005
     C***********WWMAFF    IFEQ 'D'                                       CPM005
     C***********A         IFEQ 0                                   36727 CPM005
     C***********          Z-ADD1         A                         36727 CPM005
     C***********          END                                      36727 CPM005
     C***********WWPAG2    LOKUPVDD,A                    72               CPM005
     C****                 ELSE                                           B08253
     C****                 MOVE VDM,A     WWPAGE                          B08253
     C***********          END                                            CPM005
     C***********A         SUB  1         A                               CPM005
     C***********          END                                            CPM005
     C***********          END                             E3       040639CPM005
     C***********                                                         CPM005
     C***********          MOVE *BLANKS   WWPAG1                          CPM005
     C***********                                                    59481CPM005
     C***...OTHERWISE SET TO NUMBER OF LIVE PAGES OR 1 AS APPROPRIAT 59481CPM005
     C***********          ELSE                            X2        59481CPM005
     C***********WWVLLV    IFEQ 0                          B3        59481CPM005
     C***********          Z-ADD0         A                          59481CPM005
     C***********          END                             E3        59481CPM005
     C***********          END                                            CPM005
     C***********          END                                            CPM005
     C***********                                                         CPM005
     C***MOVE*PAGE HEADING FROM MATURE / LIVE ARRAY AS APPROPRIATE        CPM005
     C***INTO*DATA STRUCTURE USED TO ACCESS PMHOLDL1                      CPM005
     C***********A         IFEQ 0                                    36854CPM005
     C***********WWF13     ANDEQ'Y'                                  59481CPM005
     C***********WWMAFF    ANDNE'D'                                  59481CPM005
     C***********          Z-ADD1         A                          36854CPM005
     C***********          END                                       36854CPM005
     C***********A         IFNE 0                          B1             CPM005
     C***********WWMAFF    OREQ 'M'                                  B0825CPM005
     C***********WWMAFF    IFEQ 'D'                                       CPM005
     C***********          MOVE VDD,A     WWPAGE                          CPM005
     C****                 ELSE                                           B08253
     C****                 MOVE VDM,A     WWPAGE                          B08253
     C****                 END                                            B08253
     C***********                                                         CPM005
     C***SAVE*DISPLAY GROUP AND INSTRUMENT AT TOP OF PAGE                 CPM005
     C****                 MOVELQFDSPG    WWDSPO                          59481
     C****                 MOVELQFINNR    WWINNO                          59481
     C***********          MOVE QMCNUM    QFCNUM                          CPM005
     C***********          MOVE QMPTF1    QFPTFR                          CPM005
     C***********                                                         CPM005
     C***USE*PAGE HEADING FROM ARRAY TO SET FILE POINTER FOR FIRST RECORD CPM005
     C***TO*BE*READ                                                       CPM005
     C****                                                                59481
     C****SE PAGE HEADING FROM ARRAY TO SET FILE POINTER FOR FIRST RECORD 59481
     C****O BE READ                                                       59481
     C****       QFMODI    IFNE 'RE'                       B3             59481
     C****                 MOVE *BLANKS   QFTXT2                          59481
     C****                 END                             E3             59481
     C***********                                                   R10016CPM005
     C****       PMHOLD    SETLLPMHOLDL2                                  B08253
     C****                 READ PMHOLDL2                 72               B08253
     C***********PMHOLD    SETLLPMHOLDL5                            B08253CPM005
     C***********          READ PMHOLDL5                 72         B08253CPM005
     C***********                                                   B08253CPM005
     C***SET*FILE POINTER FOR FLAT / MATURED POSITIONS              B08253CPM005
     C***********          ELSE                              X2     B08253CPM005
     C***********                                                   B08253CPM005
     C***IF*THIS IS THE FIRST TIME FLAT/MATURED POSITIONS DISPLAYED B08253CPM005
     C***FILE*POINTER BEFORE FIRST RECORD                           B08253CPM005
     C***********WWF13     IFEQ 'Y'                        B3       B08253CPM005
     C***********          MOVE WWFSTR    W2SCRN                    B08253CPM005
     C***********          EXSR #FILE                               B08253CPM005
     C********** PMHOLD    SETLLPMMFHLPP                           B08253 S01486
     C**********           READ PMMFHLPP                 72        B08253 S01486
     C***********PMHOLD    SETLLPMMFHLPD                            S01486CPM005
     C***********          READ PMMFHLPD                 72         S01486CPM005
     C***********          EXSR #SCRN                               B08253CPM005
     C***********          MOVE W2SCRN    WWTSCR 62                 B08253CPM005
     C****                 MOVELQFINNR    WWINNO                          59481
     C****                 MOVELQFDSPG    WWDSPO                          59481
     C***********          END                             E3       B08253CPM005
     C***********                                                   B08253CPM005
     C***IF*A*ROLLUP HAS BEEN REQUESTED SET FILE POINTER AFTER LAST B08253CPM005
     C***RECORD*ON PREVIOUS SCREEN                                  B08253CPM005
     C************IN23     IFEQ '1'                        B3       B08253CPM005
     C***********          MOVE WWBSCR    W2SCRN                    B08253CPM005
     C***********          EXSR #FILE                               B08253CPM005
     C********** PMHOLD    SETGTPMMFHLPP                           B08253 S01486
     C**********           READ PMMFHLPP                 72        B08253 S01486
     C***********PMHOLD    SETGTPMMFHLPD                            S01486CPM005
     C***********          READ PMMFHLPD                 72         S01486CPM005
     C***********                                                    59481CPM005
     C************IN72     IFEQ '0'                                  59481CPM005
     C***********QFINNR    ANDEQQMINNR                               59481CPM005
     C***********QFDSPG    ANDEQQMDSPG                               59481CPM005
     C***********          EXSR #SCRN                               B08253CPM005
     C***********          MOVE W2SCRN    WWTSCR 62                 B08253CPM005
     C***********          ELSE                                      59481CPM005
     C***********          MOVE '1'       *IN68                      59481CPM005
     C***********          MOVE WWTSCR    W2SCRN                     59481CPM005
     C***********          EXSR #FILE                                59481CPM005
     C********** PMHOLD    SETLLPMMFHLPP                             59481S01486
     C**********           READ PMMFHLPP                 72          59481S01486
     C***********PMHOLD    SETLLPMMFHLPD                            S01486CPM005
     C***********          READ PMMFHLPD                 72         S01486CPM005
     C***********          END                                       59481CPM005
     C***********                                                    59481CPM005
     C****                 MOVELQFINNR    WWINNO                          59481
     C****                 MOVELQFDSPG    WWDSPO                          59481
     C***********          END                             E3       B08253CPM005
     C***********                                                   B08253CPM005
     C***IF*A*ROLLDOWN HAS BEEN REQUESTED SET FILE POINTER BEFORE FIB08253CPM005
     C***RECORD*ON PREVIOUS SCREEN                                  B08253CPM005
     C************IN24     IFEQ '1'                        B3       B08253CPM005
     C***********          MOVE WWTSCR    W2SCRN                    B08253CPM005
     C***********          EXSR #FILE                               B08253CPM005
     C********** PMHOLD    SETLLPMMFHLPP                           B08253 S01486
     C**********           READPPMMFHLPP                 72        B08253 S01486
     C***********PMHOLD    SETLLPMMFHLPD                            S01486CPM005
     C***********          READPPMMFHLPD                 72         S01486CPM005
     C***********          EXSR #SCRN                               B08253CPM005
     C***********          MOVE W2SCRN    WWBSCR 62                 B08253CPM005
     C****                 MOVELQFINNR    WWINNO                          59481
     C****                 MOVELQFDSPG    WWDSPO                          59481
     C***********          END                             E3       B08253CPM005
     C***********          END                             E2       B08253CPM005
     C***********                                                         CPM005
     C***SET*K*EQUAL TO ZERO                                              CPM005
     C***********                                                         CPM005
     C***********          Z-ADD0         K                               CPM005
     C***********                                                         CPM005
     C************IN72     DOWEQ'0'                        B1             CPM005
     C********** K         ANDLT7                                         080700
     C***********K         ANDLT6                                   080700CPM005
     C***********QFCNUM    ANDEQWWCNUM                                    CPM005
     C***********QFPTFR    ANDEQWWPTFR                                    CPM005
     C****       QFDSPG    ANDEQWWDSPO                                    59481
     C****       QFINNR    ANDEQWWINNO                                    59481
     C***********QFDSPG    ANDEQQMDSPG                               59481CPM005
     C***********QFINNR    ANDEQQMINNR                               59481CPM005
     C***********                                                   B08253CPM005
     C***SAVE*DETAILS OF FIRST AND LAST RECORD ON SCREEN            B08253CPM005
     C***********          EXSR #SCRN                               B08253CPM005
     C***********WWF13     IFEQ 'Y'                                 B08253CPM005
     C************IN23     OREQ '1'                                 B08253CPM005
     C***********          MOVE W2SCRN    WWBSCR 62                 B08253CPM005
     C***********          ELSE                                     B08253CPM005
     C***********          MOVE W2SCRN    WWTSCR 62                 B08253CPM005
     C***********          END                                      B08253CPM005
     C***********                                                         CPM005
     C***********QFRECI    IFEQ 'D'                        B2             CPM005
     C***********WWMAFF    ANDEQ'D'                                 B08040CPM005
     C***********QFRECI    ORNE 'D'                                       CPM005
     C***********WWMAFF    ANDEQ'M'                                       CPM005
     C***********                                                         CPM005
     C***IF*MODULE ID IS 'SE'                                             CPM005
     C***********                                                         CPM005
     C***********QFMODI    IFEQ 'SE'                       B3             CPM005
     C***********          EXSR #P1004                                    CPM005
     C***********          END                             E3             CPM005
     C***********                                                         CPM005
     C***IF*MODULE ID IS NOT 'SE'                                         CPM005
     C***********                                                         CPM005
     C***********QFMODI    IFNE 'SE'                       B3             CPM005
     C***********          EXSR #P1005                                    CPM005
     C***********          END                             E3             CPM005
     C***********                                                         CPM005
     C***********          ADD  1         K                               CPM005
     C***********                                                         CPM005
     C***WRITE*A*RECORD TO THE SUBFILE                                    CPM005
     C***********                                                         CPM005
     C***********          ADD  1         RRN1                            CPM005
     C***********          ADD  1         RRN2                            CPM005
     C***********                                                   B08253CPM005
     C***FOR*ROLL BACKWARDS ON MATURED POSITIONS WRITE SCREEN RECORDB08253CPM005
     C***OUT*IN REVERSE SEQUENCE                                    B08253CPM005
     C***********WWMAFF    IFEQ 'M'                        B4       B08253CPM005
     C************IN24     ANDEQ'1'                                 B08253CPM005
     C***********          Z-ADDRRN1      W1RRN1  50                B08253CPM005
     C***********          Z-ADDRRN2      W1RRN2  50                B08253CPM005
     C********** 8         SUB  RRN1      RRN1                     B08253 080700
     C********** 8         SUB  RRN2      RRN2                     B08253 080700
     C***********7         SUB  RRN1      RRN1                      080700CPM005
     C***********7         SUB  RRN2      RRN2                      080700CPM005
     C***********          END                             E4       B08253CPM005
     C***********                                                         CPM005
     C***********          WRITEPM0700S1                                  CPM005
     C***********          WRITEPM0700S2                                  CPM005
     C***********                                                   B08253CPM005
     C***RESTORE*SAVED VALUE OF RRN1 AND RRN2                       B08253CPM005
     C***********WWMAFF    IFEQ 'M'                        B4       B08253CPM005
     C************IN24     ANDEQ'1'                                 B08253CPM005
     C***********          Z-ADDW1RRN1    RRN1                      B08253CPM005
     C***********          Z-ADDW1RRN2    RRN2                      B08253CPM005
     C***********          END                             E4             CPM005
     C***********                                                         CPM005
     C********** K         CABEQ7         #P1039                          080700
     C***********K         CABEQ6         #P1039                    080700CPM005
     C***********          END                             E2             CPM005
     C***********                                                         CPM005
     C***READ*NEXT HOLDING RECORD                                         CPM005
     C****                 READ PMHOLDL2                 72               B08253
     C***********WWMAFF    IFEQ 'D'                        B2       B08253CPM005
     C***********          READ PMHOLDL5                 72         B08253CPM005
     C***********          ELSE                            X2       B08253CPM005
     C***********                                                         CPM005
     C************IN24     IFEQ '1'                        B3       B08253CPM005
     C**********           READPPMMFHLPP                 72         B08253S01486
     C***********          READPPMMFHLPD                 72         S01486CPM005
     C***********          ELSE                            X3       B08253CPM005
     C**********           READ PMMFHLPP                 72         B08253S01486
     C***********          READ PMMFHLPD                 72         S01486CPM005
     C***********          END                             E3       B08253CPM005
     C***********          END                             E2       B08253CPM005
     C***********          END                             E1             CPM005
     C***********                                                         CPM005
     C***IF*NO*LIVE RECORDS TO BE DISPLAYED OUTPUT BLANKS TO SUBFILE      CPM005
     C***********          ELSE                                           CPM005
     C***********          ADD  1         RRN1                            CPM005
     C***********          ADD  1         RRN2                            CPM005
     C***********          MOVE '1'       *IN59                           CPM005
     C***********          MOVE '0'       *IN52                           CPM005
     C***********          MOVE *BLANKS   DDNOM1                          CPM005
     C***********          MOVEL*BLANKS   DDCCY1                    R10052CPM005
     C***********          MOVE *BLANKS   DDNARR                          CPM005
     C***********          MOVE *BLANKS   DDNAR2                    S71062CPM005
     C***********          MOVE *BLANKS   DDMKTP                          CPM005
     C***********          MOVE *BLANKS   DDMFXR                          CPM005
     C***********          MOVE *BLANKS   DDMVPC                          CPM005
     C***********          MOVE *BLANKS   DDNOM2                          CPM005
     C***********          MOVEL*BLANKS   DDCCY2                    R10052CPM005
     C***********          MOVE *BLANKS   DDTOG4                    S01496CPM005
     C***********          MOVE *BLANKS   DDDETA                          CPM005
     C***********          MOVE *BLANKS   DDDET2                    S71062CPM005
     C***********          MOVE *BLANKS   DDFOPR                          CPM005
     C***********          MOVE *BLANKS   DDFFXR                          CPM005
     C***********          MOVE *BLANKS   DDAIPC                          CPM005
     C***********          MOVE *BLANKS   DDNARR                          CPM005
     C***********          MOVE *BLANKS   DDSECU                          CPM005
     C***********          MOVE *BLANKS   DDAMEU                    S71062CPM005
     C***********          MOVE *BLANKS   DDMVIC                          CPM005
     C***********          MOVE *BLANKS   DDMKTY                          CPM005
     C***********          MOVE *BLANKS   DDMTPL                          CPM005
     C***********          MOVE *BLANKS   DDDETA                          CPM005
     C***********          MOVE *BLANKS   DDAIIC                          CPM005
     C***********          MOVE *BLANKS   DDFOLY                          CPM005
     C***********          MOVE *BLANKS   DDEXPL                          CPM005
     C***************3     MOVEL*BLANKS   DDXCCY                    R05586R00631
     C***********          WRITEPM0700S1                                  CPM005
     C***********          WRITEPM0700S2                                  CPM005
     C***********          MOVE '0'       *IN59                           CPM005
     C***********          MOVE '0'       *IN52                           CPM005
     C***********          MOVE '0'       *IN53                     B08040CPM005
     C***********          END                             E1             CPM005
     C***********                                                         CPM005
     C***********#P1039    ENDSR                                          CPM005
     C***********                                                         CPM005
      ********************************************************************CPM005
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1004   - FORMAT 'SE' HOLDINGS FOR OUTPUT TO SUBFILE            *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - TO CONVERT NUMERIC FIELD WITH DECIMAL POINT           *
      * ZEDIT    - TO CONVERT A NUMERIC FIELD WITH DECIMAL POINT         *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1002   - LOAD SUBFILE WITH TRADE DATE HOLDINGS                 *
      * #P1003   - LOAD SUBFILE WITH VALUE DATE HOLDINGS                 *
      * #P1007   - LOAD SUBFILE WITH PORTFOLIO & GLOBAL POSITION         *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1004    BEGSR
     C**
     C                     EXSR #BLANK
     C**
     C** SAVE SECURITY SHORT NAME AND TRANSACTION NUMBER IN HIDDEN FIELD
     C**
     C                     MOVELQFTDSS    DDSHOR
     C                     MOVELQFTRNB    DDTRNH
     C                     MOVELQFTVDA    DDTVDH
     C                     MOVELQFSPLD    DDSPLH
     C**
     C** SAVE RECI
     C**
     C                     MOVELQFRECI    DDRECH
     C**
     C** MOVE MIDAS INSTRUMENT NAME TO NARRATIVE
     C**
     C                     MOVELQFTXT1    DDNARR
     C                     MOVELQFTXT1    DDNAR2                          CPM005
     C                     MOVELQFTXT2    DDDETA
     C                     MOVELQFTXT2    DDDET2                          CPM005
     C**
     C                     MOVELQFMODI    DDMODH
     C**
     C** CONVERT THE LINE AMOUNT 1
     C**
     C                     Z-ADDQFAMT1    ZFLD15
     C                     Z-ADDQFCDP1    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDNOM1
     C**                                                                  B08040
     C** CONVERT THE OTHER AMOUNT                                         B08040
     C**                                                                  B08040
     C           QFOAMT    IFEQ *HIVAL                                    B08040
     C***********QFPOST    ANDEQ'C'                                 CPM005CPM005
     C           QFAMT1    OREQ QFOAMT                                    SA9108
     C***********QFPOST    ANDEQ'C'                                 CPM005CPM005
     C                     MOVE *BLANKS   DDNOM2
     C                     ELSE
     C                     Z-ADDQFOAMT    ZFLD15                          B08040
     C                     Z-ADDQFCDP1    ZDECS                           B08040
     C                     EXSR ZSEDIT                                    B08040
     C****                 MOVE ZOUT21    WWWR15 14                 B0804056079
     C******************** MOVE ZOUT21    WWWR15 15                 56079 062021
     C******************** MOVELWWWR15    DDNOM2                    B08040062021
     C******************** MOVEL'('       DDNOM2                    B08040062021
     C******************** MOVE ')'       DDNOM2                    B08040062021
     C                     MOVE ZOUT21    WWWR15 15                       062021
     C                     MOVE ')'       DDNO22 16                       062021
     C                     MOVELWWWR15    DDNO22                          062021
     C                     MOVE DDNO22    DDNOM2                          62021
     C***********          MOVE '('       DDNOM2                     62021110007
     C                     MOVEL'('       DDNOM2                          110007
     C                     END                                            B08040
     C****                                                                B08040
     C****F RECORD ID IS 'D' OR 'F' MOVE BLANKS IN NOMINAL 2              B08040
     C****                                                                B08040
     C****       QFRECI    IFEQ 'D'                                       B08040
     C****       QFRECI    OREQ 'F'                                       B08040
     C****                                                                B08040
     C****                 MOVEL*BLANKS   DDNOM2                          B08040
     C****                                                                B08040
     C****                 END                                            B08040
     C****                                                                B08040
     C****F RECORD ID IS 'M' MOVE 'MATURED' IN NOMINAL 2                  B08040
     C****                                                                B08040
     C****       QFRECI    IFEQ 'M'                                       B08040
     C****                                                                B08040
     C****                 MOVEL'MATURED' DDNOM2                          B08040
     C****                                                                B08040
     C****                 END                                            B08040
     C****                                                                B08040
     C****F SECURITY PLEDGED FLAG SET TO Y                                B08040
     C****OVE 'PLEDGED' TO NOMINAL 2                                      B08040
     C****                                                                B08040
     C****       QFSPLD    IFEQ 'Y'                                       B08040
     C****                                                                B08040
     C****                 MOVEL'PLEDGED' DDNOM2                          B08040
     C****                                                                B08040
     C****                 END                                            B08040
     C           QFSPLD    IFEQ 'Y'                                       B08040
     C                     MOVEL' P '     DDCCY2                          B08040
     C                     MOVE '1'       *IN53                           B08040
     C                     END                                            B08040
     C**                                                                  R10052
     C** CURRENCY 1 & CURRENCY 2                                          R10052
     C**                                                                  R10052
     C                     MOVELQFCCY1    DDCCY1                          R10052
     C******               MOVELQFCCY2    DDCCY2                   B08040 R0642
     C**
     C** EDIT THE MARKET PRICE
     C**
     C                     MOVEL*BLANKS   ZFIELD
     C           QFMPRC    IFGT 999999                                    CH0177
     C                     Z-ADD7         ZADIG                           CH0177
     C                     Z-ADD2         ZADEC                           CH0177
     C                     Z-ADDQFMPRC    WWPRI2                          CH0177
     C                     MOVE WWPRI2    ZFIELD                          CH0177
     C                     ELSE                                           CH0177
     C           QFMPRC    IFGT 99999                                     B07939
     C                     Z-ADD6         ZADIG                           B07939
     C                     Z-ADD3         ZADEC                           B07939
     C                     Z-ADDQFMPRC    WWPRI3                          B07939
     C                     MOVE WWPRI3    ZFIELD                          B07939
     C                     ELSE                                           B07939
     C***********          Z-ADDQFMPRC    WWPRIC    H                     R10052
     C*********************Z-ADDQFMPRC    WWPRIC  94H                     R05655
     C                     Z-ADDQFMPRC    WWPRI1                          R05655
     C*********************MOVE WWPRIC    ZFIELD                          R05655
     C                     MOVE WWPRI1    ZFIELD                          R05655
     C                     Z-ADD5         ZADIG
     C******************** Z-ADD5         ZADEC                           R10052
     C                     Z-ADD4         ZADEC
     C                     END                                            B07939
     C                     END                                            CH0177
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDMKTP
     C**
     C** EDIT THE MARKET FX RATE
     C**
     C                     MOVEL*BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADIG
     C******************** Z-ADD7         ZADEC                           R10052
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDMFXR
     C**
     C** CONVERT THE MARKET VALUE FROM INSTRUMENT TO PORTFOLIO CCY USING ZCCYXR
     C**
     C****                 Z-ADDQFMVAL    ZAMTF                           47863
     C****                 Z-ADDQFCDP2    ZCDPF                           47863
     C****                 Z-ADDQMPCDP    ZCDPT                           47863
     C****                 Z-ADDQFMFXR    ZCRSRT                          47863
     C******************** MOVE 'M'       ZCRSMD                    47863 R00631
     C****                 MOVE QFMFMD    ZCRSMD                    47863 R00631
     C****                 EXSR ZCCYXR                                    47863
     C**
     C** EDIT THE MARKET VALUE IN PORTFOLIO CURRENCY
     C**
     C****                 Z-ADDZAMTT     ZFLD15                          47863
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C                     Z-ADDQFMVPC    ZFLD15                          47863
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDMVPC
     C**
     C** EDIT THE MARKET VALUE IN INSTRUMENT CURRENCY
     C**
     C                     Z-ADDQFMVAL    ZFLD15
     C                     Z-ADDQFCDP2    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDMVIC
     C**
     C** CONVERT THE P&L MARKET
     C**
     C                     Z-ADDQFPLMK    ZFLD15
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDMTPL
     C**
     C** MOVE SECURITY SHORTNAME TO TRANSACTION/SECURITY REFERENCE
     C**
     C***********          MOVELQFTDSS    DDSECU                          CPM005
     C                     MOVELQFTDSS    DDAMEU                          CPM005
     C**
     C** CONVERT ACCRUED INTEREST FROM INSTRUMENT TO PORTFOLIO CCY USING ZCCYXR
     C**
     C****                 Z-ADDQFACIS    ZAMTF                           47863
     C****                 Z-ADDQFCDP2    ZCDPF                           47863
     C****                 Z-ADDQMPCDP    ZCDPT                           47863
     C****                 Z-ADDQFMFXR    ZCRSRT                          47863
     C******************** MOVE 'M'       ZCRSMD                    47863 R00631
     C****                 MOVE QFMFMD    ZCRSMD                    47863 R00631
     C****                 EXSR ZCCYXR                                    47863
     C****                                                                47863
     C****DIT ACCRUED INTEREST IN PORTFOLIO CURRENCY                      47863
     C****                                                                47863
     C****                 Z-ADDZAMTT     ZFLD15                          47863
     C                     Z-ADDQFAIPC    ZAMTT                           47863
     C                     Z-ADDQFAIPC    ZFLD15                          47863
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDAIPC
     C**
     C** EDIT ACCRUED INTEREST IN INSTRUMENT CURRENCY
     C**
     C                     Z-ADDQFACIS    ZFLD15
     C                     Z-ADDQFCDP2    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDAIIC
     C**
     C** EDIT BOOK (FOLIO) PRICE
     C**
     C           QFBOPR    IFNE *ZERO
     C                     MOVEL*BLANKS   ZFIELD
     C           QFBOPR    IFGT 99999                                     B07939
     C                     Z-ADD6         ZADIG                           B07939
     C                     Z-ADD3         ZADEC                           B07939
     C                     Z-ADDQFMPRC    WWPRI3                          B07939
     C                     MOVE WWPRI3    ZFIELD                          B07939
     C                     ELSE                                           B07939
     C*************        Z-ADDQFBOPR    WWPRIC 105H                     R10052
     C*********************Z-ADDQFBOPR    WWPRIC  94H                     R05655
     C                     Z-ADDQFBOPR    WWPRI1                          R05655
     C*********************MOVE WWPRIC    ZFIELD                          R05655
     C                     MOVE WWPRI1    ZFIELD                          R05655
     C                     Z-ADD5         ZADIG
     C******************** Z-ADD5         ZADEC                           R10052
     C                     Z-ADD4         ZADEC
     C                     END                                            B07939
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDFOPR
     C                     ELSE
     C                     MOVE *BLANK    DDFOPR
     C                     END
     C**
     C** EDIT BOOK (FOLIO) FX RATE
     C** IF POSITION TYPE NOT EQUAL TO 'FC' OR 'FO' ELSE OUTPUT           CPM005
     C** VALUE DATE                                                       CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'FC'                                      CPM005
     C           QFPOST    OREQ 'FO'                                      CPM005
     C                     Z-ADDQFVDAT    ZDAYNO                          CPM005
     C                     EXSR ZDATE2                                    CPM005
     C                     MOVE ZADATE    DDFFXR                          CPM005
     C                     ELSE                                           CPM005
     C**
     C           QFBFXR    IFNE *ZERO
     C                     MOVEL*BLANKS   ZFIELD
     C***********          Z-ADDQFBFXR    WWRATE 117H                     R10052
     C                     Z-ADDQFBFXR    WWRATE  84H                     R10052
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADIG
     C******************** Z-ADD7         ZADEC                           R10052
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDFFXR
     C                     ELSE
     C                     MOVE *BLANK    DDFFXR
     C                     END
     C                     END                                            CPM005
     C**
     C** EDIT THE FX P/L
     C**
     C                     Z-ADDQFPLFX    ZFLD15
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDEXPL
     C**
     C** EDIT THE MARKET YIELD
     C**
     C** IF POSITION TYPE NOT EQUAL TO 'FC' OR 'FO' ELSE OUTPUT           CPM005
     C** 'OPEN' OR 'CLOSED'                                               CPM005
     C**                                                                  CPM005
     C           QFPOST    IFNE 'FC'                                      CPM005
     C           QFPOST    ANDNE'FO'                                      CPM005
     C***********QFMKYD    IFNE *ZERO                                     R05662
     C           QFMKYD    IFGT *ZERO                                     R05662
     C                     MOVEL*BLANKS   ZFIELD
     C                     Z-ADDQFMKYD    WWPRIC    H
     C                     MOVE WWPRIC    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDMKTY
     C                     ELSE                                           R05662
     C           QFMKYD    IFEQ -9999                                     R05662
     C                     MOVE *BLANKS   DDMKTY                          R05662
     C                     MOVE 'N/A '    DDMKTY                          R05662
     C                     ELSE
     C                     MOVE *BLANK    DDMKTY
     C                     END
     C                     END                                            R05662
     C                     ELSE                                           CPM005
     C           QFPOST    IFEQ 'FC'                                      CPM005
     C                     MOVE 'Closed'  DDMKTY                          CPM005
     C                     ELSE                                           CPM005
     C                     MOVE 'Open'    DDMKTY                          CPM005
     C                     END                                            CPM005
     C                     END                                            CPM005
     C**
     C** EDIT THE BOOK (FOLIO) YIELD
     C**
     C** IF POSITION TYPE NOT EQUAL TO 'FC' OR 'FO' ELSE OUTPUT           CPM005
     C** VALUE DATE                                                       CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'FC'                                      CPM005
     C           QFPOST    OREQ 'FO'                                      CPM005
     C                     Z-ADDQFVDAT    ZDAYNO                          CPM005
     C                     EXSR ZDATE2                                    CPM005
     C                     MOVE ZADATE    DDFOLY                          CPM005
     C                     ELSE                                           CPM005
     C***********QFBKYD    IFNE *ZERO                                     R05662
     C           QFBKYD    IFGT *ZERO                                     R05662
     C                     MOVEL*BLANKS   ZFIELD
     C                     Z-ADDQFBKYD    WWPRIC    H
     C                     MOVE WWPRIC    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDFOLY
     C                     ELSE                                           R05662
     C           QFBKYD    IFEQ -9999                                     R05662
     C                     MOVE *BLANKS   DDFOLY                          R05662
     C                     MOVE 'N/A '    DDFOLY                          R05662
     C                     ELSE
     C                     MOVE *BLANK    DDFOLY
     C                     END
     C                     END                                            R05662
     C                     END                                            CPM005
     C**
     C** FORMAT PORTFOLIO CURRENCY
     C           WWGLOB    IFNE 'Y'
     C                     MOVE *BLANKS   DDPTCY
     C                     MOVE *BLANKS   DDPTFR
     C                     ELSE
     C*
     C           QFPTFR    IFEQ '9997'
     C**********           MOVE P9R997    DDPTFR                          S01486
     C                     MOVE FCR997    DDPTFR                          S01486
     C                     ELSE
     C                     MOVE QFPTFR    DDPTFR
     C                     END
     C                     MOVE QMPTCY    DDPTCY
     C                     MOVE DDFOLY    DDFOL1
     C                     MOVE DDMKTY    DDMKT1
     C                     END
     C*                                                                   CPM005
     C** IF FX P/L EXISTS OUTPUT TEXT '+FX' IN CURRENCY 2                 CPM005
     C           QFPOST    IFEQ 'FC'                                      CPM005
     C           QFPOST    OREQ 'FO'                                      CPM005
     C           QFPLFX    IFNE 0                                         CPM005
     C                     MOVE '+FX'     DDCCY2                          CPM005
     C                     END                                            CPM005
     C                     END                                            CPM005
     C*
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1005   - FORMAT 'FF' 'DL' 'LE' AND 'RE' HOLDINGS               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - TO CONVERT NUMERIC FIELD WITH DECIMAL POINT           *
      * ZEDIT    - TO CONVERT A NUMERIC FIELD WITH DECIMAL POINT         *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1002   - LOAD SUBFILE WITH TRADE DATE HOLDINGS                 *
      * #P1003   - LOAD SUBFILE WITH VALUE DATE HOLDINGS                 *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1005    BEGSR
     C**
     C                     EXSR #BLANK
     C****                                                                B08253
     C****F RECORD ID IS 'M' MOVE 'MATURED' IN NOMINAL 2                  B08253
     C****                                                                B08253
     C****       QFRECI    IFEQ 'M'                        B1             B08253
     C****                                                                B08253
     C****                 MOVEL'MATURED' WWNOM3                          B08253
     C****                                                                B08253
     C****                 END                             E1             B08253
     C*                                                                   R00853
     C** IF TRANSACTION IS FORWARD AND MODULE ID ONE OF 'FD' 'FL' 'DL'    R00853
     C** OR 'LE' OUTPUT TEXT 'FORWARD'                                    R00853
     C****       QFMODI    IFEQ 'FD'                                R00853S01313
     C****       QFMODI    OREQ 'FL'                                R00853S01313
     C****       QFMODI    OREQ 'DL'                                R00853S01313
     C           QFMODI    IFEQ 'FI'                                      S01313
     C           QFMODI    OREQ 'MD'                                      S01313
     C           QFMODI    OREQ 'ML'                                      S01313
     C           QFMODI    OREQ 'FX'                                      S01313
     C           QFMODI    OREQ 'FR'                                      S01313
     C           QFMODI    OREQ 'LE'                                      R00853
     C*                                                                   R00853
     C           QFTVDA    IFEQ 'T'                                       R00853
     C           QMTVPS    ANDEQ'T'                                       46081
     C           QFRECI    ANDEQ'D'                                       46973
     C           QFTVDA    OREQ 'X'                                       46081
     C           QMTVPS    ANDEQ'V'                                       46081
     C           QFRECI    ANDEQ'D'                                       46973
     C                     MOVEL'FORWARD' DDNOM2                          R00853
     C                     END                                            R00853
     C*                                                                   S01313
     C** OUTPUT TEXT 'CHANGES PENDING' IF ANY DEAL AMENDMENTS             S01313
     C** OUTSTANDING                                                      S01313
     C           QFDLAM    IFEQ 'Y'                        B2             S01313
     C           QFTVDA    IFEQ 'T'                        B3             S01313
     C                     MOVE '/CHG PDG'DDNOM2                          S01313
     C                     ELSE                            X3             S01313
     C                     MOVEL'CHANGES 'DDNOM2                          S01313
     C                     MOVE 'PENDING 'DDNOM2                          S01313
     C                     END                             E3             S01313
     C                     END                             E2             S01313
     C*                                                                   R00853
     C                     END                                            R00853
     C**
     C** LOAD MIDAS INSTRUMENT NAME AND DETAILS ENQUIRIES IN SUBFILE
     C**
     C                     MOVELQFTXT1    DDNARR
     C                     MOVELQFTXT1    DDNAR2                          S71062
     C                     MOVELQFTXT2    DDDETA
     C                     MOVELQFTXT2    DDDET2                          S71062
     C***********          MOVELQFCCY1    WWCCY1                   S71062 CPM005
     C           QFMODI    IFEQ 'FF'                                      CPM005
     C                     MOVELQFCCY2    WWCCY2                          CPM005
     C                     END                                            CPM005
     C**
     C**
     C** SAVE RECI AND MODULE ID
     C**
     C                     MOVELQFRECI    DDRECH
     C                     MOVELQFMODI    DDMODH
     C                     Z-ADDQFAMT2    DDAMTH
     C                     MOVELQFTDSS    DDSHOR                          CPM005
     C**
     C** IF MODULE ID = 'FF'
     C**
     C           QFMODI    IFEQ 'FF'                       B1
     C*                                                                   S71062
     C** DISPLAY AMERICAN OR EUROPEAN ONLY FOR FF                         S71062
     C*                                                                   S71062
     C                     SELEC                                          S71062
     C           QFAEIN    WHEQ 'A'                        B2             S71062
     C                     MOVEL'AM'      DDAMEU                          S71062
     C           QFAEIN    WHEQ 'E'                        B3             S71062
     C                     MOVEL'EU'      DDAMEU                          S71062
     C                     OTHER                           X3             S71062
     C                     MOVEL*BLANKS   DDAMEU                          S71062
     C                     ENDSL                                          S71062
     C**
     C** SAVE TRANSACTION NUMBER & F&O INSTRUMENT TYPE IN HIDDEN FIELD
     C**
     C********** QFTRNB    IFLT 0                                                      S71062 CLE148
     C**********           Z-SUBQFTRNB    WWORK4  60                                   S71062 CLE148
     C                     MOVELQFTRNB    WRKFLD  60                                          CLE148
     C           WRKFLD    IFLT 0                                                             CLE148
     C                     Z-SUBWRKFLD    WWORK4  60                                          CLE148
     C                     MOVE WWORK4    DDTRNH                          S71062
     C                     MOVE '-'       DDSIGH                          S71062
     C                     ELSE                                           S71062
     C                     MOVE QFTRNB    DDTRNH
     C                     MOVE ' '       DDSIGH                          S71062
     C                     END                                            S71062
     C                     MOVE QFFOIS    DDFOIH
     C**
     C                     Z-ADDQFCLON    DDCLOH                          S71062
     C*                                                                   S71062
     C** DISPLAY SETTLEMENT DATE                                          S71062
     C**                                                                  S71062
     C           BJDFIN    IFEQ 'M'                                       S71062
     C                     MOVE '1'       *IN98                           S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C                     Z-ADDQFSETD    ZDAYNO                          S71062
     C                     EXSR ZDATE2                                    S71062
     C                     MOVELZDATE     WKSETD                          S71062
     C**                                                                  S71062
     C                     MOVE WWDSET    WWDDAY                          S71062
     C                     MOVE WWMSET    WWMNTH                          S71062
     C                     MOVE WWYSET    WWYEAR                          S71062
     C                     MOVELWWSETD    DDNOM2                          S71062
     C*                                                                   S71062
     C** DISPLAY NARRATIVE                                                S71062
     C**                                                                  S71062
     C                     MOVEL*BLANKS   WWNAR2                          S71062
     C                     MOVEL*BLANKS   DDNAR2                          S71062
     C                     MOVELQFFOIS    WWFOIS                          S71062
     C                     MOVELWWFFMY    WWMTYR                          S71062
     C                     MOVELWWSETD    WWDATE                          S71062
     C                     MOVELWWNAR2    DDNAR2                          S71062
     C*                                                                   S71062
     C** DISPLAY NARRATIVE DDDET2 WITHOUT MONTH & YEAR                    S71062
     C**                                                                  S71062
     C                     MOVEL*BLANKS   WWMONT                          S71062
     C**                                                                  S71062
     C** REFORMAT NUMBER OF OPEN CONTRACTS                                S71062
     C**                                                                  S71062
     C******               Z-ADDQFAMT1    ZFLD15                          S71062
     C******               Z-ADD0         ZDECS                           S71062
     C******               EXSR ZSEDIT                                    S71062
     C******               MOVE ZOUT21    DDNOM1                          S71062
     C****                 MOVEL*BLANKS   ZFIELD                  S71062  076371
     C****                 MOVE QFAMT1    ZFIELD                  S71062  076371
     C****                 Z-ADD0         ZADEC                   S71062  076371
     C****                 EXSR ZEDIT                             S71062  076371
     C****                 MOVE ZFIELD    WWNO13                  S71062  076371
     C****                                                        S71062  076371
     C****ISPLAY NUMBER OF OPEN CONTRACTS WHIT '-' WHEN SALE      S71062  076371
     C****                                                        S71062  076371
     C****       QFDTYP    IFEQ 'S'                        B2     S71062  076371
     C****                 MOVEL'-'       WWSIGN                  S71062  076371
     C****                 ELSE                            X2     S71062  076371
     C****                 MOVEL*BLANKS   WWSIGN                  S71062  076371
     C****                 END                             E2     S71062  076371
     C****                 MOVELWWNOM1    DDNOM1                  S71062  076371
     C                     Z-ADDQFAMT1    ZFLD15                          076371
     C                     Z-ADD0         ZDECS                           076371
     C                     EXSR ZSEDIT                                    076371
     C*                                                                   077457
     C                     MOVELZOUT21    WWMK22 22                       077457
     C           QFDTYP    IFEQ 'S '                                      077457
     C                     MOVE '- '      WWMK22                          077457
     C                     END                                            077457
     C                     MOVE WWMK22    DDNOM1                          077457
     C*                                                                   S71062
     C** DISPLAY PURCHASE/SELL INDICATOR                                  S71062
     C**                                                                  S71062
     C                     MOVELQFDTYP    DDNOM1                          S71062
     C**
     C******               MOVEL*BLANKS   DDNOM2                          S71062
     C**
     C                     END                             E1
     C**
     C** IF MODULE ID = 'DL'
     C**
     C****       QFMODI    IFEQ 'DL'                       B1             S01313
     C           QFMODI    IFEQ 'MD'                       B1             S01313
     C           QFMODI    OREQ 'ML'                                      S01313
     C           QFMODI    OREQ 'DL'                                      50560
     C           QFMODI    OREQ 'FX'                                      S01313
     C           QFMODI    OREQ 'FR'                                      S01313
     C**
     C** SAVE TRANSACTION NUMBER IN HIDDEN FIELD
     C**
     C                     MOVE QFTRNB    DDTRNH
     C**
     C                     Z-ADDQFAMT1    ZFLD15
     C                     Z-ADDQFCDP1    ZDECS
     C                     EXSR ZSEDIT
     C           QFAMT1    IFGT *ZEROS                     B2             B10529
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C                     MOVE ZOUT21    WFLD16 16                       B10529
     C                     MOVELWFLD16    DDNOM1                          B10529
     C                     ELSE                            X2             B10529
     C                     MOVE ZOUT21    DDNOM1
     C                     END                             E2             B10529
     C*                                                                   39440
     C** FOR A MM LOAN NOMINAL SHOULD BE SIGNED '-'                       39440
     C           FCPORS    IFNE 'B'                                       CPM004
     C           QFDTYP    IFEQ 'IP'                                      39440
     C           QFDTYP    OREQ 'TI'                                      39440
     C           QFDTYP    OREQ 'LN'                                      39440
     C           QFDTYP    OREQ 'CL'                                      39440
     C           QFDTYP    OREQ 'DL'                                      39440
     C                     MOVE '-'       DDNOM1                          39440
     C                     END                                            39440
     C                     END                                            CPM004
     C**                                                                  R00631
     C** ADD THE 'BUY OR SELL' INDICATOR IN NOMINAL 1                     R00631
     C                     MOVELQFBYSF    DDNOM1                          R00631
     C**
     C** IF THE LINE 2 AMOUNT FROM HOLDINGS FILE IS NON ZERO
     C**
     C           QFAMT2    IFNE 0                          B2
     C**
     C***ADD*'B'*FOR*BUY*IN*NOMINAL*1                                     R00631
     C**
     C******************** MOVEL'B'       DDNOM1                          R00631
     C**
     C** EDIT THE LINE 2 AMOUNT
     C**
     C                     Z-ADDQFAMT2    ZFLD15
     C                     Z-ADDQFCDP2    ZDECS
     C                     EXSR ZSEDIT
     C           QFAMT2    IFGT *ZEROS                     B3             B10529
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C                     MOVE ZOUT21    WFLD16                          B10529
     C                     MOVELWFLD16    DDNOM2                          B10529
     C                     ELSE                            X3             B10529
     C                     MOVE ZOUT21    DDNOM2
     C                     END                             E3             B10529
     C**
     C***ADD*'S'*FOR*SELL*IN*NOMINAL*2
     C** ADD THE 'BUY OR SELL' INDICATOR IN NOMINAL 2                     R00631
     C           QFBYSF    IFEQ 'B'                        B3             R00631
     C                     MOVEL'S'       DDNOM2
     C                     ELSE                                           R00631
     C                     MOVEL'B'       DDNOM2                          R00631
     C                     END                             E3             R00631
     C**                                                                  R00631
     C** MOVE THE RELATED DEAL NUMBER INTO THE 'MARKET PRICE'             R00631
     C           QFRLDN    IFNE 0                          B3             R00631
     C           QFBYSF    ANDNE*BLANKS                                   46973
     C                     MOVE QFRLDN    DDMKTP                          R00631
     C                     END                             E3             R00631
     C**                                                                  R00631
     C** CONVERT ACCRUED INTEREST INTO PORTFOLIO CURRENCY                 R00631
     C***********QFACIS    IFNE 0                          B2             R01164
     C********** QFFPLC    CHAINSDCURRL0             73            R00631 S01486
     C**********                                                   R00631 S01486
     C********** *IN73     IFEQ '1'                        B4      R00631 S01486
     C           QFFPLC    IFNE *BLANKS                    B3             CPM005
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG   ' @RTCD   7                       S01486
     C                     PARM '*KEY    'WWOPTN  7                       S01486
     C                     PARM QFFPLC    WWKEY2  3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C**********           MOVEL'SDCURRL0'QMFILE           ** DB ER R00631S01486
     C                     MOVEL'SDCURRPD'QMFILE           ** DB ERROR 01 S01486
     C                     MOVELQFFPLC    QMKEY            ***************R00631
     C                     Z-ADD1         QMERRN                          R00631
     C                     EXSR *PSSR                                     R00631
     C                     END                             E4             R00631
     C**                                                                  R00631
     C                     Z-ADDQFACIS    ZAMTF                           R00631
     C                     MOVE QFFPLC    ZCCYF                           R00631
     C                     MOVE A6NBDP    ZCDPF                           R00631
     C                     MOVE A6MDIN    ZMDINF                          R00631
     C                     MOVE A6SPRT    ZRATEF                          R00631
     C****       QMPTCY    CHAINSDCURRL0             73             47863 R00631
     C****                                                          47863 R00631
     C****       *IN73     IFEQ '1'                        B4       47863 R00631
     C****                 MOVEL'SDCURRL0'QMFILE           ** DB ERR47863 R00631
     C****                 MOVELQMPTCY    QMKEY            *********47863*R00631
     C****                 Z-ADD2         QMERRN                    47863 R00631
     C****                 EXSR *PSSR                               47863 R00631
     C****                 END                             E4       47863 R00631
     C****                                                          47863 R00631
     C****                 MOVE QMPTCY    ZCCYT                     47863 R00631
     C****                 MOVE A6NBDP    ZCDPT                     47863 R00631
     C****                 MOVE A6MDIN    ZMDINT                    47863 R00631
     C****                 MOVE A6SPRT    ZRATET                    47863 R00631
     C****                 EXSR ZCCYCN                              47863 R00631
     C****                 Z-ADDZAMTT     ZFLD15                    47863 R00631
     C****                 Z-ADDZCDPT     ZDECS                     47863 R00631
     C                     Z-ADDQFAIPC    ZAMTT                           47863
     C                     Z-ADDQFAIPC    ZFLD15                    47863 R00631
     C                     Z-ADDQMPCDP    ZDECS                     47863 R00631
     C                     EXSR ZSEDIT                                    R00631
     C                     MOVE ZOUT21    DDAIPC                          R00631
     C*********************MOVE QFFPLC    DDXCCY                    R05586R00631
     C                     MOVE QFFPLC    DDSECU                          R05586
     C                     Z-ADDQFACIS    ZFLD15                          R00631
     C                     Z-ADDZCDPF     ZDECS                           R00631
     C                     EXSR ZSEDIT                                    R00631
     C                     MOVE ZOUT21    DDAIIC                          R00631
     C                     ELSE                            X3             CPM005
     C                     MOVE *BLANKS   DDAIIC                          CPM005
     C                     END                             E3             CPM005
     C***************      END                             E2             R01164
     C**                                                                  R00631
     C** OUTPUT DESCRIPTIVE ACCORDING TO THE STATUS OF THE TRANSACTION    R00631
     C           QFOPCL    IFEQ 'O'                        B3             R00631
     C                     MOVE QFRLDN    DDMTPL                          R00631
     C                     MOVEL'Close by'DDMTPL                          R00631
     C                     END                             E3             R00631
     C**                                                                  R00631
     C           QFOPCL    IFEQ 'L'                        B3             R00631
     C                     MOVE *BLANKS   DDMTPL                          R00631
     C                     MOVEL'Open    'DDMTPL                          R00631
     C                     END                             E3             R00631
     C**                                                                  R00631
     C           QFOPCL    IFEQ 'C'                        B3             R00631
     C**                                                                  R00631
     C           QFDTYP    IFEQ 'OP'                       B4             R00631
     C                     MOVE *BLANKS   DDMTPL                          R00631
     C                     MOVEL'Closed  'DDMTPL                          R00631
     C                     ELSE                            X4             R00631
     C                     MOVE QFRLDN    DDMTPL                          R00631
     C                     MOVEL'Close of'DDMTPL                          R00631
     C                     END                             E4             R00631
     C**                                                                  R00631
     C                     END                             E3             R00631
     C**                                                                  R00631
     C           QFOPCL    IFEQ 'M'                        B3             R00631
     C                     MOVEL'Matured 'DDMTPL                          R00631
     C                     END                             E3             R00631
     C**
     C                     END                             E2
     C**
     C                     END                             E1
     C**
     C** IF MODULE ID = 'FD' OR 'FL'
     C**
     C****       QFMODI    IFEQ 'FD'                                      S01313
     C****       QFMODI    OREQ 'FL'                                      S01313
     C           QFMODI    IFEQ 'FI'                                      S01313
     C**
     C** SAVE TRANSACTION NUMBER IN HIDDEN FIELD
     C**
     C                     MOVE QFTRNB    DDTRNH
     C****                                                           3213442752
     C**STORE*GUARANTEE TYPE FOR LOMBARDS CREDIT IN HIDDEN FIELD     3213442752
     C***                  MOVE QFINNR    DDTYPE                     3213442752
     C**
     C                     Z-ADDQFAMT1    ZFLD15
     C                     Z-ADDQFCDP1    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDNOM1
     C**
     C                     END
     C**
     C           QFMODI    IFEQ 'DL'                       B1             50559
     C                     Z-ADDQFAMT1    ZFLD15                          50559
     C                     Z-ADDQFCDP1    ZDECS                           50559
     C                     EXSR ZSEDIT                                    50559
     C           QFAMT1    IFGT *ZEROS                     B2             50559
     C                     MOVE ZOUT21    WFLD16 16                       50559
     C                     MOVELWFLD16    DDNOM1                          50559
     C                     ELSE                            X2             50559
     C                     MOVE ZOUT21    DDNOM1                          50559
     C                     END                             E2             50559
     C                     END                             E1             50559
     C** IF MODULE ID = 'LE'
     C**
     C           QFMODI    IFEQ 'LE'
     C**
     C** SAVE TRANSACTION NUMBER IN HIDDEN FIELD
     C**
     C                     MOVE QFTRNB    DDTRNH
     C**
     C*********************Z-ADDQFAMT1    ZFLD15                          R01150
     C           QMPORS    IFEQ 'B'                                       CPM004
     C                     Z-ADDQFAMT1    ZFLD15                          CPM004
     C                     ELSE                                           CPM004
     C                     Z-SUBQFAMT1    ZFLD15                          R01150
     C                     END                                            CPM004
     C                     Z-ADDQFCDP1    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDNOM1
     C**
     C                     END
     C**
     C** IF MODULE ID = 'LB'
     C**
     C           QFMODI    IFEQ 'LB'
     C**                                                                  42752
     C* STORE GUARANTEE TYPE FOR LOMBARDS CREDIT IN HIDDEN FIELD          42752
     C                     MOVE QFINNR    DDTYPE                          42752
     C**
     C**********           MOVE QFTXT2    WRK14  14                                     57400 CGL029
     C                     MOVE QFTXT2    WRK14  20                                           CGL029
     C                     ADD  1         PL      20                      57400
     C                     MOVELWRK14     DDORDN  3                       57400
     C                     MOVE DDORDN    ORD,PL                          57400
     C** SAVE TRANSACTION NUMBER IN HIDDEN FIELD
     C**
     C                     MOVE QFTRNB    DDTRNH
     C**
     C                     Z-ADDQFAMT1    ZFLD15
     C                     Z-ADDQFCDP1    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDNOM1
     C*                                                                   R05765
     C** SET UP CHARACTER INDICATING WHETHER PLEDGE GIVEN OR RECEIVED     R05765
     C                     MOVELQFTXT2    WWORK5  5                       R05765
     C           WWORK5    IFEQ 'GIVEN'                                   R05765
     C                     MOVEL'G'       DDNOM1                          R05765
     C                     ELSE                                           R05765
     C                     MOVEL'R'       DDNOM1                          R05765
     C                     END                                            R05765
     C**
     C** IF THE LINE 2 AMOUNT FROM HOLDINGS FILE IS NON ZERO
     C**
     C***********QFAMT2    IFNE 0                                         R05765
     C**
     C** ADD 'B' FOR BUY IN NOMINAL 1
     C**
     C*********************MOVELQFTXT2    WWWRK5  5                 R05765R0643
     C******               MOVE WWWRK5    WWWRK1  1                 R05765R0643
     C******               MOVELWWWRK1    DDNOM1                    R05765R0643
     C********             MOVEL'G'       DDNOM1                          R10060
     C**
     C** EDIT THE LINE 2 AMOUNT
     C**
     C                     MOVELQFTXT2    WWORK9  9                       R05956
     C                     MOVE WWORK9    WWORK3  3                       R05956
     C           WWORK3    IFNE *BLANKS                                   R05956
     C           WWORK3    ANDNE'FXD'                                     B08019
     C                     Z-ADDQFAMT2    ZFLD15
     C                     Z-ADDQFCDP2    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDNOM2
     C                     MOVEL'U'       DDNOM2                          R05765
     C                     ELSE                                           R05956
     C                     MOVE *BLANKS   DDNOM2                          R05956
     C                     MOVE *BLANKS   QFCCY2                          B08103
     C                     END                             E1             R05956
     C**
     C** ADD 'S' FOR SELL IN NOMINAL 2
     C**
     C******************** MOVEL'U'       DDNOM2                          R05765
     C**
     C**********           END                                            R05765
     C**                   MOVEL'U'       DDNOM2                    R05765R05956
     C**
     C                     END
     C**
     C** IF THE MODULE ID IS 'RE'
     C**
     C           QFMODI    IFEQ 'RE'
     C**
     C** SAVE ACCOUNT CODE AND ACCOUNT SEQUENCE IN HIDDEN FIELDS
     C**
     C                     MOVELQFTXT2    WWTEXT
     C                     MOVE WWTCCY    DDCCYH
     C                     MOVE WWTACO    DDACOH
     C                     MOVE WWTACS    DDACSH
     C                     MOVE WWBRCD    DDBRCH                          085862
     C**
     C                     Z-ADDQFAMT1    ZFLD15
     C                     Z-ADDQFCDP1    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDNOM1
     C**
     C           QMPORS    IFNE 'B'                                       CPM004
     C           QFAMT1    IFLT 0
     C*************        MOVE 'C'       DDNOM1                          R01150
     C                     MOVE ' '       DDNOM1                          R01150
     C                     ELSE
     C*************        MOVE 'D'       DDNOM1                          R01150
     C                     MOVE '-'       DDNOM1                          R01150
     C                     END
     C                     END                                            CPM004
     C**
     C****                 MOVEL*BLANKS   DDNOM2                          B08040
     C**                                                                  B08040
     C** CONVERT THE OTHER AMOUNT                                         B08040
     C**                                                                  B08040
     C           QFOAMT    IFEQ *HIVAL                                    B08040
     C           QFAMT1    OREQ QFOAMT                                    SA9108
     C                     MOVE *BLANKS   DDNOM2
     C                     ELSE
     C                     Z-ADDQFOAMT    ZFLD15                          B08040
     C                     Z-ADDQFCDP1    ZDECS                           B08040
     C                     EXSR ZSEDIT                                    B08040
     C                     MOVE ZOUT21    WWWR15                          B08040
     C           QMPORS    IFNE 'B'                                       CPM004
     C           QFOAMT    IFLE 0                          B2
     C                     MOVE ' '       WWWR15                          R01150
     C                     ELSE                            X2
     C                     MOVE '-'       WWWR15                          R01150
     C                     END                             E2
     C                     END                                            CPM004
     C******************** MOVE WWWR15    FLD15  15                 56079 062021
     C******************** MOVELFLD15     DDNOM2                    56079 062021
     C******************** MOVEL'('       DDNOM2                    B08040062021
     C******************** MOVE ')'       DDNOM2                    B08040062021
     C                     MOVE ')'       DDNO22 16                       062021
     C                     MOVELWWWR15    DDNO22                          062021
     C                     MOVE DDNO22    DDNOM2                          062021
     C                     MOVEL'('       DDNOM2                          062021
     C                     END                                            B08040
     C**
     C                     END
     C**                                                                  R10052
     C** CURRENCY 1 & CURRENCY 2                                          R10052
     C**                                                                  R10052
     C                     MOVELQFCCY1    DDCCY1                          R10052
     C******               MOVELQFCCY2    DDCCY2                    R10052S71062
     C           QFMODI    IFEQ 'FF'                                      S71062
     C                     MOVEL*BLANKS   DDCCY2                          S71062
     C                     ELSE                                           S71062
     C                     MOVELQFCCY2    DDCCY2                          S71062
     C                     END                                            S71062
     C*                                                                   CPM005
     C** IF SELL CURRENCY FIRST REVERSE FIELDS                            CPM005
     C           QFBYSF    IFEQ 'S'                        B1             CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C                     MOVELDDLIN1    WRLIN1 19                       CPM005
     C                     MOVELDDLIN2    WRLIN2 19                       CPM005
     C                     MOVELWRLIN2    DDLIN1                          CPM005
     C                     MOVELWRLIN1    DDLIN2                          CPM005
     C                     END                             E1             CPM005
     C**
     C** IF THE MARKET PRICE IS NON ZERO
     C**
     C           QFMPRC    IFNE 0
     C                     MOVEL*BLANKS   ZFIELD
     C           QFMPRC    IFGT 999999                                    CH0177
     C                     Z-ADD7         ZADIG                           CH0177
     C                     Z-ADD2         ZADEC                           CH0177
     C                     Z-ADDQFMPRC    WWPRI2                          CH0177
     C                     MOVE WWPRI2    ZFIELD                          CH0177
     C                     ELSE                                           CH0177
     C                     Z-ADD5         ZADIG
     C******************** Z-ADD5         ZADEC                           R10052
     C                     Z-ADD4         ZADEC
     C*********************Z-ADDQFMPRC    WWPRIC    H                     R05655
     C*********************MOVE WWPRIC    ZFIELD                          R05655
     C                     Z-ADDQFMPRC    WWPRI1    H                     R05655
     C                     MOVE WWPRI1    ZFIELD                          R05655
     C                     END                                            CH0177
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDMKTP
     C                     ELSE
     C**                                                                  R00631
     C           QFRLDN    IFEQ 0                                         R00631
     C                     MOVEL*BLANKS   DDMKTP
     C                     END                                            R00631
     C**                                                                  R00631
     C                     END
     C**
     C** IF THE MARKET FX RATE IS NON ZERO
     C**
     C           QFMFXR    IFNE 0
     C                     MOVEL*BLANKS   ZFIELD
     C                     Z-ADD4         ZADIG
     C******************** Z-ADD7         ZADEC                           R10052
     C                     Z-ADD4         ZADEC
     C                     Z-ADDQFMFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDMFXR
     C                     ELSE
     C                     MOVEL*BLANKS   DDMFXR
     C                     END
     C**
     C** IF THE MARKET VALUE IS NON ZERO
     C**
     C***********QFMVAL    IFNE 0                          B1             R05631
     C**
     C** CONVERT THE MARKET VALUE FROM INSTRUMENT TO PORTFOLIO CCY USING ZCCYXR
     C**
     C           QFAMT2    IFEQ 0                                         R05586
     C           QFMODI    OREQ 'FF'                                      076371
     C****                 Z-ADDQFMVAL    ZAMTF                           47863
     C****                 Z-ADDQFCDP1    ZCDPF                           47863
     C****                 Z-ADDQMPCDP    ZCDPT                           47863
     C****                 Z-ADDQFMFXR    ZCRSRT                          47863
     C******************** MOVE 'M'       ZCRSMD                    47863 R00631
     C****                 MOVE QFMFMD    ZCRSMD                    47863 R00631
     C****                 EXSR ZCCYXR                                    47863
     C**
     C** EDIT THE MARKET VALUE IN PORTFOLIO CURRENCY
     C**
     C****                 Z-ADDZAMTT     ZFLD15                          47863
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C                     Z-ADDQFMVPC    ZFLD15                          47863
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDMVPC
     C*                                                                   R05586
     C** FOR FX DEALS OUTPUT FX PROFIT AND LOSS AS MARKET VALUE           R05586
     C                     ELSE                                           R05586
     C*                                                                   CPM005
     C** FOR DISPLAY OF 'NOTIONAL' FX DEALS DUE TO SE TRADES WITH         CPM005
     C** SETTLEMENT CURRENCY *NE NOMINAL CURRENCY OUTPUT MARKET VALUE     CPM005
     C** ZERO; OTHERWISE MARKET VALUE FOR FX DEALS IS FX P/L              CPM005
     C           QFTDSS    IFEQ *BLANKS                                   CPM005
     C                     Z-ADDQFPLFX    ZFLD15                          R05586
     C                     ELSE                                           CPM005
     C                     Z-ADD0         ZFLD15                          CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C                     Z-ADDQMPCDP    ZDECS                           R05586
     C                     EXSR ZSEDIT                                    R05586
     C                     MOVE ZOUT21    DDMVPC                          R05586
     C                     END                                            R05586
     C**
     C** EDIT THE MARKET VALUE IN INSTRUMENT CURRENCY
     C**
     C                     Z-ADDQFMVAL    ZFLD15
     C           QFAMT2    IFNE 0                                         R05586
     C           QFMODI    ANDNE'FF'                                      076371
     C           QFFPLC    IFEQ QFCCY1                                    R05586
     C                     Z-ADDQFCDP1    ZDECS                           R05586
     C                     ELSE                                           R05586
     C                     Z-ADDQFCDP2    ZDECS                           R05586
     C                     END                                            R05586
     C                     ELSE                                           R05586
     C                     Z-ADDQFCDP1    ZDECS                           R05586
     C                     END                                            R05586
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDMVIC
     C************         ELSE                            X1             R05631
     C************         MOVEL*BLANKS   DDMVPC                          R05631
     C************         MOVEL*BLANKS   DDMVIC                          R05631
     C************         END                             E1             R05631
     C**
     C** IF THE P/L MARKET IS NON ZERO
     C**
     C           QFPLMK    IFNE 0
     C                     Z-ADDQFPLMK    ZFLD15
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDMTPL
     C**
     C                     ELSE
     C**                                                                  R00631
     C           QFOPCL    IFEQ *BLANKS                                   R00631
     C                     MOVEL*BLANKS   DDMTPL
     C                     END                                            R00631
     C**                                                                  R00631
     C                     END
     C**
     C** MOVE TRANSACTION NUMBER TO TRANSACTION REFERENCE
     C**
     C           QFMODI    IFEQ 'RE'
     C                     MOVE *BLANKS   DDSECU
     C                     MOVE QFACNO    DDACNO                          CPM004
     C                     ELSE
     C           QFMODI    IFEQ 'FF'                                      S71062
     C*                                                                   S71062
     C********** QFTRNB    IFLT 0                                                      S71062 CLE148
     C**********           Z-SUBQFTRNB    QFTRNB                                       S71062 CLE148
     C**********           MOVELQFTRNB    WWTNBR  7                                    S71062 CLE148
     C                     MOVELQFTRNB    WRKFLD                                              CLE148
     C           WRKFLD    IFLT 0                                                             CLE148
     C                     Z-SUBWRKFLD    WRKFLD                                              CLE148
     C                     MOVELWRKFLD    WWTNBR  7                                           CLE148
     C                     MOVE '-'       WWTNBR                          S71062
     C                     MOVELWWTNBR    DDSECU                          S71062
     C                     ELSE                                           S71062
     C                     MOVELQFTRNB    DDSECU                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C                     ELSE                                           S71062
     C                     MOVELQFTRNB    DDSECU
     C                     END                                            S71062
     C                     END
     C*                                                                   CPM005
     C                     MOVE *BLANKS   DDAMEU                          CPM005
     C           QFTDSS    IFNE *BLANKS                                   CPM005
     C                     MOVE QFTDSS    DDAMEU                          CPM005
     C                     END                                            CPM005
     C**
     C** IF THE ACCRUED INTEREST AMOUNT IS NON ZERO EDIT FOR OUTPUT
     C***********QFACIS    IFNE 0                          B1             R01164
     C           QFMODI    IFEQ 'RE'                                      R01164
     C****       QFMODI    OREQ 'FD'                                R01164S01313
     C****       QFMODI    OREQ 'FL'                                R01164S01313
     C           QFMODI    OREQ 'FI'                                      S01313
     C           QFMODI    OREQ 'ML'                                      39440
     C           QFMODI    OREQ 'MD'                                      39440
     C           QFMODI    OREQ 'LE'                                      R01164
     C           QFAMT2    ANDEQ0                                         R00631
     C**
     C** CONVERT ACCRUED INTEREST FROM INSTRUMENT TO PORTFOLIO CCY USING ZCCYXR
     C**
     C****                 Z-ADDQFACIS    ZAMTF                           47863
     C****                 Z-ADDQFCDP1    ZCDPF                           47863
     C****                 Z-ADDQMPCDP    ZCDPT                           47863
     C****                 Z-ADDQFMFXR    ZCRSRT                          47863
     C******************** MOVE 'M'       ZCRSMD                    47863 R00631
     C****                 MOVE QFMFMD    ZCRSMD                    47863 R00631
     C****                 EXSR ZCCYXR                                    47863
     C**
     C** EDIT ACCRUED INTEREST IN PORTFOLIO CURRENCY
     C**
     C****                 Z-ADDZAMTT     ZFLD15                          47863
     C                     Z-ADDQFAIPC    ZAMTT                           47863
     C                     Z-ADDQFAIPC    ZFLD15                          47863
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDAIPC
     C**
     C** EDIT ACCRUED INTEREST IN INSTRUMENT CURRENCY
     C**
     C                     Z-ADDQFACIS    ZFLD15
     C                     Z-ADDQFCDP1    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDAIIC
     C                     ELSE
     C**                                                                  R00631
     C           QFOPCL    IFEQ *BLANKS                                   R00631
     C                     MOVEL*BLANKS   DDAIPC
     C                     MOVEL*BLANKS   DDAIIC
     C                     END                                            R00631
     C**                                                                  R00631
     C                     END
     C**
     C** IF THE BOOK PRICE IS NON ZERO
     C**
     C           QFBOPR    IFNE 0
     C                     MOVEL*BLANKS   ZFIELD
     C                     Z-ADD5         ZADIG
     C******************** Z-ADD5         ZADEC                           R10052
     C                     Z-ADD4         ZADEC
     C*********************Z-ADDQFBOPR    WWPRIC    H                     R05655
     C*********************MOVE WWPRIC    ZFIELD                          R05655
     C                     Z-ADDQFBOPR    WWPRI1    H                     R05655
     C                     MOVE WWPRI1    ZFIELD                          R05655
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDFOPR
     C                     ELSE
     C                     MOVEL*BLANKS   DDFOPR
     C                     END
     C**
     C** IF THE BOOK FX RATE IS NON ZERO
     C**
     C           QFBFXR    IFNE 0
     C                     MOVEL*BLANKS   ZFIELD
     C                     Z-ADD4         ZADIG
     C******************** Z-ADD7         ZADEC                           R10052
     C                     Z-ADD4         ZADEC
     C                     Z-ADDQFBFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    DDFFXR
     C                     ELSE
     C                     MOVEL*BLANKS   DDFFXR
     C                     END
     C**
     C           QFMODI    IFEQ 'LE'
     C****       QFMODI    OREQ 'DL'                                      S01313
     C           QFMODI    OREQ 'DL'                               S01313 50560
     C           QFMODI    OREQ 'MD'                                      S01313
     C           QFMODI    OREQ 'ML'                                      S01313
     C           QFMODI    OREQ 'FX'                                      S01313
     C           QFMODI    OREQ 'FR'                                      S01313
     C           QFMODI    OREQ 'FI'                                      47863
     C**
     C****       QFAMT2    IFEQ 0                                   R00631R0147
     C**                                                                  R00631
     C** EDIT THE P&L MARKET
     C**
     C           QFAMT2    IFEQ 0                                         R05586
     C                     Z-ADDQFPLMK    ZFLD15
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDMTPL
     C                     END                                            R05586
     C**
     C** EDIT THE FX P/L
     C**
     C                     Z-ADDQFPLFX    ZFLD15
     C                     Z-ADDQMPCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDEXPL
     C****                 ELSE                                     R00631R0147
     C****                 MOVE DDAIPC    DDEXPL                    R00631R0147
     C****                 END                                      R00631R0147
     C**
     C                     ELSE
     C                     MOVEL*BLANKS   DDMTPL
     C                     MOVEL*BLANKS   DDEXPL
     C                     END
     C**
     C** SET OTHER FIELDS TO BLANK
     C**
     C                     MOVEL*BLANKS   DDMKTY
     C                     MOVEL*BLANKS   DDFOLY
     C**
     C*                                                                   S71062
     C** DISPLAY WHEN FF                                                  S71062
     C*                                                                   S71062
     C           QFMODI    IFEQ 'FF'                       B1             S71062
     C***DISPLAY MARKET VALUE                                      S71062 076371
     C****                                                         S71062 076371
     C****       QFMVAL    IFNE *ZEROS                     B2      S71062 076371
     C****                 Z-ADDQFMVAL    ZFLD15                   S71062 076371
     C****                 Z-ADDQFCDP2    ZDECS                    S71062 076371
     C****                 EXSR ZSEDIT                             S71062 076371
     C****                 MOVE ZOUT21    DDMVPC                   S71062 076371
     C****                 ELSE                            X2      S71062 076371
     C****                 MOVEL*BLANKS   DDMVPC                   S71062 076371
     C****                 END                             E2      S71062 076371
     C*                                                                   S71062
     C** PURCHASE INTEREST                                                S71062
     C*                                                                   S71062
     C           QFPUIT    IFNE *ZEROS                     B2             S71062
     C                     Z-ADDQFPUIT    ZFLD15                          S71062
     C****                 Z-ADDQFCDP1    ZDECS                    S71062 076371
     C                     Z-ADDQFCDP2    ZDECS                           076371
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    DDAIIC                          S71062
     C                     MOVELWWFFMC    DDFOLY                          S71062
     C                     ELSE                            X2             S71062
     C                     MOVEL*BLANKS   DDAIIC                          S71062
     C                     MOVEL*BLANKS   DDFOLY                          S71062
     C                     END                             E2             S71062
     C*                                                                   S71062
     C** NBR OF CONTRACT <> NBR OF ORIGINAL CONTRACT                      S71062
     C*                                                                   S71062
     C           QFAMT1    IFNE QFAMT2                     B2             S71062
     C*                                                                   077485
     C           QFAMT1    IFNE *ZEROS                     B3             077485
     C                     MOVE ' Part Cl'DDFOLY                          S71062
     C                     ELSE                            X3             077485
     C                     MOVE ' Closed 'DDFOLY                          077485
     C                     END                             E3             077485
     C*                                                                   077485
     C                     ELSE                            X2             S71062
     C                     MOVE ' Open   'DDFOLY                          S71062
     C                     END                             E2             S71062
     C****                                                         S71062 076371
     C***MARKET VALUE                                              S71062 076371
     C****                                                         S71062 076371
     C****       QFMVPC    IFNE *ZEROS                     B2      S71062 076371
     C****                 Z-ADDQFMVPC    ZFLD15                   S71062 076371
     C****                 Z-ADDQFCDP1    ZDECS                    S71062 076371
     C****                 EXSR ZSEDIT                             S71062 076371
     C****                 MOVE ZOUT21    DDMVIC                   S71062 076371
     C****                 ELSE                            X2      S71062 076371
     C****                 MOVEL*BLANKS   DDMVIC                   S71062 076371
     C****                 END                             E2      S71062 076371
     C*                                                                   S71062
     C** ACCESS INTYPD TO RETRIEVE TICKS DENOMINATOR AND MINIMUM PRICE    S71062
     C** FLUCTUATION TO DISPLAY MARKET AND BOOK PRICE                     S71062
     C*                                                                   S71062
     C           QFFOIS    CHAININTYP                73                   S71062
     C           *IN73     IFEQ '1'                        ***************S71062
     C                     MOVEL'INTYP'   QMFILE           ** DB ERROR 02 S71062
     C                     MOVELQFFOIS    QMKEY            ***************S71062
     C                     Z-ADD2         QMERRN                          S71062
     C                     EXSR *PSSR                                     S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C** MARKET PRICE                                                     S71062
     C*                                                                   S71062
     C           QFMPRC    IFNE *ZEROS                     B2             S71062
     C                     Z-ADDQFMPRC    FFPRIC                          S71062
     C                     Z-ADDTKDM      FFTKDM                          S71062
     C                     Z-ADDMNPF      FFMNPF                          S71062
     C                     EXSR FFPRCS                                    S71062
     C***********          MOVELFFSPRC    DDMKTP                    S71062CFF004
      ** Ouput of FFSPRC now 16 long therefore move in most significant   CFF004
      ** part of FFSPRC.                                                  CFF004
      ** Determine number of leading and trailing blanks.                 CFF004
     C           ' '       CHECKFFSPRC    @L      20                      CFF004
     C           ' '       CHEKRFFSPRC    @R      20                      CFF004
      *                                                                   CFF004
      ** Check if trailing zeroes required (as determined by MNPF).       CFF004
     C           TKDM      IFEQ 100                                       CFF004
     C                     MOVE MNPF      TMPMNP 15                       CFF004
     C           '1'       CHECKTMPMNP    @NDP    20                      CFF004
     C           @NDP      IFGT @R                                        CFF004
     C                     Z-ADD@NDP      @R                              CFF004
     C                     ENDIF                                          CFF004
      *                                                                   CFF004
     C                     ENDIF                                          CFF004
      *                                                                   CFF004
      ** Determine number of characters to extract.                       CFF004
     C           @R        SUB  @L        RSUBL   20                      CFF004
     C                     ADD  1         RSUBL                           CFF004
      ** Extract relevant characters.                                     CFF004
     C           RSUBL     SUBSTFFSPRC:@L DDMKTP    P                     CFF004
     C                     ELSE                            X2             S71062
     C                     MOVEL*BLANKS   DDMKTP                          S71062
     C                     END                             E2             S71062
     C*                                                                   S71062
     C** BOOK PRICE                                                       S71062
     C*                                                                   S71062
     C           QFBOPR    IFNE *ZEROS                     B2             S71062
     C                     Z-ADDQFBOPR    FFPRIC                          S71062
     C                     Z-ADDTKDM      FFTKDM                          S71062
     C                     Z-ADDMNPF      FFMNPF                          S71062
     C                     EXSR FFPRCS                                    S71062
     C***********          MOVELFFSPRC    DDFOPR                    S71062CFF004
      ** Ouput of FFSPRC now 16 long therefore move in most significant   CFF004
      ** part of FFSPRC.                                                  CFF004
      ** Determine number of leading and trailing blanks.                 CFF004
     C           ' '       CHECKFFSPRC    @L      20                      CFF004
     C           ' '       CHEKRFFSPRC    @R      20                      CFF004
      *                                                                   CFF004
      ** Check if trailing zeroes required (as determined before by MNPF).CFF004
     C           TKDM      IFEQ 100                                       CFF004
     C           @NDP      ANDGT@R                                        CFF004
     C                     Z-ADD@NDP      @R                              CFF004
     C                     ENDIF                                          CFF004
      *                                                                   CFF004
      ** Determine number of characters to extract.                       CFF004
     C           @R        SUB  @L        RSUBL   20                      CFF004
     C                     ADD  1         RSUBL                           CFF004
      ** Extract relevant characters.                                     CFF004
     C           RSUBL     SUBSTFFSPRC:@L DDFOPR    P                     CFF004
     C                     ELSE                            X2             S71062
     C                     MOVEL*BLANKS   DDFOPR                          S71062
     C                     END                             E2             S71062
     C*                                                                   S71062
     C** PROFIT AND LOSS MARKET                                           S71062
     C*                                                                   S71062
     C           QFPLMK    IFNE *ZEROS                     B2             S71062
     C                     Z-ADDQFPLMK    ZFLD15                          S71062
     C****                 Z-ADDQFCDP2    ZDECS                    S71062 076371
     C                     Z-ADDQMPCDP    ZDECS                           076371
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    DDMTPL                          S71062
     C                     ELSE                            X2             S71062
     C                     MOVEL*BLANKS   DDMTPL                          S71062
     C                     END                             E2             S71062
     C*                                                                   S71062
     C** PROFIT AND LOSS MARKET FX                                        S71062
     C*                                                                   S71062
     C           QFPLFX    IFNE *ZEROS                     B2             S71062
     C                     Z-ADDQFPLFX    ZFLD15                          S71062
     C****                 Z-ADDQFCDP2    ZDECS                    S71062 076371
     C                     Z-ADDQMPCDP    ZDECS                           076371
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    DDEXPL                          S71062
     C                     ELSE                            X2             S71062
     C                     MOVEL*BLANKS   DDEXPL                          S71062
     C                     END                             E2             S71062
     C*                                                                   S71062
     C** DISPLAY ACCRUED INTEREST                                         S71062
     C**                                                                  S71062
     C           QFACIS    IFNE *ZEROS                     B2             S71062
     C                     Z-ADDQFACIS    ZFLD15                          S71062
     C                     Z-ADDQFCDP2    ZDECS                           S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    DDAIPC                          S71062
     C                     ELSE                            X2             S71062
     C                     MOVEL*BLANKS   DDAIPC                          S71062
     C                     END                             E2             S71062
     C*                                                                   S71062
     C                     END                             E1             S71062
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1006   - DISPLAY CUSTOMER GLOBAL POSITION                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P1007   - LOAD SUBFILE WITH PORTFOLIO & GLOBAL POSITION         *
      * #U1001   - FILL SUBFILE HEADER                                   *
      * #V1001   - VALIDATE SUBFILE ENTRIES                              *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1001   - PROCESS PM HOLDINGS SCREEN                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWDISP   - DISPLAY INDICATOR                                     *
      * WWINTV   - INTERIM TRADE/VALUE INDICATOR                         *
      *                                                                  *
      ********************************************************************
     C           #P1006    BEGSR
     C**
     C** LOAD SUBFILE WITH PORTFOLIO & GLOBAL POSITION
     C**
     C                     MOVEL'Y'       WWGLOB  1
     C                     EXSR #P1007
     C                     MOVEL'N'       WWGLOB
     C**
     C** DO UNTIL CMD3 OR F12 ENTERED
     C**
     C************INKC     DOUEQ'1'                        B1             081239
     C************INKL     OREQ '1'                                       081239
     C           QMENQT    DOUEQ'Y'                                       081239
     C           QMENQT    OREQ 'C'                                       081239
     C           QMENQT    OREQ 'P'                                       081239
     C           QMENQT    OREQ 'D'                                       081239
     C           *INKL     OREQ '1'                                       081239
     C**
     C**
     C** IF THE SCREEN DISPLAY INDICATOR IS '1'
     C**
     C           WWDISP    IFEQ '1'                        B2
     C**
     C** FORMAT SUBFILE
     C**
     C                     EXSR #U1001
     C                     MOVE '1'       *IN53                           CPM005
     C                     WRITEPM0700F4
     C                     WRITEPM0700F1
     C                     EXFMTPM0700C3
     C                     ELSE                            X2
     C**
     C** FORMAT SUBFILE
     C**
     C                     EXSR #U1001
     C                     MOVE '0'       *IN53                           CPM005
     C                     WRITEPM0700F4
     C                     WRITEPM0700F1
     C                     EXFMTPM0700C4
     C                     END                             E2
     C**
     C** SET SCREEN INDICATOR ON
     C**
     C                     MOVE '0'       *IN80
     C*                                                                   081239
     C** If F3  pressed, exit program                                     081239
     C*                                                                   081239
     C           *INKC     IFEQ '1'                                       081239
     C                     MOVE 'Y'       QMENQT                          081239
     C                     CALL 'PMC1001'                                 081239
     C                     PARM           WWLDA                           081239
     C                     END                                            081239
     C*                                                                   081239
     C** If F22 pressed, access Enquiry selection screen                  081239
     C*                                                                   081239
     C           *INKW     IFEQ '1'                                       081239
     C                     CALL 'PMC0610'                                 081239
     C*                                                                   081239
     C** Retrieve *LDA values                                             081239
     C*                                                                   081239
     C                     CALL 'PMC1003'                                 081239
     C                     PARM           WWLDA                           081239
     C                     END                                            081239
     C**
     C** IF F11 TAKEN
     C**
     C           *INKK     IFEQ '1'                        B2
     C**
     C           WWDISP    IFEQ '1'                        B3
     C                     MOVEL'2'       WWDISP
     C                     MOVE '1'       *IN54
     C                     ELSE                            X3
     C                     MOVEL'1'       WWDISP
     C                     MOVE '0'       *IN54
     C                     END                             E3
     C**
     C                     END                             E2
     C**
     C                     END                             E1
     C**
     C                     MOVE '0'       *INKL
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1007   - LOAD SUBFILE WITH PORTFOLIO & GLOBAL POSITION         *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P1004   - FORMAT 'SE' HOLDINGS FOR OUTPUT TO SUBFILE            *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1006   - DISPLAY CUSTOMER GLOBAL POSITION                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWINTV   - INTERIM TRADE/VALUE INDICATOR                         *
      * WWPTFR   - PORTFOLIO REFERENCE                                   *
      *                                                                  *
      ********************************************************************
     C           #P1007    BEGSR
     C**
     C                     MOVE '1'       *IN61
     C                     WRITEPM0700C3
     C                     WRITEPM0700C4
     C                     MOVE '0'       *IN61
     C                     Z-ADD0         RRN3    40
     C                     Z-ADD0         RRN4    40
     C**
     C                     MOVE WWCNUM    WWCNM1
     C                     MOVE DDSHOR    WWTDS1
     C                     MOVE DDTVDH    WWTVD1
     C                     MOVE *LOVAL    WWPTF1
     C*
     C*  READ ALL HOLDINGS FOR THIS SECURITY,CUSTOMER & TRADE/VALUE BASIS
     C*
     C           PMHOL6    SETLLPMHOLDL6
     C**
     C                     READ PMHOLDL6                 75
     C**
     C           QFTDSS    DOWEQWWTDS1
     C           QFCNUM    ANDEQWWCNM1
     C           QFTVDA    ANDEQWWTVD1
     C           *IN75     ANDEQ'0'
     C**
     C** WRITE TO SUBFILE IF NORMAL PORTFOLIO HOLDING
     C**
     C           QFPTFR    IFNE '9998'
     C           QFPTFR    ANDNE'9999'
     C           QFRECI    IFEQ 'D'
     C           QFRECI    ORNE 'D'
     C           WWMAFF    ANDEQ'M'
     C*
     C** ACCESS PORTFOLIO DETAILS TO OBTAIN CURRENCY
     C           QFPTFR    IFNE '9997'
     C********** KLPORT    CHAINPMPORTPP             73                   S01486
     C           KLPORT    CHAINPMPORTPD             73                   S01486
     C*
     C           *IN73     IFEQ '1'
     C                     EXSR *PSSR
     C                     END
     C*
     C                     MOVE PNPTCY    QMPTCY  3
     C                     Z-ADDPNPCDP    QMPCDP  10
     C                     ELSE
     C                     MOVE QMCSBY    QMPTCY  3
     C                     Z-ADDQMBYDP    QMPCDP  10
     C                     END
     C*
     C                     EXSR #P1004
     C*                                                                   CPM005
     C** REFORMAT DETAILS RECEIVED FROM #P1004                            CPM005
     C                     MOVE DDNOM1    DDNOMA                          CPM005
     C                     MOVE DDNOM2    DDNOMB                          CPM005
     C***                                                                 CPM005
     C           DDNOM2    IFNE *BLANKS                                   CPM005
     C                     MOVEL'('       DDNOMB                          CPM005
     C                     END                                            CPM005
     C***
     C                     ADD  1         RRN3
     C                     ADD  1         RRN4
     C                     WRITEPM0700S3
     C                     WRITEPM0700S4
     C                     END
     C                     END
     C**
     C                     READ PMHOLDL6                 75
     C**
     C                     END
     C*                                                                   59468
     C** IF NO DETAILS WRITTEN TO SUBFILE OUTPUT TEXT 'NO OPEN            59468
     C** POSITIONS'                                                       59468
     C           RRN3      IFEQ 0                                         59468
     C           RRN4      ANDEQ0                                         59468
     C                     MOVE *BLANKS   DDPTFR                          59468
     C                     MOVE *BLANKS   DDNOMA                          59468
     C                     MOVE *BLANKS   DDNARR                          59468
     C                     MOVE *BLANKS   DDDET2                          S71062
     C                     MOVE *BLANKS   DDMKTP                          59468
     C                     MOVE *BLANKS   DDMFXR                          59468
     C                     MOVE *BLANKS   DDMVPC                          59468
     C                     MOVE *BLANKS   DDPTCY                          59468
     C                     MOVE *BLANKS   DDNOMB                          59468
     C                     MOVE *BLANKS   DDDETA                          59468
     C                     MOVE *BLANKS   DDDET2                          S71062
     C                     MOVE *BLANKS   DDFOPR                          59468
     C                     MOVE *BLANKS   DDFFXR                          59468
     C                     MOVE *BLANKS   DDAIPC                          59468
     C                     MOVE *BLANKS   DDNARR                          59468
     C                     MOVE *BLANKS   DDSECU                          59468
     C                     MOVE *BLANKS   DDAMEU                          S71062
     C                     MOVE *BLANKS   DDMVIC                          59468
     C                     MOVE *BLANKS   DDMKT1                          59468
     C                     MOVE *BLANKS   DDMTPL                          59468
     C                     MOVE *BLANKS   DDPTCY                          59468
     C                     MOVE *BLANKS   DDDETA                          59468
     C                     MOVE *BLANKS   DDAIIC                          59468
     C                     MOVE *BLANKS   DDFOL1                          59468
     C                     MOVE *BLANKS   DDEXPL                          59468
     C                     MOVE *BLANKS   DDTOG1                          CPM005
     C                     MOVE *BLANKS   DDTOG2                          CPM005
     C                     MOVE 'NO OPEN' DDMKTP                          59468
     C                     MOVEL'POSITION'DDMFXR                          59468
     C                     MOVE 'S'       DDMFXR                          59468
     C                     MOVE 'NO OPEN' DDMVIC                          59468
     C                     MOVEL'POSITION'DDMKT1                          59468
     C                     MOVE 'S '      DDMKT1                          59468
     C                     ADD  1         RRN3    40                      59468
     C                     ADD  1         RRN4    40                      59468
     C                     WRITEPM0700S3                                  59468
     C                     WRITEPM0700S4                                  59468
     C                     END                                            59468
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1008   - DISPLAY INSTRUMENT DETAILS OF A HOLDING               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * PM2000   - DEAL DETAILS                                          *
      * PM2010   - LOAN DETAILS                                          *
      * PM2020   - SECURITY DETAILS                                      *
      * PM2030   - F&O INSTRUMENT DETAILS                                *
      * PM2040   - RETAIL ACCOUNT DETAILS                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1001   - PROCESS PM HOLDINGS SCREEN                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1008    BEGSR
     C**
     C** MODULE ID 'DL'
     C**
     C****       DDMODH    IFEQ 'DL'                                      S01313
     C           DDMODH    IFEQ 'MD'                                      S01313
     C           DDMODH    OREQ 'ML'                                      S01313
     C           DDMODH    OREQ 'DL'                                      50560
     C           DDMODH    OREQ 'FR'                                      S01313
     C           DDMODH    OREQ 'FX'                                      S01313
     C**
     C** CALL PROGRAM 'PM2000' - DEAL DETAILS
     C**
     C           DDSHOR    IFEQ *BLANKS                                   CPM005
     C                     CALL 'PM2000'
     C                     PARM           DDTRNH
     C                     ELSE                                           CPM005
     C                     CALL 'PM2060'                                  CPM005
     C                     PARM           WWRETC  1                       CPM005
     C                     PARM           DDTRNH                          CPM005
     C                     END                                            CPM005
     C**
     C                     END
     C**
     C** MODULE ID 'LE'
     C**
     C           DDMODH    IFEQ 'LE'
     C**
     C** CALL PROGRAM 'PM2010' - LOANS DETAILS
     C**
     C                     CALL 'PM2010'
     C                     PARM           DDTRNH
     C**
     C                     END
     C**
     C** MODULE ID 'SE'
     C**
     C           DDMODH    IFEQ 'SE'
     C**
     C** CALL PROGRAM 'PM2020' - SECURITY DETAILS
     C**
     C                     CALL 'PM2020'
     C                     PARM           DDSHOR
     C**
     C                     END
     C**
     C** MODULE ID 'FF'
     C**
     C           DDMODH    IFEQ 'FF'
     C**
     C** CALL PROGRAM 'PM2030' - F&O INSTRUMENT DETAILS
     C**
     C                     CALL 'PM2030'
     C                     PARM           DDFOIH
     C**
     C                     END
     C**
     C** MODULE ID 'RE'
     C**
     C           DDMODH    IFEQ 'RE'
     C**
     C** CALL PROGRAM 'PM2040' - RETAIL ACCOUNT DETAILS
     C**
     C                     CALL 'PM2040'
     C                     PARM           DDCNUM                          CPM004
     C                     PARM           DDCCYH
     C                     PARM           DDACOH
     C                     PARM           DDACSH
     C                     PARM           DDBRCH                          085862
     C**
     C                     END
     C**
     C** MODULE ID 'LB'
     C**
     C           DDMODH    IFEQ 'LB'
     C**
     C** CALL PROGRAM 'PM2130' - LOMBARD DETAILS
     C**
     C*                                                                   32134
     C* RETRIEVE TYPE OF GUARANTEE TO PASSED PM2130                       32134
     C*                                                                   32134
     C                     EXSR LBTYP                                     32134
     C*                                                                   32134
     C                     Z-ADD0         PL                              057400
     C                     Z-ADDRRN1      PL                              057400
     C                     MOVE ORD,PL    DDORDN                          057400
     C*                                                                   057400
     C                     CALL 'PM2130'
     C                     PARM           DDTRNH
     C                     PARM           TYPE                            32134
     C                     PARM           DDORDN                          57400
     C**
     C                     END
     C**
     C** MODULE ID 'FD'
     C**
     C****       DDMODH    IFEQ 'FD'                                      S01313
     C           DDMODH    IFEQ 'FI'                                      S01313
     C**
     C** CALL PROGRAM 'PM2140' - FI DEPOSIT DETAILS
     C**
     C                     CALL 'PM2140'
     C                     PARM           DDTRNH
     C**
     C                     END
     C****                                                                S01313
     C****ODULE ID 'FL'                                                   S01313
     C****                                                                S01313
     C****       DDMODH    IFEQ 'FL'                                      S01313
     C****                                                                S01313
     C****ALL PROGRAM 'PM2150' - FI LOAN DETAILS                          S01313
     C****                                                                S01313
     C****                 CALL 'PM2150'                                  S01313
     C****                 PARM           DDTRNH                          S01313
     C****                                                                S01313
     C****                 END                                            S01313
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1009   - DISPLAY TRANSACTION DETAILS OF A HOLDING              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * PM2050   - PORTFOLIO MOVEMENTS (SE)                              *
      * PM2055   - PORTFOLIO MOVEMENTS (SE)                              *CPM004
      * PM2070   - DEAL AMENDMENTS PER DEAL                              *
      * PM2080   - LOAN AMENDMENTS PER LOAN                              *
      * PM2090   - F&O TRANSACTION DETAILS                               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1001   - PROCESS PM HOLDINGS SCREEN                            *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1009    BEGSR
     C**
     C** MODULE ID 'SE'
     C**
     C           DDMODH    IFEQ 'SE'
     C**                                                                  CPM004
     C** IF NOT BANK PORTFOLIOS                                           CPM004
     C**                                                                  CPM004
     C           QMPORS    IFNE 'B'                                       CPM004
     C**
     C** CALL PROGRAM 'PM2050' - PORTFOLIO MOVEMENTS (SE)
     C**
     C                     CALL 'PM2050'
     C                     PARM           DDSHOR
     C                     PARM           WWINTV
     C**********           PARM           P9R997                    R0875 S01486
     C                     PARM           FCR997                          S01486
     C**                                                                  CPM004
     C                     ELSE                                           CPM004
     C**                                                                  CPM004
     C** CALL PROGRAM 'PM2055' - PORTFOLIO MOVEMENTS (SE)                 CPM004
     C**                                                                  CPM004
     C                     CALL 'PM2055'                                  CPM004
     C                     PARM           DDSHOR                          CPM004
     C                     PARM           QMBRCA                          CPM004
     C                     PARM           QMBOKC                          CPM004
     C                     PARM           WWMRKT  1                       CPM004
     C                     PARM           WWINTV                          CPM004
     C**                                                                  CPM004
     C                     END                                            CPM004
     C**
     C                     END
     C**
     C** MODULE ID 'DL'
     C**
     C****       DDMODH    IFEQ 'DL'                                      S01313
     C           DDMODH    IFEQ 'MD'                                      S01313
     C           DDMODH    OREQ 'DL'                               S01313 50560
     C           DDMODH    OREQ 'ML'                                      S01313
     C           DDMODH    OREQ 'FR'                                      S01313
     C           DDMODH    OREQ 'FX'                                      S01313
     C**
     C** CALL PROGRAM 'PM2070' - DEAL AMENDMENT PER DEAL
     C**
     C                     CALL 'PM2070'
     C                     PARM           DDTRNH
     C**
     C                     END
     C**
     C** MODULE ID 'LE'
     C**
     C           DDMODH    IFEQ 'LE'
     C**
     C** CALL PROGRAM 'PM2080' - LOAN AMENDMENTS PER LOAN
     C**
     C                     CALL 'PM2080'
     C                     PARM           DDTRNH
     C**
     C                     END
     C**
     C** MODULE ID 'FF'
     C**
     C           DDMODH    IFEQ 'FF'
     C**
     C** CALL PROGRAM 'PM2090' - F&O TRANSACTION DETAILS
     C**
     C                     CALL 'PM2090'
     C                     PARM           DDTRNH
     C                     PARM           DDSIGH                          S71062
     C**
     C                     END
     C**
     C** MODULE ID 'RE'
     C**
     C           DDMODH    IFEQ 'RE'
     C**
     C** CALL PROGRAM 'PM2090' - F&O TRANSACTION DETAILS
     C**
     C                     CALL 'PM2120'
     C                     PARM           DDCNUM                          CPM004
     C                     PARM           DDCCYH
     C                     PARM           DDACOH
     C                     PARM           DDACSH
     C                     PARM           DDBRCH                          085862
     C**
     C                     END
     C**
     C** MODULE ID 'FD'
     C**
     C****       DDMODH    IFEQ 'FD'                                      S01313
     C           DDMODH    IFEQ 'FI'                                      S01313
     C**
     C** CALL PROGRAM 'PM2160' - FI DEPOSIT AMENDMENTS PER DEPOSIT
     C**
     C                     CALL 'PM2160'
     C                     PARM           DDTRNH
     C**
     C                     END
     C****                                                                S01313
     C****ODULE ID 'FL'                                                   S01313
     C****                                                                S01313
     C****       DDMODH    IFEQ 'FL'                                      S01313
     C****                                                                S01313
     C****ALL PROGRAM 'PM2170' - FI LOAN AMENDMENTS PER LOAN              S01313
     C****                                                                S01313
     C****                 CALL 'PM2170'                                  S01313
     C****                 PARM           DDTRNH                          S01313
     C****                                                                S01313
     C****                 END                                            S01313
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P1010   - PLEDGES DETAILS                                       *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #P1010    BEGSR
     C**
     C*                                                                   32134
     C* RETRIEVE TYPE OF GUARANTEE TO PASSED PM2130                       32134
     C*                                                                   32134
     C                     EXSR LBTYP                                     32134
     C*                                                                   32134
     C                     Z-ADD0         PL                              57400
     C                     Z-ADDRRN1      PL                              57400
     C                     MOVE ORD,PL    DDORDN                          57400
     C                     CALL 'PM2130'
     C                     PARM           DDTRNH
     C                     PARM           TYPE                            32134
     C                     PARM           DDORDN                          57400
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************CPM005
      ************                                                       *CPM005
      **#P1011***- SET UP ARRAYS OF VALUE DATE PAGE HEADINGS             *CPM005
      ************                                                       *CPM005
      **SUBROUTINE CALLS:                                                *CPM005
      ************                                                       *CPM005
      **SUBROUTINE CALLED FROM:                                          *CPM005
      ************                                                       *CPM005
      **ROUTINE*USES VARIABLES:                                          *CPM005
      ************                                                       *CPM005
      ********************************************************************CPM005
     C***********#P1011    BEGSR                                          CPM005
     C***********                                                         CPM005
     C***********          MOVE QMCNUM    QFCNUM                          CPM005
     C***********          MOVE QMPTF1    QFPTFR                          CPM005
     C***********          Z-ADDQMDSPS    QFDSPS                          CPM005
     C***********          MOVE QMDSPG    QFDSPG                          CPM005
     C***********          Z-ADDQMITDS    QFITDS                          CPM005
     C***********          MOVE QMINNR    QFINNR                          CPM005
     C***********          MOVE *LOVAL    QFMODI                          CPM005
     C***********          MOVE *LOVAL    QFRECI                          CPM005
     C***********          MOVE *LOVAL    QFTDSS                          CPM005
     C***********          MOVE *LOVAL    QFTRNB                          CPM005
     C***********          MOVE *LOVAL    QFDLSQ                    S01313CPM005
     C***********          MOVE *LOVAL    QFCCY1                    S01313CPM005
     C***********          MOVE *LOVAL    QFTXT2                    S01313CPM005
     C***********          Z-ADD0         I       50                      CPM005
     C***********          Z-ADD0         J       50                      CPM005
     C****                 MOVE QMDSPG    WWDSPO  3                       59481
     C****                 MOVE QMINNR    WWINNO  3                       59481
     C***********                                                         CPM005
     C***SET*FILE POINTER TO FIRST RECORD FOR PORTFOLIO AND READ RECORD   CPM005
     C****       PMHOLD    SETLLPMHOLDL2                                  B08253
     C****                 READ PMHOLDL2                 72               B08253
     C***********PMHOLD    SETLLPMHOLDL5                            B08253CPM005
     C***********          READ PMHOLDL5                 72         B08253CPM005
     C***********                                                         CPM005
     C***SAVE*DISPLAY GROUP AND INSTRUMENT TYPE READ                      CPM005
     C******************** Z-ADD7         K       50                      080700
     C******************** Z-ADD7         L       50                      080700
     C***********          Z-ADD6         K       50                080700CPM005
     C***********          Z-ADD6         L       50                080700CPM005
     C***********                                                         CPM005
     C************IN72     DOWEQ'0'                        B1             CPM005
     C***********QFCNUM    ANDEQQMCNUM                                    CPM005
     C***********QFPTFR    ANDEQQMPTF1                                    CPM005
     C****       QFDSPG    ANDEQWWDSPO                                    59481
     C****       QFINNR    ANDEQWWINNO                                    59481
     C***********QFDSPG    ANDEQQMDSPG                               59481CPM005
     C***********QFINNR    ANDEQQMINNR                               59481CPM005
     C***********                                                         CPM005
     C***********QFRECI    IFEQ 'D'                        B2             CPM005
     C***********                                                         CPM005
     C***FOR*EACH SET OF DETAILS TO BE OUTPUT ADD 1 TO K AND SET TYPE TO 'CPM005
     C***********          ADD  1         K                               CPM005
     C****                 MOVE 'T'       WWDETT                          59481
     C***********          MOVE 'V'       WWDETT                     59481CPM005
     C***********                                                         CPM005
     C***IF*K*EQUAL TO EIGHT WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C***TO*ARRAY                                                         CPM005
     C********** K         IFEQ 8                          B3             080700
     C***********K         IFEQ 7                          B3       080700CPM005
     C***********          ADD  1         I                               CPM005
     C***********          MOVE WWPAGE    VDD,I                           CPM005
     C***********          Z-ADD1         K                               CPM005
     C***********          END                             E3             CPM005
     C***********          END                             E2             CPM005
     C***********                                                         CPM005
     C***FOR*EACH SET OF DETAILS TO BE OUTPUT ADD 1 TO K AND SET TYPE TO 'CPM005
     C***********          ADD  1         L                               CPM005
     C******************** MOVE 'T'       WWDETT  1                       080700
     C***********          MOVE 'V'       WWDETT  1                 080700CPM005
     C***********                                                         CPM005
     C***IF*K*EQUAL TO EIGHT WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C***TO*ARRAY                                                         CPM005
     C********** L         IFEQ 8                          B2             080700
     C***********L         IFEQ 7                          B2       080700CPM005
     C***********          ADD  1         J                               CPM005
     C****                 MOVE WWPAGE    VDM,J                           B08253
     C***********          Z-ADD1         L                               CPM005
     C***********          END                             E2             CPM005
     C***********                                                         CPM005
     C***READ*NEXT HOLDING RECORD                                         CPM005
     C****                 READ PMHOLDL2                 72               B08253
     C***********          READ PMHOLDL5                 72         B08253CPM005
     C***********          END                             E1             CPM005
     C***********                                                         CPM005
     C***SAVE*NUMBER OF PAGES OF LIVE AND MATURED HOLDINGS                CPM005
     C***********          Z-ADDI         WWVLLV  50                      CPM005
     C***********          Z-ADDJ         WWVLFL  50                      CPM005
     C***********                                                         CPM005
     C***********          ENDSR                                          CPM005
      ********************************************************************CPM005
      /EJECT
      ********************************************************************
      *                                                                  *
      **#P1012***-*SET*UP*ARRAYS*OF*TRADE*DATE*PAGE*HEADINGS             *CPM005
      * #P102I   - SET UP ARRAYS OF TRADE DATE PAGE HEADINGS             *CPM005
      *            (TOTAL TYPE 'I' - INSTRUMENT)                         *CPM005
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C***********#P1012    BEGSR                                          CPM005
     C           #P102I    BEGSR                                          CPM005
     C*
     C                     MOVE QMCNUM    QFCNUM
     C                     MOVE QMPTF1    QFPTFR
     C                     MOVE QMPOTY    QFPOST                          CPM005
     C                     Z-ADDQMDSPS    QFDSPS
     C                     MOVE QMDSPG    QFDSPG
     C                     Z-ADDQMITDS    QFITDS
     C                     MOVE QMINNR    QFINNR
     C                     MOVE *LOVAL    QFMODI
     C                     MOVE *LOVAL    QFRECI
     C                     MOVE *LOVAL    QFTDSS
     C                     MOVE *LOVAL    QFTRNB
     C******               MOVE *LOVAL    QFDLSQ                    S01313CPM005
     C******               MOVE *LOVAL    QFCCY1                    S01313CPM005
     C                     MOVE *LOVAL    QFPOSQ                          CPM005
     C                     MOVE *LOVAL    QFTXT2                          S01313
     C                     Z-ADD0         I       50
     C                     Z-ADD0         J       50
     C****                 MOVE QMDSPG    WWDSPO  3                       59481
     C****                 MOVE QMINNR    WWINNO  3                       59481
     C                     MOVE *BLANKS   WWDSPO  3                       CPM005
     C                     MOVE *BLANKS   WWINNO  3                       CPM005
     C*
     C** SET FILE POINTER TO FIRST RECORD FOR PORTFOLIO AND READ RECORD
     C****       PMHOLD    SETLLPMHOLDL1                                  B08253
     C****                 READ PMHOLDL1                 72               B08253
     C***********PMHOLD    SETLLPMHOLDL4                            B08253CPM005
     C***********          READ PMHOLDL4                 72         B08253CPM005
     C           PMHOLA    SETLLPMHOLDLA                                  CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDEQ*BLANKS                                   CPM005
     C           *IN72     OREQ '0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDNE*BLANKS                                   CPM005
     C           QFBYSF    ANDEQ'S'                                       CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C                     END                                            CPM005
     C**
     C** SAVE DISPLAY GROUP AND INSTRUMENT TYPE READ
     C******************** Z-ADD7         K       50                      080700
     C******************** Z-ADD7         L       50                      080700
     C                     Z-ADD6         K       50                      080700
     C                     Z-ADD6         L       50                      080700
     C                     Z-ADD0         XRRN    50                      160217
     C**********           Z-ADD0         XFCNUM  60                                   160217 CSD027
     C                     MOVE *BLANKS   XFCNUM  6                                           CSD027
     C                     MOVEL*BLANKS   XFPTFR  4                       160217
     C                     Z-ADD0         XFDSPS  20                      160217
     C                     MOVEL*BLANKS   XFDSPG  3                       160217
     C                     Z-ADD0         XFITDS  20                      160217
     C                     MOVEL*BLANKS   XFINNR  3                       160217
     C                     MOVEL*BLANKS   XFPOSQ 11                       160217
     C                     MOVEL*BLANKS   XFTDSS 10                       160217
     C**********           MOVEL*BLANKS   XFTRNB  60                                   160217 CLE148
     C                     MOVEL*BLANKS   XFTRNB  6                                           CLE148
     C                     MOVEL*BLANKS   XWACCU  60                      160217
     C                     MOVEL*BLANKS   XFTXT2 10                       160217
     C                     MOVEL*BLANKS   XWFFMC  3                       160217
     C                     MOVEL*BLANKS   XWFFMY  5                       160217
     C**
     C           *IN72     DOWEQ'0'                        B1
     C           QFCNUM    ANDEQQMCNUM
     C           QFPTFR    ANDEQQMPTF1
     C****       QFDSPG    ANDEQWWDSPO                                    59481
     C****       QFINNR    ANDEQWWINNO                                    59481
     C           QFDSPG    ANDEQQMDSPG                                    59481
     C           QFINNR    ANDEQQMINNR                                    59481
     C           QFPOST    ANDEQQMPOTY                                    CPM005
     C**
     C           QFRECI    IFEQ 'D'                        B2
     C*                                                                   CPM005
     C           QFCNUM    IFEQ XFCNUM                                    160217
     C           QFPTFR    ANDEQXFPTFR                                    160217
     C           QFDSPS    ANDEQXFDSPS                                    160217
     C           QFDSPG    ANDEQXFDSPG                                    160217
     C           QFITDS    ANDEQXFITDS                                    160217
     C           QFINNR    ANDEQXFINNR                                    160217
     C           QFPOSQ    ANDEQXFPOSQ                                    160217
     C           QFTDSS    ANDEQXFTDSS                                    160217
     C           QFTRNB    ANDEQXFTRNB                                    160217
     C           QFTXT2    ANDEQXFTXT2                                    160217
     C           WWFFMC    ANDEQXWFFMC                                    160217
     C           WWFFMY    ANDEQXWFFMY                                    160217
     C                     ADD  1         XRRN                            160217
     C                     ELSE                                           160217
     C                     Z-ADD0         XRRN                            160217
     C                     END                                            160217
     C**********           Z-ADDQFCNUM    XFCNUM                                       160217 CSD027
     C                     MOVE QFCNUM    XFCNUM                                              CSD027
     C                     MOVELQFPTFR    XFPTFR                          160217
     C                     MOVELQFDSPS    XFDSPS                          160217
     C                     MOVELQFDSPG    XFDSPG                          160217
     C                     Z-ADDQFITDS    XFITDS                          160217
     C                     MOVELQFINNR    XFINNR                          160217
     C                     MOVELQFPOSQ    XFPOSQ                          160217
     C                     MOVELQFTDSS    XFTDSS                          160217
     C**********           Z-ADDQFTRNB    XFTRNB                                       160217 CLE148
     C                     MOVELQFTRNB    XFTRNB                                              CLE148
     C                     MOVELQFTXT2    XFTXT2                          160217
     C                     MOVELWWFFMC    XWFFMC                          160217
     C                     MOVELWWFFMY    XWFFMY                          160217
      *                                                                   160217
     C** ON CHANGE OF DISPLAY GROUP ADD 1 TO K AND SET TYPE TO 'D'        CPM005
     C           QFDSPG    IFNE WWDSPO                     B3             CPM005
     C                     MOVE QFDSPG    WWDSPO  3                       CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE 'D'       WWDETT  1                       CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           K         IFEQ 7                          B3             CPM005
     C                     ADD  1         I                               CPM005
     C                     MOVE WWPAGE    TDD,I                           CPM005
     C                     MOVE XRRN      HOAR,I                          160217
     C                     Z-ADD1         K                               CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** ON CHANGE OF INSTRUMENT GROUP ADD 1 TO K AND SET TYPE TO 'I'     CPM005
     C           QFINNR    IFNE WWINNO                     B3             CPM005
     C                     MOVE QFINNR    WWINNO  3                       CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE 'I'       WWDETT  1                       CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           K         IFEQ 7                          E3             CPM005
     C                     ADD  1         I                               CPM005
     C                     MOVE WWPAGE    TDD,I                           CPM005
     C                     MOVE XRRN      HOAR,I                          160217
     C                     Z-ADD1         K                               CPM005
     C                     END                             E3             CPM005
     C*
     C** FOR EACH SET OF DETAILS TO BE OUTPUT ADD 1 TO K AND SET TYPE TO 'T'
     C                     ADD  1         K
     C                     MOVE 'T'       WWDETT  1
     C*
     C** IF K EQUAL TO EIGHT WRITE DETAILS TO APPEAR ON PAGE HEADING
     C** TO ARRAY
     C********** K         IFEQ 8                          B3             080700
     C           K         IFEQ 7                          B3             080700
     C                     ADD  1         I
     C                     MOVE WWPAGE    TDD,I
     C                     MOVE XRRN      HOAR,I                          160217
     C                     Z-ADD1         K
     C                     END                             E3
     C                     END                             E2
     C*
     C** FOR EACH SET OF DETAILS TO BE OUTPUT ADD 1 TO K AND SET TYPE TO 'T'
     C                     ADD  1         L
     C                     MOVE 'T'       WWDETT  1
     C*
     C** IF K EQUAL TO EIGHT WRITE DETAILS TO APPEAR ON PAGE HEADING
     C** TO ARRAY
     C********** L         IFEQ 8                          B2             080700
     C           L         IFEQ 7                          B2             080700
     C                     ADD  1         J
     C****                 MOVE WWPAGE    TDM,J                           B08253
     C                     Z-ADD1         L
     C                     END                             E2
     C*
     C** READ NEXT HOLDING RECORD
     C****                 READ PMHOLDL1                 72               B08253
     C*******              READ PMHOLDL4                 72         B08253CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C*                                                                   CPM005
     C** READ RECORDS UNTIL NEXT NON-NOTIONAL POSITION FOUND              CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDEQ*BLANKS                                   CPM005
     C           *IN72     OREQ '0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDNE*BLANKS                                   CPM005
     C           QFBYSF    ANDEQ'S'                                       CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C                     END                                            CPM005
     C                     END                             E1
     C*
     C** SAVE NUMBER OF PAGES OF LIVE AND MATURED HOLDINGS
     C                     Z-ADDI         WWTDLV  50
     C                     Z-ADDJ         WWTDFL  50
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************CPM005
      *                                                                  *CPM005
      * #P102D   - SET UP ARRAYS OF TRADE DATE PAGE HEADINGS             *CPM005
      *            (TOTAL TYPE 'D' - DISPLAY GROUP)                      *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLS:                                                *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLED FROM:                                          *CPM005
      *                                                                  *CPM005
      * ROUTINE USES VARIABLES:                                          *CPM005
      *                                                                  *CPM005
      ********************************************************************CPM005
     C           #P102D    BEGSR                                          CPM005
     C*                                                                   CPM005
     C                     MOVE QMCNUM    QFCNUM                          CPM005
     C                     MOVE QMPTF1    QFPTFR                          CPM005
     C                     MOVE QMPOTY    QFPOST                          CPM005
     C                     Z-ADDQMDSPS    QFDSPS                          CPM005
     C                     MOVE QMDSPG    QFDSPG                          CPM005
     C                     Z-ADD*ZEROS    QFITDS                          CPM005
     C                     MOVE *BLANKS   QFINNR                          CPM005
     C                     MOVE *LOVAL    QFMODI                          CPM005
     C                     MOVE *LOVAL    QFRECI                          CPM005
     C                     MOVE *LOVAL    QFTDSS                          CPM005
     C                     MOVE *LOVAL    QFTRNB                          CPM005
     C                     MOVE *LOVAL    QFPOSQ                          CPM005
     C                     MOVE *LOVAL    QFTXT2                          CPM005
     C                     Z-ADD0         I       50                      CPM005
     C                     Z-ADD0         J       50                      CPM005
     C                     MOVE *BLANKS   WWINNO  3                       CPM005
     C                     Z-ADD0         XRRN    50                      160217
     C**********           Z-ADD0         XFCNUM  60                                   160217 CSD027
     C                     MOVE *BLANKS   XFCNUM  6                                           CSD027
     C                     MOVEL*BLANKS   XFPTFR  4                       160217
     C                     Z-ADD0         XFDSPS  20                      160217
     C                     MOVEL*BLANKS   XFDSPG  3                       160217
     C                     Z-ADD0         XFITDS  20                      160217
     C                     MOVEL*BLANKS   XFINNR  3                       160217
     C                     MOVEL*BLANKS   XFPOSQ 11                       160217
     C                     MOVEL*BLANKS   XFTDSS 10                       160217
     C**********           MOVEL*BLANKS   XFTRNB  60                                   160217 CLE148
     C                     MOVEL*BLANKS   XFTRNB  6                                           CLE148
     C                     MOVEL*BLANKS   XWACCU  60                      160217
     C                     MOVEL*BLANKS   XFTXT2 10                       160217
     C                     MOVEL*BLANKS   XWFFMC  3                       160217
     C                     MOVEL*BLANKS   XWFFMY  5                       160217
     C*                                                                   CPM005
     C** SET FILE POINTER TO FIRST RECORD FOR PORTFOLIO AND READ RECORD   CPM005
     C           PMHOLA    SETLLPMHOLDLA                                  CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDEQ*BLANKS                                   CPM005
     C           *IN72     OREQ '0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDNE*BLANKS                                   CPM005
     C           QFBYSF    ANDEQ'S'                                       CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** SAVE DISPLAY GROUP AND INSTRUMENT TYPE READ                      CPM005
     C                     Z-ADD6         K       50                      CPM005
     C                     Z-ADD6         L       50                      CPM005
     C**                                                                  CPM005
     C           *IN72     DOWEQ'0'                        B1             CPM005
     C           QFCNUM    ANDEQQMCNUM                                    CPM005
     C           QFPTFR    ANDEQQMPTF1                                    CPM005
     C           QFDSPG    ANDEQQMDSPG                                    CPM005
     C           QFPOST    ANDEQQMPOTY                                    CPM005
     C**                                                                  CPM005
     C           QFRECI    IFEQ 'D'                        B2             CPM005
     C*                                                                   CPM005
     C           QFCNUM    IFEQ XFCNUM                                    160217
     C           QFPTFR    ANDEQXFPTFR                                    160217
     C           QFDSPS    ANDEQXFDSPS                                    160217
     C           QFDSPG    ANDEQXFDSPG                                    160217
     C           QFITDS    ANDEQXFITDS                                    160217
     C           QFINNR    ANDEQXFINNR                                    160217
     C           QFPOSQ    ANDEQXFPOSQ                                    160217
     C           QFTDSS    ANDEQXFTDSS                                    160217
     C           QFTRNB    ANDEQXFTRNB                                    160217
     C           QFTXT2    ANDEQXFTXT2                                    160217
     C           WWFFMC    ANDEQXWFFMC                                    160217
     C           WWFFMY    ANDEQXWFFMY                                    160217
     C                     ADD  1         XRRN                            160217
     C                     ELSE                                           160217
     C                     Z-ADD0         XRRN                            160217
     C                     END                                            160217
     C**********           Z-ADDQFCNUM    XFCNUM                                       160217 CSD027
     C                     MOVE QFCNUM    XFCNUM                                              CSD027
     C                     MOVELQFPTFR    XFPTFR                          160217
     C                     MOVELQFDSPS    XFDSPS                          160217
     C                     MOVELQFDSPG    XFDSPG                          160217
     C                     Z-ADDQFITDS    XFITDS                          160217
     C                     MOVELQFINNR    XFINNR                          160217
     C                     MOVELQFPOSQ    XFPOSQ                          160217
     C                     MOVELQFTDSS    XFTDSS                          160217
     C**********           Z-ADDQFTRNB    XFTRNB                                       160217 CLE148
     C                     MOVELQFTRNB    XFTRNB                                              CLE148
     C                     MOVELQFTXT2    XFTXT2                          160217
     C                     MOVELWWFFMC    XWFFMC                          160217
     C                     MOVELWWFFMY    XWFFMY                          160217
      *                                                                   160217
     C** ON CHANGE OF DISPLAY GROUP ADD 1 TO K AND SET TYPE TO 'D'        CPM005
     C           QFDSPG    IFNE WWDSPO                     B3             CPM005
     C                     MOVE QFDSPG    WWDSPO  3                       CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE 'D'       WWDETT  1                       CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           K         IFEQ 7                          B3             CPM005
     C                     ADD  1         I                               CPM005
     C                     MOVE WWPAGE    TDD,I                           CPM005
     C                     MOVE XRRN      HOAR,I                          160217
     C                     Z-ADD1         K                               CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** ON CHANGE OF INSTRUMENT GROUP ADD 1 TO K AND SET TYPE TO 'I'     CPM005
     C           QFINNR    IFNE WWINNO                     B3             CPM005
     C                     MOVE QFINNR    WWINNO  3                       CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE 'I'       WWDETT  1                       CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           K         IFEQ 7                          E3             CPM005
     C                     ADD  1         I                               CPM005
     C                     MOVE WWPAGE    TDD,I                           CPM005
     C                     MOVE XRRN      HOAR,I                          160217
     C                     Z-ADD1         K                               CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** FOR EACH SET OF DETAILS TO BE OUTPUT ADD 1 TO K AND SET TYPE 'T' CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE 'T'       WWDETT  1                       CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           K         IFEQ 7                          B3             CPM005
     C                     ADD  1         I                               CPM005
     C                     MOVE WWPAGE    TDD,I                           CPM005
     C                     MOVE XRRN      HOAR,I                          160217
     C                     Z-ADD1         K                               CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C*                                                                   CPM005
     C** FOR EACH SET OF DETAILS TO BE OUTPUT ADD 1 TO K AND SET TYPE 'T' CPM005
     C                     ADD  1         L                               CPM005
     C                     MOVE 'T'       WWDETT  1                       CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           L         IFEQ 7                          B2             CPM005
     C                     ADD  1         J                               CPM005
     C                     Z-ADD1         L                               CPM005
     C                     END                             E2             CPM005
     C*                                                                   CPM005
     C** READ NEXT HOLDING RECORD                                         CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDEQ*BLANKS                                   CPM005
     C           *IN72     OREQ '0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDNE*BLANKS                                   CPM005
     C           QFBYSF    ANDEQ'S'                                       CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C                     END                                            CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C** SAVE NUMBER OF PAGES OF LIVE AND MATURED HOLDINGS                CPM005
     C                     Z-ADDI         WWTDLV  50                      CPM005
     C                     Z-ADDJ         WWTDFL  50                      CPM005
     C**                                                                  CPM005
     C                     ENDSR                                          CPM005
      ********************************************************************CPM005
      /EJECT                                                              CPM005
      ********************************************************************CPM005
      *                                                                  *CPM005
      * #P102B   - SET UP ARRAYS OF TRADE DATE PAGE HEADINGS             *CPM005
      *            (TOTAL TYPE 'D' - POSITION TYPE)                      *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLS:                                                *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLED FROM:                                          *CPM005
      *                                                                  *CPM005
      * ROUTINE USES VARIABLES:                                          *CPM005
      *                                                                  *CPM005
      ********************************************************************CPM005
     C           #P102B    BEGSR                                          CPM005
     C*                                                                   CPM005
     C                     MOVE QMCNUM    QFCNUM                          CPM005
     C                     MOVE QMPTF1    QFPTFR                          CPM005
     C                     MOVE QMPOTY    QFPOST                          CPM005
     C                     Z-ADD*ZEROS    QFDSPS                          CPM005
     C                     MOVE *BLANKS   QFDSPG                          CPM005
     C                     Z-ADD*ZEROS    QFITDS                          CPM005
     C                     MOVE *BLANKS   QFINNR                          CPM005
     C                     MOVE *LOVAL    QFMODI                          CPM005
     C                     MOVE *LOVAL    QFRECI                          CPM005
     C                     MOVE *LOVAL    QFTDSS                          CPM005
     C                     MOVE *LOVAL    QFTRNB                          CPM005
     C                     MOVE *LOVAL    QFPOSQ                          CPM005
     C                     MOVE *LOVAL    QFTXT2                          CPM005
     C                     Z-ADD0         I       50                      CPM005
     C                     Z-ADD0         J       50                      CPM005
     C                     MOVE *BLANKS   WWDSPO  3                       CPM005
     C                     MOVE *BLANKS   WWINNO  3                       CPM005
     C                     Z-ADD0         XRRN    50                      160217
     C**********           Z-ADD0         XFCNUM  60                                   160217 CSD027
     C                     MOVE *BLANKS   XFCNUM  6                                           CSD027
     C                     MOVEL*BLANKS   XFPTFR  4                       160217
     C                     Z-ADD0         XFDSPS  20                      160217
     C                     MOVEL*BLANKS   XFDSPG  3                       160217
     C                     Z-ADD0         XFITDS  20                      160217
     C                     MOVEL*BLANKS   XFINNR  3                       160217
     C                     MOVEL*BLANKS   XFPOSQ 11                       160217
     C                     MOVEL*BLANKS   XFTDSS 10                       160217
     C**********           MOVEL*BLANKS   XFTRNB  60                                   160217 CLE148
     C                     MOVEL*BLANKS   XFTRNB  6                                           CLE148
     C                     MOVEL*BLANKS   XWACCU  60                      160217
     C                     MOVEL*BLANKS   XFTXT2 10                       160217
     C                     MOVEL*BLANKS   XWFFMC  3                       160217
     C                     MOVEL*BLANKS   XWFFMY  5                       160217
     C*                                                                   CPM005
     C** SET FILE POINTER TO FIRST RECORD FOR PORTFOLIO AND READ RECORD   CPM005
     C           PMHOLA    SETLLPMHOLDLA                                  CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDEQ*BLANKS                                   CPM005
     C           *IN72     OREQ '0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDNE*BLANKS                                   CPM005
     C           QFBYSF    ANDEQ'S'                                       CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** SAVE DISPLAY GROUP AND INSTRUMENT TYPE READ                      CPM005
     C                     Z-ADD6         K       50                      CPM005
     C                     Z-ADD6         L       50                      CPM005
     C**                                                                  CPM005
     C           *IN72     DOWEQ'0'                        B1             CPM005
     C           QFCNUM    ANDEQQMCNUM                                    CPM005
     C           QFPTFR    ANDEQQMPTF1                                    CPM005
     C           QFPOST    ANDEQQMPOTY                                    CPM005
     C**                                                                  CPM005
     C           QFRECI    IFEQ 'D'                        B2             CPM005
     C*                                                                   CPM005
     C           QFCNUM    IFEQ XFCNUM                                    160217
     C           QFPTFR    ANDEQXFPTFR                                    160217
     C           QFDSPS    ANDEQXFDSPS                                    160217
     C           QFDSPG    ANDEQXFDSPG                                    160217
     C           QFITDS    ANDEQXFITDS                                    160217
     C           QFINNR    ANDEQXFINNR                                    160217
     C           QFPOSQ    ANDEQXFPOSQ                                    160217
     C           QFTDSS    ANDEQXFTDSS                                    160217
     C           QFTRNB    ANDEQXFTRNB                                    160217
     C           QFTXT2    ANDEQXFTXT2                                    160217
     C           WWFFMC    ANDEQXWFFMC                                    160217
     C           WWFFMY    ANDEQXWFFMY                                    160217
     C                     ADD  1         XRRN                            160217
     C                     ELSE                                           160217
     C                     Z-ADD0         XRRN                            160217
     C                     END                                            160217
     C**********           Z-ADDQFCNUM    XFCNUM                                       160217 CSD027
     C                     MOVE QFCNUM    XFCNUM                                              CSD027
     C                     MOVELQFPTFR    XFPTFR                          160217
     C                     MOVELQFDSPS    XFDSPS                          160217
     C                     MOVELQFDSPG    XFDSPG                          160217
     C                     Z-ADDQFITDS    XFITDS                          160217
     C                     MOVELQFINNR    XFINNR                          160217
     C                     MOVELQFPOSQ    XFPOSQ                          160217
     C                     MOVELQFTDSS    XFTDSS                          160217
     C**********           Z-ADDQFTRNB    XFTRNB                                       160217 CLE148
     C                     MOVELQFTRNB    XFTRNB                                              CLE148
     C                     MOVELQFTXT2    XFTXT2                          160217
     C                     MOVELWWFFMC    XWFFMC                          160217
     C                     MOVELWWFFMY    XWFFMY                          160217
      *                                                                   160217
     C** ON CHANGE OF DISPLAY GROUP ADD 1 TO K AND SET TYPE TO 'D'        CPM005
     C           QFDSPG    IFNE WWDSPO                     B3             CPM005
     C                     MOVE QFDSPG    WWDSPO  3                       CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE 'D'       WWDETT  1                       CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           K         IFEQ 7                          B3             CPM005
     C                     ADD  1         I                               CPM005
     C                     MOVE WWPAGE    TDD,I                           CPM005
     C                     MOVE XRRN      HOAR,I                          160217
     C                     Z-ADD1         K                               CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** ON CHANGE OF INSTRUMENT GROUP ADD 1 TO K AND SET TYPE TO 'I'     CPM005
     C           QFINNR    IFNE WWINNO                     B3             CPM005
     C                     MOVE QFINNR    WWINNO  3                       CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE 'I'       WWDETT  1                       CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           K         IFEQ 7                          E3             CPM005
     C                     ADD  1         I                               CPM005
     C                     MOVE WWPAGE    TDD,I                           CPM005
     C                     MOVE XRRN      HOAR,I                          160217
     C                     Z-ADD1         K                               CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C** FOR EACH SET OF DETAILS TO BE OUTPUT ADD 1 TO K AND SET TYPE 'T' CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE 'T'       WWDETT  1                       CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           K         IFEQ 7                          B3             CPM005
     C                     ADD  1         I                               CPM005
     C                     MOVE WWPAGE    TDD,I                           CPM005
     C                     MOVE XRRN      HOAR,I                          160217
     C                     Z-ADD1         K                               CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C*                                                                   CPM005
     C** FOR EACH SET OF DETAILS TO BE OUTPUT ADD 1 TO K AND SET TYPE 'T''CPM005
     C                     ADD  1         L                               CPM005
     C                     MOVE 'T'       WWDETT  1                       CPM005
     C*                                                                   CPM005
     C** IF K EQUAL TO SEVEN WRITE DETAILS TO APPEAR ON PAGE HEADING      CPM005
     C** TO ARRAY                                                         CPM005
     C           L         IFEQ 7                          B2             CPM005
     C                     ADD  1         J                               CPM005
     C                     Z-ADD1         L                               CPM005
     C                     END                             E2             CPM005
     C*                                                                   CPM005
     C** READ NEXT HOLDING RECORD                                         CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDEQ*BLANKS                                   CPM005
     C           *IN72     OREQ '0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDNE*BLANKS                                   CPM005
     C           QFBYSF    ANDEQ'S'                                       CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C                     END                                            CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C** SAVE NUMBER OF PAGES OF LIVE AND MATURED HOLDINGS                CPM005
     C                     Z-ADDI         WWTDLV  50                      CPM005
     C                     Z-ADDJ         WWTDFL  50                      CPM005
     C**                                                                  CPM005
     C                     ENDSR                                          CPM005
      ********************************************************************CPM005
      /EJECT                                                              CPM005
     C********************************************************************CPM005
     C*                                                                  *CPM005
     C* #P1013   - ACCESS DISPLAY GROUP DETAILS & TOTALS                 *CPM005
     C*                                                                  *CPM005
     C* SUBROUTINE CALLS:                                                *CPM005
     C*                                                                  *CPM005
     C* SUBROUTINE CALLED FROM:                                          *CPM005
     C*                                                                  *CPM005
     C* ROUTINE USES VARIABLES:                                          *CPM005
     C*                                                                  *CPM005
     C********************************************************************CPM005
     C           #P1013    BEGSR                                          CPM005
     C**                                                                  CPM005
     C** RESET FIELDS                                                     CPM005
     C**                                                                  CPM005
     C                     EXSR #BLANK                                    CPM005
     C**                                                                  CPM005
     C** ACCESS PF/PMDSPGPD FOR THE DISPLAY GROUP DETAILS                 CPM005
     C** USING THE DISPLAY GROUP FROM THE HOLDINGS FILE                   CPM005
     C**                                                                  CPM005
     C           QFDSPG    CHAINPMDSPGPD             73                   CPM005
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C**                                                                  CPM005
     C** SET 'ENQUIRIES TERMINATING' FIELD IN *GDA TO 'Y'                 CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMENQT                          CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMDBER           ***************CPM005
     C                     MOVE 'PMDSPGPD'QMFILE           ** DB ERROR 04*CPM005
     C                     MOVE QFDSPG    QMKEY            ***************CPM005
     C                     MOVE 'PM0700'  QMPGM                           CPM005
     C                     Z-ADD4         QMERRN                          CPM005
     C** UPDATE *LDA                                                      CPM005
     C                     CALL 'PMC1001'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C                     RETRN                                          CPM005
     C**                                                                  CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** FILL RECORD OF SUBFILE                                           CPM005
     C**                                                                  CPM005
     C                     MOVEL*BLANK    DDACTN                          CPM005
     C**                                                                  CPM005
     C**********           Z-ADDQFCNUM    W0CNUM                                       CPM005 CSD027
     C                     MOVE QFCNUM    W0CNUM                                              CSD027
     C                     MOVE QFPTFR    W0PTF1                          CPM005
     C                     MOVE QFPOST    W0POTY                          CPM005
     C                     MOVE PADSPG    W0DGRC                          CPM005
     C                     Z-ADDPADSPS    W0DGRS                          CPM005
     C                     MOVE 'D'       W0TOTT                          CPM005
     C**                                                                  CPM005
     C           PMASL0    CHAINPMASLIL0             73                   CPM005
     C**                                                                  CPM005
     C                     MOVE *BLANKS   DDMVPC                          CPM005
     C                     MOVE *BLANKS   DDAIPC                          CPM005
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C**                                                                  CPM005
     C                     Z-ADD*ZEROS    FEASSV                          CPM005
     C                     Z-ADD*ZEROS    FELIAV                          CPM005
     C**                                                                  CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C**  EDIT ASSET VALUE                                                CPM005
     C                     Z-ADDFEASSV    ZFLD15                          CPM005
     C                     Z-ADDQMPCDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DDNOM1                          CPM005
     C*                                                                   CPM005
     C**  EDIT LIABILITY VALUE                                            CPM005
     C                     Z-ADDFELIAV    ZFLD15                          CPM005
     C                     Z-ADDQMPCDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DDNOM2                          CPM005
     C**                                                                  CPM005
     C           PPASSV    IFNE 0                                         CPM005
     C           FEASSV    DIV  PPASSV    ZZASSV  43H                     CPM005
     C           ZZASSV    MULT 100       WWPAS   30H                     CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPAS     ZFLD15                          CPM005
     C                     Z-ADD*ZEROS    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE WWPERC    WPERCA  3                       CPM005
     C                     ELSE                                           CPM005
     C                     MOVEL'  0'     WPERCA                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     MOVE WPERCA    FIELA1                          CPM005
     C                     MOVE '%'       FIELA2                          CPM005
     C                     MOVELNARR,1    DDNARR                          CPM005
     C**                                                                  CPM005
     C           PPLIAV    IFNE 0                                         CPM005
     C           FELIAV    DIV  PPLIAV    ZZLIAV  43H                     CPM005
     C           ZZLIAV    MULT 100       WWPLI   30H                     CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPLI     ZFLD15                          CPM005
     C                     Z-ADD*ZEROS    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE WWPERC    WPERCL  3                       CPM005
     C                     ELSE                                           CPM005
     C                     MOVEL'  0'     WPERCL                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     MOVE WPERCL    FIELB1                          CPM005
     C                     MOVE '%'       FIELB2                          CPM005
     C**                                                                  CPM005
     C                     MOVELNARR,1    DDNAR2                          CPM005
     C**                                                                  CPM005
     C           PMDSGT    CHAINPMDSGTPD             73                   CPM005
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C**                                                                  CPM005
     C                     MOVELQFCNUM    WORK10 10                       CPM005
     C                     MOVE QFPTFR    WORK10                          CPM005
     C                     MOVELQFDSPS    WWORK7  5                       CPM005
     C                     MOVE QFDSPG    WWORK7                          CPM005
     C                     MOVELWORK10    WWORK8 15                       CPM005
     C                     MOVE WWORK7    WWORK8                          CPM005
     C**                                                                  CPM005
     C** SET 'ENQUIRIES TERMINATING' FIELD IN *LDA TO 'Y'                 CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMENQT                          CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMDBER           ***************CPM005
     C                     MOVE 'PMDSGTPD'QMFILE           ** DB ERROR 08*CPM005
     C                     MOVE WWORK8    QMKEY            ***************CPM005
     C                     Z-ADD8         QMERRN                          CPM005
     C** UPDATE *LDA                                                      CPM005
     C                     CALL 'PMC1001'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C                     RETRN                                          CPM005
     C**                                                                  CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     Z-ADD*ZEROS    WWMVPC 150                      CPM005
     C**                                                                  CPM005
     C                     Z-ADD*ZEROS    WAOPEN 150                      CPM005
     C                     Z-ADD*ZEROS    WLOPEN 150                      CPM005
     C                     Z-ADD*ZEROS    WACLOS 150                      CPM005
     C                     Z-ADD*ZEROS    WLCLOS 150                      CPM005
     C**                                                                  CPM005
     C** IF DISPLAY TRADE/VALUE DATE ON DTAARA *LDA IS 'T'                CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'C '                                      CPM005
     C**                                                                  CPM005
     C           QMTVPS    IFEQ 'T'                                       CPM005
     C           QDPTPA    SUB  QDPTNA    WWMVPC                          CPM005
     C           WWMVPC    SUB  QDPTMV    WWMVPC                          CPM005
     C                     ELSE                                           CPM005
     C           QDPVPA    SUB  QDPVNA    WWMVPC                          CPM005
     C           WWMVPC    SUB  QDPVMV    WWMVPC                          CPM005
     C                     ENDIF                                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C** SETUP KEY FIELDS TO ACCESS PMASLIL0 FOR THE OPEN POSITIONS       CPM005
     C**                                                                  CPM005
     C**********           Z-ADDQFCNUM    W0CNUM                                       CPM005 CSD027
     C                     MOVE QFCNUM    W0CNUM                                              CSD027
     C                     MOVE QFPTFR    W0PTF1                          CPM005
     C                     MOVE 'FO'      W0POTY                          CPM005
     C                     MOVE QFDSPG    W0DGRC                          CPM005
     C                     Z-ADDQFDSPS    W0DGRS                          CPM005
     C                     MOVE 'D'       W0TOTT                          CPM005
     C**                                                                  CPM005
     C** RETRIEVE FORWARD OPEN ASSET & FORWARD OPEN LIABILITY             CPM005
     C**                                                                  CPM005
     C           PMASL0    CHAINPMASLIL0             73                   CPM005
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C                     Z-ADD*ZEROS    WAOPEN                          CPM005
     C                     Z-ADD*ZEROS    WLOPEN                          CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADDFEASSV    WAOPEN                          CPM005
     C                     Z-ADDFELIAV    WLOPEN                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C** RETRIEVE FORWARD CLOSED ASSET & FORWARD OPEN LIABILITY           CPM005
     C**                                                                  CPM005
     C                     MOVE 'FC'      W0POTY                          CPM005
     C**                                                                  CPM005
     C           PMASL0    CHAINPMASLIL0             73                   CPM005
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C                     Z-ADD*ZEROS    WACLOS                          CPM005
     C                     Z-ADD*ZEROS    WLCLOS                          CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADDFEASSV    WACLOS                          CPM005
     C                     Z-ADDFELIAV    WLCLOS                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'C '                                      CPM005
     C           WWMVPC    SUB  WAOPEN    WWMVPC                          CPM005
     C           WWMVPC    ADD  WLOPEN    WWMVPC                          CPM005
     C           WWMVPC    SUB  WACLOS    WWMVPC                          CPM005
     C           WWMVPC    ADD  WLCLOS    WWMVPC                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'FC'                                      CPM005
     C           WACLOS    SUB  WLCLOS    WWMVPC                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C           WAOPEN    SUB  WLOPEN    WWMVPC                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C                     Z-ADDWWMVPC    ZFLD15                          CPM005
     C                     Z-ADDQMPCDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DDMVPC                          CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C           QFPOST    OREQ 'FC'                                      CPM005
     C                     Z-ADD0         QDPTAI                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     Z-ADDQDPTAI    ZFLD15                          CPM005
     C                     Z-ADDQMPCDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DDAIPC                          CPM005
     C**                                                                  CPM005
     C                     MOVELPADSPT    DDDETA                          CPM005
     C                     MOVELPADSPT    DDDET2                          CPM005
     C**                                                                  CPM005
     C                     ENDSR                                          CPM005
     C********************************************************************CPM005
     C/EJECT                                                              CPM005
     C********************************************************************CPM005
     C*                                                                  *CPM005
     C* #P1014   - ACCESS INSTRUMENT TYPE DETAILS & TOTALS               *CPM005
     C*                                                                  *CPM005
     C* SUBROUTINE CALLS:                                                *CPM005
     C*                                                                  *CPM005
     C* SUBROUTINE CALLED FROM:                                          *CPM005
     C*                                                                  *CPM005
     C* ROUTINE USES VARIABLES:                                          *CPM005
     C*                                                                  *CPM005
     C********************************************************************CPM005
     C           #P1014    BEGSR                                          CPM005
     C**                                                                  CPM005
     C** RESET FIELDS                                                     CPM005
     C**                                                                  CPM005
     C                     EXSR #BLANK                                    CPM005
     C**                                                                  CPM005
     C** ACCESS PF/SDPLINPD FOR THE INSTRUMENT TYPE DETAILS               CPM005
     C** USING THE INSTRUMENT TYPE FROM THE HOLDINGS FILE                 CPM005
     C**                                                                  CPM005
     C                     CALL 'AOPLINR0'                                CPM005
     C                     PARM '*MSG    'WWRTCD  7                       CPM005
     C                     PARM '*KEY    'WWOPTN  7                       CPM005
     C                     PARM QFINNR    WWKEY   3                       CPM005
     C           SDPLIN    PARM SDPLIN    DSFDY                           CPM005
     C**                                                                  CPM005
     C           WWRTCD    IFNE *BLANKS                                   CPM005
     C**                                                                  CPM005
     C** SET 'ENQUIRIES TERMINATING' FIELD IN *LDA TO 'Y'                 CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMENQT                          CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMDBER           ***************CPM005
     C                     MOVE 'SDPLINPD'QMFILE           ** DB ERROR 05*CPM005
     C                     MOVE QFINNR    QMKEY            ***************CPM005
     C                     Z-ADD5         QMERRN                          CPM005
     C** UPDATE *LDA                                                      CPM005
     C                     CALL 'PMC1001'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C                     RETRN                                          CPM005
     C**                                                                  CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** ACCESS PF/PMDSPGPD FOR THE DISPLAY GROUP DETAILS                 CPM005
     C** USING THE DISPLAY GROUP FROM THE HOLDINGS FILE                   CPM005
     C**                                                                  CPM005
     C           PDDSPG    CHAINPMDSPGPD             73                   CPM005
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C**                                                                  CPM005
     C** SET 'ENQUIRIES TERMINATING' FIELD IN *LDA TO 'Y'                 CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMENQT                          CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMDBER           ***************CPM005
     C                     MOVE 'PMDSPGPD'QMFILE           ** DB ERROR 07*CPM005
     C                     MOVE PDDSPG    QMKEY            ***************CPM005
     C                     MOVE 'PM0700'  QMPGM                           CPM005
     C                     Z-ADD7         QMERRN                          CPM005
     C** UPDATE *LDA                                                      CPM005
     C                     CALL 'PMC1001'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C                     RETRN                                          CPM005
     C**                                                                  CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** FILL RECORD OF SUBFILE                                           CPM005
     C**                                                                  CPM005
     C                     MOVELQFINNR    DDTYPE                          CPM005
     C                     MOVEL'IT'      DDMODH                          CPM005
     C**                                                                  CPM005
     C                     MOVEL*BLANK    DDACTN                          CPM005
     C**                                                                  CPM005
     C**********           Z-ADDQFCNUM    W0CNUM                                       CPM005 CSD027
     C                     MOVE QFCNUM    W0CNUM                                              CSD027
     C                     MOVE QFPTFR    W0PTF1                          CPM005
     C                     MOVE QFPOST    W0POTY                          CPM005
     C                     MOVE PDDSPG    W0DGRC                          CPM005
     C                     Z-ADDPADSPS    W0DGRS                          CPM005
     C                     MOVE QFINNR    W0INSC                          CPM005
     C                     Z-ADDPDITDS    W0INSS                          CPM005
     C                     MOVE 'I'       W0TOTT                          CPM005
     C**                                                                  CPM005
     C           PMASL3    CHAINPMASLIL3             73                   CPM005
     C**                                                                  CPM005
     C                     MOVE *BLANKS   DDMVPC                          CPM005
     C                     MOVE *BLANKS   DDAIPC                          CPM005
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C**                                                                  CPM005
     C                     Z-ADD*ZEROS    FEASSV                          CPM005
     C                     Z-ADD*ZEROS    FELIAV                          CPM005
     C**                                                                  CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C**  EDIT ASSET VALUE                                                CPM005
     C                     Z-ADDFEASSV    ZFLD15                          CPM005
     C                     Z-ADDQMPCDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DDNOM1                          CPM005
     C*                                                                   CPM005
     C**  EDIT LIABILITY VALUE                                            CPM005
     C                     Z-ADDFELIAV    ZFLD15                          CPM005
     C                     Z-ADDQMPCDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DDNOM2                          CPM005
     C**                                                                  CPM005
     C           PPASSV    IFNE 0                                         CPM005
     C           FEASSV    DIV  PPASSV    ZZASSV  43H                     CPM005
     C           ZZASSV    MULT 100       WWPAS   30H                     CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPAS     ZFLD15                          CPM005
     C                     Z-ADD*ZEROS    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE WWPERC    WPERCA  3                       CPM005
     C                     ELSE                                           CPM005
     C                     MOVEL'  0'     WPERCA                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     MOVE WPERCA    FIELA1                          CPM005
     C                     MOVE '%'       FIELA2                          CPM005
     C                     MOVELNARR,2    DDNARR                          CPM005
     C**                                                                  CPM005
     C           PPLIAV    IFNE 0                                         CPM005
     C           FELIAV    DIV  PPLIAV    ZZLIAV  43H                     CPM005
     C           ZZLIAV    MULT 100       WWPLI   30H                     CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPLI     ZFLD15                          CPM005
     C                     Z-ADD*ZEROS    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE WWPERC    WPERCL  3                       CPM005
     C                     ELSE                                           CPM005
     C                     MOVEL'  0'     WPERCL                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     MOVE WPERCL    FIELB1                          CPM005
     C                     MOVE '%'       FIELB2                          CPM005
     C                     MOVELPDISTN    DDDETA                          CPM005
     C**                                                                  CPM005
     C                     MOVELNARR,2    DDNAR2                          CPM005
     C                     MOVELPDISTN    DDDET2                          CPM005
     C**                                                                  CPM005
     C                     MOVE 'Y'       DDCOLR                          CPM005
     C**                                                                  CPM005
     C           PMISTT    CHAINPMISTTPD             73                   CPM005
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C**                                                                  CPM005
     C                     MOVELQFCNUM    WORK10 10                       CPM005
     C                     MOVE QFPTFR    WORK10                          CPM005
     C                     MOVELQFDSPS    WWORK7  5                       CPM005
     C                     MOVE QFDSPG    WWORK7                          CPM005
     C                     MOVELWORK10    WWORK8 15                       CPM005
     C                     MOVE WWORK7    WWORK8                          CPM005
     C**                                                                  CPM005
     C** SET 'ENQUIRIES TERMINATING' FIELD IN *LDA TO 'Y'                 CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMENQT                          CPM005
     C**                                                                  CPM005
     C                     MOVEL'Y'       QMDBER           ***************CPM005
     C                     MOVE 'PMISTTPD'QMFILE           ** DB ERROR 09*CPM005
     C                     MOVE WWORK8    QMKEY            ***************CPM005
     C                     Z-ADD9         QMERRN                          CPM005
     C** UPDATE *LDA                                                      CPM005
     C                     CALL 'PMC1001'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C                     RETRN                                          CPM005
     C**                                                                  CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     Z-ADD*ZEROS    WWMVPC 150                      CPM005
     C**                                                                  CPM005
     C                     Z-ADD*ZEROS    WAOPEN 150                      CPM005
     C                     Z-ADD*ZEROS    WLOPEN 150                      CPM005
     C                     Z-ADD*ZEROS    WACLOS 150                      CPM005
     C                     Z-ADD*ZEROS    WLCLOS 150                      CPM005
     C**                                                                  CPM005
     C** IF DISPLAY TRADE/VALUE DATE ON DTAARA *GDA IS 'T'                CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'C '                                      CPM005
     C**                                                                  CPM005
     C           QMTVPS    IFEQ 'T'                                       CPM005
     C           QEPTPA    SUB  QEPTNA    WWMVPC                          CPM005
     C           WWMVPC    SUB  QEPTMV    WWMVPC                          CPM005
     C                     ELSE                                           CPM005
     C           QEPVPA    SUB  QEPVNA    WWMVPC                          CPM005
     C           WWMVPC    SUB  QEPVMV    WWMVPC                          CPM005
     C                     ENDIF                                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C** SETUP KEY FIELDS TO ACCESS PMASLIL0 FOR THE OPEN POSITIONS       CPM005
     C**                                                                  CPM005
     C**********           Z-ADDQFCNUM    W0CNUM                                       CPM005 CSD027
     C                     MOVE QFCNUM    W0CNUM                                              CSD027
     C                     MOVE QFPTFR    W0PTF1                          CPM005
     C                     MOVE 'FO'      W0POTY                          CPM005
     C                     MOVE QFDSPG    W0DGRC                          CPM005
     C                     Z-ADDQFDSPS    W0DGRS                          CPM005
     C                     MOVE 'I'       W0TOTT                          CPM005
     C                     MOVE QFINNR    W0INSC                          145934
     C                     Z-ADDQFITDS    W0INSS                          145934
     C**                                                                  CPM005
     C** RETRIEVE FORWARD OPEN ASSET & FORWARD OPEN LIABILITY             CPM005
     C**                                                                  CPM005
     C***********PMASL0    CHAINPMASLIL0             73            CPM005 145934
     C           PMASL2    CHAINPMASLIL0             73                   145934
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C                     Z-ADD*ZEROS    WAOPEN                          CPM005
     C                     Z-ADD*ZEROS    WLOPEN                          CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADDFEASSV    WAOPEN                          CPM005
     C                     Z-ADDFELIAV    WLOPEN                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C** RETRIEVE FORWARD CLOSED ASSET & FORWARD OPEN LIABILITY           CPM005
     C**                                                                  CPM005
     C                     MOVE 'FC'      W0POTY                          CPM005
     C**                                                                  CPM005
     C***********PMASL0    CHAINPMASLIL0             73            CPM005 145934
     C           PMASL2    CHAINPMASLIL0             73                   145934
     C**                                                                  CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C                     Z-ADD*ZEROS    WACLOS                          CPM005
     C                     Z-ADD*ZEROS    WLCLOS                          CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADDFEASSV    WACLOS                          CPM005
     C                     Z-ADDFELIAV    WLCLOS                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'C '                                      CPM005
     C           WWMVPC    SUB  WAOPEN    WWMVPC                          CPM005
     C           WWMVPC    ADD  WLOPEN    WWMVPC                          CPM005
     C           WWMVPC    SUB  WACLOS    WWMVPC                          CPM005
     C           WWMVPC    ADD  WLCLOS    WWMVPC                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'FC'                                      CPM005
     C           WACLOS    SUB  WLCLOS    WWMVPC                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C           WAOPEN    SUB  WLOPEN    WWMVPC                          CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C                     Z-ADDWWMVPC    ZFLD15                          CPM005
     C                     Z-ADDQMPCDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DDMVPC                          CPM005
     C**                                                                  CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C           QFPOST    OREQ 'FC'                                      CPM005
     C                     Z-ADD0         QEPTAI                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C                     Z-ADDQEPTAI    ZFLD15                          CPM005
     C                     Z-ADDQMPCDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DDAIPC                          CPM005
     C**                                                                  CPM005
     C                     ENDSR                                          CPM005
     C********************************************************************CPM005
      /EJECT                                                              CPM005
     C********************************************************************CPM005
     C*                                                                  *CPM005
     C* #P1016   -                                                       *CPM005
     C*                                                                  *CPM005
     C* SUBROUTINE CALLS:                                                *CPM005
     C*                                                                  *CPM005
     C* SUBROUTINE CALLED FROM:                                          *CPM005
     C*                                                                  *CPM005
     C* ROUTINE USES VARIABLES:                                          *CPM005
     C*                                                                  *CPM005
     C********************************************************************CPM005
     C           #P1016    BEGSR                                          CPM005
     C*                                                                   CPM005
     C** SAVE DETAILS OF FIRST AND LAST RECORD ON SCREEN                  CPM005
     C                     EXSR #SCRN                                     CPM005
     C           WWF13     IFEQ 'Y'                                       CPM005
     C           *IN23     OREQ '1'                                       CPM005
     C                     MOVE W2SCRN    WWBSCR 62                       CPM005
     C                     ELSE                                           CPM005
     C                     MOVE W2SCRN    WWTSCR 62                       CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C           QFRECI    IFEQ 'D'                        B2             CPM005
     C           WWMAFF    ANDEQ'D'                                       CPM005
     C           QFRECI    ORNE 'D'                                       CPM005
     C           WWMAFF    ANDEQ'M'                                       CPM005
     C*                                                                   CPM005
     C** IF FIRST RECORD READ AND DISPLAY GROUP TITLE TO BE DISPLAYED     CPM005
     C** OR DISPLAY GROUP HAS CHANGED                                     CPM005
     C           WWMAFF    IFEQ 'D'                        B4             CPM005
     C           K         IFEQ 0                          B5             CPM005
     C           WWDETT    ANDEQ'D'                                       CPM005
     C           QFDSPG    ORNE WWDSPO                                    CPM005
     C                     EXSR #P1013                                    CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE QFDSPG    WWDSPO                          CPM005
     C*                                                                   CPM005
     C** WRITE DISPLAY GROUP HEADING RECORD IN SUBFILE                    CPM005
     C                     MOVE '1'       *IN59                           CPM005
     C                     MOVE '1'       *IN52                           CPM005
     C                     ADD  1         RRN1                            CPM005
     C                     ADD  1         RRN2                            CPM005
     C                     WRITEPM0700S1                                  CPM005
     C                     WRITEPM0700S2                                  CPM005
     C                     MOVE *BLANKS   DDLIN1                          CPM005
     C                     MOVE *BLANKS   DDLIN2                          CPM005
     C                     MOVE '0'       *IN59                           CPM005
     C                     MOVE '0'       *IN52                           CPM005
     C           K         CABEQ6         #P1059                          CPM005
     C                     END                             E5             CPM005
     C                     END                             E4             CPM005
     C*                                                                   CPM005
     C** IF FIRST RECORD READ AND INSTRUMENT GROUP TITLE TO BE DISPLAYED  CPM005
     C** OR INSTRUMENT GROUP HAS CHANGED                                  CPM005
     C           WWMAFF    IFEQ 'D'                        B4             CPM005
     C           K         IFEQ 0                          B5             CPM005
     C           WWDETT    ANDEQ'I'                                       CPM005
     C           K         OREQ 1                                         CPM005
     C           WWDETT    ANDEQ'D'                                       CPM005
     C           QFINNR    ORNE WWINNO                                    CPM005
     C                     EXSR #P1014                                    CPM005
     C                     ADD  1         K                               CPM005
     C                     MOVE QFINNR    WWINNO                          CPM005
     C*                                                                   CPM005
     C** WRITE INSTRUMENT GROUP HEADING RECORD IN SUBFILE                 CPM005
     C**                                                                  CPM005
     C                     MOVE '1'       *IN59                           CPM005
     C                     MOVE '1'       *IN51                           CPM005
     C                     ADD  1         RRN1                            CPM005
     C                     ADD  1         RRN2                            CPM005
     C                     WRITEPM0700S1                                  CPM005
     C                     WRITEPM0700S2                                  CPM005
     C                     MOVE *BLANKS   DDLIN1                          CPM005
     C                     MOVE *BLANKS   DDLIN2                          CPM005
     C                     MOVE '0'       *IN59                           CPM005
     C                     MOVE '0'       *IN51                           CPM005
     C           K         CABEQ6         #P1059                          CPM005
     C                     END                             E5             CPM005
     C                     END                             E4             CPM005
     C**                                                                  CPM005
     C** IF MODULE ID IS 'SE'                                             CPM005
     C**                                                                  CPM005
     C           QFMODI    IFEQ 'SE'                       B3             CPM005
     C                     EXSR #P1004                                    CPM005
     C                     END                             E3             CPM005
     C**                                                                  CPM005
     C** IF MODULE ID IS NOT 'SE'                                         CPM005
     C**                                                                  CPM005
     C           QFMODI    IFNE 'SE'                       B3             CPM005
     C                     EXSR #P1005                                    CPM005
     C                     END                             E3             CPM005
     C**                                                                  CPM005
     C                     ADD  1         K                               CPM005
     C**                                                                  CPM005
     C** WRITE A RECORD TO THE SUBFILE                                    CPM005
     C**                                                                  CPM005
     C                     ADD  1         RRN1                            CPM005
     C                     ADD  1         RRN2                            CPM005
     C*                                                                   CPM005
     C** FOR ROLL BACKWARDS ON MATURED POSITIONS WRITE SCREEN RECORDS     CPM005
     C** OUT IN REVERSE SEQUENCE                                          CPM005
     C           WWMAFF    IFEQ 'M'                        B4             CPM005
     C           *IN24     ANDEQ'1'                                       CPM005
     C                     Z-ADDRRN1      W1RRN1  50                      CPM005
     C                     Z-ADDRRN2      W1RRN2  50                      CPM005
     C           7         SUB  RRN1      RRN1                            CPM005
     C           7         SUB  RRN2      RRN2                            CPM005
     C                     END                             E4             CPM005
     C**                                                                  CPM005
     C                     WRITEPM0700S1                                  CPM005
     C                     WRITEPM0700S2                                  CPM005
     C*                                                                   CPM005
     C** RESTORE SAVED VALUE OF RRN1 AND RRN2                             CPM005
     C           WWMAFF    IFEQ 'M'                        B4             CPM005
     C           *IN24     ANDEQ'1'                                       CPM005
     C                     Z-ADDW1RRN1    RRN1                            CPM005
     C                     Z-ADDW1RRN2    RRN2                            CPM005
     C                     END                             E4             CPM005
     C*                                                                   CPM005
     C           K         CABEQ6         #P1059                          CPM005
     C                     END                             E2             CPM005
     C*                                                                   CPM005
     C** READ NEXT HOLDING RECORD                                         CPM005
     C           WWMAFF    IFEQ 'D'                        B2             CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN72     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDEQ*BLANKS                                   CPM005
     C           *IN72     OREQ '0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           QFMODI    ANDEQ'FX'                                      CPM005
     C           QFTDSS    ANDNE*BLANKS                                   CPM005
     C           QFBYSF    ANDEQ'S'                                       CPM005
     C                     READ PMHOLDLA                 72               CPM005
     C                     END                                            CPM005
     C                     ELSE                            X2             CPM005
     C*                                                                   CPM005
     C           *IN24     IFEQ '1'                        B3             CPM005
     C                     READPPMMFHLPD                 72               CPM005
     C                     ELSE                            X3             CPM005
     C                     READ PMMFHLPD                 72               CPM005
     C                     END                             E3             CPM005
     C*                                                                   CPM005
     C                     END                             E2             CPM005
     C*                                                                   CPM005
     C           #P1059    ENDSR                                          CPM005
     C********************************************************************CPM005
      /EJECT                                                              CPM005
      ********************************************************************
      *                                                                  *
      * #V1001   - VALIDATE SUBFILE ENTRIES                              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1001   - PROCESS PM HOLDINGS SCREEN                            *
      * #P1006   - DISPLAY CUSTOMER GLOBAL POSITION                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWPTFR   - PORTFOLIO REFERENCE                                   *
      *                                                                  *
      ********************************************************************
     C           #V1001    BEGSR
     C**
     C                     MOVE '0'       *IN80
     C                     MOVE '0'       *IN56
     C                     MOVE '0'       *IN57
     C                     MOVE '0'       *IN58
     C                     MOVE '0'       *IN63                           S71062
     C                     MOVE '0'       *IN67
     C                     MOVE '0'       *IN66
     C                     MOVE '0'       *IN30                           SA9108
     C                     MOVE '0'       *IN31                           SA9108
     C*                                                                   081239
     C                     EXSR #VACO                                     081239
     C           *IN42     IFEQ '1'                                       081239
     C                     MOVE '1'       *IN80                           081239
     C                     GOTO E1001                                     081239
     C                     END                                            081239
     C**                                                                  SA9108
     C***IF*POOL*PORTFOLIO*CUSTOMER*MUST*NOT*BE*G,*P*OR*T.         SA9108 CPM005
     C** IF POOL PORTFOLIO CUSTOMER MUST NOT BE G, P, T OR O.             CPM005
     C**                                                                  SA9108
     C           QMPPCS    IFEQ 'Y'                                       SA9108
     C**                                                                  SA9108
     C           WWACTN    IFEQ 'G'                                       SA9108
     C           WWACTN    OREQ 'P'                                       SA9108
     C           WWACTN    OREQ 'T'                                       SA9108
     C           WWACTN    OREQ 'O'                                       CPM005
     C                     MOVE '1'       *IN80                           SA9108
     C                     MOVE '1'       *IN30                           SA9108
     C                     END                                            SA9108
     C**                                                                  SA9108
     C                     END                                            SA9108
     C**                                                                  SA9108
     C** IF POOL PORTFOLIO CUSTOMER; D ENTERED AND MODULE DL, LE OR RE.   SA9108
     C**                                                                  SA9108
     C           QMPPCS    IFEQ 'Y'                                       SA9108
     C           WWACTN    ANDEQ'D'                                       SA9108
     C**                                                                  SA9108
     C****       QFMODI    IFEQ 'MD'                                SA910856460
     C****       QFMODI    OREQ 'ML'                                SA910856460
     C****       QFMODI    OREQ 'FX'                                SA910856460
     C****       QFMODI    OREQ 'FI'                                SA910856460
     C****       QFMODI    OREQ 'LE'                                SA910856460
     C****       QFMODI    OREQ 'RE'                                SA910856460
     C           DDMODH    IFNE 'SE'                                      56460
     C           DDMODH    ANDNE'FF'                                      56460
     C                     MOVE '1'       *IN80                           SA9108
     C                     MOVE '1'       *IN31                           SA9108
     C                     END                                            SA9108
     C**                                                                  SA9108
     C                     END                                            SA9108
     C**
     C** OPTION 'G' IS VALID ONLY FOR SECURITY POSITIONS
     C***AND*CAN'T*BE*INPUT*IF*THE*CURRENT*PORTFOLIO*IS*'9999'            CPM005
     C**
     C           WWACTN    IFEQ 'G'
     C           WWGLOB    ANDEQ'Y'
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN67
     C                     ELSE
     C**
     C           WWACTN    IFEQ 'G'
     C           DDMODH    ANDNE'SE'
     C********** WWACTN    OREQ 'G'                                       CPM005
     C********** WWPTFR    ANDEQ'9999'                                    CPM005
     C**
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN56
     C**
     C                     END
     C**
     C                     END
     C**
     C**
     C           WWACTN    IFEQ 'T'
     C           DDMODH    ANDNE'SE'
     C****       DDMODH    ANDNE'DL'                                      S01313
     C           DDMODH    ANDNE'DL'                               S01313 50560
     C           DDMODH    ANDNE'MD'                                      S01313
     C           DDMODH    ANDNE'ML'                                      S01313
     C           DDMODH    ANDNE'FR'                                      S01313
     C           DDMODH    ANDNE'FX'                                      S01313
     C           DDMODH    ANDNE'LE'
     C           DDMODH    ANDNE'FF'
     C           DDMODH    ANDNE'RE'
     C****       DDMODH    ANDNE'FD'                                      S01313
     C****       DDMODH    ANDNE'FL'                                      S01313
     C           DDMODH    ANDNE'FI'                                      S01313
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN57
     C                     END
     C**
     C           WWACTN    IFEQ 'T'
     C****       DDMODH    ANDEQ'DL'                                      S01313
     C****       DDAMTH    ANDNE0                                         S01313
     C           DDMODH    ANDEQ'FX'                                      S01313
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN57
     C                     END
     C**
     C********** WWACTN    IFEQ 'C'                                       S01486
     C           WWACTN    IFEQ 'K'                                       S01486
     C           DDMODH    ANDEQ'RE'
     C********** WWACTN    OREQ 'C'                                       S01486
     C           WWACTN    OREQ 'K'                                       S01486
     C           DDMODH    ANDEQ'FF'
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN58
     C                     END
     C**
     C           WWACTN    IFEQ 'P'
     C           DDMODH    ANDNE'SE'
     C           WWACTN    OREQ 'P'
     C           DDSPLH    ANDNE'Y'
     C                     MOVE '1'       *IN80
     C                     MOVE '1'       *IN66
     C                     END
     C**                                                                  S71062
     C           WWACTN    IFEQ 'O'                                       S71062
     C           DDMODH    ANDNE'FF'                                      S71062
     C           WWACTN    OREQ 'O'                                       S71062
     C           DDCLOH    ANDEQ*ZEROS                                    S71062
     C                     MOVE *ON       *IN80                           S71062
     C                     MOVE *ON       *IN63                           S71062
     C                     END                                            S71062
     C**
     C           E1001     TAG                                            081239
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #U1001   - FILL SUBFILE HEADER                                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P1001   - PROCESS PM HOLDINGS SCREEN                            *
      * #P1006   - DISPLAY CUSTOMER GLOBAL POSITION                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWINTV   - INTERIM TRADE/VALUE INDICATOR                         *
      *                                                                  *
      ********************************************************************
     C           #U1001    BEGSR
     C**
     C** CUSTOMER NUMBER
     C**
     C                     MOVELQMCNUM    DDCNUM
     C**
     C** CUSTOMER REPORT NAME
     C**
     C                     MOVELQMCRNM    DDCRNM
     C***********                                                         CPM005
     C***INSTRUMENT TITLE                                                 CPM005
     C***********                                                         CPM005
     C***********          MOVELQMISTN    DDISTN                          CPM005
     C**
     C** PORTFOLIO REFERENCE  ON SCREEN
     C**
     C                     MOVELQMPTF2    DDPTFR
     C**
     C** PORTFOLIO NARRATIVE
     C**
     C                     MOVELQMPTFN    DDPTFN
     C**                                                                  CPM005
     C                     CALL 'AOCURRR0'                                CPM005
     C                     PARM '*MSG   ' @RTCD   7                       CPM005
     C                     PARM '*KEY    'WWOPTN  7                       CPM005
     C                     PARM QMPTCY    WWKEY2  3                       CPM005
     C           SDCURR    PARM SDCURR    DSSDY                           CPM005
     C           @RTCD     IFNE *BLANKS                    ***************CPM005
     C                     MOVE 'SDCURRPD'QMFILE           ** DB ERROR 01*CPM005
     C                     MOVE QMPTCY    QMKEY            ***************CPM005
     C                     Z-ADD3         QMERRN                          CPM005
     C                     EXSR *PSSR                                     CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** PORTFOLIO TOTAL ASSETS                                           CPM005
     C**                                                                  CPM005
     C                     Z-ADDPPASSV    ZFLD15                          CPM005
     C                     Z-ADDA6NBDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DPTOTA                          CPM005
     C**                                                                  CPM005
     C           PPASSV    IFEQ *ZEROS                                    CPM005
     C                     MOVE '1'       *IN76                           CPM005
     C                     ELSE                                           CPM005
     C                     MOVE '0'       *IN76                           CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** PORTFOLIO TOTAL LIABILITIES                                      CPM005
     C**                                                                  CPM005
     C                     Z-ADDPPLIAV    ZFLD15                          CPM005
     C                     Z-ADDA6NBDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DPTOTL                          CPM005
     C**                                                                  CPM005
     C           PPLIAV    IFEQ *ZEROS                                    CPM005
     C                     MOVE '1'       *IN77                           CPM005
     C                     ELSE                                           CPM005
     C                     MOVE '0'       *IN77                           CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C***********                                                         CPM005
     C***MARKET*VALUE                                                     CPM005
     C***********                                                         CPM005
     C***********WWINTV    IFEQ 'T'                                       CPM005
     C***********          MOVE QMTIMV    DDMARK                          CPM005
     C***********          ELSE                                           CPM005
     C***********          MOVE QMVIMV    DDMARK                          CPM005
     C***********          END                                            CPM005
     C**
     C** PORTFOLIO CURRENCY
     C**
     C                     MOVELQMPTCY    DDCCY
     C                     MOVELQMPTCY    DDCUR1                          CPM005
     C                     MOVELQMPTCY    DDCUR2                          CPM005
     C***********                                                         CPM005
     C***PORTFOLIO TYPE                                                   CPM005
     C***********                                                         CPM005
     C***********          MOVELQMPTFT    DDPTYP                          CPM005
     C***********                                                         CPM005
     C***ACCRUED*INTEREST                                                 CPM005
     C***********                                                         CPM005
     C***********WWINTV    IFEQ 'T'                                       CPM005
     C***********          MOVE QMITAI    DDACCR                          CPM005
     C***********          ELSE                                           CPM005
     C***********          MOVE QMIVAI    DDACCR                          CPM005
     C***********          END                                            CPM005
     C**                                                                  CPM005
     C**  RETRIEVE NARRATIVE FOR BLOCK POSITIONS                          CPM005
     C**                                                                  CPM005
     C           QMPOTY    IFEQ 'C '                                      CPM005
     C                     MOVELBLK,1     DDPTYP    P                     CPM005
     C                     ENDIF                                          CPM005
     C           QMPOTY    IFEQ 'FC'                                      CPM005
     C                     MOVELBLK,2     DDPTYP    P                     CPM005
     C                     ENDIF                                          CPM005
     C           QMPOTY    IFEQ 'FO'                                      CPM005
     C                     MOVELBLK,3     DDPTYP    P                     CPM005
     C                     ENDIF                                          CPM005
     C           QMPOTY    IFEQ 'UV'                                      CPM005
     C                     MOVELBLK,4     DDPTYP    P                     CPM005
     C                     ENDIF                                          CPM005
     C**                                                                  CPM005
     C** POSITION TYPE TOTAL ASSETS                                       CPM005
     C**                                                                  CPM005
     C                     Z-ADDPPASVL    ZFLD15                          CPM005
     C                     Z-ADDA6NBDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DPOSTA                          CPM005
     C**                                                                  CPM005
     C** CALCULATE % POSITION TYPE ASSETS                                 CPM005
     C**                                                                  CPM005
     C           PPASSV    IFNE *ZEROS                       1            CPM005
     C           PPASVL    DIV  PPASSV    ZZASSV  43H                     CPM005
     C           ZZASSV    MULT 100       WWPASS  41                      CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPASS    ZFLD15                          CPM005
     C                     Z-ADD1         ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DPERCA                          CPM005
     C                     MOVE '%'       DPERCA                          CPM005
     C                     ELSE                                           CPM005
     C                     MOVE '  0.0%'  DPERCA                          CPM005
     C                     END                                            CPM005
     C**                                                                  CPM005
     C** POSITION TYPE TOTAL LIABILITIES                                  CPM005
     C**                                                                  CPM005
     C                     Z-ADDPPLIVL    ZFLD15                          CPM005
     C                     Z-ADDA6NBDP    ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DPOSTL                          CPM005
     C**                                                                  CPM005
     C** CALCULATE % POSITION TYPE LIABILITIES                            CPM005
     C**                                                                  CPM005
     C           PPLIAV    IFNE *ZEROS                       1            CPM005
     C           PPLIVL    DIV  PPLIAV    ZZLIAV  43H                     CPM005
     C           ZZLIAV    MULT 100       WWPLIA  41                      CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPLIA    ZFLD15                          CPM005
     C                     Z-ADD1         ZDECS                           CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    DPERCL                          CPM005
     C                     MOVE '%'       DPERCL                          CPM005
     C                     ELSE                                           CPM005
     C                     MOVE '  0.0%'  DPERCL                          CPM005
     C                     END                                            CPM005
     C**
     C                     ENDSR
     C**
      ********************************************************************B08253
      /EJECT                                                              32134
      ********************************************************************32134
      *                                                                  *32134
      * LBTYP    - RETRIEVE GUARANTEES/PLEDGE TYPE                       *32134
      *                                                                  *32134
      * SUBROUTINE CALLS:                                                *32134
      *                                                                  *32134
      * SUBROUTINE CALLED FROM:                                          *32134
      * #P1010   - DISPLAY INTRUMENT DETAILS OF A HOLDING                *32134
      * #P1012   - PLEDGES DETAILS                                       *32134
      *                                                                  *32134
      ********************************************************************32134
     C           LBTYP     BEGSR                                          32134
     C*                                                                   32134
B001 C           DDTYPE    IFEQ LBPLEG                                    32134
     C                     MOVE 'P'       TYPE    1                       32134
X001 C                     ELSE                                           32134
     C*                                                                   32134
B002 C           DDTYPE    IFEQ LBGUAR                                    32134
     C                     MOVE 'G'       TYPE                            32134
X002 C                     ELSE                                           32134
     C*                                                                   32134
B003 C           DDTYPE    IFEQ LBCOLI                                    32134
     C                     MOVE 'C'       TYPE                            32134
X003 C                     ELSE                                           32134
     C*                                                                   32134
B004 C           DDTYPE    IFEQ LBSECU                                    32134
     C                     MOVE 'S'       TYPE                            32134
X004 C                     ELSE                                           32134
     C                     MOVE *BLANK    TYPE                            32134
E004 C                     END                                            32134
E003 C                     END                                            32134
E002 C                     END                                            32134
E001 C                     END                                            32134
     C*                                                                   32134
     C                     ENDSR                                          32134
      ********************************************************************32134
      /EJECT                                                              B08253
      ********************************************************************B08253
      *                                                                  *B08253
      * #SCRN  - ROUTINE SETTING UP SCREEN HEADER & FOOTER ARRAYS        *B08253
      *                                                                  *B08253
      * ROUTINE USES VARIABLES:                                          *B08253
      *                                                                  *B08253
      ********************************************************************B08253
     C           #SCRN     BEGSR                                          B08253
     C**                                                                  B08253
     C                     MOVE QFCNUM    W2CNUM                          B08253
     C                     MOVE QFPTFR    W2PTFR                          B08253
     C                     MOVE QFDSPS    W2DSPS                          B08253
     C                     MOVE QFDSPG    W2DSPG                          B08253
     C                     MOVE QFITDS    W2ITDS                          B08253
     C                     MOVE QFINNR    W2INNR                          B08253
     C****                 MOVE QFMODI    W2MODI                    B08253S01313
     C****                 MOVE QFRECI    W2RECI                    B08253S01313
     C                     MOVE QFCCY1    W2CCY1                          S01313
     C                     MOVE QFTDSS    W2TDSS                          B08253
     C                     MOVE QFDLSQ    W2DLSQ                          B08253
     C                     MOVE QFTRNB    W2TRNB                          B08253
     C                     MOVE QFTXT2    W2TXT2                          B08253
     C**                                                                  B08253
     C                     ENDSR                                          B08253
      ********************************************************************B08253
      /EJECT                                                              B08253
      ********************************************************************B08253
      *                                                                  *B08253
      * #FILE  - ROUTINE SETTING UP SCREEN HEADER & FOOTER ARRAYS        *B08253
      *                                                                  *B08253
      * ROUTINE USES VARIABLES:                                          *B08253
      *                                                                  *B08253
      ********************************************************************B08253
     C           #FILE     BEGSR                                          B08253
     C**                                                                  B08253
     C                     MOVE W2CNUM    QFCNUM                          B08253
     C                     MOVE W2PTFR    QFPTFR                          B08253
     C                     MOVE W2DSPS    QFDSPS                          B08253
     C                     MOVE W2DSPG    QFDSPG                          B08253
     C                     MOVE W2ITDS    QFITDS                          B08253
     C                     MOVE W2INNR    QFINNR                          B08253
     C****                 MOVE W2MODI    QFMODI                    B08253S01313
     C****                 MOVE W2RECI    QFRECI                    B08253S01313
     C                     MOVE W2TDSS    QFTDSS                          B08253
     C                     MOVE W2DLSQ    QFDLSQ                          B08253
     C                     MOVE W2CCY1    QFCCY1                          S01313
     C                     MOVE W2TRNB    QFTRNB                          B08253
     C                     MOVE W2TXT2    QFTXT2                          B08253
     C**                                                                  B08253
     C                     ENDSR                                          B08253
      ********************************************************************
     C***********                                                   S01486CPM005
      ***/EJECT                                                     S01486CPM005
     C***********                                                   S01486CPM005
     C**************************************************************S01486CPM005
     C***********                                                   S01486CPM005
     C*****#AUTH*- CHECK ACTION CODE AND BRANCH AUTHORITY           S01486CPM005
     C***********                                                   S01486CPM005
     C*****CALLED BY: #P1001 - PROCESS VALIDATION OF START SCREEN   S01486CPM005
     C*****CALLS:                                                   S01486CPM005
     C***********                                                   S01486CPM005
     C**************************************************************S01486CPM005
     C***********#AUTH     BEGSR                                    S01486CPM005
     C***********                                                   S01486CPM005
     C***Multi-branch system, user must be authorised to action on  S01486CPM005
     C***branch.                                                    S01486CPM005
     C***********                                                   S01486CPM005
     C***********BGMBIN    IFEQ 'Y'                                 S01486CPM005
     C***********          CALL 'ZVACTBU'                           S01486CPM005
     C***********          PARM           @ZACTN  1                 S01486CPM005
     C***********          PARM           @BRCA   3                 S01486CPM005
     C***********          PARM           @ERR    10                S01486CPM005
     C***********                                                   S01486CPM005
     C***********          ELSE                                     S01486CPM005
     C***********                                                   S01486CPM005
     C***Single*branch system, check user is authorised to action coS01486CPM005
     C***********                                                   S01486CPM005
     C***********          CALL 'ZVACTU'                            S01486CPM005
     C***********          PARM           @ZACTN                    S01486CPM005
     C***********          PARM           @ERR                      S01486CPM005
     C***********                                                   S01486CPM005
     C***********          END                                      S01486CPM005
     C***********                                                   S01486CPM005
     C***********          ENDSR                                    S01486CPM005
      **************************************************************S01486CPM005
     C**                                                                  S01486
      /EJECT                                                              S01486
     C**                                                                  S01486
      ********************************************************************S01486
     C*                                                               *   081239
     C*    #VACO - CHECK FOR VALID ACTION CODE                        *   081239
     C*                                                               *   081239
     C*    CALLED BY: #V10F0 - PROCESS VALIDATION OF START SCREEN     *   081239
     C*    CALLS:                                                     *   081239
     C*                                                               *   081239
     C*****************************************************************   081239
     C           #VACO     BEGSR                                          081239
     C*                                                                   081239
     C** Check valid action codes                                         081239
     C*                                                                   081239
     C                     Z-ADD1         UV      20                      081239
     C                     MOVEL'0'       *IN42                           081239
     C***********WWACTN    LOKUPVC2,UV                   41         081239CPM005
     C           WWACTN    LOKUPVC1,UV                   41               CPM005
     C*                                                                   081239
     C           *IN41     IFEQ '0'                                       081239
     C                     MOVEL'1'       *IN42                           081239
     C                     END                                            081239
     C***********                                                   081239CPM005
     C***********WWACTN    IFEQ ','                                 081239CPM005
     C***********          MOVEL'1'       *IN42                     081239CPM005
     C***********          END                                      081239CPM005
     C*                                                                   081239
     C                     ENDSR                                          081239
     C*****************************************************************   081239
      /EJECT
      /COPY ZSRSRC,ZEDITZ2
      /EJECT
      /COPY ZSRSRC,ZSEDITZ3
      /EJECT
      /COPY ZSRSRC,ZCCYCN                                                 R00631
      /EJECT
      /COPY ZSRSRC,ZCCYXR                                                 R00631
      /EJECT                                                              S71062
      /COPY ZSRSRC,ZDATE2Z2                                               S71062
     C**************************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1000**-*PROGRAM*CALLED*TO*UPDATE *GDA**************************S01486
      * PMC1001  - PROGRAM CALLED TO UPDATE *LDA                         *S01486
      **PMC1020**-*PROGRAM*CALLED*TO*END*GROUP*JOB************************S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      **WWPARM***- *GDA***************************************************S01486
      * WWPARM   - *LDA                                                  *S01486
      * WWEND    - END PARAMETER                                         *
      * WWGRPJ   - GROUP JOB PARAMETER                                   *
      *                                                                  *
      ********************************************************************
     C           *PSSR     BEGSR
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVEL'Y'       QMDBER
     C                     MOVEL'PM0700'  QMPGM
     C                     MOVEL'Y'       QMENQT
     C**
     C***UPDATE *GDA                                                      S01486
     C** UPDATE *LDA                                                      S01486
     C**
     C**********           CALL 'PMC1002'                                 S01486
     C**********           PARM           WWGDA                           S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C                     DUMP
     C**
     C**********           CALL 'PMC1020'                                 S01486
     C**
     C                     ENDSR
     C****************************************************************    S71062
     C**                                                             *    S71062
     C****SR:FFPRCS***-*CONVERTS*A*PRICE*IN*FILE*FORMAT*(*11,7P*)***S71062CFF004
     C******************TO*ITS*EQUIVALENT*SCREEN*FORMAT*(*12**A*)***S71062CFF004
     C**  SR:FFPRCS   - CONVERTS A PRICE IN FILE FORMAT ( 15,8P )    *    CFF004
     C**                TO ITS EQUIVALENT SCREEN FORMAT ( 16  A )    *    CFF004
     C**                                                             *    S71062
     C****INPUTS******-*FFPRIC*(11,7P)*PRICE*(*FILE*FORMAT*)********S71062CFF004
     C**  INPUTS      - FFPRIC (15,8P) PRICE ( FILE FORMAT )         *    CFF004
     C**                FFTKDM  (3,0P) TICKS DENOMINATOR             *    S71062
     C******************FFMNPF*(11,7P)*MINIMUM*PRICE*FLUCTUATION****S71062CFF004
     C****OUTPUTS*****-*FFSPRC*(12**A)*PRICE*(*SCREEN*FORMAT*)******S71062CFF004
     C**                FFMNPF (15,8P) MINIMUM PRICE FLUCTUATION     *    CFF004
     C**  OUTPUTS     - FFSPRC (16  A) PRICE ( SCREEN FORMAT )       *    CFF004
     C**                                                             *    S71062
     C****************************************************************    S71062
     C**      SUBROUTINE ONLY CHANGED FOR THIS PROGRAM               *    S71062
     C**      CHANGE I TO W                                          *    S71062
     C**      CHANGE J TO Z                                          *    S71062
     C****************************************************************    S71062
     C           FFPRCS    BEGSR                           ** FFPRCS SR **S71062
     C**                                                                  S71062
     C**                                                                  S71062
     C**                                                                  S71062
     C*     DEFINE INPUT FIELDS                                           S71062
     C**                                                                  S71062
     C** FFPRIC Previously Defined.                                       CFF004
     C***********          Z-ADDFFPRIC    FFPRIC 117                S71062CFF004
     C                     Z-ADDFFPRIC    FFPRIC                          CFF004
     C                     Z-ADDFFTKDM    FFTKDM  30                      S71062
     C** FFMNPF Previously Defined.                                       CFF004
     C***********          Z-ADDFFMNPF    FFMNPF 117                S71062CFF004
     C                     Z-ADDFFMNPF    FFMNPF                          CFF004
     C**                                                                  S71062
     C*     INITIALISE O/P FIELD FFSPRC                                   S71062
     C**                                                                  S71062
     C** FFSPRC Previously Defined.                                       CFF004
     C***********          MOVE *BLANK    FFSPRC 12                 S71062CFF004
     C                     MOVE *BLANK    FFSPRC                          CFF004
     C**                                                                  S71062
     C*     SEARCH FFPRIC FOR 1ST NON ZERO ELEMENT BEFORE DECIMAL         S71062
     C**                                                                  S71062
     C                     Z-ADD1         W       20                      S71062
     C***********W         DOWLT4                                   S71062CFF004
     C           W         DOWLT7                                         CFF004
     C           FFFP,W    ANDEQ0                                         S71062
     C**                                                                  S71062
     C                     ADD  1         W                               S71062
     C**                                                                  S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C******MOVE*ELEMENTS*FROM*FIRST*NON*ZERO*POSITION*TO*4TH*OF*FFFS71062CFF004
     C*     MOVE ELEMENTS FROM FIRST NON ZERO POSITION TO 7TH OF FFFP     CFF004
     C*     TO CORRESPONDING POSITIONS IN FFSP                            S71062
     C**                                                                  S71062
     C***********W         DOWLE4                                   S71062CFF004
     C           W         DOWLE7                                         CFF004
     C**                                                                  S71062
     C                     MOVE FFFP,W    FFSP,W                          S71062
     C                     ADD  1         W                               S71062
     C**                                                                  S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C*     SET UP DECIMAL OR FRACTION FORMAT SEPARATOR                   S71062
     C**                                                                  S71062
     C           FFTKDM    IFEQ 100                                       S71062
     C*                                                                   S71062
     C                     MOVE '.'       FFPT    1                       S71062
     C*                                                                   S71062
     C                     ELSE                                           S71062
     C*                                                                   S71062
     C                     MOVE '-'       FFPT                            S71062
     C*                                                                   S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C*     DETERMINE NUMBER OF SIGNIFICANT DECIMAL DIGITS                S71062
     C**                                                                  S71062
     C*     IF TICK =100 DETERMINE NO. DECIMAL PLACES FROM FFMNPF         S71062
     C**                                                                  S71062
     C           FFTKDM    IFEQ 100                                       S71062
     C**                                                                  S71062
     C***********          Z-ADD7         W                         S71062CFF004
     C                     Z-ADD8         W                               CFF004
     C           W         DOWGT0                                         S71062
     C           FFMF,W    ANDEQ0                                         S71062
     C*                                                                   S71062
     C                     SUB  1         W                               S71062
     C*                                                                   S71062
     C                     END                                            S71062
     C                     Z-ADDW         FFN     20                      S71062
     C**                                                                  S71062
     C                     ELSE                                           S71062
     C**                                                                  S71062
     C*    DETERMINE NO. OF SIGNIFICANT DIGITS FROM TICK VALUE            S71062
     C**                                                                  S71062
     C           FFTKDM    IFLE 10                                        S71062
     C                     Z-ADD1         FFN                             S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C           FFTKDM    IFGT 10                                        S71062
     C           FFTKDM    ANDLE100                                       S71062
     C                     Z-ADD2         FFN                             S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C           FFTKDM    IFGT 100                                       S71062
     C                     Z-ADD3         FFN                             S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C*    IF NUMBER OF SIGNIFICANT DECIMALS<> 0                          S71062
     C**                                                                  S71062
     C           FFN       IFNE 0                                         S71062
     C**                                                                  S71062
     C*    MOVE FFPT IN TO OUT FIELD                                      S71062
     C**                                                                  S71062
     C***********          MOVE FFPT      FFSP,5                    S71062CFF004
     C                     MOVE FFPT      FFSP,8                          CFF004
     C**                                                                  S71062
     C*    MOVE SIGNIFICANT DIGITS TO CORRESPONDING                       S71062
     C*    POSITIONS IN FFSP                                              S71062
     C**                                                                  S71062
     C***********          Z-ADD5         W                         S71062CFF004
     C                     Z-ADD8         W                               CFF004
     C           FFN       DOWNE0                                         S71062
     C*                                                                   S71062
     C           W         ADD  1         Z       20                      S71062
     C                     MOVE FFFP,W    FFSP,Z                          S71062
     C                     ADD  1         W                               S71062
     C                     SUB  1         FFN                             S71062
     C*                                                                   S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C                     ENDSR                                          S71062
     C********************************************************************S71062
     C**
     C*****ATN*-*ARRAY*TO*ENABLE*ATTN*KEY                                 S01486
     C*SETATNPGM PGM(PMC0610)                                             S01486
     C****VC1*-*Valid*codes*for*program***********************************S71062
     C**VKGPTD***                                                         S71062
     C**   TITL- ARRAY TO PRINT TITLE                                     CPM005
     C*****TRADE                                                          CPM005
     C*****VALUE                                                          CPM005
     C* ARRAY BLK (BLOCK TOTAL NARRATIVE) ADDED                           CPM005
     C* ARRAY NARR ADDED                                                  CPM005
**  CPY@
(c) Misys International Banking Systems Ltd. 2001
**   POWER - POWERS OF 10 FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN                      S71062
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                        S71062
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES                                            S71062
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   BLK - BLOCK TOTAL NARRTIVE                                           CPM005
CURRENT POSNS
FORWARD CLOSED
FORWARD OPEN
UNVALUED POSNS
**   NARR - NARRATIVES                                                    CPM005
Display Group
Instrument Type
**  VC1 - Valid codes for program                                         S01486
VKGPTDO                                                                   S71062
