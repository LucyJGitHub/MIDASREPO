     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Customer master details enquiry')             *
     H***********                                                         080702
     F*****************************************************************
     F*                                                               *
     F*  Midas - PORTFOLIO MANAGEMENT                             *
     F*                                                               *
     F*  PM0710 - PM CUSTOMER MASTER DETAILS ENDUIRY                  *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3644            Date 12Jul04               *
      *                 BUG3122            Date 17Jul04               *
      *                 CLE025             Date 20Oct03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 159529             Date 14May99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CPM005             Date 09Jul96               *
     F*                S01408              DATE 16APR96               *
     F*                S01408              DATE 01APR96               *
     F*                093368              DATE 19SEP95               *
     F*                080702              DATE 18JAN95               *
     F*                S01486              DATE 08JUL94               *
     F*                S01313              DATE 06/05/92              *
     F*                B9383               DATE 13NOV91               *
     F*                R10033              DATE 18/09/90              *
     F*                33616               DATE 20/09/90              *
     F*                R10015              DATE 06/09/90              *
     F*                PMC164              DATE 07/06/90              *
     F*                PMC162              DATE 30/05/90              *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CRE026 - Consumer Banking                                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
      *  BUG3122 - Recompiled due to changes in SDSECSPD.             *
      *  CLE025 - Credit Lines (Recompile)                            *
     F*  159529 - When S01523 is on, System does not show the correct *
     F*           Alternate names from CGCORRPD. Caused by corrupted  *
     F*           parameter @ADCD which does not contain blanks if is *
     F*           passed as *LOVAL.  Fix is to pass the parameter as  *
     F*           blanks.                                             *
     F*  CPM005 - Private Banking Phase II                            *
     F*           Focus Group Changes Upgraded to DBA                 *
     F*           PBFG/5 - INSTRUMENT ASSET/LIABILITY SPLIT           *
     F*           PBFG/7 - NET COMMITMENT BY CURRENCY                 *
     F*           PBFG/8 - DISPLAY POSITIONS SPLIT BY CURRENCY        *
     F*           PBFG/6 - ADDITIONAL CUSTOMER DETAILS                *
     F*  S01408 - Addition of core hook PM0710CCP4                        S01408
     F*  S01408 - Addition of core hook PM0710CCP3                    *
     F*         - Addition of core hook PM0710CCP2                    *
     F*         - Addition of core hook PM0710CCP1                    *
     F*         - Addition of core hook PM0710IIP1                    *
     F*         - Addition of core hook PM0710FFP1                    *
     F*  093363 - Alternative address never displayed; fix is to add  *
     F*           new option to AOALTNR0 to obtain first alternative  *
     F*           name for a customer.                                *
     F*  080702 - Missing program in upgrade                          *
     F*  S01486 - Portfolio Management upgrade to R10                 *
     F*  S01313 - CHANGED FOR PORTFOLIO PERFORMANCE                   *
     F*  B9383  - SUPPRESS INPUT "FPV DOC" AVAILABLE ONLY FOR         *
     F*           SWISS BANKS                                         *
     F*  R10033 - SUPPRESS DETAILS OF DEPOTS ON 'SECURITY CUSTOMER    *
     F*           MASTER DETAILS' ENQUIRY SCREEN                      *
     F*  R10015 - DISPLAY ADDITIONAL INFORMATION FOR P.M. DETAILS     *
     F*  33616  - LOOP WHEN NO ROLLUP OR NO ROLLDOWN.                 *
     F*  PMC164 - DISPLAY WITH ADDRESSES REFERENCES                   *
     F*  PMC162 - STANDARD ENHANCEMENTS                               *
     F*                                                               *
     F*                                                               *
     F** **************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F***SDACOFL0IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'AZ'******************************************************080702
     F***SDCTRYL0IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'A4'******************************************************080702
     F***SDINSTL0IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'AK'******************************************************080702
     F***SDINDSL0IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'AO'******************************************************080702
     F***********                                                         080702
     F***SDPLCSL2IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'BB'AND*'QB'**********************************************080702
     F***********                                                   R10015080702
     F***SDPLCSPDIF**E           K        DISK                      R10015080702
     F***********                                   KINFSR *PSSR    R10015080702
     F***PREFIX*'QB'************************************************R10015080702
     F***SDCUSTL0IF**E***********K        DISK                      TA0000080702
     F***********                                   KINFSR *PSSR    TA0000080702
     F***PREFIX*'BB'AND*'QB'****************************************TA0000080702
     F***SDLBCSL9IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'CU'******************************************************080702
     F*                                                                   S01408
     F/COPY WNCPYSRC,PM0710FFP1                                           S01408
     F*                                                                   S01408
     F***SDFICSL0IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'FB'******************************************************080702
     F***SDSECSL1IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'BF'******************************************************080702
     F***SDSTRDPDIF**E                    DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'BV'******************************************************080702
     F***SDFOCSL0IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'BH'******************************************************080702
     F***SDCURRL0IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***SDALTNL1IF**E           K        DISK                            080702
     F***********                                   KINFSR *PSSR          080702
     F***PREFIX*'A6'******************************************************080702
     FPMPCSDL0IF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     F*                                                                   CPM005
     FPMPCSDPDIF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     F**
     F***PM0710DDCF**E                    WORKSTN                         080702
     FPM0710DFCF  E                    WORKSTN                            080702
     F**
     F**
     F******************************************************************
     F*
     F*
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F*
     F********72*********ACCESS*ON*LF/SDPLCSL2****************************080702
     F*
     F*                Unused indicators
     F*                -----------------
     F*       01  02  03  04  05  06  07  08  09  10
     F*       ..  12  13  14  15  16  17  18  19  20
     F*       21  22  23  24  25  26  27  28  29  30
     F*       31  32  33  34  35  36  37  38  39  40
     F*       41  42  43  ..  45  46  47  48  49  50
     F*       51  52  53  54  ..  ..  ..  ..  59  60
     F*       61  62  63  64  65  ..  67  68  69  70
     F*       71  ..  73  74  75  76  ..  78  79  80
     F*       81  82  83  84  85  86  87  88  89  90
     F*       91  92  93  94  95  96  97  98  99
     F*
     F*
     F*       U7         DATABASE ERROR
     F*       U8         PROGRAM  ERROR
     F*
     E*=========================================================================
     E**
     E** ARRAY TO ENABLE ATTENTION KEY
     E**
     E******************* ATN     1   1 22                                080702
      *
      ** ARRAY FOR COPYRIGHT
      *
     E                    CPY@    1   1 80
     E**
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E**
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E**
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E**
     E******************* NAM        10  6   SNM    10                    R10033
     E** ARRAY FOR ZEDIT
     E                    ZS1        15  1 0
     E                    ZS2        21  1
     E** ARRAY FOR ZEDIT
     E                    ZA1        16  1               ZALIGN/ZEDIT ARRAY
     E**
     E                    ZA2        16  1               ZALIGN/ZEDIT ARRAY
     E**
     I**
     I***EXTERNAL*FORMAT*FOR*GROUP*DATA*AREA******************************080702
     I** EXTERNAL FORMAT FOR LOCAL DATA AREA                              080702
     I**
     I****WWGDA     E DSPMGRDAPP                                          080702
     I**
     I****WWLDA     E DSPMLDAPP                                           080702
     IWWLDA     E DSPMLDAPD                                               080702
     I**
     I            DS
     I                                        1   1 WWFLG1
     I                                        2   2 WWFLG2
     I                                        3   3 WWFLG3
     I                                        4   4 WWFLG4
     I                                        5   5 WWFLG5
     I                                        1   5 WWFLAG
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I*
     IPSDS       SDS
     I**************************************247 249 WSID                  PMC162
     I************************************* 244 253 WSID                  080702
     I************************************* 254 263 USID                  080702
     I                                      244 253 WKSTN                 080702
     I                                      254 263 USER                  080702
     I**
     I** DATA STRUCTURE FOR SUBROUTINE ZSEDIT
     I**
     I            DS
     I                                        1  150WORK15
     I                                        1  150ZS1
     ISDACOF    E DSSDACOFPD                                              080702
     I**  Data structure for account officer details                      080702
     ISDCTRY    E DSSDCTRYPD                                              080702
     I**  Data structure for countries details                            080702
     ISDINST    E DSSDINSTPD                                              080702
     I**  Data structure for institution codes                            080702
     ISDINDS    E DSSDINDSPD                                              080702
     I**  Data structure for industry codes                               080702
     ISDPLCS    E DSSDPLCSPD                                              080702
     I**  Data structure for portfolio customer details                   080702
     ISDLBCS    E DSSDLBCSPD                                              080702
     I* Portfolio Customer Details Accessed Via Access Program            080702
     ISDSECS    E DSSDSECSPD                                              080702
     I** Data structure for securities details                            080702
     ISDSTRD    E DSSDSTRDPD                                              080702
     I** Data structure for securities ICD                                080702
     ISDALTN    E DSSDALTNPD                                              080702
     I** Data structure for alternate name and addresses                  080702
     ISDCURR    E DSSDCURRPD                                              080702
     I** Data structure for currencies                                    080702
     ISDCUST    E DSSDCUSTPD                                              080702
     I** Data structure for customer details                              080702
     I*                                                                   080702
     IDSFDY     E DSDSFDY                                                 080702
     I**  Short data structure for access objects                         080702
     IDSSDY     E DSDSSDY                                                 080702
     I**  Long data structure for access objects                          080702
     I*                                                                   080702
     I**
     I*
     ICPYR@#      DS
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*                                                                   S01408
     I/COPY WNCPYSRC,PM0710IIP1                                           S01408
     I*                                                                   S01408
      ********************************************************************
      *                                                                   CPM005
     C           *ENTRY    PLIST                                          CPM005
     C                     PARM           PAR1    1                       CPM005
      *                                                                   CPM005
     C           *LIKE     DEFN BBCUST    WWCUST
      ***********                                                         080702
      ***KEY*FIELD*FOR*ACCESSING*LF/SDALTNL1******************************080702
     C***********SDALT     KLIST                                          080702
     C***********          KFLD           WWNCUM                          080702
     C***********          KFLD           WWADCD                          080702
      *
      ** PROGRAM START
      *
     C                     EXSR #INIT
      *
      ** PROCESS CUSTOMER MASTER DETAILS SCREEN
      *
     C                     EXSR #P01
      *
      ** F3 TAKEN
      *
     C           *INKC     IFEQ '1'                        - B1
      *
      ** SET ENQUIRIES TERMINATING TO 'Y'
      *
     C                     MOVE 'Y'       QMENQT
      *
      ***WRITE*DETAILS*ON**GDA********************************************080702
      ** WRITE DETAILS ON *LDA                                            080702
      *
     C******************** CALL 'PMC1002'                                 080702
     C******************** PARM           WWGDA                           080702
     C                     CALL 'PMC1001'                                 080702
     C                     PARM           WWLDA                           080702
      *
     C                     END                             - E1
      *                                                                   CPM005
      ** F12 TAKEN                                                        CPM005
      *                                                                   CPM005
     C           *INKL     IFEQ '1'                        - B1           CPM005
     C                     MOVE 'P'       QMENQT                          CPM005
     C                     CALL 'PMC1001'                                 CPM005
     C                     PARM           WWLDA                           CPM005
     C                     END                             - E1           CPM005
      *
     C                     RETRN
      *
      ** PROGRAM END
      *
      ********************************************************************
     C           #INIT     BEGSR                           **#INIT BSR**
      *
      ** RETRIEVE DATA AREA
      *
     C                     MOVE *OFF      *INKL                           CPM005
      *                                                                   CPM005
     C                     CALL 'PMC1003'
     C                     PARM           WWLDA
     C                     MOVELQMRUNA    DDRUNA                          PMC162
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM0710CCP1                                           S01408
     C*                                                                   S01408
      *
     C                     ENDSR                           **#INIT ESR**
      ********************************************************************
     C           #P01      BEGSR                           **#P01  BSR**
      *
      ** LOAD CUSTOMER NUMBER
      *
     C                     MOVE QMCNUM    WWCUST
      *
      *
      ** RESET INDICATORS AND WORK FIELDS
      *
     C                     MOVE '0'       *IN
     C                     MOVEL*BLANKS   WWFLAG
     C                     Z-ADD1         WWCONT  10
     C                     MOVEL'J'       ZECODE
      **
     C***********QMATTN    IFEQ 'Y'                                       080702
     C***********          MOVE '1'       *IN61                           080702
     C***********          MOVEAATN       WWFLD  22                       080702
     C***********          Z-ADD22        WWNUMB 155                      080702
     C***********          CALL 'QCMDEXC'                                 080702
     C***********          PARM           WWFLD                           080702
     C***********          PARM           WWNUMB                          080702
     C***********          END                                            080702
     C**
     C                     EXSR #BLANK
      *
      ** DO UNTIL F3 OR F12
      *
     C           *INKC     DOUEQ'1'                        - B1
     C           *INKL     OREQ '1'
      *
      ** DISPLAY SCREEN
      *
     C                     MOVE *IN25     WWIN25  1
     C                     MOVE *IN26     WWIN26  1
     C                     MOVE '0'       *IN25
     C                     MOVE '0'       *IN26
      **
     C           WWCONT    IFEQ 1
     C                     EXSR #W01
     C                     END
      **
     C           WWCONT    IFEQ 2
     C                     EXSR #W02
     C                     END
      **
     C           PAR1      IFNE 'A'                                       CPM005
     C           WWCONT    IFEQ 3
     C                     EXSR #W03
     C                     END
      **
     C           WWCONT    IFEQ 4
     C                     EXSR #W04
     C                     END
     C                     END                                            CPM005
      ***********                                                PMC164   080702
     C***********WWCONT    IFEQ 5                                         080702
     C***********          EXSR #W05                                      080702
     C***********          END                                            080702
      **
     C           *IN25     IFEQ '1'
     C           WWCONT    IFEQ 2                                         CPM005
     C           PAR1      IFEQ 'A'                                       CPM005
     C                     MOVE *ON       *INKL                           CPM005
     C                     END                                            CPM005
     C                     END                                            CPM005
     C***********WWCONT    IFEQ 5                                PMC164   080702
     C           WWCONT    IFEQ 4                                         080702
     C                     MOVE '1'       *IN63
     C                     ELSE
     C                     ADD  1         WWCONT
     C                     END
     C                     END
      **
     C           *IN26     IFEQ '1'
     C           WWCONT    IFEQ 1
     C                     MOVE '1'       *IN62
     C                     ELSE
     C                     SUB  1         WWCONT
     C                     END
     C                     END
      **
      *
     C*                                                                   080702
     C** IF F22 TAKEN                                                     080702
     C*                                                                   080702
     C           *INKW     IFEQ '1'                                       080702
     C*                                                                   080702
     C                     CALL 'PMC0610'                                 080702
     C*                                                                   080702
     C                     END                                            080702
     C                     END                             - E1
      *
     C                     ENDSR                           **#P01  ESR**
      ********************************************************************
     C           #W01      BEGSR                           **#W01  BSR**
      **
     C           WWFLG1    IFEQ *BLANK
      **
     C                     MOVEL'Y'       WWFLG1
      *
      ** ACCESS SDPLCSL2 WITH CUSTOMER NUMBER
      *
     C           QMDLCS    IFEQ *BLANKS                                   CPM005
      *                                                                   CPM005
     C***********WWCUST    CHAINSDPLCSL2             72                   080702
     C                     CALL 'AOPLCSR0'                                080702
     C                     PARM '*MSG    'WWRTCD  7                       080702
     C                     PARM '*KEY    'WWOPTN  7                       080702
     C                     PARM WWCUST    WWKY10 10                       080702
     C           SDPLCS    PARM SDPLCS    DSSDY                           080702
      **
     C************IN72     IFEQ '1'                        ***************080702
     C           WWRTCD    IFNE *BLANKS                                   080702
     C                     Z-ADD1         QMERRN           * DB ERROR 01 *
     C***********          MOVEL'SDPLCSL2'QMFILE           ***************080702
     C                     MOVEL'SDPLCSPD'QMFILE           ***************080702
     C                     MOVELWWCUST    QMKEY
     C                     EXSR *PSSR
     C                     ELSE                                           080702
     C                     MOVELWWCUST    PLCUS                           080702
     C                     CALL 'AOCUSTR0'                                080702
     C                     PARM '*MSG    'WWRTCD                          080702
     C                     PARM '*KEY    'WWOPTN                          080702
     C                     PARM           PLCUS  10                       080702
     C                     PARM *BLANKS   KEYST   7                       080702
     C           SDCUST    PARM SDCUST    DSSDY                           080702
     C           WWRTCD    IFNE *BLANKS                                   080702
     C                     Z-ADD10        QMERRN           * DB ERROR 01 *080702
     C                     MOVEL'SDCUSTPD'QMFILE           ***************080702
     C                     MOVELWWCUST    QMKEY                           080702
     C                     EXSR *PSSR                                     080702
     C                     END                                            080702
     C                     END
      *                                                                   CPM005
     C                     ELSE                                           CPM005
      *                                                                   CPM005
     C           WWCUST    CHAINPMPCSDL0             72                   CPM005
      **                                                                  CPM005
     C           *IN72     IFEQ '1'                        ***************CPM005
     C                     Z-ADD6         QMERRN           * DB ERROR 06 *CPM005
     C                     MOVE 'PMPCSDL0'QMFILE           ***************CPM005
     C                     MOVELWWCUST    QMKEY                           CPM005
     C                     EXSR *PSSR                                     CPM005
     C                     END                                            CPM005
     C                     END                                            CPM005
      **                                                                  CPM005
      ** SET CUSTOMER NUMBER
     C                     MOVELBBCUST    DDCUST
      ** SET SHORT NAME
     C                     MOVELBBCSSN    DDCSSN
      ** SET REPORT NAME
     C                     MOVELBBCRNM    DDCRNM
      ** SET CUSTOMER NAME AND ADDRESS
     C                     MOVELBBCNA1    DDCNA1
     C                     MOVELBBCNA2    DDCNA2
     C                     MOVELBBCNA3    DDCNA3
     C                     MOVELBBCNA4    DDCNA4
      ** SET TOWN
     C                     MOVELBBCRTN    DDCRTN
      ** SET PARENT INDICATOR
     C                     MOVELBBPAIN    DDPAIN
      ** SET PARENT
     C                     MOVELBBPCNB    DDPCNB
      ** SET ACCOUNT OFFICER
     C                     MOVELBBACOC    DDACOC
     ** SET ACCOUNT OFFICER NAME
     C***********BBACOC    CHAINSDACOFL0             70            PMC162 080702
     C                     CALL 'AOACOFR0'                                080702
     C                     PARM '*MSG    'WWRTCD  7                       080702
     C                     PARM '*KEY    'WWOPTN  7                       080702
     C                     PARM BBACOC    WWKEY2  2                       080702
     C           SDACOF    PARM SDACOF    DSFDY                           080702
     C                     MOVELAZACON    DDACON                          PMC162
      ** SET SORT CODE
     C                     MOVELBBCASC    DDCASC
      ** SET COUNTRY OF CITIZENSHIP
     C                     MOVELBBCNCZ    DDCNCZ
     C***********BBCNCZ    CHAINSDCTRYL0             70                   PMC162
     C                     CALL 'AOCTRYR0'                                080702
     C                     PARM '*MSG   ' WWRTCD  7                       080702
     C                     PARM '*KEY   ' WWOPTN  7                       080702
     C                     PARM BBCNCZ    WWKEY2  2                       080702
     C           SDCTRY    PARM SDCTRY    DSFDY                           080702
     C                     MOVELA4CNNM    DDCNNM                          PMC162
      ** SET BRANCH
     C                     MOVELBBBRCD    DDBRCD
      ** SET COUNTRY OF DOMICILE
     C                     MOVELBBCOLC    DDCOLC
     C***********BBCOLC    CHAINSDCTRYL0             70                   PMC162
     C                     CALL 'AOCTRYR0'                                080702
     C                     PARM '*MSG   ' WWRTCD  7                       080702
     C                     PARM '*KEY   ' WWOPTN  7                       080702
     C                     PARM BBCOLC    WWKEY2  2                       080702
     C           SDCTRY    PARM SDCTRY    DSFDY                           080702
     C                     MOVELA4CNNM    DDBCTW                          PMC162
      ** SET BRANCH INDICATOR
     C                     MOVELBBBSIN    DDBSIN
      ** SET SUSPENDED DATE
     C                     Z-ADDBBSSDT    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDSSDT
      ** SET BANK
     C                     MOVELBBBNBI    DDBNBI
      ** SET DATE OF FIRST CONTACT
     C                     Z-ADDBBDOIC    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDDOIC
      ** SET INSTITUTION
     C                     MOVELBBLINC    DDLINC
     C***********BBLINC    CHAINSDINSTL0             70                   PMC162
     C                     CALL 'AOINSTR0'                                080702
     C                     PARM *BLANKS   WWRTCD  7                       080702
     C                     PARM '*KEY   ' WWOPTN  7                       080702
     C                     PARM BBLINC    WWKEY2  2                       080702
     C           SDINST    PARM SDINST    DSFDY                           080702
     C                     MOVELAKLINM    DDLINM                          PMC162
      ** SET PHONE
     C                     MOVELBBCTNB    DDCTNB
      ** SET INDUSTRY
     C                     MOVELBBLICD    DDLICD
     C***********BBLICD    CHAINSDINDSL0             70                   PMC162
     C                     CALL 'AOINDSR0'                                080702
     C                     PARM '*MSG    'WWRTCD  7                       080702
     C                     PARM '*KEY    'WWOPTN  7                       080702
     C                     PARM BBLICD    WWKEY   3                       080702
     C           SDINDS    PARM SDINDS    DSFDY                           080702
     C                     MOVELAOLINA    DDLINA                          PMC162
      ** SET REUTER ID
     C                     MOVELBBREID    DDREID
      ** SET TAX/NON TAX IND
     C                     MOVELBBTAIN    DDTAIN
      ** SET CUSTOMER TYPE
     C                     MOVELBBCSTY    DDCSTY
     C**
     C                     END
     C**
     C           PAR1      IFEQ 'A'                                       CPM005
     C                     MOVE *ON       *IN25                           CPM005
     C                     ELSE                                           CPM005
     C                     EXFMTPM0710F1
     C                     END                                            CPM005
     C**
     C                     MOVE '0'       *IN62
     C                     MOVE '0'       *IN63
     C**
     C                     ENDSR
      ***DISPLAY ADDRESSES REFERENCES (AMEND PMC164)
     C           #W02      BEGSR                                 PMC164
      **
     C                     MOVEL'Y'       WWFRST  1
     C           QMCNUM    IFNE WWCNUM                     B1
      **
      ** BLANK OUT ALL SCREEN FIELDS
     C                     MOVE *BLANKS   DDADC1
     C                     MOVE *BLANKS   DDCN11
     C                     MOVE *BLANKS   DDCN12
     C                     MOVE *BLANKS   DDCN13
     C                     MOVE *BLANKS   DDCN14
     C                     MOVE *BLANKS   DDTEL1
     C                     MOVE *BLANKS   DDTXN1
     C                     MOVE *BLANKS   DDADC2
     C                     MOVE *BLANKS   DDCN21
     C                     MOVE *BLANKS   DDCN22
     C                     MOVE *BLANKS   DDCN23
     C                     MOVE *BLANKS   DDCN24
     C                     MOVE *BLANKS   DDTEL2
     C                     MOVE *BLANKS   DDTXN2
     C                     MOVE *BLANKS   DDADC3
     C                     MOVE *BLANKS   DDCN31
     C                     MOVE *BLANKS   DDCN32
     C                     MOVE *BLANKS   DDCN33
     C                     MOVE *BLANKS   DDCN34
     C                     MOVE *BLANKS   DDTEL3
     C                     MOVE *BLANKS   DDTXN3
     C                     MOVE *BLANKS   DDADC4
     C                     MOVE *BLANKS   DDCN41
     C                     MOVE *BLANKS   DDCN42
     C                     MOVE *BLANKS   DDCN43
     C                     MOVE *BLANKS   DDCN44
     C                     MOVE *BLANKS   DDTEL5
     C                     MOVE *BLANKS   DDTXN5
     C                     MOVE *BLANKS   DDADC5
     C                     MOVE *BLANKS   DDCN51
     C                     MOVE *BLANKS   DDCN52
     C                     MOVE *BLANKS   DDCN53
     C                     MOVE *BLANKS   DDCN54
     C                     MOVE *BLANKS   DDTEL5
     C                     MOVE *BLANKS   DDTXN5
     C                     MOVEL'Y'       WWFLG2
     C**********           Z-ADDQMCNUM    WWCNUM  60                                          CSD027
     C                     MOVE QMCNUM    WWCNUM  6                                           CSD027
      **
      ** ACCESS SDALTNL1 WITH CUSTOMER NUMBER
      ** TO OBTAIN THE FIRST ALTERNATE ADDRESS FOR THE CUSTOMER           093368
     C                     Z-ADD0         K       10
     C                     MOVE QMCNUM    WWNCUM  6
     C***********          MOVE *LOVAL    WWADCD  1                       080702
     C***********SDALT     SETLLSDALTNL1                                  080702
     C***********WWNCUM    READESDALTNL1                 55               080702
     C                     CALL 'AOALTNR0'                                080702
     C                     PARM '*MSG    'WWRTCD  7                       080702
     C**********           PARM '*KEY    'WWOPTN  7                 080702093368
     C                     PARM '*KEYFST' WWOPTN  7                       093368
     C                     PARM WWNCUM    @CUST   6                       080702
     C**********           PARM *LOVAL    @ADCD   1                080702 159529
     C                     PARM *BLANK    @ADCD   1                       159529
     C           SDALTN    PARM SDALTN    DSFDY                           080702
      **
      **
     C************IN55     DOWEQ'0'                        B2             080702
     C           WWRTCD    DOWEQ*BLANKS                                   080702
     C                     ADD  1         K
      *
      ** SET UP FIRST SET OF SCREEN DETAILS
     C           K         IFEQ 1                          B3
     C                     MOVELBCADCD    DDADC1
     C                     MOVELBCCNA1    DDCN11
     C                     MOVELBCCNA2    DDCN12
     C                     MOVELBCCNA3    DDCN13
     C                     MOVELBCCNA4    DDCN14
     C                     MOVELBCCTNB    DDTEL1
     C                     MOVELBCTXNB    DDTXN1
     C                     END                             E3
      *
      ** SET UP SECOND SET OF SCREEN DETAILS
     C           K         IFEQ 2                          B3
     C                     MOVELBCADCD    DDADC2
     C                     MOVELBCCNA1    DDCN21
     C                     MOVELBCCNA2    DDCN22
     C                     MOVELBCCNA3    DDCN23
     C                     MOVELBCCNA4    DDCN24
     C                     MOVELBCCTNB    DDTEL2
     C                     MOVELBCTXNB    DDTXN2
     C                     END                             E3
      *
      ** SET UP THIRD SET OF SCREEN DETAILS
     C           K         IFEQ 3                          B3
     C                     MOVELBCADCD    DDADC3
     C                     MOVELBCCNA1    DDCN31
     C                     MOVELBCCNA2    DDCN32
     C                     MOVELBCCNA3    DDCN33
     C                     MOVELBCCNA4    DDCN34
     C                     MOVELBCCTNB    DDTEL3
     C                     MOVELBCTXNB    DDTXN3
     C                     END                             E3
      *
      ** SET UP FOURTH SET OF SCREEN DETAILS
     C           K         IFEQ 4                          B3
     C                     MOVELBCADCD    DDADC4
     C                     MOVELBCCNA1    DDCN41
     C                     MOVELBCCNA2    DDCN42
     C                     MOVELBCCNA3    DDCN43
     C                     MOVELBCCNA4    DDCN44
     C                     MOVELBCCTNB    DDTEL4
     C                     MOVELBCTXNB    DDTXN4
     C                     END                             E3
      *
      ** SET UP FIFTH SET OF SCREEN DETAILS
     C           K         IFEQ 5                          B3
     C                     MOVELBCADCD    DDADC5
     C                     MOVELBCCNA1    DDCN51
     C                     MOVELBCCNA2    DDCN52
     C                     MOVELBCCNA3    DDCN53
     C                     MOVELBCCNA4    DDCN54
     C                     MOVELBCCTNB    DDTEL5
     C                     MOVELBCTXNB    DDTXN5
     C                     END                             E3
      **
     C***********WWNCUM    READESDALTNL1                 55               080702
     C                     CALL 'AOALTNR0'                                080702
     C                     PARM '*MSG    'WWRTCD  7                       080702
     C                     PARM '*NEXT   'WWOPTN  7                       080702
     C                     PARM *BLANKS   @CUST   6                       080702
     C                     PARM *BLANKS   @ADCD   1                       080702
     C           SDALTN    PARM SDALTN    DSFDY                           080702
     C           WWRTCD    IFEQ *BLANKS                                   080702
     C           BCCUST    ANDNEWWNCUM                                    080702
     C                     MOVE 'END'     WWRTCD                          080702
     C                     END                                            080702
     C                     END                             E2
     C                     END                             E1
      *
      ** CONDITION DISPLAY OF NO ALTERNATE ADDRESSES TEXT
     C           DDADC1    IFEQ *BLANKS
     C                     MOVE '1'       *IN11
     C                     ELSE
     C                     MOVE '0'       *IN11
     C                     END
      *
      ** DETERMINE WHICH SCREEN TO OUTPUT
     C           WW10F2    DOUEQ'N'                        B1
     C           WW10F6    ANDEQ'N'
     C           *INKC     OREQ '1'
     C           *INKL     OREQ '1'
      *
     C           WWFRST    IFEQ 'Y'                        B2
     C           WWIN25    ANDEQ'1'
     C                     EXFMTPM0710F2
     C                     MOVE 'Y'       WW10F2  1
     C                     MOVE 'N'       WW10F6  1
     C                     MOVE 'N'       WWFRST
     C                     END                             E2
      *
     C           WWFRST    IFEQ 'Y'                        B2
     C           WWIN26    ANDEQ'1'
     C           DDADC4    IFNE *BLANKS                    B3
     C                     EXFMTPM0710F6
     C                     MOVE 'N'       WW10F2
     C                     MOVE 'Y'       WW10F6
     C                     MOVE 'N'       WWFRST
     C                     ELSE                            X3
     C                     EXFMTPM0710F2
     C                     MOVE 'Y'       WW10F2  1
     C                     MOVE 'N'       WW10F6  1
     C                     MOVE 'N'       WWFRST
     C                     END                             E3
     C                     END                             E2
      *
     C           WW10F2    IFEQ 'Y'                        B2
     C           *IN25     ANDEQ'1'
     C           DDADC4    IFNE *BLANKS                    B3
     C                     EXFMTPM0710F6
     C                     MOVE 'N'       WW10F2
     C                     MOVE 'Y'       WW10F6  1
     C                     ELSE                            X3
     C                     MOVE 'N'       WW10F2
     C                     MOVE 'N'       WW10F6
     C                     END                             E3
     C                     END                             E2
      *
     C           WW10F6    IFEQ 'Y'                        B2
     C           *IN26     ANDEQ'1'
     C                     EXFMTPM0710F2
     C                     MOVE 'Y'       WW10F2
     C                     MOVE 'N'       WW10F6
     C                     END                             E2
      *
     C           WW10F2    IFEQ 'Y'                        B2
     C           *IN26     ANDEQ'1'
     C           WW10F6    OREQ 'Y'
     C           *IN25     ANDEQ'1'
     C                     MOVE 'N'       WW10F2
     C                     MOVE 'N'       WW10F6
     C                     END                             E2
      *                                                                   33616
     C  N26N25             SETON                     26                   33616
      *                                                                   33616
     C                     END                             E1
      *
     C                     ENDSR
      **
     C           #W03      BEGSR
      **
     C           WWFLG3    IFEQ *BLANK
      **
     C                     MOVEL'Y'       WWFLG3
      **
      ***SET*THE*DATE*ASSUMED*RESPONSIBILITY                              S01313
     C*********************MOVE QMDTA1    DDDASS                          S01313
      ***SET*LANGUAGE*SPOKEN**********************************************080702
     C***********          MOVELQBLANG    DDLANG                          080702
      ** SET THE DATE OF BIRTH
     C                     MOVE QMBDA1    DDBDAT
      ** SET CUSTOMER BASE CURRENCY
     C                     MOVELQMCSBY    DDCSBY
      ** SET SAFE INDICATOR
     C                     MOVELQBSAFI    DDSAFI
      ** SET DOCUMENTATION STATUS
     C                     MOVELQBDCMS    DDDCMS
      ** SET FPV DOCUMENT
     C***********          MOVELQBFPVC    DDFPVC                          B9383
      *                                                                   CPM005
     C           QMDLCS    IFEQ *BLANKS                                   CPM005
      *                                                                   R10015
      ** ACCESS SDPLCSPD WITH CUSTOMER NUMBER                             R10015
      *                                                                   R10015
     C***********WWCUST    CHAINSDPLCSPD             77             R10015080702
     C                     CALL 'AOPLCSR0'                                080702
     C                     PARM '*MSG    'WWRTCD  7                       080702
     C                     PARM '*KEY    'WWOPTN  7                       080702
     C                     PARM WWCUST    WWKY10 10                       080702
     C           SDPLCS    PARM SDPLCS    DSSDY                           080702
      **                                                                  R10015
     C************IN77     IFEQ '1'                        *********R10015080702
     C           WWRTCD    IFNE *BLANKS                                   080702
     C                     Z-ADD5         QMERRN           * DB ERROR 05 *R10015
     C                     MOVEL'SDPLCSPD'QMFILE           ***************R10015
     C                     MOVELWWCUST    QMKEY                           R10015
     C                     EXSR *PSSR                                     R10015
     C                     END                                            R10015
      *                                                                   CPM005
     C                     MOVE QBINSU    DDS9VR                          CPM005
     C                     MOVE QBCYSU    DDS0VR                          CPM005
      *                                                                   CPM005
     C                     ELSE                                           CPM005
      *                                                                   CPM005
      ** ACCESS PMPCSDPD WITH CUSTOMER NUMBER                             CPM005
      *                                                                   CPM005
     C           WWCUST    CHAINPMPCSDPD             77                   CPM005
      **                                                                  CPM005
     C           *IN77     IFEQ '1'                        ***************CPM005
     C                     Z-ADD7         QMERRN           * DB ERROR 07 *CPM005
     C                     MOVE 'PMPCSDPD'QMFILE           ***************CPM005
     C                     MOVELWWCUST    QMKEY                           CPM005
     C                     EXSR *PSSR                                     CPM005
     C                     END                                            CPM005
      *                                                                   CPM005
     C                     MOVE QBS9VR    DDS9VR                          CPM005
     C                     MOVE QBS0VR    DDS0VR                          CPM005
      *                                                                   CPM005
     C                     END                                            CPM005
      **                                                                  R10015
      ** SET THE VALUATION FREQUENCY                                      R10015
     C                     MOVE QBVLFQ    DDVLFQ                          R10015
      ** SET THE DAY IN MONTH                                             R10015
     C                     MOVE QBVLDM    DDVLDM                          R10015
     C                     MOVE QBS1VR    DDS1VR                          S01313
     C                     MOVE QBS2VR    DDS2VR                          R10015
     C                     MOVE QBS3VR    DDS3VR                          R10015
     C                     MOVE QBS4VR    DDS4VR                          R10015
     C                     MOVE QBS5VR    DDS5VR                          R10015
     C                     MOVE QBS6VR    DDS6VR                          R10015
     C                     MOVE QBS7VR    DDS7VR                          S01313
     C                     MOVE QBS8VR    DDS8VR                          S01313
      ** SET THE NEXT VALUATION DATE                                      R10015
     C           QBVLND    IFNE 0                                         R10015
     C                     Z-ADDQBVLND    ZDAYNO                          R10015
     C                     EXSR ZDATE2                                    R10015
     C                     MOVELZDATE     DDVLND                          R10015
     C                     ELSE                                           R10015
     C                     MOVEL*BLANKS   DDVLND                          R10015
     C                     END                                            R10015
      **
      ***LOMBARD*CREDIT*DETAILS*******************************************080702
      ** PORTFOLIO LENDING DETAILS                                        080702
      **
      ** ACCESS SDLBCSPD WITH CUSTOMER NUMBER
      **
     C***********WWCUST    CHAINSDLBCSL9             73                   080702
     C                     CALL 'AOLBCSR0'                                080702
     C                     PARM *BLANKS   PRTCD   7                       080702
     C                     PARM '*KEY'    POPTN   7                       080702
     C                     PARM WWCUST    PLCUS  10                       080702
     C           SDLBCS    PARM SDLBCS    DSFDY                           080702
      **
     C************IN73     IFEQ '1'                                       080702
     C           PRTCD     IFNE *BLANKS                                   080702
     C                     MOVE '1'       *IN50            NON CUSTOMER
     C                     ELSE
      ** SET CUSTOMER BASE CURRENCY
     C                     MOVELCUCCY     DDCCY
      ** SET PLEDGES RECEIVED
     C                     MOVELCUINBP    DDINBP
      ** SET PLEDGES CALCULATION
     C                     MOVELCUPLEC    DDPLEC
      ** SET REPORT DATE, FREQUENCY AND DAY NUMBER
     C           CUREPD    IFNE 0
     C                     Z-ADDCUREPD    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDREPD
     C                     ELSE
     C                     MOVEL*BLANKS   DDREPD
     C                     END
      **
     C                     MOVELCUREPF    DDREPF
      **
     C           CUREPN    IFNE 0
     C                     MOVELCUREPN    DDREPN
     C                     ELSE
     C                     MOVEL*BLANKS   DDREPN
     C                     END
      **
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM0710CCP2                                           S01408
     C*                                                                   S01408
      ***********                                                         080702
      ***FIDUCIARY*DETAILS************************************************080702
      ***********                                                         080702
      ***ACCESS*SDFICSL0**************************************************080702
      ***********                                                         080702
     C***********WWCUST    CHAINSDFICSL0             74                   080702
      ***********                                                         080702
     C************IN74     IFEQ '1'                                       080702
     C***********          MOVE '1'       *IN51                           080702
     C***********          ELSE                                           080702
      ***SET*STANDARD*COMMISSION*CODE*LOAN*&*DEPOSIT**********************080702
     C***********          MOVELFBSCDL    DDSCDL                          080702
     C***********          MOVELFBSCDD    DDSCDD                          080702
      ***SET*%*OF*STANDARD*COMMISSION*LOAN*&DEPOSIT***********************080702
     C***********FBPSCL    IFEQ 0                                         080702
     C***********          MOVEL*BLANKS   DDPSCL                          080702
     C***********          ELSE                                           080702
     C***********          MOVEL*BLANKS   ZFIELD                          080702
     C***********          MOVE FBPSCL    ZFIELD                          080702
     C***********          Z-ADD8         ZADEC                           080702
     C***********          Z-ADD3         ZADIG                           080702
     C***********          EXSR ZEDIT                                     080702
     C***********          MOVE ZFIELD    DDPSCL                          080702
     C***********          END                                            080702
     C***********FBPSCD    IFEQ 0                                         080702
     C***********          MOVEL*BLANKS   DDPSCD                          080702
     C***********          ELSE                                           080702
     C***********          MOVEL*BLANKS   ZFIELD                          080702
     C***********          MOVE FBPSCD    ZFIELD                          080702
     C***********          Z-ADD8         ZADEC                           080702
     C***********          Z-ADD3         ZADIG                           080702
     C***********          EXSR ZEDIT                                     080702
     C***********          MOVE ZFIELD    DDPSCD                          080702
     C***********          END                                            080702
      ***SET*NO*COMMISSION*LOAN*&*DEPOSIT*********************************080702
     C***********          MOVELFBNCL     DDNCL                           080702
     C***********          MOVELFBNCD     DDNCD                           080702
      ***SET*%*OF*CCOMMISSION*TO*ADVISER**********************************080702
     C***********FBPFCA    IFEQ 0                                         080702
     C***********          MOVEL*BLANKS   DDPFCA                          080702
     C***********          ELSE                                           080702
     C***********          MOVEL*BLANKS   ZFIELD                          080702
     C***********          MOVE FBPFCA    ZFIELD                          080702
     C***********          Z-ADD8         ZADEC                           080702
     C***********          Z-ADD3         ZADIG                           080702
     C***********          EXSR ZEDIT                                     080702
     C***********          MOVE ZFIELD    DDPFCA                          080702
     C***********          END                                            080702
      ***SET*EXEMPT*FROM*PAYM.*CHARGES************************************080702
     C***********          MOVELFBEPCH    DDEPCH                          080702
      ***********                                                         080702
     C***********          END                                            080702
      ***********                                                         080702
     C                     END
      ** DISPLAY SCREEN
     C           PAR1      IFNE 'A'                                       CPM005
     C                     EXFMTPM0710F3
     C                     END                                            CPM005
      *
     C                     ENDSR                           **#W03  ESR**
     C**
     C           #W04      BEGSR
      **
     C           WWFLG4    IFEQ *BLANK
      **
     C                     MOVEL'Y'       WWFLG4
      **
      ** ACCESS SECURITIES TRADING ICD
      **
     C***********1         SETLLSDSTRDPD                                  080702
     C***********          READ SDSTRDPD                 74               080702
     C                     CALL 'AOSTRDR0'                                080702
     C                     PARM *BLANKS   WWRTCD  7                       080702
     C                     PARM '*FIRST ' WWOPTN  7                       080702
     C           SDSTRD    PARM SDSTRD    DSFDY                           080702
     C**
     C************IN74     IFEQ '1'                        ***************080702
     C           WWRTCD    IFNE *BLANKS                                   080702
     C                     Z-ADD2         QMERRN           * DB ERROR 02 *
     C                     MOVEL'SDSTRDPD'QMFILE           ***************
     C                     MOVEL*BLANKS   QMKEY
     C                     EXSR *PSSR
     C                     END
     C**
     C** ACCESS SDSECSL1 WITH CUSTOMER NUMEBR
     C**
     C***********WWCUST    CHAINSDSECSL1             75                   080702
     C                     CALL 'AOSECSR0'                                080702
     C                     PARM '*MSG    'WWRTCD                          080702
     C                     PARM '*KEY    'WWOPTN                          080702
     C                     PARM WWCUST    WWCFGC  6                       080702
     C           SDSECS    PARM SDSECS    DSSDY                           080702
     C**
     C************IN75     IFEQ '0'                                       080702
     C           WWRTCD    IFEQ *BLANKS                                   080702
     C** SET CLASSIFICATION
     C                     MOVELBFCLAS    DDCLAS
     C** SET ACCOUNT CODE/SEQUENCE
     C                     MOVELBFACCD    DDACCD
     C           BFACSN    IFEQ 0
     C                     MOVEL*BLANKS   DDACSN
     C                     ELSE
     C                     MOVE BFACSN    DDACSN
     C                     END
     C** SET STATEMENT FREQUENCY
     C                     MOVELBFSTFQ    DDSTFQ
     C** SET NEXT STATEMENT DATE
     C           BFNSDT    IFNE 0
     C                     Z-ADDBFNSDT    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDNSDT
     C                     ELSE
     C                     MOVEL*BLANKS   DDNSDT
     C                     END
     C** SET STATEMENT BASE DATE
     C           BFSBDM    IFNE 0
     C                     MOVE BFSBDM    DDSBDM
     C                     ELSE
     C                     MOVEL*BLANKS   DDSBDM
     C                     END
     C** SET ALTERNATIVE NAME/ADDRESS
     C                     MOVELBFADCD    DDADCD
     C** SET STATUTORY RETURNS CODE
     C                     MOVELBFSRCD    DDSRCD
     C** SET SET CEDEL FUNGIBILITY IND.
     C                     MOVELBFCFIN    DDCFIN
     C** SET PLEDGE AGREEMENT
     C                     MOVELBFPLAG    DDPLAG
     C** SET TAX CODE
     C                     MOVELBFTCD     DDTCD
     C** SET AUTO SETTLE INDICATOR
     C                     MOVELBFASIN    DDASIN
     C** SET NARRATIVE
     C                     MOVELBFNARR    DDNARR
     C** SET DEPOT NAME, REFERENCE AND PARTIC.
     C******************** MOVEL*BLANKS   NAM                             R10033
     C******************** MOVEL*BLANKS   SNM                             R10033
     C********************                                                R10033
     C******************** MOVELBVCUST    NAM,1                           R10033
     C******************** MOVELBVDR2     NAM,2                           R10033
     C******************** MOVELBVDR3     NAM,3                           R10033
     C******************** MOVELBVDR4     NAM,4                           R10033
     C******************** MOVELBVDR5     NAM,5                           R10033
     C******************** MOVELBVDR6     NAM,6                           R10033
     C******************** MOVELBVDR7     NAM,7                           R10033
     C******************** MOVELBVDR8     NAM,8                           R10033
     C******************** MOVELBVDR9     NAM,9                           R10033
     C******************** MOVELBVDR10    NAM,10                          R10033
     C********************                                                R10033
     C** CHAIN ON CUSTOMER FILE TO GET SHORT NAME                         R10033
     C********************                                                R10033
     C******************** Z-ADD1         X       20                      R10033
     C********************                                                R10033
     C********** X ******* DOUGT10                                        R10033
     C********** NAM,X *** IFNE *BLANKS                                   R10033
     C********** NAM,X *** CHAINSDCUSTL0             72                   R10033
     C********************                                                R10033
     C********************                                                R10033
     C** DATA BASE ERROR                                                  R10033
     C********************                                                R10033
     C********** *IN72 *** IFEQ '1'                        ***************R10033
     C******************** Z-ADD4         QMERRN           * DB ERROR 04 *R10033
     C******************** MOVEL'SDCUSTL0'QMFILE           ***************R10033
     C******************** MOVELNAM,X     QMFILE                          R10033
     C******************** EXSR *PSSR                                     R10033
     C******************** ELSE                                           R10033
     C** SHORT NAME FOUND                                                 R10033
     C******************** MOVELBBCSSN    SNM,X                           R10033
     C******************** END                                            R10033
     C********************                                                R10033
     C******************** ELSE                                           R10033
     C********************                                                R10033
     C******************** MOVEL*BLANKS   SNM,X                           R10033
     C********************                                                R10033
     C******************** END                                            R10033
     C********************                                                R10033
     C******************** ADD  1         X                               R10033
     C********************                                                R10033
     C******************** END                                            R10033
     C********************                                                R10033
     C******************** MOVELSNM,1     DDDP01                          R10033
     C******************** MOVELSNM,2     DDDP02                          R10033
     C******************** MOVELSNM,3     DDDP03                          R10033
     C******************** MOVELSNM,4     DDDP04                          R10033
     C******************** MOVELSNM,5     DDDP05                          R10033
     C******************** MOVELSNM,6     DDDP06                          R10033
     C******************** MOVELSNM,7     DDDP07                          R10033
     C******************** MOVELSNM,8     DDDP08                          R10033
     C******************** MOVELSNM,9     DDDP09                          R10033
     C******************** MOVELSNM,10    DDDP10                          R10033
     C********************                                                R10033
     C********************                                                R10033
     C******************** MOVELBFDRF1    DDRF01                          R10033
     C******************** MOVELBFDRF2    DDRF02                          R10033
     C******************** MOVELBFDRF3    DDRF03                          R10033
     C******************** MOVELBFDRF4    DDRF04                          R10033
     C******************** MOVELBFDRF5    DDRF05                          R10033
     C******************** MOVELBFDRF6    DDRF06                          R10033
     C******************** MOVELBFDRF7    DDRF07                          R10033
     C******************** MOVELBFDRF8    DDRF08                          R10033
     C******************** MOVELBFDRF9    DDRF09                          R10033
     C******************** MOVELBFDRF0    DDRF10                          R10033
     C********************                                                R10033
     C******************** MOVELBFPNP1    DDPR01                          R10033
     C******************** MOVELBFPNP2    DDPR02                          R10033
     C******************** MOVELBFPNP3    DDPR03                          R10033
     C******************** MOVELBFPNP4    DDPR04                          R10033
     C******************** MOVELBFPNP5    DDPR05                          R10033
     C******************** MOVELBFPNP6    DDPR06                          R10033
     C******************** MOVELBFPNP7    DDPR07                          R10033
     C******************** MOVELBFPNP8    DDPR08                          R10033
     C******************** MOVELBFPNP9    DDPR09                          R10033
     C******************** MOVELBFPNP0    DDPR10                          R10033
     C**
     C                     END
     C**
     C                     END
     C**
     C           PAR1      IFNE 'A'                                       CPM005
     C                     EXFMTPM0710F4
     C                     END                                            CPM005
      **
     C                     ENDSR
     C**
     C***********#W05      BEGSR                                          080702
     C***********                                                         080702
     C***********WWFLG5    IFEQ *BLANK                                    080702
     C***********                                                         080702
     C***********          MOVEL'Y'       WWFLG5                          080702
     C***********                                                         080702
     C***ACCESS*SDFOCSL0**************************************************080702
     C***********                                                         080702
     C***********WWCUST    CHAINSDFOCSL0             76                   080702
     C***********                                                         080702
     C************IN76     IFEQ '0'                                       080702
     C***SET*BROKER*******************************************************080702
     C***********          MOVELBHBKIN    DDBKIN                          080702
     C***SET*SETTLEMENT*TYPE**********************************************080702
     C***********          MOVELBHSTTY    DDSTTY                          080702
     C***SET*SETTLEMENT*ACCOUNT*******************************************080702
     C***********          MOVELBHSMAC    DDSMAC                          080702
     C***SET*COUNTERPARTY*NOSTRO******************************************080702
     C***********          MOVELBHCPNO    DDCPNO                          080702
     C***SET*FOR*ACCOUNT*OF***********************************************080702
     C***********          MOVELBHFACO    DDFACO                          080702
     C***SET*CORRESPONDANCE*ADDRESS***************************************080702
     C***********          MOVELBHCOAD    DDCOAD                          080702
     C***SET*FOR*THE*ATTENTION*OF*****************************************080702
     C***********          MOVELBHFTAO    DDFTAO                          080702
     C***SET*TELEX*CONFIRMATION*******************************************080702
     C***********          MOVELBHTXCI    DDTXCI                          080702
     C***SET*CONTRACT*LIMIT***********************************************080702
     C***********BHCTLM    IFNE 0                                         080702
     C***********          MOVE BHCTLM    DDCTLM                          080702
     C***********          ELSE                                           080702
     C***********          MOVEL*BLANKS   DDCTLM                          080702
     C***********          END                                            080702
     C***SET*POSITION*COMBINED********************************************080702
     C***********          MOVELBHPCIN    DDPCIN                          080702
     C***SET*AUTOMATIC*CLOSURE********************************************080702
     C***********          MOVELBHACIN    DDACIN                          080702
     C***SET*COLLATERAL*CURRENCY******************************************080702
     C***********          MOVELBHCYCD    DDCYCD                          080702
     C***SET*COLLATERAL*AMOUNT********************************************080702
     C***********BHCOAM    IFNE 0                                         080702
     C***********          Z-ADDBHCOAM    ZFLD15                          080702
     C***********BHCYCD    CHAINSDCURRL0             76                   080702
     C***********                                                         080702
     C************IN76     IFEQ '1'                        ***************080702
     C***********          Z-ADD3         QMERRN           * DB ERROR 03 *080702
     C***********          MOVEL'SDCURRL0'QMFILE           ***************080702
     C***********          MOVELBHCYCD    QMKEY                           080702
     C***********          EXSR *PSSR                                     080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********          Z-ADDA6NBDP    ZDECS                           080702
     C***********          EXSR ZSEDIT                                    080702
     C***********          MOVE ZOUT21    DDCOAM                          080702
     C***********          ELSE                                           080702
     C***********          MOVEL*BLANKS   DDCOAM                          080702
     C***********          END                                            080702
     C***SET*COLLATERAL*DESCRIPTION***************************************080702
     C***********          MOVELBHCODE    DDCODE                          080702
     C***SET*STATEMENT*AND*REVALUATION*FREQUENCY,*BASE*DAY*AND*NEXT*DATE**080702
     C***********          MOVELBHSTFQ    DDSTFQ                          080702
     C***********          MOVELBHRVFQ    DDRVFQ                          080702
     C***********                                                         080702
     C***********BHDMFS    IFEQ 0                                         080702
     C***********          MOVEL*BLANKS   DDDMFS                          080702
     C***********          ELSE                                           080702
     C***********          MOVE BHDMFS    DDDMFS                          080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********BHRVBD    IFEQ 0                                         080702
     C***********          MOVEL*BLANKS   DDRVBD                          080702
     C***********          ELSE                                           080702
     C***********          MOVE BHRVBD    DDRVBD                          080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********BHNSDT    IFNE 0                                         080702
     C***********          Z-ADDBHNSDT    ZDAYNO                          080702
     C***********          EXSR ZDATE2                                    080702
     C***********          MOVELZADATE    DDNSDT                          080702
     C***********          ELSE                                           080702
     C***********          MOVEL*BLANKS   DDNSDT                          080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********BHNRDT    IFNE 0                                         080702
     C***********          Z-ADDBHNRDT    ZDAYNO                          080702
     C***********          EXSR ZDATE2                                    080702
     C***********          MOVELZADATE    DDNRDT                          080702
     C***********          ELSE                                           080702
     C***********          MOVEL*BLANKS   DDNRDT                          080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********          EXFMTPM0710F5                                  080702
     C***********                                                         080702
     C***********          ENDSR                                          080702
     C***********                                                         080702
     C           #BLANK    BEGSR
     C**
     C                     MOVEL*BLANKS   DDCUST
     C                     MOVEL*BLANKS   DDCNA1
     C                     MOVEL*BLANKS   DDCSSN
     C                     MOVEL*BLANKS   DDCNA2
     C                     MOVEL*BLANKS   DDCNA3
     C                     MOVEL*BLANKS   DDCNA4
     C                     MOVEL*BLANKS   DDCRNM
     C                     MOVEL*BLANKS   DDCRTN
     C                     MOVEL*BLANKS   DDPAIN
     C                     MOVEL*BLANKS   DDPCNB
     C                     MOVEL*BLANKS   DDACOC
     C                     MOVEL*BLANKS   DDCASC
     C                     MOVEL*BLANKS   DDCNCZ
     C                     MOVEL*BLANKS   DDBRCD
     C                     MOVEL*BLANKS   DDCOLC
     C                     MOVEL*BLANKS   DDBSIN
     C                     MOVEL*BLANKS   DDSSDT
     C                     MOVEL*BLANKS   DDBNBI
     C                     MOVEL*BLANKS   DDDOIC
     C                     MOVEL*BLANKS   DDLINC
     C                     MOVEL*BLANKS   DDCTNB
     C                     MOVEL*BLANKS   DDLICD
     C                     MOVEL*BLANKS   DDREID
     C                     MOVEL*BLANKS   DDTAIN
     C                     MOVEL*BLANKS   DDCSTY
     C*********************MOVEL*BLANKS   DDDASS                          S01313
     C***********          MOVEL*BLANKS   DDLANG                          080702
     C                     MOVEL*BLANKS   DDBDAT
     C                     MOVEL*BLANKS   DDCSBY
     C                     MOVEL*BLANKS   DDSAFI
     C                     MOVEL*BLANKS   DDDCMS
     C***********          MOVEL*BLANKS   DDFPVC                          B9383
     C                     MOVEL*BLANKS   DDVLFQ                          R10015
     C                     MOVEL*BLANKS   DDVLDM                          R10015
     C                     MOVEL*BLANKS   DDVLND                          R10015
     C                     MOVEL*BLANKS   DDS2VR                          R10015
     C                     MOVEL*BLANKS   DDS3VR                          R10015
     C                     MOVEL*BLANKS   DDS4VR                          R10015
     C                     MOVEL*BLANKS   DDS5VR                          R10015
     C                     MOVEL*BLANKS   DDS6VR                          R10015
     C                     MOVEL*BLANKS   DDCCY
     C                     MOVEL*BLANKS   DDINBP
     C                     MOVEL*BLANKS   DDPLEC
     C                     MOVEL*BLANKS   DDREPD
     C                     MOVEL*BLANKS   DDREPF
     C                     MOVEL*BLANKS   DDREPN
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM0710CCP3                                           S01408
     C*                                                                   S01408
     C***********          MOVEL*BLANKS   DDSCDL                          080702
     C***********          MOVEL*BLANKS   DDSCDD                          080702
     C***********          MOVEL*BLANKS   DDPSCL                          080702
     C***********          MOVEL*BLANKS   DDPSCD                          080702
     C***********          MOVEL*BLANKS   DDNCL                           080702
     C***********          MOVEL*BLANKS   DDNCD                           080702
     C***********          MOVEL*BLANKS   DDPFCA                          080702
     C***********          MOVEL*BLANKS   DDEPCH                          080702
     C                     MOVEL*BLANKS   DDCLAS
     C                     MOVEL*BLANKS   DDACCD
     C                     MOVEL*BLANKS   DDACSN
     C                     MOVEL*BLANKS   DDSTFQ
     C                     MOVEL*BLANKS   DDNSDT
     C                     MOVEL*BLANKS   DDSBDM
     C                     MOVEL*BLANKS   DDADCD
     C                     MOVEL*BLANKS   DDSRCD
     C                     MOVEL*BLANKS   DDCFIN
     C                     MOVEL*BLANKS   DDPLAG
     C                     MOVEL*BLANKS   DDTCD
     C                     MOVEL*BLANKS   DDASIN
     C                     MOVEL*BLANKS   DDNARR
     C******************** MOVEL*BLANKS   DDDP01                          TA0000
     C******************** MOVEL*BLANKS   DDRF01                          TA0000
     C******************** MOVEL*BLANKS   DDPR01                          TA0000
     C******************** MOVEL*BLANKS   DDDP02                          TA0000
     C******************** MOVEL*BLANKS   DDRF02                          TA0000
     C******************** MOVEL*BLANKS   DDPR02                          TA0000
     C******************** MOVEL*BLANKS   DDDP03                          TA0000
     C******************** MOVEL*BLANKS   DDRF03                          TA0000
     C******************** MOVEL*BLANKS   DDPR03                          TA0000
     C******************** MOVEL*BLANKS   DDDP04                          TA0000
     C******************** MOVEL*BLANKS   DDRF04                          TA0000
     C******************** MOVEL*BLANKS   DDPR04                          TA0000
     C******************** MOVEL*BLANKS   DDDP05                          TA0000
     C******************** MOVEL*BLANKS   DDRF05                          TA0000
     C******************** MOVEL*BLANKS   DDPR05                          TA0000
     C******************** MOVEL*BLANKS   DDDP06                          TA0000
     C******************** MOVEL*BLANKS   DDRF06                          TA0000
     C******************** MOVEL*BLANKS   DDPR06                          TA0000
     C******************** MOVEL*BLANKS   DDDP07                          TA0000
     C******************** MOVEL*BLANKS   DDRF07                          TA0000
     C******************** MOVEL*BLANKS   DDPR07                          TA0000
     C******************** MOVEL*BLANKS   DDDP08                          TA0000
     C******************** MOVEL*BLANKS   DDRF08                          TA0000
     C******************** MOVEL*BLANKS   DDPR08                          TA0000
     C******************** MOVEL*BLANKS   DDDP09                          TA0000
     C******************** MOVEL*BLANKS   DDRF09                          TA0000
     C******************** MOVEL*BLANKS   DDPR09                          TA0000
     C******************** MOVEL*BLANKS   DDDP10                          TA0000
     C******************** MOVEL*BLANKS   DDRF10                          TA0000
     C******************** MOVEL*BLANKS   DDPR10                          TA0000
     C***********          MOVEL*BLANKS   DDBKIN                          080702
     C***********          MOVEL*BLANKS   DDSTTY                          080702
     C***********          MOVEL*BLANKS   DDSMAC                          080702
     C***********          MOVEL*BLANKS   DDCPNO                          080702
     C***********          MOVEL*BLANKS   DDFACO                          080702
     C***********          MOVEL*BLANKS   DDCOAD                          080702
     C***********          MOVEL*BLANKS   DDFTAO                          080702
     C***********          MOVEL*BLANKS   DDTXCI                          080702
     C***********          MOVEL*BLANKS   DDCTLM                          080702
     C***********          MOVEL*BLANKS   DDPCIN                          080702
     C***********          MOVEL*BLANKS   DDACIN                          080702
     C***********          MOVEL*BLANKS   DDCYCD                          080702
     C***********          MOVEL*BLANKS   DDCOAM                          080702
     C***********          MOVEL*BLANKS   DDCODE                          080702
     C                     MOVEL*BLANKS   DDSTFQ
     C***********          MOVEL*BLANKS   DDRVFQ                          080702
     C***********          MOVEL*BLANKS   DDDMFS                          080702
     C***********          MOVEL*BLANKS   DDRVBD                          080702
     C                     MOVEL*BLANKS   DDNSDT
     C***********          MOVEL*BLANKS   DDNRDT                          080702
     C                     MOVEL*BLANKS   DDS0VR                          CPM005
     C                     MOVEL*BLANKS   DDS9VR                          CPM005
     C**
     C                     ENDSR
     C***********ZDATE2    BEGSR                           *** ZDATE2 *** 080702
     C***********                                                         080702
     C*****CLEAR*LEAP*YEAR*WORK*FIELD.************************************080702
     C***********          MOVE 'N'       ZLEAP   1                       080702
     C***********                                                         080702
     C*****CLEAR*DATE*FIELDS.*********************************************080702
     C***********          Z-ADD0         ZDATE   60                      080702
     C***********          MOVEL'       ' ZADATE  7                       080702
     C***********                                                         080702
     C*****CALCULATION*TO*DEFINE*INPUT*DAY*NUMBER.************************080702
     C***********          Z-ADDZDAYNO    ZDAYNO  50                      080702
     C***********                                                         080702
     C*****DETERMINE*YEAR*NUMBER.*****************************************080702
     C***********                                                         080702
     C*****ADJUST*DAY*NUMBER*IN*CASE*LAST*DAY*OF*YEAR.********************080702
     C***********ZDAYNO    SUB  1         ZDAYN1  50                      080702
     C***********ZDAYN1    IFLT 0                                         080702
     C***********          GOTO ZDEND2                                    080702
     C***********          END                                            080702
     C***********                                                         080702
     C*****CALCULATE*NUMBER*OF*4*YEAR*SPANS*SINCE*31/12/1971.*************080702
     C***********ZDAYN1    DIV  1461      ZLYR    20                      080702
     C***********          MVR            ZDAYN1           SAVE REMAINING 080702
     C***********                                          DAYS           080702
     C*****CALCULATE*NUMBER*OF*REMAINING*YEARS.***************************080702
     C***********          Z-ADD1         ZWRK2   20                      080702
     C***********ZDTAG1    TAG                             ** ZDTAG1 TAG *080702
     C***********ZDAYN1    IFGE ZYDY,ZWRK2                                080702
     C***********ZWRK2     ADD  1         ZWRK2                           080702
     C***********          GOTO ZDTAG1                                    080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********ZWRK2     SUB  1         ZWRK2                           080702
     C***********                                                         080702
     C*****DECREMENT*DAY*NO.*BY*DAYS*IN*REMAINING*YEARS.******************080702
     C***********ZWRK2     IFNE 0                                         080702
     C***********ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          080702
     C***********          END                                            080702
     C***********                                                         080702
     C*****CALCULATE*ACTUAL*YEAR*NUMBER.**********************************080702
     C***********ZLYR      MULT 4         ZWRK3   30                      080702
     C***********ZWRK3     ADD  72        ZWRK3            BASE IS 1972   080702
     C***********          Z-ADDZWRK3     ZYEAR   20                      080702
     C***********ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           080702
     C***********                                                         080702
     C*****DETERMINE*MONTH*NUMBER.****************************************080702
     C***********                                                         080702
     C*****ADJUST*DAY*NO.*IN*CASE*LAST*DAY*OF*LEAP*YEAR*FEBRUARY.*********080702
     C***********ZWRK2     IFEQ 0                                         080702
     C***********ZDAYN1    IFEQ 59                                        080702
     C***********          MOVE 'Y'       ZLEAP                           080702
     C***********          END                                            080702
     C***********ZDAYN1    IFGE 59                                        080702
     C***********ZDAYN1    SUB  1         ZDAYN1                          080702
     C***********          END                                            080702
     C***********          END                                            080702
     C***********                                                         080702
     C*****CALCULATE*MONTH*NUMBER.****************************************080702
     C***********          Z-ADD2         ZWRK2                           080702
     C***********ZDTAG2    TAG                             ** ZDTAG2 TAG *080702
     C***********ZDAYN1    IFGE ZMDY,ZWRK2                                080702
     C***********ZWRK2     ADD  1         ZWRK2                           080702
     C***********          GOTO ZDTAG2                                    080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********ZWRK2     SUB  1         ZWRK2                           080702
     C***********                                                         080702
     C***********          Z-ADDZWRK2     ZMTH    20       MONTH          080702
     C***********                                                         080702
     C*****DETERMINE*DAY*OF*MONTH.****************************************080702
     C***********                                                         080702
     C*****ADD*BACK*LAST*DAY*OF*YEAR*ADJUSTMENT.**************************080702
     C***********ZDAYN1    ADD  1         ZDAYN1                          080702
     C***********                                                         080702
     C*****CALCULATE*DAY*OF*MONTH.****************************************080702
     C***********ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            080702
     C***********                                                         080702
     C*****ADD*BACK*LEAP*YEAR*29TH*FEBUARY*ADJUSTMENT,*IF*REQUIRED.*******080702
     C***********ZLEAP     IFEQ 'Y'                                       080702
     C***********ZDAY      ADD  1         ZDAY                            080702
     C***********          END                                            080702
     C***********                                                         080702
     C*****FORMAT*DATE,*DDMMYY*OR*MMDDYY.*********************************080702
     C************IN98     IFEQ '0'                                       080702
     C***********          MOVELZDAY      ZWRK4   40                      080702
     C***********          MOVE ZMTH      ZWRK4                           080702
     C***********          ELSE                                           080702
     C***********          MOVE ZDAY      ZWRK4                           080702
     C***********          MOVELZMTH      ZWRK4                           080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********          MOVELZWRK4     ZDATE                           080702
     C***********          MOVE ZYEAR     ZDATE                           080702
     C***********                                                         080702
     C*****FORMAT*ALPHA*DATE,*DDMMMYY.************************************080702
     C***********          MOVELZDAY      ZWRK5   5                       080702
     C***********ZDAY      IFLT 10                                        080702
     C***********          MOVEL' '       ZWRK5                           080702
     C***********          END                                            080702
     C***********          MOVE ZMNM,ZMTH ZWRK5                           080702
     C***********          MOVELZWRK5     ZADATE                          080702
     C***********          MOVE ZYEAR     ZADATE                          080702
     C***********                                                         080702
     C***********ZDEND2    ENDSR                           * ZDEND2 ENDSR*080702
     C***********                                                         080702
      ********************************************************************080702
     C*R*********ZSEDIT    BEGSR                           **  ZSEDIT   * 080702
     C***********                                                         080702
     C**Define/Clear*fields***********************************************080702
     C***********                                                         080702
     C***********          Z-ADDZFLD15    ZFLD15 150                      080702
     C***********          Z-ADDZDECS     ZDECS   10                      080702
     C***********          MOVE ZECODE    ZECODE  1                       080702
     C***********          MOVE *BLANKS   ZOUT21 21                       080702
     C***********                                                         080702
     C********SET*UP*WORK*FIELDS******************************************080702
     C***********                                                         080702
     C***********          Z-ADD0         ZS1                             080702
     C***********          MOVE ' '       ZS2                             080702
     C***********                                                         080702
     C***********          Z-ADD15        Z1      20                      080702
     C***********          Z-ADD20        Z2      20                      080702
     C***********                                                         080702
     C***********15        SUB  ZDECS     ZINTS   20                      080702
     C***********                                                         080702
     C**Check*if*numeric*field*is*negative********************************080702
     C***********                                                         080702
     C***********ZFLD15    IFLT *ZEROS                                    080702
     C***********          MOVE '-'       ZS2,21                          080702
     C***********          Z-SUBZFLD15    ZFLD15                          080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********          Z-ADDZFLD15    WORK15                          080702
     C***********                                                         080702
     C********CHECK*TO*SEE*IF*THERE*ARE*ANY*DECIMAL*PLACES****************080702
     C***********                                                         080702
     C***********ZDECS     CABEQ0         ZS10                            080702
     C***********                                                         080702
     C********SET*UP*DECIMALS*********************************************080702
     C***********                                                         080702
     C***********          Z-ADD*ZEROS    ZCNT    10                      080702
     C***********ZCNT      DOUEQZDECS                                     080702
     C***********          MOVE ZS1,Z1    ZS2,Z2                          080702
     C***********          SUB  1         Z2                              080702
     C***********          ADD  1         ZCNT                            080702
     C***********          SUB  1         Z1                              080702
     C***********          END                                            080702
     C***********                                                         080702
     C********PUT*IN*DECIMAL*PLACE****************************************080702
     C***********                                                         080702
     C***********          MOVE '.'       ZS2,Z2                          080702
     C***********          SUB  1         Z2                              080702
     C***********                                                         080702
     C***********ZS10      TAG                             ** ZS10 TAG ** 080702
     C***********                                                         080702
     C********SET*UP*INTEGERS*********************************************080702
     C***********                                                         080702
     C***********          Z-ADD*ZEROS    CNT3    10                      080702
     C***********Z1        DOUEQ*ZEROS                                    080702
     C***********          MOVE ZS1,Z1    ZS2,Z2                          080702
     C***********          SUB  1         Z1                              080702
     C***********          SUB  1         Z2                              080702
     C***********                                                         080702
     C**If*edit*code*is*'J',*insert*a*','*before*each*group*of*three******080702
     C**digits*-*not*if*beginning*of*array*reached.***********************080702
     C***********                                                         080702
     C***********Z2        IFGT *ZEROS                                    080702
     C***********ZECODE    ANDEQ'J'                                       080702
     C***********          ADD  1         CNT3                            080702
     C***********CNT3      IFEQ 3                                         080702
     C***********          MOVE ','       ZS2,Z2                          080702
     C***********          SUB  1         Z2                              080702
     C***********          Z-ADD*ZEROS    CNT3                            080702
     C***********          END                                            080702
     C***********          END                                            080702
     C***********                                                         080702
     C***********          END                                            080702
     C***********                                                         080702
     C********PUT*IN*LEADING*BLANKS***************************************080702
     C***********                                                         080702
     C***********          Z-ADD1         Z2                              080702
     C***********ZS2,Z2    DOWEQ'0'                                       080702
     C***********ZS2,Z2    OREQ ' '                                       080702
     C***********ZS2,Z2    OREQ ','                                       080702
     C***********          MOVE ' '       ZS2,Z2                          080702
     C***********          ADD  1         Z2                              080702
     C***********Z2        CABEQ22        ZS20                            080702
     C***********          END                                            080702
     C***********                                                         080702
     C********IF*NO*INTEGERS*PUT*IN*LEADING*ZERO**************************080702
     C***********                                                         080702
     C***********ZS20      TAG                             ** ZS20 TAG ** 080702
     C***********                                                         080702
     C***********Z2        IFEQ 22                                        080702
     C***********          SUB  2         Z2                              080702
     C***********          MOVE '0'       ZS2,Z2                          080702
     C***********          ELSE                                           080702
     C***********                                                         080702
     C***********ZS2,Z2    IFEQ '.'                                       080702
     C***********          SUB  1         Z2                              080702
     C***********          MOVE '0'       ZS2,Z2                          080702
     C***********          END                                            080702
     C***********          END                                            080702
     C***********                                                         080702
     C********SET*UP*OUTPUT*FIELD*****************************************080702
     C***********                                                         080702
     C***********          MOVEAZS2       ZOUT21                          080702
     C***********                                                         080702
     C*R*********          ENDSR                                          080702
     C***********ZEDIT     BEGSR                           ***  ZEDIT  ***080702
     C***********                                                         080702
     C*****CALCULATION*TO*DEFINE*NUMBER*STRUCTURE*CONTROL*FIELDS.*********080702
     C***********          Z-ADDZADIG     ZADIG   20                      080702
     C***********          Z-ADDZADEC     ZADEC   10                      080702
     C***********                                                        *080702
     C********SET*UP*WORK*FIELDS******************************************080702
     C***********                                                        *080702
     C***********          MOVEA' '       ZA1                            *080702
     C***********          MOVEA' '       ZA2                            *080702
     C***********                                                        *080702
     C***********          Z-ADD16        Z1      20                     *080702
     C***********          Z-ADD16        Z2      20                     *080702
     C***********                                                        *080702
     C***********16        SUB  ZADEC     ZADEC2  20                     *080702
     C***********                                                        *080702
     C***********                                                         080702
     C***********          MOVEAZFIELD    ZA1                            *080702
     C***********                                                        *080702
     C********CHECK*TO*SEE*IF*THERE*ARE*ANY*DECIMAL*PLACES****************080702
     C***********                                                        *080702
     C***********ZADEC     COMP 0                        91              *080702
     C***91******          GOTO ZT20                                     *080702
     C***********                                                        *080702
     C***********ZT10      TAG                             ** ZT10 TAG ***080702
     C***********                                                        *080702
     C***********                                                        *080702
     C********SET*UP*DECIMALS*********************************************080702
     C***********                                                        *080702
     C***********          MOVE ZA1,Z1    ZA2,Z2                         *080702
     C***********Z1        SUB  1         Z1                             *080702
     C***********Z2        SUB  1         Z2                             *080702
     C***********                                                        *080702
     C***********Z2        COMP 0                        90              *080702
     C***90******          GOTO ZT30                                     *080702
     C***********                                                        *080702
     C********CHECK*IF*END*OF*DECIMALS************************************080702
     C***********                                                        *080702
     C***********Z2        COMP ZADEC2               90                  *080702
     C***90******          GOTO ZT10                                     *080702
     C***********                                                        *080702
     C***********                                                        *080702
     C********PUT*IN*DECIMAL*PLACE****************************************080702
     C***********                                                        *080702
     C***********          MOVE '.'       ZA2,Z2                         *080702
     C***********Z2        SUB  1         Z2                             *080702
     C***********                                                        *080702
     C***********ZT20      TAG                             ** ZT20 TAG ***080702
     C***********                                                        *080702
     C********SET*UP*INTEGERS*********************************************080702
     C***********                                                        *080702
     C***********          MOVE ZA1,Z1    ZA2,Z2                         *080702
     C***********Z1        SUB  1         Z1                             *080702
     C***********Z2        SUB  1         Z2                             *080702
     C***********                                                        *080702
     C***********Z2        COMP 0                    90                  *080702
     C***90******          GOTO ZT20                                     *080702
     C***********                                                        *080702
     C********PUT*IN*LEADING*BLANKS***************************************080702
     C***********                                                        *080702
     C***********ZT30      TAG                             ** ZT30 TAG ***080702
     C***********                                                        *080702
     C***********          Z-ADD1         Z2                             *080702
     C***********                                                        *080702
     C***********ZT40      TAG                             ** ZT40 TAG ***080702
     C***********                                                        *080702
     C***********ZA2,Z2    COMP '0'                  9090                *080702
     C***90******ZA2,Z2    COMP ' '                  9090                *080702
     C***********                                                        *080702
     C***90******          GOTO ZT50                                     *080702
     C***********                                                        *080702
     C***********          MOVE ' '       ZA2,Z2                         *080702
     C***********Z2        ADD  1         Z2                             *080702
     C***********                                                        *080702
     C***********Z2        COMP 16                     90                *080702
     C***90******          GOTO ZT40                                     *080702
     C***********                                                        *080702
     C********IF*NO*INTEGERS*PUT*IN*LEADING*ZERO**************************080702
     C***********                                                        *080702
     C***********ZT50      TAG                             ** ZT50 TAG ***080702
     C***********                                                        *080702
     C***********          Z-ADDZADEC2    Z2                             *080702
     C**N91******Z2        SUB  1         Z2                             *080702
     C***********ZA2,Z2    COMP ' '                      90              *080702
     C***90******          MOVE '0'       ZA2,Z2                         *080702
     C***********                                                        *080702
     C********SET*UP*OUTPUT*FIELD*****************************************080702
     C***********                                                        *080702
     C***********ZT60      TAG                             ** ZT60 TAG ***080702
     C***********                                                        *080702
     C***********          MOVEAZA2       ZFIELD 16                      *080702
     C***********                                                        *080702
     C*R*********ZEND      ENDSR                           ** ZEND **    *080702
      ********************************************************************
     C           *PSSR     BEGSR
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVEL'Y'       QMDBER
     C                     MOVEL'Y'       QMENQT
     C                     MOVEL'PM0710'  QMPGM
     C**
     C***UPDATE**GDA******************************************************080702
     C** UPDATE *LDA                                                      080702
     C**
     C***********          CALL 'PMC1002'                                 080702
     C***********          PARM           WWGDA                           080702
     C                     CALL 'PMC1001'                                 080702
     C                     PARM           WWLDA                           080702
     C**
     C                     DUMP
     C**
     C                     RETRN
     C**
     C                     ENDSR
     C***   ATN - ARRAY TO ENABLE ATTN KEY                                080702
     C***SETATNPGM PGM(PMC0610)                                           080702
     C/EJECT                                                              080702
     C/COPY ZSRSRC,ZSEDITZ3                                               080702
     C/EJECT                                                              080702
     C/COPY ZSRSRC,ZDATE2Z4                                               080702
     C/COPY WNCPYSRC,PM0710CCP4                                           S01408
**  CPY@
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
