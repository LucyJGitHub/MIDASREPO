     H        1                                                           S01486
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Port.Valn Statement:Inst.Breakdn')            *
      *****************************************************************
      *                                                               *
      *  Midas - Portfolio Management                                 *
      *                                                               *
      *  PM0952 - PORTFOLIO VALUATION STATEMENT:                      *
      *           INSTRUMENT BREAKDOWN                                *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. AR1075401          Date 01Jun20               *      
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 182961             Date 21Apr01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 11Oct00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 101118             Date 15Oct96               *
      *                 099985             DATE 15OCT96               *
      *                 097944             DATE 15OCT96               *
      *                 CPM005             DATE 17JUL96               *
      *                 CFF004             DATE 11SEP96               *
      *                 077457             DATE 30NOV95               *
      *                 076371             DATE 30NOV95               *
      *                 S71062             DATE 30NOV95               *
      *                 064394             DATE 22NOV95               *
      *                 063049             DATE 22NOV95               *
      *                 CPM004             DATE 08FEB96               *
      *                 082763             DATE 06FEB95               *
      *                 S01486             DATE 16SEP94               *
      *                 062287             DATE 18OCT93               *
      *                 060140     LJ      DATE 02SEP93               *
      *                 049421             DATE 22JAN93               *
      *                 056459     CH      DATE 25JUN93               *
      *                 056552     LJ      DATE 16JUN93               *
      *                 051986     MF      DATE 16JUN93               *
      *                 051435     MF      DATE 16JUN93               *
      *                 051250     MF      DATE 16JUN93               *
      *                 038233     MF      DATE 16JUN93               *
      *                 48007              DATE 01DEC92               *
      *                 47863              DATE 27NOV92               *
      *                 47719              DATE 24NOV92               *
      *                 46081              DATE 23OCT92               *
      *                 S01313             DATE 26JUL92               *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  AR1075401 - Increase QFOAMT length in PMHOLDPD. Recompiled.  *
      *              (Child: AR1075402)                               *      
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  182961 - Database error occurred due to a blank key field    *
      *           (Instrument Type).  The default Instrument type in  *
      *           PF/SDPORTPD is taken if a blank instrument type is  *
      *           encountered.                                        *
      *  CSD006 - Use correct parameters for Access Objects           *
      *  101118 - Group total wrong. Chain on PMASLIPP must be done   *
      *           with the current position       : FEPOTY = 'C '     *
      *           with the future opened position : FEPOTY = 'FO'     *
      *           with the future closed position : FEPOTY = 'FC'     *
      *  099985 - COMPLETE 97944 - WHEN READ ON PMASLIL0, CHECK IF    *
      *           SAME CUSTOMER, INSTRUMENT SEQUENCE, PORTFOLIO REF., *
      *           POSITION TYPE AND TOTALS TYPE                       *
      *  097944 - WHEN PRINT OF THE GROUP TOTAL, THE FORWARD OPEN     *
      *           POSITION MUST BE INCLUDED IN THESE TOTALS           *
      *  CPM005 - Private Banking Phase 2                             *
      *           Focus Group Changes upgraded to DBA                 *
      *           PBFG/3 - DISLPAY UNREALISED P&L ON FORWARD SE TRADES*
      *           PBFG/5 - INSTRUMENT ASSET/LIABILITY SPLIT           *
      *  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
      *  077457 - FF / PM Interface corrections                       *
      *  076371 - FF / PM Interface corrections                       *
      *  S71062 - FF/PM Interface - PM Changes                        *
      *  064394 - FIELD 'R2OPCL' NOT RESET TO BLANKS                  *
      *  063049 - CORRECT OUTPUT INSTRUMENT TOTALS                    *
      *  CPM004 - Bank Portfolios                                     *
      *  082763 - Valuation Stmt not produced (replace msg id         *
      *           PM95441 by PM95551)                                 *
      *  S01486 - Private Banking upgrade to Release 10               *
      *  062287 - CORRECT OUTPUT OF FX P/L TEXT                       *
      *  060140 - FIELD 'WWPRIC' TOO SMALL                            *
      *  049421 - HEADER BOX STANDARDISATION                          *
      *  056459 - DISPLAY OTHER NOMINAL POSITION ON STATEMENT         *
      *           (REMOVE 51250)                                      *
      *  056552 - VALUATION STATEMENT OUTPUT NARRATIVES DETAILS       *
      *  051986 - FIELD TOO SMALL                                     *
      *  051435 - RECOMPILED DUE TO CHANGES IN PRINTER FILE           *
      *  051250 - DO NOT OUTPUT ZERO POSITIONS FOR HOLDINGS           *
      *  038233 - DECIMAL QUANTITY NOT PRINTED.                       *
      *  48007  - CORRECT DETAILS OUTPUT                              *
      *  47863  - OUTPUT MARKET VALUE & ACCRUED INTEREST USING        *
      *           AMOUNTS ON FILE RATHER THAN DOING CONVERSION        *
      *  47719  - CORRECT CONVERSION OF AMOUNTS BETWEEN CURRENCIES    *
      *  46081  - DISPLAY OTHER POSITION ON STATEMENT                 *
      *  S01313 - REWRITTEN FOR PORTFOLIO PERFORMANCE                 *
      *                                                               *
      *****************************************************************
     F/EJECT
      *****************************************************************
     F*
     F**      FILE DEFINITIONS
     F**     ------------------
     F*
     F*****CURRENCIES*FILE.*PREFIX*-*A6                                   S01486
     F***SDCURRL0IF**E           K        DISK         KINFSR *PSSR       S01486
     F***********                                                   S01313S01486
     F*****CUSTOMERS*FILE.*PREFIX*-*BB******************************S01313S01486
     F***SDCUSTL0IF**E           K        DISK         KINFSR *PSSR S01313S01486
     F***********                                                         S01486
     F**   PM PORTFOLIO TOTALS. PREFIX - QC
     F***PMPOTTPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMPOTTPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*
     F**   PM VALUATION GROUP DETAILS. PREFIX - PC
     F***PMVLGDPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMVLGDPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*
     F*****INSTRUMENT*TYPES.*PREFIX*-*PD**********************************S01486
     F***SDPLINPDIF**E           K        DISK         KINFSR *PSSR       S01486
     F***********                                                         S01486
     F**   Audit Control                                                  S01486
     FPM0952AUO   E                    PRINTER      KINFSR *PSSR      UC  S01486
     F                                              KINFDS SPOOLU         S01486
     F**   TOTAL COMMITMENT LINES AUDIT LIST PRINTER FILE.
     FPM0950P1O   E             21     PRINTER      KINFDS ERF1DS     UC
     F                                              KINFSR *PSSR
     F*
     F**   PORTFOLIO HOLDINGDS BY VALUATION GROUP. PREFIX - QF
     FPMHDVNLLIF  E           K        DISK         KINFSR *PSSR
     F*
     F**   INSTRUMENT TYPE                                                S71062
     FINTYP   IF  E           K        DISK                               S71062
     F                                              KINFSR *PSSR          S71062
     F**   PORTFOLIO ASSET/LIABILITY SPLIT                                CPM005
     FPMASLIL1IF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     FPMASLIL0IF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     F            PMASLID0                          KRENAMEPMASLID3       CPM005
     FSDPORTPDIF  E                    DISK         KINFSR *PSSR          182961
     F*****************************************************************
     F/EJECT
     F*****************************************************************
     F**                                                              *
     F** ID F  C  H  L    FUNCTION OF INDICATORS                      *
     F**                 ------------------------                     *
     F**   21 - OVERFLOW INDICATOR ON PRINTER FILE                    *
     F**      22 - FIRST RECORD READ INDICATOR                        *
     F**      23 - PORTFOLIO CURRENCY HAS NO DECIMAL PLACES           *
     F**      24 - PORTFOLIO CURRENCY HAS 1 DECIMAL PLACE             *
     F**      25 - PORTFOLIO CURRENCY HAS 2 DECIMAL PLACES            *
     F**      26 - PORTFOLIO CURRENCY HAS 3 DECIMAL PLACES            *
     F**      27 - 'PLEDGED' TEXT WRITTEN ON REPORT                   *
     F**      28 - HOLDING PROCESSED INDICATOR                        *
     F**      29 - DO NOT OUTPUT ACCRUED INTEREST DETAILS             *
     F**      30 - CONDITION OUTPUT OF ACCRUED INTEREST DETAILS       *
     F**      31 - CONDITION OUTPUT OF PERCENTAGE ON MARKET VALUE     *
     F**                                                              *
     F********60*-*CHAIN*FAIL*ON*SDCURRL0*********************************S01486
     F********61*-*CHAIN*FAIL*ON*PMPOTTPP*********************************S01486
     F*       61 - CHAIN FAIL ON PMPOTTPD                             *   S01486
     F**      62 - READ FAIL ON PMHDVNLL                              *
     F*       63 - CHAIN FAIL ON PMVLGDPD                             *   S01486
     F********63*-*CHAIN*FAIL*ON*PMVLGDPP*********************************S01486
     F*********4*-*CHAIN*FAIL*ON*SDPLINPD*********************************S01486
     F**      65 - READ PMASLIL1                                      *   CPM005
     F**                                                              *
     F**         98 - USED BY ZDATE2                                  *
     F*****************************************************************
     E/EJECT
     E*****************************************************************
     E*
     E**   ARRAY FOR COPYRIGHT
     E                    CPY@    1   1 80
     E*                                                                   S71062
     E**   Array for standard subroutine FFPRCS                           S71062
      /COPY ZSRSRC,FFPRCSZ2                                               S71062
     E*
     E*****************************************************************
     E/EJECT
     E*****************************************************************
     E*
     E**   ARRAY FOR STANDARD SUBROUTINE ZDATE2
      /COPY ZSRSRC,ZDATE2Z1
     E*
     E*****************************************************************
     E/EJECT
     E*****************************************************************
     E*
     E**   ARRAY FOR STANDARD SUBROUTINE ZSEDIT
      /COPY ZSRSRC,ZSEDITZ1
     E*
     E*****************************************************************
     E/EJECT
     E*****************************************************************
     E*
     E**   ARRAY FOR STANDARD SUBROUTINE ZEDIT
      /COPY ZSRSRC,ZEDITZ1
     E*
     E*****************************************************************
     E/EJECT
     E*****************************************************************
     E*
     E** ARRAY USED IN CURRENCY AMOUNT CONVERSION
      /COPY ZSRSRC,ZPOWERZ1
     E*
     E*****************************************************************
     E/EJECT
     E*****************************************************************
     E*
     E** ARRAY USED TO COUNT CHARACTERS IN NARRATIVE
     E                    AR1        20  1
     E*
     E** ARRAY USED TO OUTPUT UNDERLINE FOR NARRATIVE
     E                    AR2        20  1
     E*
     E** ARRAY USED TO OUTPUT INSTRUMENT TOTALS NARRATIVE
     E                    AR3        43  1
     E*
     E*****************************************************************
     I/EJECT
     I*****************************************************************
     I** RENAME FIELDS                                                    CPM005
     IPMASLID3                                                            CPM005
     I              FECNUM                          F3CNUM                CPM005
     I              FEPTFR                          F3PTFR                CPM005
     I              FEPOTY                          F3POTY                CPM005
     I              FETOTT                          F3TOTT                CPM005
     I              FEDGRC                          F3DGRC                CPM005
     I              FEDGRS                          F3DGRS                CPM005
     I              FEINSC                          F3INSC                CPM005
     I              FEINSS                          F3INSS                CPM005
     I              FEASSV                          F3ASSV                CPM005
     I              FELIAV                          F3LIAV                CPM005
     I*
     I** DATA STRUCTURES FOR COPYRIGHT
     ICPYR@       DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*                                                                   CPM005
     I** DATA STRUCTURE FOR DATABASE ERROR                                CPM005
     IWWERRO      DS                                                      CPM005
     I**********                              1   60K2CNUM                             CPM005 CSD027
     I                                        1   6 K2CNUM                                    CSD027
     I                                        7  10 K2PTFR                CPM005
     I                                       11  12 K2POTY                CPM005
     I                                       13  15 K2DGRC                CPM005
     I                                       16  170K2DGRS                CPM005
     I                                       18  18 K2TOTT                CPM005
     I                                       19  200K2INSS                CPM005
     I*
     I*****************************************************************
     I/EJECT
     I*****************************************************************
     I*
     I** Data structures for standard subroutine FFPRCS                   S71062
      /COPY ZSRSRC,FFSRDSZ1                                               S71062
      /COPY ZSRSRC,FFPRCSZ3                                               S71062
     I** DATA STRUCTURES FOR STANDARD SUBROUTINE ZSEDIT
      /COPY ZSRSRC,ZSEDITZ2
     I*
     I*****************************************************************
     I/EJECT
     I*****************************************************************
     I*
     I** DATA STRUCTURE FOR KEY LIST WWKEY2
     IWWKY2       DS
     I                                        1   5 WWKYL2
     I                                        1   3 WWVALG
     I                                        4   5 WWLNGI
     I*
     I** DATA STRUCTURE FOR RE HOLDINGS INSTRUMENT DESCRIPTION 3
     IWWDTSR      DS
     I**********                              1  20 QFTXT2                                    CGL029
     I                                        1  26 QFTXT2                                    CGL029
     I                                        1  11 WWDTS1
     I**********                             12  15 WWACCD                                    CGL029
     I**********                             16  16 WWDTS2                                    CGL029
     I**********                             17  18 WWACSQ                                    CGL029
     I**********                             19  20 WWDTS3                                    CGL029
     I                                       12  21 WWACCD                                    CGL029
     I                                       22  22 WWDTS2                                    CGL029
     I                                       23  24 WWACSQ                                    CGL029
     I                                       25  26 WWDTS3                                    CGL029
     I*
     I** DATA STRUCTURE USED TO CHANGE YIELD AMOUNT TO REPORT FORMAT
     IWWDATA      DS
     I                                        1  16 ZFIELD
     I                                        1   6 WWVAR1
     I                                        7  11 WWYLDS
     I                                       12  120WWROUN
     I                                       13  130WWHADJ
     I                                       14  16 WWVAR2
     I*
     I**   PROGRAM STATUS DATA STRUCTURE
     IPSDS       SDS
     I                                      244 253 JOB
     I                                      254 263 USER
     I*
     I**   FILE INFORMATION DATA STRUCTURE
     IERF1DS      DS
     I**   FOR OVERFLOW
     I                                    B 367 3680LINE
     I*                                                                   S01486
     ISPOOLU      DS                                                      S01486
     I**    SPOOL FILE INFORMATION DATA STRUCTURE                         S01486
     I                                       83  92 SFILEU                S01486
     I                                    B 123 1240SFNUMU                S01486
     I*
     I**   LOCAL DATA AREA
     ILDA         DS                            256
     I                                      132 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I** DS USED TO PASS PARAMETERS TO CALLED PROGRAMS
     I***WWPARM****E*DSPM095XPP                                           S01486
     IWWPARM    E DSPM095XPD                                              S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              CPM004
     I** DUMMY RECORD FORMAT FOR PM ICD DETAILS                           CPM004
     I*                                                                   CPM004
     ISDCURR    E DSSDCURRPD                                              S01486
     I** DUMMY RECORD FORMAT FOR CURRENCY DETAILS                         S01486
     I*                                                                   S01486
     ISDCUST    E DSSDCUSTPD                                              S01486
     I** DUMMY RECORD FORMAT FOR CUSTOMER DETAILS                         S01486
     I*                                                                   S01486
     ISDPLIN    E DSSDPLINPD                                              S01486
     I** DUMMY RECORD FORMAT FOR INSTRUMENT TYPE DETAILS                  S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01486
     I*                                                                   S01486
     I*                                                                   S71062
     I** Data structure to print nbr of open contracts, P or S            S71062
     I            DS                                                      S71062
     I                                        1  18 R2NMQT                S71062
     I                                        1   1 WWPUSE                S71062
     I                                        7   9 WWNBOC                S71062
     I                                       10  10 WWSIGN                S71062
     I*                                                                   S71062
     I** Data structure to print inst.ccy, Sett.date, Amer. or Europe     S71062
     I            DS                                                      S71062
     I                                        1  23 R2DES5                S71062
     I                                        1   3 WWICCY                S71062
     I                                        7  13 WWSETD                S71062
     I                                       15  22 WWAMEU                S71062
     I*                                                                   S71062
     I** Data structure to print settlement date                          S71062
     I            DS                                                      S71062
     I                                        1   60WKSETD                S71062
     I                                        1   20WWMONT                S71062
     I                                        3   40WWDDAY                S71062
     I                                        5   60WWYEAR                S71062
     I            DS                                                      S71062
     I                                        1   7 WWSDAT                S71062
     I                                        1   2 WWSDAY                S71062
     I                                        3   5 WWSMTH                S71062
     I                                        6   7 WWSYER                S71062
     I*                                                                   S71062
     I** Data structure to print narrative with F&O instrument            S71062
     I            DS                                                      S71062
     I                                        1  40 R2TRNB                S71062
     I                                        1   5 QFFOIS                S71062
     I                                        6  40 WWNAR2                S71062
     I                                        7  22 WWCTGA                S71062
     I                                       24  33 WWSTRK                S71062
     I            DS                                                      S71062
     I                                        1  20 WWTXT2                S71062
     I                                        5   9 WWMTHQ                S71062
     I                                       11  20 WWPCST                S71062
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #INIT    - INITIAL PROCESSING                                    *
      * #P01     - PROCESS HOLDINGS                                      *
      * #P02     - PRODUCE VALUATION GROUP HEADING                       *
      * #P03     - PRODUCE INSTRUMENT TOTALS                             *
      * #P04     - PRODUCE INSTRUMENT TYPE HEADINGS                      *
      * #P05     - ACCESS CURRENCY DETAILS                               *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P08     - PROCESS SE NON INTEREST-BEARING HOLDINGS              *
      * #P09     - PROCESS FF HOLDINGS                                   *
      * #P10     - PROCESS MM DEALS                                      *
      * #P11     - PROCESS FX DEALS AND FRA/IRS                          *
      * #P12     - PROCESS LE HOLDINGS                                   *
      * #P13     - PROCESS RE HOLDINGS                                   *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      * #P15     - PRODUCE RE ACCRUED INTEREST DETAILS                   *
      * #P16     - PRODUCE TOTALS LINE                                   *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * #Y02     - CONVERT YIELD AMOUNTS TO FORMAT REQUIRED ON REPORT    *
      * ZDATE2   - CONVERT 5 FIG DAY NUMBER TO DATE FORMAT               *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * ZCCYXR   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      * SUBR23R3 - MESSAGE RETRIEVING SUBROUTINE                         *
      *                                                                  *
      ********************************************************************
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C                     MOVEACPY@      CPY2@  80
     C*
     C           *ENTRY    PLIST
     C                     PARM           WWPARM
     C*
     C**   PARAMETERS OUTPUT FROM PROGRAM
     C**   ------------------------------
     C*
     C**   VARMSG - 7A MESSAGE ID
     C**   TEXT   - 40A OUTPUT CONTAINING TEXT RETURNED
     C**   LEVEL  - 1N SET TO DEFAULT OF '3'
     C**   RETCD  - 1N NEVER USED
     C**   TXTL   - DEFINES LENGTH OF TEXT TO BE RETURNED (DEFAULT=40)
     C*
     C           SUBR23    PLIST
     C                     PARM           VARMSG  7
     C                     PARM           TEXT   40
     C                     PARM           LEVEL   10
     C                     PARM           RETCD   10
     C                     PARM           TXTL    40
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C**   KEY LISTS USED IN PROGRAM                                  *
     C**   -------------------------                                  *
     C*                                                               *
     C**   KEY LIST FOR 'PMHDVNLL'                                    *
     C           WWKEY1    KLIST                                      *
     C                     KFLD           WWCNUM                      *
     C                     KFLD           WWPTFF                      *
     C*                                                               *
     C*****KEY*LIST*FOR*'PMVLGDPP'****************************************S01486
     C**   KEY LIST FOR 'PMVLGDPD'                                    *   S01486
     C           WWKEY2    KLIST                                      *
     C                     KFLD           WWVALG                      *
     C                     KFLD           WWLANG                      *
      *                                                               *   CPM005
      **  KLIST FOR USE WITH PMASLIL1                                 *   CPM005
     C           PMASL1    KLIST                                      *   CPM005
     C**********           KFLD           K1CNUM  60                  *                CPM005 CSD027
     C                     KFLD           K1CNUM  6                   *                       CSD027
     C                     KFLD           K1PTFR  4                   *   CPM005
     C                     KFLD           K1POTY  2                   *   CPM005
      *                                                               *   CPM005
      **  KLIST FOR USE WITH PMASLIL0                                 *   CPM005
     C           PMASL0    KLIST                                      *   CPM005
     C**********           KFLD           K2CNUM  60                  *                CPM005 CSD027
     C                     KFLD           K2CNUM  6                   *                       CSD027
     C                     KFLD           K2PTFR  4                   *   CPM005
     C                     KFLD           K2POTY  2                   *   CPM005
     C                     KFLD           K2DGRS  20                  *   CPM005
     C                     KFLD           K2DGRC  3                   *   CPM005
     C                     KFLD           K2TOTT  1                   *   CPM005
     C                     KFLD           K2INSS  20                  *   CPM005
     C                     KFLD           K2INSC  3                   *   CPM005
     C*                                                               *
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**              START MAIN
     C**             -------------
     C*
     C**   INITIAL PROCESSING
     C                     EXSR #INIT
     C*
     C**   PROCESS HOLDINGS
     C                     EXSR #P01
     C*
     C**   END PROGRAM
     C                     CLOSEPM0950P1
     C                     RETRN
     C                     MOVE '1'       *INLR
     C*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #INIT    - INITIAL PROCESSING                                    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * SUBR23R3 - MESSAGE RETRIEVING SUBROUTINE                         *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWVLGP   - VALUATION GROUP ON PREVIOUS RECORD ON PMHDVNLL        *
      * WWTVDI   - TRADE/VALUE DATE INDICATOR FROM PMHDVNLL              *
      * WWINST   - INSTRUMENT TYPE ON CURRENT RECORD ON PMHDVNLL         *
      * WWINSP   - INSTRUMENT TYPE ON PREVIOUS RECORD ON PMHDVNLL        *
      * WWCCY1   - CURRENCY 1 ON CURRENT RECORD ON PMHDVNLL              *
      * WWCCYP   - CURRENCY 1 ON PREVIOUS RECORD ON PMHDVNLL             *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WW1DEC   - NUMBER OF DECIMAL PLACES FOR CCY 1 ON PMHDVNLL        *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWTMP1   - USED IN CALCULATION OF PORTFOLIO TOTAL                *
      * WWTMP2   - USED IN CALCULATION OF PORTFOLIO TOTAL                *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWTINT   - TOTAL INSTRUMENT INTEREST                             *
      * WWINTT   - INSTRUMNET TOTAL                                      *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      * WWTMVP   - TOTAL MARKET VALUE IN PORTFOLIO CURRENCY              *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      * WWVALG   - VALUATION GROUP ON CURRENT RECORD ON PMHDVNLL         *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WWRTCD   - RETURN CODE PARAMETER                                 *
      * WWKEY1   - KEY FOR PMHDVNLL (PARAMETERS CNUM AND PORT. REF.)     *
      * WWTVPS   - TRADE/VALUE DATE PARAMETER                            *
      * WWMG16   - 'BUY' NARRATIVE FOR FX DEALS                          *
      * WWMG17   - 'SELL' NARRATIVE FOR FX DEALS                         *
      *                                                                  *
      ********************************************************************
     C*
     C           #INIT     BEGSR
     C*
     C**   INITIALISE DB ERROR FIELDS AND STORE PROGRAM NAME FOR
     C**   DB ERROR FIELD.
     C*
     C                     MOVE *BLANKS   WBFILE 10
     C                     MOVE *BLANKS   WBKEY  29
     C                     Z-ADD*ZEROS    WBASE   30
     C                     MOVEL'PM0952'  WBPGM  10
     C*
     C**   DEFINE WORK FIELDS
     C           *LIKE     DEFN QFVALG    WWVLGP
     C           *LIKE     DEFN QFTVDA    WWTVDI
     C           *LIKE     DEFN QFINNR    WWINST
     C           *LIKE     DEFN QFINNR    WWINSP
     C           *LIKE     DEFN QFCCY1    WWCCY1
     C           *LIKE     DEFN QFCCY1    WWCCYP
     C           *LIKE     DEFN QFCCY2    WWCCY2
     C           *LIKE     DEFN QFCCY2    WWCY2P
     C           *LIKE     DEFN A6SPRT    WWPSPR
     C           *LIKE     DEFN A6NBDP    WWPDEC
     C           *LIKE     DEFN A6NBDP    WWPDCS
     C           *LIKE     DEFN A6MDIN    WWPMDI
     C           *LIKE     DEFN A6SPRT    WW1SPR
     C           *LIKE     DEFN A6NBDP    WW1DEC
     C           *LIKE     DEFN A6MDIN    WW1MDI
     C*
     C**   INITIALISE WORK FIELDS
     C                     Z-ADD*ZEROS    WWPORT 150
     C                     Z-ADD*ZEROS    WWTMP1 150
     C                     Z-ADD*ZEROS    WWTMP2 150
     C                     Z-ADD*ZEROS    WWTIMV 150
     C                     Z-ADD*ZEROS    WWTINT 150
     C                     Z-ADD*ZEROS    WWINTT 150
     C                     Z-ADD*ZEROS    WWWORK 150
     C                     Z-ADD*ZEROS    WWMVPC 150
     C                     Z-ADD*ZEROS    WWTMVP 150
     C                     Z-ADD*ZEROS    WWTIPC  41
     C                     Z-ADD*ZEROS    WWPSPR
     C                     Z-ADD*ZEROS    WWPDEC
     C                     Z-ADD*ZEROS    WWPDCS
     C                     Z-ADD*ZEROS    WW1SPR
     C                     Z-ADD*ZEROS    WW1DEC
     C                     Z-ADD*ZEROS    WWRATE 105
     C***                  Z-ADD*ZEROS    WWPRIC  84                      060140
     C                     Z-ADD*ZEROS    WWPRIC 104                      060140
     C                     MOVE *BLANKS   WWPMDI
     C                     MOVE *BLANKS   WW1MDI
     C                     MOVE *BLANKS   WWTVDI
     C                     MOVE *BLANKS   WWVALG
     C                     MOVE *BLANKS   WWVLGP
     C                     MOVE *BLANKS   WWINST
     C                     MOVE *BLANKS   WSMODI  2                       063049
     C                     MOVE *BLANKS   WWINSP
     C                     MOVE *BLANKS   WWCCY1
     C                     MOVE *BLANKS   WWCCYP
     C                     MOVE *BLANKS   WWCCY2
     C                     MOVE *BLANKS   WWCY2P
     C                     MOVE *BLANKS   WWHEAD  1
     C*
     C**   INITIALISE ARRAY ELEMENTS
     C                     Z-ADD1         X       20
     C                     Z-ADD1         Y       20
     C*                                                                   CPM005
     C**   SET CALCULATION METHOD                                         CPM005
     C           WWPCAM    IFEQ 'N'                                       CPM005
     C                     MOVE *OFF      *IN01                           CPM005
     C                     ELSE                                           CPM005
     C                     MOVE *ON       *IN01                           CPM005
     C                     END                                            CPM005
     C*
     C**   SET UP DEFAULT PARAMETERS FOR STANDARD IBM SUBR. SUBR23R3
     C                     Z-ADD3         LEVEL
     C                     Z-ADD40        TXTL
     C*
     C**   SET UP OUTPUT NARRATIVES FROM MESSAGE FILE USING SUBR23R3
     C           WWLANG    IFNE WWLNGS
     C                     MOVE WWLANG    WWLNGS  2
     C***********          MOVEL'PM95201' VARMSG                          S01486
     C                     MOVEL'PM95550' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MSG1
     C*
     C***********          MOVEL'PM95202' VARMSG                          S01486
     C                     MOVEL'PM95549' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MSG2
     C*
     C***********          MOVEL'PM95203' VARMSG                          S01486
     C***********          MOVEL'PM95441' VARMSG                    S01486082763
     C                     MOVEL'PM95551' VARMSG                          082763
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MSG3
     C*
     C***********          MOVEL'PM95204' VARMSG                          S01486
     C                     MOVEL'PM95556' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MSG4
     C*
     C***********          MOVEL'PM95205' VARMSG                          S01486
     C                     MOVEL'PM95552' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MSG5
     C*
     C***********          MOVEL'PM95206' VARMSG                          S01486
     C                     MOVEL'PM95557' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MSG6
     C*
     C***********          MOVEL'PM95207' VARMSG                          S01486
     C                     MOVEL'PM95548' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MSG7
     C*
     C***********          MOVEL'PM95208' VARMSG                          S01486
     C                     MOVEL'PM95558' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MSG8
     C*
     C***********          MOVEL'PM95209' VARMSG                          S01486
     C                     MOVEL'PM95554' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MSG9
     C*
     C***********          MOVEL'PM95210' VARMSG                          S01486
     C                     MOVEL'PM95559' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG10
     C*
     C***********          MOVEL'PM95211' VARMSG                          S01486
     C                     MOVEL'PM95555' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG11
     C*
     C***********          MOVEL'PM95212' VARMSG                          S01486
     C                     MOVEL'PM95560' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG12
     C*
     C***********          MOVEL'PM95213' VARMSG                          S01486
     C                     MOVEL'PM95431' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG13 23
     C*
     C***********          MOVEL'PM95214' VARMSG                          S01486
     C                     MOVEL'PM95415' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG14
     C*
     C***********          MOVEL'PM95215' VARMSG                          S01486
     C                     MOVEL'PM95561' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG15
     C*
     C***********          MOVEL'PM95216' VARMSG                          S01486
     C                     MOVEL'PM95457' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C*********************MOVELTEXT      WWMG16 18                      051986
     C                     MOVELTEXT      WWMG16 19                      051986
     C*
     C***********          MOVEL'PM95217' VARMSG                          S01486
     C                     MOVEL'PM95458' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C*********************MOVELTEXT      WWMG17 18                       051986
     C                     MOVELTEXT      WWMG17 19                       051986
     C*
     C***********          MOVEL'PM95218' VARMSG                          S01486
     C                     MOVEL'PM95438' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG18
     C*
     C***********          MOVEL'PM95219' VARMSG                          S01486
     C                     MOVEL'PM95431' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG19
     C*
     C***********          MOVEL'PM95220' VARMSG                          S01486
     C                     MOVEL'PM95562' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG20 23
     C*
     C***********          MOVEL'PM95221' VARMSG                          S01486
     C                     MOVEL'PM95553' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG21
     C*
     C***********          MOVEL'PM95223' VARMSG                          S01486
     C                     MOVEL'PM95439' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG23
     C*
     C***********          MOVEL'PM95224' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C                     MOVELTEXT      R2MG24
     C*
     C***********          MOVEL'PM95225' VARMSG                          S01486
     C                     MOVEL'PM95440' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG25
     C*
     C***********          MOVEL'PM95226' VARMSG                          S01486
     C                     MOVEL'PM95454' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG26 15
     C*
     C***********          MOVEL'PM95227' VARMSG                          S01486
     C                     MOVEL'PM95459' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG27 18
     C*
     C***********          MOVEL'PM95228' VARMSG                          S01486
     C                     MOVEL'PM95460' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG28 18
     C*
     C***********          MOVEL'PM95229' VARMSG                          S01486
     C                     MOVEL'PM95461' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG29 18
     C*
     C***********          MOVEL'PM95230' VARMSG                          S01486
     C                     MOVEL'PM95462' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG30 18
     C***********          MOVEL'PM95900' VARMSG                          S01486
     C                     MOVEL'PM95483' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2LT25
     C***********          MOVEL'PM95901' VARMSG                          S01486
     C                     MOVEL'PM95484' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2LT26
     C***********          MOVEL'PM95902' VARMSG                          S01486
     C                     MOVEL'PM95401' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2LT27
     C***********          MOVEL'PM95903' VARMSG                          S01486
     C                     MOVEL'PM95485' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2LT28
      * GET MES. PLACED WITH CUSTOMER                                     S01313
     C***********          MOVEL'PM95240' VARMSG                    S01313S01486
     C                     MOVEL'PM95455' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23                          S01313
     C                     MOVELTEXT      WW5240 15                       S01313
      * GET MES. PLACED WITH CUSTOMER                                     S01313
     C***********          MOVEL'PM95241' VARMSG                    S01313S01486
     C                     MOVEL'PM95456' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23                          S01313
     C                     MOVELTEXT      WW5241  4                       S01313
      * GET MES. 'UNREALISED P/L'                                         062287
     C***********          MOVEL'PMS5221' VARMSG                    062287S01486
     C                     MOVEL'PM95436' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23                          062287
     C                     MOVELTEXT      R2MGUN 18                       062287
      * GET MES. 'REALISED P/L'                                           062287
     C***********          MOVEL'PMS5222' VARMSG                    062287S01486
     C                     MOVEL'PM95437' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23                          062287
     C                     MOVELTEXT      R2MGRL 18                       062287
     C* GET MES. ASSET GROUP TOTAL                                        CPM005
     C                     MOVEL'PM99627' VARMSG                          CPM005
     C                     CALL 'SUBR23R3'SUBR23                          CPM005
     C                     MOVELTEXT      MS9940 23                       CPM005
     C* GET MES. LIABILITY GROUP TOTAL                                    CPM005
     C                     MOVEL'PM99628' VARMSG                          CPM005
     C                     CALL 'SUBR23R3'SUBR23                          CPM005
     C                     MOVELTEXT      MS9941 23                       CPM005
     C* GET MES. 'CLSD'                                                   CPM005
     C                     MOVEL'PM99621' VARMSG                          CPM005
     C                     CALL 'SUBR23R3'SUBR23                          CPM005
     C                     MOVELTEXT      WM9621  4                       CPM005
     C* GET MES. 'OPEN'                                                   CPM005
     C                     MOVEL'PM99622' VARMSG                          CPM005
     C                     CALL 'SUBR23R3'SUBR23                          CPM005
     C                     MOVELTEXT      WM9622  4                       CPM005
     C                     END
     C*
     C**   SET OFF ALL INDICATORS
     C                     MOVEA'00000000'*IN,21
     C                     MOVEA'00000'   *IN,60
     C                     MOVE '1'       *IN98
     C                     MOVE '1'       *IN29
     C*
     C**   INITIALISE LINE COUNTER
     C                     Z-ADD*ZEROS    LINE
     C*
     C**   ACCESS CURRENCY CODES FILE WITH PORTFOLIO CURRENCY
     C***********WWPTCY    CHAINSDCURRL0             60                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   RTCD    7                       S01486
     C                     PARM '*KEY'    OPTN    7                       S01486
     C                     PARM WWPTCY    KEYCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C*
     C**   IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
     C************IN60     IFEQ '1'                                       S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C           A6TYLC    OREQ 'D'
     C                     Z-ADD1         WBASE
     C                     MOVE *BLANKS   WBFILE           *****************
     C                     MOVEL'SDCURRL0'WBFILE           ** DBERROR  001**
     C                     MOVE *BLANKS   WBKEY            *****************
     C                     MOVELWWPTCY    WBKEY
     C                     MOVE '9'       WWRTCD
     C                     EXSR *PSSR
     C*
     C                     ELSE
     C*
     C**   SAVE SPOT RATE, NUMBER OF DECIMAL PLACES AND MULT/DIV
     C**    INDICATOR INTO WORK FIELDS
     C                     Z-ADDA6SPRT    WWPSPR
     C                     Z-ADDA6NBDP    WWPDEC
     C                     Z-ADDA6NBDP    WWPDCS
     C                     MOVE A6MDIN    WWPMDI
     C*                                                                   CPM004
     C**   ACCESS PM ICD                                                  CPM004
     C                     CALL 'AOPORTR0'                                CPM004
     C                     PARM *BLANKS   RTCD                            CPM004
     C                     PARM '*FIRST ' OPTN                            CPM004
     C           SDPORT    PARM SDPORT    DSFDY                           CPM004
     C           RTCD      IFNE *BLANKS                                   CPM004
     C                     Z-ADD2         WBASE                           CPM004
     C                     MOVE *BLANKS   WBFILE           ***************CPM004
     C                     MOVEL'SDPORTPD'WBFILE           ** DBERROR  002CPM004
     C                     MOVE *BLANKS   WBKEY            ***************CPM004
     C                     MOVE '9'       WWRTCD                          CPM004
     C                     EXSR *PSSR                                     CPM004
     C                     END                                            CPM004
     C*
     C**   ACCESS PORTFOLIO TOTALS WITH CUSTOMER NUMBER AND PORTFOLIO
     C**    REFERENCE
     C***********WWKEY1    CHAINPMPOTTPP             61                   S01486
     C           WWKEY1    CHAINPMPOTTPD             61                   S01486
     C*
     C**   IF RECORD NOT FOUND
     C           *IN61     IFEQ '1'
     C*
     C**   SET PORTFOLIO TOTAL TO ZERO
     C                     Z-ADD*ZEROS    WWPORT
     C*
     C                     ELSE
     C*
     C**   IF TRADE/VALUE DATE = 'T'
     C           WWTVPS    IFEQ 'T'
     C           QCPTPA    SUB  QCPTNA    WWTMP1
     C           WWTMP1    SUB  QCPTMV    WWTMP1
     C           WWTMP1    ADD  QCPTAI    WWPORT
     C*
     C                     ELSE
     C*
     C**   IF TRADE/VALUE DATE = 'V'
     C           WWTVPS    IFEQ 'V'
     C           QCPVPA    SUB  QCPVNA    WWTMP2
     C           WWTMP2    SUB  QCPVMV    WWTMP2
     C           WWTMP2    ADD  QCPTAI    WWPORT
     C*
     C                     END
     C                     END
     C                     END
     C                     END
     C*                                                                   CPM005
     C**   READ ALL RECORD WITH SAME CUSTOMER & PORTFOLIO WITH TOTAL      CPM005
     C**   TYPE EQUAL 'B'                                                 CPM005
     C**********           Z-ADDWWCNUM    K1CNUM                                       CPM005 CSD027
     C                     MOVE WWCNUM    K1CNUM                                              CSD027
     C                     MOVELWWPTFR    K1PTFR                          CPM005
     C                     MOVEL*BLANKS   K1POTY                          CPM005
     C*                                                                   CPM005
     C           PMASL1    SETLLPMASLIL1                                  CPM005
     C                     READ PMASLIL1                 65               CPM005
     C*                                                                   CPM005
     C**  RECORD FOUND SAVE ASSET & LIABILITY VALUE                       CPM005
     C                     SELEC                                          CPM005
     C           *IN65     WHEQ '0'                                       CPM005
     C*                                                                   CPM005
     C           *IN65     DOWEQ'0'                        BW1            CPM005
     C           WWCNUM    ANDEQFECNUM                                    CPM005
     C           WWPTFR    ANDEQFEPTFR                                    CPM005
     C                     ADD  FEASSV    WWASSV 150                      CPM005
     C                     ADD  FELIAV    WWLIAV 150                      CPM005
     C                     READ PMASLIL1                 65               CPM005
     C                     END                             EW1            CPM005
     C*                                                                   CPM005
     C           *IN65     WHEQ '1'                                       CPM005
     C                     Z-ADD*ZEROS    WWASSV                          CPM005
     C                     Z-ADD*ZEROS    WWLIAV                          CPM005
     C                     ENDSL                           E1             CPM005
     C*
     C** OPEN PRINTER FILE
     C                     OPEN PM0950P1
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
      *                                                                  *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - CONVERT 5 FIG DAY NUMBER TO DATE FORMAT               *
      * #P02     - PRODUCE VALUATION GROUP HEADING                       *
      * #P04     - PRODUCE INSTRUMENT TYPE HEADINGS                      *
      * #P05     - ACCESS CURRENCY DETAILS                               *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      * #P03     - PRODUCE INSTRUMENT TOTALS                             *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWKEY1   - KEY FOR PMHDVNLL (PARAMETERS CNUM AND PORT. REF.)     *
      * WWCRNM   - CUSTOMER NAME PARAMETER                               *
      * WWEVCD   - EVENT CONTROL DATE INPUT PARAMETER                    *
      * WWDATE   - CONVERT EVENT CONTROL DATE PARM. TO REPORT FORMAT     *
      * WWPTFR   - PORTFOLIO REFERENCR PARAMETER                         *
      * WWPTFN   - PORTFOLIO NARRATIVE PARAMETER                         *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WWVALG   - VALUATION GROUP ON CURRENT RECORD ON PMHDVNLL         *
      * WWINST   - INSTRUMENT TYPE ON CURRENT RECORD ON PMHDVNLL         *
      * WWTVDI   - TRADE/VALUE DATE INDICATOR ON PMHDVNLL                *
      * WWCCY1   - CURRENCY 1 ON CURRENT RECORD ON PMHDVNLL              *
      * WWTVPS   - TRADE/VALUE DATE PARAMETER                            *
      * WWCCYP   - CURRENCY 1 ON PREVIOUS RECORD ON PMHDVNLL             *
      * WWVLGP   - VALUATION GROUP ON PREVIOUS RECORD ON PMHDVNLL        *
      * WWINSP   - INSTRUMENT TYPE ON PREVIOUS RECORD ON PMHDVNLL        *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WW1DEC   - NUMBER OF DECIMAL POINTS FOR CCY 1 ON PMHDVNLL        *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      *                                                                  *
      ********************************************************************
     C*
     C           #P01      BEGSR
     C*
     C**   ACCESS 'PMHDVNLL'
     C           WWKEY1    SETLLPMHDVNLL
     C           WWKEY1    READEPMHDVNLL                 62
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN62     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           WWKEY1    READEPMHDVNLL                 62               CPM005
     C                     END                                            CPM005
     C*
     C**   SET UP OUTPUT FIELDS FOR HEADER
     C                     MOVE WWCRNM    R2NAME
     C                     Z-ADDWWECD     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    WWDATE  7
     C                     MOVELWWDATE    R2VDNA
     C                     MOVE WWCNUM    R2CUST
     C                     MOVE WWPTFR    R2PREF
     C                     MOVELWWLXDT    R2LXTD
     C                     MOVE WWPTFN    R2PNAR
     C                     MOVE WWPTCY    R2PCCY
     C*
     C**   WRITE MAIN HEADINGS ON FIRST PAGE
     C                     WRITEP952HDR1
     C*
     C**   IF RECORD FOUND SET ON READING FIRST RECORD INDICATOR AND
     C**     INITIALISE HEADINGS FLAG TO 'N'
     C           *IN62     IFEQ '0'
     C                     MOVE '1'       *IN22
     C                     MOVE 'N'       WWHEAD
     C                     END
     C*
     C**   DO WHILE RECORDS EXIST ON FILE
     C           *IN62     DOWEQ'0'
     C*
     C**   FILE VALUES OF VALUATION GROUP AND INSTRUMENT TYPE INTO WORK
     C**     FIELDS FOR COMPARSION
     C                     MOVE QFVALG    WWVALG
     C                     MOVE QFINNR    WWINST
     C                     MOVE QFMODI    WSMODI  2                       063049
     C                     MOVELQFPOST    K2POTY                          CPM005
     C                     MOVELQFDSPG    K2DGRC                          CPM005
     C                     Z-ADDQFDSPS    K2DGRS                          CPM005
     C                     MOVE QFINNR    K2INSC                          CPM005
     C                     Z-ADDQFITDS    K2INSS                          CPM005
     C*
     C**   DO WHILE VALUATION GROUP AND INSTRUMENT TYPE REMAIN THE SAME
     C           WWVALG    DOWEQQFVALG
     C           WWINST    ANDEQQFINNR
     C           *IN62     ANDEQ'0'
     C*
     C**   MOVE NECCESSARY VALUES INTO WORK FIELDS
     C                     MOVE QFTVDA    WWTVDI
     C                     MOVE QFCCY1    WWCCY1
     C                     MOVE QFCCY2    WWCCY2
     C*
     C**   SET UP TRADE/VALUE DATE CONDITIONS
     C           WWTVPS    IFEQ WWTVDI
     C           WWTVDI    OREQ 'X'
     C*
     C***        QFAMT1    IFNE 0                          BMF      051250056459
     C***        QFMODI    ANDNE'RE'                                051250056459
     C***        QFMODI    OREQ 'RE'                                051250056459
     C*
     C**   IF HEADINGS HAVE NOT BEEN WRITTEN BECAUSE TRADE/VALUE DATE
     C**    HAVE NOT PREVIOUSLY BEEN MET FOR THIS VALUATION GROUP AND
     C**     INSTRUMENT TYPE WRITE CORRECT HEADINGS
     C           WWHEAD    IFEQ 'N'
     C*
     C**   IF VALUATION GROUP HAS CHANGED FROM PREVIOUS RECORD PRODUCE
     C**     VALUATION GROUP HEADING AND INSTRUMENT TYPE HEADING
     C           WWVALG    IFNE WWVLGP
     C           *IN22     OREQ '1'
     C*
     C**   IF A NEW PAGE IS REQUIRED OUTPUT MAIN HEADING FIRST
     C           LINE      IFGT 51
     C                     WRITEP952HDR1
     C                     EXSR #P02
     C                     EXSR #P04
     C                     ELSE
     C                     EXSR #P02
     C                     EXSR #P04
     C                     END
     C*
     C                     ELSE
     C*
     C**   IF INSTRUMENT TYPE HAS CHANGED FROM PREVIOUS RECORD PRODUCE
     C**     INSTRUMENT TYPE HEADING
     C           WWINST    IFNE WWINSP
     C*
     C**   IF A NEW PAGE IS REQUIRED OUTPUT ALL HEADINGS
     C           LINE      IFGT 53
     C                     WRITEP952HDR1
     C                     EXSR #P02
     C                     EXSR #P04
     C                     ELSE
     C                     EXSR #P04
     C                     END
     C                     END
     C                     END
     C*
     C**   RESET HEADINGS FLAG TO 'Y'
     C                     MOVE 'Y'       WWHEAD
     C*
     C                     ELSE
     C*
     C**  IF HEADINGS FOR VALUATION TYPE AND INSTRUMENT TYPE HAVE BEEN
     C**   WRITTEN ONLY OUTPUT MAIN HEADINGS IF OVERFLOW
     C           LINE      IFGT 55
     C                     WRITEP952HDR1
     C                     EXSR #P02
     C                     EXSR #P04
     C                     END
     C                     END
     C*
     C**   IF READING FIRST RECORD OR CURRENCY 1 ON THIS RECORD IS
     C**     DIFFERENT FROM CURRENCY 1 ON PREVIOUS RECORD ACCESS
     C**      CURRENCY DETAILS
     C           *IN22     IFEQ '1'
     C           WWCCY1    ORNE WWCCYP
     C                     MOVE WWCCY1    WWCCYN  3
     C                     EXSR #P05
     C*
     C**   SAVE SPOT RATE, NUMBER OF DECIMAL PLACES AND MULT/DIV
     C**    INDICATOR INTO WORK FIELDS
     C                     Z-ADDA6SPRT    WW1SPR
     C                     Z-ADDA6NBDP    WW1DCS  10
     C                     MOVE A6MDIN    WW1MDI
     C                     Z-ADDA6NBDP    WW1DEC
     C                     END
     C*
     C           WWCCY2    IFNE *BLANKS
     C           WWCCY2    ANDNEWWCY2P
     C                     MOVE WWCCY2    WWCCYN  3
     C                     EXSR #P05
     C                     Z-ADDA6NBDP    WW2DEC  10
     C                     END
     C*
     C**   DETERMINE TYPE OF HOLDING
     C                     EXSR #P06
     C*
     C**   SET ON INDICATOR THAT A HOLDING HAS BEEN PROCESSED
     C           *IN28     IFEQ '0'
     C                     MOVE '1'       *IN28
     C                     END
     C*
     C**   SET OFF READING FIRST RECORD INDICATOR
     C           *IN22     IFEQ '1'
     C                     MOVE '0'       *IN22
     C                     END
     C*
     C**   MOVE VALUATION GROUP, INSTRUMENT TYPE AND CURRENCY VALUES ON
     C**     THIS RECORD INTO PREVIOUS RECORD WORK FIELDS BEFORE
     C**       READING THE NEXT RECORD
     C                     MOVE WWVALG    WWVLGP
     C                     MOVE WWINST    WWINSP
     C                     MOVE WWCCY1    WWCCYP
     C                     MOVE WWCCY2    WWCY2P
     C*
     C******************** END                                 EMF  051250056459
     C                     END
     C*
     C**   READ NEXT RECORD FROM FILE
     C           WWKEY1    READEPMHDVNLL                 62
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN62     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           WWKEY1    READEPMHDVNLL                 62               CPM005
     C                     END                                            CPM005
     C*
     C                     END
     C*
     C**   IF ANY HOLDINGS HAVE BEEN PROCESSED OUTPUT TOTALS FOR THAT
     C**     INSTRUMENT TYPE
     C           *IN28     IFEQ '1'
     C*
     C**   IF A NEW PAGE IS REQUIRED OUTPUT HEADINGS BEFORE TOTALS
     C           LINE      IFGT 56
     C                     WRITEP952HDR1
     C*
     C**   ONLY OUTPUT VALUATION GROUP HEADING IF TOTALS NON ZERO
     C           WWTIMV    IFNE 0
     C           WWTINT    ORNE 0
     C                     EXSR #P02
     C                     EXSR #P04
     C                     END
     C                     END
     C*
     C** IF EITHER MARKET VALUE OR ACCRUED INTEREST NON ZERO OUTPUT
     C           WWTIMV    IFNE 0
     C           WWTINT    ORNE 0
     C                     EXSR #P03
     C                     END
     C*
     C**   SET OFF PROCESSING INDICATOR
     C                     MOVE '0'       *IN28
     C                     END
     C*
     C**   IF NOT AT END OF FILE AND NOT READING FIRST RECORD AND
     C**     TRADE/VALUE DATE CONDITIONS ARE MET FOR THE NEXT RECORD
     C           *IN62     IFEQ '0'
     C           *IN22     ANDEQ'0'
     C           WWTVPS    IFEQ QFTVDA
     C           QFTVDA    OREQ 'X'
     C*
     C** MOVE NEXT VALUATION GROUP AND INSTRUMENT TYPE INTO WORK FIELDS
     C                     MOVE QFVALG    WWVALG
     C                     MOVE QFINNR    WWINST
     C                     MOVE QFMODI    WSMODI  2                       063049
     C                     MOVE 'Y'       WWHEAD
     C*
     C**   IF VALUATION GROUP HAS CHANGED FROM PREVIOUS RECORD PRODUCE
     C**     VALUATION GROUP HEADING AND INSTRUMENT TYPE HEADING
     C           WWVALG    IFNE WWVLGP
     C*
     C**   IF A NEW PAGE IS REQUIRED OUTPUT MAIN HEADING FIRST
     C           LINE      IFGT 51
     C                     WRITEP952HDR1
     C                     EXSR #P02
     C                     EXSR #P04
     C                     ELSE
     C***        QFAMT1    IFNE 0                          BMF      051250056459
     C***        QFMODI    ANDNE'RE'                                051250056459
     C***        QFMODI    OREQ 'RE'                                051250056459
     C                     EXSR #P02
     C                     EXSR #P04
     C***                  END                                      051250056459
     C                     END
     C*
     C                     ELSE
     C*
     C**   IF INSTRUMENT TYPE HAS CHANGED FROM PREVIOUS RECORD PRODUCE
     C**     INSTRUMENT TYPE HEADING
     C           WWINST    IFNE WWINSP
     C*
     C**   IF A NEW PAGE IS REQUIRED OUTPUT ALL HEADINGS
     C           LINE      IFGT 53
     C                     WRITEP952HDR1
     C                     EXSR #P02
     C                     EXSR #P04
     C                     ELSE
     C***        QFAMT1    IFNE 0                          BMF      051250056459
     C***        QFMODI    ANDNE'RE'                                051250056459
     C***        QFMODI    OREQ 'RE'                                051250056459
     C                     EXSR #P04
     C***                  END                                      051250056459
     C                     END
     C                     END
     C                     END
     C*
     C                     ELSE
     C*
     C**   IF HEADINGS CONDITIONS NOT MET SET HEADINGS FLAG TO 'N'
     C                     MOVE 'N'       WWHEAD
     C                     END
     C                     END
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P02     - PRODUCE VALUATION GROUP HEADING                       *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWLNGI   - LANG. INDICATOR USED IN DATA STRUCTURE FOR KEY 2      *
      **WWKEY2***-*KEY*FOR*PMVLGDPP*(VAL.*GROUP*AND*LANG.*PARM)***********S01486
      * WWKEY2   - KEY FOR PMVLGDPD (VAL. GROUP AND LANG. PARM)          *S01486
      * WWKYL2   - KEY 2 SET UP IN DATA STRUCTURE FOR OUTPUT             *
      * WWRTCD   - RETURN CODE PARAMETER                                 *
      *                                                                  *
      ********************************************************************
     C*
     C           #P02      BEGSR
     C*
     C**   MOVE LANGUAGE INDICATOR PARAMETER INTO KEY FIELD
     C                     MOVE WWLANG    WWLNGI
     C*
     C*****ACCESS*PMVLGDPP*WITH*VALUATION*GROUP*AND*LANGUAGE*INDICATOR****S01486
     C**   ACCESS PMVLGDPD WITH VALUATION GROUP AND LANGUAGE INDICATOR    S01486
     C**     AS THE KEY
     C***********WWKEY2    CHAINPMVLGDPP             63                   S01486
     C           WWKEY2    CHAINPMVLGDPD             63                   S01486
     C*
     C**   INITIALISE ARRAY VARIABLES FOR HEADING OUTPUT
     C                     MOVEA*BLANKS   AR1
     C                     MOVEA*BLANKS   AR2
     C                     Z-ADD20        X
     C                     Z-ADD1         Y
     C*
     C**   IF NARRATIVE IS NOT BLANK CALCULATE LENGTH OF UNDERLINE
     C           PCVLGN    IFNE *BLANKS
     C*
     C**   MOVE VALUATION GROUP NARRATIVE INTO ARRAY
     C                     MOVEAPCVLGN    AR1
     C*
     C**   COUNT CHARACTERS IN NARRATIVE
     C           AR1,X     DOWEQ' '
     C                     SUB  1         X
     C                     END
     C*
     C**   PUT SAME NUMBER OF DASHES INTO UNDERLINE ARRAY
     C           Y         DOWLEX
     C                     MOVE '='       AR2,Y
     C                     ADD  1         Y
     C                     END
     C                     END
     C*
     C**   MOVE VALUES TO OUTPUT FIELDS AND WRITE HEADING
     C                     MOVE PCVLGN    R2VLGN
     C                     MOVEAAR2       R2UDL1
     C                     WRITEP952HDR2
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P03     - PRODUCE INSTRUMENT TOTALS                             *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWTINT   - TOTAL INSTRUMENT INTEREST                             *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      * WWNAR1   - USED TO FORMAT MARKET VALUE TOTAL NARRATIVE           *
      * WWINTT   - INSTRUMNET TOTAL                                      *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      *                                                                  *
      ********************************************************************
     C*
     C           #P03      BEGSR
     C*
     C** MOVE TOTAL INSTRUMENT MARKET VALUE INTO WORK FIELD
     C***********QFMODI    IFEQ 'FX'                               062287 063049
     C           WSMODI    IFEQ 'FX'                                      063049
     C                     Z-ADDWXUNPL    WWWORK                          062287
     C                     ELSE                                           062287
     C                     Z-ADDWWTIMV    WWWORK
     C                     END                                            062287
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO PRINTER FILE
     C                     MOVE ZOUT21    R2INTT
     C*
     C**  INITIALISE ARRAY USED FOR OUTPUT
     C                     MOVE *BLANKS   WWNAR1 43
     C                     MOVEA*BLANKS   AR3
     C                     Z-ADD43        X
     C*
     C** MOVE LEFT INSTRUMENT TYPE NARRATIVE FROM FILE INTO AR2AY
     C                     MOVELPDISTN    WWNAR1
     C                     MOVEAWWNAR1    AR3
     C*
     C** IF NARRATIVE IS BLANK ONLY OUTPUT MESSAGE
     C           WWNAR1    IFEQ *BLANKS
     C                     Z-SUB1         X
     C                     ELSE
     C*
     C** COUNT CHARACTERS IN NARRATIVE
     C           AR3,X     DOWEQ' '
     C                     SUB  1         X
     C                     END
     C                     END
     C*
     C** PUT MESSAGE 'MARKET VALUE' IN CORRECT POSITION IN ARRAY
     C                     ADD  2         X
     C*                                                                   062287
     C***********QFMODI    IFEQ 'FX'                               062287 063049
     C           WSMODI    IFEQ 'FX'                                      063049
     C                     MOVEAR2MGUN    AR3,X                           062287
     C                     ELSE                                           062287
     C                     MOVEAR2MG20    AR3,X
     C                     END                                            062287
     C*                                                                   062287
     C                     MOVEAAR3       R2NAR1
     C*
     C** WRITE INSTRUMENT DETAILS 'W0301'
     C**********           WRITEP952DET1                                  CPM005
     C  N01                WRITEP952DET1                                  CPM005
     C*
     C** MOVE TOTAL INSTRUMENT INTEREST VALUE INTO WORK FIELD
     C***********QFMODI    IFEQ 'FX'                               062287 063049
     C           WSMODI    IFEQ 'FX'                                      063049
     C                     Z-ADDWXRLPL    WWWORK                          062287
     C                     ELSE                                           062287
     C                     Z-ADDWWTINT    WWWORK
     C                     END                                            062287
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO PRINTER FILE
     C                     MOVE ZOUT21    R2TINT
     C*
     C**  INITIALISE ARRAY USED FOR OUTPUT
     C                     MOVE *BLANKS   WWNAR1
     C                     MOVEA*BLANKS   AR3
     C                     Z-ADD43        X
     C*
     C** MOVE LEFT INSTRUMENT TYPE NARRATIVE FROM FILE INTO AR2AY
     C                     MOVELPDISTN    WWNAR1
     C                     MOVEAWWNAR1    AR3
     C*
     C** IF NARRATIVE IS BLANK ONLY OUTPUT MESSAGE
     C           WWNAR1    IFEQ *BLANKS
     C                     Z-SUB1         X
     C                     ELSE
     C*
     C** COUNT CHARACTERS IN NARRATIVE
     C           AR3,X     DOWEQ' '
     C                     SUB  1         X
     C                     END
     C                     END
     C*
     C** PUT MESSAGE 'ACCRUED INTEREST' IN CORRECT POSITION IN ARRAY
     C                     ADD  2         X
     C*                                                                   062287
     C***********QFMODI    IFEQ 'FX'                               062287 063049
     C           WSMODI    IFEQ 'FX'                                      063049
     C                     MOVEAR2MGRL    AR3,X                           062287
     C                     ELSE                                           062287
     C                     MOVEAR2MG13    AR3,X
     C                     END                                            062287
     C                     MOVEAAR3       R2NAR2
     C*
     C** WRITE INSTRUMENT DETAILS 'W0302'
     C           WWTINT    IFNE 0
     C***********QFMODI    ANDNE'FX'                               062287 063049
     C           WSMODI    ANDNE'FX'                                      063049
     C           WXRLPL    ORNE 0                                         062287
     C***********QFMODI    ANDEQ'FX'                               062287 063049
     C           WSMODI    ANDEQ'FX'                                      063049
     C**********           WRITEP952DET2                                  CPM005
     C  N01                WRITEP952DET2                                  CPM005
     C                     END
     C*
     C** CALCULATE INSTRUMENT TOTAL
     C           WWTIMV    ADD  WWTINT    WWINTT
     C*
     C** MOVE INSTRUMENT TOTAL INTO WORK FIELD
     C                     Z-ADDWWINTT    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO PRINTER FILE
     C                     MOVE ZOUT21    R2TOTL
     C*
     C** EXECUTE STANDARD SUBROUTINE ZSEDIT FOR PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWTIPC    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2TOTP
     C*
     C** CALCULATE PERCENTAGE
     C                     MOVE *BLANKS   R2TOTP
     C           WWPORT    IFEQ *ZEROS
     C                     Z-ADD*ZEROS    WWIPC1  43
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           WWINTT    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           WWINTT    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           WWINTT    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C           WWIPC1    MULT 100       WWIPC2  41
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2TOTP
     C*
     C** WRITE INSTRUMENT DETAILS 'W0303'
     C**********           WRITEP952DET3                                  CPM005
     C  N01                WRITEP952DET3                                  CPM005
     C           WWPCAM    IFEQ 'S'                                       CPM005
     C                     EXSR #GRTO                                     CPM005
     C                     END                                            CPM005
     C*
     C** RESET TOTALS TO ZERO
     C                     Z-ADD*ZEROS    WWTINT
     C                     Z-ADD*ZEROS    WWTIMV
     C                     Z-ADD*ZEROS    WWTIPC
     C                     Z-ADD*ZEROS    WXUNPL                          062287
     C                     Z-ADD*ZEROS    WXRLPL                          062287
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P04     - PRODUCE INSTRUMENT TYPE HEADINGS                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWINST   - INSTRUMENT TYPE ON CURRENT RECORD ON PMHDVNLL         *
      * WWRTCD   - RETURN CODE PARAMETER                                 *
      *                                                                  *
      ********************************************************************
     C*
     C           #P04      BEGSR
      *                                                                   182961
      ** Instrument type is defaulted from PF/SDPORTPD if a blank         182961
      ** instrument type is found.                                        182961
      ** Indicator 35 was used as the operation's resulting indicator.    182961
      *                                                                   182961
     C           WWINST    IFEQ *BLANKS                                   182961
     C           1         SETLLSDPORTPD                                  182961
     C                     READ SDPORTPD                 35               182961
     C                     MOVE FCDINR    WWINST                          182961
     C                     ENDIF                                          182961
     C*
     C** ACCESS INSTRUMENT TYPES FILE USING INSTRUMENT TYPE
     C***********WWINST    CHAINSDPLINPD             64                   S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM WWINST    KEYIN   3                       S01486
     C           SDPLIN    PARM SDPLIN    DSFDY                           S01486
     C*
     C**   IF RECORD NOT FOUND OR RECORD ID = '*' THEN DB ERROR
     C************IN64     IFEQ '1'                                       S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C           PDRECI    OREQ '*'
     C                     Z-ADD3         WBASE
     C                     MOVE *BLANKS   WBFILE           *****************
     C                     MOVEL'SDPLINPD'WBFILE           ** DBERROR  003**
     C                     MOVE *BLANKS   WBKEY            *****************
     C                     MOVELWWINST    WBKEY
     C                     MOVE '9'       WWRTCD
     C                     EXSR *PSSR
     C*
     C                     ELSE
     C*
     C**   INITIALISE ARRAY VARIABLES FOR HEADING OUTPUT
     C                     MOVEA*BLANKS   AR1
     C                     MOVEA*BLANKS   AR2
     C                     Z-ADD20        X
     C                     Z-ADD1         Y
     C*
     C**   IF NARRATIVE IS NOT BLANK CALCULATE LENGTH OF UNDERLINE
     C           PDISTN    IFNE *BLANKS
     C*
     C**   MOVE INSTRUMENT TYPE NARRATIVE INTO ARRAY
     C                     MOVEAPDISTN    AR1
     C*
     C**   COUNT CHARACTERS IN NARRATIVE
     C           AR1,X     DOWEQ' '
     C                     SUB  1         X
     C                     END
     C*
     C**   PUT SAME NUMBER OF DASHES INTO UNDERLINE ARRAY
     C           Y         DOWLEX
     C                     MOVE '-'       AR2,Y
     C                     ADD  1         Y
     C                     END
     C                     END
     C*
     C**   MOVE VALUES TO OUTPUT FIELDS AND WRITE HEADING
     C                     MOVE PDISTN    R2NAR3
     C                     MOVEAAR2       R2UDL2
     C                     WRITEP952HDR3
     C*
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P05     - ACCESS CURRENCY DETAILS                               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCCY1   - CURRENCY 1 ON CURRENT RECORD ON PMHDVNLL              *
      * WWRTCD   - RETURN CODE PARAMETER                                 *
      *                                                                  *
      ********************************************************************
     C*
     C           #P05      BEGSR
     C*
     C**   ACCESS CURRENCY CODES FILE WITH CURRENCY 1
     C***********WWCCYN    CHAINSDCURRL0             60                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM WWCCYN    KEYCY                           S01486
     C***********SDCURR    PARM SDCURR    DSFDY                           S01486              CSD006
     C           SDCURR    PARM SDCURR    DSSDY                                               CSD006
     C*
     C**   IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
     C************IN60     IFEQ '1'                                       S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C           A6TYLC    OREQ 'D'
     C                     Z-ADD4         WBASE
     C                     MOVE *BLANKS   WBFILE           *****************
     C                     MOVEL'SDCURRL0'WBFILE           ** DBERROR  004**
     C                     MOVE *BLANKS   WBKEY            *****************
     C                     MOVELWWCCYN    WBKEY
     C                     MOVE '9'       WWRTCD
     C                     EXSR *PSSR
     C*
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P08     - PROCESS SE NON INTEREST-BEARING HOLDINGS              *
      * #P09     - PROCESS FF HOLDINGS                                   *
      * #P10     - PROCESS MM DEALS                                      *
      * #P11     - PROCESS FX DEALS AND FRA/IRS                          *
      * #P12     - PROCESS LE HOLDINGS                                   *
      * #P13     - PROCESS RE HOLDINGS                                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C*
     C           #P06      BEGSR
     C*
     C** IF MODULE ID ON PMHDVNLL = 'SE'
     C           QFMODI    IFEQ 'SE'
     C*
     C** IF NEXT INTEREST DATE ON PMHDVNLL IS NOT ZERO
     C           QFNIDT    IFNE *ZEROS
     C*
     C** PROCESS SE INTEREST-BEARING HOLDINGS
     C                     EXSR #P07
     C*
     C                     ELSE
     C*
     C** PROCESS SE NON INTEREST-BEARING HOLDINGS
     C                     EXSR #P08
     C*
     C                     END
     C*
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'FF'
     C           QFMODI    IFEQ 'FF'
     C*
     C** PROCESS FF HOLDINGS
     C                     EXSR #P09
     C*
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'DL'
     C           QFMODI    IFEQ 'MD'
     C           QFMODI    OREQ 'ML'
     C           QFMODI    OREQ 'FI'
     C           QFMODI    OREQ 'FR'
     C           QFMODI    OREQ 'FX'
     C*
     C** CHECK DEAL TYPE ON PMHDVNLL
     C           QFMODI    IFEQ 'MD'
     C           QFMODI    OREQ 'ML'
     C           QFMODI    OREQ 'FI'
     C*
     C** PROCESS MM DEALS
     C                     EXSR #P10
     C*
     C                     ELSE
     C*
     C** PROCESS FX DEALS AND FRA/IRS
     C                     EXSR #P11
     C*
     C                     END
     C*
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'LE'
     C           QFMODI    IFEQ 'LE'
     C*
     C** PROCESS LE HOLDINGS
     C                     EXSR #P12
     C*
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'RE'
     C           QFMODI    IFEQ 'RE'
     C*
     C** PROCESS RE HOLDINGS
     C                     EXSR #P13
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'LB'
     C           QFMODI    IFEQ 'LB'
     C*
     C** PROCESS LB HOLDINGS
     C                     EXSR #P17
     C*
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * #Y02     - CONVERT YIELD AMOUNTS TO FORMAT REQUIRED ON REPORT    *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWWYLD   - GENERAL WORK FIELD OUTPUT FROM #Y02                   *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      *                                                                  *
      ********************************************************************
     C*
     C           #P07      BEGSR
     C*
     C** EXECUTE ZSEDIT FOR NOMINAL/QTY USING AMOUNT 1 AND NUMBER OF
     C**  DECIMAL PLACES FOR CURRENCY 1, BOTH FROM PMHDVNLL
     C           QFPOST    IFEQ 'C '                       B1             CPM005
     C                     Z-ADDQFAMT1    ZFLD15
     C                     ELSE                            X1             CPM005
     C           QFPOST    IFEQ 'FO'                       B2             CPM005
     C                     Z-ADDQFOAMT    ZFLD15                          CPM005
     C                     ELSE                            X2             CPM005
     C           QFAMT1    IFLT 0                          B3             CPM005
     C                     Z-SUBQFAMT1    ZFLD15                          CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADDQFAMT1    ZFLD15                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C                     Z-ADDQFCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2NQTY
     C*                                                                   46081
     C** IF VALUE DATE POSITIONS AND OTHER NOMINAL DIFFERENT OUTPUT       46081
     C** FIGURES IN BRACKETS                                              46081
     C                     MOVE *BLANKS   R2NQT1                          46081
     C****       WWTVPS    IFEQ 'V'                                 48007 46081
     C****       QFAMT1    ANDNEQFOAMT                              48007 46081
     C           QFAMT1    IFNE QFOAMT                                    48007
     C           QFOAMT    ANDNE*HIVAL                                    46081
     C           QFPOST    ANDEQ'C '                                      CPM005
     C                     Z-ADDQFOAMT    ZFLD15                          46081
     C                     Z-ADDQFCDP1    ZDECS                           46081
     C                     MOVE 'J'       ZECODE                          46081
     C                     EXSR ZSEDIT                                    46081
     C****                 MOVE ZOUT21    R2NQT1                    48007 46081
     C                     MOVE ZOUT21    WWWK17 17                       48007
     C                     MOVELWWWK17    R2NQT1                          48007
     C                     MOVEL'('       R2NQT1                          46081
     C                     MOVE ')'       R2NQT1                          46081
     C                     END                                            46081
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DES1
     C*
     C** OUTPUT BOOK PRICE FROM PMHDVNLL
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBOPR    WWPRIC    H
     C                     MOVE WWPRIC    ZFIELD
     C                     Z-ADD4         ZADIG
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BOPR
     C*
     C** OUTPUT MARKET PRICE FROM PMHDVNLL
     C           QFMPRC    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMPRC    WWPRIC    H
     C                     MOVE WWPRIC    ZFIELD
     C                     Z-ADD4         ZADIG
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MPRC
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MPRC
     C*
     C                     END
     C*
     C** MOVE PROFIT/LOSS MARKET FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLMK    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PUPL
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP2    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C*
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C                     ADD  ZAMTT     WWTIMV
     C*
     C** STORE CONVERTED MARKET VALUE AS MARKET VALUE PORTFOLIO CCY
     C                     Z-ADDZAMTT     WWMVPC
     C*
     C** OUTPUT MARKET YIELD FROM PMHDVNLL
     C                     MOVE *BLANKS   R2MKYD                          CPM005
     C           QFMKYD    IFGT *ZERO
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE QFMKYD    ZFIELD
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     EXSR #Y02
     C                     MOVE WWWYLD    R2MKYD
     C*
     C                     ELSE
     C           QFMKYD    IFEQ -9999
     C                     MOVE *BLANKS   R2MKYD
     C                     MOVE 'N/A '    R2MKYD
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MKYD
     C*
     C                     END
     C                     END
     C*
     C** MOVE MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWMVPC    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCCV
     C*
     C** MOVE BLANKS TO PERCENTAGE FIELD ON REPORT
     C                     MOVE *BLANKS   R2PERC
     C*                                                                   CPM005
     C           QFPOST    IFEQ 'FC'                                      CPM005
     C                     MOVELWM9621    R2MKYD                          CPM005
     C                     END                                            CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C                     MOVELWM9622    R2MKYD                          CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C** IF FX P/L *NE 0 OUTPUT TEXT '+FX'                                CPM005
     C           QFPLFX    IFNE 0                                         CPM005
     C                     MOVE '+FX'     R2MKYD                          CPM005
     C                     END                                            CPM005
     C*
     C** WRITE DETAIL LINE (W0701)
     C                     WRITEP952DET4
     C*
     C** OUTPUT INSTRUMENT ENQUIRY DETAILS FROM PMHDVNLL
     C                     MOVE QFTXT2    R2DES2
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C** OUTPUT MARKET RATE USING RATE FROM FILE
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C*
     C** OUTPUT BOOK YIELD FROM PMHDVNLL
     C                     MOVE *BLANKS   R2BKYD                          CPM005
     C           QFBKYD    IFGT *ZERO
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE QFBKYD    ZFIELD
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     EXSR #Y02
     C                     MOVE WWWYLD    R2BKYD
     C*
     C                     ELSE
     C*
     C           QFBKYD    IFEQ -9999
     C                     MOVE *BLANKS   R2BKYD
     C                     MOVE 'N/A '    R2BKYD
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2BKYD
     C*
     C                     END
     C                     END
     C*                                                                   CPM005
     C** IF RECORD PROCESS IS A FORWARD TRADE POSITION                    CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C           QFPOST    OREQ 'FC'                                      CPM005
     C                     MOVEL*BLANKS   R2BFXR                          CPM005
     C*                                                                   CPM005
     C                     Z-ADDQFVDAT    ZDAYNO                          CPM005
     C                     EXSR ZDATE2                                    CPM005
     C                     MOVE ZADATE    R2BKYD                          CPM005
     C*                                                                   CPM005
     C                     END                                            CPM005
     C*
     C** WRITE DETAIL LINE (W0702)
     C                     WRITEP952DET5
     C*
     C** OUTPUT SECURITY SHORTNAME FROM PMHDVNLL
     C                     MOVE QFTDSS    R2DES3
     C*
     C** OUTPUT INSTRUMENT PLEDGED FROM PMHDVNLL
     C           QFSPLD    IFEQ 'Y'
     C                     MOVE '1'       *IN27
     C                     ELSE
     C                     MOVE '0'       *IN27
     C                     END
     C*
     C** PRODUCE NON RE ACCRUED INTEREST DETAILS
     C                     EXSR #P14
     C*                                                                   CPM005
     C** IF RECORD PROCESS IS A FORWARD TRADE POSITION                    CPM005
     C                     MOVE *OFF      *IN02                           CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C           QFPOST    OREQ 'FC'                                      CPM005
     C                     MOVE *ON       *IN02                           CPM005
     C                     END                                            CPM005
     C*
     C** WRITE DETAIL LINE (W0703)
     C                     WRITEP952DET6
     C                     MOVE *BLANKS   R2NQT1                          46081
     C*
     C** PRODUCE TOTALS LINE
     C                     EXSR #P16
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P08     - PROCESS SE NON INTEREST-BEARING HOLDINGS              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE FOR CCY 1 ON PMHDVNLL                 *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P08      BEGSR
     C*
     C** EXECUTE ZSEDIT FOR NOMINAL/QTY USING AMOUNT 1 AND NUMBER OF
     C**  DECIMAL PLACES FOR CURRENCY 1, BOTH FROM PMHDVNLL
     C           QFPOST    IFEQ 'C '                       B1             CPM005
     C                     Z-ADDQFAMT1    ZFLD15
     C                     ELSE                            X1             CPM005
     C           QFPOST    IFEQ 'FO'                       B2             CPM005
     C                     Z-ADDQFOAMT    ZFLD15                          CPM005
     C                     ELSE                            X2             CPM005
     C           QFAMT1    IFLT 0                          B3             CPM005
     C                     Z-SUBQFAMT1    ZFLD15                          CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADDQFAMT1    ZFLD15                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     Z-ADDQFCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2NQTY
     C*                                                                   48007
     C** IF VALUE DATE POSITIONS AND OTHER NOMINAL DIFFERENT OUTPUT       48007
     C** FIGURES IN BRACKETS                                              48007
     C                     MOVE *BLANKS   R2NQT1                          48007
     C           QFAMT1    IFNE QFOAMT                                    48007
     C           QFOAMT    ANDNE*HIVAL                                    48007
     C           QFPOST    ANDEQ'C '                                      CPM005
     C                     Z-ADDQFOAMT    ZFLD15                          48007
     C                     Z-ADDQFCDP1    ZDECS                           48007
     C                     MOVE 'J'       ZECODE                          48007
     C                     EXSR ZSEDIT                                    48007
     C****                 MOVE ZOUT21    R2NQT1                    48007 46081
     C                     MOVE ZOUT21    WWWK17 17                       48007
     C                     MOVELWWWK17    R2NQT1                          48007
     C                     MOVEL'('       R2NQT1                          48007
     C                     MOVE ')'       R2NQT1                          48007
     C                     END                                            48007
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DES1
     C*
     C** OUTPUT BOOK PRICE FROM PMHDVNLL
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBOPR    WWPRIC    H
     C                     MOVE WWPRIC    ZFIELD
     C                     Z-ADD4         ZADIG
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BOPR
     C*
     C** OUTPUT MARKET PRICE FROM PMHDVNLL
     C           QFMPRC    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMPRC    WWPRIC    H
     C                     MOVE WWPRIC    ZFIELD
     C                     Z-ADD4         ZADIG
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MPRC
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MPRC
     C*
     C                     END
     C*
     C** MOVE PROFIT/LOSS MARKET FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLMK    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PUPL
     C*
     C** OUTPUT BLANKS TO BOOK YIELD OUTPUT FIELD
     C                     MOVE *BLANKS   R2BKYD
     C                     MOVE *BLANKS   R2MKYD
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP2    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C                     ADD  ZAMTT     WWTIMV
     C*
     C** MOVE CONVERTED MARKET VALUE INTO WORK FIELD
     C                     Z-ADDZAMTT     WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCCV
     C*
     C** CALCULATE PERCENTAGE
     C           WWPORT    IFEQ *ZEROS
     C                     Z-ADD*ZEROS    WWIPC1  43
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           ZAMTT     DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C           WWIPC1    MULT 100       WWIPC2  41
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2PERC
     C*                                                                   CPM005
     C           QFPOST    IFEQ 'FC'                                      CPM005
     C                     MOVELWM9621    R2MKYD                          CPM005
     C                     END                                            CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C                     MOVELWM9622    R2MKYD                          CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C** IF FX P/L *NE 0 OUTPUT TEXT '+FX'                                CPM005
     C           QFPLFX    IFNE 0                                         CPM005
     C                     MOVE '+FX'     R2MKYD                          CPM005
     C                     END                                            CPM005
     C*
     C** WRITE DETAIL LINE (W0701)
     C                     WRITEP952DET4
     C*
     C** OUTPUT INSTRUMENT ENQUIRY DETAILS FROM PMHDVNLL
     C                     MOVE QFTXT2    R2DES2
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C** OUTPUT MARKET RATE USING RATE FROM FILE
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C*
     C** OUTPUT BLANKS TO MARKET YIELD OUTPUT FIELD
     C                     MOVE *BLANKS   R2MKYD
     C*                                                                   CPM005
     C** IF RECORD PROCESS IS A FORWARD TRADE POSITION                    CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C           QFPOST    OREQ 'FC'                                      CPM005
     C                     MOVEL*BLANKS   R2BFXR                          CPM005
     C*                                                                   CPM005
     C                     Z-ADDQFVDAT    ZDAYNO                          CPM005
     C                     EXSR ZDATE2                                    CPM005
     C                     MOVE ZADATE    R2BKYD                          CPM005
     C*                                                                   CPM005
     C                     END                                            CPM005
     C*
     C** WRITE DETAIL LINE (W0702)
     C                     WRITEP952DET5
     C*
     C** OUTPUT SECURITY SHORTNAME FROM PMHDVNLL
     C                     MOVE QFTDSS    R2DES3
     C*
     C** OUTPUT INSTRUMENT PLEDGED FROM PMHDVNLL
     C           QFSPLD    IFEQ 'Y'
     C                     MOVE '1'       *IN27
     C                     ELSE
     C                     MOVE '0'       *IN27
     C                     END
     C*
     C                     MOVE '0'       *IN29
     C*                                                                   CPM005
     C** IF RECORD PROCESS IS A FORWARD TRADE POSITION                    CPM005
     C                     MOVE *OFF      *IN02                           CPM005
     C           QFPOST    IFEQ 'FO'                                      CPM005
     C           QFPOST    OREQ 'FC'                                      CPM005
     C                     MOVE *ON       *IN02                           CPM005
     C                     END                                            CPM005
     C*
     C** WRITE DETAIL LINE (W0703)
     C                     WRITEP952DET6
     C                     MOVE *BLANKS   R2NQT1                          48007
     C                     MOVE '1'       *IN29
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P09     - PROCESS FF HOLDINGS                                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      *                                                                  *
      ********************************************************************
     C*
     C           #P09      BEGSR
     C*                                                                   S71062
     C** Access INTYPD to retrieve ticks denominator and minimum price    S71062
     C** fluctuation to display market and book price                     S71062
     C           QFFOIS    CHAININTYP                73                   S71062
     C           *IN73     IFEQ *ON                                       S71062
     C                     Z-ADD6         WBASE                           S71062
     C                     MOVE *BLANKS   WBFILE           ***************S71062
     C                     MOVE 'INTYP'   WBFILE           ** DBERROR  006S71062
     C                     MOVE *BLANKS   WBKEY            ***************S71062
     C                     MOVELQFFOIS    WBKEY                           S71062
     C                     MOVE '9'       WWRTCD                          S71062
     C                     EXSR *PSSR                                     S71062
     C                     ENDIF                                          S71062
     C*
     C** OUTPUT NOMINAL/QTY FROM PMHDVNLL
     C***********          Z-ADDQFAMT1    ZFLD15                          S71062
     C***********          Z-ADD*ZEROS    ZDECS                           S71062
     C***********          MOVE 'J'       ZECODE                          S71062
     C***********          EXSR ZSEDIT                                    S71062
     C***********          MOVE ZOUT21    R2NMQT                          S71062
     C                     MOVEL*BLANKS   ZFIELD                          S71062
     C                     MOVE QFAMT1    ZFIELD                          S71062
     C                     Z-ADD0         ZADEC                           S71062
     C                     EXSR ZEDIT                                     S71062
     C                     MOVE ZFIELD    WWNBOC                          S71062
     C***********          MOVELQFDTYP    WWSIGN                          076371
     C                     MOVE *BLANKS   WWSIGN                          077457
     C           QFDTYP    IFEQ 'S '                                      077457
     C                     MOVE '-'       WWSIGN                          077457
     C                     END                                            077457
     C*
     C** MOVE LEFT DEAL TYPE FROM PMHDVNLL INTO NOMINAL/QTY FIELD
     C***********          MOVELQFDTYP    R2NMQT                          S71062
     C***********          MOVELQFDTYP    WWPUSE                    S71062076371
     C***********                                                   S71062076371
     C***MOVE*'-'*IF*SELL*******************************************S71062076371
     C***********QFDTYP    IFEQ 'S'                                 S71062076371
     C***********          MOVEL'-'       WWSIGN                    S71062076371
     C***********          ELSE                                     S71062076371
     C***********          MOVEL*BLANKS   WWSIGN                    S71062076371
     C***********          END                                      S71062076371
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C***********          MOVE QFTXT1    R2DES4                          S71062
     C                     MOVELQFTXT1    R2DES4                          S71062
     C*
     C** OUTPUT BOOK PRICE FROM PMHDVNLL
     C***********          MOVE *BLANKS   ZFIELD                          S71062
     C***********          Z-ADDQFBOPR    WWPRIC    H                     S71062
     C***********          MOVE WWPRIC    ZFIELD                          S71062
     C***********          Z-ADD4         ZADIG                           S71062
     C***********          Z-ADD4         ZADEC                           S71062
     C***********          EXSR ZEDIT                                     S71062
     C***********          MOVE ZFIELD    R2BKPR                          S71062
     C           QFBOPR    IFNE *ZEROS                                    S71062
     C                     Z-ADDQFBOPR    FFPRIC                          S71062
     C                     Z-ADDTKDM      FFTKDM                          S71062
     C                     Z-ADDMNPF      FFMNPF                          S71062
     C                     EXSR FFPRCS                                    S71062
     C                     MOVELFFSPRC    R2BKPR                          S71062
     C                     ELSE                                           S71062
     C                     MOVEL*BLANKS   R2BKPR                          S71062
     C                     END                                            S71062
     C*
     C** OUTPUT MARKET PRICE FROM PMHDVNLL
     C           QFMPRC    IFNE *ZEROS
     C***********          MOVE *BLANKS   ZFIELD                          S71062
     C***********          Z-ADDQFMPRC    WWPRIC    H                     S71062
     C***********          MOVE WWPRIC    ZFIELD                          S71062
     C***********          Z-ADD4         ZADIG                           S71062
     C***********          Z-ADD4         ZADEC                           S71062
     C***********          EXSR ZEDIT                                     S71062
     C***********          MOVE ZFIELD    R2MKPR                          S71062
     C                     Z-ADDQFMPRC    FFPRIC                          S71062
     C                     Z-ADDTKDM      FFTKDM                          S71062
     C                     Z-ADDMNPF      FFMNPF                          S71062
     C                     EXSR FFPRCS                                    S71062
     C                     MOVELFFSPRC    R2MKPR                          S71062
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MKPR
     C*
     C                     END
     C*                                                                   S71062
     C** OUTPUT MARKET PROFIT & LOSS                                      S71062
     C**                                                                  S71062
     C           QFPLMK    IFNE *ZEROS                                    S71062
     C                     MOVEL*BLANKS   ZFLD15                          S71062
     C                     MOVE QFPLMK    ZFLD15                          S71062
     C***********          Z-ADDQFCDP2    ZDECS                     S71062076371
     C                     Z-ADDWWPDEC    ZDECS                           076371
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    R2UNPL                          S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   R2UNPL                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C** OUTPUT MARKET VALUE                                              S71062
     C***********QFMVAL    IFNE *ZEROS                             S71062 076371
     C           QFMVPC    IFNE *ZEROS                                    076371
     C                     Z-ADD*ZEROS    ZFLD15                          S71062
     C***********          MOVE QFMVAL    ZFLD15                   S71062 076371
     C***********          Z-ADDQFCDP2    ZDECS                    S71062 076371
     C                     MOVE QFMVPC    ZFLD15                          076371
     C                     Z-ADDWWPDEC    ZDECS                           076371
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    R2PCCV                          S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   R2PCCV                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C           WWPORT    IFEQ *ZEROS                                    S71062
     C                     Z-ADD*ZEROS    WWIPC1    H                     S71062
     C                     ELSE                                           S71062
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C***********QFMVAL    DIV  WWPORT    WWIPC1    H              S71062 076371
     C           QFMVPC    DIV  WWPORT    WWIPC1    H                     076371
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           QFMVPC    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           QFMVPC    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END                                            S71062
     C           WWIPC1    MULT 100       WWIPC2    H                     S71062
     C*                                                                   S71062
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE             S71062
     C                     Z-ADD*ZEROS    ZFLD15                          S71062
     C                     MOVE WWIPC2    ZFLD15                          S71062
     C                     Z-ADD1         ZDECS                           S71062
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C*                                                                   S71062
     C                     MOVE ZOUT21    R2PERC                          S71062
     C*                                                                   S71062
     C** OUTPUT BOOK FX RATE                                              S71062
     C**                                                                  S71062
     C           QFBFXR    IFNE *ZEROS                                    S71062
     C                     MOVEL*BLANKS   ZFIELD                          S71062
     C                     Z-ADDQFBFXR    WWRRTE  84H                     S71062
     C                     MOVE WWRRTE    ZFIELD                          S71062
     C                     Z-ADD4         ZADIG                           S71062
     C                     Z-ADD4         ZADEC                           S71062
     C                     EXSR ZEDIT                                     S71062
     C                     MOVE ZFIELD    R2BFXX                          S71062
     C                     ELSE                                           S71062
     C                     MOVEL*BLANKS   R2BFXX                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C** OUTPUT MARKET FX RATE                                            S71062
     C**                                                                  S71062
     C           QFMFXR    IFNE *ZEROS                                    S71062
     C                     MOVEL*BLANKS   ZFIELD                          S71062
     C                     Z-ADDQFMFXR    WWRRTE  84H                     S71062
     C                     MOVE WWRRTE    ZFIELD                          S71062
     C                     Z-ADD4         ZADIG                           S71062
     C                     Z-ADD4         ZADEC                           S71062
     C                     EXSR ZEDIT                                     S71062
     C                     MOVE ZFIELD    R2MFXX                          S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   R2MFXX                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C** OUTPUT PROFIT & LOSS FX                                          S71062
     C**                                                                  S71062
     C           QFPLFX    IFNE *ZEROS                                    S71062
     C                     MOVEL*BLANKS   ZFLD15                          S71062
     C                     MOVE QFPLFX    ZFLD15                          S71062
     C***********          Z-ADDQFCDP2    ZDECS                    S71062 076371
     C                     Z-ADDWWPDEC    ZDECS                           076371
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    R2PLFX                          S71062
     C                     ELSE                                           S71062
     C                     MOVEL*BLANKS   R2PLFX                          S71062
     C                     END                                            S71062
     C*
     C***MOVE*PROFIT/LOSS*MARKET*FROM*PMHDVNLL*INTO*WORK*FIELD************S71062
     C***********          Z-ADDQFPLMK    WWWORK                          S71062
     C***********                                                         S71062
     C***CALL*SUBROUTINE*TO*SET*UP*OUTPUT*FIELD***************************S71062
     C***********          EXSR #Y01                                      S71062
     C***********                                                         S71062
     C***MOVE*OUTPUT*FIELD*TO*PRINTER*FILE********************************S71062
     C***********          MOVE ZOUT21    R2UNPL                          S71062
     C*
     C** WRITE DETAIL LINE (W0901)
     C                     WRITEP952DET7
     C*
     C** WRITE DETAIL LINE (W0902)
     C***********          MOVE QFTXT2    R2DES5                          S71062
     C**                                                                  S71062
     C** OUTPUT INSTRUMENT CURRENCY                                       S71062
     C**                                                                  S71062
     C                     MOVELQFCCY1    WWICCY                          S71062
     C**                                                                  S71062
     C** OUTPUT SETTLEMENT DATE                                           S71062
     C**                                                                  S71062
     C           QFSETD    IFNE *ZEROS                                    S71062
     C**                                                                  S71062
     C                     Z-ADDQFSETD    ZDAYNO                          S71062
     C                     EXSR ZDATE2                                    S71062
     C                     MOVELZDATE     WKSETD                          S71062
     C**                                                                  S71062
     C                     MOVE WWDDAY    WWSDAY                          S71062
     C                     MOVE WWYEAR    WWSYER                          S71062
     C                     Z-ADDWWMONT    X       20                      S71062
     C                     MOVE ZMNM,X    WWSMTH                          S71062
     C                     MOVELWWSDAT    WWSETD                          S71062
     C                     ELSE                                           S71062
     C                     MOVEL*BLANKS   WWSETD                          S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C** OUTPUT AMERICAN/EUROPEAN                                         S71062
     C**                                                                  S71062
     C                     SELEC                                          S71062
     C           QFAEIN    WHEQ 'A'                                       S71062
     C                     MOVEL'AMERICAN'WWAMEU                          S71062
     C           QFAEIN    WHEQ 'E'                                       S71062
     C                     MOVEL'EUROPEAN'WWAMEU                          S71062
     C                     OTHER                                          S71062
     C                     MOVEL*BLANKS   WWAMEU                          S71062
     C                     ENDSL                                          S71062
     C                     WRITEP952DET8
     C*                                                                   S71062
     C** Output contingent amount for OTC options only                    S71062
     C**                                                                  S71062
     C                     MOVE *BLANKS   WWNAR2                          S71062
     C                     MOVELQFTXT2    WWTXT2                          S71062
     C           QFPUIT    IFNE *ZEROS                                    S71062
     C                     MOVEL*BLANKS   ZFLD15                          S71062
     C                     MOVE QFPUIT    ZFLD15                          S71062
     C                     Z-ADDQFCDP2    ZDECS                           S71062
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    WWCTGA                          S71062
     C                     MOVE WWPCST    WWSTRK                          S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   WWCTGA                          S71062
     C                     MOVELWWMTHQ    WWCTGA                          S71062
     C                     MOVE WWPCST    WWCTGA                          S71062
     C                     END                                            S71062
     C*
     C** WRITE DETAIL LINE (W0903)
     C***********          MOVELQFTRNB    R2TRNB                          S71062
     C                     WRITEP952DET9
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10     - PROCESS MM DEALS                                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P10      BEGSR
     C*
     C** OUTPUT NOMINAL/QTY FROM PMHDVNLL USING ZSEDIT
     C                     Z-ADDWW1DEC    WWPDEC
     C           QFMODI    IFEQ 'MD'                                      48007
     C           FCPORS    ANDNE'B'                                       CPM004
     C           QFMODI    OREQ 'FI'                                      48007
     C           QFMODI    OREQ 'ML'                                      CPM004
     C           FCPORS    ANDEQ'B'                                       CPM004
     C                     Z-ADDQFAMT1    WWWORK
     C                     ELSE                                           48007
     C                     Z-SUBQFAMT1    WWWORK                          48007
     C                     END                                            48007
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** OUTPUT NOMINAL/QTY TO REPORT
     C                     MOVE ZOUT21    R2NOMQ
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT NAME FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DES6
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP1    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C           QFTVDA    IFNE 'T'
     C                     ADD  ZAMTT     WWTIMV
     C                     END
     C*
     C** STORE CONVERTED MARKET VALUE AS MARKET VALUE PORTFOLIO CCY
     C                     Z-ADDZAMTT     WWMVPC
     C*
     C** MOVE MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWMVPC    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCVL
     C*
     C** IF NEXT INTEREST DATE ON PMHDVNLL IS ZERO
     C                     MOVE '0'       *IN31
     C                     MOVE *BLANKS   R2MMPC
     C*
     C           QFACIS    IFEQ *ZEROS
     C                     MOVE '1'       *IN31
     C*
     C** CALCULATE PERCENTAGE
     C           QFTVDA    IFNE 'T'
     C           WWPORT    IFEQ *ZEROS
     C                     Z-ADD*ZEROS    WWIPC1  43
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           ZAMTT     DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C           WWIPC1    MULT 100       WWIPC2  41
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2MMPC
     C                     END
     C*
     C                     ELSE
     C                     MOVE *BLANKS   R2MMPC
     C                     END
     C*
     C** WRITE DETAIL LINE (W1001)
     C                     WRITEP952DT10
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C** OUTPUT MARKET FX RATE USING 'ZCRSRT' OUTPUT FROM ZCCYCN
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C*
     C** IF DEAL IS FORWARD VALUED OUTPUT TEXT 'FORWARD'
     C           QFTVDA    IFEQ 'T'
     C           WWTVPS    ANDEQ'T'                                       46081
     C           QFTVDA    OREQ 'X'                                       46081
     C           WWTVPS    ANDEQ'V'                                       46081
     C                     MOVE WWMG26    R2FWRD
     C                     ELSE
     C                     MOVE *BLANKS   R2FWRD
     C                     END
     C*
     C** WRITE DETAIL LINE (W1002)
     C                     MOVE QFTXT2    R2DES7
     C*                                                                   S01313
     C** OUTPUT PLACED WITH CUSTOMER NAME                                 S01313
     C********** QFPLWH    IFNE 0                                                      S01313 CSD027
     C           QFPLWH    IFNE *BLANKS                                                       CSD027
     C                     MOVE QFPLWH    WWPLWH  6                       S01313
     C*                                                                   S01313
     C**   ACCESS CUSTOMER DETAILS FOR PLACED WITH NAME                   S01313
     C***********WWPLWH    CHAINSDCUSTL0             60             S01313S01486
     C                     MOVELWWPLWH    KEYCN                           S01486
     C                     CALL 'AOCUSTR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM           KEYCN  10                       S01486
     C                     PARM *BLANKS   KEYST   7                       S01486
     C           SDCUST    PARM SDCUST    DSSDY                           S01486
     C*                                                                   S01313
     C**   IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR    S01313
     C************IN60     IFEQ '1'                                 S01313S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C                     Z-ADD18        WBASE                           S01313
     C                     MOVE *BLANKS   WBFILE           ***************S01313
     C                     MOVEL'SDCUSTL0'WBFILE           ** DBERROR  018S01313
     C                     MOVE *BLANKS   WBKEY            ***************S01313
     C                     MOVELWWPLWH    WBKEY                           S01313
     C                     MOVE '9'       WWRTCD                          S01313
     C                     EXSR *PSSR                                     S01313
     C                     END                                            S01313
     C*                                                                   S01313
     C                     MOVELBBCRNM    R2PLWC                          S01313
     C                     MOVE BBCRTN    R2PLWC                          S01313
     C                     MOVELWW5240    MS5240                          S01313
     C                     ELSE                                           S01313
     C                     MOVE *BLANKS   R2PLWC                          S01313
     C                     MOVE *BLANKS   MS5240                          S01313
     C                     END                                            S01313
     C*                                                                   S01313
     C** OUTPUT FROM DATE                                                 S01313
     C           QFVDAT    IFNE 0                                         S01313
     C                     Z-ADDQFVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    R2VDAT
     C                     MOVELWW5241    MS5241                          S01313
     C                     ELSE                                           S01313
     C                     MOVE *BLANKS   R2VDAT                          S01313
     C                     MOVE *BLANKS   MS5241                          S01313
     C                     END                                            S01313
     C                     WRITEP952DT11
     C*
     C** CALL P14 TO SET UP ACCRUED INTEREST DETAILS
     C                     EXSR #P14
     C*
     C** WRITE DETAIL LINE (W1003)
     C                     MOVELQFTRNB    R2TRSN
     C           QFMODI    IFEQ 'F'                                       48007
     C                     WRITEP952DT12
     C                     ELSE                                           48007
     C                     MOVE R2TRSN    RXTRSN                          48007
     C                     MOVE R2MG18    RXMG18                          48007
     C                     MOVE R2NDAI    RXNDAI                          48007
     C                     MOVE R2NIDT    RXNIDT                          48007
     C                     MOVE R2PACC    RXPACC                          48007
     C                     WRITEP952D12A                                  48007
     C                     END                                            48007
     C*
     C** CALL P16 TO OUTPUT TOTAL DETAILS
     C           QFACIS    IFNE 0
     C                     EXSR #P16
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P11     - PROCESS FX DEALS AND FRA/IRS                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWMG16   - 'BUY' NARRATIVE FOR FX DEALS                          *
      * WWMG17   - 'SELL' NARRATIVE FOR FX DEALS                         *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      *                                                                  *
      ********************************************************************
     C*
     C           #P11      BEGSR
     C*
     C** MOVE LINE 1 AMOUNT FROM PMHDVNLL INTO WORK FIELD FOR Y01
     C                     Z-ADDWW1DEC    WWPDEC
     C                     Z-ADDQFAMT1    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2AMT1
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DES8
     C*
     C** MOVE 'BUY' OR 'SELL' ACCORDING TO 'BUY OR SELL FIRST' INDIC.
     C********** QFBYSF    IFEQ 'B'                                       CPM005
     C                     MOVELWWMG16    R2MG16
     C                     MOVELWWMG17    R2MG17
     C**********           ELSE                                           CPM005
     C**********           MOVELWWMG17    R2MG16                          CPM005
     C**********           MOVELWWMG16    R2MG17                          CPM005
     C**********           END                                            CPM005
     C**********                                                          CPM005
     C***WRITE*DETAIL LINE (W1101)                                        CPM005
     C**********           WRITEP952DT13                                  CPM005
     C*
     C** MOVE LINE 2 AMOUNT FROM PMHDVNLL INTO WORK FIELD FOR Y01
     C                     Z-ADDWW2DEC    WWPDEC
     C                     Z-ADDQFAMT2    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2AMT2
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT2    R2DES9
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL USING ZEDIT
     C           QFBFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2BFXR
     C*
     C                     END
     C*
     C** OUTPUT MARKET FX RATE USING 'ZCRSRT' OUTPUT FROM ZCCYCN
     C           QFMFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MFXR
     C                     END
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C           QFMVAL    IFNE 0
     C                     Z-ADDQFMVAL    WWWORK
     C***********QFFPLC    CHAINSDCURRL0             73                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM QFFPLC    KEYCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C************IN73     IFEQ '1'                                       S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C                     Z-ADD5         WBASE
     C                     MOVE *BLANKS   WBFILE           ***************
     C                     MOVEL'SDCURRL0'WBFILE           ** DBERROR  005
     C                     MOVE *BLANKS   WBKEY            ***************
     C                     MOVELQFFPLC    WBKEY
     C                     MOVE '9'       WWRTCD
     C                     EXSR *PSSR
     C                     END
     C                     Z-ADDA6NBDP    WWPDEC
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C                     ELSE
     C                     MOVE *BLANKS   R2FXPL
     C                     END
     C*
     C           QFOPCL    IFEQ 'C'
     C           QFOPCL    OREQ 'M'
     C                     MOVE *BLANKS   R2FPLC
     C                     ELSE
     C                     MOVELQFFPLC    R2FPLC
     C                     END
     C*
     C** FORMAT ACCRUED INTEREST
     C                     MOVE *BLANKS   R2FORX
     C           QFOPCL    IFNE 'C'
     C                     Z-ADDQFPLFX    WWWORK
     C                     ADD  QFPLFX    WWTINT
     C                     ADD  QFPLFX    ZAMTT
     C                     Z-ADDWWPDCS    WWPDEC
     C                     EXSR #Y01
     C                     MOVE ZOUT21    R2FORX
     C                     END
     C*                                                                   062287
     C** CALCULATE REALISED AND UNREALISED P/L                            062287
     C           QFOPCL    IFEQ 'L'                                       062287
     C                     ADD  QFPLFX    WXUNPL 150                      062287
     C                     END                                            062287
     C*                                                                   062287
     C           QFOPCL    IFEQ 'O'                                       062287
     C                     ADD  QFPLFX    WXRLPL 150                      062287
     C                     END                                            062287
     C*
     C                     MOVE *BLANKS   R2FORP
     C           QFPLFX    IFNE 0
     C           WWPORT    ANDNE0
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           QFPLFX    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           QFPLFX    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           QFPLFX    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C           WWIPC1    MULT 100       WWIPC2
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2FORP
     C                     END
     C*                                                                   CPM005
     C** ALWAYS OUTPUT BOUGHT CURRENCY FIRST                              CPM005
     C                     MOVE R2AMT1    WRAMT1 15                       CPM005
     C                     MOVE R2AMT2    WRAMT2 15                       CPM005
     C*                                                                   CPM005
     C           QFBYSF    IFEQ 'S'                                       CPM005
     C                     MOVE WRAMT2    R2AMT1                          CPM005
     C                     MOVE WRAMT1    R2AMT2                          CPM005
     C                     END                                            CPM005
     C                     WRITEP952DT13                                  CPM005
     C*
     C** WRITE DETAIL LINE (W1102)
     C                     WRITEP952DT14
     C*
     C** FORMAT FX DEAL TEXT FOR ENQUIRIES
     C                     MOVE *BLANKS   R2OPCL                          064394
     C*                                                                   064394
     C           QFOPCL    IFEQ 'L'
     C                     MOVE *BLANKS   R2OPCL
     C                     MOVELWWMG27    R2OPCL
     C                     END
     C*
     C           QFOPCL    IFEQ 'O'
     C                     MOVELWWMG28    R2OPCL
     C                     MOVE QFRLDN    R2OPCL
     C                     END
     C*
     C           QFOPCL    IFEQ 'C'
     C*
     C           QFDTYP    IFEQ 'OP'
     C                     MOVE *BLANKS   R2OPCL
     C***********          MOVELWWMG29    R2OPCL                          064394
     C                     ELSE
     C                     MOVELWWMG30    R2OPCL
     C                     MOVE QFRLDN    R2OPCL
     C                     END
     C*
     C                     MOVE *BLANKS   R2FXPL
     C                     MOVE *BLANKS   R2FPLC
     C                     MOVE *BLANKS   R2FORP
     C                     MOVE *BLANKS   R2FORX
     C*
     C                     END
     C*
     C** WRITE DETAIL LINE (W1103)
     C                     MOVELQFTRNB    R2TRAN
     C                     WRITEP952DT15
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P12     - PROCESS LE HOLDINGS                                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P12      BEGSR
     C*
     C** OUTPUT NOMINAL/QTY FROM PMHDVNLL USING ZSEDIT
     C                     Z-ADDWW1DEC    WWPDEC
     C           FCPORS    IFNE 'B'                                       CPM004
     C                     Z-SUBQFAMT1    WWWORK
     C                     ELSE                                           CPM004
     C                     Z-ADDQFAMT1    WWWORK                          CPM004
     C                     END                                            CPM004
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** OUTPUT NOMINAL/QTY TO REPORT
     C                     MOVE ZOUT21    R2QTY1
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT NAME FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DS10
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP1    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C           QFTVDA    IFNE 'T'
     C                     ADD  ZAMTT     WWTIMV
     C                     END
     C*
     C** STORE CONVERTED MARKET VALUE AS MARKET VALUE PORTFOLIO CCY
     C                     Z-ADDZAMTT     WWMVPC
     C*
     C** MOVE MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWMVPC    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2CCYV
     C*
     C** IF NEXT INTEREST DATE ON PMHDVNLL IS ZERO
     C                     MOVE '0'       *IN31
     C                     MOVE *BLANKS   R2OPPC
     C*
     C           QFACIS    IFEQ *ZEROS
     C                     MOVE '1'       *IN31
     C*
     C** CALCULATE PERCENTAGE
     C           QFTVDA    IFNE 'T'
     C           WWPORT    IFEQ *ZEROS
     C                     Z-ADD*ZEROS    WWIPC1  43
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           ZAMTT     DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C           WWIPC1    MULT 100       WWIPC2  41
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2OPPC
     C                     END
     C*
     C                     ELSE
     C                     MOVE *BLANKS   R2OPPC
     C                     END
     C*
     C** WRITE DETAIL LINE (W1201)
     C                     WRITEP952DT16
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL USING ZEDIT
     C           QFBFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2BFXR
     C*
     C                     END
     C*
     C** OUTPUT MARKET FX RATE USING MARKET RATE FROM PMHDVNLL
     C           QFMFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MFXR
     C                     END
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C           QFPLFX    IFNE 0
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C                     ELSE
     C                     MOVE *BLANKS   R2FXPL
     C                     END
     C*
     C** IF DEAL IS FORWARD VALUED OUTPUT TEXT 'FORWARD'
     C           QFTVDA    IFEQ 'T'
     C           WWTVPS    ANDEQ'T'                                       46081
     C           QFTVDA    OREQ 'X'                                       46081
     C           WWTVPS    ANDEQ'V'                                       46081
     C                     MOVE WWMG26    R2FWR1
     C                     ELSE
     C                     MOVE *BLANKS   R2FWR1
     C                     END
     C*
     C** WRITE DETAIL LINE (W1202)
     C                     MOVE QFTXT2    R2DS11
     C                     WRITEP952DT17
     C*
     C** CALL P14 TO SET UP ACCRUED INTEREST DETAILS
     C                     EXSR #P14
     C*
     C** WRITE DETAIL LINE (W1203)
     C                     MOVELQFTRNB    R2TNUM
     C                     WRITEP952DT18
     C*
     C** CALL P16 TO OUTPUT TOTALS LINE
     C           QFACIS    IFNE 0
     C                     EXSR #P16
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P13     - PROCESS RE HOLDINGS                                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * #P15     - PRODUCE RE ACCRUED INTEREST DETAILS                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWNOM1   - USED TO FORMAT NOMINAL/QTY FOR RE HOLDINGS            *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      * WWIDES   - USED TO SET UP LINE 3 INSTRUMENT DESCRIPTION          *
      * WWIDSC   - USED TO SET UP LINE 3 INSTRUMENT DESCRIPTION          *
      *                                                                  *
      ********************************************************************
     C*
     C           #P13      BEGSR
     C*
     C** OUTPUT NOMINAL/QTY FROM PMHDVNLL USING ZSEDIT
     C                     Z-ADDWW1DEC    WWPDEC
     C           FCPORS    IFNE 'B'                                       CPM004
     C                     Z-SUBQFAMT1    WWWORK
     C                     ELSE                                           CPM004
     C                     Z-ADDQFAMT1    WWWORK                          CPM004
     C                     END                                            CPM004
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** OUTPUT NOMINAL/QTY TO REPORT
     C                     MOVE ZOUT21    WWNOM1 18
     C                     Z-ADDWWPDCS    WWPDEC
     C*********************MOVELWWNOM1    R2NOM1                          038233
     C*                                                                   038233
     C           FCPORS    IFNE 'B'                                       CPM004
     C                     Z-SUBQFAMT1    ZFLD15                          038233
     C                     ELSE                                           CPM004
     C                     Z-ADDQFAMT1    ZFLD15                          CPM004
     C                     END                                            CPM004
     C                     Z-ADDQFCDP1    ZDECS                           038233
     C                     MOVE 'J'       ZECODE                          038233
     C                     EXSR ZSEDIT                                    038233
     C                     MOVE ZOUT21    R2NOM1                          038233
     C*                                                                   46081
     C** IF VALUE DATE POSITIONS AND OTHER NOMINAL DIFFERENT OUTPUT       46081
     C** FIGURES IN BRACKETS                                              46081
     C                     MOVE *BLANKS   R2NQT2                          46081
     C****       WWTVPS    IFEQ 'V'                                 48007 46081
     C****       QFAMT1    ANDNEQFOAMT                              48007 46081
     C           QFAMT1    IFNE QFOAMT                                    48007
     C           QFOAMT    ANDNE*HIVAL                                    46081
     C           FCPORS    IFNE 'B'                                       CPM004
     C                     Z-SUBQFOAMT    ZFLD15                          46081
     C                     ELSE                                           CPM004
     C                     Z-ADDQFOAMT    ZFLD15                          CPM004
     C                     END                                            CPM004
     C                     Z-ADDQFCDP1    ZDECS                           46081
     C                     MOVE 'J'       ZECODE                          46081
     C                     EXSR ZSEDIT                                    46081
     C****                 MOVE ZOUT21    R2NQT2                    48007 46081
     C                     MOVE ZOUT21    WWWK17 17                       48007
     C                     MOVELWWWK17    R2NQT2                          48007
     C                     MOVEL'('       R2NQT2                          46081
     C                     MOVE ')'       R2NQT2                          46081
     C                     END                                            46081
     C*
     C** OUTPUT INSTRUMENT NAME FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DS12
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP1    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C*
     C** OUTPUT MARKET RATE USING RATE FROM FILE
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MKRT
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C                     ADD  ZAMTT     WWTIMV
     C*
     C** STORE CONVERTED MARKET VALUE AS MARKET VALUE PORTFOLIO CCY
     C                     Z-ADDZAMTT     WWMVPC
     C*
     C** MOVE MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWMVPC    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCYV
     C*
     C** IF ACCRUE INTEREST ON PMHDVNLL IS ZERO CALCULATE PORTFOLIO PERCENTAGE
     C                     MOVE '0'       *IN31
     C                     MOVE *BLANKS   R2REPC
     C*
     C           QFACIS    IFEQ *ZEROS
     C                     MOVE '1'       *IN31
     C*
     C** CALCULATE PERCENTAGE
     C           WWPORT    IFEQ *ZEROS
     C                     Z-ADD*ZEROS    WWIPC1  43
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           ZAMTT     DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C           WWIPC1    MULT 100       WWIPC2  41
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2REPC
     C                     END
     C*
     C** WRITE DETAIL LINE (W1301)
     C******************** WRITEP952DT19                                  056552
     C*
     C** WRITE DETAIL LINE (W1302)
     C                     MOVE QFTXT2    R2DS13
     C******************** WRITEP952DT20                                  056552
     C*
     C** SET UP LINE 3 INSTRUMENT DESCRIPTION FOR REPORT
     C                     MOVELWWACCD    WWIDES  5
     C                     MOVE '-'       WWIDES
     C                     MOVELWWIDES    WWIDSC  7
     C                     MOVE WWACSQ    WWIDSC
     C****                                                                48007
     C***OUTPUT DESCRIPTION 3 TO REPORT                                   48007
     C****                 MOVELWWIDSC    R2DS14                          48007
     C****                                                                48007
     C***WRITE DETAIL LINE (W1303)                                        48007
     C****                 WRITEP952DT21                                  48007
     C*****                MOVE *BLANKS   R2NQT2                     4608148007
     C*
     C** CALL SUBROUTINE P15 TO PRODUCE RE ACCRUED INTEREST DETAILS
     C                     EXSR #P15
     C*
     C                     MOVE R2PCYV    WWORK3  3                       056552
     C                     MOVELWWORK3    WWORK2  2                       056552
     C                     MOVE R2PACC    WWORK3                          056552
     C                     MOVELWWORK3    WXORK2  2                       056552
     C           R2NQT2    IFNE *BLANKS                                   056552
     C           WWORK2    ORNE ' 0'                                      056552
     C           WXORK2    ORNE ' 0'                                      056552
     C                     WRITEP952DT19                                  056552
     C                     WRITEP952DT20                                  056552
     C                     WRITEP952DT23                                  056552
     C                     END                                            056552
     C*
     C                     MOVE *BLANKS   R2NQT2                          48007
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - CONVERT 5 FIG DAY NUMBER TO DATE FORMAT               *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P10     - PROCESS MM DEALS                                      *
      * #P12     - PROCESS LE HOLDINGS                                   *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTINT   - TOTAL INSTRUMENT INTEREST                             *
      * WWTMVP   - TOTAL MARKET VALUE IN PORTFOLIO CURRENCY              *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      *                                                                  *
      ********************************************************************
     C*
     C           #P14      BEGSR
     C*
     C** OUTPUT NUMBER OF DAYS ACCRUED INTEREST FROM PMHDVNLL
     C                     MOVE QFNODA    R2NDAI
     C*
     C** OUTPUT NEXT INTEREST DATE FROM PMHDVNLL USIND ZDATE2
     C                     Z-ADDQFNIDT    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    R2NIDT
     C*
     C** CONVERT ACCRUED INT. FROM CCY1 TO PORTFOLIO CCY USING ZCCYCN
     C                     Z-ADDQFACIS    ZAMTF
     C           QFMODI    IFNE 'SE'
     C                     Z-ADDQFCDP1    ZCDPF
     C                     ELSE
     C                     Z-ADDQFCDP2    ZCDPF
     C                     END
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C*
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFAIPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED ACCRUED INTEREST (ZAMTT) TO TOTAL INST. INTEREST
     C                     ADD  ZAMTT     WWTINT
     C*
     C** ADD CONVERTED ACCRUED INTEREST TO WORK FIELD MARKET VALUE
     C**   PORTFOLIO CURRENCY (FROM CALLING PROCESS) TO GIVE TOTAL
     C**     MARKET VALUE IN PORTFOLIO CURRENCY
     C           WWMVPC    ADD  ZAMTT     WWTMVP
     C*
     C** IF ACCRUED INTEREST NOT ZERO FORMAT AMOUNT FOR OUTPUT
     C           ZAMTT     IFNE 0
     C                     Z-ADDZAMTT     WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PACC
     C                     MOVE '1'       *IN30
     C                     ELSE
     C                     MOVE *BLANKS   R2PACC
     C                     MOVE '0'       *IN30
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P15     - PRODUCE RE ACCRUED INTEREST DETAILS                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P13     - PROCESS RE HOLDINGS                                   *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTINT   - TOTAL INSTRUMENT INTEREST                             *
      * WWTMVP   - TOTAL MARKET VALUE IN PORTFOLIO CURRENCY              *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P15      BEGSR
     C*
     C** CHECK WHETHER INTEREST ACCRUED IS NON ZERO
     C           QFACIS    IFNE 0
     C                     MOVE '1'       *IN30
     C                     ELSE
     C                     MOVE '0'       *IN30
     C                     END
     C*
     C** CONVERT ACCRUED INT. FROM CCY1 TO PORTFOLIO CCY USING ZCCYCN
     C                     Z-ADDQFACIS    ZAMTF
     C                     Z-ADDQFCDP1    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFAIPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED ACCRUED INTEREST (ZAMTT) TO TOTAL INST. INTEREST
     C                     ADD  ZAMTT     WWTINT
     C*
     C** MOVE ACCRUED INTEREST FOR INSTRUMENT INTO WORK FIELD
     C                     Z-ADDZAMTT     WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PACC
     C*
     C** ADD CONVERTED ACCRUED INTEREST TO WORK FIELD MARKET VALUE
     C**   PORTFOLIO CURRENCY (FROM CALLING PROCESS) TO GIVE TOTAL
     C**     MARKET VALUE IN PORTFOLIO CURRENCY
     C           WWMVPC    ADD  ZAMTT     WWTMVP
     C*
     C** MOVE TOTAL MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWTMVP    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCVB
     C*
     C** CALCULATE PERCENTAGE
     C           WWPORT    IFEQ *ZEROS
     C                     Z-ADD*ZEROS    WWIPC1  43
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           WWTMVP    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           WWTMVP    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           WWTMVP    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C           WWIPC1    MULT 100       WWIPC2  41
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2PRCB
     C*
     C** WRITE DETAIL LINE (W15)
     C******************** WRITEP952DT23                                  056552
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P16     - PRODUCE TOTALS LINE                                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P10     - PROCESS MM DEALS                                      *
      * #P12     - PROCESS LE HOLDINGS                                   *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P16      BEGSR
     C*
     C** MOVE TOTAL MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWTMVP    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCVA
     C*
     C** CALCULATE PERCENTAGE
     C           WWPORT    IFEQ *ZEROS
     C                     Z-ADD*ZEROS    WWIPC1  43
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           WWTMVP    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           WWTMVP    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           WWTMVP    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C           WWIPC1    MULT 100       WWIPC2  41
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2CPPY
     C*
     C** WRITE DETAIL LINE (W14)
     C                     WRITEP952DT22
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P17     - OUTPUT LOMBARD DETAILS ON VALUATION STATEMENT         *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      *                                                                  *
      ********************************************************************
     C*
     C           #P17      BEGSR
     C*
     C** MOVE LINE 1 AMOUNT FROM PMHDVNLL INTO WORK FIELD FOR Y01
     C                     Z-ADDWW1DEC    WWPDEC
     C                     Z-ADDQFAMT1    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2AMT1
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DES8
     C*
     C** CHECK WHETHER GUARANTEE/PLEDGE GIVEN/RECEIVED
     C                     MOVELQFTXT2    WWCHK5  5
     C                     MOVE WWCHK5    WWCHK1  1
     C           WWCHK1    IFEQ 'R'
     C                     MOVE '1'       *IN30
     C                     ELSE
     C                     MOVE '0'       *IN30
     C                     END
     C*
     C** WRITE DETAIL LINE (W1101)
     C                     WRITEP952DT24
     C*
     C** MOVE LINE 2 AMOUNT FROM PMHDVNLL INTO WORK FIELD FOR Y01
     C                     Z-ADDWW1DEC    WWPDEC
     C                     Z-ADDQFAMT2    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2AMT2
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT2    R2DES9
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL USING ZEDIT
     C           QFBFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2BFXR
     C*
     C                     END
     C*
     C*
     C** OUTPUT MARKET FX RATE USING 'ZCRSRT' OUTPUT FROM ZCCYCN
     C           QFMFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE    H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD5         ZADIG
     C                     Z-ADD5         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MFXR
     C                     END
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C           QFPLFX    IFNE 0
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C                     ELSE
     C                     MOVE *BLANKS   R2FXPL
     C                     END
     C*
     C** WRITE DETAIL LINE (W1102)
     C                     WRITEP952DT25
     C*
     C** WRITE DETAIL LINE (W1103)
     C                     MOVELQFTRNB    R2TRAN
     C                     WRITEP952DT26
     C*
     C                     ENDSR
      ********************************************************************CPM005
      /EJECT                                                              CPM005
      ********************************************************************CPM005
      *                                                                  *CPM005
      * #GRTO    - OUTPUT GROUP TOTAL                                    *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLS:                                                *CPM005
      * #P16     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLED FROM:                                          *CPM005
      *                                                                  *CPM005
      * ROUTINE USES VARIABLES:                                          *CPM005
      *                                                                  *CPM005
      ********************************************************************CPM005
     C*                                                                   CPM005
     C           #GRTO     BEGSR                                          CPM005
     C*                                                                   CPM005
     C**********           Z-ADDQFCNUM    K2CNUM                                       CPM005 CSD027
     C                     MOVE QFCNUM    K2CNUM                                              CSD027
     C                     MOVELQFPTFR    K2PTFR                          CPM005
     C                     MOVEL'I'       K2TOTT                          CPM005
     C*                                                                   101118
     C** 1st read with current position  FEPOTY = 'C '                    101118
     C                     MOVEL'C '      K2POTY                          101118
     C                     MOVELK2DGRC    SVDGRC  3                       101118
     C                     Z-ADDK2DGRS    SVDGRS  20                      101118
     C                     MOVELK2INSC    SVINSC  3                       101118
     C                     Z-ADDK2INSS    SVINSS  20                      101118
     C*                                                                   CPM005
     C           PMASL0    SETLLPMASLIL0                                  CPM005
     C                     READ PMASLIL0                 73               CPM005
     C*                                                                   CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C           F3CNUM    ORNE K2CNUM                                    101118
     C           F3DGRC    ORNE K2DGRC                                    101118
     C           F3PTFR    ORNE K2PTFR                                    101118
     C           F3POTY    ORNE K2POTY                                    101118
     C           F3TOTT    ORNE K2TOTT                                    101118
     C           F3INSC    ORNE K2INSC                                    101188
     C******************** Z-ADD7         WBASE                    CPM005 101118
     C******************** MOVE *BLANKS   WBFILE           ********CPM005 101118
     C******************** MOVEL'PMASLIL0'WBFILE           ** DBERRCPM005 101118
     C******************** MOVE *BLANKS   WBKEY            ********CPM005 101118
     C******************** MOVELWWERRO    WBKEY                    CPM005 101118
     C******************** MOVE '9'       WWRTCD                   CPM005 101118
     C******************** EXSR *PSSR                              CPM005 101118
     C                     Z-ADD*ZEROS    F3ASSV                          101118
     C                     Z-ADD*ZEROS    F3LIAV                          101118
     C                     END                                            CPM005
     C*                                                                   CPM005
     C                     Z-ADDF3ASSV    SVASSV 150                      097944
     C                     Z-ADDF3LIAV    SVLIAV 150                      097944
     C*                                                                   CPM005
     C** 2nd read with future opened position  FEPOTY = 'FO'              101118
     C**********           Z-ADDQFCNUM    K2CNUM                                       097944 CSD027
     C                     MOVE QFCNUM    K2CNUM                                              CSD027
     C                     MOVELQFPTFR    K2PTFR                          097944
     C                     MOVEL'FO'      K2POTY                          097944
     C                     MOVEL'I'       K2TOTT                          097944
     C                     MOVELSVDGRC    K2DGRC                          101118
     C                     Z-ADDSVDGRS    K2DGRS                          101118
     C                     MOVELSVINSC    K2INSC                          101118
     C                     Z-ADDSVINSS    K2INSS                          101118
     C*                                                                   097944
     C           PMASL0    SETLLPMASLIL0                                  097944
     C                     READ PMASLIL0                 73               097944
     C*                                                                   097944
     C           *IN73     IFEQ '1'                                       097944
     C           F3CNUM    ORNE K2CNUM                                    099985
     C           F3DGRC    ORNE K2DGRC                                    099985
     C           F3PTFR    ORNE K2PTFR                                    099985
     C           F3POTY    ORNE K2POTY                                    099985
     C           F3TOTT    ORNE K2TOTT                                    099985
     C           F3INSC    ORNE K2INSC                                    101188
     C                     Z-ADD*ZEROS    F3ASSV                          097944
     C                     Z-ADD*ZEROS    F3LIAV                          097944
     C                     END                                            097944
     C*                                                                   097944
     C                     ADD  F3ASSV    SVASSV                          101118
     C                     ADD  F3LIAV    SVLIAV                          101118
     C*                                                                   101118
     C** 3nd read with future closed position  FEPOTY = 'FC'              101118
     C**********           Z-ADDQFCNUM    K2CNUM                                       101118 CSD027
     C                     MOVE QFCNUM    K2CNUM                                              CSD027
     C                     MOVELQFPTFR    K2PTFR                          101118
     C                     MOVEL'FC'      K2POTY                          101118
     C                     MOVEL'I'       K2TOTT                          101118
     C                     MOVELSVDGRC    K2DGRC                          101118
     C                     Z-ADDSVDGRS    K2DGRS                          101118
     C                     MOVELSVINSC    K2INSC                          101118
     C                     Z-ADDSVINSS    K2INSS                          101118
     C*                                                                   101118
     C           PMASL0    SETLLPMASLIL0                                  101118
     C                     READ PMASLIL0                 73               101118
     C*                                                                   101118
     C           *IN73     IFEQ '1'                                       101118
     C           F3CNUM    ORNE K2CNUM                                    101118
     C           F3DGRC    ORNE K2DGRC                                    101188
     C           F3PTFR    ORNE K2PTFR                                    101118
     C           F3POTY    ORNE K2POTY                                    101118
     C           F3TOTT    ORNE K2TOTT                                    101118
     C           F3INSC    ORNE K2INSC                                    101188
     C                     Z-ADD*ZEROS    F3ASSV                          101118
     C                     Z-ADD*ZEROS    F3LIAV                          101118
     C                     END                                            101118
     C*                                                                   101118
     C                     ADD  SVASSV    F3ASSV                          101118
     C                     ADD  SVLIAV    F3LIAV                          101118
     C*                                                                   101118
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE F3ASSV    ZFLD15                          CPM005
     C                     Z-ADDWWPDEC    ZDECS                           CPM005
     C                     MOVE 'J'       ZECODE                          CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    R2TOTL                          CPM005
     C*                                                                   CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE F3LIAV    ZFLD15                          CPM005
     C                     Z-ADDWWPDEC    ZDECS                           CPM005
     C                     MOVE 'J'       ZECODE                          CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    R2TOTA                          CPM005
     C*                                                                   CPM005
     C           WWASSV    IFNE *ZEROS                                    CPM005
     C           F3ASSV    DIV  WWASSV    WWDIVI  43H                     CPM005
     C           WWDIVI    MULT 100       WWPERC  41H                     CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADD*ZEROS    WWPERC                          CPM005
     C                     END                                            CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPERC    ZFLD15                          CPM005
     C                     Z-ADD1         ZDECS                           CPM005
     C                     MOVE 'J'       ZECODE                          CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    R2TOTP                          CPM005
     C*                                                                   CPM005
     C           WWLIAV    IFNE *ZEROS                                    CPM005
     C                     Z-SUBF3LIAV    WWFLD4 150                      CPM005
     C           WWFLD4    DIV  WWLIAV    WWDIVI  43H                     CPM005
     C           WWDIVI    MULT 100       WWPERC  41H                     CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADD*ZEROS    WWPERC                          CPM005
     C                     END                                            CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPERC    ZFLD15                          CPM005
     C                     Z-ADD1         ZDECS                           CPM005
     C                     MOVE 'J'       ZECODE                          CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    R2TOPC                          CPM005
     C*                                                                   CPM005
     C                     WRITEP950GTOT                                  CPM005
     C*                                                                   CPM005
     C                     ENDSR                                          CPM005
     C*                                                                   CPM005
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - PRODUCE INSTRUMENT TOTALS                             *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P08     - PROCESS SE NON INTEREST-BEARING HOLDINGS              *
      * #P09     - PROCESS FF HOLDINGS                                   *
      * #P10     - PROCESS MM DEALS                                      *
      * #P11     - PROCESS FX DEALS AND FRA/IRS                          *
      * #P12     - PROCESS LE HOLDINGS                                   *
      * #P13     - PROCESS RE HOLDINGS                                   *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      * #P15     - PRODUCE RE ACCRUED INTEREST DETAILS                   *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWFLD0   - USED WHEN PORTFOLIO CURRENCY HAS NO DECIMAL PLACES    *
      * WWFLD1   - USED WHEN PORTFOLIO CURRENCY HAS ONE DECIMAL PLACE    *
      * WWFLD2   - USED WHEN PORTFOLIO CURRENCY HAS TWO DEC. PLACES      *
      * WWFLD3   - USED WHEN PORTFOLIO CURRENCY HAS THREE DEC. PLACES    *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      *                                                                  *
      ********************************************************************
     C*
     C           #Y01      BEGSR
     C*
     C** INITIALISE FIELDS USED FOR AMOUNT
     C*
     C                     Z-ADD*ZEROS    WWFLD0 150
     C                     Z-ADD*ZEROS    WWFLD1 151
     C                     Z-ADD*ZEROS    WWFLD2 152
     C                     Z-ADD*ZEROS    WWFLD3 153
     C*
     C** SET INDICATOR FOR NUMBER OF DECIMAL PLACES
     C*
     C                     MOVEA'0000'    *IN,23
     C           23        ADD  WWPDEC    V       20
     C                     MOVEA'1'       *IN,V
     C*
     C** MOVE TOTAL INSTRUMENT MARKET VALUE INTO CORRECT FIELD
     C           *IN23     IFEQ '1'
     C                     MOVE WWWORK    WWFLD0
     C                     Z-ADDWWFLD0    ZFLD15
     C                     ELSE
     C           *IN24     IFEQ '1'
     C                     MOVE WWWORK    WWFLD1
     C                     Z-ADDWWFLD1    ZFLD15    H
     C                     ELSE
     C           *IN25     IFEQ '1'
     C                     MOVE WWWORK    WWFLD2
     C                     Z-ADDWWFLD2    ZFLD15    H
     C                     ELSE
     C           *IN26     IFEQ '1'
     C                     MOVE WWWORK    WWFLD3
     C                     Z-ADDWWFLD3    ZFLD15    H
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C** EXECUTE STANDARD SUBROUTINE ZSEDIT FOR MARKET VALUE
     C                     Z-ADD*ZEROS    ZDECS
     C                     Z-ADDWWWORK    ZFLD15                          063049
     C                     Z-ADDWWPDEC    ZDECS                           063049
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #Y02     - CONVERT YIELD AMOUNTS TO FORMAT REQUIRED ON REPORT    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWYLD   - GENERAL WORK FIELD OF BOOK OR MARKET YIELD            *
      * WWHADJ   - USED TO HALF ADJUST YIELD AMOUNT FOR REPORT FORMAT    *
      * WWROUN   - USED TO ROUND YIELD AMOUNT FOR REPORT FORMAT          *
      *                                                                  *
      ********************************************************************
     C*
     C           #Y02      BEGSR
     C*
     C** MOVE LEFT THE FIRST FIVE FIGURES OUTPUT FROM ZEDIT TO OUTPUT
     C**   FIELD REQUIRED ON REPORT
     C                     MOVE *BLANKS   WWWYLD  6
     C                     MOVELWWYLDS    WWWYLD
     C*
     C** IF THE FOURTH DECIMAL POSITION IN OUTPUT FROM ZEDIT >= 5
     C           WWHADJ    IFGE 5
     C*
     C** ADD ONE TO THIRD DECIMAL POSITION TO ROUND UP
     C                     ADD  1         WWROUN
     C*
     C** MOVE ROUNDED UP FIGURE INTO OUTPUT FIELD
     C                     MOVE WWROUN    WWWYLD
     C*
     C                     ELSE
     C*
     C** LEAVE FIGURE AS IT STANDS AND MOVE TO OUTPUT FIELD
     C                     MOVE WWROUN    WWWYLD
     C*
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      /COPY ZSRSRC,ZSEDITZ3
      /EJECT
      /COPY ZSRSRC,ZEDITZ2
      ****/EJECT                                                          47719
      ****/COPY ZSRSRC,ZCCYCN                                             47719
      /EJECT
      /COPY ZSRSRC,ZCCYXR
      /EJECT                                                              S71062
      /COPY ZSRSRC,FFPRCSZ4                                               S71062
     C**************************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #INIT    - INITIAL PROCESSING                                    *
      * #P02     - PRODUCE VALUATION GROUP HEADING                       *
      * #P04     - PRODUCE INSTRUMENT TYPE HEADINGS                      *
      * #P05     - ACCESS CURRENCY DETAILS                               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C*
     C           *PSSR     BEGSR
     C*
     C** UPDATE DTAARA/LDA WITH DETAILS OF ERROR
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVE WBFILE    DBFILE
     C                     MOVE WBKEY     DBKEY
     C                     Z-ADDWBASE     DBASE
     C                     MOVE WBPGM     DBPGM
     C                     OUT  LDA
     C                     OPEN PM0952AU                                  S01486
     C                     WRITEPM0952F0                                  S01486
     C                     WRITEPM0952F1                                  S01486
     C*                                                                   S01486
     C** Report printer file to RCF via ZSFILE                            S01486
     C*                                                                   S01486
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ     5                       S01486
     C                     PARM           @ENT    3                       S01486
     C                     PARM           SFILEU                          S01486
     C                     PARM           ZSNUMU                          S01486
     C                     PARM *BLANKS   ZSERR   1                       S01486
     C*                                                                   S01486
     C** Error during ZSFILE processing, return to calling program        S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C                     SETON                     U7U8LR               S01486
     C                     END                                            S01486
     C*
     C**   DUMP AND RETURN TO CALLING PROGRAM
     C                     MOVE '1'       *INLR
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     DUMP
     C                     RETRN
     C*
     C           #PSSR0    ENDSR
     C*****************************************************************
      /EJECT
**  CPY@
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   POWER - POWERS OF 10 FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
