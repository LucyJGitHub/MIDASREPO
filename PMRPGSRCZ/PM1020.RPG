     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Portfolio transfer update')                   *
/*OVRF*: OVRDBF FILE(PMHPOSXX) TOFILE(PMHPOSLL) SHARE(*NO)          : *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management                                 *
     F*                                                               *
     F*  PM1020 - PORTFOLIO TRANSFER UPDATE                           *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. AR1075401          Date 01Jun20               *      
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CLE141             Date 08Feb16               *
      *                 CGL165             Date 15Feb17               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CSW212             Date 03May12               *
      *                 CRE073             Date 06Dec10               *
      *                 CLE143             Date 06Dec10               *
      *                 CRE075             Date 06Dec10               *
      *                 CER059             Date 19Jul10               *
      *                 CER054             Date 07Apr09               *
      *                 CER048             Date 19May08               *
      *                 CER047             Date 19May08               *
      *                 CER020             Date 19May08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 11Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CLE042             Date 06Sep05               *
      *                 CDL038             Date 10May05               *
      *                 CSD027             Date 09Dec05               *
      *                 CSE071             Date 19Jul05               *
      *                 CAS009             Date 16May05               *
      *                 CDL028             Date 07Feb05               *
      *                 CAS008             Date 16Jun04               *
      *                 CGL014             Date 20Oct03               *
      *                 CDL020             Date 03Feb04               *
      *                 CDL019             Date 03Feb04               *
      *                 CDL018             Date 03Feb04               *
      *                 CDL017             Date 03Feb04               *
      *                 CDL016             Date 03Feb04               *
      *                 222727             Date 05Nov03               *
      *                 CAP074             Date 08Aug02               *
      *                 217684             Date 12May03               *
      *                 CAS006             Date 21Jan03               *
      *                 CAS005             Date 16Dec02               *
      *                 CLE028             Date 27Jun02               *
      *                 CDL010             Date 02Aug02               *
      *                 CAS004             Date 26Jun02               *
      * Midas Release 4.01.01 ----------------------------------------*
      *                 207006             Date 18Jun02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 CAP056             Date 13Mar02               *
      *                 CIR008             Date 13Mar02               *
      *                 CAS002             Date 14Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 CSE023             Date 12Jul00               *
      *                 CDL008             Date 02May00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR005             Date 21Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CSE015             Date 06Dec99               *
      *                 CSE017             Date 20Oct99               *
      *                 CSE012             Date 16Aug99               *
      * Midas DBA 3.01 Patch E ---------------------------------------*
      *                 170520             Date 19Nov99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CFF004             Date 02Oct96               *
      *                 CPM003             Date 02May96               *
     F*                 S71062             DATE 25JAN96               *
     F*                 S01408             DATE 01APR96               *
     F*                 CPM004             DATE 08FEB96               *
     F*                 095249             DATE 06NOV95               *
     F*                 S01486             DATE 06JUL94               *
     F*                 049421             DATE 22JAN93               *
     F*                 062516             DATE 27OCT93               *
     F*                 059998     ADI     DATE 27AUG93               *
     F*                 058933             DATE 02AUG93               *
     F*                 056555             DATE 08JUL93               *
     F*                 056469             DATE 03JUN93               *
     F*                 041644     MF      DATE 15JUL92               *
     F*                 49213              DATE 05JAN93               *
     F*                 48219              DATE 03NOV92               *
     F*                 47719              DATE 24NOV92               *
     F*                 46797              DATE 06NOV92               *
     F*                 39590              DATE 15MAY92               *
     F*                 48863      DT      DATE 21DEC92               *
     F*                 B08275     DHW     DATE 25OCT91               *
     F*                 B08129     DHW     DATE 25JUL91               *
     F*                 B08108             DATE 22JUL91               *
     F*                 R01167             DATE 12JAN91               *
     F*                 R10049             DATE 26SEP90               *
     F*                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  AR1075401 - Increase QANOML and QAOTNM length in PMCPOSPD.   *
      *              Recompiled. (Child: AR1075402)                   *      
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  CSW212 - SWIFT 2012 Changes (Recompile)                      *
      *  CRE073 - Interest Rate Rounding (Recompile)                  *
      *  CLE143 - Original Loan Contract Date & Effective Interest    *
      *           Rate (Recompile)                                    *
      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  CER048 - German Features - Taxes (Recompile)                 *
      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
      *           (Recompile)                                         *
      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
      *           Midas Plus (Recompile)                              *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CLE042 - Extended Loan Sub Type (Recompile)                  *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  CAS009 - EIR/AC Accounting (Recompile)                       *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CAS008 - IAS 39 Enhancements (Recompile)                     *
      *  CGL014 - Collaterals Processing (Recompile)                  *
      *  CDL020 - Apply Base Rate at Value Date (Recompile)           *
      *  CDL019 - Allow Base Rate Changes on Fixed Deposits/Loans     *
      *           (Recompile)                                         *
      *  CDL018 - Multiple Settlement Accounts on Loans/Deposits      *
      *           (Recompile)                                         *
      *  CDL017 - Penalty Fee & Early Maturity of Fixed Term Loan/Dep *
      *           (Recompile)                                         *
      *  CDL016 - Automatic rollover of Fixed Term Loans/Deposits     *
      *           (Recompile)                                         *
      *  222727 - Release 5.0 errors  (Recompile)                     *
      *  CAP074 - Lending API enhancements - Loans input.             *
      *  217684 - Authorisation User Malfunction (Recompile).         *
      *  CAS006 - Hedge Accounting Phase B                            *
      *  CAS005 - Enhancements to CAS001, CAS002 and CAS004           *
      *           (Recompile)                                         *
      *  CLE028 - Flat Rate Personal Loans (Rule of 78s)              *
      *           (Recompile)                                         *
      *  CDL010 - Prevent last user that actioned the trade from      *
      *           authorising it. Recompile due to changes in         *
      *           FXDEALPP, MMDELDPP, MMDENBPP and MMDENSPP.          *
      *  CAS004 - Hedge Accounting Phase A (Recompile)                *
      *  207006 - Add Counterparty & Market Centre to SSI (Recompile) *
      *  CAP056 - Automatic Authorisation of Interface deals          *
      *           (Recompile)                                         *
      *  CIR008 - FRA/IRS Deals Authorisation (Recompile)             *
      *  CAS002 - Hedge Strategy/Linkage (Recompile)                  *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
      *  CSE023 - Treaty Withholding Tax (Recompiled)                 *
      *  CDL008 - Continuous Linked Settlement (Recompiled)           *
      *  CIR005 - FRA/IRS Business Day Conventions to DEALSDG         *
      *           (recompile)                                         *
      *  CSE015 - Forward Valued Depot Movements (Recompile)          *
      *  CSE017 - Cum/Ex Indicator on Depot Movements (Recompile)     *
      *  CSE012 - SE Depot Movement Narratives (Recompiled).          *
      *  170520 - Recompile over changed TRANSD file                  *
     F*  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
     F*  CPM003 - FF/PM Interface upgrade to Release 10               *
     F*  S71062 - FF/PM interface                                     *
     F*           Re-activate FF coding                               *
     F*  S01408 - Addition of core hook PM1020CCP3                    *
     F*         - Addition of core hook PM1020CCP2                    *
     F*         - Addition of core hook PM1020CCP1                    *
     F*         - Addition of core hook PM1020OOP1                    *
     F*         - Addition of core hook PM1020IIP2                    *
     F*         - Addition of core hook PM1020FFP1                    *
     F*  CPM004 - Bank Portfolios                                     *
     F*  095249 - Add branch for accounts                             *
     F*  S01486 - Private Banking upgrade to Release 10               *
     F*  049421 - HEADER BOX STANDARDISATION                          *
     F*  062516 - CORRECT CALCULATION OF TRADE DATE POSITION          *
     F*  059998 - WRONG ACCESS ON FF TRANS FILE (MULTI MEMBER FILE)   *
     F*  058933 - REMOVE FRA/IRS TRANSACTIONS FROM PROGRAM            *
     F*  056555 - TRANSFER OF HISTORIC POSITIONS  - CODING OF TRANSFER*
     F*           OF HISTORIC POSITIONS IS A NEW PGM PM1025           *
     F*  056469 - IF DATE OF REWORK POSITION BEFORE FIRST ACTION FOR  *
     F*           POSITION SET UP AS STARTING POSITION                *
     F*  041644 - CHECK IF PORTFOLIO  CURRENCY AND BASE CURRENCY ARE  *
     F*           THE SAME                                            *
     F*         - MARKET PRICE WRONG (DUE TO DIVISIONS).              *
     F*  49213  - COMPILE OVER NEW VERSION OF ZFXAVP                  *
     F*  48219  - CORRECT CALCULATION OF FX AP NUMERATOR              *
     F*  47719  - CORRECT CONVERSION OF AMOUNTS BETWEEN CURRENCIES    *
     F*  46797  - CORRECT CALCULATION OF FX AP NUMERATOR              *
     F*  39590  - PORTFOLIO REFERENCE ON FXDEALPP&MMDELDPP NOT UPDATED*
     F*  B08275 - DEALSPT ALTERED. REPLACE BY LF/DEALS AND LF/DLDEALL *
     F*  B08129 - BACKVALUE DATE ON PMCPOSPP SHOULD BE SET TO 1 FOR   *
     F*           TO SIDE OF PORTFOLIO TRANSFER. ALSO CHECK WHETHER   *
     F*           A 'R' RECORD ALREADY EXISTS FOR POSITION            *
     F*  B08108 - ALTERED TO TRANSFER MATURED TRANSACTIONS            *
     F*  R01167 - USE BOOK FX RATE FROM FILE FIDEPOPD                 *
     F*  R10049 - Changes required for FX Rates on Depot movements.   *
     F*                                                               *
     F*****************************************************************
     F*
     F****PREFIX*OF*PMHSEXPP*IS*'Q8'********************************R01167S01486
     F***PMHSEXPPIF**E           K        DISK                      R01167S01486
     F**  PREFIX OF PMHSEXPD IS 'Q8'                                      S01486
     FPMHSEXPDIF  E           K        DISK                               S01486
     F*                                                                   R01167
     F***SDBANKL1IF**E                    DISK                            S01486
     F***********                                   KINFSR *PSSR          S01486
     F***PREFIX*'BJ'******************************************************S01486
     F***********                                                         S01486
     F***TABTB36*IF**E                    DISK                            S01486
     F***********                                   KINFSR *PSSR          S01486
     F***SDMMODPDIF**E                    DISK                            S01486
     F***********                                   KINFSR *PSSR          S01486
     F**
     FPMTPTMLLIF  E           K        DISK
     F                                              KINFSR *PSSR
     F** PREFIX 'P8'*******
     F**
     F***PMHPOSLLUF  E           K        DISK                          UC056555
     F***                                              KINFSR *PSSR       056555
     F***            PMCPOSP0                          KRENAMEPMHPOSP0    056555
     F** PREFIX 'QA'*******
     F**
     F***PMHPOSXXUF  E           K        DISK                         UC 056555
     F***                                              KINFSR *PSSR       056555
     F***            PMCPOSP0                          KRENAMEPMHPOSPX    056555
     F** PREFIX 'QX'*******
     F**
     FPMCPOSLLUF  E           K        DISK                      A    UC
     F                                              KINFSR *PSSR
     F** PREFIX 'QA'*******
     FPMRPSTLLIF  E           K        DISK                               B08129
     F                                              KINFSR *PSSR          B08129
     F            PMCPOSP0                          KRENAMEPMRPSTP0       B08129
     F** PREFIX 'RN'*******                                               B08129
     FPMRPSVLLIF  E           K        DISK                               B08129
     F                                              KINFSR *PSSR          B08129
     F            PMCPOSP0                          KRENAMEPMRPSVP0       B08129
     F** PREFIX 'RN'*******                                               B08129
     F**
     F***PMCPOSZZUF**E           K        DISK                          UCS01486
     FPMCPOSPAUF  E           K        DISK                           UC  S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'QC'*******
     F**
     FTRADS   UF  E           K        DISK                           UC
     F                                              KINFSR *PSSR
     F**
     FDPTMV   UF  E           K        DISK                           UC
     F                                              KINFSR *PSSR
     F**
     F***CAPRHS**UF**E           K        DISK                          UCS01486
     FPMCAPRL4UF  E           K        DISK                           UC  S01486
     F                                              KINFSR *PSSR
     F**
     FSECTY   IF  E           K        DISK                           UC
     F                                              KINFSR *PSSR
     F***SDPLCSL0IF**E           K        DISK                            S01486
     F***********                                   KINFSR *PSSR          S01486
     F***PREFIX*'QB'******************************************************S01486
     F***********                                                         S01486
     F*                                                                   S01408
     F/COPY WNCPYSRC,PM1020FFP1                                           S01408
     F*                                                                   S01408
     F***FILOANL0UF**E           K        DISK                          UCS01486
     F***********                                   KINFSR *PSSR          S01486
     F***********                                                         S01486
     F***FIDEPOL0UF**E           K        DISK                          UCS01486
     F***********                                   KINFSR *PSSR          S01486
     F***********                                                         S01486
     F***PMPORTPPIF**E           K        DISK                            S01486
     FPMPORTPDIF  E           K        DISK                               S01486
     F                                              KINFSR *PSSR
     F** PREFIX 'PN'
     F***********                                                         S01486
     F*RANS***UF  E           K        DISK                           UC  059998
     F***TRANSPT*UF**E           K        DISK                    UC059998S01486
     F***********                                   KINFSR *PSSR          S01486
     FTRANSPT UF  E           K        DISK                           UC  S71062
     F                                              KINFSR *PSSR          S71062
     F**
     FDEALS   UF  E           K        DISK                           UC
     F            DEALSDAF                          KIGNORE
     F            DEALSDDF                          KIGNORE
     F            DEALSDEF                          KIGNORE
     F            DEALSDFF                          KIGNORE
     F            DEALSDGF                          KIGNORE               S01486
     F**                                                                  B08275
     FDLDEALL UF  E           K        DISK                           UC  B08275
     F            DEALSDAF                          KIGNORE               B08275
     F            DEALSDBF                          KRENAMEDEALDBF        B08275
     F            DEALSDCF                          KRENAMEDEALDCF        B08275
     F            DEALSDDF                          KIGNORE               B08275
     F            DEALSDEF                          KIGNORE               B08275
     F            DEALSDFF                          KIGNORE               B08275
     F************DEALSDGF                          KRENAMEDEALDGF  B08275S01486
     F            DEALSDGF                          KIGNORE               S01486
     FFXDEALLLUF  E           K        DISK                           UC  39590
     FMMDEALLLUF  E           K        DISK                           UC  39590
     F            MMDENSP0                          KIGNORE               39590
     F            MMDENBP0                          KIGNORE               39590
     F**
     FCLOAN   UF  E           K        DISK                           UC
     F            CLOANHHF                          KIGNORE
     F            CLOANCKF                          KIGNORE
     F            CLOANZ1F                          KIGNORE
     F                                              KINFSR *PSSR
     F**
     FACCNT   UF  E           K        DISK                           UC
     F            ACCNTAAF                          KIGNORE
     F            ACCNTACF                          KIGNORE
     F                                              KINFSR *PSSR
     F**
     F** PREFIX 'Q8'*******
     F**
     F***SDCURRL0IF**E           K        DISK                            S01486
     F***********                                   KINFSR *PSSR          S01486
     F***PREFIX*'A6'******************************************************S01486
     F**
     FPM1020AUO   E                    PRINTER
     F** PREFIX 'RR'*******
     F**
     F**************************************************************************
     F**    INDICATORS USED
     F**************************************************************************
     F**
     F**  71  -  FILE OPERATION
     F**  72  -  FILE OPERATION
     F**  73  -  FILE OPERATION
     F**  74  -  FILE OPERATION
     F**  75  -  FILE OPERATION
     F**  76  -  FILE OPERATION
     F**  78  -  FILE OPERATION                                           048863
     F**
     F**  U7  -  DATA BASE ERROR
     F**  U8  -  PROGRAM ERROR
     F**
     F**  LR  -  END PROGRAM
     F**
     F**************************************************************************
     E**
     E                    POWER   1   7  7 3             POWER ARRAY
     E**
     E                    POWER8  1   8  8 4             POWER8 ARRAY
     E*
     E**   Array for copyright
     E                    CPY@    1   1 80               COPYRIGHT
     E*
      **************************************************************************
     I**
     I** RENAME FIELDS ON PMHPOSXX                                        056555
     I**                                                                  056555
     I***PMHPOSPX                                                         056555
     I************* QARECI                          QXRECI                056555
     I************* QACNUM                          QXCNUM                056555
     I************* QAPTFR                          QXPTFR                056555
     I************* QATDSS                          QXTDSS                056555
     I************* QATVDA                          QXTVDA                056555
     I************* QAPDAT                          QXPDAT                056555
     I************* QANOML                          QXNOML                056555
     I************* QACSEX                          QXCSEX                056555
     I************* QAAPNM                          QXAPNM                056555
     I************* QAFXAP                          QXFXAP                056555
     I************* QAPILP                          QXPILP                056555
     I************* QAACDI                          QXACDI                056555
     I************* QABVLD                          QXBVLD                056555
     I************* QATNMC                          QXTNMC                056555
     I************* QATNMD                          QXTNMD                056555
     I************* QAPTCY                          QXPTCY                056555
     I************* QAPCDP                          QXPCDP                056555
     I************* QAAYNM                          QXAYNM                056555
     I************* QACSBY                          QXCSBY                056555
     I************* QABYDP                          QXBYDP                056555
     I************* QACLAS                          QXCLAS                056555
     I************* QAACOC                          QXACOC                056555
     I************* QAOTNM                          QXOTNM                056555
     I************* QAOTEX                          QXOTEX                056555
     I************* QAAPBC                          QXAPBC                056555
     I************* QAFLEX                          QXFLEX                056555
     I************* QACOLC                          QXCOLC                056555
     I************* QABRCD                          QXBRCD                056555
     I************* QANPDT                          QXNPDT                056555
     I************* QAPFMR                          QXPFMR                056555
     I**
     I** RENAME FIELDS ON PMCPOSLL
     I**
     IPMCPOSP0
     I              QARECI                          QCRECI
     I              QACNUM                          QCCNUM
     I              QAPTFR                          QCPTFR
     I              QATDSS                          QCTDSS
     I              QATVDA                          QCTVDA
     I              QAPDAT                          QCPDAT
     I              QANOML                          QCNOML
     I              QACSEX                          QCCSEX
     I              QAAPNM                          QCAPNM
     I              QAFXAP                          QCFXAP
     I              QAPILP                          QCPILP
     I              QAACDI                          QCACDI
     I              QABVLD                          QCBVLD
     I              QATNMC                          QCTNMC
     I              QATNMD                          QCTNMD
     I              QAPTCY                          QCPTCY
     I              QAPCDP                          QCPCDP
     I              QAAYNM                          QCAYNM
     I              QACSBY                          QCCSBY
     I              QABYDP                          QCBYDP
     I              QACLAS                          QCCLAS
     I              QAACOC                          QCACOC
     I              QAOTNM                          QCOTNM
     I              QAOTEX                          QCOTEX
     I              QAAPBC                          QCAPBC
     I              QAFLEX                          QCFLEX
     I              QACOLC                          QCCOLC
     I              QABRCD                          QCBRCD
     I              QANPDT                          QCNPDT
     I              QAPFMR                          QCPFMR
     I**                                                                  B08129
     I** RENAME FIELDS ON PMRPSTLL                                        B08129
     I**                                                                  B08129
     IPMRPSTP0                                                            B08129
     I              QARECI                          RNRECI                B08129
     I              QACNUM                          RNCNUM                B08129
     I              QAPTFR                          RNPTFR                B08129
     I              QATDSS                          RNTDSS                B08129
     I              QATVDA                          RNTVDA                B08129
     I              QAPDAT                          RNPDAT                B08129
     I              QANOML                          RNNOML                B08129
     I              QACSEX                          RNCSEX                B08129
     I              QAAPNM                          RNAPNM                B08129
     I              QAFXAP                          RNFXAP                B08129
     I              QAPILP                          RNPILP                B08129
     I              QAACDI                          RNACDI                B08129
     I              QABVLD                          RNBVLD                B08129
     I              QATNMC                          RNTNMC                B08129
     I              QATNMD                          RNTNMD                B08129
     I              QAPTCY                          RNPTCY                B08129
     I              QAPCDP                          RNPCDP                B08129
     I              QAAYNM                          RNAYNM                B08129
     I              QACSBY                          RNCSBY
     I              QABYDP                          RNBYDP
     I              QACLAS                          RNCLAS
     I              QAACOC                          RNACOC
     I              QAOTNM                          RNOTNM
     I              QAOTEX                          RNOTEX
     I              QAAPBC                          RNAPBC
     I              QAFLEX                          RNFLEX
     I              QACOLC                          RNCOLC
     I              QABRCD                          RNBRCD
     I              QANPDT                          RNNPDT
     I              QAPFMR                          RNPFMR
     I**                                                                  B08129
     I** RENAME FIELDS ON PMRPSVLL                                        B08129
     I**                                                                  B08129
     IPMRPSVP0                                                            B08129
     I              QARECI                          RNRECI                B08129
     I              QACNUM                          RNCNUM                B08129
     I              QAPTFR                          RNPTFR                B08129
     I              QATDSS                          RNTDSS                B08129
     I              QATVDA                          RNTVDA                B08129
     I              QAPDAT                          RNPDAT                B08129
     I              QANOML                          RNNOML                B08129
     I              QACSEX                          RNCSEX                B08129
     I              QAAPNM                          RNAPNM                B08129
     I              QAFXAP                          RNFXAP                B08129
     I              QAPILP                          RNPILP                B08129
     I              QAACDI                          RNACDI                B08129
     I              QABVLD                          RNBVLD                B08129
     I              QATNMC                          RNTNMC                B08129
     I              QATNMD                          RNTNMD                B08129
     I              QAPTCY                          RNPTCY                B08129
     I              QAPCDP                          RNPCDP                B08129
     I              QAAYNM                          RNAYNM                B08129
     I              QACSBY                          RNCSBY
     I              QABYDP                          RNBYDP
     I              QACLAS                          RNCLAS
     I              QAACOC                          RNACOC
     I              QAOTNM                          RNOTNM
     I              QAOTEX                          RNOTEX
     I              QAAPBC                          RNAPBC
     I              QAFLEX                          RNFLEX
     I              QACOLC                          RNCOLC
     I              QABRCD                          RNBRCD
     I              QANPDT                          RNNPDT
     I              QAPFMR                          RNPFMR
      *                                                                                       CAS006
      ** Rename fields on TRADS                                                               CAS006
      *                                                                                       CAS006
     ITRADSDF                                                                                 CAS006
     I              CRSK                            SECRSK                                    CAS006
     I**
     I** IDENTIFICATION OF RECORD FORMATS OF LF/DEALS
     I**
     IDEALSDBF    01
     IDEALSDCF    02
     I***DEALSDGF****03                                                   S01486
     I**                                                                  B08275
     I** IDENTIFICATION OF RECORD FORMATS OF LF/DLDEALL                   B08275
     I**                                                                  B08275
     IDEALDBF     01                                                      B08275
     IDEALDCF     02                                                      B08275
     I***DEALDGF*****03                                             B08275S01486
     I**
     I** DATA STRUCTURE FOR LAST UPDATE
     I**
     I            DS
     I                                        1   20WWDLUP
     I                                        3   5 WWMLUP
     I                                        6   70WWYLUP
     I                                        1   7 WWHLUP
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     I****LDA********UDS****************************256                   S01486
     I***************************************32 183 DBLOT                 S01486
     I**************************************132 141 DBFILE                S01486
     ILDA         DS                            256                       S01486
     I                                      134 183 DBLOT                 S01486
     I                                      134 141 DBFILE                S01486
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I** DATA AREA PMSTAT
     I*
     IPMSTAT     UDS                            256
     I                                       19  19 WWTFRD
     I*
     I* Data structure for compilation - copyright insertion.
     ICPYR@#      DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *                                                                   CPM004
      ** Input parameters on call to AOPLCSR1                             CPM004
     II@PARM      DS                            256                       CPM004
     I                                        1   1 I#PORS                CPM004
     I                                        2   5 I#R997                CPM004
     I                                        6  15 I#CUST                CPM004
     I                                       16  18 I#BRCA                CPM004
     I                                       19  20 I#BOOK                CPM004
     I                                       21  24 I#PTFR                CPM004
     I                                       25  34 I#CPGM                CPM004
     I*                                                                   CPM004
      ** Output parameters on call to AOPLCSR1                            CPM004
     IO@PARM      DS                            256                       CPM004
     I                                        1   2 O#BOOK                CPM004
     I                                        3   6 O#PTFR                CPM004
     I                                        7  12 O#BICN                CPM004
     I                                       13  22 O#CRNM                CPM004
     I                                       23  24 O#ACOF                CPM004
     I*                                                                   S01486
     ISDBANK    E DSSDBANKPD                                              S01486
     I** EXTERNAL DS FOR BANK DETAILS                                     S01486
     I*                                                                   S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I** EXTERNAL DS FOR CURRENCIES DETAILS                               S01486
     I*                                                                   S01486
     ISDMMOD    E DSSDMMODPD                                              S01486
     I** MODULES DETAILS   ACCESSED VIA ACCESS PROGRAM                    S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              CPM004
     I** External DS for Portfolio ICD Details                            CPM004
     I*                                                                   CPM004
     ISDPLCS    E DSSDPLCSPD                                              S01486
     I** EXTERNAL DS FOR PORTFOILO CUSTOMER DETAILS                       S01486
     I*                                                                   S01486
     ISDSTRD    E DSSDSTRDPD                                              S01486
     I** EXTERNAL DS FOR SECURITIES TRADING ICD DETAILS                   S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01486
     I*                                                                   S01408
     I/COPY WNCPYSRC,PM1020IIP1                                           S01408
     I*                                                                   S01408
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * INDEX OF SUBROUTINES                                                   *
      * MAIN     -                                                             *
      * #PAA     - TO INITIALIZE WRK FIELDS AND ACCESS ST. DATA                *
      * #PBB     - MAIN PROCESSING                                             *
      * #PCC     - END OF PROCESSING - WRITE TO AUDIT                          *
      * #P01     - TO ACCESS 'FROM' & 'TO' PORTFOLIO DETAILS                   *
      **#P02*****-*TO*TRANSFER*SE*HISTORIC*POSITIONS*                    056555*
      * #P03     - TO SET SE CURRENT POSITIONS FOR REWORKING                   *
      * #P04     - TO TRANSFER SE TRADES                                       *
      * #P05     - TO TRANSFER SE DEPOT MOVEMENTS                              *
      **#P06*****-*TO*TRANSFER*FF*TRANSACTIONS****************************S01486
      * #P06     - TO TRANSFER FF TRANSACTIONS                            S71062
      * #P07     - TO TRANSFER DL DEALS                                        *
      * #P08     - TO TRANSFER LE LOANS                                        *
      * #P09     - TO TRANSFER RE ACCOUNTS                                     *
      * #P10     - TO CONVERT FX AP NUMERATOR ON PORTFOLIO POSITIONS           *
      * #P11     - TO DETERMINE TRADE VALUE IN PORTFOLIO CURRENCY              *
      * #P12     - TO DETERMINE DEPOT MOVEMENT VALUE IN PORTFOLIO CURRENCY     *
      * #P13     - TO DETERMINE SPOT RATE, MULTIPLY/DIVIDE INDICATOR           *
      * ZCCYCN   - TO CONVERT AN AMOUNT IN ONE CURRENCY TO ANOTHER             *
      * ZCCYXR   - TO CONVERT AN AMOUNT IN ONE CURRENCY TO ANOTHER             *
      * ZFXAVP   - TO CALCULATE FX AVERAGE RATE                                *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * EXTERNAL ROUTINES CALLED                                               *
      *                                                                        *
      **************************************************************************
      **************************************************************************
     C*
     C                     MOVEACPY@      CPY2@  80
     C*
      ** *********
      ** KEY LISTS
      ** *********
     C           PMHSEX    KLIST
     C                     KFLD           WWCCYH  3
     C                     KFLD           WWPDAT  50
      **
     C           PMTPTM    KLIST
     C                     KFLD           WWPOTI  1
     C                     KFLD           WWMODI  2
      **
     C           PMDPTM    KLIST
     C                     KFLD           P8SESN
     C                     KFLD           WWTRNB  6
      **
     C           PMPORT    KLIST
     C                     KFLD           P8CNUM
     C                     KFLD           WWPTFR  4
      **
     C           PMCAPR    KLIST
     C                     KFLD           WWCSSC 10
     C                     KFLD           WWCSRF  6
     C                     KFLD           WWCSSE  1
      **
     C           PMPOSF    KLIST
     C                     KFLD           P8CNUM
     C                     KFLD           P8FPTF
     C                     KFLD           P8SESN
      **
     C           PMPOST    KLIST
     C                     KFLD           P8CNUM
     C                     KFLD           P8TPTF
     C                     KFLD           P8SESN
     C                     KFLD           WWTVDA  1
      **
     C           PMACCN    KLIST
     C                     KFLD           P8CNUM
     C                     KFLD           P8CCY
     C                     KFLD           P8ACOD
     C                     KFLD           P8ACSQ
     C                     KFLD           P8BRCA                          095249
      ****                                                          B08275B08108
     C****       DEALSK    KLIST                                    B08275B08108
     C****                 KFLD           P8CNUM                    B08275B08108
     C****                 KFLD           P8FPTF                    B08275B08108
     C****                 KFLD           P8TRNB                    B08275B08108
      **
      **************************************************************************
      **
      **          PROGRAM START
      **
      **************************************************************************
      **
     C                     EXSR #PAA
     C**
     C                     EXSR #PBB
     C**
     C                     EXSR #PCC
     C**
     C                     MOVE '1'       *INLR
     C                     RETRN
      **
      **************************************************************************
      **
      **          PROGRAM END
      **
      **************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PBB     - MAIN PROCESSING                                             *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #P01     - TO ACCESS 'FROM' & 'TO' PORTFOLIO DETAILS                   *
      **#P02*****-*TO*TRANSFER*SE*HISTORIC*POSITIONS*                    056555*
      * #P03     - TO SET SE CURRENT POSITIONS FOR REWORKING                   *
      * #P04     - TO TRANSFER SE TRADES                                       *
      * #P05     - TO TRANSFER SE DEPOT MOVEMENTS                              *
      **#P06*****-*TO*TRANSFER*FF*TRANSACTIONS****************************S01486
      * #P06     - TO TRANSFER FF TRANSACTIONS                            S71062
      * #P07     - TO TRANSFER DL DEALS                                        *
      * #P08     - TO TRANSFER LE LOANS                                        *
      * #P09     - TO TRANSFER RE ACCOUNTS                                     *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     -                                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWPOTI   - POSITION KEY                                                *
      * WWMODI   - MODULE INDICATOR KEY                                        *
      * WWTRFG   - COUNTER                                                     *
      *                                                                        *
      **************************************************************************
     C           #PBB      BEGSR
     C**
     C** IF SE MODULE PRESENT
     C**
     C           BGSECS    IFEQ 'Y'
     C**
     C** OPEN FILES
     C**
     C******************** OPEN PMHPOSLL                                  056555
     C******************** OPEN PMHPOSXX                                  056555
     C                     OPEN PMCPOSLL
     C***********          OPEN PMCPOSZZ                                  S01486
     C                     OPEN PMCPOSPA                                  S01486
     C                     OPEN TRADS
     C                     OPEN DPTMV
     C***********          OPEN CAPRHS                                    S01486
     C                     OPEN PMCAPRL4                                  S01486
     C                     OPEN SECTY
     C****                                                                056555
     C****REPARE KEY TO ACCESS SE POSITION TRANSFERS                      056555
     C****                                                                056555
     C******************** MOVEL'P'       WWPOTI                          056555
     C                     MOVEL'SE'      WWMODI
     C****                                                                056555
     C****OSITION IN FILE                                                 056555
     C****                                                                056555
     C****       PMTPTM    SETLLPMTPTMLL                                  056555
     C****                                                                056555
     C****       *IN73     DOUEQ'1'                                       056555
     C****                                                                056555
     C****       PMTPTM    READEPMTRSFP0                 73               056555
     C****                                                                056555
     C****       *IN73     IFEQ '0'                                       056555
     C****                                                                056555
     C****                 ADD  1         WWTRFG                          056555
     C****                                                                056555
     C****CCESS 'FROM' AND 'TO' PORTFOLIO DETAILS                         056555
     C****                                                                056555
     C****                 EXSR #P01                                      056555
     C****                                                                056555
     C****RANSFER SE HISTORIC POSITIONS                                   056555
     C****                                                                056555
     C****                 EXSR #P02                                      056555
     C****                                                                056555
     C****ET SE CURRENT POSITIONS FOR REWORKING                           056555
     C****RADE/VALUE BACKVALUATION DATES ARE SMALLEST NON-ZERO VALUE IE 1 056555
     C****                                                                056555
     C****                 Z-ADD1         TRDDAT  50                      056555
     C****                 Z-ADD1         VALDAT  50                      056555
     C****                 EXSR #P03                                      056555
     C****                                                                056555
     C****                 END                                            056555
     C****                                                                056555
     C****                 END                                            056555
     C**
     C** PREPARE KEY TO ACCESS SE TRADE TRANSFERS
     C**
     C                     MOVEL'T'       WWPOTI
     C**
     C** POSITION IN FILE
     C**
     C           PMTPTM    SETLLPMTPTMLL
     C**
     C           *IN73     DOUEQ'1'
     C**
     C           PMTPTM    READEPMTRSFP0                 73
     C**
     C           *IN73     IFEQ '0'
     C**
     C                     ADD  1         WWTRFG
     C**
     C** ACCESS 'FROM' AND 'TO' PORTFOLIO DETAILS
     C**
     C                     EXSR #P01
     C**
     C** TRANSFER SE TRADES
     C**
     C                     EXSR #P04
     C*
     C** SET SE CURRENT POSITIONS FOR REWORKING IF TRADE PROCESSED
     C** TRADE/VALUE BACKVALUATION DATES ARE TRADE/VALUE DATES OFF TRADE
     C*
     C           PROCSD    IFEQ 'Y'
     C****                 Z-ADDTDDT      TRDDAT  50                      B08129
     C****                 Z-ADDTDVD      VALDAT  50                      B08129
     C****                 Z-ADD1         TRDDAT  50                B08129056469
     C****                 Z-ADD1         VALDAT  50                B08129056469
     C                     Z-ADDTDDT      TRDDAT  50                      056469
     C                     Z-ADDTDVD      VALDAT  50                      056469
     C                     EXSR #P03
     C                     END
     C**
     C                     END
     C**
     C                     END
     C**
     C** PREPARE KEY TO ACCESS SE DEPOT MOVEMENTS
     C**
     C                     MOVEL'D'       WWPOTI
     C**
     C** POSITION IN FILE
     C**
     C           PMTPTM    SETLLPMTPTMLL
     C**
     C           *IN73     DOUEQ'1'
     C**
     C           PMTPTM    READEPMTRSFP0                 73
     C**
     C           *IN73     IFEQ '0'
     C**
     C                     ADD  1         WWTRFG
     C**
     C** ACCESS 'FROM' AND 'TO' PORTFOLIO DETAILS
     C**
     C                     EXSR #P01
     C**
     C** TRANSFER SE DEPOT MOVEMENTS
     C**
     C                     EXSR #P05
     C*
     C** SET SE CURRENT POSITIONS FOR REWORKING IF DEPOT MOVEMENT PROCESSE
     C** TRADE/VALUE BACKVALUATION DATES ARE MOVEMENT DATE IN/OUT AS APPRO
     C**
     C           PROCSD    IFEQ 'Y'
     C****       DPMV      IFEQ 'WI'                                      B08129
     C****                 Z-ADDDPMD      TRDDAT                          B08129
     C****                 Z-ADDDPMD      VALDAT                          B08129
     C****                 ELSE                                           B08129
     C****                 Z-ADDDPDO      TRDDAT                          B08129
     C****                 Z-ADDDPDO      VALDAT                          B08129
     C****                 END                                            B08129
     C****                 Z-ADD1         TRDDAT                    B08129056469
     C****                 Z-ADD1         VALDAT                    B08129056469
     C                     Z-ADDDPVD      TRDDAT                          062516
     C                     Z-ADDDPVD      VALDAT                          056469
     C                     EXSR #P03
     C                     END
     C**
     C                     END
     C**
     C                     END
     C**
     C*
     C** ACCESS PORTFOLIO POSITIONS AUDIT
     C*
     C                     READ PMCPOSZ0                 73*ON=NOT THERE
     C*
     C           *IN73     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD19        DBASE            **DB ERROR 19**
     C***********          MOVEL'PMCPOSZZ'DBFILE           ***************S01486
     C                     MOVEL'PMCPOSPA'DBFILE           ***************S01486
     C                     MOVEL*BLANK    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C*
     C** UPDATE PORTFOLIO POSITIONS AUDIT
     C*
     C                     ADD  POSADD    QANORE
     C                     UPDATPMCPOSZ0
     C*
     C******************** CLOSEPMHPOSLL                                  056555
     C******************** CLOSEPMHPOSXX                                  056555
     C                     CLOSEPMCPOSLL
     C***********          CLOSEPMCPOSZZ                                  S01486
     C                     CLOSEPMCPOSPA                                  S01486
     C                     CLOSETRADS
     C                     CLOSEDPTMV
     C***********          CLOSECAPRHS                                    S01486
     C                     CLOSEPMCAPRL4                                  S01486
     C                     CLOSESECTY
     C**
     C                     END                                            S01486
     C***********                                                         S01486
     C***IF*FF*MODULE*IS*PRESENT*IN*SYSTEM********************************S01486
     C***********                                                         S01486
     C***********BGFUOP    IFEQ 'Y'                                       S01486
     C***********                                                         S01486
     C***OPEN*FILE********************************************************S01486
     C***********                                                         S01486
     C******************** OPEN TRANS                                     059998
     C***********          OPEN TRANSPT                             059998S01486
     C***********                                                         S01486
     C***PREPARE*KEY******************************************************S01486
     C***********                                                         S01486
     C***********          MOVEL'T'       WWPOTI                          S01486
     C***********          MOVEL'FF'      WWMODI                          S01486
     C***********                                                         S01486
     C***POSITION*IN*FILE*************************************************S01486
     C***********                                                         S01486
     C***********PMTPTM    SETLLPMTPTMLL                                  S01486
     C***********                                                         S01486
     C************IN73     DOUEQ'1'                                       S01486
     C***********                                                         S01486
     C***********PMTPTM    READEPMTRSFP0                 73               S01486
     C***********                                                         S01486
     C************IN73     IFEQ '0'                                       S01486
     C***********                                                         S01486
     C***********          ADD  1         WWTRFG                          S01486
     C***********                                                         S01486
     C***TRANSFER*FF*TRANSACTIONS*****************************************S01486
     C***********                                                         S01486
     C***********          EXSR #P06                                      S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***CLOSE*FILE ******************************************************S01486
     C***********                                                         S01486
     C******************** CLOSETRANS                                     059998
     C***********          CLOSETRANSPT                             059998S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C**
     C** IF FF MODULE IS PRESENT IN SYSTEM                                S71062
     C** If Bank Portfolios are supported, treat as if FF off             CPM003
     C**                                                                  S71062
     C           BGFUOP    IFEQ 'Y'                                       S71062
     C           FCPORS    ANDNE'B'                                       CPM003
     C**                                                                  S71062
     C** OPEN FILE                                                        S71062
     C**                                                                  S71062
     C                     OPEN TRANSPT                                   S71062
     C**                                                                  S71062
     C** PREPARE KEY                                                      S71062
     C**                                                                  S71062
     C                     MOVEL'T'       WWPOTI                          S71062
     C                     MOVEL'FF'      WWMODI                          S71062
     C**                                                                  S71062
     C** POSITION IN FILE                                                 S71062
     C**                                                                  S71062
     C           PMTPTM    SETLLPMTPTMLL                                  S71062
     C**                                                                  S71062
     C           *IN73     DOUEQ'1'                                       S71062
     C**                                                                  S71062
     C           PMTPTM    READEPMTRSFP0                 73               S71062
     C**                                                                  S71062
     C           *IN73     IFEQ '0'                                       S71062
     C**                                                                  S71062
     C                     ADD  1         WWTRFG                          S71062
     C**                                                                  S71062
     C** TRANSFER FF TRANSACTIONS                                         S71062
     C**                                                                  S71062
     C                     EXSR #P06                                      S71062
     C**                                                                  S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C** CLOSE FILE                                                       S71062
     C**                                                                  S71062
     C                     CLOSETRANSPT                                   S71062
     C**                                                                  S71062
     C                     END                                            S71062
     C**
     C** IF DL MODULE IS PRESENT IN SYSTEM
     C**
     C           BGDLFX    IFEQ 'Y'
     C           BGDLMM    OREQ 'Y'
     C           BGFIIN    OREQ 'Y'
     C**
     C** OPEN FILE
     C**
     C*****                OPEN DEALSPT                             B08275B08108
     C                     OPEN DEALS                               B08275B08108
     C                     OPEN DLDEALL                             B08275B08108
     C**
     C** OPEN DRS FILES IF DRS/MM - DRS/FX PRESENT                        39590
     C           BGDRFE    IFEQ 'Y'                                       39590
     C                     OPEN FXDEALLL                                  39590
     C                     END                                            39590
     C           BGDRMM    IFEQ 'Y'                                       39590
     C                     OPEN MMDEALLL                                  39590
     C                     END                                            39590
     C**
     C** PREPARE KEY
     C**
     C                     MOVEL'T'       WWPOTI
     C                     MOVEL'DL'      WWMODI
     C**
     C** POSITION IN FILE
     C**
     C           PMTPTM    SETLLPMTPTMLL
     C**
     C           *IN73     DOUEQ'1'
     C**
     C           PMTPTM    READEPMTRSFP0                 73
     C**
     C           *IN73     IFEQ '0'
     C**
     C                     ADD  1         WWTRFG
     C**
     C** TRANSFER DL DEALS
     C**
     C                     EXSR #P07
     C**
     C                     END
     C**
     C                     END
     C**
     C** CLOSE FILE
     C**
     C****                 CLOSEDEALS                               B08275B08108
     C****                 CLOSEDEALSPT                             B08275B08108
     C                     CLOSEDEALS                                     B08275
     C                     CLOSEDLDEALL                                   B08275
     C           BGDRFE    IFEQ 'Y'                                       39590
     C                     CLOSEFXDEALLL                                  39590
     C                     END                                            39590
     C           BGDRMM    IFEQ 'Y'                                       39590
     C                     CLOSEMMDEALLL                                  39590
     C                     END                                            39590
     C**
     C                     END
     C**
     C** IF LE MODULE IS PRESENT IN SYSTEM
     C**
     C           BGCSLN    IFEQ 'Y'
     C**
     C** OPEN  FILE
     C**
     C                     OPEN CLOAN
     C**
     C** PREPARE KEY
     C**
     C                     MOVEL'T'       WWPOTI
     C                     MOVEL'LE'      WWMODI
     C**
     C** POSITION IN FILE
     C**
     C           PMTPTM    SETLLPMTPTMLL
     C**
     C           *IN73     DOUEQ'1'
     C**
     C           PMTPTM    READEPMTRSFP0                 73
     C**
     C           *IN73     IFEQ '0'
     C**
     C                     ADD  1         WWTRFG
     C**
     C** TRANSFER LE LOANS
     C**
     C                     EXSR #P08
     C**
     C                     END
     C**
     C                     END
     C**
     C** CLOSE FILE
     C**
     C                     CLOSECLOAN
     C**
     C                     END
     C**
     C** IF RE MODULE IS PRESENT IN SYSTEM
     C**
     C           BGRTBN    IFEQ 'Y'
     C**
     C** OPEN  FILE
     C**
     C                     OPEN ACCNT
     C**
     C** PREPARE KEY
     C**
     C                     MOVEL'T'       WWPOTI
     C                     MOVEL'RE'      WWMODI
     C**
     C** POSITION IN FILE
     C**
     C           PMTPTM    SETLLPMTPTMLL
     C**
     C           *IN73     DOUEQ'1'
     C**
     C           PMTPTM    READEPMTRSFP0                 73
     C**
     C           *IN73     IFEQ '0'
     C**
     C                     ADD  1         WWTRFG
     C**
     C** TRANSFER RE ACCOUNTS
     C**
     C                     EXSR #P09
     C**
     C                     END
     C**
     C                     END
     C**
     C** CLOSE FILE
     C**
     C                     CLOSEACCNT
     C**
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM1020CCP1                                           S01408
     C*                                                                   S01408
     C***********                                                         S01486
     C***IF*FI*MODULE*IS*PRESENT*IN*SYSTEM********************************S01486
     C***********                                                         S01486
     C***********BGFLND    IFEQ 'Y'                                       S01486
     C***********                                                         S01486
     C***OPEN**FILE*******************************************************S01486
     C***********                                                         S01486
     C***********          OPEN FILOANL0                                  S01486
     C***********                                                         S01486
     C***PREPARE*KEY******************************************************S01486
     C***********                                                         S01486
     C***********          MOVEL'T'       WWPOTI                          S01486
     C***********          MOVEL'FL'      WWMODI                          S01486
     C***********PMTPTM    SETLLPMTPTMLL                                  S01486
     C***********                                                         S01486
     C***********PMTPTM    READEPMTPTMLL                 75               S01486
     C***********                                                         S01486
     C************IN75     DOWEQ'0'                                       S01486
     C***********          ADD  1         WWTRFG                          S01486
     C***********          EXSR #P14                                      S01486
     C***********PMTPTM    READEPMTPTMLL                 75               S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C***OPEN**FILE*******************************************************S01486
     C***********                                                         S01486
     C***********          OPEN FIDEPOL0                                  S01486
     C***********                                                         S01486
     C***PREPARE*KEY******************************************************S01486
     C***********                                                         S01486
     C***********          MOVEL'T'       WWPOTI                          S01486
     C***********          MOVEL'FD'      WWMODI                          S01486
     C***********PMTPTM    SETLLPMTPTMLL                                  S01486
     C***********                                                         S01486
     C***********PMTPTM    READEPMTPTMLL                 75               S01486
     C***********                                                         S01486
     C************IN75     DOWEQ'0'                                       S01486
     C***********          ADD  1         WWTRFG                          S01486
     C***********          EXSR #P15                                      S01486
     C***********PMTPTM    READEPMTPTMLL                 75               S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          CLOSEFILOANL0                                  S01486
     C***********          CLOSEFIDEPOL0                                  S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C**
     C                     ENDSR
      **************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PCC     - END OF PROCESSING - WRITE TO AUDIT                          *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     -                                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #PCC      BEGSR
     C**
     C                     Z-ADDWWTRFG    RRTRFG
     C**
     C                     MOVELBJURPT    RRTITL
     C**
     C                     WRITEPM1020H
     C**
     C                     ENDSR
      **************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P01     - TO ACCESS 'FROM' & 'TO' PORTFOLIO DETAILS                   *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PBB     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWCCYF   - WORK FIELD CURRENCY - 'FROM' CURRENCY                       *
      * WWCCYT   - WORK FIELD CURRENCY - 'TO' CURRENCY                         *
      * WWDCPF   - WORK FIELD NUMBER OF DECIMAL PLACES FOR 'FROM' CURRENCY     *
      * WWDCPT   - WORK FIELD NUMBER OF DECIMAL PLACES FOR 'TO' CURRENCY       *
      *                                                                        *
      **************************************************************************
     C           #P01      BEGSR                           **#P01 BEGIN**
     C**
     C** IF 'FROM' PORTFOLIO OR 'TO' PORTFOLIO ARE NON-ASSIGNED PORTFOLIOS
     C** ACCESS CUSTOMER BASE CURRENCY & DECIMAL PLACES
     C**
     C           P8FPTF    IFEQ '9997'
     C           P8TPTF    OREQ '9997'
     C***********          MOVELP8CNUM    WCNUM   6                       S01486
     C                     MOVELP8CNUM    PLCUS                           S01486
     C***********WCNUM     CHAINSDPLCSL0             74                   S01486
     C                     CALL 'AOPLCSR0'                                S01486
     C                     PARM '*MSG   ' PRTCD   7                       S01486
     C                     PARM '*KEY'    POPTN   7                       S01486
     C                     PARM           PLCUS  10                       S01486
     C           SDPLCS    PARM SDPLCS    DSFDY                           S01486
     C************IN74     IFEQ '1'                        ***************S01486
     C           PRTCD     IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD4         DBASE            **DB ERROR 04**
     C                     MOVEL'SDPLCSL0'DBFILE           ***************
     C                     MOVELP8CNUM    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C                     END
     C**
     C***ACCESS*PMPORTPP*-*PORTFOLIO*DEFINITION*DETAILS*******************S01486
     C** ACCESS PMPORTPD - PORTFOLIO DEFINITION DETAILS                   S01486
     C** FOR 'FROM' PORTFOLIO CURRENCY
     C**
     C                     MOVELP8FPTF    WWPTFR
     C**
     C           P8FPTF    IFNE '9997'
     C***********PMPORT    CHAINPMPORTPP             74                   S01486
     C           PMPORT    CHAINPMPORTPD             74                   S01486
     C           *IN74     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD5         DBASE            **DB ERROR 05**
     C***********          MOVEL'PMPORTPP'DBFILE           ***************S01486
     C                     MOVEL'PMPORTPD'DBFILE           ***************S01486
     C                     MOVELP8CNUM    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C                     MOVELPNPTCY    WWCCYF
     C                     Z-ADDPNPCDP    WWDCPF
     C                     ELSE
     C                     MOVELQBCSBY    WWCCYF
     C                     Z-ADDQBBYDP    WWDCPF
     C                     END
     C**
     C***ACCESS*PMPORTPP*-*PORTFOLIO*DEFINITION*DETAILS*******************S01486
     C** ACCESS PMPORTPD - PORTFOLIO DEFINITION DETAILS                   S01486
     C** FOR 'TO' PORTFOLIO CURRENCY
     C**
     C                     MOVELP8TPTF    WWPTFR
     C**
     C           P8TPTF    IFNE '9997'
     C***********PMPORT    CHAINPMPORTPP             74                   S01486
     C           PMPORT    CHAINPMPORTPD             74                   S01486
     C           *IN74     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD6         DBASE            **DB ERROR 06**
     C***********          MOVEL'PMPORTPP'DBFILE           ***************S01486
     C                     MOVEL'PMPORTPD'DBFILE           ***************S01486
     C                     MOVELP8CNUM    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C                     MOVELPNPTCY    WWCCYT
     C                     Z-ADDPNPCDP    WWDCPT
     C                     ELSE
     C                     MOVELQBCSBY    WWCCYT
     C                     Z-ADDQBBYDP    WWDCPT
     C                     END
     C**
     C                     ENDSR                           **#P01 END  **
      ********************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      **#P02*****-*TO*TRANSFER*SE*HISTORIC*POSITIONS*********            056555*
      *                                                                  056555*
      * SUBROUTINE CALLS:                                                056555*
      * #P10     - TO CONVERT FX AP NUMERATOR ON PORTFOLIO POSITIONS     056555*
      *                                                                  056555*
      * SUBROUTINE CALLED FROM:                                          056555*
      * #PBB     - MAIN PROCESSING                                       056555*
      *                                                                  056555*
      * ROUTINE USES VARIABLES:                                          056555*
      * WWTVDA   - VALUE DATE KEY                                        056555*
      * WWPDAT   - DATE KEY                                              056555*
      *                                                                  056555*
      *******************************************************************056555*
     C***        #P02      BEGSR                                          056555
     C***                                                                 056555
     C***ACCESS PMHPOSLL - 'FROM' PORTFOLIO  (PREFIX 'QA')                056555
     C***                                                                 056555
     C***        PMPOSF    SETLLPMHPOSLL                                  056555
     C***                                                                 056555
     C***        *IN74     DOUEQ'1'                                       056555
     C***                                                                 056555
     C***        PMPOSF    READEPMHPOSLL                 74               056555
     C***                                                                 056555
     C***        *IN74     IFEQ '0'                                       056555
     C***                                                                 056555
     C***PREPARE KEY TO ACCESS PMHPOSXX   - 'TO' PORTFOLIO  (PREFIX 'QX') 056555
     C***                                                                 056555
     C***                  MOVELQATVDA    WWTVDA                          056555
     C***                                                                 056555
     C***        PMPOST    CHAINPMHPOSXX             75                   056555
     C***                                                                 056555
     C***        *IN75     IFEQ '0'                                       056555
     C***                                                                 056555
     C***ADD NOMINAL ON 'FROM' RECORD TO NOMINAL ON 'TO' RECORD           056555
     C***                                                                 056555
     C***                  ADD  QANOML    QXNOML                          056555
     C***                                                                 056555
     C***ADD EX-COUPON NOMINAL ON 'FROM' RECORD TO                        056555
     C***EX-COUPON NOMINAL ON 'TO' RECORD.                                056555
     C***                                                                 056555
     C***                  ADD  QACSEX    QXCSEX                          056555
     C***                                                                 056555
     C***ADD AP NUMERATOR      ON 'FROM' RECORD TO                        056555
     C***AP NUMERATOR      ON 'TO' RECORD.                                056555
     C***                                                                 056555
     C***                  ADD  QAAPNM    QXAPNM                          056555
     C***                                                                 056555
     C***IF THE 'FROM' PORTFOLIO CURRENCY IS NOT EQUAL TO THE             056555
     C***'TO' PORTFOLIO CURRENCY,CONVERT FX AP NUMERATOR                  056555
     C***                                                                 056555
     C***        WWCCYF    IFNE WWCCYT                                    056555
     C***                                                                 056555
     C***                  Z-ADDQAPDAT    WWPDAT                          056555
     C***                                                                 056555
     C***                  EXSR #P10                                      056555
     C***                                                                 056555
     C***ADD CONVERTED FX AP NUMERATOR                                    056555
     C***                                                                 056555
     C***                  ADD  ZAMTT     QXFXAP                          056555
     C***                  ELSE                                           056555
     C***                                                                 056555
     C***IF CURRENCIES  EQUAL THEN ADD FX AP NUMERATOR                    056555
     C***FROM 'FROM' RECORD TO 'TO' RECORD                                056555
     C***                                                                 056555
     C***                  ADD  QAFXAP    QXFXAP                          056555
     C***                  END                                            056555
     C***                                                                 056555
     C***ADD PURCHASED INTEREST ON 'FROM' RECORD TO                       056555
     C***PURCHASED INTEREST ON 'TO' RECORD                                056555
     C***                                                                 056555
     C***                  ADD  QAPILP    QXPILP                          056555
     C***                                                                 056555
     C***UPDATE 'TO' RECORD                                               056555
     C***                                                                 056555
     C***                  EXCPTPMHPTU                                    056555
     C***                                                                 056555
     C***DELETE 'FROM' RECORD                                             056555
     C***                                                                 056555
     C***                  DELETPMHPOSP0                                  056555
     C***                                                                 056555
     C***                  ELSE                                           056555
     C***                                                                 056555
     C***NO RECORD FOUND ON PMHPOSXX                                      056555
     C***                                                                 056555
     C***IF THE 'FROM' PORTFOLIO CURRENCY IS NOT EQUAL TO THE             056555
     C***'TO' PORTFOLIO CURRENCY,CONVERT FX AP NUMERATOR                  056555
     C***                                                                 056555
     C***        WWCCYF    IFNE WWCCYT                                    056555
     C***                                                                 056555
     C***                  Z-ADDQAPDAT    WWPDAT                          056555
     C***                                                                 056555
     C***                  EXSR #P10                                      056555
     C***                                                                 056555
     C***SET CONVERTED FX AP NUMERATOR                                    056555
     C***                                                                 056555
     C***                  Z-ADDZAMTT     QAFXAP                          056555
     C***                  END                                            056555
     C***                                                                 056555
     C***                  MOVELP8TPTF    QAPTFR                          056555
     C***                  MOVELWWCCYT    QAPTCY                          056555
     C***                  Z-ADDWWDCPT    QAPCDP                          056555
     C***                                                                 056555
     C***UPDATE 'FROM' RECORD                                             056555
     C***                                                                 056555
     C***                  EXCPTPMHPFU                                    056555
     C***                                                                 056555
     C***                  END                                            056555
     C***                                                                 056555
     C***                  END                                            056555
     C***                                                                 056555
     C***                  END                                            056555
     C***                                                                 056555
     C***                  ENDSR                                          056555
      **************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P03     - TO SET SE CURRENT POSITIONS FOR REWORKING                   *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PBB     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #P03      BEGSR
     C**
     C** SET 'FROM' POSITIONS FOR REWORKING
     C**
     C           PMPOSF    SETLLPMCPOSLL
     C**
     C           *IN75     DOUEQ'1'
     C**
     C           PMPOSF    READEPMCPOSLL                 75
     C**
     C           *IN75     IFEQ '0'
     C**
     C** STORE NOMINAL CURRENCY & DECIMAL PLACES FROM LF/PMCPOSLL
     C**
     C                     MOVE QCTNMC    NMCY
     C                     Z-ADDQCTNMD    NMDP
     C**
     C                     MOVEL'R'       QCRECI
     C**
     C** SET TRADE & VALUE BACKVALUATION DATES
     C**
     C           QCTVDA    IFEQ 'T'
     C           QCBVLD    IFEQ *ZERO
     C           QCBVLD    ORGT TRDDAT
     C                     Z-ADDTRDDAT    QCBVLD
     C                     END
     C                     ELSE
     C           QCBVLD    IFEQ *ZERO
     C           QCBVLD    ORGT VALDAT
     C                     Z-ADDVALDAT    QCBVLD
     C                     END
     C                     END
     C**
     C           QCCSBY    IFNE QCPTCY                                    041644
     C                     MOVE 'N'       QCAPBC                          041644
     C                     ELSE                                           041644
     C                     MOVE ' '       QCAPBC                          041644
     C                     END                                            041644
     C*
     C                     EXCPTPMCPOU
     C**
     C                     END
     C**
     C                     END
     C**
     C** SET 'TO' POSITIONS FOR REWORKING
     C**
     C**
     C** DO TRADE DATE POSITION
     C**
     C                     MOVEL'T'       WWTVDA
     C                     Z-ADD*ZERO     QCBVLD
     C           PMPOST    CHAINPMCPOSLL             75
     C                     MOVEL'R'       QCRECI
     C*                                                                   B08129
     C** CHECK WHETHER POSITION ALREADY FLAGGED FOR REWORKING             B08129
     C           PMPOST    CHAINPMRPSTLL             77                   B08129
     C           *IN77     IFEQ '1'                                       B08129
     C**
     C** SET TRADE BACKVALUATION DATE
     C**
     C           QCBVLD    IFEQ *ZERO
     C           QCBVLD    ORGT TRDDAT
     C                     Z-ADDTRDDAT    QCBVLD
     C                     END
     C**
     C** UPDATE EXISTING RECORD OR WRITE A NEW ONE
     C**
     C           QCCSBY    IFNE QCPTCY                                    041644
     C                     MOVE 'N'       QCAPBC                          041644
     C                     ELSE                                           041644
     C                     MOVE ' '       QCAPBC                          041644
     C                     END                                            041644
     C*
     C           *IN75     IFEQ '0'
     C                     EXCPTPMCPOU
     C                     ELSE
     C**********           Z-ADDP8CNUM    QCCNUM                                              CSD027
     C                     MOVE P8CNUM    QCCNUM                                              CSD027
     C                     MOVELP8TPTF    QCPTFR
     C                     MOVELP8SESN    QCTDSS
     C                     MOVELWWTVDA    QCTVDA
     C                     Z-ADDBJRDNB    QCPDAT
     C                     Z-ADD*ZERO     QCNOML
     C                     Z-ADD*ZERO     QCCSEX
     C                     Z-ADD*ZERO     QCAPNM
     C                     Z-ADD*ZERO     QCFXAP
     C                     Z-ADD*ZERO     QCPILP
     C                     Z-ADD*ZERO     QCACDI
     C                     MOVE NMCY      QCTNMC
     C                     Z-ADDNMDP      QCTNMD
     C                     MOVE WWCCYT    QCPTCY
     C                     Z-ADDWWDCPT    QCPCDP
     C                     Z-ADD*ZERO     QCAYNM
     C                     MOVE *BLANKS   QCCSBY
     C                     Z-ADD*ZERO     QCBYDP
     C                     MOVE *BLANKS   QCCLAS
     C                     MOVE *BLANKS   QCACOC
     C                     Z-ADD0         QCOTNM
     C                     Z-ADD0         QCOTEX
     C                     MOVE *BLANKS   QCAPBC
     C                     MOVE *BLANKS   QCFLEX
     C                     MOVE *BLANKS   QCCOLC
     C                     MOVE *BLANKS   QCBRCD
     C                     Z-ADD0         QCNPDT
     C                     MOVE *BLANKS   QCPFMR
     C                     WRITEPMCPOSP0
     C                     ADD  1         POSADD  50
     C                     END
     C                     END                                            B08129
     C**
     C** DO VALUE DATE POSITION
     C**
     C                     MOVEL'V'       WWTVDA
     C                     Z-ADD*ZERO     QCBVLD
     C           PMPOST    CHAINPMCPOSLL             75
     C                     MOVEL'R'       QCRECI
     C*                                                                   B08129
     C** CHECK WHETHER POSITION ALREADY FLAGGED FOR REWORKING             B08129
     C           PMPOST    CHAINPMRPSVLL             77                   B08129
     C           *IN77     IFEQ '1'                                       B08129
     C**
     C** SET VALUE BACKVALUATION DATE
     C**
     C           QCBVLD    IFEQ *ZERO
     C           QCBVLD    ORGT VALDAT
     C                     Z-ADDVALDAT    QCBVLD
     C                     END
     C**
     C** UPDATE EXISTING RECORD OR WRITE A NEW ONE
     C**
     C           QCCSBY    IFNE QCPTCY                                    041644
     C                     MOVE 'N'       QCAPBC                          041644
     C                     ELSE                                           041644
     C                     MOVE ' '       QCAPBC                          041644
     C                     END                                            041644
     C*
     C           *IN75     IFEQ '0'
     C                     EXCPTPMCPOU
     C                     ELSE
     C**********           Z-ADDP8CNUM    QCCNUM                                              CSD027
     C                     MOVE P8CNUM    QCCNUM                                              CSD027
     C                     MOVELP8TPTF    QCPTFR
     C                     MOVELP8SESN    QCTDSS
     C                     MOVELWWTVDA    QCTVDA
     C                     Z-ADDBJRDNB    QCPDAT
     C                     Z-ADD*ZERO     QCNOML
     C                     Z-ADD*ZERO     QCCSEX
     C                     Z-ADD*ZERO     QCAPNM
     C                     Z-ADD*ZERO     QCFXAP
     C                     Z-ADD*ZERO     QCPILP
     C                     Z-ADD*ZERO     QCACDI
     C                     MOVE NMCY      QCTNMC
     C                     Z-ADDNMDP      QCTNMD
     C                     MOVE WWCCYT    QCPTCY
     C                     Z-ADDWWDCPT    QCPCDP
     C                     Z-ADD*ZERO     QCAYNM
     C                     MOVE *BLANKS   QCCSBY
     C                     Z-ADD*ZERO     QCBYDP
     C                     MOVE *BLANKS   QCCLAS
     C                     MOVE *BLANKS   QCACOC
     C                     Z-ADD0         QCOTNM
     C                     Z-ADD0         QCOTEX
     C                     MOVE *BLANKS   QCAPBC
     C                     MOVE *BLANKS   QCFLEX
     C                     MOVE *BLANKS   QCCOLC
     C                     MOVE *BLANKS   QCBRCD
     C                     Z-ADD0         QCNPDT
     C                     MOVE *BLANKS   QCPFMR
     C                     WRITEPMCPOSP0
     C                     ADD  1         POSADD
     C                     END
     C                     END                                            B08129
     C**
     C** SET PMSTAT TO SIGNIFY (SE) TRANSFER HAS BEEN DONE
     C**
     C                     MOVEL'Y'       WWTFRD
     C**
     C                     ENDSR
      ********************************************************************
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P04     - TO TRANSFER SE TRADES                                       *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      * #P11     - TO DETERMINE TRADE VALUE IN PORTFOLIO CURRENCY              *
      * ZFXAVP   - TO CALCULATE FX AVERAGE RATE                                *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PBB     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWCCYF   - WORK FIELD CURRENCY - 'FROM' CURRENCY                       *
      * WWCCYT   - WORK FIELD CURRENCY - 'TO' CURRENCY                         *
      * WWCSSC   - SECURITY KEY                                                *
      * WWCSRF   - REFERENCE KEY                                               *
      * WWCSSE   - SORT SEQUENCE KEY                                           *
      *                                                                        *
      **************************************************************************
     C           #P04      BEGSR
     C**
     C                     MOVELP8TRNB    TDRF
     C**
     C** ACCESS TRADS
     C**
     C           TDRF      CHAINTRADS                75
     C**
     C           *IN75     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD7         DBASE            **DB ERROR 07**
     C                     MOVEL'TRADS'   DBFILE           ***************
     C                     MOVELTDRF      DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C** IF NOT LIVE RECORD ON TRADSD THEN BYPASS
     C**
     C                     MOVEL'N'       PROCSD  1
     C           RECI      CABEQ'*'       EP04
     C                     MOVEL'Y'       PROCSD
     C**
     C** IF 'FROM' CURRENCY NOT EQUAL TO 'TO' CURRENCY
     C** RECALCULATE EXCHANGE RATE FOR SETTLEMENT CURRENCY TO PORTFOLIO CURRENCY
     C**
     C           WWCCYF    IFNE WWCCYT
     C**
     C** ACCESS LF/SECTY
     C**
     C           TDSS      CHAINSECTY                76
     C**
     C** IF RECORD NOT FOUND -- DATA BASE ERROR
     C**
     C           *IN76     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD8         DBASE            **DB ERROR 08**
     C                     MOVEL'SECTY'   DBFILE           ***************
     C                     MOVELTDSS      DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C** ACCESS SDCURRL0 FOR NOMINAL CURRENCY DECIMAL PLACES
     C**
     C***********NMCY      CHAINSDCURRL0             76                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG   ' @RTCD   7                       S01486
     C                     PARM '*KEY  '  @OPTN   7                       S01486
     C                     PARM NMCY      @AJCD   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C** IF RECORD NOT FOUND -- DATA BASE ERROR
     C**
     C************IN76     IFEQ '1'                        ***************S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD9         DBASE            **DB ERROR 09**
     C***********          MOVEL'SDCURRL0'DBFILE           ***************S01486
     C                     MOVEL'SDCURRPD'DBFILE           ***************S01486
     C                     MOVELNMCY      DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C** STORE NOMINAL CURRENCY DECIMAL PLACES
     C**
     C                     Z-ADDA6NBDP    WWNCDP  10
     C**
     C** SET EXCHANGE RATE AND MULT/DIV INDICATOR AS CALCULATED
     C** IN SUBROUTINE #P11 (SETTLEMENT TO PORTFOLIO CURRENCY RATE)
     C**
     C                     EXSR #P11
     C                     Z-ADDZCRSRT    SPXR
     C                     MOVELZCRSMD    SPMD
     C                     END
     C**
     C** UPDATE SE TRADES
     C**
     C                     MOVELP8TPTF    PTFR
     C**
     C                     EXCPTTRADSU
     C**
     C***ACCESS*LF/CAPRHS**-*HISTORIC*CUSTOMER*AVERAGE*PRICE**************S01486
     C** ACCESS LF/PMCAPRL4 - HISTORIC CUSTOMER AVERAGE PRICE             S01486
     C**
     C***UPDATE*ALL*RECORDS*ON*CAPRHS*WITH*SECURITY*SHORTNAME*FROM*TRADS**S01486
     C** UPDATE ALL RECORDS ON PMCAPRL4 WITH SECURITY SHORTNAME FROM TRADSS01486
     C** TRANSACTION NUMBER FROM PMTPTMLL AND SORT SEQUENCE=1.
     C**
     C                     MOVELTDSS      WWCSSC
     C                     MOVELP8TRNB    WWCSRF
     C                     MOVEL'1'       WWCSSE
     C**
     C***********PMCAPR    SETLLCAPRHS                                    S01486
     C           PMCAPR    SETLLPMCAPRL4                                  S01486
     C**
     C           *IN75     DOUEQ'1'
     C**
     C***********PMCAPR    READECAPRHS                   75               S01486
     C           PMCAPR    READEPMCAPRL4                 75               S01486
     C**
     C           *IN75     IFEQ '0'
     C**
     C** IF 'FROM' PORTFOLIO CURRENCY IS NOT EQUAL TO 'TO' PORTFOLIO CURRENCY
     C** RECALCULATE CHANGE TO FX AP NUMERATOR & FX RATE ON CAPRHD RECORD
     C**
     C           WWCCYF    IFNE WWCCYT
     C**
     C** SET CHANGE TO FX AP NUMERATOR ON PF/CAPRHD EQUAL TO TRADE
     C** VALUE IN PORTFOLIO CURRENCY ( WITHIN PROCESS #P11 )
     C**
     C                     Z-ADDZAMTT     CFAP
     C**
     C** DETERMINE THE CUSTOMER FX RATE USING STANDARD SUBROUTINE
     C** ZFXAVP
     C**
     C           CSTB      IFNE *ZERO
     C                     Z-ADDCSTB      ZAPNM
     C                     ELSE
     C                     Z-ADDCSVB      ZAPNM
     C                     END
     C                     Z-ADDCFAP      ZFXAP
     C                     Z-ADDWWNCDP    ZNMCD
     C                     Z-ADDWWDCPT    ZPTCD
     C**
     C                     EXSR ZFXAVP
     C**
     C** SET CUSTOMER FX RATE ON PF/CAPRHD EQUAL TO THE AVERAGE EXCHANGE
     C** RATE ZAVFX FROM SR ZFXAVP
     C**
     C                     Z-ADDZAVFX     CFXR
     C**
     C                     END
     C**
     C** UPDATE RECORD - HISTORIC CUSTOMER AVERAGE PRICE
     C**
     C                     MOVELP8TPTF    PTFR
     C**
     C                     EXCPTCAPRHU
     C**
     C                     END
     C**
     C                     END
     C           EP04      ENDSR                           ** END #P04**
      ********************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P05     - TO TRANSFER SE DEPOT MOVEMENTS                              *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      * #P12     - TO DETERMINE DEPOT MOVEMENT VALUE IN PORTFOLIO CURRENCY     *
      * ZFXAVP   - TO CALCULATE FX AVERAGE RATE                                *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PBB     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWCSSC   - SECURITY KEY                                                *
      * WWCSRF   - REFERENCE KEY                                               *
      * WWSSEQ   - SORT SEQUENCE                                               *
      *                                                                        *
      **************************************************************************
     C           #P05      BEGSR                           **#P05 BEGIN**
     C**
     C** ACCESS LF/DPTMV - SE DEPOT MOVEMENTS
     C**
     C                     MOVELP8TRNB    WWTRNB
     C           PMDPTM    CHAINDPTMV                75
     C**
     C           *IN75     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD10        DBASE            **DB ERROR 10**
     C                     MOVEL'DPTMV'   DBFILE           ***************
     C                     MOVEL'PMDPTM'  DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C** BYPASS IF DEPOT MOVEMENT DELETED
     C**
     C                     MOVEL'N'       PROCSD
     C           RECI      CABEQ'*'       EP05
     C                     MOVEL'Y'       PROCSD
     C**
     C***UPDATE*DEPOT*MOVEMENT*RECORD                                     R10049
     C**
     C******************** MOVELP8TPTF    PTFR                            R10049
     C**
     C******************** EXCPTDPTMVU                                    R10049
     C**
     C** IF 'FROM' PORTFOLIO CURRENCY IS NOT EQUAL TO 'TO' PORTFOLIO CURRENCY
     C**
     C           WWCCYF    IFNE WWCCYT
     C**
     C** ACCESS LF/SECTY
     C**
     C           DPSS      CHAINSECTY                76
     C**
     C** IF RECORD NOT FOUND -- DATA BASE ERROR
     C**
     C           *IN76     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD11        DBASE            **DB ERROR 11**
     C                     MOVEL'SECTY'   DBFILE           ***************
     C                     MOVELDPSS      DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C** ACCESS SDCURRL0 FOR NOMINAL CURRENCY DECIMAL PLACES
     C**
     C***********NMCY      CHAINSDCURRL0             76                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG   ' @RTCD   7                       S01486
     C                     PARM '*KEY  '  @OPTN   7                       S01486
     C                     PARM NMCY      @AJCD   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C** IF RECORD NOT FOUND -- DATA BASE ERROR
     C**
     C************IN76     IFEQ '1'                        ***************S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD12        DBASE            **DB ERROR 12**
     C                     MOVEL'SDCURRL0'DBFILE           ***************
     C                     MOVELNMCY      DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C** STORE NOMINAL CURRENCY DECIMAL PLACES
     C**
     C                     Z-ADDA6NBDP    WWNCDP  10
     C**
     C                     END
     C**
     C***ACCESS*LF/CAPRHS**-*HISTORIC*CUSTOMER*AVERAGE*PRICE**************S01486
     C** ACCESS LF/PMCAPRL4  - HISTORIC CUSTOMER AVERAGE PRICE            S01486
     C**
     C***UPDATE*ALL*RECORDS*ON*CAPRHS*WITH*SECURITY*SHORTNAME,************S01486
     C** UPDATE ALL RECORDS ON PMCAPRL4 WITH SECURITY SHORTNAME,          S01486
     C** TRANSACTION NUMBER FROM PMTPTMLL AND SORT SEQUENCE=3.
     C**
     C                     MOVELP8SESN    WWCSSC
     C                     MOVE P8TRNB    WWCSRF
     C                     MOVEL'3'       WWCSSE
     C**
     C***********PMCAPR    SETLLCAPRHS                                    S01486
     C           PMCAPR    SETLLPMCAPRL4                                  S01486
     C**
     C           *IN76     DOUEQ'1'
     C**
     C***********PMCAPR    READECAPRHS                   76               S01486
     C           PMCAPR    READEPMCAPRL4                 76               S01486
     C**
     C           *IN76     IFEQ '0'
     C**
     C** IF 'FROM' PORTFOLIO CURRENCY IS NOT EQUAL TO 'TO' PORTFOLIO CURRENCY
     C** RECALCULATE CHANGE TO FX AP NUMERATOR & FX RATE ON CAPRHD RECORD
     C**
     C           WWCCYF    IFNE WWCCYT
     C**
     C** SET CHANGE TO FX AP NUMERATOR ON PF/CAPRHD EQUAL TO
     C** CONVERTED AP NUMERATOR (FROM STANDARD SR ZCCYCN WITHIN #P12)
     C**
     C                     EXSR #P12
     C                     Z-ADDZAMTT     CFAP
     C**
     C** DETERMINE THE CUSTOMER FX RATE USING STANDARD SUBROUTINE
     C** ZFXAVP
     C**
     C****                 Z-ADDZAMTF     ZAPNM                           46797
     C           CSTB      IFNE *ZERO                                     46797
     C                     Z-ADDCSTB      ZAPNM                           46797
     C                     ELSE                                           46797
     C                     Z-ADDCSVB      ZAPNM                           46797
     C                     END                                            46797
     C                     Z-ADDCFAP      ZFXAP
     C                     Z-ADDWWNCDP    ZNMCD
     C                     Z-ADDWWDCPT    ZPTCD
     C**
     C                     EXSR ZFXAVP
     C**
     C** SET CUSTOMER FX RATE ON PF/CAPRHD EQUAL TO THE AVERAGE
     C** EXCHANGE RATE ZAVFX FROM SR ZFXAVP
     C**
     C                     Z-ADDZAVFX     CFXR
     C**
     C                     END
     C**
     C** UPDATE RECORD - HISTORIC CUSTOMER AVERAGE PRICE
     C**
     C                     MOVELP8TPTF    PTFR
     C**
     C                     EXCPTCAPRHU
     C**
     C                     END
     C**
     C                     END
     C**
     C                     EXCPTDPTMVU                                    R10049
     C**
     C           EP05      ENDSR                           **#P05 END  **
      ********************************************************************
      ***/EJECT***                                                        S01486
      ********************************************************************S01486
      ***********                                                         S01486
      **#P06*****-*TO*TRANSFER*FF*TRANSACTIONS****************************S01486
      ***********                                                         S01486
      **SUBROUTINE CALLS:*************************************************S01486
      ***PSSR****-*TO*PROCESS*DATA*BASE*ERRORS****************************S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLED*FROM:*******************************************S01486
      **#PBB*****-*MAIN*PROCESSING****************************************S01486
      ***********                                                         S01486
      **ROUTINE*USES*VARIABLES:*******************************************S01486
      ***********                                                         S01486
      ********************************************************************S01486
     C***********#P06      BEGSR                           **#P06 BEGIN** S01486
     C***********                                                         S01486
     C***ACCESS*LF/TRANS*-*FF*TRANSACTION*DETAILS**********************   S01486
     C***********                                                         S01486
     C***********TRANSK    KLIST                                    059998S01486
     C***********          KFLD           P8CNUM                    059998S01486
     C***********          KFLD           P8FPTF                    059998S01486
     C***********          KFLD           P8TRNB                    059998S01486
     C***********P8TRNB    CHAINTRANS                75             059998S01486
     C***********TRANSK    CHAINTRANSPT              75             059998S01486
     C***********                                                         S01486
     C************IN75     IFEQ '1'                        ***************S01486
     C************LOCK     IN   LDA                                 S01486S01486
     C***********          Z-ADD13        DBASE            **DB ERROR 13**S01486
     C******************** MOVEL'TRANS   'DBFILE           *********059998S01486
     C******************** MOVELP8TRNB    DBKEY                     059998S01486
     C***********          MOVEL'TRANSPT 'DBFILE                    059998S01486
     C***********          MOVEL*BLANKS   WKKEY  50                 059998S01486
     C***********          MOVELP8TRNB    WKKEY                     059998S01486
     C***********          MOVELP8CNUM    ACNUM   6                 059998S01486
     C***********WKKEY     CAT  ACNUM:1   WKKEY                     059998S01486
     C***********WKKEY     CAT  P8FPTF:1  WKKEY                     059998S01486
     C***********          MOVELWKKEY     DBKEY                     059998S01486
     C***********          OUT  LDA                                       S01486
     C***********          EXSR *PSSR                                     S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********RECI      IFNE '*'                                       S01486
     C***********          MOVELP8TPTF    PTFR                            S01486
     C***********                                                         S01486
     C***********          EXCPTTRANSU                                    S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          ENDSR                           **#P06 END  ** S01486
      ********************************************************************S01486
      /EJECT                                                              S71062
      ********************************************************************S71062
      *                                                                   S71062
      * #P06     - TO TRANSFER FF TRANSACTIONS                            S71062
      *                                                                   S71062
      * SUBROUTINE CALLS:                                                 S71062
      * *PSSR    - TO PROCESS DATA BASE ERRORS                            S71062
      *                                                                   S71062
      * SUBROUTINE CALLED FROM:                                           S71062
      * #PBB     - MAIN PROCESSING                                        S71062
      *                                                                   S71062
      * ROUTINE USES VARIABLES:                                           S71062
      *                                                                   S71062
      ********************************************************************S71062
     C           #P06      BEGSR                           **#P06 BEGIN** S71062
     C**                                                                  S71062
     C** ACCESS LF/TRANSPT - FF TRANSACTION DETAILS                       S71062
     C**                                                                  S71062
     C           TRANSK    KLIST                                          S71062
     C                     KFLD           P8CNUM                          S71062
     C                     KFLD           P8FPTF                          S71062
     C**********           KFLD           P8TRNB                                       S71062 CLE148
     C                     KFLD           WTRNB2  60                                          CLE148
     C                     MOVE P8TRNB    WTRNB2                                              CLE148
     C           TRANSK    CHAINTRANSPT              75                   S71062
     C**                                                                  S71062
     C           *IN75     IFEQ '1'                        ***************S71062
     C           *LOCK     IN   LDA                                       S71062
     C                     Z-ADD13        DBASE            **DB ERROR 13**S71062
     C                     MOVEL'TRANSPT 'DBFILE           ***************S71062
     C                     MOVEL*BLANKS   WKKEY  50                       S71062
     C                     MOVELP8TRNB    WKKEY                           S71062
     C                     MOVELP8CNUM    ACNUM   6                       S71062
     C           WKKEY     CAT  ACNUM:1   WKKEY                           S71062
     C           WKKEY     CAT  P8FPTF:1  WKKEY                           S71062
     C                     MOVELWKKEY     DBKEY                           S71062
     C                     OUT  LDA                                       S71062
     C                     EXSR *PSSR                                     S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C           RECI      IFNE '*'                                       S71062
     C                     MOVELP8TPTF    PTFR                            S71062
     C**                                                                  S71062
     C                     EXCPTTRANSU                                    S71062
     C**                                                                  S71062
     C                     END                                            S71062
     C**                                                                  S71062
     C                     ENDSR                           **#P06 END  ** S71062
      ********************************************************************S71062
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P07     - TO TRANSFER DL DEALS                                        *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PBB     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #P07      BEGSR                           **#P07 BEGIN**
     C**
     C** ACCESS LF/DEALS - DL DEALS
     C**
     C                     MOVE '0'       *IN01
     C                     MOVE '0'       *IN02
     C                     MOVE '0'       *IN03
     C**
     C****       P8TRNB    CHAINDEALS                75                   B08114
     C****       DEALSK    CHAINDEALSPT              75             B08275B08114
     C********** P8TRNB    CHAINDEALS                75                                B08275 CLE148
     C                     MOVE P8TRNB    DLNO                                                CLE148
     C           DLNO      CHAINDEALS                75                                       CLE148
     C**
     C** SET ON INDICATOR STATING FILE ON WHICH RECORD FOUND AND IF NOT   B08275
     C** FOUND ON DEALS ACCESS DLDEALL                                    B08275
     C           *IN75     IFEQ '0'                                       B08275
     C                     MOVE 'Y'       WWDELS  1                       B08275
     C                     ELSE                                           B08275
     C                     MOVE 'N'       WWDELS                          B08275
     C********** P8TRNB    CHAINDLDEALL              75                                B08275 CLE148
     C                     MOVE P8TRNB    DLNO                                                CLE148
     C           DLNO      CHAINDLDEALL              75                                       CLE148
     C*                                                                   B08275
     C           *IN75     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD14        DBASE            **DB ERROR 14**
     C                     MOVEL'DEALS'   DBFILE           ***************
     C                     MOVELP8TRNB    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C                     END                                            B08275
     C**
     C           RECI      IFNE '*'
     C                     MOVELP8TPTF    PTFR
     C*                                                                   CPM004
     C** If Bank Portfolio is supported, access matching book             CPM004
     C** code for the new portfolio.                                      CPM004
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C                     EXSR SRBOOK                                    CPM004
     C                     MOVELO#BOOK    BOKC                            CPM004
     C                     ENDIF                                          CPM004
     C**
     C           *IN01     IFEQ '1'
     C*                                                                   B08275
     C           WWDELS    IFEQ 'Y'                                       B08275
     C                     EXCPTDEALBU
     C                     ELSE                                           B08275
     C                     EXCPTDEALBF                                    B08275
     C                     END                                            B08275
     C*
     C*  UPDATE FXDEALPP                                                  39590
     C           BGDRFE    IFEQ 'Y'                                       39590
     C           DLNO      CHAINFXDEALP0             78                   39590
     C********** *IN75     IFEQ '0'                                 39590 048863
     C           *IN78     IFEQ '0'                                       048863
     C                     MOVELPTFR      FHPTFR                          39590
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C                     MOVELO#BOOK    FHBOKC                          CPM004
     C                     ENDIF                                          CPM004
     C*                                                                   CPM004
     C                     EXCPTFXDEAL                                    39590
     C                     END                                            39590
     C                     END                                            39590
     C*                                                                   B08275
     C                     END
     C**
     C           *IN02     IFEQ '1'
     C*                                                                   R01167
     C** IF 'FROM' PORTFOLIO CURRENCY NOT EQUAL TO 'TO' PORTFOLIO         R01167
     C** CURRENCY CALCULATE NEW FX RATE FOR TO PORTFOLIO CURRENCY         R01167
     C           WWCCYF    IFNE WWCCYT                                    R01167
     C                     MOVE CCY       ZCCYF                           R01167
     C                     MOVE WWCCYT    ZCCYT                           R01167
     C                     Z-ADDDDAT      ZSDATE                          R01167
     C                     EXSR ZBAKRT                                    R01167
     C*                                                                   R01167
     C           ZERROR    IFEQ 'Y'                        ***************R01167
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD11        DBASE            * DB ERROR 11 *R01167
     C                     MOVEL'ZBAKRT  'DBFILE           ***************R01167
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     R01167
     C                     END                                            R01167
     C*                                                                   R01167
     C                     Z-ADDZCRSRT    FXRD                            R01167
     C                     END                                            R01167
     C*                                                                   R01167
     C           WWDELS    IFEQ 'Y'                                       B08275
     C                     EXCPTDEALCU
     C                     ELSE                                           B08275
     C                     EXCPTDEALCF                                    B08275
     C                     END                                            B08275
     C*
     C*  UPDATE MMDELDPP                                                  39590
     C           BGDRMM    IFEQ 'Y'                                       39590
     C           DLNO      CHAINMMDEALLL             78                   39590
     C********** *IN75     IFEQ '0'                                 39590 048863
     C           *IN78     IFEQ '0'                                       048863
     C                     MOVELPTFR      HKPTFR                          39590
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C                     MOVELO#BOOK    HKBOKC                          CPM004
     C                     ENDIF                                          CPM004
     C*                                                                   CPM004
     C                     EXCPTMMDEAL                                    39590
     C                     END                                            39590
     C                     END                                            39590
     C*                                                                   B08275
     C                     END
     C*
     C************IN03     IFEQ '1'                                       S01486
     C***********                                                         S01486
     C***********WWDELS    IFEQ 'Y'                                 B08275S01486
     C***********          EXCPTDEALGU                                    S01486
     C***********          ELSE                                     B08275S01486
     C***********          EXCPTDEALGF                              B08275S01486
     C***********          END                                      B08275S01486
     C***********                                                   B08275S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C                     END
     C**
     C                     ENDSR                           **#P07 END  **
      ********************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P08     - TO TRANSFER LE LOANS                                        *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PBB     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #P08      BEGSR                           **#P08 BEGIN**
     C**
     C** ACCESS LF/LOANS - LE LOANS
     C**
     C           P8TRNB    CHAINCLOAN                75
     C**
     C           *IN75     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD15        DBASE            **DB ERROR 15**
     C                     MOVEL'CLOAN'   DBFILE           ***************
     C                     MOVELP8TRNB    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C           RECI      IFNE '*'
     C                     MOVELP8TPTF    PTFR
     C*                                                                   CPM004
     C** If Bank Portfolio is supported, access matching book             CPM004
     C** code for the new portfolio.                                      CPM004
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C                     EXSR SRBOOK                                    CPM004
     C                     MOVELO#BOOK    BOKC                            CPM004
     C                     ENDIF                                          CPM004
     C**
     C                     EXCPTCLOANU
     C**
     C                     END
     C**
     C                     ENDSR                           **#P08 END  **
      ********************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P09     - TO TRANSFER RE ACCOUNTS                                     *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PBB     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           #P09      BEGSR                           **#P09 BEGIN**
     C**
     C** ACCESS LF/ACCNT - GL ACCOUNT MASTER
     C**
     C           PMACCN    CHAINACCNT                75
     C**
     C           *IN75     IFEQ '1'                        ***************
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD16        DBASE            **DB ERROR 16**
     C                     MOVEL'ACCNT'   DBFILE           ***************
     C                     MOVEL'PMACCN'  DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C           RECI      IFNE '*'
     C                     MOVELP8TPTF    PTFR
     C**
     C                     EXCPTACCNTU
     C**
     C                     END
     C**
     C                     ENDSR                           **#P09 END  **
      ********************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      **#P10*****- TO CONVERT FX AP NUMERATOR ON PORTFOLIO POSITIONS     056555*
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #P13     - TO DETERMINE SPOT RATE, MULTIPLY/DIVIDE INDICATOR           *
      * ZCCYCN   - TO CONVERT AN AMOUNT IN ONE CURRENCY TO ANOTHER             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      **#P02*****-*TO*TRANSFER*SE*HISTORIC*POSITIONS*                    056555*
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWCCYF   - WORK FIELD CURRENCY - 'FROM' CURRENCY                       *
      * WWCCYT   - WORK FIELD CURRENCY - 'TO' CURRENCY                         *
      * WWDCPF   - WORK FIELD NUMBER OF DECIMAL PLACES FOR 'FROM' CURRENCY     *
      * WWDCPT   - WORK FIELD NUMBER OF DECIMAL PLACES FOR 'TO' CURRENCY       *
      * WWCCYH   - CURRENCY KEY                                                *
      * WWSPOT   - WORK FIELD SPOT RATE                                        *
      * WWMDIN   - WORK FIELD MULTIPLY/DIVIDE INDICATOR                        *
      *                                                                        *
      **************************************************************************
     C***        #P10      BEGSR                           **#P10 BEGIN** 056555
     C***                                                                 056555
     C***SET ZAMTF EQUAL TO FX AP NUMERATOR ON 'FROM' RECORD              056555
     C***                                                                 056555
     C***                  Z-ADDQAFXAP    ZAMTF                           056555
     C***                                                                 056555
     C***SET ZCCYF EQUAL TO 'FROM' PORTFOLIO CURRENCY                     056555
     C***                                                                 056555
     C***                  MOVELWWCCYF    ZCCYF                           056555
     C***                                                                 056555
     C***SET ZCCYT EQUAL TO 'TO' PORTFOLIO CURRENCY                       056555
     C***                                                                 056555
     C***                  MOVELWWCCYT    ZCCYT                           056555
     C***                                                                 056555
     C***GET EXCHANGE RATE FOR 'FROM' PORTFOLIO CURRENCY                  056555
     C***                                                                 056555
     C***                  MOVELWWCCYF    WWCCYH                          056555
     C***                                                                 056555
     C***                  EXSR #P13                                      056555
     C***                                                                 056555
     C***SET ZRATEF AND ZMDINF EQUAL TO THE SPOT RATE AND MULTIPLY/       056555
     C***DIVIDE INDICATOR DETERMINED BY #P13 ABOVE                        056555
     C***                                                                 056555
     C***                  Z-ADDWWSPOT    ZRATEF                          056555
     C***                  MOVELWWMDIN    ZMDINF                          056555
     C***                                                                 056555
     C***GET EXCHANGE RATE FOR 'TO' PORTFOLIO CURRENCY                    056555
     C***                                                                 056555
     C***                  MOVELWWCCYT    WWCCYH                          056555
     C***                                                                 056555
     C***                  EXSR #P13                                      056555
     C***                                                                 056555
     C***SET ZRATET AND ZMDINT EQUAL TO THE SPOT RATE AND MULTIPLY/       056555
     C***DIVIDE INDICATOR DETERMINED BY #P13 ABOVE                        056555
     C***                                                                 056555
     C***                  Z-ADDWWSPOT    ZRATET                          056555
     C***                  MOVELWWMDIN    ZMDINT                          056555
     C***                                                                 056555
     C***SET ZCDPF EQUAL TO THE 'FROM' PORTFOLIO CURRENCY DECIMAL PLACES  056555
     C***                                                                 056555
     C***                  Z-ADDWWDCPF    ZCDPF                           056555
     C***                                                                 056555
     C***SET ZCDPT EQUAL TO THE 'TO' PORTFOLIO CURRENCY DECIMAL PLACES    056555
     C***                                                                 056555
     C***                  Z-ADDWWDCPT    ZCDPT                           056555
     C***                                                                 056555
     C***CONVERT FX AP NUMERATOR ON 'FROM' RECORD FROM 'FROM'             056555
     C***PORTFOLIO CURRENCY TO 'TO' PORTFOLIO CURRENCY                    056555
     C***                                                                 056555
     C***                  EXSR ZCCYCN                                    056555
     C***                                                                 056555
     C***                  ENDSR                           **#P10 END  ** 056555
      ********************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P11     - TO DETERMINE TRADE VALUE IN PORTFOLIO CURRENCY              *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #P13     - TO DETERMINE SPOT RATE, MULTIPLY/DIVIDE INDICATOR           *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      * ZCCYCN   - TO CONVERT AN AMOUNT IN ONE CURRENCY TO ANOTHER             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #P04     - TO TRANSFER SE TRADES                                       *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWCCYF   - WORK FIELD CURRENCY - 'FROM' CURRENCY                       *
      * WWCCYT   - WORK FIELD CURRENCY - 'TO' CURRENCY                         *
      * WWDCPF   - WORK FIELD NUMBER OF DECIMAL PLACES FOR 'FROM' CURRENCY     *
      * WWDCPT   - WORK FIELD NUMBER OF DECIMAL PLACES FOR 'TO' CURRENCY       *
      * WWCCYH   - CURRENCY KEY                                                *
      * WWPDAT   - DATE KEY                                                    *
      * WWSPOT   - WORK FIELD SPOT RATE                                        *
      * WWMDIN   - WORK FIELD MULTIPLY/DIVIDE INDICATOR                        *
      *                                                                        *
      **************************************************************************
     C           #P11      BEGSR                           **#P11 BEGIN**
     C*
     C* CALCULATE THE TRADE VALUE IN SETTLEMENT CURRENCY
     C*
     C           TVSN      ADD  TVSP      CTVLSC 150
     C                     ADD  TOSV      CTVLSC
     C*
     C* CALCULATE THE EXCHANGE RATE FROM NOMINAL TO SETTLEMENT CURRENCY
     C*
     C           TCTR      IFNE *ZERO
     C           CTVLSC    DIV  TCTR      ERNSC  158H
     C                     ELSE
     C                     Z-ADD*ZERO     ERNSC
     C                     END
     C*
     C* CONVERT PURCHASED INT,CHARGES & COMMISSIONS TO SETTLEMENT CURRENCY
     C*
     C           TBCA      ADD  TCCA      CCTL   150
     C           TCA1      ADD  TCA2      CCCT   150
     C                     ADD  TCA3      CCCT
     C                     ADD  TCA4      CCCT
     C                     ADD  TCA5      CCCT
     C                     ADD  TCA6      CCCT
     C                     ADD  TCA7      CCCT
     C                     ADD  TAXA      CCCT
     C           ITRA      MULT ERNSC     ITRASC 150H
     C           CCTL      MULT ERNSC     CCTLSC 150H
     C           CCCT      MULT ERNSC     CCCTSC 150H
     C*
     C* SUBTRACT PURCHASED INT & CHARGES & COMMISSIONS (IF REQUIRED) FROM
     C* TOTAL VALUE TO GET CUSTOMER TRADE VALUE IN SETTLEMENT CURRENCY
     C*
     C           CTVLSC    SUB  ITRASC    SETAM  150
     C****       CCAP      IFEQ 'Y'                                       48219
     C***********CCAP      IFEQ 'N'                                  48219S01486
     C           BVCCAP    IFEQ 'N'                                       S01486
     C                     SUB  CCTLSC    SETAM
     C                     END
     C****       COCP      IFEQ 'Y'                                       48219
     C***********COCP      IFEQ 'N'                                  48219S01486
     C           BVCMCP    IFEQ 'N'                                       S01486
     C                     SUB  CCCTSC    SETAM
     C                     END
     C**
     C** IF SETTLEMENT CURRENCY EQUALS TO PORTFOLIO CURRENCY
     C**
     C           SETC      IFEQ WWCCYT
     C                     Z-ADDSETAM     ZAMTT
     C                     Z-ADD1         ZCRSRT
     C                     MOVEL'M'       ZCRSMD
     C                     ELSE
     C**
     C** SET ZAMTF EQUAL TO TRADE VALUE IN SETTLEMENT CURRENCY
     C**
     C                     Z-ADDSETAM     ZAMTF
     C**
     C** SET ZCCYF EQUAL TO SETTLEMENT CURRENCY FROM LF/TRADS
     C**
     C                     MOVELSETC      ZCCYF
     C**
     C**SET*ZCCYT*EQUAL*TO*'TO'*PORTFOLIO*CURRENCY*FROM*PF/PMPORTPP*******S01486
     C**SET ZCCYT EQUAL TO 'TO' PORTFOLIO CURRENCY FROM PF/PMPORTPD       S01486
     C**
     C                     MOVELWWCCYT    ZCCYT
     C**
     C** DETERMINE EXCHANGE RATE FOR SETTLEMENT CURRENCY
     C**
     C                     MOVELSETC      WWCCYH
     C                     Z-ADDTDDT      WWPDAT
     C**
     C                     EXSR #P13
     C**
     C** SET ZRATEF AND ZMDINF EQUAL TO THE SPOT RATE AND MULTIPLY/DIVIDE
     C** INDICATOR DETERMINED BY #P13
     C**
     C                     Z-ADDWWSPOT    ZRATEF
     C                     MOVELWWMDIN    ZMDINF
     C**
     C** DETERMINE EXCHANGE RATE FOR 'TO' CURRENCY
     C**
     C                     MOVELWWCCYT    WWCCYH
     C                     Z-ADDTDDT      WWPDAT
     C**
     C                     EXSR #P13
     C**
     C** SET ZRATET AND ZMDINT EQUAL TO THE SPOT RATE AND MULTIPLY/DIVIDE
     C** INDICATOR DETERMINED BY #P13
     C**
     C                     Z-ADDWWSPOT    ZRATET
     C                     MOVELWWMDIN    ZMDINT
     C**
     C** ACCESS LF/SDCURRL0 USING THE SETTLEMENT CURRENCY
     C** FOR THE SETTLEMENT CURRENCY DECIMAL PLACES
     C**
     C***********SETC      CHAINSDCURRL0             76                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG   ' @RTCD   7                       S01486
     C                     PARM '*KEY  '  @OPTN   7                       S01486
     C                     PARM SETC      @AJCD   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C************IN76     IFEQ '1'                        ***************S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD17        DBASE            **DB ERROR 17**
     C                     MOVEL'SDCURRL0'DBFILE           ***************
     C                     MOVELSETC      DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C                     Z-ADDA6NBDP    ZCDPF
     C**
     C** SET ZCDPT EQUAL TO THE 'TO' PORTFOLIO CURRENCY
     C** DECIMAL PLACES
     C**
     C                     Z-ADDWWDCPT    ZCDPT
     C**
     C** CONVERT COUNTERVALUE FROM SETTLEMENT CURRENCY TO 'TO'
     C** PORTFOLIO CURRENCY
     C**
     C                     EXSR ZCCYCN
     C                     END
     C**
     C                     ENDSR                           **#P11 END  **
      ********************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P12     - TO DETERMINE DEPOT MOVEMENT VALUE IN PORTFOLIO CURRENCY     *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * #P13     - TO DETERMINE SPOT RATE, MULTIPLY/DIVIDE INDICATOR           *
      * ZCCYCN   - TO CONVERT AN AMOUNT IN ONE CURRENCY TO ANOTHER             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #P05     - TO TRANSFER SE DEPOT MOVEMENTS                              *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWDPOT   - WORK FIELD DEPOT MOVEMENT                                   *
      * WWCCYF   - WORK FIELD CURRENCY - 'FROM' CURRENCY                       *
      * WWCCYT   - WORK FIELD CURRENCY - 'TO' CURRENCY                         *
      * WWDCPF   - WORK FIELD NUMBER OF DECIMAL PLACES FOR 'FROM' CURRENCY     *
      * WWDCPT   - WORK FIELD NUMBER OF DECIMAL PLACES FOR 'TO' CURRENCY       *
      * WWCCYH   - CURRENCY KEY                                                *
      * WWPDAT   - DATE KEY                                                    *
      * WWSPOT   - WORK FIELD SPOT RATE                                        *
      * WWMDIN   - WORK FIELD MULTIPLY/DIVIDE INDICATOR                        *
      *                                                                        *
      **************************************************************************
     C           #P12      BEGSR                           **#P12 BEGIN**
     C**
     C** SET ZAMTF EQUAL TO  THE DEPOT MOVEMENT VALUE IN NOMINAL CURRENCY
     C**
     C           CSTB      IFNE *ZERO
     C                     Z-ADDCSTB      ZAMTF
     C                     ELSE
     C                     Z-ADDCSVB      ZAMTF
     C                     END
     C**
     C** SET ZCCYF EQUAL TO THE NOMINAL CURRENCY FROM LF/SECTY
     C**
     C                     MOVELNMCY      ZCCYF
     C**
     C** SET ZCCYT EQUAL TO THE 'TO' PORTFOLIO CURRENCY
     C***FROM*PF/PMPORTPP*************************************************S01486
     C** FROM PF/PMPORTPD                                                 S01486
     C**
     C                     MOVELWWCCYT    ZCCYT
     C**
     C** DETERMINE EXCHANGE RATE FOR THE 'FROM' CURRENCY
     C**
     C                     MOVELNMCY      WWCCYH
     C**
     C** MOVEMENT DATE IN OR OUT DEPENDING ON WHICH IS NON ZERO
     C**
     C           DPMD      IFNE 0
     C                     Z-ADDDPMD      WWPDAT
     C                     ELSE
     C                     Z-ADDDPDO      WWPDAT
     C                     END
     C**
     C                     EXSR #P13
     C**
     C** SET ZRATEF AND ZMDINF EQUAL TO THE SPOT RATE AND MULT/DIV
     C** INDICATOR DETERMINED BY #P13
     C**
     C                     Z-ADDWWSPOT    ZRATEF
     C                     MOVELWWMDIN    ZMDINF
     C**
     C** DETERMINE EXCHANGE RATE FOR THE 'TO' CURRENCY
     C** THE DATE IS AS ABOVE
     C**
     C                     MOVELWWCCYT    WWCCYH
     C**
     C                     EXSR #P13
     C**
     C** SET ZRATET AND ZMDINT EQUAL TO THE SPOT RATE AND MULT/DIV
     C** INDICATOR DETERMINED BY #P13
     C**
     C                     Z-ADDWWSPOT    ZRATET
     C                     MOVELWWMDIN    ZMDINT
     C**
     C** SET ZCDPF EQUAL TO THE NOMINAL CURRENCY DECIMAL
     C***PLACES*FROM*PF/SDCURRL0******************************************S01486
     C** PLACES FROM PF/SDCURRPD                                          S01486
     C**
     C                     Z-ADDWWNCDP    ZCDPF
     C**
     C** SET ZCDPT EQUAL TO THE 'TO' PORTFOLIO CURRENCY
     C** DECIMAL PLACES
     C**
     C                     Z-ADDWWDCPT    ZCDPT
     C**
     C                     EXSR ZCCYCN
     C**                                                                  R10049
     C** SAVE FX RATE AND M/D INDICATOR FOR THE 'TO' CURRENCY             R10049
     C** FOR OUTPUT TO PF/DPTMVD                                          R10049
     C                     Z-ADDZCRSRT    SPXR                            R10049
     C                     MOVELZCRSMD    SPMD                            R10049
     C**
     C                     ENDSR                           **#P12 END  **
      ********************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #P13     - TO DETERMINE SPOT RATE, MULTIPLY/DIVIDE INDICATOR           *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #P10     - TO CONVERT FX AP NUMERATOR ON PORTFOLIO POSITIONS           *
      * #P11     - TO DETERMINE TRADE VALUE IN PORTFOLIO CURRENCY              *
      * #P12     - TO DETERMINE DEPOT MOVEMENT VALUE IN PORTFOLIO CURRENCY     *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWCCYH   - CURRENCY KEY                                                *
      * WWSPOT   - WORK FIELD SPOT RATE                                        *
      * WWMDIN   - WORK FIELD MULTIPLY/DIVIDE INDICATOR                        *
      *                                                                        *
      **************************************************************************
     C           #P13      BEGSR                           **#P13 BEGIN**
     C**
     C***********PMHSEX    SETGTPMHSEXPP                                  S01486
     C           PMHSEX    SETGTPMHSEXPD                                  S01486
     C**
     C***READ*PREVIOUS*ON*PF/PMHSEXPP*************************************S01486
     C** READ PREVIOUS ON PF/PMHSEXPD                                     S01486
     C**
     C***********          READPPMHSEXPP                 75               S01486
     C                     READPPMHSEXPD                 75               S01486
     C**
     C           *IN75     IFEQ '0'
     C           WWCCYH    ANDEQQ8CCY
     C**
     C***SET*SPOT*RATE*EQUAL*TO*SPOT*RATE*FROM*PF/PMHSEXPP****************S01486
     C***&*MUL/DIV*INDICATOR*EQUAL*TO*MULT/DIV*INDICATOR*FROM*PF/PMHSEXPP*S01486
     C** SET SPOT RATE EQUAL TO SPOT RATE FROM PF/PMHSEXPD                S01486
     C** & MUL/DIV INDICATOR EQUAL TO MULT/DIV INDICATOR FROM PF/PMHSEXPD S01486
     C**
     C                     Z-ADDQ8SPOT    WWSPOT
     C                     MOVE Q8MDV1    WWMDIN
     C**
     C** OTHERWISE IF RECORD NOT FOUND GET NEXT AVAILABLE RATE
     C**
     C                     ELSE
     C***********PMHSEX    SETLLPMHSEXPP                                  S01486
     C           PMHSEX    SETLLPMHSEXPD                                  S01486
     C**
     C***READ*FROM*PF/PMHSEXPP********************************************S01486
     C** READ FROM PF/PMHSEXPD                                            S01486
     C**
     C***********          READ PMHSEXPP                 75               S01486
     C                     READ PMHSEXPD                 75               S01486
     C**
     C           *IN75     IFEQ '0'
     C           WWCCYH    ANDEQQ8CCY
     C**
     C***SET*SPOT*RATE*EQUAL*TO*SPOT*RATE*FROM*PF/PMHSEXPP****************S01486
     C***&*MUL/DIV*INDICATOR*EQUAL*TO*MULT/DIV*INDICATOR*FROM*PF/PMHSEXPD*S01486
     C** SET SPOT RATE EQUAL TO SPOT RATE FROM PF/PMHSEXPD                S01486
     C** & MUL/DIV INDICATOR EQUAL TO MULT/DIV INDICATOR FROM PF/PMHSEXPP S01486
     C**
     C                     Z-ADDQ8SPOT    WWSPOT
     C                     MOVE Q8MDV1    WWMDIN
     C**
     C** OTHERWISE IF RECORD NOT FOUND ACCESS SDCURRL0
     C**
     C                     ELSE
     C**
     C***********WWCCYH    CHAINSDCURRL0             76                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM '*MSG   ' @RTCD   7                       S01486
     C                     PARM '*KEY  '  @OPTN   7                       S01486
     C                     PARM WWCCYH    @AJCD   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C************IN76     IFEQ '1'                        ***************S01486
     C           @RTCD     IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD18        DBASE            **DB ERROR 18**
     C                     MOVEL'SDCURRL0'DBFILE           ***************
     C                     MOVELWWCCYH    DBKEY
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C***SET*SPOT*RATE*EQUAL*TO*SPOT*RATE*FROM*SDCURRL0*******************S01486
     C** SET SPOT RATE EQUAL TO SPOT RATE FROM SDCURRPD                   S01486
     C** AND MULT/DIV INDICATOR EQUAL TO MULT/DIV
     C***INDICATOR*FROM*SDCURRL0******************************************S01486
     C** INDICATOR FROM SDCURRPD                                          S01486
     C**
     C                     Z-ADDA6SPRT    WWSPOT
     C                     MOVELA6MDIN    WWMDIN
     C**
     C                     END
     C**
     C                     END
     C**
     C                     ENDSR                           **#P13 END  **
      ********************************************************************CPM004
      /EJECT                                                              CPM004
      ******************************************************************* CPM004
      *                                                                 * CPM004
      * SRBOOK   - Access Book Code for New Portfolio Reference         * CPM004
      *                                                                 * CPM004
      * SUBROUTINE CALLS:                                               * CPM004
      * AOPLCSR1 - Portfolio Management Customer Details Access Object  * CPM004
      *                                                                 * CPM004
      * SUBROUTINE CALLED FROM:                                         * CPM004
      * #P07     - To Transfer DL Deals                                 * CPM004
      * #P08     - To Transfer LE Loans                                 * CPM004
      *                                                                 * CPM004
      ******************************************************************* CPM004
     C*                                                                   CPM004
     C           SRBOOK    BEGSR                                          CPM004
     C*                                                                   CPM004
     C                     MOVEL'B'       I#PORS                          CPM004
     C                     MOVELFCR997    I#R997                          CPM004
     C                     MOVEL*BLANKS   I#CUST                          CPM004
     C                     MOVELBRCA      I#BRCA                          CPM004
     C                     MOVEL*BLANKS   I#BOOK                          CPM004
     C                     MOVELPTFR      I#PTFR                          CPM004
     C                     MOVEL*BLANKS   I#CPGM                          CPM004
     C*                                                                   CPM004
     C                     CALL 'AOPLCSR1'                                CPM004
     C                     PARM *BLANKS   P@RTCD  7        B:Return code  CPM004
     C                     PARM '*KEY   ' P@OPTN  7        I:Option       CPM004
     C                     PARM           I@PARM           I:Parameters   CPM004
     C                     PARM *BLANKS   O@PARM           O:Parameters   CPM004
     C           SDPLCS    PARM SDPLCS    DSFDY            O:Format       CPM004
     C*                                                                   CPM004
     C           P@RTCD    IFNE *BLANKS                                   CPM004
     C*                                                                   CPM004
     C           *LOCK     IN   LDA                                       CPM004
     C                     SELEC                                          CPM004
     C           P@RTCD    WHEQ 'PMA0007'                                 CPM004
     C                     MOVEL'SDBRCHPD'DBFILE                          CPM004
     C                     MOVELBRCA      DBKEY     P                     CPM004
     C           P@RTCD    WHEQ 'PMA0008'                                 CPM004
     C                     MOVEL'SDPLCSPD'DBFILE                          CPM004
     C                     MOVELBRCA      DBKEY     P                     CPM004
     C           P@RTCD    WHEQ 'PMA0010'                                 CPM004
     C                     MOVEL'SDBOOKPD'DBFILE                          CPM004
     C                     MOVELPTFR      DBKEY     P                     CPM004
     C                     ENDSL                           ***************CPM004
     C                     Z-ADD26        DBASE            * DB ERROR 26 *CPM004
     C                     OUT  LDA                        ***************CPM004
     C                     EXSR *PSSR                                     CPM004
     C                     END                                            CPM004
     C*                                                                   CPM004
     C                     ENDSR                                          CPM004
     C*                                                                   CPM004
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM1020CCP2                                           S01408
     C*                                                                   S01408
      **************************************************************************
      ***/EJECT***                                                        S01486
      ********************************************************************S01486
      ************                                                        S01486
      **#P14*****-*TO*TRANSFER*FI*LOANS***********************************S01486
      ************                                                        S01486
      **SUBROUTINE*CALLS:*************************************************S01486
      ***PSSR****-*TO*PROCESS*DATA*BASE*ERRORS****************************S01486
      ************                                                        S01486
      **SUBROUTINE*CALLED*FROM:*******************************************S01486
      **MAIN*****-*MAIN*PROCESSSING***************************************S01486
      ************                                                        S01486
      **ROUTINE*USES*VARIABLES:*******************************************S01486
      ************                                                        S01486
      ********************************************************************S01486
     C***********#P14      BEGSR                           **#P14 BEGIN** S01486
     C***********                                                         S01486
     C***ACCESS*FILOANL0*USING*TRANSACTION*NUMBER*FROM*PMTPTMLL***********S01486
     C***********                                                         S01486
     C***********P8TRNB    CHAINFILOANL0             75                   S01486
     C***********                                                         S01486
     C************IN75     IFEQ '1'                                       S01486
     C***DATA*BASE*ERROR**************************************************S01486
     C***********          Z-ADD19        DBASE            **DB ERROR 19**S01486
     C***********          MOVEL'FILOANL0'DBFILE           ***************S01486
     C***********          MOVELP8TRNB    DBKEY                           S01486
     C***********          EXSR *PSSR                                     S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C****       FLDLTF    IFEQ *BLANK                                    B08108
     C***********          MOVELP8TPTF    FLPTFR                          S01486
     C***********          EXCPTFILOAU                                    S01486
     C****                 END                                            B08108
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
      ********************************************************************S01486
      ***/EJECT***                                                        S01486
      ********************************************************************S01486
      ***********                                                         S01486
      **#P15*****-*TO*TRANSFER*FI*DEPOSITS********************************S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLS:*************************************************S01486
      ***PSSR****-*TO*PROCESS*DATA*BASE*ERRORS****************************S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLED*FROM:*******************************************S01486
      **MAIN*****-*MAIN*PROCESSSING***************************************S01486
      ***********                                                         S01486
      **ROUTINE*USES*VARIABLES:*******************************************S01486
      ***********                                                         S01486
      ********************************************************************S01486
     C***********#P15      BEGSR                           **#P15 BEGIN** S01486
     C***********                                                         S01486
     C***ACCESS*FIDEPOL0*USING*TRANSACTION*NUMBER*FROM*PMTPTMLL***********S01486
     C***********                                                         S01486
     C***********P8TRNB    CHAINFIDEPOL0             75                   S01486
     C***********                                                         S01486
     C************IN75     IFEQ '1'                                       S01486
     C***DATA*BASE*ERROR**************************************************S01486
     C***********          Z-ADD20        DBASE            **DB ERROR 20**S01486
     C***********          MOVEL'FILOANL0'DBFILE           ***************S01486
     C***********          MOVELP8TRNB    DBKEY                           S01486
     C***********          EXSR *PSSR                                     S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C****       FDDLTF    IFEQ *BLANK                                    B08108
     C***********                                                   R01167S01486
     C***IF*'FROM'*PORTFOLIO*CURRENCY*NOT*EQUAL*TO*'TO'*PORTFOLIO***R01167S01486
     C***CURRENCY*CALCULATE*NEW*FX*RATE*FOR*TO*PORTFOLIO*CURRENCY***R01167S01486
     C***********WWCCYF    IFNE WWCCYT                              R01167S01486
     C***********          MOVE FDCCY     ZCCYF                     R01167S01486
     C***********          MOVE WWCCYT    ZCCYT                     R01167S01486
     C***********          Z-ADDFDDDAT    ZSDATE                    R01167S01486
     C***********          EXSR ZBAKRT                              R01167S01486
     C***********                                                   R01167S01486
     C***********ZERROR    IFEQ 'Y'                  ***************R01167S01486
     C***********          Z-ADD11        DBASE      * DB ERROR 11 *R01167S01486
     C***********          MOVEL'ZBAKRT  'DBFILE     ***************R01167S01486
     C***********          EXSR *PSSR                               R01167S01486
     C***********          END                                      R01167S01486
     C***********                                                   R01167S01486
     C***********          Z-ADDZCRSRT    FDFXRD                    R01167S01486
     C***********          END                                      R01167S01486
     C***********                                                   R01167S01486
     C***********          MOVELP8TPTF    FDPTFR                          S01486
     C***********          EXCPTFIDEPU                                    S01486
     C****                 END                                            B08108
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C********************************************************************S01486
      /EJECT
     C*************************************************************************
     C*                                                                       *
     C*  ZFXAVP - CALCULATE AVERAGE FX RATE                                   *
     C*                                                                       *
     C*  PURPOSE : TO CALCULATE AN AVERAGE FX RATE (VALUE OF HOLDING IN       *
     C*            PORTFOLIO CURRENCY DIVIDED BY VALUE IN NOMINAL CURRENCY)   *
     C*                                                                       *
     C*  INPUT  FIELDS                                                        *
     C*       ZAPNM  15 0     AVERAGE PRICE NUMERATOR                         *
     C*       ZFXAP  15 0     FX AVERAGE PRICE NUMERATOR                      *
     C*       ZNMCD   1 0     NOMINAL CURRENCY DECIMAL PLACES (0-3)           *
     C*       ZPTCD   1 0     PORTFOLIO CURRENCY DECIMAL PLACES (0-3)         *
     C*                                                                       *
     C*  OUTPUT  FIELDS                                                       *
     C*       ZAVFX  13 8     AVERAGE FX RATE                                 *
     C*                                                                       *
     C*  ALSO REQUIRED                                                        *
     C*       POWER8 ARRAY    ARRAY FOR CURRENCY CONVERSIONS                  *
     C*                                                                       *
     C*  WORK FIELDS:                                                          *
     C*       ZI      1 0     INDEX TO POWER ARRAY                            *
     C*                                                                        *
     C*  CALLED FROM:                                                          *
     C*                                                                       *
     C*************************************************************************
     C********   ZFXAVP    BEGSR                           *** ZFXAVP **  49213
     C********                                                            49213
     C********E ALL FIELDS                                                49213
     C********                                                            49213
     C********             Z-ADDZAPNM     ZAPNM  150                      49213
     C********             Z-ADDZFXAP     ZFXAP  150                      49213
     C********             Z-ADDZNMCD     ZNMCD   10                      49213
     C********             Z-ADDZPTCD     ZPTCD   10                      49213
     C********             Z-ADDZAVFX     ZAVFX  138                      49213
     C********                                                            49213
     C******** NUMERATOR = 0   END PROCESS                                49213
     C********   ZAPNM     IFEQ 0                                         49213
     C********             Z-ADD0         ZAVFX                           49213
     C********                                                            49213
     C******** NUMERATOR NOT = ZEROS                                      49213
     C********             ELSE                                           49213
     C********                                                            49213
     C********E FX AP NUMERATOR BY AP NUMERATOR                           49213
     C********   ZFXAP     DIV  ZAPNM     ZAVFX     H                     49213
     C*
     C** SET POWER8 INDEX TO 5 - NBR NOM CCY DEC. PLACES + NBR PORT CCY DEC. PL.
     C********   5         SUB  ZNMCD     ZI      10                      49213
     C********             ADD  ZPTCD     ZI                              49213
     C*
     C** DIVIDE AVERAGE PRICE BY POWER
     C********   ZAVFX     DIV  POWER8,ZI ZAVFX     H                     49213
     C*
     C** SET AVERAGE PRICE POSITIVE
     C********   ZAVFX     IFLE 0                                         49213
     C********             Z-SUBZAVFX     ZAVFX                           49213
     C********             END                                            49213
     C*
     C** END CONDITION NOMINAL = ZERO
     C********             END                                            49213
     C*
     C********   ZXAVP9    ENDSR                                          49213
      **************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * #PAA     - TO INITIALIZE WRK FIELDS AND ACCESS ST. DATA                *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     -                                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWPOLC   - COUNTER                                                     *
      * WWTRFG   - COUNTER                                                     *
      *                                                                        *
      **************************************************************************
     C           #PAA      BEGSR
     C**
     C**
     C** PREPARE LDA
     C**
     C           *NAMVAR   DEFN           LDA                             S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVEL*BLANKS   DBLOT
     C                     MOVEL'PM1020'  DBPGM
     C                     OUT  LDA                                       S01486
     C**
     C** INITIALIZE WORK FIELDS
     C**
     C                     Z-ADD0         WWDPOT 150
     C                     Z-ADD0         WWSPOT 138
     C                     Z-ADD0         WWTRFG  50
     C                     Z-ADD0         RRTRFG  50
     C                     Z-ADD0         WWPDAT  50
     C                     MOVEL*BLANK    WWMDIN  1
     C                     MOVEL*BLANKS   WWCCYF  3
     C                     MOVEL*BLANKS   WWCCYT  3
     C                     Z-ADD0         WWDCPF  10
     C                     Z-ADD0         WWDCPT  10
     C**
     C** ACCESS BANK DETAILS
     C**
     C***********          READ SDBANKL1                 71               S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*MSG   ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C**
     C************IN71     IFEQ '1'                                       S01486
     C**
     C** RECORD NOT FOUND
     C**                                                   ***************
     C           @RTCD     IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD1         DBASE            **DB ERROR 01**
     C***********          MOVEL'SDBANKL1'DBPGM            ***************S01486
     C                     MOVEL'SDBANKPD'DBFILE           ***************S01486
     C                     MOVEL@OPTN     DBKEY                           S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C**
     C** RECORD FOUND -  LOAD RUN DATE
     C**
     C                     MOVELBJMRDT    RRRUNA
     C**
     C** ACCESS MIDAS MODULES
     C**
     C***********          READ SDMMODPD                 72               S01486
     C                     CALL 'AOMMODR0'                                S01486
     C                     PARM '*MSG   ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01486
     C**
     C************IN72     IFEQ '1'                        ***************S01486
     C           @RTCD     IFNE *BLANKS                    ************** S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD2         DBASE            **DB ERROR 2**
     C                     MOVEL'SDMMODPD'DBFILE           **************
     C                     MOVEL@OPTN     DBKEY                           S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C*                                                                   CPM004
     C** Access Portfolio Management ICD Details                          CPM004
     C*                                                                   CPM004
     C                     CALL 'AOPORTR0'                                CPM004
     C                     PARM '*MSG   ' @RTCD   7                       CPM004
     C                     PARM '*FIRST ' @OPTN   7                       CPM004
     C           SDPORT    PARM SDPORT    DSFDY                           CPM004
     C**                                                                  CPM004
     C           @RTCD     IFNE *BLANKS                                   CPM004
     C           *LOCK     IN   LDA                        ************** CPM004
     C                     Z-ADD25        DBASE            * DB ERROR 25* CPM004
     C                     MOVEL'SDMMODPD'DBFILE           ************** CPM004
     C                     MOVEL@OPTN     DBKEY                           CPM004
     C                     OUT  LDA                                       CPM004
     C                     EXSR *PSSR                                     CPM004
     C                     END                                            CPM004
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C                     MOVEL*ON       *IN50                           CPM004
     C                     ENDIF                                          CPM004
     C*                                                                   CPM004
     C**
     C** ACCESS SE ICD IF SECURITIES TRADING IS PRESENT
     C**
     C           BGSECS    IFEQ 'Y'
     C***********          READ TABTB36F                 72               S01486
     C                     CALL 'AOSTRDR0'                                S01486
     C                     PARM '*MSG   ' @RTCD   7                       S01486
     C                     PARM '*FIRST ' @OPTN   7                       S01486
     C           SDSTRD    PARM SDSTRD    DSFDY                           S01486
     C**
     C************IN72     IFEQ '1'                                       S01486
     C**
     C** RECORD NOT FOUND
     C**                                                   ***************
     C           @RTCD     IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD3         DBASE            **DB ERROR 03**
     C***********          MOVEL'TABTB36 'DBPGM            ***************S01486
     C                     MOVEL'SDSTRDPD'DBFILE           ***************S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,PM1020CCP3                                           S01408
     C*                                                                   S01408
     C                     ENDSR
     C********************************************************************R01167
     C*                                                                   R01167
     C*  ZBAKRT SR. TO DETERMINE THE FX RATE BETWEEN TWO CURRENCIES       R01167
     C*  ON A DATE IN THE PAST. THE RATE RETURNED IS ALWAYS A MULTIPLY    R01167
     C*  RATE BETWEEN THE FROM CURRENCY AND THE TO CURRENCY.              R01167
     C*                                                                   R01167
     C*  INPUT  FIELDS                                                    R01167
     C*       ZCCYF   3A     FROM CURRENCY                                R01167
     C*       ZCCYT   3A     TO CURRENCY                                  R01167
     C*       ZSDATE  50     PAST DATE                                    R01167
     C*                                                                   R01167
     C*  OUTPUT  FIELDS                                                   R01167
     C*       ZCRSRT 138     PAST FX RATE BETWEEN FROM AND TO CURRENCIES  R01167
     C*       ZERROR  1A     DATABASE ERROR IN SUBROUTINE                 R01167
     C*                                                                   R01167
     C*  INPUT  FILE                                                      R01167
     C********LF/PMHSEXPP    HISTORIC FX RATES                      R01167S01486
     C*       PF/PMHSEXPD    HISTORIC FX RATES                            S01486
     C*                                                                   R01167
     C*                                                                   R01167
     C*  CALLS:                                                           R01167
     C*       ZCCYCN                                                      R01167
     C*                                                                   R01167
     C*  CALLED BY:                                                       R01167
     C*                                                                   R01167
     C********************************************************************R01167
     C           ZBAKRT    BEGSR                           *** ZBAKRT *** R01167
     C*                                                                   R01167
     C** DEFINE ALL FIELDS                                                R01167
     C                     MOVE ZCCYF     ZCCYF   3                       R01167
     C                     MOVE ZCCYT     ZCCYT   3                       R01167
     C                     Z-ADDZSDATE    ZSDATE  50                      R01167
     C                     Z-ADDZCRSRT    ZCRSRT 138                      R01167
     C                     MOVE 'N'       ZERROR  1                       R01167
     C*                                                                   R01167
     C           ZWKEY     KLIST                                          R01167
     C                     KFLD           ZWCCY   3                       R01167
     C                     KFLD           ZWDATE  50                      R01167
     C*                                                                   R01167
     C** GET PAST RATE FOR 'FROM' CURRENCY                                R01167
     C                     MOVE ZCCYF     ZWCCY                           R01167
     C                     Z-ADDZSDATE    ZWDATE                          R01167
     C***********ZWKEY     SETGTPMHSEXPP                            R01167S01486
     C***********          READPPMHSEXPP                 90         R01167S01486
     C           ZWKEY     SETGTPMHSEXPD                                  S01486
     C                     READPPMHSEXPD                 90               S01486
     C*                                                                   R01167
     C           *IN90     IFEQ '1'                                       R01167
     C           Q8CCY     ORNE ZCCYF                                     R01167
     C                     MOVE *LOVAL    ZWDATE                          R01167
     C***********ZWKEY     SETLLPMHSEXPP                           R01167 S01486
     C***********          READ PMHSEXPP                 90        R01167 S01486
     C           ZWKEY     SETLLPMHSEXPD                                  S01486
     C                     READ PMHSEXPD                 90               S01486
     C           *IN90     IFEQ '1'                                       R01167
     C           Q8CCY     ORNE ZCCYF                                     R01167
     C                     MOVE 'Y'       ZERROR                          R01167
     C                     END                                            R01167
     C                     END                                            R01167
     C*                                                                   R01167
     C                     Z-ADD1         ZAMTF                           R01167
     C                     Z-ADDQ8SPOT    ZRATEF                          R01167
     C                     MOVE Q8MDV1    ZMDINF                          R01167
     C                     Z-ADDQ8CDP     ZCDPF                           R01167
     C*                                                                   R01167
     C** GET PAST RATE FOR 'TO' CURRENCY                                  R01167
     C                     MOVE ZCCYT     ZWCCY                           R01167
     C                     Z-ADDZSDATE    ZWDATE                          R01167
     C***********ZWKEY     SETGTPMHSEXPP                                  S01486
     C***********          READPPMHSEXPP                 90               S01486
     C           ZWKEY     SETGTPMHSEXPD                                  S01486
     C                     READPPMHSEXPD                 90               S01486
     C*                                                                   R01167
     C           *IN90     IFEQ '1'                                       R01167
     C           Q8CCY     ORNE ZCCYT                                     R01167
     C                     MOVE *LOVAL    ZWDATE                          R01167
     C***********ZWKEY     SETLLPMHSEXPP                                  S01486
     C***********          READ PMHSEXPP                 90               S01486
     C           ZWKEY     SETLLPMHSEXPD                                  S01486
     C                     READ PMHSEXPD                 90               S01486
     C           *IN90     IFEQ '1'                                       R01167
     C           Q8CCY     ORNE ZCCYT                                     R01167
     C                     MOVE 'Y'       ZERROR                          R01167
     C                     END                                            R01167
     C                     END                                            R01167
     C*                                                                   R01167
     C                     Z-ADDQ8SPOT    ZRATET                          R01167
     C                     MOVE Q8MDV1    ZMDINT                          R01167
     C                     Z-ADDQ8CDP     ZCDPT                           R01167
     C*                                                                   R01167
     C** CALCULATE CROSS RATE                                             R01167
     C                     EXSR ZCCYCN                                    R01167
     C*                                                                   R01167
     C           ZCRSMD    IFEQ 'D'                                       R01167
     C           1         DIV  ZCRSRT    ZCRSRT                          R01167
     C                     END                                            R01167
     C*                                                                   R01167
     C           BAKEND    ENDSR                                          R01167
     C********************************************************************R01167
      /EJECT
      /COPY ZSRSRC,ZCCYCN
      /COPY ZSRSRC,ZCCYXR                                                 49213
      /COPY ZSRSRC,ZFXAVP                                                 49213
      ****/EJECT                                                          47719
      ****/COPY ZSRSRC,ZCCYXR                                             47719
      **************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                                 *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * #PAA     - TO INITIALIZE WRK FIELDS AND ACCESS ST. DATA                *
      * #P04     - TO TRANSFER SE TRADES                                       *
      * #P05     - TO TRANSFER SE DEPOT MOVEMENTS                              *
      **#P06*****-*TO*TRANSFER*FF*TRANSACTIONS****************************S01486
      * #P07     - TO TRANSFER DL DEALS                                        *
      * #P08     - TO TRANSFER LE LOANS                                        *
      * #P09     - TO TRANSFER RE ACCOUNTS                                     *
      * #P11     - TO DETERMINE TRADE VALUE IN PORTFOLIO CURRENCY              *
      * #P13     - TO DETERMINE SPOT RATE, MULTIPLY/DIVIDE INDICATOR           *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           *PSSR     BEGSR
     C*
     C           WWERRO    IFEQ ' '
     C                     MOVE 'Y'       WWERRO  1
     C*
     C           DBASE     IFNE 0
     C*
     C**  PRINT ERROR MESSAGE:
     C                     WRITEERRORAU
     C                     ELSE
     C                     Z-ADD999       DBASE
     C                     END
     C*
     C                     DUMP
     C                     END
     C*
     C                     MOVE '1'       *INLR
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     RETRN
     C*
     C                     ENDSR
     C**
     C********************************************************************
     O**
     O** 'TO' HISTORIC POSITION                                           056555
     O**                                                                  056555
     O***PMHPOSPXE                PMHPTU                                  056555
     O***                         QXNOML                                  056555
     O***                         QXCSEX                                  056555
     O***                         QXAPNM                                  056555
     O***                         QXFXAP                                  056555
     O***                         QXPILP                                  056555
     O**                                                                  056555
     O** 'FROM' HISTORIC POSITION                                         056555
     O**                                                                  056555
     O***PMHPOSP0E                PMHPFU                                  056555
     O***                      QAFXAP                                     056555
     O***                      QAPTFR                                     056555
     O***                      QAPTCY                                     056555
     O***                      QAPCDP                                     056555
     O**                                                                  056555
     O** CURRENT POSITION
     O**
     OPMCPOSP0E                PMCPOU
     O                         QCRECI
     O                         QCBVLD
     O                         QCAPBC                                     041644
     O**
     O** TRADES
     O**
     OTRADSDF E                TRADSU
     O                         PTFR
     O                         SPXR
     O                         SPMD
     O**
     O** DEPOT MOVEMENTS
     O**
     ODPTMVDF E                DPTMVU
     O                         PTFR
     O                         SPXR                                       R10049
     O                         SPMD                                       R10049
     O**
     O** CUSTOMER AVERAGE PRICE ACTIONS
     O**
     OCAPRHDF E                CAPRHU
     O                         PTFR
     O                         CFAP
     O                         CFXR
     O***********                                                         S01486
     O***F&O*TRANSACTIONS*************************************************S01486
     O***********                                                         S01486
     O***TRANSDF*E***             TRANSU                                  S01486
     O***********              PTFR                                       S01486
     O**                                                                  S71062
     O** F&O TRANSACTIONS                                                 S71062
     O**                                                                  S71062
     OTRANSDF E                TRANSU                                     S71062
     O                         PTFR                                       S71062
     O**
     O** DEALS
     O**
     ODEALSDBFE                DEALBU
     O                    50   BOKC                                       CPM004
     O                         PTFR
     ODEALSDCFE                DEALCU
     O                    50   BOKC                                       CPM004
     O                         PTFR
     O                         FXRD                                       R01167
     O***DEALSDGFE***             DEALGU                                  S01486
     O************************ PTFR                                       058933
     O**                                                                  B08275
     O** DEALS                                                            B08275
     O**                                                                  B08275
     ODEALDBF E                DEALBF                                     B08275
     O                    50   BOKC                                       CPM004
     O                         PTFR                                       B08275
     ODEALDCF E                DEALCF                                     B08275
     O                    50   BOKC                                       CPM004
     O                         PTFR                                       B08275
     O                         FXRD                                       B08275
     O***DEALDGF*E***             DEALGF                            B08275S01486
     O************************ PTFR                                       058933
     OFXDEALP0E                FXDEAL                                     39590
     O                    50   FHBOKC                                     CPM004
     O                         FHPTFR                                     39590
     OMMDELDP0E                MMDEAL                                     39590
     O                    50   HKBOKC                                     CPM004
     O                         HKPTFR                                     39590
     O**
     O** LE LOANS
     O**
     OCLOANCLFE                CLOANU
     O                    50   BOKC                                       CPM004
     O                         PTFR
     O**
     O** ACCOUNTS
     O**
     OACCNTABFE                ACCNTU
     O                         PTFR
     O***********                                                         S01486
     O***FID*DEPOSITS*****************************************************S01486
     O***********                                                         S01486
     O***FIDEPOD0E***             FIDEPU                                  S01486
     O***********              FDPTFR                                     S01486
     O***********              FDFXRD                               R01167S01486
     O*                                                                   S01408
     O/COPY WNCPYSRC,PM1020OOP1                                           S01408
     O*                                                                   S01408
     O***********                                                         S01486
     O***FID*LOANS********************************************************S01486
     O***********                                                         S01486
     O***FILOAND0E***             FILOAU                                  S01486
     O***********              FLPTFR                                     S01486
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**  POWER8 - ARRAY OF POWERS FOR CURRENCY CONVERSION
00000001
00000010
00000100
00001000
00010000
00100000
01000000
10000000
**  CPY@
(c) Finastra International Limited 2001
