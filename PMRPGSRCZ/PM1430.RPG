     H***********                                                         S01486
     H        1                                                           S01486
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM LE events extract')                           *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management                                 *
     F*                                                               *
     F*  PM1430  - PM LE EVENTS EXTRACT                               *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD055652           Date 13Jul20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE154             Date 06Aug12               *
      *                 AR1092885          Date 11Mar13               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 CER059             Date 19Jul10               *
      *                 CER047             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 220564             Date 01Aug03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CPB001             Date 21Feb00               *
      *                 154343             Date 01Feb99               *
     F*                 163486             Date 14Oct99               *
     F* Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 134975             Date 11May98               *
     F*                 CEU003             Date 02MAY98               *
     F*                 124660             DATE 27OCT97               *
     F*                 CPM004             DATE 26FEB96               *
     F*                 093136             DATE 14SEP95               *
     F*                 S01486             DATE 08AUG94               *
     F*                 47719              DATE 24NOV92               *
     F*                 37027      ADE     DATE 12MAR92               *
     F*                 35671      SL      DATE 11MAR92               *
     F*                 B10097     DT      DATE 12NOV91               *
     F*                 B08268             DATE 14NOV91               *
     F*                 B08040             DATE 14NOV91               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD055652 - Dbase error occurs when generating MR event code  *
      *             for discount loan. Add event keys for principal   *
      *             repayment of discount loan in event codes array.  *
      *             Pattern after fix MD047582A.                      *
      *           - RECI value becomes 'D' in LVNTXZZ file. Rename    *
      *             RECI in LVNTXZZ so its current value of 'T' does  *
      *             not get overridden from record value in PMLVNTL0  *
      *             during trailer update.                            *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE154 - Loan Repayment Schedule Enhancement (Recompile)     *
      *  AR1092885 - PMC1400 seq 00002 failed during GN EN D0 COB     *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER047 - German Features LF037-00 Reporting §24c             *
      *           (Recompile)                                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  220564 - Event Codes for CLE028 are missing.                 *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *           Recompile                                           *
     F*  CPB001 -  'Private Banking' Module                           *
     F*  154343 - New event type for EMU processing.                  *
     F*  163486 - Recompile due to changes in LVENTEL.                *
     F*  134975 - Event 62A1 was wrongly coded as 61A1 in array ARA.  *
     F*  CEU003 - New event types for EMU processing.                 *
     F*  124660 - Some event codes are missing                        *
     F*           (Originally wrongly annotated as 124460)            *
     F*  CPM004 - Bank Portfolios                                     *
     F*  093136 - Missing event types                                 *
     F*  S01486 - Private Banking upgrade to Release 10               *
     F*  47719  - CORRECT CONVERSION OF AMOUNTS BETWEEN CURRENCIES    *
     F*  37027  - EVENT TYPE 70M2 MISSING IN ARA                      *
     F*         - ADD ALL POSSIBLE EVENT TYPE IN ARA                  *
     F*  35671  - ALL MATURITY EVENTS MUST BE GENERATED               *
     F*  B10097 - ADD EVENT TYPE 70I2 IN ARRAY ARA TO PREVENT A       *
     F*           DATABASE ERROR                                      *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F***PMLVNT**UF**E                    DISK                            S01486
     FPMLVNTL0UF  E                    DISK                               S01486
     F                                              KINFSR *PSSR
     F***SDLOANL1IF**E           K        DISK                            S01486
     F**FILE*PREFIX*'AY'**************************************************S01486
     F***********                                   KINFSR *PSSR          S01486
     F***SDPLCSL0IF**E           K        DISK                            S01486
     F**FILE*PREFIX*'BB'*&*'QB'*******************************************S01486
     F***********                                   KINFSR *PSSR          S01486
     F***PMPORTPPIF**E           K        DISK                            S01486
     FPMPORTPDIF  E           K        DISK                               S01486
     F* FILE PREFIX 'PN'
     F                                              KINFSR *PSSR
     F***SDBANKL1IF  E           K        DISK                            S01486
     F**FILE*PREFIX*'BJ'**************************************************S01486
     F***********                                   KINFSR *PSSR          S01486
     F*DGELRL0IF**E           K        DISK                               B08268
     F****LE PREFIX 'BK'                                                  B08268
     F****                                          KINFSR *PSSR          B08268
     FCLOAN   IF  E           K        DISK
     F                                              KINFSR *PSSR
     F***SDCURRL0IF**E           K        DISK                            S01486
     F**FILE*PREFIX*'A6'**************************************************S01486
     F***********                                   KINFSR *PSSR          S01486
     FLVNTXZZ UF  E                    DISK
     F                                              KINFSR *PSSR
     F***PMEVNTPPO***E                    DISK                            S01486
     FPMEVNTPDO   E                    DISK                               S01486
     F* FILE PREFIX 'Q9'
     F                                              KINFSR *PSSR
     FPM1430AUO   E                    PRINTER
      /EJECT
      *
      *   INDICATOR USAGE
      *   ---------------
      *
      ****71******ACCESS*SDBANKL1*****************************************S01486
      *   72      ACCESS SDCURRL0
      *   73      ACCESS LVNTXZZ
      ****74******ACCESS*SDPLCSL0*****************************************S01486
      ****75******ACCESS*PMPORTPP*****************************************S01486
      *   75      ACCESS PMPORTPD                                         S01486
      ****76******ACCESS*SDLOANL1*****************************************S01486
      *   77      ACCESS CLOAN
      *   78      CHECK LOKUP ON ARA
      ****89******END*OF*FILE*FOR*PMLVNT**********************************S01486
      *   89      END OF FILE FOR PMLVNTL0                                S01486
      *   98      DATE FORMAT
      *
      /EJECT
      *
      /COPY ZSRSRC,ZDATE2Z1
      *
      ** ARRAY FOR FORMATTING DL DETAILS FOR OUTPUT SR/ZFDLLN
     E                    ZLI        20  1
      *
      ** ARRAYS USE TO CONVERT EVENT TYPE IN EVENT NARRATIVE
     E*                   ARA     1  25  4   ARB    20                    B10097
     E******************* ARA     1  26  4   ARB    20             B10097 37027
     E***********         ARA     1  45  4   ARB    20               37027093136
     E***********         ARA     1  65  4   ARB    20             093136 124660
     E***********         ARA     1  95  4   ARB    20              124660CEU003
     E***********         ARA     1 135  4   ARB    20             CEU003 154343
     E**********          ARA     1 136  4   ARB    20                                 154343 220564
     E**********          ARA     1 144  4   ARB    20                              220564 AR1092885
     E**********          ARA     1 181  4   ARB    20                            AR1092885 MD055652
     E                    ARA     1 184  4   ARB    20                                      MD055652
     E*                                                                   B08268
     E** TABLES/ARRAYS USED TO AVOID FILE ACCESS OPERATIONS               B08268
     E                    CYCD      200  3                                B08268
     E                    SPRT      200 13 8                              B08268
     E                    NBDP      200  1 0                              B08268
     E                    MDIN      200  1                                B08268
      /COPY ZSRSRC,ZPOWERZ1
     E                    CPY@    1   1 80
      /EJECT
     ICLOANCKF                                                            124660
      ** Rename fields                                                    124660
     I              NLRA                            NLRAK                 124660
      *                                                                                     MD055652
     ILVENTZZF                                                                              MD055652
     I              RECI                            RECIZ                                   MD055652
     I*                                                                   B08268
     IPMSTAT      DS                                                      B08268
     I                                        1   50WWECD                 B08268
     I                                        1 256 WWSTAT                B08268
      *
      *  DATA STRUCTURE FOR MATURITY
      *
     IDSETYP      DS
     I                                        1   4 ETYP
     I                                        3   3 MEVNT
      *
      ***DATA*STRUCTURE*TO*FILL*DBKEY*IN*CASE*OF*ERROR*ON*PMPORTPP********S01486
      *  DATA STRUCTURE TO FILL DBKEY IN CASE OF ERROR ON PMPORTPD        S01486
      *
     IEKEY        DS
     I***********                             1   60CNUM                  S01486
     I                                        1   6 CUNR                  S01486
     I                                        7  10 PTFR
      *
      *  DATA STRUCTURE TO FILL DBKEY IN CASE OF ERROR ON CLOAN
      *
     ILKEY        DS
     I**********                              1   60LNRF                                      CLE148
     I                                        1   6 LNRF                                      CLE148
     I                                        7   7 RCDT
      *
      *  DATA STRUCTURE TO FILL DBKEY IN CASE OF ERROR ON SDLOANL1
      *
     INKEY        DS
     I                                        1   2 LTYP
     I                                        3   4 SUTP
     I                                        5   8 CLAS                                      CLE042
      *
      ** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
      *
     I***LDA********UDS                            256                    S01486
     ILDA         DS                            256                       S01486
     I                                      132 183 DBLOT
     I                                      132 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*                                                                   CPM004
     I** Input parameters on call to AOPLCSR1                             CPM004
     II@PARM      DS                            256                       CPM004
     I                                        1   1 I#PORS                CPM004
     I                                        2   5 I#R997                CPM004
     I                                        6  15 I#CUST                CPM004
     I                                       16  18 I#BRCA                CPM004
     I                                       19  20 I#BOOK                CPM004
     I                                       21  24 I#PTFR                CPM004
     I                                       25  34 I#CPGM                CPM004
     I*                                                                   CPM004
     I** Output parameters on call to AOPLCSR1                            CPM004
     IO@PARM      DS                            256                       CPM004
     I                                        1   2 O#BOOK                CPM004
     I                                        3   6 O#PTFR                CPM004
     I                                        7  12 O#BICN                CPM004
     I                                       13  22 O#CRNM                CPM004
     I                                       23  24 O#ACOF                CPM004
     I*                                                                   S01486
     ISDBANK    E DSSDBANKPD                                              S01486
     I** DUMMY RECORD FORMAT FOR BANK DETAILS                             S01486
     I*                                                                   S01486
     ISDMMOD    E DSSDMMODPD                                              CPB001
     I** DUMMY RECORD FORMAT FOR MODULE DETAILS                           CPB001
     I*                                                                   CPB001
     ISDCURR    E DSSDCURRPD                                              S01486
     I** DUMMY RECORD FORMAT FOR CURRENCY DETAILS                         S01486
     I*                                                                   S01486
     ISDCUST    E DSSDCUSTPD                                              S01486
     I** DUMMY RECORD FORMAT FOR CUSTOMER DETAILS                         S01486
     I*                                                                   S01486
     ISDLOAN    E DSSDLOANPD                                              S01486
     I** DUMMY RECORD FORMAT FOR LOAN TYPE / SUBTYPE DETAILS              S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              CPM004
     I**  SD Portfolio Management ICD details                             CPM004
     I*                                                                   CPM004
     ISDPLCS    E DSSDPLCSPD                                              S01486
     I** DUMMY RECORD FORMAT FOR PORTFOLIO MANAGEMENT CUSTOMER DETAILS    S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01486
     I*                                                                   S01486
     IDSLDY     E DSDSLDY                                                 CPB001
     I* THIRD DS FOR ACCESS PROGRAMS, VERY LONG DATA STRUCTURE            CPB001
      *
      /EJECT
      *
      *  DEFINE THE WORKING FIELDS
      *
     C**************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * INDEX OF SUBROUTINES                                                   *
      * MAIN     - MAIN PROCESSING                                             *
      * INIT     - INITIALIZATION PROCESSING                                   *
      * P01      - PROCESS EVENTS RECORDS                                      *
      * W01      - WRITE PORTFOLIO CASHFLOW EVENTS                             *
      * W02      - WRITE AUDIT REPORT                                          *
      * U01      - DELETE THE EVENT RECORD                                     *
      * U10      - UPDAT TRAILER & WRITE AUDIT                                 *
      * ZCCYCN   - CONVERT AN AMOUNT IN ONE CURRENCY TO ANOTHER                *
      * ZCCYXR   - CONVERT AN AMOUNT IN ONE CURRENCY TO ANOTHER                *
      * ZFLELN   - FORMAT THE 20A PORTFOLIO MANAGEMENT LINE DESCR.             *
      * ZDATE2   - CONVERT A DAY NUMBER TO DATE FORMATS                        *
      * GLZADD   - ADD AN AMOUNT TO THE TOTAL (HASH TOTAL)                     *
      * GLZSUB   - SUBTRACT AN AMOUNT FROM THE TOTAL (HASH TOTAL)              *
      * GLZSUM   - CARRY OUT THE ADDITION FOR SUBROUTINE (HASH TOTAL)          *
      * *PSSR    - DATA BASE ERROR PROCESSING                                  *
      *                                                                        *
      * EXTERNAL ROUTINES CALLED                                               *
      *                                                                        *
      **************************************************************************
     C           *LIKE     DEFN A6SPRT    W1SPOT
     C           *LIKE     DEFN A6MDIN    W1MDIN
     C           *LIKE     DEFN A6NBDP    W1CDP
     C           *LIKE     DEFN A6SPRT    W2SPOT
     C           *LIKE     DEFN A6MDIN    W2MDIN
     C           *LIKE     DEFN A6NBDP    W2CDP
     C           *LIKE     DEFN A6SPRT    W3SPOT
     C           *LIKE     DEFN A6MDIN    W3MDIN
     C           *LIKE     DEFN A6NBDP    W3CDP
     C           *LIKE     DEFN BJRDNB    WWI
     C************LIKE     DEFN CNUM      WWCNUM                          S01486
     C           *LIKE     DEFN CUNR      WWCNUM                          S01486
     C           *LIKE     DEFN PTFR      WWPTFR
     C           *LIKE     DEFN BBCUST    WWCUST
     C           *LIKE     DEFN BRCA      WWBRCA                          CPM004
      *
      /EJECT
      *
      ***KLIST*ELIST*TO*ACCESS*PF/PMPORTPP********************************S01486
      *  KLIST ELIST TO ACCESS PF/PMPORTPD                                S01486
      *
     C           ELIST     KLIST
     C                     KFLD           CNUM
     C                     KFLD           PTFR
      *
      *  KLIST LLIST TO ACCESS LF/CLOAN
      *
     C           LLIST     KLIST
     C                     KFLD           LNRF
     C                     KFLD           RCDT
      ***********                                                         S01486
      ***KLIST*NLIST*TO*ACCESS*LF/SDLOANL1********************************S01486
      ***********                                                         S01486
     C***********NLIST     KLIST                                          S01486
     C***********          KFLD           LTYP                            S01486
     C***********          KFLD           SUTP                            S01486
      *
      /EJECT
      *****************************************************************
      *                                                               *
      *  P R O G R A M   S T A R T                                    *
      *                                                               *
      *****************************************************************
      *
      * PERFORM INIT
      *
     C                     MOVEACPY@      CPY2@  80
     C                     EXSR INIT
      *
     C***********          READ PMLVNT                   89               S01486
     C                     READ PMLVNTL0                 89               S01486
      *
     C           *IN89     DOWEQ'0'                        - B1
      *
      * PERFORM MAIN SUB-ROUTINE
      *
     C                     EXSR P01
      *
     C           RDEL      IFEQ 'Y'                        - B2
      *
      * PERFORM DELETION SUB-ROUTINE
      *
     C                     EXSR U01
      *
     C                     END                             - E2
      *
     C***********          READ PMLVNT                   89               S01486
     C                     READ PMLVNTL0                 89               S01486
      *
     C                     END                             - E1
      *
      * UPDATE TRAILER RECORD
      *
     C                     EXSR U10
     C                     MOVE '1'       *INLR
      *
     C                     RETRN
      *************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * INIT     - INITIALIZATION PROCESSING                                   *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - DATA BASE ERROR PROCESSING                                  *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWECD    - EVENT CONTROL DATE                                          *
      * WWECPX   - EVENT CONTROL DATE + 365 DAYS                               *
      * WWCNUM   - SAVE CUSTOMER NUMBER                                        *
      * WWPTFR   - SAVE PORTFOLIO REFERENCE                                    *
      *                                                                        *
      **************************************************************************
     C           INIT      BEGSR                           **INIT BEGSR**
      *
      *  SETUP DATA BASE ERROR FIELDS
      *
     C           *NAMVAR   DEFN           LDA                             S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     MOVE *BLANKS   DBLOT
     C                     MOVE 'PM1430  'DBPGM
     C                     OUT  LDA                                       S01486
     C*                                                                   B08268
     C** DEFINE DATA AREA PMSTAT                                          B08268
     C           *NAMVAR   DEFN           PMSTAT                          B08268
     C                     IN   PMSTAT                                    B08268
     C*                                                                   CPB001
     C**   Access module details                                          CPB001
     C                     CALL 'AOMMODR0'                                CPB001
     C                     PARM *BLANKS   @RTCD   7                       CPB001
     C                     PARM '*FIRST ' @OPTN   7                       CPB001
     C           SDMMOD    PARM SDMMOD    DSFDY                           CPB001
      *
     C***READ*ICD1*FROM*LF/SDBANKL1***************************************S01486
     C** ACCESS BANK ICD DETAILS                                          S01486
      *
     C***********          READ SDBANKL1                 71               S01486
     C************IN71     IFEQ '1'                        - B1           S01486
     C***********          Z-ADD01        DBASE            ***************S01486
     C***********          MOVE 'SDBANKL1'DBFILE           **DB ERROR 01**S01486
     C***********          EXSR *PSSR                      ***************S01486
     C***********          END                             - E1           S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM '*DBERR'  RTCD    7                       S01486
     C                     PARM '*FIRST'  OPTN    7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
      *
      *  CALCULATE CONTROL DATE TO CHECK EVENT
      *
     C           BJDFIN    IFEQ 'M'                        - B1
     C                     MOVE '1'       *IN98
     C                     END                             - E1
     C*                                                                   CPM004
     C** ACCESS PM ICD                                                    CPM004
     C*                                                                   CPM004
     C                     CALL 'AOPORTR0'                                CPM004
     C                     PARM *BLANKS   P@RTCD                          CPM004
     C                     PARM '*FIRST'  P@OPTN                          CPM004
     C           SDPORT    PARM SDPORT    DSFDY                           CPM004
     C*                                                                   CPM004
     C           P@RTCD    IFNE *BLANKS                                   CPM004
     C           *LOCK     IN   LDA                                       CPM004
     C                     Z-ADD2         DBASE            ***************CPM004
     C                     MOVE 'SDPORTPD'DBFILE           * DB ERROR 02 *CPM004
     C                     MOVEL'*FIRST'  DBKEY            ***************CPM004
     C                     OUT  LDA                                       CPM004
     C                     EXSR *PSSR                                     CPM004
     C                     END                                            CPM004
     C****                                                                B08268
     C****ET GENERAL LEDGER DETAILS FOR ACCRUAL/PROFIT DATE               B08268
     C****                                                                B08268
     C****                 READ SDGELRL0                 71               B08268
     C****       *IN71     IFEQ '1'                        ***************B08268
     C****                 Z-ADD02        DBASE            **DB ERROR 02**B08268
     C****                 MOVEL'SDGELRL0'DBFILE           ***************B08268
     C****                 EXSR *PSSR                                     B08268
     C****                 END                                            B08268
     C*                                                                   B08268
     C** READ THROUGH SDCURRL0 SETTING UP ARRAY OF CURRENCIES             B08268
     C***********          READ SDCURRL0                 72         B08268S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*FIRST'  OPTN                            S01486
     C                     PARM *BLANKS   KEYCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C                     Z-ADD1         B       30                      B08268
     C************IN72     DOWEQ'0'                                 B08268S01486
     C           RTCD      DOWEQ*BLANKS                                   S01486
     C                     MOVE A6CYCD    CYCD,B                          B08268
     C                     Z-ADDA6SPRT    SPRT,B                          B08268
     C                     MOVE A6MDIN    MDIN,B                          B08268
     C                     Z-ADDA6NBDP    NBDP,B                          B08268
     C                     ADD  1         B                               B08268
     C***********          READ SDCURRL0                 72         B08268S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*NEXT'   OPTN                            S01486
     C                     PARM *BLANKS   KEYCY                           S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C                     END                                            B08268
      ****                                                                B08268
      ****EAD LF/SDCURRL0 TO GET FX EXCHANGE RATE INFORMATION             B08268
      ****                                                                B08268
     C****       BJCYCD    CHAINSDCURRL0             72                   B08268
     C****       *IN72     IFEQ '1'                        - B1           B08268
     C****                 Z-ADD03        DBASE            ***************B08268
     C****                 MOVEL'SDCURRL0'DBFILE           **DB ERROR 03**B08268
     C****                 MOVELBJCYCD    DBKEY            ***************B08268
     C****                 EXSR *PSSR                                     B08268
     C****                 END                             - E1           B08268
      ****                                                                B08268
      ****AVE FX EXCHANGE RATE INFORMATION FOR BASE CURRENCY              B08268
      ****                                                                B08268
     C****                 Z-ADDA6SPRT    W3SPOT                          B08268
     C****                 MOVE A6MDIN    W3MDIN                          B08268
     C****                 Z-ADDA6NBDP    W3CDP                           B08268
     C*                                                                   B08268
     C** ACCESS LF/SDCURRL0 USING THE BASE CURRENCY FROM LF/SDBANKL1      B08268
     C** FOR THE SPOT RATE AND NUMBER OF DECIMAL PLACES                   B08268
     C                     Z-ADD1         B                               B08268
     C           BJCYCD    LOKUPCYCD,B                   72               B08268
     C** ERROR                                                            B08268
     C           *IN72     IFEQ '0'                        ***************B08268
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD3         DBASE            **DB ERROR 02**B08268
     C                     MOVEL'SDCURRL0'DBFILE           ***************B08268
     C                     MOVELBJCYCD    DBKEY                           B08268
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     B08268
     C                     ELSE                                           B08040
     C                     Z-ADDSPRT,B    A6SPRT                          B08040
     C                     MOVE MDIN,B    A6MDIN                          B08040
     C                     Z-ADDNBDP,B    A6NBDP                          B08040
     C                     Z-ADDA6SPRT    W3SPOT                          B08040
     C                     MOVE A6MDIN    W3MDIN
     C                     Z-ADDA6NBDP    W3CDP
     C                     END                                            B08040
      *
      *  READ EVENTS FILE TRAILER PF/LVNTXZZ TO OBTAIN HASH TOTAL
      *
     C                     READ LVNTXZZ                  73
      *
      *  INITIALIZE THE COUNTER FIELD FOR AUDIT PRINT
      *
     C                     Z-ADD*ZEROS    RRCNT
     C                     MOVE *LOVAL    WWCNUM
     C                     MOVE *LOVAL    WWPTFR
      ****                                                                B08268
     C****ET THE EVENT CONTROL DATE TO BE USED BY THIS PROGRAM AS THE     B08268
     C****ESSER OF (DATE OF NEXT WORKING DAY - 1) FROM LF/SDBANKL1        B08268
     C****ND THE ACCRUALS/PROFIT DATE FROM LF/SDGELRL1                    B08268
     C****                                                                B08268
     C****       BJDNWD    SUB  1         WWDNWD  50                      B08268
     C****       WWDNWD    IFLT BKAPDT                                    B08268
     C****                 Z-ADDWWDNWD    WWECD   50                      B08268
     C****                 ELSE                                           B08268
     C****                 Z-ADDBKAPDT    WWECD                           B08268
     C****                 END                                            B08268
     C*
     C** EVENT CONTROL DATE + 365 DAYS
     C*
     C           WWECD     ADD  365       WWECPX  50
      *
     C                     ENDSR                           **INIT ENDSR**
      *************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * P01      - PROCESS EVENTS RECORDS                                      *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - DATA BASE ERROR PROCESSING                                  *
      * W01      - WRITE PORTFOLIO CASHFLOW EVENTS                             *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWECPX   - EVENT CONTROL DATE + 365 DAYS                               *
      * WWCNUM   - SAVE CUSTOMER NUMBER                                        *
      **WWAENB***-*FIELD*TO*CHAIN*LF/SDPLCSL0*****************************S01486
      * WWPTFR   - SAVE PORTFOLIO REFERENCE                                    *
      *                                                                        *
      **************************************************************************
     C           P01       BEGSR                           **P01 BEGSR**
      *
      *  CHECK IF EVENT MUST BE PERFORMED
      *
     C***********MEVNT     IFNE 'M'                        - B1           35671
     C***********EDAT      ANDLEWWECPX                                    35671
     C           MEVNT     IFEQ 'M'                        - B1           35671
     C           EDAT      ORLE WWECPX                                    35671
     C*                                                                   CPM004
     C*  IF BANK PORTFOLIOS SUPPORTED                                     CPM004
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C*                                                                   CPM004
     C           BRCA      IFNE WWBRCA                                    CPM004
     C                     EXSR BRANCH                                    CPM004
     C                     MOVE BRCA      WWBRCA                          CPM004
     C                     ENDIF                                          CPM004
     C*                                                                   CPM004
     C                     MOVE O#BICN    CUNR                            CPM004
     C                     MOVE O#ACOF    BBACOC                          CPM004
     C*                                                                   CPM004
     C                     ENDIF                                          CPM004
      *
      *  CHECK IF IT IS THE SAME CUSTOMER
      *
     C           FCPORS    IFNE 'B'                                       CPM004
      *                                                                   CPM004
     C***********CNUM      IFNE WWCNUM                     - B3           S01486
     C           CUNR      IFNE WWCNUM                     - B3           S01486
     C***********          MOVE CNUM      WWCUST                          S01486
     C***********WWCUST    CHAINSDPLCSL0             74                   S01486
     C                     MOVELCUNR      KEYCN                           S01486
     C                     CALL 'AOPLCSR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM           KEYCN  10                       S01486
     C           SDPLCS    PARM SDPLCS    DSFDY                           S01486
     C************IN74     IFEQ '1'                        - B4           S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C           BGN4ST    ANDNE'Y'                                       CPB001
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD04        DBASE            ***************
     C                     MOVEL'SDPLCSL0'DBFILE           **DB ERROR 04**
     C***********          MOVELCNUM      DBKEY            ***************S01486
     C                     MOVELCUNR      DBKEY            ***************S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E3
     C*****                CALL 'AOCUSTR0'                          S01486CPB001
     C                     CALL 'AOCUSTR1'                                CPB001
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM           KEYCN  10                       S01486
     C                     PARM *BLANKS   KEYST   7                       S01486
     C*****      SDCUST    PARM SDCUST    DSSDY                     S01486CPB001
     C           SDCUST    PARM SDCUST    DSLDY                           CPB001
     C           RTCD      IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD03        DBASE            ***************S01486
     C                     MOVEL'SDCUSTL0'DBFILE           **DB ERROR 03**S01486
     C                     MOVELCUNR      DBKEY            ***************S01486
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     S01486
     C                     END                                            S01486
     C*                                                                   CPB001
     C           BBPRBA    IFEQ 'Y'                                       CPB001
     C                     MOVE CUNR      CNUM                            CPB001
     C           ELIST     CHAINPMPORTPD             75                   CPB001
     C           *IN75     IFEQ '1'                                       CPB001
     C           *LOCK     IN   LDA                                       CPB001
     C                     Z-ADD19        DBASE            ***************CPB001
     C                     MOVEL'PMPORTPD'DBFILE           **DB ERROR 19**CPB001
     C                     MOVELEKEY      DBKEY            ***************CPB001
     C                     OUT  LDA                                       CPB001
     C                     EXSR *PSSR                                     CPB001
     C                     ELSE                                           CPB001
     C                     MOVELPNPTCY    QBCSBY                          CPB001
     C                     Z-ADDPNPCDP    QBBYDP                          CPB001
     C                     ENDIF                                          CPB001
     C                     ENDIF                                          CPB001
      ****                                                                B08268
      ****ET DETAILS OF CURRENT FX RATE & CUSTOMER CCY DECIMAL PLACES     B08268
      ****                                                                B08268
     C****       QBCSBY    CHAINSDCURRL0             72                   B08268
     C****       *IN72     IFEQ '1'                        - B3           B08268
     C****                 Z-ADD05        DBASE            ***************B08268
     C****                 MOVEL'SDCURRL0'DBFILE           **DB ERROR 05**B08268
     C****                 MOVELQBCSBY    DBKEY            ***************B08268
     C****                 EXSR *PSSR                                     B08268
     C****                 END                             - E3           B08268
      ****                                                                B08268
      ****AVE FIELDS FOR OUTPUT                                           B08268
      ****                                                                B08268
     C****                 Z-ADDA6SPRT    W1SPOT                          B08268
     C****                 MOVE A6MDIN    W1MDIN                          B08268
     C****                 Z-ADDA6NBDP    W1CDP                           B08268
      *                                                                   B08268
      *  GET DETAILS OF CURRENT FX RATE & CUSTOMER CCY DECIMAL PLACES     B08268
      *                                                                   B08268
     C                     Z-ADD1         B                               B08268
     C           QBCSBY    LOKUPCYCD,B                   72               B08268
     C** ERROR                                                            B08268
     C           *IN72     IFEQ '0'                        ***************B08268
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD5         DBASE            **DB ERROR 02**B08268
     C                     MOVEL'SDCURRL0'DBFILE           ***************B08268
     C                     MOVELQBCSBY    DBKEY                           B08268
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     B08268
     C                     ELSE                                           B08040
     C                     Z-ADDSPRT,B    A6SPRT                          B08040
     C                     MOVE MDIN,B    A6MDIN                          B08040
     C                     Z-ADDNBDP,B    A6NBDP                          B08040
     C                     Z-ADDA6SPRT    W1SPOT                          B08268
     C                     MOVE A6MDIN    W1MDIN                          B08268
     C                     Z-ADDA6NBDP    W1CDP                           B08268
     C                     END                                            B08040
      *
     C                     END                             - E2
     C                     ENDIF                                          CPM004
      *
     C***********CNUM      IFNE WWCNUM                     - B2           S01486
     C           CUNR      IFNE WWCNUM                     - B2           S01486
     C           PTFR      ORNE WWPTFR
     C           PTFR      IFNE '9997'                     - B3
      *
      *  OBTAIN NEW PORTFOLIO DEFINITION DETAILS
      *
     C                     MOVE CUNR      CNUM                            S01486
     C***********ELIST     CHAINPMPORTPP             75                   S01486
     C           ELIST     CHAINPMPORTPD             75                   S01486
     C           *IN75     IFEQ '1'                        - B4
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD06        DBASE            ***************
     C***********          MOVEL'PMPORTPP'DBFILE           **DB ERROR 06**S01486
     C                     MOVEL'PMPORTPD'DBFILE           **DB ERROR 06**S01486
     C                     MOVELEKEY      DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E4
      ****                                                                B08268
      ****ET CURRENT FX RATES                                             B08268
      ****                                                                B08268
     C****       PNPTCY    CHAINSDCURRL0             72                   B08268
     C****       *IN72     IFEQ '1'                        - B4           B08268
     C****                 Z-ADD07        DBASE            ***************B08268
     C****                 MOVEL'SDCURRL0'DBFILE           **DB ERROR 07**B08268
     C****                 MOVELPNPTCY    DBKEY            ***************B08268
     C****                 EXSR *PSSR                                     B08268
     C****                 END                             - E4           B08268
      ****                                                                B08268
      ****AVE FIELDS FOR OUTPUT                                           B08268
      ****                                                                B08268
     C****                 Z-ADDA6SPRT    W2SPOT                          B08268
     C****                 MOVE A6MDIN    W2MDIN                          B08268
     C****                 Z-ADDA6NBDP    W2CDP                           B08268
      *                                                                   B08268
      *  GET CURRENT FX RATES                                             B08268
      *                                                                   B08268
     C                     Z-ADD1         B                               B08268
     C           PNPTCY    LOKUPCYCD,B                   72               B08268
     C** ERROR                                                            B08268
     C           *IN72     IFEQ '0'                        ***************B08268
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD7         DBASE            **DB ERROR 02**B08268
     C                     MOVEL'SDCURRL0'DBFILE           ***************B08268
     C                     MOVELPNPTCY    DBKEY                           B08268
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR                                     B08268
     C                     ELSE                                           B08040
     C                     Z-ADDSPRT,B    A6SPRT                          B08040
     C                     MOVE MDIN,B    A6MDIN                          B08040
     C                     Z-ADDNBDP,B    A6NBDP                          B08040
     C                     Z-ADDA6SPRT    W2SPOT                          B08268
     C                     MOVE A6MDIN    W2MDIN                          B08268
     C                     Z-ADDA6NBDP    W2CDP                           B08268
     C                     END                                            B08040
      *
     C                     ELSE                            - X3
      *
     C                     MOVELQBCSBY    PNPTCY
     C                     Z-ADDW1SPOT    W2SPOT
     C                     MOVE W1MDIN    W2MDIN
     C                     Z-ADDW1CDP     W2CDP
      *
     C                     END                             - E3
     C                     MOVE PTFR      WWPTFR
     C***********          MOVE CNUM      WWCNUM                          S01486
     C                     MOVE CUNR      WWCNUM                          S01486
      *
     C                     END                             - E2
      *
     C                     EXSR W01
      *
      *  WRITE A RECORD
      *
     C                     WRITEPMEVNTP0
      *
      *  ADD 1 TO COUNT FOR AUDIT REPORT
      *
     C                     ADD  1         RRCNT
      *
     C                     END                             - E1
      *
     C                     ENDSR                           **P01 ENDSR**
      *************************************************************************
      /EJECT                                                              CPM004
      ********************************************************************CPM004
      *                                                                   CPM004
      * BRANCH   - RETRIEVE BRANCH'S CUSTOMER DETAILS                     CPM004
      *                                                                   CPM004
      * SUBROUTINE CALLS:                                                 CPM004
      * *PSSR    - DB ERROR SUB-ROUTINE                                   CPM004
      * AOPLCSR1 - PORTFOLIO MANAGEMENT CUSTOMER DETAILS                  CPM004
      *                                                                   CPM004
      * SUBROUTINE CALLED FROM:                                           CPM004
      * P01      - PROCESS EVENTS RECORDS                                 CPM004
      *                                                                   CPM004
      * ROUTINE USES VARIABLES:                                           CPM004
      *                                                                   CPM004
      ********************************************************************CPM004
     CSR         BRANCH    BEGSR                                          CPM004
     C**                                                                  CPM004
     C                     MOVE 'B'       I#PORS                          CPM004
     C                     MOVE FCR997    I#R997                          CPM004
     C                     MOVE BRCA      I#BRCA                          CPM004
     C**                                                                  CPM004
     C                     CALL 'AOPLCSR1'                                CPM004
     C                     PARM *BLANKS   P@RTCD  7        B:Return code  CPM004
     C                     PARM '*KEY   ' P@OPTN  7        I:Option       CPM004
     C                     PARM           I@PARM           I:Parameters   CPM004
     C                     PARM *BLANKS   O@PARM           O:Parameters   CPM004
     C           SDPLCS    PARM SDPLCS    DSFDY            O:Format       CPM004
      *                                                                   CPM004
      *                                                                   CPM004
      *  GET DETAILS OF CURRENT FX RATE & CUSTOMER CCY DECIMAL PLACES     CPM004
      *                                                                   CPM004
     C                     Z-ADD1         B                               CPM004
     C           QBCSBY    LOKUPCYCD,B                   72               CPM004
     C** ERROR                                                            CPM004
     C           *IN72     IFEQ '0'                        ***************CPM004
     C           *LOCK     IN   LDA                                       CPM004
     C                     Z-ADD5         DBASE            ***************CPM004
     C                     MOVEL'SDCURRL0'DBFILE           **DB ERROR 02**CPM004
     C                     MOVELQBCSBY    DBKEY            ***************CPM004
     C                     OUT  LDA                                       CPM004
     C                     EXSR *PSSR                                     CPM004
     C                     ELSE                                           CPM004
     C                     Z-ADDSPRT,B    A6SPRT                          CPM004
     C                     MOVE MDIN,B    A6MDIN                          CPM004
     C                     Z-ADDNBDP,B    A6NBDP                          CPM004
     C                     Z-ADDA6SPRT    W1SPOT                          CPM004
     C                     MOVE A6MDIN    W1MDIN                          CPM004
     C                     Z-ADDA6NBDP    W1CDP                           CPM004
     C                     END                                            CPM004
      *                                                                   CPM004
     CSR                   ENDSR                                          CPM004
      *************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * W01      - WRITE PORTFOLIO CASHFLOW EVENTS                             *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * *PSSR    - DATA BASE ERROR PROCESSING                                  *
      * ZFLELN   - FORMAT THE 20A PORTFOLIO MANAGEMENT LINE DESCR.             *
      * ZCCYCN   - CONVERT AN AMOUNT IN ONE CURRENCY TO ANOTHER                *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * P01      - PROCESS EVENTS RECORDS                                      *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      * WWCNUM   - SAVE CUSTOMER NUMBER                                        *
      * WWPTFR   - SAVE PORTFOLIO REFERENCE                                    *
      * WWI      - TABLE INDICE                                                *
      *                                                                        *
      **************************************************************************
     C           W01       BEGSR                           **W01 BEGSR**
      *
     C                     MOVE 'D'       Q9RECI
     C                     MOVE BBACOC    Q9ACOC
     C***********          Z-ADDWWCNUM    Q9CNUM                          S01486
     C                     MOVE WWCNUM    Q9CNUM                          S01486
     C                     MOVE WWPTFR    Q9PTFR
     C           WWPTFR    IFEQ '9997'                     - B1
     C                     MOVE QBCSBY    Q9PTCY
     C                     Z-ADDQBBYDP    Q9PCDP
     C                     ELSE                            - X1
     C                     MOVE PNPTCY    Q9PTCY
     C                     Z-ADDPNPCDP    Q9PCDP
     C                     END                             - E1
      *
     C                     MOVE LNRF      Q9TTRF
     C                     MOVE *BLANKS   Q9SEPR
     C                     MOVE 'LE'      Q9MODI
     C                     MOVE QBCSBY    Q9CSBY
     C                     Z-ADDQBBYDP    Q9BYDP
      *
      *  GET LOAN NARRATIVE
      *
     C***********NLIST     CHAINSDLOANL1             76
     C                     CALL 'AOLOANR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM LTYP      KEYLT   2                       S01486
     C                     PARM SUTP      KEYLS   2                       S01486
     C                     PARM CLAS      KEYLC   4                                           CLE042
     C           SDLOAN    PARM SDLOAN    DSFDY                           S01486
     C************IN76     IFEQ '1'                        - B1           S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD09        DBASE            ***************
     C                     MOVEL'SDLOANL1'DBFILE           **DB ERROR 09**
     C                     MOVELNKEY      DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E1
     C                     MOVELAYLNTD    Q9T1XT
     C                     MOVE AYINNR    Q9INNR
      *
     C                     MOVE 'A'       RCDT
     C           LLIST     CHAINCLOAN                77
     C           *IN77     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD10        DBASE            ***************
     C                     MOVEL'CLOAN   'DBFILE           **DB ERROR 10**
     C                     MOVELLKEY      DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E1
     C                     MOVE CCY       ZCCY
     C                     Z-ADDINTR      ZINRT
     C                     Z-ADDMDAT      ZMDAT
     C                     EXSR ZFLELN
     C                     MOVE ZLIN      Q9T2XT
      *
     C                     Z-ADDEDAT      Q9EVTD
      *
     C                     Z-ADD1         WWI
     C           ETYP      LOKUPARA,WWI                  78
     C           *IN78     IFNE '1'                        - B1
     C           *LOCK     IN   LDA                                       S01486
     C                     Z-ADD11        DBASE            ***************
     C                     MOVEL'PMEVNT  'DBFILE           **DB ERROR 11**
     C                     MOVELETYP      DBKEY            ***************
     C                     OUT  LDA                                       S01486
     C                     EXSR *PSSR
     C                     END                             - E1
     C                     MOVE ARB,WWI   Q9ENAR
      *
     C                     MOVE ECCY      Q9ECCY
     C                     Z-ADDEAMT      Q9ETAM
      *
     C           INOI      IFEQ 'O'                        - B1
     C                     MOVE 'R'       Q9AMTR
     C                     ELSE                            - X1
     C                     MOVE 'P'       Q9AMTR
     C                     END                             - E1
     C*                                                                   CPM004
     C           FCPORS    IFEQ 'B'                                       CPM004
     C           INOI      IFEQ 'O'                                       CPM004
     C                     MOVE 'P'       Q9AMTR                          CPM004
     C                     ELSE                                           CPM004
     C                     MOVE 'R'       Q9AMTR                          CPM004
     C                     END                                            CPM004
     C                     END                                            CPM004
      ****                                                                B08268
     C****       ECCY      CHAINSDCURRL0             72                   B08268
     C****       *IN72     IFEQ '1'                        - B1           B08268
     C****                 Z-ADD12        DBASE            ***************B08268
     C****                 MOVEL'SDCURRL0'DBFILE           **DB ERROR 12**B08268
     C****                 MOVELECCY      DBKEY            ***************B08268
     C****                 EXSR *PSSR                                     B08268
     C****                 END                             - E1           B08268
      *                                                                   B08268
     C                     Z-ADD1         B                               B08268
     C           ECCY      LOKUPCYCD,B                   72               B08268
     C** ERROR                                                            B08268
     C           *IN72     IFEQ '0'                        ***************B08268
     C                     Z-ADD12        DBASE            **DB ERROR 02**B08268
     C                     MOVEL'SDCURRL0'DBFILE           ***************B08268
     C                     MOVELECCY      DBKEY                           B08268
     C                     EXSR *PSSR                                     B08268
     C                     ELSE                                           B08040
     C                     Z-ADDSPRT,B    A6SPRT                          B08040
     C                     MOVE MDIN,B    A6MDIN                          B08040
     C                     Z-ADDNBDP,B    A6NBDP                          B08040
     C                     END                                            B08040
     C*
     C** CONVERT EVENT AMOUNT IN EVENT CURRENCY TO PORTFOLIO CURRENCY
     C*
     C                     Z-ADDEAMT      ZAMTF
     C                     MOVELECCY      ZCCYF
     C                     Z-ADDA6SPRT    ZRATEF
     C                     MOVE A6MDIN    ZMDINF
     C                     Z-ADDA6NBDP    ZCDPF
     C                     MOVELPNPTCY    ZCCYT
     C                     Z-ADDW2SPOT    ZRATET
     C                     MOVE W2MDIN    ZMDINT
     C                     Z-ADDW2CDP     ZCDPT
     C                     EXSR ZCCYCN
     C                     Z-ADDZAMTT     Q9PTFA
      *
     C** CONVERT EVENT AMOUNT IN EVENT CURRENCY TO CUSTOMER CURRENCY
      *
     C                     Z-ADDEAMT      ZAMTF
     C                     MOVELECCY      ZCCYF
     C                     Z-ADDA6SPRT    ZRATEF
     C                     MOVE A6MDIN    ZMDINF
     C                     Z-ADDA6NBDP    ZCDPF
     C                     MOVELQBCSBY    ZCCYT
     C                     Z-ADDW1SPOT    ZRATET
     C                     MOVE W1MDIN    ZMDINT
     C                     Z-ADDW1CDP     ZCDPT
     C                     EXSR ZCCYCN
     C                     Z-ADDZAMTT     Q9CUCA
      *
     C** CONVERT EVENT AMOUNT IN EVENT CURRENCY TO BASE CURRENCY
      *
     C                     Z-ADDEAMT      ZAMTF
     C                     MOVELECCY      ZCCYF
     C                     Z-ADDA6SPRT    ZRATEF
     C                     MOVE A6MDIN    ZMDINF
     C                     Z-ADDA6NBDP    ZCDPF
     C                     MOVELBJCYCD    ZCCYT
     C                     Z-ADDW3SPOT    ZRATET
     C                     MOVE W3MDIN    ZMDINT
     C                     Z-ADDW3CDP     ZCDPT
     C                     EXSR ZCCYCN
     C                     Z-ADDZAMTT     Q9BCYA
      *
     C                     ENDSR                           **W01 ENDSR**
      *************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * W02      - WRITE AUDIT REPORT                                          *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * U10      - UPDAT TRAILER & WRITE AUDIT                                 *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           W02       BEGSR                           **W02 BEGSR**
      *
     C                     WRITEHEADAU
     C                     WRITETOTAU
     C***********          WRITEENDAU                                     S01486
      *
     C                     ENDSR                           **W02 ENDSR**
      *************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * U01      - DELETE THE EVENT RECORD                                     *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * GLZSUB   - SUBTRACT AN AMOUNT FROM THE TOTAL (HASH TOTAL)              *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           U01       BEGSR                           **U01 BEGSR**
      *
     C                     SUB  1         NORE
     C*
     C** NEED TO DIVIDE AMOUNT BY 1000
     C           EAMT      DIV  1000      ZZAMT
     C                     Z-ADDHRWN      ZZTOTI
     C                     Z-ADDHRDC      ZZTOTD
     C                     EXSR GLZSUB
     C                     Z-ADDZZTOTI    HRWN
     C                     Z-ADDZZTOTD    HRDC
     C                     DELETLVENTELF
      *
     C                     ENDSR                           **U01 ENDSR**
      *************************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * U10      - UPDAT TRAILER & WRITE AUDIT                                 *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      * W02      - WRITE AUDIT REPORT                                          *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * MAIN     - MAIN PROCESSING                                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           U10       BEGSR                           **U10 BEGSR**
      *
      **  IF RECORD FOUND ON PF/LVNTXZZ UPDATE TRAILER
     C           *IN73     IFEQ '0'
     C                     UPDATLVENTZZF
     C                     END
      *
      **  WRITE AUDIT REPORT
     C                     EXSR W02
      *
     C                     ENDSR                           **U10 ENDSR**
     C**************************************************************************
      /EJECT
     C********************************************************************
     C*
     C*  ZFLELN SR. TO FORMAT THE 20A PORTFOLIO MANAGMENT LINE DESCRIPTION
     C*                                 FOR LENDING
     C*
     C*  FORMAT: XXX 999.9999 DDMMMYY
     C*          XXX =  LOAN CURRENCY
     C*          999.9999 = INTEREST RATE
     C*          DDMMMYY = MATURITY DATE
     C*
     C*  INPUT  FIELDS
     C*       ZCCY    3A     LOAN CURRENCY
     C*       ZINRT  117     INTEREST RATE
     C*       ZMDAT   50     MATURITY DATE
     C*
     C*  OUTPUT  FIELDS
     C*       ZLIN   20A     LINE DESCRIPTION
     C*
     C*  ARRAY USED
     C*       ZLI    20 ELEMENTS, EACH 1 CHARACTER LONG
     C*
     C********************************************************************
     C           ZFLELN    BEGSR
     C*
     C** CLEAR LINE DESCRIPTION .
     C                     MOVEA*BLANKS   ZLI
     C*
     C**   BUILD FORMAT
     C*
     C** MOVE LOAN CURRENCY TO LINE DESCRIPTION
     C                     MOVEAZCCY      ZLI,01
     C*
     C** MOVE INTEREST RATE TO LINE DESCRIPTION
     C                     Z-ADDZINRT     ZWRKN   74
     C                     MOVELZWRKN     ZWRKA3  3
     C                     MOVELZWRKA3    ZWRKA2  2
     C*
     C** SUPRESS LEADING ZEROES
     C           ZWRKA2    IFEQ '00'
     C                     MOVEL'  '      ZWRKA3
     C                     END
     C*
     C                     MOVELZWRKA3    ZWRKA1  1
     C           ZWRKA1    IFEQ '0'
     C                     MOVEL' '       ZWRKA3
     C                     END
     C*
     C** MOVE INTEREST DETAILS INTO OUTPUT ARRAY
     C                     MOVE ZWRKN     ZWRKA4  4
     C                     MOVEAZWRKA3    ZLI,05
     C                     MOVEA'.'       ZLI,08
     C                     MOVEAZWRKA4    ZLI,09
     C*
     C** MOVE MATURITY DATE TO LINE DESCRIPTION
     C                     Z-ADDZMDAT     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    ZWRKA1  1
     C*
     C           ZWRKA1    IFEQ ' '
     C                     MOVEL'0'       ZADATE
     C                     END
     C                     MOVEAZADATE    ZLI,14
     C**
     C** SET ALL   FIELDS TO BLANKS OR ZEROS
     C                     MOVE *BLANKS   ZCCY    3
     C                     Z-ADD*ZEROS    ZINRT  117
     C                     Z-ADD*ZEROS    ZMDAT   50
     C**
     C                     MOVEAZLI       ZLIN   20
     C**
     C                     ENDSR
     C*******************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      /COPY ZSRSRC,ZCCYCN
      ****/EJECT                                                          47719
      ****/COPY ZSRSRC,ZCCYXR                                             47719
      /EJECT                                                              S01486
      /COPY ZSRSRC,ZCCYXR                                                 S01486
      /EJECT
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C**************************************************************************
      * SUBROUTINE CALLS:                                                      *
      * GLZSUM   - CARRY OUT THE ADDITION FOR SUBROUTINE (HASH TOTAL)          *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * GLZSUB   - SUBTRACT AN AMOUNT FROM THE TOTAL (HASH TOTAL)              *
      **************************************************************************
     CSR         GLZADD    BEGSR                           ***  GLZADD ***
     C*
     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     CSR                   EXSR GLZSUM
     CSR         ZZAEND    ENDSR                           ***  ZZAEND ***
     C*
     C********************************************************************
      /EJECT
     C********************************************************************
     C* SUBROUTINE TO SUBTRACT AN AMOUNT (ZZAMT) FROM THE TOTAL
     C*                                                   (ZZTOTI,ZZTOTD)
     C*  IND '99' IS SET BY AN OVERFLOW ERROR
     C**************************************************************************
      * SUBROUTINE CALLS:                                                      *
      * GLZADD   - ADD AN AMOUNT TO THE TOTAL (HASH TOTAL)                     *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * U01      - DELETE THE EVENT RECORD                                     *
      **************************************************************************
     CSR         GLZSUB    BEGSR                           ***  GLZSUB ***
     C* PROCESSING. JUST REVERSE THE 'SIGN' AND ADD
     CSR                   Z-SUBZZAMT     ZZAMT  153       REVERSE 'SIGN'
     CSR                   EXSR GLZADD                       AND 'ADD'
     CSR                   Z-SUBZZAMT     ZZAMT            RESTORE 'SIGN'
     CSR                   ENDSR
     C********************************************************************
      /EJECT
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C**************************************************************************
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * GLZADD   - ADD AN AMOUNT TO THE TOTAL (HASH TOTAL)                     *
      **************************************************************************
     CSR         GLZSUM    BEGSR                           ***  GLZSUM ***
     C*
     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     CSR                   SETOF                     919293
     CSR                   SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     CSR         ZZAMTI    COMP 0                      9293
     CSR 93      ZZAMTD    COMP 0                      9293
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     CSR         ZZTOTI    COMP 0                      9193
     CSR 93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     CSR 93                Z-ADDZZAMTI    ZZTOTI
     CSR 93                Z-ADDZZAMTD    ZZTOTD
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     CSR 91N92
     CORN91 92             GOTO ZZOFPS
     C*
     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     CSRN99                Z-ADDZZWK2     ZZTOTD
     CSRN99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     CSR 99                Z-ADD0         ZZAMT  153
     CSR                   GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     CSR         ZZOFPS    TAG                             ***  ZZOFPS ***
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     CSR 91                Z-SUBZZTOTI    ZZTOTI
     CSR 91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     CSR         ZZTOTI    COMP ZZAMTI               93  95
     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     CSR 95                Z-ADD0         ZZTOTI
     CSR 95                Z-ADD0         ZZTOTD
     CSR 95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     CSR 93      ZZAMTD    COMP ZZTOTD               94
     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     CSRN93      ZZTOTD    COMP ZZAMTD               94
     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     CSR                   SETOF                     94
     CSR 93 91
     CORN93 92             SETON                     94
     CSR 94                Z-SUBZZTOTI    ZZTOTI
     CSR 94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     CSR 92                Z-SUBZZAMTI    ZZAMTI
     CSR 92                Z-SUBZZAMTD    ZZAMTD
     CSR         ZZSEND    TAG                             ***  ZZSEND ***
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     CSR                   SETOF                     96
     CSR         ZZTOTD    COMP 0                        91
     CSR 91      ZZTOTI    COMP 0                      96
     CSR 96                MOVE '.000-'   ZZNEGD  5
     CSR                   ENDSR                             ** ENDSR **
     C*****************************************************************
      /EJECT
      **************************************************************************
      *                                                                        *
      * *PSSR    - DATA BASE ERROR PROCESSING                                  *
      *                                                                        *
      * SUBROUTINE CALLS:                                                      *
      *                                                                        *
      * SUBROUTINE CALLED FROM:                                                *
      * INIT     - INITIALIZATION PROCESSING                                   *
      * P01      - PROCESS EVENTS RECORDS                                      *
      * W01      - WRITE PORTFOLIO CASHFLOW EVENTS                             *
      *                                                                        *
      * ROUTINE USES VARIABLES:                                                *
      *                                                                        *
      **************************************************************************
     C           *PSSR     BEGSR                           ** *PSRR BSR**
     C**
     C** ROLL BACK CHANGES , DUMP AND RETURN TO THE CALLING PROGRAM
     C**
     C                     SETON                     LRU7U8
     C                     WRITEHEADAU
     C                     WRITEERRORAU
     C***********          WRITEENDAU                                     S01486
     C                     DUMP
     C                     RETRN
     C**
     C                     ENDSR                            ** *PSRR ESR**
     C*=========================================================================
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  ARA
61V1PRINCIPAL
61I2INTEREST DUE
61R1PRINCIPAL REPAY AMT
61R2INTEREST REPAY AMT
61V3PRINCIPAL INCR AMT
61M1PRINCIPAL O/S AT MAT
61M2INTEREST O/S AT MAT
61R5ROLLOVER
61D1CURRENT PRINCIPAL
61A1CURRENT PRINCIPAL
61R7TRANSFER FROM                                                         124660
61V5TRANSFER TO                                                           124660
62V1PRINCIPAL
62I2INTEREST DUE
62R1PRINCIPAL REPAY AMT
62R2INTEREST REPAY AMT
62M1PRINCIPAL O/S AT MAT
62M2INTEREST O/S AT MAT
62R5ROLLOVER
62D1CURRENT PRINCIPAL
62R7TRANSFER FROM                                                         124660
62V5TRANSFER TO                                                           124660
62V7REDRAWING ON NEW CCY                                                  124660
62R9REPAYMENT ON OLD CCY                                                  124660
62A1CURRENT PRINCIPAL                                                     134975
63R1PRINCIPAL REPAY AMT                                                                     MD055652
63V1PRINCIPAL FACE VALUE
63V2DISCOUNT
63M1PRINCIPAL FACE VALUE
63D1PRINCIPAL
63A1CURRENT PRINCIPAL
63R7TRANSFER FROM                                                         124660
63V5TRANSFER TO                                                           124660
63V7REDRAWING ON NEW CCY                                                  124660
63R9REPAYMENT ON OLD CCY                                                  124660
63I3INTEREST AT ROLLOVER                                                  124660
70V3PRINCIPAL INCREASE
70I2INTEREST DUE DATE
70M2INTEREST O/S AT MAT
70R7TRANSFER FROM                                                         124660
70V5TRANSFER TO                                                           124660
64V1VALUE DATE
64I2INTEREST DUE DATE
64R1INTEREST REPAY AMT
64R2PRINCIPAL REPAY AMT
64M1INTEREST O/S AT MAT
64M2PRINCIPAL O/S AT MAT
64R7TRANSFER FROM                                                         124660
64V5TRANSFER TO                                                           124660
64V7REDRAWING ON NEW CCY                                                  124660
64R9REPAYMENT ON OLD CCY                                                  124660
65R1PRINCIPAL REPAY AMT                                                                     MD055652
65V1DISCOUNT AMT
65V2PRINCIPAL
65M1DISCOUNT AMT
65R7TRANSFER FROM                                                         124660
65V5TRANSFER TO                                                           124660
65V7REDRAWING ON NEW CCY                                                  124660
65R9REPAYMENT ON OLD CCY                                                  124660
66V1VALUE DATE
66I2INTEREST DUE DATE
66R1INTEREST REPAY AMT
66R2PRINCIPAL REPAY AMT
66M1INTEREST O/S AT MAT
66M2PRINCIPAL O/S AT MAT
66R7TRANSFER FROM                                                         124660
66V5TRANSFER TO                                                           124660
66V7REDRAWING ON NEW CCY                                                  124660
66R9REPAYMENT ON OLD CCY                                                  124660
67R1PRINCIPAL REPAY AMT                                                                     MD055652
67V1DISCOUNT AMT
67V2PRINCIPAL
67M1DISCOUNT AMT
67R7TRANSFER FROM                                                         124660
67V5TRANSFER TO                                                           124660
67V7REDRAWING ON NEW CCY                                                  124660
67R9REPAYMENT ON OLD CCY                                                  124660
67I3INTEREST AT ROLLOVER                                                  124660
61X2
62V3
62X2
63R3
63R4
63R5
64V3
64X2
64R5
64D1
65D!
66V3
66X2
66R5
66D1
67D1
70V1
70X2
70M1
70D1
61VXSTART                                                                 CEU003
62VXSTART                                                                 CEU003
63VXSTART                                                                 CEU003
64VXSTART                                                                 CEU003
65VXSTART                                                                 CEU003
66VXSTART                                                                 CEU003
67VXSTART                                                                 CEU003
61IYINT DUE                                                               CEU003
62IYINT DUE                                                               CEU003
64IYINT DUE                                                               CEU003
66IYINT DUE                                                               CEU003
70IYINT DUE                                                               CEU003
61RXREPAY PRIN                                                            CEU003
62RXREPAY PRIN                                                            CEU003
64RXREPAY PRIN                                                            CEU003
66RXREPAY PRIN                                                            CEU003
61RYREPAY INT                                                             CEU003
62RYREPAY INT                                                             CEU003
64RYREPAY INT                                                             CEU003
66RYREPAY INT                                                             CEU003
61VZPRIN INC.                                                             CEU003
61MXMATURITY                                                              CEU003
62MXMATURITY                                                              CEU003
63MXMATURITY                                                              CEU003
64MXMATURITY                                                              CEU003
65MXMATURITY                                                              CEU003
66MXMATURITY                                                              CEU003
67MXMATURITY                                                              CEU003
63VYSTART INT                                                             CEU003
65VYSTART INT                                                             CEU003
67VYSTART INT                                                             CEU003
70MYGTEE FEE                                                              CEU003
70MX                                                                      154343
61MYMATUR INT                                                             CEU003
62MYMATUR INT                                                             CEU003
64MYMATUR INT                                                             CEU003
66MYMATUR INT                                                             CEU003
62VZPRIN INC.                                                             CEU003
64VZPRIN INC.                                                             CEU003
66VZPRIN INC.                                                             CEU003
63RZRVER DSC.                                                             CEU003
80V1VALUE DATE PRINCIPAL                                                                      220564
80X2TOTAL FLAT RATE INT                                                                       220564
80R1PRINCIPAL REPAY AMT                                                                       220564
80R2INTEREST REPAY AMT                                                                        220564
80M1PRINCIPAL O/S AT MAT                                                                      220564
80M2INTEREST O/S AT MAT                                                                       220564
80D1PRIN AMNT PAST DUE                                                                        220564
80H1VDATE CHARGE AMNT                                                                         220564
61P1                                                                                       AR1092885
61P2                                                                                       AR1092885
61P6                                                                                       AR1092885
62P1                                                                                       AR1092885
62P2                                                                                       AR1092885
62P6                                                                                       AR1092885
63P1                                                                                       AR1092885
64P1                                                                                       AR1092885
64P2                                                                                       AR1092885
64P6                                                                                       AR1092885
65P1                                                                                       AR1092885
66P1                                                                                       AR1092885
66P2                                                                                       AR1092885
66P6                                                                                       AR1092885
67P1                                                                                       AR1092885
68P1                                                                                       AR1092885
68P2                                                                                       AR1092885
68P6                                                                                       AR1092885
69P1                                                                                       AR1092885
69P2                                                                                       AR1092885
69P6                                                                                       AR1092885
70P1                                                                                       AR1092885
70P2                                                                                       AR1092885
71P1                                                                                       AR1092885
71P2                                                                                       AR1092885
72P1                                                                                       AR1092885
72P2                                                                                       AR1092885
80P1                                                                                       AR1092885
80P2                                                                                       AR1092885
80P6                                                                                       AR1092885
61PX                                                                                       AR1092885
61PY                                                                                       AR1092885
68M1                                                                                       AR1092885
68M2                                                                                       AR1092885
69M1                                                                                       AR1092885
69M2                                                                                       AR1092885
72M2                                                                                       AR1092885
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**  CPY@
(c) Finastra International Limited 2001
