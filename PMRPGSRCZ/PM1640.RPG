000100200529     H        1                                                           S01486
000200200529      *****************************************************************
000300200529/*STD *  RPGBASE                                                      *
000400200529/*EXI *  TEXT('Midas PM Copy Start of Month Pos to Workfile')         *
000500200529     H***********                                                         S01486
000600200529     F*****************************************************************
000700200529     F*                                                               *
000800200529     F*  Midas - Portfolio Management Module                      *
000900200529     F*                                                               *
001000200529     F*  PM1640 - Copy Start of Month Positions to Workfile           *
001100200529     F*                                                               *
001200200529      *  (c) Finastra International Limited 2001                      *
001300200529     F*                                                               *
001400200604     F*  Last Amend No. 250228             Date 22May20               *
001500200529      *  Prev Amend No. MD046248           Date 27Oct17               *
001600200529      *                 CLE148             Date 23Jul12               *
001700200529      *                 CER059             Date 19Jul10               *
001800200529      *                 CER020             Date 19May08               *
001900200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
002000200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
002100200529      * Midas Plus 1.4 Base ------------------------------------------*
002200200529      * Midas Plus 1.3 ----------- Base ------------------------------*
002300200529      *                 CSD027             Date 09Dec05               *
002400200529      *                 CLE025             Date 20Oct03               *
002500200529      *                 CGL029             Date 01Sep03               *
002600200529      * Midas Release 4.01 -------------------------------------------*
002700200529      *                 182961             Date 21Apr01               *
002800200529      * Midas Release 4 --------------- Base -------------------------*
002900200529      * Midas DBA 3.00 ---------------- Base -------------------------*
003000200529      *                 097158             Date 28Dec95               *
003100200529      *                 091999             Date 23Aug95               *
003200200529     F*                 CPM005             DATE 12JUL96               *
003300200529     F*                 CFF004             DATE 10SEP96               *
003400200529     F*                 075998             DATE 20DEC95               *
003500200529     F*                 095867             DATE 07NOV95               *
003600200529     F*                 72242              DATE 25NOV94               *
003700200529     F*                 53103  LV          DATE 25NOV94               *
003800200529     F*                 S01486             DATE 11AUG94               *
003900200529     F*                 057020             DATE 16JUN93               *
004000200529     F*                 S01313             DATE 28JAN93               *
004100200529     F*                                                               *
004200200529     F*---------------------------------------------------------------*
004300200529     F*                                                               *
004400200529      *  250228 - RECOMPILE DUE TO FIELD CHANGE IN PMPSTMQ0.          *
004500200529      *  MD046248 - Finastra Rebranding                               *
004600200529      *  CLE148 - Alpha Loan Reference                                *
004700200529      *  CER059 - German Feature Upgrade to Delhi                     *
004800200529      *  CER020 - Enhanced Rollover Window: Upgrade FGE089 to         *
004900200529      *           Midas Plus                                          *
005000200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
005100200529      *  CLE025 - Credit Lines (Recompile)                            *
005200200529      *  CGL029 - Increase Account Code to 10 digits                  *
005300200529      *  182961 - Database error occurred due to a blank key field    *
005400200529      *           (Instrument Type).  The default Instrument type in  *
005500200529      *           PF/SDPORTPD is taken if a blank instrument type is  *
005600200529      *           encountered.                                        *
005700200529     F*  097158 - If QFVDAT different than 0, field used for forward  *
005800200529     F*           value date event (not processed for performance     *
005900200529     F*           reconciliation reports if QFVDAT greater than ecd.  *
006000200529     F*           See also PM1140, PM1620, PM6430, PM1630             *
006100200529     F*  091999 - PBFG/3 SHOULD ONLY APPLY TO VALUE DATE ACCOUNTING.  *
006200200529     F*  CPM005 - Private Banking Phase 2  (Includes 097158 & 091999) *
006300200529     F*           Focus Group Changes upgraded to DBA                 *
006400200529     F*           PBFG/3 - DISPLAY OF UNREAL. P&L ON FORWARD SE TRADES*
006500200529     F*  CFF004 - Increase in size of Price Fields,(Recompiled Only)     *
006600200529     F*  075998 - Portfolio/Future & Options performance              *
006700200529     F*  095867 - Should move all fields from PMPSTMQ0 to PMPSTCPD    *
006800200529     F*  72242  - Start of month positions should have same           *
006900200529     F*           instrument as ending position                       *
007000200529     F*  53103  - Changes for Portfolio Performance Reconciliation    *
007100200529     F*  S01486 - Portfolio Management Upgrade to Release 10.         *
007200200529     F*  057020 - RECOMPILE DUE TO FILE CHANGES                       *
007300200529     F*  S01313 - PORTFOLIO PERFORMANCE                               *
007400200529     F*                                                               *
007500200529     F*****************************************************************
007600200529     F*                                                               *
007700200529     F** C R E A T I O N     P A R A M E T E R S                      *
007800200529     F**                                                              *
007900200529     F**                                                              *
008000200529     F*****************************************************************
008100200529     F/EJECT
008200200529     F*****************************************************************
008300200529     F**
008400200529     F**      FILE DEFINITIONS
008500200529     F**     ------------------
008600200529     F*
008700200529     F*****BANK*DETAILS*FILE************************-*Prefix*BJ********   S01486
008800200529     F***SDBANKL1IF**E           K        DISK         KINFSR *PSSR       S01486
008900200529     F*
009000200529     F**   PORTFOLIO DEFINITION DETAILS             - Prefix QR
009100200529     F***PMPFMRPPIF**E           K        DISK         KINFSR *PSSR       S01486
009200200529     FPMPFMRPDIF  E           K        DISK         KINFSR *PSSR          S01486
009300200529     F*
009400200529     F**   STARTOF MONTH POSITIONS                  - Prefix QF
009500200529     F***PMPSTMPPIF**E           K        DISK         KINFSR *PSSR       S01486
009600200529     FPMPSTMQ0IF  E           K        DISK         KINFSR *PSSR          S01486
009700200529     F*
009800200529     F*****START*OF*MONTH*POSITIONS*WORKFILE********-*Prefix*QF********   S01486
009900200529     F***PMPSTCPPUF**E           K        DISK         KINFSR *PSSR A     S01486
010000200529     F**   START OF MONTH POSITIONS WORKFILE        - Prefix GF           S01486
010100200529     FPMPSTCPDUF  E           K        DISK         KINFSR *PSSR A        S01486
010200200529     F*
010300200529     F*                                                                   53103
010400200529     F**   PERF. ANALYSIS BY TRANSACTION            - Prefix QU           53103
010500200529     FPMPTRAL2IF  E           K        DISK         KINFSR *PSSR          53103
010600200529     F*                                                                   53103
010700200529     F*                                                                   72242
010800200529     F**   PERF. START OF MONTH POSITIONS COPY      - Prefix QF           72242
010900200529     FPMCPSTQ0UF  E           K        DISK         KINFSR *PSSR A        72242
011000200529     F            PMPSTCP0                          KRENAMEPMPSTCP1       72242
011100200529     F*                                                                   72242
011200200529     F**   PERF. ENDING POSITIONS DUPLICATE         - Prefix QF           72242
011300200529     FPMCPIMQ0IF  E           K        DISK         KINFSR *PSSR          72242
011400200529     FSDPORTPDIF  E                    DISK         KINFSR *PSSR          182961
011500200529     F**   AUDIT REPORT
011600200529     FPM1640AUO   E                    PRINTER      KINFSR *PSSR
011700200529     F*
011800200529     F/EJECT
011900200529     E*****************************************************************
012000200529     E*
012100200529     E**   ARRAY FOR COPYRIGHT
012200200529     E                    CPY@    1   1 80
012300200529     E*                                                                   CPM005
012400200529     E**   ARRAY FOR RETAIL ACCOUNT NARRATIVE                             CPM005
012500200529     E                    RETA        1 20                                CPM005
012600200529     E** ARRAY FOR ZDATE SUBROUTINE                                       CPM005
012700200529      /COPY ZSRSRC,ZDATE2Z1                                               CPM005
012800200529     E*****************************************************************
012900200529     E/EJECT
013000200529     E*****************************************************************
013100200529     IPMPSTCP0                                                            097158
013200200529     I              GFVDAT                          Q0VDAT                097158
013300200529     IPMPSTCP1                                                            097158
013400200529     I              GFVDAT                          Q1VDAT                097158
013500200529     I*
013600200529     I**   DATA STRUCTURE FOR COMPILATION - COPYRIGHT INSERTION
013700200529     ICPYR@$      DS
013800200529     I                                        1  80 CPY@
013900200529     I                                        1  20 CPY@$$
014000200529     I*
014100200529     I**   LOCAL DATA AREA
014200200529     I***LDA********UDS***********************     256                    S01486
014300200529     ILDA         DS                            256                       S01486
014400200529     I                                      132 141 DBFILE
014500200529     I                                      142 170 DBKEY
014600200529     I                                      171 180 DBPGM
014700200529     I                                      181 1830DBASE
014800200529     I*
014900200529     I** EXTRACT ACCOUNT CODE AND ACCOUNT SEQUENCE
015000200529     I            DS
015100200529     I**********                             12  15 WWACOD                                    CGL029
015200200529     I**********                             17  18 WWACSQ                                    CGL029
015300200529     I**********                              1  20 QFTXT2                                    CGL029
015400200529     I                                       12  21 WWACOD                                    CGL029
015500200529     I                                       23  24 WWACSQ                                    CGL029
015600200529     I                                        1  26 QFTXT2                                    CGL029
015700200529     I*
015800200529     I**   DATA STRUCTURE
015900200529     I            DS
016000200529     I                                        1   20WWDD
016100200529     I                                        3   40WWMM
016200200529     I                                        5   60WWYY
016300200529     I                                        1   60WWDAT
016400200529     I*                                                                   S01486
016500200529     ISDBANK    E DSSDBANKPD                                              S01486
016600200529     I**  Data structure for Bank details                                 S01486
016700200529     ISDPORT    E DSSDPORTPD                                              53103
016800200529     I**  Data structure for portfolio details                            53103
016900200529     ISDPLIN    E DSSDPLINPD                                              53103
017000200529     I**  Data structure for instrument details                           53103
017100200529     I*                                                                   S01486
017200200529     IDSFDY     E DSDSFDY                                                 S01486
017300200529     I**  Short data structure for access objects                         S01486
017400200529     I*                                                                   S01486
017500200529     C*****************************************************************
017600200529     C/EJECT
017700200529     C*****************************************************************
017800200529     C*
017900200529     C**              START MAINLINE
018000200529     C**             ----------------
018100200529     C*
018200200529     C** INITIAL PROCESSING
018300200529     C                     EXSR #A
018400200529     C*
018500200529     C** WRITE START OF MONTH POSITIONS TO WORKFILE FOR ALL PERFORMANCE
018600200529     C** PERIODS REQUESTED
018700200529     C***********          READ PMPFMRPP                 60               S01486
018800200529     C                     READ PMPFMRPD                 60               S01486
018900200529     C*
019000200529     C           *IN60     DOWEQ'0'                        B1
019100200529     C*
019200200529     C** CHECK WHETHER RECORDS ALREADY WRITTEN FOR THIS START MONTH
019300200529     C***********PSTCKY    SETLLPMPSTCPP                                  S01486
019400200529     C***********PSTCKY    READEPMPSTCPP                 62               S01486
019500200529     C           PSTCKY    SETLLPMPSTCPD                                  S01486
019600200529     C           PSTCKY    READEPMPSTCPD                 62               S01486
019700200529     C*
019800200529     C           *IN62     IFEQ '1'                        B2
019900200529     C*
020000200529     C** SET FILE POINTER BEFORE FIRST START OF MONTH POSITION AND READ
020100200529     C** POSITION
020200200529     C                     MOVE *LOVAL    WWMODI
020300200529     C                     MOVE *LOVAL    WWTDSS
020400200529     C**********           Z-ADD*LOVAL    WWTRNB                                              CLE148
020500200529     C                     MOVEL*LOVAL    WWTRNB                                              CLE148
020600200529     C*
020700200529     C***********PSTMKY    SETLLPMPSTMPP                                  S01486
020800200529     C***********PSTMK1    READEPMPSTMPP                 61               S01486
020900200529     C           PSTMKY    SETLLPMPSTMQ0                                  S01486
021000200529     C           PSTMK1    READEPMPSTMQ0                 61               S01486
021100200529     C*
021200200529     C** DO WHILE START OF MONTH RECORDS READ FOR PERFORMANCE PERIOD
021300200529     C           *IN61     DOWEQ'0'                        B3
021400200529     C***********          MOVE 'N'       QFPPRC                          S01486
021500200529     C                     MOVE 'N'       GFPPRC                          S01486
0216002005290    C*
021700200529     C** FORMAT ACCOUNT CODE AND ACCOUNT SEQUENCE
021800200529     C           QFMODI    IFEQ 'RE'                       B4
021900200529     C***********          MOVE WWACOD    QFACOD                          S01486
022000200529     C***********          MOVE WWACSQ    QFACSQ                          S01486
022100200529     C                     MOVE WWACOD    GFACOD                          S01486
022200200529     C                     MOVE WWACSQ    GFACSQ                          S01486
022300200529     C*                                                                   CPM005
022400200529     C** SET UP NARRATIVE FOR POOL PORTFOLIO                              CPM005
022500200529     C           QFTXT2    IFEQ *BLANKS                                   CPM005
022600200529     C                     MOVE RETA,1    GFTXT2                          CPM005
022700200529     C                     MOVELQFCCY1    GFTXT2                          CPM005
022800200529     C                     END                                            CPM005
022900200529     C*                                                                   CPM005
023000200529     C                     ELSE                            X4
023100200529     C***********          Z-ADD0         QFACOD                          S01486
023200200529     C***********          Z-ADD0         QFACSQ                          S01486
023300200529     C                     Z-ADD0         GFACOD                          S01486
023400200529     C                     Z-ADD0         GFACSQ                          S01486
023500200529     C                     END                             E4
023600200529     C*                                                                   53103
023700200529     C*  SET 'REFERENCE/SHORTNAME' AND 'EXISTED AT START'                 53103
023800200529     C                     SELEC                                          53103
023900200529     C           QFMODI    WHEQ 'SE'                                      53103
024000200529     C                     MOVELQFTDSS    GFRESH    P                     53103
024100200529     C*                                                                   CPM005
024200200529     C           QFVDAT    IFNE 0                                         CPM005
024300200529     C           FCTVPS    ANDEQ'V'                                       091999
024400200529     C           QFAMT1    IFLT 0                                         CPM005
024500200529     C                     MOVE 'S'       WWORK9  9                       CPM005
024600200529     C                     ELSE                                           CPM005
024700200529     C                     MOVE 'B'       WWORK9                          CPM005
024800200529     C                     END                                            CPM005
024900200529     C*                                                                   CPM005
025000200529     C                     Z-ADDQFVDAT    ZDAYNO                          CPM005
025100200529     C                     EXSR ZDATE2                                    CPM005
025200200529     C                     MOVELZDATE     WWORK9                          CPM005
025300200529     C*                                                                   CPM005
025400200529     C                     MOVE WWORK9    GFRESH                          CPM005
025500200529     C                     END                             E5             CPM005
025600200529     C*                                                                   CPM005
025700200529     C           QFMODI    WHEQ 'RE'                                      53103
025800200529     C                     MOVELQFTXT2    GFRESH                          53103
025900200529     C           QFMODI    WHEQ 'FO'                                      075998
026000200529     C                     MOVELQFFPSI    GFRESH                          075998
026100200529     C           QFMODI    WHEQ 'FM'                                      075998
026200200529     C                     MOVELQFFPSI    GFRESH                          075998
026300200529     C                     OTHER                                          53103
026400200529     C                     MOVELQFTRNB    GFRESH    P                     53103
026500200529     C                     ENDSL                                          53103
026600200529     C                     MOVE 'Y'       GFEXST                          53103
026700200529     C*                                                                   S01486
026800200529     C**********           Z-ADDQFCNUM    GFCNUM                                       S01486 CSD027
026900200529     C                     MOVE QFCNUM    GFCNUM                                              CSD027
027000200529     C**********           Z-ADDQFLIND    GFLIND                                       S01486 CER020
027100200529     C                     MOVE QFLOIC    GFLOIC                                              CER020
027200200529     C                     Z-ADDQFAMT1    GFAMT1                          S01486
027300200529     C                     Z-ADDQFACIS    GFACIS                          S01486
027400200529     C                     Z-ADDQFPLFX    GFPLFX                          S01486
027500200529     C                     Z-ADDQFMFXR    GFMFXR                          S01486
027600200529     C                     Z-ADDQFMPRC    GFMPRC                          S01486
027700200529     C**********           Z-ADDQFTRNB    GFTRNB                                       S01486 CLE148
027800200529     C                     MOVELQFTRNB    GFTRNB                                              CLE148
027900200529     C                     Z-ADDQFCDP1    GFCDP1                          095867
028000200529     C                     Z-ADDQFMFXD    GFMFXD                          095867
028100200529     C                     Z-ADDQFNMDP    GFNMDP                          095867
028200200529     C                     MOVELQFSPBS    GFSPBS                          095867
028300200529     C                     MOVELQFPTFR    GFPTFR                          S01486
028400200529     C                     MOVELQFINNR    GFINNR                          S01486
028500200529     C                     MOVELQFVALG    GFVALG                          S01486
028600200529     C                     MOVELQFCCY1    GFCCY1                          S01486
028700200529     C                     MOVELQFCNTR    GFCNTR                          S01486
028800200529     C                     MOVELQFTDSS    GFTDSS                          S01486
028900200529     C                     MOVELQFMFMD    GFMFMD                          S01486
029000200529     C                     MOVELQFMODI    GFMODI                          S01486
029100200529     C                     MOVELQFBYSF    GFBYSF                          S01486
029200200529     C                     MOVELQFFOIS    GFFOIS                          S01486
029300200529     C                     MOVELQFTXT2    GFTXT2                          S01486
029400200529     C                     MOVELQFSTMN    GFSTMN                          S01486
029500200529     C                     Z-ADDQFTKDM    GFTKDM                          075998
029600200529     C                     Z-ADDQFMNPF    GFMNPF                          075998
029700200529     C                     Z-ADDQFTKVL    GFTKVL                          075998
029800200529     C*                                                                   72242
029900200529     C** USE INSTRUMENT FROM ENDING POSITION                              72242
030000200529     C           ALTKY     CHAINPMCPIMQ0             64                   72242
030100200529     C           *IN64     IFEQ '0'                                       72242
030200200529     C                     MOVE GEINNR    GFINNR                          72242
030300200529     C                     END                                            72242
030400200529     C           QFVDAT    IFEQ 0                                         097158
030500200529     C           QFVDAT    ORGE BJRDNB                                    097158
030600200529      *                                                                   097158
030700200529     C                     Z-ADDQFVDAT    Q0VDAT                          097158
030800200529     C                     Z-ADDQFVDAT    Q1VDAT                          097158
030900200529     C                     WRITEPMPSTCP1                                  72242
031000200529     C*
031100200529     C                     WRITEPMPSTCP0
031200200529     C                     ADD  1         RRCT1
031300200529      *                                                                   097158
031400200529     C                     END                                            097158
031500200529     C*
031600200529     C***********PSTMK1    READEPMPSTMPP                 61               S01486
031700200529     C           PSTMK1    READEPMPSTMQ0                 61               S01486
031800200529     C                     END                             E3
031900200529     C*
032000200529     C                     END                             E2
032100200529     C*  NEW PROCESSING FOR PERFORMANCE RECONCILIATION                    53103
032200200529     C           KTRAL2    CHAINPMPTRAL2             63                   53103
032300200529     C*                                                                   53103
032400200529     C           *IN63     DOWEQ*OFF                                      53103
032500200529     C*                                                                   53103
032600200529     C           QUMODI    IFEQ 'SE'                                      53103
032700200529     C                     MOVELQUTDSS    GFRESH    P                     72242
032800200529     C                     ELSE                                           53103
032900200529     C                     MOVELQUTRNB    GFRESH    P                     72242
033000200529     C                     ENDIF                                          53103
033100200529     C*                                                                   53103
033200200529     C**********           Z-ADDQUCNUM    GFCNUM                                        72242 CSD027
033300200529     C                     MOVE QUCNUM    GFCNUM                                              CSD027
033400200529     C                     MOVE QUPTFR    GFPTFR                          72242
033500200529     C                     MOVE QUMODI    GFMODI                          72242
033600200529     C           ALTKY     CHAINPMCPSTQ0             64                   72242
033700200529     C*                                                                   53103
033800200529     C           *IN64     IFEQ *ON                                       53103
033900200529     C*                                                                   53103
034000200529     C**********           Z-ADDQUCNUM    GFCNUM                                        53103 CSD027
034100200529     C                     MOVE QUCNUM    GFCNUM                                              CSD027
034200200529     C                     MOVE QUPTFR    GFPTFR                          53103
034300200529     C                     MOVE QUINNR    GFINNR                          53103
034400200529      *                                                                   182961
034500200529      ** Instrument type is defaulted from PF/SDPORTPD if a blank         182961
034600200529      ** instrument type is found.                                        182961
034700200529      ** Indicator 35 was used as the operation's resulting indicator.    182961
034800200529      *                                                                   182961
034900200529     C           GFINNR    IFEQ *BLANKS                                   182961
035000200529     C           1         SETLLSDPORTPD                                  182961
035100200529     C                     READ SDPORTPD                 35               182961
035200200529     C                     MOVE FCDINR    GFINNR                          182961
035300200529     C                     ENDIF                                          182961
035400200529     C*                                                                   53103
035500200529     C                     CALL 'AOPLINR0'                                53103
035600200529     C                     PARM '*MSG    'WWRTCD  7                       53103
035700200529     C                     PARM '*KEY    'WWOPTN  7                       53103
035800200529     C                     PARM GFINNR    WWKEY3  3                       53103
035900200529     C           SDPLIN    PARM SDPLIN    DSFDY                           53103
036000200529     C           WWRTCD    IFNE *BLANKS                                   53103
036100200529     C           *LOCK     IN   LDA                                       53103
036200200529     C                     Z-ADD3         DBASE            ***************53103
036300200529     C                     MOVEL'SDPLINPD'DBFILE           * DBERROR  003 53103
036400200529     C                     MOVELGFINNR    DBKEY            ***************53103
036500200529     C                     OUT  LDA                                       53103
036600200529     C                     EXSR *PSSR                                     53103
036700200529     C                     END                                            53103
036800200529     C*                                                                   53103
036900200529     C                     MOVE PDVALG    GFVALG                          53103
037000200529     C                     MOVE QUCCY     GFCCY1                          53103
037100200529     C                     MOVE QUNMDP    GFCDP1                          53103
037200200529     C                     MOVE FCCNCD    GFCNTR                          53103
037300200529     C**********           MOVE FCLICD    GFLIND                                        53103 CER020
037400200529     C                     MOVE FCLICD    GFLOIC                                              CER020
037500200529     C                     MOVE QUTDSS    GFTDSS                          53103
037600200529     C                     Z-ADD0         GFAMT1                          53103
037700200529     C                     Z-ADD0         GFACIS                          53103
037800200529     C                     Z-ADD0         GFPLFX                          53103
037900200529     C                     Z-ADD0         GFMFXR                          53103
038000200529     C                     MOVE *BLANK    GFMFMD                          53103
038100200529     C                     Z-ADD0         GFMPRC                          53103
038200200529     C**********           Z-ADDQUTRNB    GFTRNB                                        53103 CLE148
038300200529     C                     MOVELQUTRNB    GFTRNB                                              CLE148
038400200529     C                     MOVE QUMODI    GFMODI                          53103
038500200529     C                     MOVE *BLANKS   GFBYSF                          53103
038600200529     C                     MOVE *BLANKS   GFFOIS                          53103
038700200529     C                     MOVE *BLANKS   GFTXT2                          53103
038800200529     C                     Z-ADD0         GFACOD                          53103
038900200529     C                     Z-ADD0         GFACSQ                          53103
039000200529     C                     MOVE QRPMSM    GFSTMN                          53103
039100200529     C                     Z-ADD0         GFMFXD                          53103
039200200529     C                     MOVE WWRESH    GFRESH                          53103
039300200529     C                     MOVE 'N'       GFEXST                          53103
039400200529     C                     Z-ADDQUNMDP    GFNMDP                          72242
039500200529     C                     MOVE QUSPBS    GFSPBS                          72242
039600200529     C*                                                                   53103
039700200529     C           QFVDAT    IFEQ 0                                         097158
039800200529     C           QFVDAT    ORGE BJRDNB                                    097158
039900200529     C                     Z-ADDQFVDAT    Q0VDAT                          097158
040000200529     C                     WRITEPMPSTCP0                                  53103
040100200529     C                     END                                            097158
040200200529     C*                                                                   53103
040300200529     C                     ENDIF                                          53103
040400200529     C*                                                                   53103
040500200529     C                     READ PMPTRAL2                 63               53103
040600200529     C                     ENDDO                                          53103
040700200529     C*
040800200529     C***********          READ PMPFMRPP                 60               S01486
040900200529     C                     READ PMPFMRPD                 60               S01486
041000200529     C                     END                             E1
041100200529     C*
041200200529     C** OUTPUT AUDIT REPORT
041300200529     C                     WRITEHEADER
041400200529     C                     WRITECONTROL                                   S01486
041500200529     C*                                                                   S01486
041600200529     C** Check if no details to report                                    S01486
041700200529     C*                                                                   S01486
041800200529     C           RRCT1     IFEQ *ZERO                                     S01486
041900200529     C                     WRITENODTLS                                    S01486
042000200529     C                     END                                            S01486
042100200529     C*
042200200529     C** TERMINATE PROGRAM
042300200529     C                     MOVE '1'       *INLR
042400200529     C                     RETRN
042500200529     C*
042600200529     C********************************************************************
042700200529     C**                                                              *
042800200529     C**   #A        - INITIAL PROCESSING                             *
042900200529     C**                                                              *
043000200529     C**   CALLS     - *PSSR                                          *
043100200529     C**                                                              *
043200200529     C**   CALLED BY - MAINLINE                                       *
043300200529     C**                                                              *
043400200529     C*****************************************************************
043500200529     C*
043600200529     C           #A        BEGSR
043700200529     C*
043800200529     C***KEY*FOR*PMPSTMPP**********************************************   S01486
043900200529     C** KEY FOR PMPSTMQ0                                                 S01486
044000200529     C           PSTMKY    KLIST
044100200529     C                     KFLD           QRCNUM
044200200529     C                     KFLD           QRPTFR
044300200529     C                     KFLD           QRPMSM
044400200529     C                     KFLD           WWMODI  2
044500200529     C                     KFLD           WWTDSS 10
044600200529     C**********           KFLD           WWTRNB  60                                          CLE148
044700200529     C                     KFLD           WWTRNB  6                                           CLE148
044800200529     C*
044900200529     C           PSTMK1    KLIST
045000200529     C                     KFLD           QRCNUM
045100200529     C                     KFLD           QRPTFR
045200200529     C                     KFLD           QRPMSM
045300200529     C*
045400200529     C           PSTCKY    KLIST
045500200529     C                     KFLD           QRCNUM
045600200529     C                     KFLD           QRPTFR
045700200529     C                     KFLD           QRPMSM
045800200529     C           KTRAL2    KLIST                                          53103
045900200529     C                     KFLD           QRCNUM                          53103
046000200529     C                     KFLD           QRPTFR                          53103
046100200529     C                     KFLD           QRPMSD                          53103
046200200529     C*                                                                   53103
046300200529     C           KPSTC     KLIST                                          53103
046400200529     C                     KFLD           QUCNUM                          53103
046500200529     C                     KFLD           QUPTFR                          53103
046600200529     C                     KFLD           QRPMSM                          53103
046700200529     C                     KFLD           QUINNR                          53103
046800200529     C                     KFLD           WWRESH 20                       53103
046900200529     C                     KFLD           QUMODI                          53103
047000200529     C*                                                                   53103
047100200529     C*                                                                   72242
047200200529     C           ALTKY     KLIST                                          72242
047300200529     C                     KFLD           QFCNUM                          72242
047400200529     C                     KFLD           QFPTFR                          72242
047500200529     C                     KFLD           GFRESH                          72242
047600200529     C                     KFLD           QFMODI                          72242
047700200529     C*                                                                   S01486
047800200529     C**  Copyright statement                                             S01486
047900200529     C*                                                                   S01486
048000200529     C                     MOVEACPY@      ACT@   80                       S01486
048100200529     C*
048200200529     C** INITIALISE DB ERROR FIELDS AND STORE PROGRAM NAME FOR DB
048300200529     C** ERROR FIELD
048400200529     C*                                                                   S01486
048500200529     C           *NAMVAR   DEFN           LDA                             S01486
048600200529     C*                                                                   S01486
048700200529     C           *LOCK     IN   LDA                                       S01486
048800200529     C                     MOVE *BLANKS   DBFILE
048900200529     C                     MOVE *BLANKS   DBKEY
049000200529     C                     Z-ADD*ZEROS    DBASE
049100200529     C                     MOVEL'PM1640'  DBPGM
049200200529     C                     OUT  LDA                                       S01486
049300200529     C***********                                                         S01486
049400200529     C***ACCESS*LF/SDBANKL1*TO*OBTAIN*BANK*DETAILS*********************   S01486
049500200529     C***********          READ SDBANKL1                 70               S01486
049600200529     C***********                                                         S01486
049700200529     C***IF*RECORD*NOT*FOUND*OR*LAST*CHANGE*TYPE*=*'D'*THEN*DB*ERROR***   S01486
049800200529     C************IN70     IFEQ '1'                                       S01486
049900200529     C*                                                                   S01486
050000200529     C** Get bank details using access object                             S01486
050100200529     C*                                                                   S01486
050200200529     C                     CALL 'AOBANKR0'                                S01486
050300200529     C                     PARM *BLANKS   P@RTCD  7                       S01486
050400200529     C                     PARM '*FIRST ' P@OPTN  7                       S01486
050500200529     C           SDBANK    PARM SDBANK    DSFDY                           S01486
050600200529     C*                                                                   S01486
050700200529     C** Check if an error occurred                                       S01486
050800200529     C*                                                                   S01486
050900200529     C           P@RTCD    IFNE *BLANKS                                   S01486
051000200529     C           *LOCK     IN   LDA                                       S01486
051100200529     C                     Z-ADD1         DBASE            ****************
051200200529     C***********          MOVEL'SDBANKL1'DBFILE           * DBERROR  001 S01486
051300200529     C                     MOVE 'SDBANKPD'DBFILE           * DBERROR  001 S01486
051400200529     C                     MOVE *BLANKS   DBKEY            ****************
051500200529     C                     OUT  LDA                                       S01486
051600200529     C                     EXSR *PSSR
051700200529     C                     END
051800200529     C**
051900200529     C                     CALL 'AOPORTR0'                                53103
052000200529     C                     PARM *BLANKS   WWRTCD                          53103
052100200529     C                     PARM '*FIRST  'WWOPTN                          53103
052200200529     C           SDPORT    PARM SDPORT    DSFDY                           53103
052300200529     C           WWRTCD    IFNE *BLANKS                                   53103
052400200529     C           *LOCK     IN   LDA                                       53103
052500200529     C                     Z-ADD2         DBASE            ***************53103
052600200529     C                     MOVEL'SDPORTPD'DBFILE           * DBERROR  002 53103
052700200529     C                     MOVE *BLANKS   DBKEY            ***************53103
052800200529     C                     OUT  LDA                                       53103
052900200529     C                     EXSR *PSSR                                     53103
053000200529     C                     END                                            53103
053100200529     C*                                                                   CPM005
053200200529     C           BJDFIN    IFEQ 'M'                                       CPM005
053300200529     C                     MOVE '1'       *IN98                           CPM005
053400200529     C                     END                                            CPM005
053500200529     C*                                                                   CPM005
053600200529     C**  SET UP PARAMETER TO RETRIEVE MESSAGE FROM MESSAGE FILE          CPM005
053700200529     C           PLLANG    PLIST                                          CPM005
053800200529     C                     PARM           MSMBR4  7                       CPM005
053900200529     C                     PARM           MSGER  10                       CPM005
054000200529     C                     PARM           MSGTXT 80                       CPM005
054100200529     C*                                                                   CPM005
054200200529     C                     MOVEL'PMUSRMSG'MSGER                           CPM005
054300200529     C*                                                                   CPM005
054400200529     C                     MOVEL'PM16300' MSMBR4                          CPM005
054500200529      *                                                                   CPM005
054600200529     C                     CALL 'SDRTVTXT'PLLANG                          CPM005
054700200529     C                     MOVELMSGTXT    RETA,1    P                     CPM005
054800200529     C*
054900200529     C                     ENDSR
055000200529     C*****************************************************************
055100200529     C/EJECT
055200200529     C*****************************************************************
055300200529     C**                                                              *
055400200529     C**   *PSSR     - Program error handling routine                 *
055500200529     C**                                                              *
055600200529     C*****************************************************************
055700200529     C*
055800200529     C           *PSSR     BEGSR
055900200529     C*                                                                   S01486
056000200529     C                     WRITEHEADER                                    S01486
056100200529     C                     WRITEDBERROR                                   S01486
056200200529     C                     DUMP
056300200529     C*
056400200529     C                     MOVE '1'       *INU7
056500200529     C                     MOVE '1'       *INU8
056600200529     C                     MOVE '1'       *INLR
056700200529     C*                                                                   S01486
056800200529     C                     RETRN                                          S01486
056900200529     C*
057000200529     C                     ENDSR
057100200529     C/EJECT                                                              CPM005
057200200529      /COPY ZSRSRC,ZDATE2Z2                                               CPM005
057300200529**  CPY@
057400200529(c) Finastra International Limited 2001
057500200529**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN                      CPM005
0576002005290366073110961461
057700200529**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                        CPM005
057800200529000031059090120151181212243273304334365
057900200529**   ZMNM - MONTHS SHORT NAMES                                            CPM005
058000200529JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
