     H***********                                                         S01486
     H        1                                                           S01486
     F*****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Deals file enquiry')                          *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management                                 *
     F*                                                               *
     F*  PM2000 - PM Deals File Details Enquiry                       *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD053295           Date 13Apr19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CDL099             Date 06Oct17               *
      *                 CGL165             Date 15Feb17               *
      *                 CDL096             Date 22Sep14               *
      *                 CDL094             Date 11Jun14               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE148             Date 23Jul12               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26839           Date 05Jan10               *
      *                 CER054             Date 07Apr09               *
      *                 BUG22911           Date 17Feb09               *
      *                 CER016A            Date 19May08               *
      *                 CER048             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CDL049             Date 11Jul06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027A            Date 10May06               *
      *                 CSD027             Date 09Dec05               *
      *                 237063             Date 20Nov05               *
      *                 CDL038             Date 10May05               *
      *                 CGL035             Date 01Mar05               *
      *                 235115             Date 25Jul05               *
      *                 234689             Date 12Jul05               *
      *                 BUG7411            Date 01Jun05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CDL028             Date 07Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 17May01               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 145170             Date 04Nov98               *
      *                 143270             Date 02Nov98               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CDL006             Date 26Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 126017             Date 14Nov97               *
      *                 121768             Date 20Feb98               *
     F*                 097885             DATE 03FEB97               *
     F*                 074286             DATE 08AUG94               *
     F*                 CPM005             DATE 11JUL96               *
     F*                 CPM004             DATE 08FEB96               *
     F*                 095022             DATE 07NOV95               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 094529             DATE 13OCT95               *
     F*                 085817             DATE 13MAR95               *
     F*                 081239             DATE 12JAN95               *
     F*                 081346             DATE 09JAN95               *
     F*                 S01486             DATE 11AUG94               *
     F*                 062278             DATE 18OCT93               *
     F*                 058645             DATE 04AUG93               *
     F*                 046057             DATE 28NOV92               *
     F*                 SA9108             DATE 06NOV91               *
     F*                 044719             DATE 15OCT92               *
     F*                 S01313             DATE 24AUG92               *
     F*                 R05661             DATE 11MAR91               *
     F*                 R00953             DATE 15NOV90               *
     F*                 R10056             DATE 02OCT90               *
     F*                 R10036             DATE 21SEP90               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD046248 - Finastra Rebranding                               *
      *  CDL099 - Split Value Date (Recompile)                        *
      *  CGL165 - Dual Withholding Tax (Recompile)                    *
      *  CDL096 - Business Day Conventions on MM Deals                *
      *           (Recompile)                                         *
      *  CDL094 - Enhance  Receive Settlement Instructions            *
      *           (Recompiled)                                        *
      *  AR996895 - Incorrect accrual interest calculation.           *
      *             (Child:AR996897) (Recompile)                      *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26839 - JA1_Threshold limit of the main joint customer was*
      *             utilized by the member                            *
      *  CER054 - German Features - Church Tax (Recompile)            *
      *  BUG22911 - Changes for Correct Tax Calculation               *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *           to Midas Plus (Recompile)                           *
      *  CER048 - German Features - Taxes                             *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027A - Conversion Of Customer Number to Alpha             *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  237063 - EU Tax fixes upgrade to MP build 103 (Recompile).   *
      *  CDL038 - Extended Deal Sub Type (Recompile)                  *
      *  CGL035 - EUSD Upgrade to Midasplus                           *
      *  235115 - Customer number incorrect to retrieve the settlement*
      *           account owner                                       *
      *  234689 - Missing EU Tax information on Portfolio Customer    *
      *           Selection - Deals Enquiry.                          *
      *  BUG7411- CDL028 fields missing from DLGHISPD (Recompile)     *
      *  CDL028 - Automatic Rate Interpolations (Recompile)           *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD006 - Use DSSDY for call to AOBSRTR0.                     *
      *  CIR004 - Dealing Calculation Method Change                   *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  145170 - 'C.d held by' must contain the value from DEALS file*
     F*           and not the customer number                         *
     F*           Review accrued interest calculation when 1st day    *
     F*           accrual and start date > rundate                    *
      *  CDL006 - Dealing Fiduciary.                                  *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  074286 - DESCRIPTION FOR DTYP 'TI' NOT FOUND                 *
     F*  CPM005 - Private Banking Phase II                            *
     F*           Focus Group Changes Upgraded to DBA                 *
     F*  CPM004 - Bank Portfolios                                     *
     F*  095022 - Add Interest Paid Separately to screen              *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  094529 - Historic deals are now kept on DLBHISPD / DLCHISPD  *
     F*  085817 - Recompile due to changes in PMLDAPD                 *
     F*  081239 - Signoff Rework - Wrong field still used             *
     F*  081346 - Wrong field used                                    *
     F*  S01486 - Portfolio Management Upgrade to Release 10          *
     F*  062278 - CORRECT INTEREST OUTPUT FOR DEALS NOT CALLED        *
     F*  058645 - MAKE DISPLAY OF INTEREST MORE USER FRIENDLY         *
     F*  046057 - DISPLAY MM LOAN/DEPOSIT WINDOW                      *
     F*  SA9108 - POOL SECURITIES TRANSACTIONS (ONLY RECOMPILED       *
     F*           FOR DTAARA/LDA)                                     *
     F*  044719 - CORRECT ROUNDING OF INTEREST FROM SR/GLINTC         *
     F*  S01313 - PORTFOLIO PERFORMANCE CHANGES                       *
     F*  R05661 - IF 9998 OR 9999 PORTFOLIO DISPLAYED OUTPUT THE      *
     F*           POSITION PORTFOLIO IN BRACKETS                      *
     F*  R00953 - MATURED DELAS NOT FOUND ON DEALS - ADD DEALSH       *
     F*  R10056 - DISPLAY BROKERAGE BLANK IF HIGH VALUE OR BLANK      *
     F*  R10036 - DISPLAY TEXT FOR CODES ON 'DEALS DETAILS            *
     F*           ENQUIRY' SCREEN FOR MM DEALS                        *
     F*                                                               *
     F*****************************************************************
     F**
     F***SDBSRTL1IF**E           K        DISK                     R10036 S01486
     F***********                                   KINFSR *PSSR   R10036 S01486
     F***PREFIX*'BA'********************************************** R10036 S01486
     F**
     F***PM2000DDCF**E                    WORKSTN                         S01486
     FPM2000DFCF  E                    WORKSTN                            S01486
     F**
     FDEALS   IF  E           K        DISK
     F            DEALSDAF                          KIGNORE
     F            DEALSDDF                          KIGNORE
     F            DEALSDEF                          KIGNORE
     F            DEALSDFF                          KIGNORE
     F                                              KINFSR *PSSR
     F**                                                                  R00953
     FDEALSH  IF  E           K        DISK                               R00953
     F            DEALSDBF                          KRENAMEDEALSDB1       R00953
     F            DEALSDCF                          KRENAMEDEALSDC1       R00953
     F            DEALSDDF                          KIGNORE               R00953
     F            DEALSDEF                          KIGNORE               R00953
     F*********** DEALSDGF                          KRENAMEDEALSDG R00953 S01486
     F            DEALSDGF                          KIGNORE               S01486
     F            DLDHISD0                          KIGNORE               094529
     F            DLEHISD0                          KIGNORE               094529
     F            DLGHISD0                          KIGNORE               094529
     FDLCCGDL0IF  E           K        DISK                           UC  CDL006
      ** DL Charge Types                                                  CDL006
      *                                                                   CDL006
     FSDJACCLBIF  E           K        DISK         KINFSR *PSSR                              234689
      ** Midas SD Joint A/c Member Details by Joint A/c No./Customer No.                      234689
      *                                                                                       234689
     FTABTB11 IF  E                    DISK                               145170
     F/COPY WNCPYSRC,PM2000F001
     F                                              KINFSR *PSSR          R00953
     F***SDMMODPDIF**E                    DISK                  UC  46057 S01486
     F***PREFIX*'**'***************************************************   S01486
     F**
     F***SDDLSTL0IF**E           K        DISK                            S01486
     F***********                                   KINFSR *PSSR          S01486
     F***PREFIX*'**'***************************************************   S01486
     F**
     F***SDBROKL0IF**E           K        DISK                            S01486
     F***********                                   KINFSR *PSSR          S01486
     F***PREFIX*'**'***************************************************   S01486
     F**
     F***SDCURRL0IF**E           K        DISK                            S01486
     F***********                                   KINFSR *PSSR          S01486
     F****************************************************************
     F******************************************************************
     F**                                                              **
     F**    F U N C T I O N   O F   I N D I C A T O R S               **
     F**                                                              **
     F******************************************************************
     F**  U7 - PROGRAM ERROR
     F**  U8 - DATA BASE ERROR
     F**
     F**  KC - TO EXIT JOB
     F**  KL - TO RETURN TO PREVIOUS PROGRAM
     F**
     F**  05-07 - TO DETERMINE WHICH FORMAT HAS BEEN READ (LF/DEALS)
      *   52    - CGL031 (Taxation of Savings Income) is enabled.                             234689
     F**  60-68 - DISPLAY FILE INDICATOR
     F**  71    - FILE PROCESSING
     F**  72    - TEST BIT OPERATION
     F**  74    - PORTFOLIOS SUPPORTED INDICATOR                          CPM004
     F**
     F**  90-99 - STANDARD SUBROUTINES
     F**
     F**
     F******************************************************************
     E**
     E**
     E** TABLES AND ARRAYS
     E*********************************************************************
      ** ARRAY FOR COPYRIGHT
      *
     E                    CPY@    1   1 80
     E***********                                                         S01486
     E***ARRAY*TO*ENABLE*ATTENTION*KEY*********************************   S01486
     E***********                                                         S01486
     E***********         ATN     1   1 22                                S01486
     E**
      /COPY ZSRSRC,ZDATE2Z1
      /COPY ZSRSRC,ZSEDITZ1
     E/COPY ZSRSRC,ZDATE9Z1                                               S01486
      *                                                                   CDL006
      **  Arrays used to retrieve percentage of current range for         CDL006
      **  Deal Principal Amount.                                          CDL006
      *                                                                   CDL006
     E                    ZRA        14 15 0A                             CDL006
     E                    ZPE        15  7 0                              CDL006
     E/COPY WNCPYSRC,PM2000E001
     I*************************************************************
     I**
     I**
     I** IDENTIFICATION OF RECORD FORMATS OF LF/DEALS
     I**
     IDEALSDBF    05
     IDEALSDCF    06
     I***DEALSDGF****07                                                   S01486
     I**                                                                  R00953
     I** IDENTIFICATION OF RECORD FORMATS OF LF/DEALSH                    R00953
     I**                                                                  R00953
     IDEALSDB1    05                                                      R00953
     IDEALSDC1    06                                                      R00953
     IDLBHISD0    05                                                      094529
     IDLCHISD0    06                                                      094529
     I***DEALSDG1****07                                            R00953 S01486
     I**
     I***EXTERNAL*FORMAT*FOR*GROUP*DATA*AREA***************************   S01486
     I*****************************************************************   S01486
     I***WWGDA*****E*DSPMGRDAPP                                           S01486
     I**
     I***WWLDA*****E DSPMLDAPP                                            S01486
     IWWLDA     E DSPMLDAPD                                               S01486
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I*
     IPSDS       SDS
     I                                      244 253 WSID
     I                                      254 263 USID
     I*                                                                   58645
     IPMSTAT    E DS                                                      58645
     I                                       29  330WWLXTR                58645
     I                                        1 256 WWSTAT
     I**
     I** DATA STRUCTURE FOR SUBROUTINE ZSEDIT
     I**
     I            DS
     I                                        1  150ZFLD15
     I                                        1  15 ZFLDA
      /COPY ZSRSRC,ZSEDITZ2
     I/COPY ZSRSRC,ZINTDYZ1                                               S01486
     I/COPY ZSRSRC,ZDATE9Z2                                               S01486
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     I**                                                                  R10036
     I***DATA*STRUCTURE*FOR*KBSRT*KEY***************************** R10036 S01486
     I***********                                                  R10036 S01486
     I***DSBSRT******DS                                            R10036 S01486
     I****************************************1   3 BACYCD         R10036 S01486
     I****************************************4   5 BABSRC         R10036 S01486
     I**
     I*
     ICPYR@#      DS
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
      *                                                                   46057
      **Get*the*data*structure*passed*from*calling*program********* 46057 S01486
      *                                                                   46057
      ***/COPY*QWINDSRC,DL0170DTA                                   46057 S01486
     I*                                                                   S01486
     IRUNDAT    E DS                                                      S01486
     I**  Standard Data Area Layout for System flags and Run Date         S01486
     I*                                                                   S01486
     ISDMMOD    E DSSDMMODPD                                              S01486
     I**  Data structure for module details                               S01486
     I*                                                                   S01486
     ISCSARD    E DSSCSARDPD                                              095022
     I** Data structure for Switchable Features details                   095022
     I*                                                                   095022
     ISDBSRT    E DSSDBSRTPD                                              S01486
     I**  Data structure for Base Rate Codes details                      S01486
     I*                                                                   S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I**  Data structure for currency details                             S01486
     I*                                                                   S01486
     ISDDLST    E DSSDDLSTPD                                              S01486
     I**  Data structure for Deal Sub-types details                       S01486
     I*                                                                   S01486
     ISDBROK    E DSSDBROKPD                                              S01486
     I**  Data structure for Broker's Codes details                       S01486
     I*                                                                   S01486
     ISDCUST    E DSSDCUSTPD                                              CPM004
     I**  Data structure for Customer details                             CPM004
     I*                                                                   CPM004
     ISDBRCH    E DSSDBRCHPD                                                                  234689
     I              QQDFAC                          QQDFA1                                    CGL035
      **  Data structure for Branch Details                                                   234689
      *                                                                                       234689
     ISDCTTX    E DSSDCTTXPD                                                                  234689
      **  Data structure for Country of Tax Details                                           234689
      *                                                                                       234689
     ISDLOCN    E DSSDLOCNPD                                                                  234689
      **  Data structure for Location Details                                                 234689
      *                                                                                       234689
     ISDTXPA    E DSSDTXPAPD                                                                BUG22911
      ** Data structure for Tax Parameter File                                              BUG22911
      *                                                                                     BUG22911
     IDSFDY     E DSDSFDY                                                 S01486
     I**  Short data structure for access objects                         S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I**  Long data structure for access programs                         S01486
     I**
      *                                                                   CDL006
      **  Data-structure used to set up arrays ZRA and ZPE from           CDL006
      **  DL Charges Types logical file DLCCGDL0, to locate the highest   CDL006
      **  range for Principal amount.                                     CDL006
     I          E DSDLCCGDPD                                              CDL006
     I                                    P  31 1420ZRA                   CDL006
     I                                    P 143 2020ZPE                   CDL006
     I            DS                                                                          234689
     I                                        1   40P@ACCT                                    234689
     I                                        5   60P@ASEQ                                    234689
     I**********                              7  120P@CNUM                            234689 CSD027A
     I                                        7  12 P@CNUM                                   CSD027A
     I                                       13  140P@STYP                                    234689
     I/COPY WNCPYSRC,PM2000I001
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #INIT    - INITIALIZATION                                        *
      * #P01     - TO DETERMINE THE DEAL                                 *
      * #FXDEL   - PROCESSING OF FX DEALS                                *
      * #MMDEL   - PROCESSING OF MM DEALS                                *
      **#FRAIR***-*PROCESSING*OF*FRA/IRS*DEALS*************************  *S01486
      * #W01     - PROCESS SCREEN FOR FX DEALS                           *
      * #W02     - PROCESS SCREEN FOR MM DEALS                           *
      **#W03*****-*PROCESS*SCREEN*FOR*FRA*DEALS************************   S01486
      **#W04*****-*PROCESS*SCREEN*FOR*IRS*DEALS************************   S01486
      **#W05*****-*PROCESS*SCREEN*FOR*CCIRS*DEALS**********************   S01486
      **#W06*****-*PROCESS*SCREEN*FOR*IRC/C*DEALS**********************   S01486
      * ZDATE2   - TO CONVERT DAY NUMBER INTO ALPHA DATE                 *
      * ZSEDIT   - TO FORMAT NUMERIC FIELDS                              *
      * GLINTC   - TO CALCULATE INTEREST                                 *
      * ZSAVE    - TO SAVE INDICATORS (USED BY GLINTC)                   *
      * ZRSTOR   - TO RESTORE INDICATORS (USED BY GLINTC)                *
      * *PSSR    - PROCESSING OF DATA BASE ERRORS                        *
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      * PMC1010  - TO READ *GDA                                          *
      **QCMDEXC**-*SYSTEM*PROGRAM*USED*TO*SET*UP*ATTENTION*PROGRAM*****   S01486
      **PMC1000**-*TO*UPDATE**GDA**************************************   S01486
      **PMC1020**-*TO*TRANSFER*GROUP*JOBS******************************   S01486
      * SDRTVTXT - TO RETRIEVE MESSAGE FROM MESSAGE FILE                 *R10036
      *                                                                  *
      ********************************************************************
     C**************************************************************
     C** P R O G R A M   S T A R T
     C**************************************************************
     C           *ENTRY    PLIST
     C                     PARM           WWDEAL  6
     C**
     C** KEY LIST
     C**
     C***********KBSRT     KLIST                                   R10036 S01486
     C***********          KFLD           BACYCD                   R10036 S01486
     C***********          KFLD           BABSRC                   R10036 S01486
     C**
     C                     MOVE WWDEAL    WWDLNO  60
     C**
     C                     EXSR #INIT
     C**
     C                     EXSR #P01
     C**
     C                     RETRN
     C**
     C**************************************************************
     C** P R O G R A M   E N D
     C**************************************************************
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #INIT    - INITIALIZATION                                        *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1010**-*TO*READ**GDA*******************************************S01486
      **QCMDEXC**-*SYSTEM*PROGRAM*USED*TO*SET*UP*ATTENTION*PROGRAM********S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWTOTI   - TOTAL INTEREST                                        *
      **WWPARM***-*PARAMETER*USED*TO*TRANSFER**GDA************************S01486
      * WWFLD    - PARAMETER FOR QCMDEXC                                 *
      * WWNUMB   - PARAMETER FOR QCMDEXC                                 *
      *                                                                  *
      ********************************************************************
     C           #INIT     BEGSR
     C**
     C**
     C                     MOVEACPY@      CPY2@  80                       S01486
     C*                                                                   S01486
     C                     MOVE '0'       *IN
     C                     MOVE '0'       *INKL
     C                     MOVEL'J'       ZECODE
     C                     Z-ADD0         WWTOTI 150
     C**                                                                  CPM004
     C           *LIKE     DEFN BBCRNM    WWCRNM                          CPM004
     C*                                                                   S01486
     C**  Read in DTAARA/RUNDAT to get multibranching indicator           S01486
     C*                                                                   S01486
     C           *NAMVAR   DEFN           RUNDAT                          S01486
     C                     IN   RUNDAT                                    S01486
     C**
     C***RECEIVE*PARAMETERS*FROM*DATA*AREA**GDA************************   S01486
     C**  Receive parameters from data area *LDA                          S01486
     C**
     C                     CALL 'PMC1003'
     C                     PARM           WWLDA
     C**
     C***IF*ATTENTION*KEY*ENABLED*SET*THE*ATTENTION*PROGRAM*TO*********   S01486
     C***PMC0610*******************************************************   S01486
     C***********                                                         S01486
     C***********QMATTN    IFEQ 'Y'                                       S01486
     C***********                                                         S01486
     C***ENABLE*ATTENTION*PROGRAM**************************************   S01486
     C***********                                                         S01486
     C***********          MOVEAATN       WWFLD  22                       S01486
     C***********          Z-ADD22        WWNUMB 155                      S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM           WWFLD                           S01486
     C***********          PARM           WWNUMB                          S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C**                                                                  R10036
     C**  SET UP PARAMETER TO RETRIEVE MESSAGE FROM MESSAGE FILE          R10036
     C**                                                                  R10036
     C           PLLANG    PLIST                                          R10036
     C                     PARM           MSMBR4  7                       R10036
     C                     PARM           MSGER  10                       R10036
     C                     PARM           MSGTXT 80                       R10036
     C***********          MOVEL'MLGBMSGF'MSGER                    R10036 S01486
     C                     MOVEL'PMUSRMSG'MSGER                           S01486
      *                                                                   46057
      **  READ FILE SDMMODPD TO FIND IF WINDOW FLAG IS ON                 46057
     C***********          OPEN SDMMODPD                            46057 S01486
     C***********1         SETLLSDMMODPD                            46057 S01486
     C***********          READ SDMMODPD                 90         46057 S01486
     C************IN90     IFEQ '1'                                 46057 S01486
     C                     CALL 'AOMMODR0'                                S01486
     C                     PARM '*DBERR'  P@RTCD  7                       S01486
     C                     PARM '*FIRST'  P@OPTN  7                       S01486
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01486
     C           P@RTCD    IFNE *BLANK                                    S01486
     C                     Z-ADD1         QMERRN           ***************46057
     C                     MOVEL'Y'       QMDBER           **DB ERROR 01**46057
     C                     MOVEL'PM2000'  QMPGM            ***************46057
     C***********          MOVEL'SDMMODPD'QMFILE                    46057 S01486
     C                     MOVE 'SDMMODPD'QMFILE                          S01486
     C                     MOVE *BLANKS   QMKEY                           46057
     C*                                                                   46057
     C***UPDATE**GDA*WITH*DATABASE*ERROR*INFORMATION*************** 46057 S01486
     C***********          CALL 'PMC1002'                           46057 S01486
     C***********          PARM           WWGDA                     46057 S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C*                                                                   46057
     C** TERMINATE ENQUIRIES                                              46057
     C***********          CALL 'PMC1020'                           46057 S01486
     C                     EXSR *PSSR                                     S01486
     C                     END                                            46057
     C**                                                                  46057
     C***********          CLOSESDMMODPD                            46057 S01486
     C*                                                                   58645
     C** DEFINE DATA AREA PMSTAT                                          58645
     C           *NAMVAR   DEFN           PMSTAT                          58645
     C                     IN   PMSTAT                                    58645
     C*                                                                   S01486
     C           AGMBIN    IFEQ 'Y'                                       S01486
     C                     MOVE '1'       *IN39                           S01486
     C                     END                                            S01486
     C*                                                                   145170
     C* Retrive accrued on last day indicator ACLD on TABTB11             145170
     C*                                                                   145170
     C           1         SETLLTABTB11                                   145170
     C                     READ TABTB11                  99               145170
     C           *IN99     IFEQ '1'                                       145170
     C                     SETON                     U7U8                 145170
     C                     ELSE                                           145170
     C           RECI      IFNE 'D'                                       145170
     C                     SETON                     U7U8                 145170
     C                     END                                            145170
     C                     END                                            145170
     C*                                                                   095022
     C**   Check automatic rollover switched on                           095022
     C*                                                                   095022
     C                     CALL 'AOSARDR0'                                095022
     C                     PARM '*MSG   ' @RTCD   7                       095022
     C                     PARM '*KEY   ' @OPTN   7                       095022
     C                     PARM 'S01434'  @SARD   6                       095022
     C           SCSARD    PARM SCSARD    DSFDY                           095022
     C*                                                                   095022
     C           @RTCD     IFEQ *BLANKS                                   095022
     C                     SETON                     15                   095022
     C                     ELSE                                           095022
     C                     SETOF                     15                   095022
     C                     ENDIF                                          095022
      *                                                                   CDL006
      ** Access Switchable features file, Check if feature CDL006         CDL006
      ** is Switched on.                                                  CDL006
      *                                                                   CDL006
     C                     CALL 'AOSARDR0'                                CDL006
     C                     PARM *BLANKS   PRTCD   7                       CDL006
     C                     PARM '*VERIFY' POPTN   7                       CDL006
     C                     PARM 'CDL006'  PSARD   6                       CDL006
     C           SCSARD    PARM SCSARD    DSSDY                           CDL006
      *                                                                   CDL006
     C           PRTCD     IFNE *BLANK                                    CDL006
     C           PRTCD     ANDNE'*NRF '                                   CDL006
     C                     Z-ADD001       QMERRN           ***************CDL006
     C                     MOVEL'SCSARDPD'QMFILE           **DB ERROR 001*CDL006
     C                     MOVELPSARD     QMKEY            ***************CDL006
     C                     EXSR *PSSR                                     CDL006
     C                     ENDIF                                          CDL006
     C           PRTCD     IFEQ *BLANK                                    CDL006
     C                     MOVE 'Y'       CDL006  1                       CDL006
     C                     MOVE '1'       *IN51                           CDL006
     C                     ELSE                                           CDL006
     C                     MOVE 'N'       CDL006                          CDL006
     C                     MOVE '0'       *IN51                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                                       234689
      ** Check if CGL031 (Taxation of Savings Income) is enabled.                             234689
      *                                                                                       234689
     C                     CALL 'AOSARDR0'                                                    234689
     C                     PARM *BLANKS   PRTCD                                               234689
     C                     PARM '*VERIFY' POPTN                                               234689
     C                     PARM 'CGL031'  PSARD                                               234689
     C           SCSARD    PARM SCSARD    DSFDY                                               234689
      *                                                                                       234689
     C                     MOVE 'N'       CGL031  1                                           234689
     C                     MOVE *OFF      *IN52                                               234689
      *                                                                                       234689
     C           PRTCD     IFEQ *BLANKS                                                       234689
     C                     MOVE 'Y'       CGL031                                              234689
     C                     MOVE *ON       *IN52                                               234689
     C                     ELSE                                                               234689
      *                                                                                       234689
     C           PRTCD     IFNE '*NRF   '                                                     234689
     C                     MOVEL'SCSARDPD'QMFILE                                              234689
     C                     MOVEL'CGL031 ' QMKEY                                               234689
     C                     Z-ADD101       QMERRN                                              234689
     C                     EXSR *PSSR                                                         234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C                     ENDIF                                                              234689
      *                                                                   CDL006
      ** Open Charge type file if SAR is installed.                       CDL006
      *                                                                   CDL006
     C           CDL006    IFEQ 'Y'                                       CDL006
     C                     OPEN DLCCGDL0                                  CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           K01SEC    KLIST                                          CDL006
     C                     KFLD           W0CCY                           CDL006
     C                     KFLD           W0COM                           CDL006
      *                                                                   CDL006
     C/COPY WNCPYSRC,PM2000C001
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P01     - TO DETERMINE THE DEAL                                 *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1000**-*TO*UPDATE**GDA**************************************   S01486
      **PMC1020**-*TO*TRANSFER*GROUP*JOBS******************************   S01486
      * #FXDEL   - PROCESSING OF FX DEALS                                *
      * #MMDEL   - PROCESSING OF MM DEALS                                *
      **#FRAIR***-*PROCESSING*OF*FRA/IRS*DEALS*************************   S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWDLNO   - DEAL NUMBER                                           *
      **WWPARM***-*PARAMETER*USED*TO*TRANSFER**GDA*********************   S01486
      **WWEND****-*PARAMETER*FOR*PMC1020*******************************   S01486
      **WWGRPJ***-*PARAMETER*FOR*PMC1020*******************************   S01486
      * WWBRDP   - BROKER DECIMAL PLACES                                 *
      *                                                                  *
      ********************************************************************
     C           #P01      BEGSR
     C**
     C** ACCESS LF/DEALS USING THE DEAL NUMBER PARAMETER AS KEY
     C**
     C           WWDLNO    CHAINDEALS                70
     C**
     C           *IN70     IFEQ '1'                        B1             R00953
     C**                                                                  R00953
     C           WWDLNO    CHAINDEALSH               70                   R00953
     C**                                                                  R00953
     C           *IN70     IFEQ '1'                        B2             R00953
     C**                                                   ***************
     C                     Z-ADD1         QMERRN           **DB ERROR 01**
     C                     MOVEL'Y'       QMDBER           ***************
     C                     MOVEL'PM2000'  QMPGM
     C***********          MOVEL'DEALS'   QMFILE                          S01486
     C                     MOVE 'DEALS   'QMFILE                          S01486
     C                     MOVELWWDLNO    QMKEY
     C**
     C***UPDATE**GDA***************************************************   S01486
     C**
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C***********          CALL 'PMC1020'                                 S01486
     C                     EXSR *PSSR                                     S01486
     C**
     C                     END                             E2             R00953
     C**                                                                  R00953
     C                     END                             E1             R00953
     C*                                                                   R05661
     C** FOR 9998 AND 9999 PORTFOLIOS OUTPUT ADDITIONAL REFERENCE         R05661
     C           QMPTF1    IFEQ '9998'                                    R05661
     C           QMPTF1    OREQ '9999'                                    R05661
     C                     MOVE '1'       *IN17                           R05661
     C                     MOVEL'('       WWWRK5  5                       R05661
     C           PTFR      IFEQ '9997'                                    R05661
     C                     MOVE QMR997    WWWRK5                          R05661
     C                     ELSE                                           R05661
     C                     MOVE PTFR      WWWRK5                          R05661
     C                     END                                            R05661
     C                     MOVELWWWRK5    DDPTF1                          R05661
     C                     MOVE ')'       DDPTF1                          R05661
     C                     ELSE                                           R05661
     C                     MOVE '0'       *IN17                           R05661
     C                     MOVE *BLANKS   DDPTF1                          R05661
     C                     END                                            R05661
     C**
     C** SET THE STATUS NARRATIVE TO BE WRITTEN TO THE SCREEN
     C** ACCORDING TO THE RECORD ID FROM LF/DEALS
     C**
     C                     MOVEL*BLANKS   DDSTUS
     C**
     C           RECI      IFEQ 'M'
     C           RECI      OREQ 'N'
     C                     MOVEL'MATURED' DDSTUS
     C                     END
     C**
     C           RECI      IFEQ 'R'
     C                     MOVEL'REVER'   DDSTUS
     C                     MOVE 'SED'     DDSTUS
     C                     END
     C**
     C           RECI      IFEQ 'E'
     C                     MOVEL'EXPIRED' DDSTUS
     C                     END
     C**
     C                     MOVE *BLANKS   WWCRNM                          CPM004
     C           QMPORS    IFEQ 'B'                                       CPM004
     C**                                                                  CPM004
     C** CALL AOCUSTR0 TO GET DEAL CUSTOMER NAME                          CPM004
     C**                                                                  CPM004
     C                     MOVELCNUM      P@KEY1    P                     CPM004
     C                     CALL 'AOCUSTR0'                                CPM004
     C                     PARM *BLANKS   P@RTCD  7                       CPM004
     C                     PARM '*KEY   ' P@OPTN  7                       CPM004
     C                     PARM           P@KEY1 10                       CPM004
     C                     PARM *BLANKS   P@KYST  7                       CPM004
     C           SDCUST    PARM SDCUST    DSSDY                           CPM004
     C**                                                                  CPM004
     C           P@RTCD    IFEQ *BLANKS                                   CPM004
     C                     MOVE BBCRNM    WWCRNM                          CPM004
     C                     ENDIF                                          CPM004
     C                     ENDIF                                          CPM004
     C**
     C** ACCESS LF/SDDLSTL0 USING THE DEAL SUB TYPE FROM LF/DEALS
     C**
     C***********DLST      CHAINSDDLSTL0             71                   S01486
     C                     CALL 'AODLSTR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C                     PARM DLST      P@DLST  2                       S01486
     C           SDDLST    PARM SDDLST    DSFDY                           S01486
     C**
     C************IN71     IFEQ '1'                                       S01486
     C           P@RTCD    IFNE *BLANK                                    S01486
     C**
     C                     Z-ADD2         QMERRN           ***************
     C                     MOVEL'Y'       QMDBER           **DB ERROR 02**
     C                     MOVEL'PM2000'  QMPGM            ***************
     C***********          MOVEL'SDDLSTL0'QMFILE                          S01486
     C                     MOVE 'SDDLSTPD'QMFILE                          S01486
     C                     MOVELDLST      QMKEY
     C**
     C***UPDATE**GDA***************************************************   S01486
     C**
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C***END*GROUP*JOB*************************************************   S01486
     C**
     C**
     C***********          CALL 'PMC1020'                                 S01486
     C                     EXSR *PSSR                                     S01486
     C**
     C                     END
     C                     MOVELASDSTN    DDSUBT
     C**
     C** IF THE BROKER CODE FROM LF/DEALS IS NOT 'SWAP',
     C** 'MAIL','TELX','PHON' OR BLANK
     C**
     C           BRKC      IFNE 'SWAP'
     C           BRKC      ANDNE'MAIL'
     C           BRKC      ANDNE'TELX'
     C           BRKC      ANDNE'PHON'
     C           BRKC      ANDNE*BLANKS
     C**
     C** ACCESS SDBROKL0 FOR THE BROKER CURRENCY
     C**
     C***********BRKC      CHAINSDBROKL0             71                   S01486
     C                     CALL 'AOBROKR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C                     PARM BRKC      P@BRKC  4                       S01486
     C           SDBROK    PARM SDBROK    DSFDY                           S01486
     C**
     C************IN71     IFEQ '1'                                       S01486
     C           P@RTCD    IFNE *BLANK                                    S01486
     C**                                                   ***************
     C                     Z-ADD3         QMERRN           **DB ERROR 03**
     C                     MOVEL'Y'       QMDBER           ***************
     C                     MOVEL'PM2000'  QMPGM
     C***********          MOVEL'SDBROKL0'QMFILE                          S01486
     C                     MOVE 'SDBROKPD'QMFILE                          S01486
     C                     MOVELBRKC      QMKEY
     C**
     C***UPDATE**GDA***************************************************   S01486
     C**
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C***END*GROUP*JOB*************************************************   S01486
     C**
     C**
     C***********          CALL 'PMC1020'                                 S01486
     C                     EXSR *PSSR                                     S01486
     C**
     C                     END
     C**
     C** ACCESS SDCURRL0 FOR THE BROKER CURRENCY DECIMAL PLACES
     C**
     C***********A9BRCY    CHAINSDCURRL0             71                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C                     PARM A9BRCY    P@CCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C************IN71     IFEQ '1'                                       S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C**                                                   ***************
     C                     Z-ADD4         QMERRN           **DB ERROR 04**
     C                     MOVEL'Y'       QMDBER           ***************
     C                     MOVEL'PM2000'  QMPGM
     C***********          MOVEL'SDCURRL0'QMFILE                          S01486
     C                     MOVE 'SDCURRPD'QMFILE                          S01486
     C                     MOVELA9BRCY    QMKEY
     C**
     C***UPDATE**GDA***************************************************   S01486
     C**
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C***END*GROUP*JOB*************************************************   S01486
     C**
     C**
     C***********          CALL 'PMC1020'                                 S01486
     C                     EXSR *PSSR                                     S01486
     C**
     C                     END
     C                     Z-ADDA6NBDP    WWBRDP  10
     C**
     C                     END
     C**
     C** CHECK WHICH RECORD HAS BEEN READ
     C**
     C           *IN05     IFEQ '1'
     C                     EXSR #FXDEL
     C                     END
     C**
     C           *IN06     IFEQ '1'
     C                     EXSR #MMDEL
     C                     END
     C**
     C************IN07     IFEQ '1'                                       S01486
     C***********          EXSR #FRAIR                                    S01486
     C***********          END                                            S01486
     C***********                                                         081239
     C************INKC     IFEQ '1'                                       081239
     C***********                                                         081239
     C***SET*ENQUIRIES*TERMINATING*TO*'Y'*********************************081239
     C***********                                                         081239
     C***********          MOVEL'Y'       QMENQT                          081239
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C***********                                                   S01486081239
     C***UPDATE**LDA************************************************S01486081239
     C***********                                                   S01486081239
     C***********          CALL 'PMC1001'                           S01486081239
     C***********          PARM           WWLDA                     S01486081239
     C***********                                                         081239
     C***END*GROUP*JOB*************************************************   S01486
     C***********                                                         081239
     C***********                                                         081239
     C***********          CALL 'PMC1020'                                 S01486
     C***********                                                         081239
     C***********          END                                            081239
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #FXDEL   - PROCESSING OF FX DEALS                                *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1000**-*TO*UPDATE**GDA**************************************   S01486
      **PMC1020**-*TO*TRANSFER*GROUP*JOBS******************************   S01486
      * #W01     - PROCESS SCREEN FOR FX DEALS                           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - TO DETERMINE THE DEAL                                 *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      **WWPARM***-*PARAMETER*USED*TO*TRANSFER**GDA*********************   S01486
      **WWEND****-*PARAMETER*FOR*PMC1020*******************************   S01486
      **WWGRPJ***-*PARAMETER*FOR*PMC1020*******************************   S01486
      * WWPDEP   - PURCHASE CURRENCY DECIMAL PLACES                      *
      * WWSDEP   - SELL CURRENCY DECIMAL PLACES                          *
      *                                                                  *
      ********************************************************************
     C           #FXDEL    BEGSR
     C**
     C** SET THE DEAL TYPE NARRATIVE ACCORDING TO THE DEAL TYPE
     C** FROM LF/DEALS
     C**
     C           DTYP      IFEQ 'FP'
     C                     MOVE '1'       *IN60
     C                     END
     C**
     C           DTYP      IFEQ 'FS'
     C                     MOVE '1'       *IN61
     C                     END
     C**
     C           DTYP      IFEQ 'PI'
     C                     MOVE '1'       *IN62
     C                     END
     C**
     C           DTYP      IFEQ 'SI'
     C                     MOVE '1'       *IN63
     C                     END
     C**
     C           DTYP      IFEQ 'CX'
     C                     MOVE '1'       *IN64
     C                     END
     C**
     C           DTYP      IFEQ 'OP'
     C                     MOVE '1'       *IN65
     C                     END
     C**
     C           DTYP      IFEQ 'OT'
     C                     MOVE '1'       *IN66
     C                     END
     C**
     C           DTYP      IFEQ 'SW'
     C                     MOVE '1'       *IN67
     C                     END
     C**
     C** ACCESS LF/SDCURRL0 - FOR NUMBER OF DECIMAL USING THE PURCHASE
     C** CURRENCY
     C**
     C***********PUCY      CHAINSDCURRL0             71                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C                     PARM PUCY      P@CCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C************IN71     IFEQ '1'                                       S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C**                                                   ***************
     C                     Z-ADD5         QMERRN           **DB ERROR 05**
     C                     MOVEL'Y'       QMDBER           ***************
     C                     MOVEL'PM2000'  QMPGM
     C***********          MOVEL'SDCURRL0'QMFILE                          S01486
     C                     MOVE 'SDCURRPD'QMFILE                          S01486
     C                     MOVELPUCY      QMKEY
     C**
     C***UPDATE**GDA***************************************************   S01486
     C**
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C***END*GROUP*JOB*************************************************   S01486
     C**
     C**
     C***********          CALL 'PMC1020'                                 S01486
     C                     EXSR *PSSR                                     S01486
     C**
     C                     END
     C                     Z-ADDA6NBDP    WWPDEP  10
     C**
     C**
     C** ACCESS LF/SDCURRL0 - FOR NUMBER OF DECIMAL USING THE SELL
     C** CURRENCY
     C**
     C***********SLCY      CHAINSDCURRL0             71                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C                     PARM SLCY      P@CCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C************IN71     IFEQ '1'                                       S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C**                                                   ***************
     C                     Z-ADD6         QMERRN           **DB ERROR 06**
     C                     MOVEL'Y'       QMDBER           ***************
     C                     MOVEL'PM2000'  QMPGM
     C***********          MOVEL'SDCURRL0'QMFILE                          S01486
     C                     MOVE 'SDCURRPD'QMFILE                          S01486
     C                     MOVELSLCY      QMKEY
     C**
     C***UPDATE**GDA***************************************************   S01486
     C**
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C***END*GROUP*JOB*************************************************   S01486
     C**
     C**
     C***********          CALL 'PMC1020'                                 S01486
     C                     EXSR *PSSR                                     S01486
     C**
     C                     END
     C                     Z-ADDA6NBDP    WWSDEP  10
     C**
     C************INKC     DOUEQ'1'                                       081239
     C************INKL     OREQ '1'                                       081239
     C           QMENQT    DOUEQ'Y'                                       081239
     C           QMENQT    OREQ 'C'                                       081239
     C           QMENQT    OREQ 'P'                                       081239
     C           QMENQT    OREQ 'D'                                       081239
     C           *INKL     OREQ '1'                                       081239
     C***********                                                   S01486081239
     C***If*F22*pressed,*access*Enquiry*selection*screen************S01486081239
     C***********                                                   S01486081239
     C************INKW     IFEQ '1'                                 S01486081239
     C***********          CALL 'PMC0610'                           S01486081239
     C***********          END                                      S01486081239
     C**
     C                     EXSR #W01
     C**
     C                     EXFMTPM2000F1
     C*                                                                   081239
     C** If F3  pressed, exit program                                     081239
     C*                                                                   081239
     C           *INKC     IFEQ '1'                                       081239
     C                     MOVE 'Y'       QMENQT                          081239
     C                     CALL 'PMC1001'                                 081239
     C                     PARM           WWLDA                           081239
     C                     END                                            081239
     C**********                                                    081239CPM005
     C***If*F22*pressed, access Enquiry selection screen            081239CPM005
     C**********                                                    081239CPM005
     C********** *INKW     IFEQ '1'                                 081239CPM005
     C**********           CALL 'PMC0610'                           081239CPM005
     C**********                                                    081239CPM005
     C***Retrieve *LDA values                                       081239CPM005
     C**********                                                    081239CPM005
     C**********           CALL 'PMC1003'                           081239CPM005
     C**********           PARM           WWLDA                     081239CPM005
     C**********           END                                      081239CPM005
     C**
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #MMDEL   - PROCESSING OF MM DEALS                                *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1000**-*TO*UPDATE**GDA**************************************   S01486
      **PMC1020**-*TO*TRANSFER*GROUP*JOBS******************************   S01486
      * GLINTC   - TO CALCULATE INTEREST                                 *
      * #W02     - PROCESS SCREEN FOR MM DEALS                           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - TO DETERMINE THE DEAL                                 *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      **WWPARM***-*PARAMETER*USED*TO*TRANSFER**GDA*********************   S01486
      **WWEND****-*PARAMETER*FOR*PMC1020*******************************   S01486
      **WWGRPJ***-*PARAMETER*FOR*PMC1020*******************************   S01486
      * WWDCDP   - DEAL DECIMAL PLACES                                   *
      * WWTOTI   - TOTAL INTEREST                                        *
      *                                                                  *
      ********************************************************************
     C           #MMDEL    BEGSR
     C**
     C** SET THE DEAL TYPE NARRATIVE ACCORDING TO THE DEAL TYPE
     C** FROM DEALS
     C**
     C           DTYP      IFEQ 'PS'
     C                     MOVE '1'       *IN60
     C                     END
     C**
     C           DTYP      IFEQ 'IT'
     C                     MOVE '1'       *IN61
     C                     END
     C**
     C           DTYP      IFEQ 'IP'
     C                     MOVE '1'       *IN62
     C                     END
     C**
     C           DTYP      IFEQ 'CD'
     C                     MOVE '1'       *IN63
     C                     END
     C**
     C           DTYP      IFEQ 'CL'
     C                     MOVE '1'       *IN64
     C                     END
     C**
     C           DTYP      IFEQ 'LN'
     C                     MOVE '1'       *IN65
     C                     END
     C**
     C           DTYP      IFEQ 'TD'
     C                     MOVE '1'       *IN66
     C                     END
     C**
     C           DTYP      IFEQ 'DL'
     C                     MOVE '1'       *IN67
     C                     END
     C**
     C***  'TL' IS DRS DEAL TYPE ON MMDELDPP. ON DEALSDC DTYP = 'TI'      074286
     C********** DTYP      IFEQ 'TL'                                      074286
     C           DTYP      IFEQ 'TI'                                      074286
     C                     MOVE '1'       *IN68
     C                     END
     C**
     C           DTYP      IFEQ 'CI'
     C                     MOVE '1'       *IN69
     C                     END
      *                                                                   CDL006
      ** Display of type narrative 'FIDUCIARY DEPOSIT TERM PLACED'        CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FL'                                      CDL006
     C                     MOVE '1'       *IN75                           CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
      ** Display of type narrative 'FIDUCIARY DEPOSIT CALL PLACED'        CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'DP'                                      CDL006
     C                     MOVE '1'       *IN76                           CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
      ** Display of type narrative 'FIDUCIARY LOAN CALL PLACED'           CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'LP'                                      CDL006
     C                     MOVE '1'       *IN77                           CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
      ** Display of type narrative 'FIDUCIARY DEPOSIT TERM TAKEN'         CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FT'                                      CDL006
     C                     MOVE '1'       *IN78                           CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
      ** Display of type narrative 'FIDUCIARY DEPOSIT CALL TAKEN'         CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'DT'                                      CDL006
     C                     MOVE '1'       *IN79                           CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
      ** Display of type narrative 'FIDUCIARY LOAN CALL TAKEN'            CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'LT'                                      CDL006
     C                     MOVE '1'       *IN81                           CDL006
     C                     END                                            CDL006
      *                                                                   CDL006
     C**
     C** ACCESS LF/SDCURRL0 FOR NUMBER OF DECIMAL PLACES USING
     C** DEAL CURRENCY FROM LF/DEALS
     C**
     C***********CCY       CHAINSDCURRL0             71                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C                     PARM CCY       P@CCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C************IN71     IFEQ '1'                                       S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C**                                                   ***************
     C                     Z-ADD7         QMERRN           **DB ERROR 07**
     C                     MOVEL'Y'       QMDBER           ***************
     C                     MOVEL'PM2000'  QMPGM
     C***********          MOVEL'SDCURRL0'QMFILE                          S01486
     C                     MOVE 'SDCURRPD'QMFILE                          S01486
     C                     MOVELCCY       QMKEY
     C**
     C***UPDATE**GDA***************************************************   S01486
     C**
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C***END*GROUP*JOB*************************************************   S01486
     C**
     C**
     C***********          CALL 'PMC1020'                                 S01486
     C                     EXSR *PSSR                                     S01486
     C**
     C                     END
     C                     Z-ADDA6NBDP    WWDCDP  10
     C**
     C** IF THE MATURITY DATE IS NOT ZERO, CALCULATE THE TOTAL
     C** INTEREST
     C**
     C                     Z-ADD*ZERO     W@TOTI                                              234689
     C           MDAT      IFNE 0
     C                     Z-ADDPCPL      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C           NOTD      IFLT 0
     C                     Z-ADDIACD      ZIBEG
     C                     ELSE
     C                     Z-ADDVDAT      ZIBEG
     C                     END
     C                     Z-ADDMDAT      ZIEND
     C                     Z-ADDICBS      ZICALC
     C/COPY WNCPYSRC,PM2000C003
     C**
     C                     EXSR GLINTC
     C**
     C***                  Z-ADDZINTR     WWTOTI                          44719
     C                     Z-ADDZINTR     WWTOTI    H                     44719
     C**
     C           NOTD      IFLT 0
     C                     ADD  AITC      WWTOTI
     C                     ADD  AIAN      WWTOTI
     C                     ADD  AIAP      WWTOTI
     C                     END
     C                     END
     C                     Z-ADDWWTOTI    W@TOTI                                              234689
      *                                                                                       234689
     C                     MOVE 'Y'       WPOSI                                               234689
     C           W@TOTI    IFLT *ZERO                                                         234689
     C                     Z-SUBW@TOTI    W@TOTI 150                                          234689
     C                     MOVE 'N'       WPOSI   1                                           234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
      ** Calculate EU Tax if CGL031 is enabled.                                               234689
      *                                                                                       234689
     C                     Z-ADD*ZERO     WNTAMT 130                                          234689
      *                                                                                       234689
     C           CGL031    IFEQ 'Y'                                                           234689
      *                                                                                       234689
     C           DTYP      IFEQ 'CD'                                                          234689
     C           DTYP      OREQ 'TD'                                                          234689
     C           DTYP      OREQ 'DT'                                                          234689
     C           CDL006    ANDEQ'Y'                                                           234689
     C           DTYP      OREQ 'FT'                                                          234689
     C           CDL006    ANDEQ'Y'                                                           234689
     C                     EXSR SRCEUT                                                        234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C                     ENDIF                                                              234689
     C**
     C************INKC     DOUEQ'1'                                       081239
     C************INKL     OREQ '1'                                       081239
     C           QMENQT    DOUEQ'Y'                                       081239
     C           QMENQT    OREQ 'C'                                       081239
     C           QMENQT    OREQ 'P'                                       081239
     C           QMENQT    OREQ 'D'                                       081239
     C           *INKL     OREQ '1'                                       081239
     C***********                                                   S01486081239
     C***If*F22*pressed,*access*Enquiry*selection*screen************S01486081239
     C***********                                                   S01486081239
     C************INKW     IFEQ '1'                                 S01486081239
     C***********          CALL 'PMC0610'                           S01486081239
     C***********          END                                      S01486081239
     C**
     C                     EXSR #W02
     C**
     C                     EXFMTPM2000F2
      *                                                                   CDL006
      ** CMD13 / F13 was pressed, Display additional details only         CDL006
      ** if deal type is either FT/DT/LT (CDL006 is installed).           CDL006
      *                                                                   CDL006
     C           *INKM     IFEQ '1'                                       CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
      *                                                                   CDL006
     C           DTYP      IFEQ 'FT'                                      CDL006
     C           DTYP      OREQ 'DT'                                      CDL006
     C           DTYP      OREQ 'LT'                                      CDL006
     C                     MOVE LNKDN     SLNKDN                          CDL006
      *                                                                   CDL006
     C           W0END     DOUEQ'Y'                                       CDL006
      *                                                                   CDL006
      ** Format Charge amount in not equal to zero.                       CDL006
      *                                                                   CDL006
     C           FCGA      IFNE *ZEROS                                    CDL006
     C                     Z-ADDFCGA      ZFLD15                          CDL006
     C                     Z-ADDWWDCDP    ZDECS                           CDL006
     C                     EXSR ZSEDIT                                    CDL006
     C                     MOVE ZOUT21    S1FCGA                          CDL006
     C                     ELSE                                           CDL006
     C                     MOVE *BLANKS   S1FCGA                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** Format Commission Amount if not equal to zero.                   CDL006
      *                                                                   CDL006
     C           FCMA      IFNE *ZEROS                                    CDL006
     C                     Z-ADDFCMA      ZFLD15                          CDL006
     C                     Z-ADDWWDCDP    ZDECS                           CDL006
     C                     EXSR ZSEDIT                                    CDL006
     C                     MOVE ZOUT21    S1FCMA                          CDL006
     C                     ELSE                                           CDL006
     C                     MOVE *BLANKS   S1FCMA                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      **  Access SE Charges file for Commission Rate.                     CDL006
      *                                                                   CDL006
     C                     MOVE CCY       W0CCY   3                       CDL006
     C                     MOVE FCMC      W0COM   2                       CDL006
     C           K01SEC    CHAINDLCCGDL0             70                   CDL006
      *                                                                   CDL006
     C           *IN70     IFEQ '0'                                       CDL006
      *                                                                   CDL006
      **  If highest range not found try to find the range where the      CDL006
      **  Principal Amount is less or equal to the upper limit range      CDL006
      *                                                                   CDL006
     C           ZPE,1     IFNE 0                                         CDL006
     C                     Z-ADDPCPL      WPCPL  150                      CDL006
     C                     Z-ADD1         I       20                      CDL006
     C           ZRA,1     IFNE 0                                         CDL006
     C           WPCPL     LOKUPZRA,I                51  51               CDL006
     C  N51                Z-ADD15        I            51                 CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      **  Commission Rate is the percentage of the current range          CDL006
      *                                                                   CDL006
     C                     MOVE ZPE,I     W1CRAT  74                      CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           W1CRAT    IFNE *ZEROS                                    CDL006
     C                     MOVE W1CRAT    ZFLD15                          CDL006
     C                     Z-ADD4         ZDECS                           CDL006
     C                     EXSR ZSEDIT                                    CDL006
     C                     MOVE ZOUT21    S1CRAT                          CDL006
     C                     ELSE                                           CDL006
     C                     MOVE *BLANKS   S1CRAT                          CDL006
     C                     ENDIF                                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C           PCPL      ADD  TOTI      WWNET  140                      CDL006
     C                     SUB  FCGA      WWNET                           CDL006
     C                     SUB  FCMA      WWNET                           CDL006
      *                                                                   CDL006
     C           WWNET     IFNE *ZEROS                                    CDL006
     C                     Z-ADDWWNET     ZFLD15                          CDL006
     C                     Z-ADDWWDCDP    ZDECS                           CDL006
     C                     EXSR ZSEDIT                                    CDL006
     C                     MOVE ZOUT21    SNETSA                          CDL006
     C                     ELSE                                           CDL006
     C                     MOVE *BLANKS   SNETSA                          CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     EXFMTPM2000F3                                  CDL006
      *                                                                   CDL006
      ** CMD12/F12 was pressed, exit program                              CDL006
      *                                                                   CDL006
     C           *INKL     IFEQ '1'                                       CDL006
     C                     MOVE 'Y'       W0END   1                       CDL006
     C                     MOVE '0'       *INKL                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** CMD3/F3 was pressed, exit program                                CDL006
      *                                                                   CDL006
     C           *INKC     IFEQ '1'                                       CDL006
     C                     MOVE 'Y'       W0END                           CDL006
     C                     CALL 'PMC1001'                                 CDL006
     C                     PARM           WWLDA                           CDL006
     C                     ENDIF                                          CDL006
     C                     ENDDO                                          CDL006
     C                     ELSE                                           CDL006
      *                                                                   CDL006
      ** Otherwise, do not display additional details though CMD13 /F13   CDL006
      ** was pressed since deal type is none of FT/DT/LT (deal types).    CDL006
      *                                                                   CDL006
     C           W0WARN    DOUEQ'Y'                                       CDL006
     C                     EXFMTPM2000F4                                  CDL006
      *                                                                   CDL006
      ** CMD12/F12 was pressed, exit program                              CDL006
      *                                                                   CDL006
     C           *INKL     IFEQ '1'                                       CDL006
     C                     MOVE 'Y'       W0WARN  1                       CDL006
     C                     MOVE '0'       *INKL                           CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
      ** CMD3/F3 was pressed, exit program                                CDL006
      *                                                                   CDL006
     C           *INKC     IFEQ '1'                                       CDL006
     C                     MOVE 'Y'       W0WARN                          CDL006
     C                     CALL 'PMC1001'                                 CDL006
     C                     PARM           WWLDA                           CDL006
     C                     ENDIF                                          CDL006
     C                     ENDDO                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     ENDIF                                          CDL006
     C/COPY WNCPYSRC,PM2000C002
     C*                                                                   081239
     C** If F3  pressed, exit program                                     081239
     C*                                                                   081239
     C           *INKC     IFEQ '1'                                       081239
     C                     MOVE 'Y'       QMENQT                          081239
     C                     CALL 'PMC1001'                                 081239
     C                     PARM           WWLDA                           081239
     C                     END                                            081239
     C**********                                                    081239CPM005
     C***If*F22*pressed, access Enquiry selection screen            081239CPM005
     C**********                                                    081239CPM005
     C********** *INKW     IFEQ '1'                                 081239CPM005
     C**********           CALL 'PMC0610'                           081239CPM005
     C**********                                                    081239CPM005
     C***Retrieve *LDA values                                       081239CPM005
     C**********                                                    081239CPM005
     C**********           CALL 'PMC1003'                           081239CPM005
     C**********           PARM           WWLDA                     081239CPM005
     C**********           END                                      081239CPM005
     C**
      *                                                                   CDL006
      ** Close opened file DLCCGDL0 if CMD12/F12 is issued from the       CDL006
      ** first screen (Feature CDL006 is installed).                      CDL006
      *                                                                   CDL006
     C           *INKL     IFEQ '1'                                       CDL006
     C           CDL006    ANDEQ'Y'                                       CDL006
     C                     CLOSEDLCCGDL0                                  CDL006
     C                     ENDIF                                          CDL006
      *                                                                   CDL006
     C                     END
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      ***********                                                         S01486
      **#FRAIR***-*PROCESSING*OF*FRA/IRS*DEALS*************************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLS:**********************************************   S01486
      **PMC1000**-*TO*UPDATE**GDA**************************************   S01486
      **PMC1020**-*TO*TRANSFER*GROUP*JOBS******************************   S01486
      **#W03*****-*PROCESS*SCREEN*FOR*FRA*DEALS************************   S01486
      **#W04*****-*PROCESS*SCREEN*FOR*IRS*DEALS************************   S01486
      **#W05*****-*PROCESS*SCREEN*FOR*CCIRS*DEALS**********************   S01486
      **#W06*****-*PROCESS*SCREEN*FOR*IRC/C*DEALS**********************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLED*FROM:****************************************   S01486
      **#P01*****-*TO*DETERMINE*THE*DEAL*******************************   S01486
      ***********                                                         S01486
      **ROUTINE*USES*VARIABLES:****************************************   S01486
      **WWPARM***-*PARAMETER*USED*TO*TRANSFER**GDA*********************   S01486
      **WWEND****-*PARAMETER*FOR*PMC1020*******************************   S01486
      **WWGRPJ***-*PARAMETER*FOR*PMC1020*******************************   S01486
      **WWODCP***-*OUR*CURRENCY*DECIMAL*PLACES*************************   S01486
      **WWTDCP***-*THEIR*CURRENCY*DECIMAL*PLACES***********************   S01486
      ***********                                                         S01486
      *****************************************************************   S01486
     C***********#FRAIR    BEGSR                                          S01486
     C***********                                                         S01486
     C***ACCESS*LF/SDCURRL0*FOR*NUMBER*OF*DECIMAL*PLACES*USING*********   S01486
     C***OUR*CURRENCY*FROM*LF/DEALS************************************   S01486
     C***********                                                         S01486
     C***********UCUCY     CHAINSDCURRL0             71                   S01486
     C***********                                                         S01486
     C************IN71     IFEQ '1'                                       S01486
     C***********                                          ***************S01486
     C***********          Z-ADD8         QMERRN           **DB ERROR 08**S01486
     C***********          MOVEL'Y'       QMDBER           ***************S01486
     C***********          MOVEL'PM2000'  QMPGM                           S01486
     C***********          MOVEL'SDCURRL0'QMFILE                          S01486
     C***********          MOVELUCUCY     QMKEY                           S01486
     C***********                                                         S01486
     C***UPDATE**GDA***************************************************   S01486
     C***********                                                         S01486
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C***********                                                         S01486
     C***END*GROUP*JOB*************************************************   S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C***********          CALL 'PMC1020'                                 S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********          Z-ADDA6NBDP    WWODCP  10                      S01486
     C***********                                                         S01486
     C***IF*THE*DEAL*TYPE*IS*'RX'**************************************   S01486
     C***********                                                         S01486
     C***********DTYP      IFEQ 'RX'                                      S01486
     C***********                                                         S01486
     C***ACCESS*LF/SDCURRL0*FOR*NUMBER*OF*DECIMAL*PLACES*USING*********   S01486
     C***THEIR*CURRENCY*FROM*LF/DEALS**********************************   S01486
     C***********                                                         S01486
     C***********TCUCY     CHAINSDCURRL0             71                   S01486
     C***********                                                         S01486
     C************IN71     IFEQ '1'                                       S01486
     C***********                                          ***************S01486
     C***********          Z-ADD9         QMERRN           **DB ERROR 09**S01486
     C***********          MOVEL'Y'       QMDBER           ***************S01486
     C***********          MOVEL'PM2000'  QMPGM                           S01486
     C***********          MOVEL'SDCURRL0'QMFILE                          S01486
     C***********          MOVELTCUCY     QMKEY                           S01486
     C***********                                                         S01486
     C***UPDATE**GDA***************************************************   S01486
     C***********                                                         S01486
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C***********                                                         S01486
     C***END*GROUP*JOB*************************************************   S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C***********          CALL 'PMC1020'                                 S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********          Z-ADDA6NBDP    WWTDCP  10                      S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C************INKC     DOUEQ'1'                                       S01486
     C************INKL     OREQ '1'                                       S01486
     C***********                                                         S01486
     C***IF*THE*DEAL*TYPE*IS*'FR'**************************************   S01486
     C***********                                                         S01486
     C***********DTYP      IFEQ 'FR'                                      S01486
     C***********          EXSR #W03                                      S01486
     C***********          EXFMTPM2000F3                                  S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***IF*THE*DEAL*TYPE*IS*'RS'**************************************   S01486
     C***********                                                         S01486
     C***********DTYP      IFEQ 'RS'                                      S01486
     C***********          EXSR #W04                                      S01486
     C***********          EXFMTPM2000F4                                  S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***IF*THE*DEAL*TYPE*IS*'RX'**************************************   S01486
     C***********                                                         S01486
     C***********DTYP      IFEQ 'RX'                                      S01486
     C***********          EXSR #W05                                      S01486
     C***********          EXFMTPM2000F5                                  S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***IF*THE*DEAL*TYPE*IS*'RL'**************************************   S01486
     C***********                                                         S01486
     C***********DTYP      IFEQ 'RL'                                      S01486
     C***********          EXSR #W06                                      S01486
     C***********          EXFMTPM2000F6                                  S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W01     - PROCESS SCREEN FOR FX DEALS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - TO CONVERT DAY NUMBER INTO ALPHA DATE                 *
      * ZSEDIT   - TO FORMAT NUMERIC FIELDS                              *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #FXDEL   - PROCESSING OF FX DEALS                                *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWDLNO   - DEAL NUMBER                                           *
      * WWBRDP   - BROKER DECIMAL PLACES                                 *
      * WWPDEP   - PURCHASE CURRENCY DECIMAL PLACES                      *
      * WWSDEP   - SELL CURRENCY DECIMAL PLACES                          *
      *                                                                  *
      ********************************************************************
     C           #W01      BEGSR
     C**
     C** LOAD RUN DATE
     C**
     C                     MOVELQMRUNA    DDRUNA
     C**
     C** CUSTOMER NUMBER
     C**
     C                     MOVELQMCNUM    DDCNUM
     C**
     C** CUSTOMER NAME
     C**
     C                     MOVELQMCRNM    DDCRNM
     C           QMPORS    IFEQ 'B'                                       CPM004
     C                     SETON                     74                   CPM004
     C**                                                                  CPM004
     C** DEAL CUSTOMER (COUNTERPARTY) NUMBER                              CPM004
     C**                                                                  CPM004
     C                     MOVELCNUM      DDCTPY                          CPM004
     C**                                                                  CPM004
     C** DEAL CUSTOMER (COUNTERPARTY) NAME                                CPM004
     C**                                                                  CPM004
     C                     MOVELWWCRNM    DDCPRN                          CPM004
     C                     ENDIF                                          CPM004
     C**
     C** PORTFOLIO REFERENCE
     C**
     C                     MOVELQMPTF2    DDPTFR
     C**
     C** PORTFOLIO NARRATIVE
     C**
     C                     MOVELQMPTFN    DDPTFN
     C**
     C** DEAL NUMBER
     C**
     C                     MOVE WWDLNO    DDDEAL
     C**
     C** DEAL DATE
     C**
     C                     Z-ADDDDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DDDDAT
     C**
     C** BRANCH
     C**
     C***********          MOVELBRCD      DDBRCH                          S01486
     C                     MOVELBRCA      DDBRCH                          S01486
     C**
     C** BROKER
     C**
     C                     MOVELBRKC      DDBROK
     C**
     C** BROKERAGE
     C**
     C           BAGE      IFNE 0
     C           BAGE      ANDNE*HIVAL                                    R10056
     C                     Z-ADDBAGE      ZFLD15
     C                     Z-ADDWWBRDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDBRKG
     C                     ELSE
     C                     MOVEL*BLANKS   DDBRKG
     C                     END
     C**
     C** SWAP DEAL NUMBER
     C**
     C           SODN      IFNE 0
     C**
     C** TEST DEAL TYPE
     C**
     C           DTYP      IFEQ 'SW'
     C                     MOVE SODN      DDSWPD
     C                     MOVEL*BLANKS   DDTKOP
     C                     ELSE
     C           DTYP      IFEQ 'OT'
     C                     MOVE *BLANKS   DDSWPD
     C                     MOVE SODN      DDTKOP
     C                     ELSE
     C                     MOVEL*BLANKS   DDSWPD
     C                     MOVEL*BLANKS   DDTKOP
     C                     END
     C                     END
     C                     END
     C**
     C** VALUE DATE
     C**
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DDVDAT
     C**
     C** OPTION TO DATE
     C**
     C           OTDT      IFNE 0
     C                     Z-ADDOTDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DDOPDT
     C                     ELSE
     C                     MOVE *BLANKS   DDOPDT
     C                     END
     C**
     C** BUY CURRENCY
     C**
     C                     MOVELPUCY      DDBCCY
     C**
     C** BUY AMOUNT
     C**
     C                     Z-ADDPUAM      ZFLD15
     C                     Z-ADDWWPDEP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDBAMO
     C**
     C** FED FUNDS (Y/N) - BUY CURRENCY
     C**
     C                     TESTB'2'       DSTI           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'YES'     DDBFDF
     C                     ELSE
     C                     MOVEL'NO '     DDBFDF
     C                     END
     C**
     C** EXCHANGE RATE
     C**
     C                     Z-ADD0         ZFLD15
     C                     MOVE EXRT      ZFLDA
     C                     Z-ADD8         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDRATE
     C**
     C** SELL CURRENCY
     C**
     C                     MOVELSLCY      DDSCCY
     C**
     C** SELL AMOUNT
     C**
     C                     Z-ADDSLAM      ZFLD15
     C                     Z-ADDWWSDEP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDSAMO
     C**
     C** FED FUNDS (YES/NO) - SELL CURRENCY
     C**
     C                     TESTB'3'       DSTI           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'YES'     DDSFDF
     C                     ELSE
     C                     MOVEL'NO '     DDSFDF
     C                     END
     C**
     C** PROFIT/LOSS CURRENCY
     C**
     C                     MOVELSPLC      DDPLCY
     C*                                                                   S01313
     C** OBTAIN BASE CURRENCY FOR ACCOUNTING DECIMAL PLACES               S01313
     C***********QMCYCD    CHAINSDCURRL0             70            S01313 S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C******************** PARM A9BRCY    P@CCY   3                S01486 081346
     C***********          PARM SPLC      P@CCY   3                 081346081239
     C                     PARM QMCYCD    P@CCY   3                       081239
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**                                                                  S01313
     C************IN70     IFEQ '1'                        B1      S01313 S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C**                                                   ***************S01313
     C                     Z-ADD11        QMERRN           **DB ERROR 11**S01313
     C                     MOVEL'Y'       QMDBER           ***************S01313
     C                     MOVEL'PM2000'  QMPGM                           S01313
     C***********          MOVEL'SDCURRL0'QMFILE                   S01313 S01486
     C                     MOVE 'SDCURRPD'QMFILE                          S01486
     C                     MOVELQMCYCD    QMKEY                           S01313
     C**                                                                  S01313
     C***UPDATE**GDA********************************************** S01313 S01486
     C**                                                                  S01313
     C***********          CALL 'PMC1002'                          S01313 S01486
     C***********          PARM           WWGDA                    S01313 S01486
     C**                                                                  S01313
     C***********          CALL 'PMC1020'                          S01313 S01486
     C                     EXSR *PSSR                                     S01486
     C**                                                                  S01313
     C                     END                             E1             S01313
     C**
     C** BASE CURRENCY EQUIVALENT
     C**
     C                     Z-ADDBCEQ      ZFLD15
     C****                 Z-ADDQMPCDP    ZDECS                           S01313
     C                     Z-ADDA6NBDP    ZDECS                           S01313
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDBCEQ
     C**
     C** OVERRIDE (Y/N)
     C**
     C                     TESTB'4'       DSTI           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'YES'     DDOVER
     C                     ELSE
     C                     MOVEL'NO '     DDOVER
     C                     END
     C**
     C** BUY TYPE
     C**
     C                     MOVELPCST      DDBTYP
     C**
     C** BUY OUR
     C**
     C                     MOVELOPCA      DDBOUR
     C**
     C** BUY THEIR
     C**
     C                     MOVELTSCN      DDBTHR
     C**
     C** SELL TYPE
     C**
     C                     MOVELSCST      DDSTYP
     C**
     C** SELL OUR
     C**
     C                     MOVELOSCA      DDSOUR
     C**
     C** SELL THEIR
     C**
     C                     MOVELTPCN      DDSTHR
     C**
     C** FOR ACCOUNT OF
     C**
     C                     MOVELFACO      DDFACO
     C**
     C** SPECIAL INSTRUCTIONS
     C**
     C                     MOVELSPI       DDSPCI
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W02     - PROCESS SCREEN FOR MM DEALS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - TO CONVERT DAY NUMBER INTO ALPHA DATE                 *
      * ZSEDIT   - TO FORMAT NUMERIC FIELDS                              *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #MMDEL   - PROCESSING OF MM DEALS                                *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWDLNO   - DEAL NUMBER                                           *
      * WWBRDP   - BROKER DECIMAL PLACES                                 *
      * WWDCDP   - DEAL DECIMAL PLACES                                   *
      * WWTOTI   - TOTAL INTEREST                                        *
      * SDRTVTXT - TO RETRIEVE MESSAGE FROM MESSAGE FILE                 *R10036
      *                                                                  *
      ********************************************************************
     C           #W02      BEGSR
     C**
     C** LOAD RUN DATE
     C**
     C                     MOVELQMRUNA    DDRUNA
     C**
     C** CUSTOMER NUMBER
     C**
     C                     MOVELQMCNUM    DDCNUM
     C**
     C** CUSTOMER NAME
     C**
     C                     MOVELQMCRNM    DDCRNM
     C           QMPORS    IFEQ 'B'                                       CPM004
     C                     SETON                     74                   CPM004
     C**                                                                  CPM004
     C** DEAL CUSTOMER (COUNTERPARTY) NUMBER                              CPM004
     C**                                                                  CPM004
     C                     MOVELCNUM      DDCTPY                          CPM004
     C**                                                                  CPM004
     C** DEAL CUSTOMER (COUNTERPARTY) NAME                                CPM004
     C**                                                                  CPM004
     C                     MOVELWWCRNM    DDCPRN                          CPM004
     C                     ENDIF                                          CPM004
     C**
     C** PORTFOLIO REFERENCE
     C**
     C                     MOVELQMPTF2    DDPTFR
     C**
     C** PORTFOLIO NARRATIVE
     C**
     C                     MOVELQMPTFN    DDPTFN
     C**
     C** DEAL NUMBER
     C**
     C                     MOVE WWDLNO    DDDEAL
     C**
     C** DEAL DATE
     C**
     C                     Z-ADDDDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DDDDAT
     C**
     C** BRANCH
     C**
     C***********          MOVELBRCD      DDBRCH                          S01486
     C                     MOVELBRCA      DDBRCH                          S01486
     C**
     C** BROKER
     C**
     C                     MOVELBRKC      DDBROK
     C**
     C** BROKERAGE
     C**
     C           BAGE      IFNE 0
     C           BAGE      ANDNE*HIVAL                                    R10056
     C                     Z-ADDBAGE      ZFLD15
     C                     Z-ADDWWBRDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDBRKG
     C                     ELSE
     C                     MOVEL*BLANKS   DDBRKG
     C                     END
     C**
     C** ROLLOVER OF DEAL NR
     C**
     C           RODN      IFNE 0
     C                     MOVE RODN      DDROLN
     C                     ELSE
     C                     MOVE *BLANKS   DDROLN
     C                     END
     C**
     C** NOTICE DAYS
     C**
     C           NOTD      IFGT 0
     C                     MOVE NOTD      DDNOTD
     C                     ELSE
     C                     MOVE *BLANKS   DDNOTD
     C                     END
     C**
     C** VALUE DATE
     C**
     C                     Z-ADDVDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DDSTRD
     C**
     C** MATURITY DATE
     C**
     C                     Z-ADDMDAT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DDMTRD
     C**
     C** FACILITY TYPE/NO
     C**
     C           FACT      IFNE 0
     C                     MOVELFACT      DDFCTY
     C                     MOVE FCNO      DDFCTY
     C                     ELSE
     C                     MOVEL*BLANKS   DDFCTY
     C                     END
     C**
     C** CURRENCY
     C**
     C                     MOVELCCY       DDCURR
     C**
     C** PRINCIPAL AMOUNT
     C**
     C                     Z-ADDPCPL      ZFLD15
     C                     Z-ADDWWDCDP    ZDECS
     C                     EXSR ZSEDIT
     C****                 MOVE ZOUT21    DDAMON                          58645
     C                     MOVE ZOUT21    DDAMO1                          58645
     C**
     C** FED FUNDS (Y/N) - BUY CURRENCY
     C**
     C                     TESTB'2'       DSTI           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'YES'     DDFEDF
     C                     ELSE
     C                     MOVEL'NO '     DDFEDF
     C                     END
     C**
     C** TAXABLE INDICATOR
     C**
     C           TAXI      IFEQ 'Y'
     C                     MOVEL'YES'     DDTAXB
     C                     ELSE
     C                     MOVEL'NO '     DDTAXB
     C                     END
     C**
     C** INTEREST CAPITALISATION INDICATOR
     C**
     C                     MOVEL*BLANKS   DDICPI
     C**
     C** BASE RATE
     C**
     C           BRTT      IFNE 0
     C                     MOVE BRTT      DDBRTT
     C                     MOVELCCY       BACYCD                          R10036
     C                     MOVE BRTT      BABSRC                          R10036
     C**                                                                  R10036
     C** ACCESS LF/SDBSRTL1                                               R10036
     C**                                                                  R10036
     C***********KBSRT     CHAINSDBSRTL1             73            R10036 S01486
     C                     CALL 'AOBSRTR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C                     PARM BACYCD    P@CYCD  3                       S01486
     C                     PARM BABSRC    P@BSRC  2                       S01486
     C***********SDBSRT    PARM SDBSRT    DSFDY                    S01486 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C**                                                                  R10036
     C************IN73     IFEQ '1'                        ******* R10036 S01486
     C           P@RTCD    IFNE *BLANK                     ***************S01486
     C                     Z-ADD10        QMERRN           **DB ERROR 10**R10036
     C                     MOVEL'Y'       QMDBER           ***************R10036
     C                     MOVEL'PM2000'  QMPGM                           R10036
     C***********          MOVEL'SDBSRTL1'QMFILE                   R10036 S01486
     C                     MOVE 'SDBSRTPD'QMFILE                          S01486
     C                     MOVELBACYCD    DSBSRT  5                       S01486
     C                     MOVE BABSRC    DSBSRT                          S01486
     C                     MOVELDSBSRT    QMKEY                           R10036
     C**                                                                  R10036
     C                     EXSR *PSSR                                     R10036
     C                     ELSE                                           R10036
     C                     MOVE BABSRN    DDBRTL                          R10036
     C                     END                                            R10036
     C**                                                                  R10036
     C                     ELSE
     C                     MOVEL*BLANKS   DDBRTT
     C                     MOVE *BLANK    DDBRTL                          R10036
     C                     END
     C**
     C** SPREAD RATE
     C**
     C           RTSP      IFNE 0
     C                     Z-ADD0         ZFLD15
     C                     MOVE RTSP      ZFLDA
     C                     Z-ADD7         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDSRAT
     C                     ELSE
     C                     MOVEL*BLANKS   DDSRAT
     C                     END
     C**
     C** CALCULATION METHOD
     C**
     C                     MOVELICBS      DDCALC
     C           ICBS      IFNE 0                                         R10036
     C                     MOVEL'PM9005'  MSMBR4                          R10036
     C                     Z-ADD1         WWMSM   10                      R10036
     C                     ADD  ICBS      WWMSM                           R10036
     C                     MOVE WWMSM     MSMBR4                          R10036
     C                     CALL 'SDRTVTXT'PLLANG                          R10036
     C                     MOVELMSGTXT    DDCALL                          R10036
     C                     ELSE                                           R10036
     C                     MOVE *BLANK    DDCALL                          R10036
     C                     END                                            R10036
     C**                                                                  R10036
     C**
     C** NEGATIVE INTEREST
     C**
     C                     TESTB'1'       DSTI           72
     C           *IN72     IFEQ '1'
     C                     MOVEL'YES'     DDNEGI
     C                     ELSE
     C                     MOVEL'NO '     DDNEGI
     C                     END
     C**
     C** FREQUENCY
     C**
     C                     MOVELIPFR      DDFREQ
     C**
     C** NEXT INTEREST DATE
     C**
     C                     Z-ADDNIDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDNIND
     C**
     C** TOTAL INTEREST
     C**
     C           MDAT      IFEQ 0
     C                     MOVEL*BLANKS   DDTOTI
     C                     ELSE
     C                     Z-ADDWWTOTI    ZFLD15
     C                     Z-ADDWWDCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDTOTI
     C                     END
      *                                                                                       234689
      ** EU TAX & NET INTEREST                                                                234689
      *                                                                                       234689
     C           CGL031    IFEQ 'Y'                                                           234689
     C                     EXSR SRFEUT                                                        234689
     C                     ENDIF                                                              234689
     C****                                                                58645
     C****CCRUALS POSTED                                                  58645
     C****                                                                58645
     C****                 Z-ADDAIPD      ZFLD15                          58645
     C****                 Z-ADDWWDCDP    ZDECS                           58645
     C****                 EXSR ZSEDIT                                    58645
     C****                 MOVE ZOUT21    DDAIPS                          58645
     C*
     C** CALCULATE INTEREST ACCRUED SINCE LAST INTEREST DATE              58645
     C                     Z-ADDPCPL      ZIAMT                           58645
     C                     Z-ADDINTR      ZIRATE                          58645
     C*                                                                   58645
     C           SLID      IFNE 0                                         58645
     C                     Z-ADDSLID      ZIBEG                           58645
     C                     ELSE                                           58645
     C                     Z-ADDVDAT      ZIBEG                           58645
     C                     END                                            58645
     C**                                                                  58645
     C           MDAT      IFGE WWLXTR
     C           MDAT      OREQ 0                                         62278
     C                     Z-ADDWWLXTR    ZIEND                           58645
     C           ACLD      IFEQ 'N'                                      145170
     C                     ADD  1         ZIEND                          145170
     C                     END                                           145170
     C                     ELSE
     C                     Z-ADDMDAT      ZIEND
     C                     END
     C*                                                                  145170
     C* If end date < begin date, set accruals to 0                      145170
     C*                                                                  145170
     C           ZIEND     IFLT ZIBEG                                    145170
     C                     Z-ADD0         ZINTR                          145170
     C                     ELSE                                          145170
     C*
     C                     Z-ADDICBS      ZICALC                          58645
     C/COPY WNCPYSRC,PM2000C004
     C**                                                                  58645
     C                     EXSR GLINTC                                    58645
     C*                                                                   58645
     C                     END                                           145170
     C*                                                                  145170
     C** INTEREST ACCRUED SINCE LAST INTEREST DATE                        58645
     C                     Z-ADDZINTR     ZFLD15    H                     58645
     C                     Z-ADDWWDCDP    ZDECS                           58645
     C                     EXSR ZSEDIT                                    58645
     C                     MOVE ZOUT21    DDISLI                          58645
     C****                                                                58645
     C****CCRUALS NOT POSTED                                              58645
     C****                                                                58645
     C****                 Z-ADDAIAN      ZFLD15                          58645
     C****                 Z-ADDWWDCDP    ZDECS                           58645
     C****                 EXSR ZSEDIT                                    58645
     C****                 MOVE ZOUT21    DDAINP                          58645
     C**                                                                  58645
     C** INTEREST PAID TO DATE                                            58645
     C**                                                                  58645
     C                     Z-ADDIPRD      ZFLD15                          58645
     C                     Z-ADDWWDCDP    ZDECS                           58645
     C                     EXSR ZSEDIT                                    58645
     C                     MOVE ZOUT21    DDINPD                          58645
     C**                                                                  58645
     C** FORMAT INTEREST OUTSTANDING FOR OUTPUT                           58645
     C**                                                                  58645
     C           WWTOTI    SUB  IPRD      ZFLD15                          58645
     C                     Z-ADDWWDCDP    ZDECS                           58645
     C                     EXSR ZSEDIT                                    58645
     C***********          MOVE ZOUT21    DDRINT                    58645 CPM004
     C**
     C** ROLLED OVER BY DEAL NUMBER
     C**
     C           RBDN      IFNE 0
     C                     MOVELRBDN      DDROLO
     C                     ELSE
     C                     MOVEL*BLANKS   DDROLO
     C                     END
     C**
     C** AMOUNT ROLLED
     C**
     C           RBDA      IFNE 0
     C                     Z-ADDRBDA      ZFLD15
     C                     Z-ADDWWDCDP    ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDAROL
     C                     ELSE
     C                     MOVEL*BLANKS   DDAROL
     C                     END
     C**
     C** CD REFERENCE NO
     C**
     C                     MOVELRNNA      DDREFN
     C**
     C** CD HELD BY
     C**
     C***********          MOVE CNUM      DDHLDB                          145170
     C                     MOVE *BLANKS   DDHLDB                          145170
     C********** CHNA      IFNE 0                                                      145170 CSD027
     C           CHNA      IFNE *BLANKS                                                       CSD027
     C                     MOVE CHNA      DDHLDB                          145170
     C                     END                                            145170
     C**
     C** A/C SEQ NO
     C**
     C                     MOVE CDAS      DDACSQ
     C**
     C** START TYPE
     C**
     C                     MOVELSDST      DDSTTP
     C**
     C** START OUR
     C**
     C                     MOVELOSDA      DDSTOU
     C**
     C** START THEIR
     C**
     C                     MOVELTSTN      DDSTTH
     C**
     C** MATURITY TYPE
     C**
     C                     MOVE MDST      DDMTTP
     C**
     C** MATURITY OUR
     C**
     C                     MOVELOMDA      DDMTOU
     C**
     C** MATURITY THEIR
     C**
     C                     MOVELTMAN      DDMTTH
     C**
     C** FOR ACCOUNT OF
     C**
     C                     MOVELFACO      DDFACO
     C**
     C** SPECIAL INSTRUCTIONS
     C**
     C                     MOVELSPI       DDSPCI
     C                     MOVELIPDS      DDIPDS                          095022
     C                     MOVELIMET      DDIMET                          095022
     C                     MOVELINSA      DDINSA                          095022
     C**********           MOVELINSA      ISAN   12                                    095022 CGL029
     C                     MOVELINSA      ISAN   18                                           CGL029
     C                     MOVELISAN      DDISAN                          095022
     C**
     C                     ENDSR
      *****************************************************************                       234689
      /EJECT                                                                                  234689
      *****************************************************************                       234689
      *                                                               *                       234689
      *  SRCEUT - Calculate EU Tax Amount                             *                       234689
      *                                                               *                       234689
      *****************************************************************                       234689
     C           SRCEUT    BEGSR                                                              234689
      *                                                                                       234689
     C           MDAT      IFEQ *ZERO                                                         234689
     C                     GOTO ECEUT                                                         234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C                     MOVEL'ZAGETSET'WRLE1  10                                           234689
     C                     MOVE 'AC'      WRLE1                                               234689
      *                                                                                       234689
     C                     MOVE CCY       P@ACCY                                              234689
     C           IPDS      IFEQ 'Y'                                                           234689
     C                     MOVE IMET      P@STYP                                              234689
     C                     MOVELINSA      P@SACT                                              234689
     C                     MOVE INSA      P@BRCA                                              234689
     C                     ELSE                                                               234689
     C                     Z-ADDPSTM      P@STYP                                              234689
     C                     MOVE PONS      P@SACT                                              234689
     C                     MOVE POBR      P@BRCA                                              234689
     C                     ENDIF                                                              234689
     C***********          MOVE QMCNUM    P@CNUM                                       234689 235115
     C                     MOVELCNUM      P@CNUM                                              235115
      *                                                                                       234689
     C           P@STYP    IFEQ 04                                                            234689
     C           P@STYP    OREQ 05                                                            234689
     C           P@STYP    OREQ 14                                                            234689
      *                                                                                       234689
     C                     CALL WRLE1                                                         234689
      *                                                                                       234689
      ** Output Parameters                                                                    234689
      *                                                                                       234689
     C                     PARM *BLANKS   P@RETC 10                                           234689
     C                     PARM *ZEROS    P@ACCT                                              234689
     C                     PARM *ZEROS    P@ASEQ                                              234689
     C                     PARM 'N'       P@MEIN  1                                           234689
     C                     PARM 'N'       P@PRIN  1                                           234689
      *                                                                                       234689
      ** Input/Output Parameters                                                              234689
      *                                                                                       234689
     C                     PARM           P@BRCA  3                                           234689
     C                     PARM           P@CNUM                                              234689
     C                     PARM           P@ACCY  3                                           234689
      *                                                                                       234689
      ** Input Parameters                                                                     234689
      *                                                                                       234689
     C                     PARM           P@STYP                                              234689
     C                     PARM           P@SACT 12                                           234689
      *                                                                                       234689
     C           P@RETC    IFNE *BLANKS                                                       234689
     C                     MOVELP@SACT    QMKEY                                               234689
     C                     Z-ADD102       QMERRN                                              234689
     C                     EXSR *PSSR                                                         234689
     C                     GOTO ECEUT                                                         234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C                     ELSE                                                               234689
      *                                                                                       234689
     C                     MOVELBRCA      P@BRCA                                              234689
     C***********          MOVELQMCNUM    P@CNUM                                       234689 235115
     C                     MOVELCNUM      P@CNUM                                              235115
     C                     MOVELCCY       P@ACCY                                              234689
      *                                                                                       234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
      ** Branch details                                                                       234689
      *                                                                                       234689
     C                     CALL 'AOBRCHR0'                                                    234689
     C                     PARM *BLANKS   PRTCD                                               234689
     C                     PARM '*KEY   ' POPTN                                               234689
     C                     PARM BRCA      PBRCH   3                                           234689
     C           SDBRCH    PARM SDBRCH    DSFDY                                               234689
      *                                                                                       234689
     C           PRTCD     IFNE *BLANKS                                                       234689
     C                     MOVEL'SDBRCHPD'QMFILE                                              234689
     C                     MOVELPBRCH     QMKEY                                               234689
     C                     Z-ADD103       QMERRN                                              234689
     C                     EXSR *PSSR                                                         234689
     C                     GOTO ECEUT                                                         234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
      ** Country code details                                                                 234689
      *                                                                                       234689
     C                     CALL 'AOLOCNR0'                                                    234689
     C                     PARM *BLANKS   PRTCD                                               234689
     C                     PARM '*KEY   ' POPTN                                               234689
     C                     PARM A8LCCD    PLOCN   3                                           234689
     C           SDLOCN    PARM SDLOCN    DSFDY                                               234689
      *                                                                                       234689
     C           PRTCD     IFNE *BLANKS                                                       234689
     C                     MOVEL'SDLOCNPD'QMFILE                                              234689
     C                     MOVELPLOCN     QMKEY                                               234689
     C                     Z-ADD104       QMERRN                                              234689
     C                     EXSR *PSSR                                                         234689
     C                     GOTO ECEUT                                                         234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C                     MOVE *BLANKS   PCUST                                               234689
     C                     MOVELP@CNUM    PCUST                                               234689
      *                                                                                       234689
      ** Customer details                                                                     234689
      *                                                                                       234689
     C                     CALL 'AOCUSTR0'                                                    234689
     C                     PARM *BLANKS   PRTCD                                               234689
     C                     PARM '*KEY   ' POPTN                                               234689
     C                     PARM           PCUST  10                                           234689
     C                     PARM           PKYST   7                                           234689
     C           SDCUST    PARM SDCUST    DSSDY                                               234689
      *                                                                                       234689
     C           PRTCD     IFNE *BLANKS                                                       234689
     C                     MOVEL'SDCUSTPD'QMFILE                                              234689
     C                     MOVELPCUST     QMKEY                                               234689
     C                     Z-ADD105       QMERRN                                              234689
     C                     EXSR *PSSR                                                         234689
     C                     GOTO ECEUT                                                         234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
      ** Country of Tax                                                                       234689
      *                                                                                       234689
     C                     CALL 'AOCTTXR0'                                                    234689
     C                     PARM *BLANKS   PRTCD                                               234689
     C                     PARM '*KEY   ' POPTN                                               234689
     C                     PARM DVCNCD    PCTRT   2                                           234689
     C                     PARM BBCOLC    PCTRR   2                                           234689
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234689
      *                                                                                       234689
     C           PRTCD     IFEQ '*NRF   '                                                     234689
      *                                                                                       234689
     C                     CALL 'AOCTTXR0'                                                    234689
     C                     PARM *BLANKS   PRTCD                                               234689
     C                     PARM '*KEY   ' POPTN                                               234689
     C                     PARM DVCNCD    PCTRT                                               234689
     C                     PARM *BLANKS   PCTRR                                               234689
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234689
      *                                                                                       234689
     C           PRTCD     IFNE *BLANKS                                                       234689
     C                     MOVEL'SDCTTXPD'QMFILE                                              234689
     C           DVCNCD    CAT  BBCOLC    QMKEY                                               234689
     C                     Z-ADD106       QMERRN                                              234689
     C                     EXSR *PSSR                                                         234689
     C                     GOTO ECEUT                                                         234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
      ** Calculate taxable interest amount                                                    234689
      *                                                                                       234689
     C           EWTRT1    IFEQ '1'                                                           234689
     C           VDAT      ANDLTEWEDT1                                                        234689
     C           MDAT      SUB  VDAT      WDY1    50                                          234689
     C           MDAT      SUB  EWEDT1    WDY2    50                                          234689
     C           W@TOTI    MULT WDY2      @@TOTI    H                                         234689
     C                     DIV  WDY1      @@TOTI    H                                         234689
      *                                                                                       234689
     C           MDAT      IFLT EWEDT1                                                        234689
     C                     Z-ADD*ZERO     @@TOTI                                              234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C                     ELSE                                                               234689
     C                     Z-ADDW@TOTI    @@TOTI                                              234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C                     MOVE P@CNUM    WCNUM   6                                           234689
     C                     MOVE WWDLNO    WDLNO   6                                           234689
      *                                                                                       234689
      ** Call EU Tax Calculation for Private Individual.                                      234689
      *                                                                                       234689
     C                     CALL 'ZATXCLPI'                                                    234689
      *                                                                                       234689
     C                     PARM 'D'       @@MODI  1                                           234689
     C                     PARM WDLNO     @@TRRF 18                                           234689
     C                     PARM BRCA      @@BRCA  3                                           234689
     C                     PARM WCNUM     @@CUST  6                                           234689
     C                     PARM           @@STRD  50                                          234689
     C                     PARM           @@ENDD  50                                          234689
     C                     PARM           @@TOTI 150                                          234689
     C                     PARM *ZERO     @@TAXR  64                                          234689
     C                     PARM CCY       @@OCCY  3                                           234689
     C                     PARM *BLANKS   PINTH   1                                           CER048
      *                                                                                       234689
      ** Output Parameters                                                                    234689
      *                                                                                       234689
     C                     PARM           @@IAED 150                                          234689
     C                     PARM           @@TAXA 150                                          234689
     C                     PARM           @@TOTO 150                                          234689
     C                     PARM           @@TXCY  3                                           234689
     C                     PARM           @@CTAX  2                                           234689
     C                     PARM           @@TXBS  2                                           234689
     C                     PARM           @@WTAC  40                                          234689
     C                     PARM           @@COLC  2                                           234689
     C                     PARM           @@STAT  5                                           234689
     C                     PARM           @@TRTE  1                                           234689
     C                     PARM           @@TXR1  64                                          234689
     C**********           PARM *ZEROS    PSTXB   20                                 CER048 BUG22911
     C**********           PARM *ZEROS    PSTAC  100                                 CER048 BUG22911
     C**********           PARM *ZEROS    PSTTR   64                                 CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP   1                                  CER048 BUG22911
     C**********           PARM *ZEROS    PSTXA  150                                 CER048 BUG22911
     C                     PARM           @@KEY  10                                           234689
     C                     PARM           @@FILE 10                                           234689
     C                     PARM           @@RTRN  7                                           234689
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       234689
     C                     SELEC                                                              234689
      *                                                                                       234689
     C           @@RTRN    WHEQ 'ERROR'                                                       234689
     C                     MOVEL@@FILE    QMFILE                                              234689
     C                     MOVEL@@KEY     QMKEY                                               234689
     C                     Z-ADD107       QMERRN                                              234689
     C                     EXSR *PSSR                                                         234689
     C                     GOTO ECEUT                                                         234689
      *                                                                                       234689
     C           @@RTRN    WHNE 'JOINT'                                                       234689
     C           @@TOTO    IFNE *ZERO                                                         234689
     C           @@STAT    IFEQ 'TAXAB'                                                       234689
     C           @@STAT    OREQ 'DISCL'                                                       234689
     C           @@STAT    OREQ 'SELF '                                                       234689
     C                     Z-ADD@@TAXA    WNTAMT                                              234689
     C                     ENDIF                                                              234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C           @@RTRN    WHEQ 'JOINT'                                                       234689
     C                     EXSR SRCALJ                                                        234689
     C                     ENDSL                                                              234689
      *                                                                                       234689
     C           ECEUT     ENDSR                                                              234689
      *****************************************************************                       234689
      /EJECT                                                                                  234689
      *****************************************************************                       234689
      *                                                               *                       234689
      *  SRCALJ - Calculate EU Tax Amount for Joint A/c Members.      *                       234689
      *                                                               *                       234689
      *****************************************************************                       234689
     C           SRCALJ    BEGSR                                                              234689
      *                                                                                       234689
     C                     MOVE *IN21     WIN21   1                                           234689
      *                                                                                       234689
     C           WCNUM     SETLLSDJACCLB                                                      234689
     C           WCNUM     READESDJACCLB                 21                                   234689
      *                                                                                       234689
     C                     Z-ADD*ZERO     WTAXA                                               234689
      *                                                                                       234689
     C           *IN21     DOWEQ*OFF                                                          234689
      *                                                                                       234689
     C                     EXSR SRCZJA                                                        234689
      *                                                                                       234689
     C           @@RTRN    IFEQ 'ERROR'                                                       234689
     C                     MOVEL@@FILE    QMFILE                                              234689
     C                     MOVEL@@KEY     QMKEY                                               234689
     C                     Z-ADD108       QMERRN                                              234689
     C                     EXSR *PSSR                                                         234689
     C                     MOVE WIN21     *IN21                                               234689
     C                     GOTO ECALJ                                                         234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C           @@TOTO    IFNE *ZERO                                                         234689
     C           @@STAT    IFEQ 'TAXAB'                                                       234689
     C           @@STAT    OREQ 'DISCL'                                                       234689
     C           @@STAT    OREQ 'SELF '                                                       234689
     C                     ADD  @@TAXA    WTAXA  150                                          234689
     C                     ENDIF                                                              234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C           @@RTRN    IFEQ 'NOTAX'                                                       234689
     C           @@RTRN    OREQ 'TAXAB'                                                       234689
     C           WCNUM     READESDJACCLB                 21                                   234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C           @@RTRN    IFEQ 'LAST '                                                       234689
     C                     MOVE *ON       *IN21                                               234689
     C                     ENDIF                                                              234689
      *                                                                                       234689
     C                     ENDDO                                                              234689
      *                                                                                       234689
     C                     MOVE WIN21     *IN21                                               234689
      *                                                                                       234689
     C                     ADD  WTAXA     WNTAMT                                              234689
      *                                                                                       234689
     C           ECALJ     ENDSR                                                              234689
      *****************************************************************                       234689
      /EJECT                                                                                  234689
      *****************************************************************                       234689
      *                                                               *                       234689
      *  SRCZJA - Calls EU Tax Calculation for Joint Accounts.        *                       234689
      *                                                               *                       234689
      *****************************************************************                       234689
     C           SRCZJA    BEGSR                                                              234689
      *                                                                                       234689
     C                     CALL 'ZATXCLJA'                                                    234689
      *                                                                                       234689
     C                     PARM 'D'       @@MODI                                              234689
     C                     PARM WDLNO     @@TRRF                                              234689
     C                     PARM BRCA      @@BRCA                                              234689
     C                     PARM WCNUM     @@JANO  6                                           234689
     C                     PARM JCCUST    @@CUST                                              234689
     C                     PARM JCNAHO    @@NARF 10                                           234689
     C                     PARM JCINVP    @@INVP 10                                           234689
     C                     PARM JCPAHT    @@PAHT  1                                         BUG26839
     C                     PARM           @@STRD                                              234689
     C                     PARM           @@ENDD                                              234689
     C                     PARM           @@TOTI                                              234689
     C                     PARM *ZERO     @@TAXR                                              234689
     C                     PARM CCY       @@OCCY                                              234689
     C                     PARM *BLANKS   PINTH                                               CER048
      *                                                                                       234689
      ** Output Parameters                                                                    234689
      *                                                                                       234689
     C                     PARM           @@IAED                                              234689
     C                     PARM           @@TAXA                                              234689
     C                     PARM           @@TOTO                                              234689
     C                     PARM           @@TXCY                                              234689
     C                     PARM           @@CTAX                                              234689
     C                     PARM           @@TXBS                                              234689
     C                     PARM           @@WTAC                                              234689
     C                     PARM           @@COLC                                              234689
     C                     PARM           @@STAT                                              234689
     C                     PARM           @@TRTE                                              234689
     C                     PARM           @@TXR1                                              234689
     C                     PARM           @@JAMG  1                                           234689
     C**********           PARM *ZEROS    PSTXB                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTAC                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTTR                                      CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP                                      CER048 BUG22911
     C**********           PARM *ZEROS    PSTXA                                      CER048 BUG22911
     C                     PARM           @@KEY                                               234689
     C                     PARM           @@FILE                                              234689
     C                     PARM           @@RTRN                                              234689
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       234689
     C                     ENDSR                                                              234689
      *****************************************************************                       234689
      /EJECT                                                                                  234689
      *****************************************************************                       234689
      *                                                               *                       234689
      *  SRFEUT - Format EU Tax Fields                                *                       234689
      *                                                               *                       234689
      *****************************************************************                       234689
     C           SRFEUT    BEGSR                                                              234689
      *                                                                                       234689
     C                     MOVE *BLANKS   DDNETI                                              234689
     C                     MOVE *BLANKS   DDEUTX                                              234689
      *                                                                                       234689
      ** Net interest                                                                         234689
      *                                                                                       234689
     C           WPOSI     IFEQ 'Y'                                                           234689
     C           W@TOTI    SUB  WNTAMT    ZFLD15                                              234689
     C                     ELSE                                                               234689
     C                     Z-SUBW@TOTI    ZFLD15                                              234689
     C                     ADD  WNTAMT    ZFLD15                                              234689
     C                     ENDIF                                                              234689
     C                     Z-ADDWWDCDP    ZDECS                                               234689
     C                     EXSR ZSEDIT                                                        234689
     C                     MOVE ZOUT21    DDNETI                                              234689
      *                                                                                       234689
      ** EU tax                                                                               234689
      *                                                                                       234689
     C           WPOSI     IFEQ 'Y'                                                           234689
     C                     Z-SUBWNTAMT    ZFLD15                                              234689
     C                     ELSE                                                               234689
     C                     Z-ADDWNTAMT    ZFLD15                                              234689
     C                     ENDIF                                                              234689
     C                     Z-ADDWWDCDP    ZDECS                                               234689
     C                     EXSR ZSEDIT                                                        234689
     C                     MOVE ZOUT21    DDEUTX                                              234689
      *                                                                                       234689
     C           EFEUT     ENDSR                                                              234689
      *****************************************************************                       234689
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      ***********                                                         S01486
      **#W03*****-*PROCESS*SCREEN*FOR*FRA*DEALS************************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLS:**********************************************   S01486
      **ZDATE2***-*TO*CONVERT*DAY*NUMBER*INTO*ALPHA*DATE***************   S01486
      **ZSEDIT***-*TO*FORMAT*NUMERIC*FIELDS****************************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLED*FROM:****************************************   S01486
      **#FRAIR***-*PROCESSING*OF*FRA/IRS*DEALS*************************   S01486
      ***********                                                         S01486
      **ROUTINE*USES*VARIABLES:****************************************   S01486
      **WWDLNO***-*DEAL*NUMBER*****************************************   S01486
      **WWBRDP***-*BROKER*DECIMAL*PLACES*******************************   S01486
      **WWODCP***-*OUR*CURRENCY*DECIMAL*PLACES*************************   S01486
      ***********                                                         S01486
      *****************************************************************   S01486
     C***********#W03      BEGSR                                          S01486
     C***********                                                         S01486
     C***LOAD*RUN*DATE*************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMRUNA    DDRUNA                          S01486
     C***********                                                         S01486
     C***CUSTOMER*NUMBER***********************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMCNUM    DDCNUM                          S01486
     C***********                                                         S01486
     C***CUSTOMER*NAME*************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMCRNM    DDCRNM                          S01486
     C***********                                                         S01486
     C***PORTFOLIO*REFERENCE*******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMPTF2    DDPTFR                          S01486
     C***********                                                         S01486
     C***PORTFOLIO*NARRATIVE*******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMPTFN    DDPTFN                          S01486
     C***********                                                         S01486
     C***DEAL*NUMBER***************************************************   S01486
     C***********                                                         S01486
     C***********          MOVE WWDLNO    DDDEAL                          S01486
     C***********                                                         S01486
     C***DEAL*DATE*****************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDDDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDDDAT                          S01486
     C***********                                                         S01486
     C***BRANCH********************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELBRCD      DDBRCH                          S01486
     C***********                                                         S01486
     C***BROKER********************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELBRKC      DDBROK                          S01486
     C***********                                                         S01486
     C***BROKERAGE*****************************************************   S01486
     C***********                                                         S01486
     C***********BAGE      IFNE 0                                  R10056 S01486
     C***********BAGE      ANDNE*HIVAL                             R10056 S01486
     C***********          Z-ADDBAGE      ZFLD15                          S01486
     C***********          Z-ADDWWBRDP    ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDBRKG                          S01486
     C***********          ELSE                                    R10056 S01486
     C***********          MOVE *BLANK    DDBRKG                   R10056 S01486
     C***********          END                                     R10056 S01486
     C***********                                                         S01486
     C***LINK*DEAL*NBR*************************************************   S01486
     C***********                                                         S01486
     C***********LNKDN     IFNE 0                                         S01486
     C***********          MOVE LNKDN     DDLINK                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVE *BLANKS   DDLINK                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***VALUE*DATE****************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDVDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDVDAT                          S01486
     C***********                                                         S01486
     C***MATURITY*DATE*************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDMDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDMDAT                          S01486
     C***********                                                         S01486
     C***ACCOUNT*SEQ*NO************************************************   S01486
     C***********                                                         S01486
     C***********CDAS      IFNE 0                                         S01486
     C***********          MOVE CDAS      DDACSQ                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDACSQ                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***CURRENCY******************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUCUCY     DDCURR                          S01486
     C***********                                                         S01486
     C***PRINCIPAL*AMOUNT**********************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDUPAMT     ZFLD15                          S01486
     C***********          Z-ADDWWODCP    ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDAMON                          S01486
     C***********                                                         S01486
     C***BASE*CURRENCY*RATE********************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE UBCXR     ZFLDA                           S01486
     C***********          Z-ADD8         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDBRAT                          S01486
     C***********                                                         S01486
     C***HEDGE*INDICATOR***********************************************   S01486
     C***********                                                         S01486
     C***********HEDIN     IFEQ 'Y'                                       S01486
     C***********HEDIN     OREQ 'I'                                       S01486
     C***********HEDIN     OREQ 'O'                                       S01486
     C***********          MOVEL'YES'     DDHDGI                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDHDGI                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***TAXABLE*INDICATOR*********************************************   S01486
     C***********                                                         S01486
     C***********TAXI      IFEQ 'Y'                                       S01486
     C***********          MOVEL'YES'     DDTAXA                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDTAXA                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***FED*FUNDS*****************************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'2'       UDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDFEDF                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDFEDF                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***CALCULATION*METHOD********************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUICBS     DDCALC                          S01486
     C***********                                                         S01486
     C***NEGATIVE*INTEREST*********************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'1'       UDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDNEGI                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDNEGI                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*FLOATING*RATE*FIX*DAYS************************************   S01486
     C***********                                                         S01486
     C***********          MOVE UFRFD     DDRAFD                          S01486
     C***********                                                         S01486
     C***BASE***RATE**TYPE*********************************************   S01486
     C***********                                                         S01486
     C***********UBRTT     IFNE 0                                         S01486
     C***********          MOVE UBRTT     DDOBRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOBRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***SPREAD*RATE***************************************************   S01486
     C***********                                                         S01486
     C***********URTSP     IFNE 0                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE URTSP     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDOSRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOSRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*SPREAD*INDICATOR******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUSPIN     DDOSPI                          S01486
     C***********                                                         S01486
     C***BASE***RATE**TYPE*********************************************   S01486
     C***********                                                         S01486
     C***********TBRTT     IFNE 0                                         S01486
     C***********          MOVE TBRTT     DDTBRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTBRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***SPREAD*RATE***************************************************   S01486
     C***********                                                         S01486
     C***********TRTSP     IFNE 0                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE TRTSP     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDTSRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTSRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*SPREAD*INDICATOR******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELTSPIN     DDTSPI                          S01486
     C***********                                                         S01486
     C***RECEIPT*SETTLEMENT*METHOD*************************************   S01486
     C***********                                                         S01486
     C***********          MOVELRSETM     DDRESM                          S01486
     C***********                                                         S01486
     C***OUR*RECEIVING*ACCOUNT*****************************************   S01486
     C***********                                                         S01486
     C***********          MOVELURACC     DDREAC                          S01486
     C***********                                                         S01486
     C***COUNTERPARTY*PAYMENT*BANK*************************************   S01486
     C***********                                                         S01486
     C***********          MOVELCPPBK     DDCNPB                          S01486
     C***********                                                         S01486
     C***PAYMENT*SETTLEMENT*METHOD*************************************   S01486
     C***********                                                         S01486
     C***********          MOVELPSETM     DDPASM                          S01486
     C***********                                                         S01486
     C***OUR*PAYMENT***ACCOUNT*****************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUPACC     DDPAAC                          S01486
     C***********                                                         S01486
     C***COUNTERPARTY*RECEIVING*BANK***********************************   S01486
     C***********                                                         S01486
     C***********          MOVELCPRBK     DDCNRB                          S01486
     C***********                                                         S01486
     C***FOR*ACCOUNT*OF************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELFACO      DDACCF                          S01486
     C***********                                                         S01486
     C***SPECIAL*INSTRUCTIONS******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELSPI       DDSPCI                          S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C***********                                                         S01486
      ********************************************************************
      /EJECT
      ********************************************************************
      ***********                                                         S01486
      **#W04*****-*PROCESS*SCREEN*FOR*IRS*DEALS************************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLS:**********************************************   S01486
      **ZDATE2***-*TO*CONVERT*DAY*NUMBER*INTO*ALPHA*DATE***************   S01486
      **ZSEDIT***-*TO*FORMAT*NUMERIC*FIELDS****************************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLED*FROM:****************************************   S01486
      **#FRAIR***-*PROCESSING*OF*FRA/IRS*DEALS*************************   S01486
      ***********                                                         S01486
      **ROUTINE*USES*VARIABLES:****************************************   S01486
      **WWDLNO***-*DEAL*NUMBER*****************************************   S01486
      **WWBRDP***-*BROKER*DECIMAL*PLACES*******************************   S01486
      **WWODCP***-*OUR*CURRENCY*DECIMAL*PLACES*************************   S01486
      ***********                                                         S01486
      ********************************************************************
     C***********#W04      BEGSR                                          S01486
     C***********                                                         S01486
     C***LOAD*RUN*DATE*************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMRUNA    DDRUNA                          S01486
     C***********                                                         S01486
     C***CUSTOMER*NUMBER***********************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMCNUM    DDCNUM                          S01486
     C***********                                                         S01486
     C***CUSTOMER*NAME*************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMCRNM    DDCRNM                          S01486
     C***********                                                         S01486
     C***PORTFOLIO*REFERENCE*******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMPTF2    DDPTFR                          S01486
     C***********                                                         S01486
     C***PORTFOLIO*NARRATIVE*******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMPTFN    DDPTFN                          S01486
     C***********                                                         S01486
     C***DEAL*NUMBER***************************************************   S01486
     C***********                                                         S01486
     C***********          MOVE WWDLNO    DDDEAL                          S01486
     C***********                                                         S01486
     C***DEAL*DATE*****************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDDDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDDDAT                          S01486
     C***********                                                         S01486
     C***BRANCH********************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELBRCD      DDBRCH                          S01486
     C***********                                                         S01486
     C***BROKER********************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELBRKC      DDBROK                          S01486
     C***********                                                         S01486
     C***BROKERAGE*****************************************************   S01486
     C***********                                                         S01486
     C***********BAGE      IFNE 0                                  R10056 S01486
     C***********BAGE      ANDNE*HIVAL                             R10056 S01486
     C***********          Z-ADDBAGE      ZFLD15                          S01486
     C***********          Z-ADDWWBRDP    ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDBRKG                          S01486
     C***********          ELSE                                    R10056 S01486
     C***********          MOVE *BLANK    DDBRKG                   R10056 S01486
     C***********          END                                     R10056 S01486
     C***********                                                         S01486
     C***LINK*DEAL*NBR*************************************************   S01486
     C***********                                                         S01486
     C***********LNKDN     IFNE 0                                         S01486
     C***********          MOVE LNKDN     DDLINK                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVE *BLANKS   DDLINK                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***VALUE*DATE****************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDVDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDVDAT                          S01486
     C***********                                                         S01486
     C***MATURITY*DATE*************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDMDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDMDAT                          S01486
     C***********                                                         S01486
     C***ACCOUNT*SEQ*NO************************************************   S01486
     C***********                                                         S01486
     C***********CDAS      IFNE 0                                         S01486
     C***********          MOVE CDAS      DDACSQ                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDACSQ                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***CURRENCY******************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUCUCY     DDCURR                          S01486
     C***********                                                         S01486
     C***PRINCIPAL*AMOUNT**********************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDUPAMT     ZFLD15                          S01486
     C***********          Z-ADDWWODCP    ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDAMON                          S01486
     C***********                                                         S01486
     C***BASE*CURRENCY*RATE********************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE UBCXR     ZFLDA                           S01486
     C***********          Z-ADD8         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDBRAT                          S01486
     C***********                                                         S01486
     C***HEDGE*INDICATOR***********************************************   S01486
     C***********                                                         S01486
     C***********HEDIN     IFEQ 'Y'                                       S01486
     C***********HEDIN     OREQ 'I'                                       S01486
     C***********HEDIN     OREQ 'O'                                       S01486
     C***********          MOVEL'YES'     DDHDGI                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDHDGI                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***TAXABLE*INDICATOR*********************************************   S01486
     C***********                                                         S01486
     C***********TAXI      IFEQ 'Y'                                       S01486
     C***********          MOVEL'YES'     DDTAXA                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDTAXA                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***FED*FUNDS*****************************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'2'       UDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDFEDF                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDFEDF                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***CALCULATION*METHOD********************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUICBS     DDCALC                          S01486
     C***********                                                         S01486
     C***NEGATIVE*INTEREST*********************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'1'       UDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDNEGI                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDNEGI                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*BASE***RATE**TYPE*****************************************   S01486
     C***********                                                         S01486
     C***********UBRTT     IFNE 0                                         S01486
     C***********          MOVE UBRTT     DDOBRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOBRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*SPREAD*RATE***********************************************   S01486
     C***********                                                         S01486
     C***********URTSP     IFNE 0                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE URTSP     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDOSRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOSRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*SPREAD*INDICATOR******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUSPIN     DDOSPI                          S01486
     C***********                                                         S01486
     C***OUR*INTEREST*RATE*CHANGE*FREQUENCY****************************   S01486
     C***********                                                         S01486
     C***********          MOVELUICFR     DDORFQ                          S01486
     C***********                                                         S01486
     C***OUR*NEXT*INTEREST*RATE*CHANGE*DATE****************************   S01486
     C***********                                                         S01486
     C***********UNICD     IFNE 0                                         S01486
     C***********          Z-ADDUNICD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDORCD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDORCD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*INTEREST*RATE*CHANGE*FREQUENCY*DAY************************   S01486
     C***********                                                         S01486
     C***********UICFD     IFNE 0                                         S01486
     C***********          MOVE UICFD     DDORDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDORDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*NEXT*INTEREST*PAYMENT*DATE********************************   S01486
     C***********                                                         S01486
     C***********UNIPD     IFNE 0                                         S01486
     C***********          Z-ADDUNIPD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDOIPD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOIPD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*INTEREST*PAYMENT*FREQUENCY********************************   S01486
     C***********                                                         S01486
     C***********          MOVELUIPFR     DDOIFQ                          S01486
     C***********                                                         S01486
     C***OUR*INTEREST*PAYMENT*FREQUENCY*DAY****************************   S01486
     C***********                                                         S01486
     C***********UIPFD     IFNE 0                                         S01486
     C***********          MOVELUIPFD     DDOIDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOIDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C***THEIR*BASE***RATE**TYPE***************************************   S01486
     C***********                                                         S01486
     C***********TBRTT     IFNE 0                                         S01486
     C***********          MOVE TBRTT     DDTBRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTBRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*SPREAD*RATE*********************************************   S01486
     C***********                                                         S01486
     C***********TRTSP     IFNE 0                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE TRTSP     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDTSRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTSRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*SPREAD*INDICATOR****************************************   S01486
     C***********                                                         S01486
     C***********          MOVELTSPIN     DDTSPI                          S01486
     C***********                                                         S01486
     C***THEIR*INTEREST*RATE*CHANGE*FREQUENCY**************************   S01486
     C***********                                                         S01486
     C***********          MOVELTICFR     DDTRFQ                          S01486
     C***********                                                         S01486
     C***THEIR*NEXT*INTEREST*RATE*CHANGE*DATE**************************   S01486
     C***********                                                         S01486
     C***********TNICD     IFNE 0                                         S01486
     C***********          Z-ADDTNICD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDTRCD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTRCD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*INTEREST*RATE*CHANGE*FREQUENCY*DAY**********************   S01486
     C***********                                                         S01486
     C***********TICFD     IFNE 0                                         S01486
     C***********          MOVE TICFD     DDTRDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTRDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*NEXT*INTEREST*PAYMENT*DATE******************************   S01486
     C***********                                                         S01486
     C***********TNIPD     IFNE 0                                         S01486
     C***********          Z-ADDTNIPD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDTIPD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTIPD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*INTEREST*PAYMENT*FREQUENCY******************************   S01486
     C***********                                                         S01486
     C***********          MOVELTIPFR     DDTIFQ                          S01486
     C***********                                                         S01486
     C***OUR*INTEREST*PAYMENT*FREQUENCY*DAY****************************   S01486
     C***********                                                         S01486
     C***********TIPFD     IFNE 0                                         S01486
     C***********          MOVELTIPFD     DDTIDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTIDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C***********                                                         S01486
      ********************************************************************
      /EJECT
      ********************************************************************
      ***********                                                         S01486
      **#W05*****-*PROCESS*SCREEN*FOR*CCIRS*DEALS**********************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLS:**********************************************   S01486
      **ZDATE2***-*TO*CONVERT*DAY*NUMBER*INTO*ALPHA*DATE***************   S01486
      **ZSEDIT***-*TO*FORMAT*NUMERIC*FIELDS****************************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLED*FROM:****************************************   S01486
      **#FRAIR***-*PROCESSING*OF*FRA/IRS*DEALS*************************   S01486
      ***********                                                         S01486
      **ROUTINE*USES*VARIABLES:****************************************   S01486
      **WWDLNO***-*DEAL*NUMBER*****************************************   S01486
      **WWBRDP***-*BROKER*DECIMAL*PLACES*******************************   S01486
      **WWODCP***-*OUR*CURRENCY*DECIMAL*PLACES*************************   S01486
      **WWTDCP***-*THEIR*CURRENCY*DECIMAL*PLACES***********************   S01486
      ***********                                                         S01486
      ********************************************************************
     C***********#W05      BEGSR                                          S01486
     C***********                                                         S01486
     C***LOAD*RUN*DATE*************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMRUNA    DDRUNA                          S01486
     C***********                                                         S01486
     C***CUSTOMER*NUMBER***********************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMCNUM    DDCNUM                          S01486
     C***********                                                         S01486
     C***CUSTOMER*NAME*************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMCRNM    DDCRNM                          S01486
     C***********                                                         S01486
     C***PORTFOLIO*REFERENCE*******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMPTF2    DDPTFR                          S01486
     C***********                                                         S01486
     C***PORTFOLIO*NARRATIVE*******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMPTFN    DDPTFN                          S01486
     C***********                                                         S01486
     C***DEAL*NUMBER***************************************************   S01486
     C***********                                                         S01486
     C***********          MOVE WWDLNO    DDDEAL                          S01486
     C***********                                                         S01486
     C***DEAL*DATE*****************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDDDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDDDAT                          S01486
     C***********                                                         S01486
     C***BRANCH********************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELBRCD      DDBRCH                          S01486
     C***********                                                         S01486
     C***BROKER********************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELBRKC      DDBROK                          S01486
     C***********                                                         S01486
     C***BROKERAGE*****************************************************   S01486
     C***********                                                         S01486
     C***********BAGE      IFNE 0                                  R10056 S01486
     C***********BAGE      ANDNE*HIVAL                             R10056 S01486
     C***********          Z-ADDBAGE      ZFLD15                          S01486
     C***********          Z-ADDWWBRDP    ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDBRKG                          S01486
     C***********          ELSE                                    R10056 S01486
     C***********          MOVE *BLANK    DDBRKG                   R10056 S01486
     C***********          END                                     R10056 S01486
     C***********                                                         S01486
     C***LINK*DEAL*NBR*************************************************   S01486
     C***********                                                         S01486
     C***********LNKDN     IFNE 0                                         S01486
     C***********          MOVE LNKDN     DDLINK                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVE *BLANKS   DDLINK                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***VALUE*DATE****************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDVDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDVDAT                          S01486
     C***********                                                         S01486
     C***MATURITY*DATE*************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDMDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDMDAT                          S01486
     C***********                                                         S01486
     C***ACCOUNT*SEQ*NO************************************************   S01486
     C***********                                                         S01486
     C***********CDAS      IFNE 0                                         S01486
     C***********          MOVE CDAS      DDACSQ                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDACSQ                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***HEDGE*INDICATOR***********************************************   S01486
     C***********                                                         S01486
     C***********HEDIN     IFEQ 'Y'                                       S01486
     C***********HEDIN     OREQ 'I'                                       S01486
     C***********HEDIN     OREQ 'O'                                       S01486
     C***********          MOVEL'YES'     DDHDGI                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDHDGI                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***TAXABLE*INDICATOR*********************************************   S01486
     C***********                                                         S01486
     C***********TAXI      IFEQ 'Y'                                       S01486
     C***********          MOVEL'YES'     DDTAXA                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDTAXA                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*CURRENCY**************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUCUCY     DDOCUR                          S01486
     C***********                                                         S01486
     C***OUR***PRINCIPAL*AMOUNT****************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDUPAMT     ZFLD15                          S01486
     C***********          Z-ADDWWODCP    ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDOAMO                          S01486
     C***********                                                         S01486
     C***OUR***BASE*CURRENCY*RATE**************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE UBCXR     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDOBCR                          S01486
     C***********                                                         S01486
     C***OUR***CALCULATION*BASIS***************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUICBS     DDOCAL                          S01486
     C***********                                                         S01486
     C***OUR*NEGATIVE*INTEREST*****************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'1'       UDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDONGI                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDONGI                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR***FED*FUNDS***********************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'2'       UDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDOFDF                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDOFDF                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*BASE***RATE**TYPE*****************************************   S01486
     C***********                                                         S01486
     C***********UBRTT     IFNE 0                                         S01486
     C***********          MOVE UBRTT     DDOBRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOBRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*SPREAD*RATE***********************************************   S01486
     C***********                                                         S01486
     C***********URTSP     IFNE 0                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE URTSP     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDOSRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOSRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*SPREAD*INDICATOR******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUSPIN     DDOSPI                          S01486
     C***********                                                         S01486
     C***OUR*INTEREST*RATE*CHANGE*FREQUENCY****************************   S01486
     C***********                                                         S01486
     C***********          MOVELUICFR     DDORFQ                          S01486
     C***********                                                         S01486
     C***OUR*NEXT*INTEREST*RATE*CHANGE*DATE****************************   S01486
     C***********                                                         S01486
     C***********UNICD     IFNE 0                                         S01486
     C***********          Z-ADDUNICD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDORCD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDORCD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*INTEREST*RATE*CHANGE*FREQUENCY*DAY************************   S01486
     C***********                                                         S01486
     C***********UICFD     IFNE 0                                         S01486
     C***********          MOVE UICFD     DDORDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDORDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*NEXT*INTEREST*PAYMENT*DATE********************************   S01486
     C***********                                                         S01486
     C***********UNIPD     IFNE 0                                         S01486
     C***********          Z-ADDUNIPD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDOIPD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOIPD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*INTEREST*PAYMENT*FREQUENCY********************************   S01486
     C***********                                                         S01486
     C***********          MOVELUIPFR     DDOIFQ                          S01486
     C***********                                                         S01486
     C***OUR*INTEREST*PAYMENT*FREQUENCY*DAY****************************   S01486
     C***********                                                         S01486
     C***********UIPFD     IFNE 0                                         S01486
     C***********          MOVELUIPFD     DDOIDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOIDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C***THEIR*CURRENCY************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELTCUCY     DDTCUR                          S01486
     C***********                                                         S01486
     C***THEIR*PRINCIPAL*AMOUNT****************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDTPAMT     ZFLD15                          S01486
     C***********          Z-ADDWWTDCP    ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDTAMO                          S01486
     C***********                                                         S01486
     C***THEIR*BASE*CURRENCY*RATE**************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE TBCXR     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDTBCR                          S01486
     C***********                                                         S01486
     C***THEIR*CALCULATION*BASIS***************************************   S01486
     C***********                                                         S01486
     C***********          MOVELTICBS     DDTCAL                          S01486
     C***********                                                         S01486
     C***THEIR*NEGATIVE*INTEREST***************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'1'       TDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDTNGI                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDTNGI                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*FED*FUNDS***********************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'2'       TDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDTFDF                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDTFDF                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*BASE***RATE**TYPE***************************************   S01486
     C***********                                                         S01486
     C***********TBRTT     IFNE 0                                         S01486
     C***********          MOVE TBRTT     DDTBRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTBRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*SPREAD*RATE*********************************************   S01486
     C***********                                                         S01486
     C***********TRTSP     IFNE 0                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE TRTSP     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDTSRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTSRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*SPREAD*INDICATOR****************************************   S01486
     C***********                                                         S01486
     C***********          MOVELTSPIN     DDTSPI                          S01486
     C***********                                                         S01486
     C***THEIR*INTEREST*RATE*CHANGE*FREQUENCY**************************   S01486
     C***********                                                         S01486
     C***********          MOVELTICFR     DDTRFQ                          S01486
     C***********                                                         S01486
     C***THEIR*NEXT*INTEREST*RATE*CHANGE*DATE**************************   S01486
     C***********                                                         S01486
     C***********TNICD     IFNE 0                                         S01486
     C***********          Z-ADDTNICD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDTRCD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTRCD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR**INTEREST*RATE*CHANGE*FREQUENCY*DAY*********************   S01486
     C***********                                                         S01486
     C***********TICFD     IFNE 0                                         S01486
     C***********          MOVE TICFD     DDTRDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTRDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*NEXT*INTEREST*PAYMENT*DATE******************************   S01486
     C***********                                                         S01486
     C***********TNIPD     IFNE 0                                         S01486
     C***********          Z-ADDTNIPD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDTIPD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTIPD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***THEIR*INTEREST*PAYMENT*FREQUENCY******************************   S01486
     C***********                                                         S01486
     C***********          MOVELTIPFR     DDTIFQ                          S01486
     C***********                                                         S01486
     C***THEIR*INTEREST*PAYMENT*FREQUENCY*DAY**************************   S01486
     C***********                                                         S01486
     C***********TIPFD     IFNE 0                                         S01486
     C***********          MOVELTIPFD     DDTIDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDTIDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C***********                                                         S01486
      ********************************************************************
      /EJECT
      ********************************************************************
      ***********                                                         S01486
      **#W06*****-*PROCESS*SCREEN*FOR*IRC/C*DEALS**********************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLS:**********************************************   S01486
      **ZDATE2***-*TO*CONVERT*DAY*NUMBER*INTO*ALPHA*DATE***************   S01486
      **ZSEDIT***-*TO*FORMAT*NUMERIC*FIELDS****************************   S01486
      ***********                                                         S01486
      **SUBROUTINE*CALLED*FROM:****************************************   S01486
      **#FRAIR***-*PROCESSING*OF*FRA/IRS*DEALS*************************   S01486
      ***********                                                         S01486
      **ROUTINE*USES*VARIABLES:****************************************   S01486
      **WWDLNO***-*DEAL*NUMBER*****************************************   S01486
      **WWBRDP***-*BROKER*DECIMAL*PLACES*******************************   S01486
      **WWODCP***-*OUR*CURRENCY*DECIMAL*PLACES*************************   S01486
      ***********                                                         S01486
      ********************************************************************
     C***********#W06      BEGSR                                          S01486
     C***********                                                         S01486
     C***LOAD*RUN*DATE*************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMRUNA    DDRUNA                          S01486
     C***********                                                         S01486
     C***CUSTOMER*NUMBER***********************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMCNUM    DDCNUM                          S01486
     C***********                                                         S01486
     C***CUSTOMER*NAME*************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMCRNM    DDCRNM                          S01486
     C***********                                                         S01486
     C***PORTFOLIO*REFERENCE*******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMPTF2    DDPTFR                          S01486
     C***********                                                         S01486
     C***PORTFOLIO*NARRATIVE*******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELQMPTFN    DDPTFN                          S01486
     C***********                                                         S01486
     C***DEAL*NUMBER***************************************************   S01486
     C***********                                                         S01486
     C***********          MOVE WWDLNO    DDDEAL                          S01486
     C***********                                                         S01486
     C***DEAL*DATE*****************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDDDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDDDAT                          S01486
     C***********                                                         S01486
     C***BRANCH********************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELBRCD      DDBRCH                          S01486
     C***********                                                         S01486
     C***BROKER********************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELBRKC      DDBROK                          S01486
     C***********                                                         S01486
     C***BROKERAGE*****************************************************   S01486
     C***********                                                         S01486
     C***********BAGE      IFNE 0                                  R10056 S01486
     C***********BAGE      ANDNE*HIVAL                             R10056 S01486
     C***********          Z-ADDBAGE      ZFLD15                          S01486
     C***********          Z-ADDWWBRDP    ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDBRKG                          S01486
     C***********          ELSE                                    R10056 S01486
     C***********          MOVE *BLANK    DDBRKG                   R10056 S01486
     C***********          END                                     R10056 S01486
     C***********                                                         S01486
     C***LINK*DEAL*NBR*************************************************   S01486
     C***********                                                         S01486
     C***********LNKDN     IFNE 0                                         S01486
     C***********          MOVE LNKDN     DDLINK                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVE *BLANKS   DDLINK                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***VALUE*DATE****************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDVDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDVDAT                          S01486
     C***********                                                         S01486
     C***MATURITY*DATE*************************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDMDAT      ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZADATE    DDMDAT                          S01486
     C***********                                                         S01486
     C***ACCOUNT*SEQ*NO************************************************   S01486
     C***********                                                         S01486
     C***********CDAS      IFNE 0                                         S01486
     C***********          MOVE CDAS      DDACSQ                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDACSQ                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***CURRENCY******************************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUCUCY     DDCURR                          S01486
     C***********                                                         S01486
     C***PRINCIPAL*AMOUNT**********************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADDUPAMT     ZFLD15                          S01486
     C***********          Z-ADDWWODCP    ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDAMON                          S01486
     C***********                                                         S01486
     C***BASE*CURRENCY*RATE********************************************   S01486
     C***********                                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE UBCXR     ZFLDA                           S01486
     C***********          Z-ADD8         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDBRAT                          S01486
     C***********                                                         S01486
     C***HEDGE*INDICATOR***********************************************   S01486
     C***********                                                         S01486
     C***********HEDIN     IFEQ 'Y'                                       S01486
     C***********HEDIN     OREQ 'I'                                       S01486
     C***********HEDIN     OREQ 'O'                                       S01486
     C***********          MOVEL'YES'     DDHDGI                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDHDGI                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***TAXABLE*INDICATOR*********************************************   S01486
     C***********                                                         S01486
     C***********TAXI      IFEQ 'Y'                                       S01486
     C***********          MOVEL'YES'     DDTAXA                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDTAXA                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***FED*FUNDS*****************************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'2'       UDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDFEDF                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDFEDF                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***CALCULATION*METHOD********************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUICBS     DDCALC                          S01486
     C***********                                                         S01486
     C***NEGATIVE*INTEREST*********************************************   S01486
     C***********                                                         S01486
     C***********          TESTB'1'       UDSTI          72               S01486
     C************IN72     IFEQ '1'                                       S01486
     C***********          MOVEL'YES'     DDNEGI                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL'NO '     DDNEGI                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*BASE***RATE**TYPE*****************************************   S01486
     C***********                                                         S01486
     C***********UBRTT     IFNE 0                                         S01486
     C***********          MOVE UBRTT     DDOBRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOBRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*SPREAD*RATE***********************************************   S01486
     C***********                                                         S01486
     C***********URTSP     IFNE 0                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE URTSP     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDOSRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOSRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*SPREAD*INDICATOR******************************************   S01486
     C***********                                                         S01486
     C***********          MOVELUSPIN     DDOSPI                          S01486
     C***********                                                         S01486
     C***OUR*INTEREST*RATE*CHANGE*FREQUENCY****************************   S01486
     C***********                                                         S01486
     C***********          MOVELUICFR     DDORFQ                          S01486
     C***********                                                         S01486
     C***OUR*NEXT*INTEREST*RATE*CHANGE*DATE****************************   S01486
     C***********                                                         S01486
     C***********UNICD     IFNE 0                                         S01486
     C***********          Z-ADDUNICD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDORCD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDORCD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*INTEREST*RATE*CHANGE*FREQUENCY*DAY************************   S01486
     C***********                                                         S01486
     C***********UICFD     IFNE 0                                         S01486
     C***********          MOVE UICFD     DDORDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDORDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*NEXT*INTEREST*PAYMENT*DATE********************************   S01486
     C***********                                                         S01486
     C***********UNIPD     IFNE 0                                         S01486
     C***********          Z-ADDUNIPD     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVELZADATE    DDOIPD                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOIPD                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***OUR*INTEREST*PAYMENT*FREQUENCY********************************   S01486
     C***********                                                         S01486
     C***********          MOVELUIPFR     DDOIFQ                          S01486
     C***********                                                         S01486
     C***OUR*INTEREST*PAYMENT*FREQUENCY*DAY****************************   S01486
     C***********                                                         S01486
     C***********UIPFD     IFNE 0                                         S01486
     C***********          MOVELUIPFD     DDOIDY                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDOIDY                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***CEILING*RATE**************************************************   S01486
     C***********                                                         S01486
     C***********CLRAT     IFNE 0                                         S01486
     C***********          Z-ADD0         ZFLD15                          S01486
     C***********          MOVE CLRAT     ZFLDA                           S01486
     C***********          Z-ADD7         ZDECS                           S01486
     C***********          EXSR ZSEDIT                                    S01486
     C***********          MOVE ZOUT21    DDCGRT                          S01486
     C***********          ELSE                                           S01486
     C***********          MOVEL*BLANKS   DDCGRT                          S01486
     C***********          END                                            S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C***********                                                         S01486
      ********************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      /COPY ZSRSRC,ZSEDITZ3
      /EJECT
      /COPY ZSRSRC,GLINTCZ1
      /EJECT
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
      /COPY ZSRSRC,ZRSTORZ1
      /EJECT
      /COPY ZSRSRC,ZSAVEZ1
     C/COPY ZSRSRC,ZINTDYZ2                                               S01486
      /EJECT                                                              S01486
     C/COPY ZSRSRC,ZDATE9Z3                                               S01486
      /EJECT
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - PROCESSING OF DATA BASE ERRORS                        *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1000**-*TO*UPDATE**GDA**************************************   S01486
      **PMC1020**-*TO*TRANSFER*GROUP*JOBS******************************   S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      **WWPARM***-*PARAMETER*USED*TO*TRANSFER**GDA*********************   S01486
      **WWEND****-*PARAMETER*FOR*PMC1020*******************************   S01486
      **WWGRPJ***-*PARAMETER*FOR*PMC1020*******************************   S01486
      *                                                                  *
      ********************************************************************
     C           *PSSR     BEGSR
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVEL'Y'       QMDBER
     C                     MOVEL'PM2000'  QMPGM
     C                     MOVEL'Y'       QMENQT
     C**
     C***UPDATE**GDA***************************************************   S01486
     C***********                                                         S01486
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C**
     C**  Update data area *LDA                                           S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C*                                                                   S01486
     C                     DUMP
     C**
     C***********          CALL 'PMC1020'                                 S01486
     C                     CALL 'DBERRCTL'                                S01486
     C                     RETRN                                          S01486
     C**
     C                     ENDSR
     C**
**  CPY@
(c) Finastra International Limited 2001
**  ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**  ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**  ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
