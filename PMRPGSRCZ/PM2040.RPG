     H        1                                                           S01486
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Retail accounts enquiry')                     *
     H***********                                                         S01486
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management Module                          *
     F*                                                               *
     F*  PM2040 - ACCOUNT DETAILS ENQUIRY                             *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 17May01               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CPM005             Date 11Jul96               *
     F*                 CPM004             DATE 14FEB96               *
     F*                 085862             DATE 16MAR95               *
     F*                 085817             DATE 13MAR95               *
     F*                 081239             DATE 01FEB95               *
     F*                 081345             DATE 09JAN95               *
     F*                 S01486             DATE 09DEC94               *
     F*                 SA9108             DATE 06NOV91               *
     F*                 S01313             DATE 06NOV92               *
     F*                 B9667  SL          DATE 05SEP91               *
     F*                 B08257             DATE 15/10/91              *
     F*                 B08193             DATE 11/03/91              *
     F*                 R05661             DATE 11/03/91              *
     F*                 R05615             DATE 07/03/91              *
     F*                 R10036             DATE 19/09/90              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  CSD006 - Use DSSDY for call to AOBSRTR0.                     *
     F*  CPM005 - Private Banking Phase II                            *
     F*           Focus Group Changes Upgraded to DBA                 *
     F*  CPM004 - Bank Portfolios                                     *
     F*  085862 - INCLUDE BRANCH CODE IN ACCOUNT IDENTIFIER           *
     F*  085817 - Recompile due to changes in PMLDAPD                 *
     F*  081239 - R10 Private Banking Rework                          *
     F*  081345 - Invalid length for branch                           *
     F*  S01486 - Portfolio Management Upgrade to Release 10          *
     F*  SA9108 - POOL SECURITIES TRANSACTIONS (ONLY RECOMPILED       *
     F*           FOR DTAARA/LDA)                                     *
     F*  S01313 - RECOMPILED DUE TO PORTFOLIO PERFORMANCE             *
     F*  B9667  - INTEREST SUBTYPES HAVE ALWAYS RECORD TYPE 'D'       *
     F*  B08257 - LF/RECRG ACCESSED WITH INCORRECT KEY                *
     F*  B08193 - IF OVERDRAFT EXPIRY DATE BEFORE RUN DATE THE        *
     F*           OVERDRAFT LIMIT & EXPIRY DATE SHOULD BE BLANK       *
     F*  R05661 - IF 9998 OR 9999 PORTFOLIO DISPLAYED OUTPUT THE      *
     F*           POSITION PORTFOLIO IN BRACKETS                      *
     F*  R05615 - DISPLAY BASE INTEREST RATE ON SCREEN                *
     F*  R10036 - DISPLAY TEXT FOR CODES ON 'RETAIL ACCOUNT           *
     F*           DETAILS ENQUIRY' SECOND SCREEN                      *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F***SDBSRTL1IF**E           K        DISK                     R10036 S01486
     F***********                                   KINFSR *PSSR   R10036 S01486
     F***PREFIX*'BA'***********************************************R10036 S01486
     F**                                                                  R10036
     FREINT   IF  E           K        DISK                               R10036
     F                                              KINFSR *PSSR          R10036
     F**                                                                  R10036
     FRECRG   IF  E           K        DISK                               R10036
     F                                              KINFSR *PSSR          R10036
     F**                                                                  R10036
     F*
     F***PM2040DDCF**E                    WORKSTN                         S01486
     FPM2040DFCF  E                    WORKSTN                            S01486
     F** PREFIX 'DD' **
     F**
     FREIAC   IF  E           K        DISK
     F            REIACAF                           KIGNORE
     F            REIACZF                           KIGNORE
     F                                              KINFSR *PSSR
     F** PREFIX '  ' **
     F**
     FACCNT   IF  E           K        DISK
     F            ACCNTAAF                          KIGNORE
     F            ACCNTACF                          KIGNORE
     F                                              KINFSR *PSSR
     F** PREFIX '  ' **
     F******************************************************************
     F**                                                              **
     F**    F U N C T I O N   O F   I N D I C A T O R S               **
     F**                                                              **
     F******************************************************************
     F**  U7 - PROGRAM ERROR
     F**  U8 - DATA BASE ERROR
     F**
     F**  KC - TO EXIT JOB
     F**  KL - TO RETURN TO PREVIOUS PROGRAM
     F**
     F**  50    - MULTIBRANCHING INDICATOR                                S01486
     F**  71    - FILE PROCESSING
     F**  72    - TEST BIT OPERATION
     F**  73    - ACCOUNT TYPE = 'R'                                      CPM004
     F**  74    - BANK PORTFOLIOS SUPPORTED                               CPM004
     F**
     F**  90-99 - STANDARD SUBROUTINES
     F**
     F**
     F******************************************************************
     E**
     E**
     E** TABLES AND ARRAYS
     E*********************************************************************
      ** ARRAY FOR COPYRIGHT
      *
     E                    CPY@    1   1 80
     E**
     E***ARRAY*TO*ENABLE*ATTENTION*KEY*****************************       S01486
     E***********                                                         S01486
     E***********         ATN     1   1 22                                S01486
      /COPY ZSRSRC,ZDATE2Z1
      /COPY ZSRSRC,ZSEDITZ1
     I*************************************************************
     I**
     I***EXTERNAL*FORMAT*FOR*GROUP*DATA*AREA***************************   S01486
     I***********                                                         S01486
     I***WWGDA*****E DSPMGRDAPP                                           S01486
     I*
     I***WWLDA*****E DSPMLDAPP                                            S01486
     IWWLDA     E DSPMLDAPD                                               S01486
     I*
     I** PROGRAM STATUS DATA STRUCTURE FOR WS/USER ID'S
     I*
     IPSDS       SDS
     I                                      244 253 WSID
     I                                      254 263 USID
     I**
     I** DATA STRUCTURE FOR SUBROUTINE ZSEDIT
     I**
     I            DS
     I                                        1  150ZFLD15
     I                                        1  15 ZFLDA
      /COPY ZSRSRC,ZSEDITZ2
     I**
     I** DATA STRUCTURE FOR PMACCN KEY
     I**
     IPKEY        DS
     I**********                              1   60WWCNUM                                    CSD027
     I                                        1   6 WWCNUM                                    CSD027
     I                                        7   9 WWCUCY
     I                                       10  190WWACOD                                    CGL029
     I                                       20  210WWACSQ                                    CGL029
     I                                       22  24 WWBRCD                                    CGL029
     I**********                             10  130WWACOD                                    CGL029
     I**********                             14  150WWACSQ                                    CGL029
     I************************************** 14  150WWBRCA         S01486 081345
     I***********                            16  180WWBRCA          081345085862
     I**********                             16  18 WWBRCD                             085862 CGL029
     I**                                                                  R10036
     I***DATA*STRUCTURE*FOR*KBSRT*KEY******************************R10036 S01486
     I***********                                                  R10036 S01486
     I***DSBSRT******DS                                            R10036 S01486
     I****************************************1   3 BACYCD         R10036 S01486
     I****************************************4   5 BABSRC         R10036 S01486
     I**                                                                  R10036
     I** DATA STRUCTURE FOR KREINT KEY                                    R10036
     I**                                                                  R10036
     IKREINT      DS                                                      R10036
     I                                        1   1 KREIN1                R10036
     I                                        2   30KREIN2                R10036
     I                                        4   80KREIN3                R10036
     I                                        9  11 KREIN4                R10036
     I                                       12  12 KREIN5                R10036
     I**
     I*
     ICPYR@#      DS
     I*
     I** DATA STRUCTURE FOR COMPILATION  - COPYRIGHT INSERTION
     I*
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I**
     I*                                                                   S01486
     IRUNDAT    E DS                                                      S01486
     I**  Standard Data Area Layout for system flags and run date         S01486
     I*                                                                   S01486
     ISDBSRT    E DSSDBSRTPD                                              S01486
     I**  Data structure for base rate details                            S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I**  First data structure for access pgms, short data structure      S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 CPM004
     I**  Long data structure for access programs                         CPM004
     I*                                                                   CPM004
     ISDCUST    E DSSDCUSTPD                                              CPM004
     I**  Data structure for Customer details                             CPM004
     I/COPY WNCPYSRC,PM2040I001
     I*                                                                   CPM004
      ********************************************************************
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #INIT    - INITIAL PROCESSING                                    *
      * #P01     - ACCESS ACCOUNT DETAILS                                *
      * #W01     - WRITE ACCOUNT DETAILS TO THE SCREEN (1ST SCREEN)      *
      * #W02     - WRITE ACCOUNT DETAILS TO THE SCREEN (2ND SCREEN)      *
      * ZSEDIT   - TO FORMAT NUMERIC FIELD WITH DECIMAL POINT            *
      * ZDATE2   - TO CONVERT MIDAS DAY NUMBER IN ALPHA DATE             *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      **PMC1010**-*TO*READ*DATA*AREA**GDA*********************************S01486
      **QCMDEXC**-*SYSTEM*PROGRAM*CALLED*TO*SET*UP*ATTENTION*KEY**********S01486
      **PMC1020**-*TO*TRANSFER*AND*END*GROUP*JOBS*************************S01486
      **PMC1000**-*TO*UPDATE*DATA*AREA**GDA*******************************S01486
      * SDRTVTXT - TO RETRIEVE MESSAGE FROM MESSAGE FILE                 *R10036
      *                                                                  *
      ********************************************************************
     C**************************************************************
     C** P R O G R A M   S T A R T
     C**************************************************************
     C           *ENTRY    PLIST
     C                     PARM           WWACCU  6                       CPM004
     C                     PARM           WWCCY   3
     C**********           PARM           WWCODE  4                                           CGL029
     C                     PARM           WWCODE 10                                           CGL029
     C                     PARM           WWSEQU  2
     C                     PARM           WWBRCA  3                       085862
     C*                                                                   S01486
     C**  Copyright statement                                             S01486
     C*                                                                   S01486
     C                     MOVEACPY@      CPY2@  80                       S01486
     C**
     C** KEY LIST
     C**
     C           PMACCN    KLIST
     C***********          KFLD           QMCNUM                          CPM004
     C                     KFLD           WWCNUM                          CPM004
     C                     KFLD           WWCUCY
     C                     KFLD           WWACOD
     C                     KFLD           WWACSQ
     C***********          KFLD           QMBRCA                    S01486085862
     C                     KFLD           WWBRCD                          085862
     C**                                                                  R10036
     C***********KBSRT     KLIST                                   R10036 S01486
     C***********          KFLD           BACYCD                   R10036 S01486
     C***********          KFLD           BABSRC                   R10036 S01486
     C**
     C**********           MOVE WWCODE    WWACOD  40                                          CGL029
     C                     MOVE WWCODE    WWACOD                                              CGL029
     C                     MOVE WWSEQU    WWACSQ  20
     C                     MOVE WWBRCA    WWBRCD  3                       085862
     C**
     C                     EXSR #INIT
     C**
     C                     EXSR #P01
     C**
     C                     RETRN
     C**
     C**************************************************************
     C** P R O G R A M   E N D
     C**************************************************************
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #INIT    - INITIAL PROCESSING                                    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1010**-*TO*READ*DATA*AREA**GDA*********************************S01486
      **QCMDEXC**-*SYSTEM*PROGRAM*CALLED*TO*SET*UP*ATTENTION*KEY**********S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWDISP   - DISPLAY FLAG                                          *
      **WWPARM***-*PARAMETER*RECEIVED*BY*THIS*PROGRAM*(*GDA)**************S01486
      * WWCNUM   - CUSTOMER NUMBER                                       *
      * WWCUCY   - CURRENCY                                              *
      **WWFLD****-*PARAMETER*FOR*QCMDEXC**********************************S01486
      **WWNUMB***-*PARAMETER*FOR*QCMDEXC**********************************S01486
      *                                                                  *
      ********************************************************************
     C           #INIT     BEGSR
     C**
     C** RESET WORK INDICATORS
     C**
     C                     MOVE '0'       *IN
     C                     MOVE '0'       *INKL
     C                     MOVEL'J'       ZECODE
     C**
     C                     MOVE '1'       WWDISP  1
     C**
     C***RECEIVE*PARAMETERS*FROM*DATA*AREA**GDA************************   S01486
     C**  Receive parameters from data area *LDA                          S01486
     C**
     C                     CALL 'PMC1003'
     C                     PARM           WWLDA
     C*                                                                   S01486
     C**  Load Run Date                                                   S01486
     C*                                                                   S01486
     C                     MOVELQMRUNA    DDRUNA
     C**
     C*********************Z-ADDQMCNUM    WWCNUM                          CPM004
     C***********          MOVE QMBRCA    WWBRCA                    S01486085862
     C                     MOVELWWACCU    WWCNUM                          CPM004
     C                     MOVE QMBRCA    WWBRCD                          085862
     C                     MOVELWWCCY     WWCUCY
     C**
     C***SET*THE*ATTENTION*PROGRAM*TO**********************************   S01486
     C***PMC0610*******************************************************   S01486
     C***********                                                         S01486
     C***ENABLE*ATTENTION*PROGRAM**************************************   S01486
     C***********                                                         S01486
     C***********          MOVEAATN       WWFLD  22                       S01486
     C***********          Z-ADD22        WWNUMB 155                      S01486
     C***********          CALL 'QCMDEXC'                                 S01486
     C***********          PARM           WWFLD                           S01486
     C***********          PARM           WWNUMB                          S01486
     C**                                                                  R10036
     C**  SET UP PARAMETER TO RETRIEVE MESSAGE FROM MESSAGE FILE          R10036
     C**                                                                  R10036
     C           PLLANG    PLIST                                          R10036
     C                     PARM           MSMBR4  7                       R10036
     C                     PARM           MSGER  10                       R10036
     C                     PARM           MSGTXT 80                       R10036
     C***********          MOVEL'MLGBMSGF'MSGER                    R10036 S01486
     C                     MOVEL'PMUSRMSG'MSGER                           S01486
     C*                                                                   S01486
     C**  Read in DTAARA/RUNDAT to get multibranching indicator           S01486
     C*                                                                   S01486
     C           *NAMVAR   DEFN           RUNDAT                          S01486
     C                     IN   RUNDAT                                    S01486
     C*                                                                   S01486
     C           AGMBIN    IFEQ 'Y'                                       S01486
     C                     MOVE '1'       *IN50                           S01486
     C                     END                                            S01486
     C**
     C/COPY WNCPYSRC,PM2040C001
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P01     - ACCESS ACCOUNT DETAILS                                *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      * #W01     - WRITE ACCOUNT DETAILS TO THE SCREEN (1ST SCREEN)      *
      * #W02     - WRITE ACCOUNT DETAILS TO THE SCREEN (2ND SCREEN)      *
      **PMC1020**-*TO*TRANSFER*AND*END*GROUP*JOBS*************************S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWDISP   - DISPLAY FLAG                                          *
      **WWEND****-*PARAMETER*FOR*PMC1020**********************************S01486
      **WWGRPJ***-*PARAMETER*FOR*PMC1020**********************************S01486
      *                                                                  *
      ********************************************************************
     C           #P01      BEGSR
     C**
     C** ACCESS LF ACCNT
     C**
     C           PMACCN    CHAINACCNT                70
     C**
     C           *IN70     IFEQ '1'                        ***************
     C                     Z-ADD1         QMERRN           **DB ERROR 01**
     C                     MOVEL'Y'       QMDBER           ***************
     C                     MOVEL'PM2040'  QMPGM
     C***********          MOVEL'ACCNT'   QMFILE                          S01486
     C                     MOVE 'ACCNT'   QMFILE                          S01486
     C                     MOVELPKEY      QMKEY
     C**
     C                     EXSR *PSSR
     C                     END
     C*                                                                   R05661
     C** FOR 9998 AND 9999 PORTFOLIOS OUTPUT ADDITIONAL REFERENCE         R05661
     C           QMPTF1    IFEQ '9998'                                    R05661
     C           QMPTF1    OREQ '9999'                                    R05661
     C                     MOVE '1'       *IN17                           R05661
     C                     MOVEL'('       WWWRK5  5                       R05661
     C           PTFR      IFEQ '9997'                                    R05661
     C                     MOVE QMR997    WWWRK5                          R05661
     C                     ELSE                                           R05661
     C                     MOVE PTFR      WWWRK5                          R05661
     C                     END                                            R05661
     C                     MOVELWWWRK5    DDPTF1                          R05661
     C                     MOVE ')'       DDPTF1                          R05661
     C                     ELSE                                           R05661
     C                     MOVE '0'       *IN17                           R05661
     C                     MOVE *BLANKS   DDPTF1                          R05661
     C                     END                                            R05661
     C**                                                                  CPM004
     C                     SETOF                     73                   CPM004
     C           ATYP      IFEQ 'R'                                       CPM004
     C                     SETON                     73                   CPM004
     C**
     C** ACCESS REIAC
     C**
     C           PMACCN    CHAINREIAC                70
     C**
     C           *IN70     IFEQ '1'                        ***************
     C                     Z-ADD2         QMERRN           **DB ERROR 02**
     C                     MOVEL'Y'       QMDBER           ***************
     C                     MOVEL'PM2040'  QMPGM
     C***********          MOVEL'REIAC'   QMFILE                          S01486
     C                     MOVE 'REIAC'   QMFILE                          S01486
     C                     MOVELPKEY      QMKEY
     C**
     C                     EXSR *PSSR
     C                     END
     C                     ENDIF                                          CPM004
     C**
     C** FILL SCREENS
     C**
     C                     EXSR #W01
     C           ATYP      IFEQ 'R'                                       CPM004
     C                     EXSR #W02
     C                     ENDIF                                          CPM004
     C**
     C** PROCESS WITH SCREENS
     C**
     C************INKC     DOUEQ'1'                                       081239
     C************INKL     OREQ '1'                                       081239
     C***********                                                   S01486081239
     C***If*F22*pressed,*access*Enquiry*selection*screen************S01486081239
     C***********                                                   S01486081239
     C************INKW     IFEQ '1'                                 S01486081239
     C***********          CALL 'PMC0610'                           S01486081239
     C***********          END                                      S01486081239
     C           QMENQT    DOUEQ'Y'                                       081239
     C           QMENQT    OREQ 'C'                                       081239
     C           QMENQT    OREQ 'P'                                       081239
     C           QMENQT    OREQ 'D'                                       081239
     C           *INKL     OREQ '1'                                       081239
     C**
     C           WWDISP    IFEQ '1'
     C                     EXFMTPM2040F1
     C                     ELSE
     C                     EXFMTPM2040F2
     C                     END
     C/COPY WNCPYSRC,PM2040C002
     C*                                                                   081239
     C** If F3  pressed, exit program                                     081239
     C*                                                                   081239
     C           *INKC     IFEQ '1'                                       081239
     C                     MOVE 'Y'       QMENQT                          081239
     C                     CALL 'PMC1001'                                 081239
     C                     PARM           WWLDA                           081239
     C                     END                                            081239
     C**********                                                    081239CPM005
     C***If*F22*pressed, access Enquiry selection screen            081239CPM005
     C**********                                                    081239CPM005
     C********** *INKW     IFEQ '1'                                 081239CPM005
     C**********           CALL 'PMC0610'                           081239CPM005
     C**********                                                    081239CPM005
     C***Retrieve *LDA values                                       081239CPM005
     C**********                                                    081239CPM005
     C**********           CALL 'PMC1003'                           081239CPM005
     C**********           PARM           WWLDA                     081239CPM005
     C**********           END                                      081239CPM005
     C**                                                                  CPM004
     C           ATYP      IFEQ 'R'                                       CPM004
     C**
     C** IF ROLLUP REQUESTED
     C**
     C           *IN25     IFEQ '1'
     C                     MOVE '2'       WWDISP
     C                     END
     C**
     C** IF ROLLDOWN REQUESTED
     C**
     C           *IN26     IFEQ '1'
     C                     MOVE '1'       WWDISP
     C                     END
     C**                                                                  CPM004
     C                     ENDIF                                          CPM004
     C**
     C                     END
     C**
     C************INKC     IFEQ '1'                                       081239
     C***********                                                         081239
     C***SET*ENQUIRIES*TERMINATING*TO*'Y'*********************************081239
     C***********                                                         081239
     C***********          MOVE 'Y'       QMENQT                          081239
     C***********                                                         081239
     C***WRITE*DETAILS*ON**GDA*****************************************   S01486
     C***********                                                         S01486
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C***********                                                   S01486081239
     C***UPDATE**LDA************************************************S01486081239
     C***********                                                   S01486081239
     C***********          CALL 'PMC1001'                           S01486081239
     C***********          PARM           WWLDA                     S01486081239
     C***********                                                         081239
     C***********          END                                            081239
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W01     - WRITE ACCOUNT DETAILS TO THE SCREEN (1ST SCREEN)      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZDATE2   - TO CONVERT MIDAS DAY NUMBER IN ALPHA DATE             *
      * ZSEDIT   - TO FORMAT NUMERIC FIELD WITH DECIMAL POINT            *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - ACCESS ACCOUNT DETAILS                                *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWCUCY   - CURRENCY                                              *
      * WWACOD   - ACCOUNT CODE                                          *
      * WWACSQ   - ACCOUNT SEQUENCE                                      *
      *                                                                  *
      ********************************************************************
     C           #W01      BEGSR
     C**
     C** CUSTOMER NUMBER, CUSTOMER NAME, PORTFOLIO REFERENCE
     C** AND PORTFOLIO NARRATIVE
     C**
     C                     MOVELQMCNUM    DDCNUM
     C                     MOVELQMCRNM    DDCRNM
     C           QMPORS    IFEQ 'B'                                       CPM004
     C                     SETON                     74                   CPM004
     C**                                                                  CPM004
     C** CALL AOCUSTR0 TO GET ACCOUNT CUSTOMER NAME                       CPM004
     C**                                                                  CPM004
     C                     MOVELWWACCU    P@KEY1                          CPM004
     C                     CALL 'AOCUSTR0'                                CPM004
     C                     PARM *BLANKS   P@RTCD  7                       CPM004
     C                     PARM '*KEY   ' P@OPTN  7                       CPM004
     C                     PARM           P@KEY1 10                       CPM004
     C                     PARM *BLANKS   P@KYST  7                       CPM004
     C           SDCUST    PARM SDCUST    DSSDY                           CPM004
     C**                                                                  CPM004
     C** ACCOUNT CUSTOMER NUMBER                                          CPM004
     C**                                                                  CPM004
     C                     MOVELWWACCU    DDACCU                          CPM004
     C**                                                                  CPM004
     C** ACCOUNT CUSTOMER NAME                                            CPM004
     C**                                                                  CPM004
     C                     MOVELBBCRNM    DDCPRN                          CPM004
     C                     ENDIF                                          CPM004
     C                     MOVELQMPTF2    DDPTFR
     C                     MOVELQMPTFN    DDPTFN
     C**
     C** CURRENCY, ACCOUNT CODE, ACCOUNT SEQUENCE
     C**
     C                     MOVELWWCUCY    DDCCY
     C                     MOVE WWACOD    DDACOD
     C                     MOVE WWACSQ    DDACSQ
     C                     MOVE WWBRCD    DDBRCD                          085862
     C**
     C** BRANCH CODE, RETAIL ACCOUNT NUMBER, ACCOUNT NAME
     C**
     C***********          MOVELBRCD      DDBRCD                          S01486
     C***********          MOVELBRCA      DDBRCD                    S01486085862
     C**
     C           ATYP      IFEQ 'R'
     C                     MOVELACNO      DDACCN
     C                     ELSE
     C                     MOVEL*BLANKS   DDACCN
     C                     END
     C                     MOVELANAM      DDACNM
     C**
     C** DATE ACCOUNT OPENED
     C**
     C                     Z-ADDDACO      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDACCO
     C**
     C** NEXT STATEMENT DATE
     C**
     C                     Z-ADDNSTD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDNSDT
     C**
     C** STATEMENT FREQUENCY
     C**
     C                     MOVELSTFQ      DDNSFQ
     C**
     C** PRINT ADDRESS
     C**
     C                     TESTB'2'       GLBT           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'Y'       DDPTAD
     C                     ELSE
     C                     MOVEL'N'       DDPTAD
     C                     END
     C**
     C** ADDRESS REFERENCE 1 & 2
     C**
     C                     MOVELADREF1    DDADRF
     C                     MOVE ADREF2    DDADRF
     C**
     C** MINIMUM BALANCE
     C**
     C                     Z-ADDMINB      ZFLD15
     C                     Z-ADD0         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDMBAL
     C**
     C** OVERDRAFT LINE
     C**
     C                     Z-ADDODLN      ZFLD15
     C                     Z-ADD0         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDOVFL
     C**
     C** OVERDRAFT EXPIRY DATE
     C**
     C                     Z-ADDODED      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDOVFE
     C**
     C** OVERDRAFT SECURED
     C**
     C                     MOVELODSC      DDOVFS
     C**                                                                  B08193
     C** IF OVERDAFT EXPIRY DATE IS BEFORE RUN DATE OUTPUT BLANK          B08193
     C** OVERDRAFT LINE AND EXPIRY DATE                                   B08193
     C**                                                                  B08193
     C           ODED      IFGT 0                                         B08193
     C           ODED      ANDLTQMRDNB                                    B08193
     C                     MOVE *BLANKS   DDOVFL                          B08193
     C                     MOVE *BLANKS   DDOVFE                          B08193
     C                     MOVE *BLANKS   DDOVFS                          B08193
     C                     END                                            B08193
     C**
     C** FACILITY TYPE, FACILITY NUMBER, ENCASHMENT FACILITY
     C**
     C           FACT      IFNE 0
     C                     MOVELFACT      DDFCTP
     C                     ELSE
     C                     MOVEL*BLANKS   DDFCTP
     C                     END
     C**
     C           FCNO      IFNE 0
     C                     MOVELFCNO      DDFCNR
     C                     ELSE
     C                     MOVEL*BLANKS   DDFCNR
     C                     END
     C**
     C           EFAC      IFNE 0
     C                     MOVELEFAC      DDENCF
     C                     ELSE
     C                     MOVEL*BLANKS   DDENCF
     C                     END
     C**
     C** REFER ALL DEBITS
     C**
     C                     TESTB'0'       RETB           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'Y'       DDRFAD
     C                     ELSE
     C                     MOVEL'N'       DDRFAD
     C                     END
     C**
     C** REFER ALL CREDITS
     C**
     C                     TESTB'1'       RETB           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'Y'       DDRFAC
     C                     ELSE
     C                     MOVEL'N'       DDRFAC
     C                     END
     C**
     C** BLOCK ALL DEBITS
     C**
     C                     TESTB'2'       RETB           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'Y'       DDBKAD
     C                     ELSE
     C                     MOVEL'N'       DDBKAD
     C                     END
     C**
     C** BLOCK ALL CREDITS
     C**
     C                     TESTB'3'       RETB           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'Y'       DDBKAC
     C                     ELSE
     C                     MOVEL'N'       DDBKAC
     C                     END
     C**
     C** INACTIVE
     C**
     C                     TESTB'4'       RETB           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'Y'       DDINAC
     C                     ELSE
     C                     MOVEL'N'       DDINAC
     C                     END
     C**
     C** BANKRUPT/LIQUIDATED
     C**
     C                     TESTB'6'       RETB           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'Y'       DDBKLQ
     C                     ELSE
     C                     MOVEL'N'       DDBKLQ
     C                     END
     C**
     C** BAD DEBT
     C**
     C                     TESTB'7'       RETB           72
     C**
     C           *IN72     IFEQ '1'
     C                     MOVEL'Y'       DDBDDB
     C                     ELSE
     C                     MOVEL'N'       DDBDDB
     C                     END
     C**
     C** PRINT TRANSACTION ADVICE, PRINT RATE CHANGE ADVICE
     C**
     C                     MOVELPTRA      DDPRTA
     C                     MOVELPRCH      DDPRRA
     C**
     C                     ENDSR
     C**
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #W02     - WRITE ACCOUNT DETAILS TO THE SCREEN (2ND SCREEN)      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - TO FORMAT NUMERIC FIELD WITH DECIMAL POINT            *
      * ZDATE2   - TO CONVERT MIDAS DAY NUMBER IN ALPHA DATE             *
      * SDRTVTXT - TO RETRIEVE MESSAGE FROM MESSAGE FILE                 *R10036
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - ACCESS ACCOUNT DETAILS                                *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C           #W02      BEGSR
     C**
     C** BASE RATE TYPE
     C**
     C                     MOVELWWCUCY    BACYCD                          R10036
     C********** DRIB      IFNE 0                                                             CSD103
     C           DRIB      IFNE *BLANKS                                                       CSD103
     C                     MOVE DRIB      DDDBRT
     C                     MOVE DRIB      BABSRC                          R10036
     C**                                                                  R10036
     C** ACCESS LF/SDBSRTL1 (DEBIT)                                       R10036
     C**                                                                  R10036
     C***********KBSRT     CHAINSDBSRTL1             70            R10036 S01486
     C                     CALL 'AOBSRTR0'                                S01486
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*KEY   ' P@OPTN  7                       S01486
     C                     PARM BACYCD    P@CYCD  3                       S01486
     C                     PARM BABSRC    P@BSRC  2                       S01486
     C***********SDBSRT    PARM SDBSRT    DSFDY                    S01486 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C**                                                                  R10036
     C************IN70     IFEQ '1'                        ********R10036 S01486
     C           P@RTCD    IFNE *BLANK                     ***************S01486
     C                     Z-ADD3         QMERRN           **DB ERROR 03**R10036
     C                     MOVEL'Y'       QMDBER           ***************R10036
     C                     MOVEL'PM2040'  QMPGM                           R10036
     C***********          MOVEL'SDBSRTL1'QMFILE                   R10036 S01486
     C                     MOVE 'SDBSRTPD'QMFILE                          S01486
     C                     MOVELBACYCD    DSBSRT  5                       S01486
     C                     MOVE BABSRC    DSBSRT                          S01486
     C                     MOVELDSBSRT    QMKEY                           R10036
     C**                                                                  R10036
     C                     EXSR *PSSR                                     R10036
     C                     ELSE                                           R10036
     C                     MOVE BABSRN    DDDBRL                          R10036
     C**                                                                  R05615
     C** EDIT BASE RATE FOR OUTPUT ON SCREEN                              R05615
     C**                                                                  R05615
     C                     MOVE BACBSR    ZFLD15                          R05615
     C                     Z-ADD7         ZDECS                           R05615
     C                     EXSR ZSEDIT                                    R05615
     C                     MOVE ZOUT21    DDBDRT                          R05615
     C                     END                                            R10036
     C**                                                                  R10036
     C                     ELSE
     C                     MOVEL*BLANKS   DDDBRT
     C                     MOVE *BLANK    DDDBRL                          R10036
     C                     MOVE *BLANKS   DDBDRT                          R05615
     C                     END
     C**
     C********** CRIB      IFNE 0                                                             CSD103
     C           CRIB      IFNE *BLANKS                                                       CSD103
     C                     MOVE CRIB      DDCBRT
     C                     MOVE CRIB      BABSRC                          R10036
     C**                                                                  R10036
     C** ACCESS LF/SDBSRTL1 (CREDIT)                                      R10036
     C**                                                                  R10036
     C***********KBSRT     CHAINSDBSRTL1             70            R10036 S01486
     C                     CALL 'AOBSRTR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C                     PARM BACYCD    P@CYCD  3                       S01486
     C                     PARM BABSRC    P@BSRC  2                       S01486
     C***********SDBSRT    PARM SDBSRT    DSFDY                    S01486 CSD006
     C           SDBSRT    PARM SDBSRT    DSSDY                           CSD006
     C**                                                                  R10036
     C************IN70     IFEQ '1'                        ********R10036 S01486
     C           P@RTCD    IFNE *BLANK                     ***************S01486
     C                     Z-ADD4         QMERRN           **DB ERROR 04**R10036
     C                     MOVEL'Y'       QMDBER           ***************R10036
     C                     MOVEL'PM2040'  QMPGM                           R10036
     C***********          MOVEL'SDBSRTL1'QMFILE                   R10036 S01486
     C                     MOVE 'SDBSRTPD'QMFILE                          S01486
     C                     MOVELBACYCD    DSBSRT  5                       S01486
     C                     MOVE BABSRC    DSBSRT                          S01486
     C                     MOVELDSBSRT    QMKEY                           R10036
     C**                                                                  R10036
     C                     EXSR *PSSR                                     R10036
     C                     ELSE                                           R10036
     C                     MOVE BABSRN    DDCBRL                          R10036
     C**                                                                  R05615
     C** EDIT BASE RATE FOR OUTPUT ON SCREEN                              R05615
     C**                                                                  R05615
     C                     MOVE BACBSR    ZFLD15                          R05615
     C                     Z-ADD7         ZDECS                           R05615
     C                     EXSR ZSEDIT                                    R05615
     C                     MOVE ZOUT21    DDBCRT                          R05615
     C                     END                                            R10036
     C**                                                                  R10036
     C                     ELSE
     C                     MOVEL*BLANKS   DDCBRT
     C                     MOVE *BLANK    DDCBRL                          R10036
     C                     MOVE *BLANKS   DDBCRT                          R05615
     C                     END
     C**
     C** RATE/SPREAD DEBIT
     C**
     C           DRIS      IFNE 0
     C                     Z-ADD0         ZFLD15
     C                     MOVE DRIS      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDDRAT
     C           DRIS      IFLT 0
     C                     MOVE '-'       DDDSPR
     C                     END
     C                     ELSE
     C                     MOVEL*BLANKS   DDDRAT
     C                     MOVEL*BLANK    DDDSPR
     C                     END
     C**
     C**
     C** RATE/SPREAD CREDIT
     C**
     C           CRIS      IFNE 0
     C                     Z-ADD0         ZFLD15
     C                     MOVE CRIS      ZFLD15
     C                     Z-ADD7         ZDECS
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    DDCRAT
     C           CRIS      IFLT 0
     C                     MOVE '-'       DDCSPR
     C                     END
     C                     ELSE
     C                     MOVEL*BLANKS   DDCRAT
     C                     MOVEL*BLANK    DDCSPR
     C                     END
     C**
     C** INTEREST CALCULATION TYPE, SUB-TYPE
     C**
     C           DICT      IFNE 0
     C                     MOVE DICT      DDDCTP
     C                     ELSE
     C                     MOVEL*BLANKS   DDDCTP
     C                     END
     C**
     C           DCST      IFNE 0
     C                     MOVE DCST      DDDCST
     C                     ELSE
     C                     MOVEL*BLANKS   DDDCST
     C                     END
     C**                                                                  R10036
     C           DICT      IFNE 0                                         R10036
     C           DCST      ANDNE0                                         R10036
     C                     MOVE *BLANK    KREIN1                          R10036
     C                     Z-ADDDICT      KREIN2                          R10036
     C                     Z-ADDDCST      KREIN3                          R10036
     C                     MOVE WWCUCY    KREIN4                          R10036
     C                     MOVE 'D'       KREIN5                          R10036
     C**                                                                  R10036
     C** ACCESS LF/REINT (DEBIT)                                          R10036
     C**                                                                  R10036
     C           KREINT    CHAINREINTDF              70                   R10036
     C**                                                                  R10036
     C           *IN70     IFEQ '1'                        ***************R10036
     C                     Z-ADD5         QMERRN           **DB ERROR 05**R10036
     C                     MOVEL'Y'       QMDBER           ***************R10036
     C                     MOVEL'PM2040'  QMPGM                           R10036
     C***********          MOVEL'REINT'   QMFILE                   R10036 S01486
     C                     MOVE 'REINT'   QMFILE                          S01486
     C                     MOVELKREINT    QMKEY                           R10036
     C**                                                                  R10036
     C                     EXSR *PSSR                                     R10036
     C                     ELSE                                           R10036
     C                     MOVE INNM      DDDICL                          R10036
     C                     END                                            R10036
     C**                                                                  R10036
     C                     ELSE                                           R10036
     C                     MOVE *BLANK    DDDICL                          R10036
     C                     END                                            R10036
     C**
     C           CICT      IFNE 0
     C                     MOVE CICT      DDCCTP
     C                     ELSE
     C                     MOVEL*BLANKS   DDCCTP
     C                     END
     C**
     C           CCST      IFNE 0
     C                     MOVE CCST      DDAMAL
     C                     ELSE
     C                     MOVEL*BLANKS   DDAMAL
     C                     END
     C**                                                                  R10036
     C           CICT      IFNE 0                                         R10036
     C           CCST      ANDNE0                                         R10036
     C                     MOVE *BLANK    KREIN1                          R10036
     C                     Z-ADDCICT      KREIN2                          R10036
     C                     Z-ADDCCST      KREIN3                          R10036
     C                     MOVE WWCUCY    KREIN4                          R10036
     C**                   MOVE 'C'       KREIN5                   R10036 B9667
     C                     MOVE 'D'       KREIN5                          B9667
     C**                                                                  R10036
     C** ACCESS LF/REINT (CREDIT)                                         R10036
     C**                                                                  R10036
     C           KREINT    CHAINREINTDF              70                   R10036
     C**                                                                  R10036
     C           *IN70     IFEQ '1'                        ***************R10036
     C                     Z-ADD6         QMERRN           **DB ERROR 06**R10036
     C                     MOVEL'Y'       QMDBER           ***************R10036
     C                     MOVEL'PM2040'  QMPGM                           R10036
     C***********          MOVEL'REINT'   QMFILE                   R10036 S01486
     C                     MOVE 'REINT'   QMFILE                          S01486
     C                     MOVELKREINT    QMKEY                           R10036
     C**                                                                  R10036
     C                     EXSR *PSSR                                     R10036
     C                     ELSE                                           R10036
     C                     MOVE INNM      DDCICL                          R10036
     C                     END                                            R10036
     C**                                                                  R10036
     C                     ELSE                                           R10036
     C                     MOVE *BLANK    DDCICL                          R10036
     C                     END                                            R10036
     C**
     C** PREVIOUS CHANGE VALUE DATE
     C**
     C           LDID      IFNE 0
     C                     Z-ADDLDID      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDDPVD
     C                     ELSE
     C                     MOVEL*BLANKS   DDDPVD
     C                     END
     C**
     C           LCID      IFNE 0
     C                     Z-ADDLCID      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDCPVD
     C                     ELSE
     C                     MOVEL*BLANKS   DDCPVD
     C                     END
     C**
     C** CALCULATION BASIS
     C**
     C                     MOVELDRIC      DDDCAC
     C                     MOVELCRIC      DDCCAC
     C**                                                                  R10036
     C           DRIC      IFEQ 0                                         R10036
     C                     MOVE *BLANK    DDDCAL                          R10036
     C                     ELSE                                           R10036
     C                     MOVEL'PM9004'  MSMBR4                          R10036
     C                     Z-ADD1         WWMSM   10                      R10036
     C                     ADD  DRIC      WWMSM
     C                     MOVE WWMSM     MSMBR4                          R10036
     C                     CALL 'SDRTVTXT'PLLANG                          R10036
     C                     MOVELMSGTXT    DDDCAL                          R10036
     C                     END                                            R10036
     C**                                                                  R10036
     C           CRIC      IFEQ 0                                         R10036
     C                     MOVE *BLANK    DDCCAL                          R10036
     C                     ELSE                                           R10036
     C                     MOVEL'PM9004'  MSMBR4                          R10036
     C                     Z-ADD1         WWMSM                           R10036
     C                     ADD  CRIC      WWMSM                           R10036
     C                     MOVE WWMSM     MSMBR4                          R10036
     C                     CALL 'SDRTVTXT'PLLANG                          R10036
     C                     MOVELMSGTXT    DDCCAL                          R10036
     C                     END                                            R10036
     C**
     C** NEXT CAPITALISATION DATE AND FREQUENCY
     C**
     C           NDID      IFNE 0
     C                     Z-ADDNDID      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDDCDT
     C                     ELSE
     C                     MOVEL*BLANKS   DDDCDT
     C                     END
     C**
     C                     MOVELDRIF      DDDCFQ
     C**
     C           NCID      IFNE 0
     C                     Z-ADDNCID      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVELZADATE    DDCCDT
     C                     ELSE
     C                     MOVEL*BLANKS   DDCCDT
     C                     END
     C**
     C                     MOVELCRIF      DDCCFQ
     C**
     C** ALTERNATIVE ACCOUNT
     C**
     C                     MOVELDACP      DDDACC
     C                     MOVELCACP      DDCACC
     C**
     C** CHARGES CALCULATION TYPE & SUB-TYPE
     C**
     C           CHGT      IFNE 0
     C                     MOVE CHGT      DDCALT
     C                     ELSE
     C                     MOVEL*BLANKS   DDCALT
     C                     END
     C**
     C           CHST      IFNE 0
     C                     MOVE CHST      DDCALS
     C                     ELSE
     C                     MOVEL*BLANKS   DDCALS
     C                     END
     C**                                                                  R10036
     C           CHGT      IFNE 0                                         R10036
     C           CHST      ANDNE0                                         R10036
     C**                                                                  R10036
     C** USE KREINT TO ACCESS LF/RECRG                                    R10036
     C**                                                                  R10036
     C                     MOVE *BLANK    KREIN1                          R10036
     C                     Z-ADDCHGT      KREIN2                          R10036
     C                     Z-ADDCHST      KREIN3                          R10036
     C                     MOVE WWCUCY    KREIN4                          R10036
     C****                 MOVE *BLANK    KREIN5                          B08257
     C                     MOVE 'D'       KREIN5                          B02857
     C**                                                                  R10036
     C** ACCESS LF/RECRG                                                  R10036
     C**                                                                  R10036
     C           KREINT    CHAINRECRGDF              70                   R10036
     C**                                                                  R10036
     C           *IN70     IFEQ '1'                        ***************R10036
     C                     Z-ADD7         QMERRN           **DB ERROR 07**R10036
     C                     MOVEL'Y'       QMDBER           ***************R10036
     C                     MOVEL'PM2040'  QMPGM                           R10036
     C***********          MOVEL'RECRG'   QMFILE                   R10036 S01486
     C                     MOVE 'RECRG'   QMFILE                          S01486
     C                     MOVELKREINT    QMKEY                           R10036
     C**                                                                  R10036
     C                     EXSR *PSSR                                     R10036
     C                     ELSE                                           R10036
     C                     MOVE CHNM      DDCALL                          R10036
     C                     END                                            R10036
     C**                                                                  R10036
     C                     ELSE                                           R10036
     C                     MOVE *BLANK    DDCALL                          R10036
     C                     END                                            R10036
     C**
     C** ALTERNATIVE ACCOUNT TO POST CHARGES
     C**
     C                     MOVELCHAC      DDALTC
     C**
     C                     ENDSR
      ********************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      /COPY ZSRSRC,ZSEDITZ3
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - TO PROCESS DATA BASE ERRORS                           *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      **PMC1000**-*TO*UPDATE*DATA*AREA**GDA*******************************S01486
      **PMC1020**-*TO*TRANSFER*AND*END*GROUP*JOBS*************************S01486
      * PMC1001  - to update data area *LDA                              *S01486
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - ACCESS ACCOUNT DETAILS                                *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      **WWPARM***-*PARAMETER*RECEIVED*BY*THIS*PROGRAM*(*GDA)**************S01486
      **WWEND****-*PARAMETER*FOR*PMC1020**********************************S01486
      **WWGRPJ***-*PARAMETER*FOR*PMC1020**********************************S01486
      *                                                                  *
      ********************************************************************
     C           *PSSR     BEGSR
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVEL'Y'       QMDBER
     C                     MOVEL'PM2040'  QMPGM
     C                     MOVEL'Y'       QMENQT
     C**
     C***UPDATE**GDA***************************************************   S01486
     C***********                                                         S01486
     C***********          CALL 'PMC1002'                                 S01486
     C***********          PARM           WWGDA                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C**
     C                     DUMP
     C**
     C***********          CALL 'PMC1020'                                 S01486
     C**
     C                     ENDSR
     C**
     C***ATN*-*ARRAY*TO*ENABLE*ATTN*KEY********************************   S01486
     C***********SETATNPGM PGM(PMC0610)                                   S01486
     C*                                                                   S01486
**  CPY@
(c) Finastra International Limited 2001
**  ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**  ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**  ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
