     H        1                                                           S01486
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Loan activity enquiry')                       *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management Module                          *
     F*                                                               *
     F*  PM2081 - Loan Activity Enquiry                               *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD053295           Date 13Apr19               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CLE154             Date 07Aug12               *
      *                 CLE141             Date 08Feb16               *
      *                 260891             Date 17Dec12               *
      *                 AR996895           Date 25Nov12               *
      *                 CLE134             Date 01Aug12               *
      *                 CLE148             Date 23Jul12               *
      *                 263666             Date 01Feb10               *
      *                 CER059             Date 19Jul10               *
      *                 CER016A            Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246141             Date 26Mar07               *
      *                 164847             Date 30Nov06               *
      *                 BUG12990           Date 05Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 242286             Date 25Sep06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE042             Date 06Sep05               *
      *                 CSW037A            Date 02May05               *
      *                 CIR013             Date 25Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 188614             Date 14Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CLE011             Date 07Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 CIR004             Date 20Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 126017             Date 14Nov97               *
      *                 121768             Date 20Feb98               *
     F*                 097885             DATE 03FEB97               *
     F*                 CPM004             DATE 03MAR96               *
     F*                 095244             DATE 01NOV95               *
     F*                 095238             DATE 31OCT95               *
     F*                 085817             DATE 13MAR95               *
     F*                 S01486             DATE 11AUG94               *
     F*                 057266             DATE 15DEC93               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD053295 - Lending loan with Interest Calculation Basis      *
      *             method 3 (30/360) has wrong interest payment      *
      *             amount for month of March (Recompile)             *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE154 - Loan Repayment Schedule Enhancement                 *
      *  CLE141 - Currency and Location Business Day Convention       *
      *           (Recompile)                                         *
      *  260891 - Wrong projection in LOAC. Add LCD as a key.         *
      *           Recompiled due to changes in LF/HISTR.              *
      *  AR996895 - Incorrect accrual interest calculation.           *
      *             (Child:AR996897) (Recompile)                      *
      *  CLE134 - Past Due Call Loan Processing (Recompile)           *
      *  CLE148 - Alpha Loan Reference                                *
      *  263666 - Recompiled due to changes in ZINTDYZ2               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER016A - German Interest Calculation: Upgarde of FGE059     *
      *           to Midas Plus (Recompile)                           *
      *  246141 - Recompiled due to changes in ZINTDYZ2               *
      *  164847 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  BUG12990 - Recompiled due to changes in ZINTDYZ2/ZINTDYZ2LE  *
      *  242286 - Recompile over changes in /COPY ZINTDYZ2.           *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE042 - Extended Loan Sub Type                              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CIR013 - Additional Calculation Method for FRA/IRS/CCF       *
      *           Recompile over GLINTC and ZINTDY.                   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  188614 - Outstanding amount displayed is modified when a     *
      *           rolldown action is requested.                       *
      *  CLE011 - Rate Fixing Days for Lending Rollover Processing    *
      *  CIR004 - Dealing Calculation Method Change                   *
      *         - Recompiled due to GLINTC and ZINTDY changes         *
     F*  126017 - Correction to interest calculation for calculation  *
     F*           basis 6 in SR/GLINTC. Add SR/ZDAT10                 *
     F*  121768 - Recompile over changed GLINTCZ1                     *
     F*  097885 - Recompiled for wrong calculation of number of day   *
     F*           interest (ZINTDYZ2).                                *
     F*  CPM004 - Bank Portfolios (RECOMPILED)                        *
     F*  095244 - Recompiled for Calculation method 3                 *
     F*  095238 - Recompiled for Calculation method 3                 *
     F*  085817 - Recompile due to changes in PMLDAPD                 *
     F*  S01486 - Portfolio Management Upgrade to Release 10          *
     F*  057266 - PROGRAM CREATED FOR FIX 57266                       *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F***PM2081DDCF**F     214            WORKSTN      KPASS  *NOIND      S01486
     FPM2081DFCF  F     230            WORKSTN      KPASS  *NOIND         S01486
     F                                              KSLN   V
     F***TABLEIC*IF  F      96 12AI     2 DISK                            S01486
     FHISTR   IF  E           K        DISK
     F***LOAMS** IF  F     320 14AI     2 DISK                                                CGL029
     F*LOAMS***IF**F****1230 14AI     2 DISK                                           CGL029 CLE042
     FLOAMS   IF  F    1291 14AI     2 DISK                                                   CLE042
     F***CLINT***IF  F     256  7AI     2 DISK                            S01486
     F*CLOAN***IF**F     400  7AI     2 DISK                              CLE011
     F***CLOAN** IF  F    1310  7AI     2 DISK                                         CLE011 CGL029
     F*CLOAN***IF**F****1632  7AI     2 DISK                                           CGL029 CLE042
     FCLOAN   IF  F    1773  7AI     2 DISK                                                   CLE042
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F* 01            WORKSTATION - SF SCREEN
     F* 02                        - CATCHALL
     F* 03            USED TO CONDITON FIRST TIME PASS THROUGH CYCLE *  *
     F* 04            SET ON IF ERROR DURING READ FROM WORKSTATION   *  *
     F* 05            WORKSTATION - SG SCREEN
     F*       08      NEXT SCREEN (ROLLUP)
     F*       09      FIRST SCREEN (ROLLDOWN)
     F**10************TABLEIC,CLINT,CLOAN,HISTS,LOAMS*LIVE*DETAIL******   S01486
     F* 10            CLOAN,HISTR,LOAMS LIVE DETAIL                       S01486
     F* 11            CLOAN - REVERSED
     F*    20         DATE BLANK
     F*    21         CODE BLANK
     F*    22         REPAYMENT DAYNO ZERO
     F*    23         INTEREST DAYNO ZERO
     F*    24         CURRENT PRINCIPAL NEGATIVE
     F*       25      PREMIUM LOAN
     F*       26      DISCOUNTED LOAN
     F*       27      USED IN INTEREST CALCS.
     F*       28      USED IN INTEREST CALCS.
     F*       29      REVERSE IMAGE LOAN REFERENCE
     F*       30      FIRST SCREEN FOR LOAN
     F*       31      COMPLETE DISPLAYED
     F*       32      LOAMS RECORD EARLIER
     F*       33      HISTS RECORD EARLIER/SAME
     F*       34      NO MORE LOAMS DETAILS
     F*       35,36   MULTIPLE USE
     F*       37      NO MORE HISTS DETAILS
     F*       38      CHAIN FAIL
     F*       39      RELEASE WORKSTATION
     F*       20      DISPLAY INITIAL/ERROR SCREEN
     F*       41      LOAN INVALID
     F*       42      DATE INVALID
     F*       43      CODE INVALID
     F*       44      ERROR MESSAGE NON-DISPLAY
     F*       45      ERROR MESSAGE REVERSE IMAGE
     F*       46      DATE/CODE COMBINATION INVALID
     F*       47-49   USED IN CHECKL/CHECKH SRS TO DETERMINE WHETHER
     F*               ANY MORE LINES WILL BE OUTPUT FOR THIS RECORD
     F*               IF SCREEN FULL WHILE PROCESSING IT.
     F*       50      CODE H
     F*       51      CODE P
     F*       52      CODE F
     F*       53      CODE B
     F*       54,55   MULTIPLE USE
     F*       56      INTEREST IS CAPITALISED
     F*       60      SCREEN FULL
     F*       61-64   CURRENCY DPS 0-3
     F*       65      SPREAD/RATE OUTPUT EDIT
     F*       66      SUPPRESS AMOUNT OUTPUT FOR STOP/START ACCRUALS
     F*       70      EXCEPTION - DETAIL LINE
     F*       71      EXCEPTION - HEADINGS ETC.
     F*       80-84   USED TO CONTROL RETURN IF SCREEN FULL IN
     F*               MIDDLE OF PROCESSING LOAM OR HIST RECORD.
     F*       90-99   STANDARD SUBROUTINES
     F*       KC      END OF JOB
     F*          U7,U8 - DATABASE ERROR
     E**  Array for copyright                                             S01486
     E                    CPY@    1   1 80                                S01486
     E**  Arrays for ZDATE1 and ZDATE2                                    S01486
     E/COPY ZSRSRC,ZDATE2Z1                                               S01486
     E***********         ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAYS01486
     E***********         ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAYS01486
     E***********         ZMNM   12  12  3               ZDATE2 SR. ARRAY S01486
     E***********         MSG     1  10 43               MESSAGES         S01486
     E                    MSG     1  12 43               MESSAGES         S01486
     E                    NARR    1  38 30               NARRATIVES
      /COPY ZSRSRC,ZDATE9Z1                                               S01486
     I**
     I**   WORKSTATION FILE
     I**
     I*  'SF' SCREEN - NO ROLLUP/ROLLDOWN
     I***PM2081DDNS  01   1 CS   2 CF                                     S01486
     I*PM2081DFNS  01   1 CS   2 CF                                       S01486
     IPM2081DFNS  01   1 CS   2 CF                                        S01486
     I                                        1   2 SCID
     I                                        3   8 LNIN
     I                                        9  14 DTIN            20
     I                                       15  15 CDIN
     I*  'SG' SCREEN - WITH ROLLUP/ROLLDOWN
     I        NS  05   3 CS   4 CG
     I                                        1   1 *IN08
     I                                        2   2 *IN09
     I                                        3   4 SCID
     I                                        5  10 LNIN
     I                                       11  16 DTIN            20
     I                                       17  17 CDIN
     I*
     I*    CATCH ALL
     I*
     I        NS  02
     I*
     I*****TABLEIC*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.**********   S01486
     I***********                                                         S01486
     I***TABLEIC*NS       2 C0   3 C1  12 C1                              S01486
     I*******AND*     13 C0                                               S01486
     I***********                             1   1 RECI                  S01486
     I***********                            12  130RCDE                  S01486
     I***********                            14  66 TITL                  S01486
     I***********                            67  67 DATF                  S01486
     I***********                            68  700DFBR                  S01486
     I***********                            74  74 MODI1                 S01486
     I***********                            75  75 MODI2                 S01486
     I***********                            76  76 MODI3                 S01486
     I***********                         P  77  790RUND                  S01486
     I***********                            80  86 RUNA                  S01486
     I***********                            87  870SFLG                  S01486
     I***********                         P  90  920LCD                   S01486
     I***********                            93  93 CHTP                  S01486
     I***********                         P  94  960TNLU                  S01486
     I***********                                                         S01486
     I*****TABLEIC*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*2.**********   S01486
     I***********                                                         S01486
     I********NS*      1 CD   2 C0   3 C1                                 S01486
     I*******AND*     12 C1  13 C1                                        S01486
     I***********                             1   1 RECI                  S01486
     I***********                             2   30RECT                  S01486
     I***********                            12  130RCDE                  S01486
     I***********                            14  16 BCCY                  S01486
     I***********                            17  19 BCYL                  S01486
     I***********                            20  22 HOCY                  S01486
     I***********                            23  280HEAD                  S01486
     I***********                         P  29  310APDA                  S01486
     I***********                            35  35 APFQ                  S01486
     I***********                         P  36  380LOGS                  S01486
     I***********                            39  40 CUZR                  S01486
     I***********                         P  41  430DNWD                  S01486
     I***********                            44  460BVLP                  S01486
     I***********                            47  49 LOCY                  S01486
     I***********                            50  510FDAY                  S01486
     I***********                            52  52 ACLD                  S01486
     I***********                            53  53 MBIN                  S01486
     I***********                            86  86 ISAV                  S01486
     I***********                         P  87  890LLOG                  S01486
     I***********                         P  90  920LCD                   S01486
     I***********                            93  93 CHTP                  S01486
     I***********                         P  94  960TNLU                  S01486
     I***********                                                         S01486
     I*****TABLEIC*FILE*-*CURRENCIES*RECORD*1.*************************   S01486
     I***********                                                         S01486
     I***TABLEIC*NS  10   1 CD   2 C2   3 C0                              S01486
     I*******AND*     13 C1                                               S01486
     I***********                             1   1 RECI                  S01486
     I***********                            13  130SREC                  S01486
     I***********                            14  27 CCNM                  S01486
     I***********                         P  28  348SPOT                  S01486
     I***********                            35  37 CCYS                  S01486
     I***********                            38  380CDP                   S01486
     I***********                            39  390TNOT                  S01486
     I***********                            40  40 DCCY                  S01486
     I***********                            41  44 SRC1                  S01486
     I***********                            45  48 SRC2                  S01486
     I***********                            49  520TACC                  S01486
     I***********                            53  560TEQV                  S01486
     I***********                            57  600SWQV                  S01486
     I***********                            61  640TAC4                  S01486
     I***********                            65  680TAC5                  S01486
     I***********                            69  69 HIND                  S01486
     I***********                         P  70  768PART                  S01486
     I***********                            77  780SSNO                  S01486
     I***********                         P  79  858ERLC                  S01486
     I***********                         P  90  920LCD                   S01486
     I***********                            93  93 CHTP                  S01486
     I***********                         P  94  960TNLU                  S01486
     I********NS*                                                         S01486
     I*
     I*    CUSTOMER LENDING LOANS FILE - DETAIL RECORD 1
     I*
     ICLOAN   NS  10   1 CD   8 CA
     I       OR   10   1 CM   8 CA
     I       OR   11   1 CR   8 CA
     I                                        1   1 RECI
     I**********                              2   70LNRF                                      CLE148
     I**********                              2   70LNRFD                                     CLE148
     I                                        2   7 LNRF                                      CLE148
     I                                        2   7 LNRFD                                     CLE148
     I                                        8   8 RCDT
     I                                        9   90MRIN
     I                                       10  110PTYP
     I*    FIELD NAME CHANGED FOR PROGRAM
     I**********                             12  170CNUML                                     CSD027
     I                                       12  17 CNUML                                     CSD027
     I***********                            18  200BRCD                  S01486
     I                                       18  20 BRCA                  S01486
     I                                       21  22 LTYP
     I                                       23  24 SUTP
     I                                    P  25  270DDAT
     I                                    P  28  300VDAT
     I                                    P  31  330MDAT
     I                                       34  350LASQ
     I**********                             36  410FCUS                                      CSD027
     I                                       36  41 FCUS                                      CSD027
     I                                       42  440FTYP
     I                                       45  460FSEQ
     I                                       47  49 CCYL
     I                                    P  50  560CPAM          24
     I                                       57  57 INTC
     I                                    P  58  637INTR
     I**********                             64  650BRTT                                      CSD103
     I                                       64  65 BRTT                                      CSD103
     I                                    P  66  717BRTE
     I                                    P  72  777RTSP
     I                                    P  78  815MARG
     I                                       82  82 SPIN
     I                                       83  83 CHIN
     I                                    P  84  897WTRT
     I                                       90  90 WTIN
     I                                       91  910REPT
     I                                    P  92  980RAMT
     I                                    P  99 1010NRPD
     I                                      102 102 RFRQ
     I                                      103 1040RDYN            22
     I                                      105 107 FCCY
     I                                      108 1100LIND
     I                                      111 112 CRSK
     I                                      113 114 ACOF
     I                                      115 115 NACD
     I                                      116 116 RELI
     I                                      117 117 AUTO
     I                                    P 118 1240PSAM
     I                                    P 125 1318BCXR
     I                                    P 132 1388FCXR
     I                                      139 1400SDST
     I**********                            141 152 OSDA                                      CGL029
     I                                      141 152 OSDAQQ                                    CGL029
     I                                      153 162 TSTN
     I                                      163 1640MDST
     I**********                            165 176 OMDA                                      CGL029
     I                                      165 176 OMDAQQ                                    CGL029
     I                                      177 186 TMAN
     I                                      187 196 FACO
     I                                    P 197 1990RLDT
     I                                    P 200 2020NROD
     I                                      203 203 RLFQ
     I                                      204 2050RLDY
     I**********                            207 2080NBRA                                      CSD103
     I                                      207 208 NBRA                                      CSD103
     I                                    P 209 2147NRTS
     I                                      215 215 NSIN
     I                                      216 2160NCAC
     I                                    P 217 2230AWTP
     I                                    P 224 2300WTRD
     I                                    P 231 2370WTWD
     I                                    P 238 2440IWOD
     I                                    P 245 2510PWOD
     I                                      252 252 BMDI
     I                                      253 253 FMDI
     I                                    P 254 2600PDIN
     I                                      287 287 BTIN
     I                                      288 2890BLDY
     I**********                            290 2950OLNO                                      CSD027
     I                                      290 295 OLNO                                      CSD027
     I                                      296 296 RCSI
     I                                      297 2970ICBS
     I                                      298 298 IPFR
     I                                    P 299 3050TOTI
     I                                    P 306 3080NIDT
     I                                    P 309 3110IBDT
     I                                    P 312 3140SLID
     I                                    P 315 3210AIPD
     I                                    P 322 3240DLRC
     I                                    P 325 3270IACD
     I                                    P 328 3340AITC
     I                                    P 335 3410TFEP
     I                                    P 342 3480AIAP
     I                                    P 349 3550IPRD
     I                                    P 356 3620IPRM
     I                                    P 363 3690ICTD
     I                                    P 370 3760AIMN
     I                                    P 377 3790RBDT
     I                                      384 3850IFDY            23
     I                                      386 386 LONI
     I                                      387 387 CNFI
     I                                      388 388 ACEI
     I                                      389 389 TLXI
     I                                      390 390 CBLI
     I                                    P 391 3930ORED
     I                                    P 394 3960LCD
     I                                      397 397 CHTP
     I                                    P 398 4000TNLU
     I                                     13901407 OSDA                                      CGL029
     I                                     14081425 OMDA                                      CGL029
     I                                     17621765 CLAS                                      CLE042
     I        NS
     I*
     I*****CLIENT*FILE*-*CUSTOMER*STANDING*DATA*RECORD.****************   S01486
     I***********                                                         S01486
     I***CLINT***NS  10   1 CD   8 CA                                     S01486
     I*******OR**      1 CC   8 CA                                        S01486
     I***********                             1   1 RECI                  S01486
     I***********                             2   70CNUM                  S01486
     I***********                             9  28 CRNM                  S01486
     I***********                            29  38 CTWN                  S01486
     I***********                            39  48 CSNM                  S01486
     I***********                            49  56 CASK                  S01486
     I***********                            57  68 TELX                  S01486
     I***********                            69  80 CSID                  S01486
     I***********                            81  82 ACOC                  S01486
     I***********                            83  83 CBSI                  S01486
     I***********                            84  85 CCTZ                  S01486
     I***********                            86  87 CLOC                  S01486
     I***********                            88  930CPAR                  S01486
     I*****FIELD*NAME*CHANGED*FOR*PROGRAM******************************   S01486
     I***********                            94  960BRCDC                 S01486
     I***********                            97  980LINS                  S01486
     I***********                            99 1010LIND                  S01486
     I***********                         P 102 1040DASU                  S01486
     I***********                         P 105 1070CDIC                  S01486
     I***********                         P 108 1100DADE                  S01486
     I***********                           111 111 CMIN                  S01486
     I***********                           112 112 CTYP                  S01486
     I***********                           113 124 TELF                  S01486
     I***********                           125 133 CHID                  S01486
     I****CLINT*FILE*-*CATCHALL****************************************   S01486
     I***********                                                         S01486
     I********NS*                                                         S01486
     I*
     I**  HISTORY FILE - LOAN HEADER
     I*   SEVERAL FIELD NAMES SUFFIXED WITH 'H' FOR THE PROGRAM
     I*
     IHISTSHMF    10
     I***********   BRCD                            BRCDH                 S01486
     I              BRCA                            BRCDH                 S01486
     I              LNRF                            LNRFH
     I              VDAT                            VDATH
     I              AMTP                            AMTPH
     I              PRAM                            PRAMH
     I              BRTE                            BRTEH
     I              RTSP                            RTSPH
     I              SPIN                            SPINH
     I              REPT                            REPTH
     I              INTC                            INTCH
     I              CPAM                            CPAMM                 188614
     I*
     I**  HISTORY FILE - AMOUNT DETAIL
     I*
     IHISTSHPF    10
     I***********   BRCD                            BRCDH                 S01486
     I              BRCA                            BRCDH                 S01486
     I              LNRF                            LNRFH
     I              VDAT                            VDATH
     I              AMTP                            AMTPH
     I              PRAM                            PRAMH
     I              INTA                            INTAH
     I              WTXA                            WTXAH
     I              FEAM                            FEAMH
     I              WOIN                            WOINH
     I              CPAM                            CPAMP                 188614
     I*
     I**   HISTORY FILE - DETAIL RATES
     I*
     IHISTSHQF    10
     I***********   BRCD                            BRCDH                 S01486
     I              BRCA                            BRCDH                 S01486
     I              LNRF                            LNRFH
     I              VDAT                            VDATH
     I              AMTP                            AMTPH
     I              BRTE                            BRTEH
     I              RTSP                            RTSPH
     I              SPIN                            SPINH
     I              STAI                            STAIH
     I              CPAM                            CPAMQ                 188614
     I*
     I*    CUSTOMER LENDING LOAN AMENDMENTS FILE - DETAIL
     I*    SEVERAL FIELD NAMES SUFFIXED WITH 'L' FOR PROGRAM
     I*
     ILOAMS   NS  10   1 CD
     I                                        1   1 RECI
     I**********                              2   70LNRFL                                     CLE148
     I                                        2   7 LNRFL                                     CLE148
     I                                        8  120VDATL
     I                                       13  150LASN
     I                                       16  160MRIN
     I                                       17  18 LTYP
     I                                       19  20 SUTP
     I                                       21  220PTYP
     I                                       23  24 AMTPL
     I                                       25  260PRSQ
     I**********                             27  280BRTT                                      CSD103
     I                                       27  28 BRTT                                      CSD103
     I                                    P  29  347RTSPL
     I                                       35  37 CCY
     I                                    P  38  440PRAML
     I                                    P  45  510INTAL
     I                                    P  52  580WTXAL
     I                                    P  59  650FEAML
     I                                    P  66  720TAMTL
     I***************************************73  750BRCDL                 S01486
     I                                       73  75 BRCDL                 S01486
     I**********                             76  810CNUM                                      CSD027
     I                                       76  81 CNUM                                      CSD027
     I                                       82  820REPTL
     I                                       83  83 AUTO
     I                                       84  84 STAIL
     I                                       85  860SETPL
     I**********                             87  98 OSAC                                      CGL029
     I                                       87  98 OSACQQ                                    CGL029
     I                                       99 108 TSEN
     I                                      109 118 FACO
     I                                      119 148 SPI1
     I                                      149 178 SPI2
     I                                      179 208 SPI3
     I                                      209 209 LAIN
     I                                    P 210 2157BRTEL
     I                                      216 216 SPINL
     I                                      217 2170CALC
     I                                      218 218 WTIN
     I                                      219 219 LLAG
     I                                      220 220 LWOI
     I                                      221 2250XAVD
     I                                      226 2280XASQ
     I**********                            229 2340FCUS                                      CSD027
     I                                      229 234 FCUS                                      CSD027
     I                                      235 2370FTYP
     I                                      238 2390FSEQ
     I                                      240 2450RLON
     I                                      246 2470FECD
     I                                      248 248 PDNI
     I                                      249 249 ACTI
     I                                      250 250 CNFY
     I                                      251 251 TLXY
     I                                      252 252 CBLY
     I                                      253 253 INTCL
     I                                    P 311 3130ORED
     I                                    P 314 3160LCD
     I                                      317 317 CHTP
     I                                    P 318 3200TNLU
     I                                     10761093 OSAC                                      CGL029
     I                                     12801283 CLAS                                      CLE042
     I        NS
     I**
     I**   DATA STRUCTURES - KEY TO LOAMS
     I**
     I            DS
     I                                        1  14 LOKEY
     I**********                              1   60LNRF                                      CLE148
     I                                        1   6 LNRF                                      CLE148
     I                                        7  110DATE
     I                                       12  140SEQU
     I**
     I*****KEY*FOR*CURRENCY*DPS****************************************   S01486
     I***********                                                         S01486
     I*********** DS                                                      S01486
     I***********                             1  12 CCYKEY                S01486
     I***********                             9  11 CCYL                  S01486
     I*****LOCAL*DATA*AREA*FOR*DATABASE*ERROR*IDENTIFICATION***********   S01486
     I*****AND*FILE*SIZE*INPUT*****************************************   S01486
     I***LDA********UDS                            256                    S01486
     I***********                           134 138 DBFILE                S01486
     I***********                           139 167 DBKEY                 S01486
     I***********                           168 175 DBPGM                 S01486
     I***********                           176 1770DBASE                 S01486
     I***********                           251 2560ZFSIZE                S01486
      /COPY ZSRSRC,ZINTDYZ1                                               S01486
      /COPY ZSRSRC,ZDATE9Z2                                               S01486
     I/COPY ZSRSRC,ZDAT10Z1                                               126017
     IWWLDA     E DSPMLDAPD                                               S01486
     IPSDS       SDS
     I***********                           244 246 WSID                  S01486
     I                                      244 253 WSID                  S01486
     I                                      254 263 USID                  S01486
     I*                                                                   S01486
     IRUNDAT    E DS                                                      S01486
     I**  Standard Data Area Layout for System flags and Run Date         S01486
     I*                                                                   S01486
     ISDBANK    E DSSDBANKPD                                              S01486
     I**  Data structure for Bank details                                 S01486
     I*                                                                   S01486
     ISDCUST    E DSSDCUSTPD                                              S01486
     I**  Data structure for Customer details                             S01486
     I*                                                                   S01486
     ISDGELR    E DSSDGELRPD                                              S01486
     I**  Data structure for General Ledger details                       S01486
     I*                                                                   S01486
     ISDCURR    E DSSDCURRPD                                              S01486
     I**  Data structure for Currency details                             S01486
     I*                                                                   S01486
     IDSFDY     E DSDSFDY                                                 S01486
     I**  Short data structure for access objects                         S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I**  Long data structure for access programs                         S01486
      /EJECT                                                              S01486
     C           *ENTRY    PLIST
     C                     PARM           WWLNRF  6
     C                     MOVE WWLNRF    LNIN
     C                     MOVE '      '  DTIN
     C                     MOVE *BLANKS   CDIN
     C***03******          READ PM2081DD                 04               S01486
     C   03                READ PM2081DF                 04               S01486
     C  N03                SETON                     0302
     C                     SETOF                     04
     C   02                EXSR FIRST
     C                     TIME           MTIME   60
     C**
     C**   COMMAND KEY TESTS
     C**
     C                     SETOF                     444560
     C   KC                SETON                     39
     C   KC                GOTO END
     C**
     C**   KEY FOR HISTORY FILE
     C**
     C           KEY       KLIST
     C***********          KFLD           BRCD                            S01486
     C                     KFLD           BRCA                            S01486
     C                     KFLD           CNUML
     C                     KFLD           LNRFD
     C                     KFLD           VDATH
     C                     KFLD           PRSQ
     C                     KFLD           LCD                                                 260891
     C                     KFLD           LASN
     C**
     C**   INVALID COMMAND KEYS
     C**
     C   08 31
     COR 09 30             EXSR INVCOM
     C   08 31
     COR 09 30             GOTO END
     C**
     C**   ROLLUP - NEXT SCREEN REQUESTED
     C**
     C   08                SETON                     71
     C   08                EXCPT
     C   08                SETOF                     71
     C   08                MOVE BLANKS    ERMSG
     C**
     C   08 21             EXSR SRLOHS
     C   08 50             EXSR SRHIST
     C   08N50N21          EXSR SRLOMS
     C**
     C   08 37 50
     COR 08N21N50
     CAN 34
     COR 08 21 37
     CAN 34                SETON                     31    COMPLETE
     C   08 31             MOVE MSG,6     ERMSG
     C**
     C   08                SETOF                     3040
     C   08N31             MOVE MSG,7     CMSG   41
     C   08 31             MOVE MSG,9     CMSG
     C**
     C**   ROLLDOWN - FIRST SCREEN REQUESTED
     C**
     C   09                Z-ADDFDATE     CDATE
     C   09                SETON                     7130
     C   09                EXCPT
     C   09                SETOF                     713437
     C   09                SETOF                     808182
     C   09                SETOF                     83
     C**
     C   09 21             EXSR SRLOHS
     C   09 50             EXSR SRHIST
     C   09N50N21          EXSR SRLOMS
     C**
     C   09                SETOF                     3140
     C   09                MOVE MSG,8     CMSG
     C   09                MOVE BLANKS    ERMSG
     C**
     C   09
     COR 08                GOTO END
     C**
     C**   NEW ENQUIRY
     C**
     C                     EXSR VALDTE
     C           END       TAG                             ** END TAG ****
     C   39                SETON                     LR
     C***U7******          MOVE 'PM2081'  DBPGM                           S01486
     C********************************************************************
     C*                                                                  *
     C*    VALIDATE SR. TO VALIDATE SCREEN INPUT                         *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - MAIN PROCESSING
     C*            ROUTINE CALLS - ZDATE1,ZDATE2 (3),SRLOHS,SRLOMS,SRHIST
     C*                            GLINTC
     C           VALDTE    BEGSR                           ** VALDTE BEGSR
     C**
     C                     SETON                     30
     C                     SETOF                     414243
     C                     SETOF                     463134
     C                     SETOF                     378081
     C                     SETOF                     828329
     C                     MOVE BLANKS    CMSG
     C                     MOVE BLANKS    ERMSG
     C                     MOVE MSG,10    ERMSG
     C**
     C**   LOAN REF. - MUST BE ON CLOAN FILE
     C**
     C                     MOVELLNIN      CLOKEY
     C                     SETOF                     381011
     C           CLOKEY    CHAINCLOAN                38
     C  N10N11             MOVELMSG,1     ERMSG  43
     C  N10N11             SETON                     41
     C  N10N11             GOTO ERTAG
     C   11                SETON                     29
     C**
     C**   DATE - IF ENTERED MUST BE VALID
     C**
     C   20                MOVE 'START  ' ACTDY   7
     C   20                GOTO CODEVL
     C**
     C                     MOVE DTIN      WK60    60
     C                     MOVE WK60      WK6     6
     C           WK6       COMP DTIN                 4242
     C   42                GOTO ERTAG
     C**
     C                     MOVE DTIN      ZDATE
     C                     EXSR ZDATE1
     C   99                MOVELMSG,2     ERMSG
     C   99                SETON                     42
     C   99                GOTO ERTAG
     C**
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    ACTDY
     C**
     C**   CODE - IF ENTERED MUST BE H,B,F,P
     C**
     C           CODEVL    TAG                             ** CODEVL TAG *
     C           CDIN      COMP ' '                      21
     C           CDIN      COMP 'H'                      50
     C           CDIN      COMP 'P'                      51
     C           CDIN      COMP 'F'                      52
     C           CDIN      COMP 'B'                      53
     C  N50N51N52
     CANN53N21             SETON                     43
     C   43                MOVELMSG,3     ERMSG
     C   43                GOTO ERTAG
     C**
     C**   VALIDATE DATE/CODE COMBINATION
     C**
     C   21
     COR 20                GOTO ENDVL
     C   50
     COR 51
     C*OR*53***** ZDAYNO    COMP RUND                 46  46              S01486
     C***52******ZDAYNO    COMP RUND                   46                 S01486
     COR 53      ZDAYNO    COMP BJRDNB               46  46               S01486
     C   52      ZDAYNO    COMP BJRDNB                 46                 S01486
     C   46                SETON                     4243
     C   46                MOVELMSG,4     ERMSG
     C   46                GOTO ERTAG
     C           ENDVL     TAG                             ** ENDVL TAG **
     C**
     C                     Z-ADD0         CDATE   50
     C                     Z-ADD0         FDATE   50
     C   20 52             Z-ADDBJRDNB    CDATE                           S01486
     C***20*528**          Z-ADDRUND      FDATE                           S01486
     C   20 52             Z-ADDBJRDNB    FDATE                           S01486
     C***20*52***          MOVE RUNA      ACTDY                           S01486
     C   20 52             MOVE BJMRDT    ACTDY                           S01486
     C  N20                Z-ADDZDAYNO    CDATE
     C  N20                Z-ADDZDAYNO    FDATE
     C**
     C**   CONVERT DATES
     C**
     C                     Z-ADDNRPD      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    NRPDA   7
     C**
     C                     Z-ADDNIDT      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    NIDTA   7
     C**
     C           MDAT      COMP 0                        35
     C   35                MOVE 'AT CALL' MDATA   7
     C  N35                Z-ADDMDAT      ZDAYNO
     C  N35                EXSR ZDATE2
     C  N35                MOVE ZADATE    MDATA
     C**
     C**   CALCULATE INTEREST TO TODAYS DATE
     C**
     C**    IF STOP ACCRUALS IND. IS ON, BYPASS THESE CALCS.
     C**
     C                     TESTB'3'       LONI           27
     C   27                GOTO STOPAC
     C**
     C**   IF LOAN NOT YET STARTED BYPASS INTEREST CALCS
     C**
     C***********VDAT      COMP RUND                 27                   S01486
     C           VDAT      COMP BJRDNB               27                   S01486
     C   27                GOTO STOPAC
     C**
     C**   IF LOAN HAS GONE PAST DUE, ADD PDIN, AIAP, AIMN TO GET
     C**   INOUT AMOUNT.  SKIP CALCULATION OF INTEREST FROM IACD TO MDAT.
     C**
     C           RECI      COMP 'D'                      28
     C   28      MDAT      COMP IACD                   27
     C   28 27   MDAT      COMP 0                    2727
     C   28 27   AIAP      ADD  AIMN      INOUT
     C   28 27   PDIN      ADD  INOUT     INOUT
     C   28 27             GOTO SUBTRT
     C**
     C                     Z-ADD0         ZINTR
     C   24                GOTO INTTAG
     C                     Z-ADDIACD      ZIBEG
     C           MDAT      COMP 0                        27
     C*****N27***RUND      COMP MDAT                   27                 S01486
     C     N27   BJRDNB    COMP MDAT                   27                 S01486
     C******27***          MOVE RUND      ZIEND                           S01486
     C      27             MOVE BJRDNB    ZIEND                           S01486
     C     N27             MOVE MDAT      ZIEND
     C** CHECK IF FIRST DAY ACCRUALS
     C** IF SO ADD EXTRA DAYS INTEREST
     C**   UNLESS MATURITY DATE TODAT OR PAST
     C***********ACLD      COMP 'Y'                  2828                 S01486
     C           BKALDI    COMP 'Y'                  2828                 S01486
     C***28******RUND      COMP MDAT                   28                 S01486
     C   28      BJRDNB    COMP MDAT                   28                 S01486
     C      28   ZIEND     ADD  1         ZIEND
     C**
     C**   CHECK FOR FIRST DAY ACCRUALS AND CALL LOAN
     C**
     C***********ACLD      COMP 'Y'                  2828                 S01486
     C           BKALDI    COMP 'Y'                  2828                 S01486
     C   28      MDAT      COMP 0                        28
     C   28      ZIEND     ADD  1         ZIEND
     C                     MOVE ICBS      ZICALC
     C                     Z-ADDCPAM      ZIAMT
     C                     Z-ADDINTR      ZIRATE
     C                     EXSR GLINTC
     C**
     C**   CALCULATE INTEREST OUTSTANDING
     C**
     C           INTTAG    TAG                             ** INTTAG TAG *
     C           ZINTR     ADD  AITC      INOUT  130H
     C           INOUT     ADD  AIAP      INOUT
     C           INOUT     ADD  AIMN      INOUT
     C                     GOTO SUBTRT
     C           STOPAC    TAG                             ** STOPAC TAG *
     C           AITC      ADD  AIAP      INOUT
     C           INOUT     ADD  AIMN      INOUT
     C           SUBTRT    TAG                             ** SUBTRT TAG *
     C           INOUT     SUB  IWOD      INOUT
     C           INOUT     SUB  IPRD      INOUT
     C           INOUT     SUB  ICTD      INOUT
     C**
     C**   CHAIN FOR CURRENCY DPS
     C**
     C***********          SETOF                     3810                 S01486
     C***********CCYKEY    CHAINTABLEIC              38                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   P@RTCD                          S01486
     C                     PARM '*KEY   ' P@OPTN                          S01486
     C                     PARM CCYL      P@CCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**N10******          MOVE 'TABLE'   DBFILE                          S01486
     C**N10******          MOVE CCYKEY    DBKEY                           S01486
     C**N10******          Z-ADD2         DBASE            DBASE 2        S01486
     C**N10******          SETON                     39U7U8               S01486
     C**N10******          GOTO VEND                                      S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD2         QMERRN           ***************S01486
     C                     MOVEL'Y'       QMDBER           **DB ERROR 02**S01486
     C                     MOVEL'PM2081'  QMPGM            ***************S01486
     C                     MOVE 'SDCURRPD'QMFILE                          S01486
     C                     MOVELCCYL      QMKEY                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C                     SETON                     39U7U8               S01486
     C                     GOTO VEND                                      S01486
     C                     END                                            S01486
     C**
     C***********CDP       COMP 1                      6162               S01486
     C***********CDP       COMP 2                    64  63               S01486
     C           A6NBDP    COMP 1                      6162               S01486
     C           A6NBDP    COMP 2                    64  63               S01486
     C**
     C*****CHAIN*TO*CLINT*FOR*CLIENT*NAME******************************   S01486
     C***********                                                         S01486
     C***********          MOVELCNUML     CLIKEY                          S01486
     C***********          SETOF                     3810                 S01486
     C***********CLIKEY    CHAINCLINT                38                   S01486
     C**N10******          SETON                     39U7U8               S01486
     C**N10******          MOVE 'CLINT'   DBFILE                          S01486
     C**N10******          MOVE CLIKEY    DBKEY                           S01486
     C**N10******          Z-ADD3         DBASE            DBASE 3        S01486
     C**N10******          GOTO VEND                                      S01486
     C*                                                                   S01486
     C**   Call Access Object to get client name                          S01486
     C*                                                                   S01486
     C                     MOVELCNUML     CLIKEY  6                       S01486
     C                     CALL 'AOCUSTR0'                                S01486
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*KEY   ' P@OPTN  7                       S01486
     C                     PARM CLIKEY    P@KEY1 10                       S01486
     C                     PARM *BLANKS   P@KYST  7                       S01486
     C           SDCUST    PARM SDCUST    DSSDY                           S01486
     C*                                                                   S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD3         QMERRN           ***************S01486
     C                     MOVEL'Y'       QMDBER           **DB ERROR 03**S01486
     C                     MOVEL'PM2081'  QMPGM            ***************S01486
     C                     MOVE 'SDCUSTPD'QMFILE                          S01486
     C                     MOVELCNUML     QMKEY                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C                     SETON                     39U7U8               S01486
     C                     GOTO VEND                                      S01486
     C                     END                                            S01486
     C**
     C**   TEST FOR CAPITALISATION
     C**
     C           INTC      COMP 'Y'                      56
     C   56                MOVE 'YES'     CAPI    3
     C  N56                MOVE ' NO'     CAPI
     C**  DETERMINE IF PARTICIPATION SOLD/PURCHASED
     C                     MOVEA'00'      *IN,72
     C           PTYP      IFEQ 64
     C           PTYP      OREQ 65
     C                     MOVE '1'       *IN73
     C                     ELSE
     C           PTYP      IFEQ 66
     C           PTYP      OREQ 67
     C                     MOVE '1'       *IN72
     C                     END
     C                     END
     C**
     C**   OUTPUT HEADINGS AND LOAN DETAILS
     C**
     C                     SETON                     71
     C                     EXCPT
     C                     SETOF                     71
     C**
     C   21                EXSR SRLOHS
     C   50                EXSR SRHIST
     C  N21N50             EXSR SRLOMS
     C**
     C   37 50
     CORN21N50 34
     COR 34 37 21          SETON                     31
     C   31                MOVE MSG,6     ERMSG            COMPLETE
     C**
     C**   SET UP CMSG FIELD
     C**
     C   31                MOVE BLANKS    CMSG
     C  N31                MOVE MSG,8     CMSG
     C                     SETOF                     40
     C                     GOTO VEND
     C**
     C           ERTAG     TAG                             ** ERTAG TAG **
     C                     SETON                     404445
     C**
     C           VEND      ENDSR                           ** VEND ENDSR *
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    INVCOM SR. TO PROCESS INVALID COMMAND KEYS                    *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - MAIN PROCESSING
     C           INVCOM    BEGSR                           ** INVCOM BEGSR
     C**
     C                     MOVELMSG,5     ERMSG
     C                     SETON                     4445
     C                     SETOF                     40
     C                     ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    RDLOMS SR. TO READ LOAMS FILE                                 *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - SRLOHS,SRLOMS
     C           RDLOMS    BEGSR                           ** RDLOMS BEGSR
     C**
     C                     SETOF                     3810
     C                     READ LOAMS                    38
     C                     ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    RDHIST SR. TO READ HISTS FILE                                 *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - SRLOHS,SRLOMS
     C           RDHIST    BEGSR                           * RDHIST BEGSR
     C**
     C                     SETOF                     3810
     C                     READ HISTR                    38
     C                     ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    SRHIST SR. TO SEARCH HISTORY FILE FOR RELEVANT DETAILS        *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - MAIN PROCESSING,VALDTE
     C*            ROUTINE CALLS - OUTH (2)
     C           SRHIST    BEGSR                           ** SRHIST BEGSR
     C                     Z-ADD10        V       20
     C**
     C**   SET UP KEY AND CHOP FOR RECORD
     C**
     C   08                EXSR OUTH
     C                     Z-ADD0         VDATH
     C                     Z-ADD0         PRSQ
     C                     Z-ADD0         LCD                                                 CLE154
     C                     Z-ADD0         LASN
     C  N08      KEY       SETLLHISTR
     C           LOOPH     TAG                             ** LOOPH  TAG *
     C                     EXSR RDHIST
     C   38                SETON                     37
     C  N37      LNRF      COMP LNRFH                3737
     C   37                GOTO SHEND
     C**
     C  N10                GOTO LOOPH
     C**
     C           VDATH     COMP CDATE                  35
     C   35                GOTO LOOPH
     C**
     C                     EXSR OUTH
     C   80                GOTO SHEND
     C  N60                GOTO LOOPH
     C**
     C**   CHECK FOR COMPLETE
     C**
     C           LOOPH2    TAG                             ** LOOPH2 TAG *
     C                     EXSR RDHIST
     C   38                SETON                     37
     C   37                GOTO SHEND
     C  N10                GOTO LOOPH2
     C  N37      LNRF      COMP LNRFH                3737
     C**
     C           SHEND     ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    SRLOMS SR. TO SEARCH LOAMS FILE FOR RELEVANT DETAILS          *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - MAIN PROCESSING,VALDTE
     C*            ROUTINE CALLS - RDLOMS (2),OUTL
     C           SRLOMS    BEGSR                           ** SRLOMS BEGSR
     C                     Z-ADD10        V
     C**
     C**   SET UP KEY AND READ RECORDS
     C**
     C   08                GOTO LOOPL1
     C                     Z-ADDCDATE     DATE
     C                     Z-ADD0         SEQU
     C           LOKEY     SETLLLOAMS
     C           LOOPL     TAG                             ** LOOPL TAG **
     C                     EXSR RDLOMS
     C   38                SETON                     34
     C   34                GOTO SLEND
     C  N10                GOTO LOOPL
     C           LNRFL     COMP LNRF                 3434
     C   34                GOTO SLEND
     C**
     C**   CHECK RECORD VIS-A-VIS CODE ENTERED
     C**   P - PAST DUE - MUST BE TYPE PD
     C**
     C           LOOPL1    TAG                             ** LOOPL1 TAG *
     C   51      AMTPL     COMP 'PD'                 3535
     C   51 35             GOTO LOOPL
     C**
     C**   B - BACK VALUED - MUST BE PRIOR TO TODAY, AND NOT 'PD'
     C**
     C***53******VDATL     COMP RUND                 35  35               S01486
     C   53      VDATL     COMP BJRDNB               35  35               S01486
     C   53N35   AMTPL     COMP 'PD'                     35
     C   53 35             GOTO LOOPL
     C**
     C                     EXSR OUTL
     C   80                GOTO SLEND
     C  N60                GOTO LOOPL
     C**
     C**   CHECK FOR COMPLETE
     C**
     C           LOOPL2    TAG                             ** LOOPL2 TAG *
     C                     EXSR RDLOMS
     C   38                SETON                     34
     C   34                GOTO SLEND
     C  N10                GOTO LOOPL2
     C           LNRF      COMP LNRFL                3434
     C**
     C           SLEND     ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    SRLOHS SR. TO SEARCH LOAMS AND HISTS FOR ACTIVITY             *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - MAIN PROCESSING,VALDTE
     C*            ROUTINE CALLS - RDLOMS (3),OUTH (2),OUTL(2)
     C           SRLOHS    BEGSR                           ** SRLOHS BEGSR
     C                     Z-ADD10        V
     C**
     C**   ASCERTAIN WHETHER THERE IS ACTIVITY ON EITHER FILE
     C**   1 - LOAMS
     C**
     C   08                GOTO LOPS3
     C                     Z-ADDCDATE     DATE
     C                     Z-ADD0         SEQU
     C           LOKEY     SETLLLOAMS
     C           LOPS1     TAG                             ** LOPS1 TAG **
     C                     EXSR RDLOMS
     C   38                SETON                     34
     C  N10N34             GOTO LOPS1
     C  N34      LNRFL     COMP LNRF                 3434
     C**
     C**   2 - HISTS
     C**
     C                     Z-ADD0         VDATH
     C                     Z-ADD0         PRSQ
     C                     Z-ADD0         LCD                                                 CLE154
     C                     Z-ADD0         LASN
     C           KEY       SETLLHISTR
     C           LOPS2     TAG                             ** LOPS2 TAG **
     C                     EXSR RDHIST
     C   38                SETON                     37
     C  N10N37             GOTO LOPS2
     C  N37      LNRFH     COMP LNRF                 3737
     C   37                GOTO LOPS3
     C**
     C           VDATH     COMP CDATE                  35
     C   35                GOTO LOPS2
     C**
     C           LOPS3     TAG                             ** LOPS3 TAG **
     C   34 37
     COR 60                GOTO SREND
     C**
     C**   NO LOAMS - OUTPUT HISTS DETAIL AND READ NEXT
     C**
     C   34                EXSR OUTH
     C   34 80             GOTO SREND
     C           LOPS4     TAG                             ** LOPS4 TAG **
     C   34                EXSR RDHIST
     C   34N10N38          GOTO LOPS4
     C   34 38             SETON                     37
     C   34N37   LNRF      COMP LNRFH                3737
     C   34                GOTO LOPS3
     C**
     C**   NO HISTS - OUTPUT LOAMS DETAIL AND READ NEXT
     C**
     C   37                EXSR OUTL
     C   37 80             GOTO SREND
     C           LOPS5     TAG                             ** LOPS5 TAG **
     C   37                EXSR RDLOMS
     C   37 38             SETON                     34
     C   37N10N34          GOTO LOPS5
     C   37N34   LNRF      COMP LNRFL                3434
     C   37                GOTO LOPS3
     C**
     C**   DETAILS ON BOTH FILES
     C**
     C           VDATH     COMP VDATL                323333
     C**
     C**   LOAM EARLIER
     C**
     C   32                EXSR OUTL
     C   32 80             GOTO SREND
     C           LOPS6     TAG                             ** LOPS6 TAG **
     C   32                EXSR RDLOMS
     C   32 38             SETON                     34
     C   32N34N10          GOTO LOPS6
     C   32N34   LNRF      COMP LNRFL                3434
     C   32                GOTO LOPS3
     C**
     C**   HIST EARLIER
     C**
     C   33                EXSR OUTH
     C   33 80             GOTO SREND
     C           LOPS7     TAG                             ** LOPS7 TAG **
     C   33                EXSR RDHIST
     C   33 38             SETON                     37
     C   33N37N10          GOTO LOPS7
     C   33N37   LNRF      COMP LNRFH                3737
     C   33                GOTO LOPS3
     C**
     C           SREND     ENDSR                           ** SREND ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    OUTH SR. TO SET UP AMOUNT AND NARRATIVE FIELDS FOR HISTS      *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - SRHIST,SRLOHS
     C*            ROUTINE CALLS - OUTHR (23),CHECKH (9)
     C           OUTH      BEGSR                           ** OUTH BEGSR
     C                     Z-ADD0         SPO
     C                     Z-ADD0         AMTO
     C                     SETOF                     66
     C**
     C           AMTPH     COMP 'PI'                     35
     C   35                MOVE NARR,14   NARO   30
     C   35                Z-ADDPRAMH     AMTO   130
     C   35                EXSR OUTHR
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'MR'                     35
     C   35      PRAMH     COMP 0                    3636
     C   35 36             MOVE NARR,9    NARO
     C   35 36             Z-ADDPRAMH     AMTO
     C   35 36N81          EXSR OUTHR
     C   35 36             SETON                     8081
     C   35 36 60          EXSR CHECKH
     C   35 36 60          GOTO HEND
     C**
     C   35      INTAH     COMP 0                    3636
     C   35 36             MOVE NARR,12   NARO
     C   35 36             Z-ADDINTAH     AMTO
     C   35 36N82          EXSR OUTHR
     C   35 36             SETON                     8082
     C   35 36 60          EXSR CHECKH
     C   35 36 60          GOTO HEND
     C**
     C                     SETOF                     573836
     C   35      WTXAH     COMP 0                    5757
     C   57                MOVELLNRFH     CLOKEY
     C   57      CLOKEY    CHAINCLOAN                38
     C***57*38***          MOVE 'CLOAN'   DBFILE                          S01486
     C***57*38***          MOVE CLOKEY    DBKEY                           S01486
     C***57*38***          Z-ADD4         DBASE            DBASE 4        S01486
     C           *IN57     IFEQ '1'                                       S01486
     C           *IN38     ANDEQ'1'                                       S01486
     C                     Z-ADD4         QMERRN           ***************S01486
     C                     MOVEL'Y'       QMDBER           **DB ERROR 04**S01486
     C                     MOVEL'PM2081'  QMPGM            ***************S01486
     C                     MOVE 'CLOAN'   QMFILE                          S01486
     C                     MOVELCLOKEY    QMKEY                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C                     END                                            S01486
     C   57 38             SETON                     39U7U8
     C   57 38             GOTO HEND
     C   57      WTIN      IFNE 'G'
     C           WTIN      ANDNE'N'
     C                     SETON                     36
     C                     END
     C   57                SETOF                     57
     C   35 36             MOVE NARR,10   NARO
     C   35 36             Z-ADDWTXAH     AMTO
     C   35 36N83          EXSR OUTHR
     C   35 36             SETON                     8083
     C   35 36 60          EXSR CHECKH
     C   35 36 60          GOTO HEND
     C**
     C   35      FEAMH     COMP 0                    3636
     C   35 36             MOVE NARR,11   NARO
     C   35 36             Z-ADDFEAMH     AMTO
     C   35 36             EXSR OUTHR
     C   35                SETOF                     808182
     C   35                SETOF                     83
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'IN'                     35
     C   35                Z-ADDINTAH     AMTO
     C   35N56             MOVE NARR,3    NARO
     C   35 56             MOVE NARR,4    NARO
     C   35                EXSR OUTHR
     C   35                SETOF                     5738
     C   35      WTXAH     COMP 0                    5757
     C   35 57             MOVELLNRFH     CLOKEY
     C   35 57   CLOKEY    CHAINCLOAN                38
     C***35*57*38          MOVE 'CLOAN'   DBFILE                          S01486
     C***35*57*38          MOVE CLOKEY    DBKEY                           S01486
     C***35*57*38          Z-ADD6         DBASE            DBASE 6        S01486
     C           *IN35     IFEQ '1'                                       S01486
     C           *IN57     ANDEQ'1'                                       S01486
     C           *IN38     ANDEQ'1'                                       S01486
     C                     Z-ADD6         QMERRN           ***************S01486
     C                     MOVEL'Y'       QMDBER           **DB ERROR 06**S01486
     C                     MOVEL'PM2081'  QMPGM            ***************S01486
     C                     MOVE 'CLOAN'   QMFILE                          S01486
     C                     MOVELCLOKEY    QMKEY                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C                     END                                            S01486
     C   35 57 38          SETON                     39U7U8
     C   35 57 38          GOTO HEND
     C   35 57   WTIN      IFEQ 'R'
     C                     Z-ADDWTXAH     AMTO
     C                     MOVE NARR,38   NARO
     C                     EXSR OUTHR
     C                     END
     C                     SETOF                     57
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'RE'                     35
     C   35      PRAMH     COMP 0                    36
     C   35 36             MOVE NARR,15   NARO
     C   35 36             Z-ADDPRAMH     AMTO
     C   35 36N81          EXSR OUTHR
     C   35 36             SETON                     8081
     C   35 36 60          EXSR CHECKH
     C   35 36 60          GOTO HEND
     C**
     C   35      INTAH     COMP 0                    3636
     C   35 36             MOVE NARR,16   NARO
     C   35 36             Z-ADDINTAH     AMTO
     C   35 36N82          EXSR OUTHR
     C   35 36             SETON                     8082
     C   35 36 60          EXSR CHECKH
     C   35 36 60          GOTO HEND
     C**
     C   35      WTXAH     COMP 0                    3636
     C   35 36             MOVE NARR,17   NARO
     C   35 36             Z-ADDWTXAH     AMTO
     C   35 36             EXSR OUTHR
     C   35                SETOF                     808182
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'MA'                     35
     C   35N26             MOVE NARR,5    NARO
     C   35 26             MOVE NARR,34   NARO
     C   35                Z-ADDPRAMH     AMTO
     C   35N81             EXSR OUTHR
     C   35                SETON                     8081
     C   35 60             EXSR CHECKH
     C   35 60             GOTO HEND
     C**
     C   35      INTAH     COMP 0                    3636
     C   35 36N56          MOVE NARR,6    NARO
     C   35 36 56          MOVE NARR,33   NARO
     C   35 36             Z-ADDINTAH     AMTO
     C   35 36N82          EXSR OUTHR
     C   35 36             SETON                     8082
     C   35 36 60          EXSR CHECKH
     C   35 36 60          GOTO HEND
     C**
     C   35      WTXAH     COMP 0                    3636
     C   35 36             MOVE NARR,7    NARO
     C   35 36             Z-ADDWTXAH     AMTO
     C   35 36             EXSR OUTHR
     C   35                SETOF                     808182
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'MI'                     35
     C   35                MOVE NARR,8    NARO
     C   35                Z-ADDINTAH     AMTO
     C   35                EXSR OUTHR
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'SA'                     35
     C   35                SETON                     66
     C   35      STAIH     COMP 'Y'                      36
     C   35 36             MOVE NARR,24   NARO
     C   35N36             MOVE NARR,25   NARO
     C   35                EXSR OUTHR
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'SC'                     35
     C   35                MOVE NARR,26   NARO
     C   35                Z-ADDRTSPH     SPO    117
     C   35                EXSR OUTHR
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'BR'                     35
     C   35                MOVE NARR,2    NARO
     C   35                Z-ADDBRTEH     SPO
     C   35                EXSR OUTHR
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'BC'                     35
     C   35                MOVE NARR,1    NARO
     C   35                Z-ADDBRTEH     SPO
     C   35                EXSR OUTHR
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'RO'                     35
     C   35      BRTEH     COMP 0                    36
     C   35 36             MOVE NARR,19   NARO
     C   35 36             Z-ADDBRTEH     SPO
     C   35 36N81          EXSR OUTHR
     C   35 36             SETON                     8081
     C   35 36 60          EXSR CHECKH
     C   35 36 60          GOTO HEND
     C**
     C   35                Z-ADDRTSPH     SPO
     C   35      RTSPH     COMP 0                    36
     C   35 36   BRTEH     COMP 0                        36
     C   35 36             MOVE NARR,20   NARO
     C   35 36N82          EXSR OUTHR
     C   35 36             SETON                     8082
     C   35 36 60          EXSR CHECKH
     C   35 36 60          GOTO HEND
     C**
     C   35      RTSPH     COMP 0                    36
     C   35 36   BRTEH     COMP 0                    36
     C   35 36   SPINH     COMP 'A'                      54
     C   35 36 54          MOVE NARR,21   NARO
     C**
     C   35 36   SPINH     COMP 'S'                      54
     C   35 36 54          MOVE NARR,22   NARO
     C**
     C   35 36   SPINH     COMP 'P'                      54
     C   35 36 54          MOVE NARR,23   NARO
     C   35 36             EXSR OUTHR
     C   35                SETOF                     808182
     C   35                GOTO HEND
     C**
     C           AMTPH     COMP 'ST'                     35
     C   35      TOTI      COMP 0                    2625
     C   35N25N26          MOVE NARR,27   NARO
     C   35 25
     COR 35 26             MOVE NARR,35   NARO
     C   35                Z-ADDPRAMH     AMTO
     C   35N81             EXSR OUTHR
     C   35                SETON                     8081
     C   35 60             GOTO HEND
     C**
     C   35 25             MOVE NARR,36   NARO
     C   35 26             MOVE NARR,37   NARO
     C   35 25             Z-SUBTOTI      AMTO
     C   35 26             Z-ADDTOTI      AMTO
     C   35 25             SETON                     26
     C   35 26N82          EXSR OUTHR
     C   35 26             SETON                     8082
     C   35 26 60          GOTO HEND
     C**
     C   35      BRTEH     COMP 0                    36
     C   35 36             MOVE NARR,28   NARO
     C   35 36             Z-ADDBRTEH     SPO
     C   35 36N83          EXSR OUTHR
     C   35 36             SETON                     8083
     C   35 36 60          GOTO HEND
     C**
     C   35                Z-ADDRTSPH     SPO
     C   35      RTSPH     COMP 0                    36
     C   35 36   BRTEH     COMP 0                        36
     C   35 36             MOVE NARR,29   NARO
     C   35 36N84          EXSR OUTHR
     C   35 36             SETON                     8084
     C   35 36 60          GOTO HEND
     C**
     C   35      RTSPH     COMP 0                    36
     C   35 36   BRTEH     COMP 0                    36
     C   35 36   SPINH     COMP 'A'                      54
     C   35 36 54          MOVE NARR,30   NARO
     C**
     C   35 36   SPINH     COMP 'S'                      54
     C   35 36 54          MOVE NARR,31   NARO
     C**
     C   35 36   SPINH     COMP 'P'                      54
     C   35 36 54          MOVE NARR,32   NARO
     C   35 36             EXSR OUTHR
     C   35                SETOF                     808182
     C   35                SETOF                     8384
     C**
     C           HEND      ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    CHECKH SR. TO CHECK WHETHER ANY FURTHER LINES WILL BE         *
     C*               OUTPUT IF SCREEN IS FULL IN MIDDLE OF PROCESSING   *
     C*               A HISTS RECORD.                                    *
     C*                                                                  *
     C*    ROUTINE CALLED FROM OUTH                                      *
     C*                                                                  *
     C           CHECKH    BEGSR                           ** CHECKH BEGSR
     C**
     C                     SETOF                     4849
     C           AMTPH     COMP 'MR'                     47
     C   47N82   INTAH     COMP 0                    4848
     C   47N83N48WTXAH     COMP 0                    4848
     C   47N48   FEAMH     COMP 0                    4848
     C**
     C           AMTPH     COMP 'RE'                     47
     C  N47      AMTPH     COMP 'MA'                     47
     C   47N82   INTAH     COMP 0                    4848
     C   47N48   WTXAH     COMP 0                    4848
     C**
     C           AMTPH     COMP 'RO'                     47
     C   47N82   RTSPH     COMP 0                    49
     C   47N82 49BRTEH     COMP 0                        49
     C   47N82 49          SETON                     48
     C**
     C   47      RTSPH     COMP 0                    49
     C   47 49   BRTEH     COMP 0                    49
     C   47 49             SETON                     48
     C**
     C  N48                SETOF                     808182
     C  N48                SETOF                     83
     C**
     C                     ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    OUTHR SR. TO OUTPUT TO SCREEN AND CHECK FULL                  *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - OUTH
     C*            ROUTINE CALLS - ZDATE2
     C           OUTHR     BEGSR                           ** OUTHR BEGSR
     C**
     C**   CONVERT DATE
     C**
     C                     Z-ADDVDATH     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DUDAT   7
     C**
     C                     MOVE 'H'       CODE    1
     C           SPO       COMP 0                    6565
     C   66                SETON                     65
     C           V         ADD  1         V
     C           V         COMP 20                       60
     C                     SETON                     70
     C                     EXCPT
     C                     SETOF                     70
     C**
     C                     ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*                                                                  *
     C*    OUTL SR. TO SET UP AMOUNT AND NARRATIVE FIELDS FOR LOAMS      *
     C*
     C*            ROUTINE CALLED FROM - SRLOMS,SRLOHS
     C*            ROUTINE CALLS - OUTLR (10),CHECKL (3)
     C           OUTL      BEGSR                           **  OUTL BEGSR*
     C                     Z-ADD0         SPO
     C                     Z-ADD0         AMTO
     C                     SETOF                     66
     C**
     C           AMTPL     COMP 'BC'                     35
     C   35                MOVE NARR,1    NARO
     C   35                Z-ADDBRTEL     SPO
     C   35                EXSR OUTLR
     C   35                GOTO LEND
     C**
     C           AMTPL     COMP 'MR'                     35
     C   35      PRAML     COMP 0                    3636
     C   35 36             MOVE NARR,9    NARO
     C   35 36             Z-ADDPRAML     AMTO
     C   35 36N81          EXSR OUTLR
     C   35 36             SETON                     8081
     C   35 36 60          EXSR CHECKL
     C   35 36 60          GOTO LEND
     C**
     C   35      INTAL     COMP 0                    3636
     C   35 36             Z-ADDINTAL     AMTO
     C   35 36             MOVE NARR,12   NARO
     C   35 36N82          EXSR OUTLR
     C   35 36             SETON                     8082
     C   35 36 60          EXSR CHECKL
     C   35 36 60          GOTO LEND
     C**
     C   35      WTXAL     COMP 0                    3636
     C   35 36             Z-ADDWTXAL     AMTO
     C   35 36             MOVE NARR,10   NARO
     C   35 36N83          EXSR OUTLR
     C   35 36             SETON                     8083
     C   35 36 60          EXSR CHECKL
     C   35 36 60          GOTO LEND
     C**
     C   35      FEAML     COMP 0                    3636
     C   35 36             MOVE NARR,11   NARO
     C   35 36             Z-ADDFEAML     AMTO
     C   35 36             EXSR OUTLR
     C   35                SETOF                     808182
     C   35                SETOF                     83
     C   35                GOTO LEND
     C**
     C           AMTPL     COMP 'PD'                     35
     C   35                MOVE NARR,13   NARO
     C   35                Z-ADDTAMTL     AMTO
     C   35                EXSR OUTLR
     C   35                GOTO LEND
     C**
     C           AMTPL     COMP 'PI'                     35
     C   35                MOVE NARR,14   NARO
     C   35                Z-ADDPRAML     AMTO
     C   35                EXSR OUTLR
     C   35                GOTO LEND
     C**
     C           AMTPL     COMP 'RE'                     35
     C      35   REPTL     COMP 1                        36
     C   35 36             MOVE NARR,15   NARO
     C   35 36             Z-ADDPRAML     AMTO
     C   35N36             MOVE NARR,18   NARO
     C   35N36             Z-ADDTAMTL     AMTO
     C   35                EXSR OUTLR
     C   35                GOTO LEND
     C**
     C           AMTPL     COMP 'SA'                     35
     C   35                SETON                     66
     C   35      STAIL     COMP 'Y'                      36
     C   35 36             MOVE NARR,24   NARO
     C   35N36             MOVE NARR,25   NARO
     C   35                EXSR OUTLR
     C   35                GOTO LEND
     C**
     C           AMTPL     COMP 'SC'                     35
     C   35                MOVE NARR,26   NARO
     C   35                Z-ADDRTSPL     SPO
     C   35                EXSR OUTLR
     C**
     C           LEND      ENDSR                           ** LEND ENDSR *
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    CHECKL SR. TO CHECK WHETHER ANY FURTHER LINES WILL BE         *
     C*               OUTPUT IF SCREEN FULL IN MIDDLE OF PROCESSING      *
     C*               A LOAMS RECORD.                                    *
     C*                                                                  *
     C*        ROUTINE CALLED FROM OUTL                                  *
     C*                                                                  *
     C           CHECKL    BEGSR                           ** CHECKL BEGSR
     C**
     C  N82      INTAL     COMP 0                    4848
     C  N83N48   WTXAL     COMP 0                    4848
     C  N48      FEAML     COMP 0                    4848
     C**
     C  N48                SETOF                     808182
     C  N48                SETOF                     83
     C**
     C                     ENDSR
     C*                                                                  *
     C********************************************************************
     C*                                                                  *
     C*    OUTLR SR. TO OUTPUT LOAM DETAILS TO SCREEN AND CHECK FULL     *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - OUTL
     C*            ROUTINE CALLS - ZDATE2
     C           OUTLR     BEGSR                           ** OUTLR BEGSR
     C**
     C**   CONVERT DATE
     C**
     C                     Z-ADDVDATL     ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    DUDAT   7
     C**
     C**   DETERMINE CODE
     C**
     C           AMTPL     COMP 'PD'                     55
     C   55                MOVE 'P'       CODE
     C   55                GOTO ENDCD
     C**
     C***********VDATL     COMP RUND                   55                 S01486
     C           VDATL     COMP BJRDNB                 55                 S01486
     C   55                MOVE 'B'       CODE
     C   55                GOTO ENDCD
     C**
     C                     MOVE 'F'       CODE
     C**
     C           ENDCD     TAG                             ** ENDCD TAG **
     C**
     C           SPO       COMP 0                    6565
     C   66                SETON                     65
     C**
     C           V         ADD  1         V
     C           V         COMP 20                       60
     C                     SETON                     70
     C                     EXCPT
     C                     SETOF                     70
     C**
     C                     ENDSR
     C*                                                                  *
      ***********                                                         S01486
     C********************************************************************S01486
     C***********                                                         S01486
     C*****ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.            S01486
     C***********                                                         S01486
     C*****THE*YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.         S01486
     C***********                                                         S01486
     C***********ZDATE2    BEGSR                           *** ZDATE2 *** S01486
     C***********                                                         S01486
     C*****CLEAR*DATE FIELDS.                                             S01486
     C***********          Z-ADD0         ZDATE   60                      S01486
     C***********          MOVEL'       ' ZADATE  7                       S01486
     C***********                                                         S01486
     C*****CALCULATION TO DEFINE INPUT DAY NUMBER.                        S01486
     C***********          Z-ADDZDAYNO    ZDAYNO  50                      S01486
     C***********                                                         S01486
     C*****DETERMINE YEAR NUMBER.                                         S01486
     C***********                                                         S01486
     C*****ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    S01486
     C***********ZDAYNO    SUB  1         ZDAYN1  50   99                 S01486
     C***99******          GOTO ZDEND2                                    S01486
     C***********                                                         S01486
     C*****CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             S01486
     C***********ZDAYN1    DIV  1461      ZLYR    20                      S01486
     C***********          MVR            ZDAYN1           SAVE REMAINING S01486
     C***********                                          DAYS           S01486
     C*****CALCULATE NUMBER OF REMAINING YEARS.                           S01486
     C***********          Z-ADD1         ZWRK2   20                      S01486
     C***********ZDTAG1    TAG                             ** ZDTAG1 TAG *S01486
     C***********ZDAYN1    COMP ZYDY,ZWRK2             90                 S01486
     C**N90******ZWRK2     ADD  1         ZWRK2                           S01486
     C**N90******          GOTO ZDTAG1                                    S01486
     C***********ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON S01486
     C***********                                                         S01486
     C*****DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  S01486
     C**N91******ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          S01486
     C***********                                                         S01486
     C*****CALCULATE ACTUAL YEAR NUMBER.                                  S01486
     C***********ZLYR      MULT 4         ZWRK3   30                      S01486
     C***********ZWRK3     ADD  72        ZWRK3            BASE IS 1972   S01486
     C***********          Z-ADDZWRK3     ZYEAR   20                      S01486
     C***********ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           S01486
     C***********                                                         S01486
     C*****DETERMINE MONTH NUMBER.                                        S01486
     C***********                                                         S01486
     C*****ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         S01486
     C***********          SETOF                     9293                 S01486
     C***91******ZDAYN1    COMP 59                     9293               S01486
     C***91N92***ZDAYN1    SUB  1         ZDAYN1                          S01486
     C***********                                                         S01486
     C*****CALCULATE MONTH NUMBER.                                        S01486
     C***********          Z-ADD2         ZWRK2                           S01486
     C***********ZDTAG2    TAG                             ** ZDTAG2 TAG *S01486
     C***********ZDAYN1    COMP ZMDY,ZWRK2             94                 S01486
     C**N94******ZWRK2     ADD  1         ZWRK2                           S01486
     C**N94******          GOTO ZDTAG2                                    S01486
     C***********ZWRK2     SUB  1         ZWRK2                           S01486
     C***********                                                         S01486
     C***********          Z-ADDZWRK2     ZMTH    20       MONTH          S01486
     C***********                                                         S01486
     C*****DETERMINE DAY OF MONTH.                                        S01486
     C***********                                                         S01486
     C*****ADD*BACK LAST DAY OF YEAR ADJUSTMENT.                          S01486
     C***********ZDAYN1    ADD  1         ZDAYN1                          S01486
     C***********                                                         S01486
     C*****CALCULATE DAY OF MONTH.                                        S01486
     C***********ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            S01486
     C***********                                                         S01486
     C*****ADD*BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       S01486
     C***93******ZDAY      ADD  1         ZDAY                            S01486
     C***********                                                         S01486
     C*****FORMAT DATE, DDMMYY OR MMDDYY.                                 S01486
     C**N98******          MOVELZDAY      ZWRK4   40                      S01486
     C***98******          MOVE ZDAY      ZWRK4                           S01486
     C**N98******          MOVE ZMTH      ZWRK4                           S01486
     C***98******          MOVELZMTH      ZWRK4                           S01486
     C***********          MOVELZWRK4     ZDATE                           S01486
     C***********          MOVE ZYEAR     ZDATE                           S01486
     C***********                                                         S01486
     C*****FORMAT ALPHA DATE, DDMMMYY.                                    S01486
     C***********ZDAY      COMP 10                     95                 S01486
     C***********          MOVELZDAY      ZWRK5   5                       S01486
     C***95******          MOVEL' '       ZWRK5                           S01486
     C***********          MOVE ZMNM,ZMTH ZWRK5                           S01486
     C***********          MOVELZWRK5     ZADATE                          S01486
     C***********          MOVE ZYEAR     ZADATE                          S01486
     C***********                                                         S01486
     C***********ZDEND2    ENDSR                           * ZDEND2 ENDSR*S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C********************************************************************S01486
     C***********                                                         S01486
     C*****ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND                     S01486
     C***********     CONVERT TO A NUMBER OF DAYS.                        S01486
     C***********                                                         S01486
     C*****THE*YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.         S01486
     C***********                                                         S01486
     C***********ZDATE1    BEGSR                           *** ZDATE1 *** S01486
     C***********                                                         S01486
     C*****CLEAR*DAY NUMBER.                                              S01486
     C***********          Z-ADD0         ZDAYNO  50                      S01486
     C***********                                                         S01486
     C*****CALCULATION TO DEFINE INPUT DATE FIELD.                        S01486
     C***********          Z-ADDZDATE     ZDATE   60                      S01486
     C***********                                                         S01486
     C*****GET*INDIVIDUAL DAY, MONTH AND YEAR FIELDS.                     S01486
     C***********          MOVE ZDATE     ZYEAR   20                      S01486
     C**N98******          MOVELZDATE     ZDAY    20                      S01486
     C***98******          MOVELZDATE     ZMTH    20                      S01486
     C***********          MOVE ZDATE     ZWRK4   40                      S01486
     C**N98******          MOVELZWRK4     ZMTH                            S01486
     C***98******          MOVELZWRK4     ZDAY                            S01486
     C***********                                                         S01486
     C*****ENSURE MONTH IS VALID.                                         S01486
     C***********ZMTH      COMP 0                      9999               S01486
     C**N99******ZMTH      COMP 12                   99                   S01486
     C***99******          GOTO ZDEND1                     BYPASS IF ERRORS01486
     C***********                                                         S01486
     C*****CHECK*FOR 30 DAY MONTHS.                                       S01486
     C***********ZMTH      COMP 4                        90IF 90 ON, 30   S01486
     C**N90******ZMTH      COMP 6                        90DAY MONTH.     S01486
     C**N90******ZMTH      COMP 9                        90               S01486
     C**N90******ZMTH      COMP 11                       90               S01486
     C***********                                                         S01486
     C*****ENSURE DAY IS VALID.                                           S01486
     C***********ZDAY      COMP 0                      9999               S01486
     C***90N99***ZDAY      COMP 30                   99                   S01486
     C**N90N99***ZDAY      COMP 31                   99                   S01486
     C***99******          GOTO ZDEND1                     BYPASS IF ERRORS01486
     C***********                                                         S01486
     C*****CHECK*FOR LEAP YEAR AND FEBRUARY.                              S01486
     C***********ZYEAR     ADD  28        ZYEAR                           S01486
     C***********ZYEAR     DIV  4         ZLYR    20                      S01486
     C***********          MVR            ZLY     10     91LEAP YR, 91 ON S01486
     C***********ZMTH      COMP 2                    93  92FEB., 92 ON    S01486
     C***********                                          PAST FEB, 93 ONS01486
     C*****IF*FEBUARY FURTHER VALIDATE DAY.                               S01486
     C**N91*92***ZDAY      COMP 28                   99                   S01486
     C***91*92***ZDAY      COMP 29                   99                   S01486
     C***99******          GOTO ZDEND1                     BYPASS IF ERRORS01486
     C***********                                                         S01486
     C*****DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANSS01486
     C***********ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.S01486
     C**N91******ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YRS01486
     C***91*93***ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.S01486
     C***********ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR S01486
     C***********ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTHS01486
     C***********                                                         S01486
     C***********ZDEND1    ENDSR                           * ZDEND1 ENDSR*S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C********************************************************************
     C********************************************************************S01486
     C********************************************************************S01486
     C*****GLINTC*SR.*TO*CALCULATE*INTEREST*BETWEEN*ANY*TWO*DAY*NUMBERS.**S01486
     C********************************************************************S01486
     C*****THIS*VERSION*REPLACES*THE*ORIGINAL*GLINTC*SR.*NOW*NAMED********S01486
     C*****GLINTO.********************************************************S01486
     C********************************************************************S01486
     C*****CALCULATION*METHODS*ARE*-**************************************S01486
     C*****1**ACTUAL/365**************************************************S01486
     C*****2**ACTUAL/360**************************************************S01486
     C*****3**360/360*(SOMETIMES*CALLED*30/360)***************************S01486
     C*****4**365/365*(EXCLUDING*29/02)***********************************S01486
     C*****5**365/360*(EXCLUDING*29/02)***********************************S01486
     C*****6**ACTUAL/366**************************************************S01486
     C********************************************************************S01486
     C*****REQUIRES*SUBRS.*-*ZDATE2,*ZSAVE,*&*ZRSTOR.*********************S01486
     C********************************************************************S01486
     C********************************************************************S01486
     C/COPY ZSRSRC,ZDATE1Z2                                               S01486
     C/COPY ZSRSRC,ZDATE2Z2                                               S01486
     C/COPY ZSRSRC,ZRSTORZ1                                               S01486
     C/COPY ZSRSRC,ZSAVEZ1                                                S01486
      /COPY ZSRSRC,GLINTCZ1                                               S01486
     C/COPY ZSRSRC,ZDAT10Z2                                               126017
     C/EJECT                                                              126017
      /COPY ZSRSRC,ZINTDYZ2                                               S01486
      /COPY ZSRSRC,ZDATE9Z3                                               S01486
     C***SR******GLINTC    BEGSR                           ** GLINTC  **  S01486
     C***********                                                         S01486
     C*****CALCULATIONS*TO*DEFINE*INPUT*FIELDS.***************************S01486
     C***********          Z-ADDZIBEG     ZIBEG   50       STARTING DATE  S01486
     C***SR******          Z-ADDZIEND     ZIEND   50       FINISHING DATE S01486
     C***SR******          Z-ADDZICALC    ZICALC  10       CALC. BASIS    S01486
     C***SR******          Z-ADDZIAMT     ZIAMT  150       PRINCIPAL      S01486
     C***SR******          Z-ADDZIRATE    ZIRATE 117       RATE OF INTRST S01486
     C***********                                                         S01486
     C****TO*DETERMINE*NUMBER*OF*DAYS*INTEREST*TO*BE*CALCULATED********   S01486
     C***SR******ZIEND     SUB  ZIBEG     ZDAYN1  50                      S01486
     C***********                                                         S01486
     C****CHECK*FOR*INTEREST*CALCULATION*BASIS*************************   S01486
     C*****USE*OF*INDICATRS********************************************   S01486
     C*****1,92**2,90**3,91**4,97**5,96**6,95**************************   S01486
     C***********          SETOF                     959697               S01486
     C***SR******ZICALC    COMP 2                    919290               S01486
     C**N91******          GOTO ZICAL                                     S01486
     C***********ZICALC    COMP 5                    959796               S01486
     C***97******ZICALC    COMP 3                    97  91               S01486
     C***95******                                                         S01486
     C**OR*96****          SETOF                     91                   S01486
     C**N91******          GOTO ZILPCK                                    S01486
     C***********                                                         S01486
     C*****THIS*CODING*WILL*CALCULATE*THE*NUMBER*OF*DAYS*TO*USE*WHEN***   S01486
     C*****USING*THE*30/360*BASIS*-*METHOD*3.**************************   S01486
     C***********          EXSR ZSAVE                                     S01486
     C***********          Z-ADDZIBEG     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZDAY      ZISD    20                      S01486
     C***********          MOVE ZMTH      ZISM    20                      S01486
     C***********          MOVE ZYEAR     ZISY    20                      S01486
     C***********          Z-ADDZIEND     ZDAYNO                          S01486
     C***********          EXSR ZDATE2                                    S01486
     C***********          MOVE ZDAY      ZIFD    20                      S01486
     C***********          MOVE ZMTH      ZIFM    20                      S01486
     C***********          MOVE ZYEAR     ZIFY    20                      S01486
     C***********          EXSR ZRSTOR                                    S01486
     C***********          SETOF                     93                   S01486
     C****IN*ORDER*FOR*THE*FINISH*YEAR*TO*BE*LESS*THAN*THE*START*YEAR*IF  S01486
     C****ZIEND*IS*GREATER*THAN*ZIBEG,THEN*THE*DATE*ZIEND*MUST*BE*IN*A*   S01486
     C****DIFFERENT*CENTURY*TO*ZIBEG.IF*SO*ADD*100*YEARS*TO*IT.********   S01486
     C***********ZIEND     COMP ZIBEG                93                   S01486
     C***93******ZIFY      COMP ZISY                   93                 S01486
     C***********          Z-ADDZISY      ZISY2   30                      S01486
     C**N93******          Z-ADDZIFY      ZIFY2   30                      S01486
     C***93******ZIFY      ADD  100       ZIFY2                           S01486
     C***********                                                         S01486
     C***********30        SUB  ZISD      ZID1    50   93                 S01486
     C***93******          Z-ADD0         ZID1                            S01486
     C***********ZISM      COMP 12                       93               S01486
     C***93******          Z-ADD0         ZISM                            S01486
     C***93******ZISY      ADD  1         ZISY                            S01486
     C***93******ZISY2     ADD  1         ZISY2                           S01486
     C***********                                                         S01486
     C***********ZIFD      COMP 31                       93               S01486
     C***93******ZID1      ADD  30        ZID1                            S01486
     C**N93******ZID1      ADD  ZIFD      ZID1                            S01486
     C***********ZIFM      SUB  1         ZIFM                            S01486
     C***********ZISY      COMP ZIFY                     93               S01486
     C***93******ZIFM      SUB  ZISM      ZINOM   30                      S01486
     C***93******          GOTO ZIOUT                                     S01486
     C***********12        SUB  ZISM      ZIM1    20                      S01486
     C***********          Z-ADD1         ZISM                            S01486
     C*****USE*ENLARGED*FIELDS*THAT*CAN*HANDLE*1999*ONWARDS************   S01486
     C***********ZISY2     ADD  1         ZISY2                           S01486
     C***********ZIFY2     SUB  ZISY2     ZIY1    20                      S01486
     C***********ZIY1      MULT 12        ZIM2    30                      S01486
     C***********ZIM2      ADD  ZIFM      ZIM2                            S01486
     C***********ZIM1      ADD  ZIM2      ZINOM                           S01486
     C***********ZIOUT     TAG                             * ZIOUT TAG *  S01486
     C***********ZINOM     MULT 30        ZID2    50                      S01486
     C***********ZID2      ADD  ZID1      ZDAYN1                          S01486
     C***********          SETOF                     93                   S01486
     C***********ZILPCK    TAG                             * ZILPCK TAG * S01486
     C**N96N97***          GOTO ZICAL                                     S01486
     C*****THE*FOLLOWING*CODING*APPLIES*FOR*METHODS*4*AND*5*ONLY.******   S01486
     C*****1*DAY*IS*SUBTRACTED*FROM*ZDAYN1*FOR*EACH*OCCURANCE*OF*29*FEB   S01486
     C*****IN*THE*INTEREST*CALCULATION*PERIOD*INCLUSIVE*OF*ZIBEG,*&*ZIEND.S01486
     C***********                                                         S01486
     C*****FIND*NO*OF*4*YEAR*PERIODS*BETWEEN*DATES*********************   S01486
     C***********ZDAYN1    DIV  1461      ZIMAN   20                      S01486
     C***********          MVR            ZIREM   50                      S01486
     C*****FIND*NEXT*29*FEB*DAY*NO.*ON*OR*AFTER*ZIBEG.*****************   S01486
     C***********ZIBEG     SUB  60        ZIBW1   50                      S01486
     C***********ZIBW1     DIV  1461      ZIDW1   20                      S01486
     C***********          MVR            ZIDREM  50                      S01486
     C***********ZIDREM    COMP 0                        94               S01486
     C***94******          Z-ADDZIBEG     ZIDW2   50                      S01486
     C***94******          GOTO ZILP1                                     S01486
     C*****ROUND*UP*RESULT*********************************************   S01486
     C***********ZIDW1     ADD  1         ZIDW2                           S01486
     C*****CALCULATE*NEXT*29*FEB.**************************************   S01486
     C***********ZIDW2     MULT 1461      ZIDW2                           S01486
     C***********ZIDW2     ADD  60        ZIDW2                           S01486
     C***********ZILP1     TAG                             * ZILP1 TAG *  S01486
     C*****IF*THIS*NEXT*29*FEB.*DAYNO*-*ZIBEG*IS*GR.*TH.*OR*EQ.*TO*****   S01486
     C*****ZIREM*THEN*ADD*1*TO*ZIMAN.**********************************   S01486
     C***********ZIDW2     SUB  ZIBEG     ZILPCP  50                      S01486
     C***********ZIREM     COMP ZILPCP               94  94               S01486
     C***94******ZIMAN     ADD  1         ZIMAN                           S01486
     C*****SUBTRACT*ZIMAN*FROM*ZDAYN1*TO*GIVE*VALUE*OF*ZDAYN1**********   S01486
     C*****REQUIRED*FOR*THIS*INTEREST*CALCULATION.*********************   S01486
     C***********ZDAYN1    SUB  ZIMAN     ZDAYN1                          S01486
     C***********          SETOF                     94                   S01486
     C***********ZICAL     TAG                             * ZICAL TAG *  S01486
     C***********                                                         S01486
     C****CALCULATE*INTEREST*******************************************   S01486
     C***90******                                                         S01486
     C***OR*91***                                                         S01486
     C***OR*96***ZIAMT     DIV  36000     ZIWRK1 155H                     S01486
     C***92******                                                         S01486
     C***OR*97***ZIAMT     DIV  36500     ZIWRK1    H                     S01486
     C***95******ZIAMT     DIV  36600     ZIWRK1    H                     S01486
     C***SR******ZIWRK1    MULT ZIRATE    ZIWRK2 155H                     S01486
     C***SR******ZIWRK2    MULT ZDAYN1    ZINTR  152H      AMT. OF INTRST S01486
     C***********                                                         S01486
     C***********          SETOF                     909192               S01486
     C***********          SETOF                     959697               S01486
     C***SR******          ENDSR                                          S01486
     C***********                                                         S01486
     C********************************************************************S01486
     C***********                                                         S01486
     C*****ZRSTOR SR. TO RESTORE INDICATORS 90 - 97 TO THE SETTINGS       S01486
     C***********     THEY HAD BEFORE THE EXECUTION OF SR. ZSAVE.         S01486
     C***********                                                         S01486
     C***********ZRSTOR    BEGSR                           *** ZRSTOR *** S01486
     C***********                                                         S01486
     C***********          TESTB'0'       ZBITS          90               S01486
     C***********          TESTB'1'       ZBITS          91               S01486
     C***********          TESTB'2'       ZBITS          92               S01486
     C***********          TESTB'3'       ZBITS          93               S01486
     C***********          TESTB'4'       ZBITS          94               S01486
     C***********          TESTB'5'       ZBITS          95               S01486
     C***********          TESTB'6'       ZBITS          96               S01486
     C***********          TESTB'7'       ZBITS          97               S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C********************************************************************S01486
     C***********                                                         S01486
     C*****ZSAVE*SR. TO MEMORISE THE SETTINGS AND TO SET OFF INDICATORS   S01486
     C***********     90 - 97 BEFORE EXECUTION OF A Z-SUBROUTINE.         S01486
     C***********                                                         S01486
     C*****THIS*SR. IS REQUIRED ONLY IF INDICATORS                        S01486
     C*****90*-*97 ARE USED ELSEWHERE IN A PROGRAM.                       S01486
     C***********                                                         S01486
     C***********ZSAVE     BEGSR                           *** ZSAVE ***  S01486
     C***********                                                         S01486
     C***********          BITOF'01234567'ZBITS   1                       S01486
     C***90******          BITON'0'       ZBITS                           S01486
     C***91******          BITON'1'       ZBITS                           S01486
     C***92******          BITON'2'       ZBITS                           S01486
     C***93******          BITON'3'       ZBITS                           S01486
     C***94******          BITON'4'       ZBITS                           S01486
     C***95******          BITON'5'       ZBITS                           S01486
     C***96******          BITON'6'       ZBITS                           S01486
     C***97******          BITON'7'       ZBITS                           S01486
     C***********                                                         S01486
     C***********          SETOF                     909192               S01486
     C***********          SETOF                     939495               S01486
     C***********          SETOF                     9697                 S01486
     C***********                                                         S01486
     C***********          ENDSR                                          S01486
     C***********                                                         S01486
     C***********                                                         S01486
     C/EJECT                                                              S01486
     C********************************************************************
     C*                                                                  *
     C*    FIRST SR. TO PERFORM FIRST CYCLE PROCESSING                   *
     C*                                                                  *
     C*            ROUTINE CALLED FROM - MAIN PROCESSING
     C*            ROUTINE CALLS - ZSYSTM
     C           FIRST     BEGSR                           ** FIRST BEGSR
     C**
     C                     EXSR ZSYSTM
     C***99******          SETON                     39U7U8               S01486
     C***99******          MOVE 'TABLE'   DBFILE                          S01486
     C***99******          MOVE ZTABKY    DBKEY                           S01486
     C***99******          Z-ADD1         DBASE            DBASE 1        S01486
     C***99******          GOTO FEND                                      S01486
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD1         QMERRN           ***************S01486
     C                     MOVEL'Y'       QMDBER           **DB ERROR 02**S01486
     C                     MOVEL'PM2081'  QMPGM            ***************S01486
     C                     MOVE 'SDBANKPD'QMFILE                          S01486
     C                     MOVE *BLANKS   QMKEY                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C                     SETON                     39U7U8               S01486
     C                     GOTO FEND                                      S01486
     C                     END                                            S01486
     C**
     C                     SETON                     40
     C**ACCESS*I/C*TWO*************************************************   S01486
     C***********          MOVE '11'      ZTABKY                          S01486
     C***********ZTABKY    CHAINTABLEIC              99                   S01486
     C******99***          SETON                     U7U839               S01486
     C******99***          Z-ADD5         DBASE            **DATABASE 08**S01486
     C******99***          MOVELZTABKY    DBKEY                           S01486
     C******99***          MOVEL'TABLE'   DBFILE                          S01486
     C******99***          GOTO FEND                                      S01486
     C**********           CALL 'AOGELRR0'                                S01486              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*FIRST'  P@OPTN  7                       S01486
     C********** SDGELR    PARM SDGELR    DSFDY                           S01486              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           P@RTCD    IFNE *BLANKS                                   S01486
     C                     Z-ADD5         QMERRN           ***************S01486
     C                     MOVEL'Y'       QMDBER           **DB ERROR 05**S01486
     C                     MOVEL'PM2081'  QMPGM            ***************S01486
     C                     MOVE 'SDGELRPD'QMFILE                          S01486
     C                     MOVE *BLANKS   QMKEY                           S01486
     C*                                                                   S01486
     C** UPDATE *LDA                                                      S01486
     C*                                                                   S01486
     C                     CALL 'PMC1001'                                 S01486
     C                     PARM           WWLDA                           S01486
     C                     SETON                     39U7U8               S01486
     C                     END                                            S01486
     C***********          MOVE 'A'       CLIKEY  7                       S01486
     C                     MOVE 'A'       CLOKEY  7
     C                     MOVE ' '       BLANKS 60
     C***********          MOVEL'20'      CCYKEY                          S01486
     C***********          MOVE '1'       CCYKEY                          S01486
     C           FEND      ENDSR
     C*                                                                  *
     C********************************************************************
     C**
     C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
     C**
     C           ZSYSTM    BEGSR                           *** ZSYSTM ***
     C*                                                                   S01486
     C                     MOVEACPY@      CPY2@  80                       S01486
     C*                                                                   S01486
     C**  Read in DTAARA/RUNDAT to get multibranching indicator           S01486
     C*                                                                   S01486
     C           *NAMVAR   DEFN           RUNDAT                          S01486
     C                     IN   RUNDAT                                    S01486
     C**
     C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.*****************   S01486
     C***********          MOVEL'01      'ZTABKY 12                       S01486
     C***********          MOVE '  10'    ZTABKY                          S01486
     C***********                                                         S01486
     C***********ZTABKY    CHAINTABLEIC              99    ON NOT THERE   S01486
     C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01486
     C                     CALL 'AOBANKR0'                                S01486
     C                     PARM *BLANKS   P@RTCD  7                       S01486
     C                     PARM '*FIRST'  P@OPTN  7                       S01486
     C           SDBANK    PARM SDBANK    DSFDY                           S01486
     C**
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C***********DATF      COMP 'M'                      98MMDDYY, 98 ON  S01486
     C           BJDFIN    IFEQ 'M'                                       S01486
     C                     MOVE '1'       *IN98                           S01486
     C                     END                                            S01486
     C                     MOVE BJMRDT    DDRUNA  7                       S01486
     C**
     C                     ENDSR
     C**
     C**
     C********************************************************************
     O**
     O**  WORKSTATION OUTPUT
     O**
     O***PM2081DDE        71                                              S01486
     OPM2081DFE        71                                                 S01486
     O                                   K8 'PM2081F1'
     O                         *IN29      1
     O***********                         3 'SG'                          S01486
     O***********              MTIME     11 '  .  .  '                    S01486
     O***********              WSID      14                               S01486
     O***********              CRNM      34                               S01486
     O***********              CNUML     40                               S01486
     O***********              LNRF      46                               S01486
     O***********              ACTDY     53                               S01486
     O***********              BRCD      56                               S01486
     O***********            61CPAM      74 ' ,   ,   ,   , 0 -'          S01486
     O***********            62CPAM      74 '   ,   ,   , 0 . -'          S01486
     O***********            63CPAM      74 '  ,   ,   , 0 .  -'          S01486
     O***********            64CPAM      74 ' ,   ,   , 0 .   -'          S01486
     O***********              CCYL      77                               S01486
     O***********            61INOUT     95 ' ,   ,   ,   , 0 -'          S01486
     O***********            62INOUT     95 '   ,   ,   , 0 . -'          S01486
     O***********            63INOUT     95 '  ,   ,   , 0 .  -'          S01486
     O***********            64INOUT     95 ' ,   ,   , 0 .   -'          S01486
     O***********            61RAMT     111 '    ,   ,   , 0 '            S01486
     O***********            62RAMT     111 '      ,   , 0 . '            S01486
     O***********            63RAMT     111 '     ,   , 0 .  '            S01486
     O***********            64RAMT     111 '    ,   , 0 .   '            S01486
     O***********              RFRQ     112                               S01486
     O***********           N22RDYN     114                               S01486
     O***********              NRPDA    121                               S01486
     O***********              REPT     122                               S01486
     O***********              IPFR     124                               S01486
     O***********           N23IFDY     126                               S01486
     O***********              NIDTA    133                               S01486
     O***********              CAPI     136                               S01486
     O***********              MDATA    143                               S01486
     O***********            61PWOD     159 '    ,   ,   , 0 '            S01486
     O***********            62PWOD     159 '      ,   , 0 . '            S01486
     O***********            63PWOD     159 '     ,   , 0 .  '            S01486
     O***********            64PWOD     159 '    ,   , 0 .   '            S01486
     O***********            61IWOD     175 '    ,   ,   , 0 '            S01486
     O***********            62IWOD     175 '      ,   , 0 . '            S01486
     O***********            63IWOD     175 '     ,   , 0 .  '            S01486
     O***********            64IWOD     175 '    ,   , 0 .   '            S01486
     O***********            61WTWD     191 '    ,   ,   , 0 '            S01486
     O***********            62WTWD     191 '      ,   , 0 . '            S01486
     O***********            63WTWD     191 '     ,   , 0 .  '            S01486
     O***********            64WTWD     191 '    ,   , 0 .   '            S01486
     O***********      72               208 'Original loan nbr'           S01486
     O***********      73               208 'Original borrower'           S01486
     O***********      72      OLNO     214                               S01486
     O***********      73      OLNO     214                               S01486
     O                         USID      11                               S01486
     O                                   13 'SG'                          S01486
     O                         DDRUNA    20                               S01486
     O                         WSID      30                               S01486
     O                         BBCRNM    50                               S01486
     O                         CNUML     56                               S01486
     O                         LNRF      62                               S01486
     O                         ACTDY     69                               S01486
     O                         BRCA      72                               S01486
     O                       61CPAM      90 ' ,   ,   ,   , 0 -'          S01486
     O                       62CPAM      90 '   ,   ,   , 0 . -'          S01486
     O                       63CPAM      90 '  ,   ,   , 0 .  -'          S01486
     O                       64CPAM      90 ' ,   ,   , 0 .   -'          S01486
     O                         CCYL      93                               S01486
     O                       61INOUT    111 ' ,   ,   ,   , 0 -'          S01486
     O                       62INOUT    111 '   ,   ,   , 0 . -'          S01486
     O                       63INOUT    111 '  ,   ,   , 0 .  -'          S01486
     O                       64INOUT    111 ' ,   ,   , 0 .   -'          S01486
     O                       61RAMT     127 '    ,   ,   , 0 '            S01486
     O                       62RAMT     127 '      ,   , 0 . '            S01486
     O                       63RAMT     127 '     ,   , 0 .  '            S01486
     O                       64RAMT     127 '    ,   , 0 .   '            S01486
     O                         RFRQ     128                               S01486
     O                      N22RDYN     130                               S01486
     O                         NRPDA    137                               S01486
     O                         REPT     138                               S01486
     O                         IPFR     140                               S01486
     O                      N23IFDY     142                               S01486
     O                         NIDTA    149                               S01486
     O                         CAPI     152                               S01486
     O                         MDATA    159                               S01486
     O                       61PWOD     175 '    ,   ,   , 0 '            S01486
     O                       62PWOD     175 '      ,   , 0 . '            S01486
     O                       63PWOD     175 '     ,   , 0 .  '            S01486
     O                       64PWOD     175 '    ,   , 0 .   '            S01486
     O                       61IWOD     191 '    ,   ,   , 0 '            S01486
     O                       62IWOD     191 '      ,   , 0 . '            S01486
     O                       63IWOD     191 '     ,   , 0 .  '            S01486
     O                       64IWOD     191 '    ,   , 0 .   '            S01486
     O                       61WTWD     207 '    ,   ,   , 0 '            S01486
     O                       62WTWD     207 '      ,   , 0 . '            S01486
     O                       63WTWD     207 '     ,   , 0 .  '            S01486
     O                       64WTWD     207 '    ,   , 0 .   '            S01486
     O                 72               224 'Original loan nbr'           S01486
     O                 73               224 'Original borrower'           S01486
     O                 72      OLNO     230                               S01486
     O                 73      OLNO     230                               S01486
     O**
     O**   ACTIVITY DETAIL
     O**
     O        E        70
     O                                   K8 'PM2081F2'
     O                                    2 'SG'
     O                         DUDAT      9
     O                         NARO      39
     O                   N65 61AMTO      58 ' ,   ,   ,   , 0 -'
     O                   N65 62AMTO      58 '   ,   ,   , 0 . -'
     O                   N65 63AMTO      58 '  ,   ,   , 0 .  -'
     O                   N65 64AMTO      58 ' ,   ,   , 0 .   -'
     O                   N66 65SPO       58 '  0 .       '
     O                         CODE      59
     O        D        40N39
     O                                   K8 'PM2081F3'
     O                         *IN44      1
     O                         *IN45      2
     O                         *IN41      3
     O                         *IN42      4
     O                         *IN43      5
     O***********                         7 'SF'                          S01486
     O***********              MTIME     15 '  .  .  '                    S01486
     O***********              WSID      18                               S01486
     O***********              ERMSG     61                               S01486
     O***********              CMSG     137                               S01486
     O***********              LNIN     143                               S01486
     O***********              DTIN     149                               S01486
     O***********              CDIN     150                               S01486
     O                         USID      15                               S01486
     O                                   17 'SF'                          S01486
     O                         DDRUNA    24                               S01486
     O                         WSID      34                               S01486
     O                         ERMSG    112                               S01486
     O                         CMSG     153                               S01486
     O                         LNIN     159                               S01486
     O                         DTIN     165                               S01486
     O                         CDIN     166                               S01486
     O**
     O**   MESSAGE LINES AND INPUT FIELDS
     O**
     O        D       N40N39 01
     O       OR       N40N39 05
     O                                   K8 'PM2081F4'
     O                         *IN31      1
     O                         *IN45      2
     O                                    4 'SG'
     O                         ERMSG     47
     O                         CMSG     123
**  CPY@
(c) Finastra International Limited 2001
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**    MSG ARRAY OF MESSAGES
LOAN REFERENCE INVALID                     1
ACTIVITY DATE FROM INVALID                 2
CODE INVALID                               3
CODE/DATE COMBINATION INVALID              4
INVALID COMMAND KEY                        5
                               * COMPLETE *6
  Rollup next screen,Rolldown first screen,7
  Rollup next screen,                      8
  Rolldown first screen,                   9
PRESS ENTER TO CONTINUE                    10
USER NOT AUTHORISED TO ANY BOOKING BRANCH  11                             S01486
USER NOT AUTHORISED TO THE BOOKING BRANCH  12                             S01486
**   NARR   ARRAY OF NARRATIVES
BASE RATE CODE CHANGE          1
BASE RATE CHANGE               2
INTEREST PAYMENT               3
INTEREST CAPITALISED           4
MATURITY - PRINCIPAL           5
MATURITY - INTEREST            6
MATURITY - WITHHOLDING TAX     7
MANUAL INTEREST ADJUSTMENT     8
MANUAL REPAYMENT - PRINCIPAL   9
MANUAL REPAYMENT -WITHHOLD TAX10
MANUAL REPAYMENT - FEE        11
MANUAL REPAYMENT - INTEREST   12
PAST DUE - TOTAL              13
PRINCIPAL INCREASE            14
REPAYMENT - PRINCIPAL         15
REPAYMENT - INTEREST          16
REPAYMENT - WITHHOLDING TAX   17
REPAYMENT - TOTAL             18
ROLLOVER - BASE RATE          19
ROLLOVER - RATE               20
ROLLOVER - SPREAD - ADD       21
ROLLOVER - SPREAD - SUBTRACT  22
ROLLOVER - SPREAD - PERCENTAGE23
STOP ACCRUALS                 24
START ACCRUALS                25
SPREAD/RATE CHANGE            26   WAS SPREAD CHANGE
START - PRINCIPAL             27
START - BASE RATE             28
START - RATE                  29
START - SPREAD - ADD          30
START - SPREAD - SUBTRACT     31
START - SPREAD - PERCENTAGE   32
MATURITY -INTEREST CAPITALISED33
MATURITY - FACE VALUE         34
START - FACE VALUE            35
START - PREMIUM               36
START - DISCOUNT              37
WITHHOLDING TAX AMOUNT        38
** @YD  USED BY SR. ZDATE9 - YEARS, IN DAYS, CUMULATIVE IN 4 YEAR SPAN
00366007310109601461
** @MD  USED BY SR. ZDATE9 - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
00000000310005900090001200015100181002120024300273003040033400365
