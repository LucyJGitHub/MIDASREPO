     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas PM Port valn statement position details')        *
     H***********                                                         076624
     H*         - Change H-specs to allow Debug                       *   076624
     F*****************************************************************
     F*                                                               *
     F*  Midas - Portfolio Management                                 *
     F*                                                               *
     F*  PM9949 - PORTFOLIO VALUATION STATEMENT:                      *
     F*           INSTRUMENT BREAKDOWN                                *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CLE148             Date 23Jul12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSE071             Date 19Jul05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 182961             Date 21Apr01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 CSD006             Date 17May01               *
      * Midas DBA 3.02 -----------------------------------------------*
      *                 167710             Date 22Sep99               *
      *                 112920             DATE 14APR97               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 101118             DATE 27MAR96               *
     F*                 099985             DATE 26FEB96               *
     F*                 097944             DATE 22FEB96               *
     F*                 091190             DATE 31JUL95               *
     F*                 CPM005             DATE 17JUL96               *
     F*                 CFF004             DATE 11SEP96               *
     F*                 102681             DATE 03MAY96               *
     F*                 076624             DATE 21AUG96               *
     F*                 063850             DATE 21AUG96               *
     F*                 077457             DATE 01DEC95               *
     F*                 076371             DATE 01DEC95               *
     F*                 S71062             DATE 01DEC95               *
     F*                 065115             DATE 22NOV95               *
     F*                 063048             DATE 22NOV95               *
     F*                 CPM004             DATE 08FEB96               *
     F*                 S01486             DATE 02SEP94               *
     F*                 062355             DATE 22OCT93               *
     F*                 062295             DATE 18OCT93               *
     F*                 061190             DATE 24SEP93               *
     F*                 038233             DATE 09JUL93               *
     F*                 056459  CH         DATE 25JUN93               *
     F*                 056552  LJ         DATE 16JUN93               *
     F*                 056839  LJ         DATE 16JUN93               *
     F*                 48007              DATE 03NOV92               *
     F*                 47863              DATE 27NOV92               *
     F*                 47719              DATE 24NOV92               *
     F*                 46081              DATE 23OCT92               *
     F*                 S01313             DATE 11JUN92               *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE148 - Alpha Loan Reference (Recompile)                    *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSE071 - Multiple Holidays Re Securities (recompile)         *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  182961 - Database error occurred due to a blank key field    *
      *           (Instrument Type).  The default Instrument type in  *
      *           PF/SDPORTPD is taken if a blank instrument type is  *
      *           encountered.                                        *
      *  CSD006 - Use DSSDY in call to AOCURRPD.                      *
     F*  167710 - Fields Folio Price and Market price too small.      *
     F*           Lenghts increased in PM9950P1.                      *
     F*  112920 - Total not cleared if FX mixed with other module     *
     F*  102681 - Correction to FF/PM interface                       *
     F*           Group Total on Valuation Statement incorrect        *
     F*  101118 - Group total wrong. Chain on PMASLIPP must be done   *
     F*           with the current position       : FEPOTY = 'C '     *
     F*           with the future opened position : FEPOTY = 'FO'     *
     F*           with the future closed position : FEPOTY = 'FC'     *
     F*  099985 - COMPLETE 97944 - WHEN READ ON PMASLIL0, CHECK IF    *
     F*           SAME CUSTOMER, INSTRUMENT SEQUENCE, PORTFOLIO REF., *
     F*           POSITION TYPE AND TOTALS TYPE                       *
     F*  097944 - WHEN PRINT OF THE GROUP TOTAL, THE FORWARD OPEN     *
     F*           POSITION MUST BE INCLUDED IN THESE TOTALS           *
     F*  091190 - CHECK PROBLEM OF OVERFLOW                           *
     F*  CPM005 - Private Banking Phase 2                             *
     F*           Focus Group Changes upgraded to DBA                 *
     F*           PBFG/3 - DISPLAY UNREALISED P&L ON FORWARD SE TRADES*
     F*           PBFG/5 - INSTRUMENT ASSET/LIABILITY SPLIT           *
     F*  CFF004 - Increase in size of Price Fields,(Recompiled Only)  *
     F*  076624 - Field percentage too small  (can be > 999)          *
     F*         - Change H-specs to allow Debug                       *
     F*  063850 - Recompile program due to modifications in PM9950P1  *
     F*           (record format P952DET3)                            *
     F*  077457 - Corrections to FF/PM interface                      *
     F*  076371 - Amount unsigned and correct market value            *
     F*  S71062 - FF/PM Interface - PM Changes                        *
     F*  065115 - EDIT ACCOUNT IF OTHER NOMINAL ACCOUNT IS NOT EQUAL  *
     F*           TO ZERO                                             *
     F*  063048 - OUTPUT GROUP TOTAL FOR FX ALSO                      *
     F*  CPM004 - Bank Portfolios                                     *
     F*  S01486 - Private Banking upgrade to Release 10               *
     F*  062355 - OUTPUT PORTFOLIO TOTALS WITH DECIMALS               *
     F*  062295 - EDIT MARKET VALUES & ACCRUED INTEREST WITH DECIMALS *
     F*  061190 - ENSURE ALL NOMINAL AMOUNTS EDITED WITH DECIMALS     *
     F*  038233 - DECIMAL QUANTITY NOT PRINTED.                       *
     F*  056459 - DISPLAY OTHER POSITION ON STATEMENT                 *
     F*  056552 - VALUATION STATEMENT OUTPUT NARRATIVES DETAILS       *
     F*  056839 - TEXT LINE AMENDMENT FOR ACCRUED INTEREST            *
     F*           AND NARRATIVE DETAILS                               *
     F*  48007  - DEAL TYPE 'TI' ALSO MM LOAN                         *
     F*  47863  - OUTPUT MARKET VALUE & ACCRUED INTEREST USING        *
     F*           AMOUNTS ON FILE RATHER THAN DOING CONVERSION        *
     F*  47719  - CORRECT CONVERSION OF AMOUNTS BETWEEN CURRENCIES    *
     F*  47617  - MARK 'FORWARD' DEALS                                *
     F*  S01313 - REWRITTEN FOR PORTFOLIO PERFORMANCE                 *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F**  C R E A T I O N     P A R A M E T E R S                     *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/EJECT
     F*****************************************************************
     F*
     F**      FILE DEFINITIONS
     F**     ------------------
     F*
     F*****CURRENCIES*FILE.*PREFIX*-*A6***********************************S01486
     F***SDCURRL0IF**E           K        DISK         KINFSR *PSSR       S01486
     F***********                                                   S01313S01486
     F*****CUSTOMERS*FILE.*PREFIX*-*BB******************************S01313S01486
     F***SDCUSTL0IF  E           K        DISK         KINFSR *PSSR S01313S01486
     F***********                                                         S01486
     F**   PM PORTFOLIO TOTALS. PREFIX - QC
     F***PMPOTTPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMPOTTPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*
     F**   PM VALUATION GROUP DETAILS. PREFIX - PC
     F***PMVLGDPPIF**E           K        DISK         KINFSR *PSSR       S01486
     FPMVLGDPDIF  E           K        DISK         KINFSR *PSSR          S01486
     F*
     F*****INSTRUMENT*TYPES.*PREFIX*-*PD**********************************S01486
     F***SDPLINPDIF**E           K        DISK         KINFSR *PSSR       S01486
     F***********                                                         S01486
     FSDPORTPDIF  E                    DISK         KINFSR *PSSR          182961
     F**   Audit Control                                                  S01486
     FPM9952AUO   E                    PRINTER      KINFSR *PSSR      UC  S01486
     F                                              KINFDS SPOOLU         S01486
     F**   TOTAL COMMITMENT LINES AUDIT LIST PRINTER FILE.
     FPM9950P1O   E             21     PRINTER      KINFDS ERF1DS     UC
     F                                              KINFSR *PSSR
     F*
     F**   PORTFOLIO HOLDINGDS BY VALUATION GROUP. PREFIX - QF
     FPMHDVNLLIF  E           K        DISK         KINFSR *PSSR
     F**   SECURITY DESCRIPTION
     FSECTY   IF  E           K        DISK         KINFSR *PSSR
     F*
     F**   Instrument type                                                S71062
     FINTYP   IF  E           K        DISK                               S71062
     F                                              KINFSR *PSSR          S71062
     F**   PORTFOLIO ASSET/LIABILITY SPLIT                                CPM005
     FPMASLIL1IF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     FPMASLIL0IF  E           K        DISK                               CPM005
     F                                              KINFSR *PSSR          CPM005
     F            PMASLID0                          KRENAMEPMASLID3       CPM005
     F/COPY WNCPYSRC,PM9952F001
     F*****************************************************************
     F/EJECT
     F*****************************************************************
     F**                                                              *
     F** ID F  C  H  L    FUNCTION OF INDICATORS                      *
     F**                 ------------------------                     *
     F**   21 - OVERFLOW INDICATOR ON PRINTER FILE                    *
     F**      22 - FIRST RECORD READ INDICATOR                        *
     F**      23 - PORTFOLIO CURRENCY HAS NO DECIMAL PLACES           *
     F**      24 - PORTFOLIO CURRENCY HAS 1 DECIMAL PLACE             *
     F**      25 - PORTFOLIO CURRENCY HAS 2 DECIMAL PLACES            *
     F**      26 - PORTFOLIO CURRENCY HAS 3 DECIMAL PLACES            *
     F**      27 - 'PLEDGED' TEXT WRITTEN ON REPORT                   *
     F**      28 - HOLDING PROCESSED INDICATOR                        *
     F**      29 - DO NOT OUTPUT ACCRUED INTEREST DETAILS             *
     F**      30 - CONDITION OUTPUT OF ACCRUED INTEREST DETAILS       *
     F**      31 - CONDITION OUTPUT OF PERCENTAGE ON MARKET VALUE     *
     F**                                                              *
     F********60*-*CHAIN*FAIL*ON*SDCURRL0*********************************S01486
     F********61*-*CHAIN*FAIL*ON*PMPOTTPP*********************************S01486
     F**      61 - CHAIN FAIL ON PMPOTTPD                             *   S01486
     F**      62 - READ FAIL ON PMHDVNLL                              *
     F**      63*-*CHAIN FAIL ON PMVLGDPD                             *   S01486
     F********63*-*CHAIN*FAIL*ON*PMVLGDPP*********************************S01486
     F********64*-*CHAIN*FAIL*ON*SDPLINPD*********************************S01486
     F**      65 - READ PMASLIL1                                      *   CPM005
     F**                                                              *
     F*****************************************************************
     E/EJECT
     E*****************************************************************
     E*
     E**   ARRAY FOR COPYRIGHT
     E                    CPY@    1   1 80
     E*                                                                   S71062
     E**   Array for standard subroutines FFPRCS                          S71062
      /COPY ZSRSRC,FFPRCSZ2                                               S71062
     E*
     E**   ARRAY FOR STANDARD SUBROUTINE ZSEDIT
      /COPY ZSRSRC,ZSEDITZ1
     E*
     E**   ARRAY FOR STANDARD SUBROUTINE ZEDIT
      /COPY ZSRSRC,ZEDITZ1
     E*
     E** ARRAY USED IN CURRENCY AMOUNT CONVERSION
      /COPY ZSRSRC,ZPOWERZ1
     E*
     E** ARRAY USED IN DATE CONVERSION
      /COPY ZSRSRC,ZDATE2Z1
     E*
     E** ARRAY USED TO COUNT CHARACTERS IN NARRATIVE
     E                    AR1        20  1
     E*
     E** ARRAY USED TO OUTPUT UNDERLINE FOR NARRATIVE
     E                    AR2        20  1
     E*
     E** ARRAY USED TO OUTPUT INSTRUMENT TOTALS NARRATIVE
     E                    AR3        43  1
     E*
     E*****************************************************************
     I/EJECT
     I*****************************************************************
     I*                                                                   CPM005
     I** RENAME FIELDS                                                    CPM005
     IPMASLID3                                                            CPM005
     I              FECNUM                          F3CNUM                CPM005
     I              FEPTFR                          F3PTFR                CPM005
     I              FEPOTY                          F3POTY                CPM005
     I              FETOTT                          F3TOTT                CPM005
     I              FEDGRC                          F3DGRC                CPM005
     I              FEDGRS                          F3DGRS                CPM005
     I              FEINSC                          F3INSC                CPM005
     I              FEINSS                          F3INSS                CPM005
     I              FEASSV                          F3ASSV                CPM005
     I              FELIAV                          F3LIAV                CPM005
     I*
     I** DATA STRUCTURES FOR COPYRIGHT
     ICPYR@       DS
     I                                        1  80 CPY@
     I                                        1  20 CPY@##
     I*
     I*****************************************************************
     I/EJECT
     I*****************************************************************
     I*
     I** Data structures for standard subroutines FFPRCS                  S71062
      /COPY ZSRSRC,FFSRDSZ1                                               S71062
      /COPY ZSRSRC,FFPRCSZ3                                               S71062
     I** DATA STRUCTURES FOR STANDARD SUBROUTINE ZSEDIT
      /COPY ZSRSRC,ZSEDITZ2
     I*
     I*****************************************************************
     I/EJECT
     I*****************************************************************
     I*
     I** DATA STRUCTURE FOR KEY LIST WWKEY2
     IWWKY2       DS
     I                                        1   5 WWKYL2
     I                                        1   3 WWVALG
     I                                        4   5 WWLNGI
     I*
     I** DATA STRUCTURE FOR RE HOLDINGS INSTRUMENT DESCRIPTION 3
     IWWDTSR      DS
     I**********                              1  20 QFTXT2                                    CGL029
     I                                        1  26 QFTXT2                                    CGL029
     I                                        1  11 WWDTS1
     I**********                             12  15 WWACCD                                    CGL029
     I**********                             16  16 WWDTS2                                    CGL029
     I**********                             17  18 WWACSQ                                    CGL029
     I**********                             19  20 WWDTS3                                    CGL029
     I                                       12  21 WWACCD                                    CGL029
     I                                       22  22 WWDTS2                                    CGL029
     I                                       23  24 WWACSQ                                    CGL029
     I                                       25  26 WWDTS3                                    CGL029
     I*
     I** DATA STRUCTURE USED TO CHANGE YIELD AMOUNT TO REPORT FORMAT
     IWWDATA      DS
     I                                        1  16 ZFIELD
     I                                        1   6 WWVAR1
     I                                        7  11 WWYLDS
     I                                       12  120WWROUN
     I                                       13  130WWHADJ
     I                                       14  16 WWVAR2
     I************                            5  12 ZFIELW                167710
     I                                        2  15 ZFIELW                167710
     I                                        4  12 ZFIELZ
     I*
     I**   PROGRAM STATUS DATA STRUCTURE
     IPSDS       SDS
     I                                      244 253 JOB
     I                                      254 263 USER
     I*
     I**   FILE INFORMATION DATA STRUCTURE
     IERF1DS      DS
     I**   FOR OVERFLOW
     I                                    B 367 3680LINE
     I*                                                                   S01486
     ISPOOLU      DS                                                      S01486
     I**    SPOOL FILE INFORMATION DATA STRUCTURE                         S01486
     I                                       83  92 SFILEU                S01486
     I                                    B 123 1240SFNUMU                S01486
     I*
     I**   LOCAL DATA AREA
     ILDA         DS                            256
     I                                      132 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*                                                                   S71062
     I** Data structure to print nbr of open contracts, P or S            S71062
     I            DS                                                      S71062
     I                                        1   5 R2NOQT                S71062
     I                                        1   1 WWPUSE                S71062
     I                                        2   4 WWNBOC                S71062
     I                                        5   5 WWSIGN                S71062
     I*                                                                   S71062
     I** Data structure to print inst. CCY,Sett.Date, AMER. or EURP.      S71062
     I            DS                                                      S71062
     I                                        1  40 R2DES5                S71062
     I                                        1   3 WWICCY                S71062
     I                                       10  16 WWSETD                S71062
     I                                       33  40 WWAMEU                S71062
     I*                                                                   S71062
     I** Data structure to print settlement date                          S71062
     I            DS                                                      S71062
     I                                        1   60WKSETD                S71062
     I                                        1   20WWMONT                S71062
     I                                        3   40WWDDAY                S71062
     I                                        5   60WWYEAR                S71062
     I            DS                                                      S71062
     I                                        1   7 WWSDAT                S71062
     I                                        1   2 WWSDAY                S71062
     I                                        3   5 WWSMTH                S71062
     I                                        6   7 WWSYER                S71062
     I*                                                                   S71062
     I** Data structure to print narrative with F&O instrument            S71062
     I            DS                                                      S71062
     I                                        1  40 R2TRNB                S71062
     I                                        1   5 QFFOIS                S71062
     I                                        6  40 WWNAR2                S71062
     I                                        7  22 WWCTGA                S71062
     I                                       24  33 WWSTRK                S71062
     I            DS                                                      S71062
     I**********                              1  20 WWTXT2                             S71062 CGL029
     I                                        1  26 WWTXT2                                    CGL029
     I                                        5   9 WWMTHQ                S71062
     I                                       11  20 WWPCST                S71062
     I*                                                                   S71062
     I** Data structure to print instrument currency                      S71062
     I            DS                                                      S71062
     I                                        1  20 R2DES4                S71062
     I                                        6   8 WICCY2                S71062
     I*                                                                   CPM005
     I** DATA STRUCTURE FOR DATABASE ERROR                                CPM005
     IWWERRO      DS                                                      CPM005
     I**********                              1   60K2CNUM                             CPM005 CSD027
     I                                        1   6 K2CNUM                                    CSD027
     I                                        7  10 K2PTFR                CPM005
     I                                       11  12 K2POTY                CPM005
     I                                       13  15 K2DGRC                CPM005
     I                                       16  170K2DGRS                CPM005
     I                                       18  18 K2TOTT                CPM005
     I                                       19  200K2INSS                CPM005
     I*
     I** DS USED TO PASS PARAMETERS TO CALLED PROGRAMS
     I***WWPARM****E*DSPM095XPP                                           S01486
     IWWPARM    E DSPM095XPD                                              S01486
     I*                                                                   S01486
     ISDPORT    E DSSDPORTPD                                              CPM004
     I** DUMMY RECORD FORMAT FOR PM ICD DETAILS                           CPM004
     I*                                                                   CPM004
     ISDCURR    E DSSDCURRPD                                              S01486
     I** DUMMY RECORD FORMAT FOR CURRENCY DETAILS                         S01486
     I*                                                                   S01486
     ISDCUST    E DSSDCUSTPD                                              S01486
     I** DUMMY RECORD FORMAT FOR CUSTOMER DETAILS                         S01486
     I*                                                                   S01486
     ISDPLIN    E DSSDPLINPD                                              S01486
     I** DUMMY RECORD FORMAT FOR INSTRUMENT TYPE DETAILS                  S01486
     I*                                                                   S01486
     I/COPY WNCPYSRC,PM9952I001
     IDSFDY     E DSDSFDY                                                 S01486
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01486
     I*                                                                   S01486
     IDSSDY     E DSDSSDY                                                 S01486
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01486
     I*                                                                   S01486
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * INDEX OF SUBROUTINES                                             *
      * MAIN     - MAIN PROCESSING                                       *
      * #INIT    - INITIAL PROCESSING                                    *
      * #P01     - PROCESS HOLDINGS                                      *
      * #P02     - PRODUCE VALUATION GROUP HEADING                       *
      * #P03     - PRODUCE INSTRUMENT TOTALS                             *
      * #P04     - PRODUCE INSTRUMENT TYPE HEADINGS                      *
      * #P05     - ACCESS CURRENCY DETAILS                               *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P08     - PROCESS SE NON INTEREST-BEARING HOLDINGS              *
      * #P09     - PROCESS FF HOLDINGS                                   *
      * #P10     - PROCESS MM DEALS                                      *
      * #P11     - PROCESS FX DEALS AND FRA/IRS                          *
      * #P12     - PROCESS LE HOLDINGS                                   *
      * #P13     - PROCESS RE HOLDINGS                                   *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      * #P15     - PRODUCE RE ACCRUED INTEREST DETAILS                   *
      * #P16     - PRODUCE TOTALS LINE                                   *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * #Y02     - CONVERT YIELD AMOUNTS TO FORMAT REQUIRED ON REPORT    *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * ZCCYXR   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      * #GRTO    - OUTPUT ASSET & LIABILITY GROUP TOTAL                  *CPM005
      *                                                                  *
      * EXTERNAL ROUTINES CALLED                                         *
      * SUBR23R3 - MESSAGE RETRIEVING SUBROUTINE                         *
      *                                                                  *
      ********************************************************************
     C/EJECT
     C*
     C                     MOVEACPY@      CPY2@  80
     C*
     C           *ENTRY    PLIST
     C                     PARM           WWPARM
     C**
     C** SET UP PARAMETER TO FORM OUTPUT LINE
     C           ZA1311    PLIST
     C                     PARM           MSGID   7
     C                     PARM           MSGDT0 40
     C                     PARM           MSGDT1 40
     C                     PARM           MSGDT2 40
     C                     PARM           MSGDT3 40
     C                     PARM           MSGDT4 40
     C                     PARM           MSGDT5 40
     C                     PARM           MSGDT6 40
     C                     PARM           MSGDT7 40
     C                     PARM           MSGDT8 40
     C                     PARM           MSGDT9 40
     C                     PARM           RESULT200
     C*
     C**   PARAMETERS OUTPUT FROM PROGRAM
     C**   ------------------------------
     C*
     C**   VARMSG - 7A MESSAGE ID
     C**   TEXT   - 40A OUTPUT CONTAINING TEXT RETURNED
     C**   LEVEL  - 1N SET TO DEFAULT OF '3'
     C**   RETCD  - 1N NEVER USED
     C**   TXTL   - DEFINES LENGTH OF TEXT TO BE RETURNED (DEFAULT=40)
     C*
     C           SUBR23    PLIST
     C                     PARM           VARMSG  7
     C                     PARM           TEXT   40
     C                     PARM           LEVEL   10
     C                     PARM           RETCD   10
     C                     PARM           TXTL    40
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C**   KEY LISTS USED IN PROGRAM                                  *
     C**   -------------------------                                  *
     C*                                                               *
     C**   KEY LIST FOR 'PMHDVNLL'                                    *
     C           WWKEY1    KLIST                                      *
     C                     KFLD           WWCNUM                      *
     C                     KFLD           WWPTFF                      *
     C*                                                               *
     C*****KEY*LIST*FOR*'PMVLGDPP'****************************************S01486
     C**   KEY LIST FOR 'PMVLGDPD'                                    *   S01486
     C           WWKEY2    KLIST                                      *
     C                     KFLD           WWVALG                      *
     C                     KFLD           WWLANG                      *
     C***********                                                     *   S01486
     C*****KEY*LIST*FOR*'INVTPDX0'****************************************S01486
     C***********INVKEY    KLIST                                      *   S01486
     C***********          KFLD           NMCY                        *   S01486
     C***********          KFLD           SITP                            S01486
      *                                                               *   CPM005
      **  KLIST FOR USE WITH PMASLIL1                                 *   CPM005
     C           PMASL1    KLIST                                      *   CPM005
     C**********           KFLD           K1CNUM  60                  *                CPM005 CSD027
     C                     KFLD           K1CNUM  6                   *                       CSD027
     C                     KFLD           K1PTFR  4                   *   CPM005
     C                     KFLD           K1POTY  2                   *   CPM005
      *                                                               *   CPM005
      **  KLIST FOR USE WITH PMASLIL0                                 *   CPM005
     C           PMASL0    KLIST                                      *   CPM005
     C**********           KFLD           K2CNUM  60                  *                CPM005 CSD027
     C                     KFLD           K2CNUM  6                   *                       CSD027
     C                     KFLD           K2PTFR  4                   *   CPM005
     C                     KFLD           K2POTY  2                   *   CPM005
     C                     KFLD           K2DGRS  20                  *   CPM005
     C                     KFLD           K2DGRC  3                   *   CPM005
     C                     KFLD           K2TOTT  1                   *   CPM005
     C/COPY WNCPYSRC,PM9952C001
     C*                                                               *
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**              START MAIN
     C**             -------------
     C*
     C**   INITIAL PROCESSING
     C                     EXSR #INIT
     C*
     C**   PROCESS HOLDINGS
     C                     EXSR #P01
     C*
     C**   PROCESS TOTAL OUTOUT
     C           LINE      IFGT 35                         B1
     C                     EXSR #TITLE
     C                     END                             E1
     C           *IN23     IFEQ '1'                          B1
     C                     MOVE WWCTOP    WWFLD0
     C                     Z-ADDWWFLD0    ZFLD15
     C                     ELSE                              X1
     C*
     C           *IN24     IFEQ '1'                          B2
     C                     MOVE WWCTOP    WWFLD1
     C                     Z-ADDWWFLD1    ZFLD15    H
     C                     ELSE                            X2
     C*
     C           *IN25     IFEQ '1'                        B3
     C                     MOVE WWCTOP    WWFLD2
     C                     Z-ADDWWFLD2    ZFLD15    H
     C                     ELSE                            X3
     C*
     C           *IN26     IFEQ '1'                        B4
     C                     MOVE WWCTOP    WWFLD3
     C                     Z-ADDWWFLD3    ZFLD15    H
     C                     END                             E4
     C*
     C                     END                             E3
     C*
     C                     END                             E2
     C*
     C                     END                             E1
     C*
     C                     Z-ADD0         ZDECS
     C*
     C                     Z-ADDWWPDEC    ZDECS                           62355
     C                     MOVE WWCTOP    ZFLD15                          62355
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R1TBAP
     C           *IN23     IFEQ '1'                        B1
     C                     MOVE QCPTAI    WWFLD0
     C                     Z-ADDWWFLD0    ZFLD15
     C                     ELSE                            X1
     C*
     C           *IN24     IFEQ '1'                        B2
     C                     MOVE QCPTAI    WWFLD1
     C                     Z-ADDWWFLD1    ZFLD15    H
     C                     ELSE                            X2
     C*
     C           *IN25     IFEQ '1'                        B3
     C                     MOVE QCPTAI    WWFLD2
     C                     Z-ADDWWFLD2    ZFLD15    H
     C                     ELSE                            X3
     C*
     C           *IN26     IFEQ '1'                        B4
     C                     MOVE QCPTAI    WWFLD3
     C                     Z-ADDWWFLD3    ZFLD15    H
     C                     END                             E4
     C*
     C                     END                             E3
     C*
     C                     END                             E2
     C*
     C                     END                             E1
     C*
     C                     Z-ADD0         ZDECS
     C                     Z-ADDWWPDEC    ZDECS                           62355
     C                     MOVE QCPTAI    ZFLD15                          62355
     C*
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R1TBAI
     C***********          MOVE R1TBAP    R2TBAP 18                       S01486
     C***********          MOVE R1TBAI    R2TBAI 18                       S01486
     C                     WRITEP952TOTT
     C*
     C**   END PROGRAM
     C                     CLOSEPM9950P1
     C                     RETRN
     C                     MOVE '1'       *INLR
     C*
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #INIT    - INITIAL PROCESSING                                    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * SUBR23R3 - MESSAGE RETRIEVING SUBROUTINE                         *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWVLGP   - VALUATION GROUP ON PREVIOUS RECORD ON PMHDVNLL        *
      * WWTVDI   - TRADE/VALUE DATE INDICATOR FROM PMHDVNLL              *
      * WWINST   - INSTRUMENT TYPE ON CURRENT RECORD ON PMHDVNLL         *
      * WWINSP   - INSTRUMENT TYPE ON PREVIOUS RECORD ON PMHDVNLL        *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WW1DEC   - NUMBER OF DECIMAL PLACES FOR CCY 1 ON PMHDVNLL        *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWTMP1   - USED IN CALCULATION OF PORTFOLIO TOTAL                *
      * WWTMP2   - USED IN CALCULATION OF PORTFOLIO TOTAL                *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWTINT   - TOTAL INSTRUMENT INTEREST                             *
      * WWINTT   - INSTRUMNET TOTAL                                      *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      * WWTMVP   - TOTAL MARKET VALUE IN PORTFOLIO CURRENCY              *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      * WWVALG   - VALUATION GROUP ON CURRENT RECORD ON PMHDVNLL         *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WWRTCD   - RETURN CODE PARAMETER                                 *
      * WWKEY1   - KEY FOR PMHDVNLL (PARAMETERS CNUM AND PORT. REF.)     *
      * WWTVPS   - TRADE/VALUE DATE PARAMETER                            *
      * WWMG16   - 'BUY' NARRATIVE FOR FX DEALS                          *
      * WWMG17   - 'SELL' NARRATIVE FOR FX DEALS                         *
      *                                                                  *
      ********************************************************************
     C*
     C           #INIT     BEGSR
     C*
     C**   INITIALISE DB ERROR FIELDS AND STORE PROGRAM NAME FOR
     C**   DB ERROR FIELD.
     C*
     C                     MOVE *BLANKS   WBFILE 10
     C                     MOVE *BLANKS   WBKEY  29
     C                     Z-ADD*ZEROS    WBASE   30
     C                     MOVEL'PM9952'  WBPGM  10
     C*
     C**   DEFINE WORK FIELDS
     C           *LIKE     DEFN QFVALG    WWVLGP
     C           *LIKE     DEFN QFTVDA    WWTVDI
     C           *LIKE     DEFN QFINNR    WWINST
     C           *LIKE     DEFN QFINNR    WWINSP
     C           *LIKE     DEFN A6SPRT    WWPSPR
     C           *LIKE     DEFN A6NBDP    WWPDEC
     C           *LIKE     DEFN A6NBDP    WWPDCS
     C           *LIKE     DEFN A6MDIN    WWPMDI
     C           *LIKE     DEFN A6SPRT    WW1SPR
     C           *LIKE     DEFN A6NBDP    WW1DEC
     C           *LIKE     DEFN A6MDIN    WW1MDI
     C*
     C**   INITIALISE WORK FIELDS
     C                     Z-ADD*ZEROS    WWPORT 150
     C                     Z-ADD*ZEROS    WWTMP1 150
     C                     Z-ADD*ZEROS    WWTMP2 150
     C                     Z-ADD*ZEROS    WWTIMV 150
     C                     Z-ADD*ZEROS    WWTINT 150
     C                     Z-ADD*ZEROS    WWINTT 150
     C                     Z-ADD*ZEROS    WWWORK 150
     C                     Z-ADD*ZEROS    WWMVPC 150
     C                     Z-ADD*ZEROS    WWTMVP 150
     C***********          Z-ADD*ZEROS    WWTIPC  41                      076624
     C                     Z-ADD*ZEROS    WWTIPC  51                      076624
     C*
     C/COPY WNCPYSRC,PM9952C002
     C                     MOVE WWCRNM    P1CRNM
     C/COPY WNCPYSRC,PM9952C003
     C                     MOVE WWPTFN    R2PTFN
     C                     MOVE WWCNUM    R1CNUM
     C                     MOVELWWACON    R1ACNM
     C                     MOVE WWAPHN    R1ACPH
     C*
     C**   INITIALISE ARRAY ELEMENTS
     C                     Z-ADD1         X       20
     C                     Z-ADD1         Y       20
     C*                                                                   CPM005
     C**   SET CALCULATION METHOD                                         CPM005
     C           WWPCAM    IFEQ 'N'                                       CPM005
     C                     MOVE *OFF      *IN01                           CPM005
     C                     ELSE                                           CPM005
     C                     MOVE *ON       *IN01                           CPM005
     C                     END                                            CPM005
     C*
     C**   SET UP DEFAULT PARAMETERS FOR STANDARD IBM SUBR. SUBR23R3
     C                     Z-ADD3         LEVEL
     C                     Z-ADD40        TXTL
     C*
     C** IF CHANGE OF LANGUAGE OBTAIN NEW TEXT
     C           WWLANG    IFNE WSLANG
     C                     MOVE WWLANG    WSLANG  2
     C*
     C**   SET UP OUTPUT NARRATIVES FROM MESSAGE FILE USING SUBR23R3
     C***********          MOVEL'PM95213' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      R2MG13 23                       S01486
     C***********                                                         S01486
     C***********          MOVEL'PM95216' VARMSG                          S01486
     C                     MOVEL'PM95457' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG16 18
     C*
     C***********          MOVEL'PM95217' VARMSG                          S01486
     C                     MOVEL'PM95458' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG17 18
     C*
     C***********          MOVEL'PM95218' VARMSG                          S01486
     C                     MOVEL'PM95438' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG18
     C*
     C***********          MOVEL'PM95219' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C*                    MOVELTEXT      R2MG19
     C***********                                                         S01486
     C***********          MOVEL'PM95220' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      R2MG20 23                       S01486
     C***********                                                         S01486
     C***********          MOVEL'PM95223' VARMSG                          S01486
     C                     MOVEL'PM95439' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG23
     C                     MOVELTEXT      R2MG24                          S01486
     C*
     C***********          MOVEL'PM95224' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      R2MG24                          S01486
     C***********                                                         S01486
     C***********          MOVEL'PM95225' VARMSG                          S01486
     C                     MOVEL'PM95440' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      R2MG25
     C*
     C***********          MOVEL'PM95226' VARMSG                          S01486
     C                     MOVEL'PM95454' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG26 15
     C*
     C***********          MOVEL'PM95227' VARMSG                          S01486
     C                     MOVEL'PM95459' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG27 18
     C*
     C***********          MOVEL'PM95228' VARMSG                          S01486
     C                     MOVEL'PM95460' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG28 18
     C*
     C***********          MOVEL'PM95229' VARMSG                          S01486
     C                     MOVEL'PM95461' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG29 18
     C*
     C***********          MOVEL'PM95230' VARMSG                          S01486
     C                     MOVEL'PM95462' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      WWMG30 18
      * GET MES. BALANCE/
     C***********          MOVEL'PMS5209' VARMSG                          S01486
     C                     MOVEL'PM95424' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5209 18
     C***********          MOVELTEXT      MB5209 18                       S01486
      * GET MES. PRICE
     C***********          MOVEL'PMS5210' VARMSG                          S01486
     C                     MOVEL'PM95425' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5210 15
     C                     MOVELTEXT      MI5210 15
     C***********          MOVELTEXT      MB5210 15                       S01486
     C***********          MOVELTEXT      MC5210 15                       S01486
      * GET MES. YIELD
     C***********          MOVEL'PMS5211' VARMSG                          S01486
     C                     MOVEL'PM95426' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5211 15
     C***********          MOVELTEXT      MB5211 15                       S01486
      * GET MES. FOREX-
     C***********          MOVEL'PMS5212' VARMSG                          S01486
     C                     MOVEL'PM95427' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5212 16
     C***********          MOVELTEXT      MB5212 16                       S01486
      * GET MES. MARKET VALUE
     C***********          MOVEL'PMS5213' VARMSG                          S01486
     C                     MOVEL'PM95428' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5213 22
     C***********          MOVELTEXT      MB5213 22                       S01486
      **GET*MES.*PORT.****************************************************S01486
     C***********          MOVEL'PMS5214' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      MS5214 15                       S01486
     C***********          MOVELTEXT      MB5214 15                       S01486
      * GET MES. NOMINAL/
     C***********          MOVEL'PMS5215' VARMSG                          S01486
     C                     MOVEL'PM95429' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5215 18
     C***********          MOVELTEXT      MB5215 18                       S01486
      * GET MES. RATE
     C***********          MOVEL'PMS5216' VARMSG                          S01486
     C                     MOVEL'PM95430' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5216 14
     C***********          MOVELTEXT      MB5216 14                       S01486
      * GET MES. ACCRUED INTEREST
     C***********          MOVEL'PMS5217' VARMSG                          S01486
     C                     MOVEL'PM95431' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5217 26
     C***********          MOVELTEXT      MB5217 26                       S01486
      * GET MES. QUANTITY
     C***********          MOVEL'PMS5218' VARMSG                          S01486
     C                     MOVEL'PM95432' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5218 18
     C***********          MOVELTEXT      MB5218 18                       S01486
      * GET MES. (BOOK VALUE)
     C***********          MOVEL'PMS5219' VARMSG                          S01486
     C                     MOVEL'PM95433' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5219 22
     C***********          MOVELTEXT      MB5219 22                       S01486
      * GET MES. (MARKET VALUE)
     C***********          MOVEL'PMS5220' VARMSG                          S01486
     C                     MOVEL'PM95434' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5220 24
     C***********          MOVELTEXT      MB5220 24                       S01486
      * GET MES. TOTAL UNREALIZED P/L
     C***********          MOVEL'PMS5221' VARMSG                          S01486
     C                     MOVEL'PM95436' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5221 30
     C***********          MOVELTEXT      MB5221 30                       S01486
      * GET MES. TOTAL REALIZED P/L
     C***********          MOVEL'PMS5222' VARMSG                          S01486
     C                     MOVEL'PM95437' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5222 28
     C***********          MOVELTEXT      MB5222 28                       S01486
      **GET*MES.*FORWARD*TRANSACTIONS*************************************S01486
     C***********          MOVEL'PMS5223' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      MS5223 30                       S01486
     C***********          MOVELTEXT      MB5223 30                       S01486
      * GET MES. CCY.
     C***********          MOVEL'PMS5224' VARMSG                          S01486
     C                     MOVEL'PM95441' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5224 14
     C                     MOVELTEXT      MI5224 14
     C***********          MOVELTEXT      MJ5224 14                       S01486
     C***********          MOVELTEXT      MB5224 14                       S01486
     C***********          MOVELTEXT      MC5224 14                       S01486
     C***********          MOVELTEXT      MD5224 14                       S01486
      * GET MES. DEAL
     C***********          MOVEL'PMS5225' VARMSG                          S01486
     C                     MOVEL'PM95442' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5225 14
     C***********          MOVELTEXT      MB5225 14                       S01486
      * GET MES. AMOUNT
     C***********          MOVEL'PMS5226' VARMSG                          S01486
     C                     MOVEL'PM95443' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5226 16
     C***********          MOVELTEXT      MB5226 16                       S01486
      * GET MES. DEAL DETAILS
     C***********          MOVEL'PMS5227' VARMSG                          S01486
     C                     MOVEL'PM95444' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5227 22
     C***********          MOVELTEXT      MB5227 22                       S01486
      * GET MES. DEAL NO.
     C***********          MOVEL'PMS5228' VARMSG                          S01486
     C                     MOVEL'PM92445' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5228 18
     C***********          MOVELTEXT      MB5228 18                       S01486
      * GET MES. MARKET
     C***********          MOVEL'PMS5229' VARMSG                          S01486
     C                     MOVEL'PM95446' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5229 16
     C***********          MOVELTEXT      MB5229 16                       S01486
      * GET MES. FOREX P/L
     C***********          MOVEL'PMS5230' VARMSG                          S01486
     C                     MOVEL'PM95447' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5230 19
     C                     MOVELTEXT      MI5230 19
     C***********          MOVELTEXT      MB5230 19                       S01486
     C***********          MOVELTEXT      MC5230 19                       S01486
      * GET MES. VALUE DATE
     C***********          MOVEL'PMS5231' VARMSG                          S01486
     C                     MOVEL'PM95448' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5231 20
     C***********          MOVELTEXT      MB5231 20                       S01486
      **GET*MES.*FX-RATE**************************************************S01486
     C***********          MOVEL'PMS5232' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      MS5232 17                       S01486
     C***********          MOVELTEXT      MB5232 17                       S01486
      **GET*MES.*IN*REF.**************************************************S01486
     C***********          MOVEL'PMS5233' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      MS5233 17                       S01486
     C***********          MOVELTEXT      MB5233 17                       S01486
      * GET MES. (DEAL DATE)
     C***********          MOVEL'PMS5234' VARMSG                          S01486
     C                     MOVEL'PM95450' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5234 21
     C***********          MOVELTEXT      MB5234 21                       S01486
      * GET MES. DEALT
     C***********          MOVEL'PMS5235' VARMSG                          S01486
     C                     MOVEL'PM95449' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5235 18
     C***********          MOVELTEXT      MB5235 18                       S01486
      **GET*MES.*FX*RATE**************************************************S01486
     C***********          MOVEL'PMS5236' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      MS5236 17                       S01486
     C***********          MOVELTEXT      MB5236 17                       S01486
      * GET MES. GROUP TOTAL
     C***********          MOVEL'PMS5237' VARMSG                          S01486
     C                     MOVEL'PM95435' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5237 23
     C***********          MOVELTEXT      MB5237 23                       S01486
     C* GET MES. ASSET GROUP TOTAL                                        CPM005
     C                     MOVEL'PM99627' VARMSG                          CPM005
     C                     CALL 'SUBR23R3'SUBR23                          CPM005
     C                     MOVELTEXT      MS9940 23                       CPM005
     C* GET MES. LIABILITY GROUP TOTAL                                    CPM005
     C                     MOVEL'PM99628' VARMSG                          CPM005
     C                     CALL 'SUBR23R3'SUBR23                          CPM005
     C                     MOVELTEXT      MS9941 23                       CPM005
      * GET MES. TOTAL ACCRUED INTEREST
     C***********          MOVEL'PMS5239' VARMSG                          S01486
     C                     MOVEL'PM95452' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      MS5239
     C***********          MOVELTEXT      MB5239                          S01486
      * GET MES. CLIENT:
     C***********          MOVEL'PMS5502' VARMSG                          S01486
     C                     MOVEL'PM95401' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      M95102
      * GET MES. REF.NO.
     C***********          MOVEL'PMS5505' VARMSG                          S01486
     C                     MOVEL'PM95407' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      M95104
      * GET MES. YOUR ADVISER:
     C***********          MOVEL'PMS5506' VARMSG                          S01486
     C                     MOVEL'PM95408' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      M95105
      **GET*MES.*INDUSTRY*************************************************S01486
     C***********          MOVEL'PMS4908' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      MS5508 26                       S01486
      **GET*MES.*TOTAL*AMOUNTS********************************************S01486
     C***********          MOVEL'PMS5509' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      MS5509 23                       S01486
      **GET*MES.*PORTFOLIO*SHARES*IN*%************************************S01486
     C***********          MOVEL'PMS5510' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      MS5510 31                       S01486
      **GET*MES.*TOTAL****************************************************S01486
     C***********          MOVEL'PMS5511' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      MS5511 25                       S01486
      **GET*MES.*AS*OF****************************************************S01486
     C***********          MOVEL'PMS5114' VARMSG                          S01486
     C***********          CALL 'SUBR23R3'SUBR23                          S01486
     C***********          MOVELTEXT      M95114 15                       S01486
      * GET MES. HOLD MAIL
     C***********          MOVEL'PMS5117' VARMSG                          S01486
     C                     MOVEL'PM95410' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      M95117 29
      * GET MES. INTERNAL USE
     C***********          MOVEL'PMS5120' VARMSG                          S01486
     C                     MOVEL'PM95411' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23
     C                     MOVELTEXT      M95120 29
      * GET MES. PLACED WITH CUSTOMER                                     S01313
     C***********          MOVEL'PM95240' VARMSG                    S01313S01486
     C                     MOVEL'PM95455' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23                          S01313
     C                     MOVELTEXT      WW5240 15                       S01313
      * GET MES. PLACED WITH CUSTOMER                                     S01313
     C***********          MOVEL'PM95241' VARMSG                    S01313S01486
     C                     MOVEL'PM95456' VARMSG                          S01486
     C                     CALL 'SUBR23R3'SUBR23                          S01313
     C                     MOVELTEXT      WW5241  4                       S01313
      * GET MES. 'OPEN'                                                   CPM005
     C                     MOVEL'PM99619' VARMSG                          CPM005
     C                     CALL 'SUBR23R3'SUBR23                          CPM005
     C                     MOVELTEXT      WW9619  6                       CPM005
      * GET MES. 'CLOSED'                                                 CPM005
     C                     MOVEL'PM99620' VARMSG                          CPM005
     C                     CALL 'SUBR23R3'SUBR23                          CPM005
     C                     MOVELTEXT      WW9620  6                       CPM005
     C                     END
     C*
     C** SET UP TEXT WHICH CHANGES DEPENDING UPON PARAMETERS PASSED
     C***********          MOVE 'PMS5203' MSGID                           S01486
     C                     MOVE 'PM95453' MSGID                           S01486
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELRESULT    P1REPT
      * GET MES. TOTAL VALUE
     C                     MOVE *BLANKS   MSGDT0
     C                     MOVELWWPTFN    MSGDT0
     C***********          MOVE 'PMS5238' MSGID                           S01486
     C                     MOVE 'PM95451' MSGID                           S01486
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELRESULT    MS5238
     C***********          MOVELRESULT    MB5238                          S01486
     C* HOLD MAIL TEXT
     C           WWHLDM    IFEQ 'H'
     C                     MOVELM95117    P1HOLD 29
     C                     ELSE
     C           WWHLDM    IFEQ 'A'
     C                     MOVELM95120    P1HOLD 29
     C                     ELSE
     C                     MOVE *BLANKS   P1HOLD
     C                     END
     C                     END
     C*
     C** FORMAT REFERENCE CURRENCY
     C                     MOVE *BLANKS   MSGDT0
     C                     MOVELWWPTCY    MSGDT0
     C***********          MOVE 'PMS5507' MSGID                           S01486
     C                     MOVE 'PM95409' MSGID                           S01486
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELRESULT    R1RCCY
     C                     MOVELWWPTCY    R2PCCY
     C***********          MOVELWWPTCY    C2PCCY                          S01486
     C*
     C** FORMAT PRINTED 'AS OF' INFORMATION
     C                     MOVE *BLANKS   MSGDT0
     C                     MOVELWWLXDT    MSGDT0
     C***********          MOVE 'PMS5114' MSGID                           S01486
     C                     MOVE 'PM95415' MSGID                           S01486
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELRESULT    P1PRDT
     C*
     C** FORMAT PRINTED PLACE (LUXEMBOURG) AND EVENT CONTROL DATE
     C                     MOVE *BLANKS   MSGDT0
     C                     MOVELWWBMSN    MSGDT0
     C                     MOVE *BLANKS   MSGDT1
     C                     MOVELWWECDT    MSGDT1
     C***********          MOVE 'PMS5116' MSGID                           S01486
     C                     MOVE 'PM95402' MSGID                           S01486
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELRESULT    P1BRDT
     C*
     C**   SET OFF ALL INDICATORS
     C                     MOVEA'00000000'*IN,21
     C                     MOVEA'00000'   *IN,60
     C                     MOVE '1'       *IN98
     C                     MOVE '1'       *IN29
     C*
     C**   INITIALISE LINE COUNTER
     C                     Z-ADD*ZEROS    LINE
     C*
     C**   ACCESS CURRENCY CODES FILE WITH PORTFOLIO CURRENCY
     C***********WWPTCY    CHAINSDCURRL0             60                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   RTCD    7                       S01486
     C                     PARM '*KEY'    OPTN    7                       S01486
     C                     PARM WWPTCY    KEYCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C*
     C**   IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
     C************IN60     IFEQ '1'                                       S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C                     Z-ADD1         WBASE
     C                     MOVE *BLANKS   WBFILE           *****************
     C                     MOVEL'SDCURRL0'WBFILE           ** DBERROR  001**
     C                     MOVE *BLANKS   WBKEY            *****************
     C                     MOVELWWPTCY    WBKEY
     C                     MOVE '9'       WWRTCD
     C                     EXSR *PSSR
     C*
     C                     ELSE
     C*
     C**   SAVE SPOT RATE, NUMBER OF DECIMAL PLACES AND MULT/DIV
     C**    INDICATOR INTO WORK FIELDS
     C                     Z-ADDA6SPRT    WWPSPR
     C                     Z-ADDA6NBDP    WWPDEC
     C                     Z-ADDA6NBDP    WWPDCS
     C                     MOVE A6MDIN    WWPMDI
     C*                                                                   CPM004
     C**   ACCESS PM ICD                                                  CPM004
     C                     CALL 'AOPORTR0'                                CPM004
     C                     PARM *BLANKS   RTCD                            CPM004
     C                     PARM '*FIRST ' OPTN                            CPM004
     C           SDPORT    PARM SDPORT    DSFDY                           CPM004
     C           RTCD      IFNE *BLANKS                                   CPM004
     C                     Z-ADD2         WBASE                           CPM004
     C                     MOVE *BLANKS   WBFILE           ***************CPM004
     C                     MOVEL'SDPORTPD'WBFILE           ** DBERROR  002CPM004
     C                     MOVE *BLANKS   WBKEY            ***************CPM004
     C                     MOVE '9'       WWRTCD                          CPM004
     C                     EXSR *PSSR                                     CPM004
     C                     END                                            CPM004
     C*
     C**   ACCESS PORTFOLIO TOTALS WITH CUSTOMER NUMBER AND PORTFOLIO
     C**    REFERENCE
     C***********WWKEY1    CHAINPMPOTTPP             61                   S01486
     C           WWKEY1    CHAINPMPOTTPD             61                   S01486
     C*
     C**   IF RECORD NOT FOUND
     C           *IN61     IFEQ '1'
     C*
     C**   SET PORTFOLIO TOTAL TO ZERO
     C                     Z-ADD*ZEROS    WWPORT
     C*
     C                     ELSE
     C*
     C**   IF TRADE/VALUE DATE = 'T'
     C           WWTVPS    IFEQ 'T'
     C           QCPTPA    SUB  QCPTNA    WWTMP1
     C           WWTMP1    SUB  QCPTMV    WWTMP1
     C                     Z-ADDWWTMP1    WWCTOP 150
     C           WWTMP1    ADD  QCPTAI    WWPORT
     C*
     C                     ELSE
     C*
     C**   IF TRADE/VALUE DATE = 'V'
     C           WWTVPS    IFEQ 'V'
     C           QCPVPA    SUB  QCPVNA    WWTMP2
     C           WWTMP2    SUB  QCPVMV    WWTMP2
     C***                  Z-ADDWWTMP1    WWCTOP 150                      056552
     C                     Z-ADDWWTMP2    WWCTOP 150                      056552
     C           WWTMP2    ADD  QCPTAI    WWPORT
     C*
     C                     END
     C                     END
     C                     END
     C                     END
     C*                                                                   CPM005
     C**   READ ALL RECORD WITH SAME CUSTOMER & PORTFOLIO WITH TOTAL      CPM005
     C**   TYPE EQUAL 'B'                                                 CPM005
     C**********           Z-ADDWWCNUM    K1CNUM                                       CPM005 CSD027
     C                     MOVE WWCNUM    K1CNUM                                              CSD027
     C                     MOVELWWPTFR    K1PTFR                          CPM005
     C                     MOVEL*BLANKS   K1POTY                          CPM005
     C*                                                                   CPM005
     C           PMASL1    SETLLPMASLIL1                                  CPM005
     C                     READ PMASLIL1                 65               CPM005
     C*                                                                   CPM005
     C**  RECORD FOUND SAVE ASSET & LIABILITY VALUE                       CPM005
     C                     SELEC                                          CPM005
     C           *IN65     WHEQ '0'                                       CPM005
     C*                                                                   CPM005
     C           *IN65     DOWEQ'0'                        BW1            CPM005
     C           WWCNUM    ANDEQFECNUM                                    CPM005
     C           WWPTFR    ANDEQFEPTFR                                    CPM005
     C                     ADD  FEASSV    WWASSV 150                      CPM005
     C                     ADD  FELIAV    WWLIAV 150                      CPM005
     C                     READ PMASLIL1                 65               CPM005
     C                     END                             EW1            CPM005
     C*                                                                   CPM005
     C           *IN65     WHEQ '1'                                       CPM005
     C                     Z-ADD*ZEROS    WWASSV                          CPM005
     C                     Z-ADD*ZEROS    WWLIAV                          CPM005
     C                     ENDSL                           E1             CPM005
     C*
     C** OPEN PRINTER FILE
     C                     OPEN PM9950P1
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
      *                                                                  *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P02     - PRODUCE VALUATION GROUP HEADING                       *
      * #P04     - PRODUCE INSTRUMENT TYPE HEADINGS                      *
      * #P05     - ACCESS CURRENCY DETAILS                               *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      * #P03     - PRODUCE INSTRUMENT TOTALS                             *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * MAIN     - MAIN PROCESSING                                       *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWKEY1   - KEY FOR PMHDVNLL (PARAMETERS CNUM AND PORT. REF.)     *
      * WWCRNM   - CUSTOMER NAME PARAMETER                               *
      * WWEVCD   - EVENT CONTROL DATE INPUT PARAMETER                    *
      * WWPTFR   - PORTFOLIO REFERENCR PARAMETER                         *
      * WWPTFN   - PORTFOLIO NARRATIVE PARAMETER                         *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WWVALG   - VALUATION GROUP ON CURRENT RECORD ON PMHDVNLL         *
      * WWINST   - INSTRUMENT TYPE ON CURRENT RECORD ON PMHDVNLL         *
      * WWTVDI   - TRADE/VALUE DATE INDICATOR ON PMHDVNLL                *
      * WWTVPS   - TRADE/VALUE DATE PARAMETER                            *
      * WWCCYP   - CURRENCY 1 ON PREVIOUS RECORD ON PMHDVNLL             *
      * WWVLGP   - VALUATION GROUP ON PREVIOUS RECORD ON PMHDVNLL        *
      * WWINSP   - INSTRUMENT TYPE ON PREVIOUS RECORD ON PMHDVNLL        *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WW1DEC   - NUMBER OF DECIMAL POINTS FOR CCY 1 ON PMHDVNLL        *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      *                                                                  *
      ********************************************************************
     C*
     C           #P01      BEGSR
     C*
     C**   ACCESS 'PMHDVNLL'
     C           WWKEY1    SETLLPMHDVNLL
     C           WWKEY1    READEPMHDVNLL                 62
     C*                                                                   CPM005
     C** READ RECORDS UNTIL NEXT NON-NOTIONAL POSITION FOUND              CPM005
     C           *IN62     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           WWKEY1    READEPMHDVNLL                 62               CPM005
     C                     END                                            CPM005
     C*
     C**   SET UP OUTPUT FIELDS FOR HEADER
     C/COPY WNCPYSRC,PM9952C004
     C                     MOVE WWCRNM    P1CRNM
     C/COPY WNCPYSRC,PM9952C005
     C*
     C**   WRITE MAIN HEADINGS ON FIRST PAGE
     C                     EXSR #TITLE
     C                     MOVE 'Y'       WWFRST  1
     C                     MOVE 'N'       WWHOLD  1
     C                     MOVE *BLANKS   WWVALG
     C                     MOVE *BLANKS   WWINST
     C                     MOVE QFMODI    WWMODI  2
     C                     Z-ADDQFCDP2    WWCDP2  20                      S71062
     C*
     C**   DO WHILE RECORDS EXIST ON FILE
     C           *IN62     DOWEQ'0'                        B1
     C*
     C** IF POSITION TO BE RPORTED
     C           WWTVPS    IFEQ QFTVDA                     B2
     C           QFTVDA    OREQ 'X'
     C*
     C** ON CHANGE OF VALUATION GROUP OUTPUT TOTALS FOR PREVIOUS GROUP
     C           QFVALG    IFNE WWVALG                     B3
     C           WWFRST    ANDNE'Y'
     C*
     C****       LINE      IFGT 40                         B4
     C****                 EXSR #TITLE
     C****                 END                             E4
     C*
     C           LINE      IFGT 40                         B4             091190
     C                     EXSR #TITLE                                    091190
     C                     END                             E4             091190
     C                     EXSR #P16
     C                     END                             E3
     C*
     C                     MOVE QFMODI    WWMODI  2
     C                     Z-ADDQFCDP2    WWCDP2                          S71062
     C*
     C** IF A NEW PAGE IS REQUIRED OUTPUT MAIN HEADING FIRST
     C           LINE      IFGT 35                         B3
     C           QFVALG    ANDNEWWVALG
     C           LINE      ORGT 35
     C           QFINNR    ANDNEWWINST
     C           LINE      ORGT 40
     C           QFMODI    OREQ 'FX'
     C           @TITRE    ANDEQ'VALUE'
     C           QFMODI    ORNE 'FX'
     C           @TITRE    ANDEQ'FOREX'
     C                     EXSR #TITLE
     C*
     C** OUTPUT VALUATION GROUP AND INSTRUMENT HEADINGS
     C                     MOVE QFVALG    WWVALG
     C                     MOVELQFDSPG    K2DGRC                          CPM005
     C                     Z-ADDQFDSPS    K2DGRS                          CPM005
     C                     MOVELQFPOST    K2POTY                          CPM005
     C                     EXSR #P02
     C                     MOVE QFINNR    WWINST
     C                     EXSR #P04
     C                     END                             E3
     C*
     C** ON CHANGE OF VALUATION GROUP OUTPUT NEW TITLE
     C           QFVALG    IFNE WWVALG                     B3
     C                     MOVE QFVALG    WWVALG
     C                     MOVELQFDSPG    K2DGRC                          CPM005
     C                     Z-ADDQFDSPS    K2DGRS                          CPM005
     C                     MOVELQFPOST    K2POTY                          CPM005
     C                     EXSR #P02
     C                     END                             E3
     C*
     C** ON CHANGE OF INSTRUMENT OUTPUT INSTRUMENT TITLE
     C           QFINNR    IFNE WWINST                     B3
     C                     MOVE QFINNR    WWINST
     C                     EXSR #P04
     C                     END                             E3
     C*
     C** ACCESS CURRENCY 1 DETAILS
     C           QFCCY1    IFNE WWCCY1                     B3
     C                     MOVE QFCCY1    WWCCYN  3
     C                     MOVE QFCCY1    WWCCY1  3
     C                     EXSR #P05
     C*
     C**   SAVE SPOT RATE, NUMBER OF DECIMAL PLACES AND MULT/DIV
     C**    INDICATOR INTO WORK FIELDS
     C                     Z-ADDA6SPRT    WW1SPR
     C                     Z-ADDA6NBDP    WW1DCS  10
     C                     MOVE A6MDIN    WW1MDI
     C                     Z-ADDA6NBDP    WW1DEC
     C                     END                             E3
     C*
     C           QFCCY2    IFNE *BLANKS                    B3
     C           QFCCY2    ANDNEWWCCY2
     C                     MOVE QFCCY2    WWCCYN  3
     C                     MOVE QFCCY2    WWCCY2  3
     C                     EXSR #P05
     C                     Z-ADDA6NBDP    WW2DEC  10
     C                     END                             E3
     C*
     C** OUTPUT INSTRUMENT DETAILS
     C                     EXSR #P06
     C                     MOVE 'Y'       WWHOLD  1
     C                     MOVE 'N'       WWFRST  1
     C                     END                             E2
     C*
     C**   READ NEXT RECORD FROM FILE
     C           WWKEY1    READEPMHDVNLL                 62
     C*                                                                   CPM005
     C** READ RECORDS UNTI NEXT NON-NOTIONAL POSITION FOUND               CPM005
     C           *IN62     DOWEQ'0'                                       CPM005
     C           QFNOPO    ANDEQ'Y'                                       CPM005
     C           WWKEY1    READEPMHDVNLL                 62               CPM005
     C                     END                                            CPM005
     C                     END                             E1
     C*
     C** IF ANY HOLDINGS HAVE BEEN PROCESSED OUTPUT VALUATION GROUP
     C** TOTALS
     C           WWHOLD    IFEQ 'Y'                        B1
     C*
     C           LINE      IFGT 40                         B2
     C                     EXSR #TITLE
     C                     END                             E2
     C*                                                                   CPM005
     C           QFNOPO    IFNE 'Y'                                       CPM005
     C                     MOVELQFDSPG    K2DGRC                          CPM005
     C                     MOVELQFDSPS    K2DGRS                          CPM005
     C                     END                                            CPM005
     C*
     C                     EXSR #P16
     C                     END                             E1
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P02     - PRODUCE VALUATION GROUP HEADING                       *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWLNGI   - LANG. INDICATOR USED IN DATA STRUCTURE FOR KEY 2      *
      **WWKEY2***-*KEY*FOR*PMVLGDPP*(VAL.*GROUP*AND*LANG.*PARM)***********S01486
      * WWKEY2   - KEY FOR PMVLGDPD (VAL. GROUP AND LANG. PARM)          *S01486
      * WWKYL2   - KEY 2 SET UP IN DATA STRUCTURE FOR OUTPUT             *
      * WWRTCD   - RETURN CODE PARAMETER                                 *
      *                                                                  *
      ********************************************************************
     C*
     C           #P02      BEGSR
     C*
     C**   MOVE LANGUAGE INDICATOR PARAMETER INTO KEY FIELD
     C                     MOVE WWLANG    WWLNGI
     C*
     C*****ACCESS*PMVLGDPP*WITH*VALUATION*GROUP*AND*LANGUAGE*INDICATOR****S01486
     C**   ACCESS PMVLGDPD WITH VALUATION GROUP AND LANGUAGE INDICATOR    S01486
     C**     AS THE KEY
     C***********WWKEY2    CHAINPMVLGDPP             63                   S01486
     C           WWKEY2    CHAINPMVLGDPD             63                   S01486
     C*
     C**   INITIALISE ARRAY VARIABLES FOR HEADING OUTPUT
     C                     MOVEA*BLANKS   AR1
     C                     MOVEA*BLANKS   AR2
     C                     Z-ADD20        X
     C                     Z-ADD1         Y
     C*
     C**   IF NARRATIVE IS NOT BLANK CALCULATE LENGTH OF UNDERLINE
     C           PCVLGN    IFNE *BLANKS
     C*
     C**   MOVE VALUATION GROUP NARRATIVE INTO ARRAY
     C                     MOVEAPCVLGN    AR1
     C*
     C**   COUNT CHARACTERS IN NARRATIVE
     C           AR1,X     DOWEQ' '
     C                     SUB  1         X
     C                     END
     C*
     C**   PUT SAME NUMBER OF DASHES INTO UNDERLINE ARRAY
     C           Y         DOWLEX
     C                     MOVE '='       AR2,Y
     C                     ADD  1         Y
     C                     END
     C                     END
     C*
     C**   MOVE VALUES TO OUTPUT FIELDS AND WRITE HEADING
     C                     MOVE PCVLGN    R2VLGN
     C*
     C                     WRITEP952HDR2
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P04     - PRODUCE INSTRUMENT TYPE HEADINGS                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWINST   - INSTRUMENT TYPE ON CURRENT RECORD ON PMHDVNLL         *
      * WWRTCD   - RETURN CODE PARAMETER                                 *
      *                                                                  *
      ********************************************************************
     C*
     C           #P04      BEGSR
      *                                                                   182961
      ** Instrument type is defaulted from PF/SDPORTPD if a blank         182961
      ** instrument type is found.                                        182961
      ** Indicator 35 was used as the operation's resulting indicator.    182961
      *                                                                   182961
     C           WWINST    IFEQ *BLANKS                                   182961
     C           1         SETLLSDPORTPD                                  182961
     C                     READ SDPORTPD                 35               182961
     C                     MOVE FCDINR    WWINST                          182961
     C                     ENDIF                                          182961
     C*
     C** ACCESS INSTRUMENT TYPES FILE USING INSTRUMENT TYPE
     C***********WWINST    CHAINSDPLINPD             64                   S01486
     C                     CALL 'AOPLINR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM WWINST    KEYIN   3                       S01486
     C           SDPLIN    PARM SDPLIN    DSFDY                           S01486
     C*
     C**   IF RECORD NOT FOUND OR RECORD ID = '*' THEN DB ERROR
     C************IN64     IFEQ '1'                                       S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C                     Z-ADD3         WBASE
     C                     MOVE *BLANKS   WBFILE           *****************
     C                     MOVEL'SDPLINPD'WBFILE           ** DBERROR  003**
     C                     MOVE *BLANKS   WBKEY            *****************
     C                     MOVELWWINST    WBKEY
     C                     MOVE '9'       WWRTCD
     C                     EXSR *PSSR
     C*
     C                     ELSE
     C*
     C**   MOVE VALUES TO OUTPUT FIELDS AND WRITE HEADING
     C                     MOVE PDISTN    R2NAR3
     C*
     C                     WRITEP952HDR3
     C*
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P05     - ACCESS CURRENCY DETAILS                               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWRTCD   - RETURN CODE PARAMETER                                 *
      *                                                                  *
      ********************************************************************
     C*
     C           #P05      BEGSR
     C*
     C**   ACCESS CURRENCY CODES FILE WITH CURRENCY 1
     C***********WWCCYN    CHAINSDCURRL0             60                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM WWCCYN    KEYCY                           S01486
     C***********SDCURR    PARM SDCURR    DSFDY                    S01486 CSD006
     C           SDCURR    PARM SDCURR    DSSDY                           CSD006
     C*
     C**   IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR
     C************IN60     IFEQ '1'                                       S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C                     Z-ADD4         WBASE
     C                     MOVE *BLANKS   WBFILE           *****************
     C                     MOVEL'SDCURRL0'WBFILE           ** DBERROR  004**
     C                     MOVE *BLANKS   WBKEY            *****************
     C                     MOVELWWCCYN    WBKEY
     C                     MOVE '9'       WWRTCD
     C                     EXSR *PSSR
     C*
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P08     - PROCESS SE NON INTEREST-BEARING HOLDINGS              *
      * #P09     - PROCESS FF HOLDINGS                                   *
      * #P10     - PROCESS MM DEALS                                      *
      * #P11     - PROCESS FX DEALS AND FRA/IRS                          *
      * #P12     - PROCESS LE HOLDINGS                                   *
      * #P13     - PROCESS RE HOLDINGS                                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P01     - PROCESS HOLDINGS                                      *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C*
     C           #P06      BEGSR
     C*
     C** IF MODULE ID ON PMHDVNLL = 'SE'
     C           QFMODI    IFEQ 'SE'
     C*
     C** IF NEXT INTEREST DATE ON PMHDVNLL IS NOT ZERO
     C           QFNIDT    IFNE *ZEROS
     C*
     C** PROCESS SE INTEREST-BEARING HOLDINGS
     C                     EXSR #P07
     C*
     C                     ELSE
     C*
     C** PROCESS SE NON INTEREST-BEARING HOLDINGS
     C                     EXSR #P08
     C*
     C                     END
     C*
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'FF'
     C           QFMODI    IFEQ 'FF'
     C*
     C** PROCESS FF HOLDINGS
     C                     EXSR #P09
     C*
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'DL'
     C           QFMODI    IFEQ 'ML'
     C           QFMODI    OREQ 'MD'
     C           QFMODI    OREQ 'FR'
     C           QFMODI    OREQ 'FX'
     C           QFMODI    OREQ 'FI'
     C*
     C** CHECK DEAL TYPE ON PMHDVNLL
     C****       QFDTYP    IFEQ 'PS'                                      48007
     C****       QFDTYP    OREQ 'IT'                                      48007
     C           QFDTYP    IFEQ 'IT'
     C           QFDTYP    OREQ 'IP'
     C           QFDTYP    OREQ 'CD'
     C           QFDTYP    OREQ 'CL'
     C           QFDTYP    OREQ 'LN'
     C           QFDTYP    OREQ 'TD'
     C           QFDTYP    OREQ 'DL'
     C           QFDTYP    OREQ 'TL'
     C           QFDTYP    OREQ 'CI'
     C           QFDTYP    OREQ 'TI'
     C           QFMODI    OREQ 'FI'
     C*
     C** PROCESS MM DEALS
     C                     EXSR #P10
     C*
     C                     ELSE
     C*
     C** PROCESS FX DEALS AND FRA/IRS
     C                     EXSR #P11
     C*
     C                     END
     C*
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'LE'
     C           QFMODI    IFEQ 'LE'
     C*
     C** PROCESS LE HOLDINGS
     C                     EXSR #P12
     C*
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'RE'
     C           QFMODI    IFEQ 'RE'
     C*
     C** PROCESS RE HOLDINGS
     C                     EXSR #P13
     C                     ELSE
     C*
     C** IF MODULE ID ON PMHDVNLL = 'LB'
     C           QFMODI    IFEQ 'LB'
     C*
     C** PROCESS LB HOLDINGS
     C                     EXSR #P17
     C*
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * #Y02     - CONVERT YIELD AMOUNTS TO FORMAT REQUIRED ON REPORT    *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWWYLD   - GENERAL WORK FIELD OUTPUT FROM #Y02                   *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      *                                                                  *
      ********************************************************************
     C*
     C           #P07      BEGSR
     C*
     C** EXECUTE ZSEDIT FOR NOMINAL/QTY USING AMOUNT 1 AND NUMBER OF
     C**  DECIMAL PLACES FOR CURRENCY 1, BOTH FROM PMHDVNLL
     C           QFPOST    IFEQ 'C '                       B1             CPM005
     C                     Z-ADDQFAMT1    ZFLD15
     C                     ELSE                            X1             CPM005
     C           QFPOST    IFEQ 'FO'                       B2             CPM005
     C                     Z-ADDQFOAMT    ZFLD15                          CPM005
     C                     ELSE                            X2             CPM005
     C           QFAMT1    IFLT 0                          B3             CPM005
     C                     Z-SUBQFAMT1    ZFLD15                          CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADDQFAMT1    ZFLD15                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     Z-ADDQFCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2NQTY
     C*                                                                   056459
     C** IF VALUE DATE POSITIONS AND OTHER NOMINAL DIFFERENT OUTPUT       056459
     C** FIGURES IN BRACKETS                                              056459
     C                     MOVE *BLANKS   R2NQT1                          056459
     C                     MOVE *BLANKS   WWWK17 17                       065115
     C           QFAMT1    IFNE QFOAMT                                    056459
     C           QFOAMT    ANDNE*HIVAL                                    056459
     C           QFPOST    ANDEQ'C '                                      CPM005
     C                     Z-ADDQFOAMT    ZFLD15                          056459
     C                     Z-ADDQFCDP1    ZDECS                           056459
     C                     MOVE 'J'       ZECODE                          056459
     C                     EXSR ZSEDIT                                    056459
     C                     MOVE ZOUT21    WWWK17 17                       056459
     C                     MOVELWWWK17    R2NQT1                          056459
     C                     MOVEL'('       R2NQT1                          056459
     C                     MOVE ')'       R2NQT1                          056459
     C                     END                                            056459
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C           QFTDSS    CHAINSECTY                99
     C           *IN99     IFEQ '1'
     C                     MOVE *BLANKS   R2DES1
     C                     MOVELQFTXT1    R2DES1
     C***                  MOVE *BLANKS   R2DES2                          056839
     C***                  MOVELQFTXT2    R2DES2                          056839
     C                     ELSE
     C                     MOVELSFN1      R2DES1
     C***                  MOVELSFN2      R2DES2                          056839
     C                     END
     C*
     C                     MOVE *BLANKS   R2DES2                          056839
     C                     MOVELQFTXT2    R2DES2                          056839
     C*
     C** OUTPUT BOOK PRICE FROM PMHDVNLL
     C           WWPTFF    IFNE '9998'
     C           WWPTFF    ANDNE'9999'
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE QFBOPR    ZFIELD
     C                     Z-ADD8         ZADEC
     C                     EXSR ZEDIT
     C*                    MOVE ZFIELD    R2BOPR
     C                     MOVE ZFIELW    R2BOPR
     C           SPBS      IFEQ 'P'
     C                     MOVE '%'       R2BOPR
     C                     END
     C*
     C                     ELSE
     C                     MOVE *BLANKS   R2BOPR
     C                     END
     C*
     C** OUTPUT MARKET PRICE FROM PMHDVNLL
     C           QFMPRC    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE QFMPRC    ZFIELD
     C                     Z-ADD8         ZADEC
     C                     EXSR ZEDIT
     C*                    MOVE ZFIELD    R2MPRC
     C                     MOVE ZFIELW    R2MPRC
     C           SPBS      IFEQ 'P'
     C                     MOVE '%'       R2MPRC
     C                     END
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MPRC
     C*
     C                     END
     C*
     C** MOVE PROFIT/LOSS MARKET FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLMK    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP2    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C*
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C                     ADD  ZAMTT     WWTIMV
     C*
     C** STORE CONVERTED MARKET VALUE AS MARKET VALUE PORTFOLIO CCY
     C                     Z-ADDZAMTT     WWMVPC
     C*
     C** OUTPUT MARKET YIELD FROM PMHDVNLL
     C           QFMKYD    IFGT *ZERO
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE QFMKYD    ZFIELD
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     EXSR #Y02
     C                     MOVE WWWYLD    R2MKYD  6
     C*
     C                     ELSE
     C           QFMKYD    IFEQ -9999
     C                     MOVE *BLANKS   R2MKYD
     C***                  MOVE 'N/A '    R2MKYD                         56522
     C                     MOVE '0'       R2MKYD                         56522
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MKYD
     C*
     C                     END
     C                     END
     C*
     C** MOVE MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWMVPC    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCCV
     C           WWWORK    IFEQ 0
     C                     MOVE *BLANKS   R2PCCV
     C***                  MOVE 'N/A'     R2PCCV                          056552
     C                     MOVE '0 '      R2PCCV                          056552
     C                     MOVE *BLANKS   R2PERC
     C                     END
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C** OUTPUT MARKET RATE USING RATE FROM FILE
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C*
     C** OUTPUT BOOK YIELD FROM PMHDVNLL
     C           QFBKYD    IFGT *ZERO
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE QFBKYD    ZFIELD
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     EXSR #Y02
     C                     MOVE WWWYLD    R2BKYD
     C*
     C                     ELSE
     C*
     C           QFBKYD    IFEQ -9999
     C                     MOVE *BLANKS   R2BKYD
     C***                  MOVE 'N/A'     R2BKYD                          056552
     C                     MOVE '0 '      R2BKYD                          056552
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2BKYD
     C*
     C                     END
     C                     END
     C*
     C** OUTPUT SECURITY SHORTNAME FROM PMHDVNLL
     C                     MOVE QFTDSS    R2DES3
     C*
     C** OUTPUT INSTRUMENT PLEDGED FROM PMHDVNLL
     C           QFSPLD    IFEQ 'Y'
     C                     MOVE '1'       *IN27
     C                     ELSE
     C                     MOVE '0'       *IN27
     C                     END
     C*
     C** PRODUCE NON RE ACCRUED INTEREST DETAILS
     C                     EXSR #P14
     C                     MOVELQFTXT2    R2CCY
     C*
     C** CALCULATE PERCENTAGE OF PORTFOLIO HELD IN INSTRUMENT
     C                     MOVE *BLANKS   R2PERC
     C                     MOVE *BLANKS   R2IERC
     C           ZAMTT     ADD  WWMVPC    WWMVPC
     C           WWPORT    IFEQ *ZEROS                     B1
     C***********          Z-ADD*ZEROS    WWIPC1  43H                     076624
     C                     Z-ADD*ZEROS    WWIPC1  53H                     076624
     C                     ELSE                            X1
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           WWMVPC    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           WWMVPC    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           WWMVPC    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END                             E1
     C***********WWIPC1    MULT 100       WWIPC2  41H                     076624
     C           WWIPC1    MULT 100       WWIPC2  51H                     076624
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC    H
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C*
     C           QFACIS    IFNE 0                          B1
     C                     MOVE ZOUT21    R2IERC
     C                     ELSE                            X1
     C                     MOVE ZOUT21    R2PERC
     C                     END                             E1
     C*                                                                   CPM005
     C** IF RECORD PROCESS IS A FORWARD TRADE POSITION                    CPM005
     C                     MOVE *OFF      *IN02                           CPM005
     C           QFPOST    IFEQ 'FO'                       B1             CPM005
     C           QFPOST    OREQ 'FC'                                      CPM005
     C                     MOVE *ON       *IN02                           CPM005
     C*                                                                   CPM005
     C                     Z-ADDQFVDAT    ZDAYNO                          CPM005
     C                     EXSR ZDATE2                                    CPM005
     C                     MOVE ZADATE    R2VDAT                          CPM005
     C*                                                                   CPM005
     C           QFPOST    IFEQ 'FO'                       B2             CPM005
     C                     MOVELWW9619    R2FCFO                          CPM005
     C                     ELSE                            X2             CPM005
     C                     MOVELWW9620    R2FCFO                          CPM005
     C                     END                             E2             CPM005
     C*                                                                   CPM005
     C** IF FX P/L EXISTS ON POSITION OUTPUT TEXT '+FX'                   CPM005
     C           QFPLFX    IFNE 0                                         CPM005
     C                     MOVE '1'       *IN66                           CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C                     END                             E1             CPM005
     C*
     C/COPY WNCPYSRC,PM9952C006
     C** WRITE DETAIL LINE (W0701)
     C                     WRITEP952DET4
     C*
     C** WRITE DETAIL LINE (W0702)
     C                     WRITEP952DET5
     C** WRITE DETAIL LINE (W0703)
     C                     WRITEP952DET6
     C                     MOVE *BLANKS   R2NQT1                          46081
     C                     MOVE '0'       *IN66                           CPM005
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P08     - PROCESS SE NON INTEREST-BEARING HOLDINGS              *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE FOR CCY 1 ON PMHDVNLL                 *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P08      BEGSR
     C*
     C** EXECUTE ZSEDIT FOR NOMINAL/QTY USING AMOUNT 1 AND NUMBER OF
     C**  DECIMAL PLACES FOR CURRENCY 1, BOTH FROM PMHDVNLL
     C           QFPOST    IFEQ 'C '                       B1             CPM005
     C                     Z-ADDQFAMT1    ZFLD15
     C                     ELSE                            X1             CPM005
     C           QFPOST    IFEQ 'FO'                       B2             CPM005
     C                     Z-ADDQFOAMT    ZFLD15                          CPM005
     C                     ELSE                            X2             CPM005
     C           QFAMT1    IFLT 0                          B3             CPM005
     C                     Z-SUBQFAMT1    ZFLD15                          CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADDQFAMT1    ZFLD15                          CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     Z-ADDQFCDP1    ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2NQTY
     C                     MOVELQFTXT2    R2CCY
     C*                                                                   056459
     C** IF VALUE DATE POSITIONS AND OTHER NOMINAL DIFFERENT OUTPUT       056459
     C** FIGURES IN BRACKETS                                              056459
     C                     MOVE *BLANKS   R2NQT1                          056459
     C           QFAMT1    IFNE QFOAMT                                    056459
     C           QFOAMT    ANDNE*HIVAL                                    056459
     C           QFPOST    ANDEQ'C '                                      CPM005
     C                     Z-ADDQFOAMT    ZFLD15                          056459
     C                     Z-ADDQFCDP1    ZDECS                           056459
     C                     MOVE 'J'       ZECODE                          056459
     C                     EXSR ZSEDIT                                    056459
     C                     MOVE ZOUT21    WWWK17 17                       056459
     C                     MOVELWWWK17    R2NQT1                          056459
     C                     MOVEL'('       R2NQT1                          056459
     C                     MOVE ')'       R2NQT1                          056459
     C                     END                                            056459
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C           QFTDSS    CHAINSECTY                99
     C           *IN99     IFEQ '1'
     C                     MOVE *BLANKS   R2DES1
     C                     MOVELQFTXT1    R2DES1
     C***                  MOVE *BLANKS   R2DES2                          056839
     C***                  MOVELQFTXT2    R2DES2                          056839
     C                     ELSE
     C                     MOVELSFN1      R2DES1
     C***                  MOVELSFN2      R2DES2                          056839
     C                     END
     C*
     C                     MOVE *BLANKS   R2DES2                          056839
     C                     MOVELQFTXT2    R2DES2                          056839
     C*
     C** OUTPUT BOOK PRICE FROM PMHDVNLL
     C                     MOVE *BLANKS   ZFIELD
     C*
     C*                                                                   167710
     C********** QFBOPR    IFLT 999                                       167710
     C**********           MOVE QFBOPR    ZFIELD                          167710
     C**********           Z-ADD8         ZADEC                           167710
     C**********           ELSE                                           167710
     C********** QFBOPR    IFLT 9999                                      167710
     C**********           Z-ADDQFBOPR    WORK7D 157                      167710
     C**********           MOVE WORK7D    ZFIELD                          167710
     C**********           Z-ADD7         ZADEC                           167710
     C**********           ELSE                                           167710
     C********** QFBOPR    IFLT 99999                                     167710
     C**********           Z-ADDQFBOPR    WORK6D 156                      167710
     C**********           MOVE WORK6D    ZFIELD                          167710
     C**********           Z-ADD6         ZADEC                           167710
     C**********           ELSE                                           167710
     C********** QFBOPR    IFLT 999999                                    167710
     C**********           Z-ADDQFBOPR    WORK5D 155                      167710
     C**********           MOVE WORK5D    ZFIELD                          167710
     C**********           Z-ADD5         ZADEC                           167710
     C**********           END                                            167710
     C**********           END                                            167710
     C**********           END                                            167710
     C**********           END                                            167710
     C*
     C           QFBOPR    IFGT 999999                                    167710
     C                     Z-ADD4         ZADEC                           167710
     C                     Z-ADD7         ZADIG                           167710
     C                     Z-ADDQFBOPR    WWPRI4 114                      167710
     C                     MOVE WWPRI4    ZFIELD                          167710
     C                     ELSE                                           167710
     C           QFBOPR    IFGT 99999                                     167710
     C                     Z-ADD6         ZADEC                           167710
     C                     Z-ADD6         ZADIG                           167710
     C                     Z-ADDQFBOPR    WWPRI6 126                      167710
     C                     MOVE WWPRI6    ZFIELD                          167710
     C                     ELSE                                           167710
     C                     Z-ADD8         ZADEC                           167710
     C                     Z-ADD5         ZADIG                           167710
     C                     MOVE QFBOPR    ZFIELD                          167710
     C                     ENDIF                                          167710
     C                     ENDIF                                          167710
     C*                                                                   167710
     C                     EXSR ZEDIT
     C                     MOVE ZFIELW    R2BOPR
     C           SPBS      IFEQ 'P'
     C                     MOVE '%'       R2BOPR
     C                     END
     C*
     C** OUTPUT MARKET PRICE FROM PMHDVNLL
     C           QFMPRC    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C*
     C********** QFMPRC    IFLT 999                                       167710
     C**********           MOVE QFMPRC    ZFIELD                          167710
     C**********           Z-ADD8         ZADEC                           167710
     C**********           ELSE                                           167710
     C********** QFMPRC    IFLT 9999                                      167710
     C**********           Z-ADDQFMPRC    WORK7D 157                      167710
     C**********           MOVE WORK7D    ZFIELD                          167710
     C**********           Z-ADD7         ZADEC                           167710
     C**********           ELSE                                           167710
     C********** QFMPRC    IFLT 99999                                     167710
     C**********           Z-ADDQFMPRC    WORK6D 156                      167710
     C**********           MOVE WORK6D    ZFIELD                          167710
     C**********           Z-ADD6         ZADEC                           167710
     C**********           ELSE                                           167710
     C********** QFMPRC    IFLT 999999                                    167710
     C**********           Z-ADDQFMPRC    WORK5D 155                      167710
     C**********           MOVE WORK5D    ZFIELD                          167710
     C**********           Z-ADD5         ZADEC                           167710
     C**********           END                                            167710
     C**********           END                                            167710
     C**********           END                                            167710
     C**********           END                                            167710
     C*                                                                   167710
     C           QFMPRC    IFGT 999999                                    167710
     C                     Z-ADD4         ZADEC                           167710
     C                     Z-ADD7         ZADIG                           167710
     C                     Z-ADDQFMPRC    WWPRI4                          167710
     C                     MOVE WWPRI4    ZFIELD                          167710
     C                     ELSE                                           167710
     C           QFMPRC    IFGT 99999                                     167710
     C                     Z-ADD6         ZADEC                           167710
     C                     Z-ADD6         ZADIG                           167710
     C                     Z-ADDQFMPRC    WWPRI6                          167710
     C                     MOVE WWPRI6    ZFIELD                          167710
     C                     ELSE                                           167710
     C                     Z-ADD8         ZADEC                           167710
     C                     Z-ADD5         ZADIG                           167710
     C                     MOVE QFMPRC    ZFIELD                          167710
     C                     ENDIF                                          167710
     C                     ENDIF                                          167710
     C*                                                                   167710
     C*
     C                     EXSR ZEDIT
     C*                    MOVE ZFIELD    R2MPRC
     C                     MOVE ZFIELW    R2MPRC
     C           SPBS      IFEQ 'P'
     C                     MOVE '%'       R2MPRC
     C                     END
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MPRC
     C*
     C                     END
     C*
     C** MOVE PROFIT/LOSS MARKET FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLMK    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** OUTPUT BLANKS TO BOOK YIELD OUTPUT FIELD
     C                     MOVE *BLANKS   R2BKYD
     C                     MOVE *BLANKS   R2MKYD
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP2    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C                     ADD  ZAMTT     WWTIMV
     C*
     C** MOVE CONVERTED MARKET VALUE INTO WORK FIELD
     C                     Z-ADDZAMTT     WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCCV
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C** OUTPUT MARKET RATE USING RATE FROM FILE
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C*
     C** OUTPUT BLANKS TO MARKET YIELD OUTPUT FIELD
     C                     MOVE *BLANKS   R2MKYD
     C*
     C** OUTPUT SECURITY SHORTNAME FROM PMHDVNLL
     C                     MOVE QFTDSS    R2DES3
     C*
     C** OUTPUT INSTRUMENT PLEDGED FROM PMHDVNLL
     C           QFSPLD    IFEQ 'Y'
     C                     MOVE '1'       *IN27
     C                     ELSE
     C                     MOVE '0'       *IN27
     C                     END
     C*
     C                     MOVE '0'       *IN29
     C*
     C                     MOVE *BLANKS   R2PACC
     C*
     C** CALCULATE PERCENTAGE OF PORTFOLIO HELD IN INSTRUMENT
     C                     MOVE *BLANKS   R2PERC
     C                     MOVE *BLANKS   R2IERC
     C           ZAMTT     ADD  WWMVPC    WWMVPC
     C           WWPORT    IFEQ *ZEROS                     B1
     C***********          Z-ADD*ZEROS    WWIPC1  43H                     076624
     C                     Z-ADD*ZEROS    WWIPC1                          076624
     C                     ELSE                            X1
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           ZAMTT     DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END                             E1
     C***********WWIPC1    MULT 100       WWIPC2  41H                     076624
     C           WWIPC1    MULT 100       WWIPC2                          076624
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC    H
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C*
     C           QFACIS    IFNE 0                          B1
     C                     MOVE ZOUT21    R2IERC
     C                     ELSE                            X1
     C                     MOVE ZOUT21    R2PERC
     C                     END                             E1
     C           ZAMTT     IFEQ 0
     C                     MOVE *BLANKS   R2PERC
     C***                  MOVE 'N/A'     R2PERC                         056552
     C                     MOVE '0 '      R2PERC                         056552
     C                     END
     C*                                                                   CPM005
     C** IF RECORD PROCESS IS A FORWARD TRADE POSITION                    CPM005
     C                     MOVE *OFF      *IN02                           CPM005
     C           QFPOST    IFEQ 'FO'                       B1             CPM005
     C           QFPOST    OREQ 'FC'                                      CPM005
     C                     MOVE *ON       *IN02                           CPM005
     C*                                                                   CPM005
     C                     Z-ADDQFVDAT    ZDAYNO                          CPM005
     C                     EXSR ZDATE2                                    CPM005
     C                     MOVE ZADATE    R2VDAT                          CPM005
     C*                                                                   CPM005
     C           QFPOST    IFEQ 'FO'                       B2             CPM005
     C                     MOVELWW9619    R2FCFO                          CPM005
     C                     ELSE                            X2             CPM005
     C                     MOVELWW9620    R2FCFO                          CPM005
     C                     END                             E2             CPM005
     C*                                                                   CPM005
     C** IF FX P/L EXISTS ON POSITION OUTPUT TEXT '+FX'                   CPM005
     C           QFPLFX    IFNE 0                                         CPM005
     C                     MOVE '1'       *IN66                           CPM005
     C                     END                                            CPM005
     C*                                                                   CPM005
     C                     END                             E1             CPM005
     C*
     C/COPY WNCPYSRC,PM9952C007
     C** WRITE DETAIL LINE (W0701)
     C                     WRITEP952DET4
     C*
     C** WRITE DETAIL LINE (W0702)
     C                     WRITEP952DET5
     C** WRITE DETAIL LINE (W0703)
     C                     WRITEP952DET6
     C                     MOVE '1'       *IN29
     C                     MOVE '0'       *IN66                           CPM005
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P09     - PROCESS FF HOLDINGS                                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      *                                                                  *
      ********************************************************************
     C*
     C           #P09      BEGSR
     C*                                                                   S71062
     C** Access INTYPD to retrieve ticks denominator and minimum price    S71062
     C** fluctuation to display book and market price                     S71062
     C           QFFOIS    CHAININTYP                73                   S71062
     C           *IN73     IFEQ *ON                                       S71062
     C                     Z-ADD2         WBASE                           S71062
     C                     MOVE *BLANKS   WBFILE           ***************S71062
     C                     MOVEL'INTYP'   WBFILE           ** DBERROR  002S71062
     C                     MOVE *BLANKS   WBKEY            ***************S71062
     C                     MOVELQFFOIS    WBKEY                           S71062
     C                     MOVE '9'       WWRTCD                          S71062
     C                     EXSR *PSSR                                     S71062
     C                     END                                            S71062
     C*
     C** OUTPUT NOMINAL/QTY FROM PMHDVNLL
     C***********          Z-ADDQFAMT1    ZFLD15                          S71062
     C***********          Z-ADD*ZEROS    ZDECS                           S71062
     C***********          MOVE 'J'       ZECODE                          S71062
     C***********          EXSR ZSEDIT                                    S71062
     C***********          MOVE ZOUT21    R2NMQT                          S71062
     C                     MOVEL*BLANKS   ZFIELD                          S71062
     C                     MOVE QFAMT1    ZFIELD                          S71062
     C                     Z-ADD0         ZADEC                           S71062
     C                     EXSR ZEDIT                                     S71062
     C***********          MOVE ZFIELD    WWNBOC                   S71062 076371
     C                     MOVELZFIELD    WWRK24 19                       076371
     C***********          MOVE QFDTYP    WWRK24                   076371 077457
     C                     MOVE '   '     WWRK24                          077457
     C           QFDTYP    IFEQ 'S '                                      077457
     C                     MOVE '-  '     WWRK24                          077457
     C                     END                                            077457
     C                     MOVE WWRK24    R2NOQ1                          076371
     C*
     C** MOVE LEFT DEAL TYPE FROM PMHDVNLL INTO NOMINAL/QTY FIELD
     C***********          MOVELQFDTYP    R2NMQT                          S71062
     C***********          MOVELQFDTYP    WWPUSE                   S71062 076371
     C***********                                                  S71062 076371
     C***MOVE*'-'*IF*SELL******************************************S71062 076371
     C***********QFDTYP    IFEQ 'S'                                S71062 076371
     C***********          MOVEL'-'       WWSIGN                   S71062 076371
     C***********          ELSE                                    S71062 076371
     C***********          MOVEL*BLANKS   WWSIGN                   S71062 076371
     C***********          END                                     S71062 076371
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C***********          MOVE QFTXT1    R2DES4                          S71062
     C                     MOVELQFTXT1    R2NMQT                          S71062
     C*                                                                   S71062
     C** OUTPUT INSTRUMENT CURRENCY                                       S71062
     C                     MOVE *BLANKS   R2DES4                          S71062
     C                     MOVELQFCCY1    WICCY2                          S71062
     C*
     C** OUTPUT BOOK PRICE FROM PMHDVNLL
     C***********          MOVE *BLANKS   ZFIELD                          S71062
     C***********          MOVE QFBOPR    ZFIELD                          S71062
     C***********          Z-ADD8         ZADEC                           S71062
     C***********          EXSR ZEDIT                                     S71062
     C***********          MOVE ZFIELW    R2BKPR                          S71062
     C           QFBOPR    IFNE *ZEROS                                    S71062
     C                     Z-ADDQFBOPR    FFPRIC                          S71062
     C                     Z-ADDTKDM      FFTKDM                          S71062
     C                     Z-ADDMNPF      FFMNPF                          S71062
     C                     EXSR FFPRCS                                    S71062
     C                     MOVE FFSPRC    R2BKPR                          S71062
     C                     ELSE                                           S71062
     C                     MOVEL*BLANKS   R2BKPR                          S71062
     C                     END                                            S71062
     C*
     C** OUTPUT MARKET PRICE FROM PMHDVNLL
     C           QFMPRC    IFNE *ZEROS
     C***********          MOVE *BLANKS   ZFIELD                          S71062
     C***********          MOVE QFMPRC    ZFIELD                          S71062
     C***********          Z-ADD8         ZADEC                           S71062
     C***********          EXSR ZEDIT                                     S71062
     C***********          MOVE ZFIELD    R2MKPR                          S71062
     C***********          MOVE ZFIELW    R2MKPR                          S71062
     C                     Z-ADDQFMPRC    FFPRIC                          S71062
     C                     Z-ADDTKDM      FFTKDM                          S71062
     C                     Z-ADDMNPF      FFMNPF                          S71062
     C                     EXSR FFPRCS                                    S71062
     C                     MOVE FFSPRC    R2MKPR                          S71062
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MKPR
     C*
     C                     END
     C*                                                                   S71062
     C** OUTPUT MARKET FX RATE                                            S71062
     C           QFMFXR    IFNE *ZEROS                                    S71062
     C                     MOVEL*BLANKS   ZFIELD                          S71062
     C                     Z-ADDQFMFXR    WWRATE  84H                     S71062
     C                     MOVE WWRATE    ZFIELD                          S71062
     C                     Z-ADD4         ZADIG                           S71062
     C                     Z-ADD4         ZADEC                           S71062
     C                     EXSR ZEDIT                                     S71062
     C                     MOVE ZFIELD    R2FMFX                          S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   R2FMFX                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C** OUTPUT MARKET VALUE                                              S71062
     C***********QFMVAL    IFNE *ZEROS                             S71062 076371
     C           QFMVPC    IFNE *ZEROS                                    076371
     C***********          ADD  QFMVAL    WWGRTO                   S71062 076371
     C                     ADD  QFMVPC    WWGRTO                          076371
     C                     Z-ADD*ZEROS    ZFLD15                          S71062
     C***********          MOVE QFMVAL    ZFLD15                   S71062 076371
     C***********          Z-ADDQFCDP2    ZDECS                    S71062 076371
     C                     MOVE QFMVPC    ZFLD15                          076371
     C                     Z-ADDWWPDEC    ZDECS                           076371
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    R2UNPL                          S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   R2UNPL                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C           WWPORT    IFEQ *ZEROS                     B1             S71062
     C                     Z-ADD*ZEROS    WWIPC1    H                     S71062
     C                     ELSE                            X1             S71062
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C***********QFMVAL    DIV  WWPORT    WWIPC1    H              S71062 076371
     C           QFMVPC    DIV  WWPORT    WWIPC1    H                     076371
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           QFMVPC    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           QFMVPC    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END                             E1             S71062
     C           WWIPC1    MULT 100       WWIPC2    H                     S71062
     C*                                                                   S71062
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE             S71062
     C                     Z-ADD*ZEROS    ZFLD15                          S71062
     C                     MOVE WWIPC2    ZFLD15                          S71062
     C                     Z-ADD1         ZDECS                           S71062
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C*                                                                   S71062
     C                     MOVE ZOUT21    R2PERC                          S71062
     C***********                                                         S71062
     C***MOVE*PROFIT/LOSS*MARKET*FROM*PMHDVNLL*INTO*WORK*FIELD************S71062
     C***********          Z-ADDQFPLMK    WWWORK                          S71062
     C***********                                                         S71062
     C***CALL*SUBROUTINE*TO*SET*UP*OUTPUT*FIELD***************************S71062
     C***********          EXSR #Y01                                      S71062
     C***********                                                         S71062
     C***MOVE*OUTPUT*FIELD*TO*PRINTER*FILE********************************S71062
     C***********          MOVE ZOUT21    R2UNPL                          S71062
     C*
     C** WRITE DETAIL LINE (W0901)
     C                     WRITEP952DET7
     C*
     C***WRITE*DETAIL*LINE*(W0902)****************************************S71062
     C***********          MOVE QFTXT2    R2DES5                          S71062
     C**                                                                  S71062
     C** OUTPUT INSTRUMENT CURRENCY                                       S71062
     C**                                                                  S71062
     C                     MOVELQFCCY1    WWICCY                          S71062
     C**                                                                  S71062
     C** OUTPUT SETTLEMENT DATE                                           S71062
     C**                                                                  S71062
     C           QFSETD    IFNE *ZEROS                                    S71062
     C**                                                                  S71062
     C                     Z-ADDQFSETD    ZDAYNO                          S71062
     C                     EXSR ZDATE2                                    S71062
     C                     MOVELZDATE     WKSETD                          S71062
     C**                                                                  S71062
     C                     MOVE WWDDAY    WWSDAY                          S71062
     C                     MOVE WWYEAR    WWSYER                          S71062
     C                     Z-ADDWWMONT    X       20                      S71062
     C                     MOVE ZMNM,X    WWSMTH                          S71062
     C                     MOVELWWSDAT    WWSETD                          S71062
     C                     ELSE                                           S71062
     C                     MOVEL*BLANKS   WWSETD                          S71062
     C                     END                                            S71062
     C*                                                                   S71062
     C** OUTPUT AMERICAN/EUROPEAN                                         S71062
     C*                                                                   S71062
     C                     SELEC                                          S71062
     C           QFAEIN    WHEQ 'A'                                       S71062
     C                     MOVEL'AMERICAN'WWAMEU                          S71062
     C           QFAEIN    WHEQ 'E'                                       S71062
     C                     MOVEL'EUROPEAN'WWAMEU                          S71062
     C                     OTHER                                          S71062
     C                     MOVEL*BLANKS   WWAMEU                          S71062
     C                     ENDSL                                          S71062
     C                     WRITEP952DET8
     C*                                                                   S71062
     C** OUTPUT CONTINGENT AMOUNT FOR OTC OPTIONS ONLY                    S71062
     C*                                                                   S71062
     C                     MOVE *BLANKS   WWNAR2                          S71062
     C                     MOVELQFTXT2    WWTXT2                          S71062
     C           QFPUIT    IFNE *ZEROS                                    S71062
     C                     MOVEL*BLANKS   ZFLD15                          S71062
     C                     MOVE QFPUIT    ZFLD15                          S71062
     C                     Z-ADDQFCDP2    ZDECS                           S71062
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    WWCTGA                          S71062
     C                     MOVE WWPCST    WWSTRK                          S71062
     C                     ELSE                                           S71062
     C                     MOVE *BLANKS   WWCTGA                          S71062
     C                     MOVELWWMTHQ    WWCTGA                          S71062
     C                     MOVE WWPCST    WWCTGA                          S71062
     C                     END                                            S71062
     C*
     C** WRITE DETAIL LINE (W0903)
     C***********          MOVELQFTRNB    R2TRNB                          S71062
     C                     WRITEP952DET9
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P10     - PROCESS MM DEALS                                      *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P10      BEGSR
     C*
     C** OUTPUT NOMINAL/QTY FROM PMHDVNLL USING ZSEDIT
     C                     Z-ADDWW1DEC    WWPDEC
     C           QFMODI    IFEQ 'MD'                                      48007
     C           FCPORS    ANDNE'B'                                       CPM004
     C           QFMODI    OREQ 'FI'                                      48007
     C           QFMODI    OREQ 'ML'                                      CPM004
     C           FCPORS    ANDEQ'B'                                       CPM004
     C                     Z-ADDQFAMT1    WWWORK
     C                     ELSE                                           48007
     C                     Z-SUBQFAMT1    WWWORK                          48007
     C                     END                                            48007
     C****                                                                061190
     C***CALL SUBROUTINE TO SET UP OUTPUT FIELD                           061190
     C****                 EXSR #Y01                                      061190
     C*                                                                   061190
     C                     Z-ADDWWWORK    ZFLD15                          061190
     C                     Z-ADDQFCDP1    ZDECS                           061190
     C                     MOVE 'J'       ZECODE                          061190
     C                     EXSR ZSEDIT                                    061190
     C*
     C** OUTPUT NOMINAL/QTY TO REPORT
     C                     MOVE ZOUT21    R2NOMQ
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT NAME FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DES6
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP1    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C           QFTVDA    IFNE 'T'
     C                     ADD  ZAMTT     WWTIMV
     C                     END
     C*
     C** STORE CONVERTED MARKET VALUE AS MARKET VALUE PORTFOLIO CCY
     C                     Z-ADDZAMTT     WWMVPC
     C*
     C** MOVE MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWMVPC    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCVL
     C*
     C** IF NEXT INTEREST DATE ON PMHDVNLL IS ZERO
     C                     MOVE '0'       *IN31
     C                     MOVE *BLANKS   R2MMPC
     C*
     C           QFACIS    IFEQ *ZEROS                     B1
     C                     MOVE '1'       *IN31
     C*
     C** CALCULATE PERCENTAGE
     C           QFTVDA    IFNE 'T'                        B2
     C           WWPORT    IFEQ *ZEROS                     B3
     C***********          Z-ADD*ZEROS    WWIPC1  43H                     076624
     C                     Z-ADD*ZEROS    WWIPC1                          076624
     C                     ELSE                            X3
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           ZAMTT     DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END                             E3
     C***********WWIPC1    MULT 100       WWIPC2  41H                     076624
     C           WWIPC1    MULT 100       WWIPC2                          076624
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC    H
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2MMPC
     C                     END                             E2
     C*
     C                     ELSE                            X1
     C                     MOVE *BLANKS   R2MMPC
     C                     END                             E1
     C           WWWORK    IFEQ 0
     C                     MOVE *BLANKS   R2PCVL
     C***                  MOVE 'N/A'     R2PCVL                         056552
     C                     MOVE '0 '      R2PCVL                         056552
     C                     MOVE *BLANKS   R2MMPC
     C                     END
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C** OUTPUT MARKET FX RATE USING 'ZCRSRT' OUTPUT FROM ZCCYCN
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C*
     C** IF DEAL IS FORWARD VALUED OUTPUT TEXT 'FORWARD'
     C           QFTVDA    IFEQ 'T'
     C           WWTVPS    ANDEQ'T'                                       47617
     C           QFTVDA    OREQ 'X'                                       47617
     C           WWTVPS    ANDEQ'V'                                       47617
     C                     MOVE WWMG26    R2FWRD
     C                     ELSE
     C                     MOVE *BLANKS   R2FWRD
     C                     END
     C*
     C** WRITE DETAIL LINE (W1002)
     C                     MOVE QFTXT2    R2DES7
     C*
     C** CALL P14 TO SET UP ACCRUED INTEREST DETAILS
     C                     EXSR #P14
     C*
     C** CALCULATE PERCENTAGE HELD IN INSTRUMENT
     C****                 MOVE *BLANKS   R2MMPC                          62295
     C           QFACIS    IFNE 0                          B1
     C                     MOVE *BLANKS   R2MMPC                          62295
     C           QFTVDA    IFEQ 'T'                        B2
     C           WWPORT    OREQ *ZEROS
     C***********          Z-ADD*ZEROS    WWIPC1  43H                     076624
     C                     Z-ADD*ZEROS    WWIPC1                          076624
     C                     ELSE                            X3
     C           ZAMTT     ADD  WWMVPC    WWTOTV 150
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           WWTOTV    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     ADD  WWMVPC    WWTOTV                          CPM005
     C           WWTOTV    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     ADD  WWMVPC    WWTOTV                          CPM005
     C           WWTOTV    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END                             E2
     C***********WWIPC1    MULT 100       WWIPC2  41H                     076624
     C           WWIPC1    MULT 100       WWIPC2                          076624
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC    H
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2MMPC
     C                     END                             E1
     C*
     C** WRITE DETAIL LINE (W1003)
     C                     MOVELQFTRNB    R2TRSN
     C*
     C                     MOVELR2DES7    R2CCY
     C*                                                                   S01313
     C** OUTPUT PLACED WITH CUSTOMER NAME                                 S01313
     C********** QFPLWH    IFNE 0                                                      S01313 CSD027
     C           QFPLWH    IFNE *BLANKS                                                       CSD027
     C                     MOVE QFPLWH    WWPLWH  6                       S01313
     C*                                                                   S01313
     C**   ACCESS CUSTOMER DETAILS FOR PLACED WITH NAME                   S01313
     C***********WWPLWH    CHAINSDCUSTL0             60             S01313S01486
     C                     MOVELWWPLWH    KEYCN                           S01486
     C                     CALL 'AOCUSTR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM           KEYCN  10                       S01486
     C                     PARM *BLANKS   KEYST   7                       S01486
     C           SDCUST    PARM SDCUST    DSSDY                           S01486
     C*                                                                   S01313
     C**   IF RECORD NOT FOUND OR LAST CHANGE TYPE = 'D' THEN DB ERROR    S01313
     C************IN60     IFEQ '1'                                 S01313S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C                     Z-ADD18        WBASE                           S01313
     C                     MOVE *BLANKS   WBFILE           ***************S01313
     C                     MOVEL'SDCUSTL0'WBFILE           ** DBERROR  018S01313
     C                     MOVE *BLANKS   WBKEY            ***************S01313
     C                     MOVELWWPLWH    WBKEY                           S01313
     C                     MOVE '9'       WWRTCD                          S01313
     C                     EXSR *PSSR                                     S01313
     C                     END                                            S01313
     C*                                                                   S01313
     C                     MOVELBBCRNM    R2PLWC                          S01313
     C                     MOVE BBCRTN    R2PLWC                          S01313
     C                     MOVELWW5240    MS5240                          S01313
     C                     ELSE                                           S01313
     C                     MOVE *BLANKS   R2PLWC                          S01313
     C                     MOVE *BLANKS   MS5240                          S01313
     C                     END                                            S01313
     C*                                                                   S01313
     C** OUTPUT FROM DATE                                                 S01313
     C           QFVDAT    IFNE 0                                         S01313
     C                     Z-ADDQFVDAT    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    R2VDAT
     C                     MOVELWW5241    MS5241                          S01313
     C                     ELSE                                           S01313
     C                     MOVE *BLANKS   R2VDAT                          S01313
     C                     MOVE *BLANKS   MS5241                          S01313
     C                     END                                            S01313
     C/COPY WNCPYSRC,PM9952C008
     C** CALL P16 TO OUTPUT TOTAL DETAILS
     C                     WRITEP952DT10
     C                     WRITEP952DT11
     C                     WRITEP952DT12
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P11     - PROCESS FX DEALS AND FRA/IRS                          *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWMG16   - 'BUY' NARRATIVE FOR FX DEALS                          *
      * WWMG17   - 'SELL' NARRATIVE FOR FX DEALS                         *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      *                                                                  *
      ********************************************************************
     C*
     C           #P11      BEGSR
     C*
     C** MOVE LINE 1 AMOUNT FROM PMHDVNLL INTO WORK FIELD FOR Y01
     C                     MOVE *BLANKS   R2FOXX
     C                     MOVE *BLANKS   R2FORM
     C                     Z-ADDWW1DEC    WWPDEC
     C                     Z-ADDQFAMT1    WWWORK
     C****                                                                061190
     C***CALL SUBROUTINE TO SET UP OUTPUT FIELD                           061190
     C****                 Z-ADDQFCDP1    WWPDEC                          061190
     C****                 EXSR #Y01                                      061190
     C*                                                                   061190
     C                     Z-ADDQFAMT1    ZFLD15                          061190
     C                     Z-ADDQFCDP1    ZDECS                           061190
     C                     MOVE 'J'       ZECODE                          061190
     C                     EXSR ZSEDIT                                    061190
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2AMT1
     C           QFFPLC    IFEQ QFCCY1
     C                     Z-ADDQFCDP1    WWPDEC
     C                     ELSE
     C                     Z-ADDQFCDP2    WWPDEC
     C                     END
     C                     Z-ADDQFMVAL    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2FOXX
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DES8
     C                     MOVELR2DES8    R2CCY1
     C*
     C** MOVE 'BUY' OR 'SELL' ACCORDING TO 'BUY OR SELL FIRST' INDIC
     C********** QFBYSF    IFEQ 'B'                                       CPM005
     C                     MOVELWWMG16    R2MG16
     C                     MOVELWWMG17    R2MG17
     C**********           ELSE                                           CPM005
     C**********           MOVELWWMG17    R2MG16                          CPM005
     C**********           MOVELWWMG16    R2MG17                          CPM005
     C**********           END                                            CPM005
     C****                                                                061190
     C***MOVE LINE 2 AMOUNT FROM PMHDVNLL INTO WORK FIELD FOR Y01         061190
     C****                 Z-ADDWW2DEC    WWPDEC                          061190
     C****                 Z-ADDQFAMT2    WWWORK                          061190
     C****                                                                061190
     C***CALL SUBROUTINE TO SET UP OUTPUT FIELD                           061190
     C                     EXSR #Y01                                      061190
     C*                                                                   061190
     C                     Z-ADDQFAMT2    ZFLD15                          061190
     C                     Z-ADDQFCDP2    ZDECS                           061190
     C                     MOVE 'J'       ZECODE                          061190
     C                     EXSR ZSEDIT                                    061190
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2AMT2
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT2    R2DES9
     C                     MOVELR2DES9    R2CCY2
     C*                                                                   CPM005
     C** ALWAYS OUTPUT BOUGHT CURRENCY FIRST                              CPM005
     C                     MOVE R2AMT1    WRAMT1 15                       CPM005
     C                     MOVE R2AMT2    WRAMT2 15                       CPM005
     C*                                                                   CPM005
     C           QFBYSF    IFEQ 'B'                                       CPM005
     C                     MOVE QFCCY1    R2CCY1                          CPM005
     C                     MOVE QFCCY2    R2CCY2                          CPM005
     C                     ELSE                                           CPM005
     C                     MOVE QFCCY2    R2CCY1                          CPM005
     C                     MOVE QFCCY1    R2CCY2                          CPM005
     C                     MOVE WRAMT2    R2AMT1                          CPM005
     C                     MOVE WRAMT1    R2AMT2                          CPM005
     C                     END                                            CPM005
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL USING ZEDIT
     C           QFBFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2BFXR
     C*
     C                     END
     C*
     C** OUTPUT MARKET FX RATE USING 'ZCRSRT' OUTPUT FROM ZCCYCN
     C           QFMFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MFXR
     C                     END
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C           QFMVAL    IFNE 0
     C                     Z-ADDQFMVAL    WWWORK
     C***********QFFPLC    CHAINSDCURRL0             73                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM QFFPLC    KEYCY   3                       S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C************IN73     IFEQ '1'                                       S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C                     Z-ADD5         WBASE
     C                     MOVE *BLANKS   WBFILE           ***************
     C                     MOVEL'SDCURRL0'WBFILE           ** DBERROR  005
     C                     MOVE *BLANKS   WBKEY            ***************
     C                     MOVELWWPTCY    WBKEY
     C                     MOVE '9'       WWRTCD
     C                     EXSR *PSSR
     C                     END
     C                     Z-ADDA6NBDP    WWPDEC
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C                     ELSE
     C                     MOVE *BLANKS   R2FXPL
     C                     END
     C           QFPLFX    IFNE 0
     C                     Z-ADDQFPLMK    WWWORK
     C***********QFFPLC    CHAINSDCURRL0             73                   S01486
     C                     CALL 'AOCURRR0'                                S01486
     C                     PARM *BLANKS   RTCD                            S01486
     C                     PARM '*KEY'    OPTN                            S01486
     C                     PARM QFFPLC    KEYCY                           S01486
     C           SDCURR    PARM SDCURR    DSSDY                           S01486
     C**
     C************IN73     IFEQ '1'                                       S01486
     C           RTCD      IFNE *BLANKS                                   S01486
     C                     Z-ADD5         WBASE
     C                     MOVE *BLANKS   WBFILE           ***************
     C                     MOVEL'SDCURRL0'WBFILE           ** DBERROR  005
     C                     MOVE *BLANKS   WBKEY            ***************
     C                     MOVELWWPTCY    WBKEY
     C                     MOVE '9'       WWRTCD
     C                     EXSR *PSSR
     C                     END
     C                     Z-ADDWWPDCS    WWPDEC
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2FORM
     C                     ELSE
     C                     MOVE *BLANKS   R2FORM
     C                     END
     C*
     C           QFOPCL    IFEQ 'C'
     C           QFOPCL    OREQ 'M'
     C                     MOVE *BLANKS   R2FPLC
     C                     ELSE
     C                     MOVELQFFPLC    R2FPLC
     C                     END
     C           QFOPCL    IFEQ 'L'
     C                     ADD  QFPLFX    WWNREA 150
     C                     END
     C           QFOPCL    IFEQ 'O'
     C                     ADD  QFPLFX    WWYREA 150
     C                     END
     C*
     C** FORMAT FX DEAL TEXT FOR ENQUIRIES
     C           QFOPCL    IFEQ 'L'
     C                     MOVE *BLANKS   R2OPCL
     C                     MOVELWWMG27    R2OPCL
     C                     END
     C*
     C           QFOPCL    IFEQ 'O'
     C                     MOVELWWMG28    R2OPCL
     C                     MOVE QFRLDN    R2OPCL
     C                     MOVE *BLANKS   R2MFXR
     C                     END
     C*
     C           QFOPCL    IFEQ 'C'
     C*
     C           QFDTYP    IFEQ 'OP'
     C                     MOVE *BLANKS   R2OPCL
     C                     MOVELWWMG29    R2OPCL
     C                     MOVE *BLANKS   R2MFXR
     C                     ELSE
     C                     MOVELWWMG30    R2OPCL
     C                     MOVE QFRLDN    R2OPCL
     C                     MOVE *BLANKS   R2MFXR
     C                     END
     C*
     C                     MOVE *BLANKS   R2FXPL
     C                     MOVE *BLANKS   R2FPLC
     C*
     C                     END
     C*
     C** FORMAT ACCRUED INTEREST
     C           QFOPCL    IFNE 'C'
     C                     Z-ADDQFPLFX    WWWORK
     C                     ADD  QFPLFX    WWTINT
     C                     ADD  QFPLFX    ZAMTT
     C                     Z-ADDWWPDCS    WWPDEC
     C                     EXSR #Y01
     C                     END
     C*
     C                     MOVE *BLANKS   R2FORP                          62295
     C           QFPLFX    IFNE 0
     C           WWPORT    ANDNE0
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           QFPLFX    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           QFPLFX    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           QFPLFX    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C           WWIPC1    MULT 100       WWIPC2    H
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C           QFOPCL    IFEQ 'L'
     C           QFOPCL    OREQ ' '
     C***********          ADD  WWIPC1    WWOPPC  43H                     076624
     C                     ADD  WWIPC1    WWOPPC  53H                     076624
     C                     END
     C*
     C           QFOPCL    IFEQ 'O'
     C***********          ADD  WWIPC1    WWCLPC  43H                     076624
     C                     ADD  WWIPC1    WWCLPC  53H                     076624
     C                     END
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2FORP
     C                     END
     C*
     C** WRITE DETAIL LINE (W1103)
     C                     MOVELQFTRNB    R2TRAN
     C/COPY WNCPYSRC,PM9952C009
     C                     WRITEP952DT13
     C                     WRITEP952DT14
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P12     - PROCESS LE HOLDINGS                                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P12      BEGSR
     C****                                                                061190
     C***OUTPUT NOMINAL/QTY FROM PMHDVNLL USING ZSEDIT                    061190
     C****                 Z-ADDWW1DEC    WWPDEC                          061190
     C****                 Z-SUBQFAMT1    WWWORK                          061190
     C****                                                                061190
     C***CALL SUBROUTINE TO SET UP OUTPUT FIELD                           061190
     C****                 EXSR #Y01                                      061190
     C*                                                                   061190
     C           FCPORS    IFNE 'B'                                       CPM004
     C                     Z-SUBQFAMT1    ZFLD15                          061190
     C                     ELSE                                           CPM004
     C                     Z-ADDQFAMT1    ZFLD15                          CPM004
     C                     END                                            CPM004
     C                     Z-ADDQFCDP1    ZDECS                           061190
     C                     MOVE 'J'       ZECODE                          061190
     C                     EXSR ZSEDIT                                    061190
     C*
     C** OUTPUT NOMINAL/QTY TO REPORT
     C                     MOVE ZOUT21    R2QTY1
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT NAME FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DS10
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP1    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C           QFTVDA    IFNE 'T'
     C                     ADD  ZAMTT     WWTIMV
     C                     END
     C*
     C** STORE CONVERTED MARKET VALUE AS MARKET VALUE PORTFOLIO CCY
     C                     Z-ADDZAMTT     WWMVPC
     C*
     C** MOVE MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWMVPC    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2CCYV
     C*
     C** IF NEXT INTEREST DATE ON PMHDVNLL IS ZERO
     C                     MOVE '0'       *IN31
     C                     MOVE *BLANKS   R2OPPC
     C*
     C           QFACIS    IFEQ *ZEROS
     C                     MOVE '1'       *IN31
     C*
     C** CALCULATE PERCENTAGE
     C           QFTVDA    IFNE 'T'
     C           WWPORT    IFEQ *ZEROS
     C***********          Z-ADD*ZEROS    WWIPC1  43H                     076624
     C                     Z-ADD*ZEROS    WWIPC1  53H                     076624
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           ZAMTT     DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C***********WWIPC1    MULT 100       WWIPC2  41H                     076624
     C           WWIPC1    MULT 100       WWIPC2  51H                     076624
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2OPPC
     C                     END
     C*
     C                     ELSE
     C                     MOVE *BLANKS   R2OPPC
     C                     END
     C           WWWORK    IFEQ 0
     C                     MOVE *BLANKS   R2CCYV
     C***                  MOVE 'N/A'     R2CCYV                          056552
     C                     MOVE '0 '      R2CCYV                          056552
     C                     MOVE *BLANKS   R2OPPC
     C                     END
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL USING ZEDIT
     C           QFBFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2BFXR
     C*
     C                     END
     C*
     C** OUTPUT MARKET FX RATE USING MARKET RATE FROM PMHDVNLL
     C           QFMFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MFXR
     C                     END
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C           QFPLFX    IFNE 0
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C                     ELSE
     C                     MOVE *BLANKS   R2FXPL
     C                     END
     C*
     C** IF DEAL IS FORWARD VALUED OUTPUT TEXT 'FORWARD'
     C           QFTVDA    IFEQ 'T'
     C           WWTVPS    ANDEQ'T'                                       47617
     C           QFTVDA    OREQ 'X'                                       47617
     C           WWTVPS    ANDEQ'V'                                       47617
     C                     MOVE WWMG26    R2FWR1
     C                     ELSE
     C                     MOVE *BLANKS   R2FWR1
     C                     END
     C*
     C** WRITE DETAIL LINE (W1202)
     C                     MOVE QFTXT2    R2DS11
     C*
     C** CALL P14 TO SET UP ACCRUED INTEREST DETAILS
     C                     EXSR #P14
     C*
     C** CALCULATE PERCENTAGE HELD IN INSTRUMENT
     C                     MOVE *BLANKS   R2MMPC
     C           QFACIS    IFNE 0                          B1
     C                     MOVE '1'       *IN31
     C           QFTVDA    IFEQ 'T'                        B2
     C           WWPORT    OREQ *ZEROS
     C***********          Z-ADD*ZEROS    WWIPC1  43H                     076624
     C                     Z-ADD*ZEROS    WWIPC1  53H                     076624
     C                     ELSE                            X3
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B10            CPM005
     C           ZAMTT     ADD  WWMVPC    WWTOTV 150
     C           WWTOTV    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X10            CPM005
     C           QFASLI    IFEQ 'A'                        B20            CPM005
     C           WWASSV    IFNE *ZEROS                     B30            CPM005
     C           ZAMTT     ADD  WWMVPC    WWTOTV                          CPM005
     C           WWTOTV    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X30            CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E30            CPM005
     C                     ELSE                            X20            CPM005
     C           WWLIAV    IFNE *ZEROS                     B30            CPM005
     C           ZAMTT     ADD  WWMVPC    WWTOTV                          CPM005
     C           WWTOTV    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X30            CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E30            CPM005
     C                     END                             E20            CPM005
     C                     END                             E10            CPM005
     C*                                                                   CPM005
     C                     END                             E2
     C***********WWIPC1    MULT 100       WWIPC2  41H                     076624
     C           WWIPC1    MULT 100       WWIPC2  51H                     076624
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC    H
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2OPPC
     C                     END                             E1
     C*
     C** WRITE DETAIL LINE (W1203)
     C                     MOVELQFTRNB    R2TNUM
     C                     MOVELR2DS11    R2CCY
     C/COPY WNCPYSRC,PM9952C010
     C                     WRITEP952DT16
     C                     WRITEP952DT17
     C                     WRITEP952DT18
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P13     - PROCESS RE HOLDINGS                                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      * #P15     - PRODUCE RE ACCRUED INTEREST DETAILS                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      * WWNOM1   - USED TO FORMAT NOMINAL/QTY FOR RE HOLDINGS            *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTIMV   - TOTAL INSTRUMENT MARKET VALUE                         *
      * WWMVPC   - MARKET VALUE PORTFOLIO CURRENCY                       *
      * WWIDES   - USED TO SET UP LINE 3 INSTRUMENT DESCRIPTION          *
      * WWIDSC   - USED TO SET UP LINE 3 INSTRUMENT DESCRIPTION          *
      *                                                                  *
      ********************************************************************
     C*
     C           #P13      BEGSR
     C*
     C** OUTPUT NOMINAL/QTY FROM PMHDVNLL USING ZSEDIT
     C                     Z-ADDWW1DEC    WWPDEC
     C           FCPORS    IFNE 'B'                                       CPM004
     C                     Z-SUBQFAMT1    WWWORK
     C                     ELSE                                           CPM004
     C                     Z-ADDQFAMT1    WWWORK                          CPM004
     C                     END                                            CPM004
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** OUTPUT NOMINAL/QTY TO REPORT
     C                     MOVE ZOUT21    WWNOM1 18
     C                     Z-ADDWWPDCS    WWPDEC
     C*********************MOVELWWNOM1    R2NOM1                          038233
     C*                                                                   038233
     C           FCPORS    IFNE 'B'                                       CPM004
     C                     Z-SUBQFAMT1    ZFLD15                          038233
     C                     ELSE                                           CPM004
     C                     Z-ADDQFAMT1    ZFLD15                          CPM004
     C                     END                                            CPM004
     C                     Z-ADDQFCDP1    ZDECS                           038233
     C                     MOVE 'J'       ZECODE                          038233
     C                     EXSR ZSEDIT                                    038233
     C                     MOVE ZOUT21    R2NOM1                          038233
     C*                                                                   056459
     C** IF VALUE DATE POSITIONS AND OTHER NOMINAL DIFFERENT OUTPUT       056459
     C** FIGURES IN BRACKETS                                              056459
     C                     MOVE *BLANKS   R2NQT2                          056459
     C           QFAMT1    IFNE QFOAMT                                    056459
     C           QFOAMT    ANDNE*HIVAL                                    056459
     C           FCPORS    IFNE 'B'                                       CPM004
     C                     Z-SUBQFOAMT    ZFLD15                          056459
     C                     ELSE                                           CPM004
     C                     Z-ADDQFOAMT    ZFLD15                          CPM004
     C                     END                                            CPM004
     C                     Z-ADDQFCDP1    ZDECS                           056459
     C                     MOVE 'J'       ZECODE                          056459
     C                     EXSR ZSEDIT                                    056459
     C                     MOVE ZOUT21    WWWK17 17                       056459
     C                     MOVELWWWK17    R2NQT2                          056459
     C                     MOVEL'('       R2NQT2                          056459
     C                     MOVE ')'       R2NQT2                          056459
     C                     END                                            056459
     C*
     C** OUTPUT INSTRUMENT NAME FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DS12
     C*
     C** CONVERT MARKET VALUE FROM CCY1 TO PORTFOLIO CCY USING ZCCYXR
     C** AND FX RATES STORED ON FILE
     C                     Z-ADDQFMVAL    ZAMTF
     C                     Z-ADDQFCDP1    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFMVPC    ZAMTT                           47863
     C*
     C** OUTPUT MARKET RATE USING RATE FROM FILE
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MKRT
     C*
     C** ADD CONVERTED MARKET VALUE (ZAMTT) TO TOTAL INST MARKET VALUE
     C**         QFTVDA    IFNE 'T'
     C                     ADD  ZAMTT     WWTIMV
     C*
     C** STORE CONVERTED MARKET VALUE AS MARKET VALUE PORTFOLIO CCY
     C                     Z-ADDZAMTT     WWMVPC
     C*
     C** MOVE MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWMVPC    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCYV
     C*
     C** IF ACCRUE INTEREST ON PMHDVNLL IS ZERO CALCULATE PORTFOLIO PERCENTAGE
     C                     MOVE '0'       *IN31
     C                     MOVE *BLANKS   R2REPC
     C*
     C           QFACIS    IFEQ *ZEROS
     C                     MOVE '1'       *IN31
     C*
     C** CALCULATE PERCENTAGE
     C           WWPORT    IFEQ *ZEROS
     C***********          Z-ADD*ZEROS    WWIPC1  43H                     076624
     C                     Z-ADD*ZEROS    WWIPC1                          076624
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           ZAMTT     DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           ZAMTT     DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C***********WWIPC1    MULT 100       WWIPC2  41H                     076624
     C           WWIPC1    MULT 100       WWIPC2                          076624
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2REPC
     C                     END
     C           WWWORK    IFEQ 0
     C                     MOVE *BLANKS   R2PCYV
     C***                  MOVE 'N/A'     R2PCYV                          056552
     C                     MOVE '0 '      R2PCYV                          056552
     C                     MOVE *BLANKS   R2REPC
     C                     END
     C*
     C** WRITE DETAIL LINE (W1301)
     C*
     C** WRITE DETAIL LINE (W1302)
     C                     MOVE QFTXT2    R2DS13
     C*
     C** SET UP LINE 3 INSTRUMENT DESCRIPTION FOR REPORT
     C**********           MOVELWWACCD    WWIDES  5                                           CGL029
     C                     MOVELWWACCD    WWIDES 11                                           CGL029
     C                     MOVE '-'       WWIDES
     C**********           MOVELWWIDES    WWIDSC  7                                           CGL029
     C                     MOVELWWIDES    WWIDSC 13                                           CGL029
     C                     MOVE WWACSQ    WWIDSC
     C*
     C** WRITE DETAIL LINE (W1303)
     C*
     C** CALL SUBROUTINE P15 TO PRODUCE RE ACCRUED INTEREST DETAILS
     C                     EXSR #P15
     C                     MOVE QFCCY1    R2CCY
     C*
     C           QFMVPC    IFNE 0                                         056552
     C           QFACIS    ORNE 0                                         056552
     C           WWWK17    ORNE *ZEROS                                    065115
     C/COPY WNCPYSRC,PM9952C011
     C                     WRITEP952DT19
     C                     WRITEP952DT20
     C                     MOVE *BLANKS   R2NQT2                          056459
     C                     END                                            056552
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P10     - PROCESS MM DEALS                                      *
      * #P12     - PROCESS LE HOLDINGS                                   *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTINT   - TOTAL INSTRUMENT INTEREST                             *
      * WWTMVP   - TOTAL MARKET VALUE IN PORTFOLIO CURRENCY              *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      *                                                                  *
      ********************************************************************
     C*
     C           #P14      BEGSR
     C*
     C** OUTPUT NUMBER OF DAYS ACCRUED INTEREST FROM PMHDVNLL
     C                     MOVE QFNODA    R2NDAI
     C*
     C** OUTPUT NEXT INTEREST DATE FROM PMHDVNLL USIND ZDATE2
     C                     Z-ADDQFNIDT    ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZADATE    R2NIDT
     C*
     C** CONVERT ACCRUED INT. FROM CCY1 TO PORTFOLIO CCY USING ZCCYCN
     C                     Z-ADDQFACIS    ZAMTF
     C           QFMODI    IFNE 'SE'
     C                     Z-ADDQFCDP1    ZCDPF
     C                     ELSE
     C                     Z-ADDQFCDP2    ZCDPF
     C                     END
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C*
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFAIPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED ACCRUED INTEREST (ZAMTT) TO TOTAL INST. INTEREST
     C                     ADD  ZAMTT     WWTINT
     C                     ADD  ZAMTT     WWTIMV
     C*
     C** ADD CONVERTED ACCRUED INTEREST TO WORK FIELD MARKET VALUE
     C**   PORTFOLIO CURRENCY (FROM CALLING PROCESS) TO GIVE TOTAL
     C**     MARKET VALUE IN PORTFOLIO CURRENCY
     C           WWMVPC    ADD  ZAMTT     WWTMVP
     C*
     C** IF ACCRUED INTEREST NOT ZERO FORMAT AMOUNT FOR OUTPUT
     C           ZAMTT     IFNE 0
     C                     Z-ADDZAMTT     WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PACC
     C                     MOVE '1'       *IN30
     C                     ELSE
     C                     MOVE *BLANKS   R2PACC
     C                     MOVE '0'       *IN30
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P15     - PRODUCE RE ACCRUED INTEREST DETAILS                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZCCYCN   - CONVERT AMOUNT FROM ONE CURRENCY TO ANOTHER           *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P13     - PROCESS RE HOLDINGS                                   *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWPTCY   - PORTFOLIO CURRENCY PARAMETER                          *
      * WW1SPR   - SPOT RATE FOR CURRENCY 1 ON PMHDVNLL                  *
      * WWPSPR   - SPOT RATE FOR PORTFOLIO CURRENCY                      *
      * WW1MDI   - MULTIPLY/DIVIDE INDICATOR FOR CCY 1 ON PMHDVNLL       *
      * WWPMDI   - MULTIPLY/DIVIDE INDICATOR FOR PORTFOLIO CURRENCY      *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      * WWTINT   - TOTAL INSTRUMENT INTEREST                             *
      * WWTMVP   - TOTAL MARKET VALUE IN PORTFOLIO CURRENCY              *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      **WWPORT***-*PORTFOLIO*TOTAL*CALCULATED*FROM*VALUES*ON*PMPOTTPP*****S01486
      * WWPORT   - PORTFOLIO TOTAL CALCULATED FROM VALUES ON PMPOTTPD    *S01486
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P15      BEGSR
     C*
     C** CHECK WHETHER INTEREST ACCRUED IS NON ZERO
     C           QFACIS    IFNE 0
     C                     MOVE '1'       *IN30
     C                     ELSE
     C                     MOVE '0'       *IN30
     C                     END
     C*
     C** CONVERT ACCRUED INT. FROM CCY1 TO PORTFOLIO CCY USING ZCCYCN
     C                     Z-ADDQFACIS    ZAMTF
     C                     Z-ADDQFCDP1    ZCDPF
     C                     Z-ADDWWPDEC    ZCDPT
     C                     Z-ADDQFMFXR    ZCRSRT
     C                     MOVE QFMFMD    ZCRSMD
     C                     EXSR ZCCYXR
     C           ZCRSMD    IFEQ 'D'
     C           ZCRSRT    ANDGT0
     C           1         DIV  ZCRSRT    ZCRSRT    H
     C                     MOVEL'M'       ZCRSMD
     C                     END
     C                     Z-ADDQFAIPC    ZAMTT                           47863
     C*
     C** ADD CONVERTED ACCRUED INTEREST (ZAMTT) TO TOTAL INST. INTEREST
     C                     ADD  ZAMTT     WWTINT
     C                     ADD  ZAMTT     WWTIMV
     C*
     C** MOVE ACCRUED INTEREST FOR INSTRUMENT INTO WORK FIELD
     C                     Z-ADDZAMTT     WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PACC
     C*
     C** ADD CONVERTED ACCRUED INTEREST TO WORK FIELD MARKET VALUE
     C**   PORTFOLIO CURRENCY (FROM CALLING PROCESS) TO GIVE TOTAL
     C**     MARKET VALUE IN PORTFOLIO CURRENCY
     C           WWMVPC    ADD  ZAMTT     WWTMVP
     C*
     C** MOVE TOTAL MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     Z-ADDWWTMVP    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** CALCULATE PERCENTAGE
     C           WWPORT    IFEQ *ZEROS
     C***********          Z-ADD*ZEROS    WWIPC1  43H                     076624
     C                     Z-ADD*ZEROS    WWIPC1                          076624
     C                     ELSE
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           WWTMVP    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           WWTMVP    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           WWTMVP    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END
     C***********WWIPC1    MULT 100       WWIPC2  41H                     076624
     C           WWIPC1    MULT 100       WWIPC2                          076624
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC    H
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2PRCB
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P16     - PRODUCE TOTALS LINE                                   *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P10     - PROCESS MM DEALS                                      *
      * #P12     - PROCESS LE HOLDINGS                                   *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWIPC1   - WORK FILED USED IN THE CALCULATION OF PERCENTAGE      *
      * WWIPC2   - WWIPC1 MULTIPLIED BY 100 TO GIVE PERCENTAGE           *
      * WWTIPC   - TOTAL INSTRUMENT PERCENTAGE                           *
      *                                                                  *
      ********************************************************************
     C*
     C           #P16      BEGSR
     C*                                                                   S71062
     C           WWMODI    IFEQ 'FF'                       B1             S71062
     C           WWGRTO    ANDNE*ZEROS                                    S71062
     C                     Z-ADD*ZEROS    ZFLD15                          S71062
     C                     MOVE WWGRTO    ZFLD15                          S71062
     C*********************Z-ADDWWCDP2    ZDECS                    S71062 102681
     C                     Z-ADDWWPDEC    ZDECS                           102681
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    R2GRTO                          S71062
     C*                                                                   S71062
     C** CALCULATE PERCENTAGE                                             S71062
     C           WWPORT    IFEQ *ZEROS                     B1             S71062
     C***********          Z-ADD*ZEROS    WWIPC1  43H               S71062076624
     C                     Z-ADD*ZEROS    WWIPC1                          076624
     C                     ELSE                            X1             S71062
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           WWGRTO    DIV  WWPORT    WWIPC1    H                     S71062
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           WWGRTO    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           WWGRTO    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END                             E1             S71062
     C***********WWIPC1    MULT 100       WWIPC2  41H               S71062076624
     C           WWIPC1    MULT 100       WWIPC2                          076624
     C*                                                                   S71062
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE             S71062
     C                     Z-ADD*ZEROS    ZFLD15                          S71062
     C                     MOVE WWIPC2    ZFLD15                          S71062
     C                     Z-ADD1         ZDECS                           S71062
     C                     MOVE 'J'       ZECODE                          S71062
     C                     EXSR ZSEDIT                                    S71062
     C                     MOVE ZOUT21    R2GRTP                          S71062
     C                     WRITEP952GTOT                                  S71062
     C                     Z-ADD*ZEROS    WWGRTO 160                      S71062
     C                     ELSE                            X1             S71062
     C                     MOVE *BLANKS   R2GRTO                          S71062
     C                     MOVE *BLANKS   R2GRTP                          S71062
     C                     END                             E1             S71062
     C*
     C** MOVE TOTAL MARKET VALUE PORTFOLIO CURRENCY INTO WORK FIELD
     C                     ADD  WWNREA    WWTIMV                          063048
     C                     ADD  WWYREA    WWTIMV                          063048
     C                     Z-ADDWWTIMV    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2PCVA 15
     C                     MOVE ZOUT21    R2TOTL
     C*
     C** CALCULATE PERCENTAGE
     C           WWPORT    IFEQ *ZEROS                     B1
     C***********          Z-ADD*ZEROS    WWIPC1  43H                     076624
     C                     Z-ADD*ZEROS    WWIPC1                          076624
     C                     ELSE                            X1
     C*                                                                   CPM005
     C           WWPCAM    IFEQ 'N'                        B1             CPM005
     C           WWTIMV    DIV  WWPORT    WWIPC1    H
     C                     ELSE                            X1             CPM005
     C           QFASLI    IFEQ 'A'                        B2             CPM005
     C           WWASSV    IFNE *ZEROS                     B3             CPM005
     C           WWTIMV    DIV  WWASSV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1                          CPM005
     C                     END                             E3             CPM005
     C                     ELSE                            X2             CPM005
     C           WWLIAV    IFNE *ZEROS                     B3             CPM005
     C           WWTIMV    DIV  WWLIAV    WWIPC1    H                     CPM005
     C                     ELSE                            X3             CPM005
     C                     Z-ADD*ZEROS    WWIPC1           X3             CPM005
     C                     END                             E3             CPM005
     C                     END                             E2             CPM005
     C                     END                             E1             CPM005
     C*                                                                   CPM005
     C                     END                             E1
     C***********WWIPC1    MULT 100       WWIPC2  41H                     076624
     C           WWIPC1    MULT 100       WWIPC2                          076624
     C*
     C** ADD CALCULATED PERCENTAGE TO TOTAL INSTRUMENT PERCENTAGE
     C                     ADD  WWIPC2    WWTIPC    H
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2TOTP
     C           WWPCAM    IFEQ 'S'                                       CPM005
     C                     EXSR #GRTO                                     CPM005
     C                     END                                            CPM005
     C           WWWORK    IFEQ 0                          B1
     C                     MOVE *BLANKS   R2TOTL
     C***                  MOVE 'N/A'     R2TOTL                          056552
     C                     MOVE '0 '      R2TOTL                          056552
     C                     MOVE *BLANKS   R2TOTP
     C                     END                             E1
     C*
     C** MOVE UNREALISED FOREX                TO WORK FIELD
     C           WWNREA    IFNE 0                          B1
     C                     Z-ADDWWNREA    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO PRINTER FILE
     C                     MOVE ZOUT21    R2NREA
     C***********          MOVE ZOUT21    R2NREB                          S01486
     C                     ELSE                            E1
     C                     MOVE *BLANKS   R2NREA
     C***********          MOVE *BLANKS   R2NREB                          S01486
     C                     END                             E1
     C** MOVE   REALISED FOREX    P/L         TO WORK FIELD
     C           WWYREA    IFNE 0                          B1
     C                     Z-ADDWWYREA    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT TO PRINTER FILE
     C                     MOVE ZOUT21    R2YREA
     C***********          MOVE ZOUT21    R2YREB                          S01486
     C                     ELSE                            E1
     C                     MOVE *BLANKS   R2YREA
     C***********          MOVE *BLANKS   R2YREB                          S01486
     C                     END                             E1
     C           WWMODI    IFEQ 'FX'                       B1
     C                     MOVE *BLANKS   R2FXNR
     C                     MOVE *BLANKS   R2FXRE
     C*
     C           WWOPPC    IFNE 0                          B2
     C***********WWOPPC    MULT 100       WWIPC2  41H                     076624
     C           WWOPPC    MULT 100       WWIPC2                          076624
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2FXNR
     C                     END                             E2
     C*
     C           WWCLPC    IFNE 0                          B2
     C***********WWCLPC    MULT 100       WWIPC2  41H                     076624
     C           WWCLPC    MULT 100       WWIPC2                          076624
     C*
     C** CALL STANDARD SUBROUTINE ZSEDIT TO OUTPUT PERCENTAGE
     C                     Z-ADD*ZEROS    ZFLD15
     C                     MOVE WWIPC2    ZFLD15
     C                     Z-ADD1         ZDECS
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C                     MOVE ZOUT21    R2FXRE
     C                     END                             E2
     C*
     C                     WRITEP952FET3
     C                     Z-ADD*ZEROS    WWNREA
     C                     Z-ADD*ZEROS    WWYREA
     C                     Z-ADD*ZEROS    WWOPPC
     C                     Z-ADD*ZEROS    WWCLPC
     C***********          ELSE                            X1             063048
     C                     ELSE                            X1             112920
     C                     Z-ADD0         WWNREA                          063048
     C                     Z-ADD0         WWYREA                          063048
     C                     END                                            063048
     C           WWTIMV    IFNE 0                          B2
     C                     WRITEP952DET3
     C                     END                             E2
     C***********          END                             E1             063048
     C                     Z-ADD*ZERO     WWTIMV
     C*
     C                     ENDSR
      ********************************************************************CPM005
      /EJECT                                                              CPM005
      ********************************************************************CPM005
      *                                                                  *CPM005
      * #GRTO    - OUTPUT GROUP TOTAL                                    *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLS:                                                *CPM005
      * #P16     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *CPM005
      *                                                                  *CPM005
      * SUBROUTINE CALLED FROM:                                          *CPM005
      *                                                                  *CPM005
      * ROUTINE USES VARIABLES:                                          *CPM005
      *                                                                  *CPM005
      ********************************************************************CPM005
     C*                                                                   CPM005
     C           #GRTO     BEGSR                                          CPM005
     C*                                                                   CPM005
     C**********           Z-ADDQFCNUM    K2CNUM                                       CPM005 CSD027
     C                     MOVE QFCNUM    K2CNUM                                              CSD027
     C                     Z-ADD*ZEROS    K2INSS                          CPM005
     C                     MOVELQFPTFR    K2PTFR                          CPM005
     C                     MOVEL'D'       K2TOTT                          CPM005
     C*                                                                   101118
     C** 1st read with current position  FEPOTY = 'C '                    101118
     C                     MOVEL'C '      K2POTY                          101118
     C                     MOVELK2DGRC    SVDGRC  3                       101118
     C                     Z-ADDK2DGRS    SVDGRS  20                      101118
     C*                                                                   CPM005
     C           PMASL0    SETLLPMASLIL0                                  CPM005
     C                     READ PMASLIL0                 73               CPM005
     C*                                                                   CPM005
     C           *IN73     IFEQ '1'                                       CPM005
     C           F3CNUM    ORNE K2CNUM                                    101118
     C           F3DGRC    ORNE K2DGRC                                    101118
     C           F3PTFR    ORNE K2PTFR                                    101118
     C           F3POTY    ORNE K2POTY                                    101118
     C           F3TOTT    ORNE K2TOTT                                    101118
     C******************** Z-ADD6         WBASE                    CPM005 101118
     C******************** MOVE *BLANKS   WBFILE           ********CPM005 101118
     C******************** MOVEL'PMASLIL0'WBFILE           ** DBERRCPM005 101118
     C******************** MOVE *BLANKS   WBKEY            ********CPM005 101118
     C******************** MOVELWWERRO    WBKEY                    CPM005 101118
     C******************** MOVE '9'       WWRTCD                   CPM005 101118
     C******************** EXSR *PSSR                              CPM005 101118
     C                     Z-ADD*ZEROS    F3ASSV                          101118
     C                     Z-ADD*ZEROS    F3LIAV                          101118
     C                     END                                            CPM005
     C*                                                                   CPM005
     C                     Z-ADDF3ASSV    SVASSV 150                      097944
     C                     Z-ADDF3LIAV    SVLIAV 150                      097944
     C*                                                                   101118
     C** 2nd read with future opened position  FEPOTY = 'FO'              101118
     C**********           Z-ADDQFCNUM    K2CNUM                                       097944 CSD027
     C                     MOVE QFCNUM    K2CNUM                                              CSD027
     C                     Z-ADD*ZEROS    K2INSS                          097944
     C                     MOVELQFPTFR    K2PTFR                          097944
     C                     MOVEL'FO'      K2POTY                          097944
     C                     MOVEL'D'       K2TOTT                          097944
     C                     MOVELSVDGRC    K2DGRC                          101118
     C                     Z-ADDSVDGRS    K2DGRS                          101118
     C*                                                                   097944
     C           PMASL0    SETLLPMASLIL0                                  097944
     C                     READ PMASLIL0                 73               097944
     C*                                                                   097944
     C           *IN73     IFEQ '1'                                       097944
     C           F3CNUM    ORNE K2CNUM                                    099985
     C           F3DGRC    ORNE K2DGRC                                    099985
     C           F3PTFR    ORNE K2PTFR                                    099985
     C           F3POTY    ORNE K2POTY                                    099985
     C           F3TOTT    ORNE K2TOTT                                    099985
     C                     Z-ADD*ZEROS    F3ASSV                          097944
     C                     Z-ADD*ZEROS    F3LIAV                          097944
     C                     END                                            097944
     C*                                                                   097944
     C                     ADD  F3ASSV    SVASSV                          101118
     C                     ADD  F3LIAV    SVLIAV                          101118
     C*                                                                   101118
     C** 3nd read with future closed position  FEPOTY = 'FC'              101118
     C**********           Z-ADDQFCNUM    K2CNUM                                       101118 CSD027
     C                     MOVE QFCNUM    K2CNUM                                              CSD027
     C                     Z-ADD*ZEROS    K2INSS                          101118
     C                     MOVELQFPTFR    K2PTFR                          101118
     C                     MOVEL'FC'      K2POTY                          101118
     C                     MOVEL'D'       K2TOTT                          101118
     C                     MOVELSVDGRC    K2DGRC                          101118
     C                     Z-ADDSVDGRS    K2DGRS                          101118
     C*                                                                   101118
     C           PMASL0    SETLLPMASLIL0                                  101118
     C                     READ PMASLIL0                 73               101118
     C*                                                                   101118
     C           *IN73     IFEQ '1'                                       101118
     C           F3CNUM    ORNE K2CNUM                                    101118
     C           F3DGRC    ORNE K2DGRC                                    101188
     C           F3PTFR    ORNE K2PTFR                                    101118
     C           F3POTY    ORNE K2POTY                                    101118
     C           F3TOTT    ORNE K2TOTT                                    101118
     C                     Z-ADD*ZEROS    F3ASSV                          101118
     C                     Z-ADD*ZEROS    F3LIAV                          101118
     C                     END                                            101118
     C*                                                                   101118
     C                     ADD  SVASSV    F3ASSV                          101118
     C                     ADD  SVLIAV    F3LIAV                          101118
     C*                                                                   101118
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE F3ASSV    ZFLD15                          CPM005
     C                     Z-ADDWWPDEC    ZDECS                           CPM005
     C                     MOVE 'J'       ZECODE                          CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    R2TOTL                          CPM005
     C*                                                                   CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE F3LIAV    ZFLD15                          CPM005
     C                     Z-ADDWWPDEC    ZDECS                           CPM005
     C                     MOVE 'J'       ZECODE                          CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    R2TOTA                          CPM005
     C*                                                                   CPM005
     C           WWASSV    IFNE *ZEROS                                    CPM005
     C***********F3ASSV    DIV  WWASSV    WWDIVI  43H               CPM005CPM005
     C***********WWDIVI    MULT 100       WWPERC  41H               CPM005CPM005
     C           F3ASSV    DIV  WWASSV    WWDIVI  53H                     CPM005
     C           WWDIVI    MULT 100       WWPERC  51H                     CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADD*ZEROS    WWPERC                          CPM005
     C                     END                                            CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPERC    ZFLD15                          CPM005
     C                     Z-ADD1         ZDECS                           CPM005
     C                     MOVE 'J'       ZECODE                          CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    R2TOTP                          CPM005
     C*                                                                   CPM005
     C           WWLIAV    IFNE *ZEROS                                    CPM005
     C                     Z-SUBF3LIAV    WWFLD4 150                      CPM005
     C***********WWFLD4    DIV  WWLIAV    WWDIVI  43H               CPM005CPM005
     C***********WWDIVI    MULT 100       WWPERC  41H               CPM005CPM005
     C           WWFLD4    DIV  WWLIAV    WWDIVI  53H                     CPM005
     C           WWDIVI    MULT 100       WWPERC  51H                     CPM005
     C                     ELSE                                           CPM005
     C                     Z-ADD*ZEROS    WWPERC                          CPM005
     C                     END                                            CPM005
     C                     Z-ADD*ZEROS    ZFLD15                          CPM005
     C                     MOVE WWPERC    ZFLD15                          CPM005
     C                     Z-ADD1         ZDECS                           CPM005
     C                     MOVE 'J'       ZECODE                          CPM005
     C                     EXSR ZSEDIT                                    CPM005
     C                     MOVE ZOUT21    R2TOPC                          CPM005
     C*                                                                   CPM005
     C                     ENDSR                                          CPM005
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #P17     - OUTPUT LOMBARD DETAILS ON VALUATION STATEMENT         *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      * ZEDIT    - INSERT DECIMAL POINT AND BLANK LEADING ZEROS          *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P06     - DETERMINE TYPE OF HOLDING                             *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWORK   - GENERAL WORK FIELD INPUT TO #Y01                      *
      *                                                                  *
      ********************************************************************
     C*
     C           #P17      BEGSR
     C****                                                                061190
     C***MOVE LINE 1 AMOUNT FROM PMHDVNLL INTO WORK FIELD FOR Y01         061190
     C****                 Z-ADDWW1DEC    WWPDEC                          061190
     C****                 Z-ADDQFAMT1    WWWORK                          061190
     C****                                                                061190
     C***CALL SUBROUTINE TO SET UP OUTPUT FIELD                           061190
     C****                 EXSR #Y01                                      061190
     C*                                                                   061190
     C                     Z-ADDQFAMT1    ZFLD15                          061190
     C                     Z-ADDQFCDP1    ZDECS                           061190
     C                     MOVE 'J'       ZECODE                          061190
     C                     EXSR ZSEDIT                                    061190
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2AMT1
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT1    R2DES8
     C*
     C** CHECK WHETHER GUARANTEE/PLEDGE GIVEN/RECEIVED
     C                     MOVELQFTXT2    WWCHK5  5
     C                     MOVE WWCHK5    WWCHK1  1
     C           WWCHK1    IFEQ 'R'
     C                     MOVE '1'       *IN30
     C                     ELSE
     C                     MOVE '0'       *IN30
     C                     END
     C*
     C** WRITE DETAIL LINE (W1101)
     C                     WRITEP952DT24
     C****                                                                061190
     C***SAVE LINE 2 AMOUNT FROM PMHDVNLL INTO WORK FIELD FOR Y01         061190
     C****                 Z-ADDWW1DEC    WWPDEC                          061190
     C****                 Z-ADDQFAMT2    WWWORK                          061190
     C****                                                                061190
     C***CALL SUBROUTINE TO SET UP OUTPUT FIELD                           061190
     C****                 EXSR #Y01                                      061190
     C*                                                                   061190
     C                     Z-ADDQFAMT2    ZFLD15                          061190
     C                     Z-ADDQFCDP2    ZDECS                           061190
     C                     MOVE 'J'       ZECODE                          061190
     C                     EXSR ZSEDIT                                    061190
     C*
     C** MOVE OUTPUT TO REPORT
     C                     MOVE ZOUT21    R2AMT2
     C                     Z-ADDWWPDCS    WWPDEC
     C*
     C** OUTPUT INSTRUMENT DESCRIPTION FROM PMHDVNLL
     C                     MOVE QFTXT2    R2DES9
     C*
     C** OUTPUT BOOK FX RATE FROM PMHDVNLL USING ZEDIT
     C           QFBFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFBFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2BFXR
     C*
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2BFXR
     C*
     C                     END
     C*
     C** OUTPUT MARKET FX RATE USING 'ZCRSRT' OUTPUT FROM ZCCYCN
     C           QFMFXR    IFNE *ZEROS
     C                     MOVE *BLANKS   ZFIELD
     C                     Z-ADDQFMFXR    WWRATE  84H
     C                     MOVE WWRATE    ZFIELD
     C                     Z-ADD4         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    R2MFXR
     C                     ELSE
     C*
     C                     MOVE *BLANKS   R2MFXR
     C                     END
     C*
     C** MOVE PROFIT/LOSS - FX FROM PMHDVNLL INTO WORK FIELD
     C           QFPLFX    IFNE 0
     C                     Z-ADDQFPLFX    WWWORK
     C*
     C** CALL SUBROUTINE TO SET UP OUTPUT FIELD
     C                     EXSR #Y01
     C*
     C** MOVE OUTPUT FIELD TO PRINTER FILE
     C                     MOVE ZOUT21    R2FXPL
     C                     ELSE
     C                     MOVE *BLANKS   R2FXPL
     C                     END
     C*
     C** WRITE DETAIL LINE (W1102)
     C                     WRITEP952DT25
     C*
     C** WRITE DETAIL LINE (W1103)
     C                     MOVELQFTRNB    R2TRAN
     C                     WRITEP952DT26
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #Y01     - CONVERT AMOUNTS INTO VALUES FOR OUTPUT                *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      * ZSEDIT   - CONVERT DECIMAL AMOUNT TO CHARACTER                   *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P03     - PRODUCE INSTRUMENT TOTALS                             *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      * #P08     - PROCESS SE NON INTEREST-BEARING HOLDINGS              *
      * #P09     - PROCESS FF HOLDINGS                                   *
      * #P10     - PROCESS MM DEALS                                      *
      * #P11     - PROCESS FX DEALS AND FRA/IRS                          *
      * #P12     - PROCESS LE HOLDINGS                                   *
      * #P13     - PROCESS RE HOLDINGS                                   *
      * #P14     - PROCESS NON-RE ACCRUED INTEREST DETAILS               *
      * #P15     - PRODUCE RE ACCRUED INTEREST DETAILS                   *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWFLD0   - USED WHEN PORTFOLIO CURRENCY HAS NO DECIMAL PLACES    *
      * WWFLD1   - USED WHEN PORTFOLIO CURRENCY HAS ONE DECIMAL PLACE    *
      * WWFLD2   - USED WHEN PORTFOLIO CURRENCY HAS TWO DEC. PLACES      *
      * WWFLD3   - USED WHEN PORTFOLIO CURRENCY HAS THREE DEC. PLACES    *
      * WWPDEC   - NUMBER OF DECIMAL PLACES IN PORTFOLIO CURRENCY        *
      *                                                                  *
      ********************************************************************
     C*
     C           #Y01      BEGSR
     C*
     C** INITIALISE FIELDS USED FOR AMOUNT
     C*
     C                     Z-ADD*ZEROS    WWFLD0 150
     C                     Z-ADD*ZEROS    WWFLD1 151
     C                     Z-ADD*ZEROS    WWFLD2 152
     C                     Z-ADD*ZEROS    WWFLD3 153
     C*
     C** SET INDICATOR FOR NUMBER OF DECIMAL PLACES
     C*
     C                     MOVEA'0000'    *IN,23
     C           23        ADD  WWPDEC    V       20
     C                     MOVEA'1'       *IN,V
     C*
     C** MOVE TOTAL INSTRUMENT MARKET VALUE INTO CORRECT FIELD
     C           *IN23     IFEQ '1'
     C                     MOVE WWWORK    WWFLD0
     C                     Z-ADDWWFLD0    ZFLD15
     C                     ELSE
     C           *IN24     IFEQ '1'
     C                     MOVE WWWORK    WWFLD1
     C                     Z-ADDWWFLD1    ZFLD15    H
     C                     ELSE
     C           *IN25     IFEQ '1'
     C                     MOVE WWWORK    WWFLD2
     C                     Z-ADDWWFLD2    ZFLD15    H
     C                     ELSE
     C           *IN26     IFEQ '1'
     C                     MOVE WWWORK    WWFLD3
     C                     Z-ADDWWFLD3    ZFLD15    H
     C                     END
     C                     END
     C                     END
     C                     END
     C*                                                                   62295
     C                     Z-ADDWWWORK    ZFLD15                          62295
     C*
     C** EXECUTE STANDARD SUBROUTINE ZSEDIT FOR MARKET VALUE
     C****                 Z-ADD*ZEROS    ZDECS                           62295
     C                     Z-ADDWWPDEC    ZDECS                           62295
     C                     MOVE 'J'       ZECODE
     C                     EXSR ZSEDIT
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #Y02     - CONVERT YIELD AMOUNTS TO FORMAT REQUIRED ON REPORT    *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #P07     - PROCESS SE INTEREST-BEARING HOLDINGS                  *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      * WWWYLD   - GENERAL WORK FIELD OF BOOK OR MARKET YIELD            *
      * WWHADJ   - USED TO HALF ADJUST YIELD AMOUNT FOR REPORT FORMAT    *
      * WWROUN   - USED TO ROUND YIELD AMOUNT FOR REPORT FORMAT          *
      *                                                                  *
      ********************************************************************
     C*
     C           #Y02      BEGSR
     C*
     C** MOVE LEFT THE FIRST FIVE FIGURES OUTPUT FROM ZEDIT TO OUTPUT
     C**   FIELD REQUIRED ON REPORT
     C                     MOVE *BLANKS   WWWYLD  6
     C                     MOVELWWYLDS    WWWYLD
     C*
     C** IF THE FOURTH DECIMAL POSITION IN OUTPUT FROM ZEDIT >= 5
     C           WWHADJ    IFGE 5
     C*
     C** ADD ONE TO THIRD DECIMAL POSITION TO ROUND UP
     C                     ADD  1         WWROUN
     C*
     C** MOVE ROUNDED UP FIGURE INTO OUTPUT FIELD
     C                     MOVE WWROUN    WWWYLD
     C*
     C                     ELSE
     C*
     C** LEAVE FIGURE AS IT STANDS AND MOVE TO OUTPUT FIELD
     C                     MOVE WWROUN    WWWYLD
     C*
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * #TITLE   - OUTPUT NEW PAGE HEADING                               *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      ********************************************************************
     C           #TITLE    BEGSR
     C*
     C                     ADD  1         WWPNBR
     C           QFMODI    IFEQ 'FX'
     C                     MOVE *BLANKS   MSGDT0
     C                     MOVELWWPNBR    MSGDT0
     C***********          MOVE 'PMS5501' MSGID                           S01486
     C                     MOVE 'PM95405' MSGID                           S01486
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELRESULT    R1PAGE
     C                     WRITEP951HD2
     C                     WRITEP952FDR1
     C                     MOVE 'FOREX'   @TITRE  5
     C                     ELSE
     C                     MOVE *BLANKS   MSGDT0
     C                     MOVELWWPNBR    MSGDT0
     C***********          MOVE 'PMS5501' MSGID                           S01486
     C                     MOVE 'PM95405' MSGID                           S01486
     C                     CALL 'ZA1310'  ZA1311
     C                     MOVELRESULT    R1PAGE
     C           QFMODI    IFEQ 'FF'                                      S71062
     C                     MOVEL*BLANKS   R2PCCY                          S71062
     C                     END                                            S71062
     C                     WRITEP951HD2
     C                     WRITEP952HDR1
     C                     MOVE 'VALUE'   @TITRE
     C                     END
     C*
     C                     ENDSR
      ********************************************************************
      /EJECT
      /COPY ZSRSRC,ZDATE2Z2
      /EJECT
      /COPY ZSRSRC,ZSEDITZ3
      /EJECT
      /COPY ZSRSRC,ZEDITZ2
      ****/EJECT                                                           47719
      ****/COPY ZSRSRC,ZCCYCN                                              47719
      /EJECT                                                              S01486
      /COPY ZSRSRC,ZCCYCN                                                 S01486
      /EJECT
      /COPY ZSRSRC,ZCCYXR
      /EJECT                                                              S71062
      /COPY ZSRSRC,FFPRCSZ4                                               S71062
     C**************************************************************************
      /EJECT
      ********************************************************************
      *                                                                  *
      * *PSSR    - PROGRAM ERROR HANDLING ROUTINE                        *
      *                                                                  *
      * SUBROUTINE CALLS:                                                *
      *                                                                  *
      * SUBROUTINE CALLED FROM:                                          *
      * #INIT    - INITIAL PROCESSING                                    *
      * #P02     - PRODUCE VALUATION GROUP HEADING                       *
      * #P04     - PRODUCE INSTRUMENT TYPE HEADINGS                      *
      * #P05     - ACCESS CURRENCY DETAILS                               *
      *                                                                  *
      * ROUTINE USES VARIABLES:                                          *
      *                                                                  *
      ********************************************************************
     C*
     C           *PSSR     BEGSR
     C*
     C** UPDATE DTAARA/LDA WITH DETAILS OF ERROR
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
     C                     MOVE WBFILE    DBFILE
     C                     MOVE WBKEY     DBKEY
     C                     Z-ADDWBASE     DBASE
     C                     MOVE WBPGM     DBPGM
     C                     OUT  LDA
     C                     OPEN PM9952AU                                  S01486
     C                     WRITEPM9952F0                                  S01486
     C                     WRITEPM9952F1                                  S01486
     C*                                                                   S01486
     C** Report printer file to RCF via ZSFILE                            S01486
     C*                                                                   S01486
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01486
     C                     CALL 'ZSFILE'                                  S01486
     C                     PARM           SEQ     5                       S01486
     C                     PARM           @ENT    3                       S01486
     C                     PARM           SFILEU                          S01486
     C                     PARM           ZSNUMU                          S01486
     C                     PARM *BLANKS   ZSERR   1                       S01486
     C*                                                                   S01486
     C** Error during ZSFILE processing, return to calling program        S01486
     C*                                                                   S01486
     C           ZSERR     IFEQ 'Y'                                       S01486
     C                     SETON                     U7U8LR               S01486
     C                     END                                            S01486
     C*
     C**   DUMP AND RETURN TO CALLING PROGRAM
     C                     MOVE '1'       *INLR
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     DUMP
     C                     RETRN
     C*
     C           #PSSR0    ENDSR
     C*****************************************************************
      /EJECT
**  CPY@
(c) Finastra International Limited 2001
**   POWER - POWERS OF 10 FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
