     H***********                                                         S01117
     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Customer exchanges input')                    *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module                                        *
     F*                                                               *
     F*  RE0150 - CUSTOMER EXCHANGES INPUT                            *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD031950           Date 17Jun15               *
      *                 CRE041             Date 28Sep12               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP205             Date 23Feb10               *
      *                 CAP204             Date 09Feb10               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CDL049             Date 11May06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG7274            Date 23Jun05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6224            Date 18Mar05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3954            Date 11Aug04               *
      *                 BUG2488            Date 31May04               *
      *                 CGL014             Date 20Oct03               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 07May04               *
      *                 BUG2304            Date 30Apr04               *
      *                 CRE020             Date 20Jan04               *
      *                 CRE019             Date 15Mar04               *
      *                 CGL029             Date 01Sep03               *
      *                 208221             Date 11Dec02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 205232             Date 30Apr02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 199219             Date 07Jan02               *
      *                 188387             Date 23Nov01               *
      *                 194983             Date 29Aug01               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 14Dec99               *
      * Midas DBA 3.05 -----------------------------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 176510             Date 05Apr00               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 02MAR99               *
      *                 CTI002             DATE 09Sep98               *
     F*                 134071             DATE 16Oct98               *
     F*                 132339  (124290)   DATE 22May98               *
     F*                 116966             DATE 21APR98               *
     F*                 124290             DATE 27FEB98               *
     F*                 123468             DATE 26FEB98               *
     F*                 122319             DATE 24FEV98               *
     F*                 084152             DATE 15JAN98               *
     F*                 CCB002             DATE 16JUL96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 S01408             DATE 30OCT95               *
     F*                 S01408             DATE 06SEP95               *
     F*                 080721             DATE 28MAR95               *
     F*                 078610             DATE 03MAR95               *
     F*                 078607             DATE 03MAR95               *
     F*                 S01408             DATE 22FEB95               *
     F*                 083135             DATE 13FEB95               *
     F*                 S01408             DATE 16JAN95               *
     F*                 072169             DATE 06OCT94               *
     F*                 S01408             DATE 22AUG94               *
     F*                 061995     ADE     DATE 14OCT93               *
     F*                 036434     SL      DATE 27FEB92               *
     F*                 S01413                  13APR93               *
     F*                 059665                  27OCT93               *
     F*                 050831                  30JUL93               *
     F*                 E41808                  07JUL92               *
     F*                 E42978                  01JUL92               *
     F*                 E41812                  07JUL92               *
     F*                 RT0067                  14MAY91               *
     F*                 E22221                  31MAY90               *
     F*                 S01252                  03FEB90               *
     F*                 S01251                  03FEB90               *
     F*                 S01241                  08JAN90               *
     F*                 E20493                  13DEC89               *
     F*                 LN0085                  02MAY90               *
     F*                 S01194                  26FEB90               *
     F*                 S01199                  19DEC89               *
     F*                 HK0000                  31/10/89              *
     F*                 S01117                  27/10/89              *
     F*                 E17935                  06/06/89              *
     F*                 E16125                  05/04/89              *
     F*                 E16124                  05/04/89              *
     F*                 E16127                  05/04/89              *
     F*                 E16123                  05/04/89              *
     F*                 S01154                  16/09/88              *
     F*                 E13304                  15/07/88              *
     F*                 E13302                  11/07/88              *
     F*                 E13254                  11/07/88              *
     F*                 E12270                  29/03/88              *
     F*                 E11649                  22/10/87              *
     F*                 E11725                  15/10/87              *
     F*                 E11643                  13/10/87              *
     F*                 E10485                  21/09/87              *
     F*                 S05452                  20/08/87              *
     F*                 S01111                  17/06/86              *
0011 F*                                                               *
0011 F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  MD031950 - Recompiled due to changed PF/CUSEXZ1.             *
      *  CRE041 - Enhancements to Customer Exchanges (Recompile)      *
      *  CAP205 - Teller Related APIs - Account Balance Check         *
      *  CAP204 - Teller Related APIs - Account Transfer (Recompile)  *
      *  CDL049 - Addition of a Reference Rate field (recompile)      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG7274 - Show warning message when value date falls on      *
      *            holiday.                                           *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6224 - Error encountered in Customer Exchange Maintenance *
      *            Apply Fix 186017.                                  *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3954- 677 CUSX: User tried to delete transaction but      *
      *           DBERR occurred. Ammend such that program will not   *
      *           update presented cheque table when deleting a       *
      *           transaction that does not have a cheque number.     *
      *  BUG2488- Logical file REDDSSRCDV/TTRANL6 is based over  a    *
      *           phsical which is set to members = *nomax.  Amend    *
      *           TTRANL6 and create a  new logical file TTRANL7.     *
      *  CGL014 - Collaterals Processing                              *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Webfacing Changes. Change *IN85 to *IN58 for CRE019 *
      *  BUG2304 - Various file layout changes. Recompile.            *
      *  CRE020 - Midas Plus Online Printing of Advices (GE7)         *
      *  CRE019 - Cheque Processing and Maintenance                   *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  208221 - Only do tolerance warning for FX Margin if          *
     F*           Analytical Accounting is on                         *
      *  205232 - Blank out before moving customer number to key field*
      *  199219 - Ensure that the accounts in PF/CUSEXCE is correctly *
      *           updated with the fields entered on screen.          *
      *  188387 - Allow insertion of retail account even if retail    *
      *           account number is 0.                                *
      *  194983 - When checking for blocked A/C MOVEL Customer Number *
      *           to CLIKEY rather than MOVE.                         *
      *  CDE002 - Revenue Analysis                                    *
     F*  176510 - Values added to the Call of access object AOPRFMR0  *
     F*           for Customer number (CNUM) and Account Officer      *
     F*           (ACOF) - to improve the assignment the default      *
     F*           profit centre.                                      *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*  134071 - Different problems with Insert and Delete of        *
     F*           Customer Exchanges, particularly relating to update *
     F*           of MEMOS and RSACMTPD, particularly using different *
     F*           combinations of retail/non-retail accounts.  Errors *
     F*           occur also when a system is not set-up to use       *
     F*           retail account number.                              *
     F*         - When DR account is GL/DL and CR account is Retail,  *
     F*           db error occurs because memos update is attempted   *
     F*           without checking if account is retail.  Fix 124290  *
     F*           did not work in this case.                          *
     F*         - When DR account is Retail and CR account is GL/DL,  *
     F*           PF/RSACMTPD and PF/MEMOS are not updated after the  *
     F*           exchange was accepted.  Keys should be set-up       *
     F*           properly such that files MEMOS and RSACMTPD are     *
     F*           updated accordingly.                                *
     F*         - If the system does not support Retail a/c number,   *
     F*           db error occurs when the inserted Customer Exchange *
     F*           is deleted.  The 18 long account reference should   *
     F*           be used for all types of account.                   *
     F*         - DR/CR currency fields are mandatory entry; program  *
     F*           should not default any value.                       *
     F*         - Also set DRRET to '1' only if retail a/c.           *
     F*         - Also for a retail charge a/c, MEMOS should be       *
     F*           credited for insertion and debited for deletion.    *
     F*  132339 - Fix 124290 does not work if DR A/c is a GL A/c and  *
     F*           CR A/c is Retail A/c.  With this case ATYP of DR a/c*
     F*           is being overwritten by ATYP of CR A/c.             *
     F*  116966 - A customer exchange is accepted by the system with  *
     F*           an exchange rate which doesn't balance the debit and*
     F*           credit amounts entered.                             *
     F*  124290 - Modification CCB002 has changed this program to use *
     F*           access object AOMEMSU0.Originally it would chain to *
     F*           MEMOS and if the account was not there it would not *
     F*           not show a DB error. Bypass code in question if a/c *
     F*           is not retail. Add field set-up for deletion.       *
     F*  123468 - Validate inserted currency when debit/credit account*
     F*           number is inputted in customer exchange.            *
     F*  122319 - Update Open Position correctly for Customer         *
     F*           Exchange Transaction. Applied fix 118668.           *
     F*  084152 - Wrong base currency equivalent check if Retail A/C  *
     F*           Numbers used.                                       *
     F*  CCB002 - COB Performance Enhancements                        *
     F*           Access now via access object                        *
     F*           Change MEMOS processing to use access objects.      *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           Add new field FX Margin Points and FX Margin        *
     F*           DR/CR indicator.                                    *
     F*  S01408 - Addition of Core Hook RE0150CP21                    *
     F*  S01408 - Addition of Core Hook RE0150CCP8                    *
     F*           Addition of Core Hook RE0150CCP9                    *
     F*           Addition of Core Hook RE0150CP10                    *
     F*           Addition of Core Hook RE0150CP11                    *
     F*           Addition of Core Hook RE0150CP12                    *
     F*           Addition of Core Hook RE0150CP13                    *
     F*           Addition of Core Hook RE0150CP14                    *
     F*           Addition of Core Hook RE0150CP15                    *
     F*           Addition of Core Hook RE0150CP16                    *
     F*           Addition of Core Hook RE0150CP17                    *
     F*           Addition of Core Hook RE0150CP18                    *
     F*           Addition of Core Hook RE0150CP19                    *
     F*           Addition of Core Hook RE0150CP20                    *
     F*  080721 - For reversal of customer exchange, memos balance    *
     F*           is debited instead of credited and vice versa.      *
     F*  078610 - If a nostro has been input today there will be no   *
     F*           PRONO record for this nostro - pgm should update    *
     F*           the record for nostro 00 (Unallocated) instead of   *
     F*           outputting DBERR 701, 705 or 706                    *
     F*  078607 - Display correct message if user not authorised      *
     F*           to action code.                                     *
     F*         - Make error message field long enough to display     *
     F*           whole message (messages in the array have been      *
     F*           amended to remove numbers at the end)               *
     F*  S01408 - Hook RE0150CVS1 added.                              *
     F*           Hook RE0150CVS2 added.                              *
     F*           Hook RE0150CVS3 added.                              *
     F*           Hook RE0150CEX1 added.                              *
     F*           Hook RE0150CCAU added.                              *
     F*  083135 - Correct processing after call to window manager.    *
     F*  S01408 - Hook RE0150CCP5 added.                              *
     F*           Hook RE0150CCP6 added.                              *
     F*           Hook RE0150CCP7 added.                              *
     F*  072169 - Correct validation for base currency equivalent     *
     F*  S01408 - Hook RE0150FFPG added.                              *
     F*           Hook RE0150IIP1 added.                              *
     F*           Hook RE0150IIP2 added.                              *
     F*           Hook RE0150IIP3 added.                              *
     F*           Hook RE0150CCPG added.                              *
     F*           Hook RE0150CEXV added.                              *
     F*           Hook RE0150CCP1 added.                              *
     F*           Hook RE0150CCP2 added.                              *
     F*           Hook RE0150CCP3 added.                              *
     F*           Hook RE0150CCP4 added.                              *
     F*           Hook RE0150OOPG added.                              *
     F*  061995 - At very first use of program input generate a       *
     F*           blank reference due to cexno blank                  *
     F*  036434 - Blank input document nbr generated when             *
     F*           customer exchange transaction data area is          *
     F*           empty                                               *
     F*  S01413 - Retail 3 Incorporation                              *
     F*  059665 - Valid nostro codes are rejected with 907 or 908     *
     F*           Intermittent problem due to uninitialised values    *
     F*           inputted to AONOSTRO.                               *
     F*  050831 - Addition of update of OLPOS.                        *
0011 F*  E41808 - PRONO FILE NOT UPDATED                              *
0011 F*  E42978 - CAN INSERT INVALID DR. CURRENCY CAUSING             *
0011 F*           INVALID ACCOUNT TO UPDATE FILE.                     *
0011 F*  E41812 - REAL TIME STATEMENTS FILE NOT UPDATED   FOR         *
0011 F*           NOSTRO ACCOUNTS                                     *
0011 F*  RT0067 - AOPRFMR0 CAN RETURN CODE 0, 1 AND 2. CODE 0         *
     F*           INIDCATES NO ERROR. CODE 1 INDICATES NO PROFIT      *
     F*           CENTRE IS FOUND FOR THE COMBINATION INVOLVED AND    *
     F*           A BLANK CODE IS RETURNED. CODE 2 MEANS THAT A       *
     F*           PROFIT CENTRE IS FOUND BUT THAT PROFIT CENTRE IS    *
     F*           NOT VALID. TAKE OUT PROCESSING OF ERROR CODE 1      *
     F*           BECAUSE BLANK IS A VALID PROFIT CENTRE.             *
     F*  E22221 - ADDITIONAL CHANGE REQUIRED TO ALL NON-SYNON         *
     F*           MAINTENANCE FUNCTIONS PREVIOUSLY CHANGED FOR        *
     F*           TRANSACTION WINDOWS.                                *
     F*           ALSO, SETLL INTRODUCED BEFORE READ OF SDMMODPD.     *
     F*  S01252 - ADDITIONAL SPARE WINDOW MANAGER PARAMETER           *   S01252
     F*  S01251 - SYNON FIELD/PROGRAM NAME CHANGES                    *   S01251
     F*  S01241 - WINDOW INCORPORATION                                *   S01241
     F*  E20493 - CORRECTION TO ENSURE THAT ACCOUNT MOVEMENT          *   E20493
     F*           RECORDS OUTPUT TO RSACMTPD ARE OUTPUT WITH          *   E20493
     F*           DATA IN THEM. (PUT IN BY HK0000)                    *   E20493
     F*  S01194 - NEW STANDING DATA                                   *   S01194
     F*  S01199 - HELP CHANGES                                        *   S01199
     F*  HK0000 - BLANK RECORDS INCORRECTLY OUTPUT TO PF/RSACMTPD.    *   HK0000
     F*  S01117 - MULTIBRANCHING / PROFIT CENTRE                      *   S01117
     F*  E17935 - PROGRAM AMENDED TO PREVENT EXCHANGES ACROSS         *   E17935
     F*           BLOCKED ACCOUNTS.  ALSO, ERROR CODES CHANGED        *   E17935
     F*           AND HELP TEXT AMENDED.                              *   E17935
     F*  E16124 - EXCHANGE RATE TOLERANCE SHOULD BE CALCULATED        *   E16124
     F*           USING VALUE CALCULATED FROM SPOT RATE.              *   E16124
     F*           ALSO, FIX E11643 INTRODUCED ERROR WHEREBY CODE      *   E16124
     F*           '120' CAN ONLY OCCUR IF ANOTHER ERROR CODE IS       *   E16124
     F*           GENERATED AT THE SAME TIME.                         *   E16124
     F*  E16125 - HIGHLIGHT A/C NUMBER ERROR IF A/C CLOSED            *   E16125
     F*           ALSO - ACCNT & ACNUM DETAILS WITH RECI='C' ARE      *   E16125
     F*           NOT READ IN TO CHECK FOR CLOSED ACCOUNTS            *   E16125
     F*           AND, ERROR CODE '017' IS NOT OUTPUT FOR             *   E16125
     F*           NON-EXISTANT RETAIL ACCOUNTS.                       *   E16125
     F*           AND, ERROR CODES '110' & '111' RELATING TO THE      *   E16125
     F*           DR. AND CR. CURRENCY INPUT FIELDS HAVE BEEN         *   E16125
     F*           CHANGED TO '121' & '122' TO AVOID CONFUSION WITH    *   E16125
     F*           SEPARATE ERRORS WHICH ALSO HAVE CODES 110 & 111.    *   E16125
     F*  E16127 - CHAIN TO TABLE FILE TO CHECK VALUE DATE IS          *   E16127
     F*           WITHIN MAX. NUMBER OF DAYS FORWARD.                 *   E16127
     F*  E16123 - DATA STRUCTURE FOR ACCNT CHAIN NOT CLEARED EACH     *   E16123
     F*           TIME DISPLAY FILE IS READ IN.                       *   E16123
     F*  S01154 - CHANGES FOR REAL TIME STATEMENTS                    *   S01154
     F*  E13304 - WHEN BOTH A/C NUMBERS ARE INVALID ERROR CODE        *   E13304
     F*           '128' APPEARS TWICE AND ONLY THE CREDIT NUMBER      *   E13304
     F*           IS SHOWN IN REVERSE IMAGE. ALSO 'AMOUNT' AND        *   E13304
     F*           'BASE CCY EQUIV.' FIELDS INCORRECTLY VALIDATED      *   E13304
     F*           IF CURRENCY HAS ZERO DECIMAL PLACES.                *   E13304
     F*  E13302 - WRONG DATE USED BY 'MEMOS' UPDATE.                  *   E13302
     F*           NOW DIFFERENT DATES USED FOR CR & DR.               *   E13302
     F*  E13254 - WHEN A CUSTOMER EXCHANGE IS DELETED, 'MEMOS'        *   E13254
     F*           SHOULD BE UPDATED. ERROR IN S01111 PREVENTED        *   E13254
     F*           THIS.                                               *   E13254
     F*  E12270 - INCONSISTENT COMMAND KEY INSTRUCTIONS AND           *   E12270
     F*           RECORD INFORMATION DISPLAYED.                       *   E12270
     F*  E11649 - AMEND ERROR MESSAGE TO READ;                        *   E11649
     F*           RECORD NOT FOUND / ALREADY DELETED                  *   E11649
0011 F*  E11725 - WHEN RE-DISPLAYED A BLANK IS INSERTED IN THE        *   E11725
0011 F*           BASE CURRENCY EQUIVALENT FIELD. ALSO REVERCE        *   E11725
0011 F*           FIELD IN ERROR FOR ERROR CODE 128.                  *   E11725
     F*  E11643 - ERROR CODES '110' & '120' WERE APPEARING TWICE.     *   E11643
     F*  E10485 - FORWARD VALUED TRANS MUST UPDATE GEN LEDGER         *   E10485
     F*           BALANCE ONLY                                        *   E10485
0011 F*  S05452 - INCLUSION OF AUTO RECONCILIATIONS.                  *   S05452
     F*  S01111 - VALUE DATE AND CHARGES ON  CUSTOMER EXCHANGES.      *   S01111
0011 F*                                                               *
     F*****************************************************************
     F**0150FMCF**F*****377            WORKSTN                            S01111
     F**0150FMCF**F*****395            WORKSTN                   S01111   S05452
     F*E0150FMCF**F*****411            WORKSTN                      S05452S01117
     F*E0150FMCF**F*****421            WORKSTN                      S01117078607
     F***RE0150FMCF  F     437            WORKSTN                   078607CAC001
     F/COPY WNCPYSRC,RE0150F004
     F***RE0150FMCF  F     446            WORKSTN                                      CAC001 CGL029
     F***RE0150FMCF  F     464            WORKSTN                                      CGL029 CRE019
     F***RE0150FMCF  F     540            WORKSTN                                      CRE019 CAAA03
     FRE0150FMCF  F     596            WORKSTN                                                CAAA03
     F*CLINT**IF**F*****256  7AI     2 DISK                         S01111S01194
     F/COPY WNCPYSRC,RE0150F001
0020 F***ACNUM** IF  F      40 10AI     2 DISK                                                CGL029
     FACNUM   IF  F      46 10AI     2 DISK                                                   CGL029
     F/COPY WNCPYSRC,RE0150F002
0023 F*CCNT***IF**F*****400 15AI     2 DISK                               S01117
     F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
     F***ACCNT***IF**F     573 24AI     2 DISK                                         CGL029 CGL014
     FACCNT   IF  F     607 24AI     2 DISK                                                   CGL014
0017 F*TABLE**IF**F******96 12AI     2 DISK                               S01194
0022 F*MEMOS**UF**F******40            DISK         KCOMIT                CCB002
     F*******************                           KCOMIT                CCB002
0022 FPRONO   UF  F     128  5AI     2 DISK                               E41808
     F                                              KCOMIT                E41808
     F/COPY WNCPYSRC,RE0150F005
0022 FRSACMTPDO   E                    DISK                               S01154
     F                                              KCOMIT                S01154
0021 F***CUSEX***UF  F     256  6AI     2 DISK                            CAC001
     F***CUSEX** UF  F     275  6AI     2 DISK                                         CAC001 CGL029
     F***CUSEX   UF  F     305  6AI     2 DISK                                         CGL029 CRE019
     FCUSEX   UF  F     307  6AI     2 DISK                                                   CRE019
     F                                              KCOMIT
0021 F***CUSEXCE*O   F     256            DISK                            CAC001
     F***CUSEXCE O   F     275            DISK                                         CAC001 CGL029
     F***CUSEXCE O   F     305            DISK                                         CGL029 CRE019
     FCUSEXCE O   F     307            DISK                                                   CRE019
     F                                              KCOMIT
     F                                              KINFDS INFDS
     F                                              KINFSR INFSR
     F/COPY WNCPYSRC,RE0150F003
      *                                                                                       CRE019
      ** Midas RE Cheque Book file - 1                                                        CRE019
      *                                                                                       CRE019
     FCHQBKL1 UF  E           K        DISK         KINFSR *PSSR A                            CRE019
      *                                                                                       CRE019
      ** Midas RE Cheques Presented with Warning Messages                                     CRE019
      *                                                                                       CRE019
     FTTRANL6 IF  E           K        DISK                                                   CRE019
      *                                                                                       CRE019
     FTTRANL7 IF  E           K        DISK         KINFSR *PSSR      UC                     BUG2488
      ** Teller Trans. logical file of all presented cheques                                 BUG2488
      *                                                                                      BUG2488
     FSDTELDL1IF  E           K        DISK         KINFSR *PSSR                             BUG2488
      ** Teller Identification file                                                          BUG2488
      *                                                                                      BUG2488
     FOLPOS   UF  E           K        DISK         KINFSR INFSR          050831
     F                                              KCOMIT                050831
     F            OLPOSHHF                          KIGNORE               050831
     F            OLPOSOBF                          KIGNORE               050831
     F*                                                                   S01408
     F** Core hook for externalisation.                                   S01408
     F/COPY WNCPYSRC,RE0150FFPG                                           S01408
     F*                                                                   S01408
     FSDMMODPDIF  E                    DISK                           UC  S01241
      *                                                                                       CRE020
     FREADVCL2UF  E           K        DISK         KCOMIT       A    UC                      CRE020
      ** Midas RE Settled Transaction Index File by Ref No/Pgm Ref                            CRE020
      *                                                                                       CRE020
     FRE0150AUO   E                    PRINTER                            S01413
0024 F*
0025 F*
0026 F* ID F  C  H  L    FUNCTION OF INDICATORS
0027 F* 01            WRKSTN  - INITIAL SCREEN
0028 F* 02                    - INSERT SCREEN
0029 F* 03                    - DELETE SCREEN
0030 F* 04                    - CATCHALL
0031 F**05*******     TABLES  - INSTALLATION CONTROL RECORD 1             S01194
0032 F**06*******             -                      RECORD 2             S01194
0033 F**07*******             - CURRENCIES RECORD                         S01194
0034 F**08*******             - BRANCHES RECORD                           S01194
     F*     08        (Reused) During OLPUPD subr to do lookup        *   050831
     F*     08        Error in FX Margin Points                       *   CAC001
0035 F* 09            RETAIL ACNOS NOT SUPPORTED
     F*     09        (REUSED) BLOCKED DEBIT AND/OR CREDIT RETAIL ACCOUNT E17935
     F*     10        ERROR ON CHARGES A/C NO                             S01111
     F*     11        ERROR ON CHARGES SIGN                               S01111
     F*     12        ERROR ON CHARGES AMOUNT                             S01111
0039 F* 13            CUSEX TRAILER RECORD
0040 F* 14            MEMOS FILE - DETAIL RECORD
0041 F* 15            ACCOUNTS MASTER - DETAIL RECORD
0042 F* 16            RETAIL ACCOUNTS - DETAIL RECORD
0043 F* 17            CUSEX - OPEN RECORD
0044 F* 18            CUSEX - CLOSED RECORD
0045 F* 19            CUSEX - CATCHALL
     F*****20****     EXCHANGE IS OVER TWO BRANCHES                       S01117
     F*       20      TRANSACTION BRANCH IN ERROR                         S01117
     F*    21         BLANK/ZERO FIELDS ON INPUT - DR CUSTOMER
0048 F*    22                                    - DR CCY
0049 F*    23                                    - DR A/C CODE
0050 F*    24                                    - DR A/C SEQ.
0051 F*    25                                    - DR RETAIL CUST.
0052 F*    26                                    - DR RETAIL CCY
0053 F*****27************************************-*DR*CHEQUE*NO.*******   CAC001
     F*       27      Error in FX Margin DR/CR Indicator              *   CAC001
     F*
     F*****28****     INPUT BRCD IS INCOMPATABLE WITH ACCOUNT BRCDS
     F*       28      PROFIT CENTRE IN ERROR                              S01117
     F*
0055 F*    29         BLANK/ZERO FIELDS ON INPUT - CR CUSTOMER
0056 F*    30                                    - CR CCY.
0057 F*    31                                    - CR A/C CODE            E17935
0057 F*    32                                    - CR A/C SEQ.            E17935
0058 F*    33                                    - CR RETAIL A/C
0059 F*    34                                    - CR RETAIL CCY
0060 F*    35                                    - BSE CCY EQV.& DEC.POS
0061 F*****36*********ACCOUNT STATUS OPEN          & DEC POS.             E16125
     F* 36            ACCOUNTS MASTER - CLOSED A/C RECORD                 E16125
     F*    36                                      & DEC POS.             E16125
0062 F*****37*********RETAIL A/C STATUS OPEN       & DEC.POS.             E16125
     F* 37            RETAIL ACCOUNTS MASTER - CLOSED A/C RECORD          E16125
     F*    37                                      & DEC.POS.             E16125
0063 F*    38         OVERRIDE INDICATOR BLANK     & DEC.POS.
0064 F*****39***      DEFAULT BRANCH ZERO - MULTI BRANCH INDICATOR ON     S01117
     F*    39         DEBIT  A/C DETAILS INPUT ON SCREEN - ACTION - I     S01117
0065 F********40      FIRST CYCLE CALCULATIONS                            S01117
0065 F*       40      PROFIT CENTRE USED = 'N'                            S01117
0066 F*       41      PREVENT OUTPUT TO WORKSTN
0067 F*       42      OUTPUT TO CUSEX FILE TO RELEASE
0068 F*       43      PASS INITIAL FIELDS FROM INPUT TO WORKSTN
0069 F*       44      PASS OTHER FIELDS CUSEX RECORD TO WORKSTN
0070 F*       45      INSERT SCREEN
0071 F*       46      DELETE SCREEN
0072 F*       47      WORK INDICATOR AND MDIN DIVIDE TEST
0073 F*       48      ONE OF THE CURRENCIES EQUALS BASE CURRENCY
0074 F********49******OVERRIDE*INDICATOR*'N'**                            CAC001
     F*       49      Analytical Accounting module is installed           CAC001
0075 F*       50      AMOUNTS      -NO DECIMAL PLACES + MDIN DIVIDE TEST
0076 F*       51                   -1 DECIMAL PLACE
0077 F*       52                   -2 DECIMAL PLACES
0078 F*       53                   -3 DECIMAL PLACES
0079 F********54 IN54 TO BYPASS DR A/C CALCULATIONS IN SUBR. MEMCHN       S01117
     F*               (USE OF INDICATOR 54 REPLACED BY FIELD 'IN54')      S01117
     F*       54      CREDIT A/C DETAILS INPUT ON SCREEN - ACTION - I     S01117
0080 F*       55      PROTECT ALL FIELDS
0081 F*       56      CUSEX CUST ZERO
0082 F*       57      CUSEX - CHEQUE NO. ZERO
     F*       58      MEMOS RECORD NOT FOUND FOR DR AND/OR CR RETAIL A/C  E17935
0084 F*       59      BLINK LABEL - ACTION CODE
0085 F*       60                  - INPUT DOC. NO.
0086 F********61***               - BRANCH CODE
     F*       61      INITIAL SCREEN TRANSACTION IN ERROR - SA SCREEN     S01117
0087 F*       62                  - D/R A/C NO. CUST-CCY-A/C CODE-SEQ
0088 F*       63                  - DEBIT RETAIL A/C NO.
0089 F*       64                  - DEBIT CURRENCY
0090 F*       65                  - DEBIT AMOUNT
0091 F*       66                  - DEBIT CHEQUE NO.
     F*
     F*       67      MULTI BRANCHING IND. = 'Y'
     F*
0093 F*       68      BLINK LABEL - C/R A/C NO. CUST-CCY-A/C CODE-SEQ
0094 F*       69                  - CREDIT RETAIL A/C NO
0095 F*       70      PROTECT FIELDS-ACTION CODE&INPUT DOCUMENT NO.
0096 F*       71      NON-DISPLAY FIELDS - REST
0097 F*       72      BLINK LABEL - CREDIT CURRENCY
0098 F*       73                  - CREDIT AMOUNT
0099 F*       74                  - BASE CCY EQUIVALENT
0100 F*       75                  - OVERIDE INDICATOR
0101 F*       76                  - EXCHANGE RATE
0102 F*       77      ERROR CODES NON DISPLAY
0103 F*       78      ERROR MESSAGE NON DISPLAY
0104 F*       79      OUTPUT INITIAL SCREEN - I.D. SF
0105 F*       80      RECORD HAS SINCE BEEN UPDATED
     F*       82      ERROR ON DR VALUE DATE                              S01111
     F*       83      ERROR ON CR VALUE DATE                              S01111
0106 F*       81      SYSTEM SUPPORTS RETAIL NOS.
     F*       84      ACCOUNT HAS BEEN REFERRED TO BY A RETAIL A/C NO.    E16125
0110 F*       85      UPDATE MEMOS FILE
     F*       86      CHECK SIGN FOR EDITING CHARGE AMOUNT.               S01111
0112 F*       87      PASS FIELDS TO WORKSTN AND WORKSTN READ FAILURE
     F***********     HELP INDICATOR                                      S01199
 113 F*       88      UPDATE CUSEX TRAILER RECORD
0114 F*       89      UPDATE CUSEX RECORD
0115 F*       99      ERROR INDICATOR FROM SUBROUTINES
0116 F**
 113 F*       KC      END OF JOB
0114 F*       KL      FOR INITIAL SCREEN
0115 F*       KJ      TO DELETE
0116 F**
0117 E*****               ERRMSG  1   9 52               ERROR MESSAGES   S01117
     E***********         ERRMSG  1  12 70         ERROR MESSAGES   S01117S01413
     E***********         ERRMSG  1  15 70               ERROR MESS S01117078607
     E/COPY WNCPYSRC,RE0150E001
     E                    ERRMSG  1  15 74               ERROR MESSAGES   078607
     E/COPY WNCPYSRC,RE0150E002
0118 E                    ERCD       30  4
0119 E**
0120 E                    ZA1        16  1               ZALIGN SR. ARRAY
0121 E                    ZA2        16  1               ZALIGN SR. ARRAY
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAYS01111
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAYS01111
     E                    ZMNM   12  12  3               ZDATE2 SR.ARRAY  S01111
     E                    CPY@    1   1 80
     E*                                                                   CAC001
     E                    AP      1  10 10 0                              CAC001
     E** Array - Powers of Ten.                                           CAC001
     E                    DCC     1   3  3                                                    CRE020
      ** Debit/Credit Text                                                                    CRE020
      *                                                                                      BUG2488
     E                    @TXT    1   2 80                                                   BUG2488
     E** Text string                                                                         BUG2488
      *                                                                                       CRE019
      ** Work array for CQPS                                                                  CRE019
      *                                                                                       CRE019
     E                    WAR        20  1                                                    CRE019
      *                                                                                       CRE019
0122 E**
     E**  ARRAY FOR SR. ZA0710 - CUMULATIVE DAYS IN YEAR PER MONTH        CAC001
     E                    @Z         14  1                                CAC001
     E*                                                                   CAC001
     E* ARRAY @Z STORES AMOUNT WITH DECIMAL (EXECUTION TIME  ARRAY)       CAC001
     E                    @Q         13  1 0                              CAC001
     E*                                                                   CAC001
     E                    @WD        16  5 0A                             050831
     E*                                                                   050831
     E** Array containing next sixteen working days day numbers           050831
     E*                                                                   050831
     E                    @IA        16 15 0                              050831
     E*                                                                   050831
     E** Array of incoming amounts for next sixteen working days          050831
     E*                                                                   050831
     E                    @OA        16 15 0                              050831
     E*                                                                   050831
     E** Array of incoming amounts for next sixteen working days          050831
     E*                                                                   050831
     E                    @WK        16 15 0                              050831
     E*                                                                   050831
     E** Working array of balances for next sixteen working days          050831
     E*                                                                   050831
     E/COPY WNCPYSRC,RE0150E003
     E/COPY ZSRSRC,ZHOLE                                                                     BUG7274
      *                                                                                       CRE019
      ** Rename fields in TTRANL6 for record format @BTREMG                                   CRE019
      *                                                                                       CRE019
     I@BTREMG                                                                                 CRE019
     I              BTRACN                          TACNO                                     CRE019
      *                                                                                       CRE019
      ** Rename fields in TTRANL6 for record format CUSEXCEF                                  CRE019
      *                                                                                       CRE019
     ICUSEXCEF                                                                                CRE019
     I              RECI                            TRECI                                     CRE019
     I              CHQNN                           TCHQN                                     CRE019
     I              IPDN                            TIPDN                                     CRE019
     I              DRBR                            TBRCA                                     CRE019
     I              DCUS                            TCNUM                                     CRE019
     I              DRCY                            TCCY                                      CRE019
     I              DCOD                            TACOD                                     CRE019
     I              DACS                            TACSQ                                     CRE019
     I              DRAN                            TACNO                                     CRE019
      *                                                                                       CRE019
      ***Rename*fields*in*TTRANL6*for*record*format*TTRAND0************               CRE019 BUG2488
      *****************************************************************               CRE019 BUG2488
     I***TTRAND0                                                                      CRE019 BUG2488
     I**********    ACNO                            TACNO                             CRE019 BUG2488
     I**********    HCAC                            TAACNO                            CRE019 BUG2488
0123 IRE0150FMNS  01   1 CS   2 CF
0124 I       OR   02   1 CS   2 CI
0125 I       OR   03   1 CS   2 CD
     I       OR   82   1 CS   2 CE                                        S01413
0126 I       OR   04
0127 I                                        1   2 STID
0128 I                                        3   8 DOCN
0129 I                                        9   9 ACTCD
     I*****                                  10  120BRCDI                 S01117
     I                                       10  12 DRBR                  S01117
0131 I**********                             13  180DACN          2121    LN0085
0131 I**********                             13  18 DACNA           S01111LN0085
0131 I                                       13  18 DACNA           21    LN0085
0131 I                                       15  18 CHKDCM                S01111
0132 I                                       19  21 DCCY            22
0133 I**********                             22  25 DACD            23                        CGL029
0134 I**********                             26  27 DASQ            24                        CGL029
0135 I**********                             28  370DRAC            25                        CGL029
0135 I**********                             28  37 DRACA                              S01117 CGL029
0136 I**********                             38  40 DRCY            26                        CGL029
0137 I**********                             41  54 DRAM                                      CGL029
     I                                       22  31 DACD            23                        CGL029
     I                                       32  33 DASQ            24                        CGL029
     I                                       34  430DRAC            25                        CGL029
     I                                       34  43 DRACA                                     CGL029
     I                                       44  46 DRCY            26                        CGL029
     I                                       47  60 DRAM                                      CGL029
0138 I***********                            55  620DCHN            27    CAC001
     I**********                             55  620DCHN                               CAC001 CGL029
0139 I**********                             55  62 DCHNA                                     CGL029
0140 I**********                             63  92 DNAR                                      CGL029
     I                                       61  680DCHN                                      CGL029
     I                                       61  68 DCHNA                                     CGL029
     I                                       69  98 DNAR                                      CGL029
0141 I***********                            93  980CACN          2929    S01117
0141 I***********                            93  98 CACNA           S01111S01117
0141 I***********                            95  98 CHKCCM          S01111S01117
0142 I***********                            99 101 CCCY            30    S01117
0143 I***********                           102 1050CACD            31    S01117
0143 I***********                           102 105 CACDA           S01111S01117
0144 I***********                           106 107 CASQ            32    S01117
0145 I***********                           108 117 CRACA           S01111S01117
0145 I***********                           108 1170CRAC            33    S01117
0146 I***********                           118 120 CRCY            34    S01117
0147 I***********                           121 134 CRAM                  S01117
0148 I***********                           135 164 CNAR                  S01117
0149 I***********                           165 178 BCEQ            35    S01117
0150 I***********                           179 179 OIND            38    S01117
0151 I***********                           180 193 EXRT                  S01117
     I**********                             93  95 CBRC                               S01117 CGL029
     I                                       99 101 CBRC                                      CGL029
     I**********                             96 1010CACN          29S01117LN0085
0141 I**********                             96 101 CACNA           S01117LN0085
0141 I**********                             96 101 CACNA           29                 LN0085 CGL029
0141 I**********                             98 101 CHKCCM                             S01117 CGL029
     I**********                            102 104 CCCY            30                 S01117 CGL029
     I                                      102 107 CACNA           29                        CGL029
     I                                      104 107 CHKCCM                                    CGL029
     I                                      108 110 CCCY            30                        CGL029
     I**********                            105 1080CACD            S01117LN0085
0143 I**********                            105 108 CACDA           S01117LN0085
0143 I**********                            105 108 CACDA           31                 LN0085 CGL029
     I**********                            109 110 CASQ            32                 S01117 CGL029
     I**********                            111 1200CRAC            33                 S01117 CGL029
0145 I**********                            111 120 CRACA                              S01117 CGL029
     I**********                            121 123 CRCY            34                 S01117 CGL029
     I**********                            124 137 CRAM                               S01117 CGL029
     I**********                            138 167 CNAR                               S01117 CGL029
     I**********                            168 181 BCEQ            35                 S01117 CGL029
     I**********                            182 182 OIND            38                 S01117 CGL029
     I**********                            183 196 EXRT                               S01117 CGL029
     I**********                            197 200 IPRFC                              S01117 CGL029
     I                                      111 120 CACDA           31                        CGL029
     I                                      121 122 CASQ            32                        CGL029
     I                                      123 1320CRAC            33                        CGL029
     I                                      123 132 CRACA                                     CGL029
     I                                      133 135 CRCY            34                        CGL029
     I                                      136 149 CRAM                                      CGL029
     I                                      150 179 CNAR                                      CGL029
     I                                      180 193 BCEQ            35                        CGL029
     I                                      194 194 OIND            38                        CGL029
     I                                      195 208 EXRT                                      CGL029
     I                                      209 212 IPRFC                                     CGL029
     I***********                           194 199 DRVALD          S01111S01117
     I***********                           200 205 CRVALD          S01111S01117
     I***********                           206 211 CHCUS           S01111S01117
     I***********                           212 215 CHACD           S01111S01117
     I***********                           216 217 CHASQ           S01111S01117
     I***********                           218 218 CHSGN           S01111S01117
     I***********                           219 232 CHAMT           S01111S01117
     I**************************************201 206 DRVALD          S01117CAC001
     I**************************************207 212 CRVALD          S01117CAC001
     I**************************************213 218 CHCUS           S01117CAC001
     I**************************************219 222 CHACD           S01117CAC001
     I**************************************223 224 CHASQ           S01117CAC001
     I**************************************225 225 CHSGN           S01117CAC001
     I**************************************226 239 CHAMT           S01117CAC001
     I*** FOLLOWING IS A NEW FIELD ADDED FOR SO5452                       SO5452
     I***********                           233 248 SWCRD           S05452S01117
     I**************************************240 255 SWCRD           S01117CAC001
     I**************************************256 258 ITBRC           S01117CAC001
     I*                                                                   CAC001
     I**  Following are new fields added for Analytical Accounting        CAC001
     I*                                                                   CAC001
     I**********                            201 208 SFXMP                              CAC001 CGL029
     I**********                            209 209 SFXIN                              CAC001 CGL029
     I                                      213 220 SFXMP                                     CGL029
     I                                      221 221 SFXIN                                     CGL029
     I*                                                                   CAC001
     I**********                            210 215 DRVALD                             CAC001 CGL029
     I**********                            216 221 CRVALD                             CAC001 CGL029
     I**********                            222 227 CHCUS                              CAC001 CGL029
     I**********                            228 231 CHACD                              CAC001 CGL029
     I**********                            232 233 CHASQ                              CAC001 CGL029
     I**********                            234 234 CHSGN                              CAC001 CGL029
     I**********                            235 248 CHAMT                              CAC001 CGL029
     I**********                            249 264 SWCRD                              CAC001 CGL029
     I**********                            265 267 ITBRC                              CAC001 CGL029
     I                                      222 227 DRVALD                                    CGL029
     I                                      228 233 CRVALD                                    CGL029
     I                                      234 239 CHCUS                                     CGL029
     I                                      240 249 CHACD                                     CGL029
     I                                      250 251 CHASQ                                     CGL029
     I                                      252 252 CHSGN                                     CGL029
     I                                      253 266 CHAMT                                     CGL029
     I                                      267 282 SWCRD                                     CGL029
     I                                      283 285 ITBRC                                     CGL029
     I                                      286 313 DNAA                                      CRE020
     I                                      314 341 CNAA                                      CRE020
     I/COPY WNCPYSRC,RE0150I003
0152 I********                               10 193 SCFLDS                S01111
0152 I********                               10 232 SCFLDS        S01111  SO5452
0152 I***********                            10 248 SCFLDS          S05452S01117
 152 I***********                            10 258 SCFLDS         S01117 CAC001
     I**********                             10 267 SCFLDS                             CAC001 CGL029
     I                                       10 285 SCFLDS                                    CGL029
0153 I***********                             1 150 CELOT1                S01117
     I**********                              1 167 CELOT1                             S01117 CGL029
     I                                        1 179 CELOT1                                    CGL029
0154 I********                              151 193 CELOT2                S01111
     I********                                1 193 REREC                 S01111
0154 I********                              151 232 CELOT2        S01111  SO5452
     I********                                1 232 REREC         S01111  SO5452
0154 I***********                           151 248 CELOT2          S05452S01117
     I***********                           168 258 CELOT2         S01117 CAC001
     I***********                             1 248 REREC          S05452 CAC001
     I***********                           249 258 REREC2         S01117 CAC001
     I**********                            168 267 CELOT2                             CAC001 CGL029
     I                                      180 285 CELOT2                                    CGL029
     I                                        1 256 REREC                 CAC001
     I**********                            257 267 REREC2                             CAC001 CGL029
     I                                      257 285 REREC2                                    CGL029
     I                                        1 200 DSDSP1                                    CRE019
     I                                      201 285 DSDSP2                                    CRE019
0155 I*
0156 I*
0157 I*****TABLE*FILE*-*INSTALLATION*CONTROL DATA RECORD 1.               S01194
0158 I***********                                                         S01194
0159 I*TABLE**NS* 05   2 C0   3 C1  12 C1                                 S01194
0160 I*******AND*     13 C0                                               S01194
0161 I***********                             1   1 RECI                  S01194
0162 I***********                             2   30RECT                  S01194
0163 I***********                            12  130RCDE                  S01194
0164 I***********                            14  66 TITL                  S01194
0165 I***********                            67  67 DATF                  S01194
0166 I***********                            68  700DFBR            39    S01117
0166 I***********                            68  70 DFBM                  S01117
0167 I***********                            74  74 MODI1                 S01194
0168 I***********                            75  75 MODI2                 S01194
0169 I***********                            76  76 MODI3                 S01194
0170 I***********                         P  77  790RUND                  S01194
0171 I***********                            80  86 RUNA                  S01194
0172 I***********                            87  870SFLG                  S01194
0173 I***********                         P  90  920LCD                   S01194
0174 I***********                            93  93 CHTP                  S01194
0175 I***********                                                         S01194
0176 I***********                                                         S01194
0177 I*****TABLE*FILE*-*INSTALLATION*CONTROL DATA RECORD 2.               S01194
0178 I***********                                                         S01194
0179 I*TABLE**NS* 06   1 CD   2 C0   3 C1                                 S01194
0180 I*******AND*     12 C1  13 C1                                        S01194
0181 I***********                             1   1 RECI                  S01194
0182 I***********                             2   30RECT                  S01194
0183 I***********                            12  130RCDE                  S01194
0184 I***********                            14  16 BCCY                  S01194
0185 I***********                            17  19 BCYL                  S01194
0186 I***********                            20  22 HOCY                  S01194
0187 I***********                            23  280HEAD                  S01194
0188 I***********                         P  29  310APDA                  S01194
0189 I***********                            35  35 APFQ                  S01194
0191 I***********                            39  40 CUZR                  S01194
0192 I***********                         P  41  430DNWD                  S01194
0193 I***********                            44  460BVLP                  S01194
0194 I***********                            47  49 LOCY                  S01194
0195 I***********                            50  510FDAY                  S01194
     I***********                            53  53 MBIN                  S01194
0196 I***********                            86  86 ISAV                  S01194
0198 I***********                         P  90  920LCD                   S01194
0199 I***********                            93  93 CHTP                  S01194
0200 I***********                                                         S01194
0201 I*****TABLE*FILE*-*INSTALLATION*CONTROL DATA RECORD 3                S01194
0202 I***********                                                         S01194
0203 I*TABLE**NS*      1 CD   2 C0   3 C1                                 S01194
0204 I*******AND*     12 C2  13 C0                                        S01194
0205 I***********                            69  69 RACN                  S01194
     I***********                                                         S01194
     I*****TABLE*FILE**RETAIL*II*INSTALLATION CONTROL DATA RECORD   E16127S01194
     I***********                                                   E16127S01194
     I*TABLE**NS*      1 CD   2 C0   3 C1                           E16127S01194
     I*******AND*     12 C5  13 C5                                  E16127S01194
     I***********                             1   1 RECI            E16127S01194
     I***********                            14  14 LDAC            E16127S01194
     I***********                            15  15 CBAC            E16127S01194
     I***********                            16  180MFWD            E16127S01194
     I***********                            19  210BINA            E16127S01194
     I***********                         P  90  920LCD             E16127S01194
     I***********                            93  93 CHPT            E16127S01194
     I***********                         P  94  960TNLU            E16127S01194
0206 I***********                                                   E16127S01194
0207 I*****TABLE*FILE*-*CURRENCIES*RECORD 1.                              S01194
0208 I***********                                                         S01194
0209 I*TABLE**NS* 07   1 CD   2 C2   3 C0                                 S01194
0210 I*******AND*     13 C1                                               S01194
0211 I***********                             1   1 RECI                  S01194
0212 I***********                             2   30RECT                  S01194
0213 I***********                            13  130SREC                  S01194
0214 I***********                            14  27 CCNM                  S01194
0215 I***********                         P  28  348SPOT                  S01194
0216 I***********                            38  380CDP                   S01194
0217 I***********                            39  390TNOT                  S01194
0218 I***********                            40  40 DLCY                  S01194
0219 I***********                            41  44 SRC1                  S01194
0220 I***********                            45  48 SRC2                  S01194
0221 I***********                            49  520TACC                  S01194
0222 I***********                            53  560TEQV                  S01194
0223 I***********                            57  600SWQV                  S01194
0224 I***********                            61  640TAC4                  S01194
0225 I***********                            65  680TAC5                  S01194
0226 I***********                            69  69 HIND                  S01194
0227 I***********                         P  70  768PART                  S01194
0228 I***********                            77  780SSNO                  S01194
0229 I***********                         P  79  858ERLC                  S01194
0230 I***********                            86  860MDIN                  S01194
0231 I***********                         P  90  920LCD                   S01194
0232 I***********                            93  93 CHTP                  S01194
0233 I***********                                                         S01194
0234 I*****TABLE*FILE*-*BRANCH*CODES*RECORD.                              S01194
0235 I***********                                                         S01194
0236 I*TABLE**NS* 08   1 CD   2 C1   3 C0                                 S01194
0237 I***********                             1   1 RECI                  S01194
0238 I***********                             2   30RECT                  S01194
0239 I***********                            11  130BRCD                  S01117
0239 I***********                            11  13 BRCA                  S01117
0240 I***********                            14  43 BRNM                  S01194
0241 I***********                            44  490BICN                  S01194
0242 I***********                            50  51 LOCC                  S01194
0243 I***********                            52  53 CMPY                  S01117
0244 I***********                         P  90  920LCD                   S01117
0245 I***********                            93  93 CHTP                  S01117
     I***********                                                   S01111S01194
     I*****TABLE*FILE*-*ACCOUNT*CODES RECORD 1.                     S01111S01194
     I***********                                                   S01111S01194
     I*TABLE**NS*      2 C3   3 C0  13 C1                           S01111S01194
     I***********                             1   1 RECIA           S01111S01194
     I***********                                                   S01111S01194
     I*****TABLE*FILE*-*NOSTROS*RECORD.                             S01111S01194
     I***********                                                   S01111S01194
     I*TABLE**NS*      1 CD   2 C7   3 C0                           S01111S01194
     I***********                             1   1 RECIN           S01111S01194
     I***********                             2   30RECT            S01111S01194
     I***********                             9  11 CCY             S01111S01194
     I***********                            12  130NOSN            S01111S01194
     I***********                            16  29 ONAC            S01111S01194
     I***********                            30  35 CNUM            S01111S01194
     I***********                            36  37 ACSQ            S01111S01194
     I***********                            38  41 ACOD            S01111S01194
     I***********                            67  69 NBRCD                 S01117
0246 I***********                                                         S01194
0247 I****TABLE*FILE*-*CATCHALL                                           S01194
0248 I***********                                                         S01194
0249 I********NS*                                                         S01194
     I***********                                                   S01111S01194
     I***CLIENT*FILE                                                S01111S01194
     I*CLINT**NS*                                                   S01111S01194
     I***********                             1   1 RECIC           S01111S01194
0301 I**
0302 I** MEMOS FILE
0303 I*************                                                       CCB002
0304 I*MEMOS***NS**14   1 CD                                              CCB002
0306 I*************                           2  160GRBL                  CCB002
0307 I*************                          17  310NETB                  CCB002
     I*                                                                   S01408
     I** Core hook for externalisation.                                   S01408
     I/COPY WNCPYSRC,RE0150IIP1                                           S01408
     I*                                                                   S01408
     I        NS
     IPRONO   NS                                                          E41808
     I                                    P   7  140PRBAL1                E41808
     I                                    P  15  220PRBAL2                E41808
     I                                    P  23  300PRBAL3                E41808
     I                                    P  31  380PRBAL4                E41808
     I                                    P  39  460PRBAL5                E41808
     I                                    P  47  490PRDAT1                S01413
     I                                    P  50  520PRDAT2                S01413
     I                                    P  53  550PRDAT3                S01413
     I                                    P  56  580PRDAT4                S01413
     I                                    P  59  610PRDAT5                S01413
     I/COPY WNCPYSRC,RE0150I006
0308 I**
0309 I** ACCOUNTS MASTER
0310 I**
0311 IACCNT   NS  15   1 CD
     I       OR   36   1 CC                                               E16125
0312 I*****                                  23  250ABRCD                 S01117
0312 I                                       23  25 ABRCD                 S01117
0313 I                                       26  26 ATYP
0314 I***************************************29  29 ACST            36    E16125
0314 I                                    P  30  320DACO                  S01111
     I                                      190 1990RETNO                 S01111
     I                                      200 200 RETB                  E17935
0315 I                                    P 239 2410RRNM
     I                                      254 254 DRIF                  S01111
     I                                    P 260 2620LDID                  S01111
     I                                      330 330 CRIF                  S01111
     I                                    P 336 3380LCID                  S01111
     I                                      580 580 COLF                                      CGL014
     I*                                                                   S01408
     I** Core hook for externalisation.                                   S01408
     I/COPY WNCPYSRC,RE0150IIP2                                           S01408
     I*                                                                   S01408
0316 I**
0317 I** CATCHALL
0318 I**
0319 I        NS
0320 I**
0321 I** RETAIL ACCOUNTS MASTER
0322 I**
0323 IACNUM   NS  16   1 CD
     I       OR   37   1 CC                                               E16125
0324 I                                       12  17 CNUM
0325 I                                       18  20 CCY
0326 I**********                             21  24 ACOD                                      CGL029
0327 I**********                             25  26 ACSQ                                      CGL029
     I                                       21  30 ACOD                                      CGL029
     I                                       31  32 ACSQ                                      CGL029
0328 I***************************************27  27 RACST           37    E16125
     I**********                             28  28 ATYP                               134071 CGL029
     I**********                             29  31 ABRCD                              S01117 CGL029
     I                                       34  34 ATYP                                      CGL029
     I                                       35  37 ABRCD                                     CGL029
     I/COPY WNCPYSRC,RE0150I001
0329 I        NS
0330 I** CUSTOMER EXCHANGES
0331 I**
0332 I**
0333 ICUSEX   NS  17   1 CD
0334 I       OR   18   1 CC
0335 I                                        1   1 RECI
0336 I                                        2   7 IPDN
0337 I*****                                   8  100BRCD                  S01117
     I                                        8  10 BRCDD                 S01117
0338 I                                    P  11  130VALD
0339 I**********                             14  190DCUS            56                        CSD027
0339 I                                       14  19 DCUS            56                        CSD027
0340 I**********                             20  23 DCOD                                      CGL029
     I                                       20  23 QQDCOD                                    CGL029
0341 I                                       24  250DACS
0342 I                                       26  350DRAN
0343 I                                       36  38 DACY
0344 I                                    P  39  450DAMT
0345 I                                       46  75 DRNA
     I                                       46  73 DANA                                      CRE020
0346 I                                       76  830CHQN            57
0347 I**********                             84  890CCUS                                      CSD027
0347 I                                       84  89 CCUS                                      CSD027
0348 I**********                             90  93 CCOD                                      CGL029
     I                                       90  93 QQCCOD                                    CGL029
0349 I                                       94  95 CACS
0350 I                                       96 1050CRAN
0351 I                                      106 108 CACY
0352 I                                    P 109 1150CAMT
0353 I                                      116 145 CRNA
     I                                      116 143 CANA                                      CRE020
0354 I                                    P 146 1528CEXRT
0355 I                                      153 153 ORIN
0356 I                                    P 154 1600BEQU
     I**********                            162 1670CHCN                               S01111 CSD027
     I                                      162 167 CHCN                                      CSD027
     I**********                            168 1710CHCD                               S01111 CGL029
     I                                      168 1710QQCHCD                                    CGL029
     I                                      172 1730CHSQ                  S01111
     I                                    P 174 1800CHAM                  S01111
     I                                      181 181 CHSN                  S01111
     I                                    P 192 1940DRVD                  S01111
     I                                    P 195 1970CRVD                  S01111
     I****  NEXT FIELD ADDED FOR SO5452  ******************************
     I                                      198 213 SWCR                  S05452
     I/COPY WNCPYSRC,RE0150I005
     I                                      240 242 BRCDC                 S01117
     I                                      243 246 PRFC                  S01117
     I                                      247 249 BRCDT                 S01117
0357 I                                      250 250 CHTP
0358 I                                    P 251 2530LCD
0359 I                                    P 254 2560TNLU
     I                                    P 257 2602FXMP                  CAC001
     I                                    P 261 2670MAMT                  CAC001
     I                                    P 268 2748ORAT                  CAC001
     I                                      275 275 FXIN                  CAC001
     I                                      276 2850DCOD                                      CGL029
     I                                      286 2950CCOD                                      CGL029
     I                                      296 3050CHCD                                      CGL029
     I                                      306 306 DUPC                                      CRE019
     I                                      307 307 OUTR                                      CRE019
0360 I                                        2 160 CEXREC
0361 I**
0362 I**  CUSEX TRAILER RECORD
0363 I        NS  13   1 CT
0364 I                                    P   8  100NORE
0365 I                                    P  11  180HRWN
0366 I                                    P  19  200HRDC
0367 I                                        2 160 CEXREC
0368 I**
0369 I** CUSEX- CATCHALL
0370 I**
0371 I        NS  19
     I/COPY WNCPYSRC,RE0150I004
0376 I**
0377 I**  DATA STRUCTURE FOR LAST UPDATE DATA.
0378 I**
0379 I            DS
0380 I                                        1   50TNLU
0381 I                                        6  100LCD
0382 I                                       11  11 CHTP
0383 I                                        1  11 TNLU1
0384 I                                       12  160TNLU2
0385 I                                       17  210LCD1
0386 I                                       22  22 CHTP1
0387 I                                       12  22 TNLUS
0388 I**
0389 I**  DATA STRUCTURE TO MULTI DEFINE AMOUNT FIELDS
0390 I            DS
0391 I**  NO DECIMAL PLACES
0392 I                                        1  130DRAMN0
0393 I                                       14  260CRAMN0
0394 I                                       53  650BCEQ0
0395 I**
0396 I**  ONE DECIMAL PLACE
0397 I                                        1  131DRAMN1
0398 I                                       14  261CRAMN1
0399 I                                       53  651BCEQ1
0400 I**  TWO DECIMAL PLACES
0401 I                                        1  132DRAMN2
0402 I                                       14  262CRAMN2
0403 I                                       53  652BCEQ2
0404 I**  THREE DECIMAL PLACES
0405 I                                        1  133DRAMN3
0406 I                                       14  263CRAMN3
0407 I                                       53  653BCEQ3
0408 I**
0409 I**  ACCOUNTS MASTER KEY
0410 I**
0411 I            DS
0412 I*****                                   1  15 ACNKEY                S01117
     I**********                              1  18 ACNKEY                             S01117 CGL029
     I                                        1  24 ACNKEY                                    CGL029
0413 I**********                              1   60XCUS                                      CSD027
0413 I                                        1   6 XCUS                                      CSD027
0414 I                                        7   9 XCCY
0415 I**********                             10  130XCOD                                      CGL029
0416 I**********                             14  150XSEQ                                      CGL029
     I**********                             16  18 XBRC                               S01117 CGL029
     I                                       10  190XCOD                                      CGL029
     I                                       20  210XSEQ                                      CGL029
     I                                       22  24 XBRC                                      CGL029
0408 I**                                                                  E11725
0409 I**  KEY FOR DEBIT A/C FROM SCREEN                                   E11725
0410 I**                                                                  E11725
0411 I            DS                                                      E11725
0412 I***********                             1  15 DRNKEY          E11725S01117
0412 I**********                              1  18 DRNKEY                             S01117 CGL029
     I                                        1  24 DRNKEY                                    CGL029
0413 I**********                              1   60DACN            E11725LN0085
0413 I                                        1   6 DACNA                 LN0085
0414 I                                        7   9 DCCY                  E11725
0415 I**********                             10  13 DACD                               E11725 CGL029
0416 I**********                             14  15 DASQ                               E11725 CGL029
     I**********                             16  18 DRBR                               S01117 CGL029
     I                                       10  19 DACD                                      CGL029
     I                                       20  21 DASQ                                      CGL029
     I                                       22  24 DRBR                                      CGL029
0408 I**                                                                  E13304
0409 I**  KEY FOR CREDIT A/C FROM SCREEN                                  E13304
0410 I**                                                                  E13304
0411 I            DS                                                      E13304
0412 I***********                             1  15 CRNKEY          E13304S01117
     I**********                              1  18 CRNKEY                             S01117 CGL029
     I                                        1  24 CRNKEY                                    CGL029
0413 I**********                              1   60CACN            E13304S01117
0413 I                                        1   6 CACNA                 S01117
0414 I                                        7   9 CCCY                  E13304
0415 I**********                             10  130CACD            E13304LN0085
0415 I**********                             10  13 CACDA                              LN0085 CGL029
0416 I**********                             14  15 CASQ                               E13304 CGL029
     I**********                             16  18 CBRC                               S01117 CGL029
     I                                       10  19 CACDA                                     CGL029
     I                                       20  21 CASQ                                      CGL029
     I                                       22  24 CBRC                                      CGL029
     I*                                                                   S01111
     I***DATA*STRUCTURE*FOR*ACCOUNT CODES RECORD KEY                S01111S01194
     I*ACODKY*****DS                             12                 S01111S01194
     I***********                             1   2 ACOD1           S01111S01194
     I***********                             8  11 CHACD           S01111S01194
     I***********                            12  12 ACOD2           S01111S01194
0417 I***********                                                         S01194
0418 I****TABLES*FILE*KEY                                                 S01194
0419 I***********                                                         S01194
0420 I*********** DS                                                      S01194
0421 I***********                             1  12 TBKEY                 S01194
0422 I***********                             1   2 TBKY1                 S01194
0423 I***********                             9  11 TBKY2                 S01194
0424 I***********                            12  12 TBKY3                 S01194
     I***********                                                   S01111S01194
     I****NOSTROS*TABLES*FILE KEY                                   S01111S01194
     I***********                                                   S01111S01194
     I*********** DS                                                S01111S01194
     I***********                             1  12 NOTKEY          S01111S01194
     I***********                             1   2 NOKY1           S01111S01194
     I***********                             8  10 NOKY2           S01111S01194
     I***********                            11  12 NOKY3           S01111S01194
     I***********                                                   S01111S01194
     I*                                                                   CAC001
     I            DS                                                      CAC001
     I* DATA STRUCTURE TO REDEFINE ARRAY @Z AS RETURNED FIELD @@AMTD      CAC001
     I                                        1  14 @@AMTD                CAC001
     I                                        1  14 @Z                    CAC001
     I            DS                                                      CAC001
     I*                                                                   CAC001
     I* DATA STRUCTURE TO REDEFINE ARRAY @Q AS INPUT FIELD @@AMTW         CAC001
     I                                        1  130@@AMTW                CAC001
     I                                        1  130@Q                    CAC001
     I*                                                                   CAC001
     I* DATA STRUCTURE FOR ASSIGN APPROPRIATE DECIMAL PLACES TO AMOUNT.   CAC001
     I                                        1  130WAMT0                 CAC001
     I                                        1  131WAMT1                 CAC001
     I                                        1  132WAMT2                 CAC001
     I                                        1  133WAMT3                 CAC001
     I                                        1  134WAMT4                 CAC001
     I                                        1  135WAMT5                 CAC001
0085 I*
     IPSDS       SDS
     I                                     *PROGRAM ZAPGM                 S01241
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I                                      244 253 WSJOB                 S01413
     I                                      254 263 USRID
     I**
     I**
     I**   DATA STRUCTURE  TO UPDATE LAST TRANSACTION NUMBER DTAARA
     I**
     IDNATN       DS                              5
     I                                        1   50FNATN
      *                                                                                       CRE019
      ** Data structure to hold screen fields                                                 CRE019
      *                                                                                       CRE019
     IDSDSP3      DS                            285                                           CRE019
     IDSSCRN      DS                            285                                           CRE019
      *                                                                                       CRE019
     I            DS                                                                         BUG2488
      **  Data structure to hold string constants for QCMDEXC                                BUG2488
      *                                                                                      BUG2488
     I                                        1  80 @CMD                                     BUG2488
     I                                       30  30 @BRI                                     BUG2488
     I                                       31  33 @BID                                     BUG2488
     I**   NEXT CUSTOMER EXCHANGE NUMBER                                  S01413
     ICEXNOD      DS                              4                       S01413
     I                                        1   40CEXNOS                S01413
     I                                        1   4 CEXNOA                036434
     I**   CUSTOMER EXCHANGE NUMBER MESSAGE                               S01413
     IINSERT      DS                             52                       S01413
     I                                       26  31 DOCNO                 S01413
     I**
     I**
     I**   DATA STRUCTURE TO PROVIDE TEXT ON COMIT ENTRY IN JOURNAL
     I**
     I*MTTXT******DS                            243                       S01111
     I*MTTXT******DS                            282                 S01111S01117
     I*CMTTXT*****DS                            308                S01117 CAC001
     I***CMTTXT*     DS                            317                                 CAC001 CGL029
     ICMTTXT      DS                            335                                           CGL029
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 ACTCDX
     I                                       26  35 USRIDX
     I********                               51 243 RERECX                S01111
     I***********                            51 282 RERECX          S01111S01117
     I***********                            51 298 RERECX         S01117 CAC001
     I***********                           299 308 RECX2          S01117 CAC001
     I                                       51 306 RERECX                CAC001
     I**********                            307 317 RECX2                              CAC001 CGL029
     I                                      307 335 RECX2                                     CGL029
     I*                                                                   S01117
     IZMUSER      DS                             17                       S01117
     I** DATA AREA OF MENU USER                                           S01117
     I                                        1  10 USRPRF                S01117
     I                                       11  13 USRBCH                S01117
     I*                                                                   S01117
     IRUNDT       DS                                                      S01117
     I** RUNDAT DATA AREA                                                 S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I*                                                                   S01117
     I***   LOCAL DATA AREA TO IDENTIFY DATABASE ERRORS                   S01117
     I*                                                                   S01117
      *                                                                   S01241
      **    LOCAL DATA AREA TO IDENTIFY DATABASE ERRORS                   S01241
      *                                                                   S01241
     I*LDA*******UDS                            256                 S01241S01413
     ILDA         DS                            256                       S01413
     I**************                        134 138 DBFILE          S01241S01117
     I**************                        139 167 DBKEY           S01241S01117
     I**************                        168 175 DBPGM           S01241S01117
     I**************                        176 1770DBASE           S01241S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I*                                                                   S01117
     ISDGELR    E DSSDGELRPD                                              S01117
     I** GENERAL LEDGER DETAILS                                           S01117
     I              BKPRCU                          PFCU                  S01117
     I              BKPCDU                          PFCD                  S01117
     I*                                                                   S01117
     I              'CustomerExchange  '  C         CUSX                                      CRE020
      *                                                                                       CRE020
     I/COPY WNCPYSRC,RE0150I002
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I** BRANCH CODES                                                     S01117
     I*                                                                   S01117
     ISDPRFM    E DSSDPRFMPD                                              S01117
     I**   PROFIT CENTRE DFT. MATRIX RETRIEVAL INDEX                      S01117
     I*                                                                   S01117
     ISDPRFC    E DSSDPRFCPD                                              S01117
     I**   PROFIT CENTRES                                                 S01117
0084 I*
     ISDPCAC    E DSSDPCACPD                                              CAC001
     I**  SD Profit Centre Accounting ICD                                 CAC001
     I*                                                                   CAC001
     ISCSARD    E DSSCSARDPD                                              CDE002
      * SAR File Details                                                  CDE002
     I              LCD                             LCDX                  CDE002
     I**  DATA STRUCTURE FOR ERROR HANDLING SUBROUTINE
     I**
     IINFDS       DS
     I                                     *STATUS  STATUS
     I**
     I**
     I**   DATA STRUCTURE  TO QUEUE PGMS DURING MEMOS UPDATE
     I**
     IREQNM       DS                              1
      * Define the data structure to pass data to WN0010 and return pgm   S01241
      *                                                                   S01241
      /COPY QWINDSRC,RE0150DTA                                            S01241
     I*                                                                   S01408
     I** Core hook for externalisation.                                   S01408
     I/COPY WNCPYSRC,RE0150IIP3                                           S01408
     I*                                                                   S01408
      *                                                                   S01194
     ISDNOST    E DSSDNOSTPD                                              S01194
     I              QQACCD                          QQACC1                                    CGL029
      **   NOSTRO DETAILS                                                 S01194
      *                                                                   S01194
     ISDRETL    E DSSDRETLPD                                              S01194
     I              QQACCD                          QQACC2                                    CGL029
      **   RETAIL DETAILS                                                 S01194
      *                                                                   S01194
     ISDCURR    E DSSDCURRPD                                              S01194
      **   CURRENCY TYPE                                                  S01194
      *                                                                   S01194
     ISDACOD    E DSSDACODPD                                              S01194
     I              QQACCD                          QQACC3                                    CGL029
     I              QQFNIC                          QQFNC1                                    CGL029
     I              QQFNAA                          QQFNA1                                    CGL029
      **   ACCOUNT CODE                                                   S01194
      *                                                                   S01194
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
      *                                                                   S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
     I              QQDFAC                          QQDFC1                                    CGL029
      **   CUSTOMER                                                       S01194
0255 I**                                                                  S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     IODT         DS                                                      050831
     I*                                                                   050831
     I** Data structure used in setting up day no of next working day     050831
     I*                                                                   050831
     I                                    P   1  480@WD                   050831
     IOFI         DS                                                      050831
     I*                                                                   050831
     I** Data structure used in setting up incoming amounts               050831
     I*                                                                   050831
     I                                    P   1 1280@IA                   050831
     IOFO         DS                                                      050831
     I*                                                                   050831
     I** Data structure used in setting up incoming amounts               050831
     I*                                                                   050831
     I                                    P   1 1280@OA                   050831
     I/COPY WNCPYSRC,RE0150I007
     I*                                                                   050831
      *                                                                                       CRE019
      ** Constant to store message file to use                                                CRE019
      *                                                                                       CRE019
     I              'GBRTSMSGF'           C         WCMSGF                                    CRE019
     I/COPY ZSRSRC,ZHOLI                                                                     BUG7274
      *                                                                                       CRE019
     C                     MOVEACPY@      BIS@   80
0366 C**
     C* PARAMETER LIST FOR AONOSTR0                                       S01194
     C*                                                                   S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           @KEYA   6                    A  S01194
     C                     PARM           @KEYB   3                    B  S01194
     C**********           PARM           @KEYC   4                    C               S01194 CGL029
     C                     PARM           @KEYC  10                                           CGL029
     C                     PARM           @KEYD   2                    D  S01194
     C                     PARM           @KEYE   2                    E  S01194
     C                     PARM           @KEYF   3                    F  S01194
     C                     PARM           @KEYG  10                    G  S01194
     C                     PARM           @KEYH   1                    H  S01194
     C           SDNOST    PARM SDNOST    DSFDY                           S01194
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOGELRR0                                       S01194
     C*                                                                   S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C********** SDGELR    PARM SDGELR    DSFDY                                        S01194 CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C***                                                                 S01194
     C* PARAMETER LIST FOR AORETLR0                                       S01194
     C*                                                                   S01194
     C           PLIST3    PLIST                                          S01194
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOCURRR0                                       S01194
     C*                                                                   S01194
     C           PLIST4    PLIST                                          S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOACODR0                                       S01194
     C*                                                                   S01194
     C           PLIST5    PLIST                                          S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C**********           PARM           ACOKEY  4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM           ACOKEY 10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOBRCHR0                                       S01194
     C*                                                                   S01194
     C           PLIST6    PLIST                                          S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           BRKEY   3                       S01194
     C********** SDBRCH    PARM SDBRCH    DSFDY                                        S01194 CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOBANKR0                                       S01194
     C*                                                                   S01194
     C           PLIST7    PLIST                                          S01194
     C                     PARM '*DBERR ' @RTCD                           S01194
     C                     PARM '*FIRST ' @OPTN                           S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   CAC001
     C**  Parameter list for AOPCACR0.                                    CAC001
     C*                                                                   CAC001
     C           PPCAC     PLIST                                          CAC001
     C                     PARM '*DBERR ' @RTCD                           CAC001
     C                     PARM '*FIRST ' @OPTN                           CAC001
     C           SDPCAC    PARM SDPCAC    DSFDY                           CAC001
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOCUSTR0                                       S01194
     C*                                                                   S01194
     C           PLIST8    PLIST                                          S01194
     C                     PARM '*BLANKS' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CLIKEY 10                       S01194
     C                     PARM '*BLANKS' KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C*                                                                   050831
     C**  Define key to file LF/OLPOS                                     050831
     C*                                                                   050831
     C           @OLPOS    KLIST                                          050831
     C                     KFLD           @BRCA   3                       050831
     C                     KFLD           @CCY    3                       050831
     C                     KFLD           @RECN   20                      050831
      *                                                                                       CRE020
      ** Midas RE Settled Transaction Index File Key Lists                                    CRE020
      *                                                                                       CRE020
     C           KADV1     KLIST                                                              CRE020
     C                     KFLD           KREFNO 30                                           CRE020
     C                     KFLD           KPRGMN 10                                           CRE020
     C                     KFLD           KSEQNO  3                                           CRE020
      *                                                                                       CRE020
     C           KADV2     KLIST                                                              CRE020
     C                     KFLD           KREFNO                                              CRE020
     C                     KFLD           KPRGMN                                              CRE020
      *                                                                                       CRE020
     C/COPY WNCPYSRC,RE0150C009
     C***                                                                 S01194
     C**   RPG ERROR HANDLING
     C           STATUS    IFEQ 01021
     C                     Z-ADD0         STATUS  50
     C                     GOTO INFTAG
     C                     END
     C/COPY WNCPYSRC,RE0150C041
0369 C**
     C**
     C*    READ WORKSTATION FILE /*HELP*FACILITY********                  S01199
     C**
     C**   FIRST CYCLE IND. 40 REPLACED BY FIELD 'FCYCL'                  S01117
     C**   FCYCL = ' ' IF 1ST CYCLE CALC. TO BE DONE,                     S01117
     C**         = '1' AFTER FIRST CYCLE CALC..                           S01117
     C**                                                                  S01117
     C********** *IN40     IFEQ '1'                                       S01117
     C           FCYCL     IFEQ '1'                                       S01117
     C           *IN87     DOUEQ'0'
     C                     MOVE *BLANKS   ACNKEY                          E16123
      *                                                                                       199219
      *  If action screen displayed clear variables                                           199219
      *                                                                                       199219
     C           *IN71     IFEQ *ON                                                           199219
     C                     EXSR CLEAR                                                         199219
     C                     ENDIF                                                              199219
      *                                                                                       199219
     C                     READ RE0150FM                 87
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C                     MOVE *BLANKS   DNAR                                                CRE020
     C                     MOVE *BLANKS   CNAR                                                CRE020
     C                     MOVELDNAA      DNAR                                                CRE020
     C                     MOVELCNAA      CNAR                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C************IN87     IFEQ '1'                                       S01199
     C***********          MOVEAERCD      HERCD 160                       S01199
     C***********          MOVEL'RE0150'  HBPGM   8                       S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C***********          END                                            S01199
     C/COPY WNCPYSRC,RE0150C020
     C                     END
      *                                                                   S01241
      **  Read the file SDMMODPD to find if WINDOW flag is on             S01241
      *                                                                   S01241
     C                     OPEN SDMMODPD                                  S01241
     C           1         SETLLSDMMODPD                                  E22221
     C                     READ SDMMODPD                 99               S01241
     C           *IN99     IFEQ '1'                        B1             S01241
     C           *LOCK     IN   LDA                                       S01413
     C***********          MOVE '1'       *INU7            *1       S01241S01413
     C***********          MOVE '1'       *INU8            *********S01241S01413
     C                     MOVEL'SDMMO'   DBFILE           * DBERROR 999  S01241
     C                     MOVEL*BLANKS   DBKEY            ***************S01241
     C                     MOVE '999'     DBASE            *1             S01241
     C***********          MOVE '1'       *INLR            *1       S01241S01413
     C                     MOVE '1'       *INKC            *1             S01241
     C                     OUT  LDA                                       S01413
     C***********          DUMP                            *1       S01241S01413
     C***********          GOTO END                        *1       S01241S01413
     C                     EXSR DBSR                                      S01413
     C                     END                             E1             S01241
     C                     CLOSESDMMODPD                                  S01241
      *                                                                   CDE002
      ** Access SAR details file to determine if CDE002 is switched on    CDE002
      *                                                                   CDE002
     C                     CALL 'AOSARDR0'                                CDE002
     C                     PARM *BLANKS   PRTCD   7                       CDE002
     C                     PARM '*VERIFY' POPTN   7                       CDE002
     C                     PARM 'CDE002'  PSARD   6                       CDE002
     C           SCSARD    PARM SCSARD    DSFDY                           CDE002
      *                                                                   CDE002
     C                     MOVE 'N'       CDE002  1                       CDE002
     C           PRTCD     IFEQ *BLANKS                                   CDE002
     C                     MOVE 'Y'       CDE002                          CDE002
     C                     MOVE '1'       *IN49                           CDE002
     C                     ENDIF                                          CDE002
      *                                                                                       CGL014
      ** Check if enhancement CGL014 (Collaterals Processing) is on                           CGL014
      *                                                                                       CGL014
     C                     CALL 'AOSARDR0'                                                    CGL014
     C                     PARM *BLANKS   PRTCD                                               CGL014
     C                     PARM '*VERIFY' POPTN                                               CGL014
     C                     PARM 'CGL014'  PSARD                                               CGL014
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ *BLANKS                                                       CGL014
     C                     MOVE 'Y'       CGL014  1                                           CGL014
     C                     ELSE                                                               CGL014
     C                     MOVE 'N'       CGL014                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C/COPY WNCPYSRC,RE0150C036
      *                                                                   S01241
      **  If Analytical Accounting is installed, access Profit Centre     CAC001
      **  Accounting ICD                                                  CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '1'       *IN49                           CAC001
     C                     CALL 'AOPCACR0'PPCAC                           CAC001
      *                                                                   CAC001
     C           @RTCD     IFNE *BLANK                                    CAC001
     C           *LOCK     IN   LDA                                       CAC001
     C                     MOVEL'SDPCACPD'DBFILE                          CAC001
     C                     Z-ADD702       DBASE                           CAC001
     C                     MOVEL@OPTN     DBKEY                           CAC001
     C                     OUT  LDA                                       CAC001
     C                     EXSR DBSR                                      CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ELSE                                           CAC001
     C           CDE002    IFNE 'Y'                                       CDE002
     C                     MOVE '0'       *IN49                           CAC001
     C                     ENDIF                                          CDE002
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
0260 C                     GOTO ENDFC
     C                     END
0256 C**   FIRST CYCLE ONLY CALCULATIONS.
0258 C**N40******          SETON                     40                   S01117
     C           FCYCL     IFEQ ' '                                       S01117
     C                     MOVE '1'       FCYCL   1                       S01117
     C                     MOVE '0'       WARN    1                       CAC001
     C                     MOVE '0'       WWARN   1                                           CGL014
     C                     Z-ADD0         WCOPY  130                                          CGL014
     C/COPY WNCPYSRC,RE0150C037
     C                     END                                            S01117
     C**                                                                  S01117
     C**   INITIALIZE LDA FIELDS                                          S01117
     C           *NAMVAR   DEFN           LDA                             S01124
     C           *LOCK     IN   LDA                                       LN0085
     C                     MOVE *BLANKS   DBFILE                          S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVE *BLANKS   DBPGM                           S01117
     C                     MOVEL'RE0150'  DBPGM                           S01117
     C                     Z-ADD0         DBASE                           S01413
     C                     OUT  LDA                                       S01413
0262 C**
0432 C**
0433 C**  GET INSTALLATION CONTROL DATA RECORD1
0434 C***********          EXSR ZSYSTM                                    S01194
     C                     CALL 'AOBANKR0'PLIST7                          S01194
     C*                                                                   S01194
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
     C*                                                                   S01194
0435 C***99******          SETON                     U841LRNOT FOUND      S01194
0436 C***99******          GOTO END                        DATABASE ERROR S01194
0437 C***********                                                         S01194
0438 C****OBTAIN*INST.*CONTROL*DATA*RECORD2*FOR*BASE*CURRENCY             S01194
     C*****AND*MULTI-BRANCHING*INDICATOR                                  S01194
     C*****AND*BACK-VALUE*PERIOD                                    S01111S01194
0439 C***********          MOVEL'01      'TBKEY                           S01194
0440 C***********          MOVE '  11'    TBKEY                           S01194
0441 C***********          EXSR TABCHN                                    S01194
      ** ACCESS GENERAL LEDGER DETAILS TO OBTAIN PROFIT CENTRE DEFAULTS   S01194
     C**********           CALL 'AOGELRR0'PLIST2                          S01194              CGL029
     C                     CALL 'AOGELRR1'PLIST2                                              CGL029
0442 C***99******          SETON                     U841LRDATABASE ERROR S01194
0443 C***99******          GOTO END                                       S01194
     C**                                                                  E16127
     C**   CHAIN TO GET MAXIMUM FORWARD DAYS                              E16127
     C***********          MOVEL'01      'TBKEY                     E16127S01194
     C***********          MOVE '  55'    TBKEY                     E16127S01194
     C***********          EXSR TABCHN                              E16127S01194
      ** ACCESS RETAIL DETAILS                                            S01194
     C                     CALL 'AORETLR0'PLIST3                          S01194
     C/COPY WNCPYSRC,RE0150C060
     C***99******          SETON                     U841LRDATABASERE16127S01194
     C***99******          GOTO END                                 E16127S01194
     C**                                                                  S01117
     C**   GET MBIN FROM DTAARA/RUNDAT                                    S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C********** *NAMVAR   DEFN           LDA                       S01117LN0085
     C********** *LOCK     IN   LDA                                 S01117LN0085
     C**
     C**   SET ON *IN67 IF MULTI-BRANCHING INDICATOR IS 'Y'
     C*********AND*DFBR IS ZERO                                           S01117
     C**   IF MBIN = N, PROTECT AND NON-DISPLAY ALL BRANCH FIELDS         S01117
     C***39**    MBIN      COMP 'Y'                      67               S01117
     C           MBIN      COMP 'Y'                      67               S01117
     C*                                                                   S01117
     C**    GET USER'S DEFAULT BRANCH                                     S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C                     IN   ZMUSER                                    S01117
     C*                                                                   S01117
     C**    CHECK IF 'PROFIT CENTRE USED'                                 S01117
     C           PFCU      IFNE 'Y'                                       S01117
     C                     SETON                     40                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**   SET UP BACK-VALUE LIMIT DATE                                   S01111
     C***********RUND      SUB  BVLP      BVLIMD  50                S01111S01194
     C           RUND      SUB  BJBVPD    BVLIMD  50                      S01194
0444 C**
0445 C*****GET*ICDR*3*AND RELEASE                                         S01194
0446 C***********          MOVE '20'      TBKEY                           S01194
0447 C***********          EXSR TABCHN                                    S01194
0448 C***********RACN      COMP 'Y'                      81               S01194
     C           BMRANR    COMP 'Y'                      81               S01194
0449 C                     MOVE ' '       BLNK93 93
0450 C                     MOVE ' '       BLANKS150        BLANK FIELD
0451 C                     MOVE ' '       BLNK12 12
0452 C                     MOVE ' '       BLNK16 16
0453 C********             MOVE ' '       BLK184184
0453 C                     MOVE ' '       BLK223223
0454 C                     MOVEL'00000000'ZERO16 16
0455 C                     MOVE '00000000'ZERO16
0456 C                     MOVE '999999'  DOCNT   6        * TRAILER KEY
0457 C**
0458 C                     Z-ADD0         ZERO5   50
0459 C***  RETRIEVE NO.OF DEC POS.FOR BASE CCY
0460 C***********          MOVE BLNK12    TBKEY                           S01194
0461 C***********          MOVE '20'      TBKY1                           S01194
0462 C***********          MOVE BCCY      TBKY2                           S01194
0463 C***********          MOVE '1'       TBKY3                           S01194
0464 C***********          EXSR TABCHN                                    S01194
     C                     MOVE BJCYCD    CKEY                            S01194
     C                     CALL 'AOCURRR0'PLIST4                          S01194
     C**  CHECK FOR DEALING CCY                                           S01194
     C           A6DLCI    COMP 'N'                      47               S01194
     C      47   S         ADD  1         S                               S01194
     C   47                MOVE '131'     ERCD,S                          S01194
0465 C***********          Z-ADDCDP       BCDP    10                      S01194
0465 C                     Z-ADDA6NBDP    BCDP    10                      S01194
     C*                                                                   S01111
     C***SETUP*KEY*FIELDS*FOR ACCOUNT CODE CHAIN                    S01111S01194
     C***********          MOVE '30'      ACOD1                     S01111S01194
     C***********          MOVE '1'       ACOD2                     S01111S01194
     C*                                                                   S01111
     C***SETUP*KEY*FOR*CLIENT FILE CHAIN                            S01111S01194
     C***********          MOVE 'A'       CLIKEY  7                 S01111S01194
     C***********          MOVE '70'      NOKY1                     S01111S01194
0466 C****
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0150CCPG                                           S01408
     C*                                                                   S01408
      ** Check if CRE020 is enabled.                                                          CRE020
      *                                                                                       CRE020
     C                     CALL 'AOSARDR0'                                                    CRE020
     C                     PARM *BLANKS   PRTCD                                               CRE020
     C                     PARM '*VERIFY' POPTN                                               CRE020
     C                     PARM 'CRE020'  PSARD                                               CRE020
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE020
      *                                                                                       CRE020
     C                     MOVE 'N'       CRE020  1                                           CRE020
      *                                                                                       CRE020
     C           PRTCD     IFEQ *BLANKS                                                       CRE020
     C                     MOVE 'Y'       CRE020                                              CRE020
     C                     MOVEL'RE0150'  KPRGMN                                              CRE020
     C                     MOVE *ON       *IN85                                               CRE020
     C                     ELSE                                                               CRE020
      *                                                                                       CRE020
     C           PRTCD     IFNE '*NRF'                                                        CRE020
     C           *LOCK     IN   LDA                                                           CRE020
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE020
     C                     MOVELPSARD     DBKEY                                               CRE020
     C                     Z-ADD101       DBASE                                               CRE020
     C                     OUT  LDA                                                           CRE020
     C                     EXSR DBSR                                                          CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** Check if a System Value exists for this maintenance.                                 CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
      *                                                                                       CRE020
     C                     CALL 'AOSVALR0'                                                    CRE020
     C                     PARM *BLANKS   PRTCD                                               CRE020
     C                     PARM CUSX      PSV01  20                                           CRE020
     C                     PARM           PCS01 200                                           CRE020
     C                     PARM           PSV02  20                                           CRE020
     C                     PARM           PCS02 200                                           CRE020
     C                     PARM           PSV03  20                                           CRE020
     C                     PARM           PCS03 200                                           CRE020
     C                     PARM           PSV04  20                                           CRE020
     C                     PARM           PCS04 200                                           CRE020
     C                     PARM           PSV05  20                                           CRE020
     C                     PARM           PCS05 200                                           CRE020
     C                     PARM           PSV06  20                                           CRE020
     C                     PARM           PCS06 200                                           CRE020
     C                     PARM           PSV07  20                                           CRE020
     C                     PARM           PCS07 200                                           CRE020
     C                     PARM           PSV08  20                                           CRE020
     C                     PARM           PCS08 200                                           CRE020
     C                     PARM           PSV09  20                                           CRE020
     C                     PARM           PCS09 200                                           CRE020
     C                     PARM           PSV10  20                                           CRE020
     C                     PARM           PCS10 200                                           CRE020
      *                                                                                       CRE020
     C                     MOVE 'N'       WSV01   1                                           CRE020
      *                                                                                       CRE020
     C           PRTCD     IFEQ *BLANKS                                                       CRE020
     C                     MOVELPCS01     WSV01                                               CRE020
     C                     ELSE                                                               CRE020
      *                                                                                       CRE020
     C           PRTCD     IFNE '*NRF'                                                        CRE020
     C           *LOCK     IN   LDA                                                           CRE020
     C                     MOVEL'SDSVALPD'DBFILE                                              CRE020
     C                     MOVELPSV01     DBKEY                                               CRE020
     C                     Z-ADD102       DBASE                                               CRE020
     C                     OUT  LDA                                                           CRE020
     C                     EXSR DBSR                                                          CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
0467 C           ENDFC     TAG                             * ENDFC TAG
     C**
0468 C**
0469 C**  RESET INDICATORS AND FIELDS
0470 C**
0471 C                     SETOF                     596061
     C                     SETOF                     2028                 S01117
0472 C                     SETOF                     626364
     C                     SETOF                     6566
0474 C                     SETOF                     686970
0475 C                     SETOF                     727374
0476 C                     SETOF                     757641
0477 C                     SETOF                       4344
0478 C                     SETOF                     797155
0479 C                     SETOF                     131609
0480 C                     SETOF                     87
     C                     SETOF                     101112               S01111
     C                     SETOF                     828399               S01111
     C                     SETOF                     84                   E16125
     C**
     C                     SETOF                     58
     C                     MOVEL'0'       *IN08                           CAC001
     C                     MOVE '0'       *IN27                           CAC001
     C                     Z-ADD*ZEROS    WFXMP   72                      CAC001
      *                                                                                       CAP205
      ** Access SAR details file to see if CAP205 is installed.                               CAP205
      *                                                                                       CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM *BLANKS   PRTCD                                               CAP205
     C                     PARM '*VERIFY' POPTN                                               CAP205
     C                     PARM 'CAP205'  PSARD                                               CAP205
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP205
      *                                                                                       CAP205
     C                     MOVE 'N'       CAP205  1                                           CAP205
     C           PRTCD     IFEQ *BLANKS                                                       CAP205
     C                     MOVE 'Y'       CAP205                                              CAP205
     C                     ELSE                                                               CAP205
     C           PRTCD     IFNE '*NRF    '                                                    CAP205
     C           *LOCK     IN   LDA                                                           CAP205
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP205
     C                     MOVEL'CAP205'  DBKEY                                               CAP205
     C                     Z-ADD7         DBASE                                               CAP205
     C                     MOVE *ON       *INKC                                               CAP205
     C                     OUT  LDA                                                           CAP205
     C                     EXSR DBSR                                                          CAP205
     C                     ENDIF                                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CRE019
      ** Access SAR details file to see if CRE019 is installed.                               CRE019
      *                                                                                       CRE019
     C                     CALL 'AOSARDR0'                                                    CRE019
     C                     PARM *BLANKS   PRTCD                                               CRE019
     C                     PARM '*VERIFY' POPTN                                               CRE019
     C                     PARM 'CRE019'  PSARD                                               CRE019
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE019
      *                                                                                       CRE019
     C           PRTCD     IFNE *BLANKS                                                       CRE019
     C           PRTCD     ANDNE'*NRF    '                                                    CRE019
     C           *LOCK     IN   LDA                                                           CRE019
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE019
     C                     MOVEL'CRE019'  DBKEY                                               CRE019
     C                     Z-ADD1         DBASE                                               CRE019
     C                     MOVE *ON       *INKC                                               CRE019
     C                     OUT  LDA                                                           CRE019
     C                     EXSR DBSR                                                          CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C           PRTCD     IFEQ *BLANK                                                        CRE019
     C**********           MOVE *OFF      *IN85                                        CRE019 CAAA03
     C                     MOVE 'Y'       CRE019  1                                           CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
      ** Initialize message data for Cheques                                                  CRE019
      *                                                                                       CRE019
     C           CRE019    IFEQ 'Y'                                                           CRE019
     C                     MOVE *BLANKS   ERMSG1 76                                           CRE019
      *                                                                                       CRE019
      ** Check if previous error was only with check number field                             CRE019
      *                                                                                       CRE019
     C           S         IFEQ 1                                                             CRE019
     C           ERCD,S    ANDEQ' 028'                                                        CRE019
     C                     MOVE 'Y'       W028    1                                           CRE019
     C                     ELSE                                                               CRE019
     C                     MOVE 'N'       W028                                                CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     ENDIF                                                              CRE019
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CCP7                                           S01408
     C*                                                                   S01408
0482 C                     SETON                     7778
0483 C**
1446 C                     MOVE '   '     WKCOD   3                       E13304
0484 C                     MOVE BLANKS    ERCD
0485 C                     Z-ADD0         S       20
0486 C**
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CCP8                                           S01408
     C*                                                                   S01408
0487 C                     Z-ADD0         DRAMN0
0488 C                     Z-ADD0         CRAMN0
0489 C                     Z-ADD0         EXRTN
0490 C                     Z-ADD0         BCEQ0
     C*                                                                   S01111
     C** ZEROISE CHARGES FIELDS                                           S01111
     C**********           MOVE '0000'    CHACDO  4                                    S01111 CGL029
     C                     MOVE *ZEROS    CHACDO 10                                           CGL029
     C**********           MOVE '000000'  CHCUSO                                       S01111 CSD027
     C                     MOVE *BLANKS   CHCUSO                                              CSD027
     C                     MOVE '00'      CHASQO                          S01111
     C                     MOVE ' '       CHSGNO  1                       S01111
     C                     Z-ADD0         CHAMTO                          S01111
     C                     MOVE *BLANKS   CHCCYO                          S01111
0491 C**
0492 C**
0493 C**  RESET LAST UPDATE DATA FIELDS FOR NEW TRANSACTION
0494 C   01                Z-ADD0         TNLU
0495 C   01                Z-ADD0         TNLU2
0496 C   01                Z-ADD0         LCD1
0497 C   01                MOVE ' '       CHTP1
0498 C**
0499 C**  TEST FOR COMMAND KEYS AND TAKE APPROPRIATE ACTION
0500 C**
0501 C   KC                SETON                     41LR  END OF JOB
0502 C   KC                GOTO END
0503 C**
0504 C   KL                GOTO SFOUT                      INITIAL SCREEN
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CCP9                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP20                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP10                                           S01408
     C*                                                                   S01408
0505 C**
0506 C** INVALID SCREEN OR INVALID COMMAND KEYS TEST
0507 C**
0508 C   03NKJ                                             INVALID SCREEN
0509 COR KJN03             SETON                     4387  INVALID CMD.KEY
     C/COPY WNCPYSRC,RE0150C021
0510 C   43                SETOF                     78
0511 C   43 01             SETON                     7179                 E12270
0511 C   43N01             SETON                     70  55
0512 C***43*******         MOVELERRMSG,1  ERMSG  52        INVALID CMD.KEY078607
0512 C   43                MOVELERRMSG,1  ERMSG  74        INVALID CMD.KEY078607
0513 C   43                GOTO SCNOUT
     C**      SETON 39 / 54 INDICATORS DEPENDING ON INPUT                 S01117
     C           ACTCD     IFEQ 'I'                                       S01117
     C           DRAC      ANDEQ0                                         S01117
     C           DACNA     ANDNE*BLANKS                                   S01117
     C                     SETON                     39                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     39                   S01117
     C                     END                                            S01117
     C           ACTCD     IFEQ 'I'                                       S01117
     C           CRAC      ANDEQ0                                         S01117
     C           CACNA     ANDNE*BLANKS                                   S01117
     C                     SETON                     54                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     54                   S01117
     C                     END                                            S01117
0514 C**
0515 C**  ACTION SCREEN TEST
0516 C   01                GOTO SCRN1
0517 C   03                GOTO DLSCRN
0518 C   02                GOTO INSCRN
     C/COPY WNCPYSRC,RE0150C016
0519 C**
0520 C**  FIRST CYCLE BLANK SCREEN OR CMD 12 INPUT
0521 C           SFOUT     TAG                             * SFOUT TAG
0522 C********             MOVE BLK184    SCFLDS                          S01111
0522 C***********          MOVE BLK223    SCFLDS                    S01111S01117
     C                     MOVE *BLANKS   SCFLDS                          S01117
0523 C                     SETON                     417971
0524 C                     SETON                       55
0525 C**
     C/COPY WNCPYSRC,RE0150C010
0526 C                     GOTO SCNOUT
     C/COPY WNCPYSRC,RE0150C011
0527 C********************************************************************
0528 C**  HANDLE INITIAL SCREEN TYPE SF.
0529 C           SCRN1     TAG                             * SCRN1 TAG
     C/COPY WNCPYSRC,RE0150C042
0530 C**
0531 C**  VALIDATE ACTION CODE
0532 C                     SETOF                     454659
     C/COPY WNCPYSRC,RE0150C058
0533 C           ACTCD     COMP 'I'                      45
0534 C  N45      ACTCD     COMP 'D'                  595946
     C   59      ACTCD     COMP 'E'                  5959                 S01413
     C/COPY WNCPYSRC,RE0150C043
0535 C**
     C**  VALIDATE USER'S AUTHORITY TO ACTION = 'I'                       S01117
     C**  IF  MBIN  EQ  N   ACTION CODE MUST BE VALID                     S01117
     C**  FOR THE USER   :  CALL ZVACTU                                   S01117
     C*                                                                   S01117
     C                     Z-ADD*ZERO     @ERR                            S01117
     C*                                                                   S01117
     C           ACTCD     IFEQ 'I'                        *B1            S01117
     C           MBIN      ANDEQ'N'                                       S01117
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM ACTCD     @ZACTN  1                       S01117
     C                     PARM           @ERR    10                      S01117
     C*                                                                   S01117
     C           @ERR      IFNE 0                          *B2            S01117
     C           S         ADD  1         S                               S01117
     C                     SETON                     59                   S01117
     C                     MOVE '302'     ERCD,S                          S01117
     C**********           MOVELERRMSG,10 ERMSG                     S01117078607
     C                     MOVELERRMSG,13 ERMSG                           078607
     C                     END                             *E2            S01117
     C*                                                                   S01117
     C                     END                             *E1            S01117
0536 C**
0537 C  N59                GOTO DOCNV
0538 C***********S         ADD  1         S                               S01117
0539 C***********          MOVE '012'     ERCD,S                          S01117
0540 C***********          MOVELERRMSG,3  ERMSG                           S01117
     C/COPY WNCPYSRC,RE0150C050
0538 C  N45N46   S         ADD  1         S                               S01117
0539 C  N45N46             MOVE '012'     ERCD,S                          S01117
0540 C  N45N46             MOVELERRMSG,3  ERMSG                           S01117
     C/COPY WNCPYSRC,RE0150C044
0541 C                     SETON                     4371
0542 C                     SETON                       55
0543 C                     SETOF                     7778
0544 C                     GOTO SCNOUT
0545 C**  VALIDATE INPUT DOCUMENT NO. - ENSURE-'CENNNN'
0546 C           DOCNV     TAG                             * DOCNV TAG
     C* IF INSERT, MUST BE BLANK                                          S01413
     C           *IN45     IFEQ '1'                                       S01413
     C           DOCN      IFNE '      '                                  S01413
     C                     SETON                     60                   S01413
     C                     ADD  1         S                               S01413
     C                     MOVE '911'     ERCD,S                          S01413
     C                     GOTO DOCNER                                    S01413
     C                     END                                            S01413
     C                     GOTO SFOK                                      S01413
     C                     END                                            S01413
     C* DELETE OR ENQUIRE                                                 S01413
0547 C                     MOVELDOCN      WRK2    2
0548 C           WRK2      COMP 'CE'                 6060
0549 C  N60                MOVE DOCN      WRK4    4
0550 C  N60                MOVELWRK4      WRK5    50
0551 C  N60                MOVELWRK5      WRK4A   4
0552 C  N60      WRK4      COMP WRK4A                6060
0553 C   60      S         ADD  1         S
0554 C   60                MOVE '079'     ERCD,S
0555 C   60                GOTO DOCNER                     NOT 'CENNN'
0556 C**
0557 C****ENSURE*INSERT*NOT ON FILE/DELETE ON FILE                        S01413
     C* DELETE OR ENQUIRE                                                 S01413
     C/COPY WNCPYSRC,RE0150C045
0558 C           DOCN      CHAINCUSEX                47
     C/COPY WNCPYSRC,RE0150C038
0559 C  N47                SETON                     42
0560 C  N47                EXSR EXCPTN
0561 C**
0562 C***45*17***                                          INSERT THERE   S01413
0563 C*R*46N17***                                          DELETE NOT THERS01413
0564 C*R*45*18***                                          INSERT - CLOSEDS01413
0565 C*R*46*18***          SETON                     60    DELETE-CLOSED  S01413
     C   46N17                                             DELETE NOT THERS01413
     COR 46 18                                             DELETE-CLOSED  S01413
     C/COPY WNCPYSRC,RE0150C046
     CORN46N17N18          SETON                     60    ENQUIRE NOT    S01413
     C/COPY WNCPYSRC,RE0150C047
0566 C  N60                GOTO SFOK
0567 C**
0568 C           S         ADD  1         S
0569 C***45*17***                                                         S01413
0570 C*R*45*18***          MOVE '016'     ERCD,S                          S01413
0571 C***45*17***                                                         S01413
0572 C*R*45*18***          MOVELERRMSG,6  ERMSG                           S01413
0573 C**
0574 C   46N17
0575 COR 46 18             MOVE '017'     ERCD,S
0576 C   46N17
0577 COR 46 18             MOVELERRMSG,7  ERMSG
     C/COPY WNCPYSRC,RE0150C048
     C  N46N17N18          MOVE '017'     ERCD,S                          S01413
     C  N46N17N18          MOVELERRMSG,10 ERMSG                           S01413
     C/COPY WNCPYSRC,RE0150C049
0578 C                     SETOF                     78
0579 C           DOCNER    TAG                             * DOCNER TAG
0580 C                     SETON                     4371
0581 C                     SETON                       55
0582 C                     SETOF                     77
     C/COPY WNCPYSRC,RE0150C059
0583 C                     GOTO SCNOUT
0584 C**
0585 C**  VALID ACTION CODE AND INPUT DOCUMENT NO.
0586 C           SFOK      TAG                             * SFOK TAG
0587 C**
0588 C**  SAVE LAST UPDATE DATA USING DATA STRUCTURE
0589 C   17                MOVE TNLU1     TNLUS
0590 C**
0591 C**  DISPLAY REST OF THE FIELDS FOR INPUT
0592 C                     SETOF                     596071
0593 C   46                SETON                     4455
     C  N45N56             SETON                     4455                 S01413
0594 C                     SETON                     4370
0595 C   44      BEQU      COMP 0                        48
0596 C***44***** CCUS      COMP 0                        29                                   CSD027
0596 C   44      CCUS      COMP *BLANKS                  29                                   CSD027
0597 C**N46******          GOTO SCNOUT                                    S01413
0598 C*****FORMAT*DETAILS*FOR DELETE DISPLAY                              S01413
     C   45                GOTO SCNOUT                                    S01413
     C**  VALIDATE USER'S AUTHORITY TO ACTION = 'D'                       S01117
     C**  MBIN  IF  EQ  N   ACTION CODE MUST BE VALID                     S01117
     C**  FOR THE USER   :  CALL ZVACTU                                   S01117
     C*                                                                   S01117
     C                     Z-ADD*ZERO     @ERR                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'N'                        *B1            S01117
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM ACTCD     @ZACTN  1                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE 0                          *B2            S01117
     C           S         ADD  1         S                               S01117
     C                     MOVE '302'     ERCD,S                          S01117
     C**********           MOVELERRMSG,10 ERMSG                     S01117078607
     C                     MOVELERRMSG,13 ERMSG                           078607
     C                     SETON                     437159               S01117
     C                     SETON                     6155                 S01117
     C                     SETOF                     777870               S01117
     C                     GOTO SCNOUT                                    S01117
     C                     END                             *E2            S01117
     C                     ELSE                            *X1            S01117
     C**  MBIN  IF  EQ  Y   ACTION/BRANCH CODE MUST BE VALID              S01117
     C**       FOR THE USER   :  CALL ZVACTBU                             S01117
     C**                                                                  S01117
     C**  TRANSACTION BRANCH/ACTION VALIDATION                            S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM ACTCD     @ZACTN  1                       S01117
     C                     PARM BRCDT     @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE 0                          *B2            S01117
     C           S         ADD  1         S                               S01117
      *                                                                   S01117
     C           @ERR      IFEQ 1                          *B3            S01117
     C                     MOVE '303'     ERCD,S                          S01117
     C*************        MOVELERRMSG,11 ERMSG                     S01117078607
     C                     MOVELERRMSG,14 ERMSG                           078607
     C                     ELSE                            *X3            S01117
     C                     MOVE '304'     ERCD,S                          S01117
     C************         MOVELERRMSG,12 ERMSG                     S01117078607
     C                     MOVELERRMSG,15 ERMSG                           078607
     C                     END                             *E3            S01117
      *                                                                   S01117
     C                     SETON                     437159               S01117
     C                     SETON                     6155                 S01117
     C                     SETOF                     777870               S01117
     C                     GOTO SCNOUT                                    S01117
     C                     END                              *E2           S01117
     C                     END                              *E1           S01117
     C* FORMAT DETAILS FOR ENQUIRE/DELETE DISPLAY                         S01413
0599 C                     SETOF                     6573
0600 C                     SETOF                     7476
     C*                                                                   CAC001
     C**  Format FX Margin Points                                         CAC001
     C*                                                                   CAC001
     C                     MOVE *BLANKS   ZFIELD                          CAC001
     C                     MOVE FXMP      ZFIELD                          CAC001
     C                     Z-ADD2         ZADEC                           CAC001
     C                     EXSR ZEDIT                                     CAC001
     C                     MOVE ZFIELD    SFXMP                           CAC001
     C*                                                                   CAC001
     C**  Format FX Margin DR/CR Indicator                                CAC001
     C*                                                                   CAC001
     C                     MOVE FXIN      SFXIN                           CAC001
     C*                                                                   S01111
     C** CONVERT VALUE DAY NUMBERS TO 6-DIGIT DATES FOR OUTPUT            S01111
     C                     Z-ADDDRVD      ZDAYNO                          S01111
     C                     EXSR ZDATE2                                    S01111
     C                     MOVE ZDATE     DRVALD                          S01111
     C*                                                                   S01111
     C                     Z-ADDCRVD      ZDAYNO                          S01111
     C                     EXSR ZDATE2                                    S01111
     C                     MOVE ZDATE     CRVALD                          S01111
     C*                                                                   S01111
     C**   DETERMINE CHARGES SIGN IN ORDER TO EDIT CHARGE AMOUNT          S01111
     C           CHSN      COMP '+'                      86               S01111
     C*                                                                   S01111
0601 C**   FOR DELETE, GET DEC POS TO EDIT AMOUNTS
0602 C***********          MOVE BLNK12    TBKEY                           S01194
0603 C***********          MOVE '20'      TBKY1                           S01194
0604 C***********          MOVE DACY      TBKY2                           S01194
0605 C***********          MOVE '1'       TBKY3                           S01194
0606 C***********          EXSR TABCHN                                    S01194
     C                     MOVE DACY      CKEY                            S01194
     C                     CALL 'AOCURRR0'PLIST4                          S01194
     C**  CHECK FOR DEALING CCY                                           S01194
     C           A6DLCI    COMP 'N'                      47               S01194
     C      47   S         ADD  1         S                               S01194
     C   47                MOVE '131'     ERCD,S                          S01194
0607 C***********CDP       COMP 1                      5051               S01194
0608 C***********CDP       COMP 2                    53  52               S01194
0607 C           A6NBDP    COMP 1                      5051               S01194
0608 C           A6NBDP    COMP 2                    53  52               S01194
0609 C** - CREDIT
0610 C***********          MOVE CACY      TBKY2                           S01194
0610 C                     MOVE CACY      CKEY                            S01194
0611 C***********          EXSR TABCHN                                    S01194
     C                     CALL 'AOCURRR0'PLIST4                          S01194
1479 C**  CHECK FOR DEALING CCY                                           S01194
1480 C           A6DLCI    COMP 'N'                      47               S01194
1481 C      47   S         ADD  1         S                               S01194
0612 C***********CDP       COMP 1                      0405               S01194
0613 C***********CDP       COMP 2                    97  06               S01194
0612 C           A6NBDP    COMP 1                      0405               S01194
0613 C           A6NBDP    COMP 2                    97  06               S01194
0614 C** - BSE CCY EQUIV IF SPEC'D
0615 C  N48      BCDP      COMP 1                      3536
0616 C  N48      BCDP      COMP 2                    38  37
0617 C   48                SETOF                     3536
0618 C   48                SETOF                     3738
0619 C* SET INDS TO DECIDE O/P OF ACCOUNT
0620 C* CODE OR RETAIL ACCOUNT NUMBER
0621 C           DRAN      COMP 0                        56
0622 C           CRAN      COMP 0                        29
     C* DISPLAY 'RECORD DELETED' MESSAGE                                  S01413
     C           *IN46     IFEQ '0'                                       S01413
     C           *IN18     ANDEQ'1'                                       S01413
     C                     MOVELERRMSG,12 ERMSG                           S01413
     C                     SETOF                     78                   S01413
     C                     END                                            S01413
     C/COPY WNCPYSRC,RE0150C017
0623 C                     GOTO SCNOUT
0624 C******************************************    **********************
0625 C**  HANDLE INSERTIONS
0626 C**
0627 C           INSCRN    TAG                             * INSCRN TAG
     C**                                                                  S01117
     C**  TRANSACTION BRANCH CODE VALIDATION                              S01117
     C*   IF MBIN = N OR TRX. BRANCH FIELD BLANK, SET TO USER DEFAULT     S01117
     C*   OTHERWISE, VALIDATE BRANCH ENTERED                              S01117
     C**                                                                  S01117
     C                     MOVE '   '     TRBRCD                          S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'N'                        *B1            S01117
     C           ITBRC     OREQ '   '                                     S01117
     C                     MOVE USRBCH    ITBRC                           S01117
     C                     MOVE USRBCH    TRBRCD                          S01117
     C*                                                                   S01117
     C                     ELSE                            *X1            S01117
     C                     MOVE ITBRC     BRCDX   3                       S01117
     C                     EXSR BRCVAL                                    S01117
     C                     MOVE BRCDX     ITBRC                           LN0085
     C                     MOVE ITBRC     TRBRCD  3                       S01117
     C           *IN99     IFEQ '1'                        *B2            S01117
     C           S         ADD  1         S                               S01117
     C**********           MOVE '302'     ERCD,S                    S01117LN0085
     C                     MOVE '032'     ERCD,S                          LN0085
     C                     SETON                     20                   S01117
     C                     END                             *E2            S01117
     C                     END                             *E1            S01117
     C**                                                                  S01117
     C**  USER MUST HAVE AUTHORITY OF INSERTION FOR BRANCH ENTERED.       S01117
     C           MBIN      IFEQ 'Y'                        *B1            S01117
     C           *IN20     ANDNE'1'                                       S01117
     C                     Z-ADD0         @ERR                            S01117
     C*                                                                   S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM ACTCD     @ZACTN  1                       S01117
     C                     PARM ITBRC     @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE *ZERO                      *B2            S01117
     C           S         ADD  1         S                               S01117
      *                                                                   S01117
     C           @ERR      IFEQ 1                          *B3            S01117
     C                     MOVE '303'     ERCD,S                          S01117
     C************         MOVELERRMSG,11 ERMSG                     S01117078607
     C                     MOVELERRMSG,14 ERMSG                           078607
     C                     ELSE                            *X3            S01117
     C                     MOVE '304'     ERCD,S                          S01117
     C************         MOVELERRMSG,12 ERMSG                     S01117078607
     C                     MOVELERRMSG,15 ERMSG                           078607
     C                     END                             *E3            S01117
      *                                                                   S01117
     C                     SETON                     20                   S01117
     C                     END                             *E2            S01117
     C*                                                                   S01117
     C                     END                             *E1            S01117
     C**                                                                  S01117
     C**             +++++++++++++++++++++++++++++++++++++                S01117
     C**             ++   VALIDATE   DEBIT   DETAILS    ++                S01117
     C**             +++++++++++++++++++++++++++++++++++++                S01117
     C**                                                                  S01117
0628 C**
0629 C**BRANCH*CODE MANDATORY IF MULTI BRANCH INDICATOR ON                S01117
0630 C****ELSE*OPTIONAL - DEFAULTS TO S/TABLE,TG BRANCH CODE              S01117
     C***********                                                         S01117
     C***********BRCDI     IFEQ 0                                         S01117
     C***39******          GOTO BRCDER                                    S01117
     C**N39******          MOVE DFBR      BRCDI            DEFAULT BRANCH S01117
     C**N39******          GOTO DACNV                                     S01117
     C***********          END                                            S01117
0634 C***********                                                         S01117
0635 C****BRANCH*CODE IF ENTERED MUST BE A VALID BRANCH ON S/TABLE        S01117
0636 C***********          MOVE BLNK12    TBKEY                           S01117
0637 C***********          MOVEL'10'      TBKEY                           S01117
0638 C***********          MOVE BRCDI     TBKEY                           S01117
0639 C***********          EXSR TABCHN                                    S01117
0640 C***08******          GOTO DACNV                                     S01117
0641 C***********                                                         S01117
0642 C***********BRCDER    TAG                             * BRCDER TAG   S01117
0643 C***********S         ADD  1         S                               S01117
0644 C***********          MOVE '032'     ERCD,S                          S01117
0645 C***********          SETON                     61                   S01117
0646 C***********                                                         S01117
0647 C***********DACNV     TAG                             * DACNV TAG    S01117
1446 C**                                                                  E13304
1446 C**  MOVE BLANKS INTO WORK FIELD (USED IN E13304 FIX)                E13304
1446 C                     MOVE '   '     WKCOD                           E13304
0649 C**
0650 C**  D/R A/C CUST.NO. - MANDATORY IF RETAIL A/C BLANK
0651 C**  OTHERWISE MUST BE BLANK
0652 C**                                                                  E17935
     C                     MOVE ' '       ATYP                            S01111
     C**********           MOVE '   '     DRBRCD                    S01117LN0085
     C  N25                MOVE '   '     DRBRCD                          LN0085
0653 C***21*25***                                                         S01117
0654 C*RN21N25***          SETON                     62                   S01117
0655 C***62******S         ADD  1         S                               S01117
0656 C***62****************MOVE*'087'*****ERCD,S**************************E17935
0656 C***62******          MOVE '090'     ERCD,S                    E17935S01117
     C   21 25                                                            S01117
     CORN21N25             DO                                             S01117
     C                     SETON                     62                   S01117
     C           S         ADD  1         S                               S01117
     C                     MOVE '090'     ERCD,S                          S01117
     C                     END                                            S01117
     C**                                                                  S01111
     C****CHECK*FOR*NOSTRO*NUMBER*IF*NOT*IN*ERROR*******************S01111E17935
     C**  CHECK IF 2-DIGIT NOSTRO NUMBER USED IN PLACE OF 6-DIGIT DR A/C  E17935
     C**    NUMBER - USE NOSTRO + CURRENCY TO FIND ACCOUNT DETAILS.       E17935
     C**                                                                  E17935
     C                     Z-ADDS         M       20       SAV ERROR INDEXS01111
     C  N21      CHKDCM    IFEQ '    '                     NOSTRO ENTERED S01111
     C           DACNA     ANDNE'?     '                                  LN0085
     C  N25                                                               S01111
     CORN22                                                               S01111
     CORN23                                                               S01111
     CORN24                DO                                             S01111
     C           S         ADD  1         S                               S01111
     C                     MOVE '906'     ERCD,S                          S01111
     C  N22                                                               S01111
     CORN23                                                               S01111
     CORN24                SETON                     62                   S01111
     C  N25                SETON                     63                   S01111
     C                     END                                            S01111
     C   25                                                               S01111
     CAN 22 23 24          DO                                             S01111
     C***********          MOVELDACN      NOKY3                     S01111S01194
     C**********           MOVELDACN      @KEYE                     S01194LN0085
     C                     MOVELDACNA     @KEYE                           LN0085
     C***********          MOVE DRCY      NOKY2                     S01111S01194
     C                     MOVE DRCY      @KEYB                           S01194
     C***********          MOVE ' '       RECIN                     S01111S01194
     C***********NOTKEY    CHAINTABLE                99             S01111S01194
     C                     MOVE *BLANKS   @KEYA                           059665
     C                     MOVE *BLANKS   @KEYC                           059665
     C                     MOVE *BLANKS   @KEYD                           059665
     C                     MOVE *BLANKS   @KEYF                           059665
     C                     MOVE *BLANKS   @KEYG                           059665
     C                     MOVE *BLANKS   @KEYH                           059665
     C                     CALL 'AONOSTR0'PLIST1                          S01194
     C           @RTCD     COMP *BLANKS              9999                 S01194
     C           *IN99     IFEQ '0'                                       S01111
     C                     MOVELA7NONB    DACNA                           S01194
     C***********RECIN     ANDEQ'D'                                 S01111S01194
     C***********          MOVE CNUM      XCUS                      S01111S01194
     C***********          MOVE CCY       XCCY                      S01111S01194
     C***********          MOVE ACOD      XCOD                      S01111S01194
     C***********          MOVE ACSQ      XSEQ                      S01111S01194
     C                     MOVE A7CUST    XCUS                            S01194
     C                     MOVE A7CYCD    XCCY                            S01194
     C                     MOVE A7ACCD    XCOD                            S01194
     C                     MOVE A7ACSN    XSEQ                            S01194
     C                     MOVE A7BRCD    XBRC                            S01194
     C                     EXSR ACNCHN                                    S01111
     C**                                                                  E17935
     C**   CHECK DEBIT ACCOUNT FOR BLOCKED DEBITS.                        E17935
     C                     TESTB'2'       RETB           09               E17935
     C           *IN09     IFEQ '1'                                       E17935
     C           S         ADD  1         S                               E17935
     C                     MOVE '087'     ERCD,S                          E17935
     C                     SETON                     62                   E17935
     C                     SETOF                     09                   E17935
     C                     END                                            E17935
     C**                                                                  E17935
     C           *IN15     IFEQ '1'                                       S01111
     C**********           Z-ADDXCUS      DACN           21         S01111LN0085
     C**********           MOVE XCUS      DACNA                     S01111LN0085
     C                     MOVE XCUS      DACNA          21               LN0085
     C                     MOVE XCCY      DCCY           22               S01111
     C                     MOVE XCOD      DACD           23               S01111
     C                     MOVE XSEQ      DASQ           24               S01111
     C                     MOVE XBRC      DRBR                            S01117
     C           ATYP      IFEQ 'R'                                       S01111
     C***********RACN      ANDEQ'Y'                                 S01111S01194
     C           BMRANR    ANDEQ'Y'                                       S01194
     C**********           Z-ADD0         DACN           21         S01111LN0085
     C**********           MOVE '      '  DACNA                     S01111LN0085
     C                     MOVE '      '  DACNA          21               LN0085
     C                     Z-ADDRETNO     DRAC           25               S01111
     C                     MOVE RETNO     DRACA                           S01111
     C                     MOVE '   '     DCCY           22               S01111
     C**********           MOVE '    '    DACD           23                            S01111 CGL029
     C                     MOVE *BLANKS   DACD           23                                   CGL029
     C                     MOVE '  '      DASQ           24               S01111
     C                     END                                            S01111
     C                     ELSE                                           S01111
     C           S         ADD  1         S                               S01111
     C                     MOVE '909'     ERCD,S                          S01111
     C                     SETON                     6264                 S01111
     C                     END                                            S01111
     C                     ELSE                                           S01111
     C           S         ADD  1         S                               S01111
     C                     MOVE '907'     ERCD,S                          S01111
     C                     SETON                     6264                 S01111
     C                     END                                            S01111
     C                     END                                            S01111
     C                     END                                            S01111
     C**                                                                  LN0085
     C**  NEW STANDING DATA FIELDS VALIDATION                             LN0085
     C**                                                                  LN0085
     C*                                                                   LN0085
     C           *IN25     IFEQ '1'                                       LN0085
     C*                                                                   LN0085
     C                     MOVELDACNA     CLIKEY                          LN0085
     C                     CALL 'AOCUSTR0'PLIST8                          LN0085
     C           @RTCD     IFNE *BLANKS                                   LN0085
     C                     SETON                     62                   LN0085
     C                     ELSE                                           LN0085
     C                     MOVE BBCUST    DACNA                           LN0085
     C                     SETOF                     21                   LN0085
     C                     END                                            LN0085
     C*                                                                   LN0085
     C                     MOVE DACD      ACOKEY                          LN0085
     C                     CALL 'AOACODR0'PLIST5                          LN0085
     C           @RTCD     IFNE *BLANKS                                   LN0085
     C                     SETON                     62                   LN0085
     C                     ELSE                                           LN0085
     C                     MOVE A5ACCD    DACD                            LN0085
     C                     END                                            LN0085
     C*                                                                   LN0085
     C                     END                                            LN0085
     C           S         IFEQ M                                         S01111
0657 C**  DEBIT ACCOUNT CCY
0658 C** MANDATORY IF D/R A/C CUST.NO ENTERED - ELSE BLANK
0659 C   21N22
0660 CORN21 22             SETON                     62
0661 C**
0662 C   21N22
0663 CORN21 22   S         ADD  1         S
0664 C   21N22
0665 CORN21 22             MOVE '110'     ERCD,S
0666 C**
0667 C**  CHECK FOR ANY CCY EQUAL TO BASE CCY
0668 C***********DCCY      COMP BCCY                     48               S01194
0668 C           DCCY      COMP BJCYCD                   48               S01194
0669 C**  DEBIT ACCOUNT CODE MANDATORY IF D/R A/C CUST.NO ENTERED
0670 C**  ELSE MUST BE BLANK
0671 C   21N23
0672 CORN21 23             SETON                     62
0673 C**
0674 C   21N23
0675 CORN21 23   S         ADD  1         S
0676 C   21N23
0677 C**ORN21*23*************MOVE*'088'*****ERCD,S************************E17935
0677 CORN21 23             MOVE '111'     ERCD,S                          E17935
0678 C**
0679 C**  DEBIT A/C SEQ.NO.- OPTIONAL - DEFAULT IS '01'
0680 C**  MUST BE BLANK IF D/R A/C CUST. NO. IS BLANK
0681 C   21N24             SETON                     62
0682 C   21N24   S         ADD  1         S
0683 C***21N24*************MOVE*'089'*****ERCD,S**************************E17935
0683 C   21N24             MOVE '112'     ERCD,S                          E17935
0684 C**
0685 C  N21 24             MOVE '01'      DASQ             DEFAULT '01'
     C*                                                                   LN0085
     C* IF  RETAIL NUMBER NOT BLANK GOTO RETAIL VALIDATION                LN0085
0686 C***21*****                                                          LN0085
0687 C*ORN25****                                                          LN0085
0688 C*OR*62****            GOTO RETVAL                                   LN0085
     C  N25                GOTO RETVAL                                    LN0085
     C**  DEBIT BRANCH CODE VALIDATION :::  ACTION CODE IS I              S01117
     C*   IF MBIN = N OR DR BRANCH FIELD BLANK, SET TO USER DEFAULT       S01117
     C*   OTHERWISE, VALIDATE BRANCH ENTERED                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'N'                        *B2            S01117
     C           DRBR      OREQ '   '                                     S01117
     C                     MOVE USRBCH    DRBR                            S01117
     C                     MOVE USRBCH    DRBRCD                          S01117
     C*                                                                   S01117
     C                     ELSE                            *X2            S01117
     C           *IN25     IFEQ '1'                                       LN0085
     C                     MOVE DRBR      BRCDX   3                       S01117
     C                     EXSR BRCVAL                                    S01117
     C                     MOVE BRCDX     DRBR                            LN0085
     C                     MOVE DRBR      DRBRCD  3                       S01117
     C                     END                                            LN0085
     C**                                                                  S01117
     C           *IN99     IFEQ '1'                        *B3            S01117
     C           S         ADD  1         S                               S01117
     C                     MOVE '032'     ERCD,S                          S01117
     C                     SETON                     62                   S01117
     C                     END                             *E3            S01117
     C                     END                             *E2            S01117
     C*
0689 C**  CHAIN TO ACCOUNTS MASTER - A/C MUST EXIST AND BE OPEN
0690 C**********           MOVE DACN      XCUS                            LN0085
0690 C                     MOVE DACNA     XCUS                            LN0085
0691 C                     MOVE DCCY      XCCY
0692 C                     MOVE DACD      XCOD
0693 C                     MOVE DASQ      XSEQ
     C                     MOVE DRBRCD    XBRC                            S01117
0694 C                     EXSR ACNCHN
      *                                                                                       199219
     C           *IN47     IFEQ '0'                                                           199219
     C                     MOVE DRBR      DRBRCD  3                                           199219
     C                     MOVE DACNA     DRCNUM  6                                           199219
     C**********           MOVE DACD      DRACOD  4                                    199219 CGL029
     C                     MOVE DACD      DRACOD 10                                           CGL029
     C                     MOVE DASQ      DRACSQ  2                                           199219
     C                     ENDIF                                                              199219
     C*                                                                   134071
     C** Store DEBIT A/C for future use.                                  134071
     C*                                                                   134071
     C                     MOVELATYP      DRATYP                          134071
     C**                                                                  E17935
     C**    CHECK DEBIT ACCOUNT FOR BLOCKED DEBITS.                       E17935
     C                     TESTB'2'       RETB           09               E17935
     C           *IN09     IFEQ '1'                                       E17935
     C           S         ADD  1         S                               E17935
     C                     MOVE '087'     ERCD,S                          E17935
     C                     SETON                     62                   E17935
     C                     SETOF                     09                   E17935
     C                     END                                            E17935
     C**                                                                  E17935
0686 C   21                                                               LN0085
0687 CORN25                                                               LN0085
0688 COR 62                GOTO RETVAL                                    LN0085
     C**                                                                  E17935
0695 C**********           MOVE DACD      DRACOD  4                                           199219
0696 C                     MOVE DCCY      DRCCY   3
0697 C**********           MOVE DACN      DRCNUM  6                       LN0085
0697 C**********           MOVE DACNA     DRCNUM  6                                    LN0085 199219
0698 C**********           MOVE DASQ      DRACSQ  2                                           199219
0698 C                     MOVE DRCNUM    DWCNUM  6                       176510
0698 C                     MOVE BBACOC    DWACOF  2                       176510
0703 C**
0704 C**                          - IF SYSTEM SUPPORTS RETAIL NOS.
0705 C**                     A RETAIL NO MUST BE ENTERED FOR A RETAIL A/C
0706 C**
     C********** ATYP      IFEQ 'R'                                       188387
0708 C***81****25          SETON                     63                   188387
0709 C***81****25S         ADD  1         S                               188387
0710 C***81****25          MOVE '031'     ERCD,S                          188387
     C**********           END                                            188387
     C***
0711 C                     GOTO RCCYVL
0712 C**
0713 C           RETVAL    TAG                             * RETVAL TAG
0714 C**
0715 C**  DEBIT RETAIL ACCOUNT NO - MANDATORY IF DEBIT A/C CUST. NOT
0716 C**  ENTERED ELSE BLANK - MUST BE A VALID ACNO.
0717 C  N21N25
0718 COR 21 25             SETON                     63
0719 C**
0720 C**  RETAIL A/C NO. VALIDATION
0721 C  N63                SETOF                     1647
0722 C  N63N25   DRAC      CHAINACNUM                47
     C*                                                                   134071
     C** Store DEBIT A/C for future use.                                  134071
     C*                                                                   134071
     C           *IN63     IFEQ '0'                                       134071
     C           *IN25     ANDEQ'0'                                       134071
     C           *IN47     ANDEQ'0'                                       134071
     C                     MOVELATYP      DRATYP                          134071
     C                     ENDIF                                          134071
0723 C***47N63N25******                                    NOT ON FILE    E16125
0724 C*RN16N63N25******                                    DELETED        E16125
0725 C*R*16N37N63******    SETON                     63    CLOSED         E16125
0726 C*
     C**  IF ACCOUNT NOT ON FILE CLEAR CUSTOMER NO. FIELDS TO             E16125
     C**  ALLOW ERROR CODE '017' TO BE PRODUCED CORRECTLY.                E16125
     C**                                                                  E16125
     C  N16N37             MOVE *BLANKS   CNUM                            E16125
     C  N16N37             MOVE *BLANKS   CCY                             E16125
     C  N16N37             MOVE *BLANKS   ACOD                            E16125
     C  N16N37             MOVE *BLANKS   ACSQ                            E16125
     C  N16N37             MOVE *BLANKS   ABRCD                           S01117
0727 C   63      S         ADD  1         S
0728 C   63                MOVE '090'     ERCD,S
0729 C   25
0731 COR 63                GOTO RCCYVL
0732 C**
0733 C**  CHAIN TO ACCOUNT MASTER FOR EXISTENCE OF OPEN A/C CHECK
0734 C                     MOVE CNUM      XCUS
0735 C                     MOVE CCY       XCCY
0736 C                     MOVE ACOD      XCOD
0737 C                     MOVE ACSQ      XSEQ
     C                     MOVE ABRCD     XBRC                            S01117
     C                     SETON                     84                   E16125
0738 C                     EXSR ACNCHN
     C/COPY WNCPYSRC,RE0150C007
     C**                                                                  E17935
     C**   CHECK DR RETAIL ACCOUNT FOR BLOCKED DEBITS.                    E17935
     C                     TESTB'2'       RETB           09               E17935
     C           *IN09     IFEQ '1'                                       E17935
     C           S         ADD  1         S                               E17935
     C                     MOVE '088'     ERCD,S                          E17935
     C                     SETON                     63                   E17935
     C                     SETOF                     09                   E17935
     C                     END                                            E17935
     C**                                                                  E17935
     C**********           MOVE CNUM      CLIKEY                                       176510 194983
     C                     MOVELCNUM      CLIKEY                                              194983
     C                     CALL 'AOCUSTR0'PLIST8                          176510
     C           @RTCD     IFNE *BLANKS                                   176510
     C                     SETON                     63                   176510
     C                     ELSE                                           176510
     C                     MOVE BBCUST    CNUM                            176510
     C                     MOVE BBCUST    DWCNUM                          176510
     C                     MOVE BBACOC    DWACOF                          176510
     C                     SETON                     25                   176510
     C                     ENDIF                                          176510
      *                                                                   176510
0739 C                     MOVE CNUM      DRCNUM
0740 C                     MOVE CCY       DRCCY
0741 C                     MOVE ACOD      DRACOD
0742 C                     MOVE ACSQ      DRACSQ
     C                     MOVE ABRCD     DRBRCD                          S01117
0743 C**N15****************                                               E16125
0744 C**N36****************SETON                     63                   E16125
     C**N15N36*************SETON*********************63****RECI*NOT*E16125E17935
     C***47N25N63**********SETON*********************63****CHAIN*FAIE16125E17935
0746 C***63******S*********ADD**1*********S*******************************E17935
0747 C***63****************MOVE*'017'*****ERCD,S**************************E17935
0745 C*                                                                   E17935
     C  N15N36                                                            E17935
     COR 47N25N63          DO                                             E17935
0746 C           S         ADD  1         S                               E17935
0747 C                     MOVE '084'     ERCD,S                          E17935
     C                     SETON                     63                   E17935
     C                     END                                            E17935
     C**                                                                  E16125
     C**  IF ACCOUNT IS CLOSED SET ON BLINK LABEL FOR DR.RETAIL A/C NO.   E16125
     C   36                SETON                     63                   E16125
     C*
0748 C**
0749 C**
0750 C***DEBIT*CURRENCY*-MANDATORY*-*IF*RETAIL*A/C*NO.*ENTERED            S01413
0751 C****MUST*BE*SAME*AS*RETAIL*A/C*CCY******                            S01413
     C*                                                                   LN0085
     C* - AMENDMENT MADE TO PROGRAM SO THAT NOW DEBIT CURRENCY            LN0085
     C*   IS OBTAINED FROM ACNUM IN THE CASE OF RETAIL NO.S               LN0085
     C*                                                                   LN0085
      *                                                                   LN0085
     C                     SETOF                     07                   084152
     C           *IN22     IFEQ '1'                                       LN0085
     C                     MOVE CCY       CKEY                            LN0085
     C                     CALL 'AOCURRR0'PLIST4                          LN0085
      *                                                                   123468
      ** Validate currency if debit account is found                      123468
      *                                                                   123468
     C           *IN47     IFEQ '0'                                       123468
     C           DRCY      COMP CCY                  6464                 123468
     C   64                GOTO RCCYVL                                    123468
     C                     END                                            123468
     C           @RTCD     IFEQ *BLANKS                                   LN0085
     C                     SETON                     07                   084152
     C*                                                                   134071
     C** Currency field is a mandatory entry                              134071
     C*                                                                   134071
     C***********          MOVE CCY       DRCY                     LN0085 134071
     C                     END                                            LN0085
     C                     END                                            LN0085
     C*                                                                   LN0085
     C** IF NO RETAIL NUMBER ENTERED VALIDATE DEBIT CURRENCY AND          S01413
     C** CURRENCY OF THE ACCOUNT                                          S01413
     C**                                                                  S01413
0752 C           RCCYVL    TAG                             * RCCYVL TAG
0753 C**
0754 C  N21N26   DRCY      COMP DCCY                 6464
0755 C***26*****           SETON                     64                   LN0085
0755 C   26                SETON                     64                   S01413
     C*                                                                   134071
     C** If DR account number is not zero, DR currency field is not       134071
     C** blank, *IN64 is OFF and currency of account is not equal to      134071
     C** DR currency, set-up error number '121'.                          134071
     C*                                                                   134071
     C           *IN25     IFEQ *OFF                                      134071
     C           *IN26     ANDEQ*OFF                                      134071
     C           *IN64     ANDEQ*OFF                                      134071
     C           DRCY      ANDNECCY                                       134071
     C                     MOVE '1'       *IN64                           134071
     C                     ENDIF                                          134071
     C***64***** S         ADD  1         S                         E17935LN0085
     C***64N25***S         ADD  1         S                         LN0085E42978
     C   64      S         ADD  1         S                               E42978
     C***64*****           MOVE '121'     ERCD,S                    E17935LN0085
     C***64N25***          MOVE '121'     ERCD,S                    LN0085E42978
     C   64                MOVE '121'     ERCD,S                          E42978
     C*                                                                   S01413
     C** IF RETAIL NUMBER ENTERED VALIDATE CURRENCY OF ACCOUNT AGAINST    S01413
     C**  DEBIT CURRENCY                                                  S01413
0756 C**
0757 C**N64N25***DRCY      COMP CCY                  6464                 LN0085
     C**N64N25***DRCY      COMP CCY                  6464          S01413 134071
0758 C***64******S         ADD  1         S                               E11643
     C***64N25***S         ADD  1         S                        S01413 134071
     C***64N25***          MOVE '121'     ERCD,S                   S01413 134071
0759 C***64******          MOVE '110'     ERCD,S                          E11643
0758 C***64N62***S         ADD  1         S                         E11643E16125
0759 C***64N62***          MOVE '110'     ERCD,S                    E11643E16125
0758 C***64******S*********ADD**1*********S*************************E16125E17935
0759 C***64****************MOVE*'121'*****ERCD,S********************E16125E17935
     C                     END                                            S01111
0760 C**
0761 C**  CHECK FOR ANY CCY EQUAL TO BASE CCY
0762 C**N48******DRCY      COMP BCCY                     48               S01194
0762 C  N48      DRCY      COMP BJCYCD                   48               S01194
0763 C**
     C**
     C****SAVE DR BRANCH CODE FOR VALIDATION LATER                        S01117
     C*****                MOVE ABRCD     DRBRCD  30                      S01117
0766 C**
0767 C**  CHECK FOR RETAIL/NON-RETAIL A/C
0768 C******     ATYP      COMP 'R'                      25               S01111
0769 C***25*               Z-ADDRRNM      DMRRN   50                      S01111
     C                     MOVE '0'       DRRET   1                       S01111
0768 C***********ATYP      IFEQD'R'M      DMRRN   50                S01111CCB002
     C           ATYP      IFEQ 'R'                                       134071
0769 C                     Z-ADDRRNM      DMRRN   50                      S01111
     C                     MOVE '1'       DRRET                           S01111
     C***********          END                                      S01111CCB002
     C                     END                                            134071
0768 C           ATYP      IFEQ 'N'                                       E41812
     C                     MOVE '2'       DRRET                           E41812
     C                     END                                            E41812
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CVS1                                           S01408
     C*                                                                   S01408
     C**                                                                  S01111
     C**  VALIDATE DEBIT VALUE DATE FIELD DRVALD                          S01111
     C**  --------------------------------------                          S01111
     C**                                                                  S01111
     C                     Z-ADD0         VALUDT  50                      S01111
     C/COPY WNCPYSRC,RE0150C022
     C*                                                                   S01111
     C*      ENTRY NOT ACCEPTABLE - NON-RETAIL                            S01111
     C           DRVALD    IFNE '      '                   1              S01111
     C           ATYP      ANDNE'R'                        *              S01111
     C                     SETON                     82    *              S01111
     C                     END                             1              S01111
     C/COPY WNCPYSRC,RE0150C023
     C*                                                                   S01111
     C**     DEFAULT TO RUN DATE -                                        S01111
     C           DRVALD    IFEQ '      '                   1              S01111
     C*         FOR FILE                                   *              S01111
     C                     Z-ADDRUND      VALUDT           *              S01111
     C*         FOR SCREEN RE-OUTPUT IF NECESSARY          *              S01111
     C           ATYP      IFEQ 'R'                        * 2            S01111
     C/COPY WNCPYSRC,RE0150C024
     C                     Z-ADDRUND      ZDAYNO           * *            S01111
     C                     EXSR ZDATE2                     * *            S01111
     C                     MOVE ZDATE     DRVALD           * *            S01111
     C                     END                             * 2            S01111
     C                     END                             1              S01111
     C*                                                                   S01111
     C**     FIELD NOT BLANK - NUMERIC CHECK                              S01111
     C           ATYP      IFEQ 'R'                        1              S01111
     C/COPY WNCPYSRC,RE0150C025
     C           DRVALD    ANDNE'      '                   *              S01111
     C                     MOVE DRVALD    NUMIC7  70       *              S01111
     C                     MOVE NUMIC7    DRVALA  6        *              S01111
     C*                                                    *              S01111
     C**        INPUT NUMERIC                              *              S01111
     C           DRVALD    IFEQ DRVALA                     * 2            S01111
     C                     MOVE DRVALD    ZDATE            * *            S01111
     C                     EXSR ZDATE1                     * *            S01111
      *                                                                                      BUG7274
     C           DRVALD    IFNE DRVALP                                                       BUG7274
     C                     MOVE 'N'       WARN0                                              BUG7274
     C                     ENDIF                                                             BUG7274
     C                     MOVE DRVALD    DRVALP  6                                          BUG7274
      *                                                                                      BUG7274
     C*                                                    * *            S01111
     C**           INPUT SUCCESSFULLY CONVERTED TO DAY NO. * *            S01111
     C           ZDAYNO    IFGT 0                          * * 3          S01111
     C                     EXSR VALDAT                     * * *          S01111
     C*                    -----------                     * * *          S01111
     C                     END                             * * 3          S01111
     C*                                                    * *            S01111
     C                     END                             * 2            S01111
     C*                                                    *              S01111
     C                     END                             1              S01111
     C*                                                                   S01111
     C**     ACCEPTABLE VALUE DATE OBTAINED                               S01111
     C           VALUDT    IFGT 0                          1              S01111
     C                     Z-ADDVALUDT    DRVD             *              S01111
     C                     END                             1              S01111
     C*                                                                   S01111
     C*      CHECK VALUE DATE IS WITHIN MAXIMUM DAYS FORWARD              E16127
     C                     MOVE *ZERO     MFWDD   50                      E16127
     C***********RUND      ADD  MFWD      MFWDD                     E16127S01194
     C           RUND      ADD  BMNDFV    MFWDD                           S01194
     C           VALUDT    IFGT MFWDD                      1              E16127
     C                     SETON                     82    *              E16127
     C                     END                             1              E16127
     C*                                                                   E16127
     C*      ENTRY NOT ACCEPTED - INVALID                                 S01111
     C*                                                                   S01111
     C           VALUDT    IFEQ 0                          1              S01111
     C           ATYP      ANDEQ'R'                        *              S01111
     C                     SETON                     82    *              S01111
     C                     END                             1              S01111
     C*                                                                   S01111
     C*      ERROR                                                        S01111
     C*                                                                   S01111
     C           *IN82     IFEQ '1'                        1              S01111
     C           S         ADD  1         S                *              S01111
     C                     MOVE '114'     ERCD,S           *              S01111
     C                     END                             1              S01111
      *                                                                                      BUG7274
     C           WVDHOL    IFEQ 'Y'                                                          BUG7274
     C                     SETON                     82                                      BUG7274
     C                     ENDIF                                                             BUG7274
     C**                                                                  S01111
0770 C**
0771 C**  DEBIT AMOUNT - MANDATORY - ZALIGN VALIDATION
0772 C**  CHAIN TO TABLES FILE FOR NO. OF DECIMAL PLACES
0773 C***********          MOVE BLNK12    TBKEY                           S01194
0774 C***********          MOVE '20'      TBKY1                           S01194
0775 C***********          MOVE DCCY      TBKY2                           S01194
0776 C***22******          MOVE DRCY      TBKY2                           S01194
0775 C                     MOVE DCCY      CKEY                            S01194
0776 C***22******          MOVE DRCY      CKEY                            LN0085
0777 C***********          MOVE '1'       TBKY3                           S01194
     C                     Z-ADDS         M                               S01111
0778 C***********          EXSR TABCHN                                    S01194
     C           *IN25     IFEQ '1'                                       LN0085
     C                     SETOF                     07                   084152
     C                     CALL 'AOCURRR0'PLIST4                          S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     SETON                     07                   S01194
     C                     MOVE A6CYCD    DCCY                            S01194
     C*                                                                   134071
     C** Currency field is a mandatory entry                              134071
     C*                                                                   134071
     C***********DRCY      IFEQ *BLANKS                            LN0085 134071
     C***********          MOVE A6CYCD    DRCY                     LN0085 134071
     C***********          END                                     LN0085 134071
     C                     END                                            LN0085
     C********** *IN22     IFEQ '1'                                       LN0085
     C**********           MOVE A6CYCD    DRCY                            LN0085
     C**********           END                                            LN0085
     C                     END                                            S01194
     C*                                                                   LN0085
1479 C**  CHECK FOR DEALING CCY                                           S01194
1480 C           A6DLCI    COMP 'N'                      47               S01194
1481 C      47   S         ADD  1         S                               S01194
     C           S         IFNE M                                         S01111
     C*********************MOVE*'130'*****ERCD,S********************S01111E17935
     C                     MOVE '131'     ERCD,S                          E17935
     C                     END                                            S01111
0779 C**  SET ERROR IND. IF NOT DEALING CCY
0780 C   26 47             SETON                     62
0781 C   22 47             SETON                     64
0782 C**
0783 C***********          Z-ADDCDP       DCDP    10       D/R DEC. PLACESS01194
0784 C***********          Z-ADDSPOT      DSPOT  138                      S01194
0785 C***********          Z-ADDMDIN      DMDIN   10                      S01194
0783 C                     Z-ADDA6NBDP    DCDP    10       D/R DEC. PLACESS01194
     C                     Z-ADDA6NQDP    DNQDP   10                      CAC001
0784 C                     Z-ADDA6SPRT    DSPOT  138                      S01194
0785 C                     MOVE A6MDIN    DMDIN   1                       S01194
0786 C   07                Z-ADD1         HOLD1   10
0787 C  N07                Z-ADD0         HOLD1
0788 C**
0789 C***********          Z-ADDCDP       ZADEC            DECIMAL PLACES S01194
0790 C***********13        SUB  CDP       ZADIG            WHOLE DIGITS   S01194
0789 C                     Z-ADDA6NBDP    ZADEC            DECIMAL PLACES S01194
0790 C           13        SUB  A6NBDP    ZADIG            WHOLE DIGITS   S01194
0791 C                     MOVE BLNK16    ZFIELD
0792 C                     MOVELDRAM      ZFIELD 16
0793 C                     EXSR ZALIGN
0794 C  N99                MOVE ZFIELD    DRAMN0 130
0795 C   99                SETON                     65
0796 C   99      S         ADD  1         S
0797 C***99****************MOVE*'112'*****ERCD,S**************************E17935
0797 C   99                MOVE '113'     ERCD,S                          E17935
     C           *IN99     IFEQ *OFF                                                          CGL014
     C           CGL014    ANDEQ'Y'                                                           CGL014
     C           DRATYP    ANDEQ'R'                                                           CGL014
     C           COLF      ANDEQ'Y'                                                           CGL014
     C                     Z-ADDDRAMN0    PTAMNT                                              CGL014
      *                                                                                       CGL014
     C                     CALL 'GL006000'                                                    CGL014
     C                     PARM           PTAMNT 150                                          CGL014
     C                     PARM DRCCY     PTCCY   3                                           CGL014
     C                     PARM DRBRCD    PABRCA  3                                           CGL014
     C                     PARM DRCNUM    PACNUM  6                                           CGL014
     C                     PARM DRCCY     PACCY   3                                           CGL014
     C                     PARM DRACOD    PAACOD 10                                           CGL014
     C                     PARM DRACSQ    PAACSQ  2                                           CGL014
     C                     PARM RETNO     PAACNO 100                                          CGL014
     C                     PARM *BLANKS   PRTCD                                               CGL014
      *                                                                                       CGL014
      ** Error:  Available balance is not sufficient                                          CGL014
      ** to cover blocked amount                                                              CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ '*BLKERR'                                                     CGL014
     C                     MOVE *ON       *IN65                                               CGL014
     C                     ADD  1         S                                                   CGL014
     C                     MOVE '115'     ERCD,S                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
      ** Warning:  Balance is greater than blocked amount but less                            CGL014
      ** than minimum balance; minimum balance will be exceeded                               CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ '*WARN  '                                                     CGL014
     C           DRAMN0    IFNE WCOPY                                                         CGL014
     C                     MOVE '0'       WWARN                                               CGL014
     C                     ENDIF                                                              CGL014
     C           WWARN     IFEQ '0'                                                           CGL014
     C                     ADD  1         S                                                   CGL014
     C                     MOVE 'W02'     ERCD,S                                              CGL014
     C                     MOVE *ON       *IN65                                               CGL014
     C                     Z-ADDDRAMN0    WCOPY                                               CGL014
     C           S         IFEQ 1                                                             CGL014
     C                     MOVE '1'       WWARN                                               CGL014
     C                     ENDIF                                                              CGL014
     C                     ENDIF                                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C/COPY WNCPYSRC,RE0150C008
0798 C**
0799 C**  CHEQUE NO. - OPTIONAL - ONLY ENTERED FOR RETAIL A/CS
0800 C**N27N25****         SETON                     66                   S01111
     C           DRRET     IFNE '1'                                       S01111
0800 C**N27******          SETON                     66            S01111 CAC001
      *                                                                   CAC001
     C           DCHN      IFNE *ZEROS                                    CAC001
     C                     SETON                     66                   CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     END                                            S01111
0801 C**                        - NUMERIC CHECK
0802 C**N66N27***          MOVELDCHNA     NUMN9   90                      CAC001
0803 C**N66N27***          MOVELNUMN9     NUMA8   8                       CAC001
0804 C**N66N27***DCHNA     COMP NUMA8                6666                 CAC001
      *                                                                   CAC001
     C           *IN66     IFEQ '0'                                       CAC001
     C           DCHN      ANDNE*ZEROS                                    CAC001
     C                     MOVELDCHNA     NUMN9   90                      CAC001
     C                     MOVELNUMN9     NUMA8   8                       CAC001
     C           DCHNA     COMP NUMA8                6666                 CAC001
      *                                                                                       CRE019
      ** If cheque is a valid and CRE019 is installed, ensure that it                         CRE019
      ** is not a stopped cheque                                                              CRE019
      *                                                                                       CRE019
     C           *IN66     IFEQ *OFF                                                          CRE019
     C           CRE019    ANDEQ'Y'                                                           CRE019
     C                     MOVE 'N'       WCHQOK  1                                           CRE019
      *                                                                                       CRE019
     C           DRAC      IFEQ *ZEROS                                                        CRE019
     C                     MOVE RETNO     PRACN                                               CRE019
     C                     ELSE                                                               CRE019
     C                     MOVE BRCA      PBRCD                                               CRE019
     C                     MOVE CNUM      PCUST                                               CRE019
     C                     MOVE CCY       PCCY                                                CRE019
     C                     MOVE ACOD      PACCD                                               CRE019
     C                     MOVE ACSQ      PACSN                                               CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     MOVELDCHN      PCQNB                                               CRE019
     C                     MOVELDRAC      PRACN                                               CRE019
      *                                                                                       CRE019
     C                     CALL 'AOSTOPV0'                                                    CRE019
     C                     PARM *BLANKS   PRTCD   7                                           CRE019
     C                     PARM DRAMN0    PCQAM  130                                          CRE019
     C                     PARM           PCQNB   8                                           CRE019
     C                     PARM           PRACN  10                                           CRE019
     C                     PARM DACNA     PCUST   6                                           CRE019
     C                     PARM DCCY      PCCY    3                                           CRE019
     C                     PARM DACD      PACCD  10                                           CRE019
     C                     PARM DASQ      PACSN   2                                           CRE019
     C                     PARM DRBR      PBRCD   3                                           CRE019
      *                                                                                       CRE019
      ** Error if stopped cheque                                                              CRE019
      *                                                                                       CRE019
     C           PRTCD     IFEQ '*STOP'                                                       CRE019
     C                     MOVEL'USR1230' WERMSG                                              CRE019
     C                     EXSR SRERRM                                                        CRE019
     C                     MOVE *ON       *IN66                                               CRE019
     C                     ELSE                                                               CRE019
     C                     MOVE 'Y'       WCHQOK                                              CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
      ** Get screen value to check if any field was changed                                   CRE019
      *                                                                                       CRE019
     C                     MOVELDSDSP1    DSDSP3                                              CRE019
     C                     MOVE DSDSP2    DSDSP3                                              CRE019
      *                                                                                       CRE019
      ** If cheque number and retail account is still valid, check if                         CRE019
      ** already a presented cheque or out of range cheque                                    CRE019
      *                                                                                       CRE019
     C           *IN66     IFEQ *OFF                                                          CRE019
     C           DSDSP3    ANDNEDSSCRN                                                        CRE019
     C           *IN77     OREQ *ON                                                           CRE019
     C           *IN66     ANDEQ*OFF                                                          CRE019
     C           *IN78     OREQ *ON                                                           CRE019
     C           *IN66     ANDEQ*OFF                                                          CRE019
      *                                                                                       CRE019
      ** Bypass if error is only '028' ano no change in fields                                CRE019
      *                                                                                       CRE019
     C           W028      IFEQ 'Y'                                                           CRE019
     C           DSDSP3    ANDEQDSSCRN                                                        CRE019
     C                     ELSE                                                               CRE019
      *                                                                                       CRE019
      ** Initialise work flags for out of range and duplicate cheque                          CRE019
      *                                                                                       CRE019
     C                     MOVE 'N'       WRANGE  1                                           CRE019
     C                     MOVE 'N'       WDUP    1                                           CRE019
      *                                                                                       CRE019
      ** Set up key to access Cheque book file                                                CRE019
      *                                                                                       CRE019
     C           KCHQBK    KLIST                                                              CRE019
     C                     KFLD           KACNO  100                                          CRE019
     C                     KFLD           KGCIN   10                                          CRE019
     C                     KFLD           KSCQN   80                                          CRE019
      *                                                                                       CRE019
     C           KCHQB2    KLIST                                                              CRE019
     C                     KFLD           KACNO                                               CRE019
     C                     KFLD           KGCIN                                               CRE019
      *                                                                                       CRE019
     C           DRAC      IFNE *ZEROS                                                        CRE019
     C                     MOVE DRAC      KACNO                                               CRE019
     C                     ELSE                                                               CRE019
     C                     Z-ADDRETNO     KACNO                                               CRE019
     C                     ENDIF                                                              CRE019
     C                     Z-ADD0         KGCIN                                               CRE019
     C                     Z-ADDDCHN      KSCQN                                               CRE019
      *                                                                                       CRE019
      ** Set up key to access Cheque book file                                                CRE019
      *                                                                                       CRE019
     C           KCHQBK    SETGTCHQBKPDF                                                      CRE019
     C           KCHQB2    REDPECHQBKPDF                 66                                   CRE019
      *                                                                                       CRE019
      ** If record is found and RECI = 'D'                                                    CRE019
      *                                                                                       CRE019
     C           *IN66     IFEQ *OFF                                                          CRE019
     C           RECID     ANDEQ'D'                                                           CRE019
     C                     MOVE 'N'       WNLIVE  1                                           CRE019
      *                                                                                       CRE019
      ** If cheque is not in range expected for any of the cheque books                       CRE019
      *                                                                                       CRE019
     C           KSCQN     IFLT SCQN                                                          CRE019
     C           KSCQN     ORGT ECQN                                                          CRE019
      *                                                                                       CRE019
     C                     MOVEL'USR1232' WERMSG                                              CRE019
     C                     EXSR SRERRM                                                        CRE019
     C                     MOVE *ON       *IN66                                               CRE019
     C                     MOVE 'Y'       WRANGE                                              CRE019
      *                                                                                       CRE019
     C                     ELSE                                                               CRE019
      *                                                                                       CRE019
      ** Check if cheque has already been presented before                                    CRE019
      *                                                                                       CRE019
     C                     Z-ADDKSCQN     WSCQN   80                                          CRE019
     C           WSCQN     SUB  SCQN      WOFSET  80                                          CRE019
     C           WOFSET    DIV  8         WI      20                                          CRE019
     C                     MVR            WBITN   10                                          CRE019
     C                     ADD  1         WI                                                  CRE019
      *                                                                                       CRE019
      ** Test corresponding bit-position of element for cheque presented                      CRE019
      *                                                                                       CRE019
     C                     MOVEACQPS      WAR                                                 CRE019
     C           WBITN     IFEQ 0                                                             CRE019
     C                     TESTB'0'       WAR,WI         66                                   CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 1                                                             CRE019
     C                     TESTB'1'       WAR,WI         66                                   CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 2                                                             CRE019
     C                     TESTB'2'       WAR,WI         66                                   CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 3                                                             CRE019
     C                     TESTB'3'       WAR,WI         66                                   CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 4                                                             CRE019
     C                     TESTB'4'       WAR,WI         66                                   CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 5                                                             CRE019
     C                     TESTB'5'       WAR,WI         66                                   CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 6                                                             CRE019
     C                     TESTB'6'       WAR,WI         66                                   CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 7                                                             CRE019
     C                     TESTB'7'       WAR,WI         66                                   CRE019
     C                     ENDIF                                                              CRE019
     C                     MOVEAWAR       CQPS                                                CRE019
      *                                                                                       CRE019
      ** If *IN66 is on, set work flag for duplicate cheques to 'Y'                           CRE019
      *                                                                                       CRE019
     C           *IN66     IFEQ *ON                                                           CRE019
     C                     MOVEL'USR1231' WERMSG                                              CRE019
     C                     EXSR SRERRM                                                        CRE019
     C                     MOVE 'Y'       WDUP                                                CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
      ** Else (No live record was found)                                                      CRE019
      *                                                                                       CRE019
     C                     ELSE                                                               CRE019
      *                                                                                       CRE019
      ** If record is found but not live                                                      CRE019
      *                                                                                       CRE019
     C           RECID     IFNE 'D'                                                           CRE019
     C           *IN66     ANDEQ*OFF                                                          CRE019
     C                     MOVE 'Y'       WNLIVE                                              CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     MOVEL'USR1233' WERMSG                                              CRE019
     C                     EXSR SRERRM                                                        CRE019
     C                     MOVE *ON       *IN66                                               CRE019
     C                     MOVE 'Y'       WRANGE                                              CRE019
      *                                                                                       CRE019
     C                     ENDIF                                                              CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
      ** Save screen values to determine if changes has been made                             CRE019
      *                                                                                       CRE019
     C                     MOVE DSDSP3    DSSCRN                                              CRE019
     C                     ENDIF                                                              CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
0805 C   66      S         ADD  1         S
0806 C   66                MOVE '028'     ERCD,S
0807 C**
0808 C**  NARRATIVE - OPTIONAL - MUST BE BLANK IF CHEQUE NO. ENTERED
0809 C**
0810 C**
     C**             +++++++++++++++++++++++++++++++++++++                S01117
     C**             ++   VALIDATE   CREDIT   DETAILS   ++                S01117
     C**             +++++++++++++++++++++++++++++++++++++                S01117
     C**                                                                  S01117
0811 C**  CREDIT CUSTOMER - MANDATORY IF CREDIT RETAIL NOT ENTERED
     C                     MOVE ' '       ATYP                            S01111
     C           CBRC      IFEQ *BLANKS                                   LN0085
     C                     MOVE '   '     CRBRCD                          S01117
     C                     END                                            LN0085
0812 C***29*33***                                                         S01117
0813 C*RN29N33***          SETON                     68                   S01117
0814 C***68******S         ADD  1         S                               S01117
0815 C***68****************MOVE*'091'*****ERCD,S**************************E17935
0815 C***68******          MOVE '090'     ERCD,S                    E17935S01117
     C   29 33                                                            S01117
     CORN29N33             DO                                             S01117
     C                     SETON                     68                   S01117
     C           S         ADD  1         S                               S01117
     C                     MOVE '090'     ERCD,S                          S01117
     C                     END                                            S01117
     C**                                                                  S01111
     C****CHECK*FOR*NOSTRO*NUMBER*IF*NOT*IN*ERROR****************** S01111E17935
     C**  CHECK IF 2-DIGIT NOSTRO NUMBER USED IN PLACE OF 6-DIGIT CR A/C  E17935
     C**    NUMBER - USE NOSTRO + CURRENCY TO FIND ACCOUNT DETAILS.       E17935
     C**                                                                  E17935
     C                     Z-ADDS         M       20       SAV ERROR INDEXS01111
     C  N29      CHKCCM    IFEQ '    '                     NOSTRO ENTERED S01111
     C           CACNA     ANDNE'?     '                                  LN0085
     C  N33                                                ** IF ** 1     S01111
     CORN30                                                               S01111
     CORN31                                                               S01111
     CORN32                DO                              ** DO ** 2     S01111
     C           S         ADD  1         S                               S01111
     C                     MOVE '906'     ERCD,S                          S01111
     C  N30                                                               S01111
     CORN31                                                               S01111
     CORN32                SETON                     68                   S01111
     C  N33                SETON                     69                   S01111
     C                     END                             ** ENDDO ** 2  S01111
     C   33                                                               S01111
     CAN 30 31 32          DO                              ** DO ** 2     S01111
     C***********          MOVELCACN      NOKY3                     S01111S01194
     C***********          MOVE CRCY      NOKY2                     S01111S01194
     C**********           MOVELCACN      @KEYE                     S01111S01194
     C                     MOVELCACNA     @KEYE                     S01111S01194
     C                     MOVE CRCY      @KEYB                     S01111S01194
     C***********          MOVE ' '       RECIN                     S01111S01194
     C***********NOTKEY    CHAINTABLE                99             S01111S01194
     C                     MOVE *BLANKS   @KEYA                           059665
     C                     MOVE *BLANKS   @KEYC                           059665
     C                     MOVE *BLANKS   @KEYD                           059665
     C                     MOVE *BLANKS   @KEYF                           059665
     C                     MOVE *BLANKS   @KEYG                           059665
     C                     MOVE *BLANKS   @KEYH                           059665
     C                     CALL 'AONOSTR0'PLIST1                          S01194
     C************IN99     IFEQ '0'                        **IF**3  S01111S01194
     C***********RECIN     ANDEQ'D'                                 S01111S01194
     C           @RTCD     IFEQ *BLANKS                    ** IF 3 **     S01194
     C                     MOVELA7NONB    CACNA                           S01194
     C***********          MOVE CNUM      XCUS                      S01111S01194
     C***********          MOVE CCY       XCCY                      S01111S01194
     C***********          MOVE ACOD      XCOD                      S01111S01194
     C***********          MOVE ACSQ      XSEQ                      S01111S01194
     C                     MOVE A7CUST    XCUS                            S01194
     C                     MOVE A7CYCD    XCCY                            S01194
     C                     MOVE A7ACCD    XCOD                            S01194
     C                     MOVE A7ACSN    XSEQ                            S01194
     C                     MOVE A7BRCD    XBRC                            S01194
     C                     EXSR ACNCHN                                    S01111
     C**                                                                  E17935
     C**   CHECK CREDIT ACCOUNT FOR BLOCKED CREDITS.                      E17935
     C                     TESTB'3'       RETB           09               E17935
     C           *IN09     IFEQ '1'                                       E17935
     C           S         ADD  1         S                               E17935
     C                     MOVE '087'     ERCD,S                          E17935
     C                     SETON                     68                   E17935
     C                     SETOF                     09                   E17935
     C                     END                                            E17935
     C**                                                                  E17935
     C           *IN15     IFEQ '1'                        ** IF ** 4     S01111
     C**********           Z-ADDXCUS      CACN           29         S01111LN0085
     C**********           MOVE XCUS      CACNA                     S01111LN0085
     C                     MOVE XCUS      CACNA          29               LN0085
     C                     MOVE XCCY      CCCY           30               S01111
     C**********           MOVE XCOD      CACD           31         S01111LN0085
     C**********           MOVE XCOD      CACDA                     S01111LN0085
     C                     MOVE XCOD      CACDA          31               LN0085
     C                     MOVE XSEQ      CASQ           32               S01111
     C                     MOVE XBRC      CBRC                            S01117
     C           ATYP      IFEQ 'R'                        ** IF ** 5     S01111
     C***********RACN      ANDEQ'Y'                                 S01111S01194
     C           BMRANR    ANDEQ'Y'                                       S01194
     C**********           Z-ADD0         CACN           29         S01111LN0085
     C**********           MOVE '      '  CACNA                     S01111LN0085
     C                     MOVE '      '  CACNA          29               LN0085
     C                     Z-ADDRETNO     CRAC           33               S01111
     C                     MOVE RETNO     CRACA                           S01111
     C                     MOVE '   '     CCCY           30               S01111
     C**********           Z-ADD0         CACD           31         S01111LN0085
     C**********           MOVE '    '    CACDA                     S01111LN0085
     C**********           MOVE '    '    CACDA          31                            LN0085 CGL029
     C                     MOVE *BLANKS   CACDA          31                                   CGL029
     C                     MOVE '  '      CASQ           32               S01111
     C                     END                             ** ENDIF ** 5  S01111
     C                     ELSE                            ** ELSE ** 4   S01111
     C           S         ADD  1         S                               S01111
     C                     MOVE '910'     ERCD,S                          S01111
     C                     SETON                     6872                 S01111
     C                     END                             ** ENDIF ** 4  S01111
     C                     ELSE                            ** ELSE ** 3   S01111
     C           S         ADD  1         S                               S01111
     C                     MOVE '908'     ERCD,S                          S01111
     C                     SETON                     6872                 S01111
     C                     END                             ** ENDIF ** 3  S01111
     C                     END                             ** ENDDO ** 2  S01111
     C                     END                             ** ENDIF ** 1  S01111
     C**                                                                  LN0085
     C**  NEW STANDING DATA FIELDS VALIDATION                             LN0085
     C**                                                                  LN0085
     C*                                                                   LN0085
     C           *IN33     IFEQ '1'                                       LN0085
     C*                                                                   LN0085
     C                     MOVELCACNA     CLIKEY                          LN0085
     C                     CALL 'AOCUSTR0'PLIST8                          LN0085
     C           @RTCD     IFNE *BLANKS                                   LN0085
     C                     SETON                     68                   LN0085
     C                     ELSE                                           LN0085
     C                     MOVE BBCUST    CACNA                           LN0085
     C                     SETOF                     29                   LN0085
     C                     END                                            LN0085
     C*                                                                   LN0085
     C                     MOVE CACDA     ACOKEY                          LN0085
     C                     CALL 'AOACODR0'PLIST5                          LN0085
     C           @RTCD     IFNE *BLANKS                                   LN0085
     C                     SETON                     68                   LN0085
     C                     ELSE                                           LN0085
     C                     MOVE A5ACCD    CACDA                           LN0085
     C                     SETOF                     31                   LN0085
     C                     END                                            LN0085
     C*                                                                   LN0085
     C                     END                                            LN0085
     C*                                                                   LN0085
     C           S         IFEQ M                          ** IF ** 1     S01111
0816 C**
0817 C** CREDIT CCY CODE - MANDATORY IF CREDIT CUST. ENTERED
0818 C  N29 30
0819 COR 29N30             SETON                     68
0820 C  N29 30
0821 COR 29N30   S         ADD  1         S
0822 C  N29 30
0823 C**OR*29N30*************MOVE*'111'*****ERCD,S************************E17935
0823 COR 29N30             MOVE '110'     ERCD,S                          E17935
0824 C**
0825 C**  CHECK FOR ANY CCY EQUAL TO BASE CCY
0826 C**N48******CCCY      COMP BCCY                     48               S01194
0826 C  N48      CCCY      COMP BJCYCD                   48               S01194
0827 C** CREDIT ACCOUNT CODE - MANDATORY IF CREDIT CUST. ENTERED
0828 C  N29 31
0829 COR 29N31             SETON                     68
0830 C  N29 31
0831 COR 29N31   S         ADD  1         S
0832 C  N29 31
0833 C**OR*29N31*************MOVE '092'*****ERCD,S************************E17935
0833 COR 29N31             MOVE '111'     ERCD,S                          E17935
0834 C**
0835 C**  CREDIT A/C SEQ.NO. - MUST NOT BE ENTERED IF CREDIT CUST. NOT
0836 C**  ENTERED - OPTIONAL - DEFAULT IS '01'
0837 C   29N32             SETON                     68
0838 C   29N32   S         ADD  1         S
0839 C***29N32*************MOVE*'093'*****ERCD,S**************************E17935
0839 C   29N32             MOVE '112'     ERCD,S                          E17935
0840 C**
0841 C  N29 32             MOVE 01        CASQ             DEFAULT IS '01'
0842 C**
0843 C****CHECK*FOR*EXISTENCE*OF OPEN ACCOUNT ON ACCOUNTS MASTER          LN0085
0744 C***29*****                                                          LN0085
0845 C*OR*68****            GOTO CRETVL                                   LN0085
0753 C**
     C**  CREDIT BRANCH CODE VALIDATION :::  ACTION CODE IS I             S01117
     C*   IF MBIN = N OR CR BRANCH FIELD BLANK, SET TO USER DEFAULT       S01117
     C*   OTHERWISE, VALIDATE BRANCH ENTERED                              S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'N'                        *B1            S01117
     C           CBRC      OREQ '   '                                     S01117
     C                     MOVE USRBCH    CBRC                            S01117
     C                     MOVE USRBCH    CRBRCD                          S01117
     C*                                                                   S01117
     C                     ELSE                            *X1            S01117
     C           *IN33     IFEQ '1'                                       LN0085
     C                     MOVE CBRC      BRCDX   3                       S01117
     C                     EXSR BRCVAL                                    S01117
     C                     MOVE BRCDX     CBRC                            LN0085
     C                     MOVE CBRC      CRBRCD  3                       S01117
     C                     END                                            LN0085
     C**                                                                  S01117
     C           *IN99     IFEQ '1'                        *B2            S01117
     C           S         ADD  1         S                               S01117
     C                     MOVE '032'     ERCD,S                          S01117
     C                     SETON                     68                   S01117
     C                     END                             *E2            S01117
     C                     END                             *E1            S01117
     C**                                                                  S01117
0843 C**  CHECK FOR EXISTENCE OF OPEN ACCOUNT ON ACCOUNTS MASTER          LN0085
0845 C  N33                GOTO CRETVL                                    LN0085
0753 C**                                                                  LN0085
0846 C**********           MOVE CACN      XCUS                            LN0085
0846 C                     MOVE CACNA     XCUS                            LN0085
0847 C                     MOVE CCCY      XCCY
0848 C**********           MOVE CACD      XCOD                            LN0085
0848 C                     MOVE CACDA     XCOD                            LN0085
0849 C                     MOVE CASQ      XSEQ
     C                     MOVE CRBRCD    XBRC                            S01117
0850 C                     EXSR ACNCHN
     C**                                                                  E17935
     C**  CHECK CREDIT ACCOUNT FOR BLOCKED CREDITS.                       E17935
     C                     TESTB'3'       RETB           09               E17935
     C           *IN09     IFEQ '1'                                       E17935
     C           S         ADD  1         S                               E17935
     C                     MOVE '087'     ERCD,S                          E17935
     C                     SETON                     68                   E17935
     C                     SETOF                     09                   E17935
     C                     END                                            E17935
     C**                                                                  E17935
0851 C**********           MOVE CACN      CRCNUM  6                       LN0085
0851 C                     MOVE CACNA     CRCNUM  6                       LN0085
0852 C**********           MOVE CACD      CRACOD  4                       LN0085
0852 C**********           MOVE CACDA     CRACOD  4                                    LN0085 CGL029
     C                     MOVE CACDA     CRACOD 10                                           CGL029
0853 C                     MOVE CCCY      CRCCY   3
0854 C                     MOVE CASQ      CRACSQ  2
0859 C**
0860 C**                          - IF SYSTEM SUPPORTS RETAIL NOS.
0861 C**                     A RETAIL NO MUST BE ENTERED FOR A RETAIL A/C
0862 C**
     C********** ATYP      IFEQ 'R'                                       188387
     C***81****33          SETON                     69                   188387
     C***81****33S         ADD  1         S                               188387
     C***81****33          MOVE '031'     ERCD,S                          188387
     C**********           END                                            188387
     C***
0867 C                     GOTO CCODVL
0868 C**
0869 C           CRETVL    TAG                             * CRETVL TAG
0870 C**
0871 C** CREDIT RETAIL A/C NO. - MANDATORY IF CREDIT CUST. NOT ENTERED
0872 C  N29N33
0873 COR 29 33             SETON                     69
0874 C**  CHECK FOR VALID OPEN ACCOUNT NO. ON ACNUM
0875 C  N69                SETOF                     4716
0876 C  N69N33   CRAC      CHAINACNUM                47
0877 C***47N33N69******                                                   E16125
0878 C*RN16N33N69******                                                   E16125
0879 C*R*16N37N69******                                                   E16125
0880 C*NN33************    SETON                     69                   E16125
0881 C**
     C**  IF ACCOUNT NOT ON FILE CLEAR CUSTOMER NO. FIELDS TO             E16125
     C**  ALLOW ERROR CODE '017' TO BE PRODUCED CORRECTLY.                E16125
     C**                                                                  E16125
     C  N16N37             MOVE *BLANKS   CNUM                            E16125
     C  N16N37             MOVE *BLANKS   CCY                             E16125
     C  N16N37             MOVE *BLANKS   ACOD                            E16125
     C  N16N37             MOVE *BLANKS   ACSQ                            E16125
     C  N16N37             MOVE *BLANKS   ABRCD                           S01117
0882 C   69      S         ADD  1         S
0883 C***69****************MOVE '094'*****ERCD,S**************************E17935
0883 C   69                MOVE '090'     ERCD,S                          E17935
0884 C**
0885 C**  CHAIN TO ACCOUNTS MASTER FOR RRN OF MEMOS
0886 C   69
0887 COR 33                GOTO CCODVL
0888 C                     MOVE CNUM      XCUS
0889 C                     MOVE CCY       XCCY
0890 C                     MOVE ACOD      XCOD
0891 C                     MOVE ACSQ      XSEQ
     C                     MOVE ABRCD     XBRC                            S01117
     C                     SETON                     84                   E16125
0892 C                     EXSR ACNCHN
     C**                                                                  E17935
     C**   CHECK CR RETAIL ACCOUNT FOR BLOCKED CREDITS.                   E17935
     C                     TESTB'3'       RETB           09               E17935
     C           *IN09     IFEQ '1'                                       E17935
     C           S         ADD  1         S                               E17935
     C                     MOVE '088'     ERCD,S                          E17935
     C                     SETON                     69                   E17935
     C                     SETOF                     09                   E17935
     C                     END                                            E17935
     C**                                                                  E17935
0893 C                     MOVE CNUM      CRCNUM
0894 C                     MOVE ACOD      CRACOD
0895 C                     MOVE CCY       CRCCY
0896 C                     MOVE ACSQ      CRACSQ
     C                     MOVE ABRCD     CRBRCD                          S01117
0897 C**N15****************                                               E16125
0898 C*RN36****************SETON                     69                   E16125
     C**N15N36*************SETON*********************69***RECI*NOT**E16125E17935
     C***47N33N69**********SETON*********************69****CHAIN*FAILED***E17935
0899 C***69******S*********ADD**1*********S*******************************E17935
0900 C***69****************MOVE '017'*****ERCD,S**************************E17935
     C  N15N36                                             RECI NOT D , C E17935
0899 COR 47N33N69          DO                              CHAIN FAILED   E17936
     C           S         ADD  1         S                               E17935
0900 C                     MOVE '085'     ERCD,S                          E17935
     C                     SETON                     69                   E17935
     C                     END                                            E17935
     C**                                                                  E16125
     C**  IF ACCOUNT IS CLOSED SET ON BLINK LABEL FOR CR.RETAIL A/C NO.   E16125
     C   36                SETON                     69                   E16125
      *                                                                   123468
      ** Validate currency if credit account is found                     123468
      *                                                                   123468
     C           *IN47     IFEQ '0'                                       123468
     C           CRCY      COMP CCY                  7272                 123468
     C   72                GOTO CCODVL                                    123468
     C                     END                                            123468
0901 C**
0902 C***********CCODVL    TAG                             * CCODVL TAG   123468
0903 C**
0904 C**  CREDIT CURRENCY CODE - MANDATORY IF RETAIL A/C NO. ENTERED
0905 C**  MUST BE SAME AS CCY OF RETAIL A/C NO.
     C*                                                                   LN0085
     C* - AMENDMENT MADE TO PROGRAM SO THAT NOW CREDIT CURRENCY           LN0085
     C*   IS OBTAINED FROM ACNUM IN THE CASE OF RETAIL NO.S               LN0085
     C*                                                                   LN0085
      *                                                                   LN0085
      * IF A/C CODE CURRENCY IS BLANK AND RETAIL NO. IS NOT BLANK         LN0085
      * OBTAIN CURRENCY CODE                                              LN0085
      *                                                                   LN0085
     C                     SETOF                     07                   084152
     C           *IN30     IFEQ '1'                                       LN0085
     C           *IN33     ANDNE'1'                                       LN0085
     C                     MOVE CCY       CKEY                            LN0085
     C                     CALL 'AOCURRR0'PLIST4                          LN0085
     C           @RTCD     IFEQ *BLANKS                                   LN0085
     C                     SETON                     07                   084152
     C*                                                                   134071
     C** Currency field is a mandatory entry                              134071
     C*                                                                   134071
     C***********          MOVE CCY       CRCY                     LN0085 134071
     C                     END                                            LN0085
     C                     END                                            LN0085
     C           CCODVL    TAG                                            123468
      *                                                                   LN0085
0906 C  N29N34   CRCY      COMP CCCY                 7272
     C   72      S         ADD  1         S                               E17935
     C   72                MOVE '121'     ERCD,S                          E17935
0907 C***34*****           SETON                     72                   LN0085
     C***34***** S         ADD  1         S                         E17935LN0085
     C***34*****           MOVE '123'     ERCD,S                    E17935LN0085
0907 C   34                SETON                     72                   S01413
     C   34      S         ADD  1         S                               S01413
     C   34                MOVE '123'     ERCD,S                          S01413
0908 C**
0909 C**N72N33***CRCY      COMP CCY                  7272                 LN0085
     C  N72N33   CRCY      COMP CCY                  7272                 S01413
     C   72N33   S         ADD  1         S                               S01413
     C   72N33             MOVE '121'     ERCD,S                          S01413
0910 C**   MUST NOT EQUAL DR CCY
     C*                                                                   134071
     C** Compare currency field entries only if both are non-blanks       134071
     C/COPY WNCPYSRC,RE0150C030
     C*                                                                   134071
     C           CRCY      IFNE *BLANKS                                   134071
     C           DRCY      ANDNE*BLANKS                                   134071
     C           CRCY      IFEQ DRCY                                      E17935
     C           S         ADD  1         S                               E17935
     C                     MOVE '122'     ERCD,S                          E17935
     C                     END                                            E17935
     C                     ENDIF                                          134071
0911 C  N72      CRCY      COMP DRCY                     72
     C/COPY WNCPYSRC,RE0150C031
0912 C***72******S*********ADD**1*********S*******************************E17935
0913 C***72******          MOVE '111'     ERCD,S                          E16125
0913 C***72****************MOVE*'122'*****ERCD,S********************E16125E17935
     C**                                                                  E17935
     C                     END                             ** ENDIF ** 1  S01111
0914 C**
0915 C**  CHECK FOR ANY CURRENCY EQUAL TO BASE CCY
0916 C**N48******CRCY      COMP BCCY                     48               S01194
0916 C  N48      CRCY      COMP BJCYCD                   48               S01194
0917 C**
     C**
     C*****MOVE*CR BRANCH CODE FOR MULTI-BRANCHING VALIDATION             S01117
     C***********          MOVE ABRCD     CRBRCD  30                      S01117
     C***********                                                         S01117
     C****VALIDATE BRANCH CODES; IF *IN67 IS OFF,  BOTH 'DR' BRCD AND     S01117
     C*******'CR' BRCD MUST BE EQUAL TO BRCDI; ELSE ONLY ONE NEED         S01117
     C*********EQUAL BRCDI.                                               S01117
     C***********          SETOF                     202847               S01117
     C***********DRBRCD    COMP CRBRCD                   47               S01117
     C**
     C****IF*BRCD'S*NOT*EQUAL;*INVALID*IF**IN67*=*'0'**************       E17935
     C***IF*SYSTEM IS NOT MULTIBRANCH,BOTH BRCDS MUST EQUAL SYS BRCDE17935S01117
     C**N67N47***          SETON                     28                   S01117
     C********** *IN28     IFEQ '1'                                 E17935S01117
     C********** S         ADD  1         S                         E17935S01117
     C**********           MOVE '133'     ERCD,S                    E17935S01117
     C**********           END                                      E17935S01117
     C**
     C****IF*BRCD'S NOT EQUAL AND *IN67 = '1' SETON *IN20                 S01117
     C***67N47***          SETON                     20                   S01117
     C*
     C**N28******          DO                                             S01117
     C***********                                                         S01117
     C****IF**IN67 = '1'; AT LEAST ONE BRCD MUST = BRCDI                  S01117
     C*****OR*IF**IN67 = '0'; BOTH BRCD'S MUST = BRCDI                    S01117
     C***********DRBRCD    COMP BRCDI                    47               S01117
     C***67N47***CRBRCD    COMP BRCDI                    47               S01117
     C***********                                                         S01117
     C**N47******          SETON                     28                   S01117
     C***********          END                                            S01117
     C**
     C**  INVALID INPUT FOUND
     C***28****************DO*********************************************E17935
     C************IN67     IFEQ '1'                        1        E17935S01117
     C************IN28     ANDEQ'1'                        *        E17935S01117
     C***********S         ADD  1         S                               S01117
     C***********          MOVE '132'     ERCD,S           *        E17935S01117
     C***67                MOVE '032'     ERCD,S                          S01111
     C***67****************MOVE '132'*****ERCD,S********************S01111E17935
     C**N67****************MOVE*'105'*****ERCD,S**************************E17935
     C**N61****************SETON*********************61*******************E16935
     C***********          END                             1        E17935S01117
     C***28******          SETON                     61                   S01117
     C**
     C**  MULTIBRANCHING CHANGES :::                                      S01117
     C**       TRANSACTION BRANCH MUST EQUAL EITHER ONE OF DEBIT OR       S01117
     C**       CREDIT BRANCH                                              S01117
     C**      (DEBIT AND CREDIT BRANCH CODES OBTAINED FROM USER DEFAULT   S01117
     C**       IF MBIN IS 'N', HENCE VALIDATION NOT REQUIRED.)            S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           TRBRCD    IFNE DRBRCD                                    S01117
     C           TRBRCD    ANDNECRBRCD                                    S01117
     C           S         ADD  1         S                               S01117
     C                     MOVE '132'     ERCD,S                          S01117
     C                     SETON                     20                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**
     C** SET UP MULTI-BRANCHING CROSS BRANCH INDICATOR
     C                     MOVE 'N'       MBEI    1
     C***67*20N28          MOVE 'Y'       MBEI                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           DRBRCD    ANDNECRBRCD                                    S01117
     C                     MOVE 'Y'       MBEI                            S01117
     C                     END                                            S01117
0920 C**
0921 C** CHECK IF CREDIT A/C IS A RETAIL A/C
0922 C******     ATYP      COMP 'R'                      33               S01111
0923 C***33*               Z-ADDRRNM      CMRRN   50                      S01111
     C                     MOVE '0'       CRRET   1                       S01111
0768 C           ATYP      IFEQ 'R'                                       S01111
0769 C***********          Z-ADDRRNM      CMRRN   50                S01111CCB002
     C                     MOVE '1'       CRRET                           S01111
     C                     END                                            S01111
1186 C           ATYP      IFEQ 'N'                                       E41812
1187 C                     MOVE '2'       CRRET                           E41812
     C                     END                                            E41812
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CVS2                                           S01408
     C*                                                                   S01408
     C**                                                                  S01111
     C**                                                                  S01111
     C**  VALIDATE CREDIT VALUE DATE FIELD CRVALD                         S01111
     C**  ---------------------------------------                         S01111
     C**                                                                  S01111
     C                     Z-ADD0         VALUDT                          S01111
     C/COPY WNCPYSRC,RE0150C026
     C*                                                                   S01111
     C*      ENTRY NOT ACCEPTED - NON-RETAIL                              S01111
     C           CRVALD    IFNE '      '                   1              S01111
     C           ATYP      ANDNE'R'                        *              S01111
     C                     SETON                     83    *              S01111
     C                     END                             1              S01111
     C/COPY WNCPYSRC,RE0150C027
     C*                                                                   S01111
     C**     DEFAULT TO RUN DATE -                                        S01111
     C           CRVALD    IFEQ '      '                   1              S01111
     C*         FOR FILE                                   *              S01111
     C                     Z-ADDRUND      VALUDT           *              S01111
     C*         FOR SCREEN RE-OUTPUT IF NECESSARY          *              S01111
     C           ATYP      IFEQ 'R'                        * 2            S01111
     C/COPY WNCPYSRC,RE0150C028
     C                     Z-ADDRUND      ZDAYNO           * *            S01111
     C                     EXSR ZDATE2                     * *            S01111
     C                     MOVE ZDATE     CRVALD           * *            S01111
     C                     END                             * 2            S01111
     C                     END                             1              S01111
     C*                                                                   S01111
     C**     FIELD NOT BLANK - NUMERIC CHECK                              S01111
     C           ATYP      IFEQ 'R'                        1              S01111
     C/COPY WNCPYSRC,RE0150C029
     C           CRVALD    ANDNE'      '                   *              S01111
     C                     MOVE CRVALD    NUMIC7           *              S01111
     C                     MOVE NUMIC7    CRVALA  6        *              S01111
     C*                                                    *              S01111
     C**        INPUT NUMERIC                              *              S01111
     C           CRVALD    IFEQ CRVALA                     * 2            S01111
     C                     MOVE CRVALD    ZDATE            * *            S01111
     C                     EXSR ZDATE1                     * *            S01111
      *                                                                                      BUG7274
     C           CRVALD    IFNE CRVALP                                                       BUG7274
     C                     MOVE 'N'       WARN0                                              BUG7274
     C                     ENDIF                                                             BUG7274
     C                     MOVE CRVALD    CRVALP  6                                          BUG7274
      *                                                                                      BUG7274
     C*                                                    * *            S01111
     C**           INPUT SUCCESSFULLY CONVERTED TO DAY NO. * *            S01111
     C           ZDAYNO    IFGT 0                          * * 3          S01111
     C*                                                    * * *          S01111
     C                     EXSR VALDAT                     * * *          S01111
     C*                    -----------                     * * *          S01111
     C                     END                             * * 3          S01111
     C*                                                    * *            S01111
     C                     END                             * 2            S01111
     C*                                                    *              S01111
     C                     END                             1              S01111
     C*                                                                   S01111
     C**     ACCEPTABLE VALUE DATE OBTAINED                               S01111
     C           VALUDT    IFGT 0                          1              S01111
     C                     Z-ADDVALUDT    CRVD             *              S01111
     C                     END                             1              S01111
     C*                                                                   S01111
     C**     CHECK VALUE DATE IS WITHIN MAXIMUM DAYS FORWARD              E16127
     C                     MOVE *ZERO     MFWDD   50                      E16127
     C***********RUND      ADD  MFWD      MFWDD                     E16127S01194
     C           RUND      ADD  BMNDFV    MFWDD                           S01194
     C           VALUDT    IFGT MFWDD                      1              E16127
     C                     SETON                     83    *              E16127
     C                     END                             1              E16127
     C*      ENTRY NOT ACCEPTED - INVALID                                 S01111
     C*                                                                   S01111
     C           VALUDT    IFEQ 0                          1              S01111
     C           ATYP      ANDEQ'R'                        *              S01111
     C                     SETON                     83    *              S01111
     C                     END                             1              S01111
     C*                                                                   S01111
     C*      ERROR                                                        S01111
     C*                                                                   S01111
     C           *IN83     IFEQ '1'                        1              S01111
     C           S         ADD  1         S                *              S01111
     C*********************MOVE '115'*****ERCD,S********************S01111E17935
     C                     MOVE '114'     ERCD,S           *              E17935
     C                     END                             1              S01111
      *                                                                                      BUG7274
     C           WVDHOL    IFEQ 'Y'                                                          BUG7274
     C                     SETON                     83                                      BUG7274
     C                     ENDIF                                                             BUG7274
     C**                                                                  S01111
     C**                                                                  S01111
0924 C**  CREDIT AMOUNT - MANDATORY - VALIDATE WITH ZALIGN
0925 C***********          MOVE CCCY      TBKY2            * DEC.PLACES   S01194
0926 C***30******          MOVE CRCY      TBKY2            * FOR CURRENCY S01194
0925 C                     MOVE CCCY      CKEY             * DEC.PLACES   S01194
     C                     Z-ADDS         M                               S01111
0927 C***********          EXSR TABCHN                                    S01194
     C           *IN33     IFEQ '1'                                       LN0085
     C                     SETOF                     07                   084152
     C                     CALL 'AOCURRR0'PLIST4                          S01194
     C           @RTCD     IFEQ *BLANKS                                   S01194
     C                     SETON                     07                   S01194
     C                     MOVE A6CYCD    CCCY                            S01194
     C*                                                                   134071
     C** Currency field is a mandatory entry                              134071
     C*                                                                   134071
     C***********CRCY      IFEQ *BLANKS                            LN0085 134071
     C***********          MOVE A6CYCD    CRCY                     LN0085 134071
     C***********          END                                     LN0085 134071
     C                     END                                            LN0085
     C*                                                                   134071
     C** Compare CR/DR currency fields inputs if both are non-blanks.     134071
     C/COPY WNCPYSRC,RE0150C032
     C*                                                                   134071
     C           CRCY      IFNE *BLANKS                                   134071
     C           DRCY      ANDNE*BLANKS                                   134071
     C           CRCY      IFEQ DRCY                                      LN0085
     C           S         ADD  1         S                               LN0085
     C                     MOVE '122'     ERCD,S                          LN0085
     C                     SETON                         72               LN0085
     C                     END                                            LN0085
     C                     ENDIF                                          134071
     C/COPY WNCPYSRC,RE0150C033
     C********** *IN30     IFEQ '1'                                 S01194LN0085
     C**********           MOVE A6CYCD    CRCY                      S01194LN0085
     C**********           END                                      S01194LN0085
     C                     END                                            S01194
1479 C**  CHECK FOR DEALING CCY                                           S01194
1480 C           A6DLCI    COMP 'N'                      47               S01194
1481 C      47   S         ADD  1         S                               S01194
     C           S         IFNE M                                         S01111
     C                     MOVE '131'     ERCD,S                          S01111
     C                     END                                            S01111
0928 C**  SET ERROR IND. FOR NON DEALING CCY
0929 C   47 34             SETON                     68
0930 C   47 30             SETON                     72
0931 C**
0932 C***********          Z-ADDCDP       CCDP    10       C/R AMOUNT DEC.S01194
0933 C***********          Z-ADDSPOT      CSPOT  138                      S01194
0934 C***********          Z-ADDMDIN      CMDIN   10                      S01194
0932 C                     Z-ADDA6NBDP    CCDP    10       C/R AMOUNT DEC.S01194
     C                     Z-ADDA6NQDP    CNQDP   10                      CAC001
0933 C                     Z-ADDA6SPRT    CSPOT  138                      S01194
0934 C                     MOVE A6MDIN    CMDIN   1                       S01194
0935 C   07                Z-ADD1         HOLD2   10
0936 C  N07                Z-ADD0         HOLD2
0937 C**
0938 C***********          Z-ADDCDP       ZADEC                           S01194
0938 C                     Z-ADDA6NBDP    ZADEC                           S01194
0939 C           13        SUB  ZADEC     ZADIG
0940 C                     MOVE BLNK16    ZFIELD
0941 C                     MOVELCRAM      ZFIELD
0942 C                     EXSR ZALIGN
0943 C  N99                MOVE ZFIELD    CRAMN0 130
0944 C   99                SETON                     73
0945 C   99      S         ADD  1         S
0946 C   99                MOVE '113'     ERCD,S
0947 C**
0958 C********************************************************************
     C**                                                                  S01117
     C**   PROFIT CENTRE VALIDATION :::                                   S01117
     C**                                                                  S01117
     C**   VALIDATE PROFIT CENTRE IF PROFIT CENTRE IS USED                S01117
     C           PFCU      IFEQ 'Y'                                       S01117
      *                                                                   176510
      * If Customer Number entered is valid and Retail Number is          176510
      * Blank                                                             176510
     C           *IN62     IFNE '1'                                       176510
     C           *IN25     ANDEQ'1'                                       176510
     C                     EXSR PRFCVL                                    S01117
     C                     ENDIF                                          176510
      *                                                                   176510
      * If Retail Number entered is valid and if Customer Number is       176510
      * Blank                                                             176510
     C           *IN63     IFNE '1'                                       176510
     C           *IN21     ANDEQ'1'                                       176510
     C                     EXSR PRFCVL                                    176510
     C                     ENDIF                                          176510
     C*                                                                   S01117
     C           *INU7     IFEQ '1'                                       S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           *IN99     IFEQ '1'                                       S01117
     C           S         ADD  1         S                               S01117
     C                     MOVE '306'     ERCD,S                          S01117
     C                     SETON                     28                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
0959 C**   BASE CCY EQUIV IS MANDATORY UNLESS ONE CCY IS BASE CCY
0960 C**   IN WHICH CASE THE FIELD MUST BE BLANK (AS IN DL0030)
     C/COPY WNCPYSRC,RE0150C012
0961 C   48 35             GOTO SAR01
0962 C  N48N35             GOTO SAR02
0963 C                     SETON                     74
0964 C           S         ADD  1         S
0965 C                     MOVE '118'     ERCD,S
0966 C                     GOTO OVRINV
0967 C**
0968 C           SAR01     TAG                             ** SAR01 TAG **
0969 C**   BASE CCY EQUIV DEFAULTS TO BASE CCY VALUE
0970 C***********DRCY      COMP BCCY                     48               S01194
0971 C**N48******DCCY      COMP BCCY                     48               S01194
0970 C           DRCY      COMP BJCYCD                   48               S01194
0971 C  N48      DCCY      COMP BJCYCD                   48               S01194
0972 C   48                Z-ADDDRAMN0    BCEQ0
0973 C  N48                Z-ADDCRAMN0    BCEQ0
0974 C  N48                SETON                     48
0975 C                     GOTO OVRINV
0976 C**
0977 C           SAR02     TAG                             ** SAR02 TAG **
0978 C********************************************************************
0979 C**
0980 C                     Z-ADDBCDP      ZADEC
0981 C           13        SUB  ZADEC     ZADIG
0982 C                     MOVE BLNK16    ZFIELD
0983 C                     MOVELBCEQ      ZFIELD
0984 C                     EXSR ZALIGN
0985 C   99      ZFIELD    COMP ZERO16                   35ALLOW ZERO NO.
0986 C   99 35             SETOF                     99
0987 C  N99                MOVE ZFIELD    BCEQ0  130
0988 C**
0989 C   99                SETON                     74    99 -ERROR IND.
0990 C   99      S         ADD  1         S                FROM ZALIGN
0991 C   99                MOVE '118'     ERCD,S
0992 C**
0993 C           OVRINV    TAG                             * OVRINV TAG
0994 C**
0995 C**  OVERRIDE INDICATOR - OPTIONAL -'Y'OR'N'- DEFAULT -'N'
0996 C   38                MOVE 'N'       OIND             DEFAULT - N
0997 C*
0998 C***********          SETOF                     49                   CAC001
     C                     MOVE '0'       OINDN   1                       CAC001
0999 C           OIND      COMP 'Y'                  4747
1000 C***47******OIND      COMP 'N'                  474749               CAC001
1000 C   47      OIND      COMP 'N'                  4747                 CAC001
     C           OIND      IFEQ 'N'                                       CAC001
     C                     MOVE '1'       OINDN                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CCP6                                           S01408
     C*                                                                   S01408
1001 C   47      S         ADD  1         S
1002 C   47                SETON                     75
1003 C   47                MOVE '117'     ERCD,S
1004 C**
1005 C**  EXCHANGE RATE - MANDATORY - VALID FIELD FROM ZALIGN
1006 C                     MOVE BLNK16    ZFIELD
1007 C                     MOVELEXRT      ZFIELD
1008 C                     Z-ADD8         ZADEC
1009 C                     Z-ADD5         ZADIG
1010 C                     EXSR ZALIGN
1011 C                     MOVE ZFIELD    EXRTN  138
1012 C**
1013 C   99                SETON                     76    ERROR FROM
1014 C   99      S         ADD  1         S                ZALIGN
1015 C   99                MOVE '116'     ERCD,S
     C/COPY WNCPYSRC,RE0150C039
1016 C**
     C*                                                                   S01111
     C** SECTION TO VALIDATE CHARGES DETAILS                              S01111
     C*                                                                   S01111
     C** IF AMOUNT FIELD IS BLANK THEN ALL OTHER CHARGES FIELDS MUST BE   S01111
     C** BLANK                                                            S01111
     C           CHAMT     IFEQ *BLANKS                    ** S-001 **    S01111
     C*                                                                   S01111
     C** CUSTOMER NUMBER                                                  S01111
     C           CHCUS     IFNE *BLANKS                    ** S-002 **    S01111
     C                     SETON                     10                   S01111
     C                     ADD  1         S                               S01111
     C                     MOVE '900'     ERCD,S                          S01111
     C                     END                             ** E-002 **    S01111
     C*                                                                   S01111
     C** ACCOUNT CODE                                                     S01111
     C           CHACD     IFNE *BLANKS                    ** S-002 **    S01111
     C                     SETON                     10                   S01111
     C                     ADD  1         S                               S01111
     C                     MOVE '901'     ERCD,S                          S01111
     C                     END                             ** E-002 **    S01111
     C*                                                                   S01111
     C** ACCOUNT SEQUENCE NUMBER                                          S01111
     C           CHASQ     IFNE *BLANKS                    ** S-002 **    S01111
     C                     SETON                     10                   S01111
     C                     ADD  1         S                               S01111
     C                     MOVE '902'     ERCD,S                          S01111
     C                     END                             ** E-002 **    S01111
     C*                                                                   S01111
     C** CHARGES SIGN                                                     S01111
     C           CHSGN     IFNE *BLANKS                    ** S-002 **    S01111
     C                     SETON                     11                   S01111
     C                     ADD  1         S                               S01111
     C                     MOVE '903'     ERCD,S                          S01111
     C                     END                             ** E-002 **    S01111
     C*                                                                   S01111
     C** IF CHARGES AMOUNT HAS BEEN ENTERED THEN FIELDS REQUIRE FURTHER   S01111
     C** VALIDATION                                                       S01111
     C                     ELSE                            ** X-001 **    S01111
     C*                                                                   S01111
     C** VALIDATE CHARGES CUSTOMER NUMBER IF ENTERED                      S01111
     C** CHECK IF ON CUSTOMER MASTER FILE                                 S01111
     C           CHCUS     IFNE *BLANKS                    ** S-002 **    S01111
     C                     MOVEL*BLANK    CLIKEY                                              205232
     C                     MOVELCHCUS     CLIKEY                          S01111
     C***********CLIKEY    CHAINCLINT                10             S01111S01194
     C                     CALL 'AOCUSTR0'PLIST8                          S01194
     C**N10******RECIC     COMP 'D'                  1010           S01111S01194
     C************IN10     IFEQ '1'                        **S-003**S01111S01194
     C           @RTCD     IFNE *BLANKS                    ** S-003 **    S01194
     C                     ADD  1         S                               S01111
     C                     MOVE '900'     ERCD,S                          S01111
     C                     ELSE                            ** X-003 **    S01111
     C                     MOVELBBCUST    CHCUS                           S01194
     C*                                                                   S01111
     C** IF NO ERROR MOVE INPUT FIELD TO OUTPUT FIELD                     S01111
     C                     MOVE CHCUS     CHCUSO  6                       S01111
     C                     END                             ** E-003 **    S01111
     C*                                                                   S01111
     C                     END                             ** E-002 **    S01111
     C*                                                                   S01111
     C** CHECK ACCOUNT CODE ON FILE                                       S01111
     C***********ACODKY    CHAINTABLE                50             S01111S01194
     C                     MOVE CHACD     ACOKEY                          S01194
     C                     CALL 'AOACODR0'PLIST5                          S01194
     C************IN50     IFEQ '1'                        **S-002**S01111S01194
     C           @RTCD     IFNE *BLANKS                    ** S-002 **    S01194
     C                     SETON                     10                   S01111
     C                     ADD  1         S                               S01111
     C                     MOVE '901'     ERCD,S                          S01111
     C                     ELSE                                           S01194
     C                     MOVELA5ACCD    CHACD                           S01194
     C                     END                             ** E-002 **    S01111
     C**********           MOVE CHACD     CHACDO  4                                    S01111 CGL029
     C                     MOVE CHACD     CHACDO                                              CGL029
     C*                                                                   S01111
     C** VALIDATE ACCOUNT SEQUENCE NUMBER                                 S01111
     C           CHASQ     IFNE *BLANKS                    ** S-002 **    S01111
     C                     MOVELCHASQ     TEST1   30                      S01111
     C                     MOVELTEST1     TEST2   2                       S01111
     C           TEST2     IFNE CHASQ                      ** S-003 **    S01111
     C                     SETON                     10                   S01111
     C                     ADD  1         S                               S01111
     C                     MOVE '902'     ERCD,S                          S01111
     C                     ELSE                            ** X-003 **    S01111
     C                     MOVE CHASQ     CHASQO  2                       S01111
     C                     END                             ** E-003 **    S01111
     C*                                                                   S01111
     C** IF CHARGES ACCOUNT SEQUENCE NUMBER IS BLANK THEN DEFAULT TO '01' S01111
     C                     ELSE                            ** X-002 **    S01111
     C                     MOVE '01'      CHASQO                          S01111
     C                     MOVE CHASQO    CHASQ                           S01111
     C                     END                             ** E-002 **    S01111
     C*                                                                   S01111
     C** VALIDATE CHARGES SIGN; MUST BE + OR -                            S01111
     C           CHSGN     IFNE '+'                        ** S-002 **    S01111
     C           CHSGN     ANDNE'-'                                       S01111
     C                     SETON                     11                   S01111
     C                     ADD  1         S                               S01111
     C                     MOVE '903'     ERCD,S                          S01111
     C                     END                             ** E-002 **    S01111
     C  N11                MOVE CHSGN     CHSGNO                          S01111
     C*                                                                   S01111
     C** IF SIGN IS OK VALIDATE CHARGES AMOUNT                            S01111
     C           *IN11     IFEQ '0'                        ** S-002 **    S01111
     C                     MOVE *BLANKS   ZFIELD                          S01111
     C                     MOVE CHAMT     ZFIELD                          S01111
     C           CHSGN     IFEQ '+'                        ** S-003 **    S01111
     C                     Z-ADDDCDP      ZADEC                           S01111
     C                     ELSE                            ** X-003 **    S01111
     C                     Z-ADDCCDP      ZADEC                           S01111
     C                     END                             ** E-003 **    S01111
     C*                                                                   S01111
     C           13        SUB  ZADEC     ZADIG                           S01111
     C                     EXSR ZALIGN                                    S01111
     C                     MOVE ZFIELD    CHAMTO 130                      S01111
     C   99                SETON                     12                   S01111
     C           *IN12     IFEQ '1'                        ** S-003 **    S01111
     C                     ADD  1         S                               S01111
     C                     MOVE '904'     ERCD,S                          S01111
     C                     END                             ** E-003 **    S01111
     C                     END                             ** E-002 **    S01111
     C*                                                                   S01111
     C** OBTAIN BRANCH INTERNAL CUSTOMER NUMBER IF CHARGES CUSTOMER       S01111
     C** NUMBER HAS NOT BEEN ENTERED                                      S01111
     C           *IN10     IFEQ '0'                        ** S-002 **    S01111
     C           *IN11     ANDEQ'0'                                       S01111
     C           CHCUS     ANDEQ*BLANKS                                   S01111
     C*                                                                   S01111
     C** USE SIGN OF CHARGE TO DETERMINE WHETHER TO USE DEBIT OR CREDIT   S01111
     C** BRANCH INTERNAL CUSTOMER NUMBER                                  S01111
     C***********          MOVE *BLANKS   KEYT   12                 S01111S01194
     C***********          MOVEL'10'      KEYT                      S01111S01194
     C           CHSGN     IFEQ '+'                        ** S-003 **    S01111
     C***********          MOVE DRBRCD    KEYT                      S01111S01194
     C                     MOVE DRBRCD    BRKEY                           S01194
     C                     ELSE                            ** X-003 **    S01111
     C***********          MOVE CRBRCD    KEYT                      S01111S01194
     C                     MOVE CRBRCD    BRKEY                           S01194
     C                     END                             ** E-003 **    S01111
     C***********KEYT      CHAINTABLE                99             S01111S01194
     C**********           CALL 'AOBRCHR0'PLIST6                          S01194              CGL029
     C                     CALL 'AOBRCHR1'PLIST6                                              CGL029
     C***********          MOVE BICN      CHCUS                     S01111S01194
     C                     MOVE A8BICN    CHCUS                           S01194
     C***********          MOVE BICN      CHCUSO                    S01111S01194
     C                     MOVE A8BICN    CHCUSO                          S01194
     C                     END                             ** E-002 **    S01111
     C*                                                                   S01111
     C** CHECK THAT CHARGES ACCOUNT IS ON FILE                            S01111
     C           *IN10     IFEQ '0'                        ** S-002 **    S01111
     C           *IN11     ANDEQ'0'                                       S01111
     C                     MOVE CHCUSO    XCUS                            S01111
     C                     MOVE CHACD     XCOD                            S01111
     C           CHSGN     IFEQ '+'                        ** S-003 **    S01111
     C                     MOVE DRCCY     XCCY                            S01111
     C                     MOVE DRBRCD    XBRC                            S01117
     C                     ELSE                            ** X-003 **    S01111
     C                     MOVE CRCCY     XCCY                            S01111
     C                     MOVE CRBRCD    XBRC                            S01117
     C                     END                             ** E-003 **    S01111
     C                     MOVE XCCY      CHCCYO  3                       S01111
     C                     MOVE CHASQO    XSEQ                            BE2138
     C                     SETOF                     15                   S01111
     C           ACNKEY    CHAINACCNT                99                   S01111
     C*                                                                   S01111
     C** ERROR IF OPEN ACCOUNT NOT FOUND                                  S01111
     C           *IN15     IFEQ '0'                        ** S-003 **    S01111
     C                     SETON                     10                   S01111
     C                     ELSE                            ** X-003 **    S01111
     C*                                                                   S01111
     C** CHECK IF ACCOUNT FOR CHARGE IS RETAIL                            S01111
     C           ATYP      IFEQ 'R'                        ** S-004 **    S01111
     C                     Z-ADDRETNO     CHRN   100                      S01111
     C                     ELSE                            ** X-004 **    S01111
     C                     Z-ADD0         CHRN                            S01111
     C                     END                             ** E-004 **    S01111
     C*                                                                   S01111
     C** IF BRANCH CODE IS NOT EQUAL TO BRANCH CODE OF ACCOUNT TO WHICH   S01111
     C** CHARGE IS TO BE MADE THIS IS AN ERROR                            S01111
     C           CHSGN     IFEQ '+'                        ** S-004 **    S01111
     C           ABRCD     COMP DRBRCD               1010                 S01111
     C***********          MOVE DRBRCD    CHBRCD  30                S01111S01117
     C                     MOVE DRBRCD    CHBRCD  3                       S01117
     C                     ELSE                            ** X-004 **    S01111
     C           ABRCD     COMP CRBRCD               1010                 S01111
     C                     MOVE CRBRCD    CHBRCD                          S01111
     C                     END                             ** E-004 **    S01111
     C                     END                             ** E-003 **    S01111
     C*                                                                   S01111
     C           *IN10     IFEQ '1'                        ** S-003 **    S01111
     C                     ADD  1         S                               S01111
     C                     MOVE '905'     ERCD,S                          S01111
     C*                                                                   S01111
     C                     END                             ** E-003 **    S01111
     C*                                                                   S01111
     C                     END                             ** E-002 **    S01111
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CVS3                                           S01408
     C*                                                                   S01408
     C*                                                                   S01111
     C                     END                             ** E-001 **    S01111
     C*                                                                   CAC001
     C**  Perform validation of new Analytical Accounting fields          CAC001
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
     C*                                                                   CAC001
     C**  FX Margin Points entered...                                     CAC001
     C*                                                                   CAC001
     C           SFXMP     IFNE *BLANKS                                   CAC001
     C           IPRFC     ANDNE*BLANKS                                   176510
     C           BGN0ST    ANDEQ'Y'                                       208221
     C           SFXMP     ORNE *BLANKS                                   208221
     C           CDE002    ANDEQ'Y'                                       208221
     C           BGN0ST    IFEQ 'Y'                                       CDE002
     C*                                                                   CAC001
     C                     EXSR PRFCVL                                    CAC001
     C*                                                                   CAC001
     C**  FX Margin Points not allowed if transaction profit centre is    CAC001
     C**  allowed to hold its own FX Position                             CAC001
     C*                                                                   CAC001
     C           DSFPPC    IFEQ *BLANKS                                   CAC001
     C           S         ADD  1         S                               CAC001
     C                     MOVE '201'     ERCD,S                          CAC001
     C                     MOVEL'1'       *IN08                           CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CDE002
     C                     ENDIF                                          CDE002
     C*                                                                   CAC001
     C**  Validate FX Margin Points entered                               CAC001
     C*                                                                   CAC001
     C                     MOVEL*BLANK    ZFIELD                          CAC001
     C                     MOVE SFXMP     ZFIELD                          CAC001
     C                     Z-ADD2         ZADEC                           CAC001
     C                     Z-ADD5         ZADIG                           CAC001
     C                     EXSR ZALIGN                                    CAC001
     C*                                                                   CAC001
     C           *IN99     IFEQ '0'                                       CAC001
     C                     MOVE ZFIELD    WFXMP   72                      CAC001
     C                     ELSE                                           CAC001
     C           S         ADD  1         S                               CAC001
     C                     MOVE '202'     ERCD,S                          CAC001
     C                     MOVEL'1'       *IN08                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C**  If there are no errors, get normally quoted decimal place       CAC001
     C*                                                                   CAC001
     C           *IN08     IFEQ '0'                                       CAC001
     C           WFXMP     ANDNE0                                         CAC001
     C*                                                                   CAC001
     C                     EXSR SRNQDP                                    CAC001
     C*                                                                   CAC001
     C           ZNQDPX    ADD  1         ZA      10                      CAC001
     C           WFXMP     DIV  AP,ZA     WFXMR  138H                     CAC001
     C*                                                                   CAC001
     C                     Z-ADDEXRTN     WMXAM  138                      CAC001
     C                     Z-ADD0         WMNAM  138                      CAC001
     C*                                                                   CAC001
     C**  Compute for the equivalent rate using the FX margin rate        CAC001
     C*                                                                   CAC001
     C           DRAMT     IFGT CRAMT                                     CAC001
     C           EXRTN     ANDGT1                                         CAC001
     C           DRAMT     ORLT CRAMT                                     CAC001
     C           EXRTN     ANDLT1                                         CAC001
     C           EXRTN     SUB  WFXMR     WMGRT  138                      CAC001
     C                     ELSE                                           CAC001
     C           EXRTN     ADD  WFXMR     WMGRT                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C**  Check if the equivalent rate is within defined tolerance        CAC001
     C**  percentage                                                      CAC001
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       208221
     C           WFXMP     IFNE 0                                         CAC001
     C           WMGRT     ANDGTEXRTN                                     CAC001
     C           FTTFRT    DIV  100       WTLRN   74H                     CAC001
     C                     ADD  1         WTLRN                           CAC001
     C           WTLRN     MULT EXRTN     WMXAM                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           WFXMP     IFNE 0                                         CAC001
     C           WMGRT     ANDLTEXRTN                                     CAC001
     C           FTTFRT    DIV  100       WTLRN   74H                     CAC001
     C           1         SUB  WTLRN     WTLRN                           CAC001
     C           WTLRN     MULT EXRTN     WMNAM                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C           WMGRT     IFGT EXRTN                                     CAC001
     C           WMGRT     ANDGTWMXAM                                     CAC001
     C           WMGRT     ORLT EXRTN                                     CAC001
     C           WMGRT     ANDLTWMNAM                                     CAC001
     C           WARN      IFEQ '0'                                       CAC001
     C           S         ADD  1         S                               CAC001
     C                     MOVE 'W01'     ERCD,S                          CAC001
     C                     MOVE '1'       *IN08                           CAC001
     C           S         IFEQ 1                                         CAC001
     C                     MOVE '1'       WARN                            CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          208221
     C*                                                                   CAC001
     C**  End of if there are no errors                                   CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C**  End of if FX Margin Points entered                              CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C**  Validate FX Margin DR/CR Indicator                              CAC001
     C*                                                                   CAC001
     C           SFXIN     IFEQ *BLANKS                                   CAC001
     C           SFXMP     ANDNE*BLANKS                                   CAC001
     C           *IN08     ANDEQ'0'                                       CAC001
     C*                                                                   CAC001
     C           SFXIN     ORNE *BLANKS                                   CAC001
     C           SFXMP     ANDEQ*BLANKS                                   CAC001
     C           *IN08     ANDEQ'0'                                       CAC001
     C*                                                                   CAC001
     C**  Send error message if:                                          CAC001
     C**   - Margin DR/CR ind. not entered but margin points entered;     CAC001
     C**   - Margin DR/CR ind. entered but margin points not entered      CAC001
     C*                                                                   CAC001
     C           S         ADD  1         S                               CAC001
     C                     MOVE '203'     ERCD,S                          CAC001
     C                     MOVE '1'       *IN27                           CAC001
     C*                                                                   CAC001
     C                     ELSE                                           CAC001
     C*                                                                   CAC001
     C**  Valid values are 'D', 'C', or blank                             CAC001
     C*                                                                   CAC001
     C           SFXIN     IFNE 'D'                                       CAC001
     C           SFXIN     ANDNE'C'                                       CAC001
     C           SFXIN     ANDNE*BLANK                                    CAC001
     C           S         ADD  1         S                               CAC001
     C                     MOVE '204'     ERCD,S                          CAC001
     C                     MOVE '1'       *IN27                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                                          CAC001
1034 C********************************************************************
1035 C**   FURTHER VALIDATION OF AMOUNTS BASED UPON SIMILAR VALIDATION
     C** N.B. IND. 50 IS USED AS A WORK IND. EARLIER IN VALIDATION        S01111
1036 C**   IN DL0030
1037 C**
1038 C**  DETERMINE NO. OF DECIMAL PLACES IN D/R & C/R AMOUNTS
1039 C           DCDP      COMP 1                      5051
1040 C           DCDP      COMP 2                    53  52
1041 C**
1042 C           CCDP      COMP 1                      0405
1043 C           CCDP      COMP 2                    97  06
1044 C**   MOVE DEBIT AMOUNT INTO A 15,3 WORK FIELD
1045 C   50                Z-ADDDRAMN0    DRAMT  153
1046 C   51                Z-ADDDRAMN1    DRAMT
1047 C   52                Z-ADDDRAMN2    DRAMT
1048 C   53                Z-ADDDRAMN3    DRAMT
1049 C**   MOVE CREDIT AMOUNT INTO A 15,3 WORK FIELD
1050 C   04                Z-ADDCRAMN0    CRAMT  153
1051 C   05                Z-ADDCRAMN1    CRAMT
1052 C   06                Z-ADDCRAMN2    CRAMT
1053 C   97                Z-ADDCRAMN3    CRAMT
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           WFXMP     IFNE 0                                         CAC001
     C           *IN08     ANDEQ'0'                                       CAC001
     C                     EXSR CLCAMT                                    CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
1054 C**
1055 C**   IF CROSS RATE IN ERROR DO NOT PERFORM VALIDATIONS
1056 C   76                GOTO FAMTV
     C                     MOVEL*BLANK    @DR1    1                       116966
     C                     MOVEL*BLANK    @DR2    1                       116966
     C                     MOVEL*BLANK    @CR1    1                       116966
     C                     MOVEL*BLANK    @CR2    1                       116966
     C/COPY WNCPYSRC,RE0150C034
1057 C**   VALIDATE DEBIT AMOUNT AGAINST CREDIT AMOUNT
1058 C                     Z-ADDCRAMT     AMTCHK
1059 C**
1060 C   04                Z-ADD1         FACTOR
1061 C   05                Z-ADD10        FACTOR
1062 C   06                Z-ADD100       FACTOR
1063 C   97                Z-ADD1000      FACTOR
1064 C**
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN08     ANDEQ'0'                                       CAC001
     C           WFXMP     ANDNE0                                         CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           *IN08     ANDEQ'0'                                       CDE002
     C           WFXMP     ANDNE0                                         CDE002
     C           DRAMT     MULT WMGRT     RESULT    H                     CAC001
     C                     ELSE                                           CAC001
1065 C           DRAMT     MULT EXRTN     RESULT    H
     C                     ENDIF                                          CAC001
     C                     Z-ADDRESULT    RESLT1 153                      116966
1066 C                     EXSR AMTCMP
1067 C*
1068 C***  KEEP RECORD OF HOW EXRT IS USED
1069 C*
1070 C**N47******          Z-ADD1         PDMDIN  10                      S01194
1071 C**N47******          Z-ADD0         PCMDIN  10                      S01194
1070 C  N47                MOVE 'M'       PDMDIN  1                       S01194
1071 C  N47                MOVE 'D'       PCMDIN  1                       S01194
1072 C**N47******          GOTO FAMTV                                     116966
     C           *IN47     IFEQ '1'                                       116966
     C                     MOVE 'Y'       @DR1                            116966
     C                     ELSE                                           116966
     C                     MOVE 'N'       @DR1                            116966
     C                     END                                            116966
     C  N47                GOTO CRCHK                                     116966
1073 C**
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN08     ANDEQ'0'                                       CAC001
     C           WFXMP     ANDNE0                                         CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           *IN08     ANDEQ'0'                                       CDE002
     C           WFXMP     ANDNE0                                         CDE002
     C           DRAMT     DIV  WMGRT     RESULT    H                     CAC001
     C                     ELSE                                           CAC001
1074 C           DRAMT     DIV  EXRTN     RESULT    H
     C                     ENDIF                                          CAC001
     C                     Z-ADDRESULT    RESLT2 153                      116966
1075 C                     EXSR AMTCMP
1076 C*
1077 C***  KEEP RECORD OF HOW EXRT IS USED
1078 C*
1079 C**N47******          Z-ADD0         PDMDIN  10                      S01194
1080 C**N47******          Z-ADD1         PCMDIN  10                      S01194
1079 C  N47                MOVE 'D'       PDMDIN  1                       S01194
1080 C  N47                MOVE 'M'       PCMDIN  1                       S01194
1081 C**N47******          GOTO FAMTV                                     116966
     C           *IN47     IFEQ '1'                                       116966
     C                     MOVEL'Y'       @DR2                            116966
     C                     ELSE                                           116966
     C                     MOVEL'N'       @DR2                            116966
     C                     END                                            116966
1082 C**
1083 C**   VALIDATE CREDIT AMOUNT AGAINST DEBIT AMOUNT
1084 C**   NB.  DIFFERENT ROUNDING ERRORS MEAN THAT THIS IS NOT EQUIVALENT
1085 C**   TO THE PREVIOUS SET OF CHECKS
1086 C**
1087 C                     Z-ADDDRAMT     AMTCHK
1088 C**
1089 C   50                Z-ADD1         FACTOR
1090 C   51                Z-ADD10        FACTOR
1091 C   52                Z-ADD100       FACTOR
1092 C   53                Z-ADD1000      FACTOR
1093 C**
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN08     ANDEQ'0'                                       CAC001
     C           WFXMP     ANDNE0                                         CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           *IN08     ANDEQ'0'                                       CDE002
     C           WFXMP     ANDNE0                                         CDE002
     C           CRAMT     MULT WMGRT     RESULT    H                     CAC001
     C                     ELSE                                           CAC001
1094 C           CRAMT     MULT EXRTN     RESULT    H
     C                     ENDIF                                          CAC001
     C                     Z-ADDRESULT    RESLT3 153                      116966
1095 C                     EXSR AMTCMP
1096 C*
1097 C***  KEEP RECORD OF HOW EXRT IS USED
1098 C*
1099 C**N47******          Z-ADD0         PDMDIN  10                      S01194
1100 C**N47******          Z-ADD1         PCMDIN  10                      S01194
1099 C  N47                MOVE 'D'       PDMDIN  1                       S01194
1100 C  N47                MOVE 'M'       PCMDIN  1                       S01194
     C           *IN47     IFEQ '1'                                       116966
     C                     MOVEL'Y'       @CR1                            116966
     C           @DR2      IFEQ 'N'                                       116966
     C                     EXSR RANGES                                    116966
     C                     END                                            116966
     C                     ELSE                                           116966
     C                     MOVEL'N'       @CR1                            116966
     C           @DR2      IFEQ 'Y'                                       116966
     C                     EXSR RANGES                                    116966
     C                     END                                            116966
     C                     END                                            116966
1101 C  N47                GOTO FAMTV
1102 C**
     C           CRCHK     TAG                                            116966
     C           @DR1      IFEQ 'Y'                                       116966
     C                     Z-ADDDRAMT     AMTCHK                          116966
     C**                                                                  116966
     C   50                Z-ADD1         FACTOR                          116966
     C   51                Z-ADD10        FACTOR                          116966
     C   52                Z-ADD100       FACTOR                          116966
     C   53                Z-ADD1000      FACTOR                          116966
     C                     END                                            116966
     C*                                                                   116966
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN08     ANDEQ'0'                                       CAC001
     C           WFXMP     ANDNE0                                         CAC001
     C           CDE002    OREQ 'Y'                                       CDE002
     C           *IN08     ANDEQ'0'                                       CDE002
     C           WFXMP     ANDNE0                                         CDE002
     C           CRAMT     DIV  WMGRT     RESULT    H                     CAC001
     C                     ELSE                                           CAC001
1103 C           CRAMT     DIV  EXRTN     RESULT    H
     C                     ENDIF                                          CAC001
     C                     Z-ADDRESULT    RESLT4 153                      116966
1104 C                     EXSR AMTCMP
1105 C*
1106 C***  KEEP RECORD OF HOW EXRT IS USED
1107 C*
1108 C**N47******          Z-ADD1         PDMDIN  10                      S01194
1109 C**N47******          Z-ADD0         PCMDIN  10                      S01194
1108 C  N47                MOVE 'M'       PDMDIN  1                       S01194
1109 C  N47                MOVE 'D'       PCMDIN  1                       S01194
     C           *IN47     IFEQ '1'                                       116966
     C                     MOVE 'Y'       @CR2                            116966
     C           @DR1      IFEQ 'N'                                       116966
     C                     EXSR RANGES                                    116966
     C                     END                                            116966
     C                     ELSE                                           116966
     C                     MOVE 'N'       @CR2                            116966
     C           @DR1      IFEQ 'Y'                                       116966
     C                     EXSR RANGES                                    116966
     C                     END                                            116966
     C                     END                                            116966
1110 C  N47                GOTO FAMTV
1111 C********************************************************************
     C           ERRAMT    TAG                                            116966
1112 C   47                SETON                     657376
1113 C   47      S         ADD  1         S
1114 C   47                MOVE '119'     ERCD,S
1115 C**
1116 C           FAMTV     TAG                             * FAMTV TAG
     C/COPY WNCPYSRC,RE0150C003
1117 C**
1118 C**  IF OVERRIDE IND. 'N'-FURTHER VALIDATIONS ON AMOUNT FIELDS
1119 C**
1120 C           BCDP      COMP 1                      3536
1121 C           BCDP      COMP 2                    38  37
1122 C***48N76*49          EXSR RATCH                                     CAC001
     C           *IN48     IFEQ '1'                                       CAC001
     C           *IN76     ANDEQ'0'                                       CAC001
     C           OINDN     ANDEQ'1'                                       CAC001
     C                     EXSR RATCH                                     CAC001
     C                     ENDIF                                          CAC001
1123 C***48******                                                         CAC001
1124 C*ORN49*****           GOTO ENDVL                                    CAC001
     C           *IN48     IFEQ '1'                                       CAC001
     C           OINDN     OREQ '0'                                       CAC001
     C                     GOTO ENDVL                                     CAC001
     C                     ENDIF                                          CAC001
1125 C**
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CCP5                                           S01408
     C*                                                                   S01408
1126 C**
1127 C**
1130 C********************************************************************
1131 C**
1132 C**   DEFINE BASE AMOUNT AS A 15,3 WORK FIELD
1133 C   35                Z-ADDBCEQ0     BSEQ   153
1134 C   36                Z-ADDBCEQ1     BSEQ
1135 C   37                Z-ADDBCEQ2     BSEQ
1136 C   38                Z-ADDBCEQ3     BSEQ
1137 C**  WORK OUT 90% AND 110% OF BASE CCY EQUIV.
1138 C**
1139 C***********BSEQ      MULT 0.9       BCEQL  153                      E16124
1140 C***********BSEQ      MULT 1.1       BCEQH  153                      E16124
1141 C**
1142 C**  IF OVERRIDE IND. IS 'N' THE D/R AMOUNT , WHEN CONVERTED
1143 C**  TO BASE CCY EQUIV. MUST BE WITHIN 10% OF BASE CCY EQUIV.
1144 C   07                Z-ADD1         HOLD    10
1145 C  N07                Z-ADD0         HOLD
1146 C           HOLD1     COMP 1                        07
1147 C***********DMDIN     COMP 0                        47               S01194
1147 C           DMDIN     COMP 'D'                      47               S01194
1148 C***47*07***DRAMT     DIV  DSPOT     DRAMNT 153H                     072169
1149 C**N47*07***DRAMT     MULT DSPOT     DRAMNT    H                     072169
1148 C   47      DRAMT     DIV  DSPOT     DRAMNT 153H                     072169
1149 C  N47      DRAMT     MULT DSPOT     DRAMNT    H                     072169
     C/COPY WNCPYSRC,RE0150C035
     C**
     C           DRAMNT    MULT 0.9       DRAML  153                      E16124
     C           DRAMNT    MULT 1.1       DRAMH  153                      E16124
     C/COPY WNCPYSRC,RE0150C004
     C           BSEQ      COMP DRAML                  47                 E16124
     C  N47      BSEQ      COMP DRAMH                47                   E16124
1150 C**                                                                  E16124
1151 C***********DRAMNT    COMP BCEQL                  47                 E16124
1152 C**N47******DRAMNT    COMP BCEQH                47                   E16124
1153 C   47                SETON                     6574
1168 C           S         IFNE 0                                         E11643
1168 C           ERCD,S    IFNE ' 120'                                    E11643
1154 C   47      S         ADD  1         S
1155 C   47                MOVE '120'     ERCD,S
1171 C                     END                                            E11643
1171 C                     END                                            E11643
     C           S         IFEQ 0                                         E16124
     C   47      S         ADD  1         S                               E16124
     C   47                MOVE '120'     ERCD,S                          E16124
     C                     END                                            E16124
1156 C**
1157 C**  SIMILARLY CREDIT AMOUNT MUST BE WITHIN 10% OF BASE CCY EQUIV.
1158 C**
1159 C           HOLD2     COMP 1                        07
1160 C***********CMDIN     COMP 0                        47               S01194
1160 C           CMDIN     COMP 'D'                      47               S01194
1161 C***47*07***CRAMT     DIV  CSPOT     CRAMNT 153H                     072169
1162 C**N47*07***CRAMT     MULT CSPOT     CRAMNT    H                     072169
1161 C   47      CRAMT     DIV  CSPOT     CRAMNT 153H                     072169
1162 C  N47      CRAMT     MULT CSPOT     CRAMNT    H                     072169
1163 C           HOLD      COMP 1                        07
     C**
     C           CRAMNT    MULT 0.9       CRAML  153                      E16124
     C           CRAMNT    MULT 1.1       CRAMH  153                      E16124
     C/COPY WNCPYSRC,RE0150C005
     C           BSEQ      COMP CRAML                  47                 E16124
     C  N47      BSEQ      COMP CRAMH                47                   E16124
1164 C**                                                                  E16124
1165 C***********CRAMNT    COMP BCEQL                  47                 E16124
1166 C**N47******CRAMNT    COMP BCEQH                47                   E16124
1167 C   47                SETON                     7374
1168 C**   IND. 73 MAY BE ON ALREADY;USE IND. 47
1168 C           S         IFNE 0                                         E11643
1168 C           ERCD,S    IFNE ' 120'                                    E11643
1169 C   47      S         ADD  1         S
1170 C   47                MOVE '120'     ERCD,S
1171 C                     END                                            E11643
1171 C                     END                                            E11643
     C           S         IFEQ 0                                         E16124
     C   47      S         ADD  1         S                               E16124
     C   47                MOVE '120'     ERCD,S                          E16124
     C                     END                                            E16124
     C/COPY WNCPYSRC,RE0150C013
1171 C**
1172 C*
1173 C                     GOTO ENDVL
1174 C********************************************************************
1175 C**  HANDLE DELETIONS
1176 C**
1177 C           DLSCRN    TAG                             * DLSCRN TAG
1446 C**                                                                  E13304
1446 C**  MOVE BLANKS INTO WORK FIELD (USED IN E13304 FIX)                E13304
1446 C                     MOVE '   '     WKCOD                           E13304
1178 C**
1179 C**   RETRIEVE A/CS FOR MEMOS FILE RRNS
1180 C**      DEBIT A/C
1181 C                     MOVE DCUS      XCUS
1182 C                     MOVE DACY      XCCY
1183 C                     MOVE DCOD      XCOD
1184 C                     MOVE DACS      XSEQ
     C                     MOVE BRCDD     XBRC                            S01117
1185 C                     EXSR ACNCHN
      *                                                                   132339
      ** Store DEBIT A/C for future use.                                  132339
      *                                                                   132339
     C                     MOVELATYP      DRATYP  1                       132339
1186 C******     ATYP      COMP 'R'                      25               S01111
1187 C***25*               Z-ADDRRNM      DMRRN                           S01111
1187 C                     MOVE '0'       DRRET                           E13254
1186 C           ATYP      IFEQ 'R'                                       S01111
1187 C                     MOVE '1'       DRRET                           E13254
1187 C***********          Z-ADDRRNM      DMRRN                     S01111CCB002
     C                     END                                            S01111
1186 C           ATYP      IFEQ 'N'                                       E41812
1187 C                     MOVE '2'       DRRET                           E41812
     C                     END                                            E41812
1188 C**      CREDIT A/C
1189 C                     MOVE CCUS      XCUS
1190 C                     MOVE CACY      XCCY
1191 C                     MOVE CCOD      XCOD
1192 C                     MOVE CACS      XSEQ
     C                     MOVE BRCDC     XBRC                            S01117
1193 C                     EXSR ACNCHN
1194 C******     ATYP      COMP 'R'                      33               S01111
1195 C***33*               Z-ADDRRNM      CMRRN                           S01111
1187 C                     MOVE '0'       CRRET                           E13254
1194 C           ATYP      IFEQ 'R'                                       S01111
1187 C                     MOVE '1'       CRRET                           E13254
1195 C***********          Z-ADDRRNM      CMRRN                     S01111CCB002
     C                     END                                            S01111
1186 C           ATYP      IFEQ 'N'                                       E41812
1187 C                     MOVE '2'       CRRET                           E41812
     C                     END                                            E41812
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CEX1                                           S01408
     C*                                                                   S01408
1197 C********************************************************************
1198 C           ENDVL     TAG                             * ENDVL TAG
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0150CEXV                                           S01408
     C*                                                                   S01408
1199 C**
1200 C**  IF ERRORS FOUND, SET OUTPUT INDICATORS TO REDISPLAY SCREEN
1201 C           S         COMP 0                    47
1202 C**   DO NOT DISPLAY BASE EQUIV FIELDS IF ONE CCY =BASE CCY
1203 C   47 48             SETOF                     353637
1204 C   47 48             SETOF                     38
1205 C   47                SETON                     437087
1206 C   47                SETOF                     7744
     C/COPY WNCPYSRC,RE0150C014
1207 C   47      S         COMP 19                     7878
1208 C   47N78             MOVE BLANKS    ERMSG
1209 C   47N78             MOVEAERCD,26   ERMSG
1210 C   47 46             SETON                     55
     C/COPY WNCPYSRC,RE0150C015
1211 C   47                GOTO SCNOUT
      *                                                                                      BUG7274
     C           *IN47     IFEQ '0'                                                          BUG7274
     C           *IN58     ANDEQ'1'                                                          BUG7274
     C           WARN0     ANDEQ'Y'                                                          BUG7274
     C                     MOVE '1'       *IN87                                              BUG7274
     C                     GOTO SCNOUT                                                       BUG7274
     C                     ENDIF                                                             BUG7274
      *                                                                                      BUG7274
     C                     MOVE 'N'       WARN0                                              BUG7274
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP11                                           S01408
     C*                                                                   S01408
     C*                                                               *   S01241
     C*    WINDOW PROCESSING                                          *   S01241
     C*                                                                   S01241
     C*                                                                   S01241
     C***********BGL5ST    IFEQ 'Y'                                 S01241S01251
     C           BGWDPR    IFEQ 'Y'                                       S01251
     C/COPY WNCPYSRC,RE0150C019
      *    /copy to move data into the data structure fields passed       S01241
      *     as a parameter to the window controller                       S01241
      /COPY WNCPYSRC,RE0150MOV1                                           S01241
      *                                                                   S01241
     C                     UNLCKLDA                                       S01241
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP19                                           S01408
     C*                                                                   S01408
     C                     CALL 'WN0010'                                  S01241
     C                     PARM 'RE0150'  #PGM   10                       S01241
     C                     PARM *BLANK    KEY     2                       S01241
     C                     PARM ACTCD     ACTION  1                       S01241
     C                     PARM           DATA                            S01241
     C                     PARM *BLANK    #RTRN   7                       S01241
     C                     PARM           SPARE 256                       S01252
     C           *LOCK     IN   LDA                                       S01241
     C                     END                                            S01241
     C*                                                                   S01241
     C***********#RTRN*****IFEQ 'USR0790'                           S01241E22221
     C*                                                                   083135
     C**  Process F3 taken from window.                                   083135
     C*                                                                   083135
     C           #RTRN     IFEQ 'Y2U9999'                                 083135
     C                     MOVE '1'       *IN41                           083135
     C                     MOVE '1'       *INKC                           083135
     C                     MOVE '1'       *INLR                           083135
     C                     GOTO END                                       083135
     C                     ENDIF                                          083135
     C/COPY WNCPYSRC,RE0150C018
     C*                                                                   083135
     C           #RTRN     IFNE *BLANK                                    E22221
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP12                                           S01408
     C*                                                                   S01408
     C                     CALL 'SNDERMSG'                                S01241
     C                     PARM           ZAPGM            Program queue  S01241
     C                     PARM           ZAPGRL  5        Rel queue      S01241
     C*********************PARM 'WND0001' ZAMSID  7     Message Id. S01241E22221
     C                     PARM #RTRN     ZAMSID  7        Message Id.    E22221
     C*********************PARM 'MIDAS  ' ZAMSGF 10   Message file. S01241E22221
     C                     PARM 'WNMSGF ' ZAMSGF 10        Message file.  E22221
     C                     PARM           ZAMSDA132        Message data.  S01241
     C                     PARM           ZAMSTP  7        Message type.  S01241
      * Clear all fields for default mechanism next time.                 S01241
     C                     MOVEL*BLANK    ZAPGM            Program queue  S01241
     C                     MOVEL*BLANK    ZAPGRL           Rel queue      S01241
     C                     MOVEL*BLANK    ZAMSID           Message Id.    S01241
     C                     MOVEL*BLANK    ZAMSGF           Message file.  S01241
     C                     MOVEL*BLANK    ZAMSDA           Message data.  S01241
     C                     MOVEL*BLANK    ZAMSTP           Message type.  S01241
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP13                                           S01408
     C*                                                                   S01408
     C*                                                                   S01241
     C      48             SETOF                     353637               S01241
     C      48             SETOF                     384465               S01241
     C                     SETOF                     657376               S01241
     C                     SETON                     437087               S01241
     C      46             SETON                     55                   S01241
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP14                                           S01408
     C*                                                                   S01408
     C                     GOTO SCNOUT                                    S01241
     C                     END                                            S01241
     C/COPY WNCPYSRC,RE0150C001
1212 C**
1213 C**  CALCULATIONS TO JOURNAL AND UPDATE THE CUSEX AND MEMOS FILES
1214 C**  IF DATABASE OR SYSTEM ERROR IS FOUND INDICATORS ARE SET
1215 C**  TO REFLECT ERROR,FILES AND SCREEN ARE RELEASED TO END PROGRAM
1219 C**
     C           *IN45     IFEQ '1'                                       S01413
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP15                                           S01408
     C*                                                                   S01408
     C**  GET NEXT C/E NUMBER AND LOCK DATA AREA DURING ALL UPDATE        S01413
     C           *NAMVAR   DEFN CEXNO     CEXNOD                          S01413
     C           *LOCK     IN   CEXNOD                                    S01413
     C           CEXNOA    IFEQ *BLANKS                                   036434
     C           CEXNOS    OREQ 0                                         061995
     C                     Z-ADD0         CEXNOS                          036434
     C                     END                                            036434
     C                     ADD  1         CEXNOS                          S01413
     C***********CEXNOS    IFEQ 0                                   S01413036434
     C***********          ADD  1         CEXNOS                    S01413036434
     C***********          END                                      S01413036434
     C                     MOVEL'CE'      DOCN                            S01413
     C                     MOVE CEXNOS    DOCN                            S01413
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP16                                           S01408
     C*                                                                   S01408
     C                     SETOF                     80                   S01413
     C                     GOTO INFTAG                                    S01413
     C                     END                                            S01413
1220 C**  CHECK STATUS OF RECORD UNCHANGED
1221 C                     SETOF                     1718
1222 C           DOCN      CHAINCUSEX                47    ON NOT THERE
1223 C**
1224 C  N17                Z-ADD0         TNLU2
1225 C  N17                Z-ADD0         LCD1
1226 C  N17                MOVE ' '       CHTP1
1227 C**
1237 C                     SETOF                     80
1228 C  N47      TNLU1     COMP TNLUS                8080
1229 C**
1230 C**  INFTAG BRANCHED TO FRM START OF DETAIL CALCS AFTER STATUS 01021
1231 C**
     C           INFTAG    TAG
1229 C**
1230 C**  IF RECORD CHANGED,SET ERROR MESSAGE,RELEASE FILES AND BYPASS
1231 C**
1232 C   80N47             SETON                     42
1233 C   80N47             EXSR EXCPTN
1234 C   80                MOVELERRMSG,5  ERMSG
1235 C   80                SETON                     8755
1236 C   80                SETON                     4370
1237 C   80                SETOF                     78
     C   80                SETON                     84
     C   80                EXSR EXCPTN
1238 C   80                GOTO SCNOUT
     C**
     C**   OBTAIN LAST TRANSACTION NUMBER AND PREPARE STANDARD
     C**   INFORMATION FOR CMTTXT DATA STRUCTURE
     C                     EXSR ZTNLU1
     C                     MOVE 'RE'      MDID
     C                     MOVEL'RE0150'  PGMN
     C                     MOVE WSID      WSIDX
     C                     TIME           MTIME
     C                     MOVE ACTCD     ACTCDX
     C                     MOVE USRID     USRIDX
     C                     MOVE REREC     RERECX
     C                     MOVE REREC2    RECX2                           S01117
1294 C**
1295 C**  LOCK DATA AREA DURING MEMOS FILE UPDATE
     C           *NAMVAR   DEFN REQFL     REQNM
     C           *LOCK     IN   REQNM
1294 C**
1295 C**  INSERT/DELETE CUSEX RECORD AND UPDATE MEMOS FILE IF
1296 C**  RETAIL A/CS ARE INVOLVED
1297 C**
1298 C***25*               Z-ADDDMRRN     MRRN    50       DR A/C RETAIL  S01111
1299 C***25*               EXSR MEMCHN                     A/C.           S01111
     C***47*25                                                            S01111
     C*RN14*25             SETON                     LRU841               S01111
     C***47*25                                                            S01111
     C*RN14*25             SETON                     58                   S01111
     C           DRRET     IFEQ '1'                                       S01111
      *                                                                   124290
      **   The following processing only applies to retail accounts       124290
      *                                                                   124290
     C***********ATYP      IFEQ 'R'                                124290 132339
     C           DRATYP    IFEQ 'R'                                       132339
     C                     MOVE '0'       IN54                            S01117
1298 C***********          Z-ADDDMRRN     MRRN    50       DR A/C RES01111CCB002
     C                     Z-ADD0         W0RETL 100                      134071
      *                                                                   CCB002
      **   Set up parameters for call to access object AOMEMSU0.          CCB002
     C                     MOVE DRAC      W0RETL                          134071
     C                     MOVE DRCNUM    W0CNUM                          CCB002
     C                     MOVELDRCCY     W0CUCD                          CCB002
     C                     MOVE DRACOD    W0ACCD                          CCB002
     C                     MOVE DRACSQ    W0ACSQ                          CCB002
     C                     MOVELDRBRCD    W0BRCA                          CCB002
     C                     Z-ADDDRAC      W0RETL                          124290
     C                     Z-ADDDRVD      W0VDAT                          CCB002
     C                     MOVEL'DR_A/C'  UACTYP  6                       CCB002
1299 C                     EXSR MEMCHN                     A/C.           S01111
     C***47******                                                   S01111S01413
     C*RN14******          SETON                     LRU841         S01111S01413
     C           *IN47     IFEQ '1'                                       S01413
     C           *IN14     OREQ '0'                                       S01413
     C                     SETON                         41               S01413
     C           *LOCK     IN   LDA                                       S01413
     C                     MOVEL'MEMOS'   DBFILE           ***************S01413
     C***********          MOVELMRRN      DBKEY            * DBERRORS01413CCB002
     C                     MOVELW0CNUM    DBKEY            * DBERROR 707  CCB002
     C                     MOVE '707'     DBASE            ***************S01413
     C                     OUT  LDA                                       S01413
     C                     EXSR DBSR                                      S01413
     C                     ENDIF                                          S01413
     C***47*****                                                                       S01111 CAAA03
     C*ORN14****           SETON                     58                                S01111 CAAA03
     C                     ENDIF                                          124290
     C                     END                                            S01111
     C           DRRET     IFEQ '2'                                       E41812
     C           *INKC     ANDNE'1'                                       E41808
     C                     MOVE 'D'       TYPE                            S01117
1303 C                     EXSR NOSTAC                     NOSTRO A/C     E41812
     C                     END                                            E41812
     C***U8******          EXSR DBERR                                     S01413
     C***U8******          GOTO END                                       S01413
1300 C**
1301 C***********          SETON                     54                   S01117
     C                     MOVE '1'       IN54    1                       S01117
1302 C***33*               Z-ADDCMRRN     MRRN             CR A/C RETAIL  S.
1303 C***33*               EXSR MEMCHN                     A/C            S01111
     C***47*33                                                            S01111
     C*RN14*33             SETON                     LRU841               S01111
     C***47*33                                                            S01111
     C*RN14*33             SETON                     58                   S01111
     C           CRRET     IFEQ '1'                                       S01111
1302 C***********          Z-ADDCMRRN     MRRN             CR A/C RES01111CCB002
     C                     Z-ADD0         W0RETL 100                      134071
      *                                                                   CCB002
      **   Set up parameters for call to access object AOMEMSU0.          CCB002
     C                     MOVE CRAC      W0RETL                          134071
     C                     MOVE CRCNUM    W0CNUM                          CCB002
     C                     MOVELCRCCY     W0CUCD                          CCB002
     C                     MOVE CRACOD    W0ACCD                          CCB002
     C                     MOVE CRACSQ    W0ACSQ                          CCB002
     C                     MOVELCRBRCD    W0BRCA                          CCB002
     C                     Z-ADDCRAC      W0RETL                          124290
     C                     Z-ADDCRVD      W0VDAT                          CCB002
     C                     MOVEL'CR_A/C'  UACTYP                          CCB002
1303 C                     EXSR MEMCHN                     A/C            S01111
     C***47******                                                   S01111S01413
     C*RN14******          SETON                     LRU841         S01111S01413
     C           *IN47     IFEQ '1'                                       S01413
     C           *IN14     OREQ '0'                                       S01413
     C                     SETON                         41               S01413
     C           *LOCK     IN   LDA                                       S01413
     C                     MOVEL'MEMOS'   DBFILE           ***************S01413
     C***********          MOVELMRRN      DBKEY            * DBERRORS01413CCB002
     C                     MOVELW0CNUM    DBKEY            * DBERROR 708  CCB002
     C                     MOVE '708'     DBASE            ***************S01413
     C                     OUT  LDA                                       S01413
     C                     EXSR DBSR                                      S01413
     C                     ENDIF                                          S01413
     C***47*****                                                                       S01111 CAAA03
     C**ORN14***           SETON                     58                                S01111 CAAA03
     C                     END                                            S01111
     C           CRRET     IFEQ '2'                                       E41812
     C           *INKC     ANDNE'1'                                       E41808
     C                     MOVE 'C'       TYPE    1                       S01117
1303 C                     EXSR NOSTAC                     NOSTRO A/C     E41812
     C                     END                                            E41812
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP21                                           S01408
     C**                                                                  S01413
     C** Update MEMOS, RSACMTPD and PRONO for the charge account.         S01413
     C**                                                                  S01413
     C                     MOVE 'C'       IN54                            S01413
     C           *INKC     IFNE '1'                                       S01413
     C           *IN02     IFEQ '1'                                       S01413
     C           CHCUS     ANDNE*BLANKS                                   S01413
     C           *IN02     OREQ '0'                                       S01413
     C********** CHCN      ANDNE*ZEROS                                                 S01413 CSD027
     C           CHCN      ANDNE*BLANKS                                                       CSD027
     C                     EXSR CHGUPD                                    S01413
     C                     END                                            S01413
     C                     END                                            S01413
     C**                                                                  S01413
     C** IF THERE IS A DATABASE ERROR AT THIS POINT THEN THE D/R
     C** A/C WILL HAVE BEEN UPDATED AND WILL HAVE TO BE REVERSED
     C** MANUALLY BY WHOEVER IS INVESTIGATING THIS DATABASE ERROR
     C***U8******          EXSR DBERR                                     S01413
     C***U8******          GOTO END                                       S01413
1304 C***********          SETOF                     54                   S01117
     C                     MOVE '0'       IN54                            S01117
1305 C**
1295 C**  UNLOCK DATA AREA AFTER MEMOS FILE UPDATE
     C                     OUT  REQNM
     C/COPY WNCPYSRC,RE0150C002
1306 C**
1307 C                     SETON                     89
1308 C                     EXSR EXCPTN
1309 C                     SETOF                     88
     C           *IN45     IFEQ '1'                                       S01413
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP17                                           S01408
     C*                                                                   S01408
     C**  UNLOCK DATA AREA                                                S01413
     C                     OUT  CEXNOD                                    S01413
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CP18                                           S01408
     C*                                                                   S01408
     C**  SET UP MESSAGE                                                  S01413
     C                     MOVELERRMSG,11 INSERT                          S01413
     C                     MOVELDOCN      DOCNO                           S01413
     C                     MOVELINSERT    ERMSG                           S01413
     C                     SETOF                     78                   S01413
     C                     END                                            S01413
1310 C**
1311 C**  READ CUSEX TRAILER
1312 C**
1313 C           DOCNT     CHAINCUSEX                47
     C***47******          SETON                     LRU841               S01413
     C           *IN47     IFEQ '1'                                       S01413
     C                     SETON                         41               S01413
     C           *LOCK     IN   LDA                                       S01413
     C                     MOVEL'CUSEX'   DBFILE           ***************S01413
     C                     MOVELDOCNT     DBKEY            * DBERROR 709  S01413
     C                     MOVE '709'     DBASE            ***************S01413
     C                     OUT  LDA                                       S01413
     C                     EXSR DBSR                                      S01413
     C                     ENDIF                                          S01413
     C** TO GET THIS FAR MUST HAVE ALREADY RELEASED LOG
     C** SO SETON 58 TO STOP UPDATE BEFORE INPUT ERROR
     C***47*****           SETON                     58                                       CAAA03
     C***U8******          EXSR DBERR                                     S01413
     C***U8******          GOTO END                                       S01413
1325 C**
1326 C   45      NORE      ADD  1         NORE             * UPDATE RECORD
1327 C**
1328 C                     Z-ADDHRWN      ZZTOTI
1329 C                     Z-ADDHRDC      ZZTOTD
1330 C**
1331 C                     MOVE DRAMN0    ZZAMT            * ACCUMULATE
1332 C   45                EXSR GLZADD                     * DR TOTALS
1333 C**
1334 C                     MOVE CRAMN0    ZZAMT            * CR TOTALS
1335 C   45                EXSR GLZADD
1336 C**
1337 C   45                Z-ADDZZTOTI    HRWN
1338 C   45                Z-ADDZZTOTD    HRDC
1339 C**
     C*                                                                   050831
     C**  Update of OLPOS file                                            050831
     C*                                                                   050831
     C**  Do update twice, once for debit entry once for credit. The      050831
     C**  Currency is sorted alphabetically and the lowest currency       050831
     C**  is done on the first DO.                                        050831
     C*                                                                   050831
     C                     MOVE ' '       DEBCRE  1                       050831
     C           DRCCY     IFLT CRCCY                      B1             050831
     C                     MOVE 'D'       DEBCRE           *1             050831
     C                     ELSE                            X1             050831
     C                     MOVE 'C'       DEBCRE           *1             050831
     C                     END                             E1             050831
     C*                                                                   050831
     C                     DO   2                          B1             050831
     C*                                                                   050831
     C**  Update 01 record on olpos                                       050831
     C*                                                                   050831
     C                     MOVE '01'      @RECN            *1             050831
     C           DEBCRE    IFEQ 'D'                        B*2            050831
     C*                                                                   050831
     C**  If this is an insert                                            050831
     C*                                                                   050831
     C           *IN45     IFEQ '1'                        B**3           050831
     C                     MOVE DRCCY     @CCY             ***3           050831
     C                     MOVELDRBRCD    @BRCA            ***3           050831
     C                     MOVELDRVD      @EVENT  50       ***3           050831
     C                     Z-ADDDRAMN0    @AMNT  150       ***3           050831
     C*                                                                   050831
     C**  Else if this a reversal                                         050831
     C*                                                                   050831
     C                     ELSE                            X**3           050831
     C                     MOVE DACY      @CCY             ***3           050831
     C                     MOVELBRCDD     @BRCA            ***3           050831
     C                     MOVELDRVD      @EVENT  50       ***3           050831
     C                     Z-SUBDAMT      @AMNT            ***3           050831
     C                     END                             E**3           050831
     C*                                                                   050831
     C           @OLPOS    CHAINOLPOS                47    **2            050831
     C           *IN47     IFEQ '0'                        B**3           050831
     C***********          MOVE 'O'       @INOUT  1        ***3    050831 122319
     C                     MOVE 'I'       @INOUT  1        ***3           122319
     C*                                                                   050831
     C**  Do update of OLPOS                                              050831
     C*                                                                   050831
     C                     EXSR OLPUPD                     ***3           050831
     C                     END                             E**3           050831
     C*                                                                   050831
     C**  Else DEBCRE = C                                                 050831
     C*                                                                   050831
     C                     ELSE                            X*2            050831
     C*                                                                   050831
     C**  If this is an insert                                            050831
     C*                                                                   050831
     C           *IN45     IFEQ '1'                        B**3           050831
     C                     MOVE CRCCY     @CCY             ***3           050831
     C                     MOVELCRBRCD    @BRCA            ***3           050831
     C                     MOVELCRVD      @EVENT           ***3           050831
     C                     Z-ADDCRAMN0    @AMNT  150       ***3           050831
     C*                                                                   050831
     C**  Else if this a reversal                                         050831
     C*                                                                   050831
     C                     ELSE                            X**3           050831
     C                     MOVE CACY      @CCY             ***3           050831
     C                     MOVELBRCDC     @BRCA            ***3           050831
     C                     MOVELCRVD      @EVENT           ***3           050831
     C                     Z-SUBCAMT      @AMNT            ***3           050831
     C                     END                             E**3           050831
     C*                                                                   050831
     C           @OLPOS    CHAINOLPOS                47    **2            050831
     C           *IN47     IFEQ '0'                        B**3           050831
     C***********          MOVE 'I'       @INOUT  1        ***3    050831 122319
     C                     MOVE 'O'       @INOUT  1        ***3           122319
     C*                                                                   050831
     C**  Do update of OLPOS                                              050831
     C*                                                                   050831
     C                     EXSR OLPUPD                     ***3           050831
     C                     END                             E**3           050831
     C                     END                             E*2            050831
     C*                                                                   050831
     C** change buy/sell indicator for second round of update             050831
     C*                                                                   050831
     C           DEBCRE    IFEQ 'D'                        B*2            050831
     C                     MOVE 'C'       DEBCRE           **2            050831
     C                     ELSE                            X*2            050831
     C                     MOVE 'D'       DEBCRE           **2            050831
     C                     END                             E*2            050831
     C*                                                                   050831
     C**  End of DO loop                                                  050831
     C*                                                                   050831
     C                     END                             E1             050831
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0150CCAU                                           S01408
     C*                                                                   S01408
1348 C**
1349 C                     SETON                     8813
1350 C                     TIME           MTIME
1351 C                     EXSR EXCPTN
0822 C**
     C**   END OF COMMITMENT CYCLE
     C           CMTTXT    COMIT
1373 C**
1374 C**  OUTPUT INITIAL SCREEN
1375 C********             MOVE BLK184    SCFLDS                          S01111
1375 C***********          MOVE BLK223    SCFLDS                    S01111S01117
     C                     MOVE *BLANKS   SCFLDS                          S01117
1376 C                     SETON                     797141
1377 C                     SETON                       55
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0150CCP4                                           S01408
     C*                                                                   S01408
1378 C**
1379 C**  OBTAIN TIME FOR SCREEN DISPLAY
1380 C           SCNOUT    TAG                             * SCNOUT TAG
1381 C                     TIME           MTIME
1382 C**
1383 C           END       TAG                             * END TAG
1384 C**
1385 C**   SET PROTECT IND FOR RET ACNO
1386 C                     SETOF                     09
1387 C   55                SETON                     09
1388 C**N09******RACN      COMP 'Y'                  0909                 S01194
1388 C  N09      BMRANR    COMP 'Y'                  0909                 S01194
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0150CCP2                                           S01408
     C*                                                                   S01408
     C/EJECT                                                                                  199219
     C*****************************************************************                       199219
     C*                                                               *                       199219
     C*            CLEAR  - Clear Variables                           *                       199219
     C*                                                               *                       199219
     C* CALLS             -                                           *                       199219
     C*                                                               *                       199219
     C* CALLED BY  MAIN   - Main Control Processing                   *                       199219
     C*                                                               *                       199219
     C* FLDS USED         -                                           *                       199219
     C*                                                               *                       199219
     C*****************************************************************                       199219
     C           CLEAR     BEGSR                                                              199219
     C                     MOVE *BLANKS   DRBR                                                199219
     C                     MOVE *BLANKS   DACNA                                               199219
     C                     MOVE *BLANKS   DCCY                                                199219
     C                     MOVE *BLANKS   DACD                                                199219
     C                     MOVE *BLANKS   DASQ                                                199219
     C                     MOVE *BLANKS   DRAC                                                199219
     C                     MOVE *BLANKS   DRCY                                                199219
     C                     MOVE *BLANKS   DRAM                                                199219
     C                     MOVE *BLANKS   DCHN                                                199219
     C                     MOVE *BLANKS   DNAR                                                199219
     C                     MOVE *BLANKS   CBRC                                                199219
     C                     MOVE *BLANKS   CACNA                                               199219
     C                     MOVE *BLANKS   CCCY                                                199219
     C                     MOVE *BLANKS   CACDA                                               199219
     C                     MOVE *BLANKS   CASQ                                                199219
     C                     MOVE *BLANKS   CRAC                                                199219
     C                     MOVE *BLANKS   CRCY                                                199219
     C                     MOVE *BLANKS   CRAM                                                199219
     C                     MOVE *BLANKS   CNAR                                                199219
     C                     MOVE *BLANKS   BCEQ                                                199219
     C                     MOVE *BLANKS   OIND                                                199219
     C                     MOVE *BLANKS   EXRT                                                199219
     C                     MOVE *BLANKS   IPRFC                                               199219
     C                     MOVE *BLANKS   SFXMP                                               199219
     C                     MOVE *BLANKS   SFXIN                                               199219
     C                     MOVE *BLANKS   DRVALD                                              199219
     C                     MOVE *BLANKS   CRVALD                                              199219
     C                     MOVE *BLANKS   CHCUS                                               199219
     C                     MOVE *BLANKS   CHACD                                               199219
     C                     MOVE *BLANKS   CHASQ                                               199219
     C                     MOVE *BLANKS   CHSGN                                               199219
     C                     MOVE *BLANKS   CHAMT                                               199219
     C                     MOVE *BLANKS   SWCRD                                               199219
     C                     ENDSR                                                              199219
     C*****************************************************************                       199219
     C/EJECT                                                                                  199219
1389 C**
     C*****************************************************************   CAC001
     C*                                                               *   CAC001
     C*            CLCAMT - Calculate Amount                          *   CAC001
     C*                                                               *   CAC001
     C* CALLS             -                                           *   CAC001
     C*                                                               *   CAC001
     C* CALLED BY  MAIN   - Main Control Processing                   *   CAC001
     C*                                                               *   CAC001
     C* FLDS USED         -                                           *   CAC001
     C*                                                               *   CAC001
     C*****************************************************************   CAC001
     C           CLCAMT    BEGSR                                          CAC001
     C*                                                                   CAC001
     C**  Calculate Margin Amount.                                        CAC001
     C*                                                                   CAC001
     C                     Z-ADDEXRTN     ORAT   138                      CAC001
     C*                                                                   CAC001
     C**  Margin amount is in Debit Currency                              CAC001
     C*                                                                   CAC001
     C           SFXIN     IFEQ 'D'                                       CAC001
     C                     MOVE DCDP      WMCDP   10                      CAC001
     C*                                                                   CAC001
     C           DRAMT     IFGT CRAMT                                     CAC001
     C           EXRTN     ANDGT1                                         CAC001
     C           DRAMT     ORLT CRAMT                                     CAC001
     C           EXRTN     ANDLT1                                         CAC001
     C*                                                                   CAC001
     C           CRAMT     MULT WFXMR     IMAR   163H                     CAC001
     C*                                                                   CAC001
     C                     ELSE                                           CAC001
     C*                                                                   CAC001
     C           WFXMP     IFGT 0                                         CAC001
     C           EXRTN     SUB  WFXMR     WRATE  138                      CAC001
     C           CRAMT     DIV  WRATE     WWDAMT 163H                     CAC001
     C           WWDAMT    SUB  DRAMT     IMAR                            CAC001
     C                     ELSE                                           CAC001
     C           EXRTN     ADD  WFXMR     WRATE                           CAC001
     C           CRAMT     DIV  WRATE     WWDAMT 163H                     CAC001
     C           DRAMT     SUB  WWDAMT    IMAR                            CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C**  Margin amount is in Credit Currency                             CAC001
     C*                                                                   CAC001
     C           SFXIN     IFEQ 'C'                                       CAC001
     C                     MOVE CCDP      WMCDP                           CAC001
     C*                                                                   CAC001
     C           CRAMT     IFGT DRAMT                                     CAC001
     C           EXRTN     ANDGT1                                         CAC001
     C           CRAMT     ORLT DRAMT                                     CAC001
     C           EXRTN     ANDLT1                                         CAC001
     C*                                                                   CAC001
     C           DRAMT     MULT WFXMR     IMAR      H                     CAC001
     C*                                                                   CAC001
     C                     ELSE                                           CAC001
     C*                                                                   CAC001
     C           WFXMP     IFGT 0                                         CAC001
     C           EXRTN     ADD  WFXMR     WRATE                           CAC001
     C           DRAMT     DIV  WRATE     WWCAMT 163H                     CAC001
     C           WWCAMT    SUB  CRAMT     IMAR                            CAC001
     C                     ELSE                                           CAC001
     C           EXRTN     SUB  WFXMR     WRATE                           CAC001
     C           DRAMT     DIV  WRATE     WWCAMT 163H                     CAC001
     C           CRAMT     SUB  WWCAMT    IMAR                            CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   CAC001
     C**  Format margin amount for output to file                         CAC001
     C*                                                                   CAC001
     C                     SELEC                                          CAC001
     C           WMCDP     WHEQ 0                                         CAC001
     C           IMAR      MULT 1         MAMT                            CAC001
     C           WMCDP     WHEQ 1                                         CAC001
     C           IMAR      MULT 10        MAMT                            CAC001
     C           WMCDP     WHEQ 2                                         CAC001
     C           IMAR      MULT 100       MAMT                            CAC001
     C           WMCDP     WHEQ 3                                         CAC001
     C           IMAR      MULT 1000      MAMT                            CAC001
     C                     ENDSL                                          CAC001
     C*                                                                   CAC001
     C                     ENDSR                                          CAC001
     C*****************************************************************   CAC001
     C/EJECT                                                              CAC001
      *****************************************************************   CAC001
      *                                                               *   CAC001
      *       TITLE:BACK OFFICE AMOUNT EDITOR .                       *   CAC001
      *                                                               *   CAC001
      *       SUBROUTINE ZA0920 ACCEPTS AN AMOUNT FIELD (13N) AND     *   CAC001
      *       A FIELD (1N) SPECIFYING NO. OF DECIMALS AND WITH THIS   *   CAC001
      *       CONVERTS THE AMOUNT INTO AN ALPHAMERIC FIELD (14A)      *   CAC001
      *       WITH THE REQUIRED DECIMAL PLACE.                        *   CAC001
      *                                                               *   CAC001
      *                                                               *   CAC001
      * INPUT  :@@AMTW AMOUNT      FORMAT(13N)                        *   CAC001
      *         @@QECN DECIMAL NO. FORMAT(1N)                         *   CAC001
      *                                                               *   CAC001
      * OUTPUT :@@AMTD AMOUNT WITH DECIMAL FORMAT(14A)                *   CAC001
      *                                                               *   CAC001
      * USES :  @@AMTW AMOUNT FIELD PASSED                            *   CAC001
      *         @@QECN NO. OF DECIMAL FIELD                           *   CAC001
      *         @@QECW POSITION ON ARRAY @Z  FOR A DECIMAL POINT      *   CAC001
      *         @@SIG  POSITION ON ARRAY THAT CANNOT BE BLANK         *   CAC001
      *         @@Z    INDEX FOR ARRAY @Z                             *   CAC001
      *         @@Q    INDEX FOR ARRAY @Q                             *   CAC001
      *         @@SWT  SWITCH SAYING ZERO HAS BEEN SUPPRESSED         *   CAC001
      *         @@SWT1 SWITCH SAYING ZERO SUPPRESSION OVER            *   CAC001
      *                                                               *   CAC001
      * ARRAYS:  @Z ARRAY USED FOR DECIMAL ALIGNMENT                  *   CAC001
      *          @Q ARRAY USED FOR STORING AMOUNT PASSED TO THE SR    *   CAC001
      *                                                               *   CAC001
      *****************************************************************   CAC001
      *                                                               *   CAC001
     C           ZA0920    BEGSR                                          CAC001
      *                                                                   CAC001
      * INITIALIZATION                                                    CAC001
     C                     MOVE '0'       @@SWT1  1                       CAC001
      *                                                                   CAC001
      * FINDING WHERE DECIMAL POSITION IS                                 CAC001
      *                                                                   CAC001
     C           14        SUB  @@QECN    @@QECW  20                      CAC001
      *                                                                   CAC001
      * FINDING OUT MOST SIGNIFICANT POSITION                             CAC001
      *                                                                   CAC001
     C           @@QECW    SUB  1         @@SIG   20                      CAC001
     C                     MOVEA*BLANKS   @Z                              CAC001
     C                     Z-ADD1         @@Q     20                      CAC001
      *                                                                   CAC001
      * CHECK TO SEE IF NO.OF DECIMAL PLACES IS ZERO. IF ZERO             CAC001
      * THEN SIGNIFICANT POSITION IS 14 AND POSITION 1 IS BLANK           CAC001
     C           @@QECW    IFEQ 14                                        CAC001
     C                     Z-ADD14        @@SIG                           CAC001
     C                     Z-ADD2         @@Z     20                      CAC001
     C                     ELSE                                           CAC001
     C                     Z-ADD1         @@Z     20                      CAC001
     C                     END                                            CAC001
      *                                                                   CAC001
      * PERFORMING ACTUAL MOVEMENT                                        CAC001
     C           @@Z       DOWLT15                                        CAC001
     C           @@Q       ANDLT14                                        CAC001
      *                                                                   CAC001
      * SWITCH FOR ZERO SUPPRESSION                                       CAC001
     C                     MOVE '0'       @@SWT                           CAC001
      *                                                                   CAC001
      * IF ELEMENT OF ARRAY @Q  IS ZERO AND INDEX @@Z FOR ARRAY @Z        CAC001
      * IS *LT SIG.POSITION AND ALSO *LT DECIMAL POSITION THEN ZERO       CAC001
      * CAN BE SUPPRESSED AND ZERO SUPPRESSION SWITCH IS SETON            CAC001
      *                                                                   CAC001
     C           @Q,@@Q    IFEQ 0                                         CAC001
     C           @@SWT1    ANDEQ'0'                                       CAC001
     C           @@Z       ANDLT@@SIG                                     CAC001
     C           @@Z       ANDLT@@QECW                                    CAC001
     C                     MOVE *BLANK    @Z,@@Z                          CAC001
     C                     MOVE '1'       @@SWT   1                       CAC001
     C                     END                                            CAC001
      *                                                                   CAC001
      * IF INDEX @@Z FOR ARRAY @Z IS EQUAL TO THE DECIMAL POSITION        CAC001
      * AND NOT EQUAL TO THE LENGTH OF THE ARRAY @Z(14) THEN MOVE         CAC001
      * DECIMAL POSITION AND INCREMENT @@Z BY 1                           CAC001
      *                                                                   CAC001
     C           @@Z       IFEQ @@QECW                                    CAC001
     C           @@Z       ANDNE14                                        CAC001
     C                     MOVE '.'       @Z,@@Z                          CAC001
     C                     ADD  1         @@Z                             CAC001
     C                     END                                            CAC001
      *                                                                   CAC001
      * IF ZERO HAS NOT BEEN SUPPRESSED THEN MOVE ELEMENT FROM ARRAY      CAC001
      * @Q TO @Z.SETON ZERO SUPPRESSION SWITCH OVER(@@SWT1)               CAC001
     C           @@SWT     IFEQ '0'                                       CAC001
     C                     MOVE @Q,@@Q    @Z,@@Z                          CAC001
     C                     MOVE '1'       @@SWT1                          CAC001
     C                     END                                            CAC001
      *                                                                   CAC001
     C                     ADD  1         @@Q                             CAC001
     C                     ADD  1         @@Z                             CAC001
      *                                                                   CAC001
     C                     END                                            CAC001
      *                                                                   CAC001
      * Dummy moves for definition of work fields.                        CAC001
     C                     GOTO ZA0929                                    CAC001
     C                     MOVE @@QECN    @@QECN  10                      CAC001
      *                                                                   CAC001
     C           ZA0929    ENDSR                                          CAC001
      *****************************************************************   CAC001
     C/EJECT                                                              CAC001
     C*****************************************************************   050831
     C* OLPUPD   - Updates currency balances type 01 on OLPOS         *   050831
     C*                                                               *   050831
     C* Flds used  @INOUT - Indicates whetrer ccy balances I/O updated*   050831
     C*            @I     - Index used in setting up array of dates   *   050831
     C*            @IA    - Array of incoming currency balnces - OLPOS*   050831
     C*            @WK    - Work array used in altering balances      *   050831
     C*            @OA    - Array of outgoing currency balances -OLPOS*   050831
     C*            @EVENT - Event date used in updating OLPOS         *   050831
     C*            @WD    - Array of balance dates from OLPOS         *   050831
     C*            @K     - Array index MIDAS & DRS pay/rcv methods   *   050831
     C*            @AMNT  - Purchase/sale amount                      *   050831
     C*                                                               *   050831
     C*****************************************************************   050831
     C           OLPUPD    BEGSR                                          050831
     C*                                                                   050831
     C** Depending upon whether amount is to be addes to incoming or      050831
     C** outgoing amounts set up work array of balance                    050831
     C*                                                                   050831
     C           @INOUT    IFEQ 'I'                        B1             050831
     C           1         DO   16        @I      30       B*2            050831
     C                     Z-ADD@IA,@I    @WK,@I           **2            050831
     C                     END                             E*2            050831
     C                     ELSE                            X1             050831
     C           1         DO   16        @I               B*2            050831
     C                     Z-ADD@OA,@I    @WK,@I           **2            050831
     C                     END                             E*2            050831
     C                     END                             E1             050831
     C*                                                                   CAC001
     C**  Save value of *IN08 before using in the inline position         CAC001
     C**  coding below so as not to confuse with its usage in the         CAC001
     C**  display file.                                                   CAC001
     C*                                                                   CAC001
     C                     MOVEL*IN08     SAV08   1                       CAC001
     C*                                                                   050831
     C** Determine inline position balance to ba altered                  050831
     C*                                                                   050831
     C                     Z-ADD1         @I                              050831
     C           @EVENT    LOKUP@WD,@I                 4708               050831
     C*                                                                   050831
     C           *IN47     IFEQ '0'                                       050831
     C           *IN08     ANDEQ'0'                                       050831
     C           @EVENT    ANDLT@WD,1                                     050831
     C                     SETON                       47                 050831
     C                     END                                            050831
     C*                                                                   050831
     C** Add amount into correct balance if date found in array less      050831
     C** than or equal to event date                                      050831
     C*                                                                   050831
     C           *IN47     IFEQ '0'                        B1             050831
     C           *IN08     ANDEQ'0'                        *1             050831
     C*                                                                   CAC001
     C**  Restore *IN08 for its DSPF usage.                               CAC001
     C*                                                                   CAC001
     C                     MOVELSAV08     *IN08   1                       CAC001
     C                     GOTO #OLP1                      *1             050831
     C                     END                             E1             050831
     C*                                                                   CAC001
     C**  Restore *IN08 for its DSPF usage.                               CAC001
     C*                                                                   CAC001
     C                     MOVELSAV08     *IN08   1                       CAC001
     C                     ADD  @AMNT     @WK,@I                          050831
     C*                                                                   050831
     C** Move updated work array back into arrays of incoming /           050831
     C** balances.                                                        050831
     C*                                                                   050831
     C           @INOUT    IFEQ 'I'                        B1             050831
     C           1         DO   16        @I               B*2            050831
     C                     Z-ADD@WK,@I    @IA,@I           **2            050831
     C                     END                             E*2            050831
     C                     ELSE                            X1             050831
     C           1         DO   16        @I      30       B*2            050831
     C                     Z-ADD@WK,@I    @OA,@I           **2            050831
     C                     END                             E*2            050831
     C                     END                             E1             050831
     C*                                                                   050831
     C** Update online positions                                          050831
     C*                                                                   050831
     C           #OLP1     TAG                                            050831
     C                     UPDATOLPOSOAF                                  050831
     C*                                                                   050831
     C           #OLP      ENDSR                                          050831
1390 C********************************************************************
1391 C*    SUBR TO CHECK THAT EXRT IS WITHIN 10% OF SPOT
1392 C*    SUBROUTINE CALLED WHEN ONE CCY IS BASE CURRENCY
1393 C*
1394 C***  USE EXRT OR 1/EXRT DEPENDING ON WHICH WAS USED IN THE
1395 C***    IN THE VALIDATION OF THE TWO AMOUNTS-JUST PRIOR TO FAMTV TAG
1396 C*
1397 C           RATCH     BEGSR                           *** RATCH ***
1398 C*
1399 C           DSPOT     COMP 1                        47
1400 C   47                Z-ADDCSPOT     WKRAT  138
1401 C***47******          Z-ADDCMDIN     SMDIN   10       * SPOT M/D IND S01194
1401 C   47                MOVE CMDIN     SMDIN   1        * SPOT M/D IND S01194
1402 C***47******          Z-ADDPCMDIN    PMDIN   10       * PROGRAM M/D  S01194
1402 C   47                MOVE PCMDIN    PMDIN   1        * PROGRAM M/D  S01194
1403 C           CSPOT     COMP 1                        47
1404 C   47                Z-ADDDSPOT     WKRAT
1405 C***47******          Z-ADDDMDIN     SMDIN   10       * SPOT M/D IND S01194
1405 C   47                MOVE DMDIN     SMDIN   1        * SPOT M/D IND S01194
1406 C***47******          Z-ADDPDMDIN    PMDIN   10       *PROGRAM M/D   S01194
1406 C   47                MOVE PDMDIN    PMDIN   1        *PROGRAM M/D   S01194
1407 C*
1408 C***  CHECK THAT BOTH THE SPOT M/D IS EQUAL TO PROGRAM M/D
1409 C*
1410 C           PMDIN     COMP SMDIN                    47* 47 EQUAL
1411 C  N47      1         DIV  WKRAT     WKRAT
1412 C           WKRAT     MULT 1.1       PLUS10 138
1413 C           WKRAT     MULT 0.9       SUB10  138
     C/COPY WNCPYSRC,RE0150C006
1414 C           EXRTN     COMP PLUS10               76
1415 C  N76      EXRTN     COMP SUB10                  76
1416 C  N76                GOTO ENDRAT
1168 C           S         IFNE 0                                         E11643
1168 C           ERCD,S    IFNE ' 120'                                    E11643
1417 C   76      S         ADD  1         S
1418 C   76                MOVE '120'     ERCD,S           OUTSIDE BASE
1171 C                     END                                            E11643
1171 C                     END                                            E11643
     C           S         IFEQ 0                                         E16124
     C   76      S         ADD  1         S                               E16124
     C   76                MOVE '120'     ERCD,S           OUTSIDE BASE   E16124
     C                     END                                            E16124
1419 C*
1420 C***  FLASH AMOUNT FIELDS ALSO IF ERROR
1421 C*
1422 C   76                SETON                     6573
1423 C*
1424 C           ENDRAT    ENDSR
1425 C********************************************************************
1438 C**
1440 C**  ACNCHN SUBR. TO RANDOM ACCESS ACCOUNTS MASTER FILE
1441 C**  - A/C MUST EXIST AND BE OPEN
1442 C           ACNCHN    BEGSR                           * S01111
1443 C**
     C                     MOVE ' '       ATYP                            S01111
1444 C                     SETOF                     1547
     C                     SETOF                     36                   E16125
1445 C           ACNKEY    CHAINACCNT                47
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0150CCP3                                           S01408
     C*                                                                   S01408
1446 C**                                                                  E13304
1446 C**   IF A/C DOES NOT EXIST AND ERROR CODE '128' HAS NOT             E13304
1446 C**   ALREADY BEEN OUTPUT TO THE ARRAY THEN OUTPUT IT.               E13304
1446 C**N15******S         ADD  1         S                               E13304
1447 C**N15******          MOVE '128'     ERCD,S                          E13304
1447 C**N15******ACNKEY    COMP DRNKEY                   62         E11725E13304
1447 C**N15N62***          SETON                         68         E11725E13304
1446 C**                                                                  E13304
1446 C           *IN15     IFEQ '0'                                       E13304
     C           *IN36     ANDEQ'0'                                       E16125
     C           *IN84     ANDEQ'0'                                       E16125
1446 C           WKCOD     IFEQ '   '                                     E13304
1446 C                     MOVE '128'     WKCOD                           E13304
1446 C           S         ADD  1         S                               E13304
1447 C                     MOVE '128'     ERCD,S                          E13304
1446 C                     END                                            E13304
1446 C                     END                                            E13304
1446 C**                                                                  E13304
1446 C**   SET ON INDICATOR TO SHOW DEBIT A/C NUMBER IN REVERSE           E13304
1446 C**   IMAGE ONLY IF A/C DOES NOT EXIST AND THIS INDICATOR IS         E13304
1446 C**   NOT ALREADY ON.                                                E13304
1446 C           *IN15     IFEQ '0'                                       E13304
 446 C           *IN62     IFEQ '0'                                       E13304
1447 C           ACNKEY    IFEQ DRNKEY                                    E13304
1447 C                     SETON                         62               E13304
1446 C                     END                                            E13304
1446 C                     END                                            E13304
1446 C                     END                                            E13304
1446 C**                                                                  E13304
1446 C*****IF*CREDIT*A/C*DOES*NOT*EXIST*SET*ON*INDICATOR*TO*SHOW****E13304E13304
1446 C**  IF CREDIT A/C IS A CLOSED ACCOUNT SET ON INDICATOR TO SHOW      E17935
1446 C**   CREDIT A/C NUMBER IN REVERSE IMAGE.                            E13304
1446 C           *IN15     IFEQ '0'                                       E13304
1447 C********** ACNKEY    COMP CRNKEY                   68         E13304LN0085
 446 C           *IN68     IFEQ '0'                                       LN0085
1447 C           ACNKEY    IFEQ CRNKEY                                    LN0085
1447 C                     SETON                         68               LN0085
1446 C                     END                                            LN0085
1446 C                     END                                            LN0085
1446 C                     END                                            E13304
1448 C**N36*15***S         ADD  1         S                               E16125
1449 C**N36*15***          MOVE '086'     ERCD,S                          E16125
1450 C**
1448 C   36      S         ADD  1         S                               E16125
1449 C   36                MOVE '086'     ERCD,S                          E16125
     C**
     C                     SETOF                     84                   E16125
1451 C                     ENDSR
1452 C********************************************************************
1466 C**
1467 C********************************************************************
1468 C***********                                                         S01194
1469 C****TABCHN*SR.*TO*RANDOM ACCESS TABLE FILE                          S01194
1470 C****AND*TO*CHECK*THAT*THE CCY IS A DEALING CCY                      S01194
1471 C***********                                                         S01194
1472 C*SR********TABCHN    BEGSR                           ** TABCHN      S01194
1473 C***********                                                         S01194
1474 C****RESET*INDICATORS                                                S01194
1475 C***********          SETOF                     050607               S01194
1476 C***********          SETOF                     08                   S01194
1477 C***********TBKEY     CHAINTABLE                99                   S01194
1478 C***********                                                         S01194
1479 C****CHECK*FOR*DEALING CCY                                           S01194
1480 C***07******DLCY      COMP 'N'                      47               S01194
1481 C***07*47***S         ADD  1         S                               S01194
1482 C***07*47***          MOVE '131'     ERCD,S                    S01111S01194
1483 C***********          ENDSR                                          S01194
1484 C********************************************************************
1485 C**
1486 C********************************************************************
1487 C**
1488 C**  EXCPTN SR. TO PERFORM EXCEPTION TIME OUTPUT AND
1489 C**  RESET EXCEPTION CONTROL INDICATORS
1490 C**
1491 CSR         EXCPTN    BEGSR                           ** EXCPTN
1492 C**
      *                                                                                       CRE019
      ** Update Presented Cheque table when updating cust exchange file                       CRE019
      *                                                                                       CRE019
     C           *IN89     IFEQ *ON                                                           CRE019
     C           *IN02     ANDEQ*ON                                                           CRE019
     C           WCHQOK    ANDEQ'Y'                                                           CRE019
     C           CRE019    ANDEQ'Y'                                                           CRE019
     C                     EXSR SRICHQ                                                        CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C           *IN89     IFEQ *ON                                                           CRE019
     C           *IN17     ANDEQ*ON                                                           CRE019
     C           *IN03     ANDEQ*ON                                                           CRE019
     C********** WCHQOK    ANDEQ'Y'                                                   CRE019 BUG2488
     C           CRE019    ANDEQ'Y'                                                           CRE019
     C           DCHN      ANDNE*ZEROS                                                CRE019 BUG3954
     C                     MOVE *IN85     WIN85   1                                           CRE019
     C                     MOVE 'Y'       WOKDEL  1                                           CRE019
     C                     MOVELDCHN      WDCHN   8                                           CRE019
      *                                                                                       CRE019
      ** Access TTRANL6 to check if other transaction uses the cheque                         CRE019
      *                                                                                       CRE019
     C           WDCHN     SETLLTTRANL6                                                       CRE019
     C           WDCHN     READETTRANL6                  85                                   CRE019
      *                                                                                       CRE019
     C           *IN85     DOWEQ*OFF                                                          CRE019
      *                                                                                       CRE019
     C********** TAACNO    IFNE *BLANKS                                               CRE019 BUG2488
     C**********           MOVE TAACNO    TACNO                                       CRE019 BUG2488
     C**********           ENDIF                                                      CRE019 BUG2488
      *                                                                                       CRE019
     C                     MOVELTACOD     WACOD  10                                           CRE019
     C           DRAN      IFEQ TACNO                                                         CRE019
     C           DRAN      OREQ *ZEROS                                                        CRE019
     C           KACNO     ANDEQTACNO                                                         CRE019
      *                                                                                       CRE019
      ** Check if other transaction w/in CUSEX is using cheque no.                            CRE019
      *                                                                                       CRE019
     C           IPDN      IFEQ TIPDN                                                         CRE019
     C                     MOVE *BLANKS   TIPDN                                               CRE019
     C           WDCHN     READETTRANL6                  85                                   CRE019
     C                     ELSE                                                               CRE019
     C                     MOVE 'N'       WOKDEL  1                                           CRE019
     C**********           MOVE *ON       *IN85                                        CRE019 CAAA03
     C**********           MOVE *ON       *IN58                                       CAAA03 BUG3954
     C                     MOVE *ON       *IN85                                              BUG3954
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     ELSE                                                               CRE019
     C           WDCHN     READETTRANL6                  85                                   CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     ENDDO                                                              CRE019
      *                                                                                      BUG2488
     C           WOKDEL    IFEQ 'Y'                                                          BUG2488
     C                     MOVE *OFF      *IN85                                              BUG2488
     C           *LOVAL    SETLLSDTELDL1                                                     BUG2488
     C                     READ SDTELDL1                 85                                  BUG2488
     C           WOKDEL    DOWEQ'Y'                                                          BUG2488
     C           *IN85     ANDEQ*OFF                                                         BUG2488
      *                                                                                      BUG2488
      ** If not the first time, delete previous overrides                                    BUG2488
      *                                                                                      BUG2488
     C           @CMD      IFNE *BLANKS                                                      BUG2488
     C                     MOVEL*BLANKS   @CMD                                               BUG2488
     C                     MOVEL@TXT,1    @CMD                                               BUG2488
     C                     CALL 'QCMDEXC'                                                    BUG2488
     C                     PARM           @CMD                                               BUG2488
     C                     PARM 80        @LEN   155                                         BUG2488
     C                     CLOSETTRANL7                                                      BUG2488
     C                     ENDIF                                                             BUG2488
      *                                                                                      BUG2488
      ** Perform override to LF/TTRANL7                                                      BUG2488
      *                                                                                      BUG2488
     C                     MOVEL*BLANKS   @CMD                                               BUG2488
     C                     MOVEL@TXT,2    @CMD                                               BUG2488
     C                     MOVEL'T'       @BRI                                               BUG2488
     C                     MOVELFRTLID    @BID                                               BUG2488
     C                     CALL 'QCMDEXC'                                                    BUG2488
     C                     PARM           @CMD                                               BUG2488
     C                     PARM 80        @LEN                                               BUG2488
      *                                                                                      BUG2488
     C                     OPEN TTRANL7                                                      BUG2488
     C           *LOVAL    SETLLTTRANL7                                                      BUG2488
     C           WDCHN     CHAINTTRANL7              70                                      BUG2488
     C           *IN70     IFEQ *OFF                                                         BUG2488
     C                     MOVE 'N'       WOKDEL                                             BUG2488
     C                     ENDIF                                                             BUG2488
      *                                                                                      BUG2488
     C                     READ SDTELDL1                 85                                  BUG2488
      *                                                                                      BUG2488
     C                     ENDDO                                                             BUG2488
     C                     ENDIF                                                             BUG2488
      *                                                                                       CRE019
      ** Allow delete if current transaction is the only transaction                          CRE019
      ** using the cheque                                                                     CRE019
      *                                                                                       CRE019
     C           WOKDEL    IFEQ 'Y'                                                           CRE019
     C                     EXSR SRDCHQ                                                        CRE019
     C                     ENDIF                                                              CRE019
     C                     MOVE WIN85     *IN85                                               CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
1493 C                     EXCPT
      *                                                                                       CRE020
      ** Handle the advice index of this transaction if CRE020 is enabled.                    CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C                     EXSR SRIDXT                                                        CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C/COPY WNCPYSRC,RE0150C040
1494 C**
1495 C                     SETOF                     428889
1498 C                     ENDSR
      *****************************************************************                       CRE019
      *                                                               *                       CRE019
      * SRICHQ - Update Presented Cheque Table                        *                       CRE019
      *                                                               *                       CRE019
      *****************************************************************                       CRE019
     C           SRICHQ    BEGSR                                                              CRE019
      *                                                                                       CRE019
      ** Generate Next Transaction number                                                     CRE019
      *                                                                                       CRE019
     C                     EXSR ZTNLU1                                                        CRE019
      *                                                                                       CRE019
     C                     MOVE 'N'       WINS    1                                           CRE019
      *                                                                                       CRE019
     C           WRANGE    IFEQ 'Y'                                                           CRE019
     C           WNLIVE    ANDNE'Y'                                                           CRE019
     C                     MOVE 'D'       RECID                                               CRE019
     C                     Z-ADDKACNO     ACNO                                                CRE019
     C                     Z-ADD0         GCQI                                                CRE019
     C                     Z-ADDKSCQN     SCQN                                                CRE019
     C                     Z-ADD1         NOCQ                                                CRE019
     C                     Z-ADDKSCQN     ECQN                                                CRE019
     C                     Z-ADDDRVD      DISS                                                CRE019
     C                     Z-ADDDRVD      DCOL                                                CRE019
     C                     MOVE A8BRCD    BRCA                                                CRE019
     C                     MOVE 'I'       CHTP                                                CRE019
     C                     Z-ADD0         CHAM                                                CRE019
     C                     Z-ADD0         CHAC                                                CRE019
     C                     Z-ADD0         CHTT                                                CRE019
     C                     MOVE 'Y'       OUTR                                                CRE019
     C                     MOVE 'Y'       WINS                                                CRE019
      *                                                                                       CRE019
      ** Set bit of for all the 160 cheque presented array                                    CRE019
      *                                                                                       CRE019
     C                     Z-ADD1         W2      20                                          CRE019
      *                                                                                       CRE019
     C           W2        DOWLE20                                                            CRE019
     C                     BITON'01234567'WAR,W2                                              CRE019
     C                     BITOF'01234567'WAR,W2                                              CRE019
     C                     ADD  1         W2                                                  CRE019
     C                     ENDDO                                                              CRE019
      *                                                                                       CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
      ** Update fields TNLU, LCD and CQPS for both update and write                           CRE019
      *                                                                                       CRE019
     C                     Z-ADDNATN      TNLU                                                CRE019
     C                     Z-ADDRUND      LCD                                                 CRE019
      *                                                                                       CRE019
      ** Set on bits  of CQPS to specify cheque presented                                     CRE019
      *                                                                                       CRE019
     C                     Z-ADDKSCQN     WSCQN   80                                          CRE019
     C           WSCQN     SUB  SCQN      WOFSET  80                                          CRE019
     C           WOFSET    DIV  8         WI      20                                          CRE019
     C                     MVR            WBITN   10                                          CRE019
     C                     ADD  1         WI                                                  CRE019
      *                                                                                       CRE019
     C                     MOVEACQPS      WAR                                                 CRE019
      *                                                                                       CRE019
     C           WBITN     IFEQ 0                                                             CRE019
     C                     BITON'0'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 1                                                             CRE019
     C                     BITON'1'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 2                                                             CRE019
     C                     BITON'2'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 3                                                             CRE019
     C                     BITON'3'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 4                                                             CRE019
     C                     BITON'4'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 5                                                             CRE019
     C                     BITON'5'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 6                                                             CRE019
     C                     BITON'6'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 7                                                             CRE019
     C                     BITON'7'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C                     MOVEAWAR       CQPS                                                CRE019
      *                                                                                       CRE019
      ** If record does not exist, write a new one and update trailer                         CRE019
      ** file, else, update current record on CHQBKPD                                         CRE019
      *                                                                                       CRE019
     C           WINS      IFEQ 'Y'                                                           CRE019
     C                     Z-ADDRUND      OEDT                                                CRE019
     C                     WRITECHQBKPDF                                                      CRE019
     C                     EXSR SRUTRL                                                        CRE019
     C                     ELSE                                                               CRE019
     C           WDUP      IFEQ 'N'                                                           CRE019
     C           RECID     IFEQ '*'                                                           CRE019
     C                     MOVE 'Y'       WINS                                                CRE019
     C                     ENDIF                                                              CRE019
     C                     MOVE 'D'       RECID                                               CRE019
     C                     MOVE 'A'       CHTP                                                CRE019
     C                     UPDATCHQBKPDF                                                      CRE019
     C                     EXSR SRUTRL                                                        CRE019
     C                     ENDIF                                                              CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
      ** Set Duplicate and Out of Range Cheque Flags accordingly                              CRE019
      *                                                                                       CRE019
     C                     MOVE WDUP      DUPC                                                CRE019
     C                     MOVE WRANGE    OUTR                                                CRE019
      *                                                                                       CRE019
     C                     ENDSR                                                              CRE019
      *****************************************************************                       CRE019
      *                                                               *                       CRE019
      * SRDCHQ - Remove cheque number from the list of presented      *                       CRE019
      *          Cheques                                              *                       CRE019
      *                                                               *                       CRE019
      *****************************************************************                       CRE019
     C           SRDCHQ    BEGSR                                                              CRE019
      *                                                                                       CRE019
      ** Generate Next Transaction number                                                     CRE019
      *                                                                                       CRE019
     C                     EXSR ZTNLU1                                                        CRE019
     C                     Z-ADDNATN      TNLU                                                CRE019
     C                     MOVE BJRDNB    LCD                                                 CRE019
     C                     MOVE 'N'       WDEL    1                                           CRE019
      *                                                                                       CRE019
      ** Access cheque book files                                                             CRE019
      *                                                                                       CRE019
     C           DRAC      IFNE *ZEROS                                                        CRE019
     C                     MOVE DRAC      KACNO                                               CRE019
     C                     ELSE                                                               CRE019
      *                                                                                       CRE019
      * Chain to ACCNTAB to get retail number                                                 CRE019
      *                                                                                       CRE019
     C                     MOVE CUSN      XCUS                                                CRE019
     C                     MOVE CCYD      XCCY                                                CRE019
     C                     MOVE ACDE      XCOD                                                CRE019
     C                     MOVE ASNC      XSEQ                                                CRE019
     C                     MOVE BRCA      XBRC                                                CRE019
      *                                                                                       CRE019
     C           ACNKEY    CHAINACCNT                47                                       CRE019
     C           *IN47     IFEQ *ON                                                           CRE019
     C           *LOCK     IN   LDA                                                           CRE019
     C                     MOVEL'ACCNT'   DBFILE                                              CRE019
     C                     MOVELACNKEY    DBKEY                                               CRE019
     C                     Z-ADD3         DBASE                                               CRE019
     C                     MOVE *ON       *INKC                                               CRE019
     C                     OUT  LDA                                                           CRE019
     C                     EXSR DBSR                                                          CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     Z-ADDRETNO     KACNO                                               CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     Z-ADD0         KGCIN                                               CRE019
     C                     Z-ADDDCHN      KSCQN                                               CRE019
      *                                                                                       CRE019
     C           KCHQBK    SETGTCHQBKPDF                                                      CRE019
     C           KCHQB2    REDPECHQBKPDF                 66                                   CRE019
      *                                                                                       CRE019
      ** If out of range flag is 'Y', record can be deleted                                   CRE019
      *                                                                                       CRE019
     C           OUTR      IFEQ 'Y'                                                           CRE019
     C                     MOVE 'Y'       WDEL                                                CRE019
     C                     DELETCHQBKPDF                                                      CRE019
     C                     EXSR SRUTRL                                                        CRE019
      *                                                                                       CRE019
      ** Else, ammend such that the cheque is not yet presented                               CRE019
      *                                                                                       CRE019
     C                     ELSE                                                               CRE019
      *                                                                                       CRE019
      ** Set on bits  of CQPS to specify cheque presented                                     CRE019
      *                                                                                       CRE019
     C                     Z-ADDKSCQN     WSCQN                                               CRE019
     C           WSCQN     SUB  SCQN      WOFSET                                              CRE019
     C           WOFSET    DIV  8         WI                                                  CRE019
     C                     MVR            WBITN                                               CRE019
     C                     ADD  1         WI                                                  CRE019
      *                                                                                       CRE019
     C                     MOVEACQPS      WAR                                                 CRE019
     C           WBITN     IFEQ 0                                                             CRE019
     C                     BITOF'0'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 1                                                             CRE019
     C                     BITOF'1'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 2                                                             CRE019
     C                     BITOF'2'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 3                                                             CRE019
     C                     BITOF'3'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 4                                                             CRE019
     C                     BITOF'4'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 5                                                             CRE019
     C                     BITOF'5'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 6                                                             CRE019
     C                     BITOF'6'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C           WBITN     IFEQ 7                                                             CRE019
     C                     BITOF'7'       WAR,WI                                              CRE019
     C                     ENDIF                                                              CRE019
     C                     MOVEAWAR       CQPS                                                CRE019
      *                                                                                       CRE019
     C                     MOVE 'A'       CHTP                                                CRE019
     C                     UPDATCHQBKPDF                                                      CRE019
      *                                                                                       CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     ENDSR                                                              CRE019
      *****************************************************************                       CRE019
      *                                                               *                       CRE019
      *****************************************************************                       CRE019
      *                                                               *                       CRE019
      * SRUTRL - Update Control Trailer Record                        *                       CRE019
      *                                                               *                       CRE019
      *****************************************************************                       CRE019
     C           SRUTRL    BEGSR                                                              CRE019
      *                                                                                       CRE019
     C                     MOVE *OFF      *IN70                                               CRE019
      *                                                                                       CRE019
     C           KCHQTR    KLIST                                                              CRE019
     C                     KFLD           KACNTR 100                                          CRE019
     C                     KFLD           KGCITR  10                                          CRE019
     C                     KFLD           KSQNTR  80                                          CRE019
      *                                                                                       CRE019
     C                     MOVE *ALL'9'   KACNTR                                              CRE019
     C                     MOVE '9'       KGCITR                                              CRE019
     C                     MOVE *ALL'9'   KSQNTR                                              CRE019
     C           KCHQTR    CHAINCHQBKPTF             70                                       CRE019
      *                                                                                       CRE019
      **  DB Error if Trailer file is empty                                                   CRE019
      *                                                                                       CRE019
     C           *IN70     IFEQ *ON                                                           CRE019
     C           *LOCK     IN   LDA                                                           CRE019
     C                     MOVEL'CHQBKPTF'DBFILE                                              CRE019
     C                     MOVEL*ALL'9'   WALL9  19                                           CRE019
     C                     MOVELWALL9     DBKEY                                               CRE019
     C                     Z-ADD2         DBASE                                               CRE019
     C                     MOVE *ON       *INKC                                               CRE019
     C                     OUT  LDA                                                           CRE019
     C                     EXSR DBSR                                                          CRE019
     C                     ELSE                                                               CRE019
      *                                                                                       CRE019
      ** Increase No. of records if action is insert                                          CRE019
      *                                                                                       CRE019
     C           WINS      IFEQ 'Y'                                                           CRE019
     C                     ADD  1         NORE                                                CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
      ** Decrease No. of records if action is delete                                          CRE019
      *                                                                                       CRE019
     C           WDEL      IFEQ 'Y'                                                           CRE019
     C                     SUB  1         NORE                                                CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     MOVE 'N'       WINS                                                CRE019
     C                     MOVE 'N'       WDEL                                                CRE019
      *                                                                                       CRE019
     C                     MOVE BJRDNB    LCD                                                 CRE019
     C                     MOVEL'A'       CHTP                                                CRE019
     C                     Z-ADDNATN      TNLU                                                CRE019
     C                     UPDATCHQBKPTF                                                      CRE019
      *                                                                                       CRE019
     C                     ENDIF                                                              CRE019
      *                                                                                       CRE019
     C                     ENDSR                                                              CRE019
      *****************************************************************                       CRE019
      *                                                               *                       CRE019
      * SRERRM - Subroutine to get error message                      *                       CRE019
      *                                                               *                       CRE019
      *****************************************************************                       CRE019
     C           SRERRM    BEGSR                                                              CRE019
      *                                                                                       CRE019
     C                     CALL 'SDRTVTXT'                                                    CRE019
     C                     PARM WERMSG    WERMSG  7                                           CRE019
     C                     PARM WCMSGF    WMSGF  10                                           CRE019
     C                     PARM *BLANKS   WMSDTA132                                           CRE019
      *                                                                                       CRE019
     C                     MOVELWMSDTA    ERMSG1                                              CRE019
     C                     MOVE *ON       *IN85                                               CRE019
      *                                                                                       CRE019
     C                     ENDSR                                                              CRE019
     C********************************************************************S01111
     C**                                                                  S01111
     C**  VALDAT SR. TO CHECK THAT VALUE DATE ENTERED IS                  S01111
     C**                                                                  S01111
     C**     (A) NOT BEFORE DATE A/C OPENED                               S01111
     C**     (B) NOT BEFORE BACK-VALUE LIMIT DATE                         S01111
     C**     (C) NOT BEFORE LAST INTEREST DAY IF INTEREST BEARING A/C     S01111
     C**                                                                  S01111
     C**                                                                  S01111
     C           VALDAT    BEGSR                           ** VALDAT      S01111
     C**                                                                  S01111
     C           ZDAYNO    IFGE DACO                       1              S01111
     C*                                                    *              S01111
     C*         BACK-VALUE LIMIT DATE                      *              S01111
     C                     Z-ADDBVLIMD    CHKDAT  50       *              S01111
     C*                                                    *              S01111
     C*         DETERMINE LAST INTEREST DATE IF ANY        *              S01111
     C                     Z-ADD0         LSTINT  50       *              S01111
     C*                                                    *              S01111
     C           DRIF      IFNE ' '                        * 2            S01111
     C                     Z-ADDLDID      LSTINT           * *            S01111
     C                     END                             * 2            S01111
     C*                                                    *              S01111
     C           CRIF      IFNE ' '                        * 2            S01111
     C           LCID      ANDGTLSTINT                     * *            S01111
     C                     Z-ADDLCID      LSTINT           * *            S01111
     C                     END                             * 2            S01111
     C*                                                    *              S01111
     C*         LAST INTEREST DATE CHECK                   *              S01111
     C           LSTINT    IFGT 0                          * 2            S01111
     C           LSTINT    ANDLTCHKDAT                     * *            S01111
     C                     Z-ADDLSTINT    CHKDAT           * *            S01111
     C                     END                             * 2            S01111
     C*                                                    *              S01111
     C*         ACCEPTABLE RETAIL VALUE DATE               *              S01111
     C           ZDAYNO    IFGE CHKDAT                     * 2            S01111
     C                     Z-ADDZDAYNO    VALUDT           * *            S01111
     C                     END                             * 2            S01111
      *                                                                                      BUG7274
      ** Send warning message if value date falls on holiday.                                BUG7274
      *                                                                                      BUG7274
     C                     MOVE 'N'       WVDHOL  1                                          BUG7274
     C                     MOVE BJLCCY    ZCCY                                               BUG7274
     C                     MOVE 'W'       ZIND                                               BUG7274
     C                     EXSR ZCHKH                                                        BUG7274
      *                                                                                      BUG7274
     C           ZIND      IFEQ 'H'                                                          BUG7274
     C           WARN0     ANDNE'Y'                                                          BUG7274
     C                     MOVEL'USR2410' WERMSG                                             BUG7274
     C                     EXSR SRERRM                                                       BUG7274
     C                     MOVE 'Y'       WARN0   1                                          BUG7274
     C                     MOVE 'Y'       WVDHOL                                             BUG7274
     C                     MOVE '0'       *IN85                                              BUG7274
     C                     MOVE '1'       *IN58                                              BUG7274
     C                     ENDIF
     C                     END                             1              S01111
     C*                                                                   S01111
     C                     ENDSR                                          S01111
     C*                                                                   S01111
     C********************************************************************S01111
     C**                                                                  S01111
1499 C********************************************************************
1512 C**  DBERR SR TO SET INDICATORS TO RELEASE FILES
1513 C**
1514 C*R*********DBERR     BEGSR                           ** DBERR       S01413
1515 C**
1518 C***46******          SETON                     42                   S01413
1519 C***********          EXSR EXCPTN                                    S01413
1518 C***********          SETON                     LR                   S01413
1520 C**
1521 C***********          ENDSR                                          S01413
1522 C**
1523 C********************************************************************
     C*                                                                   E41812
     C**  NOSTAC SR. TO UPDATE RSACMTPD FOR NOSTRO A/CS.                  E41812
     C**             AND PROJECTED NOSTRO BALANCES.                       E41808
     C*                                                                   E41812
     C           NOSTAC    BEGSR                           ** NOSTAC      E41812
     C*                                                                   E41808
     C**  ACCESS NOSTROS DETAILS FOR NOSTRO CODE                          E41808
     C*                                                                   E41808
     C                     MOVE *BLANKS   @KEYE                        E  E41808
     C                     MOVE *BLANKS   @KEYG                        G  E41808
     C                     MOVE *BLANKS   @KEYH                        H  E41808
     C*                                                                   E41808
     C           *IN02     IFEQ '1'                        **B001         E41812
     C*                                                                   E41808
     C           TYPE      IFEQ 'D'                        **B001         E41808
     C                     MOVE DRCNUM    @KEYA                        A  E41808
     C                     MOVE DRCCY     @KEYB                        B  E41808
     C                     MOVE DRACOD    @KEYC                        C  E41808
     C                     MOVE DRACSQ    @KEYD                        D  E41808
     C                     MOVE DRBRCD    @KEYF                        F  E41808
     C                     ELSE                            **X001         E41808
     C                     MOVE CRCNUM    @KEYA                        A  E41808
     C                     MOVE CRCCY     @KEYB                        B  E41808
     C                     MOVE CRACOD    @KEYC                        C  E41808
     C                     MOVE CRACSQ    @KEYD                        D  E41808
     C                     MOVE CRBRCD    @KEYF                        F  E41808
     C                     END                             **E001         E41808
     C*                                                                   E41808
     C                     ELSE                            **X001         E41808
     C*                                                                   E41808
     C           TYPE      IFEQ 'D'                        **B001         E41808
     C                     MOVE DCUS      @KEYA                        A  E41808
     C                     MOVE DACY      @KEYB                        B  E41808
     C                     MOVE DCOD      @KEYC                        C  E41808
     C                     MOVE DACS      @KEYD                        D  E41808
     C                     MOVE BRCDD     @KEYF                        F  E41808
     C                     ELSE                            **X001         E41808
     C                     MOVE CCUS      @KEYA                        A  E41808
     C                     MOVE CACY      @KEYB                        B  E41808
     C                     MOVE CCOD      @KEYC                        C  E41808
     C                     MOVE CACS      @KEYD                        D  E41808
     C                     MOVE BRCDC     @KEYF                        F  E41808
     C                     END                             **E001         E41808
     C*                                                                   E41808
     C                     END                             **E001         E41808
     C*                                                                   E41808
     C                     CALL 'AONOSTR0'PLIST1                          E41808
     C           @RTCD     IFNE *BLANKS                                   E41808
     C           *LOCK     IN   LDA                                       S01413
     C***********          MOVE '1'       *INU7            *1       E41808S01413
     C***********          MOVE '1'       *INU8            *********E41808S01413
     C                     MOVEL'NOSTR'   DBFILE           * DBERROR 700  E41808
     C                     MOVEL*BLANKS   DBKEY            ***************E41808
     C                     MOVE '700'     DBASE            *1             E41808
     C***********          MOVE '1'       *INLR            *1       E41808S01413
     C                     MOVE '1'       *INKC            *1             E41808
     C                     OUT  LDA                                       S01413
     C***********          DUMP                            *1       E41808S01413
     C***********          GOTO ENDNO                      *1       E41808S01413
     C                     EXSR DBSR                                      S01413
     C                     END                             E1             E41808
     C*                                                                   E41808
     C** Chain to projected Nostro Balances file using currency/nostro    078610
     C*                                                                   078610
     C                     MOVE A7NONB    KEYPR                           E41808
     C                     MOVEL@KEYB     KEYPR   5                       E41808
     C*                                                                   E41808
     C           KEYPR     CHAINPRONO                99                   E41808
     C*                                                                   E41808
     C** If record not found, get Unallocated Nostro record instead       078610
     C*                                                                   078610
     C           *IN99     IFNE '0'                                       078610
     C                     MOVE '00'      KEYPR                           078610
     C           KEYPR     CHAINPRONO                99                   078610
     C                     END                                            078610
     C*                                                                   078610
     C           *IN99     IFNE '0'                                       E41808
     C           *LOCK     IN   LDA                                       S01413
     C***********          MOVE '1'       *INU7            *1       E41808S01413
     C***********          MOVE '1'       *INU8            *********E41808S01413
     C                     MOVEL'PRONO'   DBFILE           * DBERROR 701  E41808
     C                     MOVELKEYPR     DBKEY            ***************E41808
     C                     MOVE '701'     DBASE            *1             E41808
     C***********          MOVE '1'       *INLR            *1       E41808S01413
     C                     MOVE '1'       *INKC            *1             E41808
     C                     OUT  LDA                                       S01413
     C***********          DUMP                            *1       E41808S01413
     C***********          GOTO ENDNO                      *1       E41808S01413
     C                     EXSR DBSR                                      S01413
     C                     END                             E1             E41808
     C*                                                                   E41808
     C                     MOVE 'CE'      TRYP                            E41812
     C                     MOVE RUND      PTDT                            E41812
     C                     Z-ADD0         CQNR                            E41812
      *                                                                                       CAP205
      ** Set up Module and Movement Type fields                                               CAP205
      *                                                                                       CAP205
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVE 'RE'      CMOD                                                CAP205
     C                     MOVE 'S'       MTYP                                                CAP205
     C                     ENDIF                                                              CAP205
     C*                                                                   E41812
     C**  INSERT                                                          E41812
     C*                                                                   E41812
     C           *IN02     IFEQ '1'                        **B001         E41812
     C                     MOVE DOCN      TNMR                            E41812
     C*                                                                   E41812
     C**  DEBIT UPDATE                                                    E41812
     C*                                                                   E41812
     C           TYPE      IFEQ 'D'                        **B002         E41812
     C                     MOVE DNAR      NRTD                            E41812
     C                     MOVE DRCNUM    CUSN                            E41812
     C                     MOVE DRCCY     CCYD                            E41812
     C                     MOVE DRACOD    ACDE                            E41812
     C                     MOVE DRACSQ    ASNC                            E41812
     C                     MOVE DRBRCD    BRCA                            E41812
     C                     MOVE DRAMN0    MVAM                            E41812
     C           CHSGNO    IFEQ '+'                                       S01413
     C                     ADD  CHAMTO    MVAM                            S01413
     C                     ENDIF                                          S01413
     C                     MOVE DRVD      VUDT                            E41812
     C                     MOVE '0'       DORC                            E41812
     C           PRBAL1    ADD  MVAM      PRBAL1                          E41808
     C           PRBAL2    ADD  MVAM      PRBAL2                          E41808
     C           PRBAL3    ADD  MVAM      PRBAL3                          E41808
     C           PRBAL4    ADD  MVAM      PRBAL4                          E41808
     C           PRBAL5    ADD  MVAM      PRBAL5                          E41808
     C*                                                                   E41812
     C* ELSE IF CREDIT                                                    E41812
     C*                                                                   E41812
     C                     ELSE                            **X002         E41812
     C*                                                                   E41812
     C                     MOVE CNAR      NRTD                            E41812
     C                     MOVE CRCNUM    CUSN                            E41812
     C                     MOVE CRCCY     CCYD                            E41812
     C                     MOVE CRACOD    ACDE                            E41812
     C                     MOVE CRACSQ    ASNC                            E41812
     C                     MOVE CRBRCD    BRCA                            E41812
     C                     MOVE CRAMN0    MVAM                            E41812
     C           CHSGNO    IFEQ '-'                                       S01413
     C                     SUB  CHAMTO    MVAM                            S01413
     C                     ENDIF                                          S01413
     C                     MOVE CRVD      VUDT                            E41812
     C                     MOVE '1'       DORC                            E41812
     C           PRBAL1    SUB  MVAM      PRBAL1                          E41808
     C           PRBAL2    SUB  MVAM      PRBAL2                          E41808
     C           PRBAL3    SUB  MVAM      PRBAL3                          E41808
     C           PRBAL4    SUB  MVAM      PRBAL4                          E41808
     C           PRBAL5    SUB  MVAM      PRBAL5                          E41808
     C*                                                                   E41812
     C                     END                             **E002         E41812
     C*                                                                   E41812
     C* ELSE IF DELETION                                                  E41812
     C*                                                                   E41812
     C                     ELSE                            **X001         E41812
     C*                                                                   E41812
     C                     MOVE IPDN      TNMR                            E41812
     C*                                                                   E41812
     C* IF DEBIT                                                          E41812
     C*                                                                   E41812
     C           TYPE      IFEQ 'D'                        **B002         E41812
     C*                                                                   E41812
     C                     MOVE DNAR      NRTD                            E41812
     C                     MOVE DCUS      CUSN                            E41812
     C                     MOVE DACY      CCYD                            E41812
     C                     MOVE DCOD      ACDE                            E41812
     C                     MOVE DACS      ASNC                            E41812
     C                     MOVE BRCDD     BRCA                            E41812
     C                     MOVE DAMT      MVAM                            E41812
     C           CHSN      IFEQ '+'                                       S01413
     C                     ADD  CHAM      MVAM                            S01413
     C                     ENDIF                                          S01413
     C                     MOVE DRVD      VUDT                            E41812
     C                     MOVE '1'       DORC                            E41812
     C           PRBAL1    SUB  MVAM      PRBAL1                          E41808
     C           PRBAL2    SUB  MVAM      PRBAL2                          E41808
     C           PRBAL3    SUB  MVAM      PRBAL3                          E41808
     C           PRBAL4    SUB  MVAM      PRBAL4                          E41808
     C           PRBAL5    SUB  MVAM      PRBAL5                          E41808
     C*                                                                   E41812
     C* ELSE IF CREDIT                                                    E41812
     C*                                                                   E41812
     C                     ELSE                            **X002         E41812
     C*                                                                   E41812
     C                     MOVE CNAR      NRTD                            E41812
     C                     MOVE CCUS      CUSN                            E41812
     C                     MOVE CACY      CCYD                            E41812
     C                     MOVE CCOD      ACDE                            E41812
     C                     MOVE CACS      ASNC                            E41812
     C                     MOVE BRCDC     BRCA                            E41812
     C                     MOVE CAMT      MVAM                            E41812
     C           CHSN      IFEQ '-'                                       S01413
     C                     SUB  CHAM      MVAM                            S01413
     C                     ENDIF                                          S01413
     C                     MOVE CRVD      VUDT                            E41812
     C                     MOVE '0'       DORC                            E41812
     C           PRBAL1    ADD  MVAM      PRBAL1                          E41808
     C           PRBAL2    ADD  MVAM      PRBAL2                          E41808
     C           PRBAL3    ADD  MVAM      PRBAL3                          E41808
     C           PRBAL4    ADD  MVAM      PRBAL4                          E41808
     C           PRBAL5    ADD  MVAM      PRBAL5                          E41808
     C*                                                                   E41812
     C                     END                             **E002         E41812
     C*                                                                   E41812
     C                     END                             **E001         E41812
     C*                                                                   E41808
     C**   UPDATE PRONO BALANCE.                                          E41808
     C*                                                                   E41808
     C                     EXCPTUPDPRO                                    E41808
      *                                                                                       CRE020
      ** Handle the relevant text of this transaction if CRE020 is enabled.                   CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
      *                                                                                       CRE020
     C           TYPE      IFEQ 'D'                                                           CRE020
     C                     MOVEL'DEB'     FUND                                                CRE020
     C                     ELSE                                                               CRE020
     C                     MOVEL'CRE'     FUND                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C           *IN02     IFEQ *ON                                                           CRE020
     C                     MOVE 'R '      NRTD                                                CRE020
     C                     ELSE                                                               CRE020
     C                     MOVE 'R*'      NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
     C*                                                                   E41812
     C**   WRITE ACCOUNT MOVEMENT RECORD TO PF/RSACMTPD                   E41812
     C*                                                                   E41812
     C                     WRITERSACMTPO                                  E41812
     C/COPY WNCPYSRC,RE0150C051
     C*                                                                   E41808
     C           ENDNO     TAG                                            E41808
     C*                                                                   E41812
1557 C           EXITAC    ENDSR                                          E41812
1525 C********************************************************************
1526 C**  MEMCHN SR. TO RANDOM ACCESS MEMOS FILE BY RRN
1527 C**  AND UPDATE BALANCES IF RETAIL A/CS ARE INVOLVED
1528 C**
1529 CSR         MEMCHN    BEGSR                           ** MEMCHN
1530 C**
1531 C***********          SETOF                     14                   CCB002
1532 C***********MRRN      CHAINMEMOS                47                   CCB002
     C***47******                                                         CCB002
     C*ORN144*****          GOTO EXIT                                     CCB002
1533 C**
1534 C**   REVERSE SIGN FOR DELETE
1535 C**
1536 C** IF D/R A/C IS A RETAIL A/C - D/R AMOUNT IS ADDED TO
1537 C** GROSS&NET SHADOW BALANCES OF THE ACCOUNT
     C* IF FORWARD VALUED ONLY UPDATE THE CLEARED BALANCE (NETB)          E10485
1535 C**                                                                  S01154
1535 C* S01154: OUTPUT A RECORD TO NEW FILE 'RCAMTPD' WHENEVER            S01154
1535 C* A 'MEMOS' RECORD IS UPDATED                                       S01154
1535 C*                                                                   S01154
1535 C* SETUP FIELDS FOR 'RCAMTPD': TRANSACTION TYPE = 'CE'               S01154
1535 C*                             (ie. CUSTOMER EXCHANGE)               S01154
1535 C*                                                                   S01154
     C                     MOVE 'CE'      TRYP                            S01154
     C                     MOVE RUND      PTDT                            S01154
      *                                                                                       CAP205
      ** Set up Module and Movement Type fields                                               CAP205
      *                                                                                       CAP205
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVE 'RE'      CMOD                                                CAP205
     C                     MOVE 'S'       MTYP                                                CAP205
     C                     ENDIF                                                              CAP205
     C*                                                                   S01154
     C* IF INSERTED RECORD                                                S01154
     C*                                                                   S01154
     C           *IN02     IFEQ '1'                        **B001         S01154
     C*                                                                   S01154
     C                     MOVE DOCN      TNMR                            S01154
     C*                                                                   S01154
     C* IF DEBIT                                                          S01154
     C*                                                                   S01154
     C********** *IN54     IFEQ '0'                        **B002   S01154S01117
     C           IN54      IFEQ '0'                        **B002         S01117
     C*                                                                   S01154
     C                     MOVE DNAR      NRTD                            S01154
     C                     MOVE DRCNUM    CUSN                            S01154
     C                     MOVE DRCCY     CCYD                            S01154
     C                     MOVE DRACOD    ACDE                            S01154
     C                     MOVE DRACSQ    ASNC                            S01154
     C                     MOVE DRBRCD    BRCA                            S01117
     C                     MOVE DRVD      VUDT                            S01154
     C                     MOVE DRAMN0    MVAM                            S01154
     C           CHSGNO    IFEQ '+'                                       S01413
     C                     ADD  CHAMTO    MVAM                            S01413
     C                     ENDIF                                          S01413
     C                     MOVE '0'       DORC                            S01154
     C*                                                                   S01154
     C           DCHN      IFNE 0                          **B003         S01154
     C                     Z-ADDDCHN      CQNR    80                      S01154
     C                     ELSE                            **X003         S01154
     C                     Z-ADD0         CQNR                            S01154
     C                     END                             **E003         S01154
     C*                                                                   S01154
     C* ELSE IF CREDIT                                                    S01154
     C*                                                                   S01154
     C                     ELSE                            **X002         S01154
     C*                                                                   S01154
     C                     MOVE CNAR      NRTD                            S01154
     C                     MOVE CRCNUM    CUSN                            S01154
     C                     MOVE CRCCY     CCYD                            S01154
     C                     MOVE CRACOD    ACDE                            S01154
     C                     MOVE CRACSQ    ASNC                            S01154
     C                     MOVE CRBRCD    BRCA                            S01117
     C                     MOVE CRVD      VUDT                            S01154
     C                     MOVE CRAMN0    MVAM                            S01154
     C           CHSGNO    IFEQ '-'                                       S01413
     C                     SUB  CHAMTO    MVAM                            S01413
     C                     ENDIF                                          S01413
     C                     MOVE '1'       DORC                            S01154
     C                     Z-ADD0         CQNR                            S01154
     C*                                                                   S01154
     C                     END                             **E002         S01154
     C*                                                                   S01154
     C* ELSE IF DELETION                                                  S01154
     C*                                                                   S01154
     C                     ELSE                            **X001         S01154
     C*                                                                   S01154
     C                     MOVE IPDN      TNMR                            S01154
     C*                                                                   S01154
     C* IF DEBIT                                                          S01154
     C*                                                                   S01154
     C********** *IN54     IFEQ '0'                        **B002   S01154S01117
     C           IN54      IFEQ '0'                        **B002         S01117
     C*                                                                   S01154
     C                     MOVE DNAR      NRTD                            S01154
     C                     MOVE DCUS      CUSN                            S01154
     C                     MOVE DACY      CCYD                            S01154
     C                     MOVE DCOD      ACDE                            S01154
     C                     MOVE DACS      ASNC                            S01154
     C                     MOVE BRCDD     BRCA                            S01117
     C                     MOVE DRVD      VUDT                            S01154
     C                     MOVE DAMT      MVAM                            S01154
     C           CHSN      IFEQ '+'                                       S01413
     C                     ADD  CHAM      MVAM                            S01413
     C                     ENDIF                                          S01413
     C                     MOVE '1'       DORC                            S01154
     C                     Z-ADDCHQN      CQNR                            S01154
     C*                                                                   134071
     C** If system does not support Retail Account Number and account     134071
     C** type is 'R', setup keys for memos.                               134071
     C*                                                                   134071
     C           BMRANR    IFEQ 'N'                                       134071
     C           DRATYP    ANDEQ'R'                                       134071
     C                     Z-ADD0         W0RETL                          134071
     C                     MOVE DCUS      W0CNUM                          134071
     C                     MOVE DACY      W0CUCD                          134071
     C                     MOVE DCOD      W0ACCD                          134071
     C                     MOVE DACS      W0ACSQ                          134071
     C                     MOVE BRCDD     W0BRCA                          134071
     C                     MOVE DRVD      W0VDAT                          134071
     C                     ENDIF                                          134071
     C*                                                                   S01154
     C* ELSE IF CREDIT                                                    S01154
     C*                                                                   S01154
     C                     ELSE                            **X002         S01154
     C*                                                                   S01154
     C                     MOVE CNAR      NRTD                            S01154
     C                     MOVE CCUS      CUSN                            S01154
     C                     MOVE CACY      CCYD                            S01154
     C                     MOVE CCOD      ACDE                            S01154
     C                     MOVE CACS      ASNC                            S01154
     C                     MOVE BRCDC     BRCA                            S01117
     C                     MOVE CRVD      VUDT                            S01154
     C                     MOVE CAMT      MVAM                            S01154
     C           CHSN      IFEQ '-'                                       S01413
     C                     SUB  CHAM      MVAM                            S01413
     C                     ENDIF                                          S01413
     C                     MOVE '0'       DORC                            S01154
     C                     Z-ADD0         CQNR                            S01154
     C*                                                                   134071
     C** If system does not support Retail Account Number and account     134071
     C** type is 'R', setup keys for memos.                               134071
     C*                                                                   134071
     C           BMRANR    IFEQ 'N'                                       134071
     C           ATYP      ANDEQ'R'                                       134071
     C                     Z-ADD0         W0RETL                          134071
     C                     MOVE CCUS      W0CNUM                          134071
     C                     MOVE CACY      W0CUCD                          134071
     C                     MOVE CCOD      W0ACCD                          134071
     C                     MOVE CACS      W0ACSQ                          134071
     C                     MOVE BRCDC     W0BRCA                          134071
     C                     MOVE CRVD      W0VDAT                          134071
     C                     ENDIF                                          134071
     C*                                                                   S01154
     C                     END                             **E002         S01154
     C*                                                                   S01154
     C                     END                             **E001         S01154
     C***********IN54      IFEQ '1'                                 S01117080721
1538 C***54***             GOTO CRAUPD                                    S01117
     C***********          GOTO CRAUPD                              S01117080721
     C***********          END                                      S01117080721
1539 C***03******          Z-SUBDAMT      DRAMN0                          080721
     C***********VALUDT    IFGT RUND                                E10485E13302
     C*                                                                   080721
     C* IF DEBIT                                                          080721
     C*                                                                   080721
     C***********IN54      IFEQ '0'                        **B002   080721CCB002
     C***********                                                   080721CCB002
     C**IF*DELETE, SUBTRACT MOMEMENT AMOUNT FROM MEMOS BALANCE.     080721CCB002
     C************IN03     IFEQ *ON                                 080721CCB002
     C***********                                                   080721CCB002
     C***********DRVD      IFGT RUND                                080721CCB002
     C***********GRBL      SUB  MVAM      GRBL                      080721CCB002
     C***********          ELSE                                     080721CCB002
     C***********GRBL      SUB  MVAM      GRBL                      080721CCB002
     C***********NETB      SUB  MVAM      NETB                      080721CCB002
     C***********          END                                      080721CCB002
     C***********                                                   080721CCB002
     C***********          ELSE                                     080721CCB002
     C**IF*INSERT, ADD MOMEMENT AMOUNT TO MEMOS BALANCE.            080721CCB002
     C***********DRVD      IFGT RUND                                E13302CCB002
     C***********GRBL      ADD  DRAMN0    GRBL                      E10485S01413
     C***********GRBL      ADD  MVAM      GRBL                      S01413CCB002
     C***********          ELSE                                     E10485CCB002
1540 C***********GRBL      ADD  DRAMN0    GRBL                            S01413
1541 C***********NETB      ADD  DRAMN0    NETB                            S01413
     C***********GRBL      ADD  MVAM      GRBL                      S01413CCB002
     C***********NETB      ADD  MVAM      NETB                      S01413CCB002
     C***********          END                                      E10485CCB002
     C***********                                                   080721CCB002
     C***********          END                                      080721CCB002
     C***********                                                   080721CCB002
1542 C************         GOTO MEMOUT                              080721CCB002
1543 C***********                                                         CCB002
1544 C***IF*C/R*A/C IS A RETAIL A/C - C/R AMOUNT IS SUBTRACTED            CCB002
1545 C** FROM GROSS&NET SHADOW BALANCES OF THE ACCOUNT
1546 C**
1547 C***********CRAUPD    TAG                             * CRAUPD TAG   080721
1548 C***03******          Z-SUBCAMT      CRAMN0                          080721
     C***********VALUDT    IFGT RUND                                E10485E13302
     C***********                                                   080721CCB002
     C**ELSE*IF*CREDIT                                              080721CCB002
     C***********                                                   080721CCB002
     C***********          ELSE                            **X002   080721CCB002
     C***********                                                   080721CCB002
     C**IF*DELETE, ADD MOMEMENT AMOUNT TO MEMOS BALANCE.            080721CCB002
     C***********                                                   080721CCB002
     C************IN03     IFEQ *ON                                 080721CCB002
     C***********                                                   080721CCB002
     C************IN03     IFEQ *ON                                 080721CCB002
     C***********                                                   080721CCB002
     C***********CRVD      IFGT RUND                                080721CCB002
     C***********GRBL      ADD  MVAM      GRBL                      080721CCB002
     C***********          ELSE                                     080721CCB002
     C***********GRBL      ADD  MVAM      GRBL                      080721CCB002
     C***********          END                                      080721CCB002
     C***********                                                   080721CCB002
     C***********          ELSE                                     080721CCB002
     C**IF*INSERT, SUBTRACT MOVEMENT TYPE FROM MEMOS BALANCE        080721CCB002
     C***********                                                   080721CCB002
     C***********CRVD      IFGT RUND                                E13302CCB002
     C***********GRBL      SUB  CRAMN0    GRBL                      E10485S01413
     C***********GRBL      SUB  MVAM      GRBL                      S01413CCB002
     C***********          ELSE                                     E10485CCB002
1549 C***********GRBL      SUB  CRAMN0    GRBL                            S01413
1550 C***********NETB      SUB  CRAMN0    NETB                            S01413
     C***********GRBL      SUB  MVAM      GRBL                      S01413CCB002
     C***********NETB      SUB  MVAM      NETB                      S01413CCB002
     C***********          END                                      E10485CCB002
     C***********                                                   080721CCB002
     C***********          END                                      080721CCB002
     C***********                                                   080721CCB002
     C***********          END                                      080721CCB002
1551 C**
1552 C***********MEMOUT    TAG                             * MEMOUT TAG   080721
1553 C***14******          SETON                     85                   CCB002
1554 C***14******          EXCPT                                          CCB002
1555 C***********          SETOF                     85                   CCB002
      *                                                                   CCB002
      ** If debit account details and deletion Or credit account          CCB002
      ** details and insert.                                              CCB002
     C           UACTYP    IFEQ 'DR_A/C'                                  CCB002
     C           *INKJ     ANDEQ*ON                                       CCB002
     C           UACTYP    OREQ 'CR_A/C'                                  CCB002
     C           *IN03     ANDEQ*OFF                                      CCB002
     C                     Z-SUBMVAM      W0AMT                           CCB002
     C                     ELSE                                           CCB002
     C                     Z-ADDMVAM      W0AMT                           CCB002
     C                     ENDIF                                          CCB002
      *                                                                   CCB002
      ** Call Access Object AOMEMSU0                                      CCB002
     C                     CALL 'AOMEMSU0'                                CCB002
     C                     PARM *BLANKS   W0RTCD  7        I:Return code  CCB002
     C***********          PARM 0         W0RETL 100       O:Retail CCB002124290
     C                     PARM           W0RETL 100       O:Retail A/C No124290
     C**********           PARM           W0CNUM  60       O:Customer No.              CCB002 CSD027
     C                     PARM           W0CNUM  6        O:Customer No.                     CSD027
     C                     PARM           W0CUCD  3        O:Currency     CCB002
     C**********           PARM           W0ACCD  40       O:Account Code              CCB002 CGL029
     C                     PARM           W0ACCD 100                                          CGL029
     C                     PARM           W0ACSQ  20       O:Account Seq. CCB002
     C                     PARM           W0BRCA  3        O:Branch       CCB002
     C                     PARM RUND      W0PSTD  50       O:Posting date CCB002
     C                     PARM           W0VDAT  50       O:Value date   CCB002
     C                     PARM           W0AMT  150       O:Movement amt CCB002
     C                     PARM 'N'       W0FTOV  1        O:FT override  CCB002
      *                                                                   CCB002
     C           W0RTCD    IFNE '       '                                 CCB002
     C                     SETON                     47                   CCB002
     C                     SETOF                     14                   CCB002
     C                     GOTO EXIT                                      CCB002
     C                     ELSE                                           CCB002
     C/COPY WNCPYSRC,RE0150C052
     C                     SETON                     14                   CCB002
     C                     SETOF                     47                   CCB002
     C                     ENDIF                                          CCB002
      *                                                                   CCB002
     C/COPY WNCPYSRC,RE0150C053
      *                                                                                       CRE020
      ** Handle the relevant text of this transaction if CRE020 is enabled.                   CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
      *                                                                                       CRE020
     C           IN54      IFEQ '0'                                                           CRE020
     C                     MOVEL'DEB'     FUND                                                CRE020
     C                     ELSE                                                               CRE020
     C                     MOVEL'CRE'     FUND                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C           *IN02     IFEQ *ON                                                           CRE020
     C                     MOVE 'R '      NRTD                                                CRE020
     C                     ELSE                                                               CRE020
     C                     MOVE 'R*'      NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
1556 C**
     C**   WRITE ACCOUNT MOVEMENT RECORD TO PF/RSACMTPD                   HK0000
     C**
     C                     WRITERSACMTPO                                  HK0000
     C**                                                                  HK0000
     C/COPY WNCPYSRC,RE0150C054
     C**  Check if Retail account is also a nostro for PRONO update.      S01413
     C**                                                                  S01413
     C                     EXSR RETNOS                                    S01413
     C/COPY WNCPYSRC,RE0150C061
     C**                                                                  S01413
1557 C           EXIT      ENDSR
1558 C**
1559 C********************************************************************
1560 C**
     C********************************************************************S01413
     C**  CHGUPD SR. To update MEMOS, RSACMTPD and PRONO for the          S01413
     C**  amount posted to the charge account.                            S01413
     C**                                                                  S01413
     C           CHGUPD    BEGSR                           ** CHGUPD      S01413
     C**                                                                  S01413
     C**   Reverse sign for delete                                        S01413
     C**                                                                  S01413
     C* S01154: Oouput a record to new file 'RCAMTPD' whenever            S01413
     C* a 'MEMOS' record is updated                                       S01413
     C*                                                                   S01413
     C* Setup fields for 'RCAMTPD': Transaction type = 'CE'               S01413
     C*                             (ie. CUSTOMER EXCHANGE)               S01413
     C*                                                                   S01413
     C                     MOVE 'CE'      TRYP                            S01413
     C                     MOVE RUND      PTDT                            S01413
      *                                                                                       CAP205
      ** Set up Module and Movement Type fields                                               CAP205
      *                                                                                       CAP205
     C           CAP205    IFEQ 'Y'                                                           CAP205
     C                     MOVE 'RE'      CMOD                                                CAP205
     C                     MOVE 'S'       MTYP                                                CAP205
     C                     ENDIF                                                              CAP205
     C*                                                                   S01413
     C* If inserted record                                                S01413
     C*                                                                   S01413
     C           *IN02     IFEQ '1'                        **B001         S01413
     C*                                                                   S01413
     C                     MOVE DOCN      TNMR                            S01413
     C*                                                                   S01413
     C* Process charge account                                            S01413
     C*                                                                   S01413
     C           CHSGNO    IFEQ '+'                        **B002         S01413
     C                     MOVE DRCCY     CCYD                            S01413
     C                     MOVE DRBRCD    BRCA                            S01413
     C                     MOVE DRVD      VUDT                            S01413
     C                     ELSE                            **X002         S01413
     C                     MOVE CRCCY     CCYD                            S01413
     C                     MOVE CRBRCD    BRCA                            S01413
     C                     MOVE CRVD      VUDT                            S01413
     C                     ENDIF                           **E002         S01413
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C                     MOVEL'CHA'     FUND                                                CRE020
     C                     ENDIF                                                              CRE020
     C*                                                                   S01413
     C                     MOVE *BLANKS   NRTD                            S01413
     C                     MOVEL'CHARGES' FLD14  14                       S01413
     C                     MOVE TNMR      FLD14  14                       S01413
     C                     MOVELFLD14     NRTD                            S01413
     C                     MOVE CHCUS     CUSN                            S01413
     C                     MOVE CHACD     ACDE                            S01413
     C                     MOVE CHASQ     ASNC                            S01413
     C                     MOVE CHAMTO    MVAM                            S01413
     C                     MOVE '1'       DORC                            S01413
     C*                                                                   S01413
     C           DCHN      IFNE 0                          **B002         S01413
     C                     Z-ADDDCHN      CQNR    80                      S01413
     C                     ELSE                            **X002         S01413
     C                     Z-ADD0         CQNR                            S01413
     C                     END                             **E002         S01413
     C*                                                                   S01413
     C* Else if deletion                                                  S01413
     C*                                                                   S01413
     C                     ELSE                            **X001         S01413
     C*                                                                   S01413
     C                     MOVE IPDN      TNMR                            S01413
     C*                                                                   S01413
     C* Process charge account                                            S01413
     C*                                                                   S01413
     C           CHSN      IFEQ '+'                        **B002         S01413
     C                     MOVE DACY      CCYD                            S01413
     C                     MOVE BRCDD     BRCA                            S01413
     C                     MOVE DRVD      VUDT                            S01413
     C                     ELSE                            **X002         S01413
     C                     MOVE CACY      CCYD                            S01413
     C                     MOVE BRCDC     BRCA                            S01413
     C                     MOVE CRVD      VUDT                            S01413
     C                     ENDIF                           **E002         S01413
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C                     MOVEL'CHA'     FUND                                                CRE020
     C                     ENDIF                                                              CRE020
     C*                                                                   S01413
     C                     MOVE *BLANKS   NRTD                            S01413
     C                     MOVEL'CHARGES' FLD14  14                       S01413
     C                     MOVE TNMR      FLD14  14                       S01413
     C                     MOVELFLD14     NRTD                            S01413
     C                     MOVE CHCN      CUSN                            S01413
     C                     MOVE CHCD      ACDE                            S01413
     C                     MOVE CHSQ      ASNC                            S01413
     C*                                                                   S01413
     C                     MOVE CHAM      MVAM                            S01413
     C                     MOVE '0'       DORC                            S01413
     C                     Z-ADDCHQN      CQNR    80                      S01413
     C*                                                                   S01413
     C                     END                             **E001         S01413
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C           *IN02     IFEQ *ON                                                           CRE020
     C                     MOVE 'R '      NRTD                                                CRE020
     C                     ELSE                                                               CRE020
     C                     MOVE 'R*'      NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
     C                     ENDIF                                                              CRE020
     C**                                                                  S01413
     C**   Bypass if charge amount is ZERO - No updates required.         S01413
     C**                                                                  S01413
     C           MVAM      CABEQ0         CHGEXT                          S01413
     C*                                                                   S01413
     C* Chain to ACCNTAB to determine type of account and access          S01413
     C* MEMOS rrn if retail account.                                      S01413
     C*                                                                   S01413
     C                     MOVE CUSN      XCUS                            S01413
     C                     MOVE CCYD      XCCY                            S01413
     C                     MOVE ACDE      XCOD                            S01413
     C                     MOVE ASNC      XSEQ                            S01413
     C                     MOVE BRCA      XBRC                            S01413
     C*                                                                   S01413
     C* Account should already have been validated so no sceeen messages  S01413
     C* if error.                                                         S01413
     C*                                                                   S01413
     C           ACNKEY    CHAINACCNT                47                   S01413
     C           *IN47     IFEQ '1'                        **B001         S01413
     C           *IN15     OREQ '0'                                       S01413
     C           *LOCK     IN   LDA                        ***************S01413
     C                     MOVEL'ACCNT'   DBFILE           * DBERROR 702 *S01413
     C                     MOVELACNKEY    DBKEY            ***************S01413
     C                     MOVE '702'     DBASE                           S01413
     C                     MOVE '1'       *INKC                           S01413
     C                     OUT  LDA                                       S01413
     C                     EXSR DBSR                                      S01413
     C                     END                             **E001         S01413
     C*                                                                   S01413
     C                     MOVE '0'       CHRET   1                       S01413
     C           ATYP      IFEQ 'R'                                       S01413
     C                     MOVE '1'       CHRET                           S01413
     C                     END                                            S01413
     C           ATYP      IFEQ 'N'                                       S01413
     C                     MOVE '2'       CHRET                           S01413
     C                     END                                            S01413
     C*                                                                   S01413
     C********************************************************************S01413
     C*  Processing for retail charge account.                            S01413
     C*                                                                   S01413
     C*  Access the charge account MEMOS record.                          S01413
     C*                                                                   S01413
     C           CHRET     IFEQ '1'                        **B001         S01413
     C*                                                                   S01413
     C                     SETOF                     14                   S01413
     C***********RRNM      CHAINMEMOS                47             S01413CCB002
      *                                                                   CCB002
      ** Set the sign of the amount.                                      CCB002
     C           DORC      IFEQ 0                                         CCB002
     C**********           Z-SUBMVAM      W0AMT                    CCB002 134071
     C                     Z-ADDMVAM      W0AMT                           134071
     C                     ELSE                                           CCB002
     C**********           Z-ADDMVAM      W0AMT                    CCB002 134071
     C                     Z-SUBMVAM      W0AMT                           134071
     C                     ENDIF                                          CCB002
      *                                                                   CCB002
      ** Call Access Object AOMEMSU0                                      CCB002
     C                     CALL 'AOMEMSU0'                                CCB002
     C                     PARM *BLANKS   W0RTCD  7        I:Return code  CCB002
     C                     PARM 0         W0RETL 100       O:Retail A/C NoCCB002
     C**********           PARM CUSN      W0CNUM  60       O:Customer No.              CCB002 CSD027
     C                     PARM CUSN      W0CNUM  6        O:Customer No.                     CSD027
     C                     PARM CCYD      W0CUCD  3        O:Currency     CCB002
     C**********           PARM ACDE      W0ACCD  40       O:Account Code              CCB002 CGL029
     C                     PARM ACDE      W0ACCD                                              CGL029
     C                     PARM ASNC      W0ACSQ  20       O:Account Seq. CCB002
     C                     PARM BRCA      W0BRCA  3        O:Branch       CCB002
     C                     PARM RUND      W0PSTD  50       O:Posting date CCB002
     C                     PARM VUDT      W0VDAT  50       O:Value date   CCB002
     C                     PARM           W0AMT  150       O:Movement amt CCB002
     C                     PARM 'N'       W0FTOV  1        O:FT override  CCB002
      *                                                                   CCB002
     C************IN47     IFEQ '1'                        **B002   S01413CCB002
     C************IN14     OREQ '0'                                 S01413CCB002
     C           W0RTCD    IFNE '       '                                 CCB002
     C           *LOCK     IN   LDA                        ***************S01413
     C                     MOVEL'MEMOS'   DBFILE           * DBERROR 703 *S01413
     C***********          MOVELRRNM      DBKEY            *********S01413CCB002
     C                     MOVELW0CNUM    DBKEY                           CCB002
     C                     MOVE '703'     DBASE                           S01413
     C                     MOVE '1'       *INKC                           S01413
     C                     OUT  LDA                                       S01413
     C                     EXSR DBSR                                      S01413
     C                     END                             **E002         S01413
     C/COPY WNCPYSRC,RE0150C055
     C***********                                                   S01413CCB002
     C***Add*the*movement amount to Gross and Net shadow balanceshfoS01413CCB002
     C***for*the*account.                                           S01413CCB002
     C***********                                                   S01413CCB002
     C***********DORC      IFEQ 1                          **B002   S01413CCB002
     C***********VUDT      IFGT RUND                       **B003   S01413CCB002
     C***********GRBL      ADD  MVAM      GRBL                      S01413CCB002
     C***********          ELSE                            **X003   S01413CCB002
     C***********GRBL      ADD  MVAM      GRBL                      S01413CCB002
     C***********NETB      ADD  MVAM      NETB                      S01413CCB002
     C***********          END                             **E003   S01413CCB002
     C***********          ELSE                            **X002   S01413CCB002
     C***********VUDT      IFGT RUND                       **B003   S01413CCB002
     C***********GRBL      SUB  MVAM      GRBL                      S01413CCB002
     C***********          ELSE                            **X003   S01413CCB002
     C***********GRBL      SUB  MVAM      GRBL                      S01413CCB002
     C***********NETB      SUB  MVAM      NETB                      S01413CCB002
     C***********          END                             **E003   S01413CCB002
     C***********          END                             **E002   S01413CCB002
     C***********                                                   S01413CCB002
     C*****Update MEMOS with adjustment for charge amount.          S01413CCB002
     C***********                                                   S01413CCB002
     C***14******          SETON                     85             S01413CCB002
     C***14******          EXCPT                                    S01413CCB002
     C***********          SETOF                     85             S01413CCB002
     C**                                                                  S01413
     C**   Write account movement record to PF/RSACMTPD                   S01413
     C                     WRITERSACMTPO                                  S01413
     C/COPY WNCPYSRC,RE0150C056
     C**                                                                  S01413
     C**  Check if Retail account is also a nostro for PRONO update.      S01413
     C**  Field IN54 is set to 'C' for charges at this point.             S01413
     C**                                                                  S01413
     C                     EXSR RETNOS                                    S01413
     C/COPY WNCPYSRC,RE0150C062
     C**                                                                  S01413
     C                     END                             **E001         S01413
     C*                                                                   S01413
     C********************************************************************S01413
     C*  Processing for nostro charge account.                            S01413
     C*                                                                   S01413
     C           CHRET     IFEQ '2'                        **B001         S01413
     C*                                                                   S01413
     C**  Access nostros details for nostro code                          S01413
     C*                                                                   S01413
     C                     MOVE *BLANKS   @KEYE                        E  S01413
     C                     MOVE *BLANKS   @KEYG                        G  S01413
     C                     MOVE *BLANKS   @KEYH                        H  S01413
     C*                                                                   S01413
     C                     MOVE CUSN      @KEYA                        A  S01413
     C                     MOVE CCYD      @KEYB                        B  S01413
     C                     MOVE ACDE      @KEYC                        C  S01413
     C                     MOVE ASNC      @KEYD                        D  S01413
     C                     MOVE BRCA      @KEYF                        F  S01413
     C*                                                                   S01413
     C                     CALL 'AONOSTR0'PLIST1                          S01413
     C           @RTCD     IFNE *BLANKS                    **B002         S01413
     C           *LOCK     IN   LDA                        ***************S01413
     C                     MOVEL'NOSTR'   DBFILE           * DBERROR 704 *S01413
     C                     MOVEL*BLANKS   DBKEY            ***************S01413
     C                     MOVE '704'     DBASE                           S01413
     C                     MOVE '1'       *INKC                           S01413
     C                     OUT  LDA                                       S01413
     C                     EXSR DBSR                                      S01413
     C                     END                             **E002         S01413
     C*                                                                   S01413
     C** Chain to projected Nostro Balances file using currency/nostro    078610
     C*                                                                   078610
     C                     MOVE A7NONB    KEYPR                           S01413
     C                     MOVEL@KEYB     KEYPR   5                       S01413
     C*                                                                   S01413
     C           KEYPR     CHAINPRONO                99                   S01413
     C*                                                                   S01413
     C** If record not found, get Unallocated Nostro record instead       078610
     C*                                                                   078610
     C           *IN99     IFNE '0'                                       078610
     C                     MOVE '00'      KEYPR                           078610
     C           KEYPR     CHAINPRONO                99                   078610
     C                     END                                            078610
     C*                                                                   078610
     C           *IN99     IFNE '0'                        **B002         S01413
     C           *LOCK     IN   LDA                        ***************S01413
     C                     MOVEL'PRONO'   DBFILE           * DBERROR 705 *S01413
     C                     MOVELKEYPR     DBKEY            ***************S01413
     C                     MOVE '705'     DBASE                           S01413
     C                     MOVE '1'       *INKC                           S01413
     C                     OUT  LDA                                       S01413
     C                     EXSR DBSR                                      S01413
     C                     END                             **E002         S01413
     C/COPY WNCPYSRC,RE0150C063
     C*                                                                   S01413
     C**  Insert                                                          S01413
     C*                                                                   S01413
     C           *IN02     IFEQ '1'                        **B002         S01413
     C*                                                                   S01413
     C           PRBAL1    SUB  MVAM      PRBAL1                          S01413
     C           PRBAL2    SUB  MVAM      PRBAL2                          S01413
     C           PRBAL3    SUB  MVAM      PRBAL3                          S01413
     C           PRBAL4    SUB  MVAM      PRBAL4                          S01413
     C           PRBAL5    SUB  MVAM      PRBAL5                          S01413
     C*                                                                   S01413
     C* Else if deletion                                                  S01413
     C*                                                                   S01413
     C                     ELSE                            **X002         S01413
     C*                                                                   S01413
     C           PRBAL1    ADD  MVAM      PRBAL1                          S01413
     C           PRBAL2    ADD  MVAM      PRBAL2                          S01413
     C           PRBAL3    ADD  MVAM      PRBAL3                          S01413
     C           PRBAL4    ADD  MVAM      PRBAL4                          S01413
     C           PRBAL5    ADD  MVAM      PRBAL5                          S01413
     C*                                                                   S01413
     C                     END                             **E002         S01413
     C/COPY WNCPYSRC,RE0150C064
     C*                                                                   S01413
     C** Update PRONO balance.                                            S01413
     C*                                                                   S01413
     C                     EXCPTUPDPRO                                    S01413
     C*                                                                   S01413
     C** Write account movement record to PF/RSACMTPD                     S01413
     C*                                                                   S01413
     C                     WRITERSACMTPO                                  S01413
     C/COPY WNCPYSRC,RE0150C057
     C                     END                             **E001         S01413
     C**                                                                  S01413
     C           CHGEXT    ENDSR                                          S01413
     C**                                                                  S01413
     C********************************************************************S01413
     C**                                                                  S01413
     C********************************************************************S01413
     C**  RETNOS SR. To update PRONO within the Retail account processing S01413
     C**  if this is a Retail Nostro account.                             S01413
     C**                                                                  S01413
     C           RETNOS    BEGSR                           ** RETNOS      S01413
     C**                                                                  S01413
     C**  Use of field IN54                                               S01413
     C**    '0' - Processing debit account.                               S01413
     C**    '1' - Processing credit account.                              S01413
     C**    'C' - Processing charge account.                              S01413
     C*                                                                   S01413
     C* Test for Reatil account on the Nostro table.                      S01413
     C*                                                                   S01413
     C                     MOVE *BLANKS   @KEYE                        E  S01413
     C                     MOVE *BLANKS   @KEYG                        G  S01413
     C                     MOVE *BLANKS   @KEYH                        H  S01413
     C*                                                                   S01413
     C                     MOVE CUSN      @KEYA                        A  S01413
     C                     MOVE CCYD      @KEYB                        B  S01413
     C                     MOVE ACDE      @KEYC                        C  S01413
     C                     MOVE ASNC      @KEYD                        D  S01413
     C                     MOVE BRCA      @KEYF                        F  S01413
     C*                                                                   S01413
     C                     CALL 'AONOSTR0'PLIST1                          S01413
     C           @RTCD     IFNE *BLANKS                    **B001         S01413
     C                     GOTO RETEXT                                    S01413
     C                     END                             **E001         S01413
     C*                                                                   S01413
     C* Nostro record found, proceed to update PRONO.                     S01413
     C*                                                                   S01413
     C                     MOVE A7NONB    KEYPR                           S01413
     C                     MOVEL@KEYB     KEYPR   5                       S01413
     C*                                                                   S01413
     C** Chain to projected Nostro Balances file using currency/nostro    078610
     C*                                                                   078610
     C           KEYPR     CHAINPRONO                99                   S01413
     C*                                                                   S01413
     C** If record not found, get Unallocated Nostro record instead       078610
     C*                                                                   078610
     C           *IN99     IFNE '0'                                       078610
     C                     MOVE '00'      KEYPR                           078610
     C           KEYPR     CHAINPRONO                99                   078610
     C                     END                                            078610
     C*                                                                   078610
     C           *IN99     IFNE '0'                        **B001         S01413
     C           *LOCK     IN   LDA                        ***************S01413
     C                     MOVEL'PRONO'   DBFILE           * DBERROR 706 *S01413
     C                     MOVELKEYPR     DBKEY            ***************S01413
     C                     MOVE '706'     DBASE                           S01413
     C                     MOVE '1'       *INKC                           S01413
     C                     OUT  LDA                                       S01413
     C                     EXSR DBSR                                      S01413
     C                     END                             **E001         S01413
     C*                                                                   S01413
     C* Debit account update.                                             S01413
     C*                                                                   S01413
     C           IN54      IFEQ '0'                        **B001         S01413
     C*                                                                   S01413
     C* Insert                                                            S01413
     C*                                                                   S01413
     C           *IN02     IFEQ '1'                        **B002         S01413
     C*                                                                   S01413
     C           VUDT      IFLE PRDAT5                     **B003         S01413
     C           PRBAL5    ADD  MVAM      PRBAL5                          S01413
     C           VUDT      IFLE PRDAT4                     **B004         S01413
     C           PRBAL4    ADD  MVAM      PRBAL4                          S01413
     C           VUDT      IFLE PRDAT3                     **B005         S01413
     C           PRBAL3    ADD  MVAM      PRBAL3                          S01413
     C           VUDT      IFLE PRDAT2                     **B006         S01413
     C           PRBAL2    ADD  MVAM      PRBAL2                          S01413
     C           VUDT      IFLE PRDAT1                     **B007         S01413
     C           PRBAL1    ADD  MVAM      PRBAL1                          S01413
     C                     ENDIF                           **E007         S01413
     C                     ENDIF                           **E006         S01413
     C                     ENDIF                           **E005         S01413
     C                     ENDIF                           **E004         S01413
     C                     ENDIF                           **E003         S01413
     C*                                                                   S01413
     C* Else if deletion                                                  S01413
     C*                                                                   S01413
     C                     ELSE                            **X002         S01413
     C*                                                                   S01413
     C           VUDT      IFLE PRDAT5                     **B003         S01413
     C           PRBAL5    SUB  MVAM      PRBAL5                          S01413
     C           VUDT      IFLE PRDAT4                     **B004         S01413
     C           PRBAL4    SUB  MVAM      PRBAL4                          S01413
     C           VUDT      IFLE PRDAT3                     **B005         S01413
     C           PRBAL3    SUB  MVAM      PRBAL3                          S01413
     C           VUDT      IFLE PRDAT2                     **B006         S01413
     C           PRBAL2    SUB  MVAM      PRBAL2                          S01413
     C           VUDT      IFLE PRDAT1                     **B007         S01413
     C           PRBAL1    SUB  MVAM      PRBAL1                          S01413
     C                     ENDIF                           **E007         S01413
     C                     ENDIF                           **E006         S01413
     C                     ENDIF                           **E005         S01413
     C                     ENDIF                           **E004         S01413
     C                     ENDIF                           **E003         S01413
     C*                                                                   S01413
     C                     END                             **E002         S01413
     C                     END                             **E001         S01413
     C*                                                                   S01413
     C* Credit account and Charge account update.                         S01413
     C*                                                                   S01413
     C           IN54      IFEQ '1'                        **B001         S01413
     C           IN54      OREQ 'C'                                       S01413
     C*                                                                   S01413
     C* Insert                                                            S01413
     C*                                                                   S01413
     C           *IN02     IFEQ '1'                        **B002         S01413
     C*                                                                   S01413
     C           VUDT      IFLE PRDAT5                     **B003         S01413
     C           PRBAL5    SUB  MVAM      PRBAL5                          S01413
     C           VUDT      IFLE PRDAT4                     **B004         S01413
     C           PRBAL4    SUB  MVAM      PRBAL4                          S01413
     C           VUDT      IFLE PRDAT3                     **B005         S01413
     C           PRBAL3    SUB  MVAM      PRBAL3                          S01413
     C           VUDT      IFLE PRDAT2                     **B006         S01413
     C           PRBAL2    SUB  MVAM      PRBAL2                          S01413
     C           VUDT      IFLE PRDAT1                     **B007         S01413
     C           PRBAL1    SUB  MVAM      PRBAL1                          S01413
     C                     ENDIF                           **E007         S01413
     C                     ENDIF                           **E006         S01413
     C                     ENDIF                           **E005         S01413
     C                     ENDIF                           **E004         S01413
     C                     ENDIF                           **E003         S01413
     C*                                                                   S01413
     C* Else if deletion                                                  S01413
     C*                                                                   S01413
     C                     ELSE                            **X002         S01413
     C*                                                                   S01413
     C           VUDT      IFLE PRDAT5                     **B003         S01413
     C           PRBAL5    ADD  MVAM      PRBAL5                          S01413
     C           VUDT      IFLE PRDAT4                     **B004         S01413
     C           PRBAL4    ADD  MVAM      PRBAL4                          S01413
     C           VUDT      IFLE PRDAT3                     **B005         S01413
     C           PRBAL3    ADD  MVAM      PRBAL3                          S01413
     C           VUDT      IFLE PRDAT2                     **B006         S01413
     C           PRBAL2    ADD  MVAM      PRBAL2                          S01413
     C           VUDT      IFLE PRDAT1                     **B007         S01413
     C           PRBAL1    ADD  MVAM      PRBAL1                          S01413
     C                     ENDIF                           **E007         S01413
     C                     ENDIF                           **E006         S01413
     C                     ENDIF                           **E005         S01413
     C                     ENDIF                           **E004         S01413
     C                     ENDIF                           **E003         S01413
     C*                                                                   S01413
     C                     END                             **E002         S01413
     C                     END                             **E001         S01413
     C*                                                                   S01413
     C** Update PRONO balance.                                            S01413
     C*                                                                   S01413
     C                     EXCPTUPDPRO                                    S01413
     C**                                                                  S01413
     C           RETEXT    ENDSR                                          S01413
     C**                                                                  S01413
     C/COPY WNCPYSRC,RE0150C065
     C********************************************************************S01413
     C**                                                                  S01413
     C********************************************************************S01413
     C**                                                                  S01413
     C** DBSR subroutine for database error handling                      S01413
     C**                                                                  S01413
     C**     Called by       VARIOUS                                      S01413
     C**     Calls           *PSSR                                        S01413
     C**                                                                  S01413
     C           DBSR      BEGSR                           **DBSR BEGSR** S01413
     C*                                                                   S01413
     C                     WRITEHEADAU                                    S01413
     C*                                                                   S01413
     C                     MOVE '1'       *INU7                           S01413
     C                     MOVE '1'       *INU8                           S01413
     C                     MOVE '1'       *INLR                           S01413
     C                     WRITEERRAU                                     S01413
     C*                                                                   S01413
     C                     EXSR *PSSR                                     S01413
     C*                                                                   S01413
     C                     RETRN                                          S01413
     C*                                                                   S01413
     C                     ENDSR                           **DBSR ENDSR** S01413
     C********************************************************************S01413
     C**                                                                  S01413
1566 C********************************************************************
1567 C**
1568 C**   AMTCMP SUBR. TO VALIDATE THAT THE DIFFERENCE BETWEEN 2 AMOUNTS
1569 C**   IN THE SAME CURRENCY IS LESS THAN ONE UNIT
1570 C**   ERROR IND-47
1571 C**
1572 C           AMTCMP    BEGSR                           * AMTCMP BEGSR*
1573 C**
1574 C                     Z-ADDAMTCHK    AMTCHK 153
1575 C                     Z-ADDRESULT    RESULT 153
1576 C                     Z-ADDFACTOR    FACTOR  40
1577 C**
1578 C           RESULT    SUB  AMTCHK    DIFF3  153   47
1579 C   47                Z-SUBDIFF3     DIFF3
1580 C           DIFF3     MULT FACTOR    DIFF1  151
1581 C           DIFF1     COMP 1                    47
1582 C                     ENDSR                           * AMTCMP ENDSR*
1583 C********************************************************************
     C********************************************************************116966
     C**                                                                  116966
     C** Subroutine to process allowable ranges for customer exhanges     116966
     C**                                                                  116966
     C** Called From Main Processing                                      116966
     C** Calls                                                            116966
     C**                                                                  116966
     C           RANGES    BEGSR                                          116966
     C*                                                                   116966
     C           EXRTN     IFGE 1                                         116966
     C********** EXRTN     MULT .005      HRANGE  53H                                 116966 BUG6224
     C           EXRTN     MULT .05       HRANGE  53H                                        BUG6224
     C                     ELSE                                           116966
     C********** .005      DIV  EXRTN     HRANGE                                      116966 BUG6224
     C           .05       DIV  EXRTN     HRANGE                                             BUG6224
     C                     END                                            116966
     C**********           Z-ADD.005      LRANGE  33                                  116966 BUG6224
     C                     Z-ADD.05       LRANGE  33                                         BUG6224
     C*                                                                   116966
     C** Checking after step 3                                            116966
     C*                                                                   116966
     C           @CR2      IFEQ *BLANK                                    116966
     C*                                                                   116966
     C           @DR2      IFEQ 'Y'                                       116966
     C*                                                                   116966
     C           EXRTN     IFGE 1                                         116966
     C           RESLT2    ADD  LRANGE    @HIGH  153                      116966
     C           RESLT2    SUB  LRANGE    @LOW   153                      116966
     C                     ELSE                                           116966
     C           RESLT2    ADD  HRANGE    @HIGH  153                      116966
     C           RESLT2    SUB  HRANGE    @LOW   153                      116966
     C                     END                                            116966
     C*                                                                   116966
     C           CRAMT     IFGE @LOW                                      116966
     C           CRAMT     ANDLE@HIGH                                     116966
     C                     SETOF                     47                   116966
     C                     ELSE                                           116966
     C                     SETON                     47                   116966
     C                     END                                            116966
     C*                                                                   116966
     C                     END                                            116966
     C*                                                                   116966
     C           @CR1      IFEQ 'Y'                                       116966
     C*                                                                   116966
     C           EXRTN     IFGE 1                                         116966
     C           RESLT3    ADD  HRANGE    @HIGH  153                      116966
     C           RESLT3    SUB  HRANGE    @LOW   153                      116966
     C                     ELSE                                           116966
     C           RESLT3    ADD  LRANGE    @HIGH  153                      116966
     C           RESLT3    SUB  LRANGE    @LOW   153                      116966
     C                     END                                            116966
     C*                                                                   116966
     C           DRAMT     IFGE @LOW                                      116966
     C           DRAMT     ANDLE@HIGH                                     116966
     C                     SETOF                     47                   116966
     C                     ELSE                                           116966
     C                     SETON                     47                   116966
     C                     END                                            116966
     C*                                                                   116966
     C                     END                                            116966
     C*                                                                   116966
     C                     ELSE                                           116966
     C*                                                                   116966
     C** Checking after Step 4                                            116966
     C*                                                                   116966
     C*                                                                   116966
     C           @DR1      IFEQ 'Y'                                       116966
     C*                                                                   116966
     C           EXRTN     IFGE 1                                         116966
     C           RESLT1    ADD  HRANGE    @HIGH  153                      116966
     C           RESLT1    SUB  HRANGE    @LOW   153                      116966
     C                     ELSE                                           116966
     C           RESLT1    ADD  LRANGE    @HIGH  153                      116966
     C           RESLT1    SUB  LRANGE    @LOW   153                      116966
     C                     END                                            116966
     C*                                                                   116966
     C           CRAMT     IFGE @LOW                                      116966
     C           CRAMT     ANDLE@HIGH                                     116966
     C                     SETOF                     47                   116966
     C                     ELSE                                           116966
     C                     SETON                     47                   116966
     C                     END                                            116966
     C*                                                                   116966
     C                     END                                            116966
     C           @CR2      IFEQ 'Y'                                       116966
     C*                                                                   116966
     C           EXRTN     IFGE 1                                         116966
     C           RESLT4    ADD  LRANGE    @HIGH  153                      116966
     C           RESLT4    SUB  LRANGE    @LOW   153                      116966
     C                     ELSE                                           116966
     C           RESLT4    ADD  HRANGE    @HIGH  153                      116966
     C           RESLT4    SUB  HRANGE    @LOW   153                      116966
     C                     END                                            116966
     C*                                                                   116966
     C           DRAMT     IFGE @LOW                                      116966
     C           DRAMT     ANDLE@HIGH                                     116966
     C                     SETOF                     47                   116966
     C                     ELSE                                           116966
     C                     SETON                     47                   116966
     C                     END                                            116966
     C*                                                                   116966
     C                     END                                            116966
     C*                                                                   116966
     C                     END                                            116966
     C*                                                                   116966
     C                     ENDSR                                          116966
1584 C**
1585 C********************************************************************
1586 C***********
0469 C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0470 C**********                                                          S01194
0471 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0472 C**********                                                          S01194
0473 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0474 C**********           MOVEL'01      'ZTABKY 12                       S01194
0475 C**********           MOVE '  10'    ZTABKY                          S01194
0476 C**********                                                          S01194
0477 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0478 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0479 C**********                                                          S01194
0480 C*****CHECK*SYSTEM*DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0481 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0482 C**********                                                          S01194
0483 C**********           ENDSR                                          S01194
1603 C**
1604 C********************************************************************
1605 C**
1606 C********************************************************************
1607 C**
1608 C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
1609 C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C********************************************************
     C** THIS PART OF ZALIGN SUBROUTINE IS NON-STANDARD      *
     C           ZFIELD    COMP ZERO16                   99  *
     C**                                                     *
     C********************************************************
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
1706 C**
1707 C**
1708 C********************************************************************
1709 C********************************************************************
1710 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
1711 C*   IND '99' IS SET BY AN OVERFLOW ERROR
1712 C*
1713 CSR         GLZADD    BEGSR                           *** GLZADD ****
1714 C*
1715 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
1716 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
1717 C*
1718 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
1719 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
1720 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
1721 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
1722 C*
1723 CSR                   EXSR GLZSUM
1724 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
1725 C*
1726 C**                                                               ***
1732 C********************************************************************
1732 C********************************************************************
1733 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
1734 C*                        GLZADD, GLZSUB, GLZCMP.
1735 C*          PARAMETERS PASSED -
1736 C*                     I/P ZZAMTI ZZAMTD
1737 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
1738 C*
1739 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
1740 C*
1741 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
1742 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
1743 CSR                   SETOF                     919293
1744 CSR                   SETOF                     949599
1745 C*
1746 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
1747 CSR         ZZAMTI    COMP 0                      9293
1748 CSR 93      ZZAMTD    COMP 0                      9293
1749 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1750 C*
1751 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
1752 CSR         ZZTOTI    COMP 0                      9193
1753 CSR 93      ZZTOTD    COMP 0                      9193
1754 C*
1755 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
1756 CSR 93                Z-ADDZZAMTI    ZZTOTI
1757 CSR 93                Z-ADDZZAMTD    ZZTOTD
1758 CSR 93                GOTO ZZSEND                     ZERO BYPASS
1759 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
1760 CSR 91N92
1761 CORN91 92             GOTO ZZOFPS
1762 C*
1763 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
1764 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
1765 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
1766 C*
1767 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
1768 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
1769 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
1770 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
1771 C*
1772 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
1773 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
1774 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
1775 CSRN99                Z-ADDZZWK2     ZZTOTD
1776 CSRN99                Z-ADDZZWK3     ZZTOTI
1777 C*
1778 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
1779 CSR 99                Z-ADD0         ZZAMT  153
1780 CSR                   GOTO ZZSEND
1781 C*
1782 C* THE 'SIGNS' ARE DIFFERENT
1783 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
1784 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
1785 C*
1786 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
1787 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
1788 C*
1789 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
1790 C*
1791 CSR 91                Z-SUBZZTOTI    ZZTOTI
1792 CSR 91                Z-SUBZZTOTD    ZZTOTD
1793 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
1794 C*
1795 CSR         ZZTOTI    COMP ZZAMTI               93  95
1796 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
1797 C*
1798 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
1799 CSR 95                Z-ADD0         ZZTOTI
1800 CSR 95                Z-ADD0         ZZTOTD
1801 CSR 95                GOTO ZZSEND
1802 C*
1803 C* IF ZZTOT GT. ZZAMT.
1804 CSR 93      ZZAMTD    COMP ZZTOTD               94
1805 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
1806 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
1807 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
1808 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
1809 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
1810 C*
1811 C*
1812 C* IF ZZAMT GT. ZZTOT.
1813 CSRN93      ZZTOTD    COMP ZZAMTD               94
1814 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
1815 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
1816 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
1817 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
1818 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
1819 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
1820 C*
1821 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
1822 CSR                   SETOF                     94
1823 CSR 93 91
1824 CORN93 92             SETON                     94
1825 CSR 94                Z-SUBZZTOTI    ZZTOTI
1826 CSR 94                Z-SUBZZTOTD    ZZTOTD
1827 C**
1828 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
1829 CSR 92                Z-SUBZZAMTI    ZZAMTI
1830 CSR 92                Z-SUBZZAMTD    ZZAMTD
1831 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
1832 C**
1833 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
1834 CSR                   SETOF                     96
1835 CSR         ZZTOTD    COMP 0                        91
1836 CSR 91      ZZTOTI    COMP 0                      96
1837 CSR 96                MOVE '.000-'   ZZNEGD  5
1838 CSR                   ENDSR                             ** ENDSR **
1839 C********************************************************************
 419 C********************************************************************
     C**
     C**   ZTNLU1 SR. - TO LOCK THE TRANSACTION NUMBER DATA AREA AND
     C**                THEN UPDATE AND RELEASE THE DATA AREA.
     C**
     C           ZTNLU1    BEGSR
     C           *NAMVAR   DEFN MNATN     DNATN
     C           *LOCK     IN   DNATN
     C                     MOVE FNATN     NATN    50
     C                     MOVE FNATN     ZZWK05  50
     C                     ADD  1         ZZWK05
     C                     MOVE ZZWK05    FNATN
     C                     OUT  DNATN
     C                     ENDSR
     C**
     C**
 707 C********************************************************************
     C**   FILE EXCEPTION/ERROR HANDLING SUBROUTINE
     C           INFSR     BEGSR
     C**   CHECK ERROR TYPE
     C           STATUS    IFEQ 01021
     C**   CHAIN TO FILE TO GET CURRENT DETAILS
     C           DOCN      CHAINCUSEX                47
     C**
     C           *IN47     IFEQ '0'
     C**   ROLLBACK UPDATES ALREADY DONE
     C                     ROLBK
     C**   SET ON 'RECORD UPDATED....' INDICATOR
     C                     SETON                     80
     C**   *IN80 IMITATES A 'RECORD ALREADY CHANGED' ERROR
     C**
     C**  RESET EXCEPTION CONTROL INDICATORS
     C                     SETOF                     428889
     C**
     C                     MOVE '*DETC '  EXTTAG  6
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C*
     C                     ENDSREXTTAG
     C*****************************************************************
1517 C**
     C**   BRANCH CODE  VALIDATION :::                                    S01117
     C*     CALLED    FROM MAIN                                           S01117
     C*     CALLS     AOBRCHR0                                            S01117
     C**                                                                  S01117
     C           BRCVAL    BEGSR                                          S01117
     C                     SETOF                     99                   S01117
     C*                                                                   S01117
     C** BRANCH CODE MUST BE DEFINED IN STANDING DATA                     S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCDX     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C**                                                                  S01117
     C           @RTCD     IFNE *BLANKS                    *B1            S01117
     C                     SETON                     99                   S01117
     C                     ELSE                                           LN0085
     C                     MOVE A8BRCD    BRCDX                           LN0085
     C                     END                             *E1            S01117
     C                     ENDSR                                          S01117
     C**                                                                  S01117
     C********************************************************************S01117
     C*     SUBROUTINE PRFCVL                                             S01117
     C*     TO CHECK IF THE ENTERED PROFIT CENTRE IS VALID                S01117
     C*     OR SUBSITITUE ANY DEFAULT VALUE IF NOT ENTERED.               S01117
     C*                                                                   S01117
     C*     CALLED    FROM MAIN                                           S01117
     C*     CALLS     AOPRFCR0, AOPRFMR0                                  S01117
     C*                                                                   S01117
     C           PRFCVL    BEGSR                           *** PRFCVL *** S01117
     C                     SETOF                     99                   S01117
     C*                                                                   S01117
     C*  VALIDATE THE INPUT PROFIT CENTRE IF ENTERED                      S01117
     C*                                                                   S01117
     C           IPRFC     IFNE *BLANK                     *B1            S01117
     C                     MOVE *BLANKS   @KEY                            S01117
     C                     CALL 'AOPRFCR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM IPRFC     @KEY    4                       S01117
     C           SDPRFC    PARM SDPRFC    DSFDY                           S01117
     C           @RTCD     IFNE *BLANK                     *B2            S01117
     C                     SETON                     99                   S01117
     C                     ELSE                            *X2            LN0085
     C                     MOVE DSPCCD    IPRFC                           LN0085
     C                     END                             *E2            S01117
     C*                                                                   S01117
     C                     ELSE                            *X1            S01117
     C*                                                                   S01117
     C** ELSE /* PROFIT CENTRE IS USED BUT NOT ENTERED */ :-              S01117
     C** EXTRACT THE DEFAULT PROFIT CENTRE IF INPUT PROFIT CENTRE IS      S01117
     C** BLANK AND PROFIT CENTRE USED FLAG IS ON AND DEFAULT FLAG IS      S01117
     C** ALSO ON.                                                         S01117
     C** FOLLOWING BASE FIELDS ARE PASSED TO AOPRFMR0 :                   S01117
     C** TRAN. TYPE  - DWPCTT                                             S01117
     C** BRANCH CODE - DWBRCD                                             S01117
     C** USER        - DWUSID                                             S01117
     C*Also passed to AOPRFMR0:                                           176510
      ** Cusromer No. - DWCNUM                                            176510
      ** Account Officer - DWACOF                                         176510
     C*                                                                   S01117
     C                     MOVEL'91020'   DWPCTT                          S01117
     C                     MOVE TRBRCD    DWBRCD                          S01117
     C                     MOVE USRPRF    DWUSID                          S01117
     C*                                                                   S01117
     C           PFCD      IFEQ 'Y'                        *B2            S01117
     C                     CALL 'AOPRFMR0'                                S01117
     C                     PARM *BLANKS   RTCDPR  1                       S01117
     C                     PARM *BLANKS   BOOKPR  2                       S01117
     C**********           PARM DWPCTT    TRTPPR  2                 S01117LN0085
     C                     PARM DWPCTT    TRTPPR  5                       LN0085
     C                     PARM *BLANKS   SUTPPR  2                       S01117
     C                     PARM DWBRCD    BRANPR  3                       S01117
     C                     PARM *BLANKS   DEPTPR  3                       S01117
     C                     PARM DWUSID    USERPR 10                       S01117
     C**********           PARM *BLANKS   ACOFPR  2                 S01117176510
     C**********           PARM *BLANKS   CNUMPR  6                 S01117176510
     C                     PARM DWACOF    ACOFPR  2                       176510
     C                     PARM DWCNUM    CNUMPR  6                       176510
     C                     PARM *BLANKS   PRFCPR  4                       S01117
     C           RTCDPR    IFEQ '0'                        *B3            S01117
     C                     MOVE PRFCPR    IPRFC                           S01117
     C                     ELSE                                           S01117
     C           RTCDPR    IFEQ '2'                        *B4            S01117
     C           RTCDPR    OREQ '1'                                       CAC001
     C                     MOVE PRFCPR    IPRFC                           S01117
     C                     SETON                     99                   S01117
     C**********           ELSE                            *X4      S01117RT0067
     C**********           MOVEL'SDPRFMPD'DBFILE             *******S01117RT0067
     C**********           Z-ADD6         DBASE              * DB6 *S01117RT0067
     C**********           EXSR *PSSR                        *******S01117RT0067
     C**********           SETON                     41             S01117RT0067
     C**********           SETON                     U7U8LR         S01117RT0067
     C                     END                             *E4            S01117
     C                     END                             *E3            S01117
     C                     END                             *E2            S01117
     C                     END                             *E1            S01117
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C****************************************************************    S01117
     C**                                                                  S01117
     C**   *PSSR  SR TO DUMP PROGRAM WHEN DATABASE ERROR OCCURS           S01117
     C**                                                                  S01117
     C**      Called by     DBSR                                          S01413
     C**      Calls         -                                             S01413
     C**                                                                  S01413
     C           *PSSR     BEGSR                                          S01117
     C*                                                                   S01413
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01413
     C                     ENDSR                                          S01117
     C**                                                                  S01117
 839 C********************************************************************S01111
     C********************************************************************S01111
     C**                                                                  S01111
     C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND                     S01111
     C**              CONVERT TO A NUMBER OF DAYS.                        S01111
     C**                                                                  S01111
     C           ZDATE1    BEGSR                           *** ZDATE1 *** S01111
     C**                                                                  S01111
     C**   CLEAR DAY NUMBER.                                              S01111
     C                     Z-ADD0         ZDAYNO  50                      S01111
     C**                                                                  S01111
     C**   CALCULATION TO DEFINE INPUT DATE FIELD.                        S01111
     C                     Z-ADDZDATE     ZDATE   60                      S01111
     C**                                                                  S01111
     C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.                     S01111
     C                     MOVE ZDATE     ZYEAR   20                      S01111
     C  N98                MOVELZDATE     ZDAY    20                      S01111
     C   98                MOVELZDATE     ZMTH    20                      S01111
     C                     MOVE ZDATE     ZWRK4   40                      S01111
     C  N98                MOVELZWRK4     ZMTH                            S01111
     C   98                MOVELZWRK4     ZDAY                            S01111
     C**                                                                  S01111
     C**   ENSURE MONTH IS VALID.                                         S01111
     C           ZMTH      COMP 0                      9999               S01111
     C  N99      ZMTH      COMP 12                   99                   S01111
     C   99                GOTO ZDEND1                     BYPASS IF ERRORS01111
     C**                                                                  S01111
     C**   CHECK FOR 30 DAY MONTHS.                                       S01111
     C           ZMTH      COMP 4                        90IF 90 ON, 30   S01111
     C  N90      ZMTH      COMP 6                        90DAY MONTH.     S01111
     C  N90      ZMTH      COMP 9                        90               S01111
     C  N90      ZMTH      COMP 11                       90               S01111
     C**                                                                  S01111
     C**   ENSURE DAY IS VALID.                                           S01111
     C           ZDAY      COMP 0                      9999               S01111
     C   90N99   ZDAY      COMP 30                   99                   S01111
     C  N90N99   ZDAY      COMP 31                   99                   S01111
     C   99                GOTO ZDEND1                     BYPASS IF ERRORS01111
     C**                                                                  S01111
     C**   CHECK FOR LEAP YEAR AND FEBRUARY.                              S01111
     C           ZYEAR     ADD  28        ZYEAR                           S01111
     C           ZYEAR     DIV  4         ZLYR    20                      S01111
     C                     MVR            ZLY     10     91LEAP YR, 91 ON S01111
     C           ZMTH      COMP 2                    93  92FEB., 92 ON    S01111
     C**                                                   PAST FEB, 93 ONS01111
     C**   IF FEBUARY FURTHER VALIDATE DAY.                               S01111
     C  N91 92   ZDAY      COMP 28                   99                   S01111
     C   91 92   ZDAY      COMP 29                   99                   S01111
     C   99                GOTO ZDEND1                     BYPASS IF ERRORS01111
     C**                                                                  S01111
     C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANSS01111
     C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.S01111
     C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YRS01111
     C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.S01111
     C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR S01111
     C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTHS01111
     C**                                                                  S01111
     C           ZDEND1    TAG                                            S01111
     C                     SETOF                     90                   S01111
     C                     ENDSR                                          S01111
     C**                                                                  S01111
      *****************************************************************                       CRE020
      /EJECT                                                                                  CRE020
      *****************************************************************                       CRE020
      *                                                               *                       CRE020
      *  SRIDXT - Handles the advice index of the current             *                       CRE020
      *           transaction.                                        *                       CRE020
      *                                                               *                       CRE020
      *****************************************************************                       CRE020
     C           SRIDXT    BEGSR                                                              CRE020
      *                                                                                       CRE020
      ** Only process Customer Exchange transactions.                                         CRE020
      *                                                                                       CRE020
     C           *IN89     IFEQ *ON                                                           CRE020
      *                                                                                       CRE020
     C                     OPEN READVCL2                                                      CRE020
      *                                                                                       CRE020
     C                     MOVE *BLANKS   KREFNO                                              CRE020
     C                     MOVELDOCN      KREFNO                                              CRE020
     C                     MOVE *IN10     WIN10   1                                           CRE020
      *                                                                                       CRE020
     C           KADV2     CHAINREADVCL2             10                                       CRE020
      *                                                                                       CRE020
     C           *IN10     IFEQ *ON                                                           CRE020
     C                     MOVE *BLANKS   RREFNO                                              CRE020
     C                     MOVELDOCN      RREFNO                                              CRE020
     C                     MOVE *BLANKS   RPRGMN                                              CRE020
     C                     MOVEL'RE0150'  RPRGMN                                              CRE020
     C                     MOVE 'CE'      RTRTYP                                              CRE020
     C                     MOVE 'I'       RCHTYP                                              CRE020
     C                     MOVE 'Y'       RAUTHI                                              CRE020
     C                     MOVE 'N'       RSAPIN                                              CRE020
      *                                                                                       CRE020
      ** Write two records - DR and CR.                                                       CRE020
      *                                                                                       CRE020
     C                     DO   2         WIDX    10                                          CRE020
     C                     MOVE DCC,WIDX  RSEQNO                                              CRE020
     C                     WRITEREADVCD0                                                      CRE020
     C                     ENDDO                                                              CRE020
      *                                                                                       CRE020
      ** Write a charges record if necessary.                                                 CRE020
      *                                                                                       CRE020
     C           CHAMTO    IFNE *ZERO                                                         CRE020
     C                     MOVE DCC,3     RSEQNO                                              CRE020
     C                     WRITEREADVCD0                                                      CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ELSE                                                               CRE020
      *                                                                                       CRE020
      ** Check first if this is a new record.                                                 CRE020
      *                                                                                       CRE020
     C           RCHTYP    IFEQ 'I'                                                           CRE020
     C           RSAPIN    ANDEQ'N'                                                           CRE020
      *                                                                                       CRE020
      ** Delete DR, CR, and Charges records.                                                  CRE020
      *                                                                                       CRE020
     C                     DO   3         WIDX                                                CRE020
     C                     MOVE DCC,WIDX  KSEQNO                                              CRE020
     C           KADV1     CHAINREADVCL2             10                                       CRE020
     C           *IN10     IFEQ *OFF                                                          CRE020
     C                     MOVE 'D'       RCHTYP                                              CRE020
     C                     MOVE 'Y'       RSAPIN                                              CRE020
     C                     UPDATREADVCD0                                                      CRE020
     C                     ENDIF                                                              CRE020
     C                     ENDDO                                                              CRE020
      *                                                                                       CRE020
     C                     GOTO EIDXT                                                         CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** At this point, the current transaction was reversed.                                 CRE020
      *                                                                                       CRE020
     C                     DO   3         WIDX                                                CRE020
     C                     MOVE DCC,WIDX  KSEQNO                                              CRE020
     C           KADV1     CHAINREADVCL2             10                                       CRE020
     C           *IN10     IFEQ *OFF                                                          CRE020
     C                     MOVE 'D'       RCHTYP                                              CRE020
     C                     MOVE 'N'       RSAPIN                                              CRE020
     C                     UPDATREADVCD0                                                      CRE020
     C                     ENDIF                                                              CRE020
     C                     ENDDO                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C           EIDXT     TAG                                                                CRE020
      *                                                                                       CRE020
     C                     MOVE WIN10     *IN10                                               CRE020
      *                                                                                       CRE020
     C                     CLOSEREADVCL2                                                      CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDSR                                                              CRE020
      *****************************************************************                       CRE020
      /EJECT                                                                                  CRE020
      *****************************************************************                       CRE020
     C********************************************************************S01111
     C**                                                                  S01111
     C********************************************************************S01111
     C**                                                                  S01111
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.            S01111
     C**                                                                  S01111
     C           ZDATE2    BEGSR                           *** ZDATE2 *** S01111
     C**                                                                  S01111
     C**   CLEAR DATE FIELDS.                                             S01111
     C                     Z-ADD0         ZDATE   60                      S01111
     C                     MOVEL'       ' ZADATE  7                       S01111
     C**                                                                  S01111
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.                        S01111
     C                     Z-ADDZDAYNO    ZDAYNO  50                      S01111
     C**                                                                  S01111
     C**   DETERMINE YEAR NUMBER.                                         S01111
     C**                                                                  S01111
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    S01111
     C           ZDAYNO    SUB  1         ZDAYN1  50   99                 S01111
     C   99                GOTO ZDEND2                                    S01111
     C**                                                                  S01111
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             S01111
     C           ZDAYN1    DIV  1461      ZLYR    20                      S01111
     C                     MVR            ZDAYN1           SAVE REMAINING S01111
     C**                                                   DAYS           S01111
     C**   CALCULATE NUMBER OF REMAINING YEARS.                           S01111
     C                     Z-ADD1         ZWRK2   20                      S01111
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *S01111
     C           ZDAYN1    COMP ZYDY,ZWRK2             90                 S01111
     C  N90      ZWRK2     ADD  1         ZWRK2                           S01111
     C  N90                GOTO ZDTAG1                                    S01111
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON S01111
     C**                                                                  S01111
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  S01111
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          S01111
     C**                                                                  S01111
     C**   CALCULATE ACTUAL YEAR NUMBER.                                  S01111
     C           ZLYR      MULT 4         ZWRK3   30                      S01111
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972   S01111
     C                     Z-ADDZWRK3     ZYEAR   20                      S01111
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           S01111
     C**                                                                  S01111
     C**   DETERMINE MONTH NUMBER.                                        S01111
     C**                                                                  S01111
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         S01111
     C                     SETOF                     9293                 S01111
     C   91      ZDAYN1    COMP 59                     9293               S01111
     C   91N92   ZDAYN1    SUB  1         ZDAYN1                          S01111
     C**                                                                  S01111
     C**   CALCULATE MONTH NUMBER.                                        S01111
     C                     Z-ADD2         ZWRK2                           S01111
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *S01111
     C           ZDAYN1    COMP ZMDY,ZWRK2             94                 S01111
     C  N94      ZWRK2     ADD  1         ZWRK2                           S01111
     C  N94                GOTO ZDTAG2                                    S01111
     C           ZWRK2     SUB  1         ZWRK2                           S01111
     C**                                                                  S01111
     C                     Z-ADDZWRK2     ZMTH    20       MONTH          S01111
     C**                                                                  S01111
     C**   DETERMINE DAY OF MONTH.                                        S01111
     C**                                                                  S01111
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.                          S01111
     C           ZDAYN1    ADD  1         ZDAYN1                          S01111
     C**                                                                  S01111
     C**   CALCULATE DAY OF MONTH.                                        S01111
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            S01111
     C**                                                                  S01111
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       S01111
     C   93      ZDAY      ADD  1         ZDAY                            S01111
     C**                                                                  S01111
     C**   FORMAT DATE, DDMMYY OR MMDDYY.                                 S01111
     C  N98                MOVELZDAY      ZWRK4   40                      S01111
     C   98                MOVE ZDAY      ZWRK4                           S01111
     C  N98                MOVE ZMTH      ZWRK4                           S01111
     C   98                MOVELZMTH      ZWRK4                           S01111
     C                     MOVELZWRK4     ZDATE                           S01111
     C                     MOVE ZYEAR     ZDATE                           S01111
     C**                                                                  S01111
     C**   FORMAT ALPHA DATE, DDMMMYY.                                    S01111
     C           ZDAY      COMP 10                     95                 S01111
     C                     MOVELZDAY      ZWRK5   5                       S01111
     C   95                MOVEL' '       ZWRK5                           S01111
     C                     MOVE ZMNM,ZMTH ZWRK5                           S01111
     C                     MOVELZWRK5     ZADATE                          S01111
     C                     MOVE ZYEAR     ZADATE                          S01111
     C**                                                                  S01111
     C           ZDEND2    TAG                                            S01111
     C                     SETOF                     90                   S01111
     C                     ENDSR                                          S01111
     C**                                                                  S01111
     C********************************************************************CAC001
     C/EJECT                                                              CAC001
     C*****************************************************************   CAC001
     C*                                                               *   CAC001
     C*  Subroutine  :  SRNQDP                                        *   CAC001
     C*  Function    :  Get Normally-Quoted Decimal Places            *   CAC001
     C*                                                               *   CAC001
     C*  Called by   :         -                                      *   CAC001
     C*  Calls       :  -                                             *   CAC001
     C*                                                               *   CAC001
     C*****************************************************************   CAC001
     C*                                                                   CAC001
     C           SRNQDP    BEGSR                           ** SRNQDP **   CAC001
     C*                                                                   CAC001
     C*  --------------------------------------------------------------   CAC001
     C*  If either the DR or CR currency is the base currency, obtain     CAC001
     C*  the number of normally-quoted decimal places for the other       CAC001
     C*  currency. Otherwise:                                             CAC001
     C*      A)  If DNQDP =  CNQDP =  5         :   ZNQDPX = 5            CAC001
     C*      B)  If DNQDP =  CNQDP <> 5  or                               CAC001
     C*             DNQDP <> CNQDP                                        CAC001
     C*             1)  If Rate >= 100          :   ZNQDPX = 2            CAC001
     C*             2)  If 100 > Rate >= 20     :   ZNQDPX = 3            CAC001
     C*             3)  If 20  > Rate >= 1      :   ZNQDPX = 4            CAC001
     C*             4)  If 1   > Rate           :   ZNQDPX = 5            CAC001
     C* ---------------------------------------------------------------   CAC001
     C*                                                                   CAC001
     C                     SELEC                                          CAC001
     C*                                                                   CAC001
     C           CRCY      WHEQ BJCYCD                                    CAC001
     C                     Z-ADDDNQDP     ZNQDPX  10                      CAC001
     C*                                                                   CAC001
     C           DRCY      WHEQ BJCYCD                                    CAC001
     C                     Z-ADDCNQDP     ZNQDPX                          CAC001
     C*                                                                   CAC001
     C           DNQDP     WHEQ CNQDP                                     CAC001
     C           DNQDP     ANDEQ5                                         CAC001
     C                     Z-ADD5         ZNQDPX                          CAC001
     C*                                                                   CAC001
     C           EXRTN     WHEQ 100                                       CAC001
     C                     Z-ADD2         ZNQDPX                          CAC001
     C*                                                                   CAC001
     C           EXRTN     WHLT 100                                       CAC001
     C           EXRTN     ANDGE20                                        CAC001
     C                     Z-ADD3         ZNQDPX                          CAC001
     C*                                                                   CAC001
     C           EXRTN     WHLT 20                                        CAC001
     C           EXRTN     ANDGE1                                         CAC001
     C                     Z-ADD4         ZNQDPX                          CAC001
     C*                                                                   CAC001
     C           EXRTN     WHLT 1                                         CAC001
     C                     Z-ADD5         ZNQDPX                          CAC001
     C*                                                                   CAC001
     C                     ENDSL                                          CAC001
     C*                                                                   CAC001
     C           SRNQD9    ENDSR                           ** SRNQD9 **   CAC001
     C*                                                                   CAC001
     C********************************************************************CAC001
     C*                                                                   CAC001
     C/COPY ZSRSRC,ZACCH                                                                     BUG7274
     C/COPY ZSRSRC,ZCHKH                                                                     BUG7274
     C/COPY ZSRSRC,ZEDITZ2                                                CAC001
     C**                                                                  S01111
     C********************************************************************S01111
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0150CCP1                                           S01408
     C*                                                                   S01408
     C********************************************************************
1840 O**  OUTPUT TO WORKSTATION
1841 O**
1842 ORE0150FMD        01N41
1843 O       OR        02N41
1844 O       OR        03N41
     O       OR        82N41                                              S01413
1845 O       OR        79
1846 O                                   K8 'RE0150F1'
1847 O                         STID       2
     O                 01N45 70           2 'SE'                          S01413
1848 O                 01 45 70           2 'SI'
1849 O                 01 46 70           2 'SD'
1850 O                 79                 2 'SF'
     O                 61                 2 'SF'                          S01117
1851 O***********              MTIME     10 '  .  .  '                    S01413
1852 O***********              WSID      13                               S01413
1852 O                         USRID     12                               S01413
1852 O                         RUNA      19                               S01413
1852 O                         WSJOB     29                               S01413
1853 O                 43      DOCN      35                               S01413
1854 O                 43      ACTCD     36                               S01413
1853 O***********      43      DOCN      19                               S01413
1854 O***********      43      ACTCD     20                               S01413
1855 O********         87      SCFLDS   204                               S01111
1855 O********         87      SCFLDS   243                       S01111  SO5452
1855 O***********      87      SCFLDS   259                         S05452S01117
     O***********      87      SCFLDS   269                         S01117S01413
     O***********      87      SCFLDS   285                        S01413 CAC001
     O/COPY WNCPYSRC,RE0150O002
     O**********       87      SCFLDS   294                                            CAC001 CGL029
     O                 87      SCFLDS   312                                                   CGL029
     O                 85      DNAA     340                                                   CRE020
     O                 85      CNAA     368                                                   CRE020
     O/COPY WNCPYSRC,RE0150O003
     O**     44 - DELETE SCREEN
1857 O***********      44      BRCD      23                               S01117
     O                 44 56   BRCDD     39                               S01413
1858 O                 44 56   DCUS      45                               S01413
1859 O                 44 56   DACY      48                               S01413
1860 O**********       44 56   DCOD      52                                            S01413 CGL029
1861 O**********       44 56   DACS      54                                            S01413 CGL029
1862 O**********       44N56   DRAN      64                                            S01413 CGL029
1863 O**********       44N56   DACY      67                                            S01413 CGL029
1864 O**********       44    50DAMT      81 '           0 '                            S01413 CGL029
1865 O**********       44    51DAMT      81 '          0 . '                           S01413 CGL029
1866 O**********       44    52DAMT      81 '         0 .  '                           S01413 CGL029
1867 O**********       44    53DAMT      81 '        0 .   '                           S01413 CGL029
1868 O**********       44N57   CHQN      89                                            S01413 CGL029
1869 O**********       44      DRNA     119                                            S01413 CGL029
     O                 44 56   DCOD      58                                                   CGL029
     O                 44 56   DACS      60                                                   CGL029
     O                 44N56   DRAN      70                                                   CGL029
     O                 44N56   DACY      73                                                   CGL029
     O                 44    50DAMT      87 '           0 '                                   CGL029
     O                 44    51DAMT      87 '          0 . '                                  CGL029
     O                 44    52DAMT      87 '         0 .  '                                  CGL029
     O                 44    53DAMT      87 '        0 .   '                                  CGL029
     O                 44N57   CHQN      95                                                   CGL029
     O**********       44      DRNA     125                                            CGL029 CRE020
     O                 44N85   DRNA     125                                                   CRE020
     O                 44 85   DANA     340                                                   CRE020
     O***********      44 56   BRCDD     23                         S01117S01413
1858 O***********      44 56   DCUS      29                               S01413
1859 O***********      44 56   DACY      32                               S01413
1860 O***********      44 56   DCOD      36                               S01413
1861 O***********      44 56   DACS      38                               S01413
1862 O***********      44N56   DRAN      48                               S01413
1863 O***********      44N56   DACY      51                               S01413
1864 O***********      44    50DAMT      65 '           0 '               S01413
1865 O***********      44    51DAMT      65 '          0 . '              S01413
1866 O***********      44    52DAMT      65 '         0 .  '              S01413
1867 O***********      44    53DAMT      65 '        0 .   '              S01413
1868 O***********      44N57   CHQN      73                               S01413
1869 O***********      44      DRNA     103                               S01413
1870 O***********      44 29   CCUS     109                               S01117
1871 O***********      44 29   CACY     112                               S01117
1872 O***********      44 29   CCOD     116                               S01117
1873 O***********      44 29   CACS     118                               S01117
1874 O***********      44N29   CRAN     128                               S01117
1875 O***********      44N29   CACY     131                               S01117
1876 O***********      44    04CAMT     145 '           0 '               S01117
1877 O***********      44    05CAMT     145 '          0 . '              S01117
1878 O***********      44    06CAMT     145 '         0 .  '              S01117
1879 O***********      44    97CAMT     145 '        0 .   '              S01117
1880 O***********      44      CRNA     175                               S01117
1881 O***********      44    35BEQU     189 '           0 '         S05452S01117
1882 O***********      44    36BEQU     189 '          0 . '        S05452S01117
1883 O***********      44    37BEQU     189 '         0 .  '        S05452S01117
1884 O***********      44    38BEQU     189 '        0 .   '        S05452S01117
1885 O***********      44      ORIN     190                         S05452S01117
1886 O***********      44      CEXRT    204 '   0 .        '        S05452S01117
     O**********       44 29   BRCDC    122                                            S01413 CGL029
     O**********       44 29   CCUS     128                                            S01413 CGL029
     O**********       44 29   CACY     131                                            S01413 CGL029
     O**********       44 29   CCOD     135                                            S01413 CGL029
     O**********       44 29   CACS     137                                            S01413 CGL029
     O**********       44N29   CRAN     147                                            S01413 CGL029
     O**********       44N29   CACY     150                                            S01413 CGL029
     O**********       44    04CAMT     164 '           0 '                            S01413 CGL029
     O**********       44    05CAMT     164 '          0 . '                           S01413 CGL029
     O**********       44    06CAMT     164 '         0 .  '                           S01413 CGL029
     O**********       44    97CAMT     164 '        0 .   '                           S01413 CGL029
     O**********       44      CRNA     194                                            S01413 CGL029
     O**********       44    35BEQU     208 '           0 '                            S01413 CGL029
     O**********       44    36BEQU     208 '          0 . '                           S01413 CGL029
     O**********       44    37BEQU     208 '         0 .  '                           S01413 CGL029
     O**********       44    38BEQU     208 '        0 .   '                           S01413 CGL029
     O**********       44      ORIN     209                                            S01413 CGL029
     O**********       44      CEXRT    223 '   0 .        '                           S01413 CGL029
     O**********       44      PRFC     227                                            S01413 CGL029
     O                 44 29   BRCDC    128                                                   CGL029
     O                 44 29   CCUS     134                                                   CGL029
     O                 44 29   CACY     137                                                   CGL029
     O                 44 29   CCOD     147                                                   CGL029
     O                 44 29   CACS     149                                                   CGL029
     O                 44N29   CRAN     159                                                   CGL029
     O                 44N29   CACY     162                                                   CGL029
     O                 44    04CAMT     176 '           0 '                                   CGL029
     O                 44    05CAMT     176 '          0 . '                                  CGL029
     O                 44    06CAMT     176 '         0 .  '                                  CGL029
     O                 44    97CAMT     176 '        0 .   '                                  CGL029
     O**********       44      CRNA     206                                            CGL029 CRE020
     O                 44N85   CRNA     206                                                   CRE020
     O                 44 85   CANA     368                                                   CRE020
     O                 44    35BEQU     220 '           0 '                                   CGL029
     O                 44    36BEQU     220 '          0 . '                                  CGL029
     O                 44    37BEQU     220 '         0 .  '                                  CGL029
     O                 44    38BEQU     220 '        0 .   '                                  CGL029
     O                 44      ORIN     221                                                   CGL029
     O                 44      CEXRT    235 '   0 .        '                                  CGL029
     O                 44      PRFC     239                                                   CGL029
     O***********      44 29   BRCDC    106                         S01117S01413
     O***********      44 29   CCUS     112                         S01117S01413
     O***********      44 29   CACY     115                         S01117S01413
     O***********      44 29   CCOD     119                         S01117S01413
     O***********      44 29   CACS     121                         S01117S01413
     O***********      44N29   CRAN     131                         S01117S01413
     O***********      44N29   CACY     134                         S01117S01413
     O***********      44    04CAMT     148 '           0 '         S01117S01413
     O***********      44    05CAMT     148 '          0 . '        S01117S01413
     O***********      44    06CAMT     148 '         0 .  '        S01117S01413
     O***********      44    97CAMT     148 '        0 .   '        S01117S01413
     O***********      44      CRNA     178                         S01117S01413
     O***********      44    35BEQU     192 '           0 '         S01117S01413
     O***********      44    36BEQU     192 '          0 . '        S01117S01413
     O***********      44    37BEQU     192 '         0 .  '        S01117S01413
     O***********      44    38BEQU     192 '        0 .   '        S01117S01413
     O***********      44      ORIN     193                         S01117S01413
     O***********      44      CEXRT    207 '   0 .        '        S01117S01413
     O***********      44      PRFC     211                         S01117S01413
     O***********      44      DRVALD   210                         S01111S01117
     O***********      44      DRVALD   217                         S01117S01413
     O*****************44      DRVALD   233                         S01413CAC001
     O***********      44      CRVALD   216                         S01111S01117
     O***********      44      CRVALD   223                         S01117S01413
     O*****************44      CRVALD   239                         S01413CAC001
     O*****************44      CHCUS    222                               S01111
     O*****************44      CHACD    226                               S01111
     O*****************44      CHASQ    228                               S01111
     O*****************44      CHSGN    229                               S01111
     O*****************44      CHAMT    243                               S01111
     O***********      44      CHCN     222                         S01111S01117
     O***********      44      CHCD     226                         S01111S01117
     O***********      44      CHSQ     228                         S01111S01117
     O***********      44      CHSN     229                         S01111S01117
     O*****************44      CHCN     245                         S01413CAC001
     O*****************44      CHCD     249                         S01413CAC001
     O*****************44      CHSQ     251                         S01413CAC001
     O*****************44      CHSN     252                         S01413CAC001
     O***********      44      CHCN     229                         S01117S01413
     O***********      44      CHCD     233                         S01117S01413
     O***********      44      CHSQ     235                         S01117S01413
     O***********      44      CHSN     236                         S01117S01413
1864 O***********      44 86 50CHAM     243 '           0 '               S01117
1865 O***********      44 86 51CHAM     243 '          0 . '              S01117
1866 O***********      44 86 52CHAM     243 '         0 .  '              S01117
1867 O***********      44 86 53CHAM     243 '        0 .   '              S01117
1876 O***********      44N86 04CHAM     243 '           0 '               S01117
1877 O***********      44N86 05CHAM     243 '          0 . '              S01117
1878 O***********      44N86 06CHAM     243 '         0 .  '              S01117
1879 O***********      44N86 97CHAM     243 '        0 .   '              S01117
     O***********      44      SWCR     259                         S05452S01117
1864 O*****************44 86 50CHAM     266 '           0 '         S01413CAC001
1865 O*****************44 86 51CHAM     266 '          0 . '        S01413CAC001
1866 O*****************44 86 52CHAM     266 '         0 .  '        S01413CAC001
1867 O*****************44 86 53CHAM     266 '        0 .   '        S01413CAC001
1876 O*****************44N86 04CHAM     266 '           0 '         S01413CAC001
1877 O*****************44N86 05CHAM     266 '          0 . '        S01413CAC001
1878 O*****************44N86 06CHAM     266 '         0 .  '        S01413CAC001
1879 O*****************44N86 97CHAM     266 '        0 .   '        S01413CAC001
     O*****************44      SWCR     282                         S01413CAC001
     O*****************44      BRCDT    285                         S01413CAC001
1864 O***********      44 86 50CHAM     250 '           0 '         S01117S01413
1865 O***********      44 86 51CHAM     250 '          0 . '        S01117S01413
1866 O***********      44 86 52CHAM     250 '         0 .  '        S01117S01413
1867 O***********      44 86 53CHAM     250 '        0 .   '        S01117S01413
1876 O***********      44N86 04CHAM     250 '           0 '         S01117S01413
1877 O***********      44N86 05CHAM     250 '          0 . '        S01117S01413
1878 O***********      44N86 06CHAM     250 '         0 .  '        S01117S01413
1879 O***********      44N86 97CHAM     250 '        0 .   '        S01117S01413
     O***********      44      SWCR     266                         S01117S01413
     O***********      44      BRCDT    269                         S01117S01413
     O**********       44      SFXMP    235                                            CAC001 CGL029
     O**********       44      SFXIN    236                                            CAC001 CGL029
     O**********       44      DRVALD   242                                            CAC001 CGL029
     O**********       44      CRVALD   248                                            CAC001 CGL029
     O**********       44      CHCN     254                                            CAC001 CGL029
     O**********       44      CHCD     258                                            CAC001 CGL029
     O**********       44      CHSQ     260                                            CAC001 CGL029
     O**********       44      CHSN     261                                            CAC001 CGL029
     O**********       44 86 50CHAM     275 '           0 '                            CAC001 CGL029
     O**********       44 86 51CHAM     275 '          0 . '                           CAC001 CGL029
     O**********       44 86 52CHAM     275 '         0 .  '                           CAC001 CGL029
     O**********       44 86 53CHAM     275 '        0 .   '                           CAC001 CGL029
     O**********       44N86 04CHAM     275 '           0 '                            CAC001 CGL029
     O**********       44N86 05CHAM     275 '          0 . '                           CAC001 CGL029
     O**********       44N86 06CHAM     275 '         0 .  '                           CAC001 CGL029
     O**********       44N86 97CHAM     275 '        0 .   '                           CAC001 CGL029
     O**********       44      SWCR     291                                            CAC001 CGL029
     O**********       44      BRCDT    294                                            CAC001 CGL029
     O                 44      SFXMP    247                                                   CGL029
     O                 44      SFXIN    248                                                   CGL029
     O                 44      DRVALD   254                                                   CGL029
     O                 44      CRVALD   260                                                   CGL029
     O                 44      CHCN     266                                                   CGL029
     O                 44      CHCD     276                                                   CGL029
     O                 44      CHSQ     278                                                   CGL029
     O                 44      CHSN     279                                                   CGL029
     O                 44 86 50CHAM     293 '           0 '                                   CGL029
     O                 44 86 51CHAM     293 '          0 . '                                  CGL029
     O                 44 86 52CHAM     293 '         0 .  '                                  CGL029
     O                 44 86 53CHAM     293 '        0 .   '                                  CGL029
     O                 44N86 04CHAM     293 '           0 '                                   CGL029
     O                 44N86 05CHAM     293 '          0 . '                                  CGL029
     O                 44N86 06CHAM     293 '         0 .  '                                  CGL029
     O                 44N86 97CHAM     293 '        0 .   '                                  CGL029
     O                 44      SWCR     309                                                   CGL029
     O                 44      BRCDT    312                                                   CGL029
     O/COPY WNCPYSRC,RE0150O004
1887 O**      87 - INSERT SCREEN,WITH ERRORS                              S01111
1888 O**********       87      DASQ      54                                            S01413 CGL029
     O                 87      DASQ      60                                                   CGL029
     O                 87 39   DRBRCD    39                               S01413
1858 O                 87N21   DACNA     45                               S01413
1859 O                 87N22   DCCY      48                               S01413
1860 O**********       87N23   DACD      52                                            S01413 CGL029
     O                 87N23   DACD      58                                                   CGL029
1888 O***********      87      DASQ      38                         S01117S01413
     O***********      87 39   DRBRCD    23                         S01117S01413
1858 O***********      87N21   DACNA     29                         S01117S01413
1859 O***********      87N22   DCCY      32                         S01117S01413
1860 O***********      87N23   DACD      36                         S01117S01413
1862 O***********      87N25   DRAC      48                         S01111S01117
1862 O**********       87N25   DRACA     64                                            S01413 CGL029
     O**********       87      DRCY      67                                            S01413 CGL029
     O                 87N25   DRACA     70                                                   CGL029
     O                 87      DRCY      73                                                   CGL029
1862 O***********      87N25   DRACA     48                         S01117S01413
     O***********      87      DRCY      51                         LN0085S01413
1870 O***********      87N29   CACNA    109                         S01111S01117
1871 O***********      87N30   CCCY     112                         S01111S01117
1872 O***********      87N31   CACD     116                         S01111S01117
1874 O***********      87N33   CRAC     128                         S01111S01117
1889 O***********      87      CASQ     118                               S01117
     O***********      87      DRVALD   210                         S01111S01117
     O***********      87      CRVALD   216                         S01111S01117
1870 O**********       87N29   CACNA    128                                            S01413 CGL029
1871 O**********       87N30   CCCY     131                                            S01413 CGL029
1872 O**********       87N31   CACDA    135                                            S01413 CGL029
1874 O**********       87N33   CRACA    147                                            S01413 CGL029
     O**********       87 54   CRBRCD   122                                            S01413 CGL029
     O**********       87      CASQ     137                                            S01413 CGL029
     O**********       87      CRCY     150                                            S01413 CGL029
     O                 87N29   CACNA    134                                                   CGL029
     O                 87N30   CCCY     137                                                   CGL029
     O                 87N31   CACDA    147                                                   CGL029
     O                 87N33   CRACA    159                                                   CGL029
     O                 87 54   CRBRCD   128                                                   CGL029
     O                 87      CASQ     149                                                   CGL029
     O                 87      CRCY     162                                                   CGL029
1870 O***********      87N29   CACNA    112                         S01117S01413
1871 O***********      87N30   CCCY     115                         S01117S01413
1872 O***********      87N31   CACDA    119                         S01117S01413
1874 O***********      87N33   CRACA    131                         S01117S01413
     O***********      87 54   CRBRCD   106                         S01117S01413
     O***********      87      CASQ     121                         S01117S01413
     O***********      87      CRCY     134                         LN0085S01413
1890 O********         87N65 50DRAMN0    65 '           0 '               E13304
1890 O**********       87N65 50DRAMN0    81 '            0 '                           S01413 CGL029
1891 O**********       87N65 51DRAMN0    81 '          0 . '                           S01413 CGL029
1892 O**********       87N65 52DRAMN0    81 '         0 .  '                           S01413 CGL029
1893 O**********       87N65 53DRAMN0    81 '        0 .   '                           S01413 CGL029
     O                 87N65 50DRAMN0    87 '            0 '                                  CGL029
     O                 87N65 51DRAMN0    87 '          0 . '                                  CGL029
     O                 87N65 52DRAMN0    87 '         0 .  '                                  CGL029
     O                 87N65 53DRAMN0    87 '        0 .   '                                  CGL029
1890 O***********      87N65 50DRAMN0    65 '            0 '        E13304S01413
1891 O***********      87N65 51DRAMN0    65 '          0 . '              S01413
1892 O***********      87N65 52DRAMN0    65 '         0 .  '              S01413
1893 O***********      87N65 53DRAMN0    65 '        0 .   '              S01413
1894 O********         87N73 04CRAMN0   145 '           0 '               E13304
1894 O***********      87N73 04CRAMN0   145 '            0 '        E13304S01117
1895 O***********      87N73 05CRAMN0   145 '          0 . '              S01117
1896 O***********      87N73 06CRAMN0   145 '         0 .  '              S01117
1897 O***********      87N73 97CRAMN0   145 '        0 .   '              S01117
1898 O********         87N74 35BCEQ0    189 '           0 '         SO5452E13304
1898 O***********      87N74 35BCEQ0    189 '            0 '        E13304S01117
1899 O***********      87N74 36BCEQ0    189 '          0 . '        S05452S01117
1900 O***********      87N74 37BCEQ0    189 '         0 .  '        S05452S01117
1901 O***********      87N74 38BCEQ0    189 '        0 .   '        S05452S01117
1902 O***********      87N76   EXRTN    204 '   0 .        '        S05452S01117
     O**********       87N73 04CRAMN0   164 '            0 '                           S01413 CGL029
     O**********       87N73 05CRAMN0   164 '          0 . '                           S01413 CGL029
     O**********       87N73 06CRAMN0   164 '         0 .  '                           S01413 CGL029
     O**********       87N73 97CRAMN0   164 '        0 .   '                           S01413 CGL029
     O**********       87N74 35BCEQ0    208 '            0 '                           S01413 CGL029
     O**********       87N74 36BCEQ0    208 '          0 . '                           S01413 CGL029
     O**********       87N74 37BCEQ0    208 '         0 .  '                           S01413 CGL029
     O**********       87N74 38BCEQ0    208 '        0 .   '                           S01413 CGL029
     O**********       87N76   EXRTN    223 '   0 .        '                           S01413 CGL029
     O                 87N73 04CRAMN0   176 '            0 '                                  CGL029
     O                 87N73 05CRAMN0   176 '          0 . '                                  CGL029
     O                 87N73 06CRAMN0   176 '         0 .  '                                  CGL029
     O                 87N73 97CRAMN0   176 '        0 .   '                                  CGL029
     O                 87N74 35BCEQ0    220 '            0 '                                  CGL029
     O                 87N74 36BCEQ0    220 '          0 . '                                  CGL029
     O                 87N74 37BCEQ0    220 '         0 .  '                                  CGL029
     O                 87N74 38BCEQ0    220 '        0 .   '                                  CGL029
     O                 87N76   EXRTN    235 '   0 .        '                                  CGL029
     O***********      87N73 04CRAMN0   148 '            0 '        S01117S01413
     O***********      87N73 05CRAMN0   148 '          0 . '        S01117S01413
     O***********      87N73 06CRAMN0   148 '         0 .  '        S01117S01413
     O***********      87N73 97CRAMN0   148 '        0 .   '        S01117S01413
     O***********      87N74 35BCEQ0    192 '            0 '        S01117S01413
     O***********      87N74 36BCEQ0    192 '          0 . '        S01117S01413
     O***********      87N74 37BCEQ0    192 '         0 .  '        S01117S01413
     O***********      87N74 38BCEQ0    192 '        0 .   '        S01117S01413
     O***********      87N76   EXRTN    207 '   0 .        '        S01117S01413
1903 O******           87N65             52 ' '                           E11725
1904 O******           87N73            132 ' '                           E11725
1905 O******           87N74            176 ' '                SO5452     E11725
1906 O******           87N76            170 ' '                SO5452     E11725
1905 O******           87N74            192 ' '                SO5452     E11725
1906 O******           87N76            186 ' '                SO5452     E11725
     O***********      87      IPRFC    211                         S01117S01413
     O**********       87      IPRFC    227                                            S01413 CGL029
     O                 87      IPRFC    239                                                   CGL029
     O**********       87      DRVALD   210                         S01111S01117
     O***********      87      DRVALD   217                         S01117S01413
     O*****************87      DRVALD   233                         S01413CAC001
     O**********       87      CRVALD   216                         S01111S01117
     O***********      87      CRVALD   223                         S01117S01413
     O*****************87      CRVALD   239                         S01413CAC001
     O**********       87      CHCUS    222                         S01111S01117
     O***********      87      CHCUS    229                         S01117S01413
     O*****************87      CHCUS    245                         S01413CAC001
     O***********      87      CHACD    226                         S01111S01117
     O***********      87      CHACD    233                         S01117S01413
     O*****************87      CHACD    249                         S01413CAC001
     O***********      87      CHASQ    228                         S01111S01117
     O***********      87      CHASQ    235                         S01117S01413
     O*****************87      CHASQ    251                         S01413CAC001
     O***********      87      CHSGN    229                         S01111S01117
     O***********      87      CHSGN    236                         S01117S01413
     O*****************87      CHSGN    252                         S01413CAC001
     O***********      87      CHAMT    243                         S01111S01117
     O***********      87      CHAMT    250                         S01117S01413
     O*****************87      CHAMT    266                         S01413CAC001
     O***********      87      SWCRD    259                         S05452S01117
     O*****************87      SWCRD    282                         S01413CAC001
     O*****************87      TRBRCD   285                         S01413CAC001
     O***********      87      SWCRD    266                         S01117S01413
     O***********      87      TRBRCD   269                         S01117S01413
     O**********       87      SFXMP    235                                            CAC001 CGL029
     O**********       87      SFXIN    236                                            CAC001 CGL029
     O**********       87      DRVALD   242                                            CAC001 CGL029
     O**********       87      CRVALD   248                                            CAC001 CGL029
     O**********       87      CHCUS    254                                            CAC001 CGL029
     O**********       87      CHACD    258                                            CAC001 CGL029
     O**********       87      CHASQ    260                                            CAC001 CGL029
     O**********       87      CHSGN    261                                            CAC001 CGL029
     O**********       87      CHAMT    275                                            CAC001 CGL029
     O**********       87      SWCRD    291                                            CAC001 CGL029
     O**********       87      TRBRCD   294                                            CAC001 CGL029
     O                 87      SFXMP    247                                                   CGL029
     O                 87      SFXIN    248                                                   CGL029
     O                 87      DRVALD   254                                                   CGL029
     O                 87      CRVALD   260                                                   CGL029
     O                 87      CHCUS    266                                                   CGL029
     O                 87      CHACD    276                                                   CGL029
     O                 87      CHASQ    278                                                   CGL029
     O                 87      CHSGN    279                                                   CGL029
     O                 87      CHAMT    293                                                   CGL029
     O                 87      SWCRD    309                                                   CGL029
     O                 87      TRBRCD   312                                                   CGL029
     O/COPY WNCPYSRC,RE0150O005
1907 O**
1908 O********                 ERCD     324                               S01111
1909 O********                 ERMSG    332                               S01111
1908 O********                 ERCD     363                      S01111   SO5452
1909 O********                 ERMSG    371                      S01111   SO5452
1908 O***********              ERCD     379                         S05452S01117
1909 O***********              ERMSG    387                         S05452S01117
     O***********              ERCD     389                         S01117S01413
     O***********              ERMSG    397                         S01117S01413
     O*************************ERCD     406                         S01413CAC001
     O*************************ERMSG    437                         080721CAC001
     O************             ERMSG    414                         S01413080721
     O**********               ERCD     415                                            CAC001 CGL029
     O**********               ERMSG    446                                            CAC001 CGL029
     O**********               ERCD     433                                            CGL029 CRE020
     O**********               ERMSG    464                                            CGL029 CRE020
     O                         ERCD     489                                                   CRE020
     O                         ERMSG    520                                                   CRE020
     O**********               ERMSG1   540                                            CRE019 CAAA03
     O                         ERMSG1   596                                                   CAAA03
     O/COPY WNCPYSRC,RE0150O006
1917 O**
2077 O**
2078 O**  CUSEX FILE OUTPUT
2079 O**  INSERTION - NEW.
2080 OCUSEXCE E        89 02N19
2081 O                                    1 'D'
2082 O                         DOCN       7
2083 O***********              BRCDI     10                               S01117
     O                         DRBRCD    10                               S01117
2084 O                         RUND      13P
2085 O                         DRCNUM    19
2086 O**********               DRACOD    23                                                   CGL029
2087 O                         DRACSQ    25
2088 O                         DRAC      35
2089 O                      N22DCCY      38
2090 O                      N26DRCY      38
2091 O                         DRAMN0    45P
2092 O                         DNAR      75
2093 O                         DCHN      83
2094 O                         CRCNUM    89
2095 O**********               CRACOD    93                                                   CGL029
2096 O                         CRACSQ    95
2097 O                         CRAC     105
2098 O                      N30CCCY     108
2099 O                      N34CRCY     108
2100 O                         CRAMN0   115P
2101 O                         CNAR     145
2102 O                         EXRTN    152P
2103 O                         OIND     153
2104 O                         BCEQ0    160P
2105 O******                   BLNK93   253                               S01111
     O                         MBEI     161
     O                         CHCUSO   167                               S01111
     O**********               CHACDO   171                                            S01111 CGL029
     O                         CHASQO   173                               S01111
     O                         CHAMTO   180P                              S01111
     O                         CHSGNO   181                               S01111
     O                         CHRN     191                               S01111
     O                         DRVD     194P                              S01111
     O                         CRVD     197P                              S01111
     O******  NEXT FIELD ADDED FOR SAR5452  ********************
     O                         SWCRD    213                               S05452
     O/COPY WNCPYSRC,RE0150O007
     O                         CRBRCD   242                               S01117
     O                         IPRFC    246                               S01117
     O                         TRBRCD   249                               S01117
2106 O                         ACTCD    250
2107 O                         RUND     253P
2108 O                         NATN     256P
     O                         WFXMP    260P                              CAC001
     O                         MAMT     267P                              CAC001
     O                         ORAT     274P                              CAC001
     O                         SFXIN    275                               CAC001
     O                         DRACOD   285                                                   CGL029
     O                         CRACOD   295                                                   CGL029
     O                         CHACDO   305                                                   CGL029
     O                         DUPC     306                                                   CRE019
     O                         OUTR     307                                                   CRE019
2109 O**
2110 O**  INSERTION OVER DELETION
2111 OCUSEX   E        89 19 02
2112 O                       02           1 'D'
2113 O                         DOCN       7
2114 O***********              BRCDI     10                               S01117
     O                         DRBRCD    10                               S01117
2115 O                         RUND      13P
2116 O                         DRCNUM    19
2117 O**********               DRACOD    23                                                   CGL029
2118 O                         DRACSQ    25
2119 O                         DRAC      35
2120 O                      N22DCCY      38
2121 O                      N26DRCY      38
2122 O                         DRAMN0    45P
2123 O                         DNAR      75
2124 O                         DCHN      83
2125 O                         CRCNUM    89
2126 O**********               CRACOD    93                                                   CGL029
2127 O                         CRACSQ    95
2128 O                         CRAC     105
2129 O                      N30CCCY     108
2130 O                      N34CRCY     108
2131 O                         CRAMN0   115P
2132 O                         CNAR     145
2133 O                         EXRTN    152P
2134 O                         OIND     153
2135 O                         BCEQ0    160P
2136 O******                   BLNK93   253                               S01111
     O                         MBEI     161
     O                         CHCUSO   167                               S01111
     O**********               CHACDO   171                                            S01111 CGL029
     O                         CHASQO   173                               S01111
     O                         CHAMTO   180P                              S01111
     O                         CHSGNO   181                               S01111
     O                         CHRN     191                               S01111
     O                         DRVD     194P                              S01111
     O                         CRVD     197P                              S01111
     O******  NEXT FIELD ADDED FOR SAR5452  ********************
     O                         SWCRD    213                               S05452
     O/COPY WNCPYSRC,RE0150O008
     O                         CRBRCD   242                               S01117
     O                         IPRFC    246                               S01117
     O                         TRBRCD   249                               S01117
2137 O                         ACTCD    250
2138 O                         RUND     253P
2139 O                         NATN     256P
     O                         WFXMP    260P                              CAC001
     O                         MAMT     267P                              CAC001
     O                         ORAT     274P                              CAC001
     O                         SFXIN    275                               CAC001
     O                         DRACOD   285                                                   CGL029
     O                         CRACOD   295                                                   CGL029
     O                         CHACDO   305                                                   CGL029
     O                         DUPC     306                                                   CRE019
     O                         OUTR     307                                                   CRE019
2140 O**
2141 O        E        89 17 03
2142 O                                    1 'C'
2143 O**
2144 O**  UPDATE CONTROLS - CUSEX TRAILER
2145 O        E        88 13
2146 O                         NORE      10P
2147 O                         HRWN      18P
2148 O                         HRDC      20P
2146 O                         ACTCD    250
2147 O                         RUND     253P
2148 O                         NATN     256P
2149 O**
2150 O**  CUSEX - FILE RELEASE
2151 O        E        42
     O*                                                                   S01408
     O** Core hook for externalisation.                                   S01408
     O/COPY WNCPYSRC,RE0150OOPG                                           S01408
     O*                                                                   S01408
2152 O**
2153 O**  MEMOS FILE  UPDATE - IF RETAIL ACCOUNS INVOLVED
2154 O*MEMOS**E**********85*14*                                           CCB002
2155 O*************************GRBL      16                               CCB002
2156 O*************************NETB      31                               CCB002
2154 OPRONO   E                UPDPRO                                     E41808
2155 O                         PRBAL1    14P                              E41808
2155 O                         PRBAL2    22P                              E41808
2155 O                         PRBAL3    30P                              E41808
2155 O                         PRBAL4    38P                              E41808
2155 O                         PRBAL5    46P                              E41808
2152 O****RSACMTPD*-*ACCOUNT MOVEMENTS: S01154                     S01154 HK0000
2152 O*SACMTPOE****    85 14                                       S01154 HK0000
     O/COPY WNCPYSRC,RE0150O001
** ERRMSG - ERROR MESSAGES (LINE 7 REPLACED)
INVALID COMMAND KEY
INVALID INPUT
INVALID ACTION CODE
UNABLE TO UPDATE - LOAD RECOVERY PROCEDURE
INVALID UPDATE - THIS RECORD HAS SINCE BEEN UPDATED
RECORD ALREADY EXISTS
RECORD NOT FOUND / ALREADY DELETED                                        E11649
FILE FULL - LOAD INCREASE FILE PROCEDURE
LOG FILE FULL
RECORD NOT FOUND                                                          S01413
CUSTOMER EXCHANGE NUMBER XXXXXX INSERTED                                  S01413
DELETED CUSTOMER EXCHANGE                                                 S01413
USER NOT AUTHORISED TO THE ACTION CODE FOR THIS MENU ITEM                 S01117
USER NOT AUTHORISED TO ANY ACTION CODES FOR THIS MENU ITEM & BRANCH       S01117
USER NOT AUTHORISED TO THE ACTION CODE FOR THIS MENU ITEM & BRANCH        S01117
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN                    S01111
0366073110961461                                                          S01111
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR                        S01111
000031059090120151181212243273304334365                                   S01111
**   ZMNM - MONTHS SHORT NAMES                                            S01111
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC                                      S01111
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** AP - Array of powers of 10.
0000000001
0000000010
0000000100
0000001000
0000010000
0000100000
0001000000
0010000000
0100000000
1000000000
** DCC - Debit/Credit/Charges Text                                                            CRE020
DEB                                                                                           CRE020
CRE                                                                                           CRE020
CHA                                                                                           CRE020
** @TXT - TEXT STRINGS FOR OVERRIDE
DLTOVR     FILE(TTRANL7)
OVRDBF     FILE(TTRANL7) MBR(XXXX) SECURE(*YES) SHARE(*NO)  SEQONLY(*NO)
