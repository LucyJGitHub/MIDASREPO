0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Interest Dets-Initial Set-Up Scrn')
0001 H***********                                                         S01117
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Retail Module
0005 F*                                                               *
0006 F*  RE0210 - INTEREST DETAILS                                    *
0007 F*           INITIAL SCREEN SET-UP                               *
0008 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*      1990, 1993                                               *
0010 F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CAAA03             Date 17Mar04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01408             Date 12Sep96               *
     F*                 S01413             DATE 13APR93               *
     F*                 049680                  18JAN93               *
     F*                 S01199                  27FEB90               *
0011 F*                 S01194                  19FEB90               *
0011 F*                 S01117                  25JAN90               *
0012 F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CAAA03 - Webfacing Changes (Recompiled)                      *
     A*  S01408  -  Addition of core hook RE0210CCP5                  *
     A*          -  Addition of core hook RE0210CCP4                  *
     A*          -  Addition of core hook RE0210CCP3                  *
     A*          -  Addition of core hook RE0210CCP2                  *
     A*          -  Addition of core hook RE0210CCP1                  *
     A*          -  Addition of core hook RE0210IIP1                  *
     F*  S01413 - Retail 3 Incorporation                              *
     F*  049680 - Program no longer compiles at OS/400 release level  *
     F*           V2R2M0, because there are two I-spec lines for      *
     F*           one file, both without record-identifying           *
     F*           codes.                                              *
     F*  S01199 - HELP SYSTEM.                                        *
     F*  S01194 - NEW STANDING DATA                                   *
     F*  S01117 - MULTIBRANCHING. LDA POSITIONS CHANGED.              *
     F*                                                               *
0013 F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,RE0210F001
0016 FRE0210FMCF  F     623            WORKSTN
     F/COPY WNCPYSRC,RE0210F002
0017 F*
0018 F*TABLE***IF  F      96 12AI     2 DISK                              S01194
0019 F*
0020 F*       FUNCTION OF INDICATORS
0021 F*       STANDARD INPUT PROGRAM INDICATORS
0036 F*       NON-STANDARD INPUT PROGRAM INDICATORS
0015 F*       02      SET ON IF ERROR DURING READ FROM THE WORK STATION *
0014 F*       13      USED TO CONDITN 1ST TIME PASS THRU RPG CALC CYCLE *
0037 F*       60      OUTPUT TITLE 4
0038 F*       61      OUTPUT TITLE 3
0039 F*       62      OUTPUT TITLE 2
0040 F*       63      OUTPUT TITLE 1
0035 F*       77      SCREENS READ IN
0034 F*       78      SCREENS READ IN
0033 F*       79      SYSTEM SET-UP FLAG ON
0032 F*       80      BLINK DELETE CHECK FIELD LABEL
0031 F*       81      OUTPUT INITIAL - SF - SCREEN
0030 F*       82      OUTPUT INSERT - SI - SCREEN
0029 F*       83      OUTPUT AMEND - SA - SCREEN
0028 F*       84      OUTPUT DELETE - SD - SCREEN
0027 F*       85      OUTPUT ENQUIRE - SE - SCREEN
0026 F*       86      NON-DISPLAY USEFUL DATA
0025 F*       87      NON-DISPLAY CHANGE DETAILS
0024 F*       88      NON-DISPLAY ERROR MESSAGE/CODES
0023 F*       89      BLINK ACTION CODE LABEL
0022 F*       U7      DATABASE ERROR
0062 F*       HELP TEXT INDICATORS                                        S01199
0061 F*                                                                   S01199
0061 F*               INTEREST TYPE                                       S01199
0061 F*               ~~~~~~~~~~~~~                                       S01199
0061 F*           | 01    02    03   04                                   S01199
0061 F*       ----|---------------------                                  S01199
0061 F*       18  |  0     0     1    1                                   S01199
0061 F*       19  |  0     1     0    1                                   S01199
0061 F*                                                                   S01199
     F/EJECT
     E                    CPY@    1   1 80
0041 I*    WORKSTATION FILE
0042 I*
0043 IRE0210FMNS
0044 I*
     I** Record-ID codes cannot be blank on two I-specs for the same file,049680
     I** so remove catchall, as it is redundant in any case.              049680
0045 I***CATCH*ALL********************************************************049680
0046 I********NS                                                          049680
0047 I*
0048 I*****TABLE*FILE*-*INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0049 I**********                                                          S01194
0050 I*TABLE***NS       2 C0   3 C1  12 C1                                S01194
0051 I*******AND      13 C0                                               S01194
0052 I**********                              1   1 RECI                  S01194
0053 I**********                              2   30RECT                  S01194
0054 I**********                             12  130RCDE                  S01194
0055 I**********                             14  66 TITL                  S01194
0056 I**********                             67  67 DATF                  S01194
0057 I**********                             68  700DFBR                  S01194
0058 I**********                             74  74 MODI1                 S01194
0059 I**********                             75  75 MODI2                 S01194
0060 I**********                             76  76 MODI3                 S01194
0061 I**********                          P  77  790RUND                  S01194
0062 I**********                             80  86 RUNA                  S01194
0063 I**********                             87  870SFLG                  S01194
0064 I**********                          P  90  920LCD                   S01194
0065 I**********                             93  93 CHTP                  S01194
0066 I**********                          P  94  960TNLU                  S01194
0076 I**********                                                          S01194
0068 I*****CATCHALL                                                       S01194
0069 I********NS                                                          S01194
0070 I**********                                                          S01194
0071 I*    STANDARD LOCAL DATA AREA FIELDS
0072 I*
0073 ILDA        UDS                            256
0074 I                                        1   8 LPROC
0075 I***********                           134 138 LFILE                 S01117
0076 I***********                           139 167 LKEY                  S01117
0077 I***********                           168 175 LPROG                 S01117
0078 I***********                           176 1770LDBNO                 S01117
0183 I                                      134 141 LFILE                 S01117
0183 I                                      142 170 LKEY                  S01117
0183 I                                      171 180 LPROG                 S01117
0183 I                                      181 1830LDBNO                 S01117
0183 I                                      134 141 DBFILE                S01117
0183 I                                      142 170 DBKEY                 S01117
0183 I                                      171 180 DBPGM                 S01117
0183 I                                      181 1830DBASE                 S01117
0079 I***********                           181 1850LRUND                 S01117
0080 I***********                           186 192 LRUNA                 S01117
0081 I***********                           193 193 LDATF                 S01117
0082 I***********                           194 1940LSFLG                 S01117
0083 I***********                           195 1960LKEYL                 S01117
0084 I***********                           197 202 LISP                  S01117
0085 I***********                           203 203 LTWOL                 S01117
0086 I***********                           204 2040LLDLP                 S01117
0087 I***********                           205 2090LTNLU                 S01117
0088 I***********                           210 210 LDELM                 S01117
0089 I***********                           211 211 LDUD                  S01117
0190 I                                      187 1910LRUND                 S01117
0191 I                                      192 198 LRUNA                 S01117
0192 I                                      199 199 LDATF                 S01117
0193 I**********                            200 2000LSFLG           S01117S01194
0193 I                                      200 200 LSFLG                 S01194
0194 I                                      201 2020LKEYL                 S01117
0195 I                                      203 208 LISP                  S01117
0196 I                                      209 209 LTWOL                 S01117
0197 I                                      210 2100LLDLP                 S01117
0198 I                                      211 2150LTNLU                 S01117
0199 I                                      216 216 LDELM                 S01117
0200 I                                      217 217 LDUD                  S01117
0090 I*
0091 I* NON STANDARD LDA FIELD
0092 I*
0093 I                                      100 131 LTITL
0094 I                                      132 133 LITYP
     I*
     I*  RETRIEVE WSID FROM PROGRAM STATUS DATA STRUCTURE
     I*
     IPSDS       SDS
     I                                      244 246 WSID
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0210IIP1                                           S01408
      *                                                                   S01408
     I*                                                                   S01194
     I/EJECT
     C** PARAMETER LIST FOR PROGRAM 'AOBANKR0'                            S01194
     C           PLISTA    PLIST                                          S01194
     C                     PARM '*DBERR ' RTCD    7                       S01194
     C                     PARM '*FIRST ' OPTN    7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     C                     MOVEACPY@      BIS@   80
0095 C*  AMEND STANDARD INPUT PROGRAM FIELDS
0096 C*  WPROG IS THIS PROGRAM NAME
0097 C*
     C           *NAMVAR   DEFN           LDA
     C           *LOCK     IN   LDA
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0210CCP1                                           S01408
      *                                                                   S01408
     C**   Set up indicators for help text.                               S01199
     C           LITYP     IFEQ '01'                                      S01199
     C**   Interest type 01 - Tiered.                                     S01199
     C                     MOVE '0'       *IN18                           S01199
     C                     MOVE '0'       *IN19                           S01199
     C                     END                                            S01199
     C**                                                                  S01199
     C           LITYP     IFEQ '02'                                      S01199
     C**   Interest type 02 - Threshold.                                  S01199
     C                     MOVE '0'       *IN18                           S01199
     C                     MOVE '1'       *IN19                           S01199
     C                     END                                            S01199
     C**                                                                  S01199
     C           LITYP     IFEQ '03'                                      S01199
     C**   Interest type 03 - Tiered, minimum monthly balance.            S01199
     C                     MOVE '1'       *IN18                           S01199
     C                     MOVE '0'       *IN19                           S01199
     C                     END                                            S01199
     C**                                                                  S01199
     C           LITYP     IFEQ '04'                                      S01199
     C**   Interest type 04 - Threshold, minimum monthly balance.         S01199
     C                     MOVE '1'       *IN18                           S01199
     C                     MOVE '1'       *IN19                           S01199
     C                     END                                            S01199
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0210CCP2                                           S01408
      *                                                                   S01408
     C**                                                                  S01199
0098 C   13                READ RE0210FM                 02
0100 C                     SETOF                     02
0101 C                     MOVE 'RE0210  'WPROG   8
0102 C*
0103 C*  SET-UP STANDARD LDA
0104 C*
0105 C                     MOVE ' '       BLK29  29
0106 C                     MOVE '1  '     LPROC
0107 C                     MOVE BLK29     LKEY
0108 C                     MOVE WPROG     LPROG
0109 C                     Z-ADD0         LDBNO
0110 C                     MOVELWPROG     LISP
0111 C                     MOVE 'Y'       LTWOL
0112 C                     Z-ADD0         LLDLP
0113 C                     Z-ADD0         LTNLU
0114 C*
0115 C*  PROCESSING IN ONE CYCLE
0116 C*
0117 C*
0118 C* FIND WHICH TITLE IS REQUIRED
0119 C*
0120 C           LITYP     COMP '01'                     63
0121 C           LITYP     COMP '02'                     62
0122 C           LITYP     COMP '03'                     61
0123 C           LITYP     COMP '04'                     60
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0210CCP3                                           S01408
      *                                                                   S01408
0124 C*
0125 C* THIS PART OF THE TITLE DOES NOT VARY
0126 C*
0127 C                     MOVEL'INTEREST'WORKA  16
0128 C                     MOVE ' TYPE - 'WORKA
0129 C*
0130 C* THIS PART OF THE TITLE VARIES
0131 C*
0132 C   63                MOVEL'       0'WORKB  16
0133 C   63                MOVE '1/TIERED'WORKB
0134 C*
0135 C   62                MOVEL'    02/T'WORKB  16
0136 C   62                MOVE 'HRESHOLD'WORKB
0137 C*
0138 C   61                MOVEL'   03/TI'WORKB  16
0139 C   61                MOVE 'ERED,MMB'WORKB
0140 C*
0141 C   60                MOVEL'04/THRES'WORKB  16
0142 C   60                MOVE 'HOLD,MMB'WORKB
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0210CCP4                                           S01408
      *                                                                   S01408
0143 C*
0144 C* NOW MOVE CORRECT TITLE INTO STITL
0145 C*
0146 C                     MOVELWORKA     STITL  32
0147 C                     MOVE WORKB     STITL
0148 C                     MOVE STITL     LTITL
0149 C                     MOVE LITYP     SITYP   2
0151 C*
0152 C***EXECUTE*SYSTEM*SUBR.*ZSYSTM.                                     S01194
0153 C**********                                                          S01194
0154 C**********           EXSR ZSYSTM                                    S01194
0155 C*
     C**  ACCESS BANK DETAILS                                             S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'PLISTA                          S01194
     C*                                                                   S01194
0156 C**N99*****           GOTO NERR1                                     S01194
0157 C**********           SETON                     U7LR                 S01194
0158 C**********           MOVE 'TABLE'   LFILE                           S01194
0159 C**********           MOVELZTABKY    LKEY                            S01194
0160 C**********           MOVE '90'      LDBNO            ** DB ERROR 90 S01194
0161 C**********           GOTO END                                       S01194
0162 C**********                                                          S01194
0163 C********** NERR1     TAG                             ** NERR1 TAG   S01194
0164 C**********                                                          S01194
0165 C**********           MOVE RUND      LRUND                           S01194
0166 C**********           MOVE RUNA      LRUNA                           S01194
0167 C**********           MOVE DATF      LDATF                           S01194
0168 C**********           MOVE SFLG      LSFLG                           S01194
0165 C                     MOVE BJRDNB    LRUND                           S01194
0166 C                     MOVE BJMRDT    LRUNA                           S01194
0167 C                     MOVE BJDFIN    LDATF                           S01194
0168 C                     MOVE BJSUC     LSFLG                           S01194
0169 C*
0170 C*    SET INDICATORS AND O/P INITIAL SCREEN.
0171 C*
0172 C                     SETON                     8881
0173 C                     MOVE 'SF'      SID     2
0174 C                     MOVELWPROG     SPID    6
0175 C*
0176 C********** END       TAG                             ** END TAG     S01194
     C                     OUT  LDA
0177 C*
0178 C                     TIME           MTIME   60
0179 C*
     C   81                EXCPT
     C                     RETRN
0180 C********************************************************************
0181 C**
0182 C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
0183 C**********                                                          S01194
0184 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0185 C**********                                                          S01194
0186 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0187 C**********           MOVEL'01      'ZTABKY 12                       S01194
0188 C**********           MOVE '  10'    ZTABKY                          S01194
0189 C**********                                                          S01194
0190 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0191 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0192 C**********                                                          S01194
0193 C*****CHECK*SYSTEM*DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0194 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0195 C**********                                                          S01194
0196 C**********           ENDSR                                          S01194
0197 C**
0198 C**
0199 C********************************************************************
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0210CCP5                                           S01408
      *                                                                   S01408
     C/EJECT
0200 O*
0201 O*  WORKSTATION - INITIAL SCREEN OUTPUT
0202 O*
0203 ORE0210FME        81
0204 O                                   K8 'RE0210F1'
0205 O**********               RUNA       7                               S01194
0205 O                         BJMRDT     7                               S01194
0206 O                         SID        9
0207 O                         SPID      15
0208 O                         STITL     47
0209 O                         MTIME     55 '  .  .  '
0210 O                         WSID      58
0211 O                         SITYP     60
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
