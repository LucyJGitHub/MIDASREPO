0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Trans chgs - delete scrn validation')         *
0001 H***********                                                         S01117
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Retail Module
0005 F*                                                               *
0006 F*  RE0224 - TRANSACTION CHARGES INPUT - S/RETRG                 *
0007 F*           DELETE SCREEN VALIDATION                            *
0008 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*      1990                                                     *
0010 F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CER049             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01413             Date 13Apr93               *
      *                 E22021                  26Jun90               *
     F*                 S01199                  15FEB90               *
0011 F*                 S01117                  31JAN90               *
0012 F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CER049 - Stamp Tax                                           *
     F*  S01413  -  Retail 3 Incorporation                            *
     F*  E22021  -  LDA IS BEING LOCKED BY THIS PROGRAM BUT IT IS     *
     F*             NEEDED BY INSTRUCTION MANUAL PROGRAM ASWELL , IF  *
     F*             IT IS CALLED (THIS IS MODIFIED FOR RELEASE 10)    *
     F*  S01199  -  HELP CHANGES                                      *
0010 F*  S01117  -  MULTIBRANCHING                                    *
     F*                                                               *
0013 F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F/COPY WNCPYSRC,RE0224F001
0016 F***RE0220FMCF  F     271            WORKSTN                                             CER049
     FRE0220FMCF  F     272            WORKSTN                                                CER049
     F/COPY WNCPYSRC,RE0224F002
0017 F*
0020 F*
0021 F*       FUNCTION OF INDICATORS
0022 F*       STANDARD INPUT PROGRAM INDICATORS
     F*       KC      F3 PRESSED - END PROGRAM
0023 F*       U7      DATABASE ERROR
0024 F*       89      BLINK ACTION CODE LABEL
0025 F*       88      NON-DISPLAY ERROR MESSAGE/CODES
0026 F*       87      NON-DISPLAY CHANGE DETAILS
0027 F*       86      NON-DISPLAY USEFUL DATA
0028 F*       85      OUTPUT ENQUIRE - SE - SCREEN
0029 F*       84      OUTPUT DELETE - SD - SCREEN
0030 F*       83      OUTPUT AMEND - SA - SCREEN
0031 F*       82      OUTPUT INSERT - SI - SCREEN
0032 F*       81      OUTPUT INITIAL - SF - SCREEN
0033 F*       80      BLINK DELETE CHECK FIELD LABEL
0034 F*       79      SYSTEM SET-UP FLAG ON
0035 F*       78      SD SCREEN READ IN
0036 F*       77      DELETE INCLUDES SETTING RECI TO *, OTHERWISE LEAVE
0038 F*       75      FIRST CYCLE IND
0015 F*       02      SET ON IF ERROR DURING READ FROM THE WORK STATION *
     F********15*     HELP INDICATOR                                      S01199
0039 F*       NON-STANDARD INPUT PROGRAM INDICATORS
0040 E*    STANDARD TABLES/ARRAYS
0041 E                    ERCD       19  4               ERROR CODES
0042 E                    ERCM    1   2 79               ERROR MESSAGES
0043 E*    NON-STANDARD TABLES/ARRAYS
     E                    CPY@    1   1 80
     E/EJECT
0044 I*    STANDARD FILES
0045 I*
0046 I*    WORKSTATION FILE
0047 I*
0048 I*    FORMAT - DELETE SCREEN
0049 I*
0050 IRE0220FMNS  78   8 CS   9 CD
0051 I                                        1   7 SRUNA
0052 I                                        8   9 SID
0053 I                                       10  15 SPID
0054 I                                       16  23 STIME
0055 I                                       24  26 SWSID
0056 I*                                NON-STANDARD KEY FIELDS
0057 I                                       27  31 STTYP
0058 I                                       32  34 STCCY
0059 I*                                STANDARD ACTION CODE
     I/COPY WNCPYSRC,RE0224I001
0060 I                                       35  35 SACTN
     I/COPY WNCPYSRC,RE0224I008
0061 I*                                NON-STANDARD DETAIL SCREEN FIELDS
0062 I                                       36  49 SCHAM
0063 I                                       50  50 SDCAM
0064 I                                       51  64 SCHPC
0065 I                                       65  65 SDCPC
0066 I                                       66  66 SREBI
     I                                       67  67 SSTLB                                     CER049
0067 I*                                STANDARD STRING FIELDS
     I/COPY WNCPYSRC,RE0224I002
0068 I                                        1  61 SCN60
0069 I                                        1 256 SCN256
     I/COPY WNCPYSRC,RE0224I003
0070 I                                        1  35 SCNSF
0071 I                                       36 226 SCN35
     I/COPY WNCPYSRC,RE0224I004
0072 I*
0073 I*    CATCHALL
0074 I        NS
0075 I                                        8   9 SID
0096 I*
0097 I*    NON-STANDARD FILES
0098 I*
0099 I*    NON-STANDARD DATA STRUCTURES
0100 I*
0101 I*    STANDARD LOCAL DATA AREA FIELDS
0102 I*
0103 ILDA        UDS                            256
0104 I                                        1   8 LPROC
0105 I***********                           134 138 LFILE                 S01117
0106 I***********                           139 167 LKEY                  S01117
0107 I***********                           168 175 LPROG                 S01117
0108 I***********                           176 1770LDBNO                 S01117
0183 I                                      134 141 LFILE                 S01117
0183 I                                      142 170 LKEY                  S01117
0183 I                                      171 180 LPROG                 S01117
0183 I                                      181 1830LDBNO                 S01117
0183 I                                      134 141 DBFILE                S01117
0183 I                                      142 170 DBKEY                 S01117
0183 I                                      171 180 DBPGM                 S01117
0183 I                                      181 1830DBASE                 S01117
0109 I***********                           181 1850LRUND                 S01117
0110 I***********                           186 192 LRUNA                 S01117
0111 I***********                           193 193 LDATF                 S01117
0112 I***********                           194 1940LSFLG                 S01117
0113 I***********                           195 1960LKEYL                 S01117
0114 I***********                           197 202 LISP                  S01117
0115 I***********                           203 203 LTWOL                 S01117
0116 I***********                           204 2040LLDLP                 S01117
0117 I***********                           205 2090LTNLU                 S01117
0118 I***********                           210 210 LDELM                 S01117
0119 I***********                           211 211 LDUD                  S01117
0190 I                                      187 1910LRUND                 S01117
0191 I                                      192 198 LRUNA                 S01117
0192 I                                      199 199 LDATF                 S01117
0193 I**********                            200 2000LSFLG           S01117S01194
0193 I                                      200 200 LSFLG                 S01194
0194 I                                      201 2020LKEYL                 S01117
0195 I                                      203 208 LISP                  S01117
0196 I                                      209 209 LTWOL                 S01117
0197 I                                      210 2100LLDLP                 S01117
0198 I                                      211 2150LTNLU                 S01117
0199 I                                      216 216 LDELM                 S01117
0200 I                                      217 217 LDUD                  S01117
0120 I*
0121 I*    NON-STANDARD LDA FIELD
0122 I*
0123 I                                      104 133 LTRAN
     I*    WORKSTATION TRANSACTION FILE / DATA STRUCTURE
0164 IWTRAN      UDS                            860
0095 I                                        1   1 MRECI
0096 I                                        5   9 MTTYP
0097 I                                       10  12 MTCCY
     I/COPY WNCPYSRC,RE0224I005
0098 I                                       13  13 MRECT
0099 I                                    P  31  330MTNLU
0100 I                                    P  34  360MORED
0101 I                                    P  37  390MLCD
0102 I                                       40  40 MCHTP
0103 I                                    P  41  470MHASH
0104 I                                    P  48  540MCHAM
0105 I                                       55  56 MDCAM
0106 I                                    P  57  630MCHPC
0107 I                                       64  65 MDCPC
0108 I                                       66  66 MREBI
     I                                      129 129 MSTLB                                     CER049
     I/COPY WNCPYSRC,RE0224I009
     I                                      401 401 MRECP
     I                                    P 402 4040MSPAC1
     I                                    P 405 4070MSPAC2
     I                                      408 409 MWSID
     I                                      414 418 MFILE
     I                                      424 429 MLOGP
     I                                      430 430 MIND1
     I                                      431 431 MRECJ
     I                                      449 454 WTIME
     I/COPY WNCPYSRC,RE0224I010
     I                                      455 495 MSCND
     I                                      496 525 MTRAN
     I                                      526 716 MSCN35
     I/COPY WNCPYSRC,RE0224I006
0109 I**********                              1 128 MOLD1                                     CER049
     I                                        1 129 MOLD1                                     CER049
     I                                        1 200 WTRAN1
     I                                      201 400 WTRAN2
     I                                      401 600 WTRAN3
     I                                      601 800 WTRAN4
     I                                      801 860 WTRAN5
0110 I                                        1 200 OLD200
     I/COPY WNCPYSRC,RE0224I007
     I*
     I*  RETRIEVE WSID FROM PROGRAM STATUS DATA STRUCTURE
     I*
     IPSDS       SDS
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I/COPY WNCPYSRC,RE0224I011
     I/EJECT
     C                     MOVEACPY@      BIS@   80
0124 C*  FIRST CYCLE PROCESSING
0125 C*
     C           *NAMVAR   DEFN           LDA
     C           *NAMVAR   DEFN           WTRAN
     C************LOCK     IN   *NAMVAR                                   E22021
     C           *LOCK     IN   WTRAN                                     E22021
     C/COPY WNCPYSRC,RE0224C001
     C**
     C*    READ WORKSTATION FILE /*HELP*FACILITY*                         S01199
     C**
     C************IN15     DOUEQ'0'                                       S01199
     C                     UNLCKLDA                                       E22021
     C                     READ RE0220FM                 02
     C           *LOCK     IN   LDA                                       E22021
     C************IN15     IFEQ '1'                                       S01199
     C***********          MOVEAERCD      HERCD 160                       S01199
     C***********          MOVEL'RE0220'  HBPGM   8                       S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C***********          END                                            S01199
     C***********          END                                            S01199
0128 C                     SETOF                     02
0131 C*
0132 C*  SET-UP STANDARD INPUT PROGRAM FIELDS  -  WPROG IS THIS PROGRAM
0133 C*
0134 C                     MOVELLISP      WPROG   8
0135 C                     MOVE '4  '     WPROG
0136 C                     MOVELWPROG     SPID    6
0137 C*  SET-UP STANDARD LDA FIELDS
0138 C                     MOVE WPROG     LPROG
0139 C                     Z-ADD4         LLDLP
0140 C*  SET-UP STANDARD BLANK FIELDS
0141 C                     MOVE ' '       BLK200200
0142 C*
0143 C           LDATF     COMP 'M'                      98* DATE FORMAT
0144 C********** LSFLG     COMP 1                        79* SSF          S01194
0144 C           LSFLG     COMP 'Y'                      79* SSF          S01194
0145 C           LDELM     COMP '*'                      77* DELETE METHOD
0146 C*
0147 C                     Z-ADD0         ZERO05  50
0148 C*
0149 C*  LOG PROGRAM NAME
0150 C*
0151 C                     MOVE LISP      WLOGP   6
0152 C                     MOVE '9'       WLOGP
0153 C*
0154 C*  INITIALISE FIELD TO BLANK OUT KEY/ACTION CODE
0155 C*
     C/COPY WNCPYSRC,RE0224C002
0156 C                     MOVE ' '       BLK09   9
     C/COPY WNCPYSRC,RE0224C003
0157 C*
0158 C           ENDFC     TAG                             ** ENDFC TAG
0159 C*
0160 C*  INITIALISE STANDARD INDICATORS
0161 C                     SETON                     888786* NON-DISPLAY
0162 C                     SETOF                     8980  * BLINK LABELS
0163 C                     SETOF                     858483* OUTPUT
0164 C                     SETOF                     8281  * SCREENS
0166 C*
0167 C*  INITIALISE NON-STANDARD INDS
0168 C*
0169 C*
0170 C*  CHECK FOR CORRECT SCREEN READ IN
0171 C*
0172 C   78                GOTO PROCES
0173 C                     SETON                     U7LR
0174 C                     MOVE 'SCREN'   LFILE
0175 C                     MOVE BLK200    LKEY
0176 C                     MOVEL'SD'      LKEY
0177 C                     MOVE 'FOUND   'LKEY
0178 C                     MOVE SID       LKEY
0179 C                     MOVE '92'      LDBNO            ** DB ERROR 92
0180 C                     GOTO END
0181 C*
0182 C           PROCES    TAG                             ** PROCES TAG
0183 C*
0184 C*  CLEAR ERROR CODE ARRAY, RESET INDEX
0185 C*
0186 C                     MOVE BLK200    ERMSG  79
0187 C                     MOVE '    '    ERCD
0188 C                     Z-ADD0         S       20
0189 C*
0190 C*  IF F3, END THE PROGRAM
0191 C*
0192 C   KC                MOVEL'**      'LPROC
0193 C   KC                SETON                     LR
0194 C   KC                GOTO END
0195 C*
0196 C*  IF F12, OUTPUT BLANK INITIAL SCREEN
0197 C*
0198 C   KL                EXSR SUBSF
0199 C   KL                GOTO END
0200 C*
0201 C*  IF NOT F10, REOUTPUT DELETE SCREEN WITH MESSAGE
0202 C*
0203 C  NKJ                EXSR SUBSD
0204 C  NKJ                SETOF                     88
0205 C  NKJ      S         ADD  1         S
0206 C  NKJ                MOVE '916'     ERCD,S
0207 C  NKJ                MOVE ERCM,1    ERMSG
0208 C  NKJ                GOTO END
0209 C*
0216 C   U7                GOTO END
0218 C*
0219 C*  S IS NON-ZERO IF THERE ARE ANY ERRORS
0220 C*
0221 C           S         COMP 0                    8484
0222 C*
0223 C*  IF THERE ARE ANY ERRORS, REOUTPUT THE
0224 C*  DELETE SCREEN WITH ERROR CODES
0225 C*
0226 C   84                EXSR SUBSD
0227 C   84                SETOF                     88
0228 C   84                GOTO END
0229 C*
 233 C*  EXECUTE UPDATE PROGRAM
0234 C*
0236 C                     MOVE '9  '     LPROC
0237 C*
0238 C           END       TAG                             ** END TAG
0212 C*  UPDATE CHAIN TO THE WORKSTATION TRANSACTION FILE DS
0213 C*  DONE HERE TO GET THE DELETE CHECK FIELD.
0244 C                     TIME           MTIME   60
0214 C*
0215 C                     EXSR WTRUPD
0240 C*  SETOF OUTPUT INDS IF DATABASE ERROR
0241 C*
0242 C   U7                SETOF                     8184
0243 C*
     C   LR U7             EXSR *PSSR                                     S01117
     C   81
     COR 84                EXCPT
     C***********          OUT  *NAMVAR                                   E22021
     C                     OUT  WTRAN                                     E22021
     C                     OUT  LDA                                       E22021
0239 C*
     C                     RETRN
0245 C*
0246 C********************************************************************
0247 C**
0248 C**   SUBR. - TO SET UP INITIAL SCREEN OUTPUT
0249 C**
0250 C           SUBSF     BEGSR                           ***  SUBSF  ***
0251 C                     SETON                     81
0252 C                     MOVE '1  '     LPROC
0253 C                     MOVE 'SF'      SID
0254 C                     ENDSR
0255 C********************************************************************
0256 C**
0257 C**   SUBR. - TO SET UP DELETE SCREEN OUTPUT
0258 C**
0259 C           SUBSD     BEGSR                           ***  SUBSD  ***
0260 C                     SETON                     84
0261 C                     MOVE '4  '     LPROC
0262 C                     MOVE 'SD'      SID
0263 C                     ENDSR
0264 C********************************************************************
0265 C**
0266 C**   SUBR. - TO UPDATE THE WORKSTATION TRANSACTION FILE DS
0267 C**
0268 C           WTRUPD    BEGSR                           ***  WTRUPD ***
0903 C                     MOVE BLK200    WTRAN3
0904 C                     MOVE BLK200    WTRAN4
0905 C                     MOVE BLK200    WTRAN5
0269 C   77                MOVE '*'       MRECI
0444 C                     MOVE ZERO05    MTNLU
0445 C                     MOVE LRUND     MLCD
0444 C                     MOVE 'D'       MCHTP
0445 C                     MOVE 'D'       MRECP
0446 C                     MOVE ZERO05    MSPAC1                       91
0445 C                     MOVE ZERO05    MSPAC2
0446 C                     MOVE WSID2     MWSID                        91
0445 C                     MOVE LFILE     MFILE
0446 C                     MOVE WLOGP     MLOGP                        91
0445 C                     MOVE '1'       MIND1
0446 C                     MOVE 'D'       MRECJ                        91
0445 C                     MOVE MTIME     WTIME
0446 C                     MOVE SCNSF     MSCND                        91
0445 C                     MOVE LTRAN     MTRAN
     C/COPY WNCPYSRC,RE0224C006
0446 C                     MOVE SCN35     MSCN35                       91
     C/COPY WNCPYSRC,RE0224C004
0277 C                     ENDSR
     C/COPY WNCPYSRC,RE0224C005
0278 C********************************************************************
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
     C/EJECT
0279 O*  WORKSTATION - INITIAL SCREEN OUTPUT
0280 O*
0281 ORE0220FME        81
0282 O                                   K8 'RE0220F1'
0283 O                         SCN60     61
0284 O                         SID        9
0285 O                         SPID      15
0286 O                         MTIME     23 '  .  .  '
0287 O*  BLANK OUT KEY/ACTION CODE FOR F12 - REMOVED IN STANDARD PROG
     O/COPY WNCPYSRC,RE0224O001
0288 O                 KL      BLK09     35
0289 O*  ERROR FIELDS
0290 O                         ERCD     111
0291 O                         ERMSG    193
     O/COPY WNCPYSRC,RE0224O002
0292 O*
0293 O*  WORKSTATION - DELETE SCREEN OUTPUT
0294 O*
0295 O        E        84
0296 O                                   K8 'RE0220F3'
     O/COPY WNCPYSRC,RE0224O003
0297 O                         SCNSF     35
0298 O                         LTRAN     65
0299 O                         SCN35    256
     O/COPY WNCPYSRC,RE0224O004
0300 O                         SID        9
0301 O                         SPID      15
0302 O                         MTIME     23 '  .  .  '
0303 O*  ERROR FIELDS
     O/COPY WNCPYSRC,RE0224O005
0304 O                         ERCD     172
0305 O**********               ERMSG    254                                                   CER049
     O                         ERMSG    255                                                   CER049
     O/COPY WNCPYSRC,RE0224O006
0306 O*
**   ERROR MESSAGES
ENTER F10 KEY FOR DELETE
INCORRECT DELETE CHECK FIELD ENTERED
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
