0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Retl Charges Maint-Amend Scrn Valid')
0001 H***********
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Retail Module
0005 F*                                                               *
0006 F*  RE0233 - RETAIL CHARGES MAINTENANCE - S/RECRG                *
0007 F*           AMEND SCREEN VALIDATION                             *
0008 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*      1990, 1993                                               *
0010 F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 02Mar99               *
      *                 CTI002             Date 09Sep98               *
     F*                 S01413             DATE 13APR93               *
     F*                 S01194                  20FEB90               *
     F*                 S01199                  15FEB90               *
0011 F*                 S01117                  06NOV89               *
0011 F*                 E16097                  13DEC88               *
0012 F*                                                               *
0013 F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*  S01413 - Retail 3 Incorporation                              *
     F*  S01194 - NEW STANDING DATA                                   *
     F*  S01199 - HELP CHANGES                                        *
0009 F*  S01117 - MULTIBRANCHING                                      *
0010 F*  E16097 - PREVENT MINIMUM CHARGE BEING EQUAL TO MAX DEFAULT   *
0011 F*           VALUE.                                              *
0012 F*                                                               *
0013 F*****************************************************************
0012 F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0016 F***RE0230FMCF  F     318            WORKSTN                                             CGL029
     FRE0230FMCF  F     324            WORKSTN                                                CGL029
0020 F*TABLE**IF**F******96 12AI     2 DISK                               S01194
0021 F*
0022 F*       FUNCTION OF INDICATORS
0023 F*       STANDARD INPUT PROGRAM INDICATORS
0024 F*       U7      DATABASE ERROR
0025 F*       89      BLINK ACTION CODE LABEL
0026 F*       88      NON-DISPLAY ERROR MESSAGE/CODES
0027 F*       87      NON-DISPLAY CHANGE DETAILS
0028 F*       86      NON-DISPLAY USEFUL DATA
0029 F*       85      OUTPUT ENQUIRE - SE - SCREEN
0030 F*       84      OUTPUT DELETE - SD - SCREEN
0031 F*       83      OUTPUT AMEND - SA - SCREEN
0032 F*       82      OUTPUT INSERT - SI - SCREEN
0033 F*       81      OUTPUT INITIAL - SF - SCREEN
0034 F*       80      BLINK DELETE CHECK FIELD LABEL
0035 F*       79      SYSTEM SET-UP FLAG ON
0036 F*       78      SA SCREEN READ IN
0037 F*       77      FIRST CYCLE IND
0038 F*       76      UPDATE WORKSTATION TRANSACTION FILE
0038 F*       50      BLANK MINIMUM CHARGE DEFAULTS TO 99------99
0039 F*       NON-STANDARD INPUT PROGRAM INDICATORS
0040 F*       01      BLINK CHARGE SUB-TYPE LABEL
0041 F*       02      BLINK CURRENCY LABEL
0042 F*       03      BLINK TITLE LABEL
0043 F*       04      BLINK MINIMUM CHARGE LABEL
0044 F*       05      BLINK MAXIMUM CHARGE LABEL
0045 F*       06      BLINK REBATE LABEL
0046 F*       07      BLINK MIN. BAL. LABEL
0047 F*       08      BLINK EXCL. FIRST LABEL
0048 F*       09      BLINK ACCOUNT CODE LABEL
0015 F*       11      SET ON IF ERROR DURING READ FROM THE WORK STATION *
0049 F*       13      CURRENCY RECORD 1
0050 F*       14      ACCOUNT CODES RECORD 1
     F*       15      DUMMY RECORD INDICATOR
     F********16*     HELP INDICATOR                                      S01199
0051 E*    SUBROUTINE TABLES/ARRAYS
0052 E                    ZA1        16  1               ZALIGN/ZEDIT
0053 E                    ZA2        16  1               ZALIGN/ZEDIT
0054 E*    STANDARD TABLES/ARRAYS
0055 E                    ERCD       19  4               ERROR CODES
0056 E                    ERCM    1   1 79               ERROR MESSAGES
     E                    CPY@    1   1 80
0057 E*    NON-STANDARD TABLES/ARRAYS
0058 I*    STANDARD FILES
0059 I*
0060 I*    WORKSTATION FILE
0061 I*
0062 I*    FORMAT - AMEND SCREEN
0063 I*
0064 IRE0230FMNS  78   8 CS   9 CA
0065 I                                        1   7 SRUNA
0066 I                                        8   9 SID
0067 I                                       10  15 SPID
0068 I                                       16  23 STIME
0069 I                                       24  26 SWSID
0070 I*                                NON-STANDARD KEY FIELDS
0071 I                                       27  31 SCSTP
0072 I                                       32  34 SCCCY
0073 I*                                STANDARD ACTION CODE
0074 I                                       35  35 SACTN
0075 I*                                NON-STANDARD DETAIL SCREEN FIELDS
0076 I                                       36  65 SCHNM
0077 I                                       66  79 SMINC
0078 I                                       80  93 SMAXC
0079 I                                       94 107 SREB
0080 I                                      108 123 SPERM
0081 I                                      124 139 SEXBL
0082 I**********                            140 143 SACOD                                     CGL029
     I                                      140 149 SACOD                                     CGL029
0083 I*                                STANDARD STRING FIELDS
0084 I                                        1  61 SCN61
0085 I                                        1 256 SCN256
0086 I*
0087 I*    CATCHALL
0088 I        NS  15
0089 I                                        8   9 SID
0113 I*
0114 I*    NON-STANDARD FILES
0115 I*
0116 I*****TABLE*FILE*-*CURRENCIES RECORD 1.                              S01194
0117 I***********                                                         S01194
0118 I*TABLE**NS**13***1 CD   2 C2   3 C0                                 S01194
0119 I*******AND******13 C1                                               S01194
0120 I***********                             1   1 RECI                  S01194
0121 I***********                             2   30RECT                  S01194
0122 I***********                            10  12 CCY                   S01194
0123 I***********                            13  130SREC                  S01194
0124 I***********                            14  27 CCNM                  S01194
0125 I***********                         P  28  348SPOT                  S01194
0126 I***********                            35  37 CCYS                  S01194
0127 I***********                            38  380CDP                   S01194
0128 I***********                            39  390TNOT                  S01194
0129 I***********                            40  40 DCCY                  S01194
0130 I***********                            41  44 SRC1                  S01194
0131 I***********                            45  48 SRC2                  S01194
0132 I***********                            49  520TACC                  S01194
0133 I***********                            53  560TEQV                  S01194
0134 I***********                            57  600SWQV                  S01194
0135 I***********                            61  640TAC4                  S01194
0136 I***********                            65  680TAC5                  S01194
0137 I***********                            69  69 HIND                  S01194
0138 I***********                         P  70  768PART                  S01194
0139 I***********                            77  780SSNO                  S01194
0140 I***********                         P  79  858ERLC                  S01194
0141 I***********                            86  860MDIN                  S01194
0142 I***********                            87  870MDIA                  S01194
0143 I***********                            88  880MDIB                  S01194
0144 I***********                         P  90  920LCD                   S01194
0145 I***********                            93  93 CHTP                  S01194
0146 I***********                         P  94  960TNLU                  S01194
0147 I***********                                                         S01194
0148 I*****TABLE*FILE*-*ACCOUNT CODES RECORD 1.                           S01194
0149 I***********                                                         S01194
0150 I*TABLE**NS**14***1 CD   2 C3   3 C0                                 S01194
0151 I*******AND******13 C1                                               S01194
0152 I***********                             1   1 RECI                  S01194
0153 I***********                             2   30RECT                  S01194
0154 I***********                             9  120ACOD                  S01194
0155 I***********                            13  130SREC                  S01194
0156 I***********                            14  38 ACKN                  S01194
0157 I***********                            39  39 ATYP                  S01194
0158 I***********                         P  40  420SHLC                  S01194
0159 I***********                         P  43  450SHFC                  S01194
0160 I***********                            48  48 TITO                  S01194
0161 I***********                            49  520BSDR                  S01194
0162 I***********                            53  560BSCR                  S01194
0163 I***********                            57  600PLDR                  S01194
0164 I***********                            61  640PLCR                  S01194
0165 I***********                            65  740RPCD                  S01194
0166 I***********                            75  76 ACCS                  S01194
0167 I***********                            77  77 STYP                  S01194
0168 I***********                         P  90  920LCD                   S01194
0169 I***********                            93  93 CHTP                  S01194
0170 I***********                         P  94  960TNLU                  S01194
0171 I***********                                                         S01194
0172 I*****CATCHALL                                                       S01194
0173 I*******NS** 15                                                      S01194
0174 I*
0175 I*    NON-STANDARD DATA STRUCTURES
0176 I*
0177 I*****DATA*STRUCTURE*FOR TABLE FILE KEY                              S01194
0178 I***********                                                         S01194
0179 I*********** DS                                                      S01194
0180 I***********                             1  12 TABKEY                S01194
0181 I***********                             1   2 TAB2                  S01194
0182 I***********                             9  11 TAB3A                 S01194
0183 I***********                            10  12 TAB3B                 S01194
0184 I***********                             9  12 TAB4                  S01194
0185 I***********                            12  12 TAB1                  S01194
0186 I***********                             6  11 TAB6                  S01194
0090 I*
0091 I*    WORKSTATION TRANSACTION DATA STRUCTURE                      D
0092 I*
0093 IWTRN       UDS                            860
0094 I                                        1   1 MRECI
0095 I                                        3   40MCTYP
0096 I                                        5   90MCSTP
0097 I                                       10  12 MCCCY
0098 I                                       13  13 MRECT
0099 I                                    P  31  330MTNLU
0100 I                                    P  34  360MORED
0101 I                                    P  37  390MLCD
0102 I                                       40  40 MCHTP
0103 I                                    P  41  470MHASH
0104 I                                       48  77 MCHNM
0105 I                                    P  78  840MMINC
0106 I                                    P  85  910MMAXC
0107 I                                    P  92  980MREB
0108 I                                    P  99 1060MPERM
0109 I                                    P 107 1140MEXBL
0110 I**********                            115 1180MACOD                                     CGL029
     I                                      161 1700MACOD                                     CGL029
0111 I                                        1 160 MOLD1
0112 I                                        1 200 OLD200
     I                                      401 401 TYPED
     I                                    P 402 4040ZERO05
     I                                    P 405 4070ZERX05
     I                                      408 410 WWSID
     I                                      415 419 WLFILE
     I                                      425 430 WLOGP
     I                                      431 431 NUMB1
     I                                      432 432 TYPEA
     I                                      450 4550MTIME
     I                                      461 716 SCN256
0187 I*
0188 I*    STANDARD LOCAL DATA AREA FIELDS
0189 I*
0190 ILDA        UDS                            256
0191 I                                        1   8 LPROC
0192 I***********                           134 138 LFILE                 S01117
0193 I***********                           139 167 LKEY                  S01117
0194 I***********                           168 175 LPROG                 S01117
0195 I***********                           176 1770LDBNO                 S01117
0196 I***********                           181 1850LRUND                 S01117
0197 I***********                           186 192 LRUNA                 S01117
0198 I***********                           193 193 LDATF                 S01117
0199 I***********                           194 1940LSFLG                 S01117
0200 I***********                           195 1960LKEYL                 S01117
0201 I***********                           197 202 LISP                  S01117
0202 I***********                           203 203 LTWOL                 S01117
0203 I***********                           204 2040LLDLP                 S01117
0204 I***********                           205 2090LTNLU                 S01117
0205 I***********                           210 210 LDELM                 S01117
0206 I***********                           211 211 LDUD                  S01117
     I                                      134 141 LFILE                 S01117
     I                                      142 170 LKEY                  S01117
     I                                      171 180 LPROG                 S01117
     I                                      181 1830LDBNO                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I                                      187 1910LRUND                 S01117
     I                                      192 198 LRUNA                 S01117
     I                                      199 199 LDATF                 S01117
     I**********                            200 2000LSFLG           S01117S01194
     I                                      200 200 LSFLG                 S01194
     I                                      201 2020LKEYL                 S01117
     I                                      203 208 LISP                  S01117
     I                                      209 209 LTWOL                 S01117
     I                                      210 2100LLDLP                 S01117
     I                                      211 2150LTNLU                 S01117
     I                                      216 216 LDELM                 S01117
     I                                      217 217 LDUD                  S01117
     I**
     I**   RETRIEVE WSID FROM PROGRAM STATUS DATA STRUCTURE
     IPSDS       SDS
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I**
     ISDCURR    E DSSDCURRPD                                              S01194
      **   CURRENCY TYPE                                                  S01194
     I**
     ISDACOD    E DSSDACODPD                                              S01194
      **   ACCOUNT CODE                                                   S01194
     I**
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     C                     MOVEACPY@      BIS@   80
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOCURRR0                                       S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*MSG   ' RTCD    7                       S01194
     C                     PARM '*KEY   ' OPTN    7                       S01194
     C                     PARM           CKEY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOACODR0                                       S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM '*BLANKS' RTCD                            S01194
     C                     PARM '*KEY   ' OPTN                            S01194
     C**********           PARM           ACCD    4                                    S01194 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01194 CGL029
     C                     PARM           ACCD   10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   S01194
0207 C*  FIRST CYCLE PROCESSING
0208 C*
     C* DEFINE DATA STRUCTURES
     C           *NAMVAR   DEFN           LDA
     C           *NAMVAR   DEFN           WTRN
     C           *LOCK     IN   *NAMVAR
     C*
     C**
     C*    READ WORKSTATION FILE /*HELP*FACILITY*                         S01199
     C**
     C           *IN16     DOUEQ'0'
     C                     READ RE0230FM                 16
     C************IN16     IFEQ '1'                                       S01199
     C***********          MOVEAERCD      HERCD 160                       S01199
     C***********          MOVEL'RE0230  'HBPGM   8                       S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C***********          END                                            S01199
     C                     END
     C*
0212 C   77                GOTO ENDFC
0213 C                     SETON                     77
0214 C*
0215 C*  SET-UP STANDARD INPUT PROGRAM FIELDS  -  WPROG IS THIS PROGRAM
0216 C*
0217 C                     MOVELLISP      WPROG   8
0218 C                     MOVE '3  '     WPROG
0219 C                     MOVELWPROG     SPID    6
0220 C*  SET-UP STANDARD LDA FIELDS
0221 C                     MOVE WPROG     LPROG
0222 C                     Z-ADD3         LLDLP
0223 C*  SET-UP STANDARD BLANK FIELDS
0224 C                     MOVE ' '       BLK200200
0225 C*
0226 C           LDATF     COMP 'M'                      98* DATE FORMAT
0227 C********** LSFLG     COMP 1                        79* SSF          S01194
0227 C           LSFLG     COMP 'Y'                      79* SSF          S01194
0228 C*
0229 C                     Z-ADD0         ZERO05  50
0230 C                     Z-ADD0         ZERO13 130
0231 C*
0232 C*  LOG PROGRAM NAME
0233 C*
0234 C                     MOVE LISP      WLOGP   6
0235 C                     MOVE '9'       WLOGP
0236 C*
0237 C*  INITIALISE FIELD TO BLANK OUT KEY/ACTION CODE
0238 C*
0239 C                     MOVE ' '       BLK9    9
0240 C*
0241 C*  INITIALISE BLANKS TO TEST FOR BLANK INPUT FIELDS
0242 C*
0243 C**********           MOVE ' '       BLK4    4                                           CGL029
     C                     MOVE *BLANKS   BLK4   10                                           CGL029
0244 C                     MOVE ' '       BLK14  14
0245 C                     MOVE ' '       BLK16  16
0246 C*
0247 C           ENDFC     TAG                             ** ENDFC TAG
0248 C*
0249 C*  INITIALISE STANDARD INDICATORS
0250 C                     SETON                     888786* NON-DISPLAY
0251 C                     SETOF                     8980  * BLINK LABELS
0252 C                     SETOF                     858483* OUTPUT
0253 C                     SETOF                     8281  * SCREENS
0254 C                     SETOF                     76
0255 C*
0256 C*  INITIALISE NON-STANDARD INDS
0257 C*
0258 C                     SETOF                     010203* BLINK
0259 C                     SETOF                     040506* LABELS
0260 C                     SETOF                     070809* PROTECT
0261 C*
0262 C*  CHECK FOR CORRECT SCREEN READ IN
0263 C*
0264 C   78                GOTO PROCES
0265 C                     SETON                     U7LR
0266 C                     MOVE 'SCREN'   LFILE
0267 C                     MOVE BLK200    LKEY
0268 C                     MOVEL'SA'      LKEY
0269 C                     MOVE 'FOUND   'LKEY
0270 C                     MOVE SID       LKEY
0271 C                     MOVE '92'      LDBNO            ** DB ERROR 92
0272 C                     GOTO END
0273 C*
0274 C           PROCES    TAG                             ** PROCES TAG
0275 C*
0276 C*  CLEAR ERROR CODE ARRAY, RESET INDEX
0277 C*
0278 C                     MOVE BLK200    ERMSG  79
0279 C                     MOVE '    '    ERCD
0280 C                     Z-ADD0         S       20
0281 C*
0282 C*  IF F3, END THE PROGRAM
0283 C*
0284 C   KC                MOVEL'**      'LPROC
0285 C   KC                SETON                     LR
0286 C   KC                GOTO END
0287 C*
0288 C*  IF F12, OUTPUT BLANK INITIAL SCREEN
0289 C*
0290 C   KL                EXSR SUBSF
0291 C   KL                GOTO END
0292 C*
0293 C*  IF F10, OUTPUT ERROR MSG TO AMEND SCREEN
0294 C*
0295 C   KJ                EXSR SUBSA
0296 C   KJ                SETOF                     88
0297 C   KJ      S         ADD  1         S
0298 C   KJ                MOVE '915'     ERCD,S
0299 C   KJ                MOVE ERCM,1    ERMSG
0300 C   KJ                GOTO END
0301 C*
0302 C*  IF NO CMD KEY ENTERED, NOW VALIDATE DATA AMENDED
0303 C*
0310 C                     EXSR VALSA
0311 C*
0312 C*  S IS NON-ZERO IF THERE ARE ANY ERRORS
0313 C*
0314 C           S         COMP 0                    8383
0315 C*
0316 C*  IF THERE ARE ANY ERRORS, REOUTPUT THE
0317 C*  AMEND SCREEN WITH ERROR CODES
0318 C*
0319 C   83                EXSR SUBSA
0320 C   83                SETOF                     88
0321 C   83                GOTO END
0322 C*
0326 C*  EXECUTE LOGGING/UPDATE PROGRAM
0327 C*
0328 C                     SETON                     76
0329 C                     MOVE '9  '     LPROC
0330 C*
0331 C           END       TAG                             ** END TAG
0332 C*
0333 C*  SETOF OUTPUT INDS IF DATABASE ERROR
0334 C*
0336 C*
0337 C                     TIME           MTIME
     C  NLR                EXSR PREPUP
     C  NLR                EXCPT
     C   U7 LR             EXSR *PSSR                                     S01117
     C                     OUT  *NAMVAR
     C                     RETRN
0338 C*
0339 C********************************************************************
0340 C**
0341 C**   SUBR. - TO SET UP INITIAL SCREEN OUTPUT
0342 C**
0343 C           SUBSF     BEGSR                           ***  SUBSF  ***
0344 C                     SETON                     81
0345 C                     MOVE '1  '     LPROC
0346 C                     MOVE 'SF'      SID
0347 C                     ENDSR
0348 C********************************************************************
0349 C**
0350 C**   SUBR. - TO SET UP AMEND SCREEN OUTPUT
0351 C**
0352 C           SUBSA     BEGSR                           ***  SUBSA  ***
0353 C                     SETON                     83
0354 C                     MOVE '3  '     LPROC
0355 C                     MOVE 'SA'      SID
0356 C*
0357 C*  PROTECT NARRATIVE FIELDS IF SSF IS ON
0358 C*
0359 C*  79                SETON                     07
0360 C*
0361 C                     ENDSR
0362 C********************************************************************
0363 C**
0364 C**  SUBR. - TO VALIDATE DATA ENTERED ON THE AMEND SCREEN
0365 C**
0366 C           VALSA     BEGSR                           ***  VALSA  ***
0367 C*
0368 C*  TITLE IS OPTIONAL AND REQUIRES NO VALIDATION
0369 C*
0370 C***GET*NO.*OF*DECIMAL*PLACES FOR CURRENCY                           S01194
0371 C***********                                                         S01194
0372 C***********          MOVE BLK200    TABKEY                          S01194
0373 C***********          MOVE '20'      TAB2                            S01194
0374 C***********          MOVE '1'       TAB1                            S01194
0375 C***********          MOVE SCCCY     TAB3A                           S01194
0376 C***********          EXSR TABCHN                                    S01194
     C*                                                                   S01194
0370 C* CALL ACCESS PROGRAM TO GET NO. OF DECIMAL PLACES FOR CURRENCY     S01194
0371 C*                                                                   S01194
0372 C                     MOVE SCCCY     CKEY                            S01194
0373 C                     CALL 'AOCURRR0'PLIST1                          S01194
     C*                                                                   S01194
     C           RTCD      IFNE *BLANK                                    S01194
     C                     MOVEL'SDCURRPD'DBFILE                          S01194
     C                     MOVELSCCCY     DBKEY                           S01194
     C                     MOVEL'RE0233'  DBPGM                           S01194
     C                     Z-ADD55        DBASE            ** DB ERROR 55 S01194
     C                     SETON                     U7  LR               S01194
     C                     GOTO END                                       S01194
     C                     END                                            S01194
0377 C*
0378 C*  VALIDATE MINIMUM CHARGE
0379 C*
0380 C*  OPTIONAL
0381 C*
0382 C***********          Z-ADDCDP       ZADEC                           S01194
0382 C                     Z-ADDA6NBDP    ZADEC                           S01194
0383 C***********13        SUB  CDP       ZADIG                           S01194
0383 C           13        SUB  A6NBDP    ZADIG                           S01194
0384 C                     MOVE BLK16     ZFIELD
0385 C                     MOVE SMINC     ZFIELD
0386 C                     EXSR ZALIGN
0356 C                     MOVE ZFIELD    CMINC  130                      E16097
0357 C                     MOVEL'99999999'MINSUM 130                      E16097
0358 C                     MOVE '99999'   MINSUM                          E16097
0359 C           CMINC     IFEQ MINSUM                                    E16097
0360 C                     SETON                     99                   E16097
0361 C                     END                                            E16097
0387 C   99                SETON                     04
0388 C   04      S         ADD  1         S
0389 C   04                MOVE '010'     ERCD,S
0390 C   04                GOTO VALMXC
0391 C*
0392 C*  IF VALID MOVE INTO FIELD FOR OUTPUT TO MASTER FILE
0393 C*  AND FORMAT FOR OUTPUT TO SCREEN
0394 C*
0395 C                     MOVE ZFIELD    WMINC  130
0396 C                     EXSR ZEDIT
0397 C                     MOVE ZFIELD    SMINC
0398 C*
0399 C*  VALIDATE MAXIMUM CHARGE
0400 C*
0401 C*  OPTIONAL
0402 C*
0403 C           VALMXC    TAG                             ** VALMXC TAG
0404 C***********13        SUB  CDP       ZADIG                           S01194
0404 C           13        SUB  A6NBDP    ZADIG                           S01194
     C*
     C* BLANK DEFAULTS TO 99------99
     C*
     C           SMAXC     COMP BLK14                    50
     C   50                GOTO BIG
0405 C                     MOVE BLK16     ZFIELD
0406 C                     MOVE SMAXC     ZFIELD
0407 C                     EXSR ZALIGN
0408 C   99                SETON                     05
0409 C   05      S         ADD  1         S
0410 C   05                MOVE '011'     ERCD,S
0411 C   05                GOTO VALREB
0412 C*
0413 C* MAX CHARGE MUST EXCEED MIN CHARGE OR EQUAL IT
0414 C*
0415 C  N04                MOVE ZFIELD    WMAXC  130
0416 C  N04      WMAXC     COMP WMINC                  0505
0417 C   05      S         ADD  1         S
0418 C   05                MOVE '011'     ERCD,S
0419 C   05                GOTO VALREB
     C                     MOVE ZFIELD    WMAXC
0419 C                     GOTO NOTBIG
     C*
     C           BIG       TAG                             *** BIG TAG*
     C                     MOVEL'99999999'WMAXC
     C                     MOVE '99999'   WMAXC
     C*
0420 C*
0421 C*  IF VALID MOVE INTO FIELD FOR OUTPUT TO MASTER FILE
0422 C*  AND FORMAT FOR OUTPUT TO SCREEN
0423 C*
0424 C  N50                MOVE ZFIELD    WMAXC  130
0424 C   50                MOVE WMAXC     ZFIELD
     C           NOTBIG    TAG                             *NOTBIG TAG*
0425 C                     EXSR ZEDIT
0426 C                     MOVE ZFIELD    SMAXC
0427 C*
0428 C*  VALIDATE REBATE AMOUNT
0429 C*
0430 C*  OPTIONAL
0431 C*
0432 C           VALREB    TAG                             ** VALREB TAG
0433 C***********13        SUB  CDP       ZADIG                           S01194
0433 C           13        SUB  A6NBDP    ZADIG                           S01194
0434 C                     MOVE BLK16     ZFIELD
0435 C                     MOVE SREB      ZFIELD
0436 C                     EXSR ZALIGN
0437 C   99                SETON                     06
0438 C   06      S         ADD  1         S
0439 C   06                MOVE '012'     ERCD,S
0440 C   06                GOTO VALPER
0441 C*
0442 C*  IF VALID MOVE INTO FIELD FOR OUTPUT TO MASTER FILE
0443 C*  AND FORMAT FOR OUTPUT TO SCREEN
0444 C*
0445 C                     MOVE ZFIELD    WREB   130
0446 C                     EXSR ZEDIT
0447 C                     MOVE ZFIELD    SREB
0448 C*
0449 C*  VALIDATE PER. MIN. BAL.
0450 C*
0451 C*  OPTIONAL - MUST BE BLANK IF REBATE NOT ENTERED
0452 C*
0453 C           VALPER    TAG                             ** VALPER TAG
0454 C***********15        SUB  CDP       ZADIG                           S01194
0454 C           15        SUB  A6NBDP    ZADIG                           S01194
0455 C                     MOVE BLK16     ZFIELD
0456 C                     MOVE SPERM     ZFIELD
0457 C                     EXSR ZALIGN
0458 C   99                SETON                     07
0459 C   07      S         ADD  1         S
0460 C   07                MOVE '014'     ERCD,S
0461 C   07                GOTO VALEXF
0462 C*
0463 C                     SETOF                     07
0464 C                     MOVE ZFIELD    TEMP   150
0465 C  N06      WREB      COMP 0                        07
0466 C   07      TEMP      COMP 0                    0707
0467 C   07      S         ADD  1         S
0468 C   07                MOVE '013'     ERCD,S
0469 C   07                GOTO VALEXF
0470 C*
0471 C*  IF VALID MOVE INTO FIELD FOR OUTPUT TO MASTER FILE
0472 C*  AND FORMAT FOR OUTPUT TO SCREEN
0473 C*
0474 C                     MOVE ZFIELD    WPERM  150
0475 C                     EXSR ZEDIT
0476 C                     MOVE ZFIELD    SPERM
0477 C*
0478 C*  VALIDATE EXCL. FIRST BALANCE
0479 C*
0480 C*  OPTIONAL - MUST BE BLANK IF REBATE NOT ENTERED
0481 C*
0482 C           VALEXF    TAG                             ** VALEXF TAG
0483 C***********15        SUB  CDP       ZADIG                           S01194
0483 C           15        SUB  A6NBDP    ZADIG                           S01194
0484 C                     MOVE BLK16     ZFIELD
0485 C                     MOVE SEXBL     ZFIELD
0486 C                     EXSR ZALIGN
0487 C   99                SETON                     08
0488 C   08      S         ADD  1         S
0489 C   08                MOVE '016'     ERCD,S
0490 C   08                GOTO VALACC
0491 C*
0492 C                     SETOF                     08
0493 C                     MOVE ZFIELD    TEMP
0494 C  N06      WREB      COMP 0                        08
0495 C   08      TEMP      COMP 0                    0808
0496 C   08      S         ADD  1         S
0497 C   08                MOVE '015'     ERCD,S
0498 C   08                GOTO VALACC
0499 C*
0500 C*  IF VALID MOVE INTO FIELD FOR OUTPUT TO MASTER FILE
0501 C*  AND FORMAT FOR OUTPUT TO SCREEN
0502 C*
0503 C                     MOVE ZFIELD    WEXBL  150
0504 C                     EXSR ZEDIT
0505 C                     MOVE ZFIELD    SEXBL
0506 C*
0507 C*  VALIDATE ACCOUNT CODE
0508 C*
0509 C*  MANDATORY - MUST BE VALID INCOME/EXPENS
0510 C*
0511 C           VALACC    TAG                             ** VALACC TAG
0512 C*
0513 C           SACOD     COMP BLK4                     09
0514 C   09      S         ADD  1         S
0515 C   09                MOVE '017'     ERCD,S
0516 C   09                GOTO VALSAE
0517 C*
0518 C***********          MOVE BLK200    TABKEY                          S01194
0519 C***********          MOVE '30'      TAB2                            S01194
0520 C***********          MOVE '1'       TAB1                            S01194
0521 C***********          MOVE SACOD     TAB6                            S01194
0522 C***********          EXSR TABCHN                                    S01194
0518 C                     MOVE SACOD     ACCD                            S01194
0519 C                     CALL 'AOACODR0'PLIST2                          S01194
0520 C           RTCD      IFEQ *BLANKS                                   S01194
0521 C                     MOVE A5ACCD    SACOD                           S01194
     C                     END                                            S01194
0377 C*                                                                   S01194
0523 C***14******ACCS      COMP 'IN'                 0909                 S01194
0524 C***14*09***ACCS      COMP 'EX'                 0909                 S01194
0525 C**N14******          SETON                     09                   S01194
0526 C***09******S         ADD  1         S                               S01194
0527 C***09******          MOVE '018'     ERCD,S                          S01194
     C           RTCD      IFNE *BLANK                                    S01194
     C                     SETON                     09                   S01194
     C           S         ADD  1         S                               S01194
     C                     MOVE '018'     ERCD,S                          S01194
     C                     ELSE                                           S01194
     C*                                                                   S01194
     C           A5ACSC    IFNE 'IN'                                      S01194
     C           A5ACSC    ANDNE'EX'                                      S01194
     C                     SETON                     09                   S01194
     C           S         ADD  1         S                               S01194
     C                     MOVE '018'     ERCD,S                          S01194
     C                     END                                            S01194
     C*                                                                   S01194
     C                     END                                            S01194
0528 C*
0529 C           VALSAE    ENDSR                           **  VALSAE TAG
0530 C********************************************************************
0543 C********************************************************************
0544 C***********                                                         S01194
0545 C*****SUBR.*-*TO*CHAIN*TO TABLE FILE                                 S01194
0546 C***********                                                         S01194
0547 C***********TABCHN    BEGSR                           ***  TABCHN ***S01194
0548 C***********                                                         S01194
0549 C***********          SETOF                     131499               S01194
0550 C***********                                                         S01194
0551 C***********TABKEY    CHAINTABLE                99                   S01194
0552 C***********                                                         S01194
0553 C***********          ENDSR                                          S01194
0554 C********************************************************************
0544 C**
0545 C**   SUBR. - TO SET UP WTRN FOR OUTPUT
0546 C**
0547 C           PREPUP    BEGSR                           ***  PREPUP ***
0548 C**
     C                     MOVE ZERO05    MTNLU
     C                     MOVE LRUND     MLCD
     C                     MOVE 'A'       MCHTP
     C                     MOVE ZERO13    MHASH
     C                     MOVE SCHNM     MCHNM
     C                     MOVE WMINC     MMINC
     C                     MOVE WMAXC     MMAXC
     C                     MOVE WREB      MREB
     C                     MOVE WPERM     MPERM
     C                     MOVE WEXBL     MEXBL
     C                     MOVE SACOD     MACOD
     C                     MOVE 'D'       TYPED
     C                     MOVE ZERO05    ZERX05
     C                     MOVE WSID      WWSID
     C                     MOVE LFILE     WLFILE
     C                     MOVE '1'       NUMB1
     C                     MOVE 'A'       TYPEA
0552 C**
0553 C                     ENDSR
0554 C********************************************************************
0555 C**                                                                 *
0556 C**  ZEDIT SUBROUTINE TO INSERT A DECIMAL POINT INTO A NUMERIC FIELD*
0557 C**  AND TO BLANK OUT LEADING ZEROES.                               *
0558 C**      INPUT FIELDS:   ZFIELD 16/                                 *
0559 C*                       ZADEC                                      *
0560 C*                       ZADIG - NOT ACTUALLY USED                  *
0561 C*                                                                  *
0562 C*       ARRAYS    ZA1 ,ZA2   BOTH 16 ELEMENTS, EACH ONE BYTE LONG. *
0563 C*                                                                  *
0564 C*       OUTPUT FIELD   ZFIELD                                      *
0565 C*                                                                  *
0566 C           ZEDIT     BEGSR                           ***  ZEDIT  ***
0567 C**                                                                 *
0568 C*       SET UP WORK FIELDS                                         *
0569 C*                                                                  *
0570 C                     MOVEA' '       ZA1                            *
0571 C                     MOVEA' '       ZA2                            *
0572 C*                                                                  *
0573 C                     Z-ADD16        Z1      20                     *
0574 C                     Z-ADD16        Z2      20                     *
0575 C*                                                                  *
0576 C           16        SUB  ZADEC     ZADEC2  20                     *
0577 C*                                                                  *
0578 C*
0579 C                     MOVEAZFIELD    ZA1                            *
0580 C*                                                                  *
0581 C*       CHECK TO SEE IF THERE ARE ANY DECIMAL PLACES               *
0582 C*                                                                  *
0583 C           ZADEC     COMP 0                        91              *
0584 C   91                GOTO ZT20                                     *
0585 C**                                                                 *
0586 C           ZT10      TAG                             ** ZT10 TAG ***
0587 C**                                                                 *
0588 C*                                                                  *
0589 C*       SET UP DECIMALS                                            *
0590 C*                                                                  *
0591 C                     MOVE ZA1,Z1    ZA2,Z2                         *
0592 C           Z1        SUB  1         Z1                             *
0593 C           Z2        SUB  1         Z2                             *
0594 C*                                                                  *
0595 C           Z2        COMP 0                        90              *
0596 C   90                GOTO ZT30                                     *
0597 C*                                                                  *
0598 C*       CHECK IF END OF DECIMALS                                   *
0599 C**                                                                 *
0600 C           Z2        COMP ZADEC2               90                  *
0601 C   90                GOTO ZT10                                     *
0602 C*                                                                  *
0603 C**                                                                 *
0604 C*       PUT IN DECIMAL PLACE                                       *
0605 C*                                                                  *
0606 C                     MOVE '.'       ZA2,Z2                         *
0607 C           Z2        SUB  1         Z2                             *
0608 C*                                                                  *
0609 C           ZT20      TAG                             ** ZT20 TAG ***
0610 C*                                                                  *
0611 C*       SET UP INTEGERS                                            *
0612 C*                                                                  *
0613 C                     MOVE ZA1,Z1    ZA2,Z2                         *
0614 C           Z1        SUB  1         Z1                             *
0615 C           Z2        SUB  1         Z2                             *
0616 C**                                                                 *
0617 C           Z2        COMP 0                    90                  *
0618 C   90                GOTO ZT20                                     *
0619 C*                                                                  *
0620 C*       PUT IN LEADING BLANKS                                      *
0621 C*                                                                  *
0622 C           ZT30      TAG                             ** ZT30 TAG ***
0623 C**                                                                 *
0624 C                     Z-ADD1         Z2                             *
0625 C**                                                                 *
0626 C           ZT40      TAG                             ** ZT40 TAG ***
0627 C*                                                                  *
0628 C           ZA2,Z2    COMP '0'                  9090                *
0629 C   90      ZA2,Z2    COMP ' '                  9090                *
0630 C*                                                                  *
0631 C   90                GOTO ZT50                                     *
0632 C*                                                                  *
0633 C                     MOVE ' '       ZA2,Z2                         *
0634 C           Z2        ADD  1         Z2                             *
0635 C*                                                                  *
0636 C           Z2        COMP 16                     90                *
0637 C   90                GOTO ZT40                                     *
0638 C*                                                                  *
0639 C*       IF NO INTEGERS PUT IN LEADING ZERO                         *
0640 C*                                                                  *
0641 C           ZT50      TAG                             ** ZT50 TAG ***
0642 C*                                                                  *
0643 C                     Z-ADDZADEC2    Z2                             *
0644 C  N91      Z2        SUB  1         Z2                             *
0645 C           ZA2,Z2    COMP ' '                      90              *
0646 C   90                MOVE '0'       ZA2,Z2                         *
0647 C*                                                                  *
0648 C*                                                                  *
0649 C*       SET UP OUTPUT FIELD                                        *
0650 C*                                                                  *
0651 C           ZT60      TAG                             ** ZT60 TAG ***
0652 C*                                                                  *
0653 C                     MOVEAZA2       ZFIELD 16                      *
0654 C**                                                                 *
0655 C           ZEND      ENDSR                           ** ZEND **    *
0656 C*                                                                  *
0657 C********************************************************************
0658 C**
     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C**
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
0757 C**
0758 C**
0759 C********************************************************************
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
0760 O*  WORKSTATION - INITIAL SCREEN OUTPUT
0761 O*
0762 ORE0230FME        81
0763 O                                   K8 'RE0230F1'
0764 O                         SCN61     61
0765 O                         SID        9
0766 O                         SPID      15
0767 O                         MTIME     23 '  .  .  '
0768 O*  BLANK OUT KEY/ACTION CODE FOR F12 - REMOVED IN STANDARD PROG
0769 O                 KL      BLK9      35
0770 O*  ERROR FIELDS
0771 O                         ERMSG    114
0772 O                         ERCD     190
0773 O*
0774 O*  WORKSTATION - AMEND SCREEN OUTPUT
0775 O*
0776 ORE0230FME        83
0777 O                                   K8 'RE0230F2'
0778 O                         SCN256   256
0779 O                         SID        9
0780 O                         SPID      15
0781 O                         MTIME     23 '  .  .  '
0782 O*  FIELDS WHICH HAVE BEEN REFORMATED IF VALID
0783 O                         SMINC     79
0784 O                         SMAXC     93
0785 O                         SREB     107
0786 O                         SPERM    123
0787 O                         SEXBL    139
0788 O*  ERROR FIELDS
0789 O**********               ERMSG    222                                                   CGL029
0790 O**********               ERCD     298                                                   CGL029
0789 O                         ERMSG    228                                                   CGL029
0790 O                         ERCD     307                                                   CGL029
0791 O*
**   ERROR MESSAGES
F10 KEY NOT ALLOWED NOW
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
