      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Retl ICD by CCY Maint-Initial Screen')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module
     F*                                                               *
     F*  RE0240 - RETAIL ACCOUNT CHARGES MAINTENANCE                  *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*      1990,1993                                                *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CAAA03             Date 17Mar04               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 23Dec99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 S01413             DATE 13APR93               *
     F*                 S01117                  17APR90               *
     F*                 S01194                  17APR90               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CAAA03 - Webfacing Changes (Recompiled)                      *
     F*  CDE002 - Revenue Analysis.  New fields in display file.      *
     F*  S01413 -  Retail 3 Incorporation                             *
     F*  S01117 -  RELEASE TEN MULTIBRANCHING                         *
     F*  S01194 -  NEW STANDING DATA                                  *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0016 F***RE0240FMCF  F     188            WORKSTN                   RE0240S01413
     F***RE0240FMCF  F     893            WORKSTN                   S01413CDE002
     FRE0240FMCF  F     917            WORKSTN                            CDE002
0018 F*TABLE***IF**F      96 12AI     2 DISK                              S01194
0019 F*                                                                   RE0240
0020 F*       FUNCTION OF INDICATORS                                      RE0240
0014 F*  01   USED TO SUPPRESS READ OF SCREEN FORMAT                      RE0240
0015 F*  02   SET ON IF ERROR DURING READ FROM THE WORK STATION           RE0240
0021 F*       STANDARD INPUT PROGRAM INDICATORS                           RE0240
0022 F*       U7      DATABASE ERROR                                      RE0240
0023 F*       89      BLINK ACTION CODE LABEL                             RE0240
0024 F*       88      NON-DISPLAY ERROR MESSAGE/CODES                     RE0240
0025 F*       87      NON-DISPLAY CHANGE DETAILS                          RE0240
0026 F*       86      NON-DISPLAY USEFUL DATA                             RE0240
0027 F*       85      OUTPUT ENQUIRE - SE - SCREEN                        RE0240
0028 F*       84      OUTPUT DELETE - SD - SCREEN                         RE0240
0029 F*       83      OUTPUT AMEND - SA - SCREEN                          RE0240
0030 F*       82      OUTPUT INSERT - SI - SCREEN                         RE0240
0031 F*       81      OUTPUT INITIAL - SF - SCREEN                        RE0240
0032 F*       80      BLINK DELETE CHECK FIELD LABEL                      RE0240
0033 F*       79      SYSTEM SET-UP FLAG ON                               RE0240
0034 F*       78      SCREENS READ IN                                     RE0240
0035 F*       77      SCREENS READ IN                                     RE0240
0036 F*       76      SPARE                                               RE0240
0037 F*       NON-STANDARD INPUT PROGRAM INDICATORS                       RE0240
     F*       03      WORKSTN FILE                                        RE0240
     F********04      ICDR1                                               S01194
     F********05      ICDR1 CATCHALL                                      S01194
     F/EJECT
     E                    CPY@    1   1 80
0038 I*    WORKSTATION FILE                                               RE0240
0039 I*                                                                   RE0240
0040 IRE0240FMNS  03                                                      RE0240
0041 I*                                                                   RE0240
0042 I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
0043 I**********                                                          S01194
0044 I*TABLE***NS  04   2 C0   3 C1  12 C1                                S01194
0045 I*******AND      13 C0                                               S01194
0046 I**********                              1   1 RECI                  S01194
0047 I**********                              2   30RECT                  S01194
0048 I**********                             12  130RCDE                  S01194
0049 I**********                             14  66 TITL                  S01194
0050 I**********                             67  67 DATF                  S01194
0051 I**********                             68  700DFBR                  S01194
0052 I**********                             74  74 MODI1                 S01194
0053 I**********                             75  75 MODI2                 S01194
0054 I**********                             76  76 MODI3                 S01194
0055 I**********                          P  77  790RUND                  S01194
0056 I**********                             80  86 RUNA                  S01194
0057 I**********                             87  870SFLG                  S01194
0058 I**********                          P  90  920LCD                   S01194
0059 I**********                             93  93 CHTP                  S01194
0060 I**********                          P  94  960TNLU                  S01194
0061 I**********                                                          S01194
0062 I*****CATCHALL                                                       S01194
0063 I********NS  05                                                      S01194
0064 I*                                                                   RE0240
0065 I*    STANDARD LOCAL DATA AREA FIELDS                                RE0240
0066 I*                                                                   RE0240
0067 ILDA        UDS                            256                       RE0240
0068 I                                        1   8 LPROC                 RE0240
0069 I**********                            134 138 LFILE                 S01117
0070 I**********                            139 167 LKEY                  S01117
0071 I**********                            168 175 LPROG                 S01117
0072 I**********                            176 1770LDBNO                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
      *                                                                   S01117
0073 I***********                           181 1850LRUND                 S01117
0074 I***********                           186 192 LRUNA                 S01117
0075 I***********                           193 193 LDATF                 S01117
0076 I***********                           194 1940LSFLG                 S01117
0077 I***********                           195 1960LKEYL                 S01117
0078 I***********                           197 202 LISP                  S01117
0079 I***********                           203 203 LTWOL                 S01117
0080 I***********                           204 2040LLDLP                 S01117
0081 I***********                           205 2090LTNLU                 S01117
0082 I***********                           210 210 LDELM                 S01117
0083 I***********                           211 211 LDUD                  S01117
     I                                      187 1910LRUND                 S01117
     I                                      192 198 LRUNA                 S01117
     I                                      199 199 LDATF                 S01117
     I                                      200 200 LSFLG                 S01194
     I                                      201 2020LKEYL                 S01117
     I                                      203 208 LISP                  S01117
     I                                      209 209 LTWOL                 S01117
     I                                      210 2100LLDLP                 S01117
     I                                      211 2150LTNLU                 S01117
     I                                      216 216 LDELM                 S01117
     I                                      217 217 LDUD                  S01117
     I**                                                                  RE0240
     IPSDS       SDS                                                      RE0240
     I                                      244 246 WSID                  RE0240
     I                                      245 246 WSID2                 RE0240
     I**                                                                  RE0240
     ISDBANK    E DSSDBANKPD                                              S01194
      **  EXTERNAL DS FOR BANK DETAILS                                    S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I**
     I/EJECT
     C                     MOVEACPY@      BIS@   80
0086 C*                                                                   RE0240
     C           *NAMVAR   DEFN           LDA                             RE0240
     C           *LOCK     IN   *NAMVAR                                   RE0240
     C**                                                                  RE0240
     C   01                READ RE0240FM                 02
     C                     SETOF                     02
     C**                                                                  RE0240
0084 C*  AMEND STANDARD INPUT PROGRAM FIELDS                              RE0240
0085 C*  WPROG IS THIS PROGRAM NAME                                       RE0240
0086 C*                                                                   RE0240
0090 C                     MOVE 'RE0240  'WPROG   8                       RE0240
0091 C*                                                                   RE0240
0092 C*  SET-UP STANDARD LDA                                              RE0240
0093 C*                                                                   RE0240
0094 C                     MOVE ' '       BLK29  29                       RE0240
0095 C                     MOVE '1  '     LPROC                           RE0240
0096 C**********           MOVE BLK29     LKEY                            S01117
0097 C**********           MOVE WPROG     LPROG                           S01117
0098 C**********           Z-ADD0         LDBNO                           S01117
0096 C                     MOVE BLK29     DBKEY                           S01117
0097 C                     MOVE WPROG     DBPGM                           S01117
0098 C                     Z-ADD0         DBASE                           S01117
0099 C                     MOVELWPROG     LISP                            RE0240
0100 C                     MOVE 'N'       LTWOL                           RE0240
0101 C                     Z-ADD0         LLDLP                           RE0240
0102 C                     Z-ADD0         LTNLU                           RE0240
0103 C*                                                                   RE0240
0108 C*  EXECUTE ZSYSTM                                                   RE0240
0109 C*                                                                   RE0240
0110 C                     EXSR ZSYSTM                                    RE0240
0111 C*                                                                   RE0240
0112 C  N99                GOTO NERR1                                     RE0240
0113 C                     SETON                     U7LR                 RE0240
0114 C**********           MOVE 'TABLE'   LFILE                           S01117
0115 C**********           MOVELZTABKY    LKEY                            S01117
0116 C**********           MOVE '01'      LDBNO            * DB ERROR 01 *S01117
0114 C                     MOVE 'SDBANKPD'DBFILE                          S01117
     C                     MOVELOPTN      DBKEY                           S01117
0116 C                     MOVE '01'      DBASE            * DB ERROR 01 *S01117
0117 C                     GOTO END                                       RE0240
0118 C*                                                                   RE0240
0119 C           NERR1     TAG                             ** NERR1 TAG **RE0240
0120 C*                                                                   RE0240
0121 C**********           MOVE RUND      LRUND                           S01194
0122 C**********           MOVE RUNA      LRUNA                           S01194
0123 C**********           MOVE DATF      LDATF                           S01194
0124 C**********           MOVE SFLG      LSFLG                           S01194
0165 C                     MOVE BJRDNB    LRUND                           S01194
0166 C                     MOVE BJMRDT    LRUNA                           S01194
0167 C                     MOVE BJDFIN    LDATF                           S01194
0168 C                     MOVE BJSUC     LSFLG                           S01194
0125 C*                                                                   RE0240
0126 C*    SET INDICATORS AND O/P INITIAL SCREEN.                         RE0240
0127 C*                                                                   RE0240
0128 C                     SETON                     8881                 RE0240
0129 C                     MOVE 'SF'      SID     2                       RE0240
0130 C                     MOVELWPROG     SPID    6                       RE0240
0131 C*                                                                   RE0240
0132 C           END       TAG                             *** END TAG ***RE0240
0133 C*                                                                   RE0240
     C                     OUT  *NAMVAR                                   RE0240
0134 C                     TIME           WTIME   60                      RE0240
0135 C*                                                                   RE0240
     C   81                EXCPT                                          RE0240
0135 C*                                                                   RE0240
     C                     RETRN                                          RE0240
     C**                                                                  RE0240
0136 C********************************************************************RE0240
0137 C**                                                                  RE0240
0138 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   RE0240
0139 C**                                                                  RE0240
0140 C           ZSYSTM    BEGSR                           *** ZSYSTM *** RE0240
0141 C**                                                                  RE0240
0142 C*****SET*UP*KEY*FOR*INSTALLATION*CONTROL*RECORD.                    S01194
0143 C**********           MOVEL'01      'ZTABKY 12                       S01194
0144 C**********           MOVE '  10'    ZTABKY                          S01194
0145 C**********                                                          S01194
0146 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0147 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
     C*                                                                   S01194
     C                     CALL 'AOBANKR0'                                S01194
     C                     PARM '*DBERR'  RTCD    7                       S01194
     C                     PARM '*FIRST'  OPTN    7                       S01194
     C           SDBANK    PARM SDBANK    DSFDY                           S01194
0148 C**                                                                  RE0240
0149 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    RE0240
0150 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0150 C           BJDFIN    COMP 'M'                      98MMDDYY, 98 ON  S01194
0151 C**                                                                  RE0240
0152 C                     ENDSR                                          RE0240
0153 C**                                                                  RE0240
0154 C**                                                                  RE0240
0155 C********************************************************************RE0240
     C/EJECT
0156 O*                                                                   RE0240
0157 O*  WORKSTATION - INITIAL SCREEN OUTPUT                              RE0240
0158 O*                                                                   RE0240
0159 ORE0240FME        81                                                 RE0240
0160 O                                   K8 'RE0240F1'                    RE0240
0161 O**********               RUNA       7                               S01194
0161 O                         BJMRDT     7                               S01194
0162 O                         SID        9                               RE0240
0163 O                         SPID      15                               RE0240
0164 O                         WTIME     23 '  .  .  '                    RE0240
0165 O                         WSID      26                               RE0240
     O**                                                                  RE0240
     O********************************************************************RE0240
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
