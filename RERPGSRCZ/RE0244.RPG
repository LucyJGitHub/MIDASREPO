      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Retl ICD by Ccy Maint-Del Screen Val')
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Retail Module
0005 F*                                                               *
0006 F*  RE0244 - RETAIL ICD BY CCY MAINTENANCE - S/RECCY             *
0007 F*           DELETE SCREEN VALIDATION                            *
0008 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
0010 F*      1990,1993                                                *
0010 F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CSD027             Date 09Dec05               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 04Jan00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
0011 F*                 S01413             Date 13APR93               *
0011 F*                 S01117                  17APR90               *
0011 F*                 S01199                  17APR90               *
0012 F*                                                               *
0013 F*****************************************************************
0012 F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
     F*  CDE002 -  Revenue Analysis                                   *
0012 F*  S01413 -  Release 3 Incorporation.                           *
0012 F*  S01117 -  Release Ten Multibranching                         *
0012 F*  S01199 -  HELP Changes                                       *
0012 F*                                                               *
0013 F*****************************************************************
0012 F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0016 F***RE0240FMCF  F     275            WORKSTN                         S01413
     F***RE0240FMCF  F     893            WORKSTN                   S01413CDE002
     FRE0240FMCF  F     917            WORKSTN                            CDE002
     FTABTBRE IF  E                    DISK                               S01413
0020 F*                                                                   RE0244
0021 F*       FUNCTION OF INDICATORS                                      RE0244
     F*                                                                   RE0244
0015 F*       02      SET ON IF ERROR DURING READ FROM WORKSTATION      * RE0244
     F*                                                                   RE0244
     F*       03      WORKSTN FILE CATCHALL                               RE0244
     F*       04      WTRN FILE                                           RE0244
0015 F*       07      SET ON IF ERROR DURING READ FROM WORKSTATION        RE0244
     F*               **AND*USED*AS*HELP*INDICATOR                        S01199
     F*       35      OUTPUT 'PERCENT' OTHERWISE 'FIXED'.                 S01413
     F*       44      GROUP NO 1 ON FILE                                  S01413
     F*       45      GROUP NO 2 ON FILE                                  S01413
     F*       46      GROUP NO 3 ON FILE                                  S01413
     F*       47      GROUP NO 4 ON FILE                                  S01413
     F*       48      GROUP NO 5 ON FILE                                  S01413
     F*       49      GROUP NO 6 ON FILE                                  S01413
     F*       50      GROUP NO 7 ON FILE                                  S01413
     F*       51      GROUP NO 8 ON FILE                                  S01413
     F*                                                                   RE0244
0022 F*       STANDARD INPUT PROGRAM INDICATORS                           RE0244
     F*                                                                   RE0244
0037 F*       76      UPDATE WORKSTATION TRANSACTION FILE                 RE0244
0036 F*       77      DELETE INCLUDES SETTING RECI TO *, OTHERWISE LEAVE  RE0244
0035 F*       78      SD SCREEN READ IN                                   RE0244
0034 F*       79      SYSTEM SET-UP FLAG ON                               RE0244
0033 F*       80      BLINK DELETE CHECK FIELD LABEL                      RE0244
0032 F*       81      OUTPUT INITIAL - SF - SCREEN                        RE0244
0031 F*       82      OUTPUT INSERT - SI - SCREEN                         RE0244
0030 F*       83      OUTPUT AMEND - SA - SCREEN                          RE0244
0029 F*       84      OUTPUT DELETE - SD - SCREEN                         RE0244
0028 F*       85      OUTPUT ENQUIRE - SE - SCREEN                        RE0244
0027 F*       86      NON-DISPLAY USEFUL DATA                             RE0244
0026 F*       87      NON-DISPLAY CHANGE DETAILS                          RE0244
0025 F*       88      NON-DISPLAY ERROR MESSAGE/CODES                     RE0244
0024 F*       89      BLINK ACTION CODE LABEL                             RE0244
0023 F*       U7      DATABASE ERROR                                      RE0244
     F/EJECT                                                              RE0244
0041 E***********         ERCD       19  4               ERROR CODES      S01413
     E                    ERCD       38  4               ERROR CODES      S01413
0042 E***********         ERCM    1   1 79               ERROR MESSAGES   S01413
     E                    ERCM    1   2 79               ERROR MESSAGES   S01413
     E                    CPY@    1   1 80
     E/COPY ZSRSRC,ZEDITZ1                                                S01413
0047 I*                                                                   RE0244
0048 I*    FORMAT - DELETE SCREEN                                         RE0244
0049 I*                                                                   RE0244
0050 IRE0240FMNS  78   8 CS   9 CD                                        RE0244
0051 I                                        1   7 SRUNA                 RE0244
0052 I                                        8   9 SID                   RE0244
0053 I                                       10  15 SPID                  RE0244
0054 I                                       16  23 STIME                 RE0244
0055 I                                       24  26 SWSID                 RE0244
0057 I                                       27  29 SCCY                  RE0244
0059 I                                       30  30 SACTN                 RE0244
0061 I                                       31  44 SCCNM                 RE0244
0062 I                                       45  58 SMIDC                 RE0244
0063 I                                       59  72 SMADC                 RE0244
0064 I                                       73  86 SMICC                 RE0244
0065 I                                       87 100 SMACC                 RE0244
     I                                      101 111 SHORT                 S01413
     I                                      112 125 SHOMN                 S01413
     I                                      126 139 SHOMX                 S01413
     I                                      140 150 SACRT                 S01413
     I                                      151 164 SACMN                 S01413
     I                                      165 178 SACMX                 S01413
     I                                      179 189 SDIRT                 S01413
     I                                      190 203 SDIMN                 S01413
     I                                      204 217 SDIMX                 S01413
     I                                      218 231 SINFC                 S01413
     I                                      232 245 SMCFC                 S01413
     I                                      246 259 SAMBC                 S01413
     I                                      260 273 SMSFC                 S01413
     I                                      274 287 SAMBS                 S01413
     I                                      288 301 SDSFC                 S01413
     I                                      302 315 SDSMN                 S01413
     I                                      316 329 SDSMX                 S01413
     I                                      330 343 SFCFC                 S01413
     I**   FOLLOWING FIELDS ADDED                                         S01413
     I                                      344 344 SGPC1                 S01413
     I                                      345 366 SGPN1                 S01413
     I                                      367 380 SAMO1                 S01413
     I                                      381 381 SGPC2                 S01413
     I                                      382 403 SGPN2                 S01413
     I                                      404 417 SAMO2                 S01413
     I                                      418 418 SGPC3                 S01413
     I                                      419 440 SGPN3                 S01413
     I                                      441 454 SAMO3                 S01413
     I                                      455 455 SGPC4                 S01413
     I                                      456 477 SGPN4                 S01413
     I                                      478 491 SAMO4                 S01413
     I                                      492 492 SGPC5                 S01413
     I                                      493 514 SGPN5                 S01413
     I                                      515 528 SAMO5                 S01413
     I                                      529 529 SGPC6                 S01413
     I                                      530 551 SGPN6                 S01413
     I                                      552 565 SAMO6                 S01413
     I                                      566 566 SGPC7                 S01413
     I                                      567 588 SGPN7                 S01413
     I                                      589 602 SAMO7                 S01413
     I                                      603 603 SGPC8                 S01413
     I                                      604 625 SGPN8                 S01413
     I                                      626 639 SAMO8                 S01413
     I                                      640 651 SDRMG                 CDE002
     I                                      652 663 SCRMG                 CDE002
0066 I*    STANDARD STRING FIELDS                                         RE0244
0067 I                                        1  30 SCN30                 RE0244
     I                                       45 200 SCNXXX                S01413
     I                                        1 200 SCN060                S01413
     I                                      201 400 SCN080                S01413
     I                                      401 600 SCN100                S01413
     I                                      601 800 SCN120                S01413
     I**********                            801 876 SCN130          S01413CDE002
     I                                      801 917 SCN130                CDE002
0068 I                                        1 256 SCN256                RE0244
0069 I*                                                                   RE0244
0070 I*    CATCHALL                                                       RE0244
0071 I        NS  03                                                      RE0244
0072 I                                        8   9 SID                   RE0244
0091 I*                                                                   RE0244
0096 I*    LOCAL DATA AREA                                                RE0244
0097 I*                                                                   RE0244
0098 ILDA        UDS                            256                       RE0244
0099 I                                        1   8 LPROC                 RE0244
0069 I**********                            134 138 LFILE                 S01117
0070 I**********                            139 167 LKEY                  S01117
0071 I**********                            168 175 LPROG                 S01117
0072 I**********                            176 1770LDBNO                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I                                      134 141 LFILE                 S01117
     I                                      142 170 LKEY                  S01117
     I                                      171 180 LPROG                 S01117
     I                                      181 1830LDBNO                 S01117
      *                                                                   S01117
0073 I***********                           181 1850LRUND                 S01117
0074 I***********                           186 192 LRUNA                 S01117
0075 I***********                           193 193 LDATF                 S01117
0076 I***********                           194 1940LSFLG                 S01117
0077 I***********                           195 1960LKEYL                 S01117
0078 I***********                           197 202 LISP                  S01117
0079 I***********                           203 203 LTWOL                 S01117
0080 I***********                           204 2040LLDLP                 S01117
0081 I***********                           205 2090LTNLU                 S01117
0082 I***********                           210 210 LDELM                 S01117
0083 I***********                           211 211 LDUD                  S01117
     I                                      187 1910LRUND                 S01117
     I                                      192 198 LRUNA                 S01117
     I                                      199 199 LDATF                 S01117
     I                                      200 200 LSFLG                 S01194
     I                                      201 2020LKEYL                 S01117
     I                                      203 208 LISP                  S01117
     I                                      209 209 LTWOL                 S01117
     I                                      210 2100LLDLP                 S01117
     I                                      211 2150LTNLU                 S01117
     I                                      216 216 LDELM                 S01117
     I                                      217 217 LDUD                  S01117
     I**                                                                  RE0244
0086 I*TRAN******UDS                            860                       S01413
     IWTRAN      UDS                           1600                       S01413
     I***********                             1 200 WTRAN1                S01413
     I***********                           201 400 WTRAN2                S01413
     I                                        1 251 WTRAN1                S01413
     I                                      252 400 WTRAN2                S01413
     I                                      401 600 WTRAN3                RE0244
     I                                      601 800 WTRAN4                RE0244
     I***********                           801 860 WTRAN5                S01413
     I                                      8011000 WTRAN5                S01413
     I                                     10011200 WTRAN6                S01413
     I                                     12011400 WTRAN7                S01413
     I                                     14011600 WTRAN8                S01413
0087 I                                        1   1 WRECI                 RE0244
0088 I                                       10  12 WCCY                  RE0244
0089 I                                       13  13 WRECT                 RE0244
0090 I                                    P  31  330WTNLU                 RE0244
0091 I                                    P  34  360WORED                 RE0244
0092 I                                    P  37  390WLCD                  RE0244
0093 I                                       40  40 WCHTP                 RE0244
0094 I                                    P  41  470WHASH                 RE0244
0095 I                                    P  48  540WMIDC                 RE0244
0096 I                                    P  55  610WMADC                 RE0244
0097 I                                    P  62  680WMICC                 RE0244
0098 I                                    P  69  750WMACC                 RE0244
     I                                    P 129 1340WHORT                 S01413
     I                                    P 135 1410WHOMN                 S01413
     I                                    P 142 1480WHOMX                 S01413
     I                                    P 149 1540WACRT                 S01413
     I                                    P 155 1610WACMN                 S01413
     I                                    P 162 1680WACMX                 S01413
     I                                    P 169 1740WDIRT                 S01413
     I                                    P 175 1810WDIMN                 S01413
     I                                    P 182 1880WDIMX                 S01413
     I                                    P 189 1950WINFC                 S01413
     I                                    P 196 2020WMCFC                 S01413
     I                                    P 203 2090WAMBC                 S01413
     I                                    P 210 2160WMSFC                 S01413
     I                                    P 217 2230WAMBS                 S01413
     I                                    P 224 2300WDSFC                 S01413
     I                                    P 231 2370WDSMN                 S01413
     I                                    P 238 2440WDSMX                 S01413
     I                                    P 245 2510WFCFC                 S01413
     I** FOLLOWING FIELDS ADDED                                           S01413
     I                                    P 252 2583WAMO1                 S01413
     I                                    P 259 2653WAMO2                 S01413
     I                                    P 266 2723WAMO3                 S01413
     I                                    P 273 2793WAMO4                 S01413
     I                                    P 280 2863WAMO5                 S01413
     I                                    P 287 2933WAMO6                 S01413
     I                                    P 294 3003WAMO7                 S01413
     I                                    P 301 3073WAMO8                 S01413
     I                                      338 338 WFCUS                 S01413
     I                                      339 339 WCUSF                 S01413
     I                                    P 340 3457WDRMG                 CDE002
     I                                    P 346 3517WCRMG                 CDE002
0099 I***********                             1 128 WOLD1                 S01413
     I                                        1 251 WOLD1                 S01413
     I                                      252 307 WOLD2                 S01413
     I                                      401 401 W401                  RE0244
     I                                    P 402 4040W404                  RE0244
     I                                    P 405 4070W407                  RE0244
     I                                      408 409 WWSID2                RE0244
     I                                      414 418 WFILE                 RE0244
     I                                      424 429 WLOGP                 RE0244
     I                                      430 430 W430                  RE0244
     I                                      431 431 W431                  RE0244
     I                                      449 4540WTIME                 RE0244
     I                                      461 716 WCN256                RE0244
     I                                      601 800 WCN060                S01413
     I                                      8011000 WCN080                S01413
     I                                     10011200 WCN100                S01413
     I                                     12011400 WCN120                S01413
     I                                     14011476 WCN130                S01413
0101 I*                                                                   RE0244
     IPSDS       SDS                                                      RE0244
     I                                     *PROGRAM ZAPGM                 S01413
     I                                      244 246 WSID                  RE0244
     I                                      245 246 WSID2                 RE0244
     I**                                                                  RE0244
     I*                                                                   S01413
     ISDMMOD    E DSSDMMODPD                                              S01413
     I*                                                                   S01413
     I**  SD Midas Modules                                                S01413
     I*                                                                   S01413
     IDSSDY     E DSDSSDY                                                 S01413
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01413
     I*                                                                   S01413
     I/EJECT
      * Insert DS to pass DATA parameter to the return program            S01413
      *                                                                   S01413
      /COPY QWINDSRC,RE0241DTA                                            S01413
      *                                                                   S01413
     C*                                                                   S01413
     C**  Read the file SDMMODPD to find if WINDOW flag is on (BGWDPR)    S01413
     C*                                                                   S01413
     C                     CALL 'AOMMODR0'                                S01413
     C                     PARM '*DBERR  '@RTCD   7                       S01413
     C                     PARM '*FIRST ' @OPTN   7                       S01413
     C           SDMMOD    PARM SDMMOD    DSSDY                           S01413
     C*                                                                   S01413
     C                     MOVEACPY@      BIS@   80
0115 C*  FIRST CYCLE PROCESSING                                           RE0244
0116 C*                                                                   RE0244
     C           *NAMVAR   DEFN           LDA                             RE0244
     C           *NAMVAR   DEFN           WTRAN                           RE0244
     C**                                                                  RE0244
     C************LOCK     IN   *NAMVAR                                   S01413
     C           *LOCK     IN   LDA                                       S01413
     C           *LOCK     IN   WTRAN                                     S01413
     C**                                                                  RE0244
     C**
     C*    READ WORKSTATION FILE /*HELP*FACILITY*                         S01199
     C**
     C************IN07     DOUEQ'0'                                       S01413
     C           GUTEN     TAG                                            S01413
     C                     READ RE0240FM                 07
     C********** *IN07     IFEQ '1'                                       S01199
     C**********           MOVEAERCD      HERCD 160                       S01199
     C**********           MOVEL'RE0240  'HBPGM   8                       S01199
     C**********           CALL 'MHELP'                                   S01199
     C**********           PARM           HBPGM                           S01199
     C**********           PARM           HERCD                           S01199
     C**********           END                                            S01199
     C***********          END                                            S01413
     C*
0123 C*  SET-UP STANDARD INPUT PROGRAM FIELDS  -  WPROG IS THIS PROGRAM   RE0244
0124 C*                                                                   RE0244
0125 C                     MOVELLISP      WPROG   8                       RE0244
0126 C                     MOVE '4  '     WPROG                           RE0244
0127 C                     MOVELWPROG     SPID    6                       RE0244
0128 C*  SET-UP STANDARD LDA FIELDS                                       RE0244
0129 C                     MOVE WPROG     LPROG                           RE0244
0130 C                     Z-ADD4         LLDLP                           RE0244
     C*                                                                   S01413
     C*  EXECUTE CHN55                                                    S01413
     C*                                                                   S01413
     C           TAG55     TAG                             ** TAG55 TAG   S01413
     C                     EXSR CHN55                                     S01413
     C  N99      MDPF      COMP 'P'                      35               S01413
     C  N99                GOTO TAG01                                     S01413
     C                     SETON                     U7LR  ** DB ERROR 04 S01413
     C                     MOVE 'TABTB'   LFILE                           S01413
     C                     MOVEL'MDPF'    LKEY                            S01413
     C                     MOVE '04'      LDBNO                           S01413
     C                     GOTO END                                       S01413
     C*                                                                   S01413
     C           TAG01     TAG                             ** TAG01 TAG   S01413
     C*                                                                   S01413
0131 C*  SET-UP STANDARD BLANK FIELDS                                     RE0244
0133 C*                                                                   RE0244
0134 C           LDATF     COMP 'M'                      98* DATE FORMAT  RE0244
0135 C********** LSFLG     COMP 1                        79* SSF          S01117
0135 C           LSFLG     COMP 'Y'                      79* SSF          S01117
0136 C           LDELM     COMP '*'                      77* DELETE METHODRE0244
0137 C*                                                                   RE0244
0140 C*  LOG PROGRAM NAME                                                 RE0244
0141 C*                                                                   RE0244
0142 C                     MOVE LISP      WLOGP                           RE0244
0143 C                     MOVE '9'       WLOGP                           RE0244
0144 C*                                                                   RE0244
0145 C*  INITIALISE FIELD TO BLANK OUT KEY/ACTION CODE                    RE0244
0146 C*                                                                   RE0244
0147 C                     MOVE ' '       BLK04   4                       RE0244
0148 C*                                                                   RE0244
0149 C           ENDFC     TAG                             ** ENDFC TAG   RE0244
0150 C*                                                                   RE0244
0151 C*  INITIALISE STANDARD INDICATORS                                   RE0244
0152 C                     SETON                     888786* NON-DISPLAY  RE0244
0153 C                     SETOF                     8980  * BLINK LABELS RE0244
0154 C                     SETOF                     858483* OUTPUT       RE0244
0155 C                     SETOF                     8281  * SCREENS      RE0244
0156 C                     SETOF                     76    * OUTPUT WTRN  RE0244
0157 C*                                                                   RE0244
0158 C*  INITIALISE NON-STANDARD INDS                                     RE0244
0159 C*                                                                   RE0244
0160 C*                                                                   RE0244
0161 C*  CHECK FOR CORRECT SCREEN READ IN                                 RE0244
0162 C*                                                                   RE0244
0163 C   78                GOTO PROCES                                    RE0244
0164 C                     SETON                     U7LR                 RE0244
0165 C                     MOVE 'SCREN'   LFILE                           RE0244
0166 C                     MOVE *BLANKS   LKEY                            RE0244
0167 C                     MOVEL'SD'      LKEY                            RE0244
0168 C                     MOVE 'FOUND   'LKEY                            RE0244
0169 C                     MOVE SID       LKEY                            RE0244
0170 C                     MOVE '01'      LDBNO            * DB ERROR 01 *RE0244
0171 C                     GOTO END                                       RE0244
0172 C*                                                                   RE0244
0173 C           PROCES    TAG                             * PROCES  TAG *RE0244
0174 C*                                                                   RE0244
0175 C*  CLEAR ERROR CODE ARRAY, RESET INDEX                              RE0244
0176 C*                                                                   RE0244
0177 C                     MOVE *BLANKS   ERMSG  79                       RE0244
0178 C                     MOVE '    '    ERCD                            RE0244
0178 C                     MOVE '    '    ERCD1  79                       S01413
0178 C                     MOVE '    '    ERCD2  79                       S01413
0179 C                     Z-ADD0         S       20                      RE0244
     C**  SET INDICATORS FOR GROUP CODES                                  S01413
     C                     MOVE WCUSF     Y       10                      S01413
     C           Y         COMP 1                    44  44               S01413
     C           Y         COMP 2                    45  45               S01413
     C           Y         COMP 3                    46  46               S01413
     C           Y         COMP 4                    47  47               S01413
     C           Y         COMP 5                    48  48               S01413
     C           Y         COMP 6                    49  49               S01413
     C           Y         COMP 7                    50  50               S01413
     C           Y         COMP 8                    51  51               S01413
0180 C*                                                                   RE0244
0181 C*  IF F3, END THE PROGRAM                                           RE0244
0182 C*                                                                   RE0244
0183 C   KC                MOVEL'**      'LPROC                           RE0244
0184 C   KC                SETON                     LR                   RE0244
0185 C   KC                GOTO END                                       RE0244
0186 C*                                                                   RE0244
0187 C*  IF F12, OUTPUT BLANK INITIAL SCREEN                              RE0244
0188 C*                                                                   RE0244
0189 C   KL                EXSR SUBSF                                     RE0244
0190 C   KL                GOTO END                                       RE0244
     C*                                                                   S01413
     C*                                                                   S01413
0191 C*                                                                   RE0244
0192 C*  IF NOT F10, REOUTPUT DELETE SCREEN WITH MESSAGE                  RE0244
0193 C*                                                                   RE0244
0194 C  NKJ                EXSR SUBSD                                     RE0244
0195 C  NKJ                SETOF                     88                   RE0244
0196 C  NKJ      S         ADD  1         S                               RE0244
0197 C  NKJ                MOVE '916'     ERCD,S                          RE0244
0198 C  NKJ                MOVE ERCM,1    ERMSG                           RE0244
0199 C  NKJ                GOTO END                                       RE0244
0200 C*                                                                   RE0244
0201 C*  IF F10 KEY ENTERED, NOW VALIDATE DELETE CHECK FIELD              RE0244
0210 C*                                                                   RE0244
0211 C*  S IS NON-ZERO IF THERE ARE ANY ERRORS                            RE0244
0212 C*                                                                   RE0244
0213 C           S         COMP 0                    8484                 RE0244
0214 C*                                                                   RE0244
0215 C*  IF THERE ARE ANY ERRORS, REOUTPUT THE                            RE0244
0216 C*  DELETE SCREEN WITH ERROR CODES                                   RE0244
0217 C*                                                                   RE0244
0218 C   84                EXSR SUBSD                                     RE0244
0219 C   84                SETOF                     88                   RE0244
0220 C   84                GOTO END                                       RE0244
      * WINDOW PROCESSING                                                 S01413
      *                                                                   S01413
     C           BGWDPR    IFEQ 'Y'                                       S01413
     C           TSTMC     ANDEQ'Y'                                       S01413
     C           *IN78     ANDEQ'1'                                       S01413
     C           BGWDPR    OREQ 'Y'                                       S01413
     C           FACH      ANDEQ'Y'                                       S01413
     C           *IN78     ANDEQ'1'                                       S01413
      *                                                                   S01413
     C                     MOVE SCCY      CCYD                            S01413
      *                                                                   S01413
     C                     UNLCKLDA                                       S01413
     C                     MOVE *BLANKS   #PGM                            S01413
     C                     MOVEL'RE0244'  #PGM                            S01413
      *                                                                   S01413
     C                     CALL 'WN0010'                                  S01413
     C                     PARM           #PGM   10                       S01413
     C                     PARM           FKEY    2                       S01413
     C                     PARM SACTN     ACTION  1                       S01413
     C                     PARM           DATA                            S01413
     C                     PARM *BLANKS   #RTRN   7                       S01413
     C                     PARM           SPARE 256                       S01413
     C           *LOCK     IN   LDA                                       S01413
     C*                                                                   S01413
     C           #RTRN     IFEQ 'USR0790'                                 S01413
     C                     EXSR SUBSD                                     S01413
     C                     EXCPT                                          S01413
     C                     MOVE '0'       *IN                             S01413
     C                     GOTO GUTEN                                     S01413
     C                     END                                            S01413
     C                     END                                            S01413
0221 C*                                                                   RE0244
0222 C*  OTHERWISE, UPDATE THE WORKSTATION TRANSACTION DATA STRUCTURE     RE0244
0223 C*  WITH THE MASTER FILE RECORD                                      RE0244
0224 C*                                                                   RE0244
0225 C*  UPDATE WTRAN AND EXECUTE LOGGING/UPDATE PROGRAM                  RE0244
0226 C*                                                                   RE0244
0206 C                     EXSR WTRUPD                                    RE0244
0205 C*                                                                   RE0244
0228 C                     MOVE '9  '     LPROC                           RE0244
0229 C*                                                                   RE0244
0230 C           END       TAG                             ** END TAG     RE0244
0231 C*                                                                   RE0244
0232 C*  SETOF OUTPUT INDS IF DATABASE ERROR                              RE0244
0233 C*                                                                   RE0244
0234 C   U7                SETOF                     818476               RE0244
0235 C*                                                                   RE0244
0236 C                     TIME           WTIME                           RE0244
0299 C*                                                                   RE0244
     C***********          OUT  *NAMVAR                                   S01413
     C                     OUT  LDA                                       S01413
     C                     OUT  WTRAN                                     S01413
     C**                                                                  RE0244
     C                     EXCPT                                          RE0244
     C                     RETRN                                          RE0244
0237 C*                                                                   RE0244
     C********************************************************************S01413
     C**                                                                  S01413
     C**   CHN55  SR. TO CHAIN TO RETAIL FEATURES ICD                     S01413
     C**                                                                  S01413
     C           CHN55     BEGSR                           *** CHN55  *** S01413
     C           1         CHAINTABTBRE              99    ON NOT THERE   S01413
     C                     ENDSR                                          S01413
     C**                                                                  S01413
     C**                                                                  S01413
0238 C********************************************************************RE0244
0239 C**                                                                  RE0244
0240 C**   SUBR. - TO SET UP INITIAL SCREEN OUTPUT                        RE0244
0241 C**                                                                  RE0244
0242 C           SUBSF     BEGSR                           ***  SUBSF  ***RE0244
0243 C                     SETON                     81LR                 RE0244
0244 C                     MOVE '1  '     LPROC                           RE0244
0245 C                     MOVE 'SF'      SID                             RE0244
0246 C                     ENDSR                                          RE0244
0247 C********************************************************************RE0244
0248 C**                                                                  RE0244
0249 C**   SUBR. - TO SET UP DELETE SCREEN OUTPUT                         RE0244
0250 C**                                                                  RE0244
0251 C           SUBSD     BEGSR                           ***  SUBSD  ***RE0244
0252 C                     SETON                     84                   RE0244
0253 C                     MOVE '4  '     LPROC                           RE0244
0254 C                     MOVE 'SD'      SID                             RE0244
0255 C                     ENDSR                                          RE0244
0256 C********************************************************************RE0244
0257 C**                                                                  RE0244
0258 C**   SUBR TO UPDATE WORKSTATION TRANSACTION DATA STRUCTURE          RE0244
0259 C**                                                                  RE0244
0260 C           WTRUPD    BEGSR                           ***  WTRUPD ***RE0244
     C**                                                                  RE0244
0902 C                     MOVE *BLANKS   WTRAN2                          RE0244
0903 C                     MOVE *BLANKS   WTRAN3                          RE0244
0904 C                     MOVE *BLANKS   WTRAN4                          RE0244
0905 C                     MOVE *BLANKS   WTRAN5                          RE0244
     C                     MOVE *BLANKS   WTRAN6                          S01413
     C                     MOVE *BLANKS   WTRAN7                          S01413
     C                     MOVE *BLANKS   WTRAN8                          S01413
     C**                                                                  RE0244
     C   77                MOVE '*'       WRECI                           RE0244
0444 C                     Z-ADD0         WTNLU                           RE0244
0446 C                     MOVE LRUND     WLCD                            RE0244
     C**                                                                  RE0244
0444 C                     MOVE 'D'       WCHTP                           RE0244
     C**                                                                  RE0244
0445 C                     MOVE 'D'       W401                            RE0244
     C**                                                                  RE0244
0446 C                     Z-ADD0         W404                            RE0244
1445 C                     Z-ADD0         W407                            RE0244
     C**                                                                  RE0244
0446 C                     MOVE WSID2     WWSID2                          RE0244
0445 C                     MOVE LFILE     WFILE                           RE0244
     C**                                                                  RE0244
0445 C                     MOVE '1'       W430                            RE0244
0446 C                     MOVE 'D'       W431                            RE0244
     C**                                                                  RE0244
     C                     MOVE SCN060    WCN060                          S01413
     C                     MOVE SCN080    WCN080                          S01413
     C                     MOVE SCN100    WCN100                          S01413
     C                     MOVE SCN120    WCN120                          S01413
     C                     MOVE SCN130    WCN130                          S01413
0446 C                     MOVE SCN256    WCN256                          RE0244
     C*                                                                   RE0244
0269 C                     ENDSR                                          RE0244
0270 C********************************************************************RE0244
     C/EJECT
0271 O*  WORKSTATION - INITIAL SCREEN OUTPUT                              RE0244
0272 O*                                                                   RE0244
0273 ORE0240FME        81                                                 RE0244
0274 O                                   K8 'RE0240F1'                    RE0244
0275 O                         SCN30     30                               RE0244
0276 O                         SID        9                               RE0244
0277 O                         SPID      15                               RE0244
0278 O                         WTIME     23 '  .  .  '                    RE0244
0279 O*  BLANK OUT KEY/ACTION CODE FOR F12 - REMOVED IN STANDARD PROG     RE0244
0280 O                 KL      BLK04     30                               RE0244
0281 O*  ERROR FIELDS                                                     RE0244
0282 O                         ERMSG    109                               RE0244
0283 O***********              ERCD     188                               S01413
     O                         ERCD1    188                               S01413
     O                         ERCD2    267                               S01413
0284 O*                                                                   RE0244
0285 O*  WORKSTATION - DELETE SCREEN OUTPUT                               RE0244
0286 O*                                                                   RE0244
0287 O        E        84                                                 RE0244
0288 O***********                        K8 'RE0240F2'                    S01413
     O                                   K8 'RE0240F3'                    S01413
     O                         SCN30     30                               S01413
     O                         SCCNM     44                               S01413
     O                         SCNXXX   217                               S01413
     O                         SCN080   417                               S01413
     O                         SCN100   617                               S01413
     O                         SCN120   817                               S01413
     O                         SCN130   917                               CDE002
     O***********              SCN130   893                         S01413CDE002
0289 O***********              SCN256   256                               S01413
0290 O                         SID        9                               RE0244
0291 O                         SPID      15                               RE0244
0292 O                         WTIME     23 '  .  .  '                    RE0244
0293 O*  ERROR FIELDS                                                     RE0244
0294 O***********              ERMSG    179                               S01413
     O***********              ERMSG    735                               CDE002
0295 O***********              ERCD1    814                         S01413CDE002
0295 O***********              ERCD2    893                         S01413CDE002
     O                         ERMSG    759                               CDE002
     O                         ERCD1    838                               CDE002
     O                         ERCD2    917                               CDE002
0296 O*                                                                   RE0244
**   ERROR MESSAGES
ENTER F10 KEY FOR DELETE
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
