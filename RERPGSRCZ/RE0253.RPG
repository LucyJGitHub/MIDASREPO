     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Standing orders maintenance')
      *****************************************************************
      *                                                               *
      *  Midas - Retail Module                                        *
      *                                                               *
      *  RE0253 - Standing Orders File Maintenance                    *
      *                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CGL154             Date 13Oct14               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP205             Date 08Mar10               *
      *                 CAP204             Date 09Feb10               *
      *                 CAP187             Date 21Aug09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG9032            Date 13Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 209727             Date 25Sep02               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG3281            Date 17Jun04               *
      *                 BUG2978            Date 03Jun04               *
      *                 CGL014             Date 20Oct03               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 19Apr04               *
      *                 CRE020             Date 20Jan04               *
      *                 CGL029             Date 01Sep03               *
      *                 CSD015             Date 14Oct02               *
      *                 CRE009             Date 18Sep02               *
      *                 209995             Date 25Sep02               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 176510             Date 11Apr00               *
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 02Mar99               *
      *                 CTI002             Date 09Sep98               *
      *                 117784             DATE 27FEB98               *
      *                 119553             DATE 27FEB98               *
      *                 088569             DATE 21JAN98               *
      *                 102954             DATE 21JAN98               *
      *                 095801             DATE 21JAN98               *
      *                 092560             DATE 21JAN98               *
      *                 087579             DATE 21JAN98               *
      *                 093486             DATE 19JAN98               *
      *                 088294             DATE 16JUN98               *
      *                 086381             DATE 16JAN98               *
      *                 120827             Date 06Jul97               *
      *                 109434             DATE 24SEP97              **
      *                 CCB002             DATE 15JUL96               *
      *                 095797             DATE 10NOV95               *
      *                 S01408             DATE 06SEP95               *
      *                 S01408             DATE 13APR95               *
      *                 S01408             DATE 22FEB95               *
      *                 072881             DATE 09SEP94               *
      *                 S01408             DATE 09SEP94               *
      *                 S01466             DATE 22MAR94               *
      *                 047906             DATE 28SEP93               *
      *                 S01413             DATE 13APR93               *
      *                 046303             DATE 16JAN94               *
      *                 059214             DATE 27OCT93               *
      *                 054720             DATE 31JUL93               *
      *                 E38323             DATE 31JUL92               *
      *                 E32459             DATE 12DEC91               *
      *                 RT0065             DATE 23MAY91               *
      *                 RT0067             DATE 14MAY91               *
      *                 S01194             DATE 20FEB90               *
      *                 E22221             DATE 31MAY90               *
      *                 S01252             DATE 03FEB90               *
      *                 S01241             DATE 08JAN90               *
      *                 LN0505             DATE 10SEP90               *
      *                 LN0056             DATE 30APR90               *
      *                 HK0000             DATE 19DEC89               *
      *                 S01199             DATE 19DEC89               *
      *                 S01195             DATE 04DEC89               *
      *                 S01117             DATE 04DEC89               *
      *                 E19322             DATE 30AUG89               *
      *                 E16893             DATE 11/04/89              *
      *                 E14693             DATE 25/01/89              *
      *                 E13426             DATE 11/07/88              *
      *                 S01154             DATE 17/05/88              *
      *                 E11056             DATE 16/09/87              *
      *                 S05452             DATE 20/08/87              *
      *                 E10048             DATE 02/07/87              *
      *                 E10405             DATE 30/04/87              *
      *                 E10579             DATE 31/03/87              *
      *                 E10339             DATE 18/02/87              *
      *                 E43618             DATE 19/09/86              *
      *                 E49677             DATE 11/06/86              *
      *                 E80649             DATE 11/06/86              *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL154 - FATCA Reporting (Recompile)                         *
      *  CAP205 - Teller Related APIs - Account Balance Check         *
      *  CAP204 - Teller Related APIs - Account Transfer (Recompile)  *
      *  CAP187 - Document Linkage (Recompile)                        *
      *  BUG9032-Pass correct Branch to RSACMTPD.  Applied fix 178665.*
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  209727 - Reset REPI flag to ' ' for replication              *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG3281 - Discrepancies on sources                           *
      *  BUG2978 - Initialise fields for debit account.               *
      *  CGL014 - Collaterals Processing                              *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Webfacing Changes (recompile)                       *
      *  CRE020 - Midas Plus Online Printing of Advices (GE7)         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CSD015 - Midas Compliance Watch - Watch List Checking        *
      *  CRE009 - Projected Account Movements for Retail Accounts     *
      *  209995 - Applied several fixes:                              *
      *                                                               *
      *           188271 - Reverse movements in RSACMTPD when SO is   *
      *           deleted (i.e. missing movements in Projected A/c    *
      *           Movements enquiry option)                           *
      *                                                               *
      *           184635 - Reverse movements in RSACMTPD when SO is   *
      *           amended (as they were causing missing movements in  *
      *           Projected A/c Movements enquiry option). Also,      *
      *           write records to RSACMTPD up to the 5th working day *
      *           for Nostro accounts.                                *
      *                                                               *
      *           144042 - Update projected nostro balances (ref.     *
      *           SC 068497)                                          *
      *                                                               *
      *           EMGFIX - Missing reverse movement when SO is        *
      *           deleted (applied fix 117784 of SR/SCFILL to         *
      *           SR/SDFILL as well as branch was being passed as     *
      *           blank).                                             *
      *                                                               *
      *  176510 - Program did not use PCDM to default a Profit        *
      *           centre. This was corrected and the Account Officer  *
      *           added to the Access Object call - AOPRFMR0 to       *
      *           improve the assignment of the default Profit Centre.*
      *  CGL007 - Account Postings Enquiry.  Recompile.               *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
      *  117784 - 1. If payment method 'C', full a/c no. used for     *
      *           retail default CR a/c and payment date changed from *
      *           run date, the shadow posting is not reversed out    *
      *           for the CR a/c as it is not deemed to be retail.    *
      *           Same applies if payment due today and S/O deleted.  *
      *           2. If final payment date is changed to run date the *
      *           shadow posting is not generated for the DR & CR a/c *
      *           due to incorrect set up of work next payment dates. *
      *  119553  -  Placing ? in Transaction field does not bring     *
      *             back data but leaves ? in field.                  *
      *  088569 - If user changes final payment date to less than     *
      *           second payment date (to mature a standing order),   *
      *           pgm changes second payment date to same as final    *
      *           payment date, causing 2 payments to be generated    *
      *           on the same date.  Fix is to amend program to       *
      *           change second date and amount to blank.             *
      *  102954 - If transaction branch code is blank, default all    *
      *           blank branch codes to users default branch code,    *
      *           else default to transaction branch code.            *
      *  095801 - Deleted record not printed out on the Standing      *
      *           Order Listing, because the Change Type was not set  *
      *           to 'D'. Amended pgm to set CHTP to 'D' for deletion.*
      *  092560 - Clear Error Message before displaying a window.     *
      *  087579 - NXTP being 'corrupted' if 2nd date has passed. NXTP *
      *           was being set to the 2nd pyt date (DSPY). As this   *
      *           is in the past, PF/RSACMTPD was not being updated   *
      *           with the changes made to the next payment date      *
      *           amount. Extra check added to ensure NXTP is correct.*
      *  093486 - Display error message if Credit Retail Account No.  *
      *           is closed                                           *
      *  088294 - Reset error index 'E' on each display               *
      *  086381 - Incorrect currency getting put onto Pf/RSACMTPD     *
      *           when a SO is amended and the currency changes       *
      *  120827 - Profit Centre Accounting defaulting                 *
      *  109434 - Default narrative field if left blank on Insert.    *
      *           On Amend, if the narrative field is amended, also   *
      *           amend the narrative in RSACMTPD.                    *
      *  CCB002  -  COB Performance Enhancements                      *
      *             Access now via access object                      *
      *             Change MEMOS processing to use access objects.    *
      *  095797  -  If Standing Order is deleted in a different       *
      *             branch to the last Standing Order processed, the  *
      *             wrong branch code is written to RSACMTPD.         *
      *  S01408  -  Addition of Core Hook RE0253CP14                  *
      *          -  Addition of Core Hook RE0253CP15                  *
      *  S01408  -  Addition of Core Hook RE0253CCA1                  *
      *  S01408  -  Addition of Core Hook RE0253CVS1                  *
      *          -  Addition of Core Hook RE0253CVS2                  *
      *          -  Addition of Core Hook RE0253IIPG                  *
      *          -  Addition of Core Hook RE0253CCP1                  *
      *          -  Addition of Core Hook RE0253CCP2                  *
      *          -  Addition of Core Hook RE0253CCP3                  *
      *          -  Addition of Core Hook RE0253CCP4                  *
      *          -  Addition of Core Hook RE0253CCP5                  *
      *          -  Addition of Core Hook RE0253CCP6                  *
      *          -  Addition of Core Hook RE0253CCP7                  *
      *          -  Addition of Core Hook RE0253CCP8                  *
      *          -  Addition of Core Hook RE0253CCP9                  *
      *          -  Addition of Core Hook RE0253CP10                  *
      *          -  Addition of Core Hook RE0253CP11                  *
      *          -  Addition of Core Hook RE0253CP12                  *
      *          -  Addition of Core Hook RE0253CP13                  *
      *  072881  -  If Action Code is not 'I', and record not found on*
      *             STAND file, then GOTO TAG05, so that the correct  *
      *             error message will be shown.                      *
      *  S01408  -  Addition of RE0253CVSF .                          *
      *             Addition of RE0253FFPG .                          *
      *             Addition of RE0253CCAU .                          *
      *  S01466 - BLI Retail Enhancements                             *
      *  047906 - Do not accept account which is blocked/bad DR       *
      *           or bankrupt                                         *
      *  S01413 - Retail 3 Incorporation                              *
      *  046303 - /COPY source subr. ZFWDT amended to prevent array   *
      *           error if no holiday record found - fixed by S01434. *
      *           Program recompiled.                                 *
      *  059214 - Message 'USER NOT AUTHORISED TO ANY ACTION CODES FOR*
      *           THIS MENU ITEM & BRANCH' displayed incorrectly when *
      *           enquiring for a deleted standing order. Validate    *
      *           action and branch code only for undeleted records.  *
      *  054720 - Message 'INVALID UPDATE - THIS RECORD HAS SINCE     *
      *           BEEN UPDATED' displayed incorrectly.                *
      *  E38323 - Recompiled due to a change in copy source ZFWDT subr*
      *  E32459 - CORRECTION TO RT0065 - DATE CONVERSION DIDN'T       *
      *           WORK FOR AMD/ENQ - ARRAY ZMDY CHANGED TO GIVE       *
      *           JANUARY 31 DAYS INSTEAD OF 311.                     *
      *  RT0065 - COMPILE TIME ARRAYS WERE MISSING                    *
      *  RT0067 - AOPRFMR0 CAN RETURN CODE 0, 1 AND 2. CODE 0         *
      *           INIDCATES NO ERROR. CODE 1 INDICATES NO PROFIT      *
      *           CENTRE IS FOUND FOR THE COMBINATION INVOLVED AND    *
      *           A BLANK CODE IS RETURNED. CODE 2 MEANS THAT A       *
      *           PROFIT CENTRE IS FOUND BUT THAT PROFIT CENTRE IS    *
      *           NOT VALID. TAKE OUT PROCESSING OF ERROR CODE 1      *
      *           BECAUSE BLANK IS A VALID PROFIT CENTRE.             *
      *  S01194 - NEW STANDING DATA                                   *
      *  E22221 - ADDITIONAL CHANGE REQUIRED TO ALL NON-SYNON         *
      *           MAINTENANCE FUNCTIONS PREVIOUSLY CHANGED FOR        *
      *           TRANSACTION WINDOWS.                                *
      *           ALSO, SETLL INTRODUCED BEFORE READ OF SDMMODPD      *
      *  S01252 - ADDITIONAL SPARE WINDOW MANAGER PARAMETER           *
      *  S01251 - SYNON FIELD/PROGRAM NAME CHANGES                    *
      *  S01241 - WINDOW INCORPORATION                                *
      *  LN0505 - DATE OF SECOND PAYMENT DEFAULTING INCORRECTLY       *
      *  HK0000 - PROTECT PAYMENT FREQUENCY FROM SCREEN AMENDMENT     *
      *  S01199 - HELP CHANGES                                        *
      *  S01195 - HOLIDAY AMENDMENT                                   *
      *  S01117 - MULTIBRANCHING                                      *
      *  E19322 - VALIDATION OF SECOND DATE NOT CORRECT.              *
      *  E16893 - MULTI-BRANCH FIELD NOT OUTPUT TO STANDSB.           *
      *  E14693 - IF THE PAYMENT FREQUENCY IS ON ACCRUAL DATE CHECK   *
      *           THAT THE PAYMENT DATE IS AFTER THE RUN DATE.        *
      *  E13426 - ENTRY OF REF. NO. AND ACTION CODE FOLLOWED BY       *
      *           'ENTER' ON DETAIL SCREEN RESULTS IN INVALID         *
      *           REF. NO. AND ACTION CODE ERRORS.                    *
      *  S01154 - INCLUSION OF REAL TIME STATEMENTS - OUTPUT TO       *
      *           ACCOUNTS MOVEMENTS FILE (RSACMTPD) REQUIRED         *
      *           WHEN MEMOS UPDATED.                                 *
      *  E11056 - LAST CHANGE TYPE NOT UPDATED WITH D,I,OR A IN       *
      *           'STAND' FILE.                                       *
      *  S05452 - INCLUSION OF AUTO RECONCILIATIONS.                  *
      *  E10048 - MEMOS NOT UPDATED FOR DELETIONS.                    *
      *  E10405 - INDIRECT - ACNUM FILE RECREATED                     *
      *  E10579 - INCORRECTLY COMPILED INTO SIGN OFF LIBRARY          *
      *  E43618 - VALIDATION ON FINAL AND SECOND PAYMENT DATE IS      *
      *           INCORRECT                                           *
      *  E10339 - CORRECT PROGRAM TERMINATION PROCSSING FOR           *
      *           DATABASE ERROR WHEN CHAIN OPERATION FAILS FOR       *
      *           INSTALLATION CONTROL RECORD 2.                      *
      *                                                               *
      *****************************************************************
     F*E0253FMCF  F     488            WORKSTN                            S01117
     F***RE0253FMCF  F     441            WORKSTN                  S01117 S01466
     F***RE0253FMCF  F     446            WORKSTN                                      S01466 CGL029
     F***RE0253FMCF  F     460            WORKSTN                                      CGL029 CRE020
     FRE0253FMCF  F     486            WORKSTN                                                CRE020
     F*TAND   UF  F     256  5AI     2 DISK                               S01117
     F***STAND***UF  F     258  5AI     2 DISK                     S01117 S01466
     F***STAND** UF  F     263  5AI     2 DISK                                         S01466 CGL029
     F***STAND   UF  F     284  5AI     2 DISK                                         CGL029 209727
     FSTAND   UF  F     285  5AI     2 DISK                                                   209727
     F                                              KCOMIT
     F*TANDSB O   F     256            DISK                      A        S01117
     F***STANDSB*O*  F     258            DISK                   A S01117 S01466
     F***STANDSB O   F     263            DISK                      A                  S01466 CGL029
     F***STANDSB O   F     284            DISK                                         CGL029 209727
     FSTANDSB O   F     285            DISK                      A                            209727
     F                                              KCOMIT
     F                                              KINFDS INFDS
     F                                              KINFSR INFSR
     FRSACMTL1UF  E           K        DISK                               109434
     F            RSACMTPO                          KRENAMERSACMTPX       109434
     F            APOSTPDF                          KIGNORE               109434
     F                                              KCOMIT                109434
     FRSACMTPDO   E                    DISK                               S01154
     F                                              KCOMIT                S01154
     FPRONO   UF  E           K        DISK                               209995
     F                                              KCOMIT                209995
     F            PRONOHHF                          KIGNORE               209995
     F**********MEMO    UF  F      40            DISK                     CCB002
     F**********                                              KCOMIT      CCB002
     F*TABLE**IF**F      96 12AI     2 DISK                               S01117
     F*CCNT   IF  F     400 15AI     2 DISK                               S01117
     FSDNOSTL4IF  E           K        DISK                               209995
     F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
     F***ACCNT** IF  F     573 24AI     2 DISK                                         CGL029 CGL014
     FACCNT   IF  F     607 24AI     2 DISK                                                   CGL014
     F***ACNUM** IF  F      40 10AI     2 DISK                                                CGL029
     FACNUM   IF  F      46 10AI     2 DISK                                                   CGL029
     FSDMMODPDIF  E                    DISK                           UC  S01241
      *                                                                   CRE009
     FREPMFWL1IF  E           K        DISK                               CRE009
      ** Projected Movements for RE Accounts file                         CRE009
      *                                                                                       CSD015
      ** Compliance Watch Hit List by Function Type, Identifier, Branch                       CSD015
     FSDCWHTL1IF  E           K        DISK                                                   CSD015
      *                                                                                       CRE020
     FREADVCL2UF  E           K        DISK         KCOMIT       A    UC                      CRE020
      ** Midas RE Settled Transaction Index File by Ref No/Pgm Ref                            CRE020
      *                                                                                       CRE020
      *                                                                   S01408
     F** Core hook for externalisation.                                   S01408
     F/COPY WNCPYSRC,RE0253FFPG                                           S01408
     F*                                                                   S01408
     F* ID F  C  H  L    FUNCTION OF INDICATORS
     F* 01            WORKSTN FILE - INITIAL SCREEN
     F* 02                         - INSERT
     F* 03                         - AMEND
     F* 04                         - DELETE
     F*       05      USED TO CONDITN 1ST TIME PASS THRU RPG CALC CYCLE *
     F* 06            STAND FILE - DETAIL RECORD
     F* 07                       - TRAILER RECORD
     F**08************MEMO FILE*-*DETAIL*RECORD************************   209995
     F*       08      Nostro a/c / Next pay date is within PRONO period   209995
     F* 09            OUTPUT SCREEN DETAILS FROM SCREEN
     F**10*******     TABLE FILE - BRANCH CODES DETAIL                    S01194
     F**11*******                - INST.CONTROL DATA RECORD #3            S01194
     F* 10            Core feature (Addition of transaction type field)   S01466
     F*               indicator                                           S01466
     F* 11            Error indicator on transaction type field           S01466
     F* 13            ACCNT FILE - LIVE DETAIL RECORD
     F* 15            ACNUM FILE - LIVE DETAIL RECORD
     F********14*     RETAIL A/C NOS. INDICATOR SET ON TABLE FILE.        S01194
     F********16*     RETAIL A/C NOS. INDICATOR NOT SET ON TABLE FILE.    S01194
     F* 17            ENQUIRY SCREEN INPUT FIELDS ENTERED
     F**18************ENQUIRY*SCREEN*INPUT*FIELDS*ENTERED*************                        CRE020
      *    18         CRE020 is enabled                                                       CRE020
     F*       15      A/C KEY FIELDS PROTECTED ON SCREEN
     F*       19      RETAIL A/C.NO.FIELD PROTECTED ON SCREEN
     F*****20****     DEFAULT BRANCH NO. EXISTS ON ICDR                   S01117
     F*       20      CR A/C DETAILS INPUT (CUST || CCY || ACOD || SEQ)   S01117
     F*****21****     INVALID BRANCH CODE ENTERED                         S01117
     F*       21      PROFIT CENTRE USED = 'NO'                           S01117
     F*    22         BLANK CUSTOMER ENTERED
     F*    23         BLANK DEBIT CCY ENTERED
     F*    24         BLANK DEBIT A/C CODE ENTERED
     F*****25         STANDING ORDER IS ACROSS TWO BRANCHES               S01117
     F*       25      DR A/C DETAILS INPUT (CUST || CCY || ACOD || SEQ)   S01117
     F*    26         BLANK DEBIT RETAIL ACCOUNT ENTERED
     F*    27         BLANK CREDIT CUSTOMER ENTERED
     F*    28         BLANK CREDIT CCY ENTERED
     F*    29         BLANK CREDIT A/C CODE ENTERED
     F*    30         BLANK CREDIT SEQ. ENTERED
     F*    31         BLANK CREDIT RETAIL ACCOUNT ENTERED
     F*****32****     NON DISPLAY OF NEXT/LAST PAY DATES EXCEPT IN ENQUIRYS01117
     F*       32      ERROR - BLINK FIELD - TRANSACTION BRANCH            S01117
     F*       33      DEBIT RETAIL ACCOUNT HAS BEEN AMENDED
     F*       34      CREDIT RETAIL ACCOUNT HAS BEEN AMENDED
     F*       35      'NEXT PAYMENT AMOUNT' HAS BEEN AMENDED
     F*       36      ACTION CODE - I
     F*       37                  - A
     F*       38                  - D
     F*       39                  - E
     F*       40      OUTPUTS FIELDS ON INITIAL SCREEN/
     F*                 FREQUENCY FIELD PROTECTED ON SCREEN.
     F*       41      ERROR CODES NON-DISPLAY/
     F*       42      DEBIT ACCOUNT                                       S01154
     F*       43      ERROR - BLINK FIELD - PROFIT CENTRE                 S01117
     F*       44      ERROR - BLINK FIELD - REFERENCE
     F*       45                          - ACTION CODE
     F*       47                          - DEBIT CUSTOMER NUMBER
     F*       48                          - DEBIT S.C.A. NUMBER
     F*       49                          - DEBIT SEQUENCE NUMBER
     F*       50                          - DEBIT RETAIL NUMBER
     F*       51                          - CREDIT CUSTOMER NUMBER
     F*       52                          - CREDIT S.C.A. NUMBER
     F*       53                          - CREDIT SEQUENCE NUMBER
     F*       54                          - CREDIT RETAIL NUMBER
     F*       55                          - PAYMENT CURRENCY
     F*       56                          - PAYMENT FREQUENCY
     F*       57                          - FIRST PAYMENT DATE
     F*       58                          - FIRST PAYMENT AMOUNT
     F*       59                          - REGULAR PAYMENT DATE
     F*       60                          - FINAL PAYMENT DATE
     F*       61      NON-DISPLAY ALL SECOND SCREEN FIELDS.
     F*       62      OUTPUTS SECOND SCREEN.
     F*       63      PROTECT FIELDS ON DETAIL SCREEN
     F*       64      OUTPUTS INITIAL SCREEN.
     F*       65      NON-DISPLAY ERROR MESSAGE
     F********66******MULTI-BRANCHING INDICATOR                           S01117
     F*       66      MULTI-BRANCHING INDICATOR - MBIN = Y                S01117
     F*       67      UPDATE MEMO FILE
     F*       68      CHAIN-FAIL ON STAND FILE, OR
     F*                SECOND PAYMENT DATE CALCULATED FROM ZFREQ
     F*       69      ZERO-SUPRESS 2ND. PAYMENT AMOUNT ON SCREEN
     F*       70      ZERO-SUPRESS FINAL PAYMENT AMOUNT ON SCREEN
     F*       71      PROTECT FIRST PAYMENT DATE AND AMOUNT FIELD
     F*       72      ERROR - BLINK FIELD - REGULAR PAYMENT AMOUNT
     F*       73      ERROR - BLINK FIELD - FINAL PAYMENT AMOUNT
     F*       74      UPDATE STAND DETAIL RECORD
     F*       75      UPDATE STAND TRAILER
     F* 76            0 DECIMAL PLACES ON PAYMENT CURRENCY
     F* 77            1 DECIMAL PLACE ON PAYMENT CURRENCY
     F* 78            2 DECIMAL PLACES ON PAYMENT CURRENCY
     F* 79            3 DECIMAL PLACES ON PAYMENT CURRENCY
     F*       80      SUCCESSFUL EXIT FROM UPDATE/LOG PROCEDURE
     F*               OR CREDIT ACCOUNT.                                  S01154
     F*       81      MULTI-PURPOSE
     F*       82      RECORD HAS BEEN UPDATED BY ANOTHER WORK-STATION
     F*       83      SUPRESS OUTPUT TO WORK-STATION
     F*       84      ORIGINAL ACCOUNT (PRIOR TO AMENDMENT).              S01154
     F*       85      PAYMENT METHOD INVALID.
     F*       86      A/C CODE INVALID
     F********87*     PROTECT 2ND PAY DATE IF PASSED                      S01117
     F*       87      PROTECT SCREEN FIELD - PROFIT CENTRE                S01117
     F*       88      NEW ACCOUNT (POST AMENDMENT)                        S01154
     F*       89      INVALID BRANCH CODE INPUT
     F*     90-95     USED IN Z-SUBROUTINES
     F*       97      SET ON IF ERROR DURING READ FROM THE WORK STATION *
     F*       98      DATE FORMAT IS MMDDYY
     F*       99      ERROR INDICATOR OUTPUT FROM Z-SUBROUTINES
     F*          U3   ENQUIRY OPTION ONLY
     F*          U8   DATABASE IN ERROR - END PROGRAM
     E/COPY WNCPYSRC,RE0253E001
     E***********         MES     1   8 76               ERROR MESSAGES.  S01117
     E********************MES     1  11 76               ERROR MESSS01117 047906
     E                    MES     1  12 76               ERROR MESSAGES.  047906
     E/COPY WNCPYSRC,RE0253E002
     E                    FREQ   13  13  1               VALID FREQ. CODES
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E***********         ZFMD   12  12  2               ZFREQ SR. ARRAY  S01195
     E                    ZFMD   12  12  2               FREQ SR. ARRAY   S01195
     E                    ERCD       19  4               ERROR CODES.
     E                    ZA1        16  1               ZALIGN SR. ARRAY
     E                    ZA2        16  1               ZALIGN SR. ARRAY
     E***********         ZHC        50  3               ZFREQ SR. ARRAY  S01195
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E                    CPY@    1   1 80
      *                                                                                       CSD015
      ** Arrays used for Midas Compliance Watch                                               CSD015
      ** XML Opening Tags for the Compliance Engine                                           CSD015
     E                    XOT     1   8 27                                                    CSD015
      *                                                                                       CSD015
      ** XML Closing Tags for the Compliance Engine                                           CSD015
     E                    XCT     1   8 28                                                    CSD015
      *                                                                                       CSD015
      ** Watch List Fields Array                                                              CSD015
     E                    WLF         9 35                                                    CSD015
      *                                                                                       CSD015
      *                                                                   209995
     E                    PBL         5 15 0             PRONO bals       209995
     E                    PDT         5  5 0A            PRONO dates      209995
     I**
     I**   WORKSTN FILE
     I**
     IRE0253FMNS  01   1 CS   2 CF
     I                                        3   7 STORSF
     I                                        8   8 ACTION
     I**************************************241 245 ESTOR                 E13426
     I**************************************246 246 EACT                  E13426
     I***********                           257 261 ESTOR           E13426S01117
     I***********                           262 262 EACT            E13426S01117
     I**************************************264 268 ESTOR          S01117 S01466
     I**************************************269 269 EACT           S01117 S01466
     I**********                            269 273 ESTOR                              S01466 CGL029
     I**********                            274 274 EACT                               S01466 CGL029
     I                                      281 285 ESTOR                                     CGL029
     I                                      286 286 EACT                                      CGL029
     I**
     IRE0253FMNS  02   1 CS   2 CI
     I       OR   03   1 CS   2 CA
     I       OR   04   1 CS   2 CD
     I*****                                   6  11 ZCNUMD                S01117
     I*****                                  15  18 ZACODD                S01117
     I*****                                  19  20 ZACSQD                S01117
     I*****                                  31  36 ZCNUMC                S01117
     I*****                                  40  43 ZACODC                S01117
     I*****                                  44  45 ZACSQC                S01117
     I*****                                   1   2 SFCODE                S01117
     I*****                                   3   5 INBRCH          21    S01117
     I*****                                   6  11 DCUSSF          22    S01117
     I*****                                  12  14 CCYDR           23    S01117
     I*****                                  15  18 ACODDR          24    S01117
     I*****                                  19  20 DACSSF          43    S01117
     I*****                                  21  30 DRACSF          26    S01117
     I*****                                  31  36 CCUSSF          27    S01117
     I*****                                  37  39 CCYCR           28    S01117
     I*****                                  40  43 ACODCR          29    S01117
     I*****                                  44  45 CACSSF          30    S01117
     I*****                                  46  55 CRACSF          31    S01117
     I*****                                  56  85 PNARSF                S01117
     I*****                                  86  88 CCYSF                 S01117
     I*****                                  89  89 PAYFSF                S01117
     I*****                                  90  95 FDATSF          57    S01117
     I*****                                  90  950FDATSX                S01117
     I*****                                  96 109 FAMTSF          58    S01117
     I*****                                  96 1090FAMTSX                S01117
     I*****                                 110 115 SDATSF                S01117
     I*****                                 116 129 SAMTSF                S01117
     I*****                                 130 135 LDATSF                S01117
     I*****                                 136 149 LAMTSF                S01117
     I*****                                 150 169 PAYEE                 S01117
     I*****                                 170 189 PAYRSF                S01117
     I******                                190 209 PYB1SF                S05452
     I******                                210 229 PYB2SF                S05452
     I******                                230 239 PAYASF                S05452
     I******                                240 240 PAYMTH                S05452
     I******                                  1 240 LOTSF                 S05452
     I***********                           190 205 ISWCR           S05452S01117
     I***********                           206 225 PYB1SF          S05252S01117
     I***********                           226 245 PYB2SF          S05452S01117
     I***********                           246 255 PAYASF          S05452S01117
     I***********                           256 256 PAYMTH          S05452S01117
     I***********                             1 256 LOTSF           S05452S01117
     I                                        1   2 SFCODE                S01117
     I                                        3   5 DRBR                  S01117
     I                                        3   5 DBRCSF                S01117
     I                                        6  11 DCUSSF          22    S01117
     I                                        6  11 ZCNUMD                S01117
     I                                       12  14 CCYDR           23    S01117
     I**********                             15  18 ACODDR          24                 S01117 CGL029
     I**********                             15  18 ZACODD                             S01117 CGL029
     I**********                             19  20 DACSSF                             S01117 CGL029
     I**********                             19  20 ZACSQD                             S01117 CGL029
     I**********                             21  30 DRACSF          26                 S01117 CGL029
     I**********                             31  33 CBRC                               S01117 CGL029
     I**********                             31  33 CBRCSF                             S01117 CGL029
     I                                       15  24 ACODDR          24                        CGL029
     I                                       15  24 ZACODD                                    CGL029
     I                                       25  26 DACSSF                                    CGL029
     I                                       25  26 ZACSQD                                    CGL029
     I                                       27  36 DRACSF          26                        CGL029
     I                                       37  39 CBRC                                      CGL029
     I                                       37  39 CBRCSF                                    CGL029
     I/COPY WNCPYSRC,RE0253I001
     I**********                             34  39 CCUSSF          27                 S01117 CGL029
     I**********                             34  39 ZCNUMC                             S01117 CGL029
     I**********                             40  42 CCYCR           28                 S01117 CGL029
     I**********                             43  46 ACODCR          29                 S01117 CGL029
     I**********                             43  46 ZACODC                             S01117 CGL029
     I**********                             47  48 CACSSF          30                 S01117 CGL029
     I                                       40  45 CCUSSF          27                        CGL029
     I                                       40  45 ZCNUMC                                    CGL029
     I                                       46  48 CCYCR           28                        CGL029
     I                                       49  58 ACODCR          29                        CGL029
     I                                       49  58 ZACODC                                    CGL029
     I                                       59  60 CACSSF          30                        CGL029
     I/COPY WNCPYSRC,RE0253I002
     I**********                             47  48 ZACSQC                             S01117 CGL029
     I**********                             49  58 CRACSF          31                 S01117 CGL029
     I**********                             59  62 IPRFC                              S01117 CGL029
     I                                       59  60 ZACSQC                                    CGL029
     I                                       61  70 CRACSF          31                        CGL029
     I                                       71  74 IPRFC                                     CGL029
     I***************************************63  92 PNARSF         S01117 S01466
     I***************************************93  95 CCYSF          S01117 S01466
     I***************************************96  96 PAYFSF         S01117 S01466
     I***************************************97 102 FDATSF       57S01117 S01466
     I***************************************97 1020FDATSX         S01117 S01466
     I**************************************103 116 FAMTSF       58S01117 S01466
     I**************************************103 1160FAMTSX         S01117 S01466
     I**************************************117 122 SDATSF         S01117 S01466
     I**************************************123 136 SAMTSF         S01117 S01466
     I**************************************137 142 LDATSF         S01117 S01466
     I**************************************143 156 LAMTSF         S01117 S01466
     I**************************************157 176 PAYEE          S01117 S01466
     I**************************************177 196 PAYRSF         S01117 S01466
     I**************************************197 212 ISWCR          S01117 S01466
     I**************************************213 232 PYB1SF         S01117 S01466
     I**************************************233 252 PYB2SF         S01117 S01466
     I**************************************253 262 PAYASF         S01117 S01466
     I**************************************263 263 PAYMTH         S01117 S01466
     I**************************************270 272 BRCASF         S01117 S01466
     I****************************************1 252 LOTSF          S01117 S01466
     I**************************************253 272 LOTSF2         S01117 S01466
     I**********                             63  67 TRATSF                             S01466 CGL029
     I**********                             68  97 PNARSF                             S01466 CGL029
     I**********                             98 100 CCYSF                              S01466 CGL029
     I**********                            101 101 PAYFSF                             S01466 CGL029
     I**********                            102 107 FDATSF          57                 S01466 CGL029
     I**********                            102 1070FDATSX                             S01466 CGL029
     I**********                            108 121 FAMTSF          58                 S01466 CGL029
     I**********                            108 1210FAMTSX                             S01466 CGL029
     I**********                            122 127 SDATSF                             S01466 CGL029
     I**********                            128 141 SAMTSF                             S01466 CGL029
     I**********                            142 147 LDATSF                             S01466 CGL029
     I**********                            148 161 LAMTSF                             S01466 CGL029
     I**********                            162 181 PAYEE                              S01466 CGL029
     I**********                            182 201 PAYRSF                             S01466 CGL029
     I**********                            202 217 ISWCR                              S01466 CGL029
     I**********                            218 237 PYB1SF                             S01466 CGL029
     I**********                            238 257 PYB2SF                             S01466 CGL029
     I**********                            258 267 PAYASF                             S01466 CGL029
     I**********                            268 268 PAYMTH                             S01466 CGL029
     I**********                            275 277 BRCASF                             S01466 CGL029
     I                                       75  79 TRATSF                                    CGL029
     I                                       80 109 PNARSF                                    CGL029
     I                                       80 107 PANASF                                    CRE020
     I                                      110 112 CCYSF                                     CGL029
     I                                      113 113 PAYFSF                                    CGL029
     I                                      114 119 FDATSF          57                        CGL029
     I                                      114 1190FDATSX                                    CGL029
     I                                      120 133 FAMTSF          58                        CGL029
     I                                      120 1330FAMTSX                                    CGL029
     I                                      134 139 SDATSF                                    CGL029
     I                                      140 153 SAMTSF                                    CGL029
     I                                      154 159 LDATSF                                    CGL029
     I                                      160 173 LAMTSF                                    CGL029
     I                                      174 193 PAYEE                                     CGL029
     I                                      194 213 PAYRSF                                    CGL029
     I                                      214 229 ISWCR                                     CGL029
     I                                      230 249 PYB1SF                                    CGL029
     I                                      250 269 PYB2SF                                    CGL029
     I                                      270 279 PAYASF                                    CGL029
     I                                      280 280 PAYMTH                                    CGL029
     I                                      287 289 BRCASF                                    CGL029
     I                                      290 317 PNAASF                                    CRE020
     I                                        1 252 LOTSF                 S01466
     I**********                            253 277 LOTSF2                             S01466 CGL029
     I                                      253 289 LOTSF2                                    CGL029
     I        NS
     I**
     I**   STAND FILE - DETAIL RECORD
     I**
     ISTAND   NS  06   1 CD
     I                                        1   1 RECI
     I                                        2   60STOR
     I*****                                   7   9 BRCDST                S01117
     I                                        7   9 BRCDD                 S01117
     I**********                             10  150DCUS                                      CSD027
     I                                       10  15 DCUS                                      CSD027
     I**********                             16  190DACD                                      CGL029
     I                                       16  190QQDACD                                    CGL029
     I                                       26  270DACS
     I                                       28  370DRAC
     I**********                             38  430CCUS                                      CSD027
     I                                       38  43 CCUS                                      CSD027
     I**********                             44  470CACD                                      CGL029
     I                                       44  470QQCACD                                    CGL029
     I                                       48  48 MBSI
     I                                       49  51 TXBRCA                S01117
     I                                       54  550CACS
     I                                       56  650CRAC
     I                                       66  68 CCYST
     I                                       66  68 CCYSTC                209995
     I                                       66  68 CCYSTD                209995
     I                                    P  69  710DFPY
     I                                    P  72  780AFPY
     I                                    P  79  810DSPY
     I                                    P  82  880ASPY            69
     I                                    P  89  910DLPY
     I                                    P  92  980ALPY            70
     I                                       99  99 PAYF
     I                                    P 100 1020DLMV
     I                                    P 103 1050NXTP
     I                                      106 135 PNAR
     I                                      136 155 PNAM
     I                                      156 175 PAYR
     I                                      176 195 PYB1
     I                                      196 215 PYB2
     I                                      216 225 PAYA
     I                                      226 226 METH
     I                                      227 2280DYTP
     I***********                           229 239 SWCRA           S05452S01117
     I***********                           241 245 SWCRB           S05452S01117
     I***********                         P 250 2520LCD                   S01117
     I***********                           253 253 CHTP                  S01117
     I***********                         P 254 2560TNLU                  S01117
     I***********                             1 256 LOTSTD                S01117
     I                                      229 231 BRCDC                 S01117
     I                                      232 235 PRFC                  S01117
     I                                      236 246 SWCRA                 S01117
     I                                      247 251 SWCRB                 S01117
     I************************************P 252 2540LCD            S01117 S01466
     I**************************************255 255 CHTP           S01117 S01466
     I************************************P 256 2580TNLU           S01117 S01466
     I****************************************1 255 LOTSTD         S01117 S01466
     I**************************************256 258 LOTST2         S01117 S01466
     I                                      252 256 TRAT                  S01466
     I                                    P 257 2590LCD                   S01466
     I                                      260 260 CHTP                  S01466
     I                                    P 261 2630TNLU                  S01466
     I                                      265 2740DACD                                      CGL029
     I                                      275 2840CACD                                      CGL029
     I                                        1 255 LOTSTD                S01466
     I**********                            256 263 LOTST2                             S01466 CGL029
     I                                      256 284 LOTST2                                    CGL029
     I**
     I**   STAND FILE - TRAILER RECORD
     I**
     I        NS  07   1 CT
     I                                        1   1 RECI
     I                                        2   6 KEY
     I                                        1   6 SKEY
     I                                    P  13  150NOSO
     I                                    P  16  230VSWN
     I                                    P  24  250VSDC
     I                                    P  26  280NSOI
     I                                    P  29  310NSOA
     I                                    P  32  340NSOD
     I                                    P  35  420VSIW
     I                                    P  43  440VSID
     I                                    P  45  520VSAW
     I                                    P  53  540VSAD
     I                                    P  55  620VSDW
     I                                    P  63  640VSDD
     I                                    P  65  670NSAU
     I                                    P  68  750VSUW
     I                                    P  76  770VSUD
     I************************************P 250 2520LCD                   054720
     I************************************P 254 2560TNLU                  054720
     I                                    P 250 2520LCDT                  054720
     I                                    P 254 2560TNLUT                 054720
     I*****                                   1 256 LOTSTT                S01117
     I                                        1 255 LOTSTT                S01117
     I                                      256 258 LOTST3                S01117
     I**
     I**   CATCHALL
     I**
     I        NS
     I*****                                   1 256 LOTSTD                S01117
     I                                        1 255 LOTSTD                S01117
     I**************************************256 258 LOTST2          S01117S01466
     I**********                            256 263 LOTST2                             S01466 CGL029
     I                                      256 284 LOTST2                                    CGL029
     I**
     I**   MEMO FILE - DETAIL RECORD
     I**
     I***********MEMO    NS  08   1 CD                                    CCB002
     I***********                                        1   1 RECI       CCB002
     I***********                                        2  160GRBL       CCB002
     I***********                                       17  310NETB       CCB002
     I***********                                       32  32 DUBI       CCB002
     I***********                                    P  39  400BNLU       CCB002
     I***********                                        1  40 LOTMEM     CCB002
     I**
     I**   CATCHALL
     I**
     I        NS
     I                                        1  40 LOTMEM
     I***********                                                         S01117
     I*****TABLE*FILE - INST. CONT. DATA RECORD 1                         S01117
     I***********                                                         S01117
     I*ABLE***NS*      1 CD   2 C0   3 C1                                 S01117
     I*******AND*     12 C1  13 C0                                        S01117
     I***********                             1   1 RECI                  S01117
     I***********                             2   30RECT                  S01117
     I***********                            12  13 RCDE                  S01117
     I***********                            14  66 TITL                  S01117
     I***********                            67  67 DATF                  S01117
     I***********                            68  700DFBR        20        S01117
     I***********                            74  74 MODI1                 S01117
     I***********                            75  75 MODI2                 S01117
     I***********                            76  76 MODI3                 S01117
     I***********                         P  77  790RUND                  S01117
     I***********                            80  86 RUNA                  S01117
     I***********                            87  870SFLG                  S01117
     I***********                         P  90  920LCD                   S01117
     I***********                            93  93 CHTP                  S01117
     I***********                         P  94  960TNLU                  S01117
     I***********                             1  96 LOT                   S01117
     I***********                                                         S01117
     I*****TABLE*FILE - BRANCH CODES DETAIL                               S01117
     I***********                                                         S01117
     I********NS* 10   1 CD   2 C1   3 C0                                 S01117
     I***********                             1   1 RECI                  S01117
     I***********                             2   30RECT                  S01117
     I***********                            11  130BRCD                  S01117
     I***********                            11  13 BRCA                  S01117
     I***********                            14  43 BRNM                  S01117
     I***********                            44  490BICN                  S01117
     I***********                            50  51 LOCN                  S01117
     I***********                            52  53 CMPY                  S01117
     I***********                         P  90  920LCD                   S01117
     I***********                            93  93 CHTP                  S01117
     I***********                         P  94  960TNLU                  S01117
     I***********                             1  96 LOT                   S01117
     I**
     I*****TABLE*FILE*-*CURRENCY*CODES DETAIL                             S01194
     I***********                                                         S01194
     I*TABLE**NS* 76   1 CD   2 C2   3 C0                                 S01194
     I*******AND*     38 C0                                               S01194
     I*******OR** 77   1 CD   2 C2   3 C0                                 S01194
     I*******AND*     38 C1                                               S01194
     I*******OR** 78   1 CD   2 C2   3 C0                                 S01194
     I*******AND*     38 C2                                               S01194
     I*******OR** 79   1 CD   2 C2   3 C0                                 S01194
     I*******AND*     38 C3                                               S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                            10  12 CCY                   S01194
     I***********                            13  130SREC                  S01194
     I***********                            14  27 CCNM                  S01194
     I***********                         P  28  348SPOT                  S01194
     I***********                            35  37 CCYS                  S01194
     I***********                            38  380CDP                   S01194
     I***********                            39  390TNOT                  S01194
     I***********                            40  40 DCCY                  S01194
     I***********                            41  44 SRC1                  S01194
     I***********                            45  48 SRC2                  S01194
     I***********                            49  520TACC                  S01194
     I***********                            53  560TEQV                  S01194
     I***********                            57  600SWQV                  S01194
     I***********                            61  640TAC4                  S01194
     I***********                            65  680TAC5                  S01194
     I***********                            69  69 HIND                  S01194
     I***********                         P  70  768PART                  S01194
     I***********                            77  780SSNO                  S01194
     I***********                         P  90  920LCD                   S01194
     I***********                            93  93 CHTP                  S01194
     I***********                         P  94  960TNLU                  S01194
     I***********                             1  96 LOT                   S01194
     I***********                                                         S01195
     I*****TABLE*FILE - HOLIDAY DETAIL RECORD FOR SR. ZFREQ.              S01195
     I***********                                                         S01195
     I********NS*      1 CD   2 C2   3 C2                                 S01195
     I*******AND*     14 CE                                               S01195
     I*******OR**      1 CD   2 C2   3 C2                                 S01195
     I*******AND*     14 CI                                               S01195
     I***********                             1   1 RECI                  S01195
     I***********                             2   30RECT                  S01195
     I***********                             8  120HOL                   S01195
     I***********                            13  130SREC                  S01195
     I***********                            14  14 INEX                  S01195
     I***********                            15  89 HCCY                  S01195
     I***********                         P  90  920LCD                   S01195
     I***********                            93  93 CHTP                  S01195
     I***********                         P  94  960TNLU                  S01195
     I***********                             1  96 LOT                   S01195
     I***********                                                         S01194
     I*****TABLE*FILE*-*INST.*CONT. DATA RECORD 2 FOR SR. ZFREQ.          S01194
     I***********                                                         S01194
     I*TABLE**NS*      1 CD   2 C0   3 C1                                 S01194
     I*******AND*     12 C1  13 C1                                        S01194
     I***********                             1   1 RECI                  S01194
     I***********                             2   30RECT                  S01194
     I***********                            12  13 RCDE                  S01194
     I***********                            14  16 BCCY                  S01194
     I***********                            17  19 BCYL                  S01194
     I***********                            20  22 HOCY                  S01194
     I***********                            23  280HEAD                  S01194
     I***********                         P  29  310APDA                  S01194
     I***********                            35  35 APFQ                  S01194
     I***********                         P  36  380LOGS                  S01194
     I***********                            39  40 CUZR                  S01194
     I***********                         P  41  430DNWD                  S01194
     I***********                            44  460BVLP                  S01194
     I***********                            47  49 LOCY                  S01194
     I***********                            50  510FDAY                  S01194
     I***********                            52  52 ACLD                  S01194
     I***********                            53  53 MBIN                  S01117
     I***********                            86  86 ISAV                  S01194
     I***********                         P  87  890LLOG                  S01194
     I***********                         P  90  920LCD                   S01194
     I***********                            93  93 CHTP                  S01194
     I***********                         P  94  960TNLU                  S01194
     I***********                             1  96 LOT                   S01194
     I***********                                                         S01194
     I*****TABLE*FILE*-*INST.*CONT. DATA RECORD 3                         S01194
     I***********                                                         S01194
     I********NS* 11   1 CD   2 C0   3 C1                                 S01194
     I*******AND*     12 C2  13 C0                                        S01194
     I***********                            69  69 REAC                  S01194
     I***********                                                         S01194
     I*****CATCHALL                                                       S01194
     I***********                                                         S01194
     I********NS*                                                         S01194
     I***********                             1   1 RECI                  S01194
     I**
     I*    ACCOUNT MASTER DETAIL RECORD
     I**
     IACCNT   NS  12   1 CD
     I                                        1   1 RECI
     I                                        2  16 ACMDKY
     I**********                              2   70CNUM                                      CSD027
     I                                        2   7 CNUM                                      CSD027
     I                                        8  10 CCYAC
     I**********                             11  140ACOD                                      CGL029
     I                                       11  140QQACOD                                    CGL029
     I                                       15  160ACSQ
     I                                       23  25 BRCDAC
     I                                       26  26 ATYP
     I                                       28  28 STYP
     I                                       29  29 ACST
     I                                    P  30  320DACO
     I                                    P  33  350DACC
     I                                       36  55 ANAM
     I                                    P  56  630LDBL
     I                                    P  64  710CLBL
     I                                       72  72 STFQ
     I                                       73  740STDY
     I                                    P  75  770LSTD
     I                                    P  78  800NSTD
     I                                    P  81  820LSTP
     I                                    P  83  900CFSB
     I                                    P  91  930LMVD
     I                                    P  94 1010EPLB
     I                                    P 102 1090EPCB
     I                                    P 110 1170YTDB
     I                                      118 118 GLBT
     I                                    P 138 1400DLIM
     I                                    P 141 1430LRCR
     I                                    P 144 1510RTCB
     I                                    P 152 1590RTLB
     I                                    P 160 1660DITM
     I                                    P 167 1730CITM
     I                                    P 178 1837CDIR
     I                                    P 184 1897CCIR
     I                                    P 178 1837CDIR
     I                                    P 184 1897CCIR
     I                                      190 1990ACNO
     I                                      200 200 RETB
     I                                      201 201 ODSC
     I                                    P 202 2070ODLN
     I                                    P 208 2100ODED
     I                                    P 211 2120DIOD
     I                                      213 2150FACT
     I                                      216 2170FCNO
     I                                      218 219 EFAC
     I                                    P 220 2270HELD
     I                                    P 228 2330MINB
     I                                    P 234 2360LACD
     I                                    P 237 2380LISP
     I                                    P 239 2410RRNM
     I**********                            242 2430DRIB                                      CSD103
     I                                      242 243 DRIB                                      CSD103
     I                                    P 244 2497DRIS
     I                                    P 250 2520DRCD
     I                                      253 2530DRIC
     I                                      254 254 DRIF
     I                                      255 2560DRDY
     I                                    P 257 2590NDID
     I                                    P 260 2620LDID
     I                                    P 263 2690LDIA
     I                                      270 270 SDAP
     I                                    P 271 2730LPAR
     I                                    P 274 2800DIIE
     I                                    P 281 2882DAIC
     I                                    P 289 2950MADI
     I                                    P 296 3020GADI
     I                                      303 303 DDIS
     I                                    P 304 3060DDIA
     I                                    P 307 3090OLDR
     I**********                            310 3110OLDB                                      CSD103
     I                                      310 311 OLDB                                      CSD103
     I                                    P 312 3177OLDS
     I**********                            318 3190CRIB                                      CSD103
     I                                      318 319 CRIB                                      CSD103
     I                                    P 320 3257CRIS
     I                                    P 326 3280CRCD
     I                                      329 3290CRIC
     I                                      330 330 CRIF
     I                                      331 3320CRDY
     I                                    P 333 3350NCID
     I                                    P 336 3380LCID
     I                                    P 339 3450LCIA
     I                                      346 346 SCAP
     I                                    P 347 3490LPAP
     I                                    P 350 3560CIIE
     I                                    P 357 3642CAIC
     I                                    P 365 3710MACI
     I                                    P 372 3780GACI
     I                                      379 379 CDIS
     I                                    P 380 3820DCIA
     I                                    P 383 3850OLCR
     I**********                            386 3870OLCB                                      CSD103
     I                                      386 387 OLCB                                      CSD103
     I                                    P 388 3937OLCS
     I************************************P 394 3960LCD                   054720
     I************************************  397 397 CHTP                  054720
     I************************************P 398 4000TNLU                  054720
     I                                    P 394 3960LCDA                  054720
     I                                      397 397 CHTPA                 054720
     I                                    P 398 4000TNLUA                 054720
     I                                      554 5630ACOD                                      CGL029
     I                                      580 580 COLF                                      CGL014
     I**
     I**   CATCHALL
     I**
     I        NS
     I**
     I*    RETAIL ACCOUNT NUMBERS DETAIL RECORD
     I*
     IACNUM   NS  13   1 CD
     I                                        1   1 RECI
     I                                        2  110ACNO
     I**********                             12  170CNUMAN                                    CSD027
     I                                       12  17 CNUMAN                                    CSD027
     I                                       18  20 CCYAN
     I**********                             21  240ACODAN                                    CGL029
     I**********                             25  260ACSQAN                                    CGL029
     I**********                             27  27 ACSTAN                                    CGL029
     I**********                             29  31 BRCDAN                             S01117 CGL029
     I                                       21  300ACODAN                                    CGL029
     I                                       31  320ACSQAN                                    CGL029
     I                                       33  33 ACSTAN                                    CGL029
     I                                       35  37 BRCDAN                                    CGL029
     I************************************P  35  370LCD                   054720
     I************************************P  38  400TNLU                  054720
     I**********                          P  35  370LCDR                               054720 CGL029
     I**********                          P  38  400TNLUR                              054720 CGL029
     I                                    P  40  420LCDR                                      CGL029
     I                                    P  44  460TNLUR                                     CGL029
     I*    CATCHALL FOR DELETED RECORDS
     I**
     I**   CATCHALL
     I**
     I        NS
     IRSACMTPX                                                            109434
     I              CUSN                            #CUSN                 109434
     I              CCYD                            #CCYD                 109434
     I              ACDE                            #ACDE                 109434
     I              ASNC                            #ASNC                 109434
     I              BRCA                            #BRCA                 109434
     I              PTDT                            #PTDT                 109434
     I              VUDT                            #VUDT                 109434
     I              TRYP                            #TRYP                 109434
     I              NRTC                            #NRTC                 109434
     I              NRTD                            #NRTD                 109434
     I              TNMR                            #TNMR                 109434
     I              CQNR                            #CQNR                 109434
     I              MVAM                            #MVAM                 109434
     I              DORC                            #DORC                 109434
      *                                                                   209995
      ** Rename PRONO fields                                              209995
      *                                                                   209995
     IPRONOPNF                                                            209995
     I              RECI                            PRECI                 209995
     I              CCY                             PCCY                  209995
     I              CNUM                            PCNUM                 209995
     I              CSNM                            PCSNM                 209995
     I              TNLU                            PTNLU                 209995
     I**
     I**   D A T A   S T R U C T U R E S .
     I**
     I**   KEY FIELD FOR ACCNT FILE.
     I            DS
     I                                        1   6 KCNUM
     I                                        7   9 KCCY
     I**********                             10  13 KCOD                                      CGL029
     I**********                             14  15 KACSQ                                     CGL029
     I**********                             16  18 KBRCD                              S01117 CGL029
     I                                       10  19 KCOD                                      CGL029
     I                                       20  21 KACSQ                                     CGL029
     I                                       22  24 KBRCD                                     CGL029
     I*****                                   1  15 ACCKEY                S01117
     I**********                              1  18 ACCKEY                             S01117 CGL029
     I                                        1  24 ACCKEY                                    CGL029
      *                                                                   209995
      ** Fields for Original Credit Account                               209995
      *                                                                   209995
     I            DS                                                      209995
     I**********                              1   60CCUS                               209995 CSD027
     I                                        1   6 CCUS                                      CSD027
     I                                        7   9 CCYSTC                209995
     I**********                             10  130CACD                               209995 CGL029
     I**********                             14  150CACS                               209995 CGL029
     I**********                             16  18 BRCDC                              209995 CGL029
     I**********                              1  18 OCAKEY                             209995 CGL029
     I                                       10  190CACD                                      CGL029
     I                                       20  210CACS                                      CGL029
     I                                       22  24 BRCDC                                     CGL029
     I                                        1  24 OCAKEY                                    CGL029
      *                                                                   209995
      ** Fields for Original Debit Account                                209995
      *                                                                   209995
     I            DS                                                      209995
     I**********                              1   60DCUS                               209995 CSD027
     I                                        1   6 DCUS                                      CSD027
     I                                        7   9 CCYSTD                209995
     I**********                             10  130DACD                               209995 CGL029
     I**********                             14  150DACS                               209995 CGL029
     I**********                             16  18 BRCDD                              209995 CGL029
     I**********                              1  18 ODAKEY                             209995 CGL029
     I                                       10  190DACD                                      CGL029
     I                                       20  210DACS                                      CGL029
     I                                       22  24 BRCDD                                     CGL029
     I                                        1  24 ODAKEY                                    CGL029
      *                                                                   209995
      ** Fields for New Credit Account                                    209995
      *                                                                   209995
     I            DS                                                      209995
     I                                        1   6 CCUSSF                209995
     I                                        7   9 CCYCR                 209995
     I**********                             10  13 ACODCR                             209995 CGL029
     I**********                             14  15 CACSSF                             209995 CGL029
     I**********                             16  18 CBRCSF                             209995 CGL029
     I**********                              1  18 NCAKEY                             209995 CGL029
     I                                       10  19 ACODCR                                    CGL029
     I                                       20  21 CACSSF                                    CGL029
     I                                       22  24 CBRCSF                                    CGL029
     I                                        1  24 NCAKEY                                    CGL029
      *                                                                   209995
      ** Fields for New Debit Account                                     209995
      *                                                                   209995
     I            DS                                                      209995
     I                                        1   6 DCUSSF                209995
     I                                        7   9 CCYDR                 209995
     I**********                             10  13 ACODDR                             209995 CGL029
     I**********                             14  15 DACSSF                             209995 CGL029
     I**********                             16  18 DBRCSF                             209995 CGL029
     I**********                              1  18 NDAKEY                             209995 CGL029
     I                                       10  19 ACODDR                                    CGL029
     I                                       20  21 DACSSF                                    CGL029
     I                                       22  24 DBRCSF                                    CGL029
     I                                        1  24 NDAKEY                                    CGL029
     I**   SWIFT COMMON REFERENCE   FILE TO SCREEN                        S05452
     I            DS                             16                       S05452
     I                                        1  11 SWCRA                 S05452
     I                                       12  16 SWCRB                 S05452
     I                                        1  16 SWCR                  S05452
     I**   SWIFT COMMON REFERENCE   SCREEN TO FILE                        S05452
     I            DS                             16                       S05452
     I                                        1  16 ISWCR                 S05452
     I/COPY WNCPYSRC,RE0253I005
     I                                        1  11 OSWCRA                S05452
     I                                       12  16 OSWCRB                S05452
     I**
     I**   LAST TRANSACTION DATA.
     I            DS
     I/COPY WNCPYSRC,RE0253I003
     I                                        1   50LCD
     I/COPY WNCPYSRC,RE0253I004
     I                                        6   6 CHTP
     I                                        7  110TNLU
     I                                        1  11 LSTC
     I                                       12  160LCDSF
     I                                       17  17 CHTPSF
     I                                       18  220TNLUSF
     I                                       12  22 LSTCSF
      *                                                                   209995
      ** PRONO balances & dates                                           209995
      *                                                                   209995
     I            DS                                                      209995
     I                                        1  40 PNB                   209995
     I                                    P   1  40 PBL                   209995
     I                                       41  55 PND                   209995
     I                                    P  41  55 PDT                   209995
     I*
      **  DATA STRUCTURE TO PASS DATA TO WN0010 AND RETURN PGM            S01241
      **                                                                  S01241
      /COPY QWINDSRC,RE0253DTA                                            S01241
      *                                                                   S01241
     I** PROGRAM STATUS DATA STRUCTURE
     IPSDS       SDS
     I                                     *PROGRAM ZAPGM                 S01241
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I                                      254 263 USRID
     I*
     IDNATN       DS                              5
     I                                        1   50FNATN
     I**
     I**   DATA STRUCTURE FOR ERROR HANDLING SUBROUTINE
     IINFDS       DS
     I                                     *STATUS  STATUS
     I**
     I**  DATA STRUCTURE TO PROVIDE TEXT ON COMIT ENTRY IN JOURNAL
     ICMTTXT      DS
     I                                        1   50NATN
     I                                        6   7 MDID
     I                                        8  15 PGMN
     I                                       16  18 WSIDX
     I                                       19  240MTIME
     I                                       25  25 HLDACT
     I                                       26  35 USRIDX
     I                                       51  55 STORSF
     I******                                 56 295 LOTSF                 S05452
     I***********                            56 311 LOTSF           S05452S01117
     I                                       56 307 LOTSF                 S01117
     I**************************************308 327 LOTSF2          S01117S01466
     I**********                            308 332 LOTSF2                             S01466 CGL029
     I                                      308 344 LOTSF2                                    CGL029
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I**  DATA AREA RUNDAT                                                S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     IZMUSER      DS                             17                       S01117
     I** DATA AREA OF MENU USER                                           S01117
     I                                        1  10 USRPRF                S01117
     I                                       11  13 DFBM                  S01117
     I*                                                                   S01117
     I***   LOCAL DATA AREA TO IDENTIFY DATABASE ERRORS                   S01117
     I*                                                                   S01117
     ILDA        UDS                            256                       S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I*                                                                   S01408
     I/COPY WNCPYSRC,RE0253IIPG                                           S01408
     I*                                                                   S01408
      *                                                                   S01194
     ISDRETL    E DSSDRETLPD                                              S01194
      **   RETAIL DETAILS                                                 S01194
      *                                                                   S01194
      ** Watch List Transaction Details (OPM)                                                 CSD015
     ISDWLTO    E DSSDWLTOPD                                                                  CSD015
      *                                                                                       CSD015
      ** Watch List Checking Details                                                          CSD015
     ISDWLCC    E DSSDWLCCPD                                                                  CSD015
      *                                                                                       CSD015
      ** SD Data Area                                                                         CSD015
     ISDSTAT    E DSSDSTAT                                                                    CSD015
      *                                                                                       CSD015
      ** 24X7 status data area                                                                CSD015
     ISC24X7    E DSSC24X7                                                                    CSD015
      *                                                                                       CSD015
      ** Compliance Watch Configuration Data File                                             CSD015
     ISDCWCD    E DSSDCWCDPD                                                                  CSD015
      *                                                                                       CSD015
      ** DS for 2nd parameter of Compliance Engine                                            CSD015
     IPXML        DS                           9999                                           CSD015
      *                                                                                       CSD015
     ISDCUST    E DSSDCUSTPD                                              LN0056
      **   CUSTOMER DETAILS                                               LN0056
      *                                                                   LN0056
     ISDACOD    E DSSDACODPD                                              LN0056
     I              QQACCD                          QQACC1                                    CGL029
      **   ACCOUNT CODE DETAILS                                           LN0056
      *                                                                   LN0056
     ISDCURR    E DSSDCURRPD                                              S01194
      **   CURRENCY TYPE                                                  S01194
     I              A6CYCD                          CCY                   S01117
     I              A6NBDP                          CDP                   S01117
     I*                                                                   S01117
     ISDBANK    E DSSDBANKPD                                              209995
      ** BANK DETAILS                                                     209995
     I              BJLCCY                          LOCCY                 209995
     ISDGELR    E DSSDGELRPD                                              S01117
     I** GENERAL LEDGER DETAILS                                           S01117
     I              BKPRCU                          PFCU                  S01117
     I              BKPRCA                          PFCA                  S01117
     I              BKPCDU                          PFCD                  S01117
     I              QQACCD                          QQACC2                                    CGL029
     I**                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              A8BRCD                          BRCA                  S01117
     I              QQDFAC                          QQDFC1                                    CGL029
     I**                                                                  S01117
     ISDPRFM    E DSSDPRFMPD                                              S01117
     I**  EXTERNAL DS FOR PROFIT CENTRE DFT. MATRIX RETRIEVAL INDEX       S01117
     I**                                                                  S01117
     ISDPRFC    E DSSDPRFCPD                                              S01117
     I**  EXTERNAL DS FOR PROFIT CENTRES                                  S01117
     I**                                                                  S01194
     ISCSARD    E DSSCSARDPD                                              S01466
     I              LCD                             LCDX                  S01466
     I* SAR FILE DETAILS ACCESSED VIA ACCESS PROGRAM  AOSARDR0            S01466
     I*                                                                   S01466
     ISDRETR    E DSSDRETRPD                                              S01466
     I* EXTERNAL DS FOR RETAIL TRANSACTION TYPES                          S01466
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I              'StandingOrders    '  C         STANOR                                    CRE020
      *                                                                                       CRE020
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I*****************************************************************   S01117
     C                     MOVEACPY@      BIS@   80
      *                                                                   209995
      ** Key lists                                                        209995
      *                                                                   209995
     C           KNOST     KLIST                                          209995
     C                     KFLD           A7CUST                          209995
     C                     KFLD           A7CYCD                          209995
     C                     KFLD           A7ACCD                          209995
     C                     KFLD           A7ACSN                          209995
      *                                                                   209995
     C           KPRON     KLIST                                          209995
     C                     KFLD           A7CYCD                          209995
     C                     KFLD           NOSN                            209995
      *                                                                   209995
      ** Midas RE Settled Transaction Index File Key Lists                                    CRE020
      *                                                                                       CRE020
     C           KADV1     KLIST                                                              CRE020
     C                     KFLD           KREFNO 30                                           CRE020
     C                     KFLD           KPRGMN 10                                           CRE020
     C                     KFLD           KSEQNO  3                                           CRE020
      *                                                                                       CRE020
     C           KADV2     KLIST                                                              CRE020
     C                     KFLD           KREFNO                                              CRE020
     C                     KFLD           KPRGMN                                              CRE020
      *                                                                                       CRE020
     C           *LIKE     DEFN NXTP      @NXTP                           209995
     C           *LIKE     DEFN AFPY      @AMT                            209995
     C           *LIKE     DEFN AFPY      @AFPY                           209995
     C           *LIKE     DEFN DFPY      @DFPY                           209995
     C           *LIKE     DEFN ASPY      @ASPY                           209995
     C           *LIKE     DEFN DSPY      @DSPY                           209995
     C           *LIKE     DEFN ALPY      @ALPY                           209995
     C           *LIKE     DEFN DLPY      @DLPY                           209995
     C           *LIKE     DEFN PAYF      @PAYF                           209995
     C           *LIKE     DEFN CCYST     @CCY                            209995
     C           *LIKE     DEFN DYTP      @DYTP                           209995
      *                                                                   117784
     C           *LIKE     DEFN CRAC      CRACO                           117784
     C           *LIKE     DEFN CRAC      CRACN                           117784
     C           *LIKE     DEFN BBACOC    DACOFF                          176510
     C           *LIKE     DEFN BBACOC    DWACOF                          176510
     C*                                                                   S01194
     C* PARAMETER LIST FOR AORETLR0                                       S01194
     C*                                                                   S01194
     C           PLIST1    PLIST                                          S01194
     C                     PARM '*DBERR ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOCURRR0                                       S01194
     C*                                                                   S01194
     C           PLIST2    PLIST                                          S01194
     C                     PARM           @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM           CKEY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*                                                                   S01194
     C* PARAMETER LIST FOR AOCUSTR0                                       LN0056
     C*                                                                   LN0056
     C           PLISTA    PLIST                                          LN0056
     C                     PARM '*BLANKS' RTCD    7                       LN0056
     C                     PARM '*KEY   ' OPTN    7                       LN0056
     C                     PARM           CUSKEY 10                       LN0056
     C                     PARM '*CNUM  ' KEYSTS  7                       LN0056
     C           SDCUST    PARM SDCUST    DSSDY                           LN0056
     C*                                                                   LN0056
     C* PARAMETER LIST FOR AOACODR0                                       LN0056
     C*                                                                   LN0056
     C           PLISTB    PLIST                                          LN0056
     C                     PARM '*BLANKS' RTCD                            LN0056
     C                     PARM '*KEY   ' OPTN                            LN0056
     C**********           PARM           ACOKEY  4                                    LN0056 CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        LN0056 CGL029
     C                     PARM           ACOKEY 10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           RKEY      KLIST                                          109434
     C                     KFLD           #BRCA                           109434
     C                     KFLD           #CUSN                           109434
     C                     KFLD           #CCYD                           109434
     C                     KFLD           #ACDE                           109434
     C                     KFLD           #ASNC                           109434
      *                                                                                       CSD015
      **   Key List for LF/SDCWHTL1                                                           CSD015
      *                                                                                       CSD015
     C           KCWHTL    KLIST                                                              CSD015
     C                     KFLD           KFUNT   8                                           CSD015
     C                     KFLD           KIDEN  40                                           CSD015
     C                     KFLD           KBRCH   3                                           CSD015
      *                                                                                       CAP205
      ** Determine if SAR CAP205 Teller Related APIs - Account Balance Check                  CAP205
      ** is installed.                                                                        CAP205
      *                                                                                       CAP205
     C                     MOVEL'N'       CAP205  1                                           CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM *BLANKS   @RTCD                                               CAP205
     C                     PARM '*VERIFY '@OPTN                                               CAP205
     C                     PARM 'CAP205'  @SARD                                               CAP205
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP205
      *                                                                                       CAP205
     C           @RTCD     IFEQ *BLANKS                                                       CAP205
     C                     MOVEL'Y'       CAP205                                              CAP205
     C                     ELSE                                                               CAP205
     C           @RTCD     IFNE *BLANKS                                                       CAP205
     C           @RTCD     ANDNE'*NRF   '                                                     CAP205
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP205
     C                     Z-ADD38        DBASE                                               CAP205
     C                     MOVEL'CAP205'  DBKEY                                               CAP205
     C                     EXSR *PSSR                                                         CAP205
     C                     ENDIF                                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCP1                                           S01408
     C*                                                                   S01408
     C*                                                                   LN0056
     C**   FROM ERROR HANDLING SUBROUTINE RETURN TO EXIT POINT
     C           STATUS    IFEQ 01021
     C                     Z-ADD0         STATUS  50
     C                     GOTO INFTAG
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCP2                                           S01408
     C*                                                                   S01408
     C*                                                                   S01241
     C*         ... CMD12 PRESSED - GOTO TO ENQUIRY SCREEN ...            S01241
     C*                                                                   S01241
     C           *INKL     IFEQ '1'                                       S01241
     C                     Z-ADD1         ETAT                            S01241
     C                     END                                            S01241
     C*                                                                   S01241
     C*          ... ERROR OCCURED ON ENQUIRY SCREEN ...                  S01241
     C*                                                                   S01241
     C  N41      ETAT      IFNE 3                                         S01241
     C                     Z-ADD1         ETAT                            S01241
     C                     END                                            S01241
     C*                                                  FIRST CYCLE-INIT S01241
     C           *IN05     IFEQ '0'                                       S01241
     C                     Z-ADD1         ETAT    10                      S01241
     C                     ELSE                                           S01241
     C*                                                  OK TO DSP BOT    S01241
     C           ETAT      IFEQ 1                                         S01241
     C                     Z-ADD2         ETAT                            S01241
     C                     ELSE                                           S01241
     C*                                                  BOT DISPLAYED    S01241
     C           ETAT      IFEQ 2                          OK TO DSP DET. S01241
     C                     Z-ADD3         ETAT                            S01241
     C                     MOVELHELDSF    STORW   5                       S01241
     C                     MOVELHLDACT    ACTNW   1                       S01241
     C                     ELSE                                           S01241
     C*                                                  READY TO DISPLAY S01241
     C           HELDSF    IFEQ *BLANKS                          WINDOW   S01241
     C                     Z-ADD2         ETAT                            S01241
     C                     ELSE                                           S01241
     C                     Z-ADD3         ETAT                            S01241
     C                     END                                            S01241
     C*                                                                   S01241
     C*          ... CALL WINDOW WHEN ENQUIRY/DELETE                      S01241
     C*              THESE DISPLAYS CONTAINS INPUT FIELD AT BOTTOM        S01241
     C*              OF THE SCREEN ...                                    S01241
     C*                                                                   S01241
     C           ACTNW     IFEQ 'E'                                       S01241
     C           ACTNW     OREQ 'D'                                       S01241
     C*                                                                   S01241
     C                     MOVEL'RE0253'  #PGM                            S01241
     C                     MOVE *BLANKS   #RTRN                           S01241
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCP3                                           S01408
     C*                                                                   S01408
     C*                                                                   S01241
     C***********BGL5ST    IFEQ 'Y'                                 S01241S01251
     C           BGWDPR    IFEQ 'Y'                                       S01251
      *    /copy to move data into the data structure fields passed       S01241
      *     as a parameter to the window controller                       S01241
      /COPY WNCPYSRC,RE0253MOV1                                           S01241
      *                                                                   S01241
     C                     UNLCKLDA                                       S01241
     C                     CALL 'WN0010'                                  S01241
     C                     PARM           #PGM   10                       S01241
     C                     PARM *BLANK    WKEY    2                       S01241
     C                     PARM           ACTNW   1                       S01241
     C                     PARM           DATA                            S01241
     C                     PARM *BLANK    #RTRN   7                       S01241
     C                     PARM           SPARE 256                       S01252
     C           *LOCK     IN   LDA                                       S01241
     C                     END                                            S01241
     C*                                                                   S01241
     C*          ... SAVE DATA KEYED IN AT BOTTOM OF THE SCREEN ...       S01241
     C*                                                                   S01241
     C                     MOVE HLDACT    ACTNW                           S01241
     C                     MOVE HELDSF    STORW                           S01241
     C*                                                                   S01241
     C           #RTRN     IFEQ 'USR0790'                                 S01241
     C/COPY WNCPYSRC,RE0253C050
     C                     Z-ADD1         ETAT                            S01241
     C                     SETON                         64               S01241
     C                     SETOF                     62                   S01241
     C                     GOTO SETSF                                     S01241
     C                     END                                            S01241
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CP14                                           S01408
     C*                                                                   S01408
     C                     END                                            S01241
     C*                                                                   S01241
     C                     END                                            S01241
     C                     END                                            S01241
     C                     END                                            S01241
     C**
     C*    READ WORKSTATION FILE /*HELP*FACILITY***********               S01199
     C**
     C           *IN05     IFEQ '1'
     C           *IN97     DOUEQ'0'
     C                     READ RE0253FM                 97
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           *IN97     ANDEQ*OFF                                                          CRE020
     C                     MOVE *BLANKS   PNARSF                                              CRE020
     C                     MOVELPNAASF    PNARSF                                              CRE020
     C                     MOVELPNAASF    PANASF                                              CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C/COPY WNCPYSRC,RE0253C027
     C************IN97     IFEQ '1'                                       S01199
     C***********          MOVEAERCD      HERCD 160                       S01199
     C***********          MOVEL'RE0253  'HBPGM   6                       S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C***********          END                                            S01199
     C                     END
     C                     GOTO START
     C                     END
     C*
     C   05                GOTO START
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCP4                                           S01408
     C*                                                                   S01408
     C**
     C**   FIRST CYCLE ONLY CALCS.
     C**                                                                  S01117
     C*                                                                   S01241
     C***  DETERMINE IF WINDOW REQUIRED (BGL5ST IN SDMMODPD)              S01241
     C*                                                                   S01241
     C                     OPEN SDMMODPD                                  S01241
     C           1         SETLLSDMMODPD                                  E22221
     C                     READ SDMMODPD                 89               S01241
     C           *IN89     IFEQ '1'                                       S01241
     C                     SETON                     U7U8                 S01241
     C                     MOVEL99        DBASE            * DB ERROR 99* S01241
     C                     MOVEL*BLANKS   DBKEY                           S01241
     C                     MOVE 'SDMMO'   DBFILE                          S01241
     C                     GOTO END                                       S01241
     C                     END                                            S01241
     C                     CLOSESDMMODPD                                  S01241
     C**                                                                  S01117
     C**    IN THE DATAAREA RUNDAT                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN           LDA                             S01241
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C                     MOVE *BLANKS   DBFILE                          S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVE *BLANKS   DBPGM                           S01117
     C                     MOVEL'RE0253'  DBPGM                           S01117
     C**                                                                  S01117
     C**    IN THE DATAAREA ZMUSER                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C                     IN   ZMUSER                                    S01117
      *                                                                                       CSD015
      ** Define dataara SDSTAT and SC24X7                                                     CSD015
      *                                                                                       CSD015
     C           *NAMVAR   DEFN           SC24X7                                              CSD015
     C           *NAMVAR   DEFN           SDSTAT                                              CSD015
     C                     IN   SDSTAT                                                        CSD015
      *                                                                                       CSD015
      ** Check if 24x7 Midas Availability is installed                                        CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CSC011'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVE 'SCSARDPD'DBFILE                                              CSD015
     C                     MOVE 'CSC011'  DBKEY                                               CSD015
     C                     Z-ADD07        DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     SETON                     U7U8LR                                   CSD015
     C                     GOTO END                                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSC011  1                                           CSD015
     C                     IN   SC24X7                                                        CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'N'       CSC011                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if Compliance Watch Enhancement (CSD015) is installed                          CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CSD015'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVE 'SCSARDPD'DBFILE                                              CSD015
     C                     MOVE 'CSD015'  DBKEY                                               CSD015
     C                     Z-ADD08        DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     SETON                     U7U8LR                                   CSD015
     C                     GOTO END                                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CSD015  1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'N'       CSD015                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if function code is being monitored by compliance watch                        CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C                     CALL 'AOWLCCR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*KEY   ' @OPTN                                               CSD015
     C                     PARM 'STANDORD'PFUNC   8                                           CSD015
     C           SDWLCC    PARM SDWLCC    DSFDY                                               CSD015
      *                                                                                       CSD015
      ** If return code not blank nor *NRF, then issue database error                         CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVE 'STANDORD'DBKEY                                               CSD015
     C                     MOVE 'SDWLCCPD'DBFILE                                              CSD015
     C                     Z-ADD09        DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     SETON                     U7U8LR                                   CSD015
     C                     GOTO END                                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Access compliance watch configuration                                                CSD015
      *                                                                                       CSD015
     C                     CALL 'AOCWCDR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*FIRST ' @OPTN                                               CSD015
     C           SDCWCD    PARM SDCWCD    DSSDY                                               CSD015
      *                                                                                       CSD015
      ** If return code not blank, then issue database error.                                 CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C                     MOVE @OPTN     DBKEY                                               CSD015
     C                     MOVE 'SDCWCDPD'DBFILE                                              CSD015
     C                     Z-ADD10        DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     SETON                     U7U8LR                                   CSD015
     C                     GOTO END                                                           CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Check if switchable feature CCF001 is installed                                      CSD015
      *                                                                                       CSD015
     C                     CALL 'AOSARDR0'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM '*VERIFY' @OPTN                                               CSD015
     C                     PARM 'CCF001'  @SARD                                               CSD015
     C           SCSARD    PARM SCSARD    DSFDY                                               CSD015
      *                                                                                       CSD015
     C           @RTCD     IFNE *BLANKS                                                       CSD015
     C           @RTCD     ANDNE'*NRF   '                                                     CSD015
     C                     MOVE 'SCSARDPD'DBFILE                                              CSD015
     C                     MOVE 'CCF001'  DBKEY                                               CSD015
     C                     Z-ADD11        DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     SETON                     U7U8LR                                   CSD015
     C                     GOTO END                                                           CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           @RTCD     IFEQ *BLANKS                                                       CSD015
     C                     MOVE 'Y'       CCF001  1                                           CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'N'       CCF001                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CRE020
      ** Check if CRE020 is enabled.                                                          CRE020
      *                                                                                       CRE020
     C                     CALL 'AOSARDR0'                                                    CRE020
     C                     PARM *BLANKS   PRTCD   7                                           CRE020
     C                     PARM '*VERIFY' POPTN   7                                           CRE020
     C                     PARM 'CRE020'  PSARD   6                                           CRE020
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE020
      *                                                                                       CRE020
     C                     MOVE 'N'       CRE020  1                                           CRE020
      *                                                                                       CRE020
     C           PRTCD     IFEQ *BLANKS                                                       CRE020
     C                     MOVE 'Y'       CRE020                                              CRE020
     C                     MOVEL'RE0253'  KPRGMN                                              CRE020
     C                     MOVE *ON       *IN18                                               CRE020
     C                     ELSE                                                               CRE020
      *                                                                                       CRE020
     C           PRTCD     IFNE '*NRF'                                                        CRE020
     C           *LOCK     IN   LDA                                                           CRE020
     C                     MOVEL'SCSARDPD'DBFILE                                              CRE020
     C                     MOVEL'CRE020'  DBKEY                                               CRE020
     C                     Z-ADD13        DBASE                                               CRE020
     C                     OUT  LDA                                                           CRE020
     C                     MOVE *ON       *INU7                                               CRE020
     C                     MOVE *ON       *INU8                                               CRE020
     C                     MOVE *ON       *INLR                                               CRE020
     C                     EXSR *PSSR                                                         CRE020
     C                     GOTO END                                                           CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
      ** Check if a System Value exists for this maintenance.                                 CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
      *                                                                                       CRE020
     C                     CALL 'AOSVALR0'                                                    CRE020
     C                     PARM *BLANKS   PRTCD                                               CRE020
     C                     PARM STANOR    PSV01  20                                           CRE020
     C                     PARM           PCS01 200                                           CRE020
     C                     PARM           PSV02  20                                           CRE020
     C                     PARM           PCS02 200                                           CRE020
     C                     PARM           PSV03  20                                           CRE020
     C                     PARM           PCS03 200                                           CRE020
     C                     PARM           PSV04  20                                           CRE020
     C                     PARM           PCS04 200                                           CRE020
     C                     PARM           PSV05  20                                           CRE020
     C                     PARM           PCS05 200                                           CRE020
     C                     PARM           PSV06  20                                           CRE020
     C                     PARM           PCS06 200                                           CRE020
     C                     PARM           PSV07  20                                           CRE020
     C                     PARM           PCS07 200                                           CRE020
     C                     PARM           PSV08  20                                           CRE020
     C                     PARM           PCS08 200                                           CRE020
     C                     PARM           PSV09  20                                           CRE020
     C                     PARM           PCS09 200                                           CRE020
     C                     PARM           PSV10  20                                           CRE020
     C                     PARM           PCS10 200                                           CRE020
      *                                                                                       CRE020
     C                     MOVE 'N'       WSV01   1                                           CRE020
      *                                                                                       CRE020
     C           PRTCD     IFEQ *BLANKS                                                       CRE020
     C                     MOVELPCS01     WSV01                                               CRE020
     C                     ELSE                                                               CRE020
      *                                                                                       CRE020
     C           PRTCD     IFNE '*NRF'                                                        CRE020
     C           *LOCK     IN   LDA                                                           CRE020
     C                     MOVEL'SDSVALPD'DBFILE                                              CRE020
     C                     MOVELPSV01     DBKEY                                               CRE020
     C                     Z-ADD14        DBASE                                               CRE020
     C                     OUT  LDA                                                           CRE020
     C                     MOVE *ON       *INU7                                               CRE020
     C                     MOVE *ON       *INU8                                               CRE020
     C                     MOVE *ON       *INLR                                               CRE020
     C                     EXSR *PSSR                                                         CRE020
     C                     GOTO END                                                           CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
     C*                                                                   S01466
     C** Access SAR details file to determine if Addition of              S01466
     C** Transaction Type to Standing Orders is switched ON               S01466
     C*                                                                   S01466
     C                     CALL 'AOSARDR0'                                S01466
     C                     PARM *BLANKS   @RTCD   7                       S01466
     C                     PARM '*VERIFY' @OPTN   7                       S01466
     C                     PARM 'S01466'  @SARD   6                       S01466
     C           SCSARD    PARM SCSARD    DSFDY                           S01466
     C                     SETOF                     10                   S01466
     C                     MOVE 'N'       S01466  1                       S01466
     C*                                                                   S01466
     C** If core feature is switched ON, set on indicator and variable    S01466
     C** field to condition the rest of the processing                    S01466
     C*                                                                   S01466
     C           @RTCD     IFEQ *BLANKS                                   S01466
     C                     SETON                     10                   S01466
     C                     MOVE 'Y'       S01466                          S01466
     C                     ELSE                                           S01466
     C*                                                                   S01466
     C** else, database error (return code other than *NRF)               S01466
     C*                                                                   S01466
     C           @RTCD     IFNE '*NRF   '                                 S01466
     C                     MOVEL'RE0253 ' DBPGM                           S01466
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01466
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 01 *   S01466
     C                     Z-ADD01        DBASE            ************   S01466
     C                     OUT  LDA                                       S01466
     C                     EXSR *PSSR                                     S01466
     C                     SETON                     U7U8LR               S01466
     C                     GOTO END                                       S01466
     C                     END                                            S01466
     C                     END                                            S01466
      *                                                                                       CGL014
      ** Check if enhancement CGL014 (Collaterals Processing) is on                           CGL014
      *                                                                                       CGL014
     C                     CALL 'AOSARDR0'                                                    CGL014
     C                     PARM *BLANKS   PRTCD   7                                           CGL014
     C                     PARM '*VERIFY' POPTN   7                                           CGL014
     C                     PARM 'CGL014'  PSARD   6                                           CGL014
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL014
      *                                                                                       CGL014
     C           PRTCD     IFNE *BLANKS                                                       CGL014
     C           PRTCD     ANDNE'*NRF   '                                                     CGL014
     C                     MOVEL'RE0253  'DBPGM                                               CGL014
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL014
     C                     MOVEL'CGL014  'DBKEY                                               CGL014
     C                     Z-ADD4         DBASE                                               CGL014
     C                     OUT  LDA                                                           CGL014
     C                     EXSR *PSSR                                                         CGL014
     C                     SETON                     U7U8LR                                   CGL014
     C                     GOTO END                                                           CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ *BLANKS                                                       CGL014
     C                     MOVE 'Y'       CGL014  1                                           CGL014
     C                     Z-ADD0         WCOPY1 130                                          CGL014
     C                     Z-ADD0         WCOPY2 130                                          CGL014
     C                     Z-ADD0         WCOPY3 130                                          CGL014
     C                     MOVE '0'       WARN1   1                                           CGL014
     C                     MOVE '0'       WARN2   1                                           CGL014
     C                     MOVE '0'       WARN3   1                                           CGL014
     C                     ELSE                                                               CGL014
     C                     MOVE 'N'       CGL014                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C/COPY WNCPYSRC,RE0253C010
      *                                                                   CRE009
      ** Access SAR details file to check if CRE009 is ON                 CRE009
      *                                                                   CRE009
     C                     CALL 'AOSARDR0'                                CRE009
     C                     PARM *BLANKS   @RTCD   7                       CRE009
     C                     PARM '*VERIFY' @OPTN   7                       CRE009
     C                     PARM 'CRE009'  @SARD   6                       CRE009
     C           SCSARD    PARM SCSARD    DSFDY                           CRE009
      *                                                                   CRE009
     C           @RTCD     IFEQ *BLANKS                                   CRE009
     C                     MOVE 'Y'       CRE009  1                       CRE009
     C                     ELSE                                           CRE009
     C                     MOVE 'N'       CRE009                          CRE009
     C                     ENDIF                                          CRE009
      *                                                                   209995
      ** ACCESS BANK DETAILS                                              209995
      *                                                                   209995
     C                     CALL 'AOBANKR0'                                209995
     C                     PARM '*MSG   ' @RTCD   7                       209995
     C                     PARM '*FIRST ' @OPTN   7                       209995
     C           SDBANK    PARM SDBANK    DSFDY                           209995
     C           @RTCD     IFNE *BLANK                                    209995
     C           *LOCK     IN   LDA                                       209995
     C                     MOVEL'SDBANKPD'DBFILE             *************209995
     C                     MOVEL@OPTN     DBKEY              * DBERR 004 *209995
     C                     Z-ADD04        DBASE              *************209995
     C                     OUT  LDA                                       209995
     C                     EXSR *PSSR                                     209995
     C                     SETON                     U7U8LR               209995
     C                     GOTO END                                       209995
     C                     END                                            209995
     C*                                                                   S01117
     C** ACCESS GENERAL LEDGER DETAILS FOR PROFIT CENTRE FLAGS            S01117
     C**********           CALL 'AOGELRR0'                                S01117              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C********** SDGELR    PARM SDGELR    DSFDY                           S01117              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*                                                                   S01117
     C**    IF PROFIT CENTRE IS NOT USED, PROTECT & NON-DISPLAY IPRFC.    S01117
     C           PFCU      IFNE 'Y'                                       S01117
     C                     SETON                     21                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     EXSR ZSYSTM                     -GET ICDR.
     C***99******          SETON                     U883  -DATABASE ERRORS01117
     C***99******          GOTO END                                       S01117
     C                     SETON                     05
     C**
     C**  OBTAIN INST. CONTROL DATA RECORD 2 FOR MULTI-BRANCHING IND.
     C*****  ONLY IF DEFAULT BRANCH CODE IS ZERO                          S01117
     C*****      DFBR      IFEQ 0                                         S01117
     C***********          MOVEL'01      'TABKEY                          S01117
     C***********          MOVE '  11'    TABKEY                          S01117
     C*****                EXSR TABCHN                                    S01117
     C** 99 *************  SETON                     U841LRDATABASE ERROR E10339
     C** 99 *************  GOTO END                                       E10339
     C***81******          SETON              U841LRDATABASE ERROR  E10339S01117
     C***81******          GOTO END                                 E10339S01117
     C**
     C**   SET ON *IN66 IF MULTI-BRANCHING INDICATOR IS 'Y'
     C*****    AND DFBR IS ZERO                                           S01117
     C           MBIN      COMP 'Y'                      66
     C*****                END                                            S01117
     C**
     C**   SET UP BLANK AND WORK FIELDS AND INITIAL SCREEN.
     C                     Z-ADD01        E       20
     C                     MOVE ' '       BLNK60 60
     C                     MOVE ' '       BLNK14 14
     C*****                MOVE ' '       BLK15  15                       S01117
     C**********           MOVE *BLANKS   BLK18  18                                    S01117 CGL029
     C                     MOVE *BLANKS   BLK18  24                                           CGL029
     C                     MOVE ' '       BLK10  10
     C*********            MOVE ' '       BLK238238                       S05452
     C***********          MOVE ' '       BLK254254                 S05452S01117
     C***********          MOVE *BLANKS   BLK245245                S01117 S01466
     C                     MOVE *BLANKS   BLK250250                       S01466
     C                     MOVE ' '       BLK16  16                       S01117
     C                     MOVE *BLANKS   BLK3    3                       S01117
     C                     Z-ADD0         ZERO10 100
     C                     Z-ADD0         ZERO05  50
     C                     MOVE '1'       CCYK    4
     C                     MOVE 'N'       MBSI
     C                     SETON                     6465
     C*****ACCESS*TABLE*FILE*FOR RETAIL A/C NOS. INDICATOR.               S01194
     C***********          MOVE ZTABKY    TABKEY                          S01194
     C***********          MOVE ZTABKY    TABKEY                          S01194
     C***********          MOVE '      20'TABKEY                          S01194
     C***********          EXSR TABCHN                                    S01194
     C*                                                                   S01194
     C* CALL ACCESS PROGRAM FOR RETAIL A/C NOS. INDICATOR                 S01194
     C                     CALL 'AORETLR0'PLIST1                          S01194
     C***11******REAC      COMP 'Y'                  161614               S01194
     C   11      BMRANR    COMP 'Y'                  161614               S01194
     C*                                                                   S01194
     C**   SET UP SCREEN ID.
     C                     MOVE 'SF'      SFCODE
     C                     SETON                     15
     C                     GOTO SETSF
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCP5                                           S01408
     C*                                                                   S01408
     C**
     C           START     TAG                             ** START TAG **
     C                     MOVE '0'       ER32    1                       S01117
     C                     MOVE '0'       ER41    1                       S01117
     C                     MOVE '0'       ER42    1                       S01117
     C                     MOVE 'N'       OMBSI   1                       S01117
     C*                    READ RE0253FM                 97
     C*  97                SETOF                     97
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCP6                                           S01408
     C*                                                                   S01408
     C*
     C***01*18**           MOVE ESTOR     STORSF                                              CRE020
     C***01*18**           MOVE EACT      ACTION                                              CRE020
      *                                                                                       CRE020
     C           *IN01     IFEQ *ON                                                           CRE020
     C           WIN18     ANDEQ'1'                                                           CRE020
     C                     MOVE ESTOR     STORSF                                              CRE020
     C                     MOVE EACT      ACTION                                              CRE020
     C                     ENDIF                                                              CRE020
     C**
     C**   RESET INDICES AND INDICATORS AND FIELDS.
     C                     MOVE *BLANKS   OCBRC   3                       S01117
     C                     MOVE *BLANKS   ODBRC   3                       S01117
      *
     C                     MOVE *BLANKS   DCUSSC                                             BUG2978
     C                     MOVE *BLANKS   DCCYSC                                             BUG2978
     C                     MOVE *BLANKS   BRCDD                                              BUG2978
      *
      *
     C                     MOVE BLNK60    ERCD
     C**
     C                     Z-ADD0         X       20
     C                     Z-ADD1         E                               088294
     C                     Z-ADD0         DFPYSF  50
     C                     Z-ADD0         DSPYSF  50
     C                     Z-ADD0         DLPYSF  50
     C                     Z-ADD0         AFPYSF 130
     C                     Z-ADD0         ASPYSF 130
     C                     Z-ADD0         ALPYSF 130
     C**
     C                     SETOF                     11                   S01466
     C                     SETOF                     44
     C                     SETOF                     454647
     C                     SETOF                     484950
     C                     SETOF                     515253
     C                     SETOF                     545556
     C                     SETOF                     575859
     C                     SETOF                     6061
     C***********          SETOF                     638771               S01117
     C                     SETOF                     6371                 S01117
     C                     SETOF                     727380
     C                     SETOF                     829940
     C                     SETOF                     858674
     C***32*ON*FOR NON DISPLAY OF NEXT AND LAST PAY DATE                  S01117
     C***********          SETON                     32                   S01117
     C** 32 OFF FOR RESET ERROR OF SCREEN FIELD: TRANSACTION BRANCH       S01117
     C                     SETOF                     32                   S01117
     C** 43 OFF FOR RESET ERROR OF SCREEN FIELD: PROFIT CENTRE            S01117
     C                     SETOF                     43                   S01117
     C**
     C                     SETON                     09
     C                     SETON                     121965
     C**
     C**   RESET LAST UPDATE DATA FOR NEW TRANSACTION.
     C   01                Z-ADD00000     LCDSF
     C   01                MOVE ' '       CHTPSF
     C   01                Z-ADD00000     TNLUSF
     C**
     C**   TEST OPERATOR RESPONSE.
     C   KC                SETON                     83    -E. O. J.
     C/COPY WNCPYSRC,RE0253C008
     C   KC                GOTO END
     C**
     C**   INITIAL SCREEN REQUESTED.
     C  NKL                GOTO TAG0
     C                     MOVE 'SF'      SFCODE           -REQUEST INIT.
     C                     MOVE '     '   STORSF
     C                     MOVE ' '       ACTION
     C***********          SETOF                     21                   S01117
     C                     SETON                     41
     C                     SETOF                     62
     C                     SETON                     61  64
     C                     SETON                     15
     C                     GOTO SETSF
     C           TAG0      TAG                             ** TAG0 TAG  **
     C                     MOVE DBRCSF    DBRCO   3                       S01117
     C                     MOVE CBRCSF    CBRCO   3                       S01117
     C           DCUSSF    IFNE *BLANKS                                   S01117
     C           CCYDR     ORNE *BLANKS                                   S01117
     C           ACODDR    ORNE *BLANKS                                   S01117
     C           DACSSF    ORNE *BLANKS                                   S01117
     C                     SETON                     25                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     25                   S01117
     C                     END                                            S01117
     C           CCUSSF    IFNE *BLANKS                                   S01117
     C           CCYCR     ORNE *BLANKS                                   S01117
     C           ACODCR    ORNE *BLANKS                                   S01117
     C           CACSSF    ORNE *BLANKS                                   S01117
     C                     SETON                     20                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     20                   S01117
     C                     END                                            S01117
     C**
     C**   CHAIN TO THE DR AND CR ACCOUNTS IN CASE OF DELETION.           E10048
     C   KJ 04             EXSR CHACC                                     E10048
     C   KJ 04             GOTO UDLOG
     C**
     C  NKJN04             GOTO TAG01
     C**
     C**   SET INDICATORS FOR INVALID CMD.KEY.
     C                     Z-ADD01        E
     C   04NKJ             Z-ADD8         E
     C**
     C  N01                SETON                         62
     C  N01                SETOF                     64
     C   01
     COR 04                SETON                     406371
     C***01******                                                         S01117
     C*R*04******          SETON                     87                   S01117
     C**
     C   03                EXSR IND04
     C**
     C   01                SETOF                     62
     C   01                SETON                       64
     C***********          SETOF                     2165                 S01117
     C                     SETOF                       65                 S01117
     C**
     C                     GOTO SETSF
     C**
     C           TAG01     TAG                             ** TAG01 TAG **
     C                     MOVE BLNK60    FDATSC  6
     C                     MOVE BLNK60    SDATSC  6
     C                     MOVE BLNK60    LDATSC  6
     C*                                                                   S01413
     C** Protect Frequency field on amend                                 S01413
     C*                                                                   S01413
     C           *IN03     IFEQ '1'                                       S01413
     C                     MOVE '1'       *IN40                           S01413
     C                     END                                            S01413
     C**
     C**   DETERMINE TYPE OF SCREEN RETURNED
     C***********REAC      COMP 'Y'                  161614               S01194
     C           BMRANR    COMP 'Y'                  161614               S01194
     C   02
     COR 03                GOTO UPDATE                     -INS. OR AMD.
     C**
     C                     MOVE STORSF    HELDSF  5
     C                     MOVE ACTION    HLDACT  1
     C/COPY WNCPYSRC,RE0253C011
     C**   INITIAL SCREEN - ACTION CODE.
     C           ACTION    COMP ' '                      81
     C   U3 81             MOVE 'E'       ACTION           -DEFAULT TO E.
     C           ACTION    COMP 'I'                      36
     C           ACTION    COMP 'A'                      37
     C           ACTION    COMP 'D'                      38
     C           ACTION    COMP 'E'                      39
     C***IF*ENQUIRY DISPLAY NEXT AND LAST PAY DATE                        S01117
     C***39******          SETOF                     32                   S01117
     C**
     C   36NU3
     COR 37NU3
     COR 38NU3
     COR 39                GOTO TAG02                      -VALID ACTION.
     C**
     C**   INVALID ACTION.
     C                     Z-ADD03        E
     C           X         ADD  1         X          4565
     C                     MOVE '012'     ERCD,X
     C**
     C           TAG02     TAG                             ** TAG02 TAG **
     C*                                                                   S01117
     C**    IF PROFIT CENTRE IS USED & PROFIT CENTRE IS NOT AMENDABLE,    S01117
     C**       PROTECT IPRFC UNDER ACTION 'A'.                            S01117
     C           PFCU      IFEQ 'Y'                                       S01117
     C           PFCA      ANDNE'Y'                                       S01117
     C           ACTION    ANDEQ'A'                                       S01117
     C                     SETON                     87                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     87                   S01117
     C                     END                                            S01117
     C**
     C**   REFERENCE NUMBER. MUST BE NUMERIC, NON-ZERO AND NOT '99999'.
     C                     MOVELSTORSF    NUM6    60
     C                     MOVELNUM6      ALF5    5
     C           STORSF    COMP ALF5                     81
     C   81      STORSF    COMP '00000'              8181
     C   81      STORSF    COMP '99999'              8181
     C   81N45             GOTO TAG03                      -VALID.
     C**
     C**   ERRORS SO FAR - DISPLAY ERROR SCREEN.
     C  N81      X         ADD  1         X          44
     C  N81                MOVE '104'     ERCD,X
     C*                                                                   LN0056
     C* WRONG ERROR MESSAGE APPEARING                                     LN0056
     C**N81*45******       Z-ADD02        E          44                   LN0056
     C  N81                Z-ADD02        E          44                   LN0056
     C*                                                                   LN0056
     C                     SETOF                     62
     C                     SETOF                     65                   LN0056
     C                     SETON                     64
     C                     GOTO SETSF
     C**
     C           TAG03     TAG                             ** TAG03 TAG **
     C**
     C**   DETERMINE IF STANDING ORDER ON STAND FILE
     C                     MOVE STORSF    STNKEY  5
     C**   STORE REFNO AND ACTION
     C                     EXSR STNCHN
     C                     MOVE OMBSI     MBSI                            S01117
      *                                                                                       CSD015
      ** For amendments, perform compliance watch processing if                               CSD015
      ** compliance watch is installed and entry watch list                                   CSD015
      ** checking is being applied                                                            CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C           *IN74     ANDEQ'1'                                                           CSD015
     C           *IN68     ANDEQ'0'                                                           CSD015
     C           *IN04     ANDEQ'0'                                                           CSD015
     C                     EXSR SRCCHK                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C  N68                EXCPTRELSTA
     C   36 68             GOTO TAG04                                     LN0056
     C  N36 68             GOTO TAG05                                     072881
     C/COPY WNCPYSRC,RE0253C012
     C*                                                                   S01117
     C                     Z-ADD*ZERO     @ERR                            S01117
     C*                                                                   S01117
     C**   VALIDATE ACTION CODE                                           S01117
     C**   IF MBIN = N, VALIDATE ACTION                                   S01117
     C***  VALIDATE USERS AUTHORITY TO USE THIS BRANCH/ACTION             S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM ACTION    @ZACTN  1                       S01117
     C                     PARM           @ERR    10                      S01117
     C*                                                                   S01117
     C           @ERR      IFNE 0                          *B2            S01117
     C                     Z-ADD9         E                               S01117
     C           X         ADD  1         X                               S01117
     C                     SETON                     59                   S01117
     C                     MOVE '302'     ERCD,X                          S01117
     C                     GOTO TAG06                                     S01117
     C                     SETOF                     62                   LN0056
     C                     SETON                     64                   LN0056
     C                     END                             *E2            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**   IF MBIN = Y, VALIDATE ACTION & BR. CODE TOGETHER               S01117
     C**   VALIDATE ACTION CODE - A/D/E FOR USER                          S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           ACTION    ANDNE'I'                                       S01117
     C           *IN06     ANDEQ'1'                                       059214
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM ACTION    @ZACTN                          S01117
     C                     PARM TXBRCA    @ZBR    3                       S01117
     C                     PARM           @ERR                            S01117
     C           @ERR      IFNE 0                          *B2            S01117
     C                     ADD  1         X                               S01117
     C                     SETOF                     6265                 LN0056
     C                     SETON                     64                   LN0056
      *                                                                   S01117
     C           @ERR      IFEQ 1                          *B3            S01117
     C                     Z-ADD10        E                               S01117
     C                     MOVE '303'     ERCD,X                          S01117
     C                     ELSE                            *X3            S01117
     C                     MOVE '304'     ERCD,X                          S01117
     C                     Z-ADD11        E                               S01117
     C                     END                             *E3            S01117
     C                     GOTO TAG06                                     S01117
     C                     END                             *E2            S01117
      *                                                                   S01117
     C                     END                                            S01117
     C**   VALID INSERT.
     C**N06*36***          GOTO TAG04                                     S01117
     C  N06 36             DO                                             S01117
     C           @ERR      IFEQ *ZERO                      NO SPF ERROR   S01117
     C                     GOTO TAG04                      =>VALID INSERT S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**   INVALID INPUT.
     C  N06
     COR 36                GOTO TAG05
     C/COPY WNCPYSRC,RE0253C013
     C**
     C**   SAVE LAST TRANSACTION DATA.
     C                     MOVE LSTC      LSTCSF
     C**
     C*****SET*UP*SCREEN*OUTPUT*FIELDS FOR LIVE RECORD.                   S01194
     C***********          MOVEL'20    '  TABKEY                          S01194
     C***********          MOVE '      '  TABKEY                          S01194
     C***********          MOVELCCYST     CCYK                            S01194
     C***********          MOVE CCYK      TABKEY                          S01194
     C***********          EXSR TABCHN                     -FOR DEC. PL.  S01194
     C*                                                                   S01194
     C* CALL ACCESS PROGRAM FOR DECIMAL PLACES                            S01194
     C*                                                                   S01194
     C                     MOVE '*MSG   ' @RTCD                           S01194
     C                     MOVELCCYST     CKEY                            S01194
     C                     CALL 'AOCURRR0'PLIST2                          S01194
     C           @RTCD     IFEQ *BLANKS                                   LN0229
     C                     MOVE CCY       CCYST                           LN0229
     C                     END                                            LN0229
     C           CDP       COMP 1                      7677               S01194
     C           CDP       COMP 2                    79  78               S01194
     C                     EXSR SFIELD
     C   37                EXSR IND04
     C                     GOTO TAG07
     C**
     C           TAG04     TAG                             ** TAG04 TAG **
     C**   VALID ACTION AND S/ORDER NUMBER - OUTPUT SI SCREEN.
     C                     MOVE 'SI'      SFCODE
     C   14                SETOF                     19
     C                     SETOF                     096461
     C**********           SETOF                     141516               S01117
     C                     SETOF                       15                 S01117
     C                     SETON                     62
     C                     GOTO SETSF
     C**
     C           TAG05     TAG                             ** TAG05 TAG **
     C**
     C**   FOR A,D AND E - S/ORDER MUST EXIST.
     C                     SETOF                     62
     C                     Z-ADD05        E          64    -DOES NOT EXIST
     C                     MOVE '017'     ERCD,1
     C   36                Z-ADD06        E
     C   36                MOVE '016'     ERCD,1
     C/COPY WNCPYSRC,RE0253C014
     C                     EXSR IND01
     C                     GOTO SETSF
     C           TAG06     TAG                                            S01117
     C           ER42      IFNE '1'                                       S01117
     C                     MOVE '1'       ER42                            S01117
     C                     END                                            S01117
     C           ER41      IFNE '1'                                       S01117
     C                     MOVE '1'       ER41                            S01117
     C                     END                                            S01117
     C                     GOTO SETSF                                     S01117
     C**
     C           TAG07     TAG                             ** TAG07 TAG **
     C**
     C**   OUTPUT SA,SD OR SF SCREEN AS REQUIRED
     C   37                MOVE 'SA'      SFCODE
     C   38                MOVE 'SD'      SFCODE
     C   39                MOVE 'SF'      SFCODE
     C                     SETOF                     62
     C   37
     COR 38                SETON                     62
     C**
     C                     SETOF                     64
     C   39                SETON                     62
     C   39                SETON                     64
     C**N37******          SETON                     637187               S01117
     C  N37                SETON                     6371                 S01117
     C                     SETON                     40
     C   37 14             SETOF                     19
     C   37                SETOF                     15
     C***37******                                                         S01117
     C*R*38******                                                         S01117
     C*R*39******          SETOF                     1416                 S01117
     C                     MOVE ' '       ACTION
     C                     MOVE '     '   STORSF
     C**
     C**   DISPLAY RET ACNO OR AC CODE
     C           DRAC      COMP 0                        26
     C           CRAC      COMP 0                        31
     C                     GOTO SETSF
     C**
     C           UPDATE    TAG                             ** UPDATE TAG *
     C/COPY WNCPYSRC,RE0253C031
     C**
     C**   V A L I D A T E   I N P U T   D A T A
     C**
     C**                                                                  HK0000
     C**   PROBLEM: THE NON-AMENDABLE FIELD PAYMENT FREQUENCY BECOMES     HK0000
     C**            UNPROTECTED WHEN ANY FIELD IS AMENDED WITH INVALID    HK0000
     C**            VALUE DURING AMENDMENT                                HK0000
     C**                                                                  HK0000
     C**   FIX: TO PROTECT PAYMENT FREQUENCY WHEN 'SA' SCREEN IS          HK0000
     C**        RECEIVED.                                                 HK0000
     C**                                                                  HK0000
     C   03                SETON                     40                   HK0000
     C   14                SETOF                     19
     C***********          SETOF                     1416                 S01117
     C*****CHECK BRANCH CODE.                                             S01117
     C*****MUST BE ON BRANCH CODES TABLE IF ENTERED.                      S01117
     C*****IF NOT ENTERED MUST TAKE DEFAULT VALUE IF EXISTS.              S01117
     C**N21N66             DO                                             S01117
     C*****                MOVEL'10      'TABKEY 12                       S01117
     C*****                MOVE '        'TABKEY                          S01117
     C*****                MOVE INBRCH    TABKEY                          S01117
     C*****                EXSR TABCHN                                    S01117
     C**N10                SETON                     21    - NOT FOUND.   S01117
     C*****                                                               S01117
     C*****                END                                            S01117
     C*****                                                               S01117
     C***21N66   DFBR      IFGT 0                                         S01117
     C*****                MOVE DFBR      INBRCH                          S01117
     C*****                SETOF                     21                   S01117
     C*****                END                                            S01117
     C*****                                                               S01117
     C*****FOR A INBRCH MUST EQUAL BRANCH CODE ON RECORD.                 S01117
     C**N21 03N66BRCDST    COMP INBRCH               2121                 S01117
     C*****                                                               S01117
     C***21      X         ADD  1         X                               S01117
     C***21                MOVE '032'     ERCD,X                          S01117
     C**
     C*****PAYMENT*CURRENCY*-*MUST*BE A VALID CCY CODE.                   S01194
     C***********          MOVEL'20    '  TABKEY                          S01194
     C***********          MOVE '      '  TABKEY                          S01194
     C***********          MOVELCCYSF     CCYK                            S01194
     C***********          MOVE CCYK      TABKEY                          S01194
     C***********          EXSR TABCHN                                    S01194
     C*                                                                   S01194
     C* CALL ACCESS PROGRAM FOR VALID CCY CODE                            S01194
     C*                                                                   S01194
     C                     MOVE '*BLANKS' @RTCD                           S01194
     C                     MOVELCCYSF     CKEY                            S01194
     C                     CALL 'AOCURRR0'PLIST2                          S01194
     C           @RTCD     COMP *BLANKS              5555                 S01194
     C  N55                MOVELCCY       CCYSF                           S01194
     C**N76N77N78****                                                     S01194
     C*ANN79*********      SETON                     55    -INVALID CCY.  S01194
     C   55                GOTO TAG08A
     C**   MUST AGREE WITH DR AND CR CCY(S)
     C  N23      CCYDR     COMP CCYSF                5555
     C/COPY WNCPYSRC,RE0253C015
     C  N28N55   CCYCR     COMP CCYSF                5555
     C/COPY WNCPYSRC,RE0253C016
     C**
     C           TAG08A    TAG                             **TAG08A TAG **
     C   55      X         ADD  1         X
     C         55          MOVE '095'     ERCD,X
     C**
     C**   D E B I T   A C C O U N T
     C**
     C**   IF DR RETAIL A/C IS BLANK ON INPUT AND                         S01117
     C**      DR BRANCH IS BLANK ON INPUT, USE DFBM ON ZMUSER.            S01117
     C**                                                                  S01117
     C           DRACSF    IFEQ *BLANKS                                   S01117
     C           DRBR      ANDEQ*BLANKS                                   S01117
      *                                                                   102954
     C           BRCASF    IFNE *BLANKS                                   102954
     C                     MOVELBRCASF    DRBR      P                     102954
     C                     ELSE                                           102954
     C                     MOVE DFBM      DRBR                            S01117
     C                     END                                            102954
      *                                                                   102954
     C                     END                                            S01117
     C**   RET ACNO AND ACC CODE NOT ALLOWED
     C***26N22N23                                                         S01117
     C*NN24                GOTO VALAC                                     S01117
     C**N26 22 23                                                         S01117
     C*N*24 43             GOTO VALAC                                     S01117
     C***26                GOTO VALAC                                     S01117
     C           DRACSF    IFNE *BLANKS                                   S01117
     C           DRBR      OREQ *BLANKS                                   S01117
     C           DACSSF    IFEQ *BLANKS                                   S01117
     C   22 23 24          GOTO VALAC                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C           DRACSF    IFEQ *BLANKS                                   S01117
     C                     GOTO VALAC                                     S01117
     C                     END                                            S01117
     C           X         ADD  1         X          50
     C                     SETON                     464748
     C                     SETON                     49
     C                     MOVE '090'     ERCD,X
     C                     GOTO TAG12
     C           VALAC     TAG                             ** VALAC TAG **
     C  N26                GOTO TAG9                       RETAIL NO USED
     C**                                                                  S01117
     C**  DEBIT BRANCH CODE VALIDATION ::: A/C DETAILS ENTERED            S01117
     C**       CALL BRCVAL :::                                            S01117
     C**       ERIND EQUALS '1' IF BRANCH IS IN ERROR.                    S01117
     C**                                                                  S01117
     C                     MOVE DRBR      BRCDI   3                       S01117
     C                     MOVE ACTION    ACTNI   1                       S01117
     C                     EXSR BRCVAL                                    S01117
     C           BRCDI     IFNE *BLANKS                                   S01117
     C                     MOVE BRCDI     DBRCO                           S01117
     C                     END                                            S01117
     C                     MOVE BRCDI     ODBRC   3                       S01117
     C                     MOVE ODBRC     DRBRCD  3                       S01117
     C                     MOVELBRCA      ZBRCAD  3                                          BUG9032
     C**                                                                  S01117
     C           ERIND     IFEQ '1'                                       S01117
     C           ER32      IFNE '1'                                       S01117
     C           X         ADD  1         X                               S01117
     C                     MOVE '032'     ERCD,X                          S01117
     C                     MOVE '1'       ER32    1                       S01117
     C                     SETON                     62                   S01117
     C                     ELSE                                           LN0229
     C                     MOVE BRCA      DRBR                            LN0229
     C                     MOVE BRCA      DBRCSF                          LN0229
     C                     END                                            S01117
     C                     END                                            S01117
     C**
     C**   DEBIT CUSTOMER NO. MUST BE ENTERED.
     C   22      X         ADD  1         X          46
     C   46                MOVE '087'     ERCD,X
     C**
     C**   IF DEBIT CUSTOMER ENTERED, DR CCY MUST BE NON-BLANK
     C      23   X         ADD  1         X          47
     C         47          MOVE '024'     ERCD,X
     C**
     C**   IF DEBIT CUSTOMER ENTERED, DR A/C CODE MUST BE NON-BLANK.
     C      24   X         ADD  1         X          48
     C   48                MOVE '036'     ERCD,X
     C**
     C**   IF DEBIT CUSTOMER ENTERED, SEQ. NO. DEFAULT IS '01'.
     C           DACSSF    IFEQ *BLANKS                     .IF
     C                     MOVE '01'      DACSSF  2         .
     C                     MOVE '01'      ZACSQD            .
     C                     END                              .END
     C*                                                                   LN0056
     C**                                                                  LN0056
     C**  NEW STANDING DATA FIELDS VALIDATION                             LN0056
     C**                                                                  LN0056
     C*                                                                   LN0056
     C                     MOVELDCUSSF    CUSKEY                          LN0056
     C                     CALL 'AOCUSTR0'PLISTA                          LN0056
     C           RTCD      IFNE *BLANKS                                   LN0056
     C           X         ADD  1         X                               LN0056
     C                     MOVE '150'     ERCD,X                          LN0056
     C                     SETON                     46                   LN0056
     C                     ELSE                                           LN0056
     C                     MOVE BBCUST    DCUSSF                          LN0056
     C                     MOVE BBCUST    ZCNUMD                          LN0056
     C                     MOVE BBACOC    DACOFF                          176510
     C                     END                                            LN0056
     C*                                                                   LN0056
     C                     MOVE CCYDR     CKEY                            LN0056
     C                     CALL 'AOCURRR0'PLIST2                          LN0056
     C           @RTCD     IFNE *BLANKS                                   LN0056
     C                     SETON                     47                   LN0056
     C           X         ADD  1         X                               LN0056
     C                     MOVE '024'     ERCD,X                          LN0056
     C                     ELSE                                           LN0056
     C                     MOVE CCY       CCYDR                           LN0056
     C                     END                                            LN0056
     C*                                                                   LN0056
     C                     MOVE ACODDR    ACOKEY                          LN0056
     C                     CALL 'AOACODR0'PLISTB                          LN0056
     C           RTCD      IFNE *BLANKS                                   LN0056
     C                     SETON                     48                   LN0056
     C           X         ADD  1         X                               LN0056
     C                     MOVE '036'     ERCD,X                          LN0056
     C                     ELSE                                           LN0056
     C                     MOVE A5ACCD    ACODDR                          LN0056
     C                     MOVE A5ACCD    ZACODD                          LN0056
     C                     END                                            LN0056
     C**
     C   46
     COR 47
     COR 48                GOTO TAG12                      -KEY FLD. ERROR
     C**
     C                     GOTO TAG10                      -NOT RETAIL NO.
     C**
     C**   DEBIT ACCOUNT KEY FIELD VALIDATION - RETAIL NUMBER.
     C           TAG9      TAG                             ** TAG9 TAG  **
     C                     MOVE DRACSF    KEY10  10
     C                     EXSR ACNCHN
     C/COPY WNCPYSRC,RE0253C032
     C   13      ACSTAN    COMP 'C'                      50
     C  N13                SETON                     50    -NOT LIVE RECD.
     C         50          EXSR IND02
     C         50          GOTO TAG12
     C**                                                                  S01117
     C**  DEBIT BRANCH CODE VALIDATION :::     RETAIL A/C ENTERED         S01117
     C**       CALL BRCVAL :::                                            S01117
     C**       ERIND EQUALS '1' IF BRANCH IS IN ERROR.                    S01117
     C**                                                                  S01117
     C                     MOVE BRCDAN    BRCDI   3                       S01117
     C                     MOVE ACTION    ACTNI   1                       S01117
     C                     EXSR BRCVAL                                    S01117
     C**                                                                  S01117
     C           ERIND     IFEQ '1'                                       S01117
     C           ER32      IFNE '1'                                       S01117
     C           X         ADD  1         X                               S01117
     C                     MOVE '032'     ERCD,X                          S01117
     C                     MOVE '1'       ER32                            S01117
     C                     END                                            S01117
     C                     SETON                     62                   S01117
     C                     END                                            S01117
     C                     MOVE BRCDAN    DRBRCD  3                       S01117
     C                     MOVE BRCDAN    ODBRC   3                       S01117
     C                     MOVELBRCDAN    ZBRCAD                                             BUG9032
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCP7                                           S01408
     C*                                                                   S01408
     C**
     C**   CHAIN TO ACCNT FILE WITH KEY OBTAINED FROM ACNUM FILE
     C                     EXSR ACFILL
     C                     EXSR ACCCHN
     C   12      ACST      COMP 'C'                      50
     C  N12                SETON                     50    -NOT LIVE RECD.
     C         50          EXSR IND03
     C*                                                                   047906
     C**    TEST IF ACCOUNT BLOCKED,BANKRUPT OR BAD DEBT -                047906
     C           *IN12     IFEQ '1'                                       047906
     C           *IN50     ANDEQ'0'                                       047906
     C           ATYP      ANDEQ'R'                                       047906
     C                     TESTB'2'       RETB           50BLOCK DEBITS   047906
     C  N50                TESTB'6'       RETB           50BANKRUPT/LIQ.  047906
     C  N50                TESTB'7'       RETB           50BAD DEBT       047906
     C         50          EXSR IND05                                     047906
     C                     END                                            047906
     C*                                                                   047906
     C         50          GOTO TAG12
     C**   SAVE MEMO RRN FOR SHADOW BALANCE UPDATE.
     C***********          Z-ADDRRNM      DRRNSF  50                      CCB002
     C**   SAVE A/C KEY FIELDS FOR OUTPUT TO STA
     C                     MOVE CNUM      ZCNUMD
     C                     MOVE ACOD      ZACODD
     C                     MOVE ACSQ      ZACSQD
     C                     MOVE BRCDAC    ZBRCDD  3                       S01117
     C                     MOVE BRCDAC    DRBRCD  3                       S01117
     C                     MOVE BRCDAC    ODBRC   3                       S01117
      *                                                                                       CGL014
      ** If CGL014 is on, save debit account details for amount validation                    CGL014
      *                                                                                       CGL014
     C           CGL014    IFEQ 'Y'                                                           CGL014
     C                     MOVE ATYP      WDATYP  1                                           CGL014
     C                     MOVE COLF      WDCOLF  1                                           CGL014
     C                     MOVE BRCDAC    WDIBCA  3                                           CGL014
     C                     MOVE CNUM      WDCUST  6                                           CGL014
     C                     MOVE CCYAC     WDCYCD  3                                           CGL014
     C**********           MOVE ACOD      WDACCD  4                                   CGL014 BUG3281
     C                     MOVE ACOD      WDACCD 10                                          BUG3281
     C                     MOVE ACSQ      WDACSN  2                                           CGL014
     C                     Z-ADDACNO      WDRACN 100                                          CGL014
     C                     ENDIF                                                              CGL014
     C**
     C/COPY WNCPYSRC,RE0253C033
     C**   CHECK CCY. CODE - MUST BE SAME AS THAT INPUT.
     C                     EXSR CCYCHK
     C/COPY WNCPYSRC,RE0253C034
     C**
     C*****SAVE BRANCH CODE FOR VALIDATION LATER                          S01117
     C*****                MOVE BRCDAC    DRBRCD  3                       S01117
     C**
     C**   RETAIL NUMBER - BYPASS CUSTOMER NUMBER VALIDATION.
     C                     MOVE ATYP      ATYPDB  1
     C                     GOTO TAG12
     C**
     C           TAG10     TAG                             ** TAG10 TAG **
     C**
     C**   DEBIT ACCOUNT KEY FIELD VALIDATION - CUSTOMER NUMBER
     C**   CHAIN TO ACCNT FILE WITH KEY OBTAINED FROM SCREEN.
     C                     EXSR SDFILL
     C                     EXSR ACCCHN
     C***********          Z-ADDRRNM      DRRNSF                          CCB002
     C  N12
     COR 19                GOTO ACSTAG
     C           ATYP      COMP 'R'                      12
     C   12      X         ADD  1         X
     C   12                MOVE '031'     ERCD,X
     C   12                SETON                       46
     C   12                SETON                     474849
     C   12                GOTO TAG12
     C                     SETON                     12
     C           ACSTAG    TAG
     C   12      ACST      COMP 'C'                  1212
     C  N12                SETON                     464748
     C  N12                SETON                     49
     C  N12                EXSR IND03                      -NOT LIVE RECD.
     C*                                                                   047906
     C**    TEST IF ACCOUNT BLOCKED,BANKRUPT OR BAD DEBT -                047906
     C           *IN12     IFEQ '1'                                       047906
     C           ATYP      ANDEQ'R'                                       047906
     C           *IN46     ANDEQ'0'                                       047906
     C           *IN47     ANDEQ'0'                                       047906
     C           *IN48     ANDEQ'0'                                       047906
     C           *IN49     ANDEQ'0'                                       047906
     C                     TESTB'2'       RETB           49BLOCK DEBITS   047906
     C  N49                TESTB'6'       RETB           49BANKRUPT/LIQ.  047906
     C  N49                TESTB'7'       RETB           49BAD DEBT       047906
     C   49                SETON                     464748               047906
     C   49                SETOF                     12                   047906
     C   49                EXSR IND05                                     047906
     C                     END                                            047906
      *                                                                                       CGL014
      ** If CGL014 is on, save debit account details for amount validation                    CGL014
      *                                                                                       CGL014
     C           CGL014    IFEQ 'Y'                                                           CGL014
     C                     MOVE ATYP      WDATYP  1                                           CGL014
     C                     MOVE COLF      WDCOLF  1                                           CGL014
     C                     MOVE BRCDAC    WDIBCA  3                                           CGL014
     C                     MOVE CNUM      WDCUST  6                                           CGL014
     C                     MOVE CCYAC     WDCYCD  3                                           CGL014
     C**********           MOVE ACOD      WDACCD  4                                   CGL014 BUG3281
     C                     MOVE ACOD      WDACCD 10                                          BUG3281
     C                     MOVE ACSQ      WDACSN  2                                           CGL014
     C                     Z-ADDACNO      WDRACN 100                                          CGL014
     C                     ENDIF                                                              CGL014
     C*                                                                   047906
     C  N12                GOTO TAG12
     C**
     C           TAG11     TAG                             ** TAG11 TAG **
     C**
     C*****SAVE BRANCH CODE FOR VALIDATION LATER                          S01117
     C*****                MOVE BRCDAC    DRBRCD                          S01117
     C**
     C                     MOVE ATYP      ATYPDB
     C           TAG12     TAG                             ** TAG12 TAG **
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CVS1                                           S01408
     C*                                                                   S01408
     C**   IF CR RETAIL A/C IS BLANK ON INPUT AND                         S01117
     C**      CR BRANCH IS BLANK ON INPUT, USE DFBM ON ZMUSER.            S01117
     C**                                                                  S01117
     C           CRACSF    IFEQ *BLANKS                                   S01117
     C           CBRC      ANDEQ*BLANKS                                   S01117
      *                                                                   102954
     C           BRCASF    IFNE *BLANKS                                   102954
     C                     MOVELBRCASF    CBRC      P                     102954
     C                     ELSE                                           102954
     C                     MOVE DFBM      CBRC                            S01117
     C                     END                                            102954
      *                                                                   102954
     C                     END                                            S01117
     C**
     C**   RET ACNO AND AC CODE NOT ALLOWED
     C**N31 27 28                                                         S01117
     C*N*29 30             GOTO CACVAL                                    S01117
     C***31N27N28                                                         S01117
     C*NN29                GOTO CACVAL                                    S01117
     C***31                GOTO CACVAL                                    S01117
     C           CRACSF    IFNE *BLANKS                                   S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C           CBRC      OREQ *BLANKS                                   S01117
     C/COPY WNCPYSRC,RE0253C028
     C      27 28                                                         S01117
     CAN 29 30             GOTO CACVAL                                    S01117
     C/COPY WNCPYSRC,RE0253C029
     C                     END                                            S01117
     C                     END                                            S01117
     C           CRACSF    IFEQ *BLANKS                                   S01117
     C                     GOTO CACVAL                                    S01117
     C                     END                                            S01117
     C           X         ADD  1         X          54
     C                     SETON                     515253
     C                     SETON                     86
     C                     MOVE '094'     ERCD,X
     C                     GOTO TAG15
     C           CACVAL    TAG                             ** CACVAL TAG *
     C  N31                GOTO TAG12A
     C**
     C**   C R E D I T   A C C O U N T
     C**                                                                  S01117
     C**  CREDIT     BRANCH CODE VALIDATION :::  A/C DETAILS ENTERED      S01117
     C**             CALL BRCVAL :::                                      S01117
     C**             ERIND EQUALS '1' IF BRANCH IS IN ERROR.              S01117
     C**                                                                  S01117
     C/COPY WNCPYSRC,RE0253C023
     C                     MOVE ACTION    ACTNI   1                       S01117
     C                     MOVE CBRC      BRCDI                           S01117
     C                     EXSR BRCVAL                                    S01117
     C           BRCDI     IFNE *BLANKS                                   S01117
     C                     MOVE BRCDI     CBRCO                           S01117
     C                     END                                            S01117
     C                     MOVE BRCDI     OCBRC   3                       S01117
     C                     MOVE BRCDI     CRBRCD  3                       S01117
     C                     MOVELBRCA      ZBRCAC  3                                          BUG9032
     C**                                                                  S01117
     C           ERIND     IFEQ '1'                                       S01117
     C                     SETON                     68                   S01117
     C           ER32      IFNE '1'                                       S01117
     C           X         ADD  1         X                               S01117
     C                     MOVE '032'     ERCD,X                          S01117
     C                     MOVE '1'       ER32                            S01117
     C                     END                                            S01117
     C                     ELSE                                           LN0229
     C                     MOVE BRCA      CBRCSF                          LN0229
     C                     MOVE BRCA      CBRC                            LN0229
     C                     END                                            S01117
     C/COPY WNCPYSRC,RE0253C017
     C**                                                                  S01117
     C**
     C**   CREDIT CUSTOMER NO. MUST BE ENTERED.
     C   27      X         ADD  1         X          51
     C   51                MOVE '091'     ERCD,X
     C**
     C**   CR CCY MUST BE NON-BLANK AND MUST AGREE WITH DR CCY FIELD.
     C  N26N31   CCYDR     COMP CCYCR                2828
     C      28   X         ADD  1         X          52
     C         52          MOVE '024'     ERCD,X
     C**   IF CREDIT CUSTOMER ENTERED,CR A/C CODE MUST BE NON-BLANK.
     C      29   X         ADD  1         X          86
     C   86                MOVE '036'     ERCD,X
     C**
     C**   IF CREDIT CUSTOMER ENTERED, SEQ. NO. DEFAULT IS '01'.
     C      30             MOVE '01'      CACSSF  2
     C   30                MOVE '01'      ZACSQC
     C/COPY WNCPYSRC,RE0253C018
     C*                                                                   LN0056
     C**                                                                  LN0056
     C**  NEW STANDING DATA FIELDS VALIDATION  (CREDIT ACCOUNT)           LN0056
     C**                                                                  LN0056
     C*                                                                   LN0056
     C                     MOVELCCUSSF    CUSKEY                          LN0056
     C                     CALL 'AOCUSTR0'PLISTA                          LN0056
     C           RTCD      IFNE *BLANKS                                   LN0056
     C                     SETON                     51                   LN0056
     C           X         ADD  1         X                               LN0056
     C                     MOVE '150'     ERCD,X                          LN0056
     C                     ELSE                                           LN0056
     C                     MOVE BBCUST    CCUSSF                          LN0056
     C                     MOVE BBCUST    ZCNUMC                          LN0056
     C                     END                                            LN0056
     C*                                                                   LN0056
     C                     MOVE CCYCR     CKEY                            LN0056
     C                     CALL 'AOCURRR0'PLIST2                          LN0056
     C           @RTCD     IFNE *BLANKS                                   LN0056
     C                     SETON                     52                   LN0056
     C           X         ADD  1         X                               LN0056
     C                     MOVE '024'     ERCD,X                          LN0056
     C                     ELSE                                           LN0056
     C                     MOVE CCY       CCYCR                           LN0056
     C                     END                                            LN0056
     C*                                                                   LN0056
     C                     MOVE ACODCR    ACOKEY                          LN0056
     C                     CALL 'AOACODR0'PLISTB                          LN0056
     C           RTCD      IFNE *BLANKS                                   LN0056
     C                     SETON                     86                   LN0056
     C           X         ADD  1         X                               LN0056
     C                     MOVE '036'     ERCD,X                          LN0056
     C                     ELSE                                           LN0056
     C                     MOVE A5ACCD    ACODCR                          LN0056
     C                     MOVE A5ACCD    ZACODC                          LN0056
     C                     END                                            LN0056
     C**
     C   51
     COR 52
     COR 86                GOTO TAG15                      -KEY FLD. ERROR
     C**
     C                     GOTO TAG13                      -NOT RETAIL NO.
     C**
     C**   CREDIT ACCOUNT KEY FIELD VALIDATION - RETAIL NUMBER
     C           TAG12A    TAG                             **TAG12A TAG **
     C                     MOVE CRACSF    KEY10  10
     C                     EXSR ACNCHN
     C/COPY WNCPYSRC,RE0253C035
     C   13      ACSTAN    COMP 'C'                      54               093486
     C  N13                SETON                     54    -NOT LIVE RECD.
     C         54          EXSR IND02
     C         54          GOTO TAG15
     C**                                                                  S01117
     C**  CREDIT     BRANCH CODE VALIDATION :::  RETAIL A/C ENTEERED      S01117
     C**             CALL BRCVAL :::                                      S01117
     C**             ERIND EQUALS '1' IF BRANCH IS IN ERROR.              S01117
     C**                                                                  S01117
     C                     MOVE ACTION    ACTNI   1                       S01117
     C                     MOVE BRCDAN    BRCDI                           S01117
     C                     EXSR BRCVAL                                    S01117
     C**                                                                  S01117
     C           ERIND     IFEQ '1'                                       S01117
     C                     SETON                     68                   S01117
     C           ER32      IFNE '1'                                       S01117
     C           X         ADD  1         X                               S01117
     C                     MOVE '032'     ERCD,X                          S01117
     C                     MOVE '1'       ER32                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     MOVE BRCDAN    CRBRCD  3                       S01117
     C                     MOVE BRCDAN    OCBRC   3                       S01117
     C                     MOVELBRCDAN    ZBRCAC                                             BUG9032
     C**
     C**   CHAIN TO ACCNT FILE WITH KEY OBTAINED FROM ACNUM FILE.
     C                     EXSR ACFILL
     C                     EXSR ACCCHN
     C  N12                SETON                     54    -NOT LIVE RECD.
     C         54          EXSR IND03
     C*                                                                   047906
     C**    TEST IF ACCOUNT BLOCKED,BANKRUPT OR BAD CRED -                047906
     C           *IN12     IFEQ '1'                                       047906
     C           *IN54     ANDEQ'0'                                       047906
     C           ATYP      ANDEQ'R'                                       047906
     C                     TESTB'3'       RETB           54BLOCK CREDIT   047906
     C  N54                TESTB'6'       RETB           54BANKRUPT/LIQ.  047906
     C  N54                TESTB'7'       RETB           54BAD DEBT       047906
     C         54          EXSR IND05                                     047906
     C                     END                                            047906
     C*                                                                   047906
     C         54          GOTO TAG15
     C**   SAVE MEMO RRN FOR SHADOW BALANCE UPDATE.
     C***********          Z-ADDRRNM      CRRNSF  50                      CCB002
     C**
     C**   SAVE CREDIT A/C TYPE
     C                     MOVE ATYP      ATYPCR  1
     C                     Z-ADDACNO      CRACN                           117784
     C**   SAVE A/C KEY FIELDS FOR OUTPUT TO STA
     C                     MOVE CNUM      ZCNUMC
     C                     MOVE ACOD      ZACODC
     C                     MOVE ACSQ      ZACSQC
     C                     MOVE BRCDAC    ZBRCDC  3                       S01117
     C                     MOVE BRCDAC    CRBRCD  3                       S01117
     C                     MOVE BRCDAC    OCBRC   3                       S01117
     C**
     C**   CHECK CCY. CODE - MUST BE SAME AS THAT INPUT
     C/COPY WNCPYSRC,RE0253C036
     C                     EXSR CCYCHK
     C/COPY WNCPYSRC,RE0253C037
     C**
     C*****SAVE BRANCH CODE FOR VALIDATION LATER                          S01117
     C*****                MOVE BRCDAC    CRBRCD  3                       S01117
     C**
     C**   RETAIL NUMBER - BYPASS CUSTOMER NUMBER VALIDATION.
     C                     GOTO TAG15
     C**
     C           TAG13     TAG                             ** TAG13 TAG **
     C**
     C**   CREDIT ACCOUNT KEY FIELD VALIDATION - CUSTOMER NUMBER.
     C**   CHAIN TO ACCNT FILE WITH KEY OBTAINED FROM SCREEN.
     C                     EXSR SCFILL
     C**
     C                     EXSR ACCCHN
     C***********          Z-ADDRRNM      CRRNSF                          CCB002
     C                     MOVE ATYP      ATYPCR
     C                     Z-ADDACNO      CRACN                           117784
     C/COPY WNCPYSRC,RE0253C019
     C  N12
     COR 19                GOTO TG13A
     C           ATYP      COMP 'R'                      12
     C   12      X         ADD  1         X
     C   12                MOVE '031'     ERCD,X
     C   12                SETON                     8651
     C   12                SETON                     5253
     C   12                GOTO TAG15
     C                     SETON                     12
     C           TG13A     TAG
     C   12      ACST      COMP 'C'                  1212
     C  N12                SETON                     515253
     C  N12                SETON                     86
     C  N12                EXSR IND03                      -NOT LIVE RECD.
     C*                                                                   047906
     C**    TEST IF ACCOUNT BLOCKED,BANKRUPT OR BAD DEBT -                047906
     C           *IN12     IFEQ '1'                                       047906
     C           ATYP      ANDEQ'R'                                       047906
     C           *IN51     ANDEQ'0'                                       047906
     C           *IN52     ANDEQ'0'                                       047906
     C           *IN53     ANDEQ'0'                                       047906
     C           *IN86     ANDEQ'0'                                       047906
     C                     TESTB'3'       RETB           86BLOCK CREDIT   047906
     C  N86                TESTB'6'       RETB           86BANKRUPT/LIQ.  047906
     C  N86                TESTB'7'       RETB           86BAD DEBT       047906
     C   86                SETON                     515253               047906
     C   86                SETOF                     12                   047906
     C   86                EXSR IND05                                     047906
     C                     END                                            047906
     C*                                                                   047906
     C  N12                GOTO TAG15
     C**
     C           TAG14     TAG                             ** TAG14 TAG **
     C**
     C**   SAVE BRANCH CODE FOR VALIDATION LATER
     C                     MOVE BRCDAC    CRBRCD
     C                     MOVE BRCDAC    OCBRC   3                       S01117
     C**
     C           TAG15     TAG                             ** TAG15 TAG **
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CVS2                                           S01408
     C*                                                                   S01408
     C*****                                                               S01117
     C****VALIDATE BRANCH CODES; IF *IN66 IS OFF,  BOTH 'DR' BRCD AND     S01117
     C*****  'CR' BRCD MUST BE EQUAL TO INBRCH; ELSE ONLY ONE NEED        S01117
     C*****    EQUAL INBRCH.                                              S01117
     C*****                SETOF                     258981               S01117
     C*****      DRBRCD    COMP CRBRCD                   81               S01117
     C*****                                                               S01117
     C****IF.BRCD'S NOT EQUAL; INVALID IF *IN32 = '0'                     S01117
     C**N66N81             SETON                     89                   S01117
     C*****                                                               S01117
     C****IF BRCD'S NOT EQUAL AND *IN32 = '1' SETON *IN20                 S01117
     C***66N81             SETON                     25                   S01117
     C*****      .                                                        S01117
     C**N89       .        DO                                             S01117
     C*****                                                               S01117
     C****IF *IN66 = '1'; AT LEAST ONE BRCD MUST = INBRCH                 S01117
     C*****OR IF *IN32 = '0'; BOTH BRCD'S MUST = INBRCH                   S01117
     C*****      DRBRCD    COMP INBRCH                   81               S01117
     C***66N81   CRBRCD    COMP INBRCH                   81               S01117
     C*****                                                               S01117
     C**N81                SETON                     89                   S01117
     C*****                END                                            S01117
     C*****                                                               S01117
     C****INVALID INPUT FOUND                                             S01117
     C***89                DO                                             S01117
     C*****      X         ADD  1         X                               S01117
     C***66                MOVE '032'     ERCD,X                          S01117
     C**N66                MOVE '105'     ERCD,X                          S01117
     C**N21                SETON                     21                   S01117
     C*****                END                                            S01117
     C**                                                                  S01117
     C**   CHECK TRANSACTION BRANCH :                                     S01117
     C**   TRANSACTION BRANCH MUST BE EQUAL TO EITHER DEBIT BRANCH        S01117
     C**                                       OR CREDIT BRANCH.          S01117
     C**   CALL BRCVAL                                                    S01117
     C**   ERIND = '1' IF BRANCH IS IN ERROR.                             S01117
     C**                                                                  S01117
     C                     MOVE BRCASF    BRCDI   3                       S01117
     C                     MOVE ACTION    ACTNI   1                       S01117
     C                     EXSR BRCVAL                                    S01117
     C                     MOVE BRCDI     BRCASF                          S01117
     C**                                                                  S01117
     C           ERIND     IFEQ '1'                                       S01117
     C           X         ADD  1         X                               S01117
     C                     MOVE '304'     ERCD,X                          S01117
     C                     SETON                     32                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           BRCASF    IFNE DRBRCD                                    S01117
     C           BRCASF    ANDNECRBRCD                                    S01117
     C           *IN32     ANDNE'1'                                       S01117
     C           X         ADD  1         X                               S01117
     C                     MOVE '304'     ERCD,X                          S01117
     C                     SETON                     32                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**   IF MBIN = Y, VALIDATE ACTION & BR. CODE TOGETHER               S01117
     C                     Z-ADD*ZERO     @ERR                            S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           *IN32     ANDNE'1'                                       S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM HLDACT    @ZACTN  1                       S01117
     C                     PARM BRCASF    @ZBR    3                       S01117
     C                     PARM           @ERR    10                      S01117
     C           @ERR      IFNE *ZERO                                     S01117
     C                     ADD  1         X                               S01117
     C*                                                                   S01117
     C           @ERR      IFEQ 1                          *B3            S01117
     C                     Z-ADD10        E                               S01117
     C                     MOVE '303'     ERCD,X                          S01117
     C                     ELSE                            *X3            S01117
     C                     MOVE '304'     ERCD,X                          S01117
     C                     Z-ADD11        E                               S01117
     C                     END                             *E3            S01117
     C*                                                                   S01117
     C                     SETON                     32                   LN0056
     C                     END                                            S01117
     C**********           SETON                     32                   LN0056
     C                     END                                            S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C**   MBIN IF NOT Y, THEN THE BRANCH CODES ON BOTH THE               S01117
     C**   A/C CODES MUST BE THE SAME.  ERCD-105.                         S01117
     C**                                                                  S01117
     C           MBIN      IFNE 'Y'                                       S01117
     C           DRBRCD    IFNE CRBRCD                                    S01117
     C           X         ADD  1         X                               S01117
     C                     MOVE '105'     ERCD,X                          S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**   VALIDATE PROFIT CENTRE IF PROFIT CENTRE IS USED                S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C**
     C** SET UP MULTI-BRANCHING CROSS BRANCH INDICATOR
     C           CRBRCD    IFNE DRBRCD                                    S01117
     C                     MOVE 'Y'       OMBSI   1                       S01117
     C                     ELSE                                           S01117
     C                     MOVE 'N'       OMBSI   1                       S01117
     C                     END                                            S01117
     C***66N21             MOVE 'N'       MBSI    1                       S01117
     C***66 25N21          MOVE 'Y'       MBSI                            S01117
     C**
     C  N26N31   CRACSF    COMP DRACSF                   81
     C  N26N31 81          SETON                     5054
     C**
     C**   MUST BE VALID FREQUENCY CODE
     C/COPY WNCPYSRC,RE0253C038
     C           PAYFSF    LOKUPFREQ                     81
     C  N81      X         ADD  1         X          56
     C  N81                MOVE '096'     ERCD,X
     C/COPY WNCPYSRC,RE0253C039
     C**
     C**   CHECK DATES AND AMOUNTS.
     C**
     C**   CHECK PROTECTED FIELDS FOR AMENDMENTS - IND 71.
     C   57                GOTO TAG16
     C**
     C**   FIRST PAYMENT DATE.
     C                     MOVE FDATSF    ZDATE
     C                     EXSR ZDATE1
     C                     MOVE ZDAYNO    DFPYSF
     C**   FIRST PAYMENT DATE MUST BE GREATER THAN RUN DATE
     C**   UNLESS ACTION CODE = A WHEN DATE MUST NOT BE AMENDED
     C**   IF IT IS IN THE PAST
     C  N99      DFPYSF    COMP RUND                   99
     C   03                EXSR IND04
     C   03 71   DFPYSF    COMP DFPY                 9999
     C**
     C           TAG16     TAG                             ** TAG16 TAG **
     C**   FIRST PAYMENT DATE ERROR.
     C   57                SETON                     99
     C   99N71   X         ADD  1         X          57
     C   99N71             MOVE '097'     ERCD,X
     C/COPY WNCPYSRC,RE0253C043
     C**
     C**   FIRST PAYMENT AMOUNT
     C   58                GOTO TAG17
     C                     MOVE FAMTSF    ZFIELD
     C                     MOVEL'  '      ZFIELD
     C           13        SUB  CDP       ZADIG
     C                     Z-ADDCDP       ZADEC
     C                     EXSR ZALIGN
     C   99                SETON                     58
     C                     MOVE ZFIELD    AFPYSF
     C           AFPYSF    COMP 0                        58
     C**
     C   71N58   SAMTSF    COMP ' '                      81
     C**
     C           TAG17     TAG                             ** TAG17 TAG **
     C   58      X         ADD  1         X
     C   58                MOVE '098'     ERCD,X
      *                                                                                       CGL014
      ** Check if balance remaining due to all debits posted across                           CGL014
      ** retail accounts is sufficient to cover the blocked amount                            CGL014
      *                                                                                       CGL014
     C           *IN58     IFEQ *OFF                                                          CGL014
     C           CGL014    ANDEQ'Y'                                                           CGL014
     C           WDATYP    ANDEQ'R'                                                           CGL014
     C           WDCOLF    ANDEQ'Y'                                                           CGL014
     C                     Z-ADDAFPYSF    PTAMNT                                              CGL014
      *                                                                                       CGL014
     C                     CALL 'GL006000'                                                    CGL014
     C                     PARM           PTAMNT 150                                          CGL014
     C                     PARM WDCYCD    PTCCY   3                                           CGL014
     C                     PARM WDIBCA    PABRCA  3                                           CGL014
     C                     PARM WDCUST    PACNUM  6                                           CGL014
     C                     PARM WDCYCD    PACCY   3                                           CGL014
     C                     PARM WDACCD    PAACOD 10                                           CGL014
     C                     PARM WDACSN    PAACSQ  2                                           CGL014
     C                     PARM WDRACN    PAACNO 100                                          CGL014
     C                     PARM *BLANKS   PRTCD                                               CGL014
      *                                                                                       CGL014
      ** Error:  Available balance is not sufficient                                          CGL014
      ** to cover blocked amount                                                              CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ '*BLKERR'                                                     CGL014
     C           X         ADD  1         X                                                   CGL014
     C                     MOVE '106'     ERCD,X                                              CGL014
     C                     MOVE *ON       *IN58                                               CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
      ** Warning:  Balance is greater than blocked amount but less                            CGL014
      ** than minimum balance; minimum balance will be exceeded                               CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ '*WARN  '                                                     CGL014
     C           AFPYSF    IFNE WCOPY1                                                        CGL014
     C                     MOVE '0'       WARN1                                               CGL014
     C                     ENDIF                                                              CGL014
     C           WARN1     IFEQ '0'                                                           CGL014
     C           X         ADD  1         X                                                   CGL014
     C                     MOVE 'W01'     ERCD,X                                              CGL014
     C                     MOVE *ON       *IN58                                               CGL014
     C                     Z-ADDAFPYSF    WCOPY1                                              CGL014
     C           X         IFEQ 1                                                             CGL014
     C                     MOVE '1'       WARN1                                               CGL014
     C                     ENDIF                                                              CGL014
     C                     ENDIF                                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C*                                                                   S01466
     C** If core feature is set ON, validate Transaction Type             S01466
     C*                                                                   S01466
     C           S01466    IFEQ 'Y'                                       S01466
     C                     SETOF                     11                   S01466
     C                     MOVE *BLANKS   @TRATT                          S01466
     C*                                                                   S01466
     C** If no transaction type entered, display error code               S01466
     C*                                                                   S01466
     C           TRATSF    IFEQ *BLANKS                                   S01466
     C                     SETON                     11                   S01466
     C           X         ADD  1         X                               S01466
     C                     MOVE '051'     ERCD,X                          S01466
     C                     ELSE                                           S01466
     C*                                                                   S01466
     C** ... else validate data entered                                   S01466
     C*                                                                   S01466
     C                     CALL 'AORETRR0'                                S01466
     C                     PARM *BLANKS   @RTCD   7                       S01466
     C                     PARM '*KEY   ' @OPTN   7                       S01466
     C                     PARM TRATSF    @TRATT  5                       S01466
     C           SDRETR    PARM SDRETR    DSFDY                           S01466
     C*                                                                   119553
     C** If transaction type entered is valid move @TRATT to screen fie   119553
     C** field TRATSF and allow continuation.                             119553
     C*                                                                   119553
     C           @RTCD     IFEQ *BLANKS                                   119553
     C                     MOVE @TRATT    TRATSF                          119553
     C                     END                                            119553
     C*                                                                   S01466
     C** If transaction type entered is not a valid transaction type in   S01466
     C** SDRETRPD, display error code                                     S01466
     C*                                                                   S01466
     C           @RTCD     IFEQ '*NRF   '                                 S01466
     C                     SETON                     11                   S01466
     C           X         ADD  1         X                               S01466
     C                     MOVE '050'     ERCD,X                          S01466
     C                     ELSE                                           S01466
     C*                                                                   S01466
     C** If return code is not equal to blank (other than *NRF),          S01466
     C** database error                                                   S01466
     C*                                                                   S01466
     C           @RTCD     IFNE *BLANKS                                   S01466
     C                     MOVEL'RE0253 ' DBPGM                           S01466
     C                     MOVEL'SDRETRPD'DBFILE           ************   S01466
     C                     MOVEL'*KEY   ' DBKEY            * DBERR 02 *   S01466
     C                     Z-ADD02        DBASE            ************   S01466
     C                     OUT  LDA                                       S01466
     C                     EXSR *PSSR                                     S01466
     C                     SETON                     U7U8LR               S01466
     C                     END                                            S01466
     C                     END                                            S01466
     C                     END                                            S01466
     C                     END                                            S01466
     C**
     C**   SECOND PAYMENT DATE.
     C**
     C*****IF*BLANK, CALCULATE DEFAULT VALUE USING ZFREQ.                 S01195
     C**   IF BLANK, CALCULATE DEFAULT VALUE USING FREQS.                 S01195
     C           SDATSF    COMP '      '                 68
     C   68                GOTO TAG18
     C**
     C                     MOVE SDATSF    ZDATE
     C                     EXSR ZDATE1
     C                     MOVE ZDAYNO    DSPYSF
     C**   SECOND PAYMENT DATE MUST BE GREATER THAN FIRST.
     C                     SETOF                     81                   E43618
     C  N99      DSPYSF    COMP DFPYSF                 9999
     C  N99 03   DSPYSF    COMP DSPY                 8181
     C**N99 81   DSPY      COMP RUND                   99                 E80649
     C**N99 81   DSPYSF    COMP RUND                   99                 E80649
     C**                                                                  E19322
     C**   THIS LINE REMOVED BECAUSE CAUSED WRONG VALIDATION TO OCCUR.    E19322
     C**   (IF IN AMEND MODE & IF SCREEN-2ND-DATE DIFFERENT TO FILE-      E19322
     C**    2ND-DATE & IF SCREEN-2ND-DATE GT SCREEN-1ST-DATE THEN         E19322
     C**    AN ERROR SHOULD NOT OCCUR IF FILE-2ND-DATE LT RUNDATE)        E19322
     C**                                                                  E19322
     C**N99*81*03DSPY******COMP RUND                   99        E80649   E19322
     C**                                                                  E19322
     C  N99 81 03DSPYSF    COMP RUND                   99                 E80649
     C   99      X         ADD  1         X          59
     C   99                MOVE '099'     ERCD,X
     C                     GOTO TAG18C
     C**
     C           TAG18     TAG                             ** TAG18  TAG *
     C**
     C*****ONLY*EXECUTE ZFREQ IF A VALID FREQUENCY CODE HAS BEEN ENTERED  S01195
     C**   ONLY EXECUTE FREQS IF A VALID FREQUENCY CODE HAS BEEN ENTERED  S01195
     C*         AND IF FIRST DATE ENTERED IS VALID
     C*
     C           ' 096'    LOKUPERCD                     81
     C  N81      ' 097'    LOKUPERCD                     81
     C   81                GOTO TAG18A
     C**
     C                     MOVE PAYFSF    ZFREQ
     C                     Z-ADDDFPYSF    ZDAYNO
     C*                    MOVELFDATSF    ZMDAY
     C  N98                MOVELFDATSF    ZMDAY
     C   98                MOVELFDATSF    WORK4   40
     C   98                MOVE WORK4     ZMDAY
     C                     MOVE CCYSF     ZCCY
     C                     MOVE *BLANKS   ZLOC                            S01195
     C**
     C           TAG18B    TAG                             ** TAG18B TAG *
     C**
     C***********          EXSR ZFREQS                                    S01195
     C/COPY WNCPYSRC,RE0253C040
     C                     EXSR FREQS                                     S01195
     C           PAYFSF    COMP 'A'                      81-FOR ACCRUAL/
     C***81******          MOVE APFQ      ZFREQ             PROFIT DATE.  S01194
     C   81                MOVE BKAPFQ    ZFREQ             PROFIT DATE.  S01194
     C**
     C*****EXSR*ZFREQ AGAIN IF RUN DATE NOT REACHED.                      S01195
     C**   EXSR FREQS AGAIN IF RUN DATE NOT REACHED.                      S01195
     C           ZDAYNO    COMP RUND                   81
     C  N81      ZDAYNO    COMP DFPYSF                 8181               E14693
     C   81                GOTO TAG18B
     C**
     C                     MOVE ZDAYNO    DSPYSF
     C* FORMAT CALCULATED SECOND DATE                                     S01413
     C                     EXSR ZDATE2                                    S01413
     C                     MOVE ZDATE     SDATSF                          E14693
     C                     MOVE PAYFSF    ZFREQ                           E14693
     C**
     C           TAG18C    TAG                             ** TAG18C TAG *
     C           ' 099'    LOKUPERCD                     81
     C   81                GOTO TAG18A
     C   03      DSPYSF    COMP DSPY                 8181                 E43618
     C   03N81             GOTO TAG18A                                    E43618
     C**
     C**   SECOND  PAYMENT DATE MUST TIE IN WITH FREQUENCY CODE.
     C                     MOVE DSPYSF    DAYNO   50
     C*
     C*    DAY IN MONTH REQUIRED TO CHECK FREQUENCY CODE 'A'
     C  N98                MOVELSDATSF    ZMDAY
     C   98                MOVELSDATSF    WORK4
     C   98                MOVE WORK4     ZMDAY
     C*
     C                     EXSR DATCHK
     C   99      X         ADD  1         X          59
     C   99                MOVE '099'     ERCD,X
     C/COPY WNCPYSRC,RE0253C044
     C**
     C**   SECOND  PAYMENT AMOUNT.
     C           TAG18A    TAG                             ** TAG18A TAG *
     C           SAMTSF    COMP ' '                      81
     C   81                GOTO TAG18D
     C           SDATSF    COMP '      '                 81
     C   81                SETON                         99
     C   81 99             GOTO ER8199
     C**
     C                     MOVE SAMTSF    ZFIELD
     C                     MOVEL'  '      ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    ASPYSF
     C           ER8199    TAG
     C   99      X         ADD  1         X          72
     C   99                MOVE '100'     ERCD,X
      *                                                                                       CGL014
      ** Check if balance remaining due to all debits posted across                           CGL014
      ** retail accounts is sufficient to cover the blocked amount                            CGL014
      *                                                                                       CGL014
     C           *IN72     IFEQ *OFF                                                          CGL014
     C           *IN58     ANDEQ*OFF                                                          CGL014
     C           CGL014    ANDEQ'Y'                                                           CGL014
     C           WDATYP    ANDEQ'R'                                                           CGL014
     C           WDCOLF    ANDEQ'Y'                                                           CGL014
     C           AFPYSF    ADD  ASPYSF    WSUM   130                                          CGL014
     C                     Z-ADDWSUM      PTAMNT                                              CGL014
      *                                                                                       CGL014
     C                     CALL 'GL006000'                                                    CGL014
     C                     PARM           PTAMNT                                              CGL014
     C                     PARM WDCYCD    PTCCY                                               CGL014
     C                     PARM WDIBCA    PABRCA                                              CGL014
     C                     PARM WDCUST    PACNUM                                              CGL014
     C                     PARM WDCYCD    PACCY                                               CGL014
     C                     PARM WDACCD    PAACOD                                              CGL014
     C                     PARM WDACSN    PAACSQ                                              CGL014
     C                     PARM WDRACN    PAACNO                                              CGL014
     C                     PARM *BLANKS   PRTCD                                               CGL014
      *                                                                                       CGL014
      ** Error:  Available balance is not sufficient                                          CGL014
      ** to cover blocked amount                                                              CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ '*BLKERR'                                                     CGL014
     C           X         ADD  1         X                                                   CGL014
     C                     MOVE '106'     ERCD,X                                              CGL014
     C                     MOVE *ON       *IN72                                               CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
      ** Warning:  Balance is greater than blocked amount but less                            CGL014
      ** than minimum balance; minimum balance will be exceeded                               CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ '*WARN  '                                                     CGL014
     C           ASPYSF    IFNE WCOPY2                                                        CGL014
     C                     MOVE '0'       WARN2                                               CGL014
     C                     ENDIF                                                              CGL014
     C           WARN2     IFEQ '0'                                                           CGL014
     C           X         ADD  1         X                                                   CGL014
     C                     MOVE 'W01'     ERCD,X                                              CGL014
     C                     MOVE *ON       *IN72                                               CGL014
     C                     Z-ADDASPYSF    WCOPY2                                              CGL014
     C           X         IFEQ 1                                                             CGL014
     C                     MOVE '1'       WARN2                                               CGL014
     C                     ENDIF                                                              CGL014
     C                     ENDIF                                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C**
     C           TAG18D    TAG                             ** TAG18D TAG *
     C**
     C**   LAST PAYMENT DATE.
     C           LDATSF    COMP '      '                 81
     C   81                Z-ADD99999     DLPYSF
     C   81                GOTO TAG19                      -NOT ENTERED
     C                     MOVE LDATSF    ZDATE
     C                     EXSR ZDATE1
     C                     MOVE ZDAYNO    DLPYSF
     C**
     C***IF*2ND*PAY DATE SET BY ZFREQ, CHECK NOT LATER THAN LAST PAY DATE.S01195
     C** IF 2ND PAY DATE SET BY FREQS, CHECK NOT LATER THAN LAST PAY DATE.S01195
     C***IF*SO,*SET*2ND*PAY*DATE*TO*LAST*PAY*DATE.*********************   088569
     C** IF SO, SET 2ND PAY DATE AND AMOUNTS TO BLANK/ZERO.               088569
     C***68******DLPYSF    COMP DSPYSF                 81                 088569
     C   68      DLPYSF    COMP DSPYSF                 8181               088569
     C           *IN81     IFEQ '1'                                       088569
     C***81******          Z-ADDDLPYSF    DSPYSF                          088569
     C                     Z-ADD*ZEROS    DSPYSF                          088569
     C                     Z-ADD*ZEROS    ASPYSF                          088569
     C**FORMAT*REPLACED*SECOND*DATE*********************************S01413088569
     C* FORMAT REPLACED SECOND DATE AND AMOUNT                            088569
     C***81******          MOVE LDATSF    SDATSF                    S01413088569
     C                     MOVE *BLANKS   SDATSF                          088569
     C                     MOVE *BLANKS   SAMTSF                          088569
     C                     END                                            088569
     C*****LAST PAYMENT DATE MUST BE GREATER THAN SECOND OR FIRST.****
     C**   LAST PAYMENT DATE > OR = SECOND OR FIRST PAYMENT DATE
     C           DFPYSF    COMP RUND                   81
     C  N99 81   DLPYSF    COMP DLMV                   9999
     C**N99N81   DLPYSF    COMP DFPYSF                 9999               E43618
     C**N99N81***DLPYSF    COMP DFPYSF                 99          E43618 S01413
     C**N99N81N68DLPYSF    COMP DSPYSF                 9999               E43618
     C* RESTORE 'STRICTLY GREATER THAN' - FOR LAST/FIRST ONLY             S01413
     C  N99N81   DLPYSF    COMP DFPYSF                 9999               S01413
     C**N99N81N68DLPYSF****COMP DSPYSF                 99           E43618088569
     C* IF SECOND DATE INPUT BUT NOT LESS THAN LAST DATE, DISPLAY ERROR   088569
     C  N99N68   DLPYSF    COMP DSPYSF                 9999               088569
     C* IF ERROR AND SECOND DATE WAS CALCULATED, RESTORE TO BLANKS        S01413
     C   99 68             Z-ADD0         DSPYSF                          S01413
     C   99 68             MOVE '      '  SDATSF                          S01413
     C                     SETOF                     68
     C   99      X         ADD  1         X          6081
     C   99                MOVE '101'     ERCD,X
     C/COPY WNCPYSRC,RE0253C045
     C**
     C           TAG19     TAG                             ** TAG19 TAG **
     C**
     C**   LAST PAYMENT AMOUNT.
     C           LAMTSF    COMP BLNK14                   81
     C   81                GOTO TAG191                     -BLANK AMOUNT.
     C**
     C           LDATSF    COMP '      '                 73
     C   73      X         ADD  1         X
     C   73                MOVE '102'     ERCD,X
     C   73                GOTO TAG19A
     C                     MOVE LAMTSF    ZFIELD
     C                     MOVEL'  '      ZFIELD
     C                     EXSR ZALIGN
     C                     MOVE ZFIELD    ALPYSF
     C   99      X         ADD  1         X          73
     C   99                MOVE '102'     ERCD,X
      *                                                                                       CGL014
      ** Check if balance remaining due to all debits posted across                           CGL014
      ** retail accounts is sufficient to cover the blocked amount                            CGL014
      *                                                                                       CGL014
     C           *IN73     IFEQ *OFF                                                          CGL014
     C           *IN72     ANDEQ*OFF                                                          CGL014
     C           *IN58     ANDEQ*OFF                                                          CGL014
     C           CGL014    ANDEQ'Y'                                                           CGL014
     C           WDATYP    ANDEQ'R'                                                           CGL014
     C           WDCOLF    ANDEQ'Y'                                                           CGL014
     C           AFPYSF    ADD  ASPYSF    WSUM                                                CGL014
     C                     ADD  ALPYSF    WSUM                                                CGL014
     C                     Z-ADDWSUM      PTAMNT                                              CGL014
      *                                                                                       CGL014
     C                     CALL 'GL006000'                                                    CGL014
     C                     PARM           PTAMNT                                              CGL014
     C                     PARM WDCYCD    PTCCY                                               CGL014
     C                     PARM WDIBCA    PABRCA                                              CGL014
     C                     PARM WDCUST    PACNUM                                              CGL014
     C                     PARM WDCYCD    PACCY                                               CGL014
     C                     PARM WDACCD    PAACOD                                              CGL014
     C                     PARM WDACSN    PAACSQ                                              CGL014
     C                     PARM WDRACN    PAACNO                                              CGL014
     C                     PARM *BLANKS   PRTCD                                               CGL014
      *                                                                                       CGL014
      ** Error:  Available balance is not sufficient                                          CGL014
      ** to cover blocked amount                                                              CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ '*BLKERR'                                                     CGL014
     C           X         ADD  1         X                                                   CGL014
     C                     MOVE '106'     ERCD,X                                              CGL014
     C                     MOVE *ON       *IN73                                               CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
      ** Warning:  Balance is greater than blocked amount but less                            CGL014
      ** than minimum balance; minimum balance will be exceeded                               CGL014
      *                                                                                       CGL014
     C           PRTCD     IFEQ '*WARN  '                                                     CGL014
     C           ALPYSF    IFNE WCOPY3                                                        CGL014
     C                     MOVE '0'       WARN3                                               CGL014
     C                     ENDIF                                                              CGL014
     C           WARN3     IFEQ '0'                                                           CGL014
     C           X         ADD  1         X                                                   CGL014
     C                     MOVE 'W01'     ERCD,X                                              CGL014
     C                     MOVE *ON       *IN73                                               CGL014
     C                     Z-ADDALPYSF    WCOPY3                                              CGL014
     C           X         IFEQ 1                                                             CGL014
     C                     MOVE '1'       WARN3                                               CGL014
     C                     ENDIF                                                              CGL014
     C                     ENDIF                                                              CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C                     ENDIF                                                              CGL014
      *                                                                                       CGL014
     C                     GOTO TAG19A
     C**
     C           TAG191    TAG                             ** TAG191 TAG *
     C**
     C           LDATSF    COMP '      '                 81
     C   81                GOTO TAG19A
     C           SAMTSF    COMP ' '                      81
     C                     Z-ADDASPYSF    ALPYSF           -DEFAULT.
     C   81                Z-ADDAFPYSF    ALPYSF           -DEFAULT
     C   81                SETOF                     81
     C**
     C           TAG19A    TAG                             ** TAG19A TAG *
     C/COPY WNCPYSRC,RE0253C041
     C**
     C**   PAYMENT METHOD.
     C           PAYMTH    COMP 'C'                  8585
     C   85      PAYMTH    COMP 'D'                  8585
     C   85      PAYMTH    COMP 'T'                  8585
     C   85      PAYMTH    COMP 'I'                  8585
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCP8                                           S01408
     C*                                                                   S01408
     C**
     C   85      X         ADD  1         X
     C   85                MOVE '129'     ERCD,X
      *
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0253CVSF                                           S01408
     C*                                                                   S01408
     C**
     C**   END OF VALIDATION SECTION. IF ERRORS, OUTPUT ERROR MESSAGES.
     C           X         COMP 00                       81
     C           *IN81     IFEQ '1'                                       S01117
     C           PFCU      IFEQ 'Y'                                       S01117
     C                     EXSR PRFCVL                                    S01117
     C                     ELSE                                           S01117
     C                     MOVE *BLANKS   IPRFC                           S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C   81                GOTO UDLOG                      -NO ERRORS.
     C                     SETON                         62
     C   03                EXSR IND04
     C   14                SETOF                     19
     C                     SETOF                     15
     C                     GOTO SETSF
     C**
     C           UDLOG     TAG                             ** UDLOG TAG **
     C*                                                               *   S01241
     C*    WINDOW PROCESSING FOR AMEND                                *   S01241
     C*                                                                   S01241
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCP9                                           S01408
     C*                                                                   S01408
     C                     MOVEL'RE0253'  #PGM                            S01241
     C                     MOVE *BLANKS   #RTRN                           S01241
     C*                                                                   S01241
     C                     MOVE HELDSF    STORW                           S01241
     C                     MOVE HLDACT    ACTNW                           S01241
     C*                                                                   S01241
     C***********BGL5ST    IFEQ 'Y'                                 S01241S01251
     C           BGWDPR    IFEQ 'Y'                                       S01251
      *    /copy to move data into the data structure fields passed       S01241
      *     as a parameter to the window controller                       S01241
      /COPY WNCPYSRC,RE0253MOV2                                           S01241
      *                                                                   S01241
     C*                                                                   092560
     C** Re-display screen after an error has been corrected              092560
     C** and prior to displaying Sweep Threshold Amount Window.           092560
     C*                                                                   092560
     C           *IN41     IFEQ *OFF                                      092560
     C                     MOVE *ON       *IN41                           092560
     C                     EXCPTSCRN2                                     092560
     C                     GOTO START                                     092560
     C                     ENDIF                                          092560
      *                                                                   092560
     C                     UNLCKLDA                                       S01241
     C                     CALL 'WN0010'                                  S01241
     C                     PARM           #PGM   10                       S01241
     C/COPY WNCPYSRC,RE0253C001
     C                     PARM *BLANK    WKEY    2                       S01241
     C/COPY WNCPYSRC,RE0253C002
     C                     PARM           ACTNW   1                       S01241
     C                     PARM           DATA                            S01241
     C                     PARM *BLANK    #RTRN   7                       S01241
     C                     PARM           SPARE 256                       S01252
     C           *LOCK     IN   LDA                                       S01241
     C                     END                                            S01241
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CP10                                           S01408
     C*                                                                   S01408
     C*                                                                   S01241
     C                     Z-ADD1         ETAT                            S01241
     C*                                                                   S01241
     C***********#RTRN*****IFEQ 'USR0790'                           S01241E22221
     C           #RTRN     IFNE *BLANK                                    E22221
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CP11                                           S01408
     C*                                                                   S01408
     C                     CALL 'SNDERMSG'                                S01241
     C                     PARM           ZAPGM            Program queue  S01241
     C                     PARM           ZAPGRL  5        Rel queue      S01241
     C*********************PARM 'WND0001' ZAMSID  7     Message Id. S01241E22221
     C                     PARM #RTRN     ZAMSID  7        Message Id.    E22221
     C*********************PARM 'MIDAS  ' ZAMSGF 10   Message file. S01241E22221
     C                     PARM 'WNMSGF ' ZAMSGF 10        Message file.  E22221
     C                     PARM           ZAMSDA132        Message data.  S01241
     C                     PARM           ZAMSTP  7        Message type.  S01241
      * Clear all fields                                                  S01241
     C                     MOVEL*BLANK    ZAPGM            Program queue  S01241
     C                     MOVEL*BLANK    ZAPGRL           Rel queue      S01241
     C                     MOVEL*BLANK    ZAMSID           Message Id.    S01241
     C                     MOVEL*BLANK    ZAMSGF           Message file.  S01241
     C                     MOVEL*BLANK    ZAMSDA           Message data.  S01241
     C                     MOVEL*BLANK    ZAMSTP           Message type.  S01241
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CP15                                           S01408
     C*                                                                   S01408
     C*                                                                   S01241
     C                     SETON                         62               S01241
     C   03                EXSR IND04                                     S01241
     C   14                SETOF                     19                   S01241
     C                     SETOF                     15                   S01241
     C                     GOTO END                                       S01241
     C                     END                                            S01241
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CP12                                           S01408
     C*                                                                   S01408
     C**
     C**   READ RECORD TO BE INSERTED, AMENDED OR DELETED.
     C                     MOVE HELDSF    STNKEY
     C                     EXSR STNCHN
     C**
     C**   IS RECORD CHANGED.
     C/COPY WNCPYSRC,RE0253C025
     C  N06                Z-ADD00000     LCD
     C/COPY WNCPYSRC,RE0253C026
     C  N06                MOVE ' '       CHTP
     C  N06                Z-ADD00000     TNLU
     C**
     C           LSTC      COMP LSTCSF               8282
     C**
     C           INFTAG    TAG                             ** INFTAG TAG**
     C**
     C  N82                GOTO TAG21
     C                     MOVE OMBSI     MBSI                            S01117
      *                                                                                       CSD015
      ** For amendments, perform compliance watch processing if                               CSD015
      ** compliance watch is installed and entry watch list                                   CSD015
      ** checking is being applied                                                            CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C           *IN74     ANDEQ'1'                                                           CSD015
     C           *IN68     ANDEQ'0'                                                           CSD015
     C           *IN04     ANDEQ'0'                                                           CSD015
     C                     EXSR SRCCHK                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C  N68                EXCPTRELSTA                     -RELEASE STAND.
     C**
     C**   OUTPUT INFORMATION FROM UPDATED RECORD.
     C  N06                GOTO TAG20                      -NOT LIVE RECD.
     C***********          MOVEL'20    '  TABKEY                          S01194
     C***********          MOVE '      '  TABKEY                          S01194
     C***********          MOVE CCYST     TABKEY                          S01194
     C***********          EXSR TABCHN                                    S01194
     C*                                                                   S01194
     C* CALL ACCESS PROGRAM AOCURRR0                                      S01194
     C*                                                                   S01194
     C                     MOVE '*MSG   ' @RTCD                           S01194
     C                     MOVELCCYST     CKEY                            S01194
     C                     CALL 'AOCURRR0'PLIST2                          S01194
     C           CDP       COMP 1                      7677               S01194
     C           CDP       COMP 2                    79  78               S01194
     C                     EXSR SFIELD
     C                     EXSR IND04
     C**
     C           TAG20     TAG                             ** TAG20 TAG **
     C**
     C                     Z-ADD04        E
     C**
     C                     SETON                       62
     C***04******          SETON                     637187               S01117
     C   04                SETON                     6371                 S01117
     C                     SETOF                       6465
     C                     GOTO SETSF
     C**
     C           TAG21     TAG                             ** TAG21 TAG **
     C**  OBTAIN LAST TRANSACTION NUMBER  AND SET UP STANDARD OUTPUT
     C**  INFORMATION
     C**
     C                     EXSR ZTNLU1
     C                     MOVE 'RE'      MDID    2
     C                     MOVEL'RE0253'  PGMN    8
     C                     MOVE WSID      WSIDX   3
     C                     MOVE USRID     USRIDX 10
     C**********           MOVE ACCKEY    ACCKYX 15                                           CGL029
     C                     MOVE ACCKEY    ACCKYX 24                                           CGL029
     C**
     C**   S T A N D I N G   O R D E R .
     C**
     C**   SET UP OUTPUT FIELDS FOR DETAIL RECORD.
     C                     MOVE 'D'       RECISF  1
     C   04                MOVE '*'       RECISF
     C   22                MOVE ZERO10    DCUSSF
     C   26                MOVE ZERO10    DRACSF
     C   23                MOVE ZERO10    CCYDR
     C   24                MOVE ZERO10    ACODDR
     C           DACSSF    IFEQ *BLANKS
     C     N26             MOVE ZERO10    DACSSF
     C                     END
     C/COPY WNCPYSRC,RE0253C020
     C   27                MOVE ZERO10    CCUSSF
     C   28                MOVE ZERO10    CCYCR
     C   29                MOVE ZERO10    ACODCR
     C   31                MOVE ZERO10    CRACSF
     C   30N31             MOVE ZERO10    CACSSF
     C/COPY WNCPYSRC,RE0253C021
     C**
     C                     Z-ADDDLMV      DLMVSF  50
     C   02                Z-ADD00000     DLMVSF
     C   02                Z-ADD00000     NXTPSF  50
     C** WHEN FIRST PAY DATE HAS NOT BEEN REACHED NEXT PAY DATE MUST AL-
     C** WAYS BE THIS FIRST PAY DATE.(THIS COVERS ALL INSERTS)
     C           DFPYSF    COMP RUND                   81
     C  N81                Z-ADDDFPYSF    NPAYDT  50
     C  N81                GOTO TAG22A
     C** 2ND PAY DATE COULD ONLY HAVE BEEN CHANGED IF WAS NOT YET REACHED.
     C** SO THE NEXT PAY DATE WILL BE THE 2ND PAY DATE
     C** IF 2ND DATE IS BLANK, DO NOT USE                                 088569
     C           DSPYSF    COMP DSPY                 8181
     C   81      DSPYSF    COMP *ZEROS               8181                 088569
     C   81                Z-ADDDSPYSF    NPAYDT
     C   81                GOTO TAG22A
     C                     Z-ADDNXTP      NPAYDT
     C** NEXT PAY DATE ONLY CHANGED NOW IF LAST PAY DATE PRIOR TO IT
     C           NPAYDT    COMP DLPYSF               81
     C   81      DLPYSF    COMP *ZEROS               8181                 088569
     C   81                Z-ADDDLPYSF    NPAYDT
     C           TAG22A    TAG                             **TAG TAG22A **
     C**
     C*    DAY IN MONTH :-
     C*
     C                     MOVE DYTP      DYTPSF  20
     C**
     C   03      DSPY      COMP DSPYSF               8181
     C*
     C*    AMEND - 2ND DATE NOT CHANGED -
     C   03N81             GOTO SHADOW
     C*
     C*    IN CASE 2ND DATE IS BLANK
     C     N98             MOVELFDATSF    DYTPSF
     C      98             MOVELFDATSF    WORK4
     C      98             MOVE WORK4     DYTPSF
     C*
     C           SDATSF    COMP '       '            8181
     C*
     C*    2ND DATE ON SCREEN IS NOT BLANK
     C      81N98          MOVELSDATSF    DYTPSF
     C      81 98          MOVELSDATSF    WORK4
     C      81 98          MOVE WORK4     DYTPSF
     C****
     C**   S H A D O W   B A L A N C E S
     C**
     C           SHADOW    TAG                             *** SHADOW ***
     C/COPY WNCPYSRC,RE0253C042
     C**
     C**   DETERMINE OLD AND NEW 'NEXT PAYMENT' DATES.
     C   02                Z-ADDDFPYSF    NXTPSF  50       -INSERT.
     C   02                Z-ADDDFPYSF    NPAYDT
     C   02                GOTO TAG26B
     C**
     C**   OLD 'NEXT PAYMENT' DATE FOR AMENDS AND DELETES
     C***********DLMV      COMP ZERO05                   81               117784
     C***********          Z-ADDDFPY      NXTP    50                      117784
     C***81******          GOTO TAG26A                                    117784
     C***********DSPY      COMP 0                        81               117784
     C***81******          Z-ADDDLPY      NXTP                            117784
     C***81******          GOTO TAG26A                                    117784
     C***********DSPY      COMP DLPY                 81                   117784
     C***********          Z-ADDDSPY      NXTP                            117784
     C***81******          Z-ADDDLPY      NXTP                            117784
     C**
     C***********TAG26A    TAG                             ** TAG26A TAG *117784
      *                                                                   087579
      * If the next payment date has passed the 2nd payment date          087579
      * and the next payment date is today, do not overwrite the next     087579
      * payment date field and make the 'saved' next payment date the     087579
      * same. This ensures that PF/RSACMTPD is updated correctly for      087579
      * the projected account movements enquiry.                          087579
      *                                                                   087579
     C           NXTP      IFGT DSPY                                      087579
     C           NXTP      ANDEQRUND                                      087579
      *                                                                   087579
     C                     Z-ADDNXTP      NXTPSF                          087579
      *                                                                   095801
     C   04                GOTO TAG28                                     095801
     C                     GOTO TAG26B                                    087579
      *                                                                   087579
     C                     ENDIF                                          087579
      *                                                                   087579
     C**
      * Old next payment date should only be set up if old 1st payment    117784
      * date not yet reached; otherwise it will have been set up by the   117784
      * system (and may have been amended by the user).                   117784
     C           DFPY      IFGE RUND                                      117784
     C                     Z-ADDDFPY      NXTP                            117784
     C                     END                                            117784
      *                                                                   117784
     C   04                GOTO TAG28                      -DELETE.
     C**
     C**   NEW 'NEXT PAYMENT' DATE FOR AMENDS.
     C***********DLMV      COMP ZERO05                   81               117784
     C***********          Z-ADDDFPYSF    NXTPSF                          117784
     C***81******          GOTO TAG26B                                    117784
     C***********DSPYSF    COMP 0                        81               117784
     C***81******          Z-ADDDLPYSF    NXTPSF                          117784
     C***81******          GOTO TAG26B                                    117784
     C***********DSPYSF    COMP DLPYSF               81                   117784
     C***********          Z-ADDDSPYSF    NXTPSF                          117784
     C***81******          Z-ADDDLPYSF    NXTPSF                          117784
     C**
      * New next payment date should be set to new 1st payment date if    117784
      * not yet reached, else new 2nd payment date if not yet reached,    117784
      * else old next payment date unless it is *GT new last pay date.    117784
     C           DFPYSF    IFGE RUND                                      117784
     C                     Z-ADDDFPYSF    NXTPSF                          117784
     C                     ELSE                                           117784
     C           DSPYSF    IFGE RUND                                      117784
     C                     Z-ADDDSPYSF    NXTPSF                          117784
     C                     ELSE                                           117784
     C                     Z-ADDNXTP      NXTPSF                          117784
     C           NXTPSF    IFGT DLPYSF                                    117784
     C                     Z-ADDDLPYSF    NXTPSF                          117784
     C                     END                                            117784
     C                     END                                            117784
     C                     END                                            117784
      *                                                                   117784
     C           TAG26B    TAG                             ** TAG26B TAG *
     C**
     C**   DETERMINE AMOUNT OF PREVIOUS AND NEXT PAYMENTS.
     C**
     C**   INSERT.
     C   02                MOVE 'I'       CHTPSF                          E11056
     C   02                MOVE AFPYSF    NXAM   133
     C   02                GOTO TAG29
     C**
     C**   AMENDMENT - PREVIOUS PAYMENT AMOUNT.
     C                     MOVE AFPY      PRAM   133
     C           NXTP      COMP DLPY                     81
     C   81                MOVE ALPY      PRAM
     C   81                GOTO TAG27
     C           DSPY      COMP 0                        81
     C   81                GOTO TAG27
     C           NXTP      COMP DSPY                 81  81
     C   81                MOVE ASPY      PRAM
     C**
     C           TAG27     TAG                             ** TAG27 TAG **
     C**
     C**   AMENDMENT - NEXT PAYMENT AMOUNT.
     C                     MOVE AFPYSF    NXAM
     C           NXTPSF    COMP DLPYSF                   81
     C   81                MOVE ALPYSF    NXAM
     C   81                GOTO TAG29
     C           DSPYSF    COMP 0                        81
     C   81                GOTO TAG29
     C           NXTPSF    COMP DSPYSF               81  81
     C   81                MOVE ASPYSF    NXAM
     C                     GOTO TAG29
     C**
     C           TAG28     TAG                             ** TAG28 TAG **
     C**
     C**   DELETION.
     C   04                MOVE 'D'       CHTPSF                          E11056
     C                     MOVE AFPY      NXAM
     C           NXTP      COMP DLPY                     81
     C   81                MOVE ALPY      NXAM
     C   81                GOTO TAG29
     C           DSPY      COMP 0                        81
     C   81                GOTO TAG29
     C           NXTP      COMP DSPY                 81  81
     C   81                MOVE ASPY      NXAM
     C**
     C           TAG29     TAG                             ** TAG29 TAG **
     C**
     C   03                GOTO TAG31                      -AMEND SCREEN.
     C**
     C**   INSERT OR DELETE - DETERMINE IF SHADOW BALANCES TO BE ADJUSTED.
     C***02******NXTPSF    COMP RUND                 81    -NEXT PAY DATE.CCB002
     C***04******NXTP      COMP RUND                 81    -NEXT PAY DATE.CCB002
     C***81******          GOTO TAG35                      -BYPASS.       CCB002
     C**
     C**   CHECK IF DEBIT RETAIL A/C TYPE
     C/COPY WNCPYSRC,RE0253C003
     C           ATYPDB    COMP 'R'                      81
     C  N81                GOTO TAG30                      -NOT DEBIT.
      *                                                                   CCB002
      **   Set up parameters for call to access object AOMEMSU0.          CCB002
     C           *IN02     IFEQ *ON                                       CCB002
     C                     Z-ADDNXTPSF    W0VDAT                          CCB002
     C                     Z-ADDNXTPSF    W0PSTD                          CCB002
     C                     ELSE                                           CCB002
     C           *IN04     IFEQ *ON                                       CCB002
     C                     Z-ADDNXTP      W0VDAT                          CCB002
     C                     Z-ADDNXTP      W0PSTD                          CCB002
     C                     ENDIF                                          CCB002
     C                     ENDIF                                          CCB002
      *                                                                   CCB002
      ** Use the full account code from the screen when retail            209995
      ** account numbers are not being used.                              209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C                     MOVE ZCNUMD    W0CNUM                          CCB002
     C                     MOVELCCYSF     W0CUCD                          CCB002
     C                     MOVE ZACODD    W0ACCD                          CCB002
     C                     MOVE ZACSQD    W0ACSQ                          CCB002
     C                     MOVELZBRCDD    W0BRCA                          CCB002
     C                     ELSE                                           209995
     C                     MOVE DCUSSF    W0CNUM                          209995
     C                     MOVELCCYSF     W0CUCD                          209995
     C                     MOVE ACODDR    W0ACCD                          209995
     C                     MOVE DACSSF    W0ACSQ                          209995
     C                     MOVELDBRCSF    W0BRCA                          209995
     C                     ENDIF                                          209995
     C           NXAM      MULT 1000      W0AMT                           CCB002
     C           *IN04     IFEQ *ON                                       CCB002
     C                     Z-SUBW0AMT     W0AMT                           CCB002
     C                     ENDIF                                          CCB002
     C**
     C*****CHAIN*TO*MEMO*FILE                                             CCB002
     C***********          MOVE DRRNSF    MEMKEY  50                      CCB002
     C                     EXSR MEMCHN
     C**
     C**   MEMO RECORD NOT FOUND.
     C**N08******          SETON                     U883  -DATABASE ERRORCCB002
     C***U8******          GOTO END                                       CCB002
     C**
     C*****ADJUST BALANCES.                                               CCB002
     C***02******          EXSR NXAMAD                                    CCB002
     C***04******          EXSR NXAMSB                                    CCB002
     C**
     C** FOR INSERT AND DELETE,OUTPUT DEBIT ACCOUNT RECORD TO RSACMTPD    S01154
     C**                                                                  S01154
      *                                                                   209995
      ** Check if account is Nostro, if so, updating will be done         209995
      ** in the #NOST subroutine.                                         209995
      *                                                                   209995
     C                     MOVE DCUSSF    A7CUST                          209995
     C                     MOVE CCYSF     A7CYCD                          209995
     C                     MOVE ACODDR    A7ACCD                          209995
     C                     MOVE DACSSF    A7ACSN                          209995
      *                                                                   209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
      *                                                                   209995
     C                     SETON                     42                   S01154
     C**                                                                  S01154
     C                     SETON                     67
     C                     EXSR RELESE
     C**
     C           TAG30     TAG                             ** TAG30 TAG **
     C**
     C**   CHECK CREDIT RETAIL A/C TYPE
     C           ATYPCR    COMP 'R'                      81
     C  N81                GOTO TAG35                      -END MEMO UPDT
      *                                                                   CCB002
      **   Set up parameters for call to access object AOMEMSU0.          CCB002
     C           *IN02     IFEQ *ON                                       CCB002
     C                     Z-ADDNXTPSF    W0VDAT                          CCB002
     C                     Z-ADDNXTPSF    W0PSTD                          CCB002
     C                     ELSE                                           CCB002
     C           *IN04     IFEQ *ON                                       CCB002
     C                     Z-ADDNXTP      W0VDAT                          CCB002
     C                     Z-ADDNXTP      W0PSTD                          CCB002
     C                     ENDIF                                          CCB002
     C                     ENDIF                                          CCB002
      *                                                                   CCB002
      ** Use the Full account code from the screen when retail            209995
      ** account numbers are not being used.                              209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C                     MOVE ZCNUMC    W0CNUM                          CCB002
     C                     MOVELCCYSF     W0CUCD                          CCB002
     C                     MOVE ZACODC    W0ACCD                          CCB002
     C                     MOVE ZACSQC    W0ACSQ                          CCB002
     C                     MOVELZBRCDC    W0BRCA                          CCB002
     C                     ELSE                                           209995
     C                     MOVE CCUSSF    W0CNUM                          209995
     C                     MOVELCCYSF     W0CUCD                          209995
     C                     MOVE ACODCR    W0ACCD                          209995
     C                     MOVE CACSSF    W0ACSQ                          209995
     C                     MOVELCBRCSF    W0BRCA                          209995
     C                     ENDIF                                          209995
     C/COPY WNCPYSRC,RE0253C030
     C           NXAM      MULT 1000      W0AMT                           CCB002
     C           *IN02     IFEQ *ON                                       CCB002
     C                     Z-SUBW0AMT     W0AMT                           CCB002
     C                     ENDIF                                          CCB002
     C**                                                                  CCB002
     C*****CHAIN*TO*MEMO*FILE.                                            CCB002
     C***********          MOVE CRRNSF    MEMKEY                          CCB002
     C                     EXSR MEMCHN
     C**
     C**  MEMO RECORD NOT FOUND.
     C**N08******          SETON                     U883  -DATABASE ERRORCCB002
     C***U8******          GOTO END                                       CCB002
     C*
     C**
     C*****ADJUST BALANCES.                                               CCB002
     C***02******          EXSR NXAMSB                                    CCB002
     C***04******          EXSR NXAMAD                                    CCB002
     C**
     C** FOR INSERT AND DELETE,OUTPUT CREDIT ACCOUNT RECORD TO RSACMTPD   S01154
     C**                                                                  S01154
      *                                                                   209995
      ** Check if account is Nostro, if so, updating will be done         209995
      ** in the #NOST subroutine.                                         209995
      *                                                                   209995
     C                     MOVE CCUSSF    A7CUST                          209995
     C                     MOVE CCYSF     A7CYCD                          209995
     C                     MOVE ACODCR    A7ACCD                          209995
     C                     MOVE CACSSF    A7ACSN                          209995
      *                                                                   209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
      *                                                                   209995
     C                     SETON                     80                   S01154
     C**                                                                  S01154
     C                     SETON                     6741
     C                     EXSR RELESE
     C**
     C                     GOTO TAG35                      -END MEMO UPDT.
     C**
     C           TAG31     TAG                             ** TAG31 TAG **
      *                                                                   117784
     C                     Z-ADDCRAC      CRACO                           117784
      *                                                                   117784
      * If payment method 'C' a retail default CR a/c no. may be used     117784
      * but with the full a/c no. Ensure that the retail no. is set up    117784
      * as otherwise the a/c will not be treated as retail.               117784
     C           METH      IFEQ 'C'                                       117784
     C           CRACO     ANDEQ*ZEROS                                    117784
     C                     MOVE CCUS      KCNUM                           117784
     C                     MOVE CCYST     KCCY                            117784
     C                     MOVE CACD      KCOD                            117784
     C                     MOVE CACS      KACSQ                           117784
     C                     MOVE BRCDC     KBRCD                           117784
     C                     Z-ADD*ZEROS    ACNO                            117784
     C                     EXSR ACCCHN                                    117784
     C                     Z-ADDACNO      CRACO                           117784
     C                     END                                            117784
     C**
     C**   AMEND - DETERMINE IF SHADOW BALANCES TO BE ADJUSTED
     C   03                MOVE 'A'       CHTPSF                          E11056
     C***********NXTP      COMP RUND                     81               CCB002
     C**N81******NXTPSF    COMP RUND                     81               CCB002
     C**N81******          GOTO TAG35                      -NO CHANGE.    CCB002
     C/COPY WNCPYSRC,RE0253C009
     C           NXTP      COMP NXTPSF                   81
      *                                                                   209995
      ** If Retail account number not being used, use the full            209995
      ** account code in the comparison.                                  209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C                     MOVE DRAC      WRK3   10
     C           WRK3      COMP DRACSF                   33
     C***********          MOVE CRAC      WRK3                            117784
     C***********WRK3      COMP CRACSF                   34               117784
     C           CRACO     COMP CRACN                    34               117784
     C                     ELSE                                           209995
     C           ODAKEY    COMP NDAKEY                   33               209995
     C           OCAKEY    COMP NCAKEY                   34               209995
     C                     ENDIF                                          209995
     C           NXAM      COMP PRAM                     35
     C/COPY WNCPYSRC,RE0253C004
      *                                                                   CRE009
      ** If CRE009 is ON, one of the accounts is RE and no there are no   CRE009
      ** changes on the next payment date but there are in either tha     CRE009
      ** 2nd payment date/amount or last payment date/amount, then we     CRE009
      ** need to reverse out the projected movements in RSACMTPD.         CRE009
      *                                                                   CRE009
 s1  C           CRE009    IFEQ 'Y'                                       CRE009
     C           *IN33     ANDEQ*ON                                       CRE009
     C           *IN34     ANDEQ*ON                                       CRE009
     C           *IN35     ANDEQ*ON                                       CRE009
     C           *IN81     ANDEQ*ON                                       CRE009
      *                                                                   CRE009
 s2  C           DSPY      IFNE DSPYSF                                    CRE009
     C           ASPY      ORNE ASPYSF                                    CRE009
     C           DLPY      ORNE DLPYSF                                    CRE009
     C           ALPY      ORNE ALPYSF                                    CRE009
      *                                                                   CRE009
 s3  C           ATYPDB    IFEQ 'R'                                       CRE009
     C           ATYPCR    OREQ 'R'                                       CRE009
      *                                                                   CRE009
     C           ATYPDB    IFEQ 'R'                                       CRE009
     C                     MOVE 'DR'      PROC    2                       CRE009
     C                     EXSR REVMOV                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           ATYPCR    IFEQ 'R'                                       CRE009
     C                     MOVE 'CR'      PROC                            CRE009
     C                     EXSR REVMOV                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     GOTO TAG35                                     CRE009
      *                                                                   CRE009
e3   C                     ELSE                                           CRE009
     C                     GOTO TAG35                                     CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
e2   C                     ELSE                                           CRE009
     C                     GOTO TAG35                                     CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
      *                                                                   CRE009
     C   33 34 35
     CAN 81                GOTO TAG35                      -NO CHANGE REQD
      *                                                                   CRE009
e1   C                     ENDIF                                          CRE009
     C**
     C**   DEBIT - BYPASS IF A/C AND AMT  UNCHANGED OR IF NOT A RETAIL A/C
     C           ATYPDB    COMP 'R'                      81
     C*                                                                   E49677
     C* BYPASS IF OLD AMT NOT VALUED TODAY                                E49677
      *                                                                   CRE009
      ** If CRE009 is ON, only bypass if old amt valued after REPMED      CRE009
      ** in REPMFWPD for the currency.                                    CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C                     MOVE *IN14     SAV14   1                       CRE009
     C           CCYST     CHAINREPMFWL1             14                   CRE009
     C           *IN14     IFEQ *ON                                       CRE009
     C                     MOVEL'RE0253 ' DBPGM                           CRE009
     C                     MOVEL'REPMFWPD'DBFILE           ************   CRE009
     C                     MOVELCCYST     DBKEY            * DBERR 08 *   CRE009
     C                     Z-ADD08        DBASE            ************   CRE009
     C                     OUT  LDA                                       CRE009
     C                     EXSR *PSSR                                     CRE009
     C                     SETON                     U7U8LR               CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV14     *IN14                           CRE009
     C           NXTP      COMP REPMED                 8989               CRE009
     C                     ELSE                                           CRE009
     C           NXTP      COMP RUND                   8989               E49677
     C                     ENDIF                                          CRE009
     C*                                                                   E49677
     C   81 89             GOTO TAG31A                                    E49677
     C*                                                                   E49677
     C   33 35
     CORN89                                                               E49677
     COR 33N81             GOTO TAG32                                     E49677
     C*R 33N81             GOTO TAG33                                     E49677
     C*                                                                   E49677
     C           TAG31A    TAG                             *** TAG31A *** E49677
     C*                                                                   E49677
     C                     SETOF                     89                   E49677
     C**
      ** Process if the account is Retail.                                209995
      *                                                                   209995
     C********** DRAC      COMP ZERO10                   81-OLD A/C NOT A 209995
     C           ATYPDB    COMP 'R'                  8181  -Old A/c not   209995
     C   81                GOTO TAG32                       RETAIL A/C.
     C**
     C**   OBTAIN MEMO RRN FOR OLD RETAIL A/C.
      ** Processing will be done only if Retail account numbers are       209995
      ** being used.                                                      209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C                     MOVE DRAC      KEY10
     C                     EXSR ACNCHN
     C  N13                SETON                     U883  -DATABASE ERROR
     C   U8                GOTO END
     C                     EXSR ACFILL
     C                     EXSR ACCCHN
     C  N12                SETON                     U883  -DATABASE ERROR
     C   U8                GOTO END
     C                     ENDIF                                          209995
      *                                                                   CCB002
      **   Set up parameters for call to access object AOMEMSU0.          CCB002
      **   (Subtract the original amount)                                 CCB002
      ** Use the full account code if retail account numbers are          209995
      ** not being used.                                                  209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C                     Z-ADDDRAC      W0RETL                          CCB002
     C**********           Z-ADD*ZEROS    W0CNUM                                       CCB002 CSD027
     C                     MOVE *BLANKS   W0CNUM                                              CSD027
     C                     MOVE *BLANKS   W0CUCD                          CCB002
     C                     Z-ADD*ZEROS    W0ACCD                          CCB002
     C                     Z-ADD*ZEROS    W0ACSQ                          CCB002
     C                     MOVE *BLANKS   W0BRCA                          CCB002
     C                     ELSE                                           209995
     C                     Z-ADD*ZEROS    W0RETL                          209995
     C**********           Z-ADDDCUS      W0CNUM                                       209995 CSD027
     C                     MOVE DCUS      W0CNUM                                              CSD027
     C                     MOVE CCYST     W0CUCD                          209995
     C                     Z-ADDDACD      W0ACCD                          209995
     C                     Z-ADDDACS      W0ACSQ                          209995
     C                     MOVE BRCDD     W0BRCA                          209995
     C                     ENDIF                                          209995
     C           PRAM      MULT 1000      W0AMT                           CCB002
     C                     Z-SUBW0AMT     W0AMT                           CCB002
     C                     Z-ADDNXTP      W0PSTD                          CCB002
     C                     Z-ADDNXTP      W0VDAT                          CCB002
      *                                                                   CCB002
     C***********          Z-ADDRRNM      DRRN    50                      CCB002
     C**
     C*****CHAIN*TO*MEMO*FILE.                                            CCB002
     C***********          MOVE DRRN      MEMKEY                          CCB002
      *
      ** Only access MEMOS file if NXTP is before or equal to the run     CRE009
      ** date.                                                            CRE009
     C           CRE009    IFEQ 'N'                                       CRE009
     C           CRE009    OREQ 'Y'                                       CRE009
     C           NXTP      ANDLERUND                                      CRE009
     C                     EXSR MEMCHN
     C                     ENDIF                                          CRE009
     C**
     C**   MEMO RECORD NOT FOUND.
     C**N08******          SETON                     U883  -DATABASE ERRORCCB002
     C***U8******          GOTO END                                       CCB002
     C**
     C*****ADJUST BALANCES.                                               CCB002
     C***********          MOVE PRAM      PRAM0  130                      CCB002
     C***********GRBL      SUB  PRAM0     GRBL                            CCB002
     C***********NETB      SUB  PRAM0     NETB                            CCB002
     C**                                                                  S01154
     C**  FOR AMEND,OUTPUT OLD DEBIT ACCOUNT RECORD TO RSACMTPD.          S01154
     C**                                                                  S01154
      *                                                                   209995
      ** Check if account is Nostro, if so, updating will be done         209995
      ** in the #NOST subroutine.                                         209995
      *                                                                   209995
     C                     MOVE DCUS      A7CUST                          209995
     C                     MOVE CCYST     A7CYCD                          209995
     C                     MOVE DACD      A7ACCD                          209995
     C                     MOVE DACS      A7ACSN                          209995
      *                                                                   209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
      *                                                                   209995
     C                     SETON                     4284                 S01154
     C**
     C**  UPDATE MEMO FILE                                                E10048
     C                     SETON                     67                   E10048
     C                     EXSR RELESE                                    E10048
     C**
     C           TAG32     TAG                             ** TAG32 TAG **
     C**
     C           ATYPDB    COMP 'R'                      81
     C/COPY WNCPYSRC,RE0253C005
     C  N81                GOTO TAG33                      -NEW A/C NOT A
     C*                                                                   E49677
     C* BYPASS IF NEW AMT NOT VALUED TODAY                                E49677
     C***********NXTPSF    COMP RUND                 81             E49677CCB002
     C***81******          GOTO TAG33                               E49677CCB002
     C**                                                    RETAIL A/C.
      *                                                                   CCB002
      **   Set up parameters for call to access object AOMEMSU0.          CCB002
      **   (Add in the new amount)                                        CCB002
      ** Use the Full account code from the screen when retail            209995
      ** account codes are not being used.                                209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C                     Z-ADD*ZEROS    W0RETL                          CCB002
     C                     MOVE ZCNUMD    W0CNUM                          CCB002
     C                     MOVE CCYSF     W0CUCD                          CCB002
     C                     MOVE ZACODD    W0ACCD                          CCB002
     C                     MOVE ZACSQD    W0ACSQ                          CCB002
     C                     MOVE ZBRCDD    W0BRCA                          CCB002
     C                     ELSE                                           209995
     C                     Z-ADD*ZEROS    W0RETL                          209995
     C                     MOVE DCUSSF    W0CNUM                          209995
     C                     MOVE CCYSF     W0CUCD                          209995
     C                     MOVE ACODDR    W0ACCD                          209995
     C                     MOVE DACSSF    W0ACSQ                          209995
     C                     MOVE DBRCSF    W0BRCA                          209995
     C                     ENDIF                                          209995
     C           NXAM      MULT 1000      W0AMT                           CCB002
     C                     Z-ADDNXTPSF    W0PSTD                          CCB002
     C                     Z-ADDNXTPSF    W0VDAT                          CCB002
     C**                                                                  CCB002
     C*****CHAIN*TO*MEMO*FILE FOR NEW RETAIL ACCOUNT.                     CCB002
     C***********          MOVE DRRNSF    MEMKEY                          CCB002
     C                     EXSR MEMCHN
     C**
     C**   MEMO RECORD NOT FOUND.
     C**N08******          SETON                     U883  -DATABASE ERRORCCB002
     C***U8******          GOTO END                                       CCB002
     C*                                                                   CCB002
     C**
     C*****ADJUST*BALANCES.                                               CCB002
     C***********          EXSR NXAMAD                                    CCB002
     C**                                                                  S01154
     C**   FOR AMEND,OUTPUT NEW DEBIT ACCOUNT RECORD TO RSACMTPD.         S01154
     C**                                                                  S01154
      *                                                                   209995
      ** Check if account is Nostro, if so, updating will be done         209995
      ** in the #NOST subroutine.                                         209995
      *                                                                   209995
     C                     MOVE DCUSSF    A7CUST                          209995
     C                     MOVE CCYSF     A7CYCD                          209995
     C                     MOVE ACODDR    A7ACCD                          209995
     C                     MOVE DACSSF    A7ACSN                          209995
      *                                                                   209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
      *                                                                   209995
     C   33                SETON                     4288                 S01154
     C**
     C   33                SETON                     67    -UPDATE MEMO
     C   33                EXSR RELESE                      ONLY.
     C   33                GOTO TAG33
     C**
     C**   FOR AMEND,OUTPUT NEW DEBIT ACCOUNT RECORD TO RSACMTPD.         S01154
     C**                                                                  S01154
     C                     SETON                     4288                 S01154
     C**                                                                  S01154
     C                     SETON                     6741
     C                     EXSR RELESE
     C**
     C           TAG33     TAG                             ** TAG33 TAG **
     C**
     C**   CREDIT - BYPASS IF A/C AND AMT.UNCHANGED OR IF NOT A RETAIL A/C
     C           ATYPCR    COMP 'R'                      81
     C/COPY WNCPYSRC,RE0253C006
     C*                                                                   E49677
     C* BYPASS IF OLD AMT NOT VALUED TODAY                                E49677
      *                                                                   CRE009
      ** If CRE009 is ON, only bypass if old amt valued after REPMED      CRE009
      ** in REPMFWPD for the currency.                                    CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C                     MOVE *IN14     SAV14                           CRE009
     C           CCYST     CHAINREPMFWL1             14                   CRE009
     C           *IN14     IFEQ *ON                                       CRE009
     C                     MOVEL'RE0253 ' DBPGM                           CRE009
     C                     MOVEL'REPMFWPD'DBFILE           ************   CRE009
     C                     MOVELCCYST     DBKEY            * DBERR 09 *   CRE009
     C                     Z-ADD09        DBASE            ************   CRE009
     C                     OUT  LDA                                       CRE009
     C                     EXSR *PSSR                                     CRE009
     C                     SETON                     U7U8LR               CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV14     *IN14                           CRE009
     C           NXTP      COMP REPMED                 8989               CRE009
     C                     ELSE                                           CRE009
     C           NXTP      COMP RUND                   8989               E49677
     C                     ENDIF                                          CRE009
     C   89 81             GOTO TAG33A                                    E49677
     C*                                                                   E49677
     C   34 35
     CORN89                                                               E49677
     COR 34N81             GOTO TAG34                                     E49677
     C*R 34N81             GOTO TAG35                                     E49677
     C*                                                                   E49677
     C           TAG33A    TAG                             *** TAG33A *** E49677
     C*                                                                   E49677
     C                     SETOF                     89                   E49677
     C**
      ** Process if account is Retail.                                    209995
      *                                                                   209995
     C***********CRAC      COMP ZERO10                   81-OLD A/C NOT A 117784
     C********** CRACO     COMP ZERO10            81-OLD A/C NOT A 117784 209995
     C           ATYPCR    COMP 'R'                  8181  -Old A/C not   209995
     C   81                GOTO TAG34                       RETAIL A/C
     C**
     C**   OBTAIN MEMO RRN FOR OLD RETAIL A/C.
     C***********          MOVE CRAC      KEY10                           117784
     C                     MOVE CRACO     KEY10                           117784
     C***********          EXSR ACNCHN                                    CCB002
     C**N13******          SETON                     U883  -DATABASE ERRORCCB002
     C***U8******          GOTO END                                       CCB002
     C***********          EXSR ACFILL                                    CCB002
     C***********          EXSR ACCCHN                                    CCB002
     C**N12******          SETON                     U883  -DATABASE ERRORCCB002
     C***U8******          GOTO END                                       CCB002
      *
      **   Set up parameters for call to access object AOMEMSU0.          CCB002
      **   (Subtract the original amount)                                 CCB002
      ** Use the Full account code from the screen when retail            209995
      ** account numbers are not being used.                              209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C                     Z-ADDCRAC      W0RETL                          CCB002
     C**********           Z-ADD*ZEROS    W0CNUM                                       CCB002 CSD027
     C                     MOVE *BLANKS   W0CNUM                                              CSD027
     C                     MOVE *BLANKS   W0CUCD                          CCB002
     C                     Z-ADD*ZEROS    W0ACCD                          CCB002
     C                     Z-ADD*ZEROS    W0ACSQ                          CCB002
     C                     MOVE *BLANKS   W0BRCA                          CCB002
     C                     ELSE                                           209995
     C                     Z-ADD*ZEROS    W0RETL                          209995
     C**********           Z-ADDCCUS      W0CNUM                                       209995 CSD027
     C                     MOVE CCUS      W0CNUM                                              CSD027
     C                     MOVE CCYST     W0CUCD                          209995
     C                     Z-ADDCACD      W0ACCD                          209995
     C                     Z-ADDCACS      W0ACSQ                          209995
     C                     MOVE BRCDC     W0BRCA                          209995
     C                     ENDIF                                          209995
     C           PRAM      MULT 1000      W0AMT                           CCB002
     C                     Z-ADDNXTP      W0PSTD                          CCB002
     C                     Z-ADDNXTP      W0VDAT                          CCB002
     C***********          Z-ADDRRNM      CRRN    50                      CCB002
      *                                                                   CCB002
     C**
     C*****CHAIN*TO*MEMO*FILE.                                            CCB002
     C***********          MOVE CRRN      MEMKEY                          CCB002
      *
      ** Only access MEMOS file if NXTP is before or equal to the run     CRE009
      ** date.                                                            CRE009
     C           CRE009    IFEQ 'N'                                       CRE009
     C           CRE009    OREQ 'Y'                                       CRE009
     C           NXTP      ANDLERUND                                      CRE009
     C                     EXSR MEMCHN
     C                     ENDIF                                          CRE009
     C**
     C**   MEMO RECORD NOT FOUND
     C**N08******          SETON                     U883  -DATABASE ERRORCCB002
     C***U8******          GOTO END                                       CCB002
     C*                                                                   CCB002
     C**
     C*****ADJUST*BALANCES.                                               CCB002
     C***********          MOVE PRAM      PRAM0  130                      CCB002
     C***********GRBL      ADD  PRAM0     GRBL                            CCB002
     C***********NETB      ADD  PRAM0     NETB                            CCB002
     C**
     C**   LOGGING NOT REQD IF ALREADY PERFORMED.
     C***********CRAC      COMP DRAC                     81               117784
     C***********          MOVE CRAC      WRK3                            117784
      *                                                                   209995
      ** If the Retail account numbers are not being used, use            209995
      ** the Full account code in the comparison.                         209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C           CRACO     COMP DRAC                     81               117784
     C                     MOVE CRACO     WRK3                            117784
     C  N81      WRK3      COMP DRACSF                   81
     C                     ELSE                                           209995
     C           OCAKEY    COMP ODAKEY                   81               209995
     C           *IN81     IFEQ '0'                                       209995
     C           OCAKEY    COMP NDAKEY                   81               209995
     C                     ENDIF                                          209995
     C                     ENDIF                                          209995
     C**                                                                  S01154
     C**   FOR AMEND,OUTPUT OLD CREDIT ACCOUNT RECORD TO RSACMTPD.        S01154
     C**                                                                  S01154
      *                                                                   209995
      ** Check if account is Nostro, if so, updating will be done         209995
      ** in the #NOST subroutine.                                         209995
      *                                                                   209995
     C                     MOVE CCUS      A7CUST                          209995
     C                     MOVE CCYST     A7CYCD                          209995
     C                     MOVE CACD      A7ACCD                          209995
     C                     MOVE CACS      A7ACSN                          209995
      *                                                                   209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
      *                                                                   209995
     C   81                SETON                     8084                 S01154
     C**                                                                  S01154
     C   81                SETON                     67    -UPDATE MEMO
     C   81                EXSR RELESE                      ONLY.
     C   81                GOTO TAG34
     C**
     C**   FOR AMEND,OUTPUT OLD CREDIT ACCOUNT RECORD TO RSACMTPD.        S01154
     C**                                                                  S01154
     C                     SETON                     8084                 S01154
     C**                                                                  S01154
     C                     SETON                     67
     C                     EXSR RELESE
     C**
     C           TAG34     TAG                             ** TAG34 TAG **
     C**
     C           ATYPCR    COMP 'R'                      81
     C/COPY WNCPYSRC,RE0253C007
     C  N81                GOTO TAG35                      -NEW A/C NOT A
     C**                                                    RETAIL A/C
     C**BYPASS*IF NEW AMT NOT VALUED TODAY                          E49677CCB002
     C*********  NXTPSF    COMP RUND                 81             E49677CCB002
     C***81***             GOTO TAG35                               E49677CCB002
     C*                                                             E49677CCB002
      **   Set up parameters for call to access object AOMEMSU0.          CCB002
      **   (Add in the new amount)                                        CCB002
      ** Use the Full account code from the screen when retail            209995
      ** account numbers are not being used.                              209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C                     Z-ADD*ZEROS    W0RETL                          CCB002
     C                     MOVE ZCNUMC    W0CNUM                          CCB002
     C                     MOVE CCYSF     W0CUCD                          CCB002
     C                     MOVE ZACODC    W0ACCD                          CCB002
     C                     MOVE ZACSQC    W0ACSQ                          CCB002
     C                     MOVE ZBRCDC    W0BRCA                          CCB002
     C                     ELSE                                           209995
     C                     Z-ADD*ZEROS    W0RETL                          209995
     C                     MOVE CCUSSF    W0CNUM                          209995
     C                     MOVE CCYSF     W0CUCD                          209995
     C                     MOVE ACODCR    W0ACCD                          209995
     C                     MOVE CACSSF    W0ACSQ                          209995
     C                     MOVE CBRCSF    W0BRCA                          209995
     C                     ENDIF                                          209995
     C           NXAM      MULT 1000      W0AMT                           CCB002
     C                     Z-SUBW0AMT     W0AMT                           CCB002
     C                     Z-ADDNXTPSF    W0PSTD                          CCB002
     C                     Z-ADDNXTPSF    W0VDAT                          CCB002
     C**   CHAIN TO MEMO FILE FOR NEW RETAIL ACCOUNT.
     C***********          MOVE CRRNSF    MEMKEY                          CCB002
     C                     EXSR MEMCHN
     C**
     C**   MEMO RECORD NOT FOUND.
     C**N08******          SETON                     U883  -DATABASE ERRORCCB002
     C***U8******          GOTO END                                       CCB002
     C*                                                                   CCB002
     C**
     C**   ADJUST BALANCES.
     C************         EXSR NXAMSB                                    CCB002
     C**
     C***********          MOVE DRAC      WRK3                            117784
     C***********CRACSF    COMP WRK3                     81               117784
     C**N81******CRACSF    COMP DRACSF                   81               117784
      *                                                                   209995
      ** If Retail account numbers are not being used, use the            184635
      ** Full account code in the comparison.                             209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C           CRACN     COMP DRAC                     81               117784
     C                     MOVE CRACN     WRK3                            117784
     C  N81      WRK3      COMP DRACSF                   81               117784
     C                     ELSE                                           209995
     C           NCAKEY    COMP ODAKEY                   81               209995
     C           *IN81     IFEQ '0'                                       209995
     C           NCAKEY    COMP NDAKEY                   81               209995
     C                     ENDIF                                          209995
     C                     ENDIF                                          209995
     C   34                SETON                         81
     C**                                                                  S01154
     C**   FOR AMEND,OUTPUT NEW CREDIT ACCOUNT RECORD TO RSACMTPD.        S01154
     C**                                                                  S01154
      *                                                                   209995
      ** Check if account is Nostro, if so, updating will be done         209995
      ** in the #NOST subroutine.                                         209995
      *                                                                   209995
     C                     MOVE CCUSSF    A7CUST                          209995
     C                     MOVE CCYSF     A7CYCD                          209995
     C                     MOVE ACODCR    A7ACCD                          209995
     C                     MOVE CACSSF    A7ACSN                          209995
      *                                                                   209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
      *                                                                   209995
     C   81                SETON                     8088                 S01154
     C**                                                                  S01154
     C   81                SETON                     67    -UPDATE MEMO
     C   81                EXSR RELESE                      ONLY.
     C   81                GOTO TAG35
     C**                                                                  S01154
     C**   FOR AMEND,OUTPUT NEW CREDIT ACCOUNT RECORD TO RSACMTPD.        S01154
     C**                                                                  S01154
     C                     SETON                     8088                 S01154
     C**                                                                  S01154
     C                     SETON                     67
     C                     EXSR RELESE
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0253CCAU                                           S01408
     C*                                                                   S01408
     C**
     C           TAG35     TAG                             ** TAG35 TAG **
      *                                                                   209995
      ** Update projected nostro balances if required                     209995
      *                                                                   209995
     C                     EXSR #NOST                                     209995
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CCA1                                           S01408
     C                     MOVE 0         CTR     10                      109434
     C           *IN03     IFEQ '1'                                       109434
     C           CTR       DOWLE1                                         109434
     C           CTR       IFEQ 0                                         109434
     C                     MOVE DRBRCD    #BRCA                           109434
     C**********           MOVE ZCNUMD    CNUMX   60                                   109434 CSD027
     C                     MOVE ZCNUMD    CNUMX   6                                           CSD027
     C**********           MOVE ZACODD    ACODX   40                                   109434 CGL029
     C                     MOVE ZACODD    ACODX  100                                          CGL029
     C                     MOVE ZACSQD    ACSQX   20                      109434
     C                     MOVE CNUMX     #CUSN                           109434
     C                     MOVE CCYAC     #CCYD                           109434
     C                     MOVE ACODX     #ACDE                           109434
     C                     MOVE ACSQX     #ASNC                           109434
     C                     ELSE                                           109434
     C           CTR       IFEQ 1                                         109434
     C                     MOVE CRBRCD    #BRCA                           109434
     C                     MOVE ZCNUMC    CNUMX                           109434
     C                     MOVE ZACODC    ACODX                           109434
     C                     MOVE ZACSQC    ACSQX                           109434
     C                     MOVE CNUMX     #CUSN                           109434
     C                     MOVE CCYAC     #CCYD                           109434
     C                     MOVE ACODX     #ACDE                           109434
     C                     MOVE ACSQX     #ASNC                           109434
     C                     ENDIF                                          109434
     C                     ENDIF                                          109434
     C                     MOVE *IN10     SVIND   1                       109434
     C                     MOVE '1'       *IN10                           109434
     C           RKEY      SETLLRSACMTPX                 10               109434
     C           *IN10     IFEQ '1'                                       109434
     C                     SETOF                     10                   109434
     C           *IN10     DOWEQ'0'                                       109434
     C           RKEY      READERSACMTPX                 10               109434
     C           *IN10     IFEQ '0'                                       109434
     C                     MOVE STOR      STORX   6 P                     109434
     C           #TNMR     IFEQ STORX                                     109434
     C           PNARSF    IFEQ *BLANKS                                   109434
     C                     MOVEL'S/O'     NRTDX   9 P                     109434
     C                     MOVE STOR      NRTDX                           109434
     C                     MOVELNRTDX     PNARSF                          109434
     C                     ENDIF                                          109434
      *                                                                                       CRE020
      ** Make sure that the posting narrative is updated properly.                            CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C                     MOVELPNARSF    WPNAR  28                                           CRE020
     C                     MOVELWPNAR     #NRTD                                               CRE020
     C                     ELSE                                                               CRE020
     C                     MOVELPNARSF    #NRTD                           109434
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     UPDATRSACMTPX                                  109434
     C                     ENDIF                                          109434
     C                     ELSE                                           109434
     C                     LEAVE                                          109434
     C                     ENDIF                                          109434
     C                     ENDDO                                          109434
     C                     ENDIF                                          109434
     C                     MOVE SVIND     *IN10                           109434
     C                     ADD  1         CTR                             109434
     C                     ENDDO                                          109434
     C                     ENDIF                                          109434
     C*                                                                   S01408
     C**
     C**   UPDATE STAND DETAIL RECORD
     C**
     C                     SETON                     74
     C                     EXSR TIME
     C                     EXSR RELESE
     C/COPY WNCPYSRC,RE0253C024
     C**
     C**   CHAIN TO STAND TRAILER
     C                     MOVE '99999'   STNKEY
     C                     EXSR STNCHN
     C**
     C**   STAND TRAILER NOT FOUND.
     C  N07                SETON                     U883  -DATABASE ERROR
     C   U8                GOTO END
     C**
     C**   SET UP UPDATED CONTROL TOTALS.
     C   03                GOTO TAG24                      -AMENDMENT.
     C   04                GOTO TAG25                      -DELETION.
     C**
     C**   NUMBER OF S/O INSERTED.
     C           NSOI      ADD  1         NSOI
     C**
     C**   VALUE OF S/O INSERTED.
     C           AFPYSF    ADD  ASPYSF    WORK   150
     C           WORK      ADD  ALPYSF    WORK
     C                     MOVE WORK      ZZAMT
     C                     Z-ADDVSIW      ZZTOTI
     C                     Z-ADDVSID      ZZTOTD
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    VSIW
     C                     Z-ADDZZTOTD    VSID
     C**
     C**   NUMBER OF S/O AFTER UPDATE.
     C           NSAU      ADD  1         NSAU
     C**
     C                     GOTO TAG26                      -BYPASS A, D.
     C**
     C           TAG24     TAG                             ** TAG24 TAG **
     C**
     C**   NUMBER OF S/O AMENDED.
     C           NSOA      ADD  1         NSOA
     C**
     C**   VALUE OF S/O AMENDED.
     C           AFPYSF    SUB  AFPY      WRK1   150
     C           ASPYSF    SUB  ASPY      WRK2   150
     C           ALPYSF    SUB  ALPY      WORK
     C           WORK      ADD  WRK1      WRK1
     C           WRK1      ADD  WRK2      WRK2
     C                     MOVE WRK2      ZZAMT
     C**
     C                     Z-ADDVSAW      ZZTOTI
     C                     Z-ADDVSAD      ZZTOTD
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    VSAW
     C                     Z-ADDZZTOTD    VSAD
     C**
     C                     GOTO TAG26                      -BYPASS D CALCS
     C**
     C           TAG25     TAG                             ** TAG25 TAG **
     C**
     C**   NUMBER OF S/O DELETED
     C           NSOD      ADD  1         NSOD
     C**
     C**   VALUE OF S/O DELETED.
     C           AFPY      ADD  ASPY      WORK
     C           WORK      ADD  ALPY      ALPY
     C                     MOVE ALPY      ZZAMT
     C                     Z-ADDVSDW      ZZTOTI
     C                     Z-ADDVSDD      ZZTOTD
     C                     EXSR GLZADD
     C                     Z-ADDZZTOTI    VSDW
     C                     Z-ADDZZTOTD    VSDD
     C**
     C**   NUMBER OF S/O AFTER UPDATE
     C           NSAU      SUB  1         NSAU
     C**
     C           TAG26     TAG                             ** TAG26 TAG **
     C**
     C**   VALUE OF S/O AFTER UPDATE.
     C                     Z-ADDVSUW      ZZTOTI
     C                     Z-ADDVSUD      ZZTOTD
     C  N04                EXSR GLZADD
     C   04                EXSR GLZSUB
     C                     Z-ADDZZTOTI    VSUW
     C                     Z-ADDZZTOTD    VSUD
     C**
     C**   UPDATE STAND TRAILER
     C                     SETON                     75
     C                     SETON                     81
     C                     EXSR RELESE
     C**
     C**   SUCCESSFUL RETURN CODE - SETON 80.
     C                     SETON                     80
     C**
     C**   END COMMITMENT CONTROL
     C           CMTTXT    COMIT
     C**
     C  N80                GOTO SETSF
     C**
     C**   OUTPUT INITIAL SCREEN
     C                     MOVE 'SF'      SFCODE
     C                     MOVE '     '   STORSF
     C                     MOVE ' '       ACTION
     C                     SETOF                     44
     C                     SETON                     15
     C                     SETOF                     62
     C***********          SETON                     1416                 S01117
     C                     SETON                     616471
     C***********          SETON                     87                   S01117
     C**
     C           SETSF     TAG                             ** SETSF TAG **
     C**
     C**   SET DISPLAY INDICATOR FOR ERROR CODES
     C           X         COMP 00                     4141
     C                     SETON                     17
     C**********           SETOF                     18                                       CRE020
     C                     MOVE '0'       WIN18   1                                           CRE020
     C   39
     CAN 01N83 62          SETOF                     17
     C***39*****                                                                              CRE020
     C***AN*01N83 62          SETON                     18                                    CRE020
      *                                                                                       CRE020
     C           *IN39     IFEQ *ON                                                           CRE020
     C           *IN01     ANDEQ*ON                                                           CRE020
     C           *IN83     ANDEQ*OFF                                                          CRE020
     C           *IN62     ANDEQ*ON                                                           CRE020
     C                     MOVE '1'       WIN18                                               CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C   KJN04             SETOF                     41
     C**
     C                     EXSR TIME
     C/COPY WNCPYSRC,RE0253C022
     C**
     C           END       TAG                             **  END TAG  **
     C   KC
     COR U8                SETON                     LR
     C   LR                RETRN
      *****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRWTCH - Set-up parameters for compliance engine program and *                       CSD015
      *           sends transaction details by calling SDWLCLOP.      *                       CSD015
      *                                                               *                       CSD015
      *  Called From : MAIN, RELESE                                   *                       CSD015
      *  Calls       : SDWLCLOP                                       *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRWTCH    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Initialise then set-up 1st parameter for SDWLCLOP                                    CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   SDWLTO                                              CSD015
      *                                                                                       CSD015
     C                     MOVEL'RESORD'  W4ITEM                                              CSD015
     C                     MOVELHELDSF    W4IDEN                                              CSD015
     C                     MOVELBRCASF    W4BRCH                                              CSD015
     C                     MOVEL'STANDSB' W4FUNT                                              CSD015
      *                                                                                       CSD015
     C           CSC011    IFEQ 'Y'                                                           CSD015
     C                     MOVELS1MAIN    W4SYSM                                              CSD015
     C                     ELSE                                                               CSD015
     C                     MOVELLIBR      W4SYSM                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     Z-ADD0         W4DDAT                                              CSD015
     C                     Z-ADD0         W4MDAT                                              CSD015
     C                     MOVEL*BLANKS   W4DEN2                                              CSD015
     C                     Z-ADD0         W4AMT2                                              CSD015
      *                                                                                       CSD015
     C                     Z-ADDDFPYSF    W4VDAT                                              CSD015
     C                     MOVELCCYSF     W4DEN1                                              CSD015
     C                     Z-ADDAFPYSF    W4AMT1                                              CSD015
      *                                                                                       CSD015
      ** Access customer details for credit account                                           CSD015
      *                                                                                       CSD015
     C                     MOVELZCNUMD    CUSKEY                                              CSD015
     C                     CALL 'AOCUSTR0'PLISTA                                              CSD015
      *                                                                                       CSD015
      ** If return code not blank nor *NRF, then issue database error                         CSD015
      *                                                                                       CSD015
     C           RTCD      IFNE *BLANKS                                                       CSD015
     C           RTCD      ANDNE'*NRF   '                                                     CSD015
     C                     MOVELCUSKEY    DBKEY                                               CSD015
     C                     MOVE 'SDCUSTPD'DBFILE                                              CSD015
     C                     Z-ADD12        DBASE                                               CSD015
     C                     OUT  LDA                                                           CSD015
     C                     EXSR *PSSR                                                         CSD015
     C                     SETON                     U7U8LR                                   CSD015
     C                     GOTO ENDWTC                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** If return code is blank, process counterparty details of 1st                         CSD015
      ** parameter                                                                            CSD015
      *                                                                                       CSD015
     C           RTCD      IFEQ *BLANKS                                                       CSD015
     C           CCF001    IFEQ 'Y'                                                           CSD015
     C           BBCRPC    IFEQ 'Y'                                                           CSD015
     C                     MOVE 'C'       W4CTYP                                              CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'I'       W4CTYP                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ELSE                                                               CSD015
     C           BBLICD    IFNE *BLANKS                                                       CSD015
     C           BBLICD    ANDNEW1IND1                                                        CSD015
     C           BBLICD    ANDNEW1IND2                                                        CSD015
     C           BBLICD    ANDNEW1IND3                                                        CSD015
     C           BBLICD    ANDNEW1IND4                                                        CSD015
     C           BBLICD    ANDNEW1IND5                                                        CSD015
     C                     MOVE 'C'       W4CTYP                                              CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE 'I'       W4CTYP                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C           BBCRNM    CAT  BBCRTN    W4CUST                                              CSD015
     C                     MOVELBBCUST    W4CNUM                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Initialise then set-up 2nd parameter for SDWLCLOP                                    CSD015
     C                     MOVE *BLANKS   PXML                                                CSD015
     C                     MOVE *BLANKS   PWLOUT216                                           CSD015
     C                     Z-ADD1         WX      10                                          CSD015
     C                     Z-ADD7         WY      10                                          CSD015
      *                                                                                       CSD015
     C           WX        DOUGTWY                                                            CSD015
      *                                                                                       CSD015
     C           WLF,WX    IFNE *BLANKS                                                       CSD015
      *                                                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM WLF,WX    PWLIN1 35                                           CSD015
     C                     PARM *BLANKS   PWLIN2 35                                           CSD015
     C                     PARM *BLANKS   PWLIN3 35                                           CSD015
     C                     PARM *BLANKS   PWLIN4 35                                           CSD015
     C                     PARM *BLANKS   PWLIN5 35                                           CSD015
     C                     PARM *BLANKS   PWLIN6 35                                           CSD015
     C                     PARM *BLANKS   PCCY    3                                           CSD015
     C                     PARM *BLANKS   PWLOUT                                              CSD015
     C                     PARM *BLANKS   PWLOP2  6                                           CSD015
      *                                                                                       CSD015
     C           PWLOUT    IFNE *BLANKS                                                       CSD015
     C                     CAT  XOT,WX:0  PXML                                                CSD015
     C                     CAT  PWLOUT:0  PXML                                                CSD015
     C                     CAT  XCT,WX:0  PXML                                                CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDIF                                                              CSD015
     C                     ADD  1         WX                                                  CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
      ** Process watch list field Payee bank                                                  CSD015
      *                                                                                       CSD015
     C           WLF,8     IFNE *BLANKS                                                       CSD015
     C           WLF,9     ORNE *BLANKS                                                       CSD015
      *                                                                                       CSD015
     C                     CALL 'SDCWLFMT'                                                    CSD015
     C                     PARM *BLANKS   @RTCD                                               CSD015
     C                     PARM WLF,8     PWLIN1 35                                           CSD015
     C                     PARM WLF,9     PWLIN2 35                                           CSD015
     C                     PARM *BLANKS   PWLIN3 35                                           CSD015
     C                     PARM *BLANKS   PWLIN4 35                                           CSD015
     C                     PARM *BLANKS   PWLIN5 35                                           CSD015
     C                     PARM *BLANKS   PWLIN6 35                                           CSD015
     C                     PARM *BLANKS   PCCY    3                                           CSD015
     C                     PARM *BLANKS   PWLOUT                                              CSD015
     C                     PARM *BLANKS   PWLOP2  6                                           CSD015
      *                                                                                       CSD015
     C           PWLOUT    IFNE *BLANKS                                                       CSD015
     C                     CAT  XOT,8:0   PXML                                                CSD015
     C                     CAT  PWLOUT:0  PXML                                                CSD015
     C                     CAT  XCT,8:0   PXML                                                CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PXML      IFNE *BLANKS                                                       CSD015
     C                     CALL 'SDWLCLOP'                                                    CSD015
     C                     PARM           SDWLTO                                              CSD015
     C                     PARM           PXML                                                CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           ENDWTC    ENDSR                                                              CSD015
      *                                                                                       CSD015
     C*****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
      *                                                               *                       CSD015
      *  SRCCHK - Check conditions before calling SRWTCH when         *                       CSD015
      *           doing amendments to standing order details.         *                       CSD015
      *                                                               *                       CSD015
      *  Called From : MAIN, RELESE                                   *                       CSD015
      *  Calls       : SRWTCH                                         *                       CSD015
      *                                                               *                       CSD015
      *****************************************************************                       CSD015
      *                                                                                       CSD015
     C           SRCCHK    BEGSR                                                              CSD015
      *                                                                                       CSD015
      ** Set up KLIST fields for accessing compliance watch hit list                          CSD015
      ** to check for hit status                                                              CSD015
      *                                                                                       CSD015
     C                     MOVEL'STANDSB 'KFUNT                                               CSD015
     C                     MOVELSTOR      KIDEN                                               CSD015
     C                     MOVELBRCA      KBRCH                                               CSD015
      *                                                                                       CSD015
     C                     MOVEA*BLANKS   WLF,1                                               CSD015
     C                     MOVE 'N'       WCWFLG  1                                           CSD015
      *                                                                                       CSD015
      ** Check status of item in compliance watch hit list                                    CSD015
      *                                                                                       CSD015
     C           KCWHTL    CHAINSDCWHTL1             81                                       CSD015
      *                                                                                       CSD015
      ** For UNCONFIRMED statuses, send all watch list fields that are                        CSD015
      ** not blank                                                                            CSD015
      *                                                                                       CSD015
     C           *IN81     IFEQ *OFF                                                          CSD015
     C           W3UNCF    ANDEQ'Y'                                                           CSD015
      *                                                                                       CSD015
     C                     MOVE ZACSQD    WSEQ                                                CSD015
     C                     CAT  ZCNUMD:0  WLF,1                                               CSD015
     C                     CAT  CCYSF:0   WLF,1                                               CSD015
     C                     CAT  ZACODD:0  WLF,1                                               CSD015
     C                     CAT  WSEQ:0    WLF,1                                               CSD015
     C                     CAT  ODBRC:0   WLF,1                                               CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   WSEQ                                                CSD015
     C                     MOVE ZACSQC    WSEQ                                                CSD015
     C                     CAT  ZCNUMC:0  WLF,2                                               CSD015
     C                     CAT  CCYSF:0   WLF,2                                               CSD015
     C                     CAT  ZACODC:0  WLF,2                                               CSD015
     C                     CAT  WSEQ:0    WLF,2                                               CSD015
     C                     CAT  BRCASF:0  WLF,2                                               CSD015
      *                                                                                       CSD015
     C                     MOVELDRACSF    WLF,3                                               CSD015
     C                     MOVELCRACSF    WLF,4                                               CSD015
     C                     MOVELPAYEE     WLF,5                                               CSD015
     C                     MOVELPAYRSF    WLF,6                                               CSD015
     C                     MOVELPAYASF    WLF,7                                               CSD015
      *                                                                                       CSD015
      ** Note: Payee bank is made up of the following 2 fields                                CSD015
      *                                                                                       CSD015
     C                     MOVELPYB1SF    WLF,8                                               CSD015
     C                     MOVELPYB2SF    WLF,9                                               CSD015
      *                                                                                       CSD015
     C                     Z-ADD9         WY                                                  CSD015
     C                     Z-ADD1         WX                                                  CSD015
      *                                                                                       CSD015
     C           WX        DOUGTWY                                                            CSD015
     C           WCWFLG    OREQ 'Y'                                                           CSD015
     C           WLF,WX    IFNE *BLANKS                                                       CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ADD  1         WX                                                  CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
      ** Otherwise, send only watch list fields that have changed and                         CSD015
      ** are not blank                                                                        CSD015
      *                                                                                       CSD015
     C                     ELSE                                                               CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   WSEQ    2                                           CSD015
     C                     MOVE *BLANKS   WDACNT 35                                           CSD015
     C                     MOVE *BLANKS   WDCUS   6                                           CSD015
     C**********           MOVE *BLANKS   WDACD   4                                    CSD015 CGL029
     C                     MOVE *BLANKS   WDACD  10                                           CGL029
     C                     MOVE *BLANKS   WDACS   2                                           CSD015
     C                     MOVE *BLANKS   WCACNT 35                                           CSD015
     C                     MOVE *BLANKS   WCCUS   6                                           CSD015
     C**********           MOVE *BLANKS   WCSCA   4                                    CSD015 CGL029
     C                     MOVE *BLANKS   WCSCA  10                                           CGL029
     C                     MOVE *BLANKS   WCACD   2                                           CSD015
     C                     MOVE *BLANKS   WDRAN  10                                           CSD015
     C                     MOVE *BLANKS   WCRAN  10                                           CSD015
      *                                                                                       CSD015
     C                     MOVE ZACSQD    WSEQ                                                CSD015
     C                     CAT  ZCNUMD:0  WLF,1                                               CSD015
     C                     CAT  CCYSF:0   WLF,1                                               CSD015
     C                     CAT  ZACODD:0  WLF,1                                               CSD015
     C                     CAT  WSEQ:0    WLF,1                                               CSD015
     C                     CAT  ODBRC:0   WLF,1                                               CSD015
     C                     MOVE DCUS      WDCUS                                               CSD015
     C                     MOVE DACD      WDACD                                               CSD015
     C                     MOVE DACS      WDACS                                               CSD015
     C                     CAT  WDCUS:0   WDACNT                                              CSD015
     C                     CAT  CCY:0     WDACNT                                              CSD015
     C                     CAT  WDACD:0   WDACNT                                              CSD015
     C                     CAT  WDACS:0   WDACNT                                              CSD015
     C                     CAT  BRCDD:0   WDACNT                                              CSD015
     C           WLF,1     IFNE WDACNT                                                        CSD015
     C           WLF,1     ANDNE*BLANKS                                                       CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE *BLANKS   WLF,1                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   WSEQ                                                CSD015
     C                     MOVE ZACSQC    WSEQ                                                CSD015
     C                     CAT  ZCNUMC:0  WLF,2                                               CSD015
     C                     CAT  CCYSF:0   WLF,2                                               CSD015
     C                     CAT  ZACODC:0  WLF,2                                               CSD015
     C                     CAT  WSEQ:0    WLF,2                                               CSD015
     C                     CAT  BRCASF:0  WLF,2                                               CSD015
     C                     MOVE CCUS      WCCUS                                               CSD015
     C                     MOVE CACD      WCSCA                                               CSD015
     C                     MOVE CACS      WCACD                                               CSD015
     C                     CAT  WCCUS:0   WCACNT                                              CSD015
     C                     CAT  CCY:0     WCACNT                                              CSD015
     C                     CAT  WCSCA:0   WCACNT                                              CSD015
     C                     CAT  WCACD:0   WCACNT                                              CSD015
     C                     CAT  TXBRCA:0  WCACNT                                              CSD015
     C           WLF,2     IFNE WCACNT                                                        CSD015
     C           WLF,2     ANDNE*BLANKS                                                       CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ELSE                                                               CSD015
     C                     MOVE *BLANKS   WLF,2                                               CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     MOVELDRAC      WDRAN                                               CSD015
     C           DRACSF    IFNE WDRAN                                                         CSD015
     C           DRACSF    ANDNE*BLANKS                                                       CSD015
     C                     MOVELDRACSF    WLF,3                                               CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     MOVELCRAC      WCRAN                                               CSD015
     C           CRACSF    IFNE WCRAN                                                         CSD015
     C           CRACSF    ANDNE*BLANKS                                                       CSD015
     C                     MOVELCRACSF    WLF,4                                               CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PAYEE     IFNE PNAM                                                          CSD015
     C           PAYEE     ANDNE*BLANKS                                                       CSD015
     C                     MOVELPAYEE     WLF,5                                               CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PAYRSF    IFNE PAYR                                                          CSD015
     C           PAYRSF    ANDNE*BLANKS                                                       CSD015
     C                     MOVELPAYRSF    WLF,6                                               CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PAYASF    IFNE PAYA                                                          CSD015
     C           PAYASF    ANDNE*BLANKS                                                       CSD015
     C                     MOVELPAYASF    WLF,7                                               CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** Note: Payee bank is made up of the following 2 fields                                CSD015
      *                                                                                       CSD015
     C           PYB1SF    IFNE PYB1                                                          CSD015
     C           PYB1SF    ANDNE*BLANKS                                                       CSD015
     C                     MOVELPYB1SF    WLF,8                                               CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C           PYB2SF    IFNE PYB2                                                          CSD015
     C           PYB2SF    ANDNE*BLANKS                                                       CSD015
     C                     MOVELPYB2SF    WLF,9                                               CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** If conditions above are met, check if 24x7 is not installed.                         CSD015
      ** If it is installed, system used should be in the main system.                        CSD015
      *                                                                                       CSD015
     C           WCWFLG    IFEQ 'Y'                                                           CSD015
     C           CSC011    IFNE 'Y'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           S1MAIN    ANDEQLIBR                                                          CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     ENDSR                                                              CSD015
      *                                                                                       CSD015
     C*****************************************************************                       CSD015
      /EJECT                                                                                  CSD015
      *****************************************************************                       CSD015
     C**
     C**   SR. TO CHAIN TO THE STAND FILE.
     C**
     C           STNCHN    BEGSR                           **** STNCHN ***
     C**
     C                     SETOF                     0607
     C           STNKEY    CHAINSTAND                68
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C***********                                                         S01194
     C*****SR.*TO*CHAIN*TO*THE TABLE FILE.                                S01194
     C***********                                                         S01194
     C***********TABCHN    BEGSR                           **** TABCHN ***S01194
     C***********                                                         S01194
     C***********          SETOF                     101176               S01194
     C***********          SETOF                     777879               S01194
     C***********TABKEY    CHAINTABLE                81                   S01194
     C***********                                                         S01194
     C***********          ENDSR                                          S01194
     C***********                                                         S01194
     C********************************************************************
     C**                                                                  E10048
     C**   SR.TO CHAIN TO THE DEBIT AND CREDIT ACCOUNTS IN CASE OF        E10048
     C**            DELETION.                                             E10048
     C**                                                                  E10048
     C           CHACC     BEGSR                           **CHACC BEGSR**E10048
     C  N26                MOVE DRACSF    KEY10                           E10048
     C  N26                EXSR ACNCHN                                    E10048
     C  N26                EXSR ACFILL                                    E10048
     C***26******          EXSR SDFILL                             E10048 117784
     C***31******          EXSR SCFILL                                    117784 209995
     C   26                EXSR SDFILL                                           209995
     C                     EXSR ACCCHN                                    E10048
     C***********          Z-ADDRRNM      DRRNSF                    E10048CCB002
     C                     MOVE ATYP      ATYPDB                          E10048
      *                                                                   CCB002
      ** Set up MEMOS fields.                                             CCB002
     C                     MOVE CNUMAN    ZCNUMD                          CCB002
     C                     MOVE ACODAN    ZACODD                          CCB002
     C                     MOVE ACSQAN    ZACSQD                          CCB002
     C                     MOVE BRCDD     ZBRCDD                          209995
      *                                                                   209995
      ** Do not reset ATYPDB if retail account numbers are not            209995
      ** being used.  This will be used to check if account is            209995
      ** retail.                                                          209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C  N26N13                                                            E10048
     COR 26N12             MOVE ' '       ATYPDB                          E10048
     C                     ENDIF                                          209995
      *                                                                   209995
     C  N31                MOVE CRACSF    KEY10                           E10048
     C  N31                EXSR ACNCHN                                    E10048
     C  N31                EXSR ACFILL                                    E10048
     C***31********        EXSR SDFILL                                    E10048 209995
     C   31                EXSR SCFILL                                    E10048 209995
     C                     EXSR ACCCHN                                    E10048
     C***********          Z-ADDRRNM      CRRNSF                    E10048CCB002
     C                     MOVE ATYP      ATYPCR                          E10048
      *                                                                   CCB002
      ** Set up MEMOS fields.                                             CCB002
     C                     MOVE CNUMAN    ZCNUMC                          CCB002
     C                     MOVE ACODAN    ZACODC                          CCB002
     C                     MOVE ACSQAN    ZACSQC                          CCB002
     C                     MOVE BRCDC     ZBRCDC                          209995
      *                                                                   209995
      ** Do not reset ATYPCR if retail account numbers are not            209995
      ** being used.  This will be used to check if account is            209995
      ** retail.                                                          209995
      *                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
     C  N31N13                                                            E10048
     COR 31N12             MOVE ' '       ATYPCR                          E10048
     C                     ENDIF                                          209995
      *                                                                   209995
     C                     ENDSR                                          E10048
     C********************************************************************E10048
     C**
     C**   SR.TO CHAIN TO THE ACNUM FILE.
     C**
     C           ACNCHN    BEGSR                           **** ACNCHN ***
     C**
     C                     SETOF                     13
     C           KEY10     CHAINACNUM                81
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO CHAIN TO THE ACCNT FILE.
     C**
     C           ACCCHN    BEGSR                           **** ACCCHN ***
     C**
     C                     SETOF                     12
     C           ACCKEY    CHAINACCNT                81
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO CHAIN TO THE MEMO FILE.
     C**
     C           MEMCHN    BEGSR                           **** MEMCHN ***
     C**
     C***********          SETOF                     08                   CCB002
      *                                                                   CCB002
      ** Call Access Object AOMEMSUO                                      CCB002
     C                     CALL 'AOMEMSU0'                                CCB002
     C                     PARM *BLANKS   W0RTCD  7        I:Return code  CCB002
     C                     PARM           W0RETL 100       O:Retail A/C NoCCB002
     C**********           PARM           W0CNUM  60       O:Customer No.              CCB002 CSD027
     C                     PARM           W0CNUM  6        O:Customer No.                     CSD027
     C                     PARM           W0CUCD  3        O:Currency     CCB002
     C**********           PARM           W0ACCD  40       O:Account Code              CCB002 CGL029
     C                     PARM           W0ACCD 100                                          CGL029
     C                     PARM           W0ACSQ  20       O:Account Seq. CCB002
     C                     PARM           W0BRCA  3        O:Branch       CCB002
     C                     PARM           W0PSTD  50       O:Posting date CCB002
     C                     PARM           W0VDAT  50       O:Value date   CCB002
     C                     PARM           W0AMT  150       O:Movement amt CCB002
     C                     PARM 'N'       W0FTOV  1        O:FT override  CCB002
      *                                                                   CCB002
     C           @RTCD     IFNE '       '                                 CCB002
     C                     MOVEL'RE0253 ' DBPGM                           CCB002
     C                     MOVEL'MEMOS   'DBFILE           ************   CCB002
     C                     MOVELW0RETL    DBKEY            * DBERR 03 *   CCB002
     C                     MOVELW0CNUM    DBKEY            ************   CCB002
     C                     Z-ADD03        DBASE                           CCB002
     C                     OUT  LDA                                       CCB002
     C                     EXSR *PSSR                                     CCB002
     C                     SETON                     U7U8LR               CCB002
     C                     END                                            CCB002
     C/COPY WNCPYSRC,RE0253C047
     C***********MEMKEY    CHAINMEMO                 81                   CCB002
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR.TO SET UP ACCNT FILE KEY FROM ACNUM FILE.
     C**
     C           ACFILL    BEGSR                           **** ACFILL ***
     C**
     C                     MOVE CNUMAN    KCNUM
     C                     MOVE CCYAN     KCCY
     C                     MOVE ACODAN    KCOD
     C                     MOVE ACSQAN    KACSQ
     C                     MOVE BRCDAN    KBRCD                           S01117
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO SET UP ACCNT FILE KEY FROM SCREEN DEBIT FIELDS.
     C**
     C           SDFILL    BEGSR                           **** SDFILL ***
     C**
     C                     MOVE DCUSSF    KCNUM
     C                     MOVE CCYDR     KCCY
     C                     MOVE ACODDR    KCOD
     C                     MOVE DACSSF    KACSQ
     C********             MOVE ODBRC     KBRCD                           S01117 209995
     C                     MOVE DBRCSF    KBRCD                                  209995
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO SET UP ACCNT FILE KEY FROM SCREEN CREDIT FIELDS.
     C**
     C           SCFILL    BEGSR                           **** SCFILL ***
     C**
     C                     MOVE CCUSSF    KCNUM
     C                     MOVE CCYCR     KCCY
     C                     MOVE ACODCR    KCOD
     C                     MOVE CACSSF    KACSQ
     C***********          MOVE OCBRC     KBRCD                    S01117 117784
     C                     MOVE CBRCSF    KBRCD                           117784
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO VALIDATE CURRENCY CODE.
     C**
     C           CCYCHK    BEGSR                           **** CCYCHK ***
     C**
     C           CCYAC     COMP CCYSF                8181
     C   81      X         ADD  1         X          55
     C   81                MOVE '103'     ERCD,X           -NOT VALID.
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO CHECK NEXT PAYMENT DATE IS COMPATIBLE WITH PAYMENT
     C**       FREQUENCY CODES S, L, B AND A.
     C**
     C           DATCHK    BEGSR                           **** DATCHK ***
     C**
     C**   CHECK FREQUENCY CODE.
     C           PAYFSF    COMP 'S'                      81
     C  N81      PAYFSF    COMP 'L'                      81
     C  N81      PAYFSF    COMP 'B'                      81
     C  N81      PAYFSF    COMP 'A'                      81
     C  N81                GOTO DATEND                     -NOT S,L,B OR A
     C**
     C**   SET ZDAYNO TO A CONVENIENT DAY LESS THAN RUND.
     C           RUND      SUB  31        ZDAYNO
     C                     MOVE CCYSF     ZCCY
     C                     MOVE *BLANKS   ZLOC                            S01195
     C                     MOVE PAYFSF    ZFREQ
     C**
     C           TAGSR1    TAG                             ** TAGSR1 TAG *
     C**
     C***********          EXSR ZFREQS                                    S01195
     C                     EXSR FREQS                                     S01195
     C           PAYFSF    COMP 'A'                      81-FOR ACCRUAL/
     C***81******          MOVE APFQ      ZFREQ             PROFIT DATE.  S01194
     C   81                MOVE BKAPFQ    ZFREQ             PROFIT DATE.  S01194
     C**
     C*****EXSR*ZFREQ AGAIN IF PAYMENT DATE NOT YET REACHED.              S01195
     C**   EXSR FREQS AGAIN IF PAYMENT DATE NOT YET REACHED.              S01195
     C**   SETON 99 IF ERROR.
     C           DAYNO     COMP ZDAYNO               8199
     C   81                GOTO TAGSR1
     C**
     C           DATEND    ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO SET INDICATORS AND X FOR INVALID S/O NUMBER.
     C**
     C           IND01     BEGSR                           **** IND01 ****
     C**
     C                     SETON                       4463
     C           X         ADD  1         X          7165
     C***********          SETON                     87                   S01117
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO SET X AND ERROR CODE FOR INVALID A/C ON ACNUM FILE.
     C**
     C           IND02     BEGSR                           **** IND02 ****
     C**
     C           X         ADD  1         X
     C                     MOVE '017'     ERCD,X           -DOES NOT EXIST
     C                     Z-ADD07        E            65
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO SET X AND ERROR CODES FOR INVALID A/C ON ACCNT FILE.
     C**
     C           IND03     BEGSR                           **** IND03 ****
     C**
     C           X         ADD  1         X
     C                     MOVE '017'     ERCD,X           -DOES NOT EXIST
     C   12                MOVE '086'     ERCD,X           -RECORD CLOSED.
     C                     Z-ADD07        E            65
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**                                                                  047906
     C**                                                                  047906
     C**   SR. TO SET X AND ERROR CODES FOR INVALID A/C ON ACCNT FILE.    047906
     C**   (BLOCKED / BANKRUPT / BAD DEBT)                                047906
     C**                                                                  047906
     C           IND05     BEGSR                           **** IND05 ****047906
     C**                                                                  047906
     C           X         ADD  1         X                               047906
     C                     MOVE '086'     ERCD,X           -RECORD CLOSED.047906
     C                     Z-ADD12        E            65                 047906
     C**                                                                  047906
     C                     ENDSR                                          047906
     C**                                                                  047906
     C********************************************************************047906
     C**
     C**   SR.TO SET PROTECT FIELD INDS. IF PAYMENT DATE HAS BEEN PASSED.
     C**
     C           IND04     BEGSR                           **** IND04 ****
     C**
     C                     SETOF                     71
     C           DFPY      COMP RUND                   71
     C***********DSPY      COMP RUND                   87                 S01117
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO SET UP SCREEN OUTPUT FIELDS.
     C**
     C           SFIELD    BEGSR                           **** SFIELD ***
     C**
     C**   DEBIT ACCOUNT FIELDS.
     C                     MOVE BLNK14    DCUSSC  6
     C********** DCUS      COMP 000000               81                                       CSD027
     C           DCUS      COMP *BLANKS              81                                       CSD027
     C   81                MOVE DCUS      DCUSSC
     C**
     C**********           MOVE BLNK14    DACDSC  4                                           CGL029
     C                     MOVE BLNK14    DACDSC 10                                           CGL029
     C           DACD      COMP 0000                 81
     C   81                MOVE DACD      DACDSC
     C**
     C                     MOVE BLNK14    DACSSC  2
     C           DACS      COMP 00                   81
     C   81                MOVE DACS      DACSSC
     C**
     C                     MOVE BLNK14    DRACSC 10
     C           DRAC      COMP ZERO10               81
     C   81                MOVE DRAC      DRACSC
     C**
     C**   CREDIT ACCOUNT FIELDS.
     C                     MOVE BLNK14    CCUSSC  6
     C********** CCUS      COMP 000000               81                                       CSD027
     C           CCUS      COMP *BLANKS              81                                       CSD027
     C   81                MOVE CCUS      CCUSSC
     C**
     C**********           MOVE BLNK14    CACDSC  4                                           CGL029
     C                     MOVE BLNK14    CACDSC 10                                           CGL029
     C           CACD      COMP 0000                 81
     C   81                MOVE CACD      CACDSC
     C**
     C                     MOVE BLNK14    CACSSC  2
     C           CACS      COMP 00                   81
     C   81                MOVE CACS      CACSSC
     C**
     C                     MOVE BLNK14    CRACSC 10
     C           CRAC      COMP ZERO10               81
     C   81                MOVE CRAC      CRACSC
     C**
     C**   CCY FIELD.
     C                     MOVE BLNK14    DCCYSC  3
     C                     MOVE CCYST     DCCYSC
     C**
     C**   NARRATIVE.
     C                     MOVE BLNK60    PNARSC 30
     C                     MOVE PNAR      PNARSC
     C*                                                                   S01466
     C** Move Transaction Type                                            S01466
     C*                                                                   S01466
     C                     MOVELTRAT      TRATSC  5                       S01466
     C***                                                                 S05452
     C***  MOVE SWIFT COMMON REFERENCE TO OUTPUT FIELD.                   S05452
     C                     MOVE BLNK60    OSWCR  16                       S05452
     C                     MOVE SWCR      OSWCR                           S05452
     C***                                                                 S05452
     C**   PAYMENT FREQUENCY.
     C                     MOVE ' '       PAYFSC  1
     C           PAYF      COMP ' '                  81
     C   81                MOVE PAYF      PAYFSC
     C**
     C**   PAYMENT METHOD.
     C                     MOVE ' '       METHSC  1
     C           METH      COMP ' '                  81
     C   81                MOVE METH      METHSC
     C**
     C**   DATE OF FIRST PAYMENT.
     C                     Z-ADDDFPY      ZDAYNO
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     FDATSC
     C**
     C**   DATE OF SECOND PAYMENT.
     C                     Z-ADDDSPY      ZDAYNO     81
     C   81                EXSR ZDATE2
     C   81                MOVE ZDATE     SDATSC
     C**
     C**   DATE OF FINAL PAYMENT.
     C                     Z-ADDDLPY      ZDAYNO     81
     C   81                EXSR ZDATE2
     C   81                MOVE ZDATE     LDATSC
     C           DLPY      COMP 99999                    81
     C   81                MOVE '      '  LDATSC
     C** NEXT PAYMENT DATE FOR ENQUIRY
     C                     Z-ADDNXTP      ZDAYNO     81
     C   81                EXSR ZDATE2
     C   81                MOVE ZDATE     NPDTSC  6
     C  N81                MOVE '      '  NPDTSC
     C** LAST PAYMENT DATE FOR ENQUIRY
     C                     Z-ADDDLMV      ZDAYNO     81
     C   81                EXSR ZDATE2
     C   81                MOVE ZDATE     LPDTSC  6
     C  N81                MOVE '      '  LPDTSC
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C***********                                                         CCB002
     C*****SR.*TO ADD NEXT PAYMENT AMOUNT TO GROSS AND NET BALANCES.      CCB002
     C***********                                                         CCB002
     C***********NXAMAD    BEGSR                           **** NXAMAD ***CCB002
     C***********                                                         CCB002
     C***********          MOVE NXAM      NXAM2  130                      CCB002
     C***********GRBL      ADD  NXAM2     GRBL                            CCB002
     C***********NETB      ADD  NXAM2     NETB                            CCB002
     C***********                                                         CCB002
     C***********          ENDSR                                          CCB002
     C***********                                                         CCB002
     C********************************************************************CCB002
     C***********                                                         CCB002
     C*****SR.*TO SUBTRACT NEXT PAYMENT AMOUNT FROM NET AND GROSS BALANCESCCB002
     C***********                                                         CCB002
     C***********NXAMSB    BEGSR                           **** NXAMSB ***CCB002
     C***********                                                         CCB002
     C***********          MOVE NXAM      NXAM2                           CCB002
     C***********GRBL      SUB  NXAM2     GRBL                            CCB002
     C***********NETB      SUB  NXAM2     NETB                            CCB002
     C***********                                                         CCB002
     C***********          ENDSR                                          CCB002
     C***********                                                         CCB002
     C********************************************************************
     C**
     C**   SR. TO SET TIME.
     C**
     C           TIME      BEGSR                           **** TIME *****
     C**
     C                     TIME           MTIME   60
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   SR. TO RELEASE AND/OR UPDATE FILES.
     C**
     C           RELESE    BEGSR                           **** RELESE ***
     C**
     C                     MOVE OMBSI     MBSI                            S01117
     C**   SET UP FIELDS FOR ACCOUNTS MOVEMENTS FILE.                     S01154
      ** If account is Nostro, RSACMTPD will be updated in the            209995
      ** #NOST subroutine.                                                209995
     C**                                                                  S01154
     C           *IN08     IFEQ '1'                                       209995
     C                     EXSR ACCMOV                                    S01154
     C                     ENDIF                                          209995
     C**                                                                  S01154
      *                                                                                       CSD015
      ** For inserts, perform compliance watch processing if                                  CSD015
      ** compliance watch is installed and entry watch list                                   CSD015
      ** checking is being applied                                                            CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C           *IN74     ANDEQ'1'                                                           CSD015
     C           *IN68     ANDEQ'1'                                                           CSD015
      *                                                                                       CSD015
     C                     MOVEA*BLANKS   WLF,1                                               CSD015
     C                     MOVE 'N'       WCWFLG                                              CSD015
      *                                                                                       CSD015
     C                     MOVE ZACSQD    WSEQ                                                CSD015
     C                     CAT  ZCNUMD:0  WLF,1                                               CSD015
     C                     CAT  CCYSF:0   WLF,1                                               CSD015
     C                     CAT  ZACODD:0  WLF,1                                               CSD015
     C                     CAT  WSEQ:0    WLF,1                                               CSD015
     C                     CAT  ODBRC:0   WLF,1                                               CSD015
      *                                                                                       CSD015
     C                     MOVE *BLANKS   WSEQ                                                CSD015
     C                     MOVE ZACSQC    WSEQ                                                CSD015
     C                     CAT  ZCNUMC:0  WLF,2                                               CSD015
     C                     CAT  CCYSF:0   WLF,2                                               CSD015
     C                     CAT  ZACODC:0  WLF,2                                               CSD015
     C                     CAT  WSEQ:0    WLF,2                                               CSD015
     C                     CAT  BRCASF:0  WLF,2                                               CSD015
      *                                                                                       CSD015
     C                     MOVELDRACSF    WLF,3                                               CSD015
     C                     MOVELCRACSF    WLF,4                                               CSD015
     C                     MOVELPAYEE     WLF,5                                               CSD015
     C                     MOVELPAYRSF    WLF,6                                               CSD015
     C                     MOVELPAYASF    WLF,7                                               CSD015
      *                                                                                       CSD015
      ** Note: Payee bank is made up of the following 2 fields                                CSD015
      *                                                                                       CSD015
     C                     MOVELPYB1SF    WLF,8                                               CSD015
     C                     MOVELPYB2SF    WLF,9                                               CSD015
      *                                                                                       CSD015
     C                     Z-ADD8         WY                                                  CSD015
     C                     Z-ADD1         WX                                                  CSD015
      *                                                                                       CSD015
     C           WX        DOUGTWY                                                            CSD015
     C           WCWFLG    OREQ 'Y'                                                           CSD015
     C           WLF,WX    IFNE *BLANKS                                                       CSD015
     C                     MOVE 'Y'       WCWFLG                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ADD  1         WX                                                  CSD015
     C                     ENDDO                                                              CSD015
      *                                                                                       CSD015
      ** If conditions above are met, check if 24x7 is not installed.                         CSD015
      ** If it is installed, system used should be in the main system.                        CSD015
      *                                                                                       CSD015
     C           WCWFLG    IFEQ 'Y'                                                           CSD015
     C           CSC011    IFNE 'Y'                                                           CSD015
     C           CSC011    OREQ 'Y'                                                           CSD015
     C           S1MAIN    ANDEQLIBR                                                          CSD015
     C                     EXSR SRWTCH                                                        CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
      ** For amendments, perform compliance watch processing if                               CSD015
      ** compliance watch is installed and entry watch list                                   CSD015
      ** checking is being applied                                                            CSD015
      *                                                                                       CSD015
     C           CSD015    IFEQ 'Y'                                                           CSD015
     C           W1EWLC    ANDEQ'Y'                                                           CSD015
     C           *IN74     ANDEQ'1'                                                           CSD015
     C           *IN68     ANDEQ'0'                                                           CSD015
     C           *IN04     ANDEQ'0'                                                           CSD015
     C                     EXSR SRCCHK                                                        CSD015
     C                     ENDIF                                                              CSD015
      *                                                                                       CSD015
     C                     EXCPT
      *                                                                                       CRE020
      ** Handle the advice index of this transaction if CRE020 is enabled.                    CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C                     EXSR SRIDXT                                                        CRE020
     C                     ENDIF                                                              CRE020
     C**
     C                     SETOF                       6774
     C                     SETOF                     7585
     C***********          SETOF                     8687                 S01117
     C                     SETOF                     86                   S01117
      *                                                                   209995
      ** Reset indicators done in ACCMOV subroutine.                      209995
      *                                                                   209995
     C                     MOVE *OFF      *IN42                           209995
     C                     MOVE *OFF      *IN80                           209995
     C                     MOVE *OFF      *IN84                           209995
     C                     MOVE *OFF      *IN88                           209995
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**                                                                  S01154
     C**  SR. TO SET UP FIELDS FOR OUTPUT TO ACCOUNTS MOVEMENTS FILE.     S01154
     C**                                                                  S01154
     C           ACCMOV    BEGSR                                          S01154
     C**                                                                  S01154
     C**  SET UP CONSTANT FIELDS(FOR INSERT,AMEND OR DELETE).             S01154
     C**                                                                  S01154
     C                     MOVE 'SO'      TRYP                            S01154
     C           CAP205    IFEQ 'Y'                                                          CAP205
     C                     MOVEL'RE'      CMOD                                               CAP205
     C                     MOVEL'F'       MTYP                                               CAP205
     C                     ELSE                                                              CAP205
     C                     MOVEL*BLANKS   CMOD                                               CAP205
     C                     MOVEL*BLANKS   MTYP                                               CAP205
     C                     ENDIF                                                             CAP205
     C                     Z-ADD*ZEROS    CQNR                            S01154
     C                     MOVE HELDSF    TNMR                            S01154
     C**                                                                  S01154
     C**  RSACMTPD RECORDS FOR INSERT OR DELETE.                          S01154
     C**                                                                  S01154
     C           *IN02     IFEQ '1'                                       S01154
     C           *IN04     OREQ '1'                                       S01154
     C**                                                                  S01154
     C**  SET UP CONSTANT FIELDS FOR INSERT OR DELETE.                    S01154
     C**                                                                  S01154
     C                     MOVE NXAM      MVAM                            S01154
     C                     MOVE CCYAC     CCYD                            S01154
     C**                                                                  S01154
     C**  OUTPUT NEXT PAY DATE AND VALUE DATE FOR INSERT.                 S01154
     C**                                                                  S01154
     C           *IN02     IFEQ '1'                                       S01154
     C                     Z-ADDNPAYDT    PTDT                            S01154
     C                     Z-ADDNPAYDT    VUDT                            S01154
     C**                                                                  S01154
     C**  FIELDS FOR INSERT DEBIT ACCOUNT RECORD.                         S01154
     C**                                                                  S01154
     C           *IN42     IFEQ '1'                                       S01154
     C                     MOVE ZCNUMD    CUSN                            S01154
     C                     MOVE ZACODD    ACDE                            S01154
     C                     MOVE ZACSQD    ASNC                            S01154
     C                     MOVELZBRCAD    BRCA                                               BUG9032
     C                     Z-ADD0         DORC                            S01154
     C                     END                                            S01154
     C**                                                                  S01154
     C**  FIELDS FOR INSERT CREDIT ACCOUNT RECORD.                        S01154
     C**                                                                  S01154
     C           *IN80     IFEQ '1'                                       S01154
     C                     MOVE ZCNUMC    CUSN                            S01154
     C                     MOVE ZACODC    ACDE                            S01154
     C                     MOVE ZACSQC    ASNC                            S01154
     C                     MOVELZBRCAC    BRCA                                               BUG9032
     C                     Z-ADD1         DORC                            S01154
     C                     END                                            S01154
     C                     END                                            S01154
     C**                                                                  S01154
     C**  OUTPUT NEXT PAY DATE AND VALUE DATE FOR DELETE.                 S01154
     C**                                                                  S01154
     C           *IN04     IFEQ '1'                                       S01154
     C                     Z-ADDNXTP      PTDT                            S01154
     C                     Z-ADDNXTP      VUDT                            S01154
     C**                                                                  S01154
     C**  FIELDS FOR DELETE DEBIT ACCOUNT RECORD.                         S01154
     C**                                                                  S01154
     C           *IN42     IFEQ '1'                                       S01154
     C                     MOVE BRCDD     BRCA                            095797
     C                     MOVE DCUS      CUSN                            S01154
     C                     MOVE DACD      ACDE                            S01154
     C                     MOVE DACS      ASNC                            S01154
     C                     Z-ADD1         DORC                            S01154
     C                     END                                            S01154
     C**                                                                  S01154
     C**  FIELDS FOR DELETE CREDIT ACCOUNT RECORD.                        S01154
     C**                                                                  S01154
     C           *IN80     IFEQ '1'                                       S01154
     C                     MOVE BRCDC     BRCA                            095797
     C                     MOVE CCUS      CUSN                            S01154
     C                     MOVE CACD      ACDE                            S01154
     C                     MOVE CACS      ASNC                            S01154
     C                     Z-ADD0         DORC                            S01154
     C                     END                                            S01154
     C                     END                                            S01154
     C                     END                                            S01154
     C**                                                                  S01154
     C**  RSACMTPD RECORDS FOR AMEND.                                     S01154
     C**                                                                  S01154
     C**  FIELDS FOR ORIGINAL ACCOUNT RECORD (CREDIT OR DEBIT).           S01154
     C**                                                                  S01154
     C           *IN03     IFEQ '1'                                       S01154
     C           *IN84     ANDEQ'1'                                       S01154
     C                     MOVE PRAM      MVAM                            S01154
     C                     Z-ADDNXTP      PTDT                            S01154
     C                     Z-ADDNXTP      VUDT                            S01154
     C                     MOVE CCYST     CCYD                            S01154
     C**                                                                  S01154
     C**  FIELDS FOR ORIGINAL DEBIT ACCOUNT RECORD.                       S01154
     C**                                                                  S01154
     C           *IN42     IFEQ '1'                                       S01154
     C**********           Z-ADDDCUS      CUSN                                         S01154 CSD027
     C                     MOVE DCUS      CUSN                                                CSD027
     C                     Z-ADDDACD      ACDE                            S01154
     C                     Z-ADDDACS      ASNC                            S01154
     C                     MOVELZBRCAD    BRCA                                               BUG9032
     C                     Z-ADD1         DORC                            S01154
     C                     END                                            S01154
     C**                                                                  S01154
     C**  FIELDS FOR ORIGINAL CREDIT ACCOUNT RECORD.                      S01154
     C           *IN80     IFEQ '1'                                       S01154
     C**********           Z-ADDCCUS      CUSN                                         S01154 CSD027
     C                     MOVE CCUS      CUSN                                                CSD027
     C                     Z-ADDCACD      ACDE                            S01154
     C                     Z-ADDCACS      ASNC                            S01154
     C                     MOVELZBRCAC    BRCA                                               BUG9032
     C                     Z-ADD0         DORC                            S01154
     C                     END                                            S01154
     C                     END                                            S01154
     C**                                                                  S01154
     C**  FIELDS FOR NEW ACCOUNT (CREDIT OR DEBIT).                       S01154
     C**                                                                  S01154
     C           *IN03     IFEQ '1'                                       S01154
     C           *IN88     ANDEQ'1'                                       S01154
     C                     MOVE NXAM      MVAM                            S01154
     C                     Z-ADDNXTPSF    PTDT                            S01154
     C                     Z-ADDNXTPSF    VUDT                            S01154
     C*********************MOVE CCYAC     CCYD                      S01154086381
     C                     MOVE CCYSF     CCYD                            086381
     C**                                                                  S01154
     C**  FIELDS FOR NEW DEBIT ACCOUNT RECORD.                            S01154
     C**                                                                  S01154
     C           *IN42     IFEQ '1'                                       S01154
     C                     MOVE ZCNUMD    CUSN                            S01154
     C                     MOVE ZACODD    ACDE                            S01154
     C                     MOVE ZACSQD    ASNC                            S01154
     C                     MOVELZBRCAD    BRCA                                               BUG9032
     C                     Z-ADD0         DORC                            S01154
     C                     END                                            S01154
     C**                                                                  S01154
     C**  FIELDS FOR NEW CREDIT ACCOUNT RECORD.                           S01154
     C**                                                                  S01154
     C           *IN80     IFEQ '1'                                       S01154
     C                     MOVE ZCNUMC    CUSN                            S01154
     C                     MOVE ZACODC    ACDE                            S01154
     C                     MOVE ZACSQC    ASNC                            S01154
     C                     MOVELZBRCAC    BRCA                                               BUG9032
     C                     Z-ADD1         DORC                            S01154
     C                     END                                            S01154
     C                     END                                            S01154
     C**                                                                  S01154
     C**  WRITE A RECORD TO RSACMTPD ONLY IF MOVE AMT IS NOT ZERO         S01154
     C**                                                                  S01154
     C           MVAM      IFNE 0                                         S01154
     C           PNARSF    IFEQ *BLANKS                                   109434
     C                     MOVEL'S/O'     NRTDX   9 P                     109434
     C                     MOVE STORSF    NRTDX                           109434
     C                     MOVELNRTDX     PNARSF                          109434
     C                     ENDIF                                          109434
     C                     MOVELPNARSF    NRTD                            109434
      *                                                                                       CRE020
      ** Handle the relevant text of this transaction if CRE020 is enabled.                   CRE020
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
      *                                                                                       CRE020
     C                     SELEC                                                              CRE020
     C           *IN02     WHEQ *ON                                                           CRE020
     C           *IN03     OREQ *ON                                                           CRE020
     C           *IN88     ANDEQ*ON                                                           CRE020
     C                     MOVE 'R '      NRTD                                                CRE020
     C           *IN04     WHEQ *ON                                                           CRE020
     C           *IN03     OREQ *ON                                                           CRE020
     C           *IN84     ANDEQ*ON                                                           CRE020
     C                     MOVE 'R*'      NRTD                                                CRE020
     C                     ENDSL                                                              CRE020
      *                                                                                       CRE020
     C                     ELSE                                                               CRE020
     C                     MOVE *BLANKS   FUND                                                CRE020
     C                     ENDIF                                                              CRE020
     C/COPY WNCPYSRC,RE0253C048
     C                     EXCPTRSAC                                      S01154
      *                                                                   CRE009
      ** If CRE009 is ON, write additional records to RSACMTPD as req'd   CRE009
      *                                                                   CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C                     EXSR REAMOV                                    CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C/COPY WNCPYSRC,RE0253C049
     C                     END                                            S01154
     C**                                                                  S01154
     C**  SET OFF INDICATORS USED IN SR.                                  S01154
     C**                                                                  S01154
     C                     SETOF                     4280                 S01154
     C                     SETOF                     8488                 S01154
     C                     ENDSR                                          S01154
     C**
      *****************************************************************   CRE009
      **                                                                  CRE009
      **  SR. TO WRITE ADDITIONAL RECORDS TO RSACMTPD                     CRE009
      **                                                                  CRE009
     C           REAMOV    BEGSR                                          CRE009
      *                                                                   CRE009
     C                     MOVEL*BLANK    @LDAY   1                       CRE009
     C                     Z-ADD0         @DSPY                           CRE009
     C                     Z-ADD0         @DLPY                           CRE009
     C                     MOVE *BLANK    @PAYF                           CRE009
     C                     Z-ADD0         @DYTP                           CRE009
     C                     Z-ADD0         @ALPY                           CRE009
     C                     Z-ADD0         @ASPY                           CRE009
      *                                                                   CRE009
      ** Save old or new values for next payment date calculation         CRE009
      ** depending on whether new records are reversals or not.           CRE009
     C           *IN04     IFEQ *ON                                       CRE009
     C           *IN03     OREQ *ON                                       CRE009
     C           *IN88     ANDEQ*ON                                       CRE009
     C                     MOVE DSPY      @DSPY                           CRE009
     C                     MOVE DLPY      @DLPY                           CRE009
     C                     MOVE PAYF      @PAYF                           CRE009
     C                     MOVE DYTP      @DYTP                           CRE009
     C                     MOVE ALPY      @ALPY                           CRE009
     C                     MOVE ASPY      @ASPY                           CRE009
     C                     ELSE                                           CRE009
     C           *IN02     IFEQ *ON                                       CRE009
     C           *IN03     OREQ *ON                                       CRE009
     C           *IN84     ANDEQ*ON                                       CRE009
     C                     MOVE DSPYSF    @DSPY                           CRE009
     C                     MOVE DLPYSF    @DLPY                           CRE009
     C                     MOVE PAYFSF    @PAYF                           CRE009
     C                     MOVE DYTPSF    @DYTP                           CRE009
     C                     MOVE ALPYSF    @ALPY                           CRE009
     C                     MOVE ASPYSF    @ASPY                           CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     MOVE *IN14     SAV14                           CRE009
     C           CCYD      CHAINREPMFWL1             14                   CRE009
     C           *IN14     IFEQ *ON                                       CRE009
     C           CRE009    ANDEQ'Y'                                       CRE009
     C                     MOVEL'RE0253 ' DBPGM                           CRE009
     C                     MOVEL'REPMFWPD'DBFILE           ************   CRE009
     C                     MOVELCCYD      DBKEY            * DBERR 07 *   CRE009
     C                     Z-ADD07        DBASE            ************   CRE009
     C                     OUT  LDA                                       CRE009
     C                     EXSR *PSSR                                     CRE009
     C                     SETON                     U7U8LR               CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV14     *IN14                           CRE009
      *                                                                   CRE009
      ** Save value date of last record written to RSACMTPD               CRE009
      *                                                                   CRE009
     C                     Z-ADD0         @PAYD   50                      CRE009
     C                     Z-ADDVUDT      @PAYD                           CRE009
      **                                                                  CRE009
      **  Write records until next payment date is less or equal          CRE009
      **  than date in REPMFWPD in currency and less or equal to          CRE009
      **  Last Payment Date.                                              CRE009
      *                                                                   CRE009
      ** Calculate next payment date for the first payment                CRE009
      *                                                                   CRE009
     C           @DSPY     IFNE 0                                         CRE009
     C                     Z-ADD@DSPY     @PAYD                           CRE009
     C                     ELSE                                           CRE009
      *                                                                   CRE009
     C                     Z-ADD@PAYD     ZDAYNO                          CRE009
     C                     MOVE @PAYF     ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE @DYTP     ZMDAY                           CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
      *                                                                   CRE009
      ** If pay freq. is on accrual date and next pay date not            CRE009
      ** greater than run date, determine next accrual date.              CRE009
      *                                                                   CRE009
     C           @PAYF     IFEQ 'A'                                       CRE009
     C                     MOVE BKAPFQ    ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE BKAPFD    ZMDAY                           CRE009
     C                     MOVE @PAYD     ZDAYNO                          CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CRE009
      **                                                                  CRE009
     C           @PAYD     DOWLEREPMED                                    CRE009
     C           @LDAY     ANDNE'Y'                                       CRE009
      *                                                                   CRE009
      ** Calculate next payment date.                                     CRE009
      ** If next pay date less than 2nd pay date, use 2nd pay date.       CRE009
      *                                                                   CRE009
     C           @PAYD     IFLE @DSPY                                     CRE009
     C                     MOVE @DSPY     @PAYD                           CRE009
     C           @ASPY     IFNE 0                                         CRE009
     C                     Z-ADD@ASPY     MVAM                            CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** If calculated next pay date is greater than last pay date,       CRE009
      ** replace next pay date with last pay date.                        CRE009
      *                                                                   CRE009
     C           @PAYD     IFGE @DLPY                                     CRE009
     C                     MOVE @DLPY     @PAYD                           CRE009
     C                     MOVE 'Y'       @LDAY                           CRE009
     C           @ALPY     IFNE 0                                         CRE009
     C                     Z-ADD@ALPY     MVAM                            CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      **  Write a record to RSACMTPD only if move amt is not 0            CRE009
      **                                                                  CRE009
     C           MVAM      IFNE 0                                         CRE009
     C                     Z-ADD@PAYD     PTDT                            CRE009
     C                     Z-ADD@PAYD     VUDT                            CRE009
     C                     EXCPTRSAC                                      CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** Calculate next payment date                                      CRE009
      *                                                                   CRE009
     C                     Z-ADD@PAYD     ZDAYNO                          CRE009
     C                     MOVE @PAYF     ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE @DYTP     ZMDAY                           CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
      *                                                                   CRE009
      ** If pay freq. is on accrual date and next pay date not            CRE009
      ** greater than run date, determine next accrual date.              CRE009
      *                                                                   CRE009
     C           @PAYF     IFEQ 'A'                                       CRE009
     C                     MOVE BKAPFQ    ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE BKAPFD    ZMDAY                           CRE009
     C                     MOVE @PAYD     ZDAYNO                          CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
     C                     END                                            CRE009
      *                                                                   CRE009
     C                     ENDDO                                          CRE009
      *                                                                   CRE009
     C                     ENDSR                                          CRE009
     C******************************************************************* CRE009
      **                                                                  CRE009
      **  SR. TO REVERSE OUT EXTRA RECORDS IN RSACMTPD WHEN AN AMENDMENT  CRE009
      **  TO THE SECOND PAYMENT OR LAST PAYMENT DATE IS DONE              CRE009
      **                                                                  CRE009
     C           REVMOV    BEGSR                                          CRE009
      *                                                                   CRE009
     C                     MOVEL*BLANK    @LDAY                           CRE009
     C                     Z-ADD0         @DSPY                           CRE009
     C                     Z-ADD0         @DLPY                           CRE009
     C                     MOVE *BLANK    @PAYF                           CRE009
     C                     Z-ADD0         @DYTP                           CRE009
     C                     Z-ADD0         @ALPY                           CRE009
     C                     Z-ADD0         @ASPY                           CRE009
     C                     MOVE *ON       *IN67                           CRE009
      *                                                                   CRE009
      ** Save old values for next payment date calculation                CRE009
      *                                                                   CRE009
     C                     MOVE DSPY      @DSPY                           CRE009
     C                     MOVE DLPY      @DLPY                           CRE009
     C                     MOVE PAYF      @PAYF                           CRE009
     C                     MOVE DYTP      @DYTP                           CRE009
     C                     MOVE ALPY      @ALPY                           CRE009
     C                     MOVE ASPY      @ASPY                           CRE009
      *                                                                   CRE009
      ** Set account fields                                               CRE009
      *                                                                   CRE009
     C           PROC      IFEQ 'DR'                                      CRE009
     C                     MOVE CCYSTD    @CCYC   3                       CRE009
     C**********           MOVE DCUS      @CUSN   60                                   CRE009 CSD027
     C                     MOVE DCUS      @CUSN   6                                           CSD027
     C**********           MOVE DACD      @ACDE   40                                   CRE009 CGL029
     C                     MOVE DACD      @ACDE  100                                          CGL029
     C                     MOVE DACS      @ASNC   20                      CRE009
     C                     MOVE BRCDD     @BRCA   3                       CRE009
     C                     ELSE                                           CRE009
     C                     MOVE CCYSTC    @CCYC                           CRE009
     C                     MOVE CCUS      @CUSN                           CRE009
     C                     MOVE CACD      @ACDE                           CRE009
     C                     MOVE CACS      @ASNC                           CRE009
     C                     MOVE BRCDC     @BRCA                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     MOVE *IN14     SAV14                           CRE009
     C           @CCYC     CHAINREPMFWL1             14                   CRE009
     C           *IN14     IFEQ *ON                                       CRE009
     C           CRE009    ANDEQ'Y'                                       CRE009
     C                     MOVEL'RE0253 ' DBPGM                           CRE009
     C                     MOVEL'REPMFWPD'DBFILE           ************   CRE009
     C                     MOVEL@CCYC     DBKEY            * DBERR 10 *   CRE009
     C                     Z-ADD010       DBASE            ************   CRE009
     C                     OUT  LDA                                       CRE009
     C                     EXSR *PSSR                                     CRE009
     C                     SETON                     U7U8LR               CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE SAV14     *IN14                           CRE009
      *                                                                   CRE009
      ** If only last payment date or last payment amount changed,        CRE009
      ** reverse record for the last payment event & write new record     CRE009
      *                                                                   CRE009
     C           DSPY      IFEQ DSPYSF                                    CRE009
     C           ASPY      ANDEQASPYSF                                    CRE009
      *                                                                   CRE009
      ** Write record for old event                                       CRE009
      *                                                                   CRE009
     C                     MOVE 'SO'      TRYP                            CRE009
     C           CAP205    IFEQ 'Y'                                                          CAP205
     C                     MOVEL'RE'      CMOD                                               CAP205
     C                     MOVEL'F'       MTYP                                               CAP205
     C                     ELSE                                                              CAP205
     C                     MOVEL*BLANKS   CMOD                                               CAP205
     C                     MOVEL*BLANKS   MTYP                                               CAP205
     C                     ENDIF                                                             CAP205
     C                     Z-ADD*ZEROS    CQNR                            CRE009
     C                     MOVE STOR      TNMR                            CRE009
     C                     MOVE ALPY      MVAM                            CRE009
     C                     MOVE @CCYC     CCYD                            CRE009
     C                     Z-ADDDLPY      PTDT                            CRE009
     C                     Z-ADDDLPY      VUDT                            CRE009
     C                     MOVE @BRCA     BRCA                            CRE009
     C                     MOVE @CUSN     CUSN                            CRE009
     C                     MOVE @ACDE     ACDE                            CRE009
     C                     MOVE @ASNC     ASNC                            CRE009
     C           PROC      IFEQ 'DR'                                      CRE009
     C                     Z-ADD1         DORC                            CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD0         DORC                            CRE009
     C                     ENDIF                                          CRE009
     C                     MOVELPNAR      NRTD                            CRE009
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C                     MOVE 'R*'      NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     EXCPTRSAC                                      CRE009
      *                                                                   CRE009
      ** Write record for new event                                       CRE009
      *                                                                   CRE009
     C                     MOVE ALPYSF    MVAM                            CRE009
     C                     Z-ADDDLPYSF    PTDT                            CRE009
     C                     Z-ADDDLPYSF    VUDT                            CRE009
     C           PROC      IFEQ 'DR'                                      CRE009
     C                     Z-ADD0         DORC                            CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD1         DORC                            CRE009
     C                     ENDIF                                          CRE009
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C                     MOVE 'R '      NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     EXCPTRSAC                                      CRE009
      *                                                                   CRE009
      ** Otherwise, reverse out all movements from the senond payment     CRE009
      ** date onwards & write new ones.                                   CRE009
      *                                                                   CRE009
     C                     ELSE                                           CRE009
      *                                                                   CRE009
      ** Reverse original second payment                                  CRE009
     C                     MOVE 'SO'      TRYP                            CRE009
     C           CAP205    IFEQ 'Y'                                                          CAP205
     C                     MOVEL'RE'      CMOD                                               CAP205
     C                     MOVEL'F'       MTYP                                               CAP205
     C                     ELSE                                                              CAP205
     C                     MOVEL*BLANKS   CMOD                                               CAP205
     C                     MOVEL*BLANKS   MTYP                                               CAP205
     C                     ENDIF                                                             CAP205
     C                     Z-ADD*ZEROS    CQNR                            CRE009
     C                     MOVE STOR      TNMR                            CRE009
     C           ASPY      IFNE 0                                         CRE009
     C                     MOVE ASPY      MVAM                            CRE009
     C                     ELSE                                           CRE009
     C                     MOVE AFPY      MVAM                            CRE009
     C                     ENDIF                                          CRE009
     C                     MOVE @CCYC     CCYD                            CRE009
     C                     Z-ADDDSPY      PTDT                            CRE009
     C                     Z-ADDDSPY      VUDT                            CRE009
     C                     MOVE @BRCA     BRCA                            CRE009
     C                     MOVE @CUSN     CUSN                            CRE009
     C                     MOVE @ACDE     ACDE                            CRE009
     C                     MOVE @ASNC     ASNC                            CRE009
     C           PROC      IFEQ 'DR'                                      CRE009
     C                     Z-ADD1         DORC                            CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD0         DORC                            CRE009
     C                     ENDIF                                          CRE009
     C                     MOVELPNAR      NRTD                            CRE009
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C                     MOVE 'R*'      NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     EXCPTRSAC                                      CRE009
      ** Additional reversals                                             CRE009
     C                     Z-ADDVUDT      @PAYD                           CRE009
      *                                                                   CRE009
     C                     Z-ADD@PAYD     ZDAYNO                          CRE009
     C                     MOVE @PAYF     ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE @DYTP     ZMDAY                           CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
      *                                                                   CRE009
     C           @PAYF     IFEQ 'A'                                       CRE009
     C                     MOVE BKAPFQ    ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE BKAPFD    ZMDAY                           CRE009
     C                     MOVE @PAYD     ZDAYNO                          CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           @PAYD     DOWLEREPMED                                    CRE009
     C           @LDAY     ANDNE'Y'                                       CRE009
      *                                                                   CRE009
     C           @PAYD     IFGE @DLPY                                     CRE009
     C                     MOVE @DLPY     @PAYD                           CRE009
     C                     MOVE 'Y'       @LDAY                           CRE009
     C                     Z-ADD@ALPY     MVAM                            CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           MVAM      IFNE 0                                         CRE009
     C                     Z-ADD@PAYD     PTDT                            CRE009
     C                     Z-ADD@PAYD     VUDT                            CRE009
     C                     EXCPTRSAC                                      CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     Z-ADD@PAYD     ZDAYNO                          CRE009
     C                     MOVE @PAYF     ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE @DYTP     ZMDAY                           CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
      *                                                                   CRE009
     C           @PAYF     IFEQ 'A'                                       CRE009
     C                     MOVE BKAPFQ    ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE BKAPFD    ZMDAY                           CRE009
     C                     MOVE @PAYD     ZDAYNO                          CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ENDDO                                          CRE009
      *                                                                   CRE009
      ** Write new records                                                CRE009
      *                                                                   CRE009
     C                     MOVE DSPYSF    @DSPY                           CRE009
     C                     MOVE DLPYSF    @DLPY                           CRE009
     C                     MOVE DYTPSF    @DYTP                           CRE009
     C                     MOVE ALPYSF    @ALPY                           CRE009
     C                     MOVE ASPYSF    @ASPY                           CRE009
      *                                                                   CRE009
      ** Record for new second payment                                    CRE009
     C                     MOVE 'SO'      TRYP                            CRE009
     C           CAP205    IFEQ 'Y'                                                          CAP205
     C                     MOVEL'RE'      CMOD                                               CAP205
     C                     MOVEL'F'       MTYP                                               CAP205
     C                     ELSE                                                              CAP205
     C                     MOVEL*BLANKS   CMOD                                               CAP205
     C                     MOVEL*BLANKS   MTYP                                               CAP205
     C                     ENDIF                                                             CAP205
     C                     Z-ADD*ZEROS    CQNR                            CRE009
     C                     MOVE STOR      TNMR                            CRE009
     C           @ASPY     IFNE 0                                         CRE009
     C                     MOVE @ASPY     MVAM                            CRE009
     C                     ELSE                                           CRE009
     C                     MOVE AFPY      MVAM                            CRE009
     C                     ENDIF                                          CRE009
     C                     Z-ADD@DSPY     PTDT                            CRE009
     C                     Z-ADD@DSPY     VUDT                            CRE009
     C           PROC      IFEQ 'DR'                                      CRE009
     C                     Z-ADD0         DORC                            CRE009
     C                     ELSE                                           CRE009
     C                     Z-ADD1         DORC                            CRE009
     C                     ENDIF                                          CRE009
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
     C                     MOVE 'R '      NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     EXCPTRSAC                                      CRE009
      ** Additional records                                               CRE009
     C                     Z-ADDVUDT      @PAYD                           CRE009
      *                                                                   CRE009
     C                     Z-ADD@PAYD     ZDAYNO                          CRE009
     C                     MOVE @PAYF     ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE @DYTP     ZMDAY                           CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
      *                                                                   CRE009
     C           @PAYF     IFEQ 'A'                                       CRE009
     C                     MOVE BKAPFQ    ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE BKAPFD    ZMDAY                           CRE009
     C                     MOVE @PAYD     ZDAYNO                          CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           @PAYD     DOWLEREPMED                                    CRE009
     C           @LDAY     ANDNE'Y'                                       CRE009
      *                                                                   CRE009
     C           @PAYD     IFGE @DLPY                                     CRE009
     C                     MOVE @DLPY     @PAYD                           CRE009
     C                     MOVE 'Y'       @LDAY                           CRE009
     C                     Z-ADD@ALPY     MVAM                            CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C           MVAM      IFNE 0                                         CRE009
     C                     Z-ADD@PAYD     PTDT                            CRE009
     C                     Z-ADD@PAYD     VUDT                            CRE009
     C                     EXCPTRSAC                                      CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     Z-ADD@PAYD     ZDAYNO                          CRE009
     C                     MOVE @PAYF     ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE @DYTP     ZMDAY                           CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
      *                                                                   CRE009
     C           @PAYF     IFEQ 'A'                                       CRE009
     C                     MOVE BKAPFQ    ZFREQ                           CRE009
     C                     MOVE CCYD      ZCCY                            CRE009
     C                     MOVE BKAPFD    ZMDAY                           CRE009
     C                     MOVE @PAYD     ZDAYNO                          CRE009
     C                     EXSR FREQS                                     CRE009
     C                     MOVE ZDAYNO    @PAYD                           CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     ENDDO                                          CRE009
      *                                                                   CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
     C                     MOVE *OFF      *IN67                           CRE009
      *                                                                   CRE009
     C                     ENDSR                                          CRE009
      *                                                                   CRE009
      ********************************************************************209995
      *                                                                   209995
      ** SR. to check if DR or CR a/c is a nostro.                        209995
      **                                                                  209995
      **       Calls: #NOSTU to update Nostro records                     209995
      **                                                                  209995
      *                                                                   209995
     C           #NOST     BEGSR                           **** #NOST ****209995
      *                                                                   209995
      ** For amendment or deletion, if DR or CR a/c was a nostro,         209995
      ** reverse out payments from projected nostro balances if           209995
      ** necessary.                                                       209995
      *                                                                   209995
     C           *IN03     IFEQ '1'                                       209995
     C           *IN04     OREQ '1'                                       209995
     C                     MOVE 'R'       @REVF   1                       209995
      *                                                                   209995
     C                     MOVE DCUS      A7CUST                          209995
     C                     MOVE CCYST     A7CYCD                          209995
     C                     MOVE DACD      A7ACCD                          209995
     C                     MOVE DACS      A7ACSN                          209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
     C           *IN08     IFEQ '0'                                       209995
     C                     MOVE 'C'       @DRCR   1                       209995
     C                     MOVE BRCDD     BRCA                            209995
     C                     EXSR #NOSTU                                    209995
     C                     END                                            209995
      *                                                                   209995
     C           *INU8     IFEQ '0'                                       209995
     C                     MOVE CCUS      A7CUST                          209995
     C                     MOVE CCYST     A7CYCD                          209995
     C                     MOVE CACD      A7ACCD                          209995
     C                     MOVE CACS      A7ACSN                          209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
     C           *IN08     IFEQ '0'                                       209995
     C                     MOVE 'D'       @DRCR                           209995
     C                     MOVE BRCDC     BRCA                            209995
     C                     EXSR #NOSTU                                    209995
     C                     END                                            209995
     C                     END                                            209995
     C                     END                                            209995
      *                                                                   209995
      ** For amendment or insertion, if DR or CR a/c is a nostro, update  209995
      ** projected nostro balances if necessary.                          209995
      *                                                                   209995
     C           *INU8     IFEQ '0'                                       209995
     C           *IN02     IFEQ '1'                                       209995
     C           *IN03     OREQ '1'                                       209995
     C                     MOVE *BLANK    @REVF                           209995
      *                                                                   209995
     C                     MOVE DCUSSF    A7CUST                          209995
     C                     MOVE CCYDR     A7CYCD                          209995
     C                     MOVE ACODDR    A7ACCD                          209995
     C                     MOVE DACSSF    A7ACSN                          209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
     C           *IN08     IFEQ '0'                                       209995
     C                     MOVE 'D'       @DRCR   1                       209995
     C                     MOVE DBRCSF    BRCA                            209995
     C                     EXSR #NOSTU                                    209995
     C                     END                                            209995
      *                                                                   209995
     C           *INU8     IFEQ '0'                                       209995
     C                     MOVE CCUSSF    A7CUST                          209995
     C                     MOVE CCYCR     A7CYCD                          209995
     C                     MOVE ACODCR    A7ACCD                          209995
     C                     MOVE CACSSF    A7ACSN                          209995
     C           KNOST     CHAINSDNOSTL4             08                   209995
     C           *IN08     IFEQ '0'                                       209995
     C                     MOVE 'C'       @DRCR                           209995
     C                     MOVE CBRCSF    BRCA                            209995
     C                     EXSR #NOSTU                                    209995
     C                     END                                            209995
     C                     END                                            209995
     C                     END                                            209995
     C                     END                                            209995
      *                                                                   209995
     C                     ENDSR                                          209995
      *                                                                   209995
      ********************************************************************209995
      *                                                                   209995
      ** SR. to update projected nostro balances if required.             209995
      **                                                                  209995
      **       Calls: SRNMOV to write Nostro records on RSACMTPD          209995
      *                                                                   209995
     C           #NOSTU    BEGSR                           *** #NOSTU *** 209995
      *                                                                   209995
      ** Set up dates & amounts.                                          209995
      *                                                                   209995
     C           @REVF     IFEQ 'R'                                       209995
      *                                                                   209995
      ** 'Old' values (amendment/deletion).                               209995
      *                                                                   209995
     C                     MOVE NXTP      @NXTP                           209995
     C                     MOVE DFPY      @DFPY                           209995
     C                     MOVE AFPY      @AFPY                           209995
     C                     MOVE DSPY      @DSPY                           209995
     C                     MOVE ASPY      @ASPY                           209995
     C                     MOVE DLPY      @DLPY                           209995
     C                     MOVE ALPY      @ALPY                           209995
     C                     MOVE PAYF      @PAYF                           209995
     C                     MOVE CCYST     @CCY                            209995
     C                     MOVE DYTP      @DYTP                           209995
     C                     ELSE                                           209995
      *                                                                   209995
      ** 'New' values (insertion/amendment).                              209995
      *                                                                   209995
     C                     MOVE NXTPSF    @NXTP                           209995
     C                     MOVE DFPYSF    @DFPY                           209995
     C                     MOVE AFPYSF    @AFPY                           209995
     C                     MOVE DSPYSF    @DSPY                           209995
     C                     MOVE ASPYSF    @ASPY                           209995
     C                     MOVE DLPYSF    @DLPY                           209995
     C                     MOVE ALPYSF    @ALPY                           209995
     C                     MOVE PAYFSF    @PAYF                           209995
     C                     MOVE CCYSF     @CCY                            209995
     C                     MOVE DYTPSF    @DYTP                           209995
     C                     END                                            209995
      *                                                                   209995
      ** Retrieve the PRONO record                                        209995
      *                                                                   209995
     C                     MOVE A7NONB    NOSN                            209995
     C           KPRON     CHAINPRONO                81                   209995
      *                                                                   209995
     C           *IN81     IFEQ '1'                                       209995
     C                     Z-ADD*ZEROS    NOSN                            209995
     C           KPRON     CHAINPRONO                81                   209995
     C                     ENDIF                                          209995
      *                                                                   209995
     C           *IN81     IFEQ '0'                                       209995
      *                                                                   209995
      ** Check if next payment date is within the range of the 5          209995
      ** projected nostro balance dates.                                  209995
      *                                                                   209995
     C                     Z-ADD1         @P      10                      209995
     C                     MOVE *BLANK    @PRONF  1                       209995
      *                                                                   209995
     C           @NXTP     DOWLEPDT,5                                     209995
     C           @NXTP     LOKUPPDT,@P               08  08               209995
     C           *IN08     IFEQ '1'                                       209995
      *                                                                   209995
      ** Next pay date is before or on projected nostro balance date.     209995
      *                                                                   209995
     C                     MOVE 'Y'       @PRONF                          209995
      *                                                                   209995
      ** Set up payment amount                                            209995
      *                                                                   209995
     C                     EXSR #PYAMT                                    209995
     C                     Z-ADD@P        @Q      10                      209995
      *                                                                   209995
      ** Generate RSACMTPD records for Nostro accounts.                   209995
      *                                                                   209995
     C                     Z-ADDPDT,@P    PTDT                            209995
     C                     Z-ADDPDT,@P    VUDT                            209995
     C                     EXSR SRNMOV                                    209995
      *                                                                   209995
      ** Update amount for projected nostro balance date and all          209995
      ** following dates.                                                 209995
      *                                                                   209995
     C           @Q        DOWLE5                                         209995
     C           @DRCR     IFEQ 'C'                                       209995
     C                     SUB  @AMT      PBL,@Q                          209995
     C                     ELSE                                           209995
     C                     ADD  @AMT      PBL,@Q                          209995
     C                     END                                            209995
     C                     ADD  1         @Q                              209995
     C                     END                                            209995
      *                                                                   209995
      ** End processing if 5th PRONO date or final pay date reached.      209995
      *                                                                   209995
     C           @NXTP     IFEQ PDT,5                                     209995
     C           @NXTP     OREQ @DLPY                                     209995
     C                     Z-ADD99999     @NXTP                           209995
     C                     ELSE                                           209995
      *                                                                   209995
      ** Calculate next payment date.                                     209995
      ** If next pay date less than 2nd pay date, use 2nd pay date.       209995
      *                                                                   209995
     C           @NXTP     IFLT @DSPY                                     209995
     C                     MOVE @DSPY     @NXTP                           209995
     C                     ELSE                                           209995
     C                     Z-ADD@NXTP     ZDAYNO                          209995
     C                     MOVE @PAYF     ZFREQ                           209995
     C                     MOVE @CCY      ZCCY                            209995
     C                     MOVE @DYTP     ZMDAY                           209995
     C                     EXSR FREQS                                     209995
     C                     MOVE ZDAYNO    @NXTP                           209995
     C                     END                                            209995
      *                                                                   209995
      ** If pay freq. is on accrual date and next pay date not            209995
      ** greater than run date, determine next accrual date.              209995
      *                                                                   209995
     C           @PAYF     IFEQ 'A'                                       209995
     C           @NXTP     IFLE RUND                                      209995
     C                     MOVE BKAPFQ    ZFREQ                           209995
     C                     MOVE LOCCY     ZCCY                            209995
     C                     MOVE BKAPFD    ZMDAY                           209995
     C                     MOVE BKAPDT    ZDAYNO                          209995
     C                     EXSR FREQS                                     209995
     C                     MOVE ZDAYNO    @NXTP                           209995
     C                     END                                            209995
     C                     END                                            209995
      *                                                                   209995
      ** If calculated next pay date is greater than last pay date,       209995
      ** replace next pay date with last pay date.                        209995
      *                                                                   209995
     C           @NXTP     IFGT @DLPY                                     209995
     C                     MOVE @DLPY     @NXTP                           209995
     C                     END                                            209995
     C                     END                                            209995
      *                                                                   209995
     C                     END                                            209995
     C                     END                                            209995
      *                                                                   209995
      ** Update PRONO if required                                         209995
      *                                                                   209995
     C           @PRONF    IFEQ 'Y'                                       209995
     C                     UPDATPRONOPNF                                  209995
     C                     END                                            209995
      *                                                                   209995
     C                     ELSE                                           209995
      *                                                                   209995
      ** Database error                                                   209995
      *                                                                   209995
     C           *LOCK     IN   LDA                                       209995
     C                     MOVEL'PRONO   'DBFILE                          209995
     C                     MOVEL'   00'   DBKEY              *************209995
     C                     MOVELA7CYCD    DBKEY              * DBERR 005 *209995
     C                     Z-ADD05        DBASE              *************209995
     C                     OUT  LDA                                       209995
     C                     EXSR *PSSR                                     209995
     C                     SETON                     U883                 209995
     C                     GOTO END                                       209995
     C                     END                                            209995
      *                                                                   209995
     C                     ENDSR                                          209995
      *                                                                   209995
      ********************************************************************209995
      *                                                                   209995
      ** SR. to set up payment amount.                                    209995
      *                                                                   209995
     C           #PYAMT    BEGSR                           *** #PYAMT *** 209995
      *                                                                   209995
      ** If 1st payment date, use 1st payment amount.                     209995
      *                                                                   209995
     C           @NXTP     IFEQ @DFPY                                     209995
     C                     Z-ADD@AFPY     @AMT                            209995
     C                     ELSE                                           209995
      *                                                                   209995
      ** If last payment date, use last payment amount if not zero.       209995
      *                                                                   209995
     C           @NXTP     IFEQ @DLPY                                     209995
     C           @ALPY     ANDNE0                                         209995
     C                     Z-ADD@ALPY     @AMT                            209995
     C                     ELSE                                           209995
      *                                                                   209995
      ** Otherwise, use 2nd pay amount; if it is zero, use 1st amount.    209995
      *                                                                   209995
     C           @ASPY     IFNE 0                                         209995
     C                     Z-ADD@ASPY     @AMT                            209995
     C                     ELSE                                           209995
     C                     Z-ADD@AFPY     @AMT                            209995
     C                     END                                            209995
     C                     END                                            209995
     C                     END                                            209995
      *                                                                   209995
     C                     ENDSR                                          209995
      *                                                                   209995
      ********************************************************************209995
      **                                                                  209995
      **  SR. Write RSACMTPD records for Nostro accounts.                 209995
      **                                                                  209995
     C           SRNMOV    BEGSR                                          209995
      *                                                                   209995
      ** Sst up constant fields (for Insert,Amend or Delete).             209995
      *                                                                   209995
     C                     MOVE 'SO'      TRYP                            209995
     C           CAP205    IFEQ 'Y'                                                          CAP205
     C                     MOVEL'RE'      CMOD                                               CAP205
     C                     MOVEL'F'       MTYP                                               CAP205
     C                     ELSE                                                              CAP205
     C                     MOVEL*BLANKS   CMOD                                               CAP205
     C                     MOVEL*BLANKS   MTYP                                               CAP205
     C                     ENDIF                                                             CAP205
     C                     Z-ADD*ZEROS    CQNR                            209995
     C                     MOVE HELDSF    TNMR                            209995
     C                     MOVE @AMT      MVAM                            209995
     C                     MOVE CCYAC     CCYD                            209995
     C                     MOVE A7CUST    CUSN                            209995
     C                     MOVE A7ACCD    ACDE                            209995
     C                     MOVE A7ACSN    ASNC                            209995
      *                                                                   209995
     C           @DRCR     IFEQ 'C'                                       209995
     C                     Z-ADD1         DORC                            209995
     C                     ELSE                                           209995
     C                     Z-ADD0         DORC                            209995
     C                     ENDIF                                          209995
      *                                                                   209995
      ** Write a record if there is a change in amount.                   209995
      *                                                                   209995
     C           MVAM      IFNE 0                                         209995
     C           PNARSF    IFEQ *BLANKS                                   209995
     C                     MOVEL'S/O'     NRTDX   9 P                     209995
     C                     MOVE STORSF    NRTDX                           209995
     C                     MOVELNRTDX     PNARSF                          209995
     C                     ENDIF                                          209995
     C                     MOVELPNARSF    NRTD                            209995
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           WSV01     ANDEQ'Y'                                                           CRE020
      *                                                                                       CRE020
     C           @REVF     IFEQ 'R'                                                           CRE020
     C                     MOVE 'R*'      NRTD                                                CRE020
     C                     ELSE                                                               CRE020
     C                     MOVE 'R '      NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     MOVE *ON       *IN67                           209995
     C                     EXCPTRSAC                                      209995
     C                     MOVE *OFF      *IN67                           209995
     C                     END                                            209995
      *                                                                   209995
     C                     ENDSR                                          209995
      *                                                                   209995
      *****************************************************************                       CRE020
      /EJECT                                                                                  CRE020
      *****************************************************************                       CRE020
      *                                                               *                       CRE020
      *  SRIDXT - Handles the advice index of the current             *                       CRE020
      *           transaction.                                        *                       CRE020
      *                                                               *                       CRE020
      *****************************************************************                       CRE020
     C           SRIDXT    BEGSR                                                              CRE020
      *                                                                                       CRE020
      ** Only process Standing Order transactions.                                            CRE020
      *                                                                                       CRE020
     C           *IN74     IFEQ *ON                                                           CRE020
      *                                                                                       CRE020
     C                     MOVE *BLANKS   KREFNO                                              CRE020
     C                     MOVELHELDSF    KREFNO                                              CRE020
     C                     MOVE *IN10     WIN10   1                                           CRE020
      *                                                                                       CRE020
     C                     OPEN READVCL2                                                      CRE020
      *                                                                                       CRE020
     C           KADV2     CHAINREADVCL2             10                                       CRE020
      *                                                                                       CRE020
     C           *IN10     IFEQ *ON                                                           CRE020
     C                     MOVE *BLANKS   RREFNO                                              CRE020
     C                     MOVELHELDSF    RREFNO                                              CRE020
     C                     MOVE *BLANKS   RPRGMN                                              CRE020
     C                     MOVEL'RE0253'  RPRGMN                                              CRE020
     C                     MOVE 'SO'      RTRTYP                                              CRE020
     C                     MOVE CHTPSF    RCHTYP                                              CRE020
     C                     MOVE 'Y'       RAUTHI                                              CRE020
     C                     MOVE 'N'       RSAPIN                                              CRE020
      *                                                                                       CRE020
     C                     MOVE *BLANKS   RSEQNO                                              CRE020
     C                     WRITEREADVCD0                                                      CRE020
      *                                                                                       CRE020
     C                     ELSE                                                               CRE020
      *                                                                                       CRE020
      ** Check first if this is a new record.                                                 CRE020
      *                                                                                       CRE020
     C           RCHTYP    IFEQ 'I'                                                           CRE020
     C           RSAPIN    ANDEQ'N'                                                           CRE020
      *                                                                                       CRE020
     C           CHTPSF    IFEQ 'D'                                                           CRE020
      *                                                                                       CRE020
      ** Delete both DR and CR records.                                                       CRE020
      *                                                                                       CRE020
     C                     MOVE *BLANKS   KSEQNO                                              CRE020
     C           KADV1     CHAINREADVCL2             10                                       CRE020
     C           *IN10     IFEQ *OFF                                                          CRE020
     C                     MOVE 'D'       RCHTYP                                              CRE020
     C                     MOVE 'Y'       RSAPIN                                              CRE020
     C                     UPDATREADVCD0                                                      CRE020
     C                     ENDIF                                                              CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     GOTO EIDXT                                                         CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     MOVE *BLANKS   KSEQNO                                              CRE020
     C           KADV1     CHAINREADVCL2             10                                       CRE020
     C           *IN10     IFEQ *OFF                                                          CRE020
     C                     MOVE CHTPSF    RCHTYP                                              CRE020
     C                     MOVE 'N'       RSAPIN                                              CRE020
     C                     UPDATREADVCD0                                                      CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C           EIDXT     TAG                                                                CRE020
      *                                                                                       CRE020
     C                     MOVE WIN10     *IN10                                               CRE020
      *                                                                                       CRE020
     C                     CLOSEREADVCL2                                                      CRE020
      *                                                                                       CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C                     ENDSR                                                              CRE020
     C********************************************************************
     C*
     C*   ZTNLU1 SR. - TO LOCK THE TRANSACTION NUMBER DATA AREA AND
     C*                THEN UPDATE AND RELEASE THE DATA AREA.
     C*
     C           ZTNLU1    BEGSR
     C           *NAMVAR   DEFN MNATN     DNATN
     C           *LOCK     IN   DNATN
     C                     MOVE FNATN     NATN    50
     C                     MOVE FNATN     ZZWK05  50
     C                     ADD  1         ZZWK05
     C                     MOVE ZZWK05    FNATN
     C                     OUT  DNATN
     C                     ENDSR
     C********************************************************************
     C**   FILE EXCEPTION / ERROR HANDLING SUBROUTINE
     C           INFSR     BEGSR
     C**   CHECK ERROR TYPE
     C           STATUS    IFEQ 01021
     C**   CHAIN FILE TO GET CURRENT DETAILS
     C           STNKEY    CHAINSTAND                68
     C**
     C           *IN68     IFEQ '0'
     C**   ROLLBACK UPDATES ALREADY DONE
     C                     ROLBK
     C**   SET ON 'RECORD UPDATED BY ANOTHER WORKSTATION' INDICATOR
     C                     SETON                     82
     C**
     C**   RESET INDICATORS
     C                     SETOF                     677475
     C***********          SETOF                     858687               S01117
     C                     SETOF                     8586                 S01117
     C**
     C                     MOVE '*DETC '  EXTTAG  6
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     ELSE
     C**
     C                     MOVE '*CANCL'  EXTTAG
     C                     END
     C**
     C                     ENDSREXTTAG
     C********************************************************************
     C**
     C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
     C**
     C           ZSYSTM    BEGSR                           *** ZSYSTM ***
     C**
     C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
     C***********          MOVEL'01      'ZTABKY 12                       S01117
     C***********          MOVE '  10'    ZTABKY                          S01117
     C***********                                                         S01117
     C***********ZTABKY    CHAINTABLE                99    ON NOT THERE   S01117
     C**N99******RECI      COMP 'D'                  9999  ON, IS DELETED S01117
     C**
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON
     C**
     C                     ENDSR
     C**
     C********************************************************************
     C**
     C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND
     C**              CONVERT TO A NUMBER OF DAYS.
     C**
     C           ZDATE1    BEGSR                           *** ZDATE1 ***
     C**
     C**   CLEAR DAY NUMBER.
     C                     Z-ADD0         ZDAYNO  50
     C**
     C**   CALCULATION TO DEFINE INPUT DATE FIELD.
     C                     Z-ADDZDATE     ZDATE   60
     C**
     C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.
     C                     MOVE ZDATE     ZYEAR   20
     C  N98                MOVELZDATE     ZDAY    20
     C   98                MOVELZDATE     ZMTH    20
     C                     MOVE ZDATE     ZWRK4   40
     C  N98                MOVELZWRK4     ZMTH
     C   98                MOVELZWRK4     ZDAY
     C**
     C**   ENSURE MONTH IS VALID.
     C           ZMTH      COMP 0                      9999
     C  N99      ZMTH      COMP 12                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR 30 DAY MONTHS.
     C           ZMTH      COMP 4                        90IF 90 ON, 30
     C  N90      ZMTH      COMP 6                        90DAY MONTH.
     C  N90      ZMTH      COMP 9                        90
     C  N90      ZMTH      COMP 11                       90
     C**
     C**   ENSURE DAY IS VALID.
     C           ZDAY      COMP 0                      9999
     C   90N99   ZDAY      COMP 30                   99
     C  N90N99   ZDAY      COMP 31                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   CHECK FOR LEAP YEAR AND FEBRUARY.
     C           ZYEAR     ADD  28        ZYEAR
     C           ZYEAR     DIV  4         ZLYR    20
     C                     MVR            ZLY     10     91LEAP YR, 91 ON
     C           ZMTH      COMP 2                    93  92FEB., 92 ON
     C**                                                   PAST FEB, 93 ON
     C**   IF FEBUARY FURTHER VALIDATE DAY.
     C  N91 92   ZDAY      COMP 28                   99
     C   91 92   ZDAY      COMP 29                   99
     C   99                GOTO ZDEND1                     BYPASS IF ERROR
     C**
     C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANS
     C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.
     C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YR
     C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.
     C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR
     C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTH
     C**
     C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*
     C**
     C********************************************************************
     C**
     C**   ZALIGN SR. TO VALIDATE AND RIGHT-ALIGN NUMERIC FIELDS.
     C           ZALIGN    BEGSR                           *** ZALIGN ***
     C**
     C                     SETOF                     929399
     C**
     C**   SAVE INPUT FIELD IN ARRAY, ZA1.
     C                     MOVEAZFIELD    ZA1
     C**
     C**   CALCULATION TO DEFINE NUMBER STRUCTURE CONTROL FIELDS.
     C                     Z-ADDZADIG     ZADIG   20
     C                     Z-ADDZADEC     ZADEC   10
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ' '       ZA2
     C                     MOVEAZA2       ZFIELD 16
     C                     Z-ADD0         ZX      20
     C                     Z-ADD0         ZY      20
     C**
     C**   ENSURE REQUIRED STRUCTURE OF FIELD IS VALID.
     C           ZADIG     ADD  ZADEC     ZZ      20
     C           ZZ        COMP 15                   99
     C   99                GOTO ZAEND
     C**
     C**   LOOP TO FIND DECIMAL POINT, BLANKS AND CHARACTERS.
     C           ZATAG1    TAG                             ** ZATAG1 TAG *
     C           ZX        ADD  1         ZX
     C**
     C**   CHECK FOR DECIMAL POINT. ERROR IF SECOND DECIMAL POINT.
     C           ZA1,ZX    COMP '.'                      90
     C   90 93             SETON                     99
     C   99                GOTO ZAEND
     C**
     C**
     C**   CHECK FOR 'M' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'M'                      96
     C   96                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 9                    99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CHECK FOR 'T' CONSTANT. ERROR IF NOT LAST CHARACTER ENTERED
     C           ZA1,ZX    COMP 'T'                      97
     C   97                DO
     C           ZX        COMP 15                   99  99
     C   99                GOTO ZAEND
     C           ZX        ADD  1         ZX
     C           ZA1,ZX    COMP ' '                  9999
     C   99                GOTO ZAEND
     C           ZX        SUB  1         ZX
     C           ZX        COMP 12                   99
     C   99                GOTO ZAEND
     C                     END
     C**
     C**   CLEAR ALPHAMERIC CONSTANT FROM ZA1
     C   96
     COR 97                MOVE ' '       ZA1,ZX
     C**
     C**   CHECK FOR BLANKS. BYPASS FOR FIRST BLANK AFTER A DIGIT.
     C           ZA1,ZX    COMP ' '                      91
     C   91 92             GOTO ZATAG2
     C**
     C**   CHECK FOR NUMERIC, IF NOT '.' OR ' '.
     C  N90N91   ZA1,ZX    COMP '0'                    99
     C  N90N91N99ZA1,ZX    COMP '9'                  99
     C   99                GOTO ZAEND                      NOT NUMERIC
     C**
     C**   STORE DIGITS IN ARRAY AND HOW MANY.
     C**   ZY, TOTAL OF DIGITS IN THE INPUT FIELD.
     C**   ZZ, TOTAL OF DIGITS TO THE LEFT OF DECIMAL POINT.
     C  N90N91   ZY        ADD  1         ZY         92
     C  N90N91             MOVE ZA1,ZX    ZA2,ZY
     C   90                Z-ADDZY        ZZ         93  93
     C**
     C           ZX        COMP 16                     94  CHECK IF ALL
     C   94                GOTO ZATAG1
     C**
     C           ZATAG2    TAG                             ** ZATAG2 TAG *
     C**
     C**   IF 'M' SPECIFIED, MULTIPLY ZA1 BY 1 MILLION
     C   96      ZZ        ADD  6         ZZ
     C**
     C**   IF 'T' SPECIFIED, MULTIPLY ZA1 BY 1 THOUSAND
     C   97      ZZ        ADD  3         ZZ
     C**
     C**   FILL IN ZEROS IN ANY BLANKS LEFT OF DECIMAL POINT
     C   96 93
     COR 97 93   ZZ        DOWGTZY
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF CONSTANT SPECIFIED WITH NO DECIMAL POINT ZEROISE BLANKS
     C   96N93             DO   6
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C   97N93             DO   3
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C                     END
     C**
     C**   IF NO DECIMAL POINT FOUND, SET TOTAL FIELD ZZ.
     C  N93                Z-ADDZY        ZZ
     C**
     C**   CHECK FOR EMBEDDED BLANKS.
     C   91 92             MOVEAZA1,ZX    ZFIELD
     C   91 92   ZFIELD    COMP ' '                  9999
     C   99                GOTO ZAEND                      EMBEDDED BLANK
     C**
     C**   ENSURE THAT NUMBER OF DIGITS ENTERED EITHER SIDE
     C**   OF DECIMAL POINT ARE NOT MORE THAN ALLOWED.
     C           ZZ        COMP ZADIG                99
     C           ZY        SUB  ZZ        ZX
     C  N99      ZADEC     SUB  ZX        ZX           9995
     C   99                GOTO ZAEND
     C   95                GOTO ZATAG4                     NO TRAILING
     C**                                                   BLANKS.
     C**   FILL THE TRAILING BLANKS WITH ZEROS.
     C           ZY        ADD  ZX        ZZ
     C           ZATAG3    TAG                             ** ZATAG3 TAG *
     C           ZY        ADD  1         ZY
     C                     MOVE '0'       ZA2,ZY
     C           ZY        COMP ZZ                     94
     C   94                GOTO ZATAG3
     C**
     C**   RIGHT-ALIGN THE VALUE BY MOVING BACK TO ARRAY, ZA1.
     C           ZATAG4    TAG                             ** ZATAG4 TAG *
     C                     MOVE '0'       ZA1
     C                     Z-ADD16        ZX
     C           ZATAG5    TAG                             ** ZATAG5 TAG *
     C           ZY        COMP 0                        94
     C   94                GOTO ZATAG6
     C                     MOVE ZA2,ZY    ZA1,ZX
     C           ZY        SUB  1         ZY
     C           ZX        SUB  1         ZX
     C                     GOTO ZATAG5
     C           ZATAG6    TAG                             ** ZATAG6 TAG *
     C**
     C**   MOVE VALIDATED AND RIGHT-ALIGNED NUMBER BACK INTO ZFIELD.
     C                     MOVEAZA1       ZFIELD
     C**
     C                     SETOF                     9697
     C**
     C           ZAEND     ENDSR                           * ZAEND ENDSR *
     C**
     C********************************************************************
     C**
     C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
     C**
     C           ZDATE2    BEGSR                           *** ZDATE2 ***
     C**
     C**   CLEAR DATE FIELDS.
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C**
     C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C**
     C**   DETERMINE YEAR NUMBER.
     C**
     C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C**
     C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1           SAVE REMAINING
     C**                                                   DAYS
     C**   CALCULATE NUMBER OF REMAINING YEARS.
     C                     Z-ADD1         ZWRK2   20
     C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
     C**
     C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C**
     C**   CALCULATE ACTUAL YEAR NUMBER.
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
     C**
     C**   DETERMINE MONTH NUMBER.
     C**
     C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C**
     C**   CALCULATE MONTH NUMBER.
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C**
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C**
     C**   DETERMINE DAY OF MONTH.
     C**
     C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
     C           ZDAYN1    ADD  1         ZDAYN1
     C**
     C**   CALCULATE DAY OF MONTH.
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C**
     C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
     C   93      ZDAY      ADD  1         ZDAY
     C**
     C**   FORMAT DATE, DDMMYY OR MMDDYY.
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   FORMAT ALPHA DATE, DDMMMYY.
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C**
     C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
     C**
     C********************************************************************
     C**
     C*****ZFREQS SR. TO INCREMENT A DAY NUMBER DATE BY A                 S01195
     C**   FREQS SR. TO INCREMENT A DAY NUMBER DATE BY A                  S01195
     C**              PERIOD VALUE DETERMINED BY A CODE.
     C**
     C***********ZFREQS    BEGSR                           *** ZFREQS *** S01195
     C           FREQS     BEGSR                           *** FREQS  *** S01195
     C**
     C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.
     C                     MOVE ZFREQ     ZFREQ   1
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C                     Z-ADDZMDAY     ZMDAY   20
     C                     MOVE ZCCY      ZCCY    3
     C                     MOVE ZLOC      ZLOC    3                       S01195
     C**
     C***********          MOVE '   '     ZHC                             S01195
     C***********          MOVE ' '       ZTABKY 12                       S01195
     C**
     C**   CONVERT DAY NUMBER TO DATE.
     C                     EXSR ZDATE2
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE D-DAILY-WORKING DAY.
     C***********ZFREQ     COMP 'D'                      91               S01195
     C***91******ZDAYNO    ADD  1         ZDAYNO                          S01195
     C***91******          GOTO ZFHCHK                                    S01195
     C           ZFREQ     IFEQ 'D'                                       S01195
     C                     Z-ADD1         ZNRDYS                          S01195
     C                     EXSR ZFWDT                                     S01195
     C                     Z-ADDZDYNBR    ZDAYNO                          S01195
     C                     EXSR ZDATE2                                    LN0505
     C                     GOTO ZFEND                                     S01195
     C                     END                                            S01195
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE W-WEEKLY.
     C           ZFREQ     COMP 'W'                      91
     C   91      ZDAYNO    ADD  7         ZDAYNO
     C   91                EXSR ZDATE2                                    LN0505
     C   91                GOTO ZFEND
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE F-FORTNIGHTLY.
     C           ZFREQ     COMP 'F'                      91
     C   91      ZDAYNO    ADD  14        ZDAYNO
     C   91                EXSR ZDATE2                                    LN0505
     C   91                GOTO ZFEND
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE S-SEMI-MONTHLY.
     C           ZFREQ     COMP 'S'                      91
     C   91      ZDAY      COMP 15                   939292
     C   91 92             Z-ADD31        ZDAY
     C   91 93             Z-ADD15        ZDAY
     C   91 93   ZMTH      ADD  1         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE M-MONTHLY.
     C           ZFREQ     COMP 'M'                      91
     C   91                Z-ADDZMDAY     ZDAY
     C   91      ZMTH      ADD  1         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTH
     C           ZFREQ     COMP 'R'                      91
     C   91                Z-ADD31        ZDAY
     C   91      ZMTH      ADD  1         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE T-BIMONTHLY.
     C           ZFREQ     COMP 'T'                      91
     C   91                Z-ADDZMDAY     ZDAY
     C   91      ZMTH      ADD  2         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE Q-QUARTERLY.
     C           ZFREQ     COMP 'Q'                      91
     C   91                Z-ADDZMDAY     ZDAY
     C   91      ZMTH      ADD  3         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE X-SIX MONTHLY.
     C           ZFREQ     COMP 'X'                      91
     C   91                Z-ADDZMDAY     ZDAY
     C   91      ZMTH      ADD  6         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE Y-YEARLY.
     C           ZFREQ     COMP 'Y'                      91
     C   91                Z-ADDZMDAY     ZDAY
     C   91      ZYEAR     ADD  1         ZYEAR
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH.
     C           ZFREQ     COMP 'L'                      91
     C   91                Z-ADD31        ZDAY
     C   91      ZMTH      ADD  1         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.
     C           ZFREQ     COMP 'B'                      91
     C   91                Z-ADD31        ZDAY
     C   91      ZMTH      ADD  1         ZMTH
     C   91                GOTO ZFDATE
     C**
     C**   CHECK FOR AND INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.
     C*                                                                   S01194
     C*  ACCESS PROGRAM AOGELRR0 HAS ALREADY BEEN CALLED                  S01194
     C*  IN THE FIRST CYCLE                                               S01194
     C*                                                                   S01194
     C***********ZFREQ     COMP 'A'                      91               S01194
     C***********          MOVEL'01    '  ZTABKY                          S01194
     C***91******          MOVE '    11'  ZTABKY                          S01194
     C***91******ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
     C**N99******RECI      COMP '*'                      99               S01194
     C***91N99***          Z-ADDAPDA      ZDAYNO                          S01194
     C**********           Z-ADDBKAPDT    ZDAYNO                          S01194
     C**                                                                  LN0505
     C**   BYPASS IF ZFREQ IS 'A' OR ANY OTHER VALUE
     C                     GOTO ZFEND
     C**
     C**
     C**   REFORMAT DATE AND ENSURE VALID.
     C           ZFDATE    TAG                             ** ZFDATE TAG*
     C**
     C**   VALIDATE MONTH.
     C           ZMTH      COMP 12                   91
     C   91      ZMTH      SUB  12        ZMTH
     C   91      ZYEAR     ADD  1         ZYEAR
     C**
     C**   CHECK FOR LEAP YEAR.
     C           ZYEAR     DIV  4         ZLYR    20
     C                     MVR            ZLY     10     92LEAP YEAR-92 ON
     C**
     C**   VALIDATE DAY NUMBER.
     C                     MOVE ZFMD,ZMTH ZWRK2   20
     C           ZMTH      COMP 2                        93
     C   92 93             Z-ADD29        ZWRK2
     C**
     C           ZDAY      COMP ZWRK2                94
     C   94                Z-ADDZWRK2     ZDAY
     C**
     C**   CHECK IF CODE R, TO SUBTRACT 6 DAYS.
     C           ZFREQ     COMP 'R'                      91
     C   91      ZDAY      SUB  6         ZDAY
     C**
     C**   REFORMAT DATE, DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.
     C                     MOVELZDAY      ZWRK4   40
     C                     MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C   98                MOVE ZDAY      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C                     EXSR ZDATE1
     C**
     C**   CHECK IF CODE B,TO BE CHECKED FOR HOLIDAY.
     C           ZFREQ     COMP 'B'                      91
     C   91N99             GOTO ZFHCHK
     C**
     C                     GOTO ZFEND
     C**
     C**
     C**   CHECK IF DAY NUMBER IS A HOLIDAY.
     C           ZFHCHK    TAG                             ** ZFHCHK TAG *
     C**                                                                  S01195
     C**   IF FREQUENCY CODE IS 'B', BACK TO FIND THE NON-HOLIDAY         S01195
     C**   BEFORE THE SPECIFIED DAY NO.                                   S01195
     C**                                                                  S01195
     C                     Z-ADD0         ZNRDYS                          S01195
     C                     EXSR ZBKDT                                     S01195
     C                     Z-ADDZDYNBR    ZDAYNO                          S01195
     C*                                                                   S01195
     C***********          SETOF                     94                   S01195
     C***********                                                         S01195
     C*****DETERMINE CODE.                                                S01195
     C***********ZFREQ     COMP 'D'                      91               S01195
     C***********ZFREQ     COMP 'B'                      92               S01195
     C***********                                                         S01195
     C*****SET*KEY FOR FIRST HOLIDAY RECORD.                              S01195
     C***********          MOVEL'22    '  ZTABKY                          S01195
     C***********          MOVELZDAYNO    ZWRK6   6                       S01195
     C***********          MOVE 1         ZWRK6                           S01195
     C***********          MOVE ZWRK6     ZTABKY                          S01195
     C***********                                                         S01195
     C*****GET*HOLIDAY RECORD.                                            S01195
     C***********ZFHCHN    TAG                             ** ZFHCHN TAG* S01195
     C***********ZTABKY    CHAINTABLE                93    ON NOT THERE   S01195
     C**N93******RECI      COMP '*'                      93               S01195
     C**N94******          MOVE '   '     ZHC                             S01195
     C***********                                                         S01195
     C*****STORE*CURRENCIES IF RECORD FOUND.                              S01195
     C**N94N93***          MOVEAHCCY      ZHC,1                           S01195
     C***94N93***          MOVEAHCCY      ZHC,26                          S01195
     C***********                                                         S01195
     C*****GET*SECORD RECORD, IF NOT ALREADY DONE.                        S01195
     C***********          MOVE ZTABKY    ZWRK1   10                      S01195
     C***********ZWRK1     COMP 1                        94               S01195
     C***********          MOVE '2'       ZTABKY                          S01195
     C***94N93***          GOTO ZFHCHN                                    S01195
     C***********                                                         S01195
     C*****BYPASS TO END IF NO FIRST RECORD FOUND.                        S01195
     C***93*94***          GOTO ZFEND                                     S01195
     C***********                                                         S01195
     C*****DETERMINE HOLIDAY RECORD TYPE.                                 S01195
     C***********INEX      COMP 'E'                      95               S01195
     C***********INEX      COMP 'I'                      96               S01195
     C***********                                                         S01195
     C*****CHECK*IF CURRENCY ON HOLIDAY.                                  S01195
     C***********ZCCY      LOKUPZHC                      97               S01195
     C***********                                                         S01195
     C*****BYPASS IF NOT HOLIDAY FOR CURRENCY.                            S01195
     C***95*97***                                          EXCLUDE FOUND  S01195
     C*R*96N97***          GOTO ZFEND                      INCL. NOT FOUNDS01195
     C***********                                                         S01195
     C*****INCREMENT OR DECREMENT DAY NUMBER AS REQUIRED.                 S01195
     C***91*95N97                                          EXCL. NOT FOUNDS01195
     C*R*91*96*97ZDAYNO    ADD  1         ZDAYNO           INCLUDE FOUND  S01195
     C***********                                                         S01195
     C***92*95N97                                          EXCL. NOT FOUNDS01195
     C*R*92*96*97ZDAYNO    SUB  1         ZDAYNO           INCLUDE FOUND  S01195
     C***********          GOTO ZFHCHK                                    S01195
     C**
     C           ZFEND     ENDSR                           * ZFEND ENDSR *
     C**
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZACCH  --- SUBROUTINE TO ACCESS A HOLIDAY RECORD FOR A            S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: ZFWDT, ZBKDT                                         S01195
     C*                                                                   S01195
     C* CALLS: NOTHING                                                    S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZFWDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY            S01195
     C*            FORWARD FROM A GIVEN START DATE FOR ANY                S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: FREQS                                                S01195
     C*                                                                   S01195
     C* CALLS: ZACCH                                                      S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZFWDT                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZBKDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY            S01195
     C*            BACKWARD FROM A GIVEN START DATE FOR ANY               S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: FREQS                                                S01195
     C*                                                                   S01195
     C* CALLS: ZACCH                                                      S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZBKDT                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     CSR         GLZADD    BEGSR                           *** GLZADD ****
     C*
     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     CSR                   Z-ADDZZAMT     ZZWK1   33
     CSR                   MOVE ZZWK1     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     CSR                   EXSR GLZSUM
     CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C* SUBROUTINE TO SUBTRACT AN AMOUNT (ZZAMT) FROM THE TOTAL
     C*                                                   (ZZTOTI,ZZTOTD)
     C*  IND '99' IS SET BY AN OVERFLOW ERROR
     CSR         GLZSUB    BEGSR                           *** GLZSUB ****
     C* PROCESSING. JUST REVERSE THE 'SIGN' AND ADD
     CSR                   Z-SUBZZAMT     ZZAMT  153       REVERSE 'SIGN'
     CSR                   EXSR GLZADD                       AND 'ADD'
     CSR                   Z-SUBZZAMT     ZZAMT            RESTORE 'SIGN'
     CSR                   ENDSR
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     CSR         GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     CSR                   SETOF                     919293
     CSR                   SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     CSR         ZZAMTI    COMP 0                      9293
     CSR 93      ZZAMTD    COMP 0                      9293
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     CSR         ZZTOTI    COMP 0                      9193
     CSR 93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     CSR 93                Z-ADDZZAMTI    ZZTOTI
     CSR 93                Z-ADDZZAMTD    ZZTOTD
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     CSR 91N92
     CORN91 92             GOTO ZZOFPS
     C*
     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     CSRN99                Z-ADDZZWK2     ZZTOTD
     CSRN99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     CSR 99                Z-ADD0         ZZAMT  153
     CSR                   GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     CSR 91                Z-SUBZZTOTI    ZZTOTI
     CSR 91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     CSR         ZZTOTI    COMP ZZAMTI               93  95
     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     CSR 95                Z-ADD0         ZZTOTI
     CSR 95                Z-ADD0         ZZTOTD
     CSR 95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     CSR 93      ZZAMTD    COMP ZZTOTD               94
     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C* IF ZZAMT GT. ZZTOT.
     CSRN93      ZZTOTD    COMP ZZAMTD               94
     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     CSR                   SETOF                     94
     CSR 93 91
     CORN93 92             SETON                     94
     CSR 94                Z-SUBZZTOTI    ZZTOTI
     CSR 94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     CSR 92                Z-SUBZZAMTI    ZZAMTI
     CSR 92                Z-SUBZZAMTD    ZZAMTD
     CSR         ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     CSR                   SETOF                     96
     CSR         ZZTOTD    COMP 0                        91
     CSR 91      ZZTOTI    COMP 0                      96
     CSR 96                MOVE '.000-'   ZZNEGD  5
     CSR                   ENDSR                             ** ENDSR **
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0253CP13                                           S01408
     C*                                                                   S01408
     C********************************************************************
     C**                                                                  S01117
     C**   BRANCH CODE  VALIDATION :::                                    S01117
     C**     1. INPUT IS MANDATORY IF THE MULTIBRANCH INDICATOR ON        S01117
     C**        ELSE OPTIONAL.                                            S01117
     C**                                                                  S01117
     C**     2. BRANCH MUST BE VALID ON THE NEW BRANCH CODE STANDING      S01117
     C**        DATA.                                                     S01117
     C**                                                                  S01117
     C           BRCVAL    BEGSR                                          S01117
     C                     MOVE '0'       ERIND   1                       S01117
     C**                                                                  S01117
     C**  BRANCH CODE IF ENTERED MUST BE A VALID BRANCH                   S01117
     C           BRCDI     IFNE *BLANKS                                   S01117
     C           MBIN      ANDEQ'Y'                                       S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCDI     @DSNB   3                       S01117
     C                     PARM           SDBRCH                          S01117
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVE '1'       ERIND   1                       S01117
     C                     ELSE                                           LN0229
     C                     MOVE BRCA      BRCDI                           LN0229
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           BRCDI     IFEQ *BLANKS                                   S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C           DFBM      IFEQ *BLANKS                                   S01117
     C  N39                MOVE '1'       ERIND   1                       S01117
     C  N39                GOTO BRCDER                                    S01117
     C                     ELSE                                           S01117
     C  N39                MOVE DFBM      BRCDI            DEFAULT BRANCH S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           BRCDER    ENDSR                                          S01117
     C/COPY WNCPYSRC,RE0253C046
     C**                                                                  S01117
     C********************************************************************S01117
     C*     SUBROUTINE PRFCVL                                             S01117
     C*     TO CHECK IF THE ENTERED PROFIT CENTRE IS VALID                S01117
     C*     OR SUBSITITUE ANY DEFAULT VALUE IF NOT ENTERED.               S01117
     C*                                                                   S01117
     C*     CALLED    FROM MAIN                                           S01117
     C*     CALLS     AOPRFCR0, AOPRFMR0                                  S01117
     C*                                                                   S01117
     C           PRFCVL    BEGSR                           *** PRFCVL *** S01117
     C*                                                                   S01117
     C*  VALIDATE THE INPUT PROFIT CENTRE IF ENTERED                      S01117
     C*                                                                   S01117
     C           BGN0ST    IFEQ 'Y'                        *B0            176510
     C           IPRFC     IFNE *BLANK                     *B1            S01117
     C*********  BGN0ST    OREQ 'Y'                                120827 176510
     C                     MOVE *BLANKS   @KEY                            S01117
     C                     CALL 'AOPRFCR0'                                S01117
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY    '@OPTN   7                       S01117
     C                     PARM IPRFC     @KEY    4                       S01117
     C**********           PARM           SDPRFC                          LN0056
     C           SDPRFC    PARM SDPRFC    DSFDY                           LN0056
     C           @RTCD     IFNE *BLANK                     *B2            S01117
     C           X         ADD  1         X          43                   S01117
     C                     MOVE '132'     ERCD,X                          S01117
     C                     SETOF                     81                   S01117
     C                     ELSE                                           LN0056
     C                     MOVELDSPCCD    IPRFC                           LN0056
     C                     END                             *E2            S01117
     C*                                                                   S01117
     C                     ELSE                            *X1            S01117
     C*                                                                   S01117
     C** ELSE /* PROFIT CENTRE IS USED BUT NOT ENTERED */ :-              S01117
     C** EXTRACT THE DEFAULT PROFIT CENTRE IF INPUT PROFIT CENTRE IS      S01117
     C** BLANK AND PROFIT CENTRE USED FLAG IS ON AND DEFAULT FLAG IS      S01117
     C** ALSO ON.                                                         S01117
     C** FOLLOWING BASE FIELDS ARE PASSED TO AOPRFMR0 :                   S01117
     C** BRANCH CODE - DWBRCD                                             S01117
     C** CUSTOMER    - DWCUST                                             S01117
     C** USER        - DWUSID                                             S01117
     C** Account Off - DWACOF                                             176510
     C*                                                                   S01117
     C                     MOVE BRCASF    DWBRCD                          S01117
     C                     MOVE DCUSSF    DWCUST                          S01117
     C                     MOVE USRPRF    DWUSID                          S01117
     C                     MOVE DACOFF    DWACOF                          176510
     C*                                                                   S01117
     C           PFCD      IFEQ 'Y'                        *B2            S01117
     C                     CALL 'AOPRFMR0'                                S01117
     C                     PARM *BLANKS   RTCDPR  1                       S01117
     C                     PARM *BLANKS   BOOKPR  2                       S01117
     C                     PARM *BLANKS   TRTPPR  5                       LN0229
     C                     PARM *BLANKS   SUTPPR  2                       S01117
     C                     PARM DWBRCD    BRANPR  3                       S01117
     C                     PARM *BLANKS   DEPTPR  3                       S01117
     C                     PARM DWUSID    USERPR 10                       S01117
     C******************** PARM *BLANKS   ACOFPR  2                S01117 176510
     C                     PARM DWACOF    ACOFPR  2                       176510
     C                     PARM DWCUST    CNUMPR  6                       S01117
     C                     PARM *BLANKS   PRFCPR  4                       S01117
     C           RTCDPR    IFEQ '0'                        *B3            S01117
     C                     MOVE PRFCPR    IPRFC                           S01117
     C                     ELSE                                           S01117
     C           RTCDPR    IFEQ '2'                        *B4            S01117
     C                     MOVE PRFCPR    IPRFC                           S01117
     C                     SETON                     99                   S01117
     C***********          ELSE                            *X4            S01117
     C***********          MOVEL'SDPRFMPD'DBFILE       *************S01117RT0067
     C***********          Z-ADD6         DBASE        * DBERR 006 *S01117RT0067
     C***********          EXSR *PSSR                  *************S01117RT0067
     C***********          SETON                     41             S01117RT0067
     C***********          SETON                     U7U8LR         S01117RT0067
     C                     END                             *E4            S01117
     C                     END                             *E3            S01117
     C                     END                             *E2            S01117
     C                     END                             *E1            S01117
     C                     END                             *E0            176510
     C*                                                                   S01117
     C                     ENDSR                                          S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C****************************************************************    S01117
     O**
     O**   D I S P L A Y   S C R E E N   O U T P U T
     ORE0253FME        02N83 62SCRN2                                      092560
     O       OR        03N83 62                                           092560
     O                                   K8 'RE0253F2'                    092560
     O                         SFCODE     2                               092560
     O                      N17           2 'SF'                          092560
     O                         MTIME     10 '  .  .  '                    092560
     O                         WSID      13                               092560
     O                         HELDSF    18                               092560
     O                         HLDACT    19                               092560
     O**                                                                  092560
     O**   FIELDS FROM SCREEN.                                            092560
     O                       09DBRCSF    22                               092560
     O                       09DCUSSF    28                               092560
     O                       09CCYDR     31                               092560
     O**********             09ACODDR    35                                            092560 CGL029
     O**********             09DACSSF    37                                            092560 CGL029
     O**********             09DRACSF    47                                            092560 CGL029
     O**********             09CBRCSF    50                                            092560 CGL029
     O**********             09CCUSSF    56                                            092560 CGL029
     O**********             09CCYCR     59                                            092560 CGL029
     O**********             09ACODCR    63                                            092560 CGL029
     O**********             09CACSSF    65                                            092560 CGL029
     O**********             09CRACSF    75                                            092560 CGL029
     O**********             09IPRFC     79                                            092560 CGL029
     O**********             09PNARSF   109                                            092560 CGL029
     O**********             09CCYSF    112                                            092560 CGL029
     O**********             09PAYFSF   113                                            092560 CGL029
     O**********             09FDATSF   119                                            092560 CGL029
     O**********             09FAMTSF   133                                            092560 CGL029
     O**********             09SDATSF   139                                            092560 CGL029
     O**********             09SAMTSF   153                                            092560 CGL029
     O**********             09LDATSF   159                                            092560 CGL029
     O**********             09LAMTSF   173                                            092560 CGL029
     O**********             09PAYEE    193                                            092560 CGL029
     O**********             09PAYRSF   213                                            092560 CGL029
     O**********             09ISWCR    229                                            092560 CGL029
     O**********             09PYB1SF   249                                            092560 CGL029
     O**********             09PYB2SF   269                                            092560 CGL029
     O**********             09PAYASF   279                                            092560 CGL029
     O**********             09PAYMTH   280                                            092560 CGL029
     O**********             09ERCD     356                                            092560 CGL029
     O**********             09MES,E    432                                            092560 CGL029
     O**********             09BRCASF   441                                            092560 CGL029
     O**********             09DYTPSF   443                                            092560 CGL029
     O                       09ACODDR    41                                                   CGL029
     O                       09DACSSF    43                                                   CGL029
     O                       09DRACSF    53                                                   CGL029
     O                       09CBRCSF    56                                                   CGL029
     O                       09CCUSSF    62                                                   CGL029
     O                       09CCYCR     65                                                   CGL029
     O                       09ACODCR    75                                                   CGL029
     O                       09CACSSF    77                                                   CGL029
     O                       09CRACSF    87                                                   CGL029
     O                       09IPRFC     91                                                   CGL029
     O**********             09PNARSF   126                                            CGL029 CRE020
     O                 09N18   PNARSF   126                                                   CRE020
     O                 09 18   PANASF   486                                                   CRE020
     O                       09CCYSF    129                                                   CGL029
     O                       09PAYFSF   130                                                   CGL029
     O                       09FDATSF   136                                                   CGL029
     O                       09FAMTSF   150                                                   CGL029
     O                       09SDATSF   156                                                   CGL029
     O                       09SAMTSF   170                                                   CGL029
     O                       09LDATSF   176                                                   CGL029
     O                       09LAMTSF   190                                                   CGL029
     O                       09PAYEE    210                                                   CGL029
     O                       09PAYRSF   230                                                   CGL029
     O                       09ISWCR    246                                                   CGL029
     O                       09PYB1SF   266                                                   CGL029
     O                       09PYB2SF   286                                                   CGL029
     O                       09PAYASF   296                                                   CGL029
     O                       09PAYMTH   297                                                   CGL029
     O                       09ERCD     373                                                   CGL029
     O                       09MES,E    449                                                   CGL029
     O                       09BRCASF   458                                                   CGL029
     O                       09DYTPSF   460                                                   CGL029
     O                    09 26DBRCO     22                               092560
     O**********          09 20CBRCO     50                                            092560 CGL029
     O                    09 20CBRCO     56                                                   CGL029
     ORE0253FMD        01N83 64
     O       OR        02N83 64
     O       OR        03N83 64
     O       OR        04N83 64
     O       OR        05N83 64
     O                                   K8 'RE0253F1'
     O                         SFCODE     2
     O                         MTIME     10 '  .  .  '
     O                         WSID      13
     O                         ERCD      89
     O                         MES,E    165
     O                         STORSF   170
     O                         ACTION   171
     ORE0253FMD        01N83 62
     O       OR        02N83 62
     O       OR        03N83 62
     O       OR        04N83 62
     O                                   K8 'RE0253F2'
     O                         SFCODE     2
     O                      N17           2 'SF'
     O                         MTIME     10 '  .  .  '
     O                         WSID      13
     O                         HELDSF    18
     O                         HLDACT    19
     O*****                  09INBRCH    22                               S01117
     O**
     O**   FIELDS FROM SCREEN.
     O                       09DBRCSF    22                               S01117
     O                       09DCUSSF    28
     O                       09CCYDR     31
     O**********             09ACODDR    35                                                   CGL029
     O**********             09DACSSF    37                                                   CGL029
     O**********             09DRACSF    47                                                   CGL029
     O                       09ACODDR    41                                                   CGL029
     O                       09DACSSF    43                                                   CGL029
     O                       09DRACSF    53                                                   CGL029
     O*****                  09CCUSSF    53                               S01117
     O*****                  09CCYCR     56                               S01117
     O*****                  09ACODCR    60                               S01117
     O*****                  09CACSSF    62                               S01117
     O*****                  09CRACSF    72                               S01117
     O*****                  09PNARSF   102                               S01117
     O*****                  09CCYSF    105                               S01117
     O*****                  09PAYFSF   106                               S01117
     O*****                  09FDATSF   112                               S01117
     O*****                  09FAMTSF   126                               S01117
     O*****                  09SDATSF   132                               S01117
     O*****                  09SAMTSF   146                               S01117
     O*****                  09LDATSF   152                               S01117
     O*****                  09LAMTSF   166                               S01117
     O*****                  09PAYEE    186                               S01117
     O*****                  09PAYRSF   206                               S01117
     O******                 09PYB1SF   226                               S05452
     O******                 09PYB2SF   246                               S05452
     O******                 09PAYASF   256                               S05452
     O******                 09PAYMTH   257                               S05452
     O******                   ERCD     333                               S05452
     O******                   MES,E    409                               S05452
     O***********            09ISWCR    222                         S05452S01117
     O***********            09PYB1SF   242                         S05452S01117
     O***********            09PYB2SF   262                         S05452S01117
     O***********            09PAYASF   272                         S05452S01117
     O***********            09PAYMTH   273                         S05452S01117
     O***********              ERCD     349                         S05452S01117
     O***********              MES,E    425                         S05452S01117
     O**********             09CBRCSF    50                                            S01117 CGL029
     O**********             09CCUSSF    56                                            S01117 CGL029
     O**********             09CCYCR     59                                            S01117 CGL029
     O**********             09ACODCR    63                                            S01117 CGL029
     O**********             09CACSSF    65                                            S01117 CGL029
     O**********             09CRACSF    75                                            S01117 CGL029
     O**********             09IPRFC     79                                            S01117 CGL029
     O                       09CBRCSF    56                                                   CGL029
     O                       09CCUSSF    62                                                   CGL029
     O                       09CCYCR     65                                                   CGL029
     O                       09ACODCR    75                                                   CGL029
     O                       09CACSSF    77                                                   CGL029
     O                       09CRACSF    87                                                   CGL029
     O                       09IPRFC     91                                                   CGL029
     O***********************09PNARSF   109                        S01117 S01466
     O***********************09CCYSF    112                        S01117 S01466
     O***********************09PAYFSF   113                        S01117 S01466
     O***********************09FDATSF   119                        S01117 S01466
     O***********************09FAMTSF   133                        S01117 S01466
     O***********************09SDATSF   139                        S01117 S01466
     O***********************09SAMTSF   153                        S01117 S01466
     O***********************09LDATSF   159                        S01117 S01466
     O***********************09LAMTSF   173                        S01117 S01466
     O***********************09PAYEE    193                        S01117 S01466
     O***********************09PAYRSF   213                        S01117 S01466
     O***********************09ISWCR    229                        S01117 S01466
     O***********************09PYB1SF   249                        S01117 S01466
     O***********************09PYB2SF   269                        S01117 S01466
     O***********************09PAYASF   279                        S01117 S01466
     O***********************09PAYMTH   280                        S01117 S01466
     O*************************ERCD     356                        S01117 S01466
     O*************************MES,E    432                        S01117 S01466
     O***********************09BRCASF   441                        S01117 S01466
     O**********             09TRATSF    84                                            S01466 CGL029
     O**********             09PNARSF   114                                            S01466 CGL029
     O**********             09CCYSF    117                                            S01466 CGL029
     O**********             09PAYFSF   118                                            S01466 CGL029
     O**********             09FDATSF   124                                            S01466 CGL029
     O**********             09FAMTSF   138                                            S01466 CGL029
     O**********             09SDATSF   144                                            S01466 CGL029
     O**********             09SAMTSF   158                                            S01466 CGL029
     O**********             09LDATSF   164                                            S01466 CGL029
     O**********             09LAMTSF   178                                            S01466 CGL029
     O**********             09PAYEE    198                                            S01466 CGL029
     O**********             09PAYRSF   218                                            S01466 CGL029
     O**********             09ISWCR    234                                            S01466 CGL029
     O**********             09PYB1SF   254                                            S01466 CGL029
     O**********             09PYB2SF   274                                            S01466 CGL029
     O**********             09PAYASF   284                                            S01466 CGL029
     O**********             09PAYMTH   285                                            S01466 CGL029
     O**********               ERCD     361                                            S01466 CGL029
     O**********               MES,E    437                                            S01466 CGL029
     O**********             09BRCASF   446                                            S01466 CGL029
     O                       09TRATSF    96                                                   CGL029
     O**********             09PNARSF   126                                            CGL029 CRE020
     O                 09N18   PNARSF   126                                                   CRE020
     O                 09 18   PANASF   486                                                   CRE020
     O                       09CCYSF    129                                                   CGL029
     O                       09PAYFSF   130                                                   CGL029
     O                       09FDATSF   136                                                   CGL029
     O                       09FAMTSF   150                                                   CGL029
     O                       09SDATSF   156                                                   CGL029
     O                       09SAMTSF   170                                                   CGL029
     O                       09LDATSF   176                                                   CGL029
     O                       09LAMTSF   190                                                   CGL029
     O                       09PAYEE    210                                                   CGL029
     O                       09PAYRSF   230                                                   CGL029
     O                       09ISWCR    246                                                   CGL029
     O                       09PYB1SF   266                                                   CGL029
     O                       09PYB2SF   286                                                   CGL029
     O                       09PAYASF   296                                                   CGL029
     O                       09PAYMTH   297                                                   CGL029
     O                         ERCD     373                                                   CGL029
     O                         MES,E    449                                                   CGL029
     O                       09BRCASF   458                                                   CGL029
     O                    09 25DBRCO     22                               S01117
     O                    09 26DBRCO     22                               LN0229
     O**********          09 20CBRCO     50                                            S01117 CGL029
     O                    09 20CBRCO     56                                                   CGL029
     O**
     O**   FIELDS FROM STAND FILE.
     O*****                  41BRCDST    22                               S01117
     O                       41BRCDD     22                               S01117
     O                    26 41DCUSSC    28
     O                    26 41DCCYSC    31
     O**********          26 41DACDSC    35                                                   CGL029
     O**********          26 41DACSSC    37                                                   CGL029
     O                    26 41DACDSC    41                                                   CGL029
     O                    26 41DACSSC    43                                                   CGL029
     O*****              N26 41BLK15     37                               S01117
     O**********         N26 41BLK18     37                                            S01117 CGL029
     O**********             41DRACSC    47                                                   CGL029
     O**********          16 41BLK10     47                                                   CGL029
     O                   N26 41BLK18     43                                                   CGL029
     O                       41DRACSC    53                                                   CGL029
     O                    16 41BLK10     53                                                   CGL029
     O*****               31 41CCUSSC    53                               S01117
     O*****               31 41DCCYSC    56                               S01117
     O*****               31 41CACDSC    60                               S01117
     O*****               31 41CACSSC    62                               S01117
     O*****              N31 41BLK15     62                               S01117
     O*****                  41CRACSC    72                               S01117
     O*****               16 41BLK10     72                               S01117
     O*****                  41PNARSC   102                               S01117
     O*****                  41DCCYSC   105                               S01117
     O*****                  41PAYFSC   106                               S01117
     O*****                  41FDATSC   112                               S01117
     O*****               76 41         113 ' '                           S01117
     O*****               76 41AFPY     126 '           0 '               S01117
     O*****               77 41AFPY     126 '          0 . '              S01117
     O*****               78 41AFPY     126 '         0 .  '              S01117
     O*****               79 41AFPY     126 '        0 .   '              S01117
     O*****                  41SDATSC   132                               S01117
     O*****               76 41         133 ' '                           S01117
     O*****               76 41ASPY     146 '           0 '               S01117
     O*****               77 41ASPY     146 '          0 . '              S01117
     O*****               78 41ASPY     146 '         0 .  '              S01117
     O*****               79 41ASPY     146 '        0 .   '              S01117
     O*****               69 41BLNK14   146                               S01117
     O*****                  41LDATSC   152                               S01117
     O*****               76 41         153 ' '                           S01117
     O*****               76 41ALPY     166 '           0 '               S01117
     O*****               77 41ALPY     166 '          0 . '              S01117
     O*****               78 41ALPY     166 '         0 .  '              S01117
     O*****               79 41ALPY     166 '        0 .   '              S01117
     O*****               70 41BLNK14   166                               S01117
     O*****                  41PNAM     186                               S01117
     O*****                  41PAYR     206                               S01117
     O******                 41PYB1     226                               S05452
     O******                 41PYB2     246                               S05452
     O******                 41PAYA     256                               S05452
     O******                 41METHSC   257                               S05452
     O******                 41NPDTSC   263                               S05452
     O******                 41LPDTSC   269                               S05452
     O***********            41OSWCR    222                         S05452S01117
     O***********            41PYB1     242                         S05452S01117
     O***********            41PYB2     262                         S05452S01117
     O***********            41PAYA     272                         S05452S01117
     O***********            41METHSC   273                         S05452S01117
     O***********            41NPDTSC   279                         S05452S01117
     O***********            41LPDTSC   285                         S05452S01117
     O**********             41BRCDC     50                                            S01117 CGL029
     O**********          31 41CCUSSC    56                                            S01117 CGL029
     O**********          31 41DCCYSC    59                                            S01117 CGL029
     O**********          31 41CACDSC    63                                            S01117 CGL029
     O**********          31 41CACSSC    65                                            S01117 CGL029
     O**********         N31 41BLK18     65                                            S01117 CGL029
     O**********             41CRACSC    75                                            S01117 CGL029
     O**********          16 41BLK10     75                                            S01117 CGL029
     O**********             41PRFC      79                                            S01117 CGL029
     O                       41BRCDC     56                                                   CGL029
     O                    31 41CCUSSC    62                                                   CGL029
     O                    31 41DCCYSC    65                                                   CGL029
     O                    31 41CACDSC    75                                                   CGL029
     O                    31 41CACSSC    77                                                   CGL029
     O                   N31 41BLK18     77                                                   CGL029
     O                       41CRACSC    87                                                   CGL029
     O                    16 41BLK10     87                                                   CGL029
     O                       41PRFC      91                                                   CGL029
     O***********************41PNARSC   109                        S01117 S01466
     O***********************41DCCYSC   112                        S01117 S01466
     O***********************41PAYFSC   113                        S01117 S01466
     O***********************41FDATSC   119                        S01117 S01466
     O********************76 41         120 ' '                    S01117 S01466
     O********************76 41AFPY     133 '           0 '        S01117 S01466
     O********************77 41AFPY     133 '          0 . '       S01117 S01466
     O********************78 41AFPY     133 '         0 .  '       S01117 S01466
     O********************79 41AFPY     133 '        0 .   '       S01117 S01466
     O***********************41SDATSC   139                        S01117 S01466
     O********************76 41         140 ' '                    S01117 S01466
     O********************76 41ASPY     153 '           0 '        S01117 S01466
     O********************77 41ASPY     153 '          0 . '       S01117 S01466
     O********************78 41ASPY     153 '         0 .  '       S01117 S01466
     O********************79 41ASPY     153 '        0 .   '       S01117 S01466
     O********************69 41BLNK14   153                        S01117 S01466
     O***********************41LDATSC   159                        S01117 S01466
     O********************76 41         160 ' '                    S01117 S01466
     O********************76 41ALPY     173 '           0 '        S01117 S01466
     O********************77 41ALPY     173 '          0 . '       S01117 S01466
     O********************78 41ALPY     173 '         0 .  '       S01117 S01466
     O********************79 41ALPY     173 '        0 .   '       S01117 S01466
     O********************70 41BLNK14   173                        S01117 S01466
     O***********************41PNAM     193                        S01117 S01466
     O***********************41PAYR     213                        S01117 S01466
     O***********************41OSWCR    229                        S01117 S01466
     O***********************41PYB1     249                        S01117 S01466
     O***********************41PYB2     269                        S01117 S01466
     O***********************41PAYA     279                        S01117 S01466
     O***********************41METHSC   280                        S01117 S01466
     O***********************41NPDTSC   286                        S01117 S01466
     O***********************41LPDTSC   292                        S01117 S01466
     O***********************41TXBRCA   441                        S01117 S01466
     O**********             41TRATSC    84                                            S01466 CGL029
     O**********             41PNARSC   114                                            S01466 CGL029
     O**********             41DCCYSC   117                                            S01466 CGL029
     O**********             41PAYFSC   118                                            S01466 CGL029
     O**********             41FDATSC   124                                            S01466 CGL029
     O**********          76 41         125 ' '                                        S01466 CGL029
     O**********          76 41AFPY     138 '           0 '                            S01466 CGL029
     O**********          77 41AFPY     138 '          0 . '                           S01466 CGL029
     O**********          78 41AFPY     138 '         0 .  '                           S01466 CGL029
     O**********          79 41AFPY     138 '        0 .   '                           S01466 CGL029
     O**********             41SDATSC   144                                            S01466 CGL029
     O**********          76 41         145 ' '                                        S01466 CGL029
     O**********          76 41ASPY     158 '           0 '                            S01466 CGL029
     O**********          77 41ASPY     158 '          0 . '                           S01466 CGL029
     O**********          78 41ASPY     158 '         0 .  '                           S01466 CGL029
     O**********          79 41ASPY     158 '        0 .   '                           S01466 CGL029
     O**********          69 41BLNK14   158                                            S01466 CGL029
     O**********             41LDATSC   164                                            S01466 CGL029
     O**********          76 41         165 ' '                                        S01466 CGL029
     O**********          76 41ALPY     178 '           0 '                            S01466 CGL029
     O**********          77 41ALPY     178 '          0 . '                           S01466 CGL029
     O**********          78 41ALPY     178 '         0 .  '                           S01466 CGL029
     O**********          79 41ALPY     178 '        0 .   '                           S01466 CGL029
     O**********          70 41BLNK14   178                                            S01466 CGL029
     O**********             41PNAM     198                                            S01466 CGL029
     O**********             41PAYR     218                                            S01466 CGL029
     O**********             41OSWCR    234                                            S01466 CGL029
     O**********             41PYB1     254                                            S01466 CGL029
     O**********             41PYB2     274                                            S01466 CGL029
     O**********             41PAYA     284                                            S01466 CGL029
     O**********             41METHSC   285                                            S01466 CGL029
     O**********             41NPDTSC   291                                            S01466 CGL029
     O**********             41LPDTSC   297                                            S01466 CGL029
     O**********             41TXBRCA   446                                            S01466 CGL029
     O                       41TRATSC    96                                                   CGL029
     O                       41PNARSC   126                                                   CGL029
     O                       41DCCYSC   129                                                   CGL029
     O                       41PAYFSC   130                                                   CGL029
     O                       41FDATSC   136                                                   CGL029
     O                    76 41         137 ' '                                               CGL029
     O                    76 41AFPY     150 '           0 '                                   CGL029
     O                    77 41AFPY     150 '          0 . '                                  CGL029
     O                    78 41AFPY     150 '         0 .  '                                  CGL029
     O                    79 41AFPY     150 '        0 .   '                                  CGL029
     O                       41SDATSC   156                                                   CGL029
     O                    76 41         157 ' '                                               CGL029
     O                    76 41ASPY     170 '           0 '                                   CGL029
     O                    77 41ASPY     170 '          0 . '                                  CGL029
     O                    78 41ASPY     170 '         0 .  '                                  CGL029
     O                    79 41ASPY     170 '        0 .   '                                  CGL029
     O                    69 41BLNK14   170                                                   CGL029
     O                       41LDATSC   176                                                   CGL029
     O                    76 41         177 ' '                                               CGL029
     O                    76 41ALPY     190 '           0 '                                   CGL029
     O                    77 41ALPY     190 '          0 . '                                  CGL029
     O                    78 41ALPY     190 '         0 .  '                                  CGL029
     O                    79 41ALPY     190 '        0 .   '                                  CGL029
     O                    70 41BLNK14   190                                                   CGL029
     O                       41PNAM     210                                                   CGL029
     O                       41PAYR     230                                                   CGL029
     O                       41OSWCR    246                                                   CGL029
     O                       41PYB1     266                                                   CGL029
     O                       41PYB2     286                                                   CGL029
     O                       41PAYA     296                                                   CGL029
     O                       41METHSC   297                                                   CGL029
     O                       41NPDTSC   303                                                   CGL029
     O                       41LPDTSC   309                                                   CGL029
     O                       41TXBRCA   458                                                   CGL029
     O**
     O*****                  82BRCDST    22                               S01117
     O                       82BRCDD     22                               S01117
     O                       82DCUSSC    28
     O                       82CCY       31
     O**********             82DACDSC    35                                                   CGL029
     O**********             82DACSSC    37                                                   CGL029
     O**********             82DRACSC    47                                                   CGL029
     O                       82DACDSC    41                                                   CGL029
     O                       82DACSSC    43                                                   CGL029
     O                       82DRACSC    53                                                   CGL029
     O*****                  82CCUSSC    53                               S01117
     O*****                  82CCY       56                               S01117
     O*****                  82CACDSC    60                               S01117
     O*****                  82CACSSC    62                               S01117
     O*****                  82CRACSC    72                               S01117
     O*****                  82PNARSC   102                               S01117
     O*****                  82CCY      105                               S01117
     O*****                  82PAYFSC   106                               S01117
     O*****                  82FDATSC   112                               S01117
     O*****               76 82         113 ' '                           S01117
     O*****               76 82AFPY     126 '           0 '               S01117
     O*****               77 82AFPY     126 '          0 . '              S01117
     O*****               78 82AFPY     126 '         0 .  '              S01117
     O*****               79 82AFPY     126 '        0 .   '              S01117
     O*****                  82SDATSC   132                               S01117
     O*****               76 82         133 ' '                           S01117
     O*****               76 82ASPY     146 '           0 '               S01117
     O*****               77 82ASPY     146 '          0 . '              S01117
     O*****               78 82ASPY     146 '         0 .  '              S01117
     O*****               79 82ASPY     146 '        0 .   '              S01117
     O*****               69 82BLNK14   146                               S01117
     O*****                  82LDATSC   152                               S01117
     O*****               76 82         153 ' '                           S01117
     O*****               76 82ALPY     166 '           0 '               S01117
     O*****               77 82ALPY     166 '          0 . '              S01117
     O*****               78 82ALPY     166 '         0 .  '              S01117
     O*****               79 82ALPY     166 '        0 .   '              S01117
     O*****               70 82BLNK14   166                               S01117
     O*****                  82PNAM     186                               S01117
     O*****                  82PAYR     206                               S01117
     O******                 82PYB1     226                               S05452
     O******                 82PYB2     246                               S05452
     O******                 82PAYA     256                               S05452
     O******                 82METHSC   257                               S05452
     O******              01 36BLK238   257                               S05452
     O***********            82OSWCR    222                         S05452S01117
     O***********            82PYB1     242                         S05452S01117
     O***********            82PYB2     262                         S05452S01117
     O***********            82PAYA     272                         S05452S01117
     O***********            82METHSC   273                         S05452S01117
     O***********         01 36BLK254   273                         S05452S01117
     O**********             82BRCDC     50                                            S01117 CGL029
     O**********             82CCUSSC    56                                            S01117 CGL029
     O**********             82CCY       59                                            S01117 CGL029
     O**********             82CACDSC    63                                            S01117 CGL029
     O**********             82CACSSC    65                                            S01117 CGL029
     O**********             82CRACSC    75                                            S01117 CGL029
     O**********             82PRFC      79                                            S01117 CGL029
     O                       82BRCDC     56                                                   CGL029
     O                       82CCUSSC    62                                                   CGL029
     O                       82CCY       65                                                   CGL029
     O                       82CACDSC    75                                                   CGL029
     O                       82CACSSC    77                                                   CGL029
     O                       82CRACSC    87                                                   CGL029
     O                       82PRFC      91                                                   CGL029
     O***********************82PNARSC   109                        S01117 S01466
     O***********************82CCY      112                        S01117 S01466
     O***********************82PAYFSC   113                        S01117 S01466
     O***********************82FDATSC   119                        S01117 S01466
     O********************76 82         120 ' '                    S01117 S01466
     O********************76 82AFPY     133 '           0 '        S01117 S01466
     O********************77 82AFPY     133 '          0 . '       S01117 S01466
     O********************78 82AFPY     133 '         0 .  '       S01117 S01466
     O********************79 82AFPY     133 '        0 .   '       S01117 S01466
     O***********************82SDATSC   139                        S01117 S01466
     O********************76 82         140 ' '                    S01117 S01466
     O********************76 82ASPY     153 '           0 '        S01117 S01466
     O********************77 82ASPY     153 '          0 . '       S01117 S01466
     O********************78 82ASPY     153 '         0 .  '       S01117 S01466
     O********************79 82ASPY     153 '        0 .   '       S01117 S01466
     O********************69 82BLNK14   153                        S01117 S01466
     O***********************82LDATSC   159                        S01117 S01466
     O********************76 82         160 ' '                    S01117 S01466
     O********************76 82ALPY     173 '           0 '        S01117 S01466
     O********************77 82ALPY     173 '          0 . '       S01117 S01466
     O********************78 82ALPY     173 '         0 .  '       S01117 S01466
     O********************79 82ALPY     173 '        0 .   '       S01117 S01466
     O********************70 82BLNK14   173                        S01117 S01466
     O***********************82PNAM     193                        S01117 S01466
     O***********************82PAYR     213                        S01117 S01466
     O***********************82OSWCR    229                        S01117 S01466
     O***********************82PYB1     249                        S01117 S01466
     O***********************82PYB2     269                        S01117 S01466
     O***********************82PAYA     279                        S01117 S01466
     O***********************82METHSC   280                        S01117 S01466
     O***********************82TXBRCA   441                        S01117 S01466
     O********************01 36BLK245   264                        S01117 S01466
     O********************01 36BLK16    280                        S01117 S01466
     O********************01 36BLK3     441                        S01117 S01466
     O**********             82TRATSC    84                                            S01466 CGL029
     O**********             82PNARSC   114                                            S01466 CGL029
     O**********             82CCY      117                                            S01466 CGL029
     O**********             82PAYFSC   118                                            S01466 CGL029
     O**********             82FDATSC   124                                            S01466 CGL029
     O**********          76 82         125 ' '                                        S01466 CGL029
     O**********          76 82AFPY     138 '           0 '                            S01466 CGL029
     O**********          77 82AFPY     138 '          0 . '                           S01466 CGL029
     O**********          78 82AFPY     138 '         0 .  '                           S01466 CGL029
     O**********          79 82AFPY     138 '        0 .   '                           S01466 CGL029
     O**********             82SDATSC   144                                            S01466 CGL029
     O**********          76 82         145 ' '                                        S01466 CGL029
     O**********          76 82ASPY     158 '           0 '                            S01466 CGL029
     O**********          77 82ASPY     158 '          0 . '                           S01466 CGL029
     O**********          78 82ASPY     158 '         0 .  '                           S01466 CGL029
     O**********          79 82ASPY     158 '        0 .   '                           S01466 CGL029
     O**********          69 82BLNK14   158                                            S01466 CGL029
     O**********             82LDATSC   164                                            S01466 CGL029
     O**********          76 82         165 ' '                                        S01466 CGL029
     O**********          76 82ALPY     178 '           0 '                            S01466 CGL029
     O**********          77 82ALPY     178 '          0 . '                           S01466 CGL029
     O**********          78 82ALPY     178 '         0 .  '                           S01466 CGL029
     O**********          79 82ALPY     178 '        0 .   '                           S01466 CGL029
     O**********          70 82BLNK14   178                                            S01466 CGL029
     O**********             82PNAM     198                                            S01466 CGL029
     O**********             82PAYR     218                                            S01466 CGL029
     O**********             82OSWCR    234                                            S01466 CGL029
     O**********             82PYB1     254                                            S01466 CGL029
     O**********             82PYB2     274                                            S01466 CGL029
     O**********             82PAYA     284                                            S01466 CGL029
     O**********             82METHSC   285                                            S01466 CGL029
     O**********             82TXBRCA   446                                            S01466 CGL029
     O**********          01 36BLK250   269                                            S01466 CGL029
     O**********          01 36BLK16    285                                            S01466 CGL029
     O**********          01 36BLK3     446                                            S01117 CGL029
     O                       82TRATSC    96                                                   CGL029
     O                       82PNARSC   126                                                   CGL029
     O                       82CCY      129                                                   CGL029
     O                       82PAYFSC   130                                                   CGL029
     O                       82FDATSC   136                                                   CGL029
     O                    76 82         137 ' '                                               CGL029
     O                    76 82AFPY     150 '           0 '                                   CGL029
     O                    77 82AFPY     150 '          0 . '                                  CGL029
     O                    78 82AFPY     150 '         0 .  '                                  CGL029
     O                    79 82AFPY     150 '        0 .   '                                  CGL029
     O                       82SDATSC   156                                                   CGL029
     O                    76 82         157 ' '                                               CGL029
     O                    76 82ASPY     170 '           0 '                                   CGL029
     O                    77 82ASPY     170 '          0 . '                                  CGL029
     O                    78 82ASPY     170 '         0 .  '                                  CGL029
     O                    79 82ASPY     170 '        0 .   '                                  CGL029
     O                    69 82BLNK14   170                                                   CGL029
     O                       82LDATSC   176                                                   CGL029
     O                    76 82         177 ' '                                               CGL029
     O                    76 82ALPY     190 '           0 '                                   CGL029
     O                    77 82ALPY     190 '          0 . '                                  CGL029
     O                    78 82ALPY     190 '         0 .  '                                  CGL029
     O                    79 82ALPY     190 '        0 .   '                                  CGL029
     O                    70 82BLNK14   190                                                   CGL029
     O                       82PNAM     210                                                   CGL029
     O                       82PAYR     230                                                   CGL029
     O                       82OSWCR    246                                                   CGL029
     O                       82PYB1     266                                                   CGL029
     O                       82PYB2     286                                                   CGL029
     O                       82PAYA     296                                                   CGL029
     O                       82METHSC   297                                                   CGL029
     O                       82TXBRCA   458                                                   CGL029
     O                    01 36BLK250   281                                                   CGL029
     O                    01 36BLK16    297                                                   CGL029
     O                    01 36BLK3     458                                                   CGL029
     O**
     O**   S T A N D   F I L E .
     O**
     O**   RELEASE STAND FILE
     OSTAND   E                RELSTA
     O**
     O*    AMENDMENT  OR INSERTION OVER DELETED RECORD.
     O**      E        74N68
     O        E        74N68N04
     O                         RECISF     1
     O                         HELDSF     6
     O*****                    INBRCH     9                               S01117
     O                         ODBRC      9                               S01117
     O                         ZCNUMD    15
     O**********               ZACODD    19                                                   CGL029
     O                         ZACSQD    27
     O                         DRACSF    37
     O                         ZCNUMC    43
     O**********               ZACODC    47                                                   CGL029
     O                         MBSI      48
     O                         BRCASF    51                               S01117
     O                         ZACSQC    55
     O                         CRACSF    65
     O                         CCYSF     68
     O                         DFPYSF    71P
     O                         AFPYSF    78P
     O                         DSPYSF    81P
     O                         ASPYSF    88P
     O                         DLPYSF    91P
     O                         ALPYSF    98P
     O                         PAYFSF    99
     O                         DLMVSF   102P
     O                         NPAYDT   105P
     O                         PNARSF   135
     O                         PAYEE    155
     O                         PAYRSF   175
     O                         PYB1SF   195
     O                         PYB2SF   215
     O                         PAYASF   225
     O                         PAYMTH   226
     O                         DYTPSF   228
     O***********              OSWCRA   239                         S05452S01117
     O***********              OSWCRB   245                         S05452S01117
     O***********              RUND     252P                              S01117
     O***********              CHTPSF   253                               S01117
     O***********              NATN     256P                              S01117
     O                         OCBRC    231                               S01117
     O                         IPRFC    235                               S01117
     O                         OSWCRA   246                               S01117
     O                         OSWCRB   251                               S01117
     O*************************RUND     254P                       S01117 S01466
     O*************************CHTPSF   255                        S01117 S01466
     O*************************NATN     258P                       S01117 S01466
     O                         TRATSF   256                               S01466
     O                         RUND     259P                              S01466
     O                         CHTPSF   260                               S01466
     O                         NATN     263P                              S01466
     O                         ZACODD   274                                                   CGL029
     O                         ZACODC   284                                                   CGL029
     O                                  285 ' '                           209727
     O**
     O**   DELETION
     O        E        74N68 04
     O                         RECISF     1
     O***********              RUND     252P                              S01117
     O***********              CHTPSF   253                               S01117
     O***********              NATN     256P                              S01117
     O*************************RUND     254P                       S01117 S01466
     O*************************CHTPSF   255                        S01117 S01466
     O*************************NATN     258P                       S01117 S01466
     O                         RUND     259P                              S01466
     O                         CHTPSF   260                               S01466
     O                         NATN     263P                              S01466
     O**
     O**   UPDATE STAND TRAILER RECORD
     O        E        75 81
     O                         NSOI      28P
     O                         NSOA      31P
     O                         NSOD      34P
     O                         VSIW      42P
     O                         VSID      44P
     O                         VSAW      52P
     O                         VSAD      54P
     O                         VSDW      62P
     O                         VSDD      64P
     O                         NSAU      67P
     O                         VSUW      75P
     O                         VSUD      77P
     O                         RUND     252P
     O                         NATN     256P
     O**
     O**   INSERT NEW RECORD.
     OSTANDSB EADD     74 68
     O                         RECISF     1
     O                         HELDSF     6
     O*****                    INBRCH     9                               S01117
     O                         ODBRC      9                               S01117
     O                         ZCNUMD    15
     O**********               ZACODD    19                                                   CGL029
     O                         ZACSQD    27
     O                         DRACSF    37
     O                         ZCNUMC    43
     O**********               ZACODC    47                                                   CGL029
     O                         MBSI      48                               E16893
     O                         BRCASF    51                               S01117
     O                         ZACSQC    55
     O                         CRACSF    65
     O                         CCYSF     68
     O                         DFPYSF    71P
     O                         AFPYSF    78P
     O                         DSPYSF    81P
     O                         ASPYSF    88P
     O                         DLPYSF    91P
     O                         ALPYSF    98P
     O                         PAYFSF    99
     O                         DLMVSF   102P
     O                         NPAYDT   105P
     O                         PNARSF   135
     O                         PAYEE    155
     O                         PAYRSF   175
     O                         PYB1SF   195
     O                         PYB2SF   215
     O                         PAYASF   225
     O                         PAYMTH   226
     O                         DYTPSF   228
     O***********              OSWCRA   239                         S05452S01117
     O***********              OSWCRB   245                         S05452S01117
     O***********              RUND     252P                              S01117
     O***********              CHTPSF   253                               S01117
     O***********              NATN     256P                              S01117
     O                         OCBRC    231                               S01117
     O                         IPRFC    235                               S01117
     O                         OSWCRA   246                               S01117
     O                         OSWCRB   251                               S01117
     O*************************RUND     254P                       S01117 S01466
     O*************************CHTPSF   255                        S01117 S01466
     O*************************NATN     258P                       S01117 S01466
     O                         TRATSF   256                               S01466
     O                         RUND     259P                              S01466
     O                         CHTPSF   260                               S01466
     O                         NATN     263P                              S01466
     O                         ZACODD   274                                                   CGL029
     O                         ZACODC   284                                                   CGL029
     O                                  285 ' '                           209727
     O**
     O**   M E M O   F I L E
     O**
     O**   UPDATE NEW BALANCES TO MEMO FILE
     O***********MEMO    E        67                                      CCB002
     O***********                         GRBL      16                    CCB002
     O***********                         NETB      31                    CCB002
     ORSACMTPOE        67      RSAC                                       S01154
     O                         *ALL                                       S01154
     O* 47906 - REC ADDED IN MES: ACCOUNT IS BLOCKED,BANKRUPT OR BAD DEBT 047906
     O/COPY WNCPYSRC,RE0253O001
**   MES - MESSAGES TO OPERATOR
 INVALID COMMAND KEY
 INVALID INPUT
 INVALID ACTION CODE
 INVALID UPDATE - THIS RECORD HAS SINCE BEEN UPDATED
 RECORD DOES NOT EXIST
 RECORD ALREADY EXISTS
 ACCOUNT DOES NOT EXIST, OR ACCOUNT CLOSED
INVALID KEY
USER NOT AUTHORISED TO THE ACTION CODE FOR THIS MENU ITEM
USER NOT AUTHORISED TO ANY ACTION CODES FOR THIS MENU ITEM & BRANCH
USER NOT AUTHORISED TO THE ACTION CODE FOR THIS MENU ITEM & BRANCH
 ACCOUNT IS BLOCKED, BANKRUPT OR BAD DEBT                                 047906
     X/COPY WNCPYSRC,RE0253X001
**   FREQ - VALID FREQUENCY CODES
DWFSMRTQXYLBA
**   ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** XOT - Array for watch list fields' Opening XML Tags                                        CSD015
<DR Account>                                                                                  CSD015
<CR Account>                                                                                  CSD015
<DR Retail Account>                                                                           CSD015
<CR Retail Account>                                                                           CSD015
<Payee>                                                                                       CSD015
<Reference>                                                                                   CSD015
<Payee Account>                                                                               CSD015
<Payee Bank>                                                                                  CSD015
** XCT - Array for watch list fields' Closing XML Tags                                        CSD015
</DR Account>                                                                                 CSD015
</CR Account>                                                                                 CSD015
</DR Retail Account>                                                                          CSD015
</CR Retail Account>                                                                          CSD015
</Payee>                                                                                      CSD015
</Reference>                                                                                  CSD015
</Payee Account>                                                                              CSD015
</Payee Bank>                                                                                 CSD015
