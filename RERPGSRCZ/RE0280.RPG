     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Manual Adjusts to Accr Int-Initi Sc')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module
     F*                                                               *
     F*  RE0280 - MANUAL ADJUSTMENTS TO ACCRUED INTEREST - S/REACR    *
     F*           INITIAL SCREEN SET-UP                               *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*      1990, 1993                                               *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CLE025             Date 20Oct03               *
      *                 CAAA03             Date 21Apr04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 117074             Date 06Feb98               *
     F*                 S01413             DATE 13APR93               *
     F*                 LN0229                  29MAY90               *
     F*                 S01194                  21FEB90               *
     F*                 S01117                  11NOV89               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Reverse image is showing in Webface without error.  *
      *           Recompile due to changes in RE0280FM.               *
     F*  117074  -  Upgrade R3 core fix 064034.                       *
     F*  S01413  -  Header Box Standardised                           *
     F*  LN0229  -  Remove retail number field when RACN = N          *
     F*  S01194  -  New Standing Data.                                *
     F*  S01117  -  Release 10  Multibranching.                       *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*E0280FMCF  F     269            WORKSTN                            S01117
     FRE0280FMCF  F     272            WORKSTN                            S01117
     F*TABLE***IF  F      96 12AI     2 DISK                              S01194
     F*
     F*       FUNCTION OF INDICATORS
     F*
     F*       01      SUPPRESS READ OF SCREEN FORMAT
     F*       02      SET ON IF ERROR DURING READ FROM THE WORK STATION
     F*       37      MULT-BRANCH IND ON - MBIN=Y                         S01117
     F*       81      OUTPUT INITIAL - SF - SCREEN
     F*       88      NON-DISPLAY ERROR MESSAGE/CODES
     F*       U7      DATABASE ERROR
     E                    CPY@    1   1 80
     I*    WORKSTATION FILE
     I*
     IRE0280FMNS
     I*
     I*****TABLE*FILE***INSTALLATION*CONTROL*DATA*RECORD*1.               S01194
     I**********                                                          S01194
     I*TABLE***NS       2 C0   3 C1  12 C1                                S01194
     I*******AND      13 C0                                               S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                             12  130RCDE                  S01194
     I**********                             14  66 TITL                  S01194
     I***********                            67  67 DATF                  S01117
     I**********                             68  700DFBR                  S01194
     I**********                             74  74 MODI1                 S01194
     I**********                             75  75 MODI2                 S01194
     I**********                             76  76 MODI3                 S01194
     I***********                         P  77  790RUND                  S01117
     I***********                            80  86 RUNA                  S01117
     I**********                             87  870SFLG                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
     I*****CATCHALL                                                       S01194
     I********NS                                                          S01194
     I*
     I*    LOCAL DATA AREA
     I*
     ILDA        UDS                            256
     I                                        1   8 LPROC
     I***********                           134 138 LFILE                 S01117
     I***********                           139 167 LKEY                  S01117
     I***********                           168 175 LPROG                 S01117
     I***********                           176 1770LDBNO                 S01117
     I                                      134 141 LFILE                 S01117
     I                                      142 170 LKEY                  S01117
     I                                      171 180 LPROG                 S01117
     I                                      181 1830LDBNO                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I***********                           181 1850LRUND                 S01117
     I***********                           186 192 LRUNA                 S01117
     I***********                           193 193 LDATF                 S01117
     I***********                           194 1940LSFLG                 S01117
     I***********                           195 1960LKEYL                 S01117
     I***********                           197 202 LISP                  S01117
     I***********                           203 203 LTWOL                 S01117
     I***********                           204 2040LLDLP                 S01117
     I***********                           205 2090LTNLU                 S01117
     I***********                           210 210 LDELM                 S01117
     I***********                           211 211 LDUD                  S01117
     I                                      187 1910LRUND                 S01117
     I                                      192 198 LRUNA                 S01117
     I                                      199 199 LDATF                 S01117
     I**********                            200 2000LSFLG           S01117S01194
     I                                      200 200 LSFLG                 S01194
     I                                      201 2020LKEYL                 S01117
     I                                      203 208 LISP                  S01117
     I                                      209 209 LTWOL                 S01117
     I                                      210 2100LLDLP                 S01117
     I                                      211 2150LTNLU                 S01117
     I                                      216 216 LDELM                 S01117
     I                                      217 217 LDUD                  S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**
     IPSDS       SDS
     I                                      244 246 WSID
     I                                      245 246 WSID2
     I**
      *                                                                   LN0229
     ISDRETL    E DSSDRETLPD                                              LN0229
     I              BMRANR                          RACN                  LN0229
     I*                                                                   S01194
     IDSFDY     E DSDSFDY                                                 LN0229
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                LN0229
     I*                                                                   LN0229
      *----------------------------------------------------------------   117074
      *                                                                   117074
     C                     MOVEACPY@      BIS@   80
     C                     CALL 'AORETLR0'                                LN0229
     C                     PARM '*DBERR ' @RTCD   7                       LN0229
     C                     PARM '*FIRST ' @OPTN   7                       LN0229
     C           SDRETL    PARM SDRETL    DSFDY                           LN0229
     C           RACN      COMP 'Y'                  3030                 LN0229
     C*                                                                   S01194
     C           *NAMVAR   DEFN           LDA
     C************LOCK     IN   *NAMVAR                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*                                                                   S01117
     C**   IF MBIN = Y SETON MULTIBRANCH IND.                             S01117
     C           MBIN      COMP 'Y'                      37               S01117
     C*
     C   01                READ RE0280FM                 02
     C                     SETOF                     02
     C*
     C*  WPROG IS THIS PROGRAM NAME
     C*
     C                     MOVE 'RE028   'WPROG   8
     C*
     C*  SET-UP LDA
     C*
     C                     MOVE ' '       BLK29  29
     C                     MOVE '1  '     LPROC
     C                     MOVE BLK29     LKEY
     C                     MOVE WPROG     LPROG
     C                     Z-ADD0         LDBNO
     C                     MOVELWPROG     LISP
     C                     MOVE 'N'       LTWOL
     C                     Z-ADD0         LLDLP
     C                     Z-ADD0         LTNLU
     C*
     C***EXECUTE*SYSTEM*SUBROUTINE*ZSYSTM.                                S01194
     C**********                                                          S01194
     C**********           EXSR ZSYSTM                                    S01194
     C*
     C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
     C           DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
     C********** *IN99     IFEQ '1'                                       S01194
     C**********           SETON                     U7                   S01194
     C**********           MOVE 'TABLE'   LFILE                           S01194
     C**********           MOVELZTABKY    LKEY                            S01194
     C**********           MOVE '01'      LDBNO            * DB ERROR 01 *S01194
     C**********           GOTO END                                       S01194
     C**********           END                                            S01194
     C*
     C           NERR1     TAG                             ** NERR1 TAG
     C*
     C                     MOVE RUND      LRUND
      *                                                                   117074
      ** Check if Last Day Accrual                                        117074
     C           BMLDAI    IFEQ 'Y'                                       117074
     C                     SUB  1         LRUND                           117074
     C                     ENDIF                                          117074
      *                                                                   117074
     C                     MOVE RUNA      LRUNA
     C                     MOVE DATF      LDATF
     C**********           MOVE SFLG      LSFLG                           S01194
     C                     MOVE SSF       LSFLG                           S01194
     C*
     C*    SET INDICATORS AND O/P INITIAL SCREEN.
     C*
     C                     SETON                     8881
     C                     MOVE 'SF'      SID     2
     C                     MOVELWPROG     SPID    6
     C*
     C           END       TAG                             ** END TAG
     C*
     C                     TIME           WTIME   60
     C*
     C***********          OUT  *NAMVAR                                   S01117
     C                     OUT  LDA                                       S01117
     C                     EXCPT
     C*                                                                   S01117
     C*
     C                     RETRN
     C*
     C********************************************************************
     C**
     C*****ZSYSTM*SR.*TO*CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   S01194
     C**********                                                          S01194
0184 C********** ZSYSTM    BEGSR                           *** ZSYSTM *** S01194
0185 C**********                                                          S01194
0186 C*****SET*UP*KEY*FOR*INSTALLATION CONTROL RECORD.                    S01194
0187 C**********           MOVEL'01      'ZTABKY 12                       S01194
0188 C**********           MOVE '  10'    ZTABKY                          S01194
0189 C**********                                                          S01194
0190 C********** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0191 C**N99***** RECI      COMP 'D'                  9999  ON, IS DELETED S01194
0192 C**********                                                          S01194
0193 C*****CHECK*SYSTEM*DATE FORMAT, DDMMYY OR MMDDYY.                    S01194
0194 C********** DATF      COMP 'M'                      98MMDDYY, 98 ON  S01194
0195 C**********                                                          S01194
0196 C**********           ENDSR                                          S01194
     C**
     C**
     C**                                                                  S01117
     C*                                                                   S01117
     C********************************************************************S01117
     O*
     O*  WORKSTATION - INITIAL SCREEN OUTPUT
     O*
     ORE0280FME        81
     O                                   K8 'RE0280F1'
     O                         RUNA       7
     O                         SID        9
     O                         SPID      15
     O                         WTIME     23 '  .  .  '
     O                         WSID      26
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
