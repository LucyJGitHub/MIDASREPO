     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Manual adjusts to accr int - insert scr')     *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module
     F*                                                               *
     F*  RE0281 - MANUAL ADJUSTMENTS TO ACCRUED INTEREST - S/REACR    *
     F*           INITIAL/UPDATE SCREEN PROCESSING                    *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. MD026105           Date 19Aug14               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 250988             Date 23Oct07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 20Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 185122             Date 27Jun01               *
      * Midas DBA 3.03 -----------------------------------------------*
      *                 166994             Date 15May00               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 02MAR99               *
      *                 CTI002             DATE 09Sep98               *
     F*                 121606             DATE 23FEV98               *
     F*                 S01413             DATE 13APR93               *
     F*                 BHF697                  28SEP90               *
     F*                 LN0446                  28JUN90               *
     F*                 LN0229                  22MAY90               *
     F*                 S01194                  23FEB90               *
     F*                 S01199                  15FEB90               *
     F*                 S01117                  24NOV89               *
     F*                 E11550                  22SEP87               *
     F*                 E10814                  31JUL87               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  MD026105 - Recalculate the accrued interest if LCD (last     *
      *             change date) in REACRD is not equal to rundate.   *
      *             Patterned from 219664.                            *
      *  250988 - Wrong error message for Retail No.                  *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Reverse image is showing in Webface without error.  *
      *           Recompile due to changes in RE0280FM.               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  185122 - DBASE error 004 in SDCURRPD when processing closed  *
      *           account.  System should output error message when   *
      *           account is closed, or a warning message when the    *
      *           account is flagged for closure.                     *
      *           Note - error message 17 has been amended.           *
      *  166994 - Do not allow input of interest adjustment for a     *
      *           secondary account - any adjustment needs to be      *
      *           applied to the primary account.                     *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*  121606 - Get the Curency details  before start calculation
      *           in Intcal
     F*  S01413 - Retail 3 Incorporation                              *
     F*  BHF697 - THERE SHOULD BE A WARNING WHEN ADJUSTING ACCRUED    *
     F*           INTEREST FOR A CLOSED ACCOUNT.                      *
     F*  LN0446 - DISPLAY RETAIL NUMBER WHEN OTHER DETAILS ARE        *
     F*           ENTERED                                             *
     F*  LN0229 - ADDING NEW STANDING DATA & ACCESS OBJECTS           *
     F*           ADDING IN ERROR CODE NO.S FOR NEW STANDING DATA     *
     F*           FIELDS                                              *
     F*           MAKING RETAIL NUMBER NON-DISPLAY WHEN RETAIL AC.NO. *
     F*           ARE OFF (BMRANR = N)                                *
     F*  S01194 - NEW STANDING DATA                                   *
     F*  S01199 - HELP CHANGES                                        *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  E11550 - CODE ADDED TO TEST FOR VALID SEQUENCE NUMBER ENTRY  *
     F*           BETWEEN 01 - 99 IF RETAIL NUMBER IS BLANK.          *
     F*  E10814 - USE THE SUM OF INTEREST ACCRUED, MANUAL AND         *
     F*           GENERATED ADJUSTMENTS FOR THE TWO 'PREVIOUS'        *
     F*           FIELDS OUTPUT TO THE DISPLAY.                       *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*E0280FMCF  F     269            WORKSTN                            S01117
     F***RE0280FMCF  F     272            WORKSTN                                      S01117 CGL029
     FRE0280FMCF  F     290            WORKSTN                                                CGL029
     F*EACR   IF  F     128 15AI     2 DISK                               S01117
     F***REACR** IF  F     128 18AI     2 DISK                                         S01117 CGL029
     FREACR   IF  F     191 24AI     2 DISK                                                   CGL029
     F*CCNT   IF  F     400 15AI     2 DISK                               S01117
     F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
     FACCNT   IF  F     573 24AI     2 DISK                                                   CGL029
     F                                              KCOMIT
     FACNUM   IF  F      40 10AI     2 DISK
     FRELINKL1IF  E           K        DISK                               166994
     F*ABLE***IF* F      96 12AI     2 DISK                               S01194
     FREHRCJ  IF  E           K        DISK                                                 MD026105
     FREHRDJ  IF  E           K        DISK                                                 MD026105
     FREHISL  IF  E           K        DISK                                                 MD026105
     F            REHISPMF                          KIGNORE                                 MD026105
     F                                              KINFDS REHDS                            MD026105
     F                                              KINFSR REHSR                            MD026105
     F*
     F*       FUNCTION OF INDICATORS
     F*       KC      END OF JOB REQUEST
     F*       01      BLINK KEY FIELDS
     F*       03      SET ON IF ERROR DURING READ FROM THE WORK STATION
     F***********     /HELP INDICATOR                                     S01199
     F*       05      BLINK SIGN
     F*       06-10   SCREEN CONDITIONING INDICATORS                      S01117
     F*       11      BRANCH CODE ERROR                                   S01117
     F*       12      CUSTOMER NUMBER BLANK
     F*       13      CURRENCY BLANK
     F*       14      ACCOUNT CODE BLANK
     F*       15      ACCOUNT SEQUENCE BLANK
     F*       16      RETAIL NUMBER BLANK
     F*       17      WARNING IF ACCOUNT IS CLOSED                        BHF697
     F*       19      BRANCH CODE ERROR                                   S01117
     F*       20      BRANCH CODE RECORD
     F*       21      CURRENCY RECORD 1
     F*       22      RETAIL ACCOUNT NUMBER RECORD
     F*       29      FIRST CYCLE INDICATOR                               S01117
     F*       30      ERROR INDICATOR
     F*       37      MULT-BRANCH IND ON - MBIN=Y                         S01117
     F*       39      BRANCH CODE ERROR                                   S01117
     F*       49      REVERSE IMAGE - INTEREST SIGN FIELD
      *       50       Record not found on REHISL file                                      MD026105
     F*       57      KEY FIELDS ENTERED, RETAIL NUMBER BLANK
     F*       58      KEY FIELDS BLANK, RETAIL NUMBER ENTERED
     F*       59      KEY FIELDS BLANK
     F*       60      SOME BUT NOT ALL KEY FIELDS ENTERED
     F*       61      KEY FIELDS AND RETAIL NUMBER ALL ENTERED
     F*       62      RETAIL NUMBER AND BRANCH CODE MAY NOT BE ENTERED    S01117
     F*       71      ACCRUAL ADJUSTMENT RECORD
     F*       75      NO RECORD FOUND ON FILES
     F*       76      Chain fail on Linked Accounts file                  166994
     F*****   76      FIRST CYCLE IND                                     S01117
     F*       77      SA SCREEN READ IN
     F*       78      SF SCREEN READ IN
     F*       80      BLINK DELETE CHECK FIELD LABEL
     F*       81      OUTPUT INITIAL - SF - SCREEN
     F*       82      OUTPUT UPDATE - SA - SCREEN
     F*       83      POSITION CURSOR ON FIRST AMENDABLE FIELD
     F*       84-89   SCREEN CONDITIONING INDICATORS                      S01117
      *       99      Database Error                                                        MD026105
     F*       U7      DATABASE ERROR
     E*    TABLES/ARRAYS
     E                    ZA1        16  1               ZALIGN/ZEDIT
     E                    ZA2        16  1               ZALIGN/ZEDIT
     E*
     E                    ERCD       19  4               ERROR CODES
     E*****               ERCM    1   7 79               ERROR MSGS.      S01117
     E*****               ERCM    1  16 79               ERROR MSGS.S01117BHF697
     E*****               ERCM    1  17 79               ERROR MSGS.BHF697166994
     E**********          ERCM    1  18 79               ERROR MSGS.166994185122
     E                    ERCM    1  19 79               ERROR MSGS.      185122
     E                    CPY@    1   1 80
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.Array                  MD026105
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.Array                  MD026105
     E                    ZMNM   12  12  3               ZDATE2 SR. Array                   MD026105
     E                    ZIR        11 11 7             ZIC. Int.rates                     MD026105
     E                    ZIRD       11 11 7             ZIC. Int.rates                     MD026105
     E                    ZIRC       11 11 7             ZIC. Int.rates                     MD026105
     E                    ZIB        11 15 0A            ZIC. Int.balances                  MD026105
     E                    ZIBD       11 15 0             ZIC. Int.balances                  MD026105
     E                    ZIBC       11 15 0             ZIC. Int.balances                  MD026105
     E                    ZIN        11 13 0             ZIC. Int.calc                      MD026105
     E                    ZIN1       11 30 9             ZIC. INT.CALC                      MD026105
     E                    ZIA        11 15 0             ZIC. Work array                    MD026105
     E                    ZIA1       11 30 9             ZIC. WORK ARRAY                    MD026105
     E                    WZIB       11 15 0A                                               MD026105
     I/EJECT                                                                                MD026105
     IREHISPPF                                                                              MD026105
      *                                                                                     MD026105
      ** RENAME REHISPPF FORMAT RECI - REHISL FILE                                          MD026105
      *                                                                                     MD026105
     I              RECI                            WRECI                                   MD026105
     I              HISD                            DHISD                                   MD026105
     I              MNBL                            BMNBL                                   MD026105
     I              MACI                            BMACI                                   MD026105
     I              MADI                            BMADI                                   MD026105
     I              DRCD                            BDRCD                                   MD026105
     I              CRCD                            BCRCD                                   MD026105
     I              HISB                            BHISB                                   MD026105
     IREHISPSF                                                                              MD026105
      *                                                                                     MD026105
      ** RENAME REHISPSF FORMAT RECI - REHISL FILE                                          MD026105
      *                                                                                     MD026105
     I              RECI                            WRECI                                   MD026105
     I              HISD                            DHISD                                   MD026105
     I              HISB                            BHISB                                   MD026105
     I              MNBL                            DMNBL                                   MD026105
     I              CRIS                            DCRIS                                   MD026105
     I              DRIS                            DDRIS                                   MD026105
     I              DRCD                            DDRCD                                   MD026105
     I              CRCD                            DCRCD                                   MD026105
     I              DAIC                            DDAIC                                   MD026105
     I              CAIC                            DCAIC                                   MD026105
     I              SDACP                           DSDCP                                   MD026105
     I              SCACP                           DSCCP                                   MD026105
     I              DRBR                            DDRBR                                   MD026105
     I              CRBR                            DCRBR                                   MD026105
     I              CHBR                            DCHBR                                   MD026105
     I*
     I*    FORMAT - INITIAL SCREEN
     I*
     IRE0280FMNS  78   8 CS   9 CF
     I                                        1   7 SRUNA
     I                                        8   9 SID
     I                                       10  15 SPID
     I                                       16  23 STIME
     I                                       24  26 SWSID
     I*****                                  27  32                       S01117
     I*****                                  33  35 SCCY                  S01117
     I*****                                  36  39 SACCD                 S01117
     I*****                                  40  41 SSEQ                  S01117
     I*****                                  42  51 SRTNO                 S01117
     I*****                                   1  51 SCN51                 S01117
     I                                       27  29 SBRCD                 S01117
     I                                       30  35 SCUST                 S01117
     I**********                             30  350SCUSTN                             166994 CSD027
     I                                       30  35 SCUSTN                                    CSD027
     I                                       36  38 SCCY                  S01117
     I**********                             39  42 SACCD                              S01117 CGL029
     I**********                             39  420SACCDN                             166994 CGL029
     I**********                             43  44 SSEQ                               S01117 CGL029
     I**********                             43  440SSEQN                              166994 CGL029
     I**********                             45  54 SRTNO                              S01117 CGL029
     I**********                              1  54 SCN54                              S01117 CGL029
     I**********                             27  54 SCN28                              S01117 CGL029
     I                                       39  48 SACCD                                     CGL029
     I                                       39  480SACCDN                                    CGL029
     I                                       49  50 SSEQ                                      CGL029
     I                                       49  500SSEQN                                     CGL029
     I                                       51  60 SRTNO                                     CGL029
     I                                        1  60 SCN54                                     CGL029
     I                                       27  60 SCN28                                     CGL029
     I*
     I*    FORMAT - UPDATE SCREEN
     I*
     IRE0280FMNS  77   8 CS   9 CA
     I                                        1   7 SRUNA
     I                                        8   9 SID
     I                                       10  15 SPID
     I                                       16  23 STIME
     I                                       24  26 SWSID
     I*****                                  27  32 SCUST                 S01117
     I*****                                  33  35 SCCY                  S01117
     I*****                                  36  39 SACCD                 S01117
     I*****                                  40  41 SSEQ                  S01117
     I*****                                  42  51 SRTNO                 S01117
     I*****                                  52  65 SDINT                 S01117
     I*****                                  66  66 SDSGN                 S01117
     I*****                                  67  80 SCINT                 S01117
     I*****                                  81  81 SCSGN                 S01117
     I*****                                  82  95 SPDI                  S01117
     I*****                                  96  96 SPDIS                 S01117
     I*****                                  97 110 SPCI                  S01117
     I*****                                 111 111 SPCIS                 S01117
     I*****                                   1  35 SCN35                 S01117
     I                                       27  29 SBRCD                 S01117
     I                                       30  35 SCUST                 S01117
     I                                       36  38 SCCY                  S01117
     I**********                             39  42 SACCD                              S01117 CGL029
     I**********                             43  44 SSEQ                               S01117 CGL029
     I**********                             45  54 SRTNO                              S01117 CGL029
     I**********                             55  68 SDINT                              S01117 CGL029
     I**********                             69  69 SDSGN                              S01117 CGL029
     I**********                             70  83 SCINT                              S01117 CGL029
     I**********                             84  84 SCSGN                              S01117 CGL029
     I**********                             85  98 SPDI                               S01117 CGL029
     I**********                             99  99 SPDIS                              S01117 CGL029
     I**********                            100 113 SPCI                               S01117 CGL029
     I**********                            114 114 SPCIS                              S01117 CGL029
     I**********                            115 120 SVLDDB                             S01413 CGL029
     I**********                            121 126 SVLDCR                             S01413 CGL029
     I                                       39  48 SACCD                                     CGL029
     I                                       49  50 SSEQ                                      CGL029
     I                                       51  60 SRTNO                                     CGL029
     I                                       61  74 SDINT                                     CGL029
     I                                       75  75 SDSGN                                     CGL029
     I                                       76  89 SCINT                                     CGL029
     I                                       90  90 SCSGN                                     CGL029
     I                                       91 104 SPDI                                      CGL029
     I                                      105 105 SPDIS                                     CGL029
     I                                      106 119 SPCI                                      CGL029
     I                                      120 120 SPCIS                                     CGL029
     I                                      121 126 SVLDDB                                    CGL029
     I                                      127 132 SVLDCR                                    CGL029
     I                                        1  38 SCN38                 S01117
     I*
     I*    CATCHALL
     I        NS
     I                                        8   9 SID
     I*
     I*    ACCNT - DETAIL RECORD
     I**
     IACCNT   NS       1 CD
     I       OR        1 C*                                               185122
     I       OR        1 CC                                               185122
     I                                        1   1 LRECI                 185122
     I                                        8  10 CCY
     I                                       23  25 BCOD
     I                                       26  26 ATYP
     I                                       29  29 @ACST                 185122
     I                                    P  30  320DACO
     I                                    P  33  350DACC                  BHF697
     I                                      190 199 RACNO                 LN0446
     I                                      200 200 RETB
     I                                    P 202 2070ODLN                                    MD026105
     I                                    P 208 2100ODED                                    MD026105
     I                                    P 260 2620LDID
     I                                    P 336 3380LCID
     I                                    P 239 2410RRNM
     I                                      242 2430DRIB                                    MD026105
     I                                    P 244 2497DRIS                                    MD026105
     I                                    P 250 2520DRCD                                    MD026105
     I                                      253 2530DRIC                                    MD026105
     I                                      254 254 DRIF
     I                                    P 307 3090OLDR                                    MD026105
     I                                      318 3190CRIB                                    MD026105
     I                                    P 320 3257CRIS                                    MD026105
     I                                    P 326 3280CRCD                                    MD026105
     I                                      329 3290CRIC                                    MD026105
     I                                      330 330 CRIF
     I                                    P 383 3850OLCR                                    MD026105
     I**   ACCNT - CATCH-ALL.
     I        NS
     I                                        1   1 LRECI                 185122
     I*
     IREACR   NS  71   1 CD
     I       OR        1 C*                                               185122
     I       OR        1 CC                                               185122
     I                                        1   1 MRECI
     I**********                              2   70MCUST                                     CSD027
     I                                        2   7 MCUST                                     CSD027
     I                                        8  10 MCCY
     I**********                             11  140MACCD                                     CGL029
     I                                       11  140QQACCD                                    CGL029
     I                                       15  160MSEQ
     I                                       17  19 MBRCA                                   MD026105
     I                                    P  31  330MTNLU
     I                                    P  34  360MORED
     I                                    P  37  390MLCD
     I                                       40  40 MCHTP
     I                                    P  41  470MDAIC
     I                                    P  48  540MMADI
     I                                    P  55  610MGADI
     I                                    P  62  680MCAIC
     I                                    P  69  750MMACI
     I                                    P  76  820MGACI
     I                                    P  83  900MHISB                                   MD026105
     I                                    P 129 1360MNBL                                    MD026105
     I                                      182 1910MACCD                                     CGL029
     I                                        1 128 MOLD1
     I*
     I*    CATCHALL
     I        NS
     I                                        1   1 MRECI
     I**
     I**   RETAIL ACCOUNT NUMBERS FILE.
     I**
     IACNUM   NS       1 CD
     I       OR        1 CC                                               185122
     I                                        1   1 NRECI                 185122
     I                                        2  11 ACNO
     I                                       12  17 CNUMB
     I                                       18  20 CCY
     I**********                             21  240ACODA                                     CGL029
     I**********                             25  26 ACSQA                                     CGL029
     I**********                             27  27 ACST                                      CGL029
     I**********                             29  31 BRCDA                              S01117 CGL029
     I                                       21  300ACODA                                     CGL029
     I                                       31  32 ACSQA                                     CGL029
     I                                       33  33 ACST                                      CGL029
     I                                       35  37 BRCDA                                     CGL029
     I*    ACNUM FILE CATCH-ALL.
     I        NS
     I                                        1   1 NRECI                 185122
     I**********                                                          S01194
     I*****TABLE FILE - BRANCH CODES RECORD.                              S01194
     I**********                                                          S01194
     I*ABLE***NS  20   1 CD   2 C1   3 C0                                 S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I***********                            11  130BRCD                  S01194
     I**********                             14  43 BRNM                  S01194
     I**********                             44  490BICN                  S01194
     I**********                             50  51 LOCC                  S01194
     I**********                             52  53 CMPY                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
     I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
     I**********                                                          S01194
     I*ABLE***NS  21   1 CD   2 C2   3 C0                                 S01194
     I*******AND      13 C1                                               S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                             10  12 CCY                   S01194
     I**********                             13  130SREC                  S01194
     I**********                             14  27 CCNM                  S01194
     I**********                          P  28  348SPOT                  S01194
     I**********                             35  37 CCYS                  S01194
     I**********                             38  380CDP                   S01194
     I**********                             39  390TNOT                  S01194
     I**********                             40  40 DCCY                  S01194
     I**********                             41  44 SRC1                  S01194
     I**********                             45  48 SRC2                  S01194
     I**********                             49  520TACC                  S01194
     I**********                             53  560TEQV                  S01194
     I**********                             57  600SWQV                  S01194
     I**********                             61  640TAC4                  S01194
     I**********                             65  680TAC5                  S01194
     I**********                             69  69 HIND                  S01194
     I**********                          P  70  768PART                  S01194
     I**********                             77  780SSNO                  S01194
     I**********                          P  79  858ERLC                  S01194
     I**********                             86  860MDIN                  S01194
     I**********                             87  870MDIA                  S01194
     I**********                             88  880MDIB                  S01194
     I**********                          P  90  920LCD                   S01194
     I**********                             93  93 CHTP                  S01194
     I**********                          P  94  960TNLU                  S01194
     I**********                                                          S01194
     I*ABLE***NS  22   1 CD   2 C0   3 C1                                 S01194
     I*******AND      12 C2  13 C0                                        S01194
     I*********                              69  69 RACN                  S01194
0372 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 1.               S01117
0372 I***********                                                         S01117
0372 I*ABLE***NS*      1 CD   2 C0   3 C1                                 S01117
0372 I*******AND*     12 C1  13 C0                                        S01117
0372 I***********                             1   1 RECI                  S01117
0372 I***********                            68  700DFBR                  S01117
0372 I***********                                                         S01117
0373 I*****TABLE*FILE - INSTALLATION CONTROL DATA RECORD 2.               S01117
0374 I***********                                                         S01117
0375 I********NS*      1 CD   2 C0   3 C1                                 S01117
0376 I*******AND*     12 C1  13 C1                                        S01117
0377 I***********                             1   1 RECI                  S01117
0372 I***********                            53  53 MBIN                  S01117
     I*****CATCHALL
     I********NS
     I**********
      *                                                                                     MD026105
     IREHRCJF                                                                               MD026105
      ** Rename REHRCJF format fields - REHRCJ file                                         MD026105
      *                                                                                     MD026105
     I              INTH                            INTHC                                   MD026105
     I              ACNO                            TACNO                                   MD026105
     IREHRDJF                                                                               MD026105
      ** Rename REHRDJF format fields - REHRDJ file                                         MD026105
      *                                                                                     MD026105
     I              INTH                            INTHD                                   MD026105
     I              ACNO                            TACNO                                   MD026105
      *                                                                                     MD026105
     I*    DATA STRUCTURE FOR ACCNT KEY
     I*
     I            DS
     I*****                                   1  15 DSMKEY                S01117
     I**********                              1  18 DSMKEY                             S01117 CGL029
     I                                        1  24 DSMKEY                                    CGL029
     I                                        1   6 SCUST
     I                                        7   9 SCCY
     I**********                             10  13 SACCD                                     CGL029
     I**********                             14  15 SSEQ                                      CGL029
     I**********                             16  18 SBRCD                              S01117 CGL029
     I                                       10  19 SACCD                                     CGL029
     I                                       20  21 SSEQ                                      CGL029
     I                                       22  24 SBRCD                                     CGL029
     I**********                                                          S01194
     I*****DATA*STRUCTURE FOR TABLE FILE KEY                              S01194
     I**********                                                          S01194
     I**********  DS                                                      S01194
     I**********                              1  12 TABKEY                S01194
     I**********                              1   2 TAB2                  S01194
     I**********                              9  11 TAB3A                 S01194
     I**********                             10  12 TAB3B                 S01194
     I**********                              9  12 TAB4                  S01194
     I**********                             12  12 TAB1                  S01194
     I**********                              6  11 TAB6                  S01194
     I**********                                                          S01194
      *                                                                                     MD026105
      ** Key Data Structure : REHKEY to fill DBKEY if error                                 MD026105
      *                                                                                     MD026105
     I            DS                                                                        MD026105
     I                                        1  23 REHKEY                                  MD026105
     I                                        1   3 MBRCA                                   MD026105
     I                                        4   9 MCUST                                   MD026105
     I                                       10  12 REHCCY                                  MD026105
     I                                       13  160QQACCD                                  MD026105
     I                                       17  180MSEQ                                    MD026105
     I                                       19  230REHDAT                                  MD026105
     I                                       24  330MACCD                                   MD026105
      *                                                                                     MD026105
      ** Data Structure for date format DD/MM/YY                                            MD026105
      *                                                                                     MD026105
     I            DS                                                                        MD026105
     I                                        1   60RESULT                                  MD026105
     I                                        1   20ZDAY                                    MD026105
     I                                        3   40ZMTH                                    MD026105
     I                                        5   60ZYEAR                                   MD026105
      *                                                                                     MD026105
      ** Data structure for beginning date                                                  MD026105
      *                                                                                     MD026105
     I            DS                                                                        MD026105
     I                                        1   60SRES                                    MD026105
     I                                        1   20ZISD                                    MD026105
     I                                        3   40ZISM                                    MD026105
     I                                        5   60ZISY                                    MD026105
      *                                                                                     MD026105
      ** Data structure for finishing date                                                  MD026105
      *                                                                                     MD026105
     I            DS                                                                        MD026105
     I                                        1   60FRES                                    MD026105
     I                                        1   20ZIFD                                    MD026105
     I                                        3   40ZIFM                                    MD026105
     I                                        5   60ZIFY                                    MD026105
      *                                                                                     MD026105
      ** Data structure for date format MM/DD/YY                                            MD026105
      *                                                                                     MD026105
     I            DS                                                                        MD026105
     I                                        1   60RESULX                                  MD026105
     I                                        1   20ZMTHX                                   MD026105
     I                                        3   40ZDAYX                                   MD026105
     I                                        5   60ZYEARX                                  MD026105
      *                                                                                     MD026105
      ** Data structure for beginning date MM/DD/YY                                         MD026105
      *                                                                                     MD026105
     I            DS                                                                        MD026105
     I                                        1   60SRESX                                   MD026105
     I                                        1   20ZISMX                                   MD026105
     I                                        3   40ZISDX                                   MD026105
     I                                        5   60ZISYX                                   MD026105
      *                                                                                     MD026105
      ** Data structure for finishing date MM/DD/YY                                         MD026105
      *                                                                                     MD026105
     I            DS                                                                        MD026105
     I                                        1   60FRESX                                   MD026105
     I                                        1   20ZIFMX                                   MD026105
     I                                        3   40ZIFDX                                   MD026105
     I                                        5   60ZIFYX                                   MD026105
      *                                                                                     MD026105
      ** Data structure to split from alpha to numeric debit and                            MD026105
      ** credit balances                                                                    MD026105
      *                                                                                     MD026105
     IWDBAL       DS                                                                        MD026105
      *                                                                                     MD026105
     I                                    P   1  880ZIBD                                    MD026105
     I                                    P   1   80ZBD01                                   MD026105
     I                                    P   9  160ZBD02                                   MD026105
     I                                    P  17  240ZBD03                                   MD026105
     I                                    P  25  320ZBD04                                   MD026105
     I                                    P  33  400ZBD05                                   MD026105
     I                                    P  41  480ZBD06                                   MD026105
     I                                    P  49  560ZBD07                                   MD026105
     I                                    P  57  640ZBD08                                   MD026105
     I                                    P  65  720ZBD09                                   MD026105
     I                                    P  73  800ZBD10                                   MD026105
     I                                    P  81  880ZBD11                                   MD026105
     I                                    P  89  960ZBD12                                   MD026105
      *                                                                                     MD026105
     IWCBAL       DS                                                                        MD026105
     I                                    P   1  880ZIBC                                    MD026105
     I                                    P   1   80ZBC01                                   MD026105
     I                                    P   9  160ZBC02                                   MD026105
     I                                    P  17  240ZBC03                                   MD026105
     I                                    P  25  320ZBC04                                   MD026105
     I                                    P  33  400ZBC05                                   MD026105
     I                                    P  41  480ZBC06                                   MD026105
     I                                    P  49  560ZBC07                                   MD026105
     I                                    P  57  640ZBC08                                   MD026105
     I                                    P  65  720ZBC09                                   MD026105
     I                                    P  73  800ZBC10                                   MD026105
     I                                    P  81  880ZBC11                                   MD026105
     I                                    P  89  960ZBC12                                   MD026105
      *                                                                                     MD026105
      ** Data structure to split from alpha to numeric debit & credit                       MD026105
      ** rates                                                                              MD026105
      *                                                                                     MD026105
     IWDRAT       DS                                                                        MD026105
      *                                                                                     MD026105
     I                                    P   1  667ZIRD                                    MD026105
     I                                    P   1   67ZRD01                                   MD026105
     I                                    P   7  127ZRD02                                   MD026105
     I                                    P  13  187ZRD03                                   MD026105
     I                                    P  19  247ZRD04                                   MD026105
     I                                    P  25  307ZRD05                                   MD026105
     I                                    P  31  367ZRD06                                   MD026105
     I                                    P  37  427ZRD07                                   MD026105
     I                                    P  43  487ZRD08                                   MD026105
     I                                    P  49  547ZRD09                                   MD026105
     I                                    P  55  607ZRD10                                   MD026105
     I                                    P  61  667ZRD11                                   MD026105
     I                                    P  67  727ZRD12                                   MD026105
      *                                                                                     MD026105
     IWCRAT       DS                                                                        MD026105
     I                                    P   1  667ZIRC                                    MD026105
     I                                    P   1   67ZRC01                                   MD026105
     I                                    P   7  117ZRC02                                   MD026105
     I                                    P  13  187ZRC03                                   MD026105
     I                                    P  19  247ZRC04                                   MD026105
     I                                    P  25  307ZRC05                                   MD026105
     I                                    P  31  367ZRC06                                   MD026105
     I                                    P  37  427ZRC07                                   MD026105
     I                                    P  43  487ZRC08                                   MD026105
     I                                    P  49  547ZRC09                                   MD026105
     I                                    P  55  607ZRC10                                   MD026105
     I                                    P  61  667ZRC11                                   MD026105
     I                                    P  67  727ZRC12                                   MD026105
     IREHDS       DS                                                                        MD026105
     I                                     *STATUS  STSREH                                  MD026105
     I*    LOCAL DATA AREA
     I*
     ILDA        UDS                            256
     I                                        1   8 LPROC
     I                                    P 102 1040LVLDDB                S01413
     I                                    P 105 1070LVLDCR                S01413
     I***********                           134 138 LFILE                 S01117
     I***********                           139 167 LKEY                  S01117
     I***********                           168 175 LPROG                 S01117
     I***********                           176 1770LDBNO                 S01117
     I                                      134 141 LFILE                 S01117
     I                                      142 170 LKEY                  S01117
     I                                      171 180 LPROG                 S01117
     I                                      181 1830LDBNO                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I***********                           181 1850LRUND                 S01117
     I***********                           186 192 LRUNA                 S01117
     I***********                           193 193 LDATF                 S01117
     I***********                           194 1940LSFLG                 S01117
     I***********                           195 1960LKEYL                 S01117
     I***********                           197 202 LISP                  S01117
     I***********                           203 203 LTWOL                 S01117
     I***********                           204 2040LLDLP                 S01117
     I***********                           205 2090LTNLU                 S01117
     I***********                           210 210 LDELM                 S01117
     I***********                           211 211 LDUD                  S01117
     I                                      187 1910LRUND                 S01117
     I                                      192 198 LRUNA                 S01117
     I                                      199 199 LDATF                 S01117
     I**********                            200 2000LSFLG           S01117S01194
     I                                      200 200 LSFLG                 S01194
     I                                      201 2020LKEYL                 S01117
     I                                      203 208 LISP                  S01117
     I                                      209 209 LTWOL                 S01117
     I                                      210 2100LLDLP                 S01117
     I                                      211 2150LTNLU                 S01117
     I                                      216 216 LDELM                 S01117
     I                                      217 217 LDUD                  S01117
     IWTRAN      UDS                            860
     I                                        1   1 WRECI
     I                                        2   7 WCUST
     I                                        8  10 WCCY
     I**********                             11  14 WACCD                                     CGL029
     I                                       11  14 QQACC4                                    CGL029
     I                                       15  16 WACSQ
     I                                       17  19 WBRCD                 S01117
     I                                    P  31  330WTNLU
     I                                    P  37  390WLCD
     I                                       40  40 WCHTP
     I                                    P  41  470WDAIC
     I                                    P  48  540WMADI
     I                                    P  55  610WGADI
     I                                    P  62  680WCAIC
     I                                    P  69  750WMACI
     I                                    P  76  820WGACI
     I                                      401 401 W401
     I                                    P 402 4040W404
     I                                    P 405 4070W407
     I                                      408 409 WWSID2
     I                                      414 418 WFILE
     I                                      424 429 WLOGP
     I                                      430 430 W430
     I                                      431 431 W431
     I                                      449 4540WTIME
     I                                      461 716 WCN256
     I                                      717 726 WACCD                                     CGL029
     I                                        1 200 WTRAN1
     I                                      201 400 WTRAN2
     I                                      401 600 WTRAN3
     I                                      601 800 WTRAN4
     I                                      801 860 WTRAN5
     I**
     IPSDS       SDS
     I                                      244 246 WSID
     ISCSARD    E DSSCSARDPD                                                                MD026105
      ** Data structure for Switchable features details                                     MD026105
      *                                                                                     MD026105
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I*
     ISDGELR    E DSSDGELRPD                                              S01194
      ** GENERAL LEDGER DETAILS                                           S01194
      *                                                                   S01194
     I              QQACCD                          QQACC1                                    CGL029
     ISDCURR    E DSSDCURRPD                                              S01194
      **   CURRENCY TYPE                                                  S01194
     I              A6NBDP                          CDP                   S01194
     ISDCUST    E DSSDCUSTPD                                              LN0229
      **   CUSTOMER DETAILS                                               LN0229
      *                                                                   LN0229
     ISDACOD    E DSSDACODPD                                              LN0229
      **   ACCOUNT CODE                                                   LN0229
      *                                                                   LN0229
     I              QQACCD                          QQACC2                                    CGL029
     ISDRETL    E DSSDRETLPD                                              S01194
     I              BMRANR                          RACN                  S01194
     I              QQACCD                          QQACC3                                    CGL029
      **                                                                  S01194
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**  EXTERNAL DS FOR BRANCH CODE DETAILS                             S01117
     I              QQDFAC                          QQDFC1                                    CGL029
      **                                                                  S01194
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
     I                                      245 246 WSID2
     I*                                                                   S01117
     I** DATA AREA RUNDAT                                                 S01117
     I*                                                                   S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     IZMUSER      DS                             17                       S01117
     I** DATA AREA OF MENU USER                                           S01117
     I                                       11  13 DFBM                  S01117
      *                                                                                     MD026105
      ** Constant value for Interest Calculation Method                                     MD026105
      *                                                                                     MD026105
     I              'InterestNumber'      C         PSYSVL                                  MD026105
     I****************************************************************    S01117
     C**  PARAMETER LIST FOR AOCUSTR0                                     LN0229
     C           PLISTA    PLIST                                          LN0229
     C                     PARM '*BLANKS' RTCD    7                       LN0229
     C                     PARM '*KEY   ' OPTN    7                       LN0229
     C                     PARM           CUSKEY 10                       LN0229
     C                     PARM '*CNUM  ' KEYSTS  7                       LN0229
     C           SDCUST    PARM SDCUST    DSSDY                           LN0229
     C*                                                                   LN0229
     C**  PARAMETER LIST FOR AOACODR0                                     LN0229
     C           PLISTB    PLIST                                          LN0229
     C                     PARM '*BLANKS' RTCD                            LN0229
     C                     PARM '*KEY   ' OPTN                            LN0229
     C**********           PARM           ACOKEY  4                                    LN0229 CGL029
     C                     PARM           ACOKEY 10                                           CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        LN0229 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*                                                                   LN0229
     C**  PARAMETER LIST FOR AOCURRR0                                     LN0229
     C           PLISTC    PLIST                                          LN0229
     C                     PARM '*BLANKS' RTCD                            LN0229
     C                     PARM '*KEY   ' OPTN                            LN0229
     C                     PARM           CKEY    3                       LN0229
     C           SDCURR    PARM SDCURR    DSSDY                           LN0229
     C*                                                                   166994
     C           RELINK    KLIST                                          166994
     C                     KFLD           SBRCD                           166994
     C                     KFLD           SCUSTN                          166994
     C                     KFLD           SCCY                            166994
     C                     KFLD           SACCDN                          166994
     C                     KFLD           SSEQN                           166994
     C*                                                                   LN0229
     C*                                                                   LN0229
     C                     MOVEACPY@      BIS@   80
      *                                                                                     MD026105
      ** Key field to access LF/REHISL                                                      MD026105
      *                                                                                     MD026105
     C           R1KEY     KLIST                                                            MD026105
     C                     KFLD           MBRCA                                             MD026105
     C                     KFLD           MCUST                                             MD026105
     C                     KFLD           MCCY                                              MD026105
     C                     KFLD           MACCD                                             MD026105
     C                     KFLD           MSEQ                                              MD026105
     C*                    KFLD           BRCA                                              MD026105
     C*                    KFLD           CNUM                                              MD026105
     C*                    KFLD           CCY                                               MD026105
     C*                    KFLD           ACOD                                              MD026105
     C*                    KFLD           ACSQ                                              MD026105
      *                                                                                     MD026105
      ** Key field to access to REHRDJ/REHRCJ file                                          MD026105
      *                                                                                     MD026105
     C           DCKEY     KLIST                                                            MD026105
     C                     KFLD           MBRCA                                             MD026105
     C                     KFLD           MCUST                                             MD026105
     C                     KFLD           MCCY                                              MD026105
     C                     KFLD           MACCD                                             MD026105
     C                     KFLD           MSEQ                                              MD026105
     C                     KFLD           KDATE                                             MD026105
      *                                                                                     MD026105
      ** Work fields definition                                                             MD026105
      *                                                                                     MD026105
     C           *LIKE     DEFN MCAIC     ZINTR                                             MD026105
     C           *LIKE     DEFN MHISB     ZITHR                                             MD026105
     C           *LIKE     DEFN MHISB     ZBAL                                              MD026105
     C           *LIKE     DEFN MHISB     DINT                                              MD026105
     C           *LIKE     DEFN MHISB     CINT                                              MD026105
     C           *LIKE     DEFN MHISB     ZIAMT                                             MD026105
     C           *LIKE     DEFN MHISB     ZIAMT1                                            MD026105
     C           *LIKE     DEFN MHISB     ZIAMTR                                            MD026105
     C           *LIKE     DEFN RUND      KDATE                                             MD026105
     C           *LIKE     DEFN RUND      ZLDTM                                             MD026105
     C           *LIKE     DEFN RUND      ZIBEG                                             MD026105
     C           *LIKE     DEFN RUND      ZIEND                                             MD026105
     C           *LIKE     DEFN RUND      ZIDREM                                            MD026105
     C           *LIKE     DEFN RUND      ZID1                                              MD026105
     C           *LIKE     DEFN RUND      ZID2                                              MD026105
     C           *LIKE     DEFN RUND      ZIBW1                                             MD026105
     C           *LIKE     DEFN RUND      ZIDW2                                             MD026105
     C           *LIKE     DEFN RUND      ZIREM                                             MD026105
     C           *LIKE     DEFN RUND      ZILPCP                                            MD026105
     C           *LIKE     DEFN DRIB      ZICT                                              MD026105
     C           *LIKE     DEFN DRIC      ZICALC                                            MD026105
     C           *LIKE     DEFN DRIS      ZIRATE                                            MD026105
     C           *LIKE     DEFN MACCD     ZLYCHK                                            MD026105
     C           *LIKE     DEFN MSEQ      ZLYREM                                            MD026105
     C           *LIKE     DEFN MSEQ      ZIM1                                              MD026105
     C           *LIKE     DEFN MSEQ      ZIDW1                                             MD026105
     C           *LIKE     DEFN MSEQ      ZIY1                                              MD026105
     C           *LIKE     DEFN MSEQ      Z                                                 MD026105
     C           *LIKE     DEFN MSEQ      Y                                                 MD026105
     C           *LIKE     DEFN MSEQ      ZIMAN                                             MD026105
      *                                                                                     MD026105
      ** Prepare work variables                                                             MD026105
      *                                                                                     MD026105
     C                     Z-ADD*ZEROS    ZIWRK1 309                                        MD026105
     C                     Z-ADD*ZEROS    ZIWRK2 309                                        MD026105
     C                     Z-ADD*ZEROS    ZDAYN2  94                                        MD026105
     C                     Z-ADD*ZEROS    ZIFY2   30                                        MD026105
     C                     Z-ADD*ZEROS    ZISY2   30                                        MD026105
     C                     Z-ADD*ZEROS    ZINOM   30                                        MD026105
     C                     Z-ADD*ZEROS    ZIM2    30                                        MD026105
     C                     Z-ADD*ZEROS    LOOP    10                                        MD026105
      *                                                                                     MD026105
     C*  FIRST CYCLE PROCESSING
     C**
     C           *NAMVAR   DEFN           LDA                             LN0229
     C           *NAMVAR   DEFN           WTRAN
     C*****      *LOCK     IN   *NAMVAR                                   S01117
     C           *LOCK     IN   LDA                                 S01117LN0229
     C           *LOCK     IN   WTRAN                                     S01117
     C**                                                                  S01117
     C**    IN THE DATAAREA RUNDAT                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C**    IN THE DATAAREA ZMUSER                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN           ZMUSER                          S01117
     C                     IN   ZMUSER                                    S01117
     C*
     C**   IF MBIN = Y SETON MULTIBRANCH IND.                             S01117
     C           MBIN      COMP 'Y'                      37               S01117
     C*                                                                   S01117
     C           *IN29     IFEQ '0'                                       S01117
      ** ACCESS BANK DETAILS                                              S01117
     C                     CALL 'AOBANKR0'                                S01117
     C                     PARM '*DBERR ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C           SDBANK    PARM SDBANK    DSFDY                           S01117
     C*                                                                   S01117
      ** ACCESS GENERAL LEDGER DETAILS                                    S01117
     C**********           CALL 'AOGELRR0'                                S01117              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*DBERR ' @RTCD                           S01117
     C                     PARM '*FIRST ' @OPTN                           S01117
     C********** SDGELR    PARM SDGELR    DSFDY                           S01117              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C                     SETON                     29                   S01117
     C**********           END                                            S01117
      *                                                                                     MD026105
      ** Check if CER055 is installed                                                       MD026105
      *                                                                                     MD026105
     C                     CALL 'AOSARDR0'                                                  MD026105
     C                     PARM *BLANKS   @RTCD                                             MD026105
     C                     PARM '*VERIFY' @OPTN                                             MD026105
     C                     PARM 'CER055'  @SARD   6                                         MD026105
     C                     PARM           DSFDY                                             MD026105
      *                                                                                     MD026105
     C           @RTCD     IFNE *BLANKS                                                     MD026105
     C                     MOVE 'N'       CER055  1                                         MD026105
     C                     ELSE                                                             MD026105
     C                     MOVE 'Y'       CER055                                            MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
      ** Call AOSARDR0 to check for CER016                                                  MD026105
      *                                                                                     MD026105
     C                     CALL 'AOSARDR0'                                                  MD026105
     C                     PARM *BLANKS   PRTCD   7                                         MD026105
     C                     PARM '*VERIFY' POPTN   7                                         MD026105
     C                     PARM 'CER016'  PSARD   6                                         MD026105
     C           SCSARD    PARM SCSARD    DSFDY                                             MD026105
      *                                                                                     MD026105
     C           PRTCD     IFEQ *BLANKS                                                     MD026105
     C                     MOVE 'Y'       CER016  1                                         MD026105
     C                     MOVE 'Y'       WFIRST  1                                         MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
     C                     MOVE 'N'       CER016                                            MD026105
     C                     MOVE 'N'       WFIRST                                            MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C           PRTCD     IFNE *BLANKS                                                     MD026105
     C           PRTCD     ANDNE'*NRF   '                                                   MD026105
     C           *LOCK     IN   LDA                                                         MD026105
     C                     MOVEL'CER016'  DBKEY                                             MD026105
     C                     MOVEL'SCSARDPD'DBFILE                                            MD026105
     C                     Z-ADD046       DBASE                                             MD026105
     C                     OUT  LDA                                                         MD026105
     C                     EXSR *PSSR                                                       MD026105
      *                                                                                     MD026105
     C                     ENDIF                                                            MD026105
      *                                                                   LN0229
     C                     CALL 'AORETLR0'                                LN0229
     C                     PARM '*DBERR ' @RTCD                           LN0229
     C                     PARM '*FIRST ' @OPTN                           LN0229
     C           SDRETL    PARM SDRETL    DSFDY                           LN0229
      *                                                                   LN0229
     C           RACN      COMP 'Y'                  3030                 LN0229
      *                                                                   LN0229
     C                     END                                            LN0229
      *                                                                   LN0229
     C**
     C*    READ WORKSTATION FILE /*HELP*FACILITY*                         S01199
     C**
     C           *IN03     DOUEQ'0'
     C                     READ RE0280FM                 03
     C************IN03     IFEQ '1'                                       S01199
     C***********          MOVEAERCD      HERCD 160                       S01199
     C***********          MOVEL'RE0280'  HBPGM   8                       S01199
     C***********          CALL 'MHELP'                                   S01199
     C***********          PARM           HBPGM                           S01199
     C***********          PARM           HERCD                           S01199
     C***********          END                                            S01199
     C                     END
     C*
     C*
     C*  SET-UP STANDARD INPUT PROGRAM FIELDS  -  WPROG IS THIS PROGRAM
     C*
     C                     MOVELLISP      WPROG   8
     C                     MOVE '1  '     WPROG
     C                     MOVELWPROG     SPID    6
     C*  SET-UP STANDARD LDA FIELDS
     C                     MOVE 'REACR'   LFILE
     C                     MOVE WPROG     LPROG
     C                     Z-ADD15        LKEYL
     C                     Z-ADD1         LLDLP
     C*  SET-UP STANDARD BLANK FIELDS
     C*
     C           LDATF     COMP 'M'                      98* DATE FORMAT
     C           LDUD      COMP 'U'                      58* USEFUL DATA
     C*                                                    *    DISPLAYED
     C*
     C*  INITIALISE FIELD TO BLANK OUT KEY/ACTION CODE
     C*
     C*****                MOVE ' '       BLK25  25                       S01117
     C*****                MOVE ' '       BLK15  15                       S01117
     C*****                MOVE ' '       BLK10  10                       S01117
     C*****                MOVE ' '       BLK6    6                       S01117
     C*****                MOVE ' '       BLK4    4                       S01117
     C*****                MOVE ' '       BLK3    3                       S01117
     C*****                MOVE ' '       BLK2    2                       S01117
     C*
     C*  INITIALISE STANDARD INDICATORS
     C                     SETON                     888786* NON-DISPLAY
     C                     SETOF                     8980  * BLINK LABELS
     C                     SETOF                     858483* OUTPUT
     C                     SETOF                     8281  * SCREENS
     C                     SETOF                     505758
     C                     SETOF                     596061
     C                     SETOF                     66
     C*
     C*  INITIALISE NON-STANDARD INDS
     C*
     C                     SETOF                     010506* BLINK
     C                     SETOF                     070809* LABELS
     C                     SETOF                     121314               LN0229
     C                     SETOF                     10
     C                     SETOF                         49* REV IMAGE
     C                     SETOF                     39                   S01117
     C*
     C*  CHECK FOR CORRECT SCREEN READ IN
     C*
     C   77
     COR 78                GOTO PROCES
     C                     SETON                     U7LR
     C                     MOVE 'SCREN'   LFILE
     C                     MOVE *BLANKS   LKEY
     C                     MOVEL'SF OR SA'LKEY
     C                     MOVE 'FOUND   'LKEY
     C                     MOVE SID       LKEY
     C                     MOVE '02'      LDBNO            * DB ERROR 02 *
     C                     GOTO END
     C*
     C           PROCES    TAG                             ** PROCES TAG
     C*
     C*  CLEAR ERROR CODE ARRAY, RESET INDEX
     C*
     C                     MOVE *BLANKS   ERMSG  79
     C                     MOVE '    '    ERCD
     C                     Z-ADD0         S       20
     C*
     C*  IF F3, END THE PROGRAM
     C*
     C   KC                MOVE '**      'LPROC
     C   KC                SETON                     LR
     C   KC                GOTO END
     C*
     C*  IF F12, OUTPUT BLANK INITIAL SCREEN
     C*
     C   KL                EXSR SUBSF
     C*
     C* BLANK OUT KEY FIELDS AND RETAIL NUMBER
     C*
     C***KL                MOVE BLK25     SCN51                           S01117
     C   KL                MOVE *BLANKS   SCN28                           S01117
     C   KL                MOVE SCN28     SCN54                           S01117
     C   KL                MOVE *BLANKS   SRTNO                           LN0229
     C   KL                EXCPT                                          LN0229
     C   KL                GOTO END
     C*
     C*  TEST FOR ALL MANDATORY KEY FIELDS ENTERED
     C**
     C           SBRCD     COMP *BLANKS                  11               S01117
     C*****      SCUST     COMP BLK6                     12               S01117
     C*****      SCCY      COMP BLK3                     13               S01117
     C*****      SACCD     COMP BLK4                     14               S01117
     C*****      SSEQ      COMP BLK2                     15               S01117
     C           SCUST     COMP *BLANKS                  12               S01117
     C           SCCY      COMP *BLANKS                  13               S01117
     C           SACCD     COMP *BLANKS                  14               S01117
     C           SSEQ      COMP *BLANKS                  15               S01117
     C*
     C*****      SRTNO     COMP BLK10                    16               S01117
     C           SRTNO     COMP *BLANKS                  16               S01117
     C*                                                                   S01117
     C*  BRANCH CODE NOT ENTERED, MOVE   DEFAULT VALUE.                   S01117
     C*                                                                   S01117
     C   16 11             MOVE DFBM      SBRCD                           S01117
     C*
     C*  ALL KEY FIELDS ENTERED AND RETAIL NO BLANK IS VALID - *IN57
     C*
     C  N12N13N14
     CAN 16                SETON                         57
     C*
     C* IF SEQUENCE NOT ENTERED DEFAULT VALUE IS 01
     C*
     C   57 15             MOVE '01'      SSEQ
     C*                                                                   E11550
     C*  TEST THAT VALUE OF SEQUENCE NUMBER IS BETWEEN 01 - 99            E11550
     C*  IF RETAIL NUMBER IS BLANK.                                       E11550
     C*                                                                   E11550
     C           SRTNO     IFEQ *BLANKS                                   E11550
     C           SSEQ      ANDLT'01'                                      E11550
     C           SSEQ      ORGT '99'                                      E11550
     C                     ADD  1         S                               E11550
     C                     MOVE '007'     ERCD,S                          E11550
     C                     GOTO ERCHK                                     E11550
     C                     END                                            E11550
     C***57******          GOTO CHACCT                                    S01117
     C   57                GOTO SPF                                       S01117
     C*
     C*  ALL KEY FIELDS BLANK AND RETAIL NO. ENTERED IS VALID (*IN58)
     C*  PROVIDED RETAIL INPUT IS ALLOWED. CHECK RACN ON TABTB20
     C*
     C   12 13 14
     C*NN16                SETON                         58               S01117
     CAN 11N16             SETON                         58               S01117
     C*
     C           *IN58     IFEQ '1'
     C*****                MOVEL'01      'TABKEY                          S01117
     C*****                MOVE '  20'    TABKEY                          S01117
     C*****                EXSR TABCHN                                    S01117
     C**********           CALL 'AORETLR0'                          S01194LN0229
     C**********           PARM '*DBERR ' @RTCD                     S01194LN0229
     C**********           PARM '*FIRST ' @OPTN                     S01194LN0229
     C********** SDRETL    PARM SDRETL    DSFDY                     S01117LN0229
     C*****                                                               S01117
     C*****      *IN99     IFEQ '1'                                       S01117
     C*****                SETON                     U7LR                 S01117
     C*****                MOVE 'TABLE'   LFILE                           S01117
     C*****                MOVE *BLANKS   LKEY                            S01117
     C*****                MOVELTABKEY    LKEY                            S01117
     C*****                MOVE '03'      LDBNO            * DB ERROR 03 *S01117
     C*****                GOTO END                                       S01117
     C*****                END                                            S01117
     C*
     C           RACN      COMP 'Y'                  3030
     C*
     C           *IN30     IFEQ '1'
     C                     ADD  1         S
     C                     MOVE '002'     ERCD,S
     C                     MOVE ERCM,7    ERMSG
     C                     SETON                         05
     C                     GOTO ERCHK
     C                     END
     C*
     C***********          GOTO CHACCT                                    S01117
     C                     GOTO SPF                                       S01117
     C                     END
     C*  RETAIL NUMBER AND BRANCH CODE MAY NOT BE ENTERED (*IN62)         S01117
     C*                                                                   S01117
     C   12 13 14                                                         S01117
     CANN16N11             SETON                     62                   S01117
     C*                                                                   S01117
     C           *IN62     IFEQ '1'                                       S01117
     C                     ADD  1         S                               S01117
     C                     MOVE '002'     ERCD,S                          S01117
     C                     MOVE ERCM,8    ERMSG                           S01117
     C                     SETON                       3905               S01117
     C                     GOTO ERCHK                                     S01117
     C                     END                                            S01117
     C*
     C*  CHECK KEY FIELDS INPUT. IF ALL BLANK, SETON *IN59. IF THEY ARE
     C*  NOT ALL BLANK, AND ARE NOT ALL FULL (*IN60) OUTPUT ERROR MSG.
     C*  IF THEY ARE ALL BLANK, CHECK RETAIL NUMBER IS NON-BLANK
     C*
     C***12 13 14          SETON                         59               S01117
     C   12 13 14                                                         S01117
     CAN 11                SETON                         59               S01117
     C*
     C           *IN59     IFEQ '0'
     C   12
     COR 13
     COR 14                SETON                         60
     C*
     C           *IN60     IFEQ '1'
     C                     ADD  1         S
     C                     MOVE '002'     ERCD,S
     C                     MOVE ERCM,6    ERMSG
     C                     SETON                     01
     C                     SETON                     121314               LN0229
     C                     GOTO ERCHK
     C                     END
     C*
     C                     ELSE
     C*
     C           *IN16     IFEQ '1'
     C                     ADD  1         S
     C                     MOVE '002'     ERCD,S
     C                     MOVE ERCM,4    ERMSG
     C                     SETON                       0105
     C                     SETON                       121314             LN0229
     C                     GOTO ERCHK
     C                     END
     C*
     C                     END
     C*
     C*  ALL KEY FIELDS AND RETAIL NUMBER MAY NOT BE ENTERED (*IN61)
     C*
     C  N12N13N14
     CANN16                SETON                       61
     C*
     C           *IN61     IFEQ '1'
     C                     ADD  1         S
     C                     MOVE '002'     ERCD,S
     C                     MOVE ERCM,5    ERMSG
     C                     SETON                       0105
     C                     SETON                     121314               LN0229
     C                     SETON                       39                 S01117
     C                     GOTO ERCHK                                     S01117
     C                     END
     C**                                                                  S01117
     C           SPF       TAG                                            S01117
     C**                                                                  S01117
     C** BASIC VALIDATION OF INPUT BRANCH CODE                            S01117
     C           MBIN      IFEQ 'Y'                        IF MULTIBRANCH S01117
     C           *IN11     ANDNE'1'                        & INBRCH<>BLANKS01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM SBRCD     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     ADD  1         S                               S01117
     C                     MOVE '040'     ERCD,S                          S01117
     C                     MOVE ERCM,9    ERMSG                           S01117
     C***********          SETON                     053919         S01117S01413
     C                     SETON                     3919                 S01413
     C                     GOTO ERCHK                                     S01117
     C                     ELSE                                           LN0229
     C                     MOVE A8BRCD    SBRCD                           LN0229
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   E10814
     C*
     C**   VALIDATE ACTION CODE                                           S01117
     C**   IF MBIN = N, VALIDATE ACTION                                   S01117
     C***  VALIDATE USERS AUTHORITY TO USE THIS BRANCH/ACTION (I)         S01117
     C*                                                                   S01117
     C                     Z-ADD*ZERO     @ERR                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'N'                                       S01117
     C                     CALL 'ZVACTU'                                  S01117
     C                     PARM 'I'       @ZACTN  1                       S01117
     C                     PARM           @ERR    10                      S01117
     C**  IF NOT VALID FOR USER                                           S01117
     C           @ERR      IFNE *ZERO                                     S01117
     C                     ADD  1         S                               S01117
     C                     MOVE '302'     ERCD,S                          S01117
     C                     MOVE ERCM,10   ERMSG                           S01117
     C                     GOTO ERCHK                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*  THIS PIECE OF CODE HAS TO BE MOVED TO HERE ELSE THE BRANCH       LN0229
     C*  FOR THE RETAIL ACCOUNT HAS NOT YET BEEN ACCESSED.                LN0229
     C*                                                                   LN0229
     C  N16                EXSR ACNMCH                                    LN0229
     C   75N16   S         ADD  1         S                               LN0229
     C   75N16             MOVE '002'     ERCD,S                          LN0229
     C   75N16             MOVE ERCM,2    ERMSG                           LN0229
     C   75N16             SETON                         05               LN0229
     C*                                                                   BHF697
     C           *IN17     IFEQ *ZERO                                     BHF697
     C           *IN16     IFNE '1'                                       BHF697
     C                     SETOF                         75               BHF697
     C                     EXSR ACCTCH                                    BHF697
     C                     SETOF                     121314               BHF697
     C*                                                                   BHF697
     C*   IF RECORD FOUND OUTPUT WARNING ERROR IF ACCOUNT IS CLOSED       BHF697
     C*                                                                   BHF697
     C*                                                                   BHF697
     C  N75      DACC      IFGT *ZERO                                     BHF697
     C           S         ADD  1         S                               BHF697
     C                     MOVE ERCM,17   ERMSG                           BHF697
     C                     MOVE 'W01'     ERCD,S                          BHF697
     C                     SETON                         17               BHF697
     C                     MOVE *BLANKS   SCUST                           BHF697
     C                     MOVE *BLANKS   SCCY                            BHF697
     C                     MOVE *BLANKS   SACCD                           BHF697
     C                     MOVE *BLANKS   SSEQ                            BHF697
     C                     MOVE *BLANKS   SBRCD                           BHF697
     C                     EXSR SUBSF                                     BHF697
     C                     SETOF                         88               BHF697
     C                     GOTO END                                       BHF697
     C*                                                                   BHF697
     C                     END                                            BHF697
     C*                                                                   BHF697
     C                     ELSE                                           BHF697
     C                     SETOF                         17               BHF697
     C                     END                                            BHF697
     C                     END                                            BHF697
     C*                                                                   BHF697
     C** Do not allow input of interest adjustment against secondary a/c. 166994
     C           RELINK    CHAINRELINKL1             76                   166994
     C           *IN76     IFEQ '0'                                       166994
     C                     MOVE ERCM,18   ERMSG                           166994
     C           S         IFEQ 0                                         166994
     C           S         ADD  1         S                               166994
     C                     END                                            166994
     C                     END                             - E4           166994
     C*                                                                   166994
     C   75N16             GOTO NORF1                                     LN0229
     C*                                                                   LN0229
     C**   IF MBIN = Y, VALIDATE ACTION & BR. CODE TOGETHER               S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C   16                MOVE SBRCD     @ZBR                            LN0229
     C  N16                MOVE BRCDA     @ZBR                            LN0229
     C**                                                                  S01117
     C**   CHECK IF THE USER IS AUTHORIZED TO USE ACTION I                S01117
     C                     CALL 'ZVACTBU'                                 S01117
     C                     PARM 'I'       @ZACTN  1                       S01117
     C                     PARM           @ZBR    3                       LN0229
     C                     PARM           @ERR    10                      S01117
     C**  IF NOT VALID FOR USER                                           S01117
     C           @ERR      IFEQ 1                                         S01117
     C                     ADD  1         S                               S01117
     C                     MOVE '303'     ERCD,S                          S01117
     C                     MOVE ERCM,12   ERMSG                           S01117
     C                     GOTO ERCHK                                     S01117
     C                     END                                            S01117
     C           @ERR      IFEQ 2                                         S01117
     C           S         ANDEQ0                                         250988
     C                     ADD  1         S                               S01117
     C                     MOVE '304'     ERCD,S                          S01117
     C                     MOVE ERCM,11   ERMSG                           S01117
     C                     GOTO ERCHK                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** VALIDATE STANDING DATA FIELDS INDIVIDUALLY IF                    LN0229
     C** (IF 1) - A RETAIL NUMBER HAS NOT BEEN ENTERED,                   LN0229
     C** (IF 2) - THE ACCOUNT NUMBER FIELDS ARE NOT BLANK                 LN0229
     C*                                                                   LN0229
     C           *IN16     IFNE '0'                                       LN0229
     C*                                                                   LN0229
     C           *IN12     IFEQ '0'                                       LN0229
     C           *IN13     ANDEQ'0'                                       LN0229
     C           *IN14     ANDEQ'0'                                       LN0229
     C*                                                                   LN0229
     C                     MOVELSCUST     CUSKEY                          LN0229
     C                     CALL 'AOCUSTR0'PLISTA                          LN0229
     C           RTCD      IFNE *BLANKS                                   LN0229
     C           KEYSTS    OREQ '*CSHT  '                                                     CSD027
     C                     SETON                         12               LN0229
     C           S         ADD  1         S                               LN0229
     C                     MOVE ERCM,13   ERMSG                           LN0229
     C                     MOVE '104'     ERCD,S                          LN0229
     C                     ELSE                                           LN0229
     C                     MOVE BBCUST    SCUST                           LN0229
     C                     END                                            LN0229
     C*                                                                   LN0229
     C                     MOVE SCCY      CKEY                            LN0229
     C                     CALL 'AOCURRR0'PLISTC                          LN0229
     C           RTCD      IFNE *BLANKS                                   LN0229
     C                     SETON                         13               LN0229
     C           S         ADD  1         S                               LN0229
     C                     MOVE ERCM,14   ERMSG                           LN0229
     C                     MOVE '105'     ERCD,S                          LN0229
     C                     ELSE                                           LN0229
     C                     MOVE A6CYCD    SCCY                            LN0229
     C                     END                                            LN0229
     C*                                                                   LN0229
     C                     MOVE SACCD     ACOKEY                          LN0229
     C                     CALL 'AOACODR0'PLISTB                          LN0229
     C           RTCD      IFNE *BLANKS                                   LN0229
     C                     SETON                         14               LN0229
     C           S         ADD  1         S                               LN0229
     C                     MOVE ERCM,15   ERMSG                           LN0229
     C                     MOVE '106'     ERCD,S                          LN0229
     C                     ELSE                                           LN0229
     C                     MOVE A5ACCD    SACCD                           LN0229
     C                     END                                            LN0229
     C*                                                                   LN0229
     C                     END                                            LN0229
     C*                                                                   LN0229
     C   12 13                                                            LN0229
     COR 12 14                                                            LN0229
     COR 14 13             DO                                             LN0229
     C                     MOVE ERCM,16   ERMSG                           LN0229
     C           S         ADD  1         S                               LN0229
     C                     MOVE '108'     ERCD,S                          LN0229
     C                     END                                            LN0229
     C*                                                                   LN0229
     C                     END                                            LN0229
     C*                                                                   LN0229
     C           ERCHK     TAG                             ** ERCHK  **
     C*
     C*  S IS NON-ZERO IF THERE ARE ANY ERRORS. IF SO, OUTPUT SF SCREEN
     C*  WITH ERROR MESSAGE
     C*
     C           S         COMP 0                    8181
     C  N81                GOTO CHACCT
     C*
     C                     EXSR SUBSF
     C                     SETOF                     88
     C                     GOTO END
     C*
     C           CHACCT    TAG                             ** CHACCT TAG
     C*
     C*  CHAIN TO ACCNT FOR DETAIL RECORD
     C*
     C                     SETOF                         75
     C   16                EXSR ACCTCH
     C*                                                                   185122
     C*  If account not found, output error message                       185122
     C*                                                                   185122
     C   75      S         ADD  1         S
     C   75                MOVE '001'     ERCD,S
     C   75                MOVE ERCM,1    ERMSG
     C   75                SETON                         01
     C   75                SETON                     121314               LN0229
     C   75                SETON                         39               S01117
     C   75                GOTO NORF1
     C*                                                                   185122
     C*  If account closed, output error message                          185122
     C*                                                                   185122
     C           DACC      IFGT *ZERO                                     185122
     C           LRECI     ORNE 'D'                                       185122
     C           S         ADD  1         S                               185122
     C                     MOVE '001'     ERCD,S                          185122
     C                     MOVE ERCM,19   ERMSG                           185122
     C                     SETON                         01               185122
     C                     SETON                     121314               185122
     C                     SETON                     3975                 185122
     C                     GOTO NORF1                                     185122
     C                     END                                            185122
     C**N16*****           EXSR ACNMCH                                    LN0229
     C***75***** S         ADD  1         S                               LN0229
     C***75*****           MOVE '002'     ERCD,S                          LN0229
     C***75*****           MOVE ERCM,2    ERMSG                           LN0229
     C***75*****           SETON                         05               LN0229
     C***75*****           GOTO NORF1                                     LN0229
     C*                                                                   BHF697
     C****IF*RECORD*FOUND OUTPUT WARNING ERROR IF ACCOUNT IS CLOSED BHF697185122
     C*   If account is flagged for closure, output warning message       185122
     C*                                                                   BHF697
     C           *IN17     IFEQ *ZERO                                     BHF697
     C*                                                                   BHF697
     C**N75******DACC      IFGT *ZERO                               BHF697185122
     C  N75      @ACST     IFEQ 'C'                                       185122
     C           S         ADD  1         S                               BHF697
     C                     MOVE ERCM,17   ERMSG                           BHF697
     C                     MOVE 'W01'     ERCD,S                          BHF697
     C                     SETON                         17               BHF697
     C                     EXSR SUBSF                                     BHF697
     C                     SETOF                         88               BHF697
     C                     GOTO END                                       BHF697
     C*                                                                   BHF697
     C                     END                                            BHF697
     C*                                                                   BHF697
     C                     ELSE                                           BHF697
     C                     SETOF                         17               BHF697
     C                     END                                            BHF697
     C*                                                                   BHF697
     C* IF CHAIN SUCCESSFUL MOVE RETAIL NO FROM ACCNT INTO SCREEN FIELD   LN0446
     C   16                MOVE RACNO     SRTNO                           LN0446
     C*
     C* IF CHAIN SUCCESSFUL FORMAT DATA
     C*
     C  N75      DSMKEY    CHAINREACR                75
     C*
     C           *IN75     IFEQ '1'
     C           MRECI     ORNE 'D'                                       185122
     C           S         ADD  1         S
     C                     MOVE '003'     ERCD,S
     C                     MOVE ERCM,3    ERMSG
     C                     SETON                       0105
     C                     SETON                     121314               LN0229
     C                     SETON                       39                 S01117
     C                     GOTO NORF1
     C                     END
      *                                                                                     MD026105
      ** Access the last record from LF/REHISL                                              MD026105
      *                                                                                     MD026105
     C           R1KEY     SETGTREHISL                                                      MD026105
     C           R1KEY     REDPEREHISL                   49                                 MD026105
     C           *IN49     IFEQ '1'                                                         MD026105
     C                     EXSR REHSR                                                       MD026105
     C                     END                             - E2                             MD026105
      *                                                                                     MD026105
     C           DHISD     IFNE RUND                                                        MD026105
     C                     EXSR INTCAL                                                      MD026105
      *                                                                                     MD026105
      ** Initialise DAIC/CAIC with accruals from last balance                               MD026105
      ** date of REHISL                                                                     MD026105
      *                                                                                     MD026105
     C           WRECI     IFEQ 'S'                                                         MD026105
     C                     Z-ADDDDAIC     MDAIC                                             MD026105
     C                     Z-ADDDCAIC     MCAIC                                             MD026105
     C                     ELSE                                                             MD026105
     C                     Z-ADDDAID      MDAIC                                             MD026105
     C                     Z-ADDCAID      MCAIC                                             MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C                     ADD  DINT      MDAIC                                             MD026105
     C                     ADD  CINT      MCAIC                                             MD026105
     C                     END                                                              MD026105
     C*
     C                     CALL 'AOCURRR0'                                             121606
     C                     PARM '*MSG   ' @RTCD                                        121606
     C                     PARM '*KEY   ' @OPTN                                        121606
     C                     PARM MCCY      CKEY    3                                    121606
     C           SDCURR    PARM SDCURR    DSSDY                                        121606
     C*                                                                                121606
     C           @RTCD     COMP *BLANKS              9999                              121606
     C   99                SETON                     U7LR                              121606
     C***99*******         MOVE 'TABLE'   LFILE                                 121606 185122
     C   99                MOVE 'SDCURRPD'LFILE                                        185122
     C   99                MOVE *BLANKS   LKEY                                         121606
     C   99                MOVELMCCY      LKEY                                         121606
     C   99                MOVE '04'      LDBNO            * DB ERROR 04 *             121606
     C*                                                                                121606
     C*********************MOVE MMADI     MTAMT  130                      E10814
     C*********************MOVE MMACI     STORE  130                      E10814
     C*                                                                   E10814
     C*  SUM OF ACCRUED INTEREST, MANUAL AND GENERATED ADJUSTMENTS OUTPUT E10814
     C*  TO 'PREVIOUS' FIELDS.                                            E10814
     C*                                                                   E10814
     C           MMADI     ADD  MGADI     XMADI  130                      E10814
     C           XMADI     ADD  MDAIC     XMADI                           E10814
     C                     MOVE XMADI     MTAMT  130                      E10814
     C           MMACI     ADD  MGACI     XMACI  130                      E10814
     C           XMACI     ADD  MCAIC     XMACI                           E10814
     C                     MOVE XMACI     STORE  130                      E10814
     C*                                                                   E10814
     C                     EXSR FORMT
     C                     MOVE WTAMT     SPDI
     C                     MOVE WSIGN     SPDIS
     C                     MOVE STORE     MTAMT
     C                     EXSR FORMT
     C                     MOVE WTAMT     SPCI
     C                     MOVE WSIGN     SPCIS
     C*
     C           NORF1     TAG                             **  NORF1  **
     C*
     C*  UPDATE TNLU IN LDA
     C*
     C  N75                MOVE MTNLU     LTNLU
     C   75                Z-ADD0         LTNLU
     C*
     C*  NO RECORD FOUND
     C*
     C   75                GOTO NORF
     C                     GOTO END
     C*
     C           NORF      TAG                             ** NORF TAG
     C*
     C                     EXSR SUBSF
     C                     SETOF                     88
     C           END       TAG                             ** END TAG
     C*
     C* SET UP UPDATE SCREEN
     C*
     C  NKL      S         COMP 0                        82
     C   82NKLNKC          EXSR SUBSA
     C*
     C*  SETOF OUTPUT INDS IF DATABASE ERROR
     C*
     C   U7                SETOF                     818283
     C   U7                SETOF                     8485
     C   U7                EXSR *PSSR                                     S01117
     C*
     C                     TIME           WTIME
     C*
     C*****                OUT  *NAMVAR                                   S01117
     C                     OUT  WTRAN                                     S01117
     C                     OUT  LDA                                       LN0229
     C  NKC                EXCPT
     C                     RETRN
     C*
     C********************************************************************
     C**
     C**   SUBR TO SET UP INITIAL SCREEN OUTPUT
     C**
     C           SUBSF     BEGSR                           ***  SUBSF  ***
     C                     SETON                     81
     C                     MOVE '1  '     LPROC
     C                     MOVE 'SF'      SID
     C                     ENDSR
     C********************************************************************
     C**
     C**   SUBR TO SET UP UPDATE SCREEN OUTPUT
     C**
     C           SUBSA     BEGSR                           ***  SUBSA  ***
     C                     SETON                     8549
     C                     MOVE '2  '     LPROC
     C                     MOVE 'SA'      SID
     C                     EXSR FORMT
     C                     EXSR WTRUPD
     C*
     C                     ENDSR
     C********************************************************************
     C**
     C**   SUBR TO CHAIN TO ACCNT
     C**
     C           ACCTCH    BEGSR                           *** ACCTCH  ***
     C                     SETOF                     717374
     C                     SETOF                     75
     C                     MOVELDSMKEY    LKEY
     C           DSMKEY    CHAINACCNT                75
     C                     ENDSR
     C********************************************************************
     C**
     C**  SUBR TO CHAIN TO ACNUM & ACCNT
     C**
     C           ACNMCH    BEGSR                           ** ACNMCH  **
     C**
     C                     SETOF                     717374
     C                     SETOF                         75
     C**
     C           SRTNO     CHAINACNUM                75
     C* IF CHAIN IS SUCCESSFUL PROCEED TO CHAIN ACCNT. SET UP KEY
     C*
     C           NRECI     IFNE 'D'                                       185122
     C                     SETON                     75                   185122
     C                     END                                            185122
      *                                                                   185122
     C   75                GOTO CHNFL
     C*
     C*****                MOVE CCY       STKEY1  9                       S01117
     C*****                MOVELCNUMB     STKEY1                          S01117
     C*****                MOVELACODA     STKEY2  6                       S01117
     C*****                MOVE ACSQA     STKEY2                          S01117
     C*****                MOVELSTKEY1    DSMKEY                          S01117
     C*****                MOVE STKEY2    DSMKEY                          S01117
     C**
     C                     MOVE CNUMB     SCUST
     C                     MOVE CCY       SCCY
     C                     MOVE ACODA     SACCD
     C                     MOVE ACSQA     SSEQ
     C                     MOVE BRCDA     SBRCD                           S01117
     C**
     C           CHNFL     ENDSR                           ** CHNFL TAG **
     C********************************************************************
     C**
     C**   SUBR TO FORMAT REACR FILE RECORD DATA FOR SCREEN OUTPUT
     C**
     C           FORMT     BEGSR                           ***  FORMT  ***
     C**********                                                          S01194
     C***GET*CURRENCY RECORD FOR DECIMAL PLACES                           S01194
     C**********                                                          S01194
     C**********           MOVE *BLANKS   TABKEY                          S01194
     C**********           MOVE '20'      TAB2                            S01194
     C**********           MOVE '1'       TAB1                            S01194
     C**********           MOVE MCCY      TAB3A                           S01194
     C**********           EXSR TABCHN                                    S01194
     C                     CALL 'AOCURRR0'                                S01194
     C                     PARM '*MSG   ' @RTCD                           S01194
     C                     PARM '*KEY   ' @OPTN                           S01194
     C                     PARM MCCY      CKEY    3                       S01194
     C           SDCURR    PARM SDCURR    DSSDY                           S01194
     C*
     C***21*****           GOTO FORMT1                                    S01194
     C*  DATABASE ERROR IF CURRENCY NOT FOUND
     C*
     C           @RTCD     COMP *BLANKS              9999                 S01194
     C**********           SETON                     U7LR                 S01194
     C**********           MOVE 'TABLE'   LFILE                           S01194
     C**********           MOVE *BLANKS   LKEY                            S01194
     C**********           MOVELTABKEY    LKEY                            S01194
     C**********           MOVE '04'      LDBNO            * DB ERROR 04 *S01194
     C**********           GOTO FORMTE                                    S01194
     C   99                SETON                     U7LR                 S01194
     C   99                MOVE 'TABLE'   LFILE                           S01194
     C   99                MOVE *BLANKS   LKEY                            S01194
     C   99                MOVELMCCY      LKEY                            S01194
     C   99                MOVE '04'      LDBNO            * DB ERROR 04 *S01194
     C   99                GOTO FORMTE                                    S01194
     C*
     C           FORMT1    TAG                             ** FORMT1 TAG
     C*
     C*  FORMAT TRANSFER AMOUNT
     C*
     C*  CHECK SIGN OF TRANSFER AMOUNT
     C*
     C           MTAMT     COMP 0                      95
     C   95                MOVE '-'       WSIGN   1
     C  N95                MOVE '+'       WSIGN
     C*
     C*  MAKE AMOUNT +VE BEFORE EDITING
     C*
     C   95                Z-SUBMTAMT     MTAMT
     C*
     C                     MOVE MTAMT     ZFIELD
     C           13        SUB  CDP       ZADIG
     C                     Z-ADDCDP       ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    WTAMT  14
     C*
     C           FORMTE    ENDSR                           ** FORMTE TAG
     C********************************************************************
     C**
     C**   SUBR TO UPDATE WORKSTATION TRANSACTION DATA STRUCTURE
     C**
     C           WTRUPD    BEGSR                           ***  WTRUPD ***
     C**
     C                     MOVE *BLANKS   WTRAN1
     C                     MOVE *BLANKS   WTRAN2
     C                     MOVE *BLANKS   WTRAN3
     C                     MOVE *BLANKS   WTRAN4
     C                     MOVE *BLANKS   WTRAN5
     C                     MOVELMOLD1     WTRAN1
     C**
     C                     ENDSR
     C********************************************************************
     C**********                                                          S01194
     C*****SUBR*TO CHAIN TO TABLE FILE                                    S01194
     C**********                                                          S01194
     C********** TABCHN    BEGSR                           ***  TABCHN ***S01194
     C**********                                                          S01194
     C**********           SETOF                     202122               S01194
     C**********           SETOF                         99               S01194
     C**********                                                          S01194
     C********** TABKEY    CHAINTABLE                99                   S01194
     C**********                                                          S01194
     C**********           ENDSR                                          S01194
     C********************************************************************
     C**                                                                 *
     C**  ZEDIT SUBROUTINE TO INSERT A DECIMAL POINT INTO A NUMERIC FIELD*
     C**  AND TO BLANK OUT LEADING ZEROES.                               *
     C**      INPUT FIELDS:   ZFIELD 16/                                 *
     C*                       ZADEC                                      *
     C*                       ZADIG - NOT ACTUALLY USED                  *
     C*                                                                  *
     C*       ARRAYS    ZA1 ,ZA2   BOTH 16 ELEMENTS, EACH ONE BYTE LONG. *
     C*                                                                  *
     C*       OUTPUT FIELD   ZFIELD                                      *
     C*                                                                  *
     C           ZEDIT     BEGSR                           ***  ZEDIT  ***
     C**                                                                 *
     C*       SET UP WORK FIELDS                                         *
     C**                                                                 *
     C                     Z-ADDZADIG     ZADIG   20                     *
     C                     Z-ADDZADEC     ZADEC   10                     *
     C*                                                                  *
     C                     MOVEA' '       ZA1                            *
     C                     MOVEA' '       ZA2                            *
     C*                                                                  *
     C                     Z-ADD16        Z1      20                     *
     C                     Z-ADD16        Z2      20                     *
     C*                                                                  *
     C           16        SUB  ZADEC     ZADEC2  20                     *
     C*                                                                  *
     C*                                                                  *
     C                     MOVEAZFIELD    ZA1                            *
     C*                                                                  *
     C*       CHECK TO SEE IF THERE ARE ANY DECIMAL PLACES               *
     C*                                                                  *
     C           ZADEC     COMP 0                        91              *
     C   91                GOTO ZT20                                     *
     C**                                                                 *
     C           ZT10      TAG                             ** ZT10 TAG ***
     C**                                                                 *
     C*                                                                  *
     C*       SET UP DECIMALS                                            *
     C*                                                                  *
     C                     MOVE ZA1,Z1    ZA2,Z2                         *
     C           Z1        SUB  1         Z1                             *
     C           Z2        SUB  1         Z2                             *
     C*                                                                  *
     C           Z2        COMP 0                        90              *
     C   90                GOTO ZT30                                     *
     C*                                                                  *
     C*       CHECK IF END OF DECIMALS                                   *
     C**                                                                 *
     C           Z2        COMP ZADEC2               90                  *
     C   90                GOTO ZT10                                     *
     C*                                                                  *
     C**                                                                 *
     C*       PUT IN DECIMAL PLACE                                       *
     C*                                                                  *
     C                     MOVE '.'       ZA2,Z2                         *
     C           Z2        SUB  1         Z2                             *
     C*                                                                  *
     C           ZT20      TAG                             ** ZT20 TAG ***
     C*                                                                  *
     C*       SET UP INTEGERS                                            *
     C*                                                                  *
     C                     MOVE ZA1,Z1    ZA2,Z2                         *
     C           Z1        SUB  1         Z1                             *
     C           Z2        SUB  1         Z2                             *
     C**                                                                 *
     C           Z2        COMP 0                    90                  *
     C   90                GOTO ZT20                                     *
     C*                                                                  *
     C*       PUT IN LEADING BLANKS                                      *
     C*                                                                  *
     C           ZT30      TAG                             ** ZT30 TAG ***
     C**                                                                 *
     C                     Z-ADD1         Z2                             *
     C**                                                                 *
     C           ZT40      TAG                             ** ZT40 TAG ***
     C*                                                                  *
     C           ZA2,Z2    COMP '0'                  9090                *
     C   90      ZA2,Z2    COMP ' '                  9090                *
     C*                                                                  *
     C   90                GOTO ZT50                                     *
     C*                                                                  *
     C                     MOVE ' '       ZA2,Z2                         *
     C           Z2        ADD  1         Z2                             *
     C*                                                                  *
     C           Z2        COMP 16                     90                *
     C   90                GOTO ZT40                                     *
     C*                                                                  *
     C*       IF NO INTEGERS PUT IN LEADING ZERO                         *
     C*                                                                  *
     C           ZT50      TAG                             ** ZT50 TAG ***
     C*                                                                  *
     C                     Z-ADDZADEC2    Z2                             *
     C  N91      Z2        SUB  1         Z2                             *
     C           ZA2,Z2    COMP ' '                      90              *
     C   90                MOVE '0'       ZA2,Z2                         *
     C*                                                                  *
     C*                                                                  *
     C*       SET UP OUTPUT FIELD                                        *
     C*                                                                  *
     C           ZT60      TAG                             ** ZT60 TAG ***
     C*                                                                  *
     C                     MOVEAZA2       ZFIELD 16                      *
     C**                                                                 *
     C           ZEND      ENDSR                           ** ZEND **    *
     C*                                                                  *
     C********************************************************************
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  INTCAL subroutine for interest calculation between two dates *                     MD026105
      *                                                               *                     MD026105
      *      Called by       Main                                     *                     MD026105
      *      Calls           CRINIT, DATEIN, DRINIT, ZIC00, ZIC01,    *                     MD026105
      *                      ZIC02                                    *                     MD026105
      *****************************************************************                     MD026105
      *                                                                                     MD026105
     C           INTCAL    BEGSR                           **INTCAL BEGSR*                  MD026105
      *                                                                                     MD026105
      ** Loading of currency to chain to REHRDJ/REHRCJ files                                MD026105
      *                                                                                     MD026105
     C                     MOVE CCY       REHCCY                                            MD026105
     C                     Z-ADD*ZEROS    INRT                                              MD026105
     C                     Z-ADD*ZEROS    INTP                                              MD026105
     C                     Z-ADD*ZEROS    INST                                              MD026105
     C                     Z-ADD*ZEROS    ZINTR                                             MD026105
     C                     Z-ADD*ZEROS    ZLDTM                                             MD026105
      *                                                                                     MD026105
     C           WFIRST    IFEQ 'Y'                                                         MD026105
     C                     EXSR SRAOS                                                       MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
      ** Dedit processing                                                                   MD026105
      *                                                                                     MD026105
     C           MHISB     IFGT *ZEROS                                                      MD026105
     C           MNBL      ORGT *ZEROS                                                      MD026105
     C                     EXSR DRINIT                                                      MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     Z-ADDINRT      ZIRATE                                            MD026105
     C                     Z-ADDINTP      ZICT                                              MD026105
     C                     Z-ADDDRIC      ZICALC                                            MD026105
     C                     Z-ADDDHISD     ZIBEG                                             MD026105
     C                     Z-ADDRUND      ZIEND                                             MD026105
      *                                                                                     MD026105
     C           INTP      IFLT 3                                                           MD026105
     C           MHISB     IFGT 0                                                           MD026105
     C                     Z-ADDBHISB     ZIAMT                                             MD026105
     C           ZICT      CASEQ0         ZIC00                                             MD026105
     C           ZICT      CASEQ1         ZIC01                                             MD026105
     C           ZICT      CASEQ2         ZIC02                                             MD026105
     C                     END                                                              MD026105
     C                     Z-ADDZINTR     DINT                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
      ** Searching END-OF-MONTH date                                                        MD026105
      *                                                                                     MD026105
     C                     EXSR DATEIN                                                      MD026105
      *                                                                                     MD026105
     C           RUND      IFLE ZLDTM                                                       MD026105
     C           MNBL      IFGT 0                                                           MD026105
     C                     Z-ADDMNBL      ZIAMT                                             MD026105
     C           INTP      IFEQ 3                                                           MD026105
     C                     Z-ADD1         ZICT                                              MD026105
     C                     ELSE                                                             MD026105
     C                     Z-ADD2         ZICT                                              MD026105
     C                     END                                                              MD026105
     C           ZICT      CASEQ1         ZIC01                                             MD026105
     C           ZICT      CASEQ2         ZIC02                                             MD026105
     C                     END                                                              MD026105
     C                     Z-ADDZINTR     DINT                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
      ** If change of month occurs with methods 3 & 4 then two processings                  MD026105
      ** First processing:                                                                  MD026105
      *                                                                                     MD026105
     C           MNBL      IFGT 0                                                           MD026105
     C                     Z-ADDMNBL      ZIAMT                                             MD026105
     C                     Z-ADDZLDTM     ZIEND                                             MD026105
     C           INTP      IFEQ 3                                                           MD026105
     C                     Z-ADD1         ZICT                                              MD026105
     C                     ELSE                                                             MD026105
     C                     Z-ADD2         ZICT                                              MD026105
     C                     END                                                              MD026105
     C           ZICT      CASEQ1         ZIC01                                             MD026105
     C           ZICT      CASEQ2         ZIC02                                             MD026105
     C                     END                                                              MD026105
     C                     Z-ADDZINTR     DINT                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Second processing:                                                                 MD026105
      *                                                                                     MD026105
     C           MHISB     IFGT 0                                                           MD026105
     C                     Z-ADDBHISB     ZIAMT                                             MD026105
     C                     Z-ADDZLDTM     ZIBEG                                             MD026105
     C                     Z-ADDRUND      ZIEND                                             MD026105
     C           INTP      IFEQ 3                                                           MD026105
     C                     Z-ADD1         ZICT                                              MD026105
     C                     ELSE                                                             MD026105
     C                     Z-ADD2         ZICT                                              MD026105
     C                     END                                                              MD026105
     C           ZICT      CASEQ1         ZIC01                                             MD026105
     C           ZICT      CASEQ2         ZIC02                                             MD026105
     C                     END                                                              MD026105
     C                     ADD  ZINTR     DINT                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Credit processing                                                                  MD026105
      *                                                                                     MD026105
     C                     Z-ADD*ZEROS    INRT                                              MD026105
     C                     Z-ADD*ZEROS    INTP                                              MD026105
     C                     Z-ADD*ZEROS    INST                                              MD026105
     C                     Z-ADD*ZEROS    ZINTR                                             MD026105
     C                     Z-ADD*ZEROS    ZLDTM                                             MD026105
      *                                                                                     MD026105
     C           MHISB     IFLT *ZEROS                                                      MD026105
     C           MNBL      ORLT *ZEROS                                                      MD026105
     C                     EXSR CRINIT                                                      MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     Z-ADDINRT      ZIRATE                                            MD026105
     C                     Z-ADDINTP      ZICT                                              MD026105
     C                     Z-ADDCRIC      ZICALC                                            MD026105
     C                     Z-ADDDHISD     ZIBEG                                             MD026105
     C                     Z-ADDRUND      ZIEND                                             MD026105
      *                                                                                     MD026105
     C           INTP      IFLT 3                                                           MD026105
     C           MHISB     IFLT 0                                                           MD026105
     C                     Z-ADDBHISB     ZIAMT                                             MD026105
     C           ZICT      CASEQ0         ZIC00                                             MD026105
     C           ZICT      CASEQ1         ZIC01                                             MD026105
     C           ZICT      CASEQ2         ZIC02                                             MD026105
     C                     END                                                              MD026105
     C                     Z-ADDZINTR     CINT                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
      ** Searching END-OF-MONTH date                                                        MD026105
      *                                                                                     MD026105
     C                     EXSR DATEIN                                                      MD026105
      *                                                                                     MD026105
     C           RUND      IFLE ZLDTM                                                       MD026105
     C           MNBL      IFGT 0                                                           MD026105
     C                     Z-ADDMNBL      ZIAMT                                             MD026105
     C           INTP      IFEQ 3                                                           MD026105
     C                     Z-ADD1         ZICT                                              MD026105
     C                     ELSE                                                             MD026105
     C                     Z-ADD2         ZICT                                              MD026105
     C                     END                                                              MD026105
     C           ZICT      CASEQ1         ZIC01                                             MD026105
     C           ZICT      CASEQ2         ZIC02                                             MD026105
     C                     END                                                              MD026105
     C                     Z-ADDZINTR     CINT                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
      ** If change of month occurs with methods 3 & 4 then two processings                  MD026105
      ** First processing:                                                                  MD026105
      *                                                                                     MD026105
     C           MNBL      IFGT 0                                                           MD026105
     C                     Z-ADDMNBL      ZIAMT                                             MD026105
     C                     Z-ADDZLDTM     ZIEND                                             MD026105
     C           INTP      IFEQ 3                                                           MD026105
     C                     Z-ADD1         ZICT                                              MD026105
     C                     ELSE                                                             MD026105
     C                     Z-ADD2         ZICT                                              MD026105
     C                     END                                                              MD026105
     C           ZICT      CASEQ1         ZIC01                                             MD026105
     C           ZICT      CASEQ2         ZIC02                                             MD026105
     C                     END                                                              MD026105
     C                     Z-ADDZINTR     CINT                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Second processing:                                                                 MD026105
      *                                                                                     MD026105
     C           MHISB     IFGT 0                                                           MD026105
     C                     Z-ADDBHISB     ZIAMT                                             MD026105
     C                     Z-ADDZLDTM     ZIBEG                                             MD026105
     C                     Z-ADDRUND      ZIEND                                             MD026105
     C           INTP      IFEQ 3                                                           MD026105
     C                     Z-ADD1         ZICT                                              MD026105
     C                     ELSE                                                             MD026105
     C                     Z-ADD2         ZICT                                              MD026105
     C                     END                                                              MD026105
     C           ZICT      CASEQ1         ZIC01                                             MD026105
     C           ZICT      CASEQ2         ZIC02                                             MD026105
     C                     END                                                              MD026105
     C                     ADD  ZINTR     CINT                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     ENDSR                           **INTCAL ENDSR*                  MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
     C/COPY ZSRSRC,ZICDREZ2                                                                 MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  ZIC00 subroutine to calculate interest (type=00)             *                     MD026105
      *                                                               *                     MD026105
      *      Called by       INTCAL                                   *                     MD026105
      *      Calls           ZICD                                     *                     MD026105
      *****************************************************************                     MD026105
      *                                                                                     MD026105
     C           ZIC00     BEGSR                           **ZIC00 BEGSR**                  MD026105
      *                                                                                     MD026105
      ** Core hook for externalisation.                                                     MD026105
      *                                                                                     MD026105
     C/COPY WNCPYSRC,RE3360CLD1                                                             MD026105
      *                                                                                     MD026105
      ** Reverse sign of amount if it's negative.                                           MD026105
      *                                                                                     MD026105
     C           ZIAMT     IFLT 0                                                           MD026105
     C                     Z-SUBZIAMT     ZIAMT                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Find number of days to calculate interest according to calc.                       MD026105
      ** basis.                                                                             MD026105
      *                                                                                     MD026105
     C                     EXSR ZICD                                                        MD026105
      *                                                                                     MD026105
      ** FOR CALC BASIS 6, USE THE FACTORED NUMBER OF DAYS                                  MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 6                                                           MD026105
     C           ZIAMT     MULT INT6DY    WWMULT 309                                        MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
     C           ZIAMT     MULT ZDAYN2    WWMULT                                            MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
      ** CHANGE FIELD LENGTH TO PREVENT 0.01 DIFFERENCE                                     MD026105
      *                                                                                     MD026105
     C           WWMULT    MULT ZIRATE    WWMULT                                            MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 7                                                           MD026105
     C           ZICALC    OREQ 5                                                           MD026105
     C           ZICALC    OREQ 3                                                           MD026105
     C           ZICALC    OREQ 2                                                           MD026105
     C           WWMULT    DIV  36000     ZIWRK1    H                                       MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 4                                                           MD026105
     C           ZICALC    OREQ 1                                                           MD026105
     C           WWMULT    DIV  36500     ZIWRK1    H                                       MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 6                                                           MD026105
     C           WWMULT    DIV  36600     ZIWRK1    H                                       MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     Z-ADDZIWRK1    ZINTR     H                                       MD026105
      *                                                                                     MD026105
      ** Core hook for externalisation.                                                     MD026105
     C/COPY WNCPYSRC,RE3360CLD2                                                             MD026105
      *                                                                                     MD026105
     C                     ENDSR                           **ZIC00 ENDSR**                  MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  ZIC01 subroutine to calculate interest (type=01)             *                     MD026105
      *                                                               *                     MD026105
      *      Called by       INTCAL                                   *                     MD026105
      *      Calls           ZICD                                     *                     MD026105
      *****************************************************************                     MD026105
      **                                                                                    MD026105
     C           ZIC01     BEGSR                           **ZIC01 BEGSR**                  MD026105
      *                                                                                     MD026105
      ** Core hook for externalisation.                                                     MD026105
     C/COPY WNCPYSRC,RE3360CLD3                                                             MD026105
      *                                                                                     MD026105
      ** Reverse sign of amount if it's negative.                                           MD026105
      *                                                                                     MD026105
     C           ZIAMT     IFLT 0                                                           MD026105
     C                     Z-SUBZIAMT     ZIAMT                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Initialize work fields.                                                            MD026105
      *                                                                                     MD026105
     C                     Z-ADDZIAMT     ZIAMT1                                            MD026105
     C                     Z-ADD1         Z                                                 MD026105
     C                     Z-ADD*ZEROS    ZIAMTR                                            MD026105
     C                     Z-ADD*ZEROS    ZIA                                               MD026105
     C                     Z-ADD*ZEROS    ZIA1                                              MD026105
     C                     Z-ADD*ZEROS    LOOP                                              MD026105
     C                     Z-ADD*ZEROS    Y                                                 MD026105
     C                     Z-ADD*ZEROS    ZIN                                               MD026105
      *                                                                                     MD026105
      ** Interest is only calculated on an amount that exceeds initial                      MD026105
      ** threshold balance.                                                                 MD026105
      *                                                                                     MD026105
     C           ZIAMT     IFGT ZITHR                                                       MD026105
      *                                                                                     MD026105
      ** Find number of days to calculate interest according to calc.                       MD026105
      ** basis.                                                                             MD026105
      *                                                                                     MD026105
     C                     EXSR ZICD                                                        MD026105
      *                                                                                     MD026105
     C                     Z-ADD0         WOVRIN 117                                        MD026105
     C           LOOP      DOWEQ0                                                           MD026105
     C                     Z-ADDZIAMT1    ZIAMTR                                            MD026105
      ** Skip and exit if BAL is -2                                                         MD026105
     C           CER055    IFEQ 'Y'                                                         MD026105
     C           ZIB,Z     IFEQ -2                                                          MD026105
     C                     Z-ADDZIR,Z     WOVRIN                                            MD026105
     C                     Z-ADDZIAMTR    ZIA,Y                                             MD026105
     C                     Z-ADD1         LOOP                                              MD026105
     C                     GOTO SKIP                                                        MD026105
     C                     ENDIF                                                            MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C           Z         IFEQ 11                                                          MD026105
     C                     Z-ADDZIAMTR    ZIA,Z                                             MD026105
     C                     Z-ADD1         LOOP                                              MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
     C                     ADD  1         Y                                                 MD026105
     C                     ADD  1         Z                                                 MD026105
      *                                                                                     MD026105
     C           ZIB,Z     IFEQ 0                                                           MD026105
     C                     ADD  ZIAMTR    ZIA,Y                                             MD026105
     C                     Z-ADD1         LOOP                                              MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
      ** Skip and exit if BAL is -2                                                         MD026105
      *                                                                                     MD026105
     C           CER055    IFEQ 'Y'                                                         MD026105
     C           ZIB,Z     IFEQ -2                                                          MD026105
     C                     Z-ADDZIR,Z     WOVRIN                                            MD026105
     C                     Z-ADDZIAMTR    ZIA,Y                                             MD026105
     C                     Z-ADD1         LOOP                                              MD026105
     C                     GOTO SKIP                                                        MD026105
     C                     ENDIF                                                            MD026105
     C                     ENDIF                                                            MD026105
     C           ZIB,Z     SUB  ZIB,Y     ZBAL                                              MD026105
     C           ZIAMTR    SUB  ZBAL      ZIAMT1                                            MD026105
      *                                                                                     MD026105
     C           ZIAMT1    IFLE 0                                                           MD026105
     C                     ADD  ZIAMTR    ZIA,Y                                             MD026105
     C                     Z-ADD1         LOOP                                              MD026105
      *                                                                                     MD026105
      ** Skip and exit if BAL is -2                                                         MD026105
      *                                                                                     MD026105
     C           CER055    IFEQ 'Y'                                                         MD026105
     C           ZIB,Z     IFEQ -2                                                          MD026105
     C                     Z-ADDZIR,Z     WOVRIN                                            MD026105
     C                     Z-ADDZIAMTR    ZIA,Y                                             MD026105
     C                     Z-ADD1         LOOP                                              MD026105
     C                     GOTO SKIP                                                        MD026105
     C                     ENDIF                                                            MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
     C                     ADD  ZBAL      ZIA,Y                                             MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           SKIP      TAG                                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** If the sub-type is from 50000 TO 99999, calculate the interest                     MD026105
      ** on the amount exceeding the initial threshold.  Otherwise, the                     MD026105
      ** interest is calculated on the whole balance whenever it exceeds                    MD026105
      ** the initial threshold.                                                             MD026105
      *                                                                                     MD026105
     C           INST      IFGE 50000                                                       MD026105
     C                     Z-ADD1         Z                                                 MD026105
     C           Z         DOWLT12                                                          MD026105
     C           ZITHR     ANDGT0                                                           MD026105
     C           ZIA,Z     SUB  ZITHR     ZIA,Z                                             MD026105
     C           ZIA,Z     IFLT 0                                                           MD026105
     C                     Z-SUBZIA,Z     ZITHR                                             MD026105
     C                     Z-ADD0         ZIA,Z                                             MD026105
     C                     ELSE                                                             MD026105
     C                     Z-ADD0         ZITHR                                             MD026105
     C                     END                                                              MD026105
     C                     ADD  1         Z                                                 MD026105
     C                     END                                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 6                                                           MD026105
     C           ZIA       MULT INT6DY    ZIA1                                              MD026105
     C                     ELSE                                                             MD026105
     C           ZIA       MULT ZDAYN2    ZIA1                                              MD026105
     C                     ENDIF                                                            MD026105
     C           ZIA1      MULT ZIR       ZIA1                                              MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 7                                                           MD026105
     C           ZICALC    OREQ 5                                                           MD026105
     C           ZICALC    OREQ 3                                                           MD026105
     C           ZICALC    OREQ 2                                                           MD026105
     C           ZIA1      DIV  36000     ZIN1      H                                       MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 4                                                           MD026105
     C           ZICALC    OREQ 1                                                           MD026105
     C           ZIA1      DIV  36500     ZIN1      H                                       MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 6                                                           MD026105
     C           ZIA1      DIV  36600     ZIN1      H                                       MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     XFOOTZIN1      ZINTR1 185H                                       MD026105
     C                     Z-ADDZINTR1    ZINTR     H                                       MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** If OVERDRAFT exists, get account debit balance                                     MD026105
      *                                                                                     MD026105
     C           WOVRIN    IFNE 0                                                           MD026105
     C                     Z-ADD0         WODLN  110                                        MD026105
     C                     Z-ADD0         WODLN2 150                                        MD026105
     C                     Z-ADD0         WACTDB 110                                        MD026105
     C                     Z-ADD0         WZIA   155                                        MD026105
     C                     Z-ADD0         WZIN   185                                        MD026105
     C                     Z-ADDODLN      WODLN                                             MD026105
     C           WODLN     MULT 100       WODLN2                                            MD026105
     C                     Z-ADDBHISB     WACTDB                                            MD026105
     C           WODLN     IFNE 0                                                           MD026105
     C           BJRDNB    ANDLEODED                                                        MD026105
     C           BHISB     SUB  WODLN2    WACTDB                                            MD026105
     C                     ENDIF                                                            MD026105
      ** Get calculation basis                                                              MD026105
     C           ZICALC    IFEQ 7                                                           MD026105
     C           ZICALC    OREQ 5                                                           MD026105
     C           ZICALC    OREQ 3                                                           MD026105
     C           ZICALC    OREQ 2                                                           MD026105
     C           ZICALC    OREQ 0                                                           MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 0                                                           MD026105
     C           PINTN     ANDEQ'Y'                                                         MD026105
      *                                                                                     MD026105
     C                     Z-ADD1         C       20                                        MD026105
      *                                                                                     MD026105
     C           C         DOWLT12                                                          MD026105
      ** Skip if BAL is -2                                                                  MD026105
     C           CER055    IFEQ 'Y'                                                         MD026105
     C           ZIB,Z     ANDEQ-2                                                          MD026105
     C                     Z-ADDZIA,C     WAMT                                              MD026105
     C                     Z-ADDZIR,C     WRATE                                             MD026105
     C                     EXSR SRINT0                                                      MD026105
     C                     Z-ADDZINTR     ZIN1,C                                            MD026105
     C                     ADD  1         C                                                 MD026105
     C                     ENDIF                                                            MD026105
     C                     ENDDO                                                            MD026105
      *                                                                                     MD026105
     C                     XFOOTZIN1      ZINTR1    H                                       MD026105
     C                     Z-ADDZINTR1    ZINTR     H                                       MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
     C           WACTDB    DIV  36000     WZIA      H                                       MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 4                                                           MD026105
     C           ZICALC    OREQ 1                                                           MD026105
     C           WACTDB    DIV  36500     WZIA      H                                       MD026105
      *                                                                                     MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 6                                                           MD026105
     C           WACTDB    DIV  36600     WZIA      H                                       MD026105
      *                                                                                     MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C           WZIA      MULT WOVRIN    WZIA                                              MD026105
     C           WZIA      MULT ZDAYN2    WZIN                                              MD026105
      *                                                                                     MD026105
     C                     ADD  WZIN      ZINTR                                             MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
      ** Core hook for externalisation.                                                     MD026105
     C/COPY WNCPYSRC,RE3360CLD4                                                             MD026105
      *                                                                                     MD026105
     C                     ENDSR                           **ZIC01 ENDSR**                  MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  ZIC02 subroutine to calculate interest (type=02)             *                     MD026105
      *                                                               *                     MD026105
      *      Called by       INTCAL                                   *                     MD026105
      *      Calls           ZICD                                     *                     MD026105
      *****************************************************************                     MD026105
      *                                                                                     MD026105
     C           ZIC02     BEGSR                           **ZIC02 BEGSR**                  MD026105
      *                                                                                     MD026105
      ** Core hook for externalisation.                                                     MD026105
     C/COPY WNCPYSRC,RE3360CLD5                                                             MD026105
      *                                                                                     MD026105
      ** Check if OVERDRAFT exist in ZIB array                                              MD026105
      **  and save the original ZIB in WZIB array                                           MD026105
      *                                                                                     MD026105
     C                     Z-ADD0         WACTDB                                            MD026105
     C           CER055    IFEQ 'Y'                                                         MD026105
      *                                                                                     MD026105
     C                     Z-ADD2         Z                                                 MD026105
     C                     Z-ADD0         WOVRIN                                            MD026105
     C           Z         DOWLE11                                                          MD026105
     C           ZIB,Z     IFEQ -2                                                          MD026105
     C                     Z-ADDZIR,Z     WOVRIN                                            MD026105
      ** Save original Balance array(ZIB)                                                   MD026105
     C                     MOVE ZIB       WZIB                                              MD026105
     C                     Z-ADD0         ZIB,Z                                             MD026105
     C                     LEAVE                                                            MD026105
     C                     ENDIF                                                            MD026105
     C                     ADD  1         Z                                                 MD026105
     C                     ENDDO                                                            MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
      ** Fill the end of the table with highval.                                            MD026105
      *                                                                                     MD026105
     C                     Z-ADD2         Z                                                 MD026105
     C           Z         DOWLE11                                                          MD026105
     C           ZIB,Z     IFEQ *ZEROS                                                      MD026105
     C                     Z-ADD*HIVAL    ZIB,Z                                             MD026105
     C                     END                                                              MD026105
     C                     ADD  1         Z                                                 MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Reverse sign of amount if it's negative.                                           MD026105
      *                                                                                     MD026105
     C           ZIAMT     IFLT 0                                                           MD026105
     C                     Z-SUBZIAMT     ZIAMT                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Interest is only calculated on an amount that exceeds or is equal                  MD026105
      ** to the initial threshold balance.                                                  MD026105
      *                                                                                     MD026105
     C           ZIAMT     IFGT ZITHR                                                       MD026105
      *                                                                                     MD026105
      ** Find number of days to calculate interest according to calc.                       MD026105
      ** basis.                                                                             MD026105
      *                                                                                     MD026105
     C                     EXSR ZICD                                                        MD026105
      *                                                                                     MD026105
     C                     Z-ADD1         Z                                                 MD026105
      *                                                                                     MD026105
     C           ZIAMT     LOKUPZIB,Z                  40                                   MD026105
      *                                                                                     MD026105
      ** Move back Original Balance array(ZIB)                                              MD026105
      *                                                                                     MD026105
     C           WOVRIN    IFNE 0                                                           MD026105
     C                     MOVE WZIB      ZIB                                               MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
      ** If the sub-type is from 50000 to 99999, calculate the interest                     MD026105
      ** on the amount exceeding the initial threshold. Otherwise, the                      MD026105
      ** interest is calculated on the whole balance whenever it exceeds                    MD026105
      ** the initial threshold.                                                             MD026105
      *                                                                                     MD026105
     C           INST      IFGE 50000                                                       MD026105
     C           ZIAMT     SUB  ZITHR     ZIAMT                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 6                                                           MD026105
     C           ZIAMT     MULT INT6DY    WWMUL3 309                                        MD026105
     C                     ELSE                                                             MD026105
     C           ZIAMT     MULT ZDAYN2    WWMUL3                                            MD026105
     C                     ENDIF                                                            MD026105
     C           WWMUL3    MULT ZIR,Z     WWDIV3 309                                        MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 7                                                           MD026105
     C           ZICALC    OREQ 5                                                           MD026105
     C           ZICALC    OREQ 3                                                           MD026105
     C           ZICALC    OREQ 2                                                           MD026105
     C           WWDIV3    DIV  36000     ZIWRK1    H                                       MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 4                                                           MD026105
     C           ZICALC    OREQ 1                                                           MD026105
     C           WWDIV3    DIV  36500     ZIWRK1    H                                       MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 6                                                           MD026105
     C           WWDIV3    DIV  36600     ZIWRK1    H                                       MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     ADD  ZIWRK1    ZINTR     H                                       MD026105
      *                                                                                     MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** If OVERDRAFT exists                                                                MD026105
     C           WOVRIN    IFNE 0                                                           MD026105
     C                     Z-ADDBHISB     WACTDB                                            MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 7                                                           MD026105
     C           ZICALC    OREQ 5                                                           MD026105
     C           ZICALC    OREQ 3                                                           MD026105
     C           ZICALC    OREQ 2                                                           MD026105
     C           ZICALC    OREQ 0                                                           MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 0                                                           MD026105
     C           PINTN     ANDEQ'Y'                                                         MD026105
      *                                                                                     MD026105
     C                     Z-ADD1         C       20                                        MD026105
      *                                                                                     MD026105
     C           C         DOWLT12                                                          MD026105
     C                     Z-ADDZIA,C     WAMT   150                                        MD026105
     C                     Z-ADDZIR,C     WRATE  117                                        MD026105
     C                     EXSR SRINT0                                                      MD026105
     C                     Z-ADDZINTR     ZIN1,C                                            MD026105
     C                     ADD  1         C                                                 MD026105
     C                     ENDDO                                                            MD026105
      *                                                                                     MD026105
     C                     XFOOTZIN1      ZINTR1    H                                       MD026105
     C                     Z-ADDZINTR1    ZINTR     H                                       MD026105
      *                                                                                     MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
     C           WACTDB    DIV  36000     WZIA      H                                       MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 4                                                           MD026105
     C           ZICALC    OREQ 1                                                           MD026105
     C           WACTDB    DIV  36500     WZIA      H                                       MD026105
      *                                                                                     MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C           ZICALC    IFEQ 6                                                           MD026105
     C           WACTDB    DIV  36600     WZIA      H                                       MD026105
      *                                                                                     MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C           WZIA      MULT WOVRIN    WZIA                                              MD026105
     C           WZIA      MULT ZDAYN2    WZIN                                              MD026105
      *                                                                                     MD026105
     C                     ADD  WZIN      ZINTR                                             MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
      ** Core hook for externalisation.                                                     MD026105
     C/COPY WNCPYSRC,RE3360CLD6                                                             MD026105
      *                                                                                     MD026105
     C                     ENDSR                           **ZIC02 ENDSR**                  MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  DRINIT subroutine for debit rates loading                    *                     MD026105
      *                                                               *                     MD026105
      *      Called by       INTCAL                                   *                     MD026105
      *      Calls           *PSSR                                    *                     MD026105
      *****************************************************************                     MD026105
      *                                                                                     MD026105
     C           DRINIT    BEGSR                           **DRINIT BEGSR*                  MD026105
      *                                                                                     MD026105
     C                     Z-ADD*ZEROS    ZIRD                                              MD026105
     C                     Z-ADD*ZEROS    ZIBD                                              MD026105
     C                     Z-ADD*ZERO     ZITHR                                             MD026105
     C                     Z-ADD*ZEROS    INTHD                                             MD026105
      *                                                                                     MD026105
      ** Chain to debit rate changes files                                                  MD026105
      *                                                                                     MD026105
     C                     Z-ADDDRCD      KDATE                                             MD026105
      *                                                                                     MD026105
     C           DCKEY     CHAINREHRDJ               99                                     MD026105
      *                                                                                     MD026105
      ** Error in REHRDJ                                                                    MD026105
      *                                                                                     MD026105
     C           *IN99     IFEQ '1'                                                         MD026105
     C           DRIB      ANDEQ*ZEROS                                                      MD026105
     C           DRIS      ANDEQ*ZEROS                                                      MD026105
     C           OLDR      ORNE *ZEROS                                                      MD026105
     C                     MOVE '0'       *IN99                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           *IN99     IFEQ '1'                                                         MD026105
     C           *LOCK     IN   LDA                                                         MD026105
     C                     Z-ADD092       DBASE            ***************                  MD026105
     C                     MOVE 'REHRDJ'  DBFILE           * DB ERROR 092*                  MD026105
     C                     Z-ADDKDATE     REHDAT           ***************                  MD026105
     C                     MOVE *BLANKS   DBKEY                                             MD026105
     C                     MOVELREHKEY    DBKEY                                             MD026105
     C                     OUT  LDA                                                         MD026105
     C                     EXSR *PSSR                                                       MD026105
     C                     MOVE '1'       *INU7                                             MD026105
     C                     MOVE '1'       *INLR                                             MD026105
      *                                                                                     MD026105
     C                     RETRN                                                            MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Pick up Debit Threshold Balance                                                    MD026105
      *                                                                                     MD026105
     C                     Z-ADDINTHD     ZITHR                                             MD026105
      *                                                                                     MD026105
      ** Setup work Debit fields with fields read                                           MD026105
      *                                                                                     MD026105
     C           RAT2      IFNE *BLANKS                                                     MD026105
     C                     MOVELRAT2      WDRAT                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           RAT3      IFNE *BLANKS                                                     MD026105
     C                     MOVE RAT3      WDRAT                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           BAL2      IFNE *BLANKS                                                     MD026105
     C                     MOVELBAL2      WDBAL                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           BAL3      IFNE *BLANKS                                                     MD026105
     C                     MOVE BAL3      WDBAL                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Loading of debit interest rates and debit interest balances                        MD026105
      *                                                                                     MD026105
     C                     Z-ADDZIRD      ZIR                                               MD026105
     C                     Z-ADDZIBD      ZIB                                               MD026105
      *                                                                                     MD026105
     C                     ENDSR                           **DRINIT ENDSR*                  MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  CRINIT subroutine for credit rates loading                   *                     MD026105
      *                                                               *                     MD026105
      *      Called by       INTCAL                                   *                     MD026105
      *      Calls           *PSSR                                    *                     MD026105
      *****************************************************************                     MD026105
      *                                                                                     MD026105
     C           CRINIT    BEGSR                           **CRINIT BEGSR*                  MD026105
      *                                                                                     MD026105
     C                     Z-ADD*ZEROS    ZIRC                                              MD026105
     C                     Z-ADD*ZEROS    ZIBC                                              MD026105
     C                     Z-ADD*ZERO     ZITHR                                             MD026105
     C                     Z-ADD*ZEROS    INTHC                                             MD026105
      *                                                                                     MD026105
      ** Chain to credit rate changes file                                                  MD026105
      *                                                                                     MD026105
     C                     Z-ADDCRCD      KDATE                                             MD026105
      *                                                                                     MD026105
     C           DCKEY     CHAINREHRCJ               99                                     MD026105
      *                                                                                     MD026105
      ** Error in REHRCJ                                                                    MD026105
      *                                                                                     MD026105
     C           *IN99     IFEQ '1'                                                         MD026105
     C           CRIB      ANDEQ*ZEROS                                                      MD026105
     C           CRIS      ANDEQ*ZEROS                                                      MD026105
     C           OLCR      ORNE *ZEROS                                                      MD026105
     C                     MOVE '0'       *IN99                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           *IN99     IFEQ '1'                                                         MD026105
     C           *LOCK     IN   LDA                                                         MD026105
     C                     Z-ADD093       DBASE            ***************                  MD026105
     C                     MOVE 'REHRCJ'  DBFILE           * DB ERROR 093*                  MD026105
     C                     Z-ADDKDATE     REHDAT           ***************                  MD026105
     C                     MOVE *BLANKS   DBKEY                                             MD026105
     C                     MOVELREHKEY    DBKEY                                             MD026105
     C                     OUT  LDA                                                         MD026105
     C                     EXSR *PSSR                                                       MD026105
     C                     MOVE '1'       *INU7                                             MD026105
     C                     MOVE '1'       *INLR                                             MD026105
      *                                                                                     MD026105
     C                     RETRN                                                            MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Pick-up Credit Threshold Balance                                                   MD026105
      *                                                                                     MD026105
     C                     Z-ADDINTHC     ZITHR                                             MD026105
      *                                                                                     MD026105
      ** Setup work credit fields with fields read processing                               MD026105
      *                                                                                     MD026105
     C           RAT2      IFNE *BLANKS                                                     MD026105
     C                     MOVELRAT2      WCRAT                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           RAT3      IFNE *BLANKS                                                     MD026105
     C                     MOVE RAT3      WCRAT                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           BAL2      IFNE *BLANKS                                                     MD026105
     C                     MOVELBAL2      WCBAL                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           BAL3      IFNE *BLANKS                                                     MD026105
     C                     MOVE BAL3      WCBAL                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Loading of credit interest rates and credit interest balances                      MD026105
      *                                                                                     MD026105
     C                     Z-ADDZIRC      ZIR                                               MD026105
     C                     Z-ADDZIBC      ZIB                                               MD026105
      *                                                                                     MD026105
     C                     ENDSR                           **CRINIT ENDSR*                  MD026105
      *                                                                                     MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  DATEIN subroutine for date init processing                   *                     MD026105
      *                                                               *                     MD026105
      *      Called by       INTCAL                                   *                     MD026105
      *      Calls           *PSSR                                    *                     MD026105
      *****************************************************************                     MD026105
     C           DATEIN    BEGSR                           **DATEIN BEGSR*                  MD026105
      *                                                                                     MD026105
      ** Work field Init                                                                    MD026105
      *                                                                                     MD026105
     C                     Z-ADD*ZEROS    ZLDTM                                             MD026105
      *                                                                                     MD026105
      ** Calculating date from day number (REACR History date)                              MD026105
      *                                                                                     MD026105
     C                     Z-ADDDHISD     ZDAYNO                                            MD026105
     C                     EXSR ZDATE2                                                      MD026105
      *                                                                                     MD026105
      ** Verify if error                                                                    MD026105
      *                                                                                     MD026105
     C           *IN99     IFEQ '1'                                                         MD026105
     C           *LOCK     IN   LDA                                                         MD026105
     C                     Z-ADD094       DBASE            ***************                  MD026105
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 094*                  MD026105
     C                     MOVE *BLANKS   DBKEY            ***************                  MD026105
     C                     OUT  LDA                                                         MD026105
     C                     EXSR *PSSR                                                       MD026105
     C                     MOVE '1'       *INU7                                             MD026105
     C                     MOVE '1'       *INLR                                             MD026105
      *                                                                                     MD026105
     C                     RETRN                                                            MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
      ** Calculating first day of this month to calculate the last one                      MD026105
      *                                                                                     MD026105
     C           *IN98     IFEQ '0'                                                         MD026105
     C                     Z-ADDZDATE     RESULT                                            MD026105
     C                     Z-ADD1         ZDAY                                              MD026105
     C                     Z-ADDRESULT    ZDATE                                             MD026105
     C                     ELSE                                                             MD026105
     C                     Z-ADDZDATE     RESULX                                            MD026105
     C                     Z-ADD1         ZDAYX                                             MD026105
     C                     Z-ADDRESULX    ZDATE                                             MD026105
     C                     END                                                              MD026105
     C                     EXSR ZDATE1                                                      MD026105
      *                                                                                     MD026105
      ** Verify if error                                                                    MD026105
      *                                                                                     MD026105
     C           *IN99     IFEQ '1'                                                         MD026105
     C           *LOCK     IN   LDA                                                         MD026105
     C                     Z-ADD095       DBASE            ***************                  MD026105
     C                     MOVE 'ZDATE1'  DBFILE           * DB ERROR 095*                  MD026105
     C                     MOVE *BLANKS   DBKEY            ***************                  MD026105
     C                     OUT  LDA                                                         MD026105
     C                     EXSR *PSSR                                                       MD026105
     C                     MOVE '1'       *INU7                                             MD026105
     C                     MOVE '1'       *INLR                                             MD026105
      *                                                                                     MD026105
     C                     RETRN                                                            MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           *IN98     IFEQ '0'                                                         MD026105
     C           ZMTH      IFEQ 12                                                          MD026105
     C                     Z-ADD1         ZMTH                                              MD026105
     C                     ADD  1         ZYEAR                                             MD026105
     C                     ELSE                                                             MD026105
     C                     ADD  1         ZMTH                                              MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     Z-ADDRESULT    ZDATE                                             MD026105
     C                     ELSE                                                             MD026105
     C           ZMTHX     IFEQ 12                                                          MD026105
     C                     Z-ADD1         ZMTHX                                             MD026105
     C                     ADD  1         ZYEARX                                            MD026105
     C                     ELSE                                                             MD026105
     C                     ADD  1         ZMTHX                                             MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C                     Z-ADDRESULX    ZDATE                                             MD026105
     C                     END                                                              MD026105
     C                     EXSR ZDATE1                                                      MD026105
      *                                                                                     MD026105
      ** Verify if error                                                                    MD026105
      *                                                                                     MD026105
     C           *IN99     IFEQ '1'                                                         MD026105
     C           *LOCK     IN   LDA                                                         MD026105
     C                     Z-ADD096       DBASE            ***************                  MD026105
     C                     MOVE 'ZDATE1'  DBFILE           * DB ERROR 096*                  MD026105
     C                     MOVE *BLANKS   DBKEY            ***************                  MD026105
     C                     OUT  LDA                                                         MD026105
     C                     EXSR *PSSR                                                       MD026105
     C                     MOVE '1'       *INU7                                             MD026105
     C                     MOVE '1'       *INLR                                             MD026105
      *                                                                                     MD026105
     C                     RETRN                                                            MD026105
     C                     END                                                              MD026105
      *                                                                                     MD026105
     C           ZDAYNO    SUB  1         ZLDTM                                             MD026105
      *                                                                                     MD026105
     C                     ENDSR                           **DATEIN ENDSR*                  MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  ZDATE1 Subroutine to convert a date format to a day number.  *                     MD026105
      *                                                               *                     MD026105
      *      Called by       DATEIN                                   *                     MD026105
      *      Calls           -                                        *                     MD026105
      *****************************************************************                     MD026105
      *                                                                                     MD026105
     C/COPY ZSRSRC,ZDATE1Z2                                                                 MD026105
      *                                                                                     MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      **                                                                                    MD026105
      ** ZDATE2 Subroutine to convert a day number to date formats.                         MD026105
      **                                                                                    MD026105
      **     Called by       DATEIN, ZICD                                                   MD026105
      **     Calls           -                                                              MD026105
      **                                                                                    MD026105
      *****************************************************************                     MD026105
     C/EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  REHSR subroutine for REHISL file exception/error handling    *                     MD026105
      *                                                               *                     MD026105
      *      Called by       Input specifications                     *                     MD026105
      *      Calls           DBSR                                     *                     MD026105
      *****************************************************************                     MD026105
     C           REHSR     BEGSR                           **REHSR BEGSR*                   MD026105
      *                                                                                     MD026105
     C           *LOCK     IN   LDA                                                         MD026105
     C                     MOVE 'REHISL'  DBFILE           **************                   MD026105
     C                     Z-ADD18        DBASE            **DBERR  018**                   MD026105
     C                     MOVEL*BLANKS   DBKEY            **STATUS ERR**                   MD026105
     C                     MOVELSTSREH    DBSTAT  5        **************                   MD026105
     C                     OUT  LDA                                                         MD026105
     C                     EXSR DBSR                                                        MD026105
      *                                                                                     MD026105
     C                     ENDSR                           **REHSR ENDSR*                   MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  SRINT0 - SUBROUTINE TO CALCULATE INTEREST FOR RETAIL TYPE    *                     MD026105
      *           ACCOUNT (METHOD 0)                                  *                     MD026105
      *                                                               *                     MD026105
      *  CALLED BY: ZIC00, ZIC01 AND ZIC02 SUBROUTINE                 *                     MD026105
      *                                                               *                     MD026105
      *  CALLS: NONE                                                  *                     MD026105
      *                                                               *                     MD026105
      *****************************************************************                     MD026105
      *                                                                                     MD026105
     C           SRINT0    BEGSR                                                            MD026105
      *                                                                                     MD026105
     C                     MOVE CDP       WNDP    10                                        MD026105
     C                     Z-ADD1         WNDTMP 150                                        MD026105
      *                                                                                     MD026105
     C           WNDP      IFEQ 0                                                           MD026105
     C                     Z-ADD1         WNDTMP 150                                        MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
     C                     DO   WNDP                                                        MD026105
     C           10        MULT WNDTMP    WNDTMP                                            MD026105
     C                     ENDDO                                                            MD026105
      *                                                                                     MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C           WAMT      MULT ZDAYN2    WINAMT 150                                        MD026105
     C           WINAMT    DIV  100       WNAMT1 150H                                       MD026105
     C           WNAMT1    DIV  WNDTMP    WNAMT2 150H                                       MD026105
     C           WNAMT2    MULT WNDTMP    WRKFLD 150                                        MD026105
     C           WRKFLD    MULT WRATE     ZINT1  150                                        MD026105
     C           ZINT1     DIV  360       ZINT2  150H                                       MD026105
     C                     Z-ADDZINT2     ZINTR                                             MD026105
      *                                                                                     MD026105
     C                     ENDSR                                                            MD026105
      *****************************************************************                     MD026105
      /EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  SRAOS - Subroutine to call AOSVALR0 for New system valuele   *                     MD026105
      *          Interest Number                                      *                     MD026105
      *                                                               *                     MD026105
      *  Called By: INTCAL Subroutine                                 *                     MD026105
      *                                                               *                     MD026105
      *  Calls: AOSVALR0                                              *                     MD026105
      *                                                               *                     MD026105
      *****************************************************************                     MD026105
      *                                                                                     MD026105
     C           SRAOS     BEGSR                                                            MD026105
     C                     MOVE 'N'       WFIRST                                            MD026105
      *                                                                                     MD026105
     C                     CALL 'AOSVALR0'                                                  MD026105
     C                     PARM *BLANKS   PRTCD   7                                         MD026105
     C                     PARM PSYSVL    PSVLK1 20                                         MD026105
     C                     PARM           PSVL1 200                                         MD026105
     C                     PARM *BLANKS   PSVLK2 20                                         MD026105
     C                     PARM           PSVL2 200                                         MD026105
     C                     PARM *BLANKS   PSVLK3 20                                         MD026105
     C                     PARM           PSVL3 200                                         MD026105
     C                     PARM *BLANKS   PSVLK4 20                                         MD026105
     C                     PARM           PSVL4 200                                         MD026105
     C                     PARM *BLANKS   PSVLK5 20                                         MD026105
     C                     PARM           PSVL5 200                                         MD026105
     C                     PARM *BLANKS   PSVLK6 20                                         MD026105
     C                     PARM           PSVL6 200                                         MD026105
     C                     PARM *BLANKS   PSVLK7 20                                         MD026105
     C                     PARM           PSVL7 200                                         MD026105
     C                     PARM *BLANKS   PSVLK8 20                                         MD026105
     C                     PARM           PSVL8 200                                         MD026105
     C                     PARM *BLANKS   PSVLK9 20                                         MD026105
     C                     PARM           PSVL9 200                                         MD026105
     C                     PARM *BLANKS   PSVLK0 20                                         MD026105
     C                     PARM           PSVL10200                                         MD026105
      *                                                                                     MD026105
     C           PRTCD     IFNE *BLANKS                                                     MD026105
     C           PSVL1     ANDEQ'*NRF'                                                      MD026105
      *                                                                                     MD026105
     C                     EXSR *PSSR                                                       MD026105
     C                     ELSE                                                             MD026105
      *                                                                                     MD026105
     C                     MOVELPSVL1     PINTN   1                                         MD026105
      *                                                                                     MD026105
     C                     ENDIF                                                            MD026105
      *                                                                                     MD026105
     C                     ENDSR                                                            MD026105
      *****************************************************************                     MD026105
     C/EJECT                                                                                MD026105
      *****************************************************************                     MD026105
      *                                                               *                     MD026105
      *  DBSR SUBROUTINE FOR DATABASE ERROR HANDLING                  *                     MD026105
      *                                                               *                     MD026105
      *****************************************************************                     MD026105
     C           DBSR      BEGSR                           **DBSR BEGSR**                   MD026105
      *                                                                                     MD026105
     C                     MOVE '1'       *INU7                                             MD026105
     C                     MOVE '1'       *INU8                                             MD026105
     C                     MOVE '1'       *INLR                                             MD026105
     C                     EXSR *PSSR                                                       MD026105
     C                     RETRN                                                            MD026105
     C                     ENDSR                                                            MD026105
      *****************************************************************                     MD026105
     C/COPY ZSRSRC,ZDATE2Z2                                                                 MD026105
      *****************************************************************                     MD026105
     O*  WORKSTATION - INITIAL SCREEN OUTPUT
     O*
     ORE0280FME        81
     O                                   K8 'RE0280F1'
     O*****                    SCN51     51                               S01117
     O**********               SCN54     54                                            S01117 CGL029
     O                         SCN54     60                                                   CGL029
     O                         SRUNA      7
     O                         SID        9
     O                         SPID      15
     O                         WTIME     23 '  .  .  '
     O                         SWSID     26
     O*****                    SCUST     32                               S01117
     O*****                    SCCY      35                               S01117
     O*****                    SACCD     39                               S01117
     O*****                    SSEQ      41                               S01117
     O                         SBRCD     29                               S01117
     O                         SCUST     35                               S01117
     O                         SCCY      38                               S01117
     O**********               SACCD     42                                            S01117 CGL029
     O**********               SSEQ      44                                            S01117 CGL029
     O**********      N30      SRTNO     54                                            LN0229 CGL029
     O**********       KL      SCN54     54                                            S01117 CGL029
     O**********      N30      SRTNO     54                                            LN0229 CGL029
     O                         SACCD     48                                                   CGL029
     O                         SSEQ      50                                                   CGL029
     O                N30      SRTNO     60                                                   CGL029
     O                 KL      SCN54     60                                                   CGL029
     O                N30      SRTNO     60                                                   CGL029
     O*  ERROR FIELDS
     O*****                    ERMSG    130                               S01117
     O*****                    ERCD     206                               S01117
     O**********               ERMSG    133                                            S01117 CGL029
     O**********               ERCD     209                                            S01117 CGL029
     O                         ERMSG    139                                                   CGL029
     O                         ERCD     218                                                   CGL029
     O*
     O*  WORKSTATION - UPDATE SCREEN OUTPUT
     O*
     O        E        82
     O                                   K8 'RE0280F2'
     O*****                    SCN51     51                               S01117
     O**********               SCN54     54                                            S01117 CGL029
     O                         SCN54     60                                                   CGL029
     O                         SRUNA      7
     O                         SID        9
     O                         SPID      15
     O                         WTIME     23 '  .  .  '
     O                         SWSID     26
     O*****                    SCUST     32                               S01117
     O*****                    SCCY      35                               S01117
     O*****                    SACCD     39                               S01117
     O*****                    SSEQ      41                               S01117
     O                         SBRCD     29                               S01117
     O                         SCUST     35                               S01117
     O                         SCCY      38                               S01117
     O**********               SACCD     42                                            S01117 CGL029
     O**********               SSEQ      44                                            S01117 CGL029
     O**********      N30      SRTNO     54                                            LN0229 CGL029
     O                         SACCD     48                                                   CGL029
     O                         SSEQ      50                                                   CGL029
     O                N30      SRTNO     60                                                   CGL029
     O*  OUTPUT DETAIL FIELDS FOR UPDATE SCREEN
     O*****                    SPDI      95                               S01117
     O*****                    SPDIS     96                               S01117
     O*****                    SPCI     110                               S01117
     O*****                    SPCIS    111                               S01117
     O**********               SPDI      98                                            S01117 CGL029
     O**********               SPDIS     99                                            S01117 CGL029
     O**********               SPCI     113                                            S01117 CGL029
     O**********               SPCIS    114                                            S01117 CGL029
     O**********               SVLDDB   120                                            S01413 CGL029
     O**********               SVLDCR   126                                            S01413 CGL029
     O                         SPDI     104                                                   CGL029
     O                         SPDIS    105                                                   CGL029
     O                         SPCI     119                                                   CGL029
     O                         SPCIS    120                                                   CGL029
     O                         SVLDDB   126                                                   CGL029
     O                         SVLDCR   132                                                   CGL029
     O*  ERROR FIELDS AND CHANGE DETAILS
     O*****                    ERMSG    190                               S01117
     O*****                    ERCD     266                               S01117
     O**********               ERMSG    193                                            S01117 CGL029
     O**********               ERCD     269                                            S01117 CGL029
     O                         ERMSG    211                                                   CGL029
     O                         ERCD     290                                                   CGL029
      * THE ERROR MESSAGES 8 - 12 ARE FOR S01117 CHANGES                  S01117
**   ERROR MESSAGES
RECORD NOT ON FILE - ACCNT
RECORD NOT ON FILE - ACNUM
RECORD NOT ON FILE - NO POSTINGS OR HISTORY FOR THIS ACCOUNT
MUST ENTER EITHER KEY FIELDS OR RETAIL NUMBER
CANNOT ENTER BOTH KEY FIELDS AND RETAIL NUMBER
KEY FIELDS ENTRY INCORRECT
NO RETAIL NUMBER ENTRY ALLOWED
BRANCH CODE SHOULD NOT BE ENTERED WITH RETAIL ACCOUNT NUMBER
BRANCH ON FILE OR INPUT, INCORRECT OR NOT VALID FOR USER
USER IS NOT AUTHORISED TO THE ACTION CODE FOR THIS MENU ITEM
USER IS NOT AUTHORISED TO THE ACTION CODE FOR THIS MENU ITEM AND BRANCH
USER IS NOT AUTHORISED TO ANY ACTION CODES FOR THIS MENU ITEM AND BRANCH
INVALID CUSTOMER
INVALID CURRENCY
INVALID ACCOUNT CODE
INVALID FIELDS ENTERED
WARNING:ACCOUNT IS FLAGGED FOR CLOSED                                          185122
This is a Secondary account; adjustment should be applied to Primary account
ACCOUNT HAS BEEN CLOSED                                                        185122
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
** ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
** ZMNM - MONTH SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
