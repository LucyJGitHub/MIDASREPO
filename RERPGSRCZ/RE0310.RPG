0001 H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Stop Payments List')                          *
0001 H***********                                                         S01117
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Retail Module
0005 F*                                                               *
0006 F*  RE0310 - STOPPED PAYMENT LIST                                *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*      1990, 1993                                               *
0009 F*                                                               *
      *  Last Amend No. MD046248           Date 27Oct17               *
      *  Prev Amend No. CER059             Date 19Jul10               *
      *                 BUG23967           Date 13May09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG27045A          Date 13Apr10               *
      *                 BUG27045           Date 18Feb10               *
      *                 CAP201             Date 09Dec09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01413             Date 13Apr93               *
      *                                    Date                       *
0009 F*                                                               *
0012 F*****************************************************************
0011 F*                                                               *
      *  MD046248 - Finastra Rebranding                               *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23967 - Add Local Industry Code Field.                    *
      *  BUG27045A - Override the fix of Bug 27045 (Recompile)        *
      *  BUG27045 - Amend via SOAP removes Document Linkage           *
      *             (Recompile)                                       *
      *  CAP201 - Enhance Stopped Cheques processing for              *
      *           Teller Interfaces                                   *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  S01413  -  Retail 3 Incorporation                            *
     F*          -  Recompiled due to changes to files SSTOP, CLINT.  *
0009 F*  S01117  -  Multibranching                                    *
0011 F*                                                               *
0012 F*****************************************************************
0011 F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 F**
     F/COPY WNCPYSRC,RE0310F001
0011 F***SSTOP** IP  F      96  1AI     1 DISK                                                CGL029
     F***SSTOP** IP  F     106  1AI     1 DISK                                         CGL029 CAP201
     FSSTOP   IP  F     218  1AI     1 DISK                                                   CAP201
     F/COPY WNCPYSRC,RE0310F002
0013 F***TABLE** IF  F      96 12AI     2 DISK                                                CGL029
     FTABLE   IF  F     144 12AI     2 DISK                                                   CGL029
0015 F***CLINT** IF  F     256  7AI     2 DISK                                              BUG23967
     FCLINT   IF  F     264  7AI     2 DISK                                                 BUG23967
0017 F*E0310P1O** F     132     OF     PRINTER                      S01124S01117
0017 FRE0310P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
0017 FRE0310AUO   F     132     OV     PRINTER      KINFDS SPOOLU         S01117
0016 F**
0018 F* 01            STOPC HEADER
0019 F* 02                  DETAIL
0020 F* 03                  TRAILER
     F*       10      FIRST CYCLE INDICATOR                               S01117
0021 F*       20      RETAIL A/C NUMBER BLANK
0022 F*       21      DIFFERENCE IN NUMBER OF RECS
0023 F*       22      DIFFERENCE IN VALUE  OF RECS
0024 F*       23      NEW CCY
0025 F*       45      CHAIN FAIL
0026 F*       30      0 DEC PLACES
0027 F*       31      1 DEC PLACES
0028 F*       32      2 DEC PLACES
0029 F*       33      3 DEC PLACES
0030 F*       45      MULTI-PURPOSE
0031 F*       60      FROM CHEQUE NO. ZERO
0032 F*       61      TO CHEQUE NO ZERO
     F*       73      MULTIBRANCHING OUTPUT INDICATOR                     S01117
     F*       75      P1 FILE HAS BEEN OPENED                             S01117
     F*       76      NO DETAILS TO REPORT                                S01117
     F*       88      MBIN = 'Y'                                          S01117
     F*       89      BRNCH = 'ALL'                                       S01117
0033 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0034 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0035 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    CPY@    1   1 80
0036 E**
0037 I*
0038 I**
0039 I**   STOPPED CHEQUES FILE - SORTED
0040 ISSTOP   NS  01   1 CH
0041 I                                    P   2   40FLSZ
0042 I        NS  02   1 CD
0043 I       OR        1 C*  93 CD
0044 I**********                              2   70CNUM                                      CGL029
0045 I**********                              8  10 CCY                                       CGL029
0046 I**********                             11  140ACOD                                      CGL029
0047 I**********                             15  160ACSQ                                      CGL029
     I**********                              2   70CNUM  L1                           CGL029 CSD027
     I                                        2   7 CNUM  L1                                  CSD027
     I                                        8  10 CCY   L1                                  CGL029
     I                                       11  140ACODQQ                                    CGL029
     I                                       15  160ACSQ  L1                                  CGL029
0048 I**********                              2  16 LEVEL L1                                  CGL029
     I/COPY WNCPYSRC,RE0310I001
0049 I                                       17  190STCR
     I/COPY WNCPYSRC,RE0310I002
0050 I                                       20  290ACNO            20
0051 I***********                            30  320BRCD  L2              S01117
0051 I                                       30  32 BRCA  L2              S01117
0052 I                                       33  400FCHQ            60
0053 I                                       41  480TCHQ            61
0054 I                                    P  49  550STPA
0055 I                                    P  56  580DATI
0056 I                                       59  78 STPN
0057 I                                    P  79  810EXPD
0058 I                                    P  90  920LCD
0059 I                                       93  93 CHTP
0060 I                                    P  94  960TNLU
     I                                       97 1060ACOD  L1                                  CGL029
     I                                      107 171 EUSER                                     CAP201
     I                                      172 197 TMSTP                                     CAP201
     I                                      198 217 FROID                                     CAP201
     I                                      218 218 RPRLOC                                    CAP201
     I/COPY WNCPYSRC,RE0310I003
0061 I                                        1  96 LSTC
     I/COPY WNCPYSRC,RE0310I004
0062 I**
0063 I**
0064 I        NS  03   1 CT
0065 I                                    P  20  220NOSQ
0066 I                                    P  23  300VQW
0067 I                                    P  31  320VQD
0068 I                                    P  33  340NSQI
0069 I                                    P  35  360NSQA
0070 I                                    P  37  380NSQD
0071 I                                    P  39  460VQIW
0072 I                                    P  47  480VQID
0073 I                                    P  49  560VQAW
0074 I                                    P  57  580VQAD
0075 I                                    P  59  660VQDW
0076 I                                    P  67  680VQDD
0077 I                                    P  69  710NSAU
0078 I                                    P  72  790VQUW
0079 I                                    P  80  810VQUD
0080 I                                    P  82  840LCD
0081 I                                    P  85  870TNLU
     I/COPY WNCPYSRC,RE0310I005
0082 I                                        1  96 LOT
     I/COPY WNCPYSRC,RE0310I006
0083 I**
0084 I**   CATCHALL
0085 I        NS  04
0086 I**   TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.
0087 I**
0088 ITABLE   NS       2 C0   3 C1  12 C1
0089 I       AND      13 C0
0090 I                                        1   1 RECI
0091 I                                        2   30RECT
0092 I                                       12  130RCDE
0093 I                                       14  66 TITL
0094 I***********                            67  67 DATF                  S01117
0095 I***********                            68  700DFBR                  S01117
0095 I                                       68  70 DFBM                  S01117
0096 I                                       74  74 MODI1
0097 I                                       75  75 MODI2
0098 I                                       76  76 MODI3
0099 I***********                         P  77  790RUND                  S01117
0100 I***********                            80  86 RUNA                  S01117
0101 I                                       87  870SFLG
0102 I                                        1  96 LOT
0103 I**
0104 I**   TABLE FILE - CURRENCIES RECORD 1.
0105 I**
0106 ITABLE   NS       1 CD   2 C2   3 C0
0107 I       AND      13 C1
0108 I                                        1   1 RECI
0109 I                                        2   30RECT
0110 I                                       10  12 TBCCY
0111 I                                       13  130SREC
0112 I                                       14  27 CCNM
0113 I                                    P  28  348SPOT
0114 I                                       35  37 CCYS
0115 I                                       38  380CDP
0116 I                                       39  390TNOT
0117 I                                       40  40 DCCY
0118 I                                       41  44 SRC1
0119 I                                       45  48 SRC2
0120 I**********                             49  520TACC                                      CGL029
0121 I**********                             53  560TEQV                                      CGL029
0122 I**********                             57  600SWQV                                      CGL029
0123 I**********                             61  640TAC4                                      CGL029
0124 I**********                             65  680TAC5                                      CGL029
0125 I**********                             69  69 HIND                                      CGL029
0126 I**********                          P  70  768PART                                      CGL029
0127 I**********                             77  780SSNO                                      CGL029
     I                                       49  580TACC                                      CGL029
     I                                       59  680TEQV                                      CGL029
     I                                       69  780SWQV                                      CGL029
     I                                       79  880TAC4                                      CGL029
     I                                       89  980TAC5                                      CGL029
0125 I                                       99  99 HIND                                      CGL029
0126 I                                    P 100 1068PART                                      CGL029
0127 I                                      107 1080SSNO                                      CGL029
0128 I                                        1  96 LOT
0129 I**
0130 I**   TABLE FILE - CURRENCIES RECORD 2.
0131 I**
0132 I        NS       1 CD   2 C2   3 C0
0133 I       AND      13 C2
0134 I                                        1   1 RECI
0135 I                                        2   30RECT
0136 I                                       10  12 CCY
0137 I                                       13  130SREC
0138 I                                       14  42 EURB
0139 I                                        1  96 LOT
0140 I**
0141 I**   CATCHALL FOR DELETED RECORDS.
0142 I        NS
0143 I**
0144 I**
0145 I**   CLIENT FILE - CUSTOMER STANDING DATA RECORD.
0146 I**
0147 ICLINT   NS       1 CD   8 CA
0148 I                                        1   1 RECI
0149 I**********                              2   70CNUMC                                     CSD027
0149 I                                        2   7 CNUMC                                     CSD027
0150 I                                        8   8 RCDT
0151 I                                        9  28 CRNM
0152 I                                       29  38 CTWN
0153 I                                       39  48 CSNM
0154 I                                       49  56 CASK
0155 I                                       57  68 TELX
0156 I                                       69  80 CSID
0157 I                                       81  82 ACOC
0158 I                                       83  83 CBSI
0159 I                                       84  85 CCTZ
0160 I                                       86  87 CLOC
0161 I**********                             88  930CPAR                                      CSD027
0161 I                                       88  93 CPAR                                      CSD027
0162 I                                       97  98 LINS
0163 I                                       99 101 LIND
0164 I                                    P 102 1040DASU
0165 I                                    P 105 1070CDIC
0166 I                                    P 108 1100DADE
0167 I                                      111 111 CMIN
0168 I                                      112 112 CTYP
0169 I                                      113 124 TELF
     I                                      262 264 LOIC                                    BUG23967
0170 I**
0171 I**   CATCHALL FOR DELETED RECORDS.
0172 I        NS
0218 I*                                                                   S01117
0219 I*    LDA - DIAGNOSTICS FOR PROGRAM ABORT                            S01117
0220 I*                                                                   S01117
0221 ILDA        UDS                            256                       S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**  EXTERNAL DS FOR BRANCH DETAILS                                  S01117
     I              A8BRNM                          BRNM                  S01117
     IDSFDY     E DSDSFDY                                                 S01117
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01117
     I*                                                                   S01117
     I**                                                                  S01117
     C                     MOVEACPY@      BIS@   80
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C**                                                                  S01117
0175 C**N01******          GOTO MAINPR                                    S01117
     C   10                GOTO MAINPR                                    S01117
0176 C**
0177 C**   FIRST CYCLE CALCS
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVE *BLANKS   DBFILE                          S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVE *BLANKS   DBPGM                           S01117
     C                     MOVE 'RE0310  'DBPGM                           S01117
     C                     OUT  LDA                                       S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NO.  S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
     C**                                                                  S01117
     C**    IN THE DATAAREA RUNDAT                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C**    TEST FOR MULTIBRANCHING                                       S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
0178 C                     EXSR ZSYSTM
0179 C                     TIME           OTIME   60
     C                     SETON                     10                   S01117
     C**                                                                  S01117
     C**  END OF FIRST CYCLE CALCS                                        S01117
     C**                                                                  S01117
0180 C***********          GOTO END                                       S01117
     C   01                GOTO END                                       S01117
0181 C**
0182 C           MAINPR    TAG                             * MAINPR TAG **
0183 C   04                GOTO END
0184 C                     SETOF                     77
0185 C   02      EXPD      COMP 99999                    77
     C*                                                                   S01117
     C*   MULTIBRANCHING CHANGES                                          S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C** IF THE REQUIRED BRANCH IS GREATER THAN BRCA,                     S01117
     C** SKIP THE CALCULATION                                             S01117
     C*                                                                   S01117
     C           BRNCH     IFGT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETOF                     73                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** IF THE REQUIRED BRANCH IS LESS THAN BRCA                         S01117
     C** END THE PROGRAM                                                  S01117
     C*                                                                   S01117
     C           BRNCH     IFLT BRCA                                      S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C                     SETON                     LR                   S01117
     C                     SETOF                     73                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           *INL2     IFEQ '1'                                       S01117
     C                     CLOSERE0310P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C           MBIN      OREQ 'N'                                       S01117
     C                     SETON                     73    ALLOW OUTPUT   S01117
     C                     OPEN RE0310P1                                  S01117
     C*                                                                   S01117
     C** INDICATE THAT THE P1 FILE HAS BEEN OPENED                        S01117
     C                     SETON                     75                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         ASTOP                           S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7LR                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**                                                                  S01117
     C** GET BRANCH NAME (IN BRNM)                                        S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD12        DBASE            * DBERROR 012 *S01117
     C                     OUT  LDA                        ***************S01117
     C                     SETON                     U7LR                 S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
     C                     SETOF                     73                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0186 C*
0187 C*    IF NO STOP CHEQUES ON FILE-NO CONTROL BREAK L1,SO NO HEADINGS.
0188 C*    THEREFORE HAVE ARTIFICIAL CONTROL BREAK WHEN TRAILER READ.
0189 C   02                SETON                     24
0190 C   03N24             SETON                     L2L1
0191 C*
0192 C**
0193 C**   IF TRAILER, COMPARE NUMBER AND VALUE OF RECORDS AFTER
0194 C**   UPDATE WITH AMOUNTS ON FILE
     C           MBIN      IFEQ 'N'                                       S01117
     C           MBIN      OREQ 'Y'                                       S01117
     C           BRNCH     ANDEQ'ALL'                                     S01117
0195 C   03      NSAU      COMP OCNO                 2121
0196 C   03      VQUW      COMP ZZTOTI               2222
0197 C   03N22   VQUD      COMP ZZTOTD               2222
     C                     END                                            S01117
0198 C**
0199 C   21
0200 COR 22                SETON                     U8
0201 C   03                GOTO END
0202 C**
0203 C**   ACCESS CUSTOMER NAME IF CHANGED
0204 C           CNUM      COMP CNUMC                    45
0205 C  N45                MOVELCNUM      CLKEY   7
0206 C  N45                MOVE 'A'       CLKEY
0207 C  N45      CLKEY     CHAINCLINT                45
0208 C**
0209 C**   FIND NO OF DECIMAL POSITIONS IF CHANGED
0210 C           CCY       COMP TBCCY                2323
0211 C   23                MOVEL'20      'TKEY   12
0212 C                     MOVELCCY       CCY4    4
0213 C                     MOVE '1'       CCY4
0214 C   23                MOVE CCY4      TKEY
0215 C   23      TKEY      CHAINTABLE                45
0216 C           CDP       COMP 0                        30
0217 C           CDP       COMP 1                        31
0218 C           CDP       COMP 2                        32
0219 C           CDP       COMP 3                        33
0220 C**
0221 C**   ADD TO ACCUMULATORS
0222 C           1         ADD  ASTOP     ASTOP   50
0223 C           CHTP      COMP 'D'                      25
0224 C   25      1         ADD  DELETS    DELETS  30
0225 C  N25      1         ADD  OCNO      OCNO    50
0226 C  N25                MOVE STPA      ZZAMT
0227 C  N25                EXSR GLZADD
0228 C** CONVERT DATES TO ALPHA FORMAT
0229 C                     Z-ADDDATI      ZDAYNO
0230 C                     EXSR ZDATE2
0231 C                     MOVE ZADATE    ODATI   7
0232 C                     Z-ADDEXPD      ZDAYNO
0233 C                     EXSR ZDATE2
0234 C                     MOVE ZADATE    ODATE   7
0235 C                     Z-ADDLCD       ZDAYNO
0236 C                     EXSR ZDATE2
0237 C                     MOVE ZADATE    OLCD    7
0238 C**
0239 C** SET UP ACTION FOR REPORT
0240 C           CHTP      COMP 'I'                      45
0241 C   45                MOVE 'INSERT'  OACT    6
0242 C           CHTP      COMP 'A'                      45
0243 C   45                MOVE 'AMEND '  OACT
0244 C           CHTP      COMP 'D'                      45
0245 C   45                MOVE 'DELETE'  OACT
0246 C           END       TAG                             ** END TAG **
0247 CL2         ASTOP     SUB  DELETS    ASTOP
0248 CL2                   Z-ADD0         DELETS
     C*                                                                   S01117
     C** IF P1 FILE NOT OPEN (BECAUSE NO RECORDS READ) THEN OPEN IT       S01117
     C*                                                                   S01117
     CLR         *IN75     IFNE '1'                                       S01117
     CLR                   SETON                     76                   S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   EXCPTNODTL                                     S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7                   S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR U7                EXSR *PSSR                                     S01117
0349 C**                                                                  S01117
0249 C********************************************************************
0250 C**
0251 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0252 C**
0253 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0254 C**
0255 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
0256 C                     MOVEL'01      'ZTABKY 12
0257 C                     MOVE '  10'    ZTABKY
0258 C**
0259 C           ZTABKY    CHAINTABLE                99    ON NOT THERE
0260 C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
0261 C**
0262 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0263 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
0264 C**
0265 C                     ENDSR
0266 C**
0267 C**
0268 C********************************************************************
0269 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0270 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0271 C*
0272 CSR         GLZADD    BEGSR                           *** GLZADD ****
0273 C*
0274 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0275 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0276 C*
0277 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0278 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0279 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0280 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0281 C*
0282 CSR                   EXSR GLZSUM
0283 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0284 C*
0285 C********************************************************************
0286 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0287 C*                        GLZADD, GLZSUB, GLZCMP.
0288 C*          PARAMETERS PASSED -
0289 C*                     I/P ZZAMTI ZZAMTD
0290 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0291 C*
0292 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0293 C*
0294 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0295 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0296 CSR                   SETOF                     919293
0297 CSR                   SETOF                     949599
0298 C*
0299 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0300 CSR         ZZAMTI    COMP 0                      9293
0301 CSR 93      ZZAMTD    COMP 0                      9293
0302 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0303 C*
0304 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0305 CSR         ZZTOTI    COMP 0                      9193
0306 CSR 93      ZZTOTD    COMP 0                      9193
0307 C*
0308 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0309 CSR 93                Z-ADDZZAMTI    ZZTOTI
0310 CSR 93                Z-ADDZZAMTD    ZZTOTD
0311 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0312 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0313 CSR 91N92
0314 CORN91 92             GOTO ZZOFPS
0315 C*
0316 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0317 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0318 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0319 C*
0320 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0321 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0322 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0323 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0324 C*
0325 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0326 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0327 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0328 CSRN99                Z-ADDZZWK2     ZZTOTD
0329 CSRN99                Z-ADDZZWK3     ZZTOTI
0330 C*
0331 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0332 CSR 99                Z-ADD0         ZZAMT  153
0333 CSR                   GOTO ZZSEND
0334 C*
0335 C* THE 'SIGNS' ARE DIFFERENT
0336 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0337 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0338 C*
0339 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0340 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0341 C*
0342 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0343 C*
0344 CSR 91                Z-SUBZZTOTI    ZZTOTI
0345 CSR 91                Z-SUBZZTOTD    ZZTOTD
0346 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0347 C*
0348 CSR         ZZTOTI    COMP ZZAMTI               93  95
0349 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0350 C*
0351 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0352 CSR 95                Z-ADD0         ZZTOTI
0353 CSR 95                Z-ADD0         ZZTOTD
0354 CSR 95                GOTO ZZSEND
0355 C*
0356 C* IF ZZTOT GT. ZZAMT.
0357 CSR 93      ZZAMTD    COMP ZZTOTD               94
0358 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0359 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0360 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0361 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0362 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0363 C*
0364 C*
0365 C* IF ZZAMT GT. ZZTOT.
0366 CSRN93      ZZTOTD    COMP ZZAMTD               94
0367 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0368 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0369 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0370 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0371 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0372 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0373 C*
0374 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0375 CSR                   SETOF                     94
0376 CSR 93 91
0377 CORN93 92             SETON                     94
0378 CSR 94                Z-SUBZZTOTI    ZZTOTI
0379 CSR 94                Z-SUBZZTOTD    ZZTOTD
0380 C**
0381 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0382 CSR 92                Z-SUBZZAMTI    ZZAMTI
0383 CSR 92                Z-SUBZZAMTD    ZZAMTD
0384 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0385 C**
0386 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0387 CSR                   SETOF                     96
0388 CSR         ZZTOTD    COMP 0                        91
0389 CSR 91      ZZTOTI    COMP 0                      96
0390 CSR 96                MOVE '.000-'   ZZNEGD  5
0391 CSR                   ENDSR                             ** ENDSR **
0392 C********************************************************************
0393 C********************************************************************
0394 C**
0395 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0396 C**
0397 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0398 C**
0399 C**   CLEAR DATE FIELDS.
0400 C                     Z-ADD0         ZDATE   60
0401 C                     MOVEL'       ' ZADATE  7
0402 C**
0403 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0404 C                     Z-ADDZDAYNO    ZDAYNO  50
0405 C**
0406 C**   DETERMINE YEAR NUMBER.
0407 C**
0408 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0409 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0410 C   99                GOTO ZDEND2
0411 C**
0412 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0413 C           ZDAYN1    DIV  1461      ZLYR    20
0414 C                     MVR            ZDAYN1           SAVE REMAINING
0415 C**                                                   DAYS
0416 C**   CALCULATE NUMBER OF REMAINING YEARS.
0417 C                     Z-ADD1         ZWRK2   20
0418 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0419 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0420 C  N90      ZWRK2     ADD  1         ZWRK2
0421 C  N90                GOTO ZDTAG1
0422 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0423 C**
0424 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0425 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0426 C**
0427 C**   CALCULATE ACTUAL YEAR NUMBER.
0428 C           ZLYR      MULT 4         ZWRK3   30
0429 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0430 C                     Z-ADDZWRK3     ZYEAR   20
0431 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0432 C**
0433 C**   DETERMINE MONTH NUMBER.
0434 C**
0435 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0436 C                     SETOF                     9293
0437 C   91      ZDAYN1    COMP 59                     9293
0438 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0439 C**
0440 C**   CALCULATE MONTH NUMBER.
0441 C                     Z-ADD2         ZWRK2
0442 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0443 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0444 C  N94      ZWRK2     ADD  1         ZWRK2
0445 C  N94                GOTO ZDTAG2
0446 C           ZWRK2     SUB  1         ZWRK2
0447 C**
0448 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0449 C**
0450 C**   DETERMINE DAY OF MONTH.
0451 C**
0452 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0453 C           ZDAYN1    ADD  1         ZDAYN1
0454 C**
0455 C**   CALCULATE DAY OF MONTH.
0456 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0457 C**
0458 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0459 C   93      ZDAY      ADD  1         ZDAY
0460 C**
0461 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0462 C  N98                MOVELZDAY      ZWRK4   40
0463 C   98                MOVE ZDAY      ZWRK4
0464 C  N98                MOVE ZMTH      ZWRK4
0465 C   98                MOVELZMTH      ZWRK4
0466 C                     MOVELZWRK4     ZDATE
0467 C                     MOVE ZYEAR     ZDATE
0468 C**
0469 C**   FORMAT ALPHA DATE, DDMMMYY.
0470 C           ZDAY      COMP 10                     95
0471 C                     MOVELZDAY      ZWRK5   5
0472 C   95                MOVEL' '       ZWRK5
0473 C                     MOVE ZMNM,ZMTH ZWRK5
0474 C                     MOVELZWRK5     ZADATE
0475 C                     MOVE ZYEAR     ZADATE
0476 C**
0477 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0478 C**
0546 C********************************************************************S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILE HAS NOT ALREADY BEEN OPENED (IE. IF THERE ARE         S01117
     C* NO RECORDS READ AND THEREFORE FILE OPENING NOT PERFORMED          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C** OPEN P1 SPOOL FILE                                               S01117
     C                     OPEN RE0310P1                                  S01117
     C*                                                                   S01117
     C** INDICATE THAT THE P1 FILE HAS BEEN OPENED                        S01117
     C                     SETON                     75                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** IF IT'S BRANCH ALL, NO BRANCH NAME WILL BE PRINTED               S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C                     SETON                     89                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY          S01117
     C           BRNCH     IFEQ 'ALL'                      B1             S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7                   S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED       S01117
     C                     ELSE                            X1             S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7                   S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN MULTIBRANCHING   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD11        DBASE            * DBERROR 011 *S01117
     C                     OUT  LDA                        ***************S01117
     C                     SETON                     U7                   S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                             E1             S01117
     C*                                                                   S01117
     C           #ZZ9      ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
0479 C**                                                                  S01117
0480 C********************************************************************S01117
0481 O*E0310P1H**202   L2                                           S01124S01117
0482 O*******OR**      OFNL2                                              S01117
0483 O***********                        20 'REFERENCE RE0310'            S01117
0481 ORE0310P1H  202   L2 73                                              S01117
0482 O       OR        OFNL2 73                                           S01117
0483 O                                   22 'REFERENCE RE0310P1'          S01117
0484 O                         TITL      93
0485 O                                  104 'DATE'
0486 O                         RUNA     113
0487 O                                  122 'PAGE'
0488 O                         PAGE  Z  127
0489 O********H**      L2                                                 S01117
0490 O*******OR**      OFNL2                                              S01117
0489 O        H        L2 73                                              S01117
0490 O       OR        OFNL2 73                                           S01117
0491 O                 U1                52 'INTERIM'
0492 O                                   71 'STOP CHEQUES LIST'
0493 O                 U1      OTIME     82 '  .  .  '
0494 O***********                       106 'BRANCH'                      S01117
0495 O***********              BRCD     110                               S01117
     O                 U1 88             92 'BRANCH'                      S01117
     O                 U1 88   BRCA      96                               S01117
     O                 U1 88             97 '-'                           S01117
     O                 U1 88   BRNM     127                               S01117
     O                NU1 88             81 'BRANCH'                      S01117
     O                NU1 88   BRCA      85                               S01117
     O                NU1 88             86 '-'                           S01117
     O                NU1 88   BRNM     116                               S01117
0496 O********H**2     L2                                                 S01117
0497 O*******OR**      OFNL2                                              S01117
0496 O        H  2     L2 73                                              S01117
0497 O       OR        OFNL2 73                                           S01117
0498 O                 U1                52 '*******'
0499 O                                   71 '-----------------'
0500 O                 U1                82 '********'
0501 O********H**      L2                                                 S01117
0502 O*******OR**      OFNL2                                              S01117
0501 O        H        L2 73                                              S01117
0502 O       OR        OFNL2 73                                           S01117
0503 O                                   17 'ACCOUNT NUMBER'
0504 O**********                         33 'CUSTOMER NAME'                                   CGL029
     O                                   39 'CUSTOMER NAME'                                   CGL029
0505 O********H**2     L2                                                 S01117
0506 O*******OR**      OFNL2                                              S01117
0505 O        H  2     L2 73                                              S01117
0506 O       OR        OFNL2 73                                           S01117
     O/COPY WNCPYSRC,RE0310O001
0507 O                                   30 'CCY   REF  INPUT'
0508 O                                   41 'EXPIRY'
0509 O                                   57 'CHEQUE NOS'
0510 O                                   78 'AMOUNT'
0511 O                                   98 'REASON FOR STOP'
0512 O                                  112 'LAST CHANGE'
0513 O                                  122 'ACTION'
     O/COPY WNCPYSRC,RE0310O002
0514 O********D*21     02 L1                                              S01117
0514 O        D 21     02 L1 73                                           S01117
0515 O                 20      CNUM       6
0516 O                 20                 7 '-'
0517 O                 20      CCY       10
0518 O                 20                11 '-'
0519 O**********       20      ACOD      15                                                   CGL029
0520 O**********       20                16 '-'                                               CGL029
0521 O**********       20      ACSQ      18                                                   CGL029
     O                 20      ACOD      21                                                   CGL029
     O                 20                22 '-'                                               CGL029
     O                 20      ACSQ      24                                                   CGL029
0522 O                N20      ACNO      10
0523 O**********               CRNM      40                                                   CGL029
     O                         CRNM      46                                                   CGL029
0524 O********D**      02                                                 S01117
0524 O        D        02 73                                              S01117
0525 O                         CCY       17
     O/COPY WNCPYSRC,RE0310O003
0526 O                         STCR      23
0527 O                         ODATI     32
0528 O                         ODATE     42
0529 O                       77          42 '       '
0530 O                         FCHQ      52
0531 O                                   53 '-'
0532 O                         TCHQ      61
0533 O                       60          61 '                 '
0534 O                       61          61 '         '
0535 O                 30      STPA      80 ' ,   ,   ,   , 0 '
0536 O                 31      STPA      80 '   ,   ,   , 0 . '
0537 O                 32      STPA      80 '  ,   ,   , 0 .  '
0538 O                 33      STPA      80 ' ,   ,   , 0 .   '
0539 O                         STPN     101
0540 O                         OLCD     110
0541 O                         OACT     122
     O/COPY WNCPYSRC,RE0310O004
0542 O********T*32     L2                                                 S01117
0542 O        T 3      L2 73 88                                           S01117
0543 O                                   60 'BRANCH TOTALS'
0544 O********T**      L2                                                 S01117
0544 O        T 2      L2 73                                              S01117
0545 O                                   63 'NUMBER OF ACTIVE'
0546 O                                   76 'STOP CHEQUES'
0547 O***********              ASTOP 1B  82                               S01117
0547 O                         ASTOP 1   82                               S01117
0829 O        T 32     L2 U7 73                                           S01117
0831 O                                   74 '*** DATABASE ERROR ***'      S01117
     O        T 3      L2 73                                              S01117
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRCA      77                               S01117
     O                 88                81 ' ***'                        S01117
     O                N88                76 '*** END OF REPORT ***'       S01117
0548 O**      FILE CONTROLS
0549 O********T**202   LR                                                 S01117
0550 O***********                        20 'REFERENCE RE0310'            S01117
0481 O        E  202           NODTL                                      S01117
0483 O                                   22 'REFERENCE RE0310P1'          S01117
0484 O                         TITL      93                               S01117
0485 O                                  104 'DATE'                        S01117
0486 O                         RUNA     113                               S01117
0487 O                                  122 'PAGE'                        S01117
0488 O                         PAGE  Z  127                               S01117
0489 O        E                NODTL                                      S01117
0491 O                 U1                52 'INTERIM'                     S01117
0492 O                                   71 'STOP CHEQUES LIST'           S01117
0493 O                 U1      OTIME     82 '  .  .  '                    S01117
     O                 U1 88             92 'BRANCH'                      S01117
     O                 U1 88   BRNCH     96                               S01117
     O                 U1 88N89          97 '-'                           S01117
     O                 U1 88N89BRNM     127                               S01117
     O                NU1 88             81 'BRANCH'                      S01117
     O                NU1 88   BRNCH     85                               S01117
     O                NU1 88N89          86 '-'                           S01117
     O                NU1 88N89BRNM     116                               S01117
0496 O        E  2             NODTL                                      S01117
0498 O                 U1                52 '*******'                     S01117
0499 O                                   71 '-----------------'           S01117
0500 O                 U1                82 '********'                    S01117
0501 O        E                NODTL                                      S01117
0503 O                                   17 'ACCOUNT NUMBER'              S01117
0504 O                                   33 'CUSTOMER NAME'               S01117
0505 O        E  2             NODTL                                      S01117
0507 O                                   30 'CCY   REF  INPUT'            S01117
0508 O                                   41 'EXPIRY'                      S01117
0509 O                                   57 'CHEQUE NOS'                  S01117
0510 O                                   78 'AMOUNT'                      S01117
0511 O                                   98 'REASON FOR STOP'             S01117
0512 O                                  112 'LAST CHANGE'                 S01117
0513 O                                  122 'ACTION'                      S01117
     O        E 3              NODTL                                      S01117
     O                                   71 '***   NO DETAILS TO REPO'    S01117
     O                                   79 'RT   ***'                    S01117
     O        E 3              NODTL                                      S01117
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRNCH     77                               S01117
     O                 88                81 ' ***'                        S01117
     O                N88                76 '*** END OF REPORT ***'       S01117
0549 ORE0310AUT  202   LR                                                 S01117
0550 O                                   22 'REFERENCE RE0310AU'          S01117
0551 O                         TITL      93
0552 O                                  104 'DATE'
0553 O                         RUNA     113
0554 O                                  122 'PAGE'
0555 O***********              PAGE  Z  127                               S01117
0555 O                         PAGE1 Z  127                               S01117
0556 O        T        LR
0557 O                 U1                52 'INTERIM'
0558 O                                   71 'STOP CHEQUES LIST'
0559 O                 U1      OTIME     82 '  .  .  '
     O                NU1                87 'RUN CONTROLS'                S01117
     O                 U1                98 'RUN CONTROLS'                S01117
0560 O        T  2     LR
0561 O                 U1                52 '*******'
0562 O                                   71 '-----------------'
0563 O                 U1                82 '********'
0564 O        T   15   LR
0565 O                                   39 'END OF REPORT TOTALS'
0566 O        T 2      LR
0567 O                                   39 'NUMBER OF INSERTIONS'
0568 O                         NSQI  1   57
0569 O                                   84 'VALUE OF INSERTIONS'
0570 O                         VQIW  Z  116
0571 O                         VQID     119
0572 O        T 1      LR
0573 O                                   39 'NUMBER OF AMENDMENTS'
0574 O                         NSQA  1   57
0575 O                                   84 'VALUE OF AMENDMENTS'
0576 O                         VQAD     119
0577 O                         VQAW  Z  116
0578 O        T 1      LR
0579 O                                   38 'NUMBER OF DELETIONS'
0580 O                         NSQD  1   57
0581 O                                   83 'VALUE OF DELETIONS'
0582 O                         VQDD     119
0583 O                         VQDW  Z  116
0584 O        TF21     LR
0585 O                                   36 'NUMBER OF RECORDS'
0586 O                                   50 'BEFORE UPDATE'
0587 O                         NOSQ  1   57
0588 O                                   81 'VALUE OF RECORDS'
0589 O                                   95 'BEFORE UPDATE'
0590 O                         VQD      119
0591 O                         VQW   Z  116
0592 O        T        LR
0593 O                                   36 'NUMBER OF RECORDS'
0594 O                                   49 'AFTER UPDATE'
0595 O                         NSAU  1   57
0596 O                                   81 'VALUE OF RECORDS'
0597 O                                   94 'AFTER UPDATE'
0598 O                         VQUD     119
0599 O                         VQUW  Z  116
0600 O        T 2      LR U8
0601 O                                   16 'CALCULATED'
0602 O                                   36 '-NUMBER OF RECORDS'
0603 O                                   49 'AFTER UPDATE'
0604 O                         OCNO  1   57
0605 O                                   81 '-VALUE OF RECORDS'
0606 O                                   94 'AFTER UPDATE'
0607 O                         ZZTOTD   119
0608 O                         ZZTOTIZ  116
0609 O        T 2      LR
0610 O                 21                54 '***  DIFFERENCE  ***'
0611 O                 22               119 '***  DIFFERENCE  ***'
0868 O*                                                                   S01117
0797 O*  DATABASE ERROR OUTPUT                                            S01117
0798 O*                                                                   S01117
0799 O        T 32     LR U7                                              S01117
0800 O                                   58 'DATABASE ERROR '             S01117
0801 O                         DBASE     61                               S01117
0802 O                                   75 'IN PROGRAM '                 S01117
0803 O                         DBPGM     85                               S01117
0799 O        T  2     LR U7                                              S01117
0804 O                                   48 'FILE '                       S01117
0805 O                         DBFILE    56                               S01117
0804 O                                   62 ', KEY '                      S01117
0805 O                         DBKEY     91                               S01117
0868 O*                                                                   S01117
0797 O*  NO DETAILS OUTPUT                                                S01117
0798 O*                                                                   S01117
     O        T 3      LR 76                                              S01117
     O                                   70 '***   NO DETAILS TO REPO'    S01117
     O                                   78 'RT   ***'                    S01117
0612 O********T** 45   LR                                                 S01117
0613 O***********                        72 '*** END OF REPORT ***'       S01117
0614 O*
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
