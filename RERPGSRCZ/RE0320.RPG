     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Held items report')                           *
0001 H***********                                                         S01117
0002 F*****************************************************************
0004 F*                                                               *
     F*  Midas - Retail Module
0004 F*                                                               *
0005 F*  RE0320 - HELD ITEMS REPORT                                   *
0006 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*      1990, 1993                                               *
0008 F*                                                               *
      *  Last Amend No. MD030959A          Date 16Jun15               *
      *  Prev Amend No. MD030959           Date 16Jun15               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23967           Date 13May09               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG27390           Date 06Apr10               *
      *                 CAP205             Date 14Jan10               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG3584            Date 28Jul04               *
      *                 BUG2304            Date 30Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01408             Date 06Mar95               *
      *                 S01413             Date 13Apr93               *
0009 F*                 S01117                  28FEB90               *
0009 F*                 E15788                  28NOV88               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD030959A - Project values when requested during I/C.        *
      *  MD030959 - Recompiled due to changed PF/HELDIHC.             *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23967 - Add Local Industry Code Field.                    *
      *  BUG27390 - RE0320P1 has blank Hard Held Item Flag            *
      *  CAP205 - Account Balance Check                               *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG3584 - Increase the size of the file control fields.      *
      *  BUG2304 - Various file layout changes. Recompile.            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  S01408 - Addition of core hook RE0320FFPG                    *
     F*           Addition of core hook RE0320CPLT                    *
     F*           Addition of core hook RE0320OOPG                    *
     F*  S01413 - Retail 3 Incorporation                              *
     F*         - Recompiled due to changes to files SHLDI, CLINT.    *
0010 F*  S01117 - Multibranching                                      *
     F*  E15788 - Page 1 with 'NO DETAILS TO REPORT' missing          *
0010 F*                                                               *
0011 F*****************************************************************
0010 F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
0010 F*                                                               *
0011 F*****************************************************************
0030 F***SHLDI** IP  F      80  1AI     1 DISK                                                CGL029
     F***SHLDI** IP  F      90  1AI     1 DISK                                        CGL029 BUG3584
     F***SHLDI** IP  F     102  1AI     1 DISK                                        BUG3584 CAP205
     FSHLDI   IP  F     103  1AI     1 DISK                                                   CAP205
0031 FTABLE   IF  F      96 12AI     2 DISK
0032 FTABLED  IF  F      96 12AI     2 DISK
0033 F***CLINT** IF  F     256  7AI     2 DISK                                              BUG23967
     FCLINT   IF  F     264  7AI     2 DISK                                                 BUG23967
     FRE0320AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0034 F*E0320P1O** F     132     OF     PRINTER                      S01124S01117
0017 FRE0320P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,RE0320FFPG                                           S01408
     F*                                                                   S01408
0012 F* ID F  C  H  L    FUNCTION OF INDICATORS
0013 F* 01            SHLDI FILE HEADER
0014 F* 02            SHLDI HELD ITEM DETAIL
0015 F* 03            SHLDI FILE TRAILER
0016 F* 04            TABLE FILE - INSTALLATION CONTROL DATA RECORD 1
0017 F* 05            TABLE FILE - CURRENCIES RECORD 1
0018 F* 06            CLIENT FILE - CUSTOMER DETAIL RECORD A
0019 F* 07            ALL FILES CATCHALL
0020 F*    20         RETAIL ACCOUNT NUMBER -ACNO- BLANK.
0021 F*       40      BYPASS FIRST CYCLE ONLY CALCS.
0022 F*       41      CHANGE TYPE 'I' - INSERTION.
0022 F*       47      CHANGE TYPE 'A' - AMENDMENT.
0023 F*       42      CHANGE TYPE 'D' - DELETION.
0024 F*       43      HASH TOTALS OUT OF BALANCE
0025 F*       44      NUMBER OF RECORDS OUT OF BALANCE
0026 F*       45      CHAIN FAIL ON CLINT FILE
     F*       46      AT LEAST ONE DETAIL PRESENT IN SHLDI.               E15788
     F*       49      NO DETAILS TO REPORT FROM SHLDI.                    E15788
0027 F*     50-53     CURRENCY HAS 0-3 DECIMAL POSITIONS RESPECTIVELY.
     F*       60      OUTPUT INDICATOR                                    S01117
     F*       61      Output Indicator for Hard Held                                          CAP205
     F*       88      MBIN = Y                                            S01117
0028 F*          U1   REPORT PRODUCED DURING INPUT CYCLE
     F*          U7   DATABASE ERROR DUE TO FAILED CHAIN
0029 F*          U8   SHLDI FILE OUT OF BALANCE.
0035 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0036 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0037 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    CPY@    1   1 80
0038 E**
0039 E                    CCYA      150  3
0040 E                    DPA       150  1 0
0041 I**
0042 I**   SORTED HELD ITEMS FILE HEADER.
0043 ISHLDI   NS  01   1 CH
0044 I                                        1   1 RECI
0045 I                                        2  19 KEY
0046 I                                    P  20  230FLSZ
0047 I**
0048 I**   HELD ITEM - DETAIL RECORD.
0049 I        NS  02   1 CD
0050 I       OR        1 C*  74 CD
0051 I                                        1   1 RECI
0052 I**********                              2   70CNUMHI                                    CGL029
0053 I**********                              8  10 CCY                                       CGL029
0054 I**********                             11  140ACOD                                      CGL029
0055 I**********                             15  160ACSQ                                      CGL029
0056 I**********                              2  16 LEVEL L1                                  CGL029
0052 I**********                              2   70CNUMHIL1                           CGL029 CSD027
0052 I                                        2   7 CNUMHIL1                                  CSD027
0053 I                                        8  10 CCY   L1                                  CGL029
     I                                       11  140ACODQQ                                    CGL029
0055 I                                       15  160ACSQ  L1                                  CGL029
0057 I                                       17  190HIRF
0058 I                                       20  290ACNO            20
0059 I                                    P  30  320DATI
0060 I                                    P  33  350HEXP
0061 I                                    P  36  420HLDA
0062 I                                       43  62 HLDN
0063 I***********                            63  650BRCD  L2              S01117
0063 I                                       63  65 BRCA  L2              S01117
0064 I                                       74  74 CHTP
0065 I                                    P  75  770LCD
0066 I                                    P  78  800TNLU
     I                                       81  900ACOD  L1                                  CGL029
     I                                       91  91 HHIT                                      CAP205
0067 I**
0068 I**   HELD ITEM - FILE TRAILER.
0069 I        NS  03   1 CT
0070 I                                        1   1 RECI
0071 I                                        2  19 KEY
0072 I**********                          P  20  210NORE                                     BUG3584
0073 I**********                          P  24  250NOHI                                     BUG3584
0074 I**********                          P  26  330VWHI                                     BUG3584
0075 I**********                          P  34  350VDHI                                     BUG3584
0076 I**********                          P  36  370NHII                                     BUG3584
0077 I**********                          P  38  390NHID                                     BUG3584
0078 I**********                          P  40  470VIHW                                     BUG3584
0079 I**********                          P  48  490VIHD                                     BUG3584
0080 I**********                          P  50  570VDHW                                     BUG3584
0081 I**********                          P  58  590VDHD                                     BUG3584
0082 I**********                          P  60  610NHAU                                     BUG3584
0083 I**********                          P  62  690VHAW                                     BUG3584
0084 I**********                          P  70  710VHAD                                     BUG3584
0085 I**********                          P  72  740LCD                                      BUG3584
0086 I**********                          P  75  770TNLU                                     BUG3584
     I                                    P  20  230NORE                                     BUG3584
     I                                    P  28  310NOHI                                     BUG3584
     I                                    P  32  390VWHI                                     BUG3584
     I                                    P  40  410VDHI                                     BUG3584
     I                                    P  42  450NHII                                     BUG3584
     I                                    P  46  490NHID                                     BUG3584
     I                                    P  50  570VIHW                                     BUG3584
     I                                    P  58  590VIHD                                     BUG3584
     I                                    P  60  670VDHW                                     BUG3584
     I                                    P  68  690VDHD                                     BUG3584
     I                                    P  70  730NHAU                                     BUG3584
     I                                    P  74  810VHAW                                     BUG3584
     I                                    P  82  830VHAD                                     BUG3584
     I                                    P  84  860LCD                                      BUG3584
     I                                    P  87  890TNLU                                     BUG3584
0087 I**
0088 I**   CATCHALL
0089 I        NS  07
0090 I**
0091 I*    TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.
0092 I*
0093 ITABLE   NS  04   2 C0   3 C1  12 C1
0094 I       AND      13 C0
0095 I                                        1   1 RECI
0096 I                                        2   30RECT
0097 I                                       12  130RCDE
0098 I                                       14  66 TITL
0099 I                                       67  67 DATF
0100 I***********                            68  700DFBR                  S01117
     I                                       68  70 DFBM                  S01117
0101 I                                       74  74 MODI1
0102 I                                       75  75 MODI2
0103 I                                       76  76 MODI3
0104 I***********                         P  77  790RUND                  S01117
0105 I***********                            80  86 RUNA                  S01117
0106 I                                       87  870SFLG
0107 I                                    P  90  920LCD
0108 I***********                            93  93 CHTP                  S01117
0109 I                                    P  94  960TNLU
0111 I**
0112 I**   CATCHALL
0113 I        NS  07
0114 I*
0115 I*    CLIENT FILE - CUSTOMER STANDING DATA RECORD.
0116 I*
0117 ICLINT   NS  06   1 CD   8 CA
0118 I                                        1   1 RECI
0119 I**********                              2   70CNUMCT                                    CSD027
0119 I                                        2   7 CNUMCT                                    CSD027
0120 I                                        8   8 RCDT
0121 I                                        9  28 CRNM
0122 I                                       29  38 CTWN
0123 I                                       39  48 CSNM
0124 I                                       49  56 CASK
0125 I                                       57  68 TELX
0126 I                                       69  80 CSID
0127 I                                       81  82 ACOC
0128 I                                       83  83 CBSI
0129 I                                       84  85 CCTZ
0130 I                                       86  87 CLOC
0131 I**********                             88  930CPAR                                      CSD027
0131 I                                       88  93 CPAR                                      CSD027
0132 I                                       97  98 LINS
0133 I                                       99 101 LIND
0134 I                                    P 102 1040DASU
0135 I                                    P 105 1070CDIC
0136 I                                    P 108 1100DADE
0137 I                                      111 111 CMIN
0138 I                                      112 112 CTYP
0139 I                                      113 124 TELF
0140 I                                    P 250 2520LCDC
0141 I                                      253 253 CHTPC
0142 I                                    P 254 2560TNLUC
     I                                      262 264 LOIC                                    BUG23967
0143 I*
0144 I**
0145 I**   CATCHALL
0146 I        NS  07
0147 I*
0148 I**   TABLE FILE - CURRENCIES RECORD 1.
0149 I**
0150 ITABLED  NS  05   2 C2   3 C0
0151 I                                        1   1 RECIX
0152 I                                        2   30RECTX
0153 I                                       10  12 CCYX
0154 I                                       13  130SRECX
0155 I                                       38  380CDPX
0156 I**
0157 I        NS
0158 I                                        2   30RECTX
     I*    STANDARD LOCAL DATA AREA FIELDS
     I*
     I***********UDS                                                      S01117
     ILDA        UDS                            256                       S01117
     I***********                           134 138 LFILE                 S01117
     I***********                           139 167 LKEY                  S01117
     I***********                           168 175 LPROG                 S01117
     I***********                           176 1770LDBNO                 S01117
     I                                      134 141 LFILE                 S01117
     I                                      142 170 LKEY                  S01117
     I                                      171 180 LPROG                 S01117
     I                                      181 1830LDBNO                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I/EJECT                                                              S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - P1                           S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - AU                           S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
      *                                                                                    MD030959A
     IMPHAS       DS                                                                       MD030959A
     I                                        1   1 W@PHAS                                 MD030959A
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**                                                                  S01117
     I              A8BRNM                          BRNM                  S01117
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01117
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01117
     I*                                                                   S01117
0122 I*                                                                   S01117
     C                     MOVEACPY@      BIS@   80
     C/EJECT                                                              S01117
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
     C**                                                                  S01117
     C/SPACE 3                                                            S01117
0159 C**
0160 C**   BYPASS 1ST CYCLE CALCS.
0161 C   40                GOTO DETAIL
     C**                                                                  S01117
     C**         IN THE DATAAREA RUNDAT                                   S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C                     IN   LDA                                       S01117
     C           *NAMVAR   DEFN           MPHAS                                            MD030959A
     C                     IN   MPHAS                                                      MD030959A
     C**                                                                  S01117
     C**         SETON MULTIBRANCH INDICATOR IF MBIN = Y                  S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
0162 C                     SETON                         40
     C***********          MOVEL'RE0320'  LPROG                           S01117
     C                     MOVE *BLANKS   DBPGM                           S01117
     C                     MOVE *BLANKS   DBFILE                          S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVEL'RE0320  'DBPGM                           S01117
0163 C**
0164 C**   ON FIRST CYCLE ONLY.
0165 C                     EXSR ZSYSTM
     C   99                SETON                     U7LR  ** DB ERROR 01
     C   99                MOVE *BLANKS   LFILE                           S01117
     C   99                MOVE 'TABLE'   LFILE
     C   99                MOVE ' '       LKEY
     C   99                MOVELZTABKY    LKEY
     C   99                Z-ADD01        LDBNO
0167 C   99                GOTO END
0168 C                     EXSR CCYARR
      *                                                                                    MD030959A
     C                     Z-ADD0         WTOTI   70                                       MD030959A
     C                     Z-ADD0         WTOTD   70                                       MD030959A
     C                     Z-ADD0         WHLDI  150                                       MD030959A
     C                     Z-ADD0         WHLDD  150                                       MD030959A
     C                     MOVE '0'       *IN08   1                                        MD030959A
     C                     MOVE '0'       *IN09   1                                        MD030959A
     C           W@PHAS    IFEQ 'A'                                                        MD030959A
     C           W@PHAS    OREQ 'G'                                                        MD030959A
     C                     MOVE '1'       *IN08                                            MD030959A
     C           BRNCH     IFNE 'ALL'                                                      MD030959A
     C                     MOVE '1'       *IN09                                            MD030959A
     C                     ENDIF                                                           MD030959A
     C                     ENDIF                                                           MD030959A
0169 C**
0170 C**   GET TIME IF INTERIM REPORT
0171 C   U1                TIME           MTIME   60
0172 C**
0173 C**   SET UP KEY FIELD FOR CLINT FILE.
0174 C                     MOVE 'A'       CLKEY   7
0175 C**
0176 C**   INPUT CYCLE PROCESSING.
     C**                                                                  S01117
0177 C           DETAIL    TAG                             **  DETAIL  ***
     C***02******          SETON                     46             E15788S01117
     C**N01N46***          SETON                     49             E15788S01117
     C           HHIT      IFEQ *BLANKS                                                     BUG27390
     C                     MOVEL'N'       HHIT                                              BUG27390
     C                     ENDIF                                                            BUG27390
0178 C  N02                GOTO END
0179 C                     SETON                     30
     C**                                                                  S01117
     C*    DETERMINE IF THE BRANCH ON THE SHLDI       DETAIL RECORD       S01117
     C*    IS VALID FOR OUTPUT. (NB *IN65 SET ON FOR A VALID BRANCH)      S01117
     C**                                                                  S01117
     C           *INL2     IFEQ '1'                                       S01117
     C**                                                                  S01117
     C                     EXSR CHKBR                                     S01117
     C**                                                                  S01117
     C*    ZEROISE NO. OF HELD ITEMS BY BRANCH TOTAL                      S01117
     C**                                                                  S01117
     C                     Z-ADD0         BRITM                           S01117
     C**                                                                  S01117
     C                     END                                            S01117
     C**                                                                  S01117
0180 C**
0181 C**   COUNT NUMBER OF HELD ITEMS PER BRANCH.
0182 C********** BRITM     ADD  1         BRITM   30                                         BUG3584
     C           BRITM     ADD  1         BRITM   70                                         BUG3584
0183 C**
0184 C**   COUNT INSERTIONS
0185 C           HLDA      DIV  1000      ZZAMT
0186 C           CHTP      COMP 'I'                      41
0187 C***41***** INSRTS    ADD  1         INSRTS  30                                         BUG3584
     C   41      INSRTS    ADD  1         INSRTS  70                                         BUG3584
0188 C   41                EXSR GLZADD
     C           *IN41     IFEQ '1'                                                        MD030959A
     C           DATI      ANDEQRUND                                                       MD030959A
     C           *IN08     ANDEQ'1'                                                        MD030959A
     C           BRNCH     IFEQ 'ALL'                                                      MD030959A
     C           BRNCH     OREQ BRCA                                                       MD030959A
     C                     ADD  HLDA      WHLDI                                            MD030959A
     C                     ADD  1         WTOTI                                            MD030959A
     C                     ENDIF                                                           MD030959A
     C                     ENDIF                                                           MD030959A
0183 C**
0184 C**   COUNT AMENDMENTS
0186 C           CHTP      COMP 'A'                      47
0188 C   47                EXSR GLZADD
     C           *IN47     IFEQ '1'                                                        MD030959A
     C           DATI      ANDEQRUND                                                       MD030959A
     C           *IN08     ANDEQ'1'                                                        MD030959A
     C           BRNCH     IFEQ 'ALL'                                                      MD030959A
     C           BRNCH     OREQ BRCA                                                       MD030959A
     C                     ADD  HLDA      WHLDI                                            MD030959A
     C                     ADD  1         WTOTI                                            MD030959A
     C                     ENDIF                                                           MD030959A
     C                     ENDIF                                                           MD030959A
0189 C**
0190 C**   COUNT DELETIONS
0191 C           CHTP      COMP 'D'                      42
0192 C***42***** DELETS    ADD  1         DELETS  30                                         BUG3584
     C   42      DELETS    ADD  1         DELETS  70                                         BUG3584
     C           *IN42     IFEQ '1'                                                        MD030959A
     C           LCD       ANDEQRUND                                                       MD030959A
     C           *IN08     ANDEQ'1'                                                        MD030959A
      *                                                                                    MD030959A
     C           BRNCH     IFEQ 'ALL'                                                      MD030959A
     C           BRNCH     OREQ BRCA                                                       MD030959A
     C                     ADD  HLDA      WHLDD                                            MD030959A
     C                     ADD  1         WTOTD                                            MD030959A
     C           DATI      IFEQ RUND                                                       MD030959A
     C                     ADD  1         WTOTI                                            MD030959A
     C                     ADD  HLDA      WHLDI                                            MD030959A
     C                     ENDIF                                                           MD030959A
     C                     ENDIF                                                           MD030959A
     C                     ENDIF                                                           MD030959A
0193 C**
0194 C**   CHAIN TO CLINT FOR CUSTOMER REPORT NAME.
0195 C                     MOVELCNUMHI    CLKEY
0196 C           CLKEY     CHAINCLINT                45
     C  N45      RECI      COMP 'D'                  4545
     C   45                SETON                     U7LR  ** DB ERROR 02
     C   45                MOVE 'CLINT'   LFILE
     C   45                MOVELCLKEY     LKEY
     C   45                Z-ADD02        LDBNO
     C   45                GOTO END
0197 C**
0198 C**   FIND NBR DECIMAL POSITIONS FOR EDITING CURRENCY AMOUNTS.
0199 C                     MOVE CCY       XCCY
0200 C                     EXSR CCYDEP
0201 C           XDECP     COMP 1                      5051
0202 C           XDECP     COMP 2                    53  52
0203 C**
0204 C**   CONVERT DATES TO ALPHA FORMAT FOR PRINTING.
0205 C                     Z-ADDHEXP      ZDAYNO           -EXPIRY DATE
0206 C                     EXSR ZDATE2
0207 C                     MOVE ZADATE    EXPIRY  7
0208 C**
0209 C                     Z-ADDDATI      ZDAYNO           -INPUT DATE
0210 C                     EXSR ZDATE2
0211 C                     MOVE ZADATE    INPUTD  7
0212 C**
0213 C                     Z-ADDLCD       ZDAYNO           -LAST CHANGE D.
0214 C                     EXSR ZDATE2
0215 C                     MOVE ZADATE    CHANGE  7
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0320CPLT                                           S01408
     C*                                                                   S01408
0216 C**
0217 C           END       TAG                               ** END TAG **
0218 C**
0219 C**   AT CHANGE OF BRANCH PRINT BRANCH TOTAL, ADD TO FILE TOTAL,
0220 C**   & ZEROISE AFTER.
0221 CL2         BRITM     SUB  DELETS    BRITM
0222 CL2                   Z-ADD0         DELETS
0223 CL2                   Z-ADD0         INSRTS
0224 C***L2*****    BRITM     ADD  TOTITM    TOTITM  30                                      BUG3584
     CL2         BRITM     ADD  TOTITM    TOTITM  70                                         BUG3584
0225 C**
0226 C**   AT LR COMPARE FILE CONTROL TOTALS.
0227 CLRN30                SETON                     OF
0228 CLRN30                SETOF                     L1L2
     CLR         MBIN      IFEQ 'N'                                       S01117
     CLR         MBIN      OREQ 'Y'                                       S01117
     CLR         BRNCH     ANDEQ'ALL'                                     S01117
     CLR         W@PHAS    IFEQ 'A'                                                        MD030959A
     CLR         W@PHAS    OREQ 'G'                                                        MD030959A
      *                                                                                    MD030959A
      **Number of records after INSERT                                                     MD030959A
      *                                                                                    MD030959A
     CLR         NHAU      ADD  WTOTI     ICNHAU  70                                       MD030959A
     CLR         ICNHAU    SUB  WTOTD     ICNHAU                                           MD030959A
      *                                                                                    MD030959A
      **Value of records after INSERT                                                      MD030959A
      *                                                                                    MD030959A
     CLR                   Z-ADDZZTOTI    OZTOTI 150                                       MD030959A
     CLR                   Z-ADDZZTOTD    OZTOTD  30                                       MD030959A
     CLR                   Z-ADDZZTOTI    ICVHAW 150                                       MD030959A
     CLR                   Z-ADDZZTOTD    ICVHAD  30                                       MD030959A
      *                                                                                    MD030959A
      **Value of records INSERTED                                                          MD030959A
      *                                                                                    MD030959A
     CLR                   Z-ADDWTOTI     ICNHII  70                                       MD030959A
     CLR                   Z-ADDVIHW      ZZTOTI                                           MD030959A
     CLR                   Z-ADDVIHD      ZZTOTD                                           MD030959A
     CLR         WHLDI     DIV  1000      ZZAMT                                            MD030959A
     CLR                   EXSR GLZADD                                                     MD030959A
     CLR                   Z-ADDZZTOTI    ICVIHW 150                                       MD030959A
     CLR                   Z-ADDZZTOTD    ICVIHD  30                                       MD030959A
      *                                                                                    MD030959A
      **Value of records DELETED                                                           MD030959A
      *                                                                                    MD030959A
     CLR                   Z-ADDWTOTD     ICNHID  70                                       MD030959A
     CLR                   Z-ADDVDHW      ZZTOTI                                           MD030959A
     CLR                   Z-ADDVDHD      ZZTOTD                                           MD030959A
     CLR         WHLDD     DIV  1000      ZZAMT                                            MD030959A
     CLR                   EXSR GLZADD                                                     MD030959A
     CLR                   Z-ADDZZTOTI    ICVDHW 150                                       MD030959A
     CLR                   Z-ADDZZTOTD    ICVDHD  30                                       MD030959A
      *                                                                                    MD030959A
      ** Restore value of OZTOTI AND OZTOTD                                                MD030959A
      *                                                                                    MD030959A
     CLR                   Z-ADDOZTOTI    ZZTOTI                                           MD030959A
     CLR                   Z-ADDOZTOTD    ZZTOTD                                           MD030959A
     CLR                   ENDIF                                                           MD030959A
      *                                                                                    MD030959A
      ** MPHAS 'A' OR 'G'                                                                  MD030959A
      *                                                                                    MD030959A
     CLR         W@PHAS    IFEQ 'A'                                                        MD030959A
     CLR         W@PHAS    OREQ 'G'                                                        MD030959A
     CLR         ZZTOTI    COMP ICVHAW               4343                                  MD030959A
     CLRN43      ZZTOTD    COMP ICVHAD               4343  -OUT OF BALANCE                 MD030959A
     CLR         TOTITM    COMP ICNHAU               4444                                  MD030959A
     CLR                   ELSE                                                            MD030959A
0229 CLR         ZZTOTI    COMP VHAW                 4343
0230 CLRN43      ZZTOTD    COMP VHAD                 4343  -OUT OF BALANCE
0231 CLR         TOTITM    COMP NHAU                 4444
     CLR                   ENDIF                                                           MD030959A
0232 CLR 43
0233 COR 44                SETON                         U8
     CLR                   END                                            S01117
     C**                                                                  S01117
     C**         SETON OUTPUT INDICATOR                                   S01117
     C**                                                                  S01117
     CLR         MBIN      IFEQ 'Y'                                       S01117
     CLR         BRNCH     ANDNE'ALL'                                     S01117
     CLR                   SETON                     60                   S01117
     CLR         W@PHAS    IFEQ 'A'                                                        MD030959A
     CLR         W@PHAS    OREQ 'G'                                                        MD030959A
      *                                                                                    MD030959A
      **Value of records INSERTED                                                          MD030959A
      *                                                                                    MD030959A
     CLR                   Z-ADDWTOTI     ICNHII  70                                       MD030959A
     CLR                   Z-ADDVIHW      ZZTOTI                                           MD030959A
     CLR                   Z-ADDVIHD      ZZTOTD                                           MD030959A
     CLR         WHLDI     DIV  1000      ZZAMT                                            MD030959A
     CLR                   EXSR GLZADD                                                     MD030959A
     CLR                   Z-ADDZZTOTI    ICVIHW 150                                       MD030959A
     CLR                   Z-ADDZZTOTD    ICVIHD  30                                       MD030959A
      *                                                                                    MD030959A
      **Value of records DELETED                                                           MD030959A
      *                                                                                    MD030959A
     CLR                   Z-ADDWTOTD     ICNHID  70                                       MD030959A
     CLR                   Z-ADDVDHW      ZZTOTI                                           MD030959A
     CLR                   Z-ADDVDHD      ZZTOTD                                           MD030959A
     CLR         WHLDD     DIV  1000      ZZAMT                                            MD030959A
     CLR                   EXSR GLZADD                                                     MD030959A
     CLR                   Z-ADDZZTOTI    ICVDHW 150                                       MD030959A
     CLR                   Z-ADDZZTOTD    ICVDHD  30                                       MD030959A
     CLR                   ENDIF                                                           MD030959A
     CLR                   END                                            S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     CLR                   OUT  LDA                                       S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     CLR         *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C** WHEN LR INDICATOR SET ON WITHOUT EXECUTING THE FIRST             S01117
     C** CYCLE                                                            S01117
     CLR         P1OP      IFNE 'Y'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
0206 C*                                                                   S01117
0364 C*                                                                   S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
0232 C*                                                                   S01117
0234 C**
     C/SPACE 3                                                            S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C*    S U B R O U T I N E S                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/SPACE 3                                                            S01117
     C*SUBROUTINE- CHKBR                                                  S01117
     C*PURPOSE   - DETERMINES IF BRANCH INPUT ON SHLDI   DETAIL           S01117
     C*            RECORD IS VALID FOR OUTPUT                             S01117
     C*                                                                   S01117
     C*CALLED FROM- MAIN PROGRAM CYCLE                                    S01117
     C*CALLS SUBROUTINES - NONE                                           S01117
     C**                                                                  S01117
     C*                                                                   S01117
     C           CHKBR     BEGSR                           *** CHKBR * ** S01117
     C**                                                                  S01117
     C                     CLOSERE0320P1                                  S01117
     C**                                                                  S01117
     C                     SETOF                     65                   S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDEQ'ALL'                                     S01117
     C           MBIN      OREQ 'Y'                                       S01117
     C           BRNCH     ANDEQBRCA                                      S01117
     C           MBIN      OREQ 'N'                                       S01117
     C           P1OP      ANDNE'Y'                                       S01117
     C**                                                                  S01117
     C*    SET ON *IN65 TO ALLOW O/P TO RE0320P1                          S01117
     C**                                                                  S01117
     C                     SETON                     65                   S01117
     C                     OPEN RE0320P1                                  S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     SETON                     46                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**                                                                  S01117
     C*    ACCESS BRANCH DETAILS                                          S01117
     C*                                                                   S01117
     C**                                                                  S01117
      **                                                                  S01117
      ** GET BRANCH NAME, ONLY WHEN MBIN = 'Y'                            S01117
      **                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
      *                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD12        DBASE            * DBERROR 012 *S01117
     C                     SETON                     U7U8LR***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ELSE                                           S01117
      *                                                                   S01117
      *    END THE PROGRAM IF MBIN = 'Y', BRANCH REQUESTED <> ALL,        S01117
      *    AND THE BRANCH READ ON RECORD > REQUESTED BRANCH               S01117
      *                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRCA      ANDGTBRNCH                                     S01117
     C                     SETON                     LR                   S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
      *    SKIP TO END IF MBIN = 'Y', BRANCH REQUESTED <> ALL,            S01117
      *    AND THE BRANCH READ ON RECORD <> REQUESTED BRANCH              S01117
      *                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRCA      ANDNEBRNCH                                     S01117
     C                     GOTO END                                       S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           ENDBR     ENDSR                                          S01117
     C********************************************************************S01117
     C/SPACE 3                                                            S01117
0235 C********************************************************************
0236 C**
0237 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
0238 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
0239 C**
0240 C           CCYARR    BEGSR                           *** CCYARR  ***
0241 C**
0242 C**   SET ARRAY INDEX TO ZERO.
0243 C                     Z-ADD0         X       30
0244 C**
0245 C**   SET UP KEY FOR CURRENCY TABLE.
0246 C                     MOVEL'20      'XCYKEY 12
0247 C                     MOVE '    '    XCYKEY
0248 C**
0249 C**   SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.
0250 C           XCYKEY    SETLLTABLED
0251 C**
0252 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0253 C           XLOOP     TAG                             ** XLOOP TAG **
0254 C                     READ TABLED                   99
0255 C  N99      RECTX     COMP 20                   9999
0256 C**
0257 C**   END IF ALL CURRENCY RECORDS PROCESSED
0258 C   99                GOTO XEND
0259 C**
0260 C**   IGNORE DELETED RECORDS AND NON-SUB-RECORD ONE.
0261 C           RECIX     COMP 'D'                  9797
0262 C   97                GOTO XLOOP
0263 C           SRECX     COMP 1                    9797
0264 C   97                GOTO XLOOP
0265 C**
0266 C**   INCREMENT ARRAY INDEX.
0267 C           X         ADD  1         X
0268 C**
0269 C**   MOVE DATA INTO ARRAYS.
0270 C                     MOVE CCYX      CCYA,X
0271 C                     MOVE CDPX      DPA,X
0272 C**
0273 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0274 C           X         COMP 150                      96
0275 C**
0276 C**   GO TO READ NEXT RECORD.
0277 C  N96                GOTO XLOOP
0278 C**
0279 C           XEND      TAG                             ** XEND TAG  **
0280 C                     ENDSR
0281 C**
0282 C********************************************************************
0283 C**
0284 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
0285 C**
0286 C           CCYDEP    BEGSR                           *** CCYDEP  ***
0287 C**
0288 C**   SET ARRAY INDEX TO ONE AND RESET ERROR INDICATOR.
0289 C                     Z-ADD1         X            99
0290 C**
0291 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0292 C                     Z-ADD0         XDECP   10
0293 C                     MOVE XCCY      XCCY    3
0294 C**
0295 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0296 C**   99 SETON FOR INVALID CURRENCY.
0297 C           XCCY      LOKUPCCYA,X                   95
0298 C   95                MOVE DPA,X     XDECP
0299 C  N95                SETON                     99
0300 C**
0301 C                     ENDSR
0302 C**
0303 C********************************************************************
0304 C**
0305 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0306 C**
0307 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0308 C**
0309 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
0310 C                     MOVEL'01      'ZTABKY 12
0311 C                     MOVE '  10'    ZTABKY
0312 C**
0313 C           ZTABKY    CHAINTABLE                99    ON NOT THERE
0314 C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
0315 C**
0316 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0317 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
0318 C**
0319 C                     ENDSR
0320 C**
0321 C**
0322 C********************************************************************
0323 C**
0324 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0325 C**
0326 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0327 C**
0328 C**   CLEAR DATE FIELDS.
0329 C                     Z-ADD0         ZDATE   60
0330 C                     MOVEL'       ' ZADATE  7
0331 C**
0332 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0333 C                     Z-ADDZDAYNO    ZDAYNO  50
0334 C**
0335 C**   DETERMINE YEAR NUMBER.
0336 C**
0337 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0338 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0339 C   99                GOTO ZDEND2
0340 C**
0341 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0342 C           ZDAYN1    DIV  1461      ZLYR    20
0343 C                     MVR            ZDAYN1           SAVE REMAINING
0344 C**                                                   DAYS
0345 C**   CALCULATE NUMBER OF REMAINING YEARS.
0346 C                     Z-ADD1         ZWRK2   20
0347 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0348 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0349 C  N90      ZWRK2     ADD  1         ZWRK2
0350 C  N90                GOTO ZDTAG1
0351 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0352 C**
0353 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0354 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0355 C**
0356 C**   CALCULATE ACTUAL YEAR NUMBER.
0357 C           ZLYR      MULT 4         ZWRK3   30
0358 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0359 C                     Z-ADDZWRK3     ZYEAR   20
0360 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0361 C**
0362 C**   DETERMINE MONTH NUMBER.
0363 C**
0364 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0365 C                     SETOF                     9293
0366 C   91      ZDAYN1    COMP 59                     9293
0367 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0368 C**
0369 C**   CALCULATE MONTH NUMBER.
0370 C                     Z-ADD2         ZWRK2
0371 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0372 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0373 C  N94      ZWRK2     ADD  1         ZWRK2
0374 C  N94                GOTO ZDTAG2
0375 C           ZWRK2     SUB  1         ZWRK2
0376 C**
0377 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0378 C**
0379 C**   DETERMINE DAY OF MONTH.
0380 C**
0381 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0382 C           ZDAYN1    ADD  1         ZDAYN1
0383 C**
0384 C**   CALCULATE DAY OF MONTH.
0385 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0386 C**
0387 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0388 C   93      ZDAY      ADD  1         ZDAY
0389 C**
0390 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0391 C  N98                MOVELZDAY      ZWRK4   40
0392 C   98                MOVE ZDAY      ZWRK4
0393 C  N98                MOVE ZMTH      ZWRK4
0394 C   98                MOVELZMTH      ZWRK4
0395 C                     MOVELZWRK4     ZDATE
0396 C                     MOVE ZYEAR     ZDATE
0397 C**
0398 C**   FORMAT ALPHA DATE, DDMMMYY.
0399 C           ZDAY      COMP 10                     95
0400 C                     MOVELZDAY      ZWRK5   5
0401 C   95                MOVEL' '       ZWRK5
0402 C                     MOVE ZMNM,ZMTH ZWRK5
0403 C                     MOVELZWRK5     ZADATE
0404 C                     MOVE ZYEAR     ZADATE
0405 C**
0406 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0407 C**
0408 C********************************************************************
0409 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0410 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0411 C*
0412 CSR         GLZADD    BEGSR                           *** GLZADD ****
0413 C*
0414 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0415 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0416 C*
0417 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0418 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0419 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0420 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0421 C*
0422 CSR                   EXSR GLZSUM
0423 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0424 C*
0425 C********************************************************************
0426 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0427 C*                        GLZADD, GLZSUB, GLZCMP.
0428 C*          PARAMETERS PASSED -
0429 C*                     I/P ZZAMTI ZZAMTD
0430 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0431 C*
0432 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0433 C*
0434 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0435 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0436 CSR                   SETOF                     919293
0437 CSR                   SETOF                     949599
0438 C*
0439 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0440 CSR         ZZAMTI    COMP 0                      9293
0441 CSR 93      ZZAMTD    COMP 0                      9293
0442 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0443 C*
0444 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0445 CSR         ZZTOTI    COMP 0                      9193
0446 CSR 93      ZZTOTD    COMP 0                      9193
0447 C*
0448 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0449 CSR 93                Z-ADDZZAMTI    ZZTOTI
0450 CSR 93                Z-ADDZZAMTD    ZZTOTD
0451 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0452 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0453 CSR 91N92
0454 CORN91 92             GOTO ZZOFPS
0455 C*
0456 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0457 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0458 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0459 C*
0460 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0461 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0462 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0463 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0464 C*
0465 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0466 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0467 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0468 CSRN99                Z-ADDZZWK2     ZZTOTD
0469 CSRN99                Z-ADDZZWK3     ZZTOTI
0470 C*
0471 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0472 CSR 99                Z-ADD0         ZZAMT  153
0473 CSR                   GOTO ZZSEND
0474 C*
0475 C* THE 'SIGNS' ARE DIFFERENT
0476 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0477 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0478 C*
0479 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0480 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0481 C*
0482 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0483 C*
0484 CSR 91                Z-SUBZZTOTI    ZZTOTI
0485 CSR 91                Z-SUBZZTOTD    ZZTOTD
0486 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0487 C*
0488 CSR         ZZTOTI    COMP ZZAMTI               93  95
0489 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0490 C*
0491 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0492 CSR 95                Z-ADD0         ZZTOTI
0493 CSR 95                Z-ADD0         ZZTOTD
0494 CSR 95                GOTO ZZSEND
0495 C*
0496 C* IF ZZTOT GT. ZZAMT.
0497 CSR 93      ZZAMTD    COMP ZZTOTD               94
0498 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0499 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0500 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0501 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0502 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0503 C*
0504 C*
0505 C* IF ZZAMT GT. ZZTOT.
0506 CSRN93      ZZTOTD    COMP ZZAMTD               94
0507 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0508 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0509 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0510 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0511 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0512 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0513 C*
0514 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0515 CSR                   SETOF                     94
0516 CSR 93 91
0517 CORN93 92             SETON                     94
0518 CSR 94                Z-SUBZZTOTI    ZZTOTI
0519 CSR 94                Z-SUBZZTOTD    ZZTOTD
0520 C**
0521 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0522 CSR 92                Z-SUBZZAMTI    ZZAMTI
0523 CSR 92                Z-SUBZZAMTD    ZZAMTD
0524 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0525 C**
0526 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0527 CSR                   SETOF                     96
0528 CSR         ZZTOTD    COMP 0                        91
0529 CSR 91      ZZTOTI    COMP 0                      96
0530 CSR 96                MOVE '.000-'   ZZNEGD  5
0531 CSR                   ENDSR                             ** ENDSR **
     C********************************************************************S01117
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
      *                                                                   S01117
      ** OPEN P1 SPOOL FILE                                               S01117
     C                     OPEN RE0320P1                                  S01117
      *                                                                   S01117
      ** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY          S01117
     C           BRNCH     IFEQ 'ALL'                      B1             S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     MOVE 'ALL'     BRCA                            S01117
     C                     MOVE *BLANKS   BRNM                            S01117
      *                                                                   S01117
      ** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED       S01117
     C                     ELSE                            X1             S01117
      *                                                                   S01117
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     MOVE BRNCH     BRCA                            S01117
      *                                                                   S01117
      ** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN MULTIBRANCHING   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
      *                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD11        DBASE            * DBERROR 011 *S01117
     C                     SETON                     U7U8  ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                             E1             S01117
      *                                                                   S01117
      ** OUTPUT 'NO DETAILS TO REPORT' IN P1                              S01117
     C**                                                                  S01117
     C           #ZZ9      TAG                                            S01117
     C                     EXCPTNODTL                                     S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
      *****************************************************************                       CAP205
      /SPACE 5                                                                                CAP205
      *****************************************************************                       CAP205
      *                                                               *                       CAP205
      * INITIAL PROCESSING                                            *                       CAP205
      *                                                               *                       CAP205
      *****************************************************************                       CAP205
     C           *INZSR    BEGSR                                                              CAP205
      *                                                                                       CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM *BLANKS   PRTCD   7                                           CAP205
     C                     PARM '*VERIFY' POPTN   7                                           CAP205
     C                     PARM 'CAP205'  PSARD   6                                           CAP205
     C                     PARM           DSFDY                                               CAP205
      *                                                                                       CAP205
     C           PRTCD     IFEQ *BLANKS                                                       CAP205
     C                     MOVE '1'       *IN61                                               CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
     C                     ENDSR                                                              CAP205
      *                                                                   S01117
     C**                                                                  S01117
0497 C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
0532 C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
0533 O*E0320P1H** 03   OF                                           S01124S01117
0534 O*******OR**      L2                                                 S01117
0533 ORE0320P1H   03   OFNL2 65                                           S01117
0534 O       OR        L2 65                                              S01117
     O*******OR**      49                                           E15788S01117
0535 O***********                        20 'REFERENCE RE0320'            S01117
0535 O                                   22 'REFERENCE RE0320P1'          S01117
0536 O                         TITL      94
0537 O                                  122 'DATE              PAGE'
0538 O                         RUNA     113
0539 O                         PAGE  Z  127
0540 O********H*2      OF                                                 S01117
0541 O*******OR**      L2                                                 S01117
0540 O        H 2      OFNL2 65                                           S01117
0541 O       OR        L2 65                                              S01117
     O*******OR**      49                                           E15788S01117
0542 O                       U1          54 'INTERIM'
0543 O                                   73 'HELD ITEMS REPORT'
0544 O                       U1MTIME     83 '  .  .  '
     O                 88                93 'BRANCH'                      S01117
     O                 88      BRCA      97                               S01117
     O                 88                98 '-'                           S01117
     O                 88      BRNM     128                               S01117
0545 O***********            L1         106 'BRANCH'                      S01117
0546 O***********            L1BRCD     110                               S01117
0547 O********H*1      OF                                                 S01117
0548 O*******OR**      L2                                                 S01117
0547 O        H 1      OFNL2 65                                           S01117
0548 O       OR        L2 65                                              S01117
     O*******OR**      49                                           E15788S01117
0549 O                       U1          54 '*******'
0550 O                                   73 '-----------------'
0551 O                       U1          83 '********'
0552 O********H*2      OF                                                 S01117
0553 O*******OR*       L2                                                 S01117
0552 O        H 2      OFNL2 65                                           S01117
0553 O       OR        L2 65                                              S01117
0554 O**********                         27 'ACCOUNT NO       CUSTOME'                        CGL029
0555 O**********                         51 'R NAME         EXPIRY   '                        CGL029
0556 O**********                         75 'INPUT    CCY   REF      '                        CGL029
     O                                   27 'ACCOUNT NO            CU'                        CGL029
     O                                   51 'STOMER NAME        EXPIR'                        CGL029
     O                                   75 'Y  INPUT   CCY REF      '                        CGL029
0557 O                                   99 '   AMOUNT    NARRATIVE  '
0558 O                                  123 '             LAST     AC'
0559 O                                  127 'TION'
     O                 61               132 'HARD'                                            CAP205
0560 O********H*11     OF                                                 S01117
0561 O*******OR**      L2                                                 S01117
0560 O        H 11     OFNL2 65                                           S01117
0561 O       OR        L2 65                                              S01117
0562 O**********                         55 'DATE     DATE'                                   CGL029
     O                                   58 'DATE    DATE'                                    CGL029
0563 O                                   68 'NO'
0564 O                                  118 'CHANGE'
0564 O                 61               132 'HELD'                                            CAP205
0565 O********D*2      02 L1                                              S01117
0565 O        D 2      02 L1 65                                           S01117
0566 O                      N20ACNO      13
0567 O**********             20          16 '-   -    -'                                      CGL029
     O                       20          22 '-   -          -'                                CGL029
0568 O                       20CNUMHI     6
0569 O                       20CCY       10
0570 O**********             20ACOD      15                                                   CGL029
0571 O**********             20ACSQ      18                                                   CGL029
     O                       20ACOD      21                                                   CGL029
     O                       20ACSQ      24                                                   CGL029
0572 O********D**      02                                                 S01117
0572 O        D        02 65                                              S01117
0573 O**********               CRNM      40                                                   CGL029
0574 O**********               EXPIRY    49                                                   CGL029
0575 O**********               INPUTD    58                                                   CGL029
0576 O**********               CCY       63                                                   CGL029
     O                         CRNM      45                                                   CGL029
     O                         EXPIRY    53                                                   CGL029
     O                         INPUTD    61                                                   CGL029
     O                         CCY       65                                                   CGL029
0577 O                         HIRF      69
0578 O                       50HLDA      86 ' ,   ,   ,   , 0 '
0579 O                       51HLDA      86 '   ,   ,   , 0 . '
0580 O                       52HLDA      86 '  ,   ,   , 0 .  '
0581 O                       53HLDA      86 ' ,   ,   , 0 .   '
0582 O                         HLDN     108
0583 O                         CHANGE   119
0584 O                       41         127 'INSERT'
0584 O                       47         126 'AMEND'
0585 O                       42         127 'DELETE'
     O                       61HHIT     131                                                   CAP205
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0320OOPG                                           S01408
     O*                                                                   S01408
     O********D** 20   49                                           E15788S01117
     O***********                        74 '*** NO DETAILS TO REPO E15788S01117
     O***********                        78 ' ***'                  E15788S01117
0586 O********T*32     L2                                                 S01117
0586 O        T 32     L2 65                                              S01117
0587 O***********                        61 'BRANCH TOTALS-'              S01117
0587 O                 88                61 'BRANCH TOTALS-'              S01117
0588 O********T*       L2                                                 S01117
0588 O        T        L2 65 88                                           S01117
0589 O                                   63 'NUMBER OF ACTIVE'
0590 O                                   74 'HELD ITEMS'
0591 O                         BRITM 3B  80
     O        T 32     U7 U8 LR                                           S01117
     O       AND       65                                                 S01117
     O                                   75 '*** DATABASE ERROR ***'      S01117
     O*                                                                   S01117
     O        T 3      L2 65                                              S01117
     O                 88                65 '*** END OF REPORT FOR'       S01117
     O                 88                73 ' BRANCH '                    S01117
     O                 88      BRCA      76                               S01117
     O                 88                80 ' ***'                        S01117
     O                N88                72 '*** END OF REPORT ***'       S01117
0533 O        E   03           NODTL                                      S01117
0535 O                                   22 'REFERENCE RE0320P1'          S01117
0536 O                         TITL      94                               S01117
0537 O                                  122 'DATE              PAGE'      S01117
0538 O                         RUNA     113                               S01117
0539 O                         PAGE  Z  127                               S01117
0540 O        E 2              NODTL                                      S01117
0542 O                       U1          54 'INTERIM'                     S01117
0543 O                                   73 'HELD ITEMS REPORT'           S01117
0544 O                       U1MTIME     83 '  .  .  '                    S01117
     O                 88                93 'BRANCH'                      S01117
     O                 88      BRCA      97                               S01117
     O                 60                98 '-'                           S01117
     O                 88      BRNM     128                               S01117
0547 O        E 1              NODTL                                      S01117
0549 O                       U1          54 '*******'                     S01117
0550 O                                   73 '-----------------'           S01117
0551 O                       U1          83 '********'                    S01117
0552 O        E 2              NODTL                                      S01117
0554 O                                   27 'ACCOUNT NO       CUSTOME'    S01117
0555 O                                   51 'R NAME         EXPIRY   '    S01117
0556 O                                   75 'INPUT    CCY   REF      '    S01117
0557 O                                   99 '   AMOUNT    NARRATIVE  '    S01117
0558 O                                  123 '             LAST     AC'    S01117
0559 O                                  127 'TION'                        S01117
     O                 61               132 'HARD'                                            CAP205
0560 O        E 11             NODTL                                      S01117
0562 O                                   55 'DATE     DATE'               S01117
0563 O                                   68 'NO'                          S01117
0564 O                                  118 'CHANGE'                      S01117
0564 O                 61               132 'HELD'                                            CAP205
     O        E 3              NODTL                                      S01117
     O                                   74 '*** NO DETAILS TO REPORT'    S01117
     O                                   78 ' ***'                        S01117
     O        E 3              NODTL                                      S01117
     O                 88                65 '*** END OF REPORT FOR'       S01117
     O                 88                73 ' BRANCH '                    S01117
     O                 88      BRCA      76                               S01117
     O                 88                80 ' ***'                        S01117
     O                N88                72 '*** END OF REPORT ***'       S01117
0592 O**      FILE CONTROLS
0593 O********T*  03   LR                                                 S01117
0594 O**********                         20 'REFERENCE RE0320'            S01117
0593 ORE0320AUT   03   LR                                                 S01117
0594 O                                   22 'REFERENCE RE0320AU'          S01117
0595 O                         TITL      94
0596 O                                  122 'DATE              PAGE'
0597 O                         RUNA     113
0598 O***********              PAGE  Z  127                               S01117
0598 O                         PAGE1 Z  127                               S01117
0599 O        T 2      LR
0600 O                       U1          54 'INTERIM'
0601 O                                   73 'HELD ITEMS REPORT'
0602 O                       U1MTIME     83 '  .  .  '
     O                                   98 '   RUN CONTROLS'             S01117
0603 O        T 1      LR
0604 O                       U1          54 '*******'
0605 O                                   73 '-----------------'
0606 O                       U1          83 '********'
0607 O        T   15   LR
0608 O                                   39 'END OF REPORT TOTALS'
0609 O        T 2      LR
0610 O                                   39 'NUMBER OF INSERTIONS'
0611 O**********               NHII  3   54                                                  BUG3584
      ** Start of change MD030959A
     O**********               NHII  3   58                                        BUG3584 MD030959A
     O                N08      NHII  3   58
     O                 08      ICNHII3   58
      ** End of change MD030959A
0612 O                                   81 'VALUE OF INSERTIONS'
      ** Start of change MD030959A
0613 O**********               VIHD     116                                                MD030959A
0614 O**********               VIHW  Z  113                                                MD030959A
     O                N08      VIHD     116
     O                N08      VIHW  Z  113
     O                 08      ICVIHD   116
     O                 08      ICVIHWZ  113
      ** End of change MD030959A
0615 O        T 1      LR
0616 O                                   38 'NUMBER OF DELETIONS'
0617 O**********               NHID  3   54                                                  BUG3584
      ** Start of change MD030959A
     O**********               NHID  3   58                                        BUG3584 MD030959A
     O                N08      NHID  3   58
     O                 08      ICNHID3   58
      ** End of change MD030959A
0618 O                                   80 'VALUE OF DELETIONS'
      ** Start of change MD030959A
0619 O**********               VDHD     116                                                MD030959A
0620 O**********               VDHW  Z  113                                                MD030959A
     O                N08      VDHD     116
     O                N08      VDHW  Z  113
     O                 08      ICVDHD   116
     O                 08      ICVDHWZ  113
0621 O********T*3      LR                                                                  MD030959A
     O        T 3      LRN09
      ** End of change MD030959A
0622 O                                   43 'NUMBER OF RECORDS BEFORE'
0623 O                                   50 ' UPDATE'
0624 O**********               NOHI  3   54                                                  BUG3584
     O                         NOHI  3   58                                                  BUG3584
0625 O                                   86 'VALUE OF RECORDS BEFORE '
0626 O                                   92 'UPDATE'
0627 O                         VDHI     116
0628 O                         VWHI  Z  113
      **Start of change MD030959A
0629 O********T*1      LR                                                                  MD030959A
     O        T 1      LRN09
      **End of change MD030959A
0630 O                                   43 'NUMBER OF RECORDS AFTER '
0631 O                                   49 'UPDATE'
0632 O**********               NHAU  3   54                                                  BUG3584
      ** Start of change MD030959A
     O**********               NHAU  3   58                                        BUG3584 MD030959A
     O                N08      NHAU  3   58
     O                 08      ICNHAU3   58
      ** End of change MD030959A
0633 O                                   86 'VALUE OF RECORDS AFTER U'
0634 O                                   91 'PDATE'
      ** Start of change MD030959A
0635 O**********               VHAD     116                                                MD030959A
0636 O**********               VHAW  Z  113                                                MD030959A
     O                N08      VHAD     116
     O                N08      VHAW  Z  113
     O                 08      ICVHAD   116
     O                 08      ICVHAWZ  113
      ** End of change MD030959A
0637 O        T 3      LR 43
0638 O       OR 3      LR 44
0639 O                                   16 'CALCULATED'
0640 O                       44          42 '-NUMBER OF RECORDS AFTER'
0641 O                       44          49 ' UPDATE'
0642 O**********             44TOTITM3   54                                                  BUG3584
     O                       44TOTITM3   58                                                  BUG3584
0643 O                       43          85 '-VALUE OF RECORDS AFTER'
0644 O                       43          92 'UPDATE'
0645 O                       43ZZTOTD   116
0646 O                       43ZZTOTIZ  113
0647 O********T*2      LR 43                                              S01117
0648 O*******OR*2      LR 44                                              S01117
0647 O        T 2      LR 43NU7                                           S01117
0648 O       OR 2      LR 44NU7                                           S01117
0649 O                       44          54 '***  DIFFERENCE  ***'
0650 O                       43         116 '***  DIFFERENCE  ***'
     O        T 3      LRN46NU7                                           S01117
     O                                   74 '*** NO DETAILS TO REPORT'    S01117
     O                                   78 ' ***'                        S01117
0651 O********T** 45   LR                                                 S01117
0652 O***********                        76 '***  END OF REPORT  ***'     S01117
0653 O**
0654 O**   INCLUDE HERE COMPILE TIME ARRAYS FROM ZDATE2
    EO*
    EO*  DATABASE ERROR OUTPUT
    EO*
    EO        T 3      LR U7
    EO                                   38 'DATABASE ERROR NO.-'
    EO***********              LDBNO     40                               S01117
    EO***********                        48 'FILE-'                       S01117
    EO***********              LFILE     53                               S01117
    EO***********                        60 'KEY-'                        S01117
    EO***********              LKEY      89                               S01117
    EO                         DBASE     41                               S01117
    EO                                   49 'FILE-'                       S01117
    EO                         DBFILE    57                               S01117
    EO                                   64 'KEY-'                        S01117
    EO                         DBKEY     93                               S01117
    EO*
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
