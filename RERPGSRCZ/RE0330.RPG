     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Standing orders listing')
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module                                        *
     F*                                                               *
     F*  RE0330 - STANDING ORDERS LIST                                *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
      *  Last Amend No. MD024382           Date 24Jan14               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP187             Date 21Aug09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 BUG8512            Date 22Sep05               *
      *                 CSD027             Date 09Dec05               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 097964             Date 26Feb98               *
      *                 088569             Date 19Jun95               *
     F*                 088447             DATE 21JAN98               *
     F*                 S01408             DATE 08AUG96               *
     F*                 S01408             DATE 17APR96               *
     F*                 S01408             DATE 24JAN96               *
     F*                 S01408             DATE 18JAN96               *
     F*                 S01408             DATE 17JAN96               *
     F*                 S01408             DATE 18OCT95               *
     F*                 S01408             DATE 06SEP95               *
     F*                 S01408             DATE 13MAR95               *
     F*                 S01466             DATE 22MAR94               *
     F*                 S01413             DATE 13APR93               *
     F*                 S01117             DATE 08MAR90               *
     F*                 E16121             DATE 01/02/89              *
     F*                 E16122             DATE 23/01/89              *
     F*                 E15787             DATE 24/10/88              *
     F*                 E80673             DATE 23/10/86              *
     F*                 S01124             DATE 17/10/86              *
     F*                                                               *
     F*---------------------------------------------------------------*
     F*                                                               *
      *  MD024382 - REC33 File Controls show Difference in Calculated *
      *             and Trailer. Amended the program to check CHTP    *
      *             when LCD is not equal to RUND.                    *
      *  MD046248 - Finastra Rebranding                               *
      *  CAP187 - Document Linkage (Recompile)                        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG8512 - Cancellation of standing order does not show in    *
      *            List of Standing Orders                            *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  097964 - I/O error occurred when program tried to write to a *
     F*           closed printer file (RE0330P1). Set off *IN24 to    *
     F*           prevent further write.                              *
     F*           (Applied fix 098688).                               *
     F*  088569 - Second amount is defaulting to first amount, even   *
     F*           when second date is blank.                          *
     F*  088447 - Change Text for Frequency 'A'.                      *
     F*  S01408 - Addition of core hook RE0330IIP2                    *
     F*           Addition of core hook RE0330CCP6                    *
     F*           Addition of core hook RE0330CCP5                    *
     F*  S01408 - Addition of core hook RE0330OP10                    *
     F*         - Addition of core hook RE0330OOP9                    *
     F*  S01408 - Addition of core hook RE0330OOP7                    *
     F*         - Addition of core hook RE0330OOP8                    *
     F*  S01408 - Addition of core hook RE0330OOP5                    *
     F*           Addition of core hook RE0330OOP6                    *
     F*  S01408 - Addition of core hook RE0330OOP4                    *
     F*  S01408 - Addition of core hook RE0330EEP1                    *
     F*  S01408 - Addition of core hook RE0330CCP4                    *
     F*           Addition of core hook RE0330IIP1                    *
     F*           Addition of core hook RE0330OOP3                    *
     F*  S01408 - Addition of core hook RE0330FFPG                    *
     F*           Addition of core hook RE0330CCPG                    *
     F*           Addition of core hook RE0330OOPG                    *
     F*           Addition of core hook RE0330IIPG                    *
     F*           Addition of core hook RE0330CCP1                    *
     F*           Addition of core hook RE0330CCP2                    *
     F*           Addition of core hook RE0330CCP3                    *
     F*           Addition of core hook RE0330OOP1                    *
     F*           Addition of core hook RE0330OOP2                    *
     F*  S01466 - BLI Retail Enhancements                             *
     F*  S01413 - Retail 3 Incorporation                              *
     F*         - Recompiled due to changes to files SSTAN, CLINT.    *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  E16121 - SECOND PAYMENT SHOULD NOT BE INCLUDED IN TOTALS     *
     F*           IF IT DOES NOT EXIST.                               *
     F*  E16122 - PAYMENT FREQUENCY 'R' NOT OUTPUT ON REPORT.         *
     F*           ALSO 'Z' NO LONGER VALID.                           *
     F*  E15787 - 'PARTIAL' WAS NOT PREVIOUSLY UNDERLINED ON REPORT   *
     F*  E80673 - DELETED RECORDS BEING ADDED TO FILE CONTROL TOTALS  *
     F*           N.B. THIS IS R11 FIX TRANSFERRED TO R21             *
     F*  S01124 - R21 PRINTER FILE CHANGES                            *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F***SSTAN***IP**F     256  1AI     1 DISK                            S01466
     F***SSTAN** IP  F     263  1AI     1 DISK                                         S01466 CGL029
     FSSTAN   IP  F     284  1AI     1 DISK                                                   CGL029
0014 FTABLE   IF  F      96 12AI     2 DISK
0015 FTABLED  IF  F      96 12AI     2 DISK
0016 FCLINT   IF  F     256  7AI     2 DISK
     F/COPY WNCPYSRC,RE0330F001
0017 FRE0330AUO   F     132     OV     PRINTER      KINFDS SPOOLU         S01117
0017 F*E0330P1O** F     132     OF     PRINTER                      S01124S01117
0017 FRE0330P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     F*                                                                   S01408
     F/COPY WNCPYSRC,RE0330FFPG                                           S01408
     F*                                                                   S01408
0018 F* ID F  C  H  L    FUNCTION OF INDICATORS
0019 F* 01            STANDING ORDERS - DETAIL
0020 F* 02            STANDING ORDERS - TRAILER
0021 F* 03            STANDING ORDERS - CATCHALL
0022 F* 04            TABLE FILE - ICR 1
0023 F* 05            TABLE FILE - CATCHALL
0024 F* 06            DEMAND TABLE FILE - CURRENCIES RECORD 1
0025 F* 07            DEMAND TABLE FILE - CATCHALL
0026 F* 08            CUSTOMER MASTER FILE - DETAIL
0027 F* 09            CUSTOMER MASTER FILE - CATCHALL
0028 F*       10      DATE OF LAST PAYMENT IS 99999
0028 F********20*     PRINTER FILE OPENED INDICATOR                       S01117
0028 F*       20      MULTIBRANCHING OUTPUT INDICATOR                     S01117
0029 F*   N21         DEBIT RETAIL ACCOUNT NUMBER EXISTS
0030 F*   N22         CREDIT RETAIL ACCOUNT NUMBER EXISTS
0031 F*       23      LAST CHANGE DATE IS RUN DATE
0032 F*       40      FIRST CYCLE PROCESSING
0033 F*       41      CHAIN FAIL
     F*       42      WORK INDICATOR
0034 F* ID F  C  H  L    FUNCTION OF INDICATORS
0035 F*       44      NO. OF RECORDS OUT OF BALANCE
0036 F*       45      VALUE OF RECORDS OUT OF BALANCE
0037 F*       50      CURRENCY HAS 0 D.P.
0038 F*       51      CURRENCY HAS 1 D.P.
0039 F*       52      CURRENCY HAS 2 D.P.
0040 F*       53      CURRENCY HAS 3 D.P.
0041 F*       55      CHANGE TYPE IS 'INSERT'
0042 F*       56      CHANGE TYPE IS 'AMEND'
0043 F*       57      CHANGE TYPE IS 'DELETE'
0044 F**
0045 F**   PAYMENT FREQUENCIES
0046 F*       58      DAILY
0047 F*       59      WEEKLY
0048 F*       60      15TH AND LAST DAY OF MONTH
0049 F*       61      FORTNIGHTLY
0050 F* ID F  C  H  L    FUNCTION OF INDICATORS
0051 F*       62      MONTHLY
0052 F*       63      LAST DAY OF MONTH
0053 F*       64      LAST WORKING DAY OF MONTH
0054 F*       65      MONTHLY ON ACCRUAL DAY
0055 F********66******ON DEMAND                                           E16122
0055 F*       66      EOM LESS 6 DAYS                                     E16122
0056 F*       67      QUARTERLY
0057 F*       68      SIX MONTHLY
0058 F*       69      BI-MONTHLY
0059 F*       70      YEARLY
0060 F*       75      NO LIVE DETAILS TO REPORT
0061 F*       76      LEVEL BREAK INDICATOR CHECK
0062 F*       77      LIVE DETAILS WITHIN A BRANCH
     F*       85      P1 FILE HAS BEEN OPENED                             S01117
     F*       86      NO DETAILS TO REPORT                                S01117
     F*       88      MBIN = 'Y'                                          S01117
     F*       89      BRNCH = 'ALL'                                       S01117
0063 F**
0064 F**   PAYMENT METHOD
0065 F*       71      CREDIT TRANSFER
0066 F*       72      DRAFT
0067 F*       73      TELEX
0068 F*       74      INTERNAL
0069 F*             L1CHANGE OF BRANCH
0070 F*             U8FILE CONTROLS OUT OF BALANCE
0072 F*
0073 F*             U1INTERIM LIST OF STANDING ORDERS
0074 F*             U2PARTIAL LIST OF STANDING ORDERS (TODAYS CHANGES)
      *                                                                   S01408
     E/COPY WNCPYSRC,RE0330EEP1                                           S01408
      *                                                                   S01408
0075 E                    CCYA      150  3
0076 E                    DPA       150  1 0
0077 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0078 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0079 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    CPY@    1   1 80
0080 E**
0081 I*
0082 I*    STANDING ORDERS FILE
0083 I*
0084 ISSTAN   NS  01   1 CD
0085 I*******OR**      1 C* 253 CD                                        S01117
0085 I*******OR*       1 C* 255 CD                                                    S01117 BUG8512
     I       OR        1 C* 260 CD                                                           BUG8512
0086 I                                        2   60STOR
0087 I***********                             7   90BRCD  L1              S01117
0087 I                                        7   9 DRBR                  S01117
0088 I**********                             10  150DCUS                                      CSD027
0088 I                                       10  15 DCUS                                      CSD027
0089 I**********                             16  190DACD                                      CGL029
     I                                       16  190DACDQQ                                    CGL029
0090 I                                       26  270DACS
0091 I                                       28  370DRAN            21
0092 I**********                             38  430CCUS                                      CSD027
0092 I                                       38  43 CCUS                                      CSD027
0093 I**********                             44  470CACD                                      CGL029
     I                                       44  470CACDQQ                                    CGL029
     I                                       49  51 BRCA  L1              S01117
0094 I                                       54  550CACS
0095 I                                       56  650CRAN            22
0096 I                                       66  68 CCY
0097 I                                    P  69  710DFPY
0098 I                                    P  72  780AFPY0
0099 I                                    P  72  781AFPY1
0100 I                                    P  72  782AFPY2
0101 I                                    P  72  783AFPY3
0102 I                                    P  79  810DSPY
0103 I                                    P  82  880ASPY0
0104 I                                    P  82  881ASPY1
0105 I                                    P  82  882ASPY2
0106 I                                    P  82  883ASPY3
0107 I                                    P  89  910DLPY
0108 I                                    P  92  980ALPY0
0109 I                                    P  92  981ALPY1
0110 I                                    P  92  982ALPY2
0111 I                                    P  92  983ALPY3
0112 I                                       99  99 PAYF
0113 I                                      106 135 PNAR
0114 I                                      136 155 PNAM
0115 I                                      156 175 PAYR
0116 I                                      176 195 PAYB1
0117 I                                      196 215 PAYB2
0118 I                                      216 225 PAYA
0119 I                                      226 226 METH
0119 I                                      229 231 CBRC                  S01117
0119 I                                      232 235 PRFC                  S01117
0120 I***********                         P 250 2520LCD                   S01117
0121 I***********                           253 253 CHTP                  S01117
0120 I***********                         P 252 2540LCD            S01117 S01466
0121 I***********                           255 255 CHTP           S01117 S01466
     I                                      252 256 TRAT                  S01466
     I                                    P 257 2590LCD                   S01466
     I                                      260 260 CHTP                  S01466
     I                                      265 2740DACD                                      CGL029
     I                                      275 2840CACD                                      CGL029
0122 I        NS  02   1 CT
0123 I                                    P  13  150NOSO
0124 I                                    P  16  230VSWN
0125 I                                    P  24  250VSDC
0126 I                                    P  26  280NSOI
0127 I                                    P  29  310NSOA
0128 I                                    P  32  340NSOD
0129 I                                    P  35  420VSIW
0130 I                                    P  43  440VSID
0131 I                                    P  45  520VSAW
0132 I                                    P  53  540VSAD
0133 I                                    P  55  620VSDW
0134 I                                    P  63  640VSDD
0135 I                                    P  65  670NSAU
0136 I                                    P  68  750VSUW
0137 I                                    P  76  770VSUD
0138 I*
0139 I*    CATCHALL
0140 I*
0141 I        NS  03
0142 I*
0143 I*    TABLE FILE ICR 1
0144 I*
0145 ITABLE   NS  04   1 CD   2 C0   3 C1
0146 I       AND      12 C1  13 C0
0147 I                                        1   1 RECI
0148 I                                       14  66 TITL
0149 I***********                            67  67 DATF                  S01117
0150 I***********                         P  77  790RUND                  S01117
0151 I***********                            80  86 RUNA                  S01117
0152 I*
0153 I*    CATCHALL
0154 I*
0155 I        NS  05
0156 I*
0157 I*    TABLE FILE CURRENCIES RECORD 1
0158 I*
0159 ITABLED  NS  06   1 CD   2 C2   3 C0
0160 I                                        1   1 RECIX
0161 I                                        2   30RECTX
0162 I                                       10  12 CCYX
0163 I                                       13  130SRECX
0164 I                                       38  380CDPX
0165 I*
0166 I        NS  07
0167 I                                        2   30RECTX
0168 I*
0169 I*    CUSTOMER MASTER FILE
0170 I*
0171 ICLINT   NS  08   1 CD
0172 I                                        9  28 CRNM
     I*                                                                   S01408
     I/COPY WNCPYSRC,RE0330IIP2                                           S01408
     I*                                                                   S01408
0173 I*
0174 I*    CATCHALL
0175 I*
0176 I        NS  09
     I*                                                                   S01408
     I/COPY WNCPYSRC,RE0330IIPG                                           S01408
     I*                                                                   S01408
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
0218 I*                                                                   S01117
0219 I*    LDA - DIAGNOSTICS FOR PROGRAM ABORT                            S01117
0220 I*                                                                   S01117
0221 ILDA        UDS                            256                       S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     ISDGELR    E DSSDGELRPD                                              S01117
     I** GENERAL LEDGER DETAILS                                           S01117
     I              BKPRCU                          PFCU                  S01117
     I**                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**  EXTERNAL DS FOR BRANCH DETAILS                                  S01117
     I              A8BRNM                          BRNM                  S01117
     I*                                                                   S01466
     ISCSARD    E DSSCSARDPD                                              S01466
     I**  SAR File Details Accessed via Access Program AOSARDR0           S01466
     I*                                                                   S01466
     IDSFDY     E DSDSFDY                                                 S01117
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01117
     I*                                                                   S01117
     I*                                                                   S01408
     I/COPY WNCPYSRC,RE0330IIP1                                           S01408
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
     I*                                                                   S01408
     C                     MOVEACPY@      BIS@   80
0177 C*
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NO.  S01117
     C                     PARM           BRNCH   3         BRANCH OR ALL S01117
0178 C*    FIRST CYCLE PROCESSING
0179 C*
0180 C   40                GOTO START
0181 C                     SETON                     40
     C                     MOVE *BLANKS   DBFILE                          S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVE *BLANKS   DBPGM                           S01117
     C                     MOVEL'RE0330'  DBPGM                           S01117
     C**                                                                  S01117
     C**    IN THE DATAAREA RUNDAT                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C**    TEST FOR MULTIBRANCHING                                       S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** ACCESS GENERAL LEDGER DETAILS FOR PROFIT CENTRE FLAGS            S01117
     C**********           CALL 'AOGELRR0'                                S01117              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C********** SDGELR    PARM SDGELR    DSFDY                           S01117              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL'SDGELRPD'DBFILE             *************S01117
     C                     MOVEL'004'     DBASE              * DBERR 004 *S01117
     C                     MOVEL@OPTN     DBKEY              *************S01117
     C                     SETON                     U7U8LR               S01117
     C                     GOTO TOTAL                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C**    TEST IF PROFIT CENTRE IS USED                                 S01117
     C           PFCU      IFEQ 'Y'                                       S01117
     C                     SETON                     84                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C**    ASSUME NO DETAILS TO REPORT                                   S01117
     C**                                                                  S01117
     C                     SETON                     86                   S01117
     C*                                                                   S01117
0182 C                     EXSR ZSYSTM
0183 C                     EXSR CCYARR
0184 C                     MOVE 'A'       KEYCL   7
0185 C                     TIME           MTIME   60
     C/COPY WNCPYSRC,RE0330C001
     C*                                                                   S01466
     C**  Read switchable features file SCSARDPD using access object      S01466
     C**  to determine if transaction type is to be printed on the        S01466
     C**  report                                                          S01466
     C*                                                                   S01466
     C                     CALL 'AOSARDR0'                                S01466
     C                     PARM *BLANKS   W0RTCD  7                       S01466
     C                     PARM '*VERIFY' W0OPTN  7                       S01466
     C                     PARM 'S01466'  W0SARD  6                       S01466
     C           SCSARD    PARM SCSARD    DSFDY                           S01466
     C                     MOVE '0'       *IN15                           S01466
     C*                                                                   S01466
     C**  If feature is on, set up SAR indicator                          S01466
     C*                                                                   S01466
     C           W0RTCD    IFEQ *BLANKS                                   S01466
     C                     MOVE '1'       *IN15                           S01466
     C                     ELSE                                           S01466
     C*                                                                   S01466
     C** else, database error (return code other than *NRF)               S01466
     C*                                                                   S01466
     C           W0RTCD    IFNE '*NRF   '                                 S01466
     C                     MOVEL'RE0330'  DBPGM                           S01466
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01466
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 13 *   S01466
     C                     Z-ADD13        DBASE            ************   S01466
     C                     SETON                     U7U8LR               S01466
     C                     GOTO TOTAL                                     S01466
     C                     END                                            S01466
     C*                                                                   S01466
     C                     END                                            S01466
     C*                                                                   S01466
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0330CCP3                                           S01408
     C*                                                                   S01408
0186 C           START     TAG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0330CCP4                                           S01408
     C*                                                                   S01408
0187 C*****   LIVE DETAIL CHECK
0188 C   L1                SETON                     76
0189 C   L1                SETOF                     77
     C*                                                                   S01117
     C** IF THE REQUIRED BRANCH IS GREATER THAN BRCA,                     S01117
     C** SKIP THE CALCULATION                                             S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRNCH     ANDGTBRCA                                      S01117
     C                     GOTO TOTAL                                     S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           *INL1     IFEQ '1'                                       S01117
     C*   Where *INLn is the Branch or Company level break indicator.     S01117
     C                     CLOSERE0330P1                                  S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           BRNCH     OREQ BRCA                                      S01117
     C           MBIN      OREQ 'N'                                       S01117
     C                     SETON                     20    ALLOW OUTPUT   S01117
     C                     OPEN RE0330P1                                  S01117
     C*                                                                   S01117
     C** INDICATE THAT THE P1 FILE HAS BEEN OPENED                        S01117
     C                     SETON                     85                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C*                                                                   S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**                                                                  S01117
     C** GET BRANCH NAME (IN BRNM)                                        S01117
     C**                                                                  S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD                           S01117
     C                     PARM '*KEY   ' @OPTN                           S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD12        DBASE            * DBERROR 012 *S01117
     C                     SETON                     U7U8LR***************S01117
     C                     GOTO TOTAL                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C*
     C**N80******RECI      COMP 'D'                  8080                 S01117
     C***80******          SETON                     U7U8LR               S01117
     C***U8******          GOTO TOTAL                                     S01117
     C                     ELSE                                           S01117
     C                     SETOF                     20                   S01117
     C                     MOVE '0'       *IN24                           097964
     C           BRNCH     IFLT BRCA                                      S01117
     C                     SETON                     LR                   S01117
     C                     END                                            S01117
     C                     GOTO TOTAL                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
0190 C*
0191 C   02
0192 COR 03                GOTO TOTAL
0193 C**   IF PARTIAL LIST ONLY PRINT TODAYS UPD
0194 C**
0195 C                     SETOF                     555657
     C                     SETOF                     42                   E16121
0196 C**
0197 C   U2      LCD       COMP RUND                     23
0198 C   U2N23             SETOF                     01
     C   U2N23   CHTP      COMP 'D'                      57                                 MD024382
0199 C   U2N23             GOTO TAG01
0200 C*
0201 C*       LIVE DETAIL CHECK
0202 C   01                SETON                     7577
     C   77                SETOF                     86                   S01117
0203 C*
0204 C*    FIND NUMBER OF DECIMAL PLACES FOR CURRENCY
0205 C                     MOVE CCY       XCCY
0206 C                     EXSR CCYDEP
0207 C           XDECP     COMP 1                      5051
0208 C           XDECP     COMP 2                    53  52
0209 C*
     C*    IF SECOND PAYMENT AMOUNT IS BLANK THEN
     C*         USE FIRST PAYMENT AMOUNT
     C*         IF SECOND DATE IS NOT BLANK.                              088569
     C           DSPY      IFNE *ZERO                                     088569
     C           ASPY0     COMP *ZERO                    42
     C   42 50             Z-ADDAFPY0     ASPY0
     C   42 51             Z-ADDAFPY1     ASPY1
     C   42 52             Z-ADDAFPY2     ASPY2
     C   42 53             Z-ADDAFPY3     ASPY3
     C                     END                                            088569
0209 C*
0210 C*    SET INDICATORS ACCORDING TO CHANGE TYPE
0211 C           CHTP      COMP 'I'                      55
0212 C           CHTP      COMP 'A'                      56
0213 C           CHTP      COMP 'D'                      57
0214 C*
0215 C*    SET INDICATORS ACCORDING TO PAYMENT FREQUENCY
0216 C           PAYF      COMP 'D'                      58 DAILY
0217 C           PAYF      COMP 'W'                      59 WEEKLY
0218 C           PAYF      COMP 'S'                      60 15TH AND LAST
0219 C           PAYF      COMP 'F'                      61 FORTNIGHTLY
0220 C           PAYF      COMP 'M'                      62 MONTHLY
0221 C           PAYF      COMP 'L'                      63 LAST DAY
0222 C           PAYF      COMP 'B'                      64 LAST WORK DAY
0223 C           PAYF      COMP 'A'                      65 MON.ON ACC.DAY
0224 C***********PAYF      COMP 'Z'                      66 ON DEMAND     E16122
0224 C           PAYF      COMP 'R'                      66 EOM LESS 6DAYSE16122
0225 C           PAYF      COMP 'Q'                      67 QUARTERLY
0226 C           PAYF      COMP 'X'                      68 SIX MONTHLY
0227 C           PAYF      COMP 'T'                      69 BI-MONTHLY
0228 C           PAYF      COMP 'Y'                      70 YEARLY
0229 C*
0230 C*    SET INDICATORS ACCORDING TO PAYMENT METHOD
0231 C           METH      COMP 'C'                      71 CR. TRANSFER
0232 C           METH      COMP 'D'                      72 DRAFT
0233 C           METH      COMP 'T'                      73 TELEX
0234 C           METH      COMP 'I'                      74 INTERNAL
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0330CCP1                                           S01408
     C*                                                                   S01408
0235 C*
0236 C*    RECOVER DEBIT AND CREDIT CUSTOMER NAMES
0237 C*    PUT DEBIT CUSTOMER NAME IN DCRNM
0238 C*    LEAVE CREDIT CUSTOMER NAME IN CRNM
0239 C*
0240 C                     MOVELDCUS      KEYCL
0241 C           KEYCL     CHAINCLINT                41
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0330CCP5                                           S01408
     C*                                                                   S01408
0242 C                     MOVE CRNM      DCRNM  20
0243 C                     MOVELCCUS      KEYCL
0244 C           KEYCL     CHAINCLINT                41
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0330CCP6                                           S01408
     C*                                                                   S01408
0245 C*
0246 C*    ACCUMULATE NUMBER OF S/O FROM EACH BRANCH IN BRTOT
0247 C           BRTOT     ADD  1         BRTOT   50
0248 C   57      DELETS    ADD  1         DELETS  50
     C/COPY WNCPYSRC,RE0330C002
0249 C*
0250 C*    CONVERT DAY NUMBERS TO ALPHAMERIC FORMAT
0251 C*
0252 C                     Z-ADDDFPY      ZDAYNO  50
0253 C                     EXSR ZDATE2
0254 C                     MOVE ZADATE    DFPYA   7
0255 C                     Z-ADDDSPY      ZDAYNO
0256 C                     EXSR ZDATE2
0257 C                     MOVE ZADATE    DSPYA   7
0258 C           DLPY      COMP 99999                    10
0259 C  N10                Z-ADDDLPY      ZDAYNO
0260 C  N10                EXSR ZDATE2
0261 C  N10                MOVE ZADATE    DLPYA   7
0262 C                     Z-ADDLCD       ZDAYNO
0263 C                     EXSR ZDATE2
0264 C                     MOVE ZADATE    LCDA    7
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0330CCP2                                           S01408
     C*                                                                   S01408
0265 C*
0266 C*    ACCUMULATE TOTAL NUMBER AND VALUE OF RECORDS READ
0267 C*
0268 C           TAG01     TAG                             ** TAG TAG01 **
0269 C*
0270 C  N57      NAFTUP    ADD  1         NAFTUP  50
     C   57                GOTO TOTAL                                     E80673
0271 C                     Z-ADDAFPY3     ZZAMT  153
0272 C                     EXSR GLZADD
0273 C***********          Z-ADDASPY3     ZZAMT                           E16121
0274 C***********          EXSR GLZADD                                    E16121
0273 C  N42                Z-ADDASPY3     ZZAMT                           E16121
0274 C  N42                EXSR GLZADD                                    E16121
0275 C                     Z-ADDALPY3     ZZAMT
0276 C                     EXSR GLZADD
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0330CCPG                                           S01408
     C*                                                                   S01408
0277 C           TOTAL     TAG                             ** TOTAL TAG **
0278 C*****IF PARTIAL LIST, ONLY PRINT TODAYS UPDATES
0279 CL1         BRTOT     SUB  DELETS    BRTOT
0280 CL1                   Z-ADD0         DELETS
     C*                                                                   S01117
     C** IF P1 FILE NOT OPEN (BECAUSE NO RECORDS READ) THEN OPEN IT       S01117
     C*                                                                   S01117
     CLR         *IN85     IFNE '1'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   EXCPTNODTL                                     S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     CLR                   OUT  LDA                                       S01117
     C*                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR         MBIN      IFEQ 'N'                                       S01117
     CLR         MBIN      OREQ 'Y'                                       S01117
     CLR         BRNCH     ANDEQ'ALL'                                     S01117
0281 CLRNU1      NSAU      COMP NAFTUP               4444
0282 CLRNU1      VSUW      COMP ZZTOTI               4545
0283 CLRNU1N45   VSUD      COMP ZZTOTD               4545
     CLR                   END                                            S01117
0284 CLR    44
0285 COR    45             SETON                     U8
     C*                                                                   S01117
     CLR U7 U8             EXSR *PSSR                                     S01117
0286 C*
0287 C********************************************************************
0288 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0289 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0290 C*
0291 CSR         GLZADD    BEGSR                           *** GLZADD ****
0292 C*
0293 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0294 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0295 C*
0296 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0297 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0298 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0299 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0300 C*
0301 CSR                   EXSR GLZSUM
0302 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0303 C*
0304 C********************************************************************
0305 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0306 C*                        GLZADD, GLZSUB, GLZCMP.
0307 C*          PARAMETERS PASSED -
0308 C*                     I/P ZZAMTI ZZAMTD
0309 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0310 C*
0311 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0312 C*
0313 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0314 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0315 CSR                   SETOF                     919293
0316 CSR                   SETOF                     949599
0317 C*
0318 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0319 CSR         ZZAMTI    COMP 0                      9293
0320 CSR 93      ZZAMTD    COMP 0                      9293
0321 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0322 C*
0323 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0324 CSR         ZZTOTI    COMP 0                      9193
0325 CSR 93      ZZTOTD    COMP 0                      9193
0326 C*
0327 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0328 CSR 93                Z-ADDZZAMTI    ZZTOTI
0329 CSR 93                Z-ADDZZAMTD    ZZTOTD
0330 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0331 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0332 CSR 91N92
0333 CORN91 92             GOTO ZZOFPS
0334 C*
0335 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0336 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0337 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0338 C*
0339 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0340 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0341 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0342 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0343 C*
0344 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0345 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0346 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0347 CSRN99                Z-ADDZZWK2     ZZTOTD
0348 CSRN99                Z-ADDZZWK3     ZZTOTI
0349 C*
0350 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0351 CSR 99                Z-ADD0         ZZAMT  153
0352 CSR                   GOTO ZZSEND
0353 C*
0354 C* THE 'SIGNS' ARE DIFFERENT
0355 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0356 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0357 C*
0358 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0359 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0360 C*
0361 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0362 C*
0363 CSR 91                Z-SUBZZTOTI    ZZTOTI
0364 CSR 91                Z-SUBZZTOTD    ZZTOTD
0365 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0366 C*
0367 CSR         ZZTOTI    COMP ZZAMTI               93  95
0368 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0369 C*
0370 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0371 CSR 95                Z-ADD0         ZZTOTI
0372 CSR 95                Z-ADD0         ZZTOTD
0373 CSR 95                GOTO ZZSEND
0374 C*
0375 C* IF ZZTOT GT. ZZAMT.
0376 CSR 93      ZZAMTD    COMP ZZTOTD               94
0377 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0378 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0379 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0380 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0381 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0382 C*
0383 C*
0384 C* IF ZZAMT GT. ZZTOT.
0385 CSRN93      ZZTOTD    COMP ZZAMTD               94
0386 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0387 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0388 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0389 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0390 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0391 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0392 C*
0393 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0394 CSR                   SETOF                     94
0395 CSR 93 91
0396 CORN93 92             SETON                     94
0397 CSR 94                Z-SUBZZTOTI    ZZTOTI
0398 CSR 94                Z-SUBZZTOTD    ZZTOTD
0399 C**
0400 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0401 CSR 92                Z-SUBZZAMTI    ZZAMTI
0402 CSR 92                Z-SUBZZAMTD    ZZAMTD
0403 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0404 C**
0405 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0406 CSR                   SETOF                     96
0407 CSR         ZZTOTD    COMP 0                        91
0408 CSR 91      ZZTOTI    COMP 0                      96
0409 CSR 96                MOVE '.000-'   ZZNEGD  5
0410 CSR                   ENDSR                             ** ENDSR **
0411 C********************************************************************
0412 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0413 C**
0414 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0415 C**
0416 C**   CLEAR DATE FIELDS.
0417 C                     Z-ADD0         ZDATE   60
0418 C                     MOVEL'       ' ZADATE  7
0419 C**
0420 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0421 C                     Z-ADDZDAYNO    ZDAYNO  50
0422 C**
0423 C**   DETERMINE YEAR NUMBER.
0424 C**
0425 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0426 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0427 C   99                GOTO ZDEND2
0428 C**
0429 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0430 C           ZDAYN1    DIV  1461      ZLYR    20
0431 C                     MVR            ZDAYN1           SAVE REMAINING
0432 C**                                                   DAYS
0433 C**   CALCULATE NUMBER OF REMAINING YEARS.
0434 C                     Z-ADD1         ZWRK2   20
0435 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0436 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0437 C  N90      ZWRK2     ADD  1         ZWRK2
0438 C  N90                GOTO ZDTAG1
0439 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0440 C**
0441 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0442 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0443 C**
0444 C**   CALCULATE ACTUAL YEAR NUMBER.
0445 C           ZLYR      MULT 4         ZWRK3   30
0446 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0447 C                     Z-ADDZWRK3     ZYEAR   20
0448 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0449 C**
0450 C**   DETERMINE MONTH NUMBER.
0451 C**
0452 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0453 C                     SETOF                     9293
0454 C   91      ZDAYN1    COMP 59                     9293
0455 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0456 C**
0457 C**   CALCULATE MONTH NUMBER.
0458 C                     Z-ADD2         ZWRK2
0459 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0460 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0461 C  N94      ZWRK2     ADD  1         ZWRK2
0462 C  N94                GOTO ZDTAG2
0463 C           ZWRK2     SUB  1         ZWRK2
0464 C**
0465 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0466 C**
0467 C**   DETERMINE DAY OF MONTH.
0468 C**
0469 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0470 C           ZDAYN1    ADD  1         ZDAYN1
0471 C**
0472 C**   CALCULATE DAY OF MONTH.
0473 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0474 C**
0475 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0476 C   93      ZDAY      ADD  1         ZDAY
0477 C**
0478 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0479 C  N98                MOVELZDAY      ZWRK4   40
0480 C   98                MOVE ZDAY      ZWRK4
0481 C  N98                MOVE ZMTH      ZWRK4
0482 C   98                MOVELZMTH      ZWRK4
0483 C                     MOVELZWRK4     ZDATE
0484 C                     MOVE ZYEAR     ZDATE
0485 C**
0486 C**   FORMAT ALPHA DATE, DDMMMYY.
0487 C           ZDAY      COMP 10                     95
0488 C                     MOVELZDAY      ZWRK5   5
0489 C   95                MOVEL' '       ZWRK5
0490 C                     MOVE ZMNM,ZMTH ZWRK5
0491 C                     MOVELZWRK5     ZADATE
0492 C                     MOVE ZYEAR     ZADATE
0493 C**
0494 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0495 C**
0496 C********************************************************************
0497 C**
0498 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0499 C**
0500 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0501 C**
0502 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
0503 C                     MOVEL'01      'ZTABKY 12
0504 C                     MOVE '  10'    ZTABKY
0505 C**
0506 C           ZTABKY    CHAINTABLE                99    ON NOT THERE
0507 C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
0508 C**
0509 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0510 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
0511 C**
0512 C                     ENDSR
0513 C**
0514 C**
0515 C********************************************************************
0516 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF
0517 C**   DECIMAL PLACES FOR THOSE CURRENCIES.
0518 C**
0519 C           CCYARR    BEGSR                           *** CCYARR  ***
0520 C**
0521 C**   SET ARRAY INDEX TO ZERO.
0522 C                     Z-ADD0         X       30
0523 C**
0524 C**   SET UP KEY FOR CURRENCY TABLE.
0525 C                     MOVEL'20      'XCYKEY 12
0526 C                     MOVE '    '    XCYKEY
0527 C**
0528 C**   SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.
0529 C           XCYKEY    SETLLTABLED
0530 C**
0531 C**   LOOP TO READ CURRENCY DETAIL RECORDS.
0532 C           XLOOP     TAG                             ** XLOOP TAG **
0533 C                     READ TABLED                   99
0534 C  N99      RECTX     COMP 20                   9999
0535 C**
0536 C**   END IF ALL CURRENCY RECORDS PROCESSED
0537 C   99                GOTO XEND
0538 C**
0539 C**   IGNORE DELETED RECORDS AND NON-SUB-RECORD ONE.
0540 C           RECIX     COMP 'D'                  9797
0541 C   97                GOTO XLOOP
0542 C           SRECX     COMP 1                    9797
0543 C   97                GOTO XLOOP
0544 C**
0545 C**   INCREMENT ARRAY INDEX.
0546 C           X         ADD  1         X
0547 C**
0548 C**   MOVE DATA INTO ARRAYS.
0549 C                     MOVE CCYX      CCYA,X
0550 C                     MOVE CDPX      DPA,X
0551 C**
0552 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.
0553 C           X         COMP 150                      96
0554 C**
0555 C**   GO TO READ NEXT RECORD.
0556 C  N96                GOTO XLOOP
0557 C**
0558 C           XEND      TAG                             ** XEND TAG  **
0559 C                     ENDSR
0560 C**
0561 C********************************************************************
0562 C**
0563 C**   SR. TO OBTAIN NO. OF DECIMAL PLACES FOR A CURRENCY.
0564 C**
0565 C           CCYDEP    BEGSR                           *** CCYDEP  ***
0566 C**
0567 C**   SET ARRAY INDEX TO ONE AND RESET ERROR INDICATOR.
0568 C                     Z-ADD1         X            99
0569 C**
0570 C**   INITIALIZE INPUT-OUTPUT FIELDS.
0571 C                     Z-ADD0         XDECP   10
0572 C                     MOVE XCCY      XCCY    3
0573 C**
0574 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.
0575 C**   99 SETON FOR INVALID CURRENCY.
0576 C           XCCY      LOKUPCCYA,X                   95
0577 C   95                MOVE DPA,X     XDECP
0578 C  N95                SETON                     99
0579 C**
0580 C                     ENDSR
0581 C**
0582 C********************************************************************
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILE HAS NOT ALREADY BEEN OPENED (IE. IF THERE ARE         S01117
     C* NO RECORDS READ AND THEREFORE FILE OPENING NOT PERFORMED.)        S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
     C*                                                                   S01117
     C** OPEN P1 SPOOL FILE                                               S01117
     C                     OPEN RE0330P1                                  S01117
     C*                                                                   S01117
     C** INDICATE THAT THE P1 FILE HAS BEEN OPENED                        S01117
     C                     SETON                     85                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C*                                                                   S01117
     C** IF IT'S BRANCH ALL, NO BRANCH NAME WILL BE PRINTED               S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C                     SETON                     89                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY          S01117
     C           BRNCH     IFEQ 'ALL'                      B1             S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C*                                                                   S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED       S01117
     C                     ELSE                            X1             S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C*                                                                   S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN MULTIBRANCHING   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD11        DBASE            * DBERROR 011 *S01117
     C                     SETON                     U7U8  ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     END                             E1             S01117
     C*                                                                   S01117
     C           #ZZ9      ENDSR                                          S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
0583 O*E0330P1H  203   L1                                           S01124S01117
0584 O*****  OR        OF                                                 S01117
0583 ORE0330P1H  203   L1 20                                              S01117
0584 O       OR        OFNL1 20                                           S01117
0585 O*****                              25 'REFERENCE RE0330'            S01117
0585 O                                   25 'REFERENCE RE0330P1'          S01117
0586 O                         TITL      92
0587 O                                  104 'DATE'
0588 O                         RUNA     113
0589 O                                  122 'PAGE'
0590 O                         PAGE  Z  127
0591 O*****   H  1     L1                                                 S01117
0592 O*****  OR        OF                                                 S01117
0591 O        H  1     L1 20                                              S01117
0592 O       OR        OFNL1 20                                           S01117
0593 O                    U2             40 'PARTIAL'
0594 O                       U1          49 'INTERIM'
0595 O                                   73 'LIST OF STANDING ORDERS'
0596 O                       U1MTIME     82 '  .  .  '
     O                 88 U1             92 'BRANCH'                      S01117
     O                 88 U1   BRCA      96                               S01117
     O                 88 U1             97 '-'                           S01117
     O                 88 U1   BRNM     127                               S01117
     O                 88NU1             83 'BRANCH'                      S01117
     O                 88NU1   BRCA      87                               S01117
     O                 88NU1             88 '-'                           S01117
     O                 88NU1   BRNM     118                               S01117
0597 O***********                       106 'BRANCH'                      S01117
0598 O***********              BRCD     110                               S01117
0599 O*****   H  2     L1                                                 S01117
0600 O*****  OR        OF                                                 S01117
0599 O        H  2     L1 20                                              S01117
0600 O       OR        OFNL1 20                                           S01117
     O                    U2             40 '-------'                     E15787
0601 O                       U1          49 '*******'
0602 O                                   73 '-----------------------'
0603 O                       U1          82 '********'
0604 O*
0605 O*    LINES 8, 17, 26, 35, 44 AND 53
0606 O*
0607 O*****   D  1     01                                                 S01117
0607 O        D  1     01 20                                              S01117
     O                                   10 'DR CUST NO'                                      CGL029
     O                 88                37 '-      -   -          -'                         CGL029
     O                N88                37 '       -   -          -'                         CGL029
     O                 88      DRBR      14                                                   CGL029
     O                         DCUS      21                                                   CGL029
     O                         CCY       25                                                   CGL029
0608 O**********                         15 'DR. CUSTOMER NO'                                 CGL029
0609 O**********       88                37 '-      -   -    -'                        S01117 CGL029
0609 O**********      N88                37 '       -   -    -'                        S01117 CGL029
0610 O**********       88      DRBR      20                                            S01117 CGL029
0610 O**********               DCUS      27                                            S01117 CGL029
0611 O**********               CCY       31                                            S01117 CGL029
0612 O                         DACD      36                               S01117
0613 O                         DACS      39                               S01117
0609 O*****                              35 '-   -    -'                  S01117
0610 O*****                    DCUS      25                               S01117
0611 O*****                    CCY       29                               S01117
0612 O*****                    DACD      34                               S01117
0613 O*****                    DACS      37                               S01117
     O                                   50 'CR CUST NO'                                      CGL029
     O                 88                77 '-      -   -          -'                         CGL029
     O                N88                77 '       -   -          -'                         CGL029
     O                 88      CBRC      54                                                   CGL029
     O                         CCUS      61                                                   CGL029
     O                         CCY       65                                                   CGL029
0614 O**********                         55 'CR. CUSTOMER NO'                                 CGL029
0615 O**********       88                77 '-      -   -    -'                        S01117 CGL029
0615 O**********      N88                77 '       -   -    -'                        S01117 CGL029
0616 O**********       88      CBRC      60                                            S01117 CGL029
0616 O**********               CCUS      67                                            S01117 CGL029
0617 O**********               CCY       71                                            S01117 CGL029
0618 O                         CACD      76                               S01117
0619 O                         CACS      79                               S01117
0615 O*****                              75 '-   -    -'                  S01117
0616 O*****                    CCUS      65                               S01117
0617 O*****                    CCY       69                               S01117
0618 O*****                    CACD      74                               S01117
0619 O*****                    CACS      77                               S01117
0620 O                                   93 'FIRST PAYMENT'
0621 O                         DFPYA    105
0622 O                    50   AFPY0    123 ' ,   ,   ,   , 0 '
0623 O                    51   AFPY1    125 '   ,   ,   , 0 . '
0624 O                    52   AFPY2    126 '  ,   ,   , 0 .  '
0625 O                    53   AFPY3    127 ' ,   ,   , 0 .   '
0626 O*****   D  1     01                                                 S01117
0626 O        D  1     01 20                                              S01117
0627 O**********                         17 'DR. CUSTOMER NAME'                               CGL029
     O                                   16 'DR CUSTOMER NAME'                                CGL029
0628 O                         DCRNM     39
0629 O**********                         57 'CR. CUSTOMER NAME'                               CGL029
     O                                   56 'CR CUSTOMER NAME'                                CGL029
0630 O                         CRNM      79
0631 O                                   94 'SECOND PAYMENT'
0632 O                         DSPYA    105
0633 O                    50   ASPY0    123 ' ,   ,   ,   , 0 '
0634 O                    51   ASPY1    125 '   ,   ,   , 0 . '
0635 O                    52   ASPY2    126 '  ,   ,   , 0 .  '
0636 O                    53   ASPY3    127 ' ,   ,   , 0 .   '
0637 O*****   D  1     01                                                 S01117
0637 O        D  1     01 20                                              S01117
0638 O**********            N21          17 'DR. RETAIL ACC NO'                               CGL029
     O                      N21          16 'DR RETAIL ACC NO'                                CGL029
0639 O                      N21DRAN      29
0640 O**********            N22          57 'CR. RETAIL ACC NO'                               CGL029
     O                      N22          56 'CR RETAIL ACC NO'                                CGL029
0641 O                      N22CRAN      69
0642 O                                   93 'FINAL PAYMENT'
0643 O                N10      DLPYA    105
0644 O                    50   ALPY0    123 ' ,   ,   ,   , 0 '
0645 O                    51   ALPY1    125 '   ,   ,   , 0 . '
0646 O                    52   ALPY2    126 '  ,   ,   , 0 .  '
0647 O                    53   ALPY3    127 ' ,   ,   , 0 .   '
0637 O*****   D  1     01                                                 S01117
0637 O        D  1     01 20                                              S01117
0649 O                                    8 'CURRENCY'
0650 O                         CCY       22
0651 O                                   50 'PAYEE NAME'
0652 O                         PNAM      79
0653 O                                   95 'PAYEE REFERENCE'
0654 O                         PAYR     119
0637 O*****   D  1     01                                                 S01117
0637 O        D  1     01 20                                              S01117
0656 O                                   17 'PAYMENT REFERENCE'
0657 O                         STOR      24
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOP7                                           S01408
     O*                                                                   S01408
0658 O                                   56 'PAYEE ACCOUNT NO'
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOP9                                           S01408
     O*                                                                   S01408
0659 O                         PAYA      69
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOP5                                           S01408
     O*                                                                   S01408
0660 O                                   89 'NARRATIVE'
0661 O                         PNAR     129
     O/COPY WNCPYSRC,RE0330O001
0637 O*****   D  1     01                                                 S01117
0637 O        D  1     01 20                                              S01117
0663 O                                   17 'PAYMENT FREQUENCY'
0664 O                    58             24 'DAILY'
0665 O                    59             25 'WEEKLY'
0666 O                    60             29 '15 AND LCD'
0667 O                    61             30 'FORTNIGHTLY'
0668 O                    62             26 'MONTHLY'
0669 O                    63             29 'LD MONTHLY'
0670 O                    64             30 'LWD MONTHLY'
0671 O********************65             30 'MONTHLY B/A'                 088447
     O                    65             34 'ON ACCRUAL DATE'             088447
0672 O***********         66             27 'ON DEMAND'                   E16122
0672 O                    66             38 '6 DAYS PRIOR TO EOM'         E16122
0673 O                    67             27 'QUARTERLY'
0674 O                    68             30 'SIX MONTHLY'
0675 O                    69             29 'BI-MONTHLY'
0676 O                    70             25 'YEARLY'
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOP8                                           S01408
     O*                                                                   S01408
0677 O                                   50 'PAYEE BANK'
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OP10                                           S01408
     O*                                                                   S01408
0678 O                         PAYB1     79
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOP6                                           S01408
     O*                                                                   S01408
0679 O                                   91 'LAST CHANGE'
0680 O                         LCDA     105
0681 O                                  113 'TYPE'
0682 O                    55            125 'INSERT'
0683 O                    56            124 'AMEND'
0684 O                    57            125 'DELETE'
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOPG                                           S01408
     O*                                                                   S01408
0685 O*****   D  3     01                                                 S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOP4                                           S01408
     O*                                                                   S01408
0637 O        D  3     01 20                                              S01117
0686 O                                   14 'PAYMENT METHOD'
0687 O                    71             34 'CREDIT TRANSFER'
0688 O                    72             24 'DRAFT'
0689 O                    73             24 'TELEX'
0690 O                    74             27 'INTERNAL'
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOP1                                           S01408
     O*                                                                   S01408
0691 O                         PAYB2     79
     O                    84             93 'PROFIT CENTRE'               S01117
     O                    84   PRFC     103                               S01117
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOP2                                           S01408
     O*                                                                   S01408
     O                    15            113 'TR.TYPE'                     S01466
     O                    15   TRAT     125                               S01466
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0330OOP3                                           S01408
     O*                                                                   S01408
0692 O********NO*LIVE RECORDS ON FILE - PRINT HEADINGS AT LR TIME         S01117
0693 O********T**203   LRN76                                              S01117
0694 O***********                        25 'REFERENCE RE0330'            S01117
0695 O***********              TITL      92                               S01117
0696 O***********                       104 'DATE'                        S01117
0697 O***********              RUNA     113                               S01117
0698 O***********                       122 'PAGE'                        S01117
0699 O***********              PAGE  Z  127                               S01117
0700 O********T**1     LRN76                                              S01117
0701 O***********         U2             40 'PARTIAL'                     S01117
0702 O***********            U1          49 'INTERIM'                     S01117
0703 O***********                        73 'LIST OF STANDING ORDERS'     S01117
0704 O***********            U1MTIME     82 '  .  .  '                    S01117
0705 O********T**2     LRN76                                              S01117
0701 O***********         U2             40 '-------'               E15787S01117
0706 O***********            U1          49 '*******'                     S01117
0707 O***********                        73 '-----------------------'     S01117
0708 O***********            U1          82 '********'                    S01117
0709 O***********                                                         S01117
0710 O********T** 20   LRN77                                              S01117
0710 O        T   20   L1N77NU7                                           S01117
0710 O       AND       20                                                 S01117
0711 O                                   71 '*** NO DETAILS TO REPORT'
0712 O                                   75 ' ***'
0714 O***     BRANCH TOTALS PRINTED ONLY IF THERE ARE LIVE RECORDS
0715 O*****   T 32     L1 77                                              S01117
0715 O        T 32     L1 77 20                                           S01117
     O       AND       88                                                 S01117
0716 O                                   60 'BRANCH TOTALS'
0717 O*****   T        L1 77                                              S01117
0717 O        T        L1 77 20                                           S01117
     O       AND       88                                                 S01117
0718 O                                   63 'NUMBER OF ACTIVE'
0719 O                                   79 'STANDING ORDERS'
0720 O                         BRTOT 3B  85
0786 O******* T   45   LR                                                 S01117
0787 O*******                            72 '*** END OF REPORT ***'       S01117
     O        T 32     L1 U7 20                                           S01117
     O                                   74 '*** DATABASE ERROR ***'      S01117
     O        T 3      L1 20                                              S01117
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRCA      77                               S01117
     O                 88                81 ' ***'                        S01117
     O                N88                76 '*** END OF REPORT ***'       S01117
     O*                                                                   S01117
     O*  NO DETAILS OUTPUT                                                S01117
     O*                                                                   S01117
     O        E  203           NODTL                                      S01117
     O                                   25 'REFERENCE RE0330P1'          S01117
     O                         TITL      92                               S01117
     O                                  104 'DATE'                        S01117
     O                         RUNA     113                               S01117
     O                                  122 'PAGE'                        S01117
     O                         PAGE  Z  127                               S01117
     O        E  1             NODTL                                      S01117
     O                    U2             40 'PARTIAL'                     S01117
     O                       U1          49 'INTERIM'                     S01117
     O                                   73 'LIST OF STANDING ORDERS'     S01117
     O                       U1MTIME     82 '  .  .  '                    S01117
     O                 88 U1             92 'BRANCH'                      S01117
     O                 88 U1   BRNCH     96                               S01117
     O                 88 U1N89          97 '-'                           S01117
     O                 88 U1N89BRNM     127                               S01117
     O                 88NU1             83 'BRANCH'                      S01117
     O                 88NU1   BRNCH     87                               S01117
     O                 88NU1N89          88 '-'                           S01117
     O                 88NU1N89BRNM     118                               S01117
     O        E  2             NODTL                                      S01117
     O                    U2             40 '-------'                     S01117
     O                       U1          49 '*******'                     S01117
     O                                   73 '-----------------------'     S01117
     O                       U1          82 '********'                    S01117
     O        E   20           NODTL                                      S01117
     O                                   71 '*** NO DETAILS TO REPORT'    S01117
     O                                   75 ' ***'                        S01117
     O        E 3              NODTL                                      S01117
     O                 88                66 '*** END OF REPORT FOR'       S01117
     O                 88                74 ' BRANCH '                    S01117
     O                 88      BRNCH     77                               S01117
     O                 88                81 ' ***'                        S01117
     O                N88                76 '*** END OF REPORT ***'       S01117
0721 O**      FILE CONTROLS
0722 O*****   T  203   LR                                                 S01117
0722 ORE0330AUT  203   LR                                                 S01117
0723 O*****                              25 'REFERENCE RE0330'            S01117
0723 O                                   25 'REFERENCE RE0330AU'          S01117
0724 O                         TITL      92
0725 O                                  104 'DATE'
0726 O                         RUNA     113
0727 O                                  122 'PAGE'
0728 O*****                    PAGE  Z  127                               S01117
0728 O                         PAGE1 Z  127                               S01117
0729 O        T  1     LR
0730 O                    U2             40 'PARTIAL'
0731 O                       U1          49 'INTERIM'
0732 O                                   73 'LIST OF STANDING ORDERS'
0733 O                       U1MTIME     82 '  .  .  '
     O                      NU1          89 'RUN CONTROLS'                S01117
     O                       U1          98 'RUN CONTROLS'                S01117
0734 O        T  2     LR
0701 O                    U2             40 '-------'                     E15787
0735 O                       U1          49 '*******'
0736 O                                   73 '-----------------------'
0737 O                       U1          82 '********'
0738 O        T  215   LR
0739 O                                   39 'END OF REPORT TOTALS'
0740 O        T  1     LR
0741 O                                   39 'NUMBER OF INSERTIONS'
0742 O                         NSOI  3   56
0743 O                                   84 'VALUE OF INSERTIONS'
0744 O                         VSID     119 '0   '
0745 O                         VSIW  Z  116
0746 O        T  1     LR
0747 O                                   39 'NUMBER OF AMENDMENTS'
0748 O                         NSOA  3   56
0749 O                                   84 'VALUE OF AMENDMENTS'
0750 O                         VSAD     119 '0   '
0751 O                         VSAW  Z  116
0752 O        T  3     LR
0753 O                                   38 'NUMBER OF DELETIONS'
0754 O                         NSOD  3   56
0755 O                                   83 'VALUE OF DELETIONS'
0756 O                         VSDD     119 '0   '
0757 O                         VSDW  Z  116
0758 O        T  1     LR
0759 O                                   28 'NUMBER OF'
0760 O                                   50 'RECORDS BEFORE UPDATE'
0761 O                         NOSO  3   56
0762 O                                   81 'VALUE OF RECORDS'
0763 O                                   95 'BEFORE UPDATE'
0764 O                         VSDC     119 '0   '
0765 O                         VSWN  Z  116
0766 O        T  2     LR
0767 O                                   28 'NUMBER OF'
0768 O                                   49 'RECORDS AFTER UPDATE'
0769 O                         NSAU  3   56
0770 O                                   81 'VALUE OF RECORDS'
0771 O                                   94 'AFTER UPDATE'
0772 O                         VSUD     119 '0   '
0773 O                         VSUW  Z  116
0774 O        T  2     LR 44
0775 O       OR        LR 45
0776 O                                   25 'CALCULATED - NUMBER'
0777 O                                   49 'OF RECORDS AFTER UPDATE'
0778 O                         NAFTUP3   56
0779 O                                   81 'VALUE OF RECORDS'
0780 O                                   94 'AFTER UPDATE'
0781 O                         ZZTOTD   119 '0   '
0782 O                         ZZTOTIZ  116
0783 O        T  2     LR
0784 O                       44          54 '***  DIFFERENCE  ***'
0785 O                       45         119 '***  DIFFERENCE  ***'
     O*                                                                   S01117
     O*  DATABASE ERROR OUTPUT                                            S01117
     O*                                                                   S01117
     O        T 32     LR U7                                              S01117
     O                                   58 'DATABASE ERROR '             S01117
     O                         DBASE     61                               S01117
     O                                   75 'IN PROGRAM '                 S01117
     O                         DBPGM     85                               S01117
     O        T  2     LR U7                                              S01117
     O                                   48 'FILE '                       S01117
     O                         DBFILE    56                               S01117
     O                                   62 ', KEY '                      S01117
     O                         DBKEY     91                               S01117
     O*                                                                   S01117
     O*  NO DETAILS OUTPUT                                                S01117
     O*                                                                   S01117
     O        T 3      LR 86                                              S01117
     O                                   70 '***   NO DETAILS TO REPO'    S01117
     O                                   78 'RT   ***'                    S01117
0786 O*****   T   45   LR                                                 S01117
0787 O*****                              72 '*** END OF REPORT ***'       S01117
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
