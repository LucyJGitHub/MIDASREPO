     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Interest details audit and list')             *
0001 H***********
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Retail Module
0005 F*                                                               *
0006 F*  RE0510 - INTEREST DETAILS AUDIT AND LIST - S/REINT           *
0007 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*      1990                                                     *
0009 F*                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 CRE083BQ           Date 06Aug12               *
      *                 CER055             Date 06Dec10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 S01408             Date 12Sep96               *
      *                 S01413             Date 13Apr93               *
     F*                 S01117                  11OCT89               *
     F*                 S01127                  17AUG87               *
0010 F*                 E11279                  30JUL87               *
0011 F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  CRE083BQ - COB Restructure - RE COB Optimisation Phase 1     *
      *  CER055 - Penalty Interest on Exceeding Overdraft Limit       *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  S01408  -  Addition of core hook RE0510OOP2                  *
     F*          -  Addition of core hook RE0510OOP1                  *
     F*          -  Addition of core hook RE0510IIP1                  *
     F*          -  Addition of core hook RE0510CCP4                  *
     F*          -  Addition of core hook RE0510CCP3                  *
     F*          -  Addition of core hook RE0510CCP2                  *
     F*          -  Addition of core hook RE0510CCP1                  *
     F*  S01413 - Retail 3 Incorporation                              *
     F*  S01117 - Multibranching                                      *
     F*  S01127 - FF Module allows 'MARGIN' in first balance          *
     F*  E11279 - Array for currencies too small                      *
     F*                                                               *
0012 F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0014 FREINT   UF  F     320 12AI     2 DISK
0015 F***TABLE** IF  F      96 12AI     2 DISK                                                CGL029
0015 FTABLE   IF  F     126 12AI     2 DISK                                                   CGL029
0017 F*E0510P1O** F     132     OF     PRINTER                      S01124S01117
0017 FRE0510AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0017 FRE0510P1O   F     132     OF     PRINTER      KINFDS SPOOL          S01117
0018 F*
0019 F*       U8      FILE OUT OF BALANCE
0020 F*       U7      DATABASE ERROR
0021 F*       89      MASTER FILE - HEADER
0022 F*       88      MASTER FILE - TRAILER
0023 F*       87      MASTER FILE - DETAIL RECORD -CORRECT RECORD TYPE-
0025 F*       85      FIRST CYCLE IND.
0026 F*       84      PRINT THIS DETAIL RECORD
0027 F*       83      PRINT HEADINGS
0028 F*       82      NO INPUT TODAY
0029 F*       81      AUDIT REPORT WITH NO INPUT TODAY -U1 AND 82-
0030 F*       80      UPDATE TRAILER BY EXCEPTION OUTPUT
0031 F*       79      FILE OUT OF BALANCE - NUMBER OF ACTIVE RECORDS
0032 F*       78      FILE OUT OF BALANCE - LIVE RECORDS AFTER INPUT
0033 F*       77      LISTING REPORT WITH NO DETAILS TO REPORT
0034 F*       76      SPARE
0035 F*       75      ACTIVE DETAIL RECORD READ - RECI NOT *
0036 F*       74      LIVE DETAIL RECORD READ - RECI IS D AND CHTP NOT D
0037 F*       73      DETAIL RECORD UPDATED TODAY - LCD EQUALS RUN DATE
0038 F*       72      CURRENCY RECORD ON TABLE  FILE
0039 F*       71      TABLE  CATCHALL
     F*       70      ICD RECORD ON TABLE FILE
0040 F*       63      CURRENCY HAS 3 DECIMAL PLACES
0041 F*       62      CURRENCY HAS 2 DECIMAL PLACES
0042 F*       61      CURRENCY HAS 1 DECIMAL PLACE
0043 F*       60      CURRENCY HAS 0 DECIMAL PLACES
     F*       52      VALUE DATE ZERO
     F*       51      RATE/SPREAD NEGATIVE
     F*       50      RATE/SPREAD POSITIVE
0044 F*       35      BASE RATE ZERO , NOT OUTPUT TO REPORT
0045 F*       34      PREVIOUS VALUE DATE VALID,NON-BLANK ENTRY ON REPORT
0046 F*       33      OVERFLOW IND. FOR EXCEPTION OUTPUT
0047 F*       32      BLANK RATE/SPREAD , LEVEL 0
0048 F*       31      LEVEL ZERO EXCEPTION OUTPUT
0049 F*       30      OTHER LEVELS EXCEPTION OUTPUT INDICATOR.
0050 F*       24      SUB-TYPE 04 / THRESHOLD,MMB
0051 F*       23               03 / TIERED,MMB
0052 F*       22               02 / THRESHOLD
0053 F*       21               01 / TIERED
     F*       55      CER055 IS INSTALLED                                                     CER055
     F*       53      ALLOW OVERDRAFT                                                         CER055
0054 F*
0055 E*    STANDARD TABLES/ARRAYS
0056 E*
0057 E*    RN/RW/RD,1 ARE COUNT/HASH OF ACTIVE RECORDS
0058 E*    RN/RW/RD,2 ARE COUNT/HASH OF LIVE RECORDS
0059 E*    RN,3 IS COUNT OF RECORDS UPDATED TODAY. RW/RD,3 ARE NOT USED
0060 E*    RN/RW/RD,4 ARE COUNT/HASH OF LIVE RECORDS CALCULATED FROM TRLR
0061 E                    RN          4  5 0
0062 E                    RW          4 15 0
0063 E                    RD          4  3 0
0064 E*    ARRAYS OF CURRENCY CODES, NAMES AND DECIMAL PLACES.
0065 E*    NAMES REMOVED UNLESS REQUIRED, TO SAVE SPACE.
0066 E********************ACCY       99  3                                E11279
0067 E******************  ACNM       99 14
0068 E********************ACDP       99  1 0                              E11279
     E                    ACCY      150  3                                E11279
     E                    ACDP      150  1 0                              E11279
0069 E*    ARRAYS OF COUNTS AND HASH TOTALS IN THE MASTER FILE TRAILER
0070 E                    NR          5  5 0
0071 E                    WN          5 15 0
0072 E                    DC          5  3 0
0073 E*
0074 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0075 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0076 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
0077 E*    NON-STANDARD TABLES/ARRAYS
0078 E                    MBAL       11 15 0             BALANCES
0079 E                    MBLA       11  8               ALPHA BALS
0080 E                    MRAT       11 11 7             RATES/SPREADS
0081 E                    MRTA       11  6               ALPHA RATES
0082 E                    WLEV   10  10  2 0             WORK LEVELS
     E                    CPY@    1   1 80
0083 I*    STANDARD FILES
0084 I*
0085 I*    MASTER FILE - HEADER
0086 I*
0087 IREINT   NS  89   1 CA
0118 I*
0119 I*    MASTER FILE - TRAILER
0120 I*
0121 I        NS  88   1 CZ
0122 I                                        1   1 RECI
0123 I                                    P  31  330TNLU
0124 I                                       34  34 IRRI
0125 I                                    P  35  49 NR
0126 I                                    P  50  89 WN
0127 I                                    P  90  99 DC
0092 I*
0093 I*    MASTER FILE - DETAIL
0094 I*
0095 I        NS  87  13 CD
0096 I                                        1   1 MRECI
0097 I                                        3   40MTYP
0098 I                                        5   90MSTP
0099 I                                       10  12 MCCY
0100 I                                       13  13 MRECT
0101 I                                    P  31  330MTNLU
0102 I                                    P  34  360MORED
0103 I                                    P  37  390MLCD
0104 I                                       40  40 MCHTP
0105 I                                    P  41  470MHASH
0106 I                                       48  77 MINNM
0107 I                                    P  78 165 MBAL
0108 I                                       78 165 MBLA
0109 I                                    P 166 231 MRAT
0110 I                                      166 231 MRTA
0111 I                                      232 233 MBRT
0112 I                                    P 254 2610MINTH
0113 I                                    P 262 2640MVDTC
0114 I                                    P 265 2670MVDPC
0128 I*
0129 I*    CATCHALL
0130 I        NS
0131 I*
0132 I*    TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.
0133 I*
0134 ITABLE   NS  70   2 C0   3 C1  12 C1
0135 I       AND      13 C0
     I                                        1   1 RECI
0136 I                                        2   30RECT
0137 I                                       12  130RCDE
0138 I                                       14  66 TITL
0139 I***********                            67  67 DATF                  S01117
0140 I                                       68  700DFBR
0141 I                                       74  74 MODI1
0142 I                                       75  75 MODI2
0143 I                                       76  76 MODI3
0144 I***********                         P  77  790RUND                  S01117
0145 I***********                            80  86 RUNA                  S01117
0146 I                                       87  870SFLG
0147 I                                    P  90  920LCD
0148 I                                       93  93 CHTP
0149 I                                    P  94  960TNLU
0150 I*
0151 I*    TABLE FILE - CURRENCIES RECORD 1.
0152 I*
0153 ITABLE   NS  72   2 C2   3 C0
     I                                        1   1 RECI
0155 I                                        2   30RECT
0156 I                                       10  12 CCY
0157 I                                       13  130SREC
0158 I                                       14  27 CCNM
0159 I                                    P  28  348SPOT
0160 I                                       35  37 CCYS
0161 I                                       38  380CDP
0162 I                                       39  390TNOT
0163 I                                       40  40 DCCY
0164 I                                       41  44 SRC1
0165 I                                       45  48 SRC2
0166 I**********                             49  520TACC                                      CGL029
0167 I**********                             53  560TEQV                                      CGL029
0168 I**********                             57  600SWQV                                      CGL029
0169 I**********                             61  640TAC4                                      CGL029
0170 I**********                             65  680TAC5                                      CGL029
0171 I**********                             69  69 HIND                                      CGL029
0172 I**********                          P  70  768PART                                      CGL029
0173 I**********                             77  780SSNO                                      CGL029
0174 I**********                          P  79  858ERLC                                      CGL029
0175 I**********                             86  860MDIN                                      CGL029
0176 I**********                             87  870MDIA                                      CGL029
0177 I**********                             88  880MDIB                                      CGL029
0178 I**********                          P  90  920LCD                                       CGL029
0179 I**********                             93  93 CHTP                                      CGL029
0180 I**********                          P  94  960TNLU                                      CGL029
     I                                       49  580TACC                                      CGL029
     I                                       59  680TEQV                                      CGL029
     I                                       69  780SWQV                                      CGL029
     I                                       79  880TAC4                                      CGL029
     I                                       89  980TAC5                                      CGL029
     I                                       99  99 HIND                                      CGL029
     I                                    P 100 1068PART                                      CGL029
     I                                      107 1080SSNO                                      CGL029
     I                                    P 109 1158ERLC                                      CGL029
     I                                      116 1160MDIN                                      CGL029
     I                                      117 1170MDIA                                      CGL029
     I                                      118 1180MDIB                                      CGL029
     I                                    P 120 1220LCD                                       CGL029
     I                                      123 123 CHTP                                      CGL029
     I                                    P 124 1260TNLU                                      CGL029
0181 I*
0182 I*    CATCHALL
0183 I        NS  71
     I                                        1   1 RECI
     I                                        2   30RECT
     I                                       13  130SREC
0184 I*
0185 I*    DATA STRUCTURE FOR TABLE FILE KEY
0186 I*
0187 I            DS
0188 I                                        1  12 TABKEY
0189 I                                        1   2 TAB2
0190 I                                        9  11 TAB3A
0191 I                                       10  12 TAB3B
0192 I                                        9  12 TAB4
0193 I                                       12  12 TAB1
0194 I                                        6  11 TAB6
0925 I**                                                                  S01117
0925 I**   FILE INFORMATION DATA STRUCTURE                                S01117
0925 I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
0195 I*
0196 I*    STANDARD LOCAL DATA AREA FIELDS
0197 I*
0198 ILDA        UDS                            256
0199 I***********                           134 138 LFILE                 S01117
0200 I***********                           139 167 LKEY                  S01117
0201 I***********                           168 175 LPROG                 S01117
0202 I***********                           176 1770LDBNO                 S01117
0199 I                                      134 141 LFILE                 S01117
0200 I                                      142 170 LKEY                  S01117
0201 I                                      171 180 LPROG                 S01117
0202 I                                      181 1830LDBNO                 S01117
0232 I                                      134 141 DBFILE                S01117
0233 I                                      142 170 DBKEY                 S01117
0234 I                                      171 180 DBPGM                 S01117
0235 I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
      *                                                                   S01408
     IDSFDY     E DSDSFDY                                                                     CER055
      ** First DS for access programs, Short data structure                                   CER055
     ISCSARD    E DSSCSARDPD                                                                  CER055
      ** Switchable SARs                                                                      CER055
      *                                                                                       CER055
     I/COPY WNCPYSRC,RE0510IIP1                                           S01408
      *                                                                   S01408
     C                     MOVEACPY@      BIS@   80
     C**                                                                  S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C********** *LOCK     IN   LDA                                                  S01117 CRE083BQ
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NO.  S01117
0203 C*  INITIALISE TO -PRINT NO HEADINGS- AND -PRINT NO DETAILS-
0204 C*
0205 C                     SETOF                     8384
0206 C*
      *                                                                                       CER055
      ***Check*if*CER055*feature*is*installed**************************              CER055 CRE083BQ
      *                                                                                       CER055
     C**********           CALL 'AOSARDR0'                                           CER055 CRE083BQ
     C**********           PARM *BLANKS   @RTCD   7                                  CER055 CRE083BQ
     C**********           PARM '*VERIFY' @OPTN   7                                  CER055 CRE083BQ
     C**********           PARM 'CER055'  @SARD   6                                  CER055 CRE083BQ
     C********** SCSARD    PARM SCSARD    DSFDY                                      CER055 CRE083BQ
      *                                                                                       CER055
     C********** @RTCD     IFEQ *BLANKS                                              CER055 CRE083BQ
     C**********           MOVE *ON       *IN55                                      CER055 CRE083BQ
     C**********           ELSE                                                      CER055 CRE083BQ
     C**********           MOVE *OFF      *IN55                                      CER055 CRE083BQ
     C**********           END                                                       CER055 CRE083BQ
      *                                                                                       CER055
0207 C  N85                EXSR FIRSTC
     C  N85      *LOVAL    SETLLREINT
0208 C                     SETON                     85
     C                     READ REINT                    99
     C   99                SETON                     LR
     C   99                GOTO LASTR
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0510CCP3                                           S01408
      *                                                                   S01408
0209 C           MTYP      COMP 2                      2122
0210 C           MTYP      COMP 3                    24  23
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0510CCP2                                           S01408
      *                                                                   S01408
0211 C*
0212 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR
0213 C*  AN AUDIT REPORT, GOTO LR PROCESSING.
0214 C*
0215 C   U7
0216 COR U1 82             GOTO LASTR
0217 C*
0218 C*  IF HEADER OR TRAILER READ, GOTO LR PROCESSING
0219 C*
0220 C   89
0221 COR 88                GOTO LASTR
0222 C*
0223 C*  IF INCORRECT - WRONG RECORD TYPE - DETAIL
0224 C*  RECORD READ, GOTO LR PROCESSING
0225 C*
0226 C  N87                GOTO LASTR
0227 C*
0228 C*  PROCESSING NOW CONSISTS OF RUN CONTROLS, RECORD FORMATTING
0229 C*  FOR OUTPUT AND PRINTING THE RECORD.
0230 C*
0231 C*
0232 C*  RUN CONTROLS - AUDIT AND LIST CONTROLS ARE
0233 C*  MAINTAINED UNCONDITIONALLY
0234 C*
0235 C*  IF THERE IS NO HASH TOTAL FIELD ON THE MASTER FILE DETAIL RECORD,
0236 C*  THEN ZEROISE AND CONTINUE AS IF THERE IS.
0237 C*
0238 C                     Z-ADD0         MHASH  130
0239 C*
0240 C*  COUNT ACTIVE RECORDS READ - RECI NOT *
0241 C*  MOVE HASH AMOUNT INTO ZZAMT FIRST.
0242 C*
0243 C                     MOVE MHASH     ZZAMT
0244 C*
0245 C           MRECI     COMP '*'                  7575
0246 C   75                Z-ADD1         H
0247 C   75                EXSR NPZTOT
0248 C*
0249 C*  COUNT LIVE RECORDS READ - RECI IS D AND CHTP IS NOT D
0250 C*
0251 C           MRECI     COMP 'D'                      74
0252 C   74      MCHTP     COMP 'D'                  7474
0253 C   74                Z-ADD2         H
0254 C   74                EXSR NPZTOT
0255 C*
0256 C*  COUNT RECORDS UPDATED TODAY - LCD IS RUN DATE
0257 C*
0258 C           MLCD      COMP RUND                     73
0259 C   73      RN,3      ADD  1         RN,3
0260 C*
0261 C*  IF AUDIT REPORT, RECORDS UPDATED TODAY ARE PRINTED.
0262 C*  IF LISTING, LIVE RECORDS ARE PRINTED.
0263 C*  SET ON 84 IF THE RECORD IS TO BE PRINTED.
0264 C*
0265 C   U1 73
0266 CORNU1 74   MTYP      COMP WETYP                8383
0267 C   83                MOVE MTYP      WETYP   20
0268 C   U1 73
0269 CORNU1 74             SETON                       84
0270 C*
0271 C*  FORMAT THE RECORD IF IT IS TO BE PRINTED
0272 C*
0273 C   84                EXSR FORMT
0274 C*
0275 C   84                EXSR EXCPT
0276 C*
0277 C   84 U7             GOTO LASTR
0278 C*
0280 C           LASTR     TAG                             ** LASTR TAG
0281 C*
0282 CLR                   TIME           MTIME
0283 C*
0284 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR
0285 C*  AN AUDIT REPORT, NO FILE CONTROL CHECK DONE.
0286 C*
0287 CLR U7
0288 COR U1 82             GOTO END
0289 C*
0290 C*  FOR LIST, TEST FOR NO DETAILS TO REPORT
0291 C*
0292 CLRNU1      RN,2      COMP 0                        77
     CLRNU1 77             SETON                     8331                 S01117
0293 C*
0294 C*  TEST FOR ALL ACTIVE RECORDS READ - COUNT AND HASH
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0510CCP4                                           S01408
      *                                                                   S01408
0295 C*
0296 CLR         RN,1      COMP NR,1                 7979
0297 CLRN79      RW,1      COMP WN,1                 7979
0298 CLRN79      RD,1      COMP DC,1                 7979
0299 CLR 79                SETON                     U8
0300 C*
0301 C***IF*LISTING REPORT, GOTO END                                      S01117
0302 C***********                                                         S01117
0303 C*RNU1******          GOTO END                                       S01117
0301 C*  IF LISTING REPORT, GOTO END01                                    S01117
0302 C*                                                                   S01117
0303 CLRNU1                GOTO END01                                     S01117
0304 C*
0305 C*  CALCULATE NUMBER OF LIVE RECORDS FROM TRAILER
0306 C*
0307 CLR         NR,2      ADD  NR,3      RN,4
0308 CLR         RN,4      SUB  NR,5      RN,4             ** TOTAL
0309 C*
0310 C*  CALCULATE HASH TOTAL OF LIVE RECORDS AFTER INPUT FROM TRAILER
0311 C*
0312 C*  PUT HASH OF LIVE RECORDS BEFORE INPUT INTO ZZ FIELDS
0313 C*
0314 CLR                   Z-ADDWN,2      ZZTOTI
0315 CLR                   Z-ADDDC,2      ZZTOTD
0316 C*
0317 C*  ADD HASH OF INSERTED RECORDS
0318 C*
0319 CLR                   Z-ADDWN,3      ZZAMTI
0320 CLR                   Z-ADDDC,3      ZZAMTD
0321 CLR                   EXSR GLZSUM
0322 C*
0323 C*  ADD HASH OF AMENDMENTS
0324 C*
0325 CLR                   Z-ADDWN,4      ZZAMTI
0326 CLR                   Z-ADDDC,4      ZZAMTD
0327 CLR                   EXSR GLZSUM
0328 C*
0329 C*  SUBTRACT HASH OF DELETIONS
0330 C*
0331 CLR                   Z-SUBWN,5      ZZAMTI
0332 CLR                   Z-SUBDC,5      ZZAMTD
0333 CLR                   EXSR GLZSUM
0334 C*
0335 CLR                   MOVE ZZTOTI    RW,4
0336 CLR                   MOVE ZZTOTD    RD,4
0337 C*
0338 C*  COMPARE PROGRAM'S COUNT AND HASH OF LIVE RECORDS
0339 C*  READ WITH THOSE JUST CALCULATED.
0340 C*
0341 CLR         RN,2      COMP RN,4                 7878
0342 CLRN78      RW,2      COMP RW,4                 7878
0343 CLRN78      RD,2      COMP RD,4                 7878
0344 CLR 78                SETON                     U8
0345 C*
0346 C*  IF DATABASE ERROR, GOTO END
0347 C*
0348 CLR U8                GOTO END
0349 C*
0350 C*  UPDATE CHAIN TO THE TRAILER
0351 C*
0352 CLR                   SETOF                     9988
0353 CLR         TRLRKY    CHAINREINT                99
0354 CLRN99
0355 CAN 88                GOTO END01
0356 CLR                   SETON                     U7    ** DB ERROR 92
0357 CLR                   MOVELTRLRKY    LKEY
0358 CLR                   Z-ADD92        LDBNO
0359 CLR                   GOTO END
0360 C*
0361 CLR         END01     TAG                             ** END01 TAG
0362 C*
0363 C*  UPDATE THE TRAILER - IND 88 PERFORMS OUTPUT
0364 C*
0365 CLR                   EXCPT
0366 C*
0367 CLR         END       TAG                             ** END TAG
0368 C*
     C**                                                                  S01117
     C*  PRINT HEADING ON P1 AUDIT REPORT IF NO INPUT TODAY               S01117
     C**                                                                  S01117
     CLR                   SETOF                     88                   S01117
     CLR 82 U1             SETON                     3183                 S01117
     CLR 82 U1             EXCPT                                          S01117
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     C***LR*****              OUT  LDA                                               S01117 CRE083BQ
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    SENTY                           S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR   1                       S01117
     C***LR*****    *LOCK     IN   LDA                                               S01117 CRE083BQ
      *                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     C**   ENSURE TOTALS SPOOL FILE RECORDED BY RCF                       S01117
     C*                                                                   S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU                          S01117
     C***LR*****              OUT  LDA                                               S01117 CRE083BQ
      *                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANKS   SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU  60                      S01117
     CLR                   PARM           ZSERR   1                       S01117
     C***LR*****    *LOCK     IN   LDA                                               S01117 CRE083BQ
      *                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR U7                EXSR *PSSR                                     S01117
     C*                                                                   S01117
0369 C********************************************************************
0370 C**
0371 C**   SUBR. - TO PERFORM FIRST CYCLE PROCESSING.
0372 C**
0373 C           FIRSTC    BEGSR                           ***  FIRSTC ***
0374 C*
0375 C*  SET-UP LDA FIELDS
0376 C*
     C                     MOVE *BLANKS   DBFILE                          S01117
0377 C                     MOVE 'REINT'   LFILE
0378 C                     MOVE 'RE0510  'LPROG
0379 C*
0380 C*  SET-UP BLANK LKEY
0381 C*
0382 C                     MOVE ' '       BLK200200
0383 C                     MOVE BLK200    LKEY
0384 C*
0385 C*  SET-UP ZEROES
0386 C                     Z-ADD0         ZERO03  30
0387 C                     Z-ADD0         ZERO05  50
0388 C                     Z-ADD0         ZERO15 150
     C/COPY WNCPYSRC,RE0510C001
0389 C*
0390 C*  SET-UP TRAILER KEY
0391 C*
0392 C                     MOVEL'99999999'TRLRKY 12
0393 C                     MOVE '999D'    TRLRKY
     C*                                                                   S01117
     C*  IN RUNDAT                                                        S01117
     C*                                                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
0394 C*
0395 C*  EXECUTE ZSYSTM
0396 C*
0397 C                     EXSR ZSYSTM
0398 C  N99                GOTO TAG01
0399 C                     SETON                     U7LR  ** DB ERROR 90
0400 C                     MOVE 'TABLE'   LFILE
0401 C                     MOVELZTABKY    LKEY
0402 C                     Z-ADD90        LDBNO
0403 C                     GOTO ENDFC
0404 C*
0405 C           TAG01     TAG                             ** TAG01 TAG
0406 C*
0407 C*  CHAIN TO THE TRAILER
0408 C*
0409 C                     SETOF                     9988
0410 C           TRLRKY    CHAINREINT                99
0411 C  N99
0412 CAN 88                GOTO TAG02
0413 C                     SETON                     U7LR  ** DB ERROR 91
0414 C                     MOVELTRLRKY    LKEY
0415 C                     Z-ADD91        LDBNO
0416 C                     GOTO ENDFC
0417 C*
0418 C           TAG02     TAG                             ** TAG02 TAG
0419 C*
0420 C*  IF AUDIT REPORT AND NO INPUT TODAY, GOTO ENDFC
0421 C*
0422 C           IRRI      COMP ' '                      82
0423 C   U1 82             SETON                     LR81
0424 C   U1 82             GOTO ENDFC
0425 C*
0426 C*  OUTPUT HEADINGS - DELETED WHEN SUB-TYPE CHANGES ADDED TO PROG.
0427 C***********          SETON                     83
0428 C*
0429 C*  BUILD TABLE OF CURRENCY NAMES AND DECIMAL PLACES.
0430 C*  CCY NAMES REMOVED UNLESS REQUIRED, TO SAVE SPACE.
0431 C*
0432 C                     MOVE BLK200    TABKEY
0433 C                     MOVE '20'      TAB2
0434 C           TABKEY    SETLLTABLE
0435 C                     Z-ADD0         J       30
0436 C           ARC       TAG                             ** ARC TAG
0437 C                     SETOF                     727192
0438 C                     READ TABLE                    91
0439 C   71
0440 COR 91                GOTO ENDFC
0441 C           RECI      COMP 'D'                  9292
0442 C  N92      SREC      COMP 1                    9292
0443 C   92                GOTO ARC
0444 C           J         ADD  1         J
0445 C                     MOVE CCY       ACCY,J
0446 C*******************  MOVE CCNM      ACNM,J
0447 C                     MOVE CDP       ACDP,J
0448 C                     GOTO ARC
0449 C*
0450 C           ENDFC     TAG                             ** ENDFC TAG
0451 C*
0452 C                     TIME           MTIME   60
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0510CCP1                                           S01408
      *                                                                   S01408
0453 C*
      ** Check if CER055 feature is installed                                               CRE083BQ
      *                                                                                     CRE083BQ
     C                     CALL 'AOSARDR0'                                                  CRE083BQ
     C                     PARM *BLANKS   @RTCD   7                                         CRE083BQ
     C                     PARM '*VERIFY' @OPTN   7                                         CRE083BQ
     C                     PARM 'CER055'  @SARD   6                                         CRE083BQ
     C           SCSARD    PARM SCSARD    DSFDY                                             CRE083BQ
      *                                                                                     CRE083BQ
     C           @RTCD     IFEQ *BLANKS                                                     CRE083BQ
     C                     MOVE *ON       *IN55                                             CRE083BQ
     C                     ELSE                                                             CRE083BQ
     C                     MOVE *OFF      *IN55                                             CRE083BQ
     C                     END                                                              CRE083BQ
      *                                                                                     CRE083BQ
0454 C                     ENDSR
0455 C*
0456 C********************************************************************
0457 C**
0458 C**   SUBR. - TO FORMAT RECORD DETAILS PRIOR TO PRINTING
0459 C**
0460 C           FORMT     BEGSR                           ***  FORMT  ***
0461 C*
0462 C*  CHECK CURRENCY DECIMAL PLACES
0463 C*
0464 C                     SETOF                     606162
0465 C                     SETOF                     63
0466 C                     Z-ADD1         J       30
0467 C           MCCY      LOKUPACCY,J                   91
0468 C   91                GOTO FORMT1
0469 C                     SETON                     U7LR  ** DB ERROR 01
0470 C                     MOVE 'TABLE'   LFILE
0471 C                     MOVELMCCY      LKEY
0472 C                     Z-ADD1         LDBNO
0473 C                     GOTO FORMTE
0474 C*
0475 C           FORMT1    TAG                             ** FORMT1 TAG
0476 C*
0477 C           ACDP,J    COMP 1                    626061
0478 C   62      ACDP,J    COMP 2                    63  62
0479 C*
0480 C*    BASE RATE CHECK
0481 C*
0482 C           MBRT      COMP '  '                     35
0483 C**N35***** MBRT      COMP '00'                     35                                   CSD103
0484 C*
0485 C*  FORMAT VALUE DATE FOR THIS CHANGE
0486 C*
0487 C                     Z-ADDMVDTC     ZDAYNO
0488 C                     EXSR ZDATE2
0489 C                     MOVE ZDATE     WVDTC   60
0490 C*
0491 C*    FORMAT VALUE DATE FOR PREVIOUS DATE
0492 C*
0493 C                     Z-ADDMVDPC     ZDAYNO
0494 C                     EXSR ZDATE2
0495 C                     MOVE ZDATE     WVDPC   60
0496 C           WVDPC     COMP 0                    34
0497 C*
0498 C*  STANDARD FORMATTING - FORMAT LAST CHANGE DATE
0499 C*
0500 C                     Z-ADDMLCD      ZDAYNO
0501 C                     EXSR ZDATE2
0502 C                     MOVE ZADATE    WLCD    7
0503 C*
0504 C           FORMTE    ENDSR                           ** FORMTE TAG
0505 C*
0506 C********************************************************************
0507 C**   EXCPT - SUBROUTINE TO PERFORM EXCEPTION OUTPUT FOR DIFFERENT
0508 C*            LEVELS OF RATE/SPREAD
0509 C           EXCPT     BEGSR                           ** EXCPT **
0510 C*
0511 C                     Z-ADD0         N       20
0512 C                     Z-ADD1         M       20
0513 C           START     TAG                             ** START TAG **
0514 C           M         COMP 1                        31
0515 C   31      MRTA,1    COMP '      '                 32
     C                     SETOF                     5051
     C   31N32   MRAT,1    COMP 0                    5051
     C  N31      MRAT,M    COMP 0                    5051
     C           WVDTC     COMP 0                        52VALUE DATE ZERO
     C/COPY WNCPYSRC,RE0510C002
0516 C   83 31
0517 COR 33                SETOF                     OF33
0518 C   OF                SETON                     33
0519 C                     EXCPT
     C/COPY WNCPYSRC,RE0510C003
0520 C*
0521 C           N         ADD  1         N
0522 C           M         ADD  1         M
0523 C           M         COMP 11                   30
0524 C   30                GOTO ENDEX
0525 C           MBLA,M    COMP '        '               30
0526 C  N30      MBAL,M    COMP 0                        30
0526 C  N30      MBAL,M    COMP -1                       49               S01127
     C  N30 55   MBAL,M    COMP -2                       53                                   CER055
0527 C  N30                GOTO START
     C/COPY WNCPYSRC,RE0510C004
0528 C*
0529 C           ENDEX     ENDSR                           ** ENDEX **
0530 C*
     C/COPY WNCPYSRC,RE0510C005
0531 C********************************************************************
0532 C**
0533 C**   SUBR. - TO ADD 1 TO RN,H AND TO ADD ZZAMT TO RW/RD,H
0534 C**
0535 C           NPZTOT    BEGSR                           ***  NPZTOT ***
0536 C                     Z-ADDH         H       10
0537 C*
0538 C           RN,H      ADD  1         RN,H
0539 C*
0540 C                     Z-ADDRW,H      ZZTOTI
0541 C                     Z-ADDRD,H      ZZTOTD
0542 C                     EXSR GLZADD
0543 C                     Z-ADDZZTOTI    RW,H
0544 C                     Z-ADDZZTOTD    RD,H
0545 C*
0546 C                     ENDSR
0547 C********************************************************************
0548 C**
0549 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0550 C**
0551 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0552 C**
0553 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
0554 C                     MOVEL'01      'ZTABKY 12
0555 C                     MOVE '  10'    ZTABKY
0556 C**
0557 C           ZTABKY    CHAINTABLE                99    ON NOT THERE
0558 C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
0559 C**
0560 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0561 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
0562 C**
0563 C                     ENDSR
0564 C**
0565 C**
0566 C********************************************************************
0567 C**
0568 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0569 C**
0570 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0571 C**
0572 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0573 C**
0574 C**   CLEAR DATE FIELDS.
0575 C                     Z-ADD0         ZDATE   60
0576 C                     MOVEL'       ' ZADATE  7
0577 C**
0578 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0579 C                     Z-ADDZDAYNO    ZDAYNO  50
0580 C**
0581 C**   DETERMINE YEAR NUMBER.
0582 C**
0583 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0584 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0585 C   99                GOTO ZDEND2
0586 C**
0587 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0588 C           ZDAYN1    DIV  1461      ZLYR    20
0589 C                     MVR            ZDAYN1           SAVE REMAINING
0590 C**                                                   DAYS
0591 C**   CALCULATE NUMBER OF REMAINING YEARS.
0592 C                     Z-ADD1         ZWRK2   20
0593 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0594 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0595 C  N90      ZWRK2     ADD  1         ZWRK2
0596 C  N90                GOTO ZDTAG1
0597 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0598 C**
0599 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0600 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0601 C**
0602 C**   CALCULATE ACTUAL YEAR NUMBER.
0603 C           ZLYR      MULT 4         ZWRK3   30
0604 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0605 C                     Z-ADDZWRK3     ZYEAR   20
0606 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0607 C**
0608 C**   DETERMINE MONTH NUMBER.
0609 C**
0610 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0611 C                     SETOF                     9293
0612 C   91      ZDAYN1    COMP 59                     9293
0613 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0614 C**
0615 C**   CALCULATE MONTH NUMBER.
0616 C                     Z-ADD2         ZWRK2
0617 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0618 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0619 C  N94      ZWRK2     ADD  1         ZWRK2
0620 C  N94                GOTO ZDTAG2
0621 C           ZWRK2     SUB  1         ZWRK2
0622 C**
0623 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0624 C**
0625 C**   DETERMINE DAY OF MONTH.
0626 C**
0627 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0628 C           ZDAYN1    ADD  1         ZDAYN1
0629 C**
0630 C**   CALCULATE DAY OF MONTH.
0631 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0632 C**
0633 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0634 C   93      ZDAY      ADD  1         ZDAY
0635 C**
0636 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0637 C  N98                MOVELZDAY      ZWRK4   40
0638 C   98                MOVE ZDAY      ZWRK4
0639 C  N98                MOVE ZMTH      ZWRK4
0640 C   98                MOVELZMTH      ZWRK4
0641 C                     MOVELZWRK4     ZDATE
0642 C                     MOVE ZYEAR     ZDATE
0643 C**
0644 C**   FORMAT ALPHA DATE, DDMMMYY.
0645 C           ZDAY      COMP 10                     95
0646 C                     MOVELZDAY      ZWRK5   5
0647 C   95                MOVEL' '       ZWRK5
0648 C                     MOVE ZMNM,ZMTH ZWRK5
0649 C                     MOVELZWRK5     ZADATE
0650 C                     MOVE ZYEAR     ZADATE
0651 C**
0652 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0653 C**
0654 C**
0655 C********************************************************************
0656 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0657 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0658 C*
0659 CSR         GLZADD    BEGSR                           *** GLZADD ****
0660 C*
0661 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0662 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0663 C*
0664 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0665 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0666 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0667 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0668 C*
0669 CSR                   EXSR GLZSUM
0670 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0671 C*
0672 C********************************************************************
0673 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0674 C*                        GLZADD, GLZSUB, GLZCMP.
0675 C*          PARAMETERS PASSED -
0676 C*                     I/P ZZAMTI ZZAMTD
0677 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0678 C*
0679 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0680 C*
0681 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0682 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0683 CSR                   SETOF                     919293
0684 CSR                   SETOF                     949599
0685 C*
0686 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0687 CSR         ZZAMTI    COMP 0                      9293
0688 CSR 93      ZZAMTD    COMP 0                      9293
0689 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0690 C*
0691 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0692 CSR         ZZTOTI    COMP 0                      9193
0693 CSR 93      ZZTOTD    COMP 0                      9193
0694 C*
0695 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0696 CSR 93                Z-ADDZZAMTI    ZZTOTI
0697 CSR 93                Z-ADDZZAMTD    ZZTOTD
0698 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0699 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0700 CSR 91N92
0701 CORN91 92             GOTO ZZOFPS
0702 C*
0703 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0704 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0705 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0706 C*
0707 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0708 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0709 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0710 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0711 C*
0712 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0713 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0714 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0715 CSRN99                Z-ADDZZWK2     ZZTOTD
0716 CSRN99                Z-ADDZZWK3     ZZTOTI
0717 C*
0718 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0719 CSR 99                Z-ADD0         ZZAMT  153
0720 CSR                   GOTO ZZSEND
0721 C*
0722 C* THE 'SIGNS' ARE DIFFERENT
0723 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0724 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0725 C*
0726 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0727 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0728 C*
0729 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0730 C*
0731 CSR 91                Z-SUBZZTOTI    ZZTOTI
0732 CSR 91                Z-SUBZZTOTD    ZZTOTD
0733 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0734 C*
0735 CSR         ZZTOTI    COMP ZZAMTI               93  95
0736 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0737 C*
0738 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0739 CSR 95                Z-ADD0         ZZTOTI
0740 CSR 95                Z-ADD0         ZZTOTD
0741 CSR 95                GOTO ZZSEND
0742 C*
0743 C* IF ZZTOT GT. ZZAMT.
0744 CSR 93      ZZAMTD    COMP ZZTOTD               94
0745 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0746 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0747 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0748 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0749 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0750 C*
0751 C*
0752 C* IF ZZAMT GT. ZZTOT.
0753 CSRN93      ZZTOTD    COMP ZZAMTD               94
0754 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0755 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0756 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0757 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0758 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0759 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0760 C*
0761 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0762 CSR                   SETOF                     94
0763 CSR 93 91
0764 CORN93 92             SETON                     94
0765 CSR 94                Z-SUBZZTOTI    ZZTOTI
0766 CSR 94                Z-SUBZZTOTD    ZZTOTD
0767 C**
0768 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0769 CSR 92                Z-SUBZZAMTI    ZZAMTI
0770 CSR 92                Z-SUBZZAMTD    ZZAMTD
0771 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0772 C**
0773 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0774 CSR                   SETOF                     96
0775 CSR         ZZTOTD    COMP 0                        91
0776 CSR 91      ZZTOTI    COMP 0                      96
0777 CSR 96                MOVE '.000-'   ZZNEGD  5
0778 CSR                   ENDSR                             ** ENDSR **
0779 C********************************************************************
     C*                                                                   S01117
     C*  *PSSR --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C*  CALLED FROM: AFTER ABNORMAL OPERATION OCCURS                     S01117
     C*                                                                   S01117
     C*  CALLS: NOTHING                                                   S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C/EJECT                                                              S01117
0780 O*  STANDARD OUTPUT
0781 O*
0782 ORE0510P1E  203   83 31                                              S01124
0783 O       OR  203   33
0784 O*
0785 O*  STANDARD HEADINGS
0786 O*
0787 O***********                        20 'REFERENCE RE0510'            S01117
0787 O                                   22 'REFERENCE RE0510P1'          S01117
0788 O                         TITL      89
0789 O                                  104 'DATE'
0790 O                         RUNA     112
0791 O                                  122 'PAGE'
0792 O                         PAGE  Z  126
0793 O        E  1     83 31
0794 O       OR  1     33
0795 O                       U1          16 'AUDIT REPORT'
0796 O                      NU1          18 'LISTING REPORT'
0797 O*
0798 O*  NAME OF FILE OR RECORD
0799 O*
0800 O                                   69 'INTEREST SUB-TYPES LIST-'
0801 O                       21          79 '01/TIERED'
0802 O                       22          82 '02/THRESHOLD'
0803 O                       23          83 '03/TIERED,MMB'
0804 O                       24          86 '04/THRESHOLD,MMB'
      *                                                                   S01408
     O/COPY WNCPYSRC,RE0510OOP1                                           S01408
      *                                                                   S01408
0805 O*
0806 O*  STANDARD OUTPUT
0807 O*
0808 O                         MTIME    112 '  .  .  '
0809 O        E  3     83 31
0810 O       OR  3     33
0811 O                       U1          16 '------------'
0812 O                      NU1          18 '--------------'
0813 O*
0814 O*  UNDERLINE NAME OF FILE OR RECORD
0815 O*
0816 O                                   69 '------------------------'
0817 O                       21          79 '---------'
0818 O                       22          82 '------------'
0819 O                       23          83 '-------------'
0820 O                       24          86 '----------------'
      *                                                                   S01408
     O/COPY WNCPYSRC,RE0510OOP2                                           S01408
      *                                                                   S01408
0821 O*
0822 O*  NON-STANDARD HEADINGS
0823 O*
0824 O        E 11     83 31
0825 O       OR 11     33
0826 O                                   11 'SUB   CCY'
0827 O                                   31 'TITLE'
0828 O                                   60 'LEVEL     BALANCE'
0829 O                                   80 'RATE/   BASE'
0830 O                                   98 'VALUE     PREV-'
0831 O                                  112 'INITIAL'
0832 O                                  131 'CHANGE ACTION'
0833 O        E  1     83 31
0834 O       OR  1     33
0835 O                                    6 '-TYPE'
0836 O                                   80 'SPREAD  RATE'
0837 O                                   97 'DATE      DATE'
0838 O                                  122 'THRESHOLD    DATE'
0839 O*
0840 O*  NON-STANDARD DETAILS
0841 O*
0842 O        E 11     84 31
0843 O       OR 10     33N31
0844 O                         MSTP       6
0845 O                         MCCY      11
0846 O                         MINNM     43
0847 O                    31             46 '0'
0848 O********            31 60MBAL,1    63 '             0 '             S01127
0849 O********            31 61MBAL,1    63 '            0 . '            S01127
0850 O********            31 62MBAL,1    63 '           0 .  '            S01127
0851 O********            31 63MBAL,1    63 '          0 .   '            S01127
0848 O                N49 31 60MBAL,1    63 '             0 '             S01127
0849 O                N49 31 61MBAL,1    63 '            0 . '            S01127
0850 O                N49 31 62MBAL,1    63 '           0 .  '            S01127
0851 O                N49 31 63MBAL,1    63 '          0 .   '            S01127
     O                    49             63 '*MARGIN*'                    S01127
0852 O                    31N32MRAT,13   75
0853 O                    31 32          75 '.0000000'
     O                    50             76 '+'
     O                    51             76 '-'
0854 O                      N35MBRT      79
0855 O                   N52   WVDTC Y   89
0856 O                       34WVDPC Y   99
0857 O                       60MINTH    116 '             0 '
0858 O                       61MINTH    116 '            0 . '
0859 O                       62MINTH    116 '           0 .  '
0860 O                       63MINTH    116 '          0 .   '
0861 O                         WLCD     125
0862 O                         MCHTP    128
0863 O        E 01     84N31
0864 O                         WLEV,N1   46
0865 O********               60MBAL,M    63 '             0 '             S01127
0866 O********               61MBAL,M    63 '            0 . '            S01127
0867 O********               62MBAL,M    63 '           0 .  '            S01127
0868 O********               63MBAL,M    63 '          0 .   '            S01127
0865 O**********         N49 60MBAL,M    63 '             0 '                          S01127 CER055
0866 O**********         N49 61MBAL,M    63 '            0 . '                         S01127 CER055
0867 O**********         N49 62MBAL,M    63 '           0 .  '                         S01127 CER055
0868 O**********         N49 63MBAL,M    63 '          0 .   '                         S01127 CER055
     O                N53N49 60MBAL,M    63 '             0 '                                 CER055
     O                N53N49 61MBAL,M    63 '            0 . '                                CER055
     O                N53N49 62MBAL,M    63 '           0 .  '                                CER055
     O                N53N49 63MBAL,M    63 '          0 .   '                                CER055
     O/COPY WNCPYSRC,RE0510O001
     O                    49             63 '*MARGIN*'                    S01127
     O                 55 53             63 '*OVERDRAFT*'                                     CER055
0869 O                         MRAT,M3   75
     O                    50             76 '+'
     O                    51             76 '-'
0876 O*
0877 O*  DATABASE ERROR OUTPUT                                            S01117
0878 O*                                                                   S01117
0879 O        T 3      LR U7                                              S01117
0880 O                                   74 '*** DATABASE ERROR ***'      S01117
0871 O*  NO DETAILS TO REPORT MESSAGE                                     S01117
0872 O*                                                                   S01117
0873 O        T   40   LR 77NU1                                           S01117
0874 O                                   72 '*** NO DETAILS TO REPORT'    S01117
     O                                   76 ' ***'                        S01117
0873 O        T   40   LR 82 U1                                           S01117
0874 O                                   73 '*** NO INPUT TODAY ***'      S01117
0998 O        T   50   LR                                                 S01117
0999 O                                   73 '*** END OF REPORT ***'       S01117
0784 O*
0785 O*  STANDARD HEADINGS FOR NO DETAILS PAGE                           R
0786 O*
0873 O********T**203   LRNU1 77                                           S01117
0787 O***********                        20 'REFERENCE RE0510'            S01117
0788 O***********              TITL      89                               S01117
0789 O***********                       104 'DATE'                        S01117
0790 O***********              RUNA     112                               S01117
0791 O***********                       122 'PAGE'                        S01117
0792 O***********              PAGE  Z  126                               S01117
0873 O********T**1     LRNU1 77                                           S01117
0795 O***********            U1          16 'AUDIT REPORT'                S01117
0796 O***********           NU1          18 'LISTING REPORT'              S01117
0797 O***********                                                         S01117
0798 O***NAME*OF*FILE OR RECORD                                           S01117
0799 O***********                                                         S01117
0800 O***********                        73 'INTEREST SUB-TYPES LIST'     S01117
0805 O***********                                                         S01117
0806 O***STANDARD OUTPUT                                                  S01117
0807 O***********                                                         S01117
0808 O***********              MTIME    112 '  .  .  '                    S01117
0809 O********T**1     LRNU1 77                                           S01117
0811 O***********            U1          16 '------------'                S01117
0812 O***********           NU1          18 '--------------'              S01117
0813 O***********                                                         S01117
0814 O***UNDERLINE NAME OF FILE OR RECORD                                 S01117
0815 O***********                                                         S01117
0816 O***********                        73 '-----------------------'     S01117
0870 O***********                                                         S01117
0871 O***NO*DETAILS TO REPORT MESSAGE                                     S01117
0872 O***********                                                         S01117
0873 O********T** 40   LRNU1 77                                           S01117
0874 O***********                        72 '*** NO DETAILS TO REPORT'    S01117
0875 O***********                        76 ' ***'                        S01117
0876 O***********                                                         S01117
0877 O***DATABASE ERROR OUTPUT                                            S01117
0878 O***********                                                         S01117
0879 O********T*3      LR U7                                              S01117
0880 O***********                        38 'DATABASE ERROR NO.-'         S01117
0881 O***********              LDBNO     40                               S01117
0882 O***********                        48 'FILE-'                       S01117
0883 O***********              LFILE     53                               S01117
0884 O***********                        60 'KEY-'                        S01117
0885 O***********              LKEY      89                               S01117
0886 O*
0887 O*  STANDARD FILE CONTROLS
0888 O*
0889 O*  STANDARD HEADINGS
0890 O*
0891 O********T**203   LR                                                 S01117
0891 ORE0510AUT  203   LR                                                 S01117
0892 O***********                        20 'REFERENCE RE0510'            S01117
0892 O                                   22 'REFERENCE RE0510AU'          S01117
0893 O                         TITL      89
0894 O                                  104 'DATE'
0895 O                         RUNA     112
0896 O                                  122 'PAGE'
0897 O***********              PAGE  Z  126                               S01117
0897 O                         PAGE1 Z  126                               S01117
0898 O        T  1     LR
0899 O                       U1          16 'AUDIT REPORT'
0900 O                      NU1          18 'LISTING REPORT'
0901 O*
0902 O*  NAME OF FILE OR RECORD
0903 O*
0904 O                                   73 'INTEREST SUB-TYPES LIST'
0905 O                                   88 '   RUN CONTROLS'             S01117
0905 O*
0906 O*  STANDARD OUTPUT
0907 O*
0908 O                         MTIME    112 '  .  .  '
0909 O        T  1     LR
0910 O                       U1          16 '------------'
0911 O                      NU1          18 '--------------'
0912 O*
0913 O*  UNDERLINE NAME OF FILE OR RECORD
0914 O*
0915 O                                   73 '-----------------------'
0916 O***********                                                         S01117
0917 O***NO*INPUT TODAY MESSAGE                                           S01117
0918 O***********                                                         S01117
0919 O********T** 40   LR U1 82                                           S01117
0920 O***********                        73 '*** NO INPUT TODAY ***'      S01117
0921 O*
0922 O*  HEADINGS AND RUN CONTROLS COMMON TO AUDIT AND LIST
0923 O*
0924 O        T  220   LRN81
0925 O                                   21 'RUN CONTROLS - '
0926 O                                   77 '----------- PROGRAM ----'
0927 O                                   84 '-------'
0928 O                                  116 '--------- FILE TRAILER '
0929 O                                  124 '--------'
0930 O        T  1     LRN81
0931 O                                   59 'NUMBER'
0932 O                                   84 'VALUE'
0933 O                                   99 'NUMBER'
0934 O                                  124 'VALUE'
0935 O        T  2     LRN81
0936 O                                   13 'S/'
0937 O***********              LFILE     18                               S01117
0937 O                                   18 'REINT'                       S01117
0938 O        T  2     LRN81
0939 O                                   32 'NUMBER OF ACTIVE RECORDS'
0940 O                                   40 'ON FILE'
0941 O                         RN,1  3   59
0942 O                         RW,1  Z   80
0943 O                         RD,1      84 '0   -'
0944 O                         NR,1  3   99
0945 O                         WN,1  Z  120
0946 O                         DC,1     124 '0   -'
0947 O                       79         130 '***'
0948 O*
0949 O*  AUDIT REPORT ONLY RUN CONTROLS
0950 O*
0951 O        T  3     LR U1N82
0952 O                                   29 'NUMBER OF RECORDS UPD'
0953 O                                   39 'ATED TODAY'
0954 O                         RN,3  3   59
0955 O        T  2     LR U1N82
0956 O                                   27 'LIVE RECORDS BEFORE'
0957 O                                   39 'INPUT CYCLE'
0958 O                         NR,2  3   99
0959 O                         WN,2  Z  120
0960 O                         DC,2     124 '0   -'
0961 O        T  2     LR U1N82
0962 O                                   26 'RECORDS INSERTED'
0963 O                         NR,3  3   99
0964 O                         WN,3  Z  120
0965 O                         DC,3     124 '0   -'
0966 O        T  2     LR U1N82
0967 O                                   25 'RECORDS AMENDED'
0968 O                         NR,4  3   99
0969 O                         WN,4  Z  120
0970 O                         DC,4     124 '0   -'
0971 O        T  2     LR U1N82
0972 O                                   25 'RECORDS DELETED'
0973 O                         NR,5  3   99
0974 O                         WN,5  Z  120
0975 O                         DC,5     124 '0   -'
0976 O        T        LR U1N82
0977 O                                   32 'LIVE RECORDS AFTER INPUT'
0978 O                                   38 'CYCLE'
0979 O                         RN,2  3   59
0980 O                         RW,2  Z   80
0981 O                         RD,2      84 '0   -'
0982 O                         RN,4  3   99
0983 O                         RW,4  Z  120
0984 O                         RD,4     124 '0   -'
0985 O                       78         129 '***'
0986 O*
0987 O*  LISTING REPORT ONLY RUN CONTROLS
0988 O*
0989 O        T        LRNU1
0990 O                                   29 'NUMBER OF LIVE RECORD'
0991 O                                   38 'S ON FILE'
0992 O                         RN,2  3   59
0916 O*                                                                   S01117
0917 O*  NO INPUT TODAY MESSAGE                                           S01117
0918 O*                                                                   S01117
0919 O        T   40   LR U1 82                                           S01117
0920 O                                   73 '*** NO INPUT TODAY ***'      S01117
0876 O*                                                                   S01117
0877 O*  DATABASE ERROR OUTPUT                                            S01117
0878 O*                                                                   S01117
0642 O        T 3      LR U7                                              S01117
     O                                   66 'DATABASE ERROR '             S01117
     O                         DBASE     69                               S01117
     O                                   83 'IN PROGRAM '                 S01117
     O                         DBPGM     93                               S01117
     O        T 2      LR U7                                              S01117
     O                                   56 'FILE '                       S01117
     O                         DBFILE    64                               S01117
     O                                   70 ', KEY '                      S01117
     O                         DBKEY     99                               S01117
0870 O*                                                                   S01117
0871 O*  NO DETAILS TO REPORT MESSAGE                                     S01117
0872 O*                                                                   S01117
0873 O        T   40   LRNU1 77                                           S01117
0874 O                                   72 '*** NO DETAILS TO REPORT'    S01117
0875 O                                   76 ' ***'                        S01117
0993 O*
0994 O*  OUTPUT DETAILS COMMON TO AUDIT AND LIST
0995 O*
0996 O********T** 45   LR U8                                              S01117
0996 O        T   45   LR U8NU7                                           S01117
0997 O                                  100 '*** DIFFERENCE ***'
0998 O********T** 50   LR                                                 S01117
0999 O***********                        73 '*** END OF REPORT ***'       S01117
1000 O*EINT***E**      88                                                 S01117
1000 OREINT   E        88 LR                                              S01117
1001 O                                   34 ' '
1002 O                         RN,1      37P
1003 O                         RN,2      40P
1004 O                         ZERO05    43P
1005 O                         ZERO05    46P
1006 O                         ZERO05    49P
1007 O                         RW,1      57P
1008 O                         RW,2      65P
1009 O                         ZERO15    73P
1010 O                         ZERO15    81P
1011 O                         ZERO15    89P
1012 O                         RD,1      91P
1013 O                         RD,2      93P
1014 O                         ZERO03    95P
1015 O                         ZERO03    97P
1016 O                         ZERO03    99P
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   WLEV - WORK LEVELS OF RATE/SPREAD
01020304050607080910
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
