0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Transaction Charges Audit & List')
0001 H***********
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Retail Module
0005 F*                                                               *
0006 F*  RE0530 - RETAIL CHARGES AUDIT AND LIST - S/RECRG             *
0007 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*      1990, 1993                                               *
      *                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CGL029             Date 01Sep03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *  Prev Amend No. S01413             Date 13Apr93               *
      *                 LN0374             Date 14Jun90               *
0010 F*                 S01117                  04OCT89               *
0010 F*                 E12855                  24AUG88               *
0010 F*                 E11279                  30JUL87               *
0011 F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  S01413 - Retail 3 Incorporation                              *
     F*  LN0374 - CORRECT P1 REPORT LAYOUT                            *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  E12855 - NO HEADINGS PRINTED WHEN DATABASE ERROR REPORTED.   *
     F*  E11279 - ARRAY FOR CURRENCIES TOO SMALL                      *
     F*                                                               *
     F*****************************************************************
0014 F***RECRG** UF  F     160 12AI     2 DISK                                         RE0530 CGL029
     FRECRG   UF  F     170 12AI     2 DISK                                                   CGL029
0015 F***TABLE** IF  F      96 12AI     2 DISK                                         RE0530 CGL029
     FTABLE   IF  F     126 12AI     2 DISK                                                   CGL029
0017 F*E0530P1O** F     132     OF     PRINTER                      S01124S01117
0017 FRE0530P1O   F     132     OF     PRINTER      KINFDS SPOOL          S01117
0017 FRE0530AUO   F     132     OA     PRINTER      KINFDS SPOOLU         S01117
0018 F*                                                                   RE0530
0019 F*       U8      FILE OUT OF BALANCE                                 RE0530
0020 F*       U7      DATABASE ERROR                                      RE0530
0021 F*       89      MASTER FILE - HEADER                                RE0530
0022 F*       88      MASTER FILE - TRAILER                               RE0530
0023 F*       87      MASTER FILE - DETAIL RECORD -CORRECT RECORD TYPE-   RE0530
0025 F*       85      FIRST CYCLE IND.                                    RE0530
0026 F*       84      PRINT THIS DETAIL RECORD                            RE0530
0027 F*       83      PRINT HEADINGS                                      RE0530
0028 F*       82      NO INPUT TODAY                                      RE0530
0029 F*       81      AUDIT REPORT WITH NO INPUT TODAY -U1 AND 82-        RE0530
0030 F*       80      UPDATE TRAILER BY EXCEPTION OUTPUT                  RE0530
0031 F*       79      FILE OUT OF BALANCE - NUMBER OF ACTIVE RECORDS      RE0530
0032 F*       78      FILE OUT OF BALANCE - LIVE RECORDS AFTER INPUT      RE0530
0033 F*       77      LISTING REPORT WITH NO DETAILS TO REPORT            RE0530
0034 F*       76      SPARE                                               RE0530
0035 F*       75      ACTIVE DETAIL RECORD READ - RECI NOT *              RE0530
0036 F*       74      LIVE DETAIL RECORD READ - RECI IS D AND CHTP NOT D  RE0530
0037 F*       73      DETAIL RECORD UPDATED TODAY - LCD EQUALS RUN DATE   RE0530
0038 F*       72      CURRENCY RECORD ON TABLE FILE                       RE0530
0039 F*       71      TABLE CATCHALL                                      RE0530
     F*       70      ICD RECORD ON TABLE FILE
     F*       64      END OF MASTER FILE
0040 F*       63      CURRENCY HAS 3 DECIMAL PLACES                       RE0530
0041 F*       62      CURRENCY HAS 2 DECIMAL PLACES                       RE0530
0042 F*       61      CURRENCY HAS 1 DECIMAL PLACE                        RE0530
0043 F*       60      CURRENCY HAS 0 DECIMAL PLACES                       RE0530
0044 E*    STANDARD TABLES/ARRAYS                                         RE0530
0045 E*                                                                   RE0530
0046 E*    RN/RW/RD,1 ARE COUNT/HASH OF ACTIVE RECORDS                    RE0530
0047 E*    RN/RW/RD,2 ARE COUNT/HASH OF LIVE RECORDS                      RE0530
0048 E*    RN,3 IS COUNT OF RECORDS UPDATED TODAY. RW/RD,3 ARE NOT USED   RE0530
0049 E*    RN/RW/RD,4 ARE COUNT/HASH OF LIVE RECORDS CALCULATED FROM TRLR RE0530
0050 E                    RN          4  5 0                              RE0530
0051 E                    RW          4 15 0                              RE0530
0052 E                    RD          4  3 0                              RE0530
0053 E*    ARRAYS OF CURRENCY CODES, NAMES AND DECIMAL PLACES.            RE0530
0054 E*    NAMES REMOVED UNLESS REQUIRED, TO SAVE SPACE.                  RE0530
0055 E********************ACCY       99  3                                E11279
0056 E********************ACDP       99  1 0                              E11279
     E                    ACCY      150  3                                E11279
     E                    ACDP      150  1 0                              E11279
0057 E*    ARRAYS OF COUNTS AND HASH TOTALS IN THE MASTER FILE TRAILER    RE0530
0058 E                    NR          5  5 0                              RE0530
0059 E                    WN          5 15 0                              RE0530
0060 E                    DC          5  3 0                              RE0530
0061 E*                                                                   RE0530
0062 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAYRE0530
0063 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAYRE0530
0064 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY RE0530
     E                    CPY@    1   1 80
     E/EJECT
0065 I*    STANDARD FILES                                                 RE0530
0066 I*                                                                   RE0530
0067 I*    MASTER FILE - HEADER                                           RE0530
0068 I*                                                                   RE0530
0069 IRECRG   NS  89   1 CA                                               RE0530
0098 I*                                                                   RE0530
0099 I*    MASTER FILE - TRAILER                                          RE0530
0100 I*                                                                   RE0530
0101 I        NS  88   1 CZ                                               RE0530
0102 I                                        1   1 RECI                  RE0530
0103 I                                    P  31  330TNLU                  RE0530
0104 I                                       34  34 IRRI            82    RE0530
0105 I                                    P  35  49 NR                    RE0530
0106 I                                    P  50  89 WN                    RE0530
0107 I                                    P  90  99 DC                    RE0530
0074 I*                                                                   RE0530
0075 I*    MASTER FILE - DETAIL                                           RE0530
0076 I*                                                                   RE0530
0077 I        NS  87  13 CD                                               RE0530
0078 I                                        1   1 MRECI                 RE0530
0079 I                                        3   40MCTYP                 RE0530
0080 I                                        5   90MCSTP                 RE0530
0081 I                                       10  12 MCCCY                 RE0530
0082 I                                       13  13 MRECT                 RE0530
0083 I                                    P  31  330MTNLU                 RE0530
0084 I                                    P  34  360MORED                 RE0530
0085 I                                    P  37  390MLCD                  RE0530
0086 I                                       40  40 MCHTP                 RE0530
0087 I                                    P  41  470MHASH                 RE0530
0088 I                                       48  77 MCHNM                 RE0530
0089 I                                    P  78  840MMINC                 RE0530
0090 I                                    P  85  910MMAXC                 RE0530
0091 I                                    P  92  980MREB                  RE0530
0092 I                                    P  99 1060MPERM                 RE0530
0093 I                                    P 107 1140MEXBL                 RE0530
0094 I**********                            115 118 MACOD                              RE0530 CGL029
     I                                      115 118 MACOD#                                    CGL029
     I                                      161 170 MACOD                                     CGL029
0108 I*                                                                   RE0530
0109 I*    CATCHALL                                                       RE0530
0110 I        NS                                                          RE0530
     I*
0131 I*    TABLE FILE - CURRENCIES RECORD 1.                              RE0530
0132 I*                                                                   RE0530
0133 ITABLE   NS  72   2 C2   3 C0                                        RE0530
0134 I                                        1   1 RECI                  RE0530
0135 I                                        2   30RECT                  RE0530
0136 I                                       10  12 CCY                   RE0530
0137 I                                       13  130SREC                  RE0530
0138 I                                       14  27 CCNM                  RE0530
0139 I                                    P  28  348SPOT                  RE0530
0140 I                                       35  37 CCYS                  RE0530
0141 I                                       38  380CDP                   RE0530
0142 I                                       39  390TNOT                  RE0530
0143 I                                       40  40 DCCY                  RE0530
0144 I                                       41  44 SRC1                  RE0530
0145 I                                       45  48 SRC2                  RE0530
0146 I**********                             49  520TACC                               RE0530 CGL029
0147 I**********                             53  560TEQV                               RE0530 CGL029
0148 I**********                             57  600SWQV                               RE0530 CGL029
0149 I**********                             61  640TAC4                               RE0530 CGL029
0150 I**********                             65  680TAC5                               RE0530 CGL029
0151 I**********                             69  69 HIND                               RE0530 CGL029
0152 I**********                          P  70  768PART                               RE0530 CGL029
0153 I**********                             77  780SSNO                               RE0530 CGL029
0154 I**********                          P  79  858ERLC                               RE0530 CGL029
0155 I**********                             86  860MDIN                               RE0530 CGL029
0156 I**********                             87  870MDIA                               RE0530 CGL029
0157 I**********                             88  880MDIB                               RE0530 CGL029
0158 I**********                          P  90  920LCD                                RE0530 CGL029
0159 I**********                             93  93 CHTP                               RE0530 CGL029
0160 I**********                          P  94  960TNLU                               RE0530 CGL029
     I                                       49  580TACC                                      CGL029
     I                                       59  680TEQV                                      CGL029
     I                                       69  780SWQV                                      CGL029
     I                                       79  880TAC4                                      CGL029
     I                                       89  980TAC5                                      CGL029
     I                                       99  99 HIND                                      CGL029
     I                                    P 100 1068PART                                      CGL029
     I                                      107 1080SSNO                                      CGL029
     I                                    P 109 1158ERLC                                      CGL029
     I                                      116 1160MDIN                                      CGL029
     I                                      117 1170MDIA                                      CGL029
     I                                      118 1180MDIB                                      CGL029
     I                                    P 120 1220LCD                                       CGL029
     I                                      123 123 CHTP                                      CGL029
     I                                    P 124 1260TNLU                                      CGL029
0111 I*                                                                   RE0530
0112 I*    TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               RE0530
0113 I*                                                                   RE0530
0114 ITABLE   NS  70   2 C0   3 C1  12 C1                                 RE0530
     I       AND      13 C0
0115 I                                        1   1 RECI                  RE0530
0116 I                                        2   30RECT                  RE0530
0117 I                                       12  130RCDE                  RE0530
0118 I                                       14  66 TITL                  RE0530
0119 I                                       67  67 DATF                  RE0530
0120 I***********                            68  700DFBR                  S01117
0120 I                                       68  70 DFBM                  S01117
0121 I                                       74  74 MODI1                 RE0530
0122 I                                       75  75 MODI2                 RE0530
0123 I                                       76  76 MODI3                 RE0530
0124 I                                    P  77  790RUND                  RE0530
0125 I                                       80  86 RUNA                  RE0530
0126 I                                       87  870SFLG                  RE0530
0127 I                                    P  90  920LCD                   RE0530
0128 I                                       93  93 CHTP                  RE0530
0129 I                                    P  94  960TNLU                  RE0530
     I*
     I*    CATCHALL
     I        NS  71
     I                                        1   1 RECI
     I                                        2   30RECT
     I                                       13  130SREC
0130 I*                                                                   RE0530
0164 I*                                                                   RE0530
0165 I*    DATA STRUCTURE FOR TABLE FILE KEY                              RE0530
0166 I*                                                                   RE0530
0167 I            DS                                                      RE0530
0168 I                                        1  12 TABKEY                RE0530
0169 I                                        1   2 TAB2                  RE0530
0170 I                                        9  11 TAB3A                 RE0530
0171 I                                       10  12 TAB3B                 RE0530
0172 I                                        9  12 TAB4                  RE0530
0173 I                                       12  12 TAB1                  RE0530
0174 I                                        6  11 TAB6                  RE0530
0175 I*                                                                   RE0530
0176 I*    STANDARD LOCAL DATA AREA FIELDS                                RE0530
0177 I*                                                                   RE0530
0178 ILDA        UDS                            256                       RE0530
0179 I***********                           134 138 LFILE                 S01117
0180 I***********                           139 167 LKEY                  S01117
0181 I***********                           168 175 LPROG                 S01117
0182 I***********                           176 1770LDBNO                 S01117
     I                                      134 141 LFILE                 S01117
     I                                      142 170 LKEY                  S01117
     I                                      171 180 LPROG                 S01117
     I                                      181 1830LDBNO                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C**                                                                  S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NO.  S01117
0183 C*  INITIALISE TO -PRINT NO HEADINGS- AND -PRINT NO DETAILS-         RE0530
0184 C*                                                                   RE0530
0185 C                     SETOF                     8384                 RE0530
0186 C*                                                                   RE0530
0187 C  N85                EXSR FIRSTC                                    RE0530
     C  N85      *LOVAL    SETLLRECRG
0188 C                     SETON                     85                   RE0530
     C*  READS MASTER FILE
     C*
     C                     READ RECRG                    64
     C   64                SETON                     LR
     C   64                GOTO LASTR
0189 C*                                                                   RE0530
0190 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR                          RE0530
0191 C*  AN AUDIT REPORT, GOTO LR PROCESSING.                             RE0530
0192 C*                                                                   RE0530
0193 C   U7                                                               RE0530
0194 COR U1 82             GOTO LASTR                                     RE0530
0195 C*                                                                   RE0530
0196 C*  IF HEADER OR TRAILER READ, GOTO LR PROCESSING                    RE0530
0197 C*                                                                   RE0530
0198 C   89                                                               RE0530
0199 COR 88                GOTO LASTR                                     RE0530
0200 C*                                                                   RE0530
0201 C*  IF INCORRECT - WRONG RECORD TYPE - DETAIL                        RE0530
0202 C*  RECORD READ, GOTO LR PROCESSING                                  RE0530
0203 C*                                                                   RE0530
0204 C  N87                GOTO LASTR                                     RE0530
0205 C*                                                                   RE0530
0206 C*  PROCESSING NOW CONSISTS OF RUN CONTROLS, RECORD FORMATTING       RE0530
0207 C*  FOR OUTPUT AND PRINTING THE RECORD.                              RE0530
0208 C*                                                                   RE0530
0209 C*                                                                   RE0530
0210 C*  RUN CONTROLS - AUDIT AND LIST CONTROLS ARE                       RE0530
0211 C*  MAINTAINED UNCONDITIONALLY                                       RE0530
0212 C*                                                                   RE0530
0213 C*  IF THERE IS NO HASH TOTAL FIELD ON THE MASTER FILE DETAIL RECORD,RE0530
0214 C*  THEN ZEROISE AND CONTINUE AS IF THERE IS.                        RE0530
0215 C*                                                                   RE0530
0216 C                     Z-ADD0         MHASH  130                      RE0530
0217 C*                                                                   RE0530
0218 C*  COUNT ACTIVE RECORDS READ - RECI NOT *                           RE0530
0219 C*  MOVE HASH AMOUNT INTO ZZAMT FIRST.                               RE0530
0220 C*                                                                   RE0530
0221 C                     MOVE MHASH     ZZAMT                           RE0530
0222 C*                                                                   RE0530
0223 C           MRECI     COMP '*'                  7575                 RE0530
0224 C   75                Z-ADD1         H                               RE0530
0225 C   75                EXSR NPZTOT                                    RE0530
0226 C*                                                                   RE0530
0227 C*  COUNT LIVE RECORDS READ - RECI IS D AND CHTP IS NOT D            RE0530
0228 C*                                                                   RE0530
0229 C           MRECI     COMP 'D'                      74               RE0530
0230 C   74      MCHTP     COMP 'D'                  7474                 RE0530
0231 C   74                Z-ADD2         H                               RE0530
0232 C   74                EXSR NPZTOT                                    RE0530
0233 C*                                                                   RE0530
0234 C*  COUNT RECORDS UPDATED TODAY - LCD IS RUN DATE                    RE0530
0235 C*                                                                   RE0530
0236 C           MLCD      COMP RUND                     73               RE0530
0237 C   73      RN,3      ADD  1         RN,3                            RE0530
0238 C*                                                                   RE0530
0239 C*  IF AUDIT REPORT, RECORDS UPDATED TODAY ARE PRINTED.              RE0530
0240 C*  IF LISTING, LIVE RECORDS ARE PRINTED.                            RE0530
0241 C*  SET ON 84 IF THE RECORD IS TO BE PRINTED.                        RE0530
0242 C*                                                                   RE0530
0243 C   U1 73                                                            RE0530
0244 CORNU1 74             SETON                       84                 RE0530
0245 C*                                                                   RE0530
0246 C*  FORMAT THE RECORD IF IT IS TO BE PRINTED                         RE0530
0247 C*                                                                   RE0530
0248 C   84                EXSR FORMT                                     RE0530
0249 C*                                                                   RE0530
0250 C   84 U7             GOTO LASTR                                     RE0530
0251 C*                                                                   RE0530
0252 C*                                                                   RE0530
0253 C           LASTR     TAG                             ** LASTR TAG   RE0530
0254 C*                                                                   RE0530
0255 CLR                   TIME           MTIME                           RE0530
0256 C*                                                                   RE0530
0257 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR                          RE0530
0258 C*  AN AUDIT REPORT, NO FILE CONTROL CHECK DONE.                     RE0530
0259 C*                                                                   RE0530
0260 CLR U7                                                               RE0530
0261 COR U1 82             GOTO END                                       RE0530
0262 C*                                                                   RE0530
0263 C*  FOR LIST, TEST FOR NO DETAILS TO REPORT                          RE0530
0264 C*                                                                   RE0530
0265 CLRNU1      RN,2      COMP 0                        77               RE0530
0266 C*                                                                   RE0530
0267 C*  TEST FOR ALL ACTIVE RECORDS READ - COUNT AND HASH                RE0530
0268 C*                                                                   RE0530
0269 CLR         RN,1      COMP NR,1                 7979                 RE0530
0270 CLRN79      RW,1      COMP WN,1                 7979                 RE0530
0271 CLRN79      RD,1      COMP DC,1                 7979                 RE0530
0272 CLR 79                SETON                     U8                   RE0530
0273 C*                                                                   RE0530
0274 C*  IF LISTING REPORT, GOTO END                                      RE0530
0275 C*                                                                   RE0530
0276 CLRNU1                GOTO END                                       RE0530
0277 C*                                                                   RE0530
0278 C*  CALCULATE NUMBER OF LIVE RECORDS FROM TRAILER                    RE0530
0279 C*                                                                   RE0530
0280 CLR         NR,2      ADD  NR,3      RN,4                            RE0530
0281 CLR         RN,4      SUB  NR,5      RN,4             ** TOTAL       RE0530
0282 C*                                                                   RE0530
0283 C*  CALCULATE HASH TOTAL OF LIVE RECORDS AFTER INPUT FROM TRAILER    RE0530
0284 C*                                                                   RE0530
0285 C*  PUT HASH OF LIVE RECORDS BEFORE INPUT INTO ZZ FIELDS             RE0530
0286 C*                                                                   RE0530
0287 CLR                   Z-ADDWN,2      ZZTOTI                          RE0530
0288 CLR                   Z-ADDDC,2      ZZTOTD                          RE0530
0289 C*                                                                   RE0530
0290 C*  ADD HASH OF INSERTED RECORDS                                     RE0530
0291 C*                                                                   RE0530
0292 CLR                   Z-ADDWN,3      ZZAMTI                          RE0530
0293 CLR                   Z-ADDDC,3      ZZAMTD                          RE0530
0294 CLR                   EXSR GLZSUM                                    RE0530
0295 C*                                                                   RE0530
0296 C*  ADD HASH OF AMENDMENTS                                           RE0530
0297 C*                                                                   RE0530
0298 CLR                   Z-ADDWN,4      ZZAMTI                          RE0530
0299 CLR                   Z-ADDDC,4      ZZAMTD                          RE0530
0300 CLR                   EXSR GLZSUM                                    RE0530
0301 C*                                                                   RE0530
0302 C*  SUBTRACT HASH OF DELETIONS                                       RE0530
0303 C*                                                                   RE0530
0304 CLR                   Z-SUBWN,5      ZZAMTI                          RE0530
0305 CLR                   Z-SUBDC,5      ZZAMTD                          RE0530
0306 CLR                   EXSR GLZSUM                                    RE0530
0307 C*                                                                   RE0530
0308 CLR                   MOVE ZZTOTI    RW,4                            RE0530
0309 CLR                   MOVE ZZTOTD    RD,4                            RE0530
0310 C*                                                                   RE0530
0311 C*  COMPARE PROGRAM'S COUNT AND HASH OF LIVE RECORDS                 RE0530
0312 C*  READ WITH THOSE JUST CALCULATED.                                 RE0530
0313 C*                                                                   RE0530
0314 CLR         RN,2      COMP RN,4                 7878                 RE0530
0315 CLRN78      RW,2      COMP RW,4                 7878                 RE0530
0316 CLRN78      RD,2      COMP RD,4                 7878                 RE0530
0317 CLR 78                SETON                     U8                   RE0530
0318 C*                                                                   RE0530
0319 C*  IF DATABASE ERROR, GOTO END                                      RE0530
0320 C*                                                                   RE0530
0321 CLR U8                GOTO END                                       RE0530
0322 C*                                                                   RE0530
0323 C*  UPDATE CHAIN TO THE TRAILER                                      RE0530
0324 C*                                                                   RE0530
0325 CLR                   SETOF                     9988                 RE0530
0326 CLR         TRLRKY    CHAINRECRG                99                   RE0530
0327 CLRN99                                                               RE0530
0328 CAN 88                GOTO END01                                     RE0530
0329 CLR                   SETON                     U7    ** DB ERROR 92 RE0530
0330 CLR                   MOVELTRLRKY    LKEY                            RE0530
0331 CLR                   Z-ADD92        LDBNO                           RE0530
0332 CLR                   GOTO END                                       RE0530
0333 C*                                                                   RE0530
0334 CLR         END01     TAG                             ** END01 TAG   RE0530
0335 C*                                                                   RE0530
0336 C*  UPDATE THE TRAILER - IND 88 PERFORMS OUTPUT                      RE0530
0337 C*                                                                   RE0530
0338 CLR                   EXCPT                                          RE0530
0339 C*                                                                   RE0530
0340 CLR         END       TAG                             ** END TAG     RE0530
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   OUT  LDA                                       S01117
     C*                                                                   S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8LR               S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     CLR U7                EXSR *PSSR                                     S01117
0341 C*                                                                   RE0530
0342 C********************************************************************RE0530
0343 C**                                                                  RE0530
0344 C**   SUBR. - TO PERFORM FIRST CYCLE PROCESSING.                     RE0530
0345 C**                                                                  RE0530
0346 C           FIRSTC    BEGSR                           ***  FIRSTC ***RE0530
0347 C*                                                                   RE0530
0348 C*  SET-UP LDA FIELDS                                                RE0530
0349 C*                                                                   RE0530
0350 C                     MOVE 'RECRG'   LFILE                           RE0530
0351 C                     MOVE 'RE0530  'LPROG                           RE0530
0352 C*                                                                   RE0530
0353 C*  SET-UP BLANK LKEY                                                RE0530
0354 C*                                                                   RE0530
0355 C                     MOVE ' '       BLK200200                       RE0530
0356 C                     MOVE BLK200    LKEY                            RE0530
0357 C*                                                                   RE0530
0358 C*  SET-UP ZEROES                                                    RE0530
0359 C                     Z-ADD0         ZERO03  30                      RE0530
0360 C                     Z-ADD0         ZERO05  50                      RE0530
0361 C                     Z-ADD0         ZERO15 150                      RE0530
0362 C*                                                                   RE0530
0363 C*  SET-UP TRAILER KEY                                               RE0530
0364 C*                                                                   RE0530
0365 C                     MOVEL'99999999'TRLRKY 12                       RE0530
0366 C                     MOVE '999D'    TRLRKY                          RE0530
0367 C*                                                                   RE0530
0368 C*  EXECUTE ZSYSTM                                                   RE0530
0369 C*                                                                   RE0530
0370 C                     EXSR ZSYSTM                                    RE0530
0371 C  N99                GOTO TAG01                                     RE0530
0372 C                     SETON                     U7LR  ** DB ERROR 90 RE0530
0373 C                     MOVE 'TABLE'   LFILE                           RE0530
0374 C                     MOVELZTABKY    LKEY                            RE0530
0375 C                     Z-ADD90        LDBNO                           RE0530
0376 C                     GOTO ENDFC                                     RE0530
0377 C*                                                                   RE0530
0378 C           TAG01     TAG                             ** TAG01 TAG   RE0530
0379 C*                                                                   RE0530
0380 C*  CHAIN TO THE TRAILER                                             RE0530
0381 C*                                                                   RE0530
0382 C                     SETOF                     9988                 RE0530
0383 C           TRLRKY    CHAINRECRG                99                   RE0530
0384 C  N99                                                               RE0530
0385 CAN 88                GOTO TAG02                                     RE0530
0386 C                     SETON                     U7LR  ** DB ERROR 91 RE0530
0387 C                     MOVELTRLRKY    LKEY                            RE0530
0388 C                     Z-ADD91        LDBNO                           RE0530
0389 C                     GOTO ENDFC                                     RE0530
0390 C*                                                                   RE0530
0391 C           TAG02     TAG                             ** TAG02 TAG   RE0530
0397 C*                                                                   S01117
0398 C*  OUTPUT HEADINGS                                                  S01117
0399 C                     SETON                     83                   S01117
0392 C*                                                                   RE0530
0393 C*  IF AUDIT REPORT AND NO INPUT TODAY, GOTO ENDFC                   RE0530
0394 C*                                                                   RE0530
0395 C   U1 82             SETON                     LR81                 RE0530
0396 C   U1 82             GOTO ENDFC                                     RE0530
0397 C***********                                                         S01117
0398 C***OUTPUT*HEADINGS                                                  S01117
0399 C***********          SETON                     83                   S01117
0400 C*                                                                   RE0530
0401 C*  BUILD TABLE OF CURRENCY NAMES AND DECIMAL PLACES.                RE0530
0402 C*  CCY NAMES REMOVED UNLESS REQUIRED, TO SAVE SPACE.                RE0530
0403 C*                                                                   RE0530
0404 C                     MOVE BLK200    TABKEY                          RE0530
0405 C                     MOVE '20'      TAB2                            RE0530
0406 C           TABKEY    SETLLTABLE                                     RE0530
0407 C                     Z-ADD0         J       30                      RE0530
0408 C           ARC       TAG                             ** ARC TAG     RE0530
0409 C                     SETOF                     727192               RE0530
0410 C                     READ TABLE                    91               RE0530
0411 C   71                                                               RE0530
0412 COR 91                GOTO ENDFC                                     RE0530
0413 C           RECI      COMP 'D'                  9292                 RE0530
0414 C  N92      SREC      COMP 1                    9292                 RE0530
0415 C   92                GOTO ARC                                       RE0530
0416 C           J         ADD  1         J                               RE0530
0417 C                     MOVE CCY       ACCY,J                          RE0530
0418 C                     MOVE CDP       ACDP,J                          RE0530
0419 C                     GOTO ARC                                       RE0530
0420 C*                                                                   RE0530
0421 C           ENDFC     TAG                             ** ENDFC TAG   RE0530
0422 C*                                                                   RE0530
0423 C                     TIME           MTIME   60                      RE0530
0424 C*                                                                   RE0530
0425 C                     ENDSR                                          RE0530
0426 C*                                                                   RE0530
0427 C********************************************************************RE0530
0428 C**                                                                  RE0530
0429 C**   SUBR. - TO FORMAT RECORD DETAILS PRIOR TO PRINTING             RE0530
0430 C**                                                                  RE0530
0431 C           FORMT     BEGSR                           ***  FORMT  ***RE0530
0432 C*                                                                   RE0530
0433 C*  CHECK CURRENCY DECIMAL PLACES                                    RE0530
0434 C*                                                                   RE0530
0435 C                     SETOF                     606162               RE0530
0436 C                     SETOF                     63                   RE0530
0437 C                     Z-ADD1         J       30                      RE0530
0438 C           MCCCY     LOKUPACCY,J                   91               RE0530
0439 C   91                GOTO FORMT1                                    RE0530
0440 C                     SETON                     U7LR  ** DB ERROR 01 RE0530
0441 C                     MOVE 'TABLE'   LFILE                           RE0530
0442 C                     MOVELMCCCY     LKEY                            RE0530
0443 C                     Z-ADD1         LDBNO                           RE0530
0444 C                     GOTO FORMTE                                    RE0530
0445 C*                                                                   RE0530
0446 C           FORMT1    TAG                             ** FORMT1 TAG  RE0530
0447 C*                                                                   RE0530
0448 C           ACDP,J    COMP 1                    626061               RE0530
0449 C   62      ACDP,J    COMP 2                    63  62               RE0530
0450 C*                                                                   RE0530
0451 C*  STANDARD FORMATTING - FORMAT LAST CHANGE DATE                    RE0530
0452 C*                                                                   RE0530
0453 C                     Z-ADDMLCD      ZDAYNO                          RE0530
0454 C                     EXSR ZDATE2                                    RE0530
0455 C                     MOVE ZADATE    WLCD    7                       RE0530
0456 C*                                                                   RE0530
0457 C           FORMTE    ENDSR                           ** FORMTE TAG  RE0530
0458 C*                                                                   RE0530
0459 C********************************************************************RE0530
0460 C**                                                                  RE0530
0461 C**   SUBR. - TO ADD 1 TO RN,H AND TO ADD ZZAMT TO RW/RD,H           RE0530
0462 C**                                                                  RE0530
0463 C           NPZTOT    BEGSR                           ***  NPZTOT ***RE0530
0464 C                     Z-ADDH         H       10                      RE0530
0465 C*                                                                   RE0530
0466 C           RN,H      ADD  1         RN,H                            RE0530
0467 C*                                                                   RE0530
0468 C                     Z-ADDRW,H      ZZTOTI                          RE0530
0469 C                     Z-ADDRD,H      ZZTOTD                          RE0530
0470 C                     EXSR GLZADD                                    RE0530
0471 C                     Z-ADDZZTOTI    RW,H                            RE0530
0472 C                     Z-ADDZZTOTD    RD,H                            RE0530
0473 C*                                                                   RE0530
0474 C                     ENDSR                                          RE0530
0475 C********************************************************************RE0530
0476 C**                                                                  RE0530
0477 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   RE0530
0478 C**                                                                  RE0530
0479 C           ZSYSTM    BEGSR                           *** ZSYSTM *** RE0530
0480 C**                                                                  RE0530
0481 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.                    RE0530
0482 C                     MOVEL'01      'ZTABKY 12                       RE0530
0483 C                     MOVE '  10'    ZTABKY                          RE0530
0484 C**                                                                  RE0530
0485 C           ZTABKY    CHAINTABLE                99    ON NOT THERE   RE0530
0486 C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED RE0530
0487 C**                                                                  RE0530
0488 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    RE0530
0489 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  RE0530
0490 C**                                                                  RE0530
0491 C                     ENDSR                                          RE0530
0492 C**                                                                  RE0530
0493 C**                                                                  RE0530
0494 C********************************************************************RE0530
0495 C**                                                                  RE0530
0496 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.            RE0530
0497 C**                                                                  RE0530
0498 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.         RE0530
0499 C**                                                                  RE0530
0500 C           ZDATE2    BEGSR                           *** ZDATE2 *** RE0530
0501 C**                                                                  RE0530
0502 C**   CLEAR DATE FIELDS.                                             RE0530
0503 C                     Z-ADD0         ZDATE   60                      RE0530
0504 C                     MOVEL'       ' ZADATE  7                       RE0530
0505 C**                                                                  RE0530
0506 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.                        RE0530
0507 C                     Z-ADDZDAYNO    ZDAYNO  50                      RE0530
0508 C**                                                                  RE0530
0509 C**   DETERMINE YEAR NUMBER.                                         RE0530
0510 C**                                                                  RE0530
0511 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    RE0530
0512 C           ZDAYNO    SUB  1         ZDAYN1  50   99                 RE0530
0513 C   99                GOTO ZDEND2                                    RE0530
0514 C**                                                                  RE0530
0515 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             RE0530
0516 C           ZDAYN1    DIV  1461      ZLYR    20                      RE0530
0517 C                     MVR            ZDAYN1           SAVE REMAINING RE0530
0518 C**                                                   DAYS           RE0530
0519 C**   CALCULATE NUMBER OF REMAINING YEARS.                           RE0530
0520 C                     Z-ADD1         ZWRK2   20                      RE0530
0521 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *RE0530
0522 C           ZDAYN1    COMP ZYDY,ZWRK2             90                 RE0530
0523 C  N90      ZWRK2     ADD  1         ZWRK2                           RE0530
0524 C  N90                GOTO ZDTAG1                                    RE0530
0525 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON RE0530
0526 C**                                                                  RE0530
0527 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  RE0530
0528 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          RE0530
0529 C**                                                                  RE0530
0530 C**   CALCULATE ACTUAL YEAR NUMBER.                                  RE0530
0531 C           ZLYR      MULT 4         ZWRK3   30                      RE0530
0532 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972   RE0530
0533 C                     Z-ADDZWRK3     ZYEAR   20                      RE0530
0534 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           RE0530
0535 C**                                                                  RE0530
0536 C**   DETERMINE MONTH NUMBER.                                        RE0530
0537 C**                                                                  RE0530
0538 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         RE0530
0539 C                     SETOF                     9293                 RE0530
0540 C   91      ZDAYN1    COMP 59                     9293               RE0530
0541 C   91N92   ZDAYN1    SUB  1         ZDAYN1                          RE0530
0542 C**                                                                  RE0530
0543 C**   CALCULATE MONTH NUMBER.                                        RE0530
0544 C                     Z-ADD2         ZWRK2                           RE0530
0545 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *RE0530
0546 C           ZDAYN1    COMP ZMDY,ZWRK2             94                 RE0530
0547 C  N94      ZWRK2     ADD  1         ZWRK2                           RE0530
0548 C  N94                GOTO ZDTAG2                                    RE0530
0549 C           ZWRK2     SUB  1         ZWRK2                           RE0530
0550 C**                                                                  RE0530
0551 C                     Z-ADDZWRK2     ZMTH    20       MONTH          RE0530
0552 C**                                                                  RE0530
0553 C**   DETERMINE DAY OF MONTH.                                        RE0530
0554 C**                                                                  RE0530
0555 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.                          RE0530
0556 C           ZDAYN1    ADD  1         ZDAYN1                          RE0530
0557 C**                                                                  RE0530
0558 C**   CALCULATE DAY OF MONTH.                                        RE0530
0559 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            RE0530
0560 C**                                                                  RE0530
0561 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       RE0530
0562 C   93      ZDAY      ADD  1         ZDAY                            RE0530
0563 C**                                                                  RE0530
0564 C**   FORMAT DATE, DDMMYY OR MMDDYY.                                 RE0530
0565 C  N98                MOVELZDAY      ZWRK4   40                      RE0530
0566 C   98                MOVE ZDAY      ZWRK4                           RE0530
0567 C  N98                MOVE ZMTH      ZWRK4                           RE0530
0568 C   98                MOVELZMTH      ZWRK4                           RE0530
0569 C                     MOVELZWRK4     ZDATE                           RE0530
0570 C                     MOVE ZYEAR     ZDATE                           RE0530
0571 C**                                                                  RE0530
0572 C**   FORMAT ALPHA DATE, DDMMMYY.                                    RE0530
0573 C           ZDAY      COMP 10                     95                 RE0530
0574 C                     MOVELZDAY      ZWRK5   5                       RE0530
0575 C   95                MOVEL' '       ZWRK5                           RE0530
0576 C                     MOVE ZMNM,ZMTH ZWRK5                           RE0530
0577 C                     MOVELZWRK5     ZADATE                          RE0530
0578 C                     MOVE ZYEAR     ZADATE                          RE0530
0579 C**                                                                  RE0530
0580 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*RE0530
0581 C**                                                                  RE0530
0582 C**                                                                  RE0530
0583 C********************************************************************RE0530
0584 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  RE0530
0585 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            RE0530
0586 C*                                                                   RE0530
0587 CSR         GLZADD    BEGSR                           *** GLZADD ****RE0530
0588 C*                                                                   RE0530
0589 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  RE0530
0590 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS RE0530
0591 C*                                                                   RE0530
0592 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       RE0530
0593 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  RE0530
0594 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  RE0530
0595 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  RE0530
0596 C*                                                                   RE0530
0597 CSR                   EXSR GLZSUM                                    RE0530
0598 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *RE0530
0599 C*                                                                   RE0530
0600 C********************************************************************RE0530
0601 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            RE0530
0602 C*                        GLZADD, GLZSUB, GLZCMP.                    RE0530
0603 C*          PARAMETERS PASSED -                                      RE0530
0604 C*                     I/P ZZAMTI ZZAMTD                             RE0530
0605 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       RE0530
0606 C*                                                                   RE0530
0607 CSR         GLZSUM    BEGSR                           *** GLZSUM ****RE0530
0608 C*                                                                   RE0530
0609 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  RE0530
0610 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  RE0530
0611 CSR                   SETOF                     919293               RE0530
0612 CSR                   SETOF                     949599               RE0530
0613 C*                                                                   RE0530
0614 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      RE0530
0615 CSR         ZZAMTI    COMP 0                      9293               RE0530
0616 CSR 93      ZZAMTD    COMP 0                      9293               RE0530
0617 CSR 93                GOTO ZZSEND                     ZERO BYPASS    RE0530
0618 C*                                                                   RE0530
0619 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       RE0530
0620 CSR         ZZTOTI    COMP 0                      9193               RE0530
0621 CSR 93      ZZTOTD    COMP 0                      9193               RE0530
0622 C*                                                                   RE0530
0623 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           RE0530
0624 CSR 93                Z-ADDZZAMTI    ZZTOTI                          RE0530
0625 CSR 93                Z-ADDZZAMTD    ZZTOTD                          RE0530
0626 CSR 93                GOTO ZZSEND                     ZERO BYPASS    RE0530
0627 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        RE0530
0628 CSR 91N92                                                            RE0530
0629 CORN91 92             GOTO ZZOFPS                                    RE0530
0630 C*                                                                   RE0530
0631 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      RE0530
0632 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   RE0530
0633 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.RE0530
0634 C*                                                                   RE0530
0635 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VERE0530
0636 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VERE0530
0637 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           RE0530
0638 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           RE0530
0639 C*                                                                   RE0530
0640 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    RE0530
0641 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. RE0530
0642 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      RE0530
0643 CSRN99                Z-ADDZZWK2     ZZTOTD                          RE0530
0644 CSRN99                Z-ADDZZWK3     ZZTOTI                          RE0530
0645 C*                                                                   RE0530
0646 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. RE0530
0647 CSR 99                Z-ADD0         ZZAMT  153                      RE0530
0648 CSR                   GOTO ZZSEND                                    RE0530
0649 C*                                                                   RE0530
0650 C* THE 'SIGNS' ARE DIFFERENT                                         RE0530
0651 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**RE0530
0652 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            RE0530
0653 C*                                                                   RE0530
0654 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      RE0530
0655 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      RE0530
0656 C*                                                                   RE0530
0657 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           RE0530
0658 C*                                                                   RE0530
0659 CSR 91                Z-SUBZZTOTI    ZZTOTI                          RE0530
0660 CSR 91                Z-SUBZZTOTD    ZZTOTD                          RE0530
0661 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            RE0530
0662 C*                                                                   RE0530
0663 CSR         ZZTOTI    COMP ZZAMTI               93  95               RE0530
0664 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               RE0530
0665 C*                                                                   RE0530
0666 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   RE0530
0667 CSR 95                Z-ADD0         ZZTOTI                          RE0530
0668 CSR 95                Z-ADD0         ZZTOTD                          RE0530
0669 CSR 95                GOTO ZZSEND                                    RE0530
0670 C*                                                                   RE0530
0671 C* IF ZZTOT GT. ZZAMT.                                               RE0530
0672 CSR 93      ZZAMTD    COMP ZZTOTD               94                   RE0530
0673 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          RE0530
0674 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           RE0530
0675 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          RE0530
0676 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          RE0530
0677 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          RE0530
0678 C*                                                                   RE0530
0679 C*                                                                   RE0530
0680 C* IF ZZAMT GT. ZZTOT.                                               RE0530
0681 CSRN93      ZZTOTD    COMP ZZAMTD               94                   RE0530
0682 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      RE0530
0683 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           RE0530
0684 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          RE0530
0685 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          RE0530
0686 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          RE0530
0687 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          RE0530
0688 C*                                                                   RE0530
0689 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          RE0530
0690 CSR                   SETOF                     94                   RE0530
0691 CSR 93 91                                                            RE0530
0692 CORN93 92             SETON                     94                   RE0530
0693 CSR 94                Z-SUBZZTOTI    ZZTOTI                          RE0530
0694 CSR 94                Z-SUBZZTOTD    ZZTOTD                          RE0530
0695 C**                                                                  RE0530
0696 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            RE0530
0697 CSR 92                Z-SUBZZAMTI    ZZAMTI                          RE0530
0698 CSR 92                Z-SUBZZAMTD    ZZAMTD                          RE0530
0699 CSR         ZZSEND    TAG                             ** ZZSEND TAG *RE0530
0700 C**                                                                  RE0530
0701 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           RE0530
0702 CSR                   SETOF                     96                   RE0530
0703 CSR         ZZTOTD    COMP 0                        91               RE0530
0704 CSR 91      ZZTOTI    COMP 0                      96                 RE0530
0705 CSR 96                MOVE '.000-'   ZZNEGD  5                       RE0530
0706 CSR                   ENDSR                             ** ENDSR **  RE0530
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
0707 C********************************************************************RE0530
     C/EJECT
0708 O*  STANDARD OUTPUT                                                  RE0530
0709 O*                                                                   RE0530
0710 ORE0530P1H  203   83                                                 S01124
0711 O       OR        OF                                                 RE0530
0711 O*******OR**      U7                                           E12855S01117
0712 O*                                                                   RE0530
0713 O*  STANDARD HEADINGS                                                RE0530
0714 O*                                                                   RE0530
0715 O***********                        20 'REFERENCE RE0530'            S01117
0715 O                                   22 'REFERENCE RE0530P1'          S01117
0716 O                         TITL      89                               RE0530
0717 O                                  104 'DATE'                        RE0530
0718 O                         RUNA     112                               RE0530
0719 O                                  122 'PAGE'                        RE0530
0720 O                         PAGE  Z  126                               RE0530
0721 O        H  1     83                                                 RE0530
0722 O       OR        OF                                                 RE0530
0711 O*******OR**      U7                                           E12855S01117
0723 O                       U1          16 'AUDIT REPORT'                RE0530
0724 O                      NU1          18 'LISTING REPORT'              RE0530
0725 O*                                                                   RE0530
0726 O*  NAME OF FILE OR RECORD                                           RE0530
0727 O*                                                                   RE0530
0728 O                                   73 'CHARGES SUB-TYPES LIST'      RE0530
0729 O*                                                                   RE0530
0730 O*  STANDARD OUTPUT                                                  RE0530
0731 O*                                                                   RE0530
0732 O                         MTIME    112 '  .  .  '                    RE0530
0733 O        H  2     83                                                 RE0530
0734 O       OR        OF                                                 RE0530
0711 O*******OR**      U7                                           E12855S01117
0735 O                       U1          16 '------------'                RE0530
0736 O                      NU1          18 '--------------'              RE0530
0737 O*                                                                   RE0530
0738 O*  UNDERLINE NAME OF FILE OR RECORD                                 RE0530
0739 O*                                                                   RE0530
0740 O                                   73 '----------------------'      RE0530
0741 O*                                                                   RE0530
0742 O*  NON-STANDARD HEADINGS                                            RE0530
0743 O*                                                                   RE0530
0744 O        H  1     83                                                 RE0530
0745 O       OR        OF                                                 RE0530
0746 O                                   99 '------- R  E  B  A  T'       RE0530
0747 O**********                        123 'E ------  A/C   CHANGE'                   RE0530 CGL029
     O                                  124 'E ------   ACCOUNT  CHG'                         CGL029
0748 O                                  132 'ACTION'                      RE0530
0749 O        H  2     83                                                 RE0530
0750 O       OR        OF                                                 RE0530
0751 O                                   13 'SUB-TYPE CCY'                RE0530
0752 O                                   32 'TITLE'                       RE0530
0753 O                                   57 'MIN.CHARGE'                  RE0530
0754 O                                   75 'MAX.CHARGE'                  RE0530
0755 O                                   88 'AMOUNT'                      RE0530
0756 O                                  106 'PER MIN. BAL'                RE0530
0757 O**********                        122 'CODE   DATE'                              RE0530 CGL029
     O                                  125 'CODE    DATE'                                    CGL029
0758 O*                                                                   RE0530
0759 O*  NON-STANDARD DETAILS                                             RE0530
0760 O*                                                                   RE0530
0761 O        D  1     84                                                 RE0530
0762 O                         MCSTP      7                               RE0530
0763 O                         MCCCY     13                               RE0530
0764 O                         MCHNM     44                               RE0530
0765 O                       60MMINC 4   61                               RE0530
0766 O                       61MMINC     61 '          0 . '              RE0530
0767 O                       62MMINC     61 '         0 .  '              RE0530
0768 O                       63MMINC     61 '        0 .   '              RE0530
0769 O                       60MMAXC 4   76                               RE0530
0770 O                       61MMAXC     76 '          0 . '              RE0530
0771 O                       62MMAXC     76 '         0 .  '              RE0530
0772 O                       63MMAXC     76 '        0 .   '              RE0530
0773 O                       60MREB  4   92                               RE0530
0774 O                       61MREB      92 '          0 . '              RE0530
0775 O                       62MREB      92 '         0 .  '              RE0530
0776 O                       63MREB      92 '        0 .   '              RE0530
0777 O                       60MPERM 4  109                               RE0530
0778 O                       61MPERM    109 '            0 . '            RE0530
0779 O                       62MPERM    109 '           0 .  '            RE0530
0780 O                       63MPERM    109 '          0 .   '            RE0530
0781 O**********               MACOD    115                                            RE0530 CGL029
0782 O**********               WLCD     124                                            RE0530 CGL029
0783 O**********               MCHTP    130                                            RE0530 CGL029
0781 O                         MACOD    120                                                   CGL029
0782 O                         WLCD     128                                                   CGL029
0783 O                         MCHTP    131                                                   CGL029
0784 O        D  2     84                                                 RE0530
0785 O                                   92 'EXCLUDE'                     RE0530
0786 O                       60MEXBL 4  109                               RE0530
0787 O                       61MEXBL    109 '            0 . '            RE0530
0788 O                       62MEXBL    109 '           0 .  '            RE0530
0789 O                       63MEXBL    109 '          0 .   '            RE0530
0797 O***DATABASE ERROR OUTPUT                                            S01117
0798 O***********                                                         S01117
0799 O********T*3      LR U7                                              S01117
0800 O********                           38 'DATABASE ERROR NO.-'         E12855
0800 O***********                        66 'DATABASE ERROR '       E12855S01117
0801 O********                 LDBNO     40                               E12855
0801 O***********              LDBNO     68                         E12855S01117
0802 O********                           48 'FILE-'                       E12855
0802 O***********                        82 'IN PROGRAM '           E12855S01117
0803 O***********              LPROG     90                         E12855S01117
0799 O********T*2      LR U7                                        E12855S01117
0804 O********                           60 'KEY-'                        E12855
0804 O***********                        56 'FILE '                 E12855S01117
0805 O********                 LFILE     53                               E12855
0805 O***********              LFILE     61                         E12855S01117
0804 O***********                        67 ', KEY '                E12855S01117
0805 O********                 LKEY      89                               E12855
0805 O***********              LKEY      96                         E12855S01117
0799 O        T 32     LR U7                                              S01117
0800 O                                   74 '*** DATABASE ERROR ***'      S01117
0836 O*                                                                   S01117
0837 O*  NO INPUT TODAY MESSAGE                                           S01117
0838 O*                                                                   S01117
0839 O        T   40   LR U1 82                                           S01117
0840 O                                   73 '*** NO INPUT TODAY ***'      S01117
0790 O*                                                                   RE0530
0791 O*  NO DETAILS TO REPORT MESSAGE                                     RE0530
0792 O*                                                                   RE0530
0793 O        T   40   LRNU1 77                                           RE0530
0794 O                                   72 '*** NO DETAILS TO REPORT'    RE0530
0795 O                                   76 ' ***'                        RE0530
0796 O*                                                                   RE0530
0918 O********T*  50   LR                                           S01117LN0374
0918 O        T 3      LR                                                 LN0374
0919 O                                   73 '*** END OF REPORT ***'       S01117
0806 O*                                                                   RE0530
0807 O*  STANDARD FILE CONTROLS                                           RE0530
0808 O*                                                                   RE0530
0809 O*  STANDARD HEADINGS                                                RE0530
0810 O*                                                                   RE0530
0811 O********T  203   LR                                                 S01117
0811 ORE0530AUT  203   LR                                                 S01117
0812 O********                           20 'REFERENCE RE0530'            S01117
0812 O                                   22 'REFERENCE RE0530AU'          S01117
0813 O                         TITL      89                               RE0530
0814 O                                  104 'DATE'                        RE0530
0815 O                         RUNA     112                               RE0530
0816 O                                  122 'PAGE'                        RE0530
0817 O***********              PAGE  Z  126                               S01117
0817 O                         PAGE1 Z  126                               S01117
0818 O        T  1     LR                                                 RE0530
0819 O                       U1          16 'AUDIT REPORT'                RE0530
0820 O                      NU1          18 'LISTING REPORT'              RE0530
0821 O*                                                                   RE0530
0822 O*  NAME OF FILE OR RECORD                                           RE0530
0823 O*                                                                   RE0530
0824 O                                   73 'CHARGES SUB-TYPES LIST'      RE0530
     O                                   88 '   RUN CONTROLS'             S01117
0825 O*                                                                   RE0530
0826 O*  STANDARD OUTPUT                                                  RE0530
0827 O*                                                                   RE0530
0828 O                         MTIME    112 '  .  .  '                    RE0530
0829 O        T  1     LR                                                 RE0530
0830 O                       U1          16 '------------'                RE0530
0831 O                      NU1          18 '--------------'              RE0530
0832 O*                                                                   RE0530
0833 O*  UNDERLINE NAME OF FILE OR RECORD                                 RE0530
0834 O*                                                                   RE0530
0835 O                                   73 '----------------------'      RE0530
0836 O*                                                                   RE0530
0837 O*  NO INPUT TODAY MESSAGE                                           RE0530
0838 O*                                                                   RE0530
0839 O        T   40   LR U1 82                                           RE0530
0840 O                                   73 '*** NO INPUT TODAY ***'      RE0530
0841 O*                                                                   RE0530
0842 O*  HEADINGS AND RUN CONTROLS COMMON TO AUDIT AND LIST               RE0530
0843 O*                                                                   RE0530
0844 O        T  220   LRN81                                              RE0530
0845 O                                   21 'RUN CONTROLS - '             RE0530
0846 O                                   77 '----------- PROGRAM ----'    RE0530
0847 O                                   84 '-------'                     RE0530
0848 O                                  116 '--------- FILE TRAILER '     RE0530
0849 O                                  124 '--------'                    RE0530
0850 O        T  1     LRN81                                              RE0530
0851 O                                   59 'NUMBER'                      RE0530
0852 O                                   84 'VALUE'                       RE0530
0853 O                                   99 'NUMBER'                      RE0530
0854 O                                  124 'VALUE'                       RE0530
0855 O        T  2     LRN81                                              RE0530
0856 O                                   13 'S/'                          RE0530
0857 O***********              LFILE     18                               S01117
0857 O                                   18 'RECRG'                       S01117
0858 O        T  2     LRN81                                              RE0530
0859 O                                   32 'NUMBER OF ACTIVE RECORDS'    RE0530
0860 O                                   40 'ON FILE'                     RE0530
0861 O                         RN,1  3   59                               RE0530
0862 O                         RW,1  Z   80                               RE0530
0863 O                         RD,1      84 '0   -'                       RE0530
0864 O                         NR,1  3   99                               RE0530
0865 O                         WN,1  Z  120                               RE0530
0866 O                         DC,1     124 '0   -'                       RE0530
0867 O                       79         130 '***'                         RE0530
0868 O*                                                                   RE0530
0869 O*  AUDIT REPORT ONLY RUN CONTROLS                                   RE0530
0870 O*                                                                   RE0530
0871 O        T  3     LR U1N82                                           RE0530
0872 O                                   29 'NUMBER OF RECORDS UPD'       RE0530
0873 O                                   39 'ATED TODAY'                  RE0530
0874 O                         RN,3  3   59                               RE0530
0875 O        T  2     LR U1N82                                           RE0530
0876 O                                   27 'LIVE RECORDS BEFORE'         RE0530
0877 O                                   39 'INPUT CYCLE'                 RE0530
0878 O                         NR,2  3   99                               RE0530
0879 O                         WN,2  Z  120                               RE0530
0880 O                         DC,2     124 '0   -'                       RE0530
0881 O        T  2     LR U1N82                                           RE0530
0882 O                                   26 'RECORDS INSERTED'            RE0530
0883 O                         NR,3  3   99                               RE0530
0884 O                         WN,3  Z  120                               RE0530
0885 O                         DC,3     124 '0   -'                       RE0530
0886 O        T  2     LR U1N82                                           RE0530
0887 O                                   25 'RECORDS AMENDED'             RE0530
0888 O                         NR,4  3   99                               RE0530
0889 O                         WN,4  Z  120                               RE0530
0890 O                         DC,4     124 '0   -'                       RE0530
0891 O        T  2     LR U1N82                                           RE0530
0892 O                                   25 'RECORDS DELETED'             RE0530
0893 O                         NR,5  3   99                               RE0530
0894 O                         WN,5  Z  120                               RE0530
0895 O                         DC,5     124 '0   -'                       RE0530
0896 O        T        LR U1N82                                           RE0530
0897 O                                   32 'LIVE RECORDS AFTER INPUT'    RE0530
0898 O                                   38 'CYCLE'                       RE0530
0899 O                         RN,2  3   59                               RE0530
0900 O                         RW,2  Z   80                               RE0530
0901 O                         RD,2      84 '0   -'                       RE0530
0902 O                         RN,4  3   99                               RE0530
0903 O                         RW,4  Z  120                               RE0530
0904 O                         RD,4     124 '0   -'                       RE0530
0905 O                       78         129 '***'                         RE0530
0906 O*                                                                   RE0530
0907 O*  LISTING REPORT ONLY RUN CONTROLS                                 RE0530
0908 O*                                                                   RE0530
0909 O        T        LRNU1                                              RE0530
0910 O                                   29 'NUMBER OF LIVE RECORD'       RE0530
0911 O                                   38 'S ON FILE'                   RE0530
0912 O                         RN,2  3   59                               RE0530
0913 O*                                                                   RE0530
0914 O*  OUTPUT DETAILS COMMON TO AUDIT AND LIST                          RE0530
0915 O*                                                                   RE0530
0916 O********T** 45   LR U8                                              S01117
0916 O        T  2     LR U8                                              S01117
0917 O                                  100 '*** DIFFERENCE ***'          RE0530
0790 O*                                                                   S01117
0791 O*  NO DETAILS TO REPORT MESSAGE                                     S01117
0792 O*                                                                   S01117
0793 O        T  1     LRNU1 77                                           S01117
0794 O                                   72 '*** NO DETAILS TO REPORT'    S01117
0795 O                                   76 ' ***'                        S01117
0918 O********T** 50   LR                                                 S01117
0919 O***********                        73 '*** END OF REPORT ***'       S01117
0798 O*                                                                   S01117
0797 O*  DATABASE ERROR OUTPUT                                            S01117
0798 O*                                                                   S01117
0799 O        T 32     LR U7                                              S01117
0800 O                                   66 'DATABASE ERROR '             S01117
0801 O                         DBASE     69                               S01117
0802 O                                   83 'IN PROGRAM '                 S01117
0803 O                         DBPGM     93                               S01117
0799 O        T  2     LR U7                                              S01117
0804 O                                   56 'FILE '                       S01117
0805 O                         DBFILE    64                               S01117
0804 O                                   70 ', KEY '                      S01117
0805 O                         DBKEY     99                               S01117
0920 ORECRG   E        88                                                 RE0530
0921 O                                   34 ' '                           RE0530
0922 O                         RN,1      37P                              RE0530
0923 O                         RN,2      40P                              RE0530
0924 O                         ZERO05    43P                              RE0530
0925 O                         ZERO05    46P                              RE0530
0926 O                         ZERO05    49P                              RE0530
0927 O                         RW,1      57P                              RE0530
0928 O                         RW,2      65P                              RE0530
0929 O                         ZERO15    73P                              RE0530
0930 O                         ZERO15    81P                              RE0530
0931 O                         ZERO15    89P                              RE0530
0932 O                         RD,1      91P                              RE0530
0933 O                         RD,2      93P                              RE0530
0934 O                         ZERO03    95P                              RE0530
0935 O                         ZERO03    97P                              RE0530
0936 O                         ZERO03    99P                              RE0530
0806 O*                                                                   S01117
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
