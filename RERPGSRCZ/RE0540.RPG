0001 H
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Retail ICD by Currency Audit & List')
0002 F*****************************************************************
0003 F*                                                               *
     F*  Midas - Retail Module
0005 F*                                                               *
0006 F*  RE0540 - RETAIL ICD BY CCY AUDIT AND LIST - S/RECCY          *
0007 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
0009 F*      1990, 1993                                               *
0011 F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Last Amend No. CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *  Prev Amend No. 201500             Date 14Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 21Dec99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
0010 F*                 S01413             DATE 13Apr93               *
0010 F*                 S01117                  12APR90               *
0010 F*                 E11279                  30JUL87               *
0011 F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  201500 - Handle deleted currency record.                     *
     F*  CDE002 - Revenue Analysis - Two new fields added to report.  *
     F*  S01413 - Release 3 Incorporation.                            *
     F*  S01117 - Release Ten Multibranching                          *
     F*  E11279 - Array for currencies too small                      *
     F*                                                               *
0012 F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0014 F***RECCY***UF  F     128 12AI     2 DISK                            S01413
     FRECCYDXCIF  E           K        DISK                               S01413
     FRECCY   IF  E           K        DISK                               S01413
     F            RECCYZF                           KIGNORE               S01413
     FRECCYZ  UF  F     128            DISK                               S01413
0015 F***TABLE** IF  F      96 12AI     2 DISK                                                CGL029
     FTABLE   IF  F     126 12AI     2 DISK                                                   CGL029
     FTABTBRE IF  E                    DISK                               S01413
0017 F*RE0540P1O***F*    132     OF     PRINTER                     S01124S01117
0017 FRE0540P1O   F     132     OF     PRINTER      KINFDS SPOOL          S01117
0017 FRE0540AUO   F     132     OE     PRINTER      KINFDS SPOOLU         S01117
0018 F*
0019 F*       U8      FILE OUT OF BALANCE
0020 F*       U7      DATABASE ERROR
0021 F*       89      MASTER FILE - HEADER
0022 F*       88      MASTER FILE - TRAILER
0023 F*       87      MASTER FILE - DETAIL RECORD -CORRECT RECORD TYPE-
0025 F*       85      FIRST CYCLE IND.
0026 F*       84      PRINT THIS DETAIL RECORD
0027 F*       83      PRINT HEADINGS
0028 F*       82      NO INPUT TODAY
0029 F*       81      AUDIT REPORT WITH NO INPUT TODAY -U1 AND 82-
0030 F*       80      UPDATE TRAILER BY EXCEPTION OUTPUT
0031 F*       79      FILE OUT OF BALANCE - NUMBER OF ACTIVE RECORDS
0032 F*       78      FILE OUT OF BALANCE - LIVE RECORDS AFTER INPUT
0033 F*       77      LISTING REPORT WITH NO DETAILS TO REPORT
0034 F***     76      SPARE
0034 F*       76      MAXIMUM DEBIT CAPITALISATION FIELD IS BLANK
0035 F*       75      ACTIVE DETAIL RECORD READ - RECI NOT *
0036 F*       74      LIVE DETAIL RECORD READ - RECI IS D AND CHTP NOT D
0037 F*       73      DETAIL RECORD UPDATED TODAY - LCD EQUALS RUN DATE
0038 F*       72      CURRENCY RECORD ON TABLE FILE
0039 F*       71      TABLE CATCHALL
     F*       70      ICD RECORD ON TABLE FILE
     F*       64      END OF MASTER FILE
0040 F*       63      CURRENCY HAS 3 DECIMAL PLACES
0041 F*       62      CURRENCY HAS 2 DECIMAL PLACES
0042 F*       61      CURRENCY HAS 1 DECIMAL PLACE
0043 F*       60      CURRENCY HAS 0 DECIMAL PLACES
     F*       59      MAXIMUM CREDIT CAPITALISATION FIELD IS BLANK
     F*       51      PROCESS ADDITION OF RETAIL ICD                      S01413
     F*                 BY CURRENCY EXTENSION FILE                        S01413
     F*       52      ALLOW PRINTING OF FIXED ACCOUNT CHARGE AMOUNT       S01413
     F*       17      COMMISSION ON DAILY STATEMENTS ACTIVE               S01413
     F*       35      MAX. COMMISSION ON DAILY STATEMENTS = 99S           S01413
     F*       18      CDE002 (REVENUE ANALYSIS) PRESENT                   CDE002
0044 E*
0046 E*    RN/RW/RD,1 ARE COUNT/HASH OF ACTIVE RECORDS
0047 E*    RN/RW/RD,2 ARE COUNT/HASH OF LIVE RECORDS
0048 E*    RN,3 IS COUNT OF RECORDS UPDATED TODAY. RW/RD,3 ARE NOT USED
0049 E*    RN/RW/RD,4 ARE COUNT/HASH OF LIVE RECORDS CALCULATED FROM TRLR
0050 E                    RN          4  5 0
0051 E                    RW          4 15 0
0052 E                    RD          4  3 0
0053 E*    ARRAYS OF CURRENCY CODES, NAMES AND DECIMAL PLACES.
0054 E*    NAMES REMOVED UNLESS REQUIRED, TO SAVE SPACE.
0055 E********************ACCY       99  3                                E11279
0056 E********************ACNM       99 14                                E11279
0057 E********************ACDP       99  1 0                              E11279
     E                    ACCY      150  3                                E11279
     E                    ACNM      150 14                                E11279
     E                    ACDP      150  1 0                              E11279
0058 E*    ARRAYS OF COUNTS AND HASH TOTALS IN THE MASTER FILE TRAILER
0059 E                    NR          5  5 0
0060 E                    WN          5 15 0
0061 E                    DC          5  3 0
0062 E*
0063 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
0064 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
0065 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E                    CPY@    1   1 80
0069 I*
0070 I*    MASTER FILE - HEADER
0071 I*
0072 I***RECCY***NS  89   1 CA                                            S01413
     IRECCYAF     89                                                      S01413
0093 I***********                                                         S01413
0097 I*****MASTER*FILE*-*TRAILER***************************************   S01413
0098 I***********                                                         S01413
0099 I********NS* 88   1 CZ                                               S01413
0100 I****************************************1   1 RECI                  S01413
0101 I************************************P  31  330TNLU                  S01413
0102 I***************************************34  34 IRRI                  S01413
0103 I************************************P  35  49 NR                    S01413
0104 I************************************P  50  89 WN                    S01413
0105 I************************************P  90  99 DC                    S01413
0077 I*
0078 I*    MASTER FILE - DETAIL
0079 I*
0080 I********NS**87**13*CD                                               S01413
0081 I***********                             1   1 MRECI                 S01413
0082 I***********                            10  12 MCCY                  S01413
0083 I***********                            13  13 MRECT                 S01413
0084 I***********                         P  31  330MTNLU                 S01413
0085 I***********                         P  34  360MORED                 S01413
0086 I***********                         P  37  390MLCD                  S01413
0087 I***********                            40  40 MCHTP                 S01413
0088 I***********                         P  41  470MHASH                 S01413
0089 I***********                         P  48  540MMIDC                 S01413
0090 I***********                         P  55  610MMADC                 S01413
0091 I***********                         P  62  680MMICC                 S01413
0092 I***********                         P  69  750MMACC                 S01413
     IRECCYDF     87                                                      S01413
     I              RECI                            MRECI                 S01413
     I              TNLU                            MTNLU                 S01413
     I              ORED                            MORED                 S01413
     I              LCD                             MLCD                  S01413
     I              CHTP                            MCHTP                 S01413
     I              HASH                            MHASH                 S01413
     I              MIDC                            MMIDC                 S01413
     I              MADC                            MMADC                 S01413
     I              MICC                            MMICC                 S01413
     I              MACC                            MMACC                 S01413
     I*                                                                   S01413
     I*    MASTER FILE - TRAILER                                          S01413
     I*                                                                   S01413
     IRECCYZ  NS  88   1 CZ                                               S01413
     I                                        1   1 RECI                  S01413
     I                                    P  31  330TNLU                  S01413
     I                                       34  34 IRRI                  S01413
     I                                    P  35  49 NR                    S01413
     I                                    P  50  89 WN                    S01413
     I                                    P  90  99 DC                    S01413
0106 I*                                                                   S01413
0107 I*    CATCHALL
0108 I        NS
0128 I*
0129 I*    TABLE FILE - CURRENCIES RECORD 1.
0130 I*
0131 ITABLE   NS  72   2 C2   3 C0
0132 I                                        1   1 RECI
0133 I                                        2   30RECT
0134 I                                       10  12 CCY
0135 I                                       13  130SREC
0136 I                                       14  27 CCNM
0137 I                                    P  28  348SPOT
0138 I                                       35  37 CCYS
0139 I                                       38  380CDP
0140 I                                       39  390TNOT
0141 I                                       40  40 DCCY
0142 I                                       41  44 SRC1
0143 I                                       45  48 SRC2
0144 I**********                             49  520TACC                                      CGL029
0145 I**********                             53  560TEQV                                      CGL029
0146 I**********                             57  600SWQV                                      CGL029
0147 I**********                             61  640TAC4                                      CGL029
0148 I**********                             65  680TAC5                                      CGL029
0149 I**********                             69  69 HIND                                      CGL029
0150 I**********                          P  70  768PART                                      CGL029
0151 I**********                             77  780SSNO                                      CGL029
0152 I**********                          P  79  858ERLC                                      CGL029
0153 I**********                             86  860MDIN                                      CGL029
0154 I**********                             87  870MDIA                                      CGL029
0155 I**********                             88  880MDIB                                      CGL029
0156 I**********                          P  90  920LCD                                       CGL029
0157 I**********                             93  93 CHTP                                      CGL029
0158 I**********                          P  94  960TNLU                                      CGL029
     I                                       49  580TACC                                      CGL029
     I                                       59  680TEQV                                      CGL029
     I                                       69  780SWQV                                      CGL029
     I                                       79  880TAC4                                      CGL029
     I                                       89  980TAC5                                      CGL029
     I                                       99  99 HIND                                      CGL029
     I                                    P 100 1068PART                                      CGL029
     I                                      107 1080SSNO                                      CGL029
     I                                    P 109 1158ERLC                                      CGL029
     I                                      116 1160MDIN                                      CGL029
     I                                      117 1170MDIA                                      CGL029
     I                                      118 1180MDIB                                      CGL029
     I                                    P 120 1220LCD                                       CGL029
     I                                      123 123 CHTP                                      CGL029
     I                                    P 124 1260TNLU                                      CGL029
0109 I*
0110 I*    TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.
0111 I*
0112 ITABLE   NS  70   2 C0   3 C1  12 C1
     I       AND      13 C0
0113 I                                        1   1 RECI
0114 I                                        2   30RECT
0115 I                                       12  130RCDE
0116 I                                       14  66 TITL
0117 I                                       67  67 DATF
0118 I                                       68  700DFBR
0119 I                                       74  74 MODI1
0120 I                                       75  75 MODI2
0121 I                                       76  76 MODI3
0122 I                                    P  77  790RUND
0123 I                                       80  86 RUNA
0124 I                                       87  870SFLG
0125 I                                    P  90  920LCD
0126 I                                       93  93 CHTP
0127 I                                    P  94  960TNLU
     I*
     I*    CATCHALL
     I        NS  71
0162 I*
0163 I*    DATA STRUCTURE FOR TABLE FILE KEY
0164 I*
0165 I            DS
0166 I                                        1  12 TABKEY
0167 I                                        1   2 TAB2
0168 I                                        9  11 TAB3A
0169 I                                       10  12 TAB3B
0170 I                                        9  12 TAB4
0171 I                                       12  12 TAB1
0172 I                                        6  11 TAB6
     I*                                                                   S01413
     I*    DATA STRUCTURE FOR RECCYD FILE                                 S01413
     I*                                                                   S01413
     I            DS                                                      S01413
     I                                        2  13 KEY                   S01413
     I                                       10  12 MCCY                  S01413
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
0173 I*
0174 I*    STANDARD LOCAL DATA AREA FIELDS
0175 I*
0176 ILDA        UDS                            256
     I***********                           134 138 DBFILE                S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I                                      134 141 LFILE                 S01117
     I                                      142 170 LKEY                  S01117
     I                                      171 180 LPROG                 S01117
     I                                      181 1830LDBNO                 S01117
     I*                                                                   CDE002
     ISCSARD    E DSSCSARDPD                                              CDE002
     I* SAR file details                                                  CDE002
     I*                                                                   CDE002
     IDSFDY     E DSDSFDY                                                 CDE002
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                CDE002
     I*                                                                   CDE002
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C*
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NO.  S01117
     C*
0181 C*  INITIALISE TO -PRINT NO HEADINGS- AND -PRINT NO DETAILS-
0182 C*
0183 C   84                SETON                     83                   S01413
0183 C  N84                SETOF                     83                   S01413
0183 C                     SETOF                     84                   S01413
0183 C***********          SETOF                     8384                 S01413
0185 C*                                                                   S01413
0185 C** INITIALISE RECCYD FIELDS                                         S01413
0185 C*                                                                   S01413
0185 C                     EXSR INTFLD                                    S01413
0184 C*
0185 C  N85                EXSR FIRSTC
     C  N85      *LOVAL    SETLLRECCY
0186 C                     SETON                     85
     C*  READS MASTER FILE
     C*
     C                     READ RECCY                    64
     C   64                SETON                     LR
     C   64                SETOF                     83                   S01413
     C   64                GOTO LASTR
0187 C*
0188 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR
0189 C*  AN AUDIT REPORT, GOTO LR PROCESSING.
0190 C*
0191 C   U7
0192 COR U1 82             GOTO LASTR
0193 C*
0194 C*  IF HEADER OR TRAILER READ, GOTO LR PROCESSING
0195 C*
0196 C   89
0197 COR 88                GOTO LASTR
0198 C*
0199 C*  IF INCORRECT - WRONG RECORD TYPE - DETAIL
0200 C*  RECORD READ, GOTO LR PROCESSING
0201 C*
0202 C  N87                GOTO LASTR
      *                                                                   S01413
      **   Access retail I.C.D. by currency extension file                S01413
     C           *IN51     IFEQ '1'                                       S01413
     C           *IN52     OREQ '1'                                       S01413
     C                     MOVE '1'       *IN58                           S01413
     C           MCCY      CHAINRECCYDXC             58                   S01413
     C                     END                                            S01413
0203 C*
0204 C*  PROCESSING NOW CONSISTS OF RUN CONTROLS, RECORD FORMATTING
0205 C*  FOR OUTPUT AND PRINTING THE RECORD.
0206 C*
0207 C*
0208 C*  RUN CONTROLS - AUDIT AND LIST CONTROLS ARE
0209 C*  MAINTAINED UNCONDITIONALLY
0210 C*
0211 C*  IF THERE IS NO HASH TOTAL FIELD ON THE MASTER FILE DETAIL RECORD,
0212 C*  THEN ZEROISE AND CONTINUE AS IF THERE IS.
0213 C*
0214 C                     Z-ADD0         MHASH  130
0215 C*
0216 C*  COUNT ACTIVE RECORDS READ - RECI NOT *
0217 C*  MOVE HASH AMOUNT INTO ZZAMT FIRST.
0218 C*
0219 C                     MOVE MHASH     ZZAMT
0220 C*
0221 C           MRECI     COMP '*'                  7575
0222 C   75                Z-ADD1         H
0223 C   75                EXSR NPZTOT
0224 C*
0225 C*  COUNT LIVE RECORDS READ - RECI IS D AND CHTP IS NOT D
0226 C*
0227 C           MRECI     COMP 'D'                      74
0228 C   74      MCHTP     COMP 'D'                  7474
0229 C   74                Z-ADD2         H
0230 C   74                EXSR NPZTOT
0231 C*
0232 C*  COUNT RECORDS UPDATED TODAY - LCD IS RUN DATE
0233 C*
0234 C           MLCD      COMP RUND                     73
0235 C   73      RN,3      ADD  1         RN,3
0236 C*
0237 C*  IF AUDIT REPORT, RECORDS UPDATED TODAY ARE PRINTED.
0238 C*  IF LISTING, LIVE RECORDS ARE PRINTED.
0239 C*  SET ON 84 IF THE RECORD IS TO BE PRINTED.
0240 C*
0241 C   U1 73
0242 CORNU1 74             SETON                       84
0243 C*
0244 C*  FORMAT THE RECORD IF IT IS TO BE PRINTED
0245 C*
0246 C   84                EXSR FORMT
0247 C*
0248 C   84 U7             GOTO LASTR
0249 C*
0250 C*
0251 C           LASTR     TAG                             ** LASTR TAG
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUM     ZSNUM   60                      S01117
     CLR                   OUT  LDA                                       S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ                             S01117
     CLR                   PARM *BLANKS   SENTY                           S01117
     CLR                   PARM           SFILE                           S01117
     CLR                   PARM           ZSNUM                           S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0252 C*
0253 CLR                   TIME           MTIME
0254 C*
0255 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR
0256 C*  AN AUDIT REPORT, NO FILE CONTROL CHECK DONE.
0257 C*
0258 CLR U7
0259 COR U1 82             GOTO END
0260 C*
0261 C*  FOR LIST, TEST FOR NO DETAILS TO REPORT
0262 C*
0263 CLRNU1      RN,2      COMP 0                        77
0264 C*
0265 C*  TEST FOR ALL ACTIVE RECORDS READ - COUNT AND HASH
0266 C*
0267 CLR         RN,1      COMP NR,1                 7979
0268 CLRN79      RW,1      COMP WN,1                 7979
0269 CLRN79      RD,1      COMP DC,1                 7979
0270 CLR 79                SETON                     U8
0271 C*
0272 C*  IF LISTING REPORT, GOTO END
0273 C*
0274 CLRNU1                GOTO END
0275 C*
0276 C*  CALCULATE NUMBER OF LIVE RECORDS FROM TRAILER
0277 C*
0278 CLR         NR,2      ADD  NR,3      RN,4
0279 CLR         RN,4      SUB  NR,5      RN,4             ** TOTAL
0280 C*
0281 C*  CALCULATE HASH TOTAL OF LIVE RECORDS AFTER INPUT FROM TRAILER
0282 C*
0283 C*  PUT HASH OF LIVE RECORDS BEFORE INPUT INTO ZZ FIELDS
0284 C*
0285 CLR                   Z-ADDWN,2      ZZTOTI
0286 CLR                   Z-ADDDC,2      ZZTOTD
0287 C*
0288 C*  ADD HASH OF INSERTED RECORDS
0289 C*
0290 CLR                   Z-ADDWN,3      ZZAMTI
0291 CLR                   Z-ADDDC,3      ZZAMTD
0292 CLR                   EXSR GLZSUM
0293 C*
0294 C*  ADD HASH OF AMENDMENTS
0295 C*
0296 CLR                   Z-ADDWN,4      ZZAMTI
0297 CLR                   Z-ADDDC,4      ZZAMTD
0298 CLR                   EXSR GLZSUM
0299 C*
0300 C*  SUBTRACT HASH OF DELETIONS
0301 C*
0302 CLR                   Z-SUBWN,5      ZZAMTI
0303 CLR                   Z-SUBDC,5      ZZAMTD
0304 CLR                   EXSR GLZSUM
0305 C*
0306 CLR                   MOVE ZZTOTI    RW,4
0307 CLR                   MOVE ZZTOTD    RD,4
0308 C*
0309 C*  COMPARE PROGRAM'S COUNT AND HASH OF LIVE RECORDS
0310 C*  READ WITH THOSE JUST CALCULATED.
0311 C*
0312 CLR         RN,2      COMP RN,4                 7878
0313 CLRN78      RW,2      COMP RW,4                 7878
0314 CLRN78      RD,2      COMP RD,4                 7878
0315 CLR 78                SETON                     U8
0316 C*
0317 C*  IF DATABASE ERROR, GOTO END
0318 C*
0319 CLR U8                GOTO END
0320 C*
0321 C*  UPDATE CHAIN TO THE TRAILER
0322 C*
0323 CLR                   SETOF                     9988
0324 C***LR******TRLRKY    CHAINRECCY                99                   S01413
     CLR         1         CHAINRECCYZ               99                   S01413
0325 CLRN99
0326 CAN 88                GOTO END01
0327 CLR                   SETON                     U7    ** DB ERROR 92
0328 CLR                   MOVELTRLRKY    LKEY
0329 CLR                   Z-ADD92        LDBNO
0330 CLR                   GOTO END
0331 C*
0332 CLR         END01     TAG                             ** END01 TAG
0333 C*
0334 C*  UPDATE THE TRAILER - IND 88 PERFORMS OUTPUT
0335 C*
0336 CLR                   EXCPT
0337 C*
0338 CLR         END       TAG                             ** END TAG
0339 C*
0340 C********************************************************************
0341 C**
0342 C**   SUBR. - TO PERFORM FIRST CYCLE PROCESSING.
0343 C**
0344 C           FIRSTC    BEGSR                           ***  FIRSTC ***
     C*                                                                   S01117
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
0345 C*
0346 C*  SET-UP LDA FIELDS
0347 C*
     C                     MOVE *BLANKS   LFILE                           S01117
0348 C                     MOVE 'RECCY'   LFILE
0349 C                     MOVE 'RE0540  'LPROG
0349 C                     MOVE 'RE0540  'DBPGM                           S01117
0350 C*
0351 C*  SET-UP BLANK LKEY
0352 C*
0353 C                     MOVE ' '       BLK200200
0354 C                     MOVE BLK200    LKEY
0355 C*
0356 C*  SET-UP ZEROES
0357 C                     Z-ADD0         ZERO03  30
0358 C                     Z-ADD0         ZERO05  50
0359 C                     Z-ADD0         ZERO15 150
0360 C*
0361 C*  SET-UP TRAILER KEY
0362 C*
0363 C                     MOVEL'99999999'TRLRKY 12
0364 C                     MOVE '999D'    TRLRKY
0362 C*                                                                   S01117
0397 C*  OUTPUT HEADINGS                                                  S01117
0398 C                     SETON                     83                   S01117
0365 C*
0366 C*  EXECUTE ZSYSTM
0367 C*
0368 C                     EXSR ZSYSTM
0369 C  N99                GOTO TAG01
0370 C                     SETON                     U7LR  ** DB ERROR 90
0371 C                     MOVE 'TABLE'   LFILE
0372 C                     MOVELZTABKY    LKEY
0373 C                     Z-ADD90        LDBNO
0374 C                     GOTO ENDFC
0375 C*
0376 C           TAG01     TAG                             ** TAG01 TAG
0377 C*
0378 C*  CHAIN TO THE TRAILER
0379 C*
0380 C                     SETOF                     9988
0381 C***********TRLRKY    CHAINRECCY                99                   S01413
0381 C           1         CHAINRECCYZ               99                   S01413
0382 C  N99
0383 CAN 88                GOTO TAG02
0384 C                     SETON                     U7LR  ** DB ERROR 91
0385 C                     MOVELTRLRKY    LKEY
0386 C                     Z-ADD91        LDBNO
0387 C                     GOTO ENDFC
0388 C*
0389 C           TAG02     TAG                             ** TAG02 TAG
0390 C*
0391 C*  IF AUDIT REPORT AND NO INPUT TODAY, GOTO ENDFC
0392 C*
0393 C           IRRI      COMP ' '                      82
0394 C   U1 82             SETON                     LR81
0395 C   U1 82             GOTO ENDFC
0396 C*
0397 C***OUTPUT*HEADINGS                                                  S01117
0398 C**********           SETON                     83                   S01117
0399 C*
0400 C*  BUILD TABLE OF CURRENCY NAMES AND DECIMAL PLACES.
0401 C*  CCY NAMES REMOVED UNLESS REQUIRED, TO SAVE SPACE.
0402 C*
0403 C                     MOVE BLK200    TABKEY
0404 C                     MOVE '20'      TAB2
0405 C           TABKEY    SETLLTABLE
0406 C                     Z-ADD0         J       30
0407 C           ARC       TAG                             ** ARC TAG
0408 C                     SETOF                     727192
0409 C                     READ TABLE                    91
0410 C   71
0411 COR 91                GOTO ENDFC
0412 C********** RECI      COMP 'D'                  9292                                     201500
0413 C  N92      SREC      COMP 1                    9292
0414 C   92                GOTO ARC
0415 C           J         ADD  1         J
0416 C                     MOVE CCY       ACCY,J
0417 C                     MOVE CCNM      ACNM,J
0418 C                     MOVE CDP       ACDP,J
0419 C                     GOTO ARC
0420 C*
0421 C           ENDFC     TAG                             ** ENDFC TAG
0422 C*
0423 C                     TIME           MTIME   60
     C*                                                                   S01413
     C**   CHAIN ON RETAIL TABLE FILE                                     S01413
     C*                                                                   S01413
     C           1         CHAINTABTBRE              97                   S01413
     C*                                                                   S01413
     C           CHOV      COMP 'Y'                      10               S01413
     C   10      MDPF      COMP 'F'                      11               S01413
     C           CDTO      COMP 'Y'                      12               S01413
     C           CDRI      COMP 'Y'                      13               S01413
     C           FXAC      COMP 'Y'                      14               S01413
     C           CINA      COMP 'Y'                      15               S01413
     C           CMBL      COMP 'Y'                      16               S01413
     C           CNDS      COMP 'Y'                      17               S01413
     C*                                                                   S01413
     C**   Initialisation of the work field number of read                S01413
     C*                                                                   S01413
     C           TSTMC     IFEQ 'Y'                                       S01413
     C                     MOVE '1'       *IN51                           S01413
     C                     END                                            S01413
     C           FACH      IFEQ 'Y'                                       S01413
     C                     MOVE '1'       *IN52                           S01413
     C                     END                                            S01413
     C           *IN51     IFEQ '1'                                       S01413
     C                     Z-ADD*ZEROS    WWCNT   10                      S01413
     C                     END                                            S01413
     C*                                                                   S01413
     C**    Access Switchable Features file to see if CDE002 is present   CDE002
     C                     CALL 'AOSARDR0'                                CDE002
     C                     PARM *BLANKS   @RTCD   7                       CDE002
     C                     PARM '*VERIFY' @OPTN   7                       CDE002
     C                     PARM 'CDE002'  @SARD   6                       CDE002
     C           SCSARD    PARM SCSARD    DSFDY                           CDE002
     C                     MOVE *OFF      *IN18                           CDE002
     C*                                                                   CDE002
     C** If core feature is switched ON, set on print indicator and       CDE002
     C** variable field to condition the rest of the processing.          CDE002
     C           @RTCD     IFEQ *BLANKS                                   CDE002
     C                     MOVE *ON       *IN18                           CDE002
     C                     ELSE                                           CDE002
     C*                                                                   CDE002
     C** Else, database error (return code other than *NRF)               CDE002
     C           @RTCD     IFNE '*NRF   '                                 CDE002
     C                     MOVEL'RE0540 ' DBPGM                           CDE002
     C                     MOVEL'SCSARDPD'DBFILE           ************   CDE002
     C                     MOVEL'CDE002'  DBKEY            * DBERR 01 *   CDE002
     C                     Z-ADD1         DBASE            ************   CDE002
     C                     OUT  LDA                                       CDE002
     C                     EXSR *PSSR                                     CDE002
     C                     SETON                     U7U8LR               CDE002
     C                     GOTO END                                       CDE002
     C                     ENDIF                                          CDE002
     C                     ENDIF                                          CDE002
     C*                                                                   CDE002
0424 C*
0425 C                     ENDSR
0426 C*
0427 C********************************************************************
0428 C**
0429 C**   SUBR. - TO FORMAT RECORD DETAILS PRIOR TO PRINTING
0430 C**
0431 C           FORMT     BEGSR                           ***  FORMT  ***
0432 C*
     C           MMADC     COMP *ZERO                    76
     C           MMACC     COMP *ZERO                    59
     C*                                                                   S01413
     C** CHECK IF MAXIMA EXIST                                            S01413
     C*                                                                   S01413
     C           MMADC     COMP *ALL'9'                  30               S01413
     C           MMACC     COMP *ALL'9'                  31               S01413
     C           HOMX      COMP *ALL'9'                  32               S01413
     C           ACMX      COMP *ALL'9'                  33               S01413
     C           DIMX      COMP *ALL'9'                  34               S01413
     C           DSMX      COMP *ALL'9'                  35               S01413
0432 C*
0433 C*  CHECK CURRENCY DECIMAL PLACES
0434 C*
0435 C                     SETOF                     606162
0436 C                     SETOF                     63
0437 C                     Z-ADD1         J       30
0438 C           MCCY      LOKUPACCY,J                   91
0439 C   91                GOTO FORMT1
0440 C                     SETON                     U7LR  ** DB ERROR 01
0441 C                     MOVE 'TABLE'   LFILE
0442 C                     MOVELMCCY      LKEY
0443 C                     Z-ADD1         LDBNO
0444 C                     GOTO FORMTE
0445 C*
0446 C           FORMT1    TAG                             ** FORMT1 TAG
0447 C*
0448 C           ACDP,J    COMP 1                    626061
0449 C   62      ACDP,J    COMP 2                    63  62
0450 C*
0451 C*  STANDARD FORMATTING - FORMAT LAST CHANGE DATE
0452 C*
0453 C                     Z-ADDMLCD      ZDAYNO
0454 C                     EXSR ZDATE2
0455 C                     MOVE ZADATE    WLCD    7
0456 C*
0457 C           FORMTE    ENDSR                           ** FORMTE TAG
0458 C*
0459 C********************************************************************
0460 C**
0461 C**   SUBR. - TO ADD 1 TO RN,H AND TO ADD ZZAMT TO RW/RD,H
0462 C**
0463 C           NPZTOT    BEGSR                           ***  NPZTOT ***
0464 C                     Z-ADDH         H       10
0465 C*
0466 C           RN,H      ADD  1         RN,H
0467 C*
0468 C                     Z-ADDRW,H      ZZTOTI
0469 C                     Z-ADDRD,H      ZZTOTD
0470 C                     EXSR GLZADD
0471 C                     Z-ADDZZTOTI    RW,H
0472 C                     Z-ADDZZTOTD    RD,H
0473 C*
0474 C                     ENDSR
0475 C********************************************************************
0460 C**                                                                  S01413
0461 C**   INTFLD - INITIALISE RECCYD FIELDS.                             S01413
0462 C**                                                                  S01413
0463 C           INTFLD    BEGSR                           ***  INTFLD ***S01413
0462 C*                                                                   S01413
0474 C                     MOVEL*BLANK    MRECI                           S01413
0474 C                     Z-ADD*ZERO     MTNLU                           S01413
0474 C                     Z-ADD*ZERO     MORED                           S01413
0474 C                     Z-ADD*ZERO     MLCD                            S01413
0474 C                     MOVEL*BLANK    MCHTP                           S01413
0474 C                     Z-ADD*ZERO     MHASH                           S01413
0474 C                     Z-ADD*ZERO     MMIDC                           S01413
0474 C                     Z-ADD*ZERO     MMADC                           S01413
0474 C                     Z-ADD*ZERO     MMICC                           S01413
0474 C                     Z-ADD*ZERO     MMACC                           S01413
0462 C*                                                                   S01413
0474 C                     ENDSR                                          S01413
0459 C********************************************************************S01413
0476 C**
0477 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.
0478 C**
0479 C           ZSYSTM    BEGSR                           *** ZSYSTM ***
0480 C**
0481 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.
0482 C                     MOVEL'01      'ZTABKY 12
0483 C                     MOVE '  10'    ZTABKY
0484 C**
0485 C           ZTABKY    CHAINTABLE                99    ON NOT THERE
0486 C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED
0487 C**
0488 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.
0489 C           DATF      COMP 'M'                      98MMDDYY, 98 ON
0490 C**
0491 C                     ENDSR
0492 C**
0493 C**
0494 C********************************************************************
0495 C**
0496 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.
0497 C**
0498 C**   THE YEAR 2000, BEING DIVISIBLE BY 400, IS A LEAP YEAR.
0499 C**
0500 C           ZDATE2    BEGSR                           *** ZDATE2 ***
0501 C**
0502 C**   CLEAR DATE FIELDS.
0503 C                     Z-ADD0         ZDATE   60
0504 C                     MOVEL'       ' ZADATE  7
0505 C**
0506 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.
0507 C                     Z-ADDZDAYNO    ZDAYNO  50
0508 C**
0509 C**   DETERMINE YEAR NUMBER.
0510 C**
0511 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.
0512 C           ZDAYNO    SUB  1         ZDAYN1  50   99
0513 C   99                GOTO ZDEND2
0514 C**
0515 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.
0516 C           ZDAYN1    DIV  1461      ZLYR    20
0517 C                     MVR            ZDAYN1           SAVE REMAINING
0518 C**                                                   DAYS
0519 C**   CALCULATE NUMBER OF REMAINING YEARS.
0520 C                     Z-ADD1         ZWRK2   20
0521 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *
0522 C           ZDAYN1    COMP ZYDY,ZWRK2             90
0523 C  N90      ZWRK2     ADD  1         ZWRK2
0524 C  N90                GOTO ZDTAG1
0525 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON
0526 C**
0527 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.
0528 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
0529 C**
0530 C**   CALCULATE ACTUAL YEAR NUMBER.
0531 C           ZLYR      MULT 4         ZWRK3   30
0532 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972
0533 C                     Z-ADDZWRK3     ZYEAR   20
0534 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR
0535 C**
0536 C**   DETERMINE MONTH NUMBER.
0537 C**
0538 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.
0539 C                     SETOF                     9293
0540 C   91      ZDAYN1    COMP 59                     9293
0541 C   91N92   ZDAYN1    SUB  1         ZDAYN1
0542 C**
0543 C**   CALCULATE MONTH NUMBER.
0544 C                     Z-ADD2         ZWRK2
0545 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *
0546 C           ZDAYN1    COMP ZMDY,ZWRK2             94
0547 C  N94      ZWRK2     ADD  1         ZWRK2
0548 C  N94                GOTO ZDTAG2
0549 C           ZWRK2     SUB  1         ZWRK2
0550 C**
0551 C                     Z-ADDZWRK2     ZMTH    20       MONTH
0552 C**
0553 C**   DETERMINE DAY OF MONTH.
0554 C**
0555 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.
0556 C           ZDAYN1    ADD  1         ZDAYN1
0557 C**
0558 C**   CALCULATE DAY OF MONTH.
0559 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
0560 C**
0561 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.
0562 C   93      ZDAY      ADD  1         ZDAY
0563 C**
0564 C**   FORMAT DATE, DDMMYY OR MMDDYY.
0565 C  N98                MOVELZDAY      ZWRK4   40
0566 C   98                MOVE ZDAY      ZWRK4
0567 C  N98                MOVE ZMTH      ZWRK4
0568 C   98                MOVELZMTH      ZWRK4
0569 C                     MOVELZWRK4     ZDATE
0570 C                     MOVE ZYEAR     ZDATE
0571 C**
0572 C**   FORMAT ALPHA DATE, DDMMMYY.
0573 C           ZDAY      COMP 10                     95
0574 C                     MOVELZDAY      ZWRK5   5
0575 C   95                MOVEL' '       ZWRK5
0576 C                     MOVE ZMNM,ZMTH ZWRK5
0577 C                     MOVELZWRK5     ZADATE
0578 C                     MOVE ZYEAR     ZADATE
0579 C**
0580 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*
0581 C**
0582 C**
0583 C********************************************************************
0584 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
0585 C*   IND '99' IS SET BY AN OVERFLOW ERROR
0586 C*
0587 CSR         GLZADD    BEGSR                           *** GLZADD ****
0588 C*
0589 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
0590 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
0591 C*
0592 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
0593 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
0594 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
0595 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
0596 C*
0597 CSR                   EXSR GLZSUM
0598 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
0599 C*
0600 C********************************************************************
0601 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
0602 C*                        GLZADD, GLZSUB, GLZCMP.
0603 C*          PARAMETERS PASSED -
0604 C*                     I/P ZZAMTI ZZAMTD
0605 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
0606 C*
0607 CSR         GLZSUM    BEGSR                           *** GLZSUM ****
0608 C*
0609 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
0610 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
0611 CSR                   SETOF                     919293
0612 CSR                   SETOF                     949599
0613 C*
0614 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
0615 CSR         ZZAMTI    COMP 0                      9293
0616 CSR 93      ZZAMTD    COMP 0                      9293
0617 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0618 C*
0619 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
0620 CSR         ZZTOTI    COMP 0                      9193
0621 CSR 93      ZZTOTD    COMP 0                      9193
0622 C*
0623 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
0624 CSR 93                Z-ADDZZAMTI    ZZTOTI
0625 CSR 93                Z-ADDZZAMTD    ZZTOTD
0626 CSR 93                GOTO ZZSEND                     ZERO BYPASS
0627 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
0628 CSR 91N92
0629 CORN91 92             GOTO ZZOFPS
0630 C*
0631 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
0632 CSR         ZZWK2     COMP 999                  93    '93' = CARRY
0633 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
0634 C*
0635 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
0636 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
0637 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
0638 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
0639 C*
0640 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
0641 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
0642 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
0643 CSRN99                Z-ADDZZWK2     ZZTOTD
0644 CSRN99                Z-ADDZZWK3     ZZTOTI
0645 C*
0646 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
0647 CSR 99                Z-ADD0         ZZAMT  153
0648 CSR                   GOTO ZZSEND
0649 C*
0650 C* THE 'SIGNS' ARE DIFFERENT
0651 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
0652 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
0653 C*
0654 CSR 92                Z-SUBZZAMTI    ZZAMTI 150
0655 CSR 92                Z-SUBZZAMTD    ZZAMTD  30
0656 C*
0657 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
0658 C*
0659 CSR 91                Z-SUBZZTOTI    ZZTOTI
0660 CSR 91                Z-SUBZZTOTD    ZZTOTD
0661 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
0662 C*
0663 CSR         ZZTOTI    COMP ZZAMTI               93  95
0664 CSR 95      ZZTOTD    COMP ZZAMTD               93  95
0665 C*
0666 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
0667 CSR 95                Z-ADD0         ZZTOTI
0668 CSR 95                Z-ADD0         ZZTOTD
0669 CSR 95                GOTO ZZSEND
0670 C*
0671 C* IF ZZTOT GT. ZZAMT.
0672 CSR 93      ZZAMTD    COMP ZZTOTD               94
0673 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
0674 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
0675 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
0676 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
0677 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
0678 C*
0679 C*
0680 C* IF ZZAMT GT. ZZTOT.
0681 CSRN93      ZZTOTD    COMP ZZAMTD               94
0682 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
0683 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
0684 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
0685 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
0686 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
0687 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
0688 C*
0689 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
0690 CSR                   SETOF                     94
0691 CSR 93 91
0692 CORN93 92             SETON                     94
0693 CSR 94                Z-SUBZZTOTI    ZZTOTI
0694 CSR 94                Z-SUBZZTOTD    ZZTOTD
0695 C**
0696 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
0697 CSR 92                Z-SUBZZAMTI    ZZAMTI
0698 CSR 92                Z-SUBZZAMTD    ZZAMTD
0699 CSR         ZZSEND    TAG                             ** ZZSEND TAG *
0700 C**
0701 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
0702 CSR                   SETOF                     96
0703 CSR         ZZTOTD    COMP 0                        91
0704 CSR 91      ZZTOTI    COMP 0                      96
0705 CSR 96                MOVE '.000-'   ZZNEGD  5
0706 CSR                   ENDSR                             ** ENDSR **
0707 C********************************************************************
     C/EJECT                                                              CDE002
     C********************************************************************CDE002
     C*                                                                   CDE002
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         CDE002
     C*                                                                   CDE002
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      CDE002
     C*                                                                   CDE002
     C* CALLS: NOTHING                                                    CDE002
     C*                                                                   CDE002
     C********************************************************************CDE002
     C*                                                                   CDE002
     C           *PSSR     BEGSR                           ** *PSSR **    CDE002
     C*                                                                   CDE002
     C           @RUN      IFEQ *BLANKS                                   CDE002
     C                     MOVE 'Y'       @RUN    1                       CDE002
     C                     DUMP                                           CDE002
     C                     ENDIF                                          CDE002
     C*                                                                   CDE002
     C                     ENDSR                                          CDE002
     C****************************************************************    CDE002
     C/EJECT
0708 O*  STANDARD OUTPUT
0709 O*
0710 ORE0540P1H  203   83                                                 S01124
0711 O       OR        OF
0712 O*
0713 O*  STANDARD HEADINGS
0714 O*
0715 O**********                         20 'REFERENCE RE0540'            S01117
0715 O                                   22 'REFERENCE RE0540P1'          S01117
0716 O                         TITL      89
0717 O                                  104 'DATE'
0718 O                         RUNA     112
0719 O                                  122 'PAGE'
0720 O                         PAGE  Z  126
0721 O        H  1     83
0722 O       OR        OF
0723 O                       U1          16 'AUDIT REPORT'
0724 O                      NU1          18 'LISTING REPORT'
0725 O*
0726 O*  NAME OF FILE OR RECORD
0727 O*
0728 O                                   63 'RETAIL INSTALLATION CONT'
0729 O                                   83 'ROL DATA BY CURRENCY'
0730 O*
0731 O*  STANDARD OUTPUT
0732 O*
0733 O                         MTIME    112 '  .  .  '
0734 O        H  2     83
0735 O       OR        OF
0736 O                       U1          16 '------------'
0737 O                      NU1          18 '--------------'
0738 O*
0739 O*  UNDERLINE NAME OF FILE OR RECORD
0740 O*
0741 O                                   63 '------------------------'
0742 O                                   83 '--------------------'
0743 O*
0744 O*  NON-STANDARD HEADINGS
0745 O*
0746 O        H 11     83
0747 O       OR        OF
0748 O                                  132 'CHANGE DATE  TYPE'
0749 O*
0750 O        H 21     84
0751 O                                   19 'CURRENCY NAME ;'
0752 O                         MCCY      24
0753 O                         ACNM,J    43
0754 O*
0755 O*  NON-STANDARD DETAILS
0756 O*
0757 O        D 22     84
0758 O                                   37 'MIN. DR INTEREST TO CAPI'
0759 O                                   43 'TALISE'
0760 O                       60MMIDC     60 '           0 -'
0761 O                       61MMIDC     60 '          0 . -'
0762 O                       62MMIDC     60 '         0 .  -'
0763 O                       63MMIDC     60 '        0 .   -'
0764 O                                   92 'MIN. CR INTEREST TO CAPI'
0765 O                                   98 'TALISE'
0766 O                       60MMICC    115 '           0 -'
0767 O                       61MMICC    115 '          0 . -'
0768 O                       62MMICC    115 '         0 .  -'
0769 O                       63MMICC    115 '        0 .   -'
0770 O                         WLCD     125
0771 O                         MCHTP    130
0772 O        D  2     84
0773 O                                   37 'MAX. DR INTEREST TO CAPI'
0774 O                                   43 'TALISE'
0775 O                   N76 60MMADC     60 '           0 -'
0776 O                   N76 61MMADC     60 '          0 . -'
0777 O                   N76 62MMADC     60 '         0 .  -'
0778 O                   N76 63MMADC     60 '        0 .   -'
     O                       76          60 'NOMAX'
0779 O                                   92 'MAX. CR INTEREST TO CAPI'
0780 O                                   98 'TALISE'
0781 O                   N59 60MMACC    115 '           0 -'
0782 O                   N59 61MMACC    115 '          0 . -'
0783 O                   N59 62MMACC    115 '         0 .  -'
0784 O                   N59 63MMACC    115 '        0 .   -'
     O                       59         115 'NOMAX'
     O        D  1     10 84                                              S01413
     O                                   35 'HIGHEST OVERDRAFT RATE'      S01413
     O*AB******************************************************           S01413
     O*AB******************************************************           S01413
     O                         HORT   B  60 '   0 .        %'             S01413
     O                                   68 'MINIMUM'                     S01413
     O                       60HOMN   B  85 '           0 -'              S01413
     O                       61HOMN   B  85 '          0 . -'             S01413
     O                       62HOMN   B  85 '         0 .  -'             S01413
     O                       63HOMN   B  85 '        0 .   -'             S01413
     O                                   98 'MAXIMUM'                     S01413
     O                N32 11 60HOMX   B 115 '           0 -'              S01413
     O                N32 11 61HOMX   B 115 '          0 . -'             S01413
     O                N32 11 62HOMX   B 115 '         0 .  -'             S01413
     O                N32 11 63HOMX   B 115 '        0 .   -'             S01413
     O*                                                                   S01413
     O                   N32N11HOMX   B 115 '   0 .        %'             S01413
     O                       32         123 'NOMAX'                       S01413
     O        D  1     12 84                                              S01413
     O                                   35 'TURNOVER RATE         '      S01413
     O                         ACRT   B  60 '0 .        %'                S01413
     O                                   68 'MINIMUM'                     S01413
     O                       60ACMN   B  85 '           0 -'              S01413
     O                       61ACMN   B  85 '          0 . -'             S01413
     O                       62ACMN   B  85 '         0 .  -'             S01413
     O                       63ACMN   B  85 '        0 .   -'             S01413
     O                                   98 'MAXIMUM'                     S01413
     O                   N33 60ACMX   B 115 '           0 -'              S01413
     O                   N33 61ACMX   B 115 '          0 . -'             S01413
     O                   N33 62ACMX   B 115 '         0 .  -'             S01413
     O                   N33 63ACMX   B 115 '        0 .   -'             S01413
     O                       33         123 'NOMAX'                       S01413
     O        D  1     13 84                                              S01413
     O                                   35 'DEBIT INTEREST RATE   '      S01413
     O                         DIRT   B  60 '0 .        %'                S01413
     O                                   68 'MINIMUM'                     S01413
     O                       60DIMN   B  85 '           0 -'              S01413
     O                       61DIMN   B  85 '          0 . -'             S01413
     O                       62DIMN   B  85 '         0 .  -'             S01413
     O                       63DIMN   B  85 '        0 .   -'             S01413
     O                                   98 'MAXIMUM'                     S01413
     O                   N34 60DIMX   B 115 '           0 -'              S01413
     O                   N34 61DIMX   B 115 '          0 . -'             S01413
     O                   N34 62DIMX   B 115 '         0 .  -'             S01413
     O                   N34 63DIMX   B 115 '        0 .   -'             S01413
     O                       34         123 'NOMAX'                       S01413
     O        D  1     14 84                                              S01413
     O                                   35 'FIXED COMMISSION      '      S01413
     O                       60FCFC   B  60 '           0 -'              S01413
     O                       61FCFC   B  60 '          0 . -'             S01413
     O                       62FCFC   B  60 '         0 .  -'             S01413
     O                       63FCFC   B  60 '        0 .   -'             S01413
     O        D  1     15 84                                              S01413
     O                                   35 'INACTIVE FIXED CHARGE '      S01413
     O                       60INFC   B  60 '           0 -'              S01413
     O                       61INFC   B  60 '          0 . -'             S01413
     O                       62INFC   B  60 '         0 .  -'             S01413
     O                       63INFC   B  60 '        0 .   -'             S01413
     O        D  1     16 84                                              S01413
     O                                   37 'CHARGE ON MIN.CR BALANCE'    S01413
     O                                   43 ' FOR C'                      S01413
     O                       60MCFC   B  60 '           0 -'              S01413
     O                       61MCFC   B  60 '          0 . -'             S01413
     O                       62MCFC   B  60 '         0 .  -'             S01413
     O                       63MCFC   B  60 '        0 .   -'             S01413
     O                                   92 'AVERAGE MINIMUM BALANCE'     S01413
     O                                   98 'FOR C'                       S01413
     O                       60AMBC   B 115 '           0 -'              S01413
     O                       61AMBC   B 115 '          0 . -'             S01413
     O                       62AMBC   B 115 '         0 .  -'             S01413
     O                       63AMBC   B 115 '        0 .   -'             S01413
     O        D  1     16 84                                              S01413
     O                                   37 'CHARGE ON MIN.CR BALANCE'    S01413
     O                                   43 ' FOR S'                      S01413
     O                       60MSFC   B  60 '           0 -'              S01413
     O                       61MSFC   B  60 '          0 . -'             S01413
     O                       62MSFC   B  60 '         0 .  -'             S01413
     O                       63MSFC   B  60 '        0 .   -'             S01413
     O                                   92 'AVERAGE MINIMUM BALANCE'     S01413
     O                                   98 'FOR S'                       S01413
     O                       60AMBS   B 115 '           0 -'              S01413
     O                       61AMBS   B 115 '          0 . -'             S01413
     O                       62AMBS   B 115 '         0 .  -'             S01413
     O                       63AMBS   B 115 '        0 .   -'             S01413
     O        D  1     17 84                                              S01413
     O                                   36 'COMM. ON DAILY STATEMEN'     S01413
     O                                   38 'TS'                          S01413
     O                       60DSFC   B  60 '           0 -'              S01413
     O                       61DSFC   B  60 '          0 . -'             S01413
     O                       62DSFC   B  60 '         0 .  -'             S01413
     O                       63DSFC   B  60 '        0 .   -'             S01413
     O                                   69 'MINIMUM'                     S01413
     O                       60DSMN   B  86 '           0 -'              S01413
     O                       61DSMN   B  86 '          0 . -'             S01413
     O                       62DSMN   B  86 '         0 .  -'             S01413
     O                       63DSMN   B  86 '        0 .   -'             S01413
     O                                   99 'MAXIMUM'                     S01413
     O                   N35 60DSMX   B 116 '           0 -'              S01413
     O                   N35 61DSMX   B 116 '          0 . -'             S01413
     O                   N35 62DSMX   B 116 '         0 .  -'             S01413
     O                   N35 63DSMX   B 116 '        0 .   -'             S01413
     O                    35            123 'NOMAX'                       S01413
      *                                                                   S01413
     O        D  1     18 84                                              CDE002
     O                                   34 'DEBIT INTEREST MARGIN'       CDE002
     O                         DRMG   B  59 '  0 .       '                CDE002
     O        D  1     18 84                                              CDE002
     O                                   35 'CREDIT INTEREST MARGIN'      CDE002
     O                         CRMG   B  59 '  0 .       '                CDE002
      *                                                                   CDE002
      **   Print fields from retail I.C.D. by currency extension file     S01413
     O        D  1     51 84                                              S01413
     O                                   37 'DEMAND STATEMENT CHARGE '    S01413
     O                       60RYCHGC B  76 '           0 -'              S01413
     O                       61RYCHGC B  76 '          0 . -'             S01413
     O                       62RYCHGC B  76 '         0 .  -'             S01413
     O                       63RYCHGC B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'DAILY STATEMENT CHARGE  '    S01413
     O                       60RYCHGD B  76 '           0 -'              S01413
     O                       61RYCHGD B  76 '          0 . -'             S01413
     O                       62RYCHGD B  76 '         0 .  -'             S01413
     O                       63RYCHGD B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'WEEKLY STATEMENT CHARGE '    S01413
     O                       60RYCHGW B  76 '           0 -'              S01413
     O                       61RYCHGW B  76 '          0 . -'             S01413
     O                       62RYCHGW B  76 '         0 .  -'             S01413
     O                       63RYCHGW B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'EVERY TWO WEEKS STATEMEN'    S01413
     O                                   61 'T CHARGE                '    S01413
     O                       60RYCHGF B  76 '           0 -'              S01413
     O                       61RYCHGF B  76 '          0 . -'             S01413
     O                       62RYCHGF B  76 '         0 .  -'             S01413
     O                       63RYCHGF B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'SEMI MONTHLY STATEMENT C'    S01413
     O                                   61 'HARGE                   '    S01413
     O                       60RYCHGS B  76 '           0 -'              S01413
     O                       61RYCHGS B  76 '          0 . -'             S01413
     O                       62RYCHGS B  76 '         0 .  -'             S01413
     O                       63RYCHGS B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'MONTHLY STATEMENT CHARGE'    S01413
     O                       60RYCHGM B  76 '           0 -'              S01413
     O                       61RYCHGM B  76 '          0 . -'             S01413
     O                       62RYCHGM B  76 '         0 .  -'             S01413
     O                       63RYCHGM B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'EVERY TWO MONTHS STATEME'    S01413
     O                                   61 'NT CHARGE               '    S01413
     O                       60RYCHGT B  76 '           0 -'              S01413
     O                       61RYCHGT B  76 '          0 . -'             S01413
     O                       62RYCHGT B  76 '         0 .  -'             S01413
     O                       63RYCHGT B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'LAST WORKING DAY IN MONT'    S01413
     O                                   61 'H STATEMENT CHARGE      '    S01413
     O                       60RYCHGB B  76 '           0 -'              S01413
     O                       61RYCHGB B  76 '          0 . -'             S01413
     O                       62RYCHGB B  76 '         0 .  -'             S01413
     O                       63RYCHGB B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'LAST CALENDAR DAY IN MON'    S01413
     O                                   61 'TH STATEMENT CHARGE     '    S01413
     O                       60RYCHGL B  76 '           0 -'              S01413
     O                       61RYCHGL B  76 '          0 . -'             S01413
     O                       62RYCHGL B  76 '         0 .  -'             S01413
     O                       63RYCHGL B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'ACCRUAL DATE STATEMENT C'    S01413
     O                                   61 'HARGE                   '    S01413
     O                       60RYCHGA B  76 '           0 -'              S01413
     O                       61RYCHGA B  76 '          0 . -'             S01413
     O                       62RYCHGA B  76 '         0 .  -'             S01413
     O                       63RYCHGA B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'QUARTERLY STATEMENT CHAR'    S01413
     O                                   61 'GE                      '    S01413
     O                       60RYCHGQ B  76 '           0 -'              S01413
     O                       61RYCHGQ B  76 '          0 . -'             S01413
     O                       62RYCHGQ B  76 '         0 .  -'             S01413
     O                       63RYCHGQ B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'SIX MONTHLY STATEMENT CH'    S01413
     O                                   61 'ARGE                    '    S01413
     O                       60RYCHGX B  76 '           0 -'              S01413
     O                       61RYCHGX B  76 '          0 . -'             S01413
     O                       62RYCHGX B  76 '         0 .  -'             S01413
     O                       63RYCHGX B  76 '        0 .   -'             S01413
     O        D  1     51 84                                              S01413
     O                                   37 'YEARLY STATEMENT CHARGE '    S01413
     O                       60RYCHGY B  76 '           0 -'              S01413
     O                       61RYCHGY B  76 '          0 . -'             S01413
     O                       62RYCHGY B  76 '         0 .  -'             S01413
     O                       63RYCHGY B  76 '        0 .   -'             S01413
     O        D  1     52 84                                              S01413
     O                                   37 'FIXED ACCOUNT CHARGE AMO'    S01413
     O                                   61 'UNT                     '    S01413
     O                       60RYACCH B  76 '           0 -'              S01413
     O                       61RYACCH B  76 '          0 . -'             S01413
     O                       62RYACCH B  76 '         0 .  -'             S01413
     O                       63RYACCH B  76 '        0 .   -'             S01413
0785 O*
0786 O*  NO DETAILS TO REPORT MESSAGE
0787 O*
0788 O        T   40   LRNU1 77
0789 O                                   72 '*** NO DETAILS TO REPORT'
0790 O                                   76 ' ***'
0791 O***********                                                         S01117
0792 O***DATABASE*ERROR*OUTPUT*                                           S01117
0793 O***********                                                         S01117
0794 O********T*3      LR U7                                              S01117
0795 O***********                        38 'DATABASE ERROR NO.-'         S01117
0796 O***********              LDBNO     40                               S01117
0797 O***********                        48 'FILE-'                       S01117
0798 O***********              LFILE     53                               S01117
0799 O***********                        60 'KEY-'                        S01117
0800 O***********              LKEY      89                               S01117
0833 O*                                                                   S01117
0834 O*  NO INPUT TODAY MESSAGE                                           S01117
0835 O*                                                                   S01117
0836 O        T   40   LR U1 82                                           S01117
0837 O                                   73 '*** NO INPUT TODAY ***'      S01117
0915 O        T   50   LR                                                 S01117
0916 O                                   73 '*** END OF REPORT ***'       S01117
0801 O*
0802 O*  STANDARD FILE CONTROLS
0803 O*
0804 O*  STANDARD HEADINGS
0805 O*
0806 O********T  203   LR                                                 S01117
0806 ORE0540AUT  203   LR                                                 S01117
0747 O       OR        OE                                                 S01117
0807 O**********                         20 'REFERENCE RE0540'            S01117
0807 O                                   22 'REFERENCE RE0540AU'          S01117
0808 O                         TITL      89
0809 O                                  104 'DATE'
0810 O                         RUNA     112
0811 O                                  122 'PAGE'
0812 O**********               PAGE  Z  126                               S01117
0812 O                         PAGE1 Z  126                               S01117
0813 O        T  1     LR
0814 O                       U1          16 'AUDIT REPORT'
0815 O                      NU1          18 'LISTING REPORT'
0816 O*
0817 O*  NAME OF FILE OR RECORD
0818 O*
0819 O                                   63 'RETAIL INSTALLATION CONT'
0820 O                                   83 'ROL DATA BY CURRENCY'
0821 O*
0822 O*  STANDARD OUTPUT
0823 O*
0824 O                         MTIME    112 '  .  .  '
0825 O        T  1     LR
0826 O                       U1          16 '------------'
0827 O                      NU1          18 '--------------'
0828 O*
0829 O*  UNDERLINE NAME OF FILE OR RECORD
0830 O*
0831 O                                   63 '------------------------'
0832 O                                   83 '--------------------'
0833 O*
0834 O*  NO INPUT TODAY MESSAGE
0835 O*
0836 O        T   40   LR U1 82
0837 O                                   73 '*** NO INPUT TODAY ***'
0792 O*  DATABASE ERROR OUTPUT                                            S01117
0793 O*                                                                   S01117
0794 O        T 3      LR U7                                              S01117
0795 O                                   38 'DATABASE ERROR NO.-'         S01117
0796 O                         DBASE     40                               S01117
0797 O                                   48 'FILE-'                       S01117
0798 O                         DBFILE    53                               S01117
0799 O                                   60 'KEY-'                        S01117
0800 O                         DBKEY     89                               S01117
0838 O*
0839 O*  HEADINGS AND RUN CONTROLS COMMON TO AUDIT AND LIST
0840 O*
0841 O        T  220   LRN81
0842 O                                   21 'RUN CONTROLS - '
0843 O                                   77 '----------- PROGRAM ----'
0844 O                                   84 '-------'
0845 O                                  116 '--------- FILE TRAILER '
0846 O                                  124 '--------'
0847 O        T  1     LRN81
0848 O                                   59 'NUMBER'
0849 O                                   84 'VALUE'
0850 O                                   99 'NUMBER'
0851 O                                  124 'VALUE'
0852 O        T  2     LRN81
0853 O                                   13 'S/'
0854 O                         LFILE     18
0855 O        T  2     LRN81
0856 O                                   32 'NUMBER OF ACTIVE RECORDS'
0857 O                                   40 'ON FILE'
0858 O                         RN,1  3   59
0859 O                         RW,1  Z   80
0860 O                         RD,1      84 '0   -'
0861 O                         NR,1  3   99
0862 O                         WN,1  Z  120
0863 O                         DC,1     124 '0   -'
0864 O                       79         130 '***'
0865 O*
0866 O*  AUDIT REPORT ONLY RUN CONTROLS
0867 O*
0868 O        T  3     LR U1N82
0869 O                                   29 'NUMBER OF RECORDS UPD'
0870 O                                   39 'ATED TODAY'
0871 O                         RN,3  3   59
0872 O        T  2     LR U1N82
0873 O                                   27 'LIVE RECORDS BEFORE'
0874 O                                   39 'INPUT CYCLE'
0875 O                         NR,2  3   99
0876 O                         WN,2  Z  120
0877 O                         DC,2     124 '0   -'
0878 O        T  2     LR U1N82
0879 O                                   26 'RECORDS INSERTED'
0880 O                         NR,3  3   99
0881 O                         WN,3  Z  120
0882 O                         DC,3     124 '0   -'
0883 O        T  2     LR U1N82
0884 O                                   25 'RECORDS AMENDED'
0885 O                         NR,4  3   99
0886 O                         WN,4  Z  120
0887 O                         DC,4     124 '0   -'
0888 O        T  2     LR U1N82
0889 O                                   25 'RECORDS DELETED'
0890 O                         NR,5  3   99
0891 O                         WN,5  Z  120
0892 O                         DC,5     124 '0   -'
0893 O        T        LR U1N82
0894 O                                   32 'LIVE RECORDS AFTER INPUT'
0895 O                                   38 'CYCLE'
0896 O                         RN,2  3   59
0897 O                         RW,2  Z   80
0898 O                         RD,2      84 '0   -'
0899 O                         RN,4  3   99
0900 O                         RW,4  Z  120
0901 O                         RD,4     124 '0   -'
0902 O                       78         129 '***'
0903 O*
0904 O*  LISTING REPORT ONLY RUN CONTROLS
0905 O*
0906 O        T        LRNU1
0907 O                                   29 'NUMBER OF LIVE RECORD'
0908 O                                   38 'S ON FILE'
0909 O                         RN,2  3   59
0910 O*
0911 O*  OUTPUT DETAILS COMMON TO AUDIT AND LIST
0912 O*
0913 O        T   45   LR U8
0914 O                                  100 '*** DIFFERENCE ***'
0915 O********T*  50   LR                                                 S01117
0916 O**********                         73 '*** END OF REPORT ***'       S01117
0917 O***RECCY   E        88                                              S01413
     ORECCYZ  E        88                                                 S01413
0918 O                                   34 ' '
0919 O                         RN,1      37P
0920 O                         RN,2      40P
0921 O                         ZERO05    43P
0922 O                         ZERO05    46P
0923 O                         ZERO05    49P
0924 O                         RW,1      57P
0925 O                         RW,2      65P
0926 O                         ZERO15    73P
0927 O                         ZERO15    81P
0928 O                         ZERO15    89P
0929 O                         RD,1      91P
0930 O                         RD,2      93P
0931 O                         ZERO03    95P
0932 O                         ZERO03    97P
0933 O                         ZERO03    99P
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
