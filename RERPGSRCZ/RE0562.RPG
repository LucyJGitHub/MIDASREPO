0001 H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Default Retail Accounts Detail Rep')          *
0001 H***********
0002 F*****************************************************************
0004 F*                                                               *
     F*  Midas - Retail Module
0004 F*                                                               *
0005 F*  RE0562 - DEFAULT RETAIL ACCOUNTS/DETAILS REPORT              *
0006 F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*      1990, 1993                                               *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. MD046248           Date 27Oct17               *
      *                 242897             Date 24Mar17               *
      *                 CER059             Date 19Jul10               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP205             Date 05Jan10               *
      *                 CRE030             Date 10Jul06               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG3800            Date 18Feb05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.03 ----------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 132486             Date 21Jun01               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 093765             Date 18Aug97               *
     F*                 S01413                  13APR93               *
0009 F*                 S01117                  08MAR90               *
     F*                 S01194                  22FEB90               *
     F*                 E81154                  23FEB87               *
0009 F*                 E43416                  18NOV86               *
0008 F*                                                               *
0010 F*****************************************************************
0010 F*                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  MD046248 - Finastra Rebranding                               *
      *  242897 - Error in update of trailer                          *
      *         - Applied for MD-44564                                *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompiled)                                        *
      *  CAP205 - Teller Related APIs Account Balance Check           *
      *  CRE030 - Default RE Accounts by Currency                     *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG3800 - If error in first cycle processing, program        *
      *            attempts to output to closed printer file RE0562P2 *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CGL029 - Increase Account Code to 10 digits                  *
     F*  132486 - Enrol RE0562P2 in RCF.                                       *
     F*  093765 - Report account codes with missing default retail    *
     F*           account.                                            *
     F*  S01413 - Header Box Standardised                             *
0009 F*  S01117 - Multibranching                                      *
     F*  S01194 - Standing Data changes                               *
     F*  E81154 - Run Ctl Rpt Names DB error file instead of          *
     F*           Redef. Heading underline has a gap on run ctl.      *
0008 F*  E43416 - Database due to REIAC record with RECI=C            *
0008 F*           Not defined in input SPEX                           *
0010 F*                                                               *
0011 F*****************************************************************
0012 F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0013 F***REDES** IP  F     400  5AI     2 DISK                                         RE0562 CGL029
     F***REDES** IP  F     410 13AI     2 DISK                                         CGL029 CAP205
     FREDES   IP  F     411 13AI     2 DISK                                                   CAP205
0014 F*LINT***IF**F     256  7AI     2 DISK                               S01194
0015 F*ABLE***IF**F      96 12AI     2 DISK                               S01194
0016 F*EIAC   IF  F     128 15AI     2 DISK                               S01117
     FSDCURRL0IF  E           K        DISK                               S01194
     F***REIAC** IF  F     128 18AI     2 DISK                                         S01117 CGL029
     FREIAC   IF  F     218 24AI     2 DISK                                                   CGL029
0017 F*EACR   IF  F     128 15AI     2 DISK                               S01117
     F***REACR** IF  F     128 18AI     2 DISK                                         S01117 CGL029
     FREACR   IF  F     191 24AI     2 DISK                                                   CGL029
     F/COPY WNCPYSRC,RE0562F001
0019 F***REDEF** UF  F     128  5AI     2 DISK                                         RE0562 CGL029
     F***REDEF   UF  F     138 11AI     2 DISK                                         CGL029 CRE030
     FREDEF   UF  E           K        DISK                                                   CRE030
     F            REDEFAF                           KIGNORE                                   CRE030
     F            REDEFDF                           KIGNORE                                   CRE030
0020 F*E0562P1O   F     132            PRINTER                      S01124S01117
     FRE0562AUO   F     132     OB     PRINTER      KINFDS SPOOLU         S01117
     FRE0562P1O   F     132     OF     PRINTER      KINFDS SPOOL      UC  S01117
     F*E0562P2O***F     132            PRINTER                     093765 132486
     FRE0562P2O   F     132            PRINTER      KINFDS SPOOL2     UC  132486
0021 F*                                                                   RE0562
0022 F* 01            DEFAULT ACCOUNT DETAIL.                             RE0562
0023 F* 02            DEFAULT ACCOUNT TRAILER RECORD.                     RE0562
0024 F* 03            DEFAULT ACCOUNT CATCHALL.                           RE0562
0025 F* 04            DEFAULT ACCOUNT CLOSED DETAIL RECORD.               RE0562
     F* 05            DEFAULT ACCOUNT MISSING DETAIL RECORD.              093765
0027 F*                                                                   RE0562
     F*       10      THERE IS AT LEAST ONE MISSING A/C                   093765
     F*       11      DACP FIELD BLANK                                    S01117
     F*       12      CACP FIELD BLANK                                    S01117
     F*       13      CHAC FIELD BLANK                                    S01117
     F*       14      DEFAULT RETAIL ACCOUNT IS MISSING                   093765
     F*       15      PRINT HEADER OF MISSING A/C REPORT                  093765
     F*       16      PRINT SUB-HEADER OF MISSING A/C REPORT              093765
     F*       17      PRINT DETAIL OF MISSING A/C REPORT                  093765
     F*       18      PRINT TRAILER OF MISSING A/C REPORT                 093765
     F*       19      MISSING RETAIL ACCOUNT NUMBER                       093765
0028 F*       21      PRINT DETAIL                                        RE0562
0029 F*       22      REIAC CHAIN FAIL - DATABASE ERROR                   RE0562
0030 F*       23      REACR CHAIN FAIL - DATABASE ERROR                   RE0562
0031 F*       33      OVERDRAFT SECURED                                   RE0562
0032 F*       40      NON-FIRST CYCLE.                                    RE0562
0033 F*       41      CHAIN FAIL.                                         RE0562
0034 F*       42      REFER ALL DEBITS - YES.                             RE0562
0035 F*       43      REFER CREDIT - YES.                                 RE0562
0036 F*       44      BLOCK ALL DEBITS - YES.                             RE0562
0037 F*       45      PRINT ADDRESS - YES.                                RE0562
0038 F*       46      BLOCK ALL CREDITS - YES.                            RE0562
0039 F*       47      INACTIVE - YES.                                     RE0562
0040 F*       48      BANKRUPT - YES                                      RE0562
0041 F*       49      BAD DEBT - YES                                      RE0562
0042 F*       50      CHANGE IN ACCOUNT CURRENCY CODE.                    RE0562
0043 F*       51      DEBIT RATE/SPREAD > 0.                              RE0562
0044 F*       53      CREDIT RATE/SPREAD > 0.                             RE0562
0045 F*       55      DEBIT MAN.ADJ. TO A.I. >= 0.                        RE0562
0046 F*       57      CREDIT MAN.ADJ. TO A.I. >= 0.                       RE0562
0047 F*       61      RETAIL A/C NOS SUPPORTED ON ICDR 3                  RE0562
0048 F*       63      LAST CR INC/EXP AMOUNT IS DR                        RE0562
     F*       65      HAVE DETAILS REPORTED                               S01117
0049 F*       66      GENERATED ADJ TO CR INT IS DR.                      RE0562
     F*       67      BRANCH CODE NOT THE REQUESTED ONE                   S01117
     F*       69      BRANCH DETAILS PRINT FILE IS OPEN                   S01117
0050 F*       70      CURRENCY HAS 0 DECIMAL PLACES.                      RE0562
0051 F*       71      CURRENCY HAS 1 DECIMAL PLACE.                       RE0562
0052 F*       72      CURRENCY HAS 2 DECIMAL PLACES.                      RE0562
0053 F*       73      CURRENCY HAS 3 DECIMAL PLACES.                      RE0562
0054 F*       74      LIVE DETAIL RECORD READ - RECI IS D AND CHTP NOT D  RE0562
0055 F*       75      ACTIVE DETAIL RECORD READ - RECI NOT *              RE0562
0056 F*       76      DETAIL RECORD UPDATED TODAY - LCD EQUALS RUN DATE   RE0562
0057 F*       77      LISTING REPORT WITH NO DETAILS TO REPORT.           RE0562
0057 F*               OR AUDIT REPORT WITH NO RECORDS UPDATED TODAY       RE0562
0057 F*               FOR A PARTICULAR BRANCH.                            RE0562
0058 F*       78      FILE OUT OF BALANCE - LIVE RECORDS AFTER INPUT.     RE0562
0059 F*       79      FILE OUT OF BALANCE - NUMBER OF ACTIVE RECORDS.     RE0562
0060 F*       80      CHANGE TYPE I - INSERT                              RE0562
0061 F*       81      CHANGE TYPE A - AMEND.                              RE0562
0062 F*       82      CHANGE TYPE C - CLOSE.                              RE0562
0063 F*       83      CHANGE TYPE R - RE-OPEN.                            RE0562
0065 F*       85      NO INPUT TODAY.                                     RE0562
0066 F*       86      MASTER FILE - CORRECT TRAILER FOUND ON CHAIN.       RE0562
0067 F*       87      AUDIT REPORT WITH NO INPUT TODAY -U1 AND 82-        RE0562
0068 F*       88      MULTIBRANCHING INDICATOR                            S01117
0068 F*       90-99   USED IN SUBROUTINES.                                RE0562
     F*            L1 CHANGE IN BRANCH BEING PROCESSED                    S01117
0069 F*       U1      RUNNING IN 'AUDIT' LIST MODE.                       RE0562
0070 F*       U7      DATABASE ERROR.                                     RE0562
0071 F*       U8      SORTED DEFAULT RETAIL ACCOUNTS FILE OUT OF BALANCE. RE0562
0072 F*       LR      LAST FILE RECORD OR DATABASE ERROR LOCATED.         RE0562
0073 F*                                                                   RE0562
0074 E*    STANDARD TABLES/ARRAYS                                         RE0562
0075 E*                                                                   RE0562
0076 E*    RN/RW/RD,1 ARE COUNT/HASH OF ACTIVE RECORDS                    RE0562
0077 E*    RN/RW/RD,2 ARE COUNT/HASH OF LIVE RECORDS                      RE0562
0078 E*    RN,3 IS COUNT OF RECORDS UPDATED TODAY. RW/RD,3 ARE NOT USED   RE0562
0079 E*    RN/RW/RD,4 ARE COUNT/HASH OF LIVE RECORDS CALCULATED FROM TRLR RE0562
0080 E                    RN          4  5 0                              RE0562
0081 E                    RW          4 15 0                              RE0562
0082 E                    RD          4  3 0                              RE0562
0083 E*    ARRAYS OF COUNTS AND HASH TOTALS IN THE MASTER FILE TRAILER    RE0562
0084 E                    NR          5  5 0                              RE0562
0085 E                    WN          5 15 0                              RE0562
0086 E                    DC          5  3 0                              RE0562
0087 E*                                                                   RE0562
0088 E                    ZYDY    4   4  4 0             ZDATE SR. ARRAY  RE0562
0089 E                    ZMDY   13  13  3 0             ZDATE SR. ARRAY  RE0562
0090 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY RE0562
0091 E                    CCYA      150  3                                RE0562
0092 E                    DPA       150  1 0                              RE0562
     E                    CPY@    1   1 80
0093 E**                                                                  RE0562
0094 I*    ACCOUNT MASTER DETAIL RECORD                                   RE0562
0095 I**                                                                  RE0562
0096 IREDES   NS  01   1 CD                                               RE0562
0097 I       OR   04   1 CC                                               RE0562
     I       OR   05   1 C*                                               093765
0098 I                                        1   1 RECI                  RE0562
0099 I**********                              2   70CNUM                               RE0562 CSD027
0099 I                                        2   7 CNUM                                      CSD027
0100 I                                        8  10 CCY                   RE0562
0101 I**********                             11  140ACOD                               RE0562 CGL029
     I                                       11  140ACODQQ                                    CGL029
0102 I                                       15  160ACSQ                  RE0562
0103 I                                    P  17  190RDLCD                 RE0562
0104 I                                       20  20 RDCHTP                RE0562
0105 I                                       21  21 RDRECI                RE0562
0106 I*****                                  23  250BRCD                  S01117
0106 I                                       23  25 BRCA  L1              S01117
0107 I                                       27  27 STYP                  RE0562
0108 I                                       26  26 ATYP                  RE0562
0109 I                                       29  29 ACST                  RE0562
0110 I                                    P  30  320DACO                  RE0562
0111 I                                    P  33  350DACC                  RE0562
0112 I                                       36  55 ANAM                  RE0562
0113 I                                    P  56  630LDBL                  RE0562
0114 I                                    P  64  710CLBL                  RE0562
0115 I                                       72  72 STFQ                  RE0562
0116 I                                    P  78  800NSTD                  RE0562
0117 I                                    P  81  820LSTP                  RE0562
0118 I                                    P  83  900CFSB                  RE0562
0119 I                                    P  91  930LMVD                  RE0562
0120 I                                      118 118 GLBT                  RE0562
     I/COPY WNCPYSRC,RE0562I002
0121 I                                    P 178 1837CDIR                  RE0562
0122 I                                    P 184 1897CCIR                  RE0562
0123 I                                      190 1990ACNO                  RE0562
0124 I                                      200 200 RETB                  RE0562
0125 I                                      201 201 ODSC                  RE0562
0126 I                                    P 202 2070ODLN                  RE0562
0127 I                                    P 208 2100ODED                  RE0562
0128 I                                    P 211 2120DIOD                  RE0562
0129 I                                      213 2150FACT                  RE0562
0130 I                                      216 2170FCNO                  RE0562
0131 I                                      218 219 EFAC                  RE0562
0132 I                                    P 220 2270HELD                  RE0562
0133 I                                    P 228 2330MINB                  RE0562
0134 I                                    P 234 2360LACD                  RE0562
0135 I**********                            242 2430DRIB                               RE0562 CSD103
0135 I                                      242 243 DRIB                                      CSD103
0136 I                                    P 244 2497DRIS                  RE0562
0137 I                                    P 250 2520DRCD                  RE0562
0138 I                                      253 2530DRIC                  RE0562
0139 I                                      254 254 DRIF                  RE0562
0140 I                                    P 257 2590NDID                  RE0562
0141 I                                    P 260 2620LDID                  RE0562
0142 I                                    P 263 2690LDIA                  RE0562
0143 I                                      270 270 SDAP                  RE0562
0144 I                                    P 271 2730LPAR                  RE0562
0145 I                                    P 274 2800DIIE                  RE0562
0146 I                                    P 304 3060DDIA                  RE0562
0147 I**********                            318 3190CRIB                               RE0562 CSD103
0147 I                                      318 319 CRIB                                      CSD103
0148 I                                    P 320 3257CRIS                  RE0562
0149 I                                    P 326 3280CRCD                  RE0562
0150 I                                      329 3290CRIC                  RE0562
0151 I                                      330 330 CRIF                  RE0562
0152 I                                    P 333 3350NCID                  RE0562
0153 I                                    P 336 3380LCID                  RE0562
0154 I                                    P 339 3450LCIA                  RE0562
0155 I                                      346 346 SCAP                  RE0562
0156 I                                    P 347 3490LPAP                  RE0562
0157 I                                    P 350 3560CIIE                  RE0562
0158 I                                    P 380 3820DCIA                  RE0562
0159 I                                    P 394 3960LCD                   RE0562
0160 I                                      397 397 CHTP                  RE0562
0161 I                                    P 398 4000TNLU                  RE0562
     I                                      401 4100ACOD                                      CGL029
     I                                      411 411 ABCR                                      CAP205
0162 I**                                                                  RE0562
0163 I**                                                                  RE0562
0164 I*    ACCOUNT MASTER TRAILER RECORD                                  RE0562
0165 I**                                                                  RE0562
0166 I        NS  02   1 CZ                                               RE0562
0167 I                                        1   1 RECI                  RE0562
0168 I**                                                                  RE0562
0169 I*    CATCHALL FOR DELETED RECORDS                                   RE0562
0170 I**                                                                  RE0562
0171 I        NS  03                                                      RE0562
0172 I                                        1   1 RECI                  RE0562
0173 I*                                                                   RE0562
0174 I*    MASTER FILE - TRAILER                                          RE0562
0175 I*                                                                   RE0562
0176 I***REDEF   NS  86   1 CZ                                                         RE0562 CRE030
0177 I********                                1   1 RECI                               RE0562 CRE030
0178 I********                            P  31  330TNLU                               RE0562 CRE030
0179 I********                               34  34 IRRI                               RE0562 CRE030
0180 I********                            P  35  49 NR                                 RE0562 CRE030
0181 I********                            P  50  89 WN                                 RE0562 CRE030
0182 I********                            P  90  99 DC                                 RE0562 CRE030
0183 I*                                                                   RE0562
0184 I**   CATCHALL                                                       RE0562
0185 I*                                                                   RE0562
0186 I********NS                                                                       RE0562 CRE030
0187 I**                                                                  RE0562
0188 I**********                                                          S01194
0189 I***CUSTOMER MASTER DETAILS                                          S01194
0190 I**********                                                          S01194
0191 I*LINT***NS       1 CD                                               S01194
0192 I*******OR        1 CC                                               S01194
0193 I**********                              1   1 RECI                  S01194
0194 I**********                              9  28 CRNM                  S01194
0195 I**********                             29  38 CTWN                  S01194
0196 I**********                                                          S01194
0197 I***CATCHALL                                                         S01194
0198 I**********                                                          S01194
0199 I********NS                                                          S01194
0200 I**********                              1   1 RECI                  S01194
0201 I**********                                                          S01194
0202 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               S01194
0203 I**********                                                          S01194
0204 I*ABLE***NS       2 C0   3 C1  12 C1                                 S01194
0205 I*******AND      13 C0                                               S01194
0206 I**********                              1   1 RECI                  S01194
0207 I**********                              2   30RECT                  S01194
0208 I**********                             12  130RCDE                  S01194
0209 I**********                             14  66 TITL                  S01194
0210 I**********                             67  67 DATF                  S01194
0211 I**********                             68  700DFBR                  S01194
0212 I**********                             74  74 MODI1                 S01194
0213 I**********                             75  75 MODI2                 S01194
0214 I**********                             76  76 MODI3                 S01194
0215 I**********                          P  77  790RUND                  S01194
0216 I**********                             80  86 RUNA                  S01194
0217 I**********                             87  870SFLG                  S01194
0218 I**********                              1  96 LOT                   S01194
0219 I**********                                                          S01194
0220 I*****TABLE FILE-INSTALLATION CONTROL DATA RECORD 2                  S01194
0221 I**********                                                          S01194
0222 I********NS       1 CD   2 C0   3 C1                                 S01194
0223 I*******AND      12 C1  13 C1                                        S01194
0224 I**********                              1   1 RECI                  S01194
0225 I**********                          P  41  430DNWD                  S01194
0226 I**********                                                          S01194
0227 I*****TABLE FILE - INSTALLATION CONTROL DATA RECORD 3.               S01194
0228 I**********                                                          S01194
0229 I********NS       1 CD   2 C0   3 C1                                 S01194
0230 I*******AND      12 C2  13 C0                                        S01194
0231 I**********                              1   1 RECI                  S01194
0232 I**********                              2   30RECT                  S01194
0233 I**********                             12  130RCDE                  S01194
0234 I**********                             14  170COMS                  S01194
0235 I**********                             18  210CADC                  S01194
0236 I**********                          P  22  240MDIC                  S01194
0237 I**********                          P  25  270MCIC                  S01194
0238 I**********                          P  28  300MDIA                  S01194
0239 I**********                          P  31  330MCIA                  S01194
0240 I**********                             34  370SRPL                  S01194
0241 I**********                             38  410SPAC                  S01194
0242 I**********                             42  450SWAC                  S01194
0243 I**********                             46  490FTAC                  S01194
0244 I**********                             50  530TAC4                  S01194
0245 I**********                             54  570TAC5                  S01194
0246 I**********                          P  63  650NOBA                  S01194
0247 I**********                          P  66  680TSIZ                  S01194
0248 I**********                             69  69 RACN                  S01194
0249 I**********                             70  700GLSI                  S01194
0250 I**********                             71  710RTSI                  S01194
0251 I**********                             72  720DLSI                  S01194
0252 I**********                             73  730NOSI                  S01194
0253 I**********                             74  740CTSI                  S01194
0254 I**********                          P  75  770ELAC                  S01194
0255 I**********                          P  78  800ECAC                  S01194
0256 I**********                          P  90  920LCD                   S01194
0257 I**********                             93  93 CHTP                  S01194
0258 I**********                          P  94  960TNLU                  S01194
0309 I**********                                                          S01194
0310 I*****TABLE FILE - CURRENCIES RECORD 1.                              S01194
0311 I**********                                                          S01194
0312 I********NS       1 CD   2 C2   3 C0                                 S01194
0313 I*******AND      13 C1                                               S01194
0314 I**********                              1   1 RECI                  S01194
0315 I**********                              2   30RECT                  S01194
0316 I**********                             10  12 CCY                   S01194
0317 I**********                             13  130SREC                  S01194
0318 I**********                             38  380CDP                   S01194
0259 I**********                                                          S01194
0260 I*****CATCHALL.                                                      S01194
0261 I**********                                                          S01194
0262 I********NS                                                          S01194
     I**********                              1   1 RECI                  S01194
     I**********                              2   30RECT                  S01194
     I**********                             13  130SREC                  S01194
0264 I**********                                                          S01194
0265 I**   RETAIL INTEREST AND CHARGES DETAIL RECORD.                     RE0562
0266 I*                                                                   RE0562
0267 IREIAC   NS       1 CD                                               RE0562
0268 I       OR        1 C*                                               RE0562
     I       OR        1 CC                                               E43416
0269 I                                        1   1 RECI                  RE0562
0270 I**********                              2   70CNUM                               RE0562 CSD027
0270 I                                        2   7 CNUM                                      CSD027
0271 I                                        8  10 CCY                   RE0562
0272 I**********                             11  140ACOD                               RE0562 CGL029
     I                                       11  140ACODQQ                                    CGL029
0273 I                                       15  160ACSQ                  RE0562
0274 I                                       17  180DICT                  RE0562
0275 I                                       19  230DCST                  RE0562
0276 I*****                                  24  38 DACP                  S01117
     I**********                             24  38 DACP            11                 S01117 CGL029
     I                                       24  38 DACPQQ                                    CGL029
0277 I                                       39  400DICP                  RE0562
0278 I                                       41  420CICT                  RE0562
0279 I                                       43  470CCST                  RE0562
0280 I*****                                  48  62 CACP                  S01117
     I**********                             48  62 CACP            12                 S01117 CGL029
     I                                       48  62 CACPQQ                                    CGL029
0281 I                                       63  640CICP                  RE0562
0282 I                                       65  660CHCT                  RE0562
0283 I                                       67  710CHST                  RE0562
0284 I*****                                  72  86 CHAC                  S01117
     I**********                             72  86 CHAC            13                 S01117 CGL029
     I                                       72  86 CHACQQ                                    CGL029
0285 I                                       87  87 PTRA                  RE0562
0286 I                                       88  88 PRCA                  RE0562
0287 I                                    P  89  950NRCA                  RE0562
0288 I                                    P  96 1020RCA                   RE0562
0289 I                                    P 103 1100MCBL                  RE0562
     I                                      146 1550ACOD                                      CGL029
     I                                      156 176 DACP            11                        CGL029
     I                                      177 197 CACP            12                        CGL029
     I                                      198 218 CHAC            13                        CGL029
0290 I*                                                                   RE0562
0291 I**   CATCHALL                                                       RE0562
0292 I        NS  22                                                      RE0562
0293 I*                                                                   RE0562
0294 I**   RETAIL ACCRUED INTEREST TO DATE DETAIL RECORD.                 RE0562
0295 I*                                                                   RE0562
0296 IREACR   NS       1 CD                                               RE0562
0297 I       OR        1 C*                                               RE0562
     I       OR        1 CC                                               E43416
0298 I                                        1   1 RECI                  RE0562
0299 I                                    P  41  470DAIC                  RE0562
0300 I                                    P  48  540MADI                  RE0562
0301 I                                    P  55  610GADI                  RE0562
0302 I                                    P  62  680CAIC                  RE0562
0303 I                                    P  69  750MACI                  RE0562
0304 I                                    P  76  820GACI                  RE0562
0305 I*                                                                   RE0562
0306 I**   CATCHALL                                                       RE0562
0307 I*                                                                   RE0562
0308 I        NS  23                                                      RE0562
0325 I**                                                                  RE0562
     I*                                                                   S01194
     IREDEFZF                                                                                 CRE030
     I              NR                              NRDS                                      CRE030
     I              WN                              WNDS                                      CRE030
     I              DC                              DCDS                                      CRE030
     I              ACOD                            TACOD                                     CRE030
     IDSFDY     E DSDSFDY                                                 S01194
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01194
     I*                                                                   S01194
     IDSSDY     E DSDSSDY                                                 S01194
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01194
     I*                                                                   S01194
0326 I*    STANDARD LOCAL DATA AREA FIELDS                                RE0562
0327 I*                                                                   RE0562
0328 ILDA        UDS                            256                       RE0562
0329 I                                        1   8 LPROC                 RE0562
0186 I***********                           134 138 LFILE                 S01117
0187 I***********                           139 167 LKEY                  S01117
0188 I***********                           168 175 LPROG                 S01117
0189 I***********                           176 1770LDBNO                 S01117
0183 I                                      134 141 LFILE                 S01117
0183 I                                      142 170 LKEY                  S01117
0183 I                                      171 180 LPROG                 S01117
0183 I                                      181 1830LDBNO                 S01117
0183 I                                      134 141 DBFILE                S01117
0183 I                                      142 170 DBKEY                 S01117
0183 I                                      171 180 DBPGM                 S01117
0183 I                                      181 1830DBASE                 S01117
0190 I***********                           181 1850LRUND                 S01117
0191 I***********                           186 192 LRUNA                 S01117
0192 I***********                           193 193 LDATF                 S01117
0193 I***********                           194 1940LSFLG                 S01117
0190 I                                      187 1910LRUND                 S01117
0191 I                                      192 198 LRUNA                 S01117
0192 I                                      199 199 LDATF                 S01117
0193 I**********                            200 2000LSFLG           S01117S01194
0193 I                                      200 200 LSFLG                 S01194
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOL2      DS                                                      132486
     I                                       83  92 SFILE2                132486
     I                                    B 123 1240SFNUM2                132486
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     INRDS1       DS                                                                          CRE030
     I                                    P   1   30NR1                                       CRE030
     I                                    P   4   60NR2                                       CRE030
     I                                    P   7   90NR3                                       CRE030
     I                                    P  10  120NR4                                       CRE030
     I                                    P  13  150NR5                                       CRE030
     I**                                                                                      CRE030
     IWNDS1       DS                                                                          CRE030
     I                                    P   1   80WN1                                       CRE030
     I                                    P   9  160WN2                                       CRE030
     I                                    P  17  240WN3                                       CRE030
     I                                    P  25  320WN4                                       CRE030
     I                                    P  33  400WN5                                       CRE030
     I**                                                                                      CRE030
     IDCDS1       DS                                                                          CRE030
     I                                    P   1   20DC1                                       CRE030
     I                                    P   3   40DC2                                       CRE030
     I                                    P   5   60DC3                                       CRE030
     I                                    P   7   80DC4                                       CRE030
     I                                    P   9  100DC5                                       CRE030
     ISDBANK    E DSSDBANKPD                                              S01194
      ** BANK DETAILS                                                     S01194
     I              BJURPT                          TITL                  S01194
     I              BJSUC                           SFLG                  S01194
     ISDRETL    E DSSDRETLPD                                              S01194
     I              BMRANR                          RACN                  S01194
     ISDCUST    E DSSDCUSTPD                                              S01194
      **   CUSTOMER                                                       S01194
     I              BBCRNM                          CRNM                  S01194
     I              BBCRTN                          CTWN                  S01194
     I**                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I              A8BRNM                          BRNM                  S01117
     I              QQDFAC                          QQDFA1                                    CGL029
     ISCSARD    E DSSCSARDPD                                                                  CAP205
     I**  EXTERNAL DS FOR BRANCH CODES                                    S01117
     I/COPY WNCPYSRC,RE0562I001
0338 I**                                                                  RE0562
     C                     MOVEACPY@      BIS@   80
     C**                                                                  S01117
     C           *ENTRY    PLIST                                          S01117
     C                     PARM           SEQ     5         SEQUENCE NUM. S01117
     C                     PARM           BRNCH   3                       S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN           LDA                             S01194
     C           *LOCK     IN   LDA                                       S01194
0339 C*                                                                   RE0562
0340 C*    PERFORM FIRST CYCLE OPERATIONS.                                RE0562
0341 C                     SETOF                     21                   RE0562
     C                     MOVE '0'       *IN14                           093765
0342 C  N40                EXSR FIRSTC                                    RE0562
     C*                                                                   093765
     C** If first cycle, print header for MISSING DEFAULT                 093765
     C** RETAIL ACCOUNTS report.                                          093765
     C           *IN40     IFEQ '0'                                       093765
     C                     MOVE '0'       *IN86                           093765
     C                     MOVE '1'       *IN15                           093765
     C                     EXCPT                                          093765
     C                     MOVE '0'       *IN15                           093765
     C                     END                                            093765
     C*                                                                   093765
0343 C                     SETON                     40                   RE0562
0344 C*                                                                   RE0562
0345 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR                          RE0562
0346 C*  AN AUDIT REPORT, GOTO LR PROCESSING.                             RE0562
0347 C*                                                                   RE0562
0348 C   U7                                                               RE0562
0349 COR U1 85             GOTO LASTR                                     RE0562
0351 C*                                                                   RE0562
0352 C*  IF HEADER OR TRAILER READ, GOTO LR PROCESSING                    RE0562
0353 C*                                                                   RE0562
0354 C   03                                                               RE0562
0355 COR 02                GOTO LASTR                                     RE0562
0356 C*                                                                   RE0562
     C           *INL1     IFEQ '1'                                       S01117
     C           *IN05     IFEQ '0'                                       093765
     C  NLR                EXSR CHKBR                                     S01117
     C                     END                                            093765
     C*                                                                   S01117
     C*    IF DATABASE ERROR ACCESSING BRANCH CODE RECORD                 S01117
     C*                                                                   S01117
     C           *IN67     CABEQ'1'       LASTR                           S01117
     C                     END                                            S01117
      *                                                                   S01117
      *    SKIP TO END IF MBIN = 'Y', BRANCH REQUESTED <> ALL,            S01117
      *    AND THE BRANCH READ ON RECORD <> REQUESTED BRANCH              S01117
      *                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRCA      ANDNEBRNCH                                     S01117
     C                     SETOF                       69                 S01117
     C                     GOTO LASTR                                     S01117
     C                     END                                            S01117
      *                                                                   S01117
0357 C*  PROCESSING NOW CONSISTS OF RUN CONTROLS, RECORD FORMATTING       RE0562
0358 C*  FOR OUTPUT AND PRINTING THE RECORD.                              RE0562
0359 C*                                                                   RE0562
0360 C*                                                                   RE0562
0361 C*  RUN CONTROLS - AUDIT AND LIST CONTROLS ARE                       RE0562
0362 C*  MAINTAINED UNCONDITIONALLY                                       RE0562
0363 C*                                                                   RE0562
0364 C*  IF THERE IS NO HASH TOTAL FIELD ON THE MASTER FILE DETAIL RECORD,RE0562
0365 C*  THEN ZEROISE AND CONTINUE AS IF THERE IS.                        RE0562
0366 C*                                                                   RE0562
0367 C                     Z-ADD0         MHASH  130                      RE0562
0368 C*                                                                   RE0562
0369 C*  COUNT ACTIVE RECORDS READ - RECI NOT *                           RE0562
0370 C*  MOVE HASH AMOUNT INTO ZZAMT FIRST.                               RE0562
0371 C*                                                                   RE0562
0372 C                     MOVE MHASH     ZZAMT                           RE0562
0373 C*                                                                   RE0562
0374 C           RDRECI    COMP '*'                  7575                 RE0562
0375 C   75                Z-ADD1         H                               RE0562
0376 C   75                EXSR NPZTOT                                    RE0562
0377 C*                                                                   RE0562
0378 C*  COUNT LIVE RECORDS READ - RECI IS D AND CHTP IS NOT D            RE0562
0379 C*                                                                   RE0562
0380 C           RDRECI    COMP 'D'                      74               RE0562
     C*                                                                   093765
     C** If RECI is 'M', consider live as long as CHTP is not 'D'.        093765
     C           *IN74     IFEQ '0'                                       093765
     C           RDRECI    ANDEQ'M'                                       093765
     C                     ADD  1         @MSS    50                      093765
     C                     MOVE '1'       *IN74                           093765
     C                     END                                            093765
     C*                                                                   093765
0381 C   74      RDCHTP    COMP 'D'                  7474                 RE0562
0382 C   74                Z-ADD2         H                               RE0562
0383 C   74                EXSR NPZTOT                                    RE0562
0384 C*                                                                   RE0562
0385 C*  COUNT RECORDS UPDATED TODAY - LCD IS RUN DATE                    RE0562
0386 C*                                                                   RE0562
0387 C           RDLCD     COMP RUND                     76               RE0562
0388 C   76      RN,3      ADD  1         RN,3                            RE0562
0389 C*                                                                   RE0562
0390 C*  IF AUDIT REPORT, RECORDS UPDATED TODAY ARE PRINTED.              RE0562
0391 C*  IF LISTING, LIVE RECORDS ARE PRINTED.                            RE0562
0392 C*  SET ON 21 IF THE RECORD IS TO BE PRINTED.                        RE0562
0393 C*                                                                   RE0562
     C           RDRECI    IFNE 'M'                                       093765
0394 C   U1 76                                                            RE0562
0395 CORNU1 74             SETON                       21                 RE0562
     C           DACP      COMP *BLANKS                  11               S01117
     C           CACP      COMP *BLANKS                  12               S01117
     C           CHAC      COMP *BLANKS                  13               S01117
     C*                                                                   093765
     C                     ELSE                                           093765
     C*                                                                   093765
     C** Set on 14 if the account is missing.                             093765
     C           *INU1     IFEQ '1'                                       093765
     C           *IN76     ANDEQ'1'                                       093765
     C           *INU1     OREQ '0'                                       093765
     C           *IN74     ANDEQ'1'                                       093765
     C                     MOVE '1'       *IN14                           093765
     C                     END                                            093765
     C*                                                                   093765
     C                     END                                            093765
     C*                                                                   093765
     C           *IN14     IFEQ '1'                                       093765
     C*                                                                   093765
     C** Check if whole GL account was used or just the RE a/c no.        093765
     C                     MOVE CNUM      @CNUM   6                       093765
     C           @CNUM     IFEQ *BLANKS                                   093765
     C           @CNUM     OREQ '000000'                                  093765
     C                     MOVE '1'       *IN19                           093765
     C                     ELSE                                           093765
     C                     MOVE '0'       *IN19                           093765
     C                     END                                            093765
     C*                                                                   093765
     C** If this is first record to be reported, print sub-header.        093765
     C           *IN10     IFEQ '0'                                       093765
     C                     MOVE '1'       *IN16                           093765
     C                     EXCPT                                          093765
     C                     MOVE '0'       *IN16                           093765
     C                     Z-ADD10        @LINE                           093765
     C                     END                                            093765
     C*                                                                   093765
     C** There is at least one missing default retail account.            093765
     C                     MOVE '1'       *IN10                           093765
     C*                                                                   093765
     C** Print header first if overflow.                                  093765
     C           @LINE     IFGT 56                                        093765
     C                     Z-ADD10        @LINE   20                      093765
     C                     MOVE '1'       *IN15                           093765
     C                     MOVE '1'       *IN16                           093765
     C                     EXCPT                                          093765
     C                     MOVE '0'       *IN15                           093765
     C                     MOVE '0'       *IN16                           093765
     C                     END                                            093765
     C*                                                                   093765
     C/COPY WNCPYSRC,RE0562C001
     C                     MOVE '1'       *IN17                           093765
     C                     EXCPT                                          093765
     C                     MOVE '0'       *IN17                           093765
     C                     ADD  1         @LINE                           093765
     C                     END                                            093765
0396 C*                                                                   RE0562
0397 C*  FORMAT THE RECORD IF IT IS TO BE PRINTED                         RE0562
0398 C*                                                                   RE0562
0399 C   21                EXSR FORMT                                     RE0562
     C   21                SETOF                     77                   S01117
     C   21                SETON                     65                   S01117
0400 C*                                                                   RE0562
0401 C           LASTR     TAG                             ** LASTR TAG   RE0562
     C*                                                                   093765
     C** If REDES trailer record read, print 'END OF REPORT'.  Print      093765
     C** 'NO DETAILS TO REPORT' first if there are no missing retail      093765
     C** accounts.                                                        093765
     C           *IN02     IFEQ '1'                                       093765
     C           *INU1     OREQ '1'                                       093765
     C           *IN85     ANDEQ'1'                                       093765
     C                     MOVE '1'       *IN18                           093765
     C                     EXCPT                                          093765
     C                     MOVE '0'       *IN18                           093765
     C                     END                                            093765
     C*                                                                   093765
     C*                                                                   S01117
     C*  OUTPUT HEADING IF NO DETAILS IN P1 OR DATABASE ERROR             S01117
     C*                                                                   S01117
     CL1 U1 85 69                                                         S01117
     COR U7 69                                                            S01117
     COR    77 69          EXCPTNODTL                                     S01117
0402 C*                                                                   RE0562
0403 C*  IF DATABASE ERROR OR NO INPUT TODAY FOR                          RE0562
0404 C*  AN AUDIT REPORT, NO FILE CONTROL CHECK DONE.                     RE0562
0405 C*                                                                   RE0562
0406 CLR U7                                                               RE0562
0407 COR U1 85             GOTO END                                       RE0562
0408 C*                                                                   RE0562
0409 C*  FOR LIST, TEST FOR NO DETAILS TO REPORT                          RE0562
0410 C*                                                                   RE0562
0411 C*RNU1      RN,2      COMP 0                        77               S01117
     CLRNU1      RN,2      SUB  @MSS      @TEMP   50                      093765
     CLRNU1      @TEMP     COMP 0                        77               093765
0413 C*                                                                   RE0562
0414 C*  TEST FOR ALL ACTIVE RECORDS READ - COUNT AND HASH                RE0562
0415 C*                                                                   RE0562
0415 CLR         MBIN      IFEQ 'Y'                                       S01117
0415 CLR         BRNCH     ANDEQ'ALL'                                     S01117
0415 CLR         MBIN      OREQ 'N'                                       S01117
0416 CLR         RN,1      COMP NR,1                 7979                 RE0562
0417 CLRN79      RW,1      COMP WN,1                 7979                 RE0562
0418 CLRN79      RD,1      COMP DC,1                 7979                 RE0562
0419 CLR 79                SETON                     U8                   RE0562
0415 CLR                   END                                            S01117
0420 C*                                                                   RE0562
0421 C*  IF LISTING REPORT, GOTO END                                      RE0562
0422 C*                                                                   RE0562
0423 CLRNU1                GOTO END                                       RE0562
0424 C*                                                                   RE0562
0425 C*  CALCULATE NUMBER OF LIVE RECORDS FROM TRAILER                    RE0562
0426 C*                                                                   RE0562
0427 CLR         NR,2      ADD  NR,3      RN,4                            RE0562
0428 CLR         RN,4      SUB  NR,5      RN,4             ** TOTAL       RE0562
0429 C*                                                                   RE0562
0430 C*  CALCULATE HASH TOTAL OF LIVE RECORDS AFTER INPUT FROM TRAILER    RE0562
0431 C*                                                                   RE0562
0432 C*  PUT HASH OF LIVE RECORDS BEFORE INPUT INTO ZZ FIELDS             RE0562
0433 C*                                                                   RE0562
0434 CLR                   Z-ADDWN,2      ZZTOTI                          RE0562
0435 CLR                   Z-ADDDC,2      ZZTOTD                          RE0562
0436 C*                                                                   RE0562
0437 C*  ADD HASH OF INSERTED RECORDS                                     RE0562
0438 C*                                                                   RE0562
0439 CLR                   Z-ADDWN,3      ZZAMTI                          RE0562
0440 CLR                   Z-ADDDC,3      ZZAMTD                          RE0562
0441 CLR                   EXSR GLZSUM                                    RE0562
0442 C*                                                                   RE0562
0443 C*  ADD HASH OF AMENDMENTS                                           RE0562
0444 C*                                                                   RE0562
0445 CLR                   Z-ADDWN,4      ZZAMTI                          RE0562
0446 CLR                   Z-ADDDC,4      ZZAMTD                          RE0562
0447 CLR                   EXSR GLZSUM                                    RE0562
0448 C*                                                                   RE0562
0449 C*  SUBTRACT HASH OF DELETIONS                                       RE0562
0450 C*                                                                   RE0562
0451 CLR                   Z-SUBWN,5      ZZAMTI                          RE0562
0452 CLR                   Z-SUBDC,5      ZZAMTD                          RE0562
0453 CLR                   EXSR GLZSUM                                    RE0562
0454 C*                                                                   RE0562
0455 CLR                   MOVE ZZTOTI    RW,4                            RE0562
0456 CLR                   MOVE ZZTOTD    RD,4                            RE0562
0457 C*                                                                   RE0562
0458 C*  COMPARE PROGRAM'S COUNT AND HASH OF LIVE RECORDS                 RE0562
0459 C*  READ WITH THOSE JUST CALCULATED.                                 RE0562
0460 C*                                                                   RE0562
0415 CLR         MBIN      IFEQ 'Y'                                       S01117
0415 CLR         BRNCH     ANDEQ'ALL'                                     S01117
0415 CLR         MBIN      OREQ 'N'                                       S01117
0461 CLR         RN,2      COMP RN,4                 7878                 RE0562
0462 CLRN78      RW,2      COMP RW,4                 7878                 RE0562
0463 CLRN78      RD,2      COMP RD,4                 7878                 RE0562
0464 CLR 78                SETON                     U8                   RE0562
0415 CLR                   END                                            S01117
0465 C*                                                                   RE0562
0466 C*  IF DATABASE ERROR, GOTO END                                      RE0562
0467 C*                                                                   RE0562
0468 CLR U8                GOTO END                                       RE0562
0469 C*                                                                   RE0562
0470 C*  UPDATE CHAIN TO THE TRAILER                                      RE0562
0471 C*                                                                   RE0562
0472 CLR                   SETOF                     9986                 RE0562
0473 C**LR         TRLRKY    CHAINREDEF                99                              RE0562 CRE030
     CLR         ACODK     CHAINREDEFZF              99                                       CRE030
     CLRN99      RECI      COMP 'Z'                      86                                   CRE030
0474 CLRN99                                                               RE0562
0475 CAN 86                GOTO END01                                     RE0562
0476 CLR                   SETON                     U7    ** DB ERROR 92 RE0562
0477 CLR                   MOVELTRLRKY    LKEY                            RE0562
0478 CLR                   Z-ADD92        LDBNO                           RE0562
0479 CLR                   GOTO END                                       RE0562
0480 C*                                                                   RE0562
0481 CLR         END01     TAG                             ** END01 TAG   RE0562
0482 C*                                                                   RE0562
0483 C*  UPDATE THE TRAILER - IND 86 PERFORMS OUTPUT                      RE0562
0484 C*                                                                   RE0562
0485 C***LR                   EXCPT                                                    RE0562 CRE030
      *                                                                                       CRE030
     CLR                   MOVEL' '       IRRI                                                CRE030
     CLR                   Z-ADDNR,1      NR1                                                 CRE030
      *                                                                                       242897
      ** Update 'before input cycle' value with current value to start new day.               242897
      *                                                                                       242897
     C*R********           Z-ADDNR,2      NR2                                          CRE030 242897
     CLR                   Z-ADDNR,1      NR2                                                 242897
     CLR                   Z-ADD*ZERO     NR3                                                 CRE030
     CLR                   Z-ADD*ZERO     NR4                                                 CRE030
     CLR                   Z-ADD*ZERO     NR5                                                 CRE030
     CLR                   MOVE NRDS1     NRDS                                                CRE030
      *                                                                                       CRE030
     CLR                   Z-ADDWN,1      WN1                                                 CRE030
      *                                                                                       242897
      ** Update 'before input cycle' value with current value to start new day.               242897
      *                                                                                       242897
     C*R********           Z-ADDWN,2      WN2                                          CRE030 242897
     CLR                   Z-ADDWN,1      WN2                                                 242897
     CLR                   Z-ADD*ZERO     WN3                                                 CRE030
     CLR                   Z-ADD*ZERO     WN4                                                 CRE030
     CLR                   Z-ADD*ZERO     WN5                                                 CRE030
     CLR                   MOVE WNDS1     WNDS                                                CRE030
      *                                                                                       CRE030
     CLR                   Z-ADDDC,1      DC1                                                 CRE030
      *                                                                                       242897
      ** Update 'before input cycle' value with current value to start new day.               242897
      *                                                                                       242897
     C*R********           Z-ADDDC,2      DC2                                          CRE030 242897
     CLR                   Z-ADDDC,1      DC2                                                 242897
     CLR                   Z-ADD*ZERO     DC3                                                 CRE030
     CLR                   Z-ADD*ZERO     DC4                                                 CRE030
     CLR                   Z-ADD*ZERO     DC5                                                 CRE030
     CLR                   MOVE DCDS1     DCDS                                                CRE030
     CLR                   UPDATREDEFZF                                                       CRE030
0486 C*                                                                   RE0562
0487 CLR         END       TAG                             ** END TAG     RE0562
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7U8                 S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
0335 C**  IF NO DETAILS HAVE BEEN REPORTED PRINT HEADINGS                 S01117
     C*                                                                   S01117
     CLR         P1OP      IFNE 'Y'                                       S01117
     CLR                   EXSR #ZZ                                       S01117
     CLR                   END                                            S01117
      **                                                                  S01117
     CLR    99             SETON                     U7                   S01117
     CLR    U7             EXSR *PSSR                                     S01117
0488 C*                                                                   RE0562
0489 C********************************************************************RE0562
0490 C**                                                                  RE0562
0491 C           FORMT     BEGSR                           *** FORMT ***  RE0562
0492 C*                                                                   RE0562
0493 C**   CHECK FIELDS ON DEFAULT ACCOUNT FILE.                          RE0562
0494 C*                                                                   RE0562
0495 C           ODSC      COMP 'Y'                      33               RE0562
0496 C           DRIS      COMP 0                    51                   RE0562
0497 C           CRIS      COMP 0                    53                   RE0562
0498 C           CIIE      COMP 0                    63                   RE0562
0499 C*                                                                   RE0562
0500 C*    CHECK FOR CHANGE IN CURRENCY CODE.                             RE0562
0501 C           XCCY      COMP CCY                  5050                 RE0562
0502 C*                                                                   RE0562
0503 C**   LOOK UP NO. OF DECIMAL PLACES FOR CURRENCY.                    RE0562
0504 C                     MOVE CCY       XCCY    3                       RE0562
0505 C                     Z-ADD1         X                               RE0562
0506 C           XCCY      LOKUPCCYA,X                   95               RE0562
0507 C                     MOVE DPA,X     XDECP   10                      RE0562
0508 C*                                                                   RE0562
0509 C*    CHECK NUMBER OF DECIMAL PLACES FOR ACCOUNT CURRENCY.           RE0562
0510 C   50      XDECP     COMP 1                      7071               RE0562
0511 C   50      XDECP     COMP 2                    73  72               RE0562
0512 C*                                                                   RE0562
0513 C*                                                                   RE0562
0514 C*    ADJUST HELD AMOUNT AND MINIMUM BALANCE FOR OUTPUT.             RE0562
0515 C                     MOVE HELD      HELDA  140                      RE0562
0516 C                     MOVE MINB      MINBA  110                      RE0562
0517 C*                                                                   RE0562
0518 C*    CHECK CHANGE TYPE.                                             RE0562
0519 C           CHTP      COMP 'I'                      80               RE0562
0520 C           CHTP      COMP 'A'                      81               RE0562
0521 C           CHTP      COMP 'C'                      82               RE0562
0522 C           CHTP      COMP 'R'                      83               RE0562
0523 C*                                                                   RE0562
0524 C*    OBTAIN CUSTOMER DETAILS FOR RETAIL                             RE0562
0525 C**********           MOVELCNUM      CKEY                            S01194
0525 C                     MOVELCNUM      KEYC                            S01194
0526 C********** CKEY      CHAINCLINT                41                   S01194
     C                     CALL 'AOCUSTR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*KEY    '@OPTN   7                       S01194
     C                     PARM           KEYC   10                       S01194
     C                     PARM           KEYSTS  7                       S01194
     C           SDCUST    PARM SDCUST    DSSDY                           S01194
     C           @RTCD     COMP *BLANKS              4141                 S01194
0527 C**N41***** RECI      COMP 'D'                  4141                 S01194
0528 C***41*****           MOVEL'CLINT'   LFILE                           S01194
0528 C                     MOVEL'SDCUSTPD'LFILE                           S01194
0529 C***41*****           MOVELKEYC      LKEY                            S01194
0529 C   41                MOVELCNUM      LKEY                            S01194
0530 C   41                Z-ADD1         LDBNO            ** DB ERROR 01 RE0562
0531 C   41                SETON                     U7LR                 RE0562
0532 C   41                GOTO ENDFM                                     RE0562
0533 C*                                                                   RE0562
0534 C**                                                                **RE0562
0535 C*  FOR RETAIL A/C'S CHAIN TO RETAIL FILES.                          RE0562
0536 C*                                                                  *RE0562
0537 C                     MOVELCNUM      PART1   9                       RE0562
0538 C                     MOVE CCY       PART1                           RE0562
0539 C**********           MOVELACOD      PART2   6                                    RE0562 CGL029
     C                     MOVELACOD      PART2  12                                           CGL029
0540 C                     MOVE ACSQ      PART2                           RE0562
0541 C*****                MOVELPART1     REKEY  15                       S01117
0542 C*****                MOVE PART2     REKEY                           S01117
     C**********           MOVELPART1     REKEY1 15                                    S01117 CGL029
     C                     MOVELPART1     REKEY1 21                                           CGL029
     C                     MOVE PART2     REKEY1                          S01117
     C**********           MOVELREKEY1    REKEY  18                                    S01117 CGL029
     C                     MOVELREKEY1    REKEY  24                                           CGL029
     C                     MOVE BRCA      REKEY                           S01117
0543 C           REKEY     CHAINREIAC                22                   RE0562
0544 C  N22      REKEY     CHAINREACR                23                   RE0562
0545 C*                                                                   RE0562
0546 C**   DATABASE ERROR IF NOT FOUND.                                   RE0562
0547 C*                                                                   RE0562
0548 C   22                MOVEL'REIAC'   LFILE                           RE0562
0549 C   23                MOVEL'REACR'   LFILE                           RE0562
0550 C   22                                                               RE0562
0551 COR 23                Z-ADD2         LDBNO            ** DB ERROR 02 RE0562
0552 C   22                                                               RE0562
0553 COR 23                MOVELREKEY     LKEY                            RE0562
0554 C   22                                                               RE0562
0555 COR 23                SETON                     U7LR                 RE0562
0556 C   22                                                               RE0562
0557 COR 23                GOTO ENDFM                                     RE0562
0558 C*                                                                   RE0562
0559 C**   CHECK FIELDS ON RETAIL FILES RECORDS.                          RE0562
0560 C*                                                                   RE0562
0561 C           MADI      COMP 0                    55  55               RE0562
0562 C           MACI      COMP 0                    57  57               RE0562
0563 C           GACI      COMP 0                    66                   RE0562
0564 C*                                                                   RE0562
0565 C*    CONVERT DATES FOR REPORT PRINTING TO DDMMYY FORMAT.            RE0562
0566 C*                                                                   RE0562
0567 C                     Z-ADDDACO      ZDAYNO                          RE0562
0568 C                     EXSR ZDATE2                                    RE0562
0569 C                     MOVE ZADATE    OPNDAT  7        OPEN DATE      RE0562
0570 C*                                                                   RE0562
0571 C                     Z-ADDODED      ZDAYNO                          RE0562
0572 C                     EXSR ZDATE2                                    RE0562
0573 C                     MOVE ZADATE    EXPDAT  7        EXPIRY DATE    RE0562
0574 C*                                                                   RE0562
0575 C                     Z-ADDNSTD      ZDAYNO                          RE0562
0576 C                     EXSR ZDATE2                                    RE0562
0577 C                     MOVE ZADATE    NXTDAT  7        NEXT STATMENT  RE0562
0578 C*                                                    DATE           RE0562
0579 C*                                                                   RE0562
0580 C                     TESTB'0'       RETB           42REFER DEBITS   RE0562
0581 C*                                                                   RE0562
0582 C                     TESTB'1'       RETB           43REFER CREDITS  RE0562
0583 C*                                                                   RE0562
0584 C                     TESTB'2'       RETB           44BLOCK DEBITS   RE0562
0585 C*                                                                   RE0562
0586 C                     TESTB'2'       GLBT           45PRINT ADDRESS  RE0562
0587 C*                                                                   RE0562
0588 C                     TESTB'3'       RETB           46BLOCK CREDITS  RE0562
0589 C*                                                                   RE0562
0590 C                     TESTB'4'       RETB           47INACTIVE       RE0562
0591 C*                                                                   RE0562
0592 C                     TESTB'6'       RETB           48BANKRUPT       RE0562
0593 C*                                                                   RE0562
0594 C                     TESTB'7'       RETB           49BAD DEBT       RE0562
0595 C*                                                                   RE0562
0596 C                     Z-ADDLMVD      ZDAYNO                          RE0562
0597 C                     EXSR ZDATE2                                    RE0562
0598 C                     MOVE ZADATE    LMVDAT  7        LAST MOVE.DATE RE0562
0599 C*                                                                   RE0562
0600 C                     Z-ADDLACD      ZDAYNO                          RE0562
0601 C                     EXSR ZDATE2                     LAST ACTIVITY  RE0562
0602 C                     MOVE ZADATE    LACDAT  7        DATE           RE0562
0603 C*                                                                   RE0562
0604 C                     Z-ADDLCD       ZDAYNO                          RE0562
0605 C                     EXSR ZDATE2                     LAST CHANGE    RE0562
0606 C                     MOVE ZADATE    LCHDAT  7        DATE           RE0562
0607 C*                                                                   RE0562
0608 C                     Z-ADDDRCD      ZDAYNO                          RE0562
0609 C                     EXSR ZDATE2                     DEBIT RATE     RE0562
0610 C                     MOVE ZADATE    DRCDAT  7        CHANGE DATE    RE0562
0611 C*                                                                   RE0562
0612 C                     Z-ADDCRCD      ZDAYNO                          RE0562
0613 C                     EXSR ZDATE2                     CREDIT RATE    RE0562
0614 C                     MOVE ZADATE    CRCDAT  7        CHANGE DATE    RE0562
0615 C*                                                                   RE0562
0616 C                     Z-ADDNDID      ZDAYNO                          RE0562
0617 C                     EXSR ZDATE2                     NEXT CAP.      RE0562
0618 C                     MOVE ZADATE    NDIDAT  7        DEBIT DATE     RE0562
0619 C*                                                                   RE0562
0620 C                     Z-ADDNCID      ZDAYNO                          RE0562
0621 C                     EXSR ZDATE2                     NEXT CAP.      RE0562
0622 C                     MOVE ZADATE    NCIDAT  7        CREDIT DATE    RE0562
0623 C*                                                                   RE0562
0624 C                     Z-ADDLDID      ZDAYNO                          RE0562
0625 C                     EXSR ZDATE2                     LAST POSTING   RE0562
0626 C                     MOVE ZADATE    LPDDAT  7        DATE - DEBIT   RE0562
0627 C*                                                                   RE0562
0628 C                     Z-ADDLCID      ZDAYNO                          RE0562
0629 C                     EXSR ZDATE2                     LAST POSTING   RE0562
0630 C                     MOVE ZADATE    LPCDAT  7        DATE -CREDIT   RE0562
0631 C*                                                                   RE0562
     C/COPY WNCPYSRC,RE0562C002
0632 C*                                                                   RE0562
0633 C           ENDFM     ENDSR                           *** ENDFM ***  RE0562
0634 C*                                                                   RE0562
0635 C********************************************************************RE0562
0636 C**                                                                  RE0562
0637 C**   SUBR. - TO PERFORM FIRST CYCLE PROCESSING.                     RE0562
0638 C**                                                                  RE0562
0639 C           FIRSTC    BEGSR                           ***  FIRSTC ***RE0562
0640 C*                                                                   RE0562
0641 C*  SET-UP LDA FIELDS                                                RE0562
0642 C*                                                                   RE0562
     C                     MOVE *BLANK    DBFILE                          S01117
     C                     MOVE *BLANK    DBKEY                           S01117
     C                     MOVE *BLANK    DBASE                           S01117
     C                     MOVEL*BLANK    DBPGM                           S01117
0643 C***********          MOVE 'REDES'   LFILE                           S01117
0643 C                     MOVEL'REDES'   LFILE                           S01117
0644 C                     MOVE 'RE0562  'LPROG                           RE0562
0645 C                     MOVEL'REP0562 'LPROC                           RE0562
0646 C*                                                                   RE0562
0647 C*  SET-UP BLANK LKEY                                                RE0562
0648 C*                                                                   RE0562
0649 C                     MOVE ' '       BLK200200                       RE0562
0650 C                     MOVE BLK200    LKEY                            RE0562
0651 C*                                                                   RE0562
0652 C*  SET-UP ZEROES                                                    RE0562
0653 C                     Z-ADD0         ZERO03  30                      RE0562
0654 C                     Z-ADD0         ZERO05  50                      RE0562
0655 C                     Z-ADD0         ZERO15 150                      RE0562
0656 C*                                                                   RE0562
0657 C*  SET-UP TRAILER KEY                                               RE0562
0658 C*                                                                   RE0562
0659 C**********           MOVEL'9999D'   TRLRKY  5                                    RE0562 CGL029
     C           ACODK     KLIST                                                              CRE030
     C                     KFLD           WWACOD 100                                          CRE030
     C                     KFLD           WWRECD  1                                           CRE030
      *                                                                                       CRE030
     C                     MOVE *ALL'9'   TRLRKY 11                                           CGL029
     C                     MOVE 'D'       TRLRKY                                              CGL029
     C                     MOVE *ALL'9'   WWACOD                                              CRE030
     C                     MOVE 'D'       WWRECD                                              CRE030
0660 C                     MOVE 'A'       CKEY    7                       RE0562
      *                                                                                      BUG3800
      **  Perform SPF processing first, in case of errors with ICD in first cycle.           BUG3800
      *                                                                                      BUG3800
     C                     OPEN RE0562P2                                                     BUG3800
      *                                                                                      BUG3800
      **   ENSURE REPORT SPOOL FILE RECORDED BY RCF                                          BUG3800
      *                                                                                      BUG3800
     C                     Z-ADDSFNUM2    ZSNUM   60                                         BUG3800
      *                                                                                      BUG3800
     C                     OUT  LDA                                                          BUG3800
     C                     CALL 'ZSFILE'                                                     BUG3800
     C                     PARM           SEQ                                                BUG3800
     C                     PARM BRCA      SENTY                                              BUG3800
     C                     PARM           SFILE2                                             BUG3800
     C                     PARM           ZSNUM                                              BUG3800
     C                     PARM           ZSERR   1                                          BUG3800
     C           *LOCK     IN   LDA                                                          BUG3800
      *                                                                                      BUG3800
0661 C*                                                                   RE0562
0662 C*  EXECUTE ZSYSTM                                                   RE0562
0663 C*                                                                   RE0562
0664 C                     EXSR ZSYSTM                                    RE0562
     C*                                                                   S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     88                   S01117
     C                     END                                            S01117
0665 C                     Z-ADDRUND      LRUND                           RE0562
0666 C                     MOVELRUNA      LRUNA                           RE0562
0667 C                     MOVELSFLG      LSFLG                           RE0562
0668 C                     MOVELDATF      LDATF                           RE0562
0669 C  N99                GOTO TAG01                                     RE0562
0670 C                     SETON                     U7LR  ** DB ERROR 90 RE0562
0671 C**********           MOVE 'TABLE'   LFILE                           S01194
0672 C**********           MOVELZTABKY    LKEY                            S01194
0673 C**********           Z-ADD90        LDBNO                           S01194
0674 C                     GOTO ENDFC                                     RE0562
0675 C*                                                                   RE0562
0676 C           TAG01     TAG                             ** TAG01 TAG   RE0562
0677 C**                                                                  RE0562
0678 C**   ACCESS ICR 3                                                   RE0562
0679 C**********           MOVE '20'      ZTABKY                          S01194
0680 C********** ZTABKY    CHAINTABLE                99                   S01194
     C                     CALL 'AORETLR0'                                S01194
     C                     PARM '*MSG   ' @RTCD   7                       S01194
     C                     PARM '*FIRST ' @OPTN   7                       S01194
     C           SDRETL    PARM SDRETL    DSFDY                           S01194
0681 C**N99***** RECI      COMP 'D'                  9999                 S01194
     C           @RTCD     COMP *BLANKS              9999                 S01194
0682 C***99*****           MOVEL'TABLE'   LFILE                           S01194
0682 C   99                MOVEL'SDRETLPD'LFILE                           S01194
0683 C***99*****           MOVELZTABKY    LKEY                            S01194
0684 C***99*****           SETON                     U7LR                 S01194
0685 C   99                Z-ADD93        LDBNO             ** DBERR 93 **RE0562
0686 C   99                GOTO ENDFC                                     RE0562
0687 C           RACN      COMP 'Y'                      61               RE0562
0688 C                     EXSR CCYARR                                    RE0562
     C/COPY WNCPYSRC,RE0562C003
0689 C*                                                                   RE0562
0690 C*  CHAIN TO THE TRAILER                                             RE0562
0691 C*                                                                   RE0562
0692 C                     SETOF                     9986                 RE0562
0693 C********   TRLRKY    CHAINREDEF                99                                RE0562 CRE030
     C           ACODK     CHAINREDEFZF              99                                       CRE030
     C  N99      RECI      COMP 'Z'                      86                                   CRE030
0694 C  N99                                                               RE0562
0695 CAN 86                GOTO TAG02                                     RE0562
0696 C                     SETON                     U7LR  ** DB ERROR 91 RE0562
0697 C                     MOVELTRLRKY    LKEY                            RE0562
0698 C                     Z-ADD91        LDBNO                           RE0562
0699 C                     GOTO ENDFC                                     RE0562
0700 C*                                                                   RE0562
0701 C           TAG02     TAG                             ** TAG02 TAG   RE0562
      *                                                                                       CRE030
     C                     MOVE NRDS      NRDS1                                               CRE030
     C                     Z-ADDNR1       NR,1                                                CRE030
     C                     Z-ADDNR2       NR,2                                                CRE030
     C                     Z-ADDNR3       NR,3                                                CRE030
     C                     Z-ADDNR4       NR,4                                                CRE030
     C                     Z-ADDNR5       NR,5                                                CRE030
      *                                                                                       CRE030
     C                     MOVE WNDS      WNDS1                                               CRE030
     C                     Z-ADDWN1       WN,1                                                CRE030
     C                     Z-ADDWN2       WN,2                                                CRE030
     C                     Z-ADDWN3       WN,3                                                CRE030
     C                     Z-ADDWN4       WN,4                                                CRE030
     C                     Z-ADDWN5       WN,5                                                CRE030
      *                                                                                       CRE030
     C                     MOVE DCDS      DCDS1                                               CRE030
     C                     Z-ADDDC1       DC,1                                                CRE030
     C                     Z-ADDDC2       DC,2                                                CRE030
     C                     Z-ADDDC3       DC,3                                                CRE030
     C                     Z-ADDDC4       DC,4                                                CRE030
     C                     Z-ADDDC5       DC,5                                                CRE030
      *                                                                                       CRE030
      ** Check if SAR CAP205 - Teller Related APIs Account Balance Check is installed         CAP205
      *                                                                                       CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM *BLANKS   @RTCD                                               CAP205
     C                     PARM '*VERIFY' @OPTN                                               CAP205
     C                     PARM 'CAP205'  @SARD   6                                           CAP205
     C           SCSARD    PARM *BLANKS   DSFDY                                               CAP205
      *                                                                                       CAP205
     C           @RTCD     IFEQ *BLANKS                                                       CAP205
     C                     SETON                     89                                       CAP205
     C                     ELSE                                                               CAP205
     C                     SETOF                     89                                       CAP205
     C           @RTCD     IFNE '*NRF   '                                                     CAP205
     C                     MOVEL'CAP205'  DBKEY                                               CAP205
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP205
     C                     Z-ADD6         DBASE                                               CAP205
     C                     SETON                     U7U8LR                                   CAP205
     C                     EXSR *PSSR                                                         CAP205
     C                     ENDIF                                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
0702 C           IRRI      COMP ' '                      85               RE0562
0703 C*                                                                   RE0562
0704 C*  IF AUDIT REPORT AND NO INPUT TODAY, GOTO ENDFC                   RE0562
0705 C*                                                                   RE0562
0706 C   U1 85             SETON                     LR87                 RE0562
     C**                                                                  132486
      *                                                                                      BUG3800
      ** SPF processing moved to top of subroutine.                                          BUG3800
      *                                                                                      BUG3800
     C**********           OPEN RE0562P2                                              132486 BUG3800
     C**********                                                                      132486 BUG3800
     C*****ENSURE*REPORT*SPOOL*FILE*RECORDED*BY RCF                                   132486 BUG3800
     C**********                                                                      132486 BUG3800
     C**********           Z-ADDSFNUM2    ZSNUM   60                                  132486 BUG3800
     C**********                                                                      132486 BUG3800
     C**********           OUT  LDA                                                   132486 BUG3800
     C**********           CALL 'ZSFILE'                                              132486 BUG3800
     C**********           PARM           SEQ                                         132486 BUG3800
     C**********           PARM BRCA      SENTY                                       132486 BUG3800
     C**********           PARM           SFILE2                                      132486 BUG3800
     C**********           PARM           ZSNUM                                       132486 BUG3800
     C**********           PARM           ZSERR   1                                   132486 BUG3800
     C********** *LOCK     IN   LDA                                                   132486 BUG3800
      **********                                                                      132486 BUG3800
      *                                                                   132486
0708 C*                                                                   RE0562
0712 C           ENDFC     ENDSR                           *** ENDFC ***  RE0562
0713 C*                                                                   RE0562
0714 C********************************************************************RE0562
0715 C**                                                                  RE0562
0716 C**   SUBR. - TO ADD 1 TO RN,H AND TO ADD ZZAMT TO RW/RD,H           RE0562
0717 C**                                                                  RE0562
0718 C           NPZTOT    BEGSR                           ***  NPZTOT ***RE0562
0719 C                     Z-ADDH         H       10                      RE0562
0720 C*                                                                   RE0562
0721 C           RN,H      ADD  1         RN,H                            RE0562
0722 C*                                                                   RE0562
0723 C                     Z-ADDRW,H      ZZTOTI                          RE0562
0724 C                     Z-ADDRD,H      ZZTOTD                          RE0562
0725 C                     EXSR GLZADD                                    RE0562
0726 C                     Z-ADDZZTOTI    RW,H                            RE0562
0727 C                     Z-ADDZZTOTD    RD,H                            RE0562
0728 C*                                                                   RE0562
0729 C                     ENDSR                                          RE0562
0730 C********************************************************************RE0562
0731 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  RE0562
0732 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            RE0562
0733 C*                                                                   RE0562
0734 CSR         GLZADD    BEGSR                           *** GLZADD ****RE0562
0735 C*                                                                   RE0562
0736 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  RE0562
0737 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS RE0562
0738 C*                                                                   RE0562
0739 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       RE0562
0740 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  RE0562
0741 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  RE0562
0742 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  RE0562
0743 C*                                                                   RE0562
0744 CSR                   EXSR GLZSUM                                    RE0562
0745 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *RE0562
0746 C*                                                                   RE0562
0747 C********************************************************************RE0562
0748 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            RE0562
0749 C*                        GLZADD, GLZSUB, GLZCMP.                    RE0562
0750 C*          PARAMETERS PASSED -                                      RE0562
0751 C*                     I/P ZZAMTI ZZAMTD                             RE0562
0752 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       RE0562
0753 C*                                                                   RE0562
0754 CSR         GLZSUM    BEGSR                           *** GLZSUM ****RE0562
0755 C*                                                                   RE0562
0756 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  RE0562
0757 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  RE0562
0758 CSR                   SETOF                     919293               RE0562
0759 CSR                   SETOF                     949599               RE0562
0760 C*                                                                   RE0562
0761 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      RE0562
0762 CSR         ZZAMTI    COMP 0                      9293               RE0562
0763 CSR 93      ZZAMTD    COMP 0                      9293               RE0562
0764 CSR 93                GOTO ZZSEND                     ZERO BYPASS    RE0562
0765 C*                                                                   RE0562
0766 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       RE0562
0767 CSR         ZZTOTI    COMP 0                      9193               RE0562
0768 CSR 93      ZZTOTD    COMP 0                      9193               RE0562
0769 C*                                                                   RE0562
0770 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           RE0562
0771 CSR 93                Z-ADDZZAMTI    ZZTOTI                          RE0562
0772 CSR 93                Z-ADDZZAMTD    ZZTOTD                          RE0562
0773 CSR 93                GOTO ZZSEND                     ZERO BYPASS    RE0562
0774 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        RE0562
0775 CSR 91N92                                                            RE0562
0776 CORN91 92             GOTO ZZOFPS                                    RE0562
0777 C*                                                                   RE0562
0778 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      RE0562
0779 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   RE0562
0780 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.RE0562
0781 C*                                                                   RE0562
0782 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VERE0562
0783 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VERE0562
0784 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           RE0562
0785 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           RE0562
0786 C*                                                                   RE0562
0787 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    RE0562
0788 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. RE0562
0789 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      RE0562
0790 CSRN99                Z-ADDZZWK2     ZZTOTD                          RE0562
0791 CSRN99                Z-ADDZZWK3     ZZTOTI                          RE0562
0792 C*                                                                   RE0562
0793 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. RE0562
0794 CSR 99                Z-ADD0         ZZAMT  153                      RE0562
0795 CSR                   GOTO ZZSEND                                    RE0562
0796 C*                                                                   RE0562
0797 C* THE 'SIGNS' ARE DIFFERENT                                         RE0562
0798 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**RE0562
0799 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            RE0562
0800 C*                                                                   RE0562
0801 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      RE0562
0802 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      RE0562
0803 C*                                                                   RE0562
0804 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           RE0562
0805 C*                                                                   RE0562
0806 CSR 91                Z-SUBZZTOTI    ZZTOTI                          RE0562
0807 CSR 91                Z-SUBZZTOTD    ZZTOTD                          RE0562
0808 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            RE0562
0809 C*                                                                   RE0562
0810 CSR         ZZTOTI    COMP ZZAMTI               93  95               RE0562
0811 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               RE0562
0812 C*                                                                   RE0562
0813 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   RE0562
0814 CSR 95                Z-ADD0         ZZTOTI                          RE0562
0815 CSR 95                Z-ADD0         ZZTOTD                          RE0562
0816 CSR 95                GOTO ZZSEND                                    RE0562
0817 C*                                                                   RE0562
0818 C* IF ZZTOT GT. ZZAMT.                                               RE0562
0819 CSR 93      ZZAMTD    COMP ZZTOTD               94                   RE0562
0820 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          RE0562
0821 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           RE0562
0822 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          RE0562
0823 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          RE0562
0824 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          RE0562
0825 C*                                                                   RE0562
0826 C*                                                                   RE0562
0827 C* IF ZZAMT GT. ZZTOT.                                               RE0562
0828 CSRN93      ZZTOTD    COMP ZZAMTD               94                   RE0562
0829 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      RE0562
0830 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           RE0562
0831 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          RE0562
0832 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          RE0562
0833 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          RE0562
0834 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          RE0562
0835 C*                                                                   RE0562
0836 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          RE0562
0837 CSR                   SETOF                     94                   RE0562
0838 CSR 93 91                                                            RE0562
0839 CORN93 92             SETON                     94                   RE0562
0840 CSR 94                Z-SUBZZTOTI    ZZTOTI                          RE0562
0841 CSR 94                Z-SUBZZTOTD    ZZTOTD                          RE0562
0842 C**                                                                  RE0562
0843 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            RE0562
0844 CSR 92                Z-SUBZZAMTI    ZZAMTI                          RE0562
0845 CSR 92                Z-SUBZZAMTD    ZZAMTD                          RE0562
0846 CSR         ZZSEND    TAG                             ** ZZSEND TAG *RE0562
0847 C**                                                                  RE0562
0848 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           RE0562
0849 CSR                   SETOF                     96                   RE0562
0850 CSR         ZZTOTD    COMP 0                        91               RE0562
0851 CSR 91      ZZTOTI    COMP 0                      96                 RE0562
0852 CSR 96                MOVE '.000-'   ZZNEGD  5                       RE0562
0853 CSR                   ENDSR                             ** ENDSR **  RE0562
0854 C********************************************************************RE0562
0855 C**                                                                  RE0562
0856 C**   SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.          RE0562
0857 C**                                                                  RE0562
0858 CSR         ZSYSTM    BEGSR                           ZSYSTM BEGSR   RE0562
0859 C**********                                                          S01194
0860 C*****SET*UP KEY FOR INSTALLATION CONTROL RECORD.                    S01194
0861 C*R********           MOVEL'01      'ZTABKY 12                       S01194
0862 C*R********           MOVE '  10'    ZTABKY                          S01194
0863 C**********                                                          S01194
0864 C*R******** ZTABKY    CHAINTABLE                99    ON NOT THERE   S01194
0865 C*RN99***** RECI      COMP '*'                      99ON, IS DELETED S01194
0866 C**********                                                          S01194
      ** ACCESS BANK DETAILS                                              S01194
     CSR                   CALL 'AOBANKR0'                                S01194
     CSR                   PARM '*MSG   ' @RTCD   7                       S01194
     CSR                   PARM '*FIRST ' @OPTN   7                       S01194
     CSR         SDBANK    PARM SDBANK    DSFDY                           S01194
     C*                                                                   S01194
     CSR         @RTCD     COMP *BLANKS              9999                 S01194
     CSR 99                MOVEL'SDBANKPD'LFILE                           S01194
     CSR 99                Z-ADD4         LDBNO            ************** S01194
     CSR 99                SETON                     U7U8LR* DBERROR04  * S01194
0867 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.     ************** S01194
0868 C*R******** DATF      COMP 'M'                      98MMDDYY, 98 ON. S01194
0868 CSR         BJDFIN    COMP 'M'                      98MMDDYY, 98 ON. S01194
0869 C**                                                                  RE0562
0870 CSR                   ENDSR                                          RE0562
0871 C**                                                                  RE0562
0872 C**                                                                  RE0562
0873 C********************************************************************RE0562
0874 C**                                                                  RE0562
0875 C**   SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.                   RE0562
0876 C**                                                                  RE0562
0877 CSR         ZDATE2    BEGSR                           ZDATE2 BEGSR   RE0562
0878 C**                                                                  RE0562
0879 C**   CLEAR DATE FIELDS.                                             RE0562
0880 CSR                   Z-ADD0         ZDATE   60                      RE0562
0881 CSR                   MOVEL'       ' ZADATE  7                       RE0562
0882 C**                                                                  RE0562
0883 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.                        RE0562
0884 CSR                   Z-ADDZDAYNO    ZDAYNO  50                      RE0562
0885 C**                                                                  RE0562
0886 C**   DETERMINE YEAR NUMBER.                                         RE0562
0887 C**                                                                  RE0562
0888 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    RE0562
0889 CSR         ZDAYNO    SUB  1         ZDAYN1  50   99                 RE0562
0890 CSR 99                GOTO ZDEND2                                    RE0562
0891 C**                                                                  RE0562
0892 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             RE0562
0893 CSR         ZDAYN1    DIV  1461      ZLYR    20                      RE0562
0894 CSR                   MVR            ZDAYN1           SAVE REMAINING RE0562
0895 C**                                                   DAYS.          RE0562
0896 C**   CALCULATE NUMBER OF REMAINING YEARS.                           RE0562
0897 CSR                   Z-ADD1         ZWRK2   20                      RE0562
0898 CSR         ZDTAG1    TAG                             ZDTAG1 TAG     RE0562
0899 CSR         ZDAYN1    COMP ZYDY,ZWRK2             90                 RE0562
0900 CSRN90      ZWRK2     ADD  1         ZWRK2                           RE0562
0901 CSRN90                GOTO ZDTAG1                                    RE0562
0902 CSR         ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON.RE0562
0903 C**                                                                  RE0562
0904 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  RE0562
0905 CSRN91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          RE0562
0906 C**                                                                  RE0562
0907 C**   CALCULATE ACTUAL YEAR NUMBER.                                  RE0562
0908 CSR         ZLYR      MULT 4         ZWRK3   30                      RE0562
0909 CSR         ZWRK3     ADD  72        ZWRK3            BASE IS 1972.  RE0562
0910 CSR                   Z-ADDZWRK3     ZYEAR   20                      RE0562
0911 CSR         ZYEAR     ADD  ZWRK2     ZYEAR            YEAR.          RE0562
0912 C**                                                                  RE0562
0913 C**   DETERMINE MONTH NUMBER.                                        RE0562
0914 C**                                                                  RE0562
0915 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         RE0562
0916 CSR                   SETOF                     9293                 RE0562
0917 CSR 91      ZDAYN1    COMP 59                     9293               RE0562
0918 CSR 91N92   ZDAYN1    SUB  1         ZDAYN1                          RE0562
0919 C**                                                                  RE0562
0920 C**   CALCULATE MONTH NUMBER.                                        RE0562
0921 CSR                   Z-ADD2         ZWRK2                           RE0562
0922 CSR         ZDTAG2    TAG                             ZDTAG2 TAG     RE0562
0923 CSR         ZDAYN1    COMP ZMDY,ZWRK2             94                 RE0562
0924 CSRN94      ZWRK2     ADD  1         ZWRK2                           RE0562
0925 CSRN94                GOTO ZDTAG2                                    RE0562
0926 CSR         ZWRK2     SUB  1         ZWRK2                           RE0562
0927 C**                                                                  RE0562
0928 CSR                   Z-ADDZWRK2     ZMTH    20       MONTH.         RE0562
0929 C**                                                                  RE0562
0930 C**   DETERMINE DAY OF MONTH.                                        RE0562
0931 C**                                                                  RE0562
0932 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.                          RE0562
0933 CSR         ZDAYN1    ADD  1         ZDAYN1                          RE0562
0934 C**                                                                  RE0562
0935 C**   CALCULATE DAY OF MONTH.                                        RE0562
0936 CSR         ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY.           RE0562
0937 C**                                                                  RE0562
0938 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       RE0562
0939 CSR 93      ZDAY      ADD  1         ZDAY                            RE0562
0940 C**                                                                  RE0562
0941 C**   FORMAT DATE, DDMMYY OR MMDDYY.                                 RE0562
0942 CSRN98                MOVELZDAY      ZWRK4   40                      RE0562
0943 CSR 98                MOVE ZDAY      ZWRK4                           RE0562
0944 CSRN98                MOVE ZMTH      ZWRK4                           RE0562
0945 CSR 98                MOVELZMTH      ZWRK4                           RE0562
0946 CSR                   MOVELZWRK4     ZDATE                           RE0562
0947 CSR                   MOVE ZYEAR     ZDATE                           RE0562
0948 C**                                                                  RE0562
0949 C**   FORMAT ALPHA DATE, DDMMMYY.                                    RE0562
0950 CSR         ZDAY      COMP 10                     95                 RE0562
0951 CSR                   MOVELZDAY      ZWRK5   5                       RE0562
0952 CSR 95                MOVEL' '       ZWRK5                           RE0562
0953 CSR                   MOVE ZMNM,ZMTH ZWRK5                           RE0562
0954 CSR                   MOVELZWRK5     ZADATE                          RE0562
0955 CSR                   MOVE ZYEAR     ZADATE                          RE0562
0956 C**                                                                  RE0562
0957 CSR         ZDEND2    ENDSR                           ZDEND2 ENDSR   RE0562
0958 C**                                                                  RE0562
0959 C**                                                                  RE0562
0960 C********************************************************************RE0562
0961 C**                                                                  RE0562
0962 C**   SR. TO SET UP AN ARRAY OF CURRENCIES AND AN ARRAY OF           RE0562
0963 C**   DECIMAL PLACES FOR THOSE CURRENCIES.                           RE0562
0964 C**                                                                  RE0562
0965 C           CCYARR    BEGSR                           *** CCYARR  ***RE0562
0966 C**                                                                  RE0562
0967 C**   SET OFF ERROR INDICATOR                                        RE0562
0968 C                     SETOF                     99                   RE0562
0969 C**                                                                  RE0562
0970 C**   SET ARRAY INDEX TO ZERO.                                       RE0562
0971 C                     Z-ADD0         X       30                      RE0562
0972 C**********                                                          S01194
0973 C*****SET*UP KEY FOR CURRENCY TABLE.                                 S01194
0974 C**********           MOVEL'20      'XCYKEY 12                       S01194
0975 C**********           MOVE '    '    XCYKEY                          S01194
0976 C**********                                                          S01194
0977 C*****SET LOWER LIMIT AND READ CURRENCY TABLE HEADER.                S01194
0978 C********** XCYKEY    SETLLTABLE                                     S01194
0979 C**********                                                          S01194
0980 C**   LOOP TO READ CURRENCY DETAIL RECORDS.                          RE0562
0981 C           XLOOP     TAG                             ** XLOOP TAG **RE0562
0982 C**********           READ TABLE                    99               S01194
     C                     READ SDCURRL0                 99               S01194
0983 C**N99***** RECT      COMP 20                   9999                 S01194
0984 C**                                                                  RE0562
0985 C**   END IF ALL CURRENCY RECORDS PROCESSED                          RE0562
0986 C   99                GOTO XEND                                      RE0562
0987 C**                                                                  RE0562
0988 C**   IGNORE DELETED RECORDS AND NON-SUB-RECORD ONE.                 RE0562
0989 C********** RECI      COMP 'D'                  9797                 S01194
0990 C***97*****           GOTO XLOOP                                     S01194
0991 C********** SREC      COMP 1                    9797                 S01194
0992 C***97*****           GOTO XLOOP                                     S01194
0993 C**                                                                  RE0562
0994 C**   INCREMENT ARRAY INDEX.                                         RE0562
0995 C           X         ADD  1         X                               RE0562
0996 C**                                                                  RE0562
0997 C**   MOVE DATA INTO ARRAYS.                                         RE0562
0998 C                     MOVE A6CYCD    CCYA,X                          S01194
0999 C                     MOVE A6NBDP    DPA,X                           S01194
1000 C**                                                                  RE0562
1001 C**   CHECK FOR FULL ARRAY.96 ON IF FULL.                            RE0562
1002 C           X         COMP 150                      96               RE0562
1003 C**                                                                  RE0562
1004 C**   GO TO READ NEXT RECORD.                                        RE0562
1005 C  N96                GOTO XLOOP                                     RE0562
1006 C**                                                                  RE0562
1007 C           XEND      TAG                             ** XEND TAG  **RE0562
1008 C                     ENDSR                                          RE0562
     C********************************************************************S01117
     C*SUBROUTINE- CHKBR                                                  S01117
     C*PURPOSE   - DETERMINES IF BRANCH INPUT ON FACILITIES               S01117
     C*            DETAIL RECORD IS VALID FOR OUTPUT                      S01117
     C*                                                                   S01117
     C*CALLED FROM- MAIN PROGRAM CYCLE                                    S01117
     C**                                                                  S01117
     C           CHKBR     BEGSR                           *** CHKBR * ** S01117
     C**                                                                  S01117
     C                     CLOSERE0562P1                                  S01117
     C                     SETOF                     6769                 S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDEQ'ALL'                                     S01117
     C           MBIN      OREQ 'Y'                                       S01117
     C           BRNCH     ANDEQBRCA                                      S01117
     C           MBIN      OREQ 'N'                                       S01117
     C           P1OP      ANDNE'Y'                                       S01117
     C**                                                                  S01117
     C                     OPEN RE0562P1                                  S01117
     C                     SETON                       6977               S01117
     C                     MOVE 'Y'       P1OP    1                       S01117
     C                     Z-ADD0         PAGE                            S01117
     C                     Z-ADD0         PAGE1                           S01117
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRCA      SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C*    ACCESS BRANCH DETAILS                                          S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRCA      @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANK                                    S01117
     C                     SETON                     U7U8LR               S01117
     C                     SETON                     67                   S01117
     C                     MOVEL'SDBRCHPD'DBFILE                          S01117
     C                     MOVEL@DSNB     DBKEY            ***************S01117
     C                     MOVEL'002'     DBASE            * DBERROR 002 *S01117
     C                     GOTO ENDBR                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     ELSE                                           S01117
      *                                                                   S01117
      *    END THE PROGRAM IF MBIN = 'Y', BRANCH REQUESTED <> ALL,        S01117
      *    AND THE BRANCH READ ON RECORD > REQUESTED BRANCH               S01117
      *                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C           BRNCH     ANDNE'ALL'                                     S01117
     C           BRCA      ANDGTBRNCH                                     S01117
     C                     SETOF                       69                 S01117
     C                     SETON                     LR67                 S01117
     C                     GOTO ENDBR                                     S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C           ENDBR     ENDSR                                          S01117
1009 C**                                                                  RE0562
1010 C********************************************************************RE0562
     C*                                                                   S01117
     C* SUBROUTINE : #ZZ                                                  S01117
     C*                                                                   S01117
     C* CALLED BY MAIN PROCESSING DURING TOTAL TIME CALCULATIONS IF       S01117
     C* THE P1 FILES HAVE NOT ALREADY BEEN OPENED (IE, IF THERE ARE       S01117
     C* NO RECORDS READ AND THEREFORE FILES OPENING NOT PERFORMED)        S01117
     C*                                                                   S01117
     C           #ZZ       BEGSR                                          S01117
      *                                                                   S01117
      ** OPEN P1 SPOOL FILE                                               S01117
     C                     OPEN RE0562P1                                  S01117
     C                     SETON                     6977                 S01117
      *                                                                   S01117
      ** IF REPORT FOR ALL ENTITIES CALL ZSFILE WITH BLANK SENTY          S01117
     C           BRNCH     IFEQ 'ALL'                                     S01117
     C           MBIN      ORNE 'Y'                                       S01117
     C*                                                                   S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANKS   SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
      *                                                                   S01117
     C           *LOCK     IN   LDA                                       S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     MOVE 'ALL'     BRCA                            S01117
     C                     MOVE *BLANKS   BRNM                            S01117
      *                                                                   S01117
      ** ELSE REPORT BY ENTITY SO CALL ZSFILE WITH ENTITY REQUESTED       S01117
     C                     ELSE                                           S01117
      *                                                                   S01117
      ** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C**                                                                  S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM BRNCH     SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     MOVE BRNCH     BRCA                            S01117
      *                                                                   S01117
      ** AND GET ENTITY DETAILS FOR REPORT HEADINGS WHEN MULTIBRANCHING   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
      *                                                                   S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C                     PARM BRNCH     @DSNB   3                       S01117
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD5         DBASE            * DBERROR 005 *S01117
     C                     SETON                     U7U8  ***************S01117
     C                     EXSR *PSSR                                     S01117
     C                     GOTO #ZZ9                                      S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
     C                     END                                            S01117
      *                                                                   S01117
      ** OUTPUT 'NO DETAILS TO REPORT' IN P1                              S01117
     C**                                                                  S01117
     C           #ZZ9      TAG                                            S01117
     C                     EXCPTNODTL                                     S01117
     C**                                                                  S01117
     C                     ENDSR                                          S01117
0385 C**                                                                  S01117
0386 C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C**                                                                  S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
1011 O*E0562P1H  203   21                                           S01124S01117
1013 O*****                              22 'REFERENCE RE0562'            S01117
     ORE0562P1E  203           NODTL                                      S01117
1013 O                                   24 'REFERENCE RE0562P1'          S01117
1014 O                         TITL      89                               S01117
1015 O                                  104 'DATE'                        S01117
1016 O                         RUNA     113                               S01117
1017 O                                  122 'PAGE'                        S01117
1018 O                         PAGE  Z  127                               S01117
     O        E  1             NODTL                                      S01117
1021 O                 U1                16 'AUDIT REPORT'                S01117
1022 O                NU1                18 'LISTING REPORT'              S01117
1023 O                                   71 'DEFAULT RETAIL ACCOUNTS'     S01117
     O                 88                82 'BRANCH '                     S01117
     O                 88      BRCA      85                               S01117
     O                 88                86 '-'                           S01117
     O                 88      BRNM     116                               S01117
     O        E  2             NODTL                                      S01117
1026 O                 U1                16 '------------'                S01117
1027 O                NU1                18 '--------------'              S01117
1028 O                                   71 '-----------------------'     S01117
     ORE0562P1H  203   21 69                                              S01117
1013 O                                   24 'REFERENCE RE0562P1'          S01117
1014 O                         TITL      89                               RE0562
1015 O                                  104 'DATE'                        RE0562
1016 O                         RUNA     113                               RE0562
1017 O                                  122 'PAGE'                        RE0562
1018 O                         PAGE  Z  127                               RE0562
1019 O*****   H  1     21                                                 S01117
     O        H  1     21 69                                              S01117
1021 O                 U1                16 'AUDIT REPORT'                RE0562
1022 O                NU1                18 'LISTING REPORT'              RE0562
1023 O                                   71 'DEFAULT RETAIL ACCOUNTS'     RE0562
     O                 88                82 'BRANCH '                     S01117
     O                 88      BRCA      85                               S01117
     O                 88                86 '-'                           S01117
     O                 88      BRNM     116                               S01117
1024 O*****   H  2     21                                                 S01117
     O        H  2     69 21                                              S01117
1026 O                 U1                16 '------------'                RE0562
1027 O                NU1                18 '--------------'              RE0562
1028 O                                   71 '-----------------------'     RE0562
1029 O*****   D  2     21                                                 S01117
     O        D  2     21 69                                              S01117
1030 O                                    8 'ACCOUNT'                     RE0562
1031 O*****                    CNUM      17                               S01117
1032 O*****                              18 '-'                           S01117
1033 O*****                    XCCY      21                               S01117
1034 O*****                              22 '-'                           S01117
1035 O*****                    ACOD      26                               S01117
1036 O*****                              27 '-'                           S01117
1037 O*****                    ACSQ      29                               S01117
1038 O*****               61             42 'RETAIL NO.'                  S01117
1039 O*****               61   ACNO      53                               S01117
1040 O*****                    ANAM      79                               S01117
1041 O*****                    CRNM     103                               S01117
1042 O*****                    CTWN     114                               S01117
     O                    88   BRCA      13                               S01117
     O                    88             14 '-'                           S01117
     O                         CNUM      20                               S01117
     O                                   21 '-'                           S01117
     O                         XCCY      24                               S01117
     O                                   25 '-'                           S01117
     O                         ACOD      35                                                   CGL029
     O                                   36 '-'                                               CGL029
     O                         ACSQ      38                                                   CGL029
     O                    61             50 'RETAIL NO.'                                      CGL029
     O                    61   ACNO      61                                                   CGL029
     O                         ANAM      87                                                   CGL029
     O                         CRNM     111                                                   CGL029
     O                         CTWN     122                                                   CGL029
     O**********               ACOD      29                                            S01117 CGL029
     O**********                         30 '-'                                        S01117 CGL029
     O**********               ACSQ      32                                            S01117 CGL029
     O**********          61             44 'RETAIL NO.'                               S01117 CGL029
     O**********          61   ACNO      55                                            S01117 CGL029
     O**********               ANAM      81                                            S01117 CGL029
     O**********               CRNM     105                                            S01117 CGL029
     O**********               CTWN     116                                            S01117 CGL029
     O        D  2     21 69                                                                  CAP205
     O                 89                22 'ACCOUNT BALANCE CHECK'                           CAP205
     O                 89                31 'REQUIRED'                                        CAP205
     O                 89      ABCR      34                                                   CAP205
     O/COPY WNCPYSRC,RE0562O001
1043 O*                                                                   RE0562
1044 O*    LINE 10.                                                       RE0562
1045 O*****   D  1     21                                                 S01117
     O        D  2     21 69                                              S01117
1046 O                                   15 'LEDGER BALANCE'              RE0562
1047 O                 70      LDBL      41 '   ,   ,   ,   , 0 CR'       RE0562
1048 O                 71      LDBL      41 '  ,   ,   ,   , 0 . CR'      RE0562
1049 O                 72      LDBL      41 ' ,   ,   ,   , 0 .  CR'      RE0562
1050 O                 73      LDBL      41 '   ,   ,   , 0 .   CR'       RE0562
1051 O                                   55 'DATE OPENED'                 RE0562
1052 O                         OPNDAT    67                               RE0562
1053 O                                   86 'OVERDRAFT LINE'              RE0562
1054 O                         ODLN  1  107                               RE0562
1055 O*                                                                   RE0562
1056 O*    LINE 11.                                                       RE0562
1057 O*****   D  1     21                                                 S01117
     O        D  2     21 69                                              S01117
1058 O                                   16 'CLEARED BALANCE'             RE0562
1059 O                 70      CLBL      41 '   ,   ,   ,   , 0 CR'       RE0562
1060 O                 71      CLBL      41 '  ,   ,   ,   , 0 . CR'      RE0562
1061 O                 72      CLBL      41 ' ,   ,   ,   , 0 .  CR'      RE0562
1062 O                 73      CLBL      41 '   ,   ,   , 0 .   CR'       RE0562
1063 O                                   85 'EXPIRY DATE'                 RE0562
1064 O                         EXPDAT   107                               RE0562
1065 O*                                                                   RE0562
1066 O*    LINE 12.                                                       RE0562
1067 O*****   D  1     21                                                 S01117
     O        D  2     21 69                                              S01117
1068 O                                   10 'STATEMENT'                   RE0562
1069 O                                   61 'A/C TYPE/SUB-TYPE'           RE0562
1070 O                         ATYP      65                               RE0562
1071 O                                   66 '/'                           RE0562
1072 O                         STYP      67                               RE0562
1073 O                                   81 'SECURED'                     RE0562
1074 O                                  107 'NO'                          RE0562
1075 O                    33            107 'YES'                         RE0562
1076 O*                                                                   RE0562
1077 O*    LINE 13.                                                       RE0562
1078 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1079 O                                   12 'FREQUENCY'                   RE0562
1080 O                         STFQ      39                               RE0562
1081 O                                   54 'A/C STATUS'                  RE0562
1082 O                 01                67 'OPEN'                        RE0562
1083 O                 04                67 'CLOSED'                      RE0562
1084 O                                   85 'FACILITY TYPE'               RE0562
1085 O                         FACT  4  107                               RE0562
1086 O*                                                                   RE0562
1087 O*    LINE 14.                                                       RE0562
1088 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1089 O                                   12 'NEXT DATE'                   RE0562
1090 O                         NXTDAT    39                               RE0562
1091 O                                   52 'REFER DR'                    RE0562
1092 O                   N42             67 'NO'                          RE0562
1093 O                    42             67 'YES'                         RE0562
1094 O                                   84 'FACILITY NO.'                RE0562
1095 O                         FCNO  4  107                               RE0562
1096 O*                                                                   RE0562
1097 O*    LINE 15.                                                       RE0562
1098 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1099 O                                   12 'LAST PAGE'                   RE0562
1100 O                         LSTP  1   39                               RE0562
1101 O                                   52 'REFER CR'                    RE0562
1102 O                   N43             67 'NO'                          RE0562
1103 O                    43             67 'YES'                         RE0562
1104 O                                   84 'ENCASH. FAC.'                RE0562
1105 O                         EFAC     107                               RE0562
1106 O*                                                                   RE0562
1107 O*    LINE 16.                                                       RE0562
1108 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1109 O                                   16 'C/FWD BALANCE'               RE0562
1110 O                 70      CFSB      41 '   ,   ,   ,   , 0 CR'       RE0562
1111 O                 71      CFSB      41 '  ,   ,   ,   , 0 . CR'      RE0562
1112 O                 72      CFSB      41 ' ,   ,   ,   , 0 .  CR'      RE0562
1113 O                 73      CFSB      41 '   ,   ,   , 0 .   CR'       RE0562
1114 O                                   52 'BLOCK DR'                    RE0562
1115 O                   N44             67 'NO'                          RE0562
1116 O                    44             67 'YES'                         RE0562
1117 O                                   83 'HELD AMOUNT'                 RE0562
1118 O                    70   HELDA    109 '  ,   ,   ,   , 0 CR'        RE0562
1119 O                    71   HELDA    109 ' ,   ,   ,   , 0 . CR'       RE0562
1120 O                    72   HELDA    109 '   ,   ,   , 0 .  CR'        RE0562
1121 O                    73   HELDA    109 '  ,   ,   , 0 .   CR'        RE0562
1122 O*                                                                   RE0562
1123 O*    LINE 17.                                                       RE0562
1124 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1125 O                                   16 'PRINT ADDRESS'               RE0562
1126 O                 45                39 'YES'                         RE0562
1127 O                N45                39 'NO'                          RE0562
1128 O                                   52 'BLOCK CR'                    RE0562
1129 O                   N46             67 'NO'                          RE0562
1130 O                    46             67 'YES'                         RE0562
1131 O                                   83 'MIN BALANCE'                 RE0562
1132 O                         MINBA 1  107                               RE0562
1133 O*                                                                   RE0562
1134 O*    LINE 18.                                                       RE0562
1135 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1136 O                                   19 'LAST MOVEMENT DATE'          RE0562
1137 O                         LMVDAT    39                               RE0562
1138 O                                   52 'INACTIVE'                    RE0562
1139 O                   N47             67 'NO'                          RE0562
1140 O                    47             67 'YES'                         RE0562
1141 O                                   85 'LAST ACTIVITY'               RE0562
1142 O                         LACDAT   107                               RE0562
1143 O*                                                                   RE0562
1144 O*    LINE 19.                                                       RE0562
1145 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1146 O                                   52 'BANKRUPT'                    RE0562
1147 O                   N48             67 'NO'                          RE0562
1148 O                    48             67 'YES'                         RE0562
1149 O                                   83 'LAST CHANGE'                 RE0562
1150 O                         LCHDAT   107                               RE0562
1151 O*                                                                   RE0562
1152 O**   LINE 20.                                                       RE0562
1153 O*****   D  2     21                                                 S01117
     O        D  2     21 69                                              S01117
1154 O                                   52 'BAD DEBT'                    RE0562
1155 O                   N49             67 'NO'                          RE0562
1156 O                    49             67 'YES'                         RE0562
1157 O                                   83 'CHANGE TYPE'                 RE0562
1158 O                 80               107 'OPEN'                        RE0562
1159 O                 81               107 'AMEND'                       RE0562
1160 O                 82               107 'CLOSE'                       RE0562
1161 O                 83               107 'REOPEN'                      RE0562
1162 O*                                                                   RE0562
1163 O*    LINE 22.                                                       RE0562
1164 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1165 O                                    9 'INTEREST'                    RE0562
1166 O                                   39 'DEBIT'                       RE0562
1167 O                                   67 'CREDIT'                      RE0562
1168 O                                   79 'CHARGES'                     RE0562
1169 O*                                                                   RE0562
1170 O*    LINE 23.                                                       RE0562
1171 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1172 O                                   12 'BASE RATE'                   RE0562
1173 O                         DRIB  4   39                               RE0562
1174 O                         CRIB  4   67                               RE0562
1175 O                                   90 'CHARGES CALC.TYPE'           RE0562
1176 O                         CHCT     107                               RE0562
1177 O*                                                                   RE0562
1178 O*    LINE 24.                                                       RE0562
1179 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1180 O                                   14 'RATE/SPREAD'                 RE0562
1181 O                         DRIS  M   40                               RE0562
1182 O                 51                40 '+'                           RE0562
1183 O                         CRIS  M   68                               RE0562
1184 O                 53                68 '+'                           RE0562
1185 O                                   94 'CHARGES CALC.SUB-TYPE'       RE0562
1186 O                         CHST     107                               RE0562
1187 O*                                                                   RE0562
1188 O**   LINE 25.                                                       RE0562
1189 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1190 O                                   11 'INT.TYPE'                    RE0562
1191 O                         DICT      39                               RE0562
1192 O                         CICT      67                               RE0562
1193 O                                   84 'CAPT.TO A/C'                 RE0562
     O                N13 88   BRCA      91                               S01117
     O                N13 88             92 '-'                           S01117
     O                         CHAC     113                                                   CGL029
1194 O**********               CHAC     107                                            RE0562 CGL029
1195 O*                                                                   RE0562
1196 O**   LINE 26.                                                       RE0562
1197 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1198 O                                   15 'INT.SUB-TYPE'                RE0562
1199 O                         DCST      39                               RE0562
1200 O                         CCST      67                               RE0562
1201 O                                   89 'ACR. SINCE CAPT.'            RE0562
1202 O                 70      RCA      107 ' ,   ,   ,   , 0 '           RE0562
1203 O                 71      RCA      107 '   ,   ,   , 0 . '           RE0562
1204 O                 72      RCA      107 '  ,   ,   , 0 .  '           RE0562
1205 O                 73      RCA      107 ' ,   ,   , 0 .   '           RE0562
1206 O                                  119 'REBATABLE'                   RE0562
1207 O*                                                                   RE0562
1208 O*    LINE 27.                                                       RE0562
1209 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1210 O                                   19 'RATE CHANGE DATE'            RE0562
1211 O                         DRCDAT    39                               RE0562
1212 O                         CRCDAT    67                               RE0562
1213 O                 70      NRCA     107 ' ,   ,   ,   , 0 '           RE0562
1214 O                 71      NRCA     107 '   ,   ,   , 0 . '           RE0562
1215 O                 72      NRCA     107 '  ,   ,   , 0 .  '           RE0562
1216 O                 73      NRCA     107 ' ,   ,   , 0 .   '           RE0562
1217 O                                  123 'NON-REBATABLE'               RE0562
1218 O*                                                                   RE0562
1219 O*    LINE 28.                                                       RE0562
1220 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1221 O                                   14 'CALC. BASIS'                 RE0562
1222 O                         DRIC  2   39                               RE0562
1223 O                         CRIC  2   67                               RE0562
1224 O*                                                                   RE0562
1225 O*    LINE 29.                                                       RE0562
1226 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1227 O                                   12 'FREQUENCY'                   RE0562
1228 O                         DRIF      39                               RE0562
1229 O                         CRIF      67                               RE0562
1230 O*                                                                   RE0562
1231 O*    LINE 30.                                                       RE0562
1232 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1233 O                                   17 'NEXT CAPT.DATE'              RE0562
1234 O                         NDIDAT    39                               RE0562
1235 O                         NCIDAT    67                               RE0562
1236 O*                                                                   RE0562
1237 O*    LINE 31.                                                       RE0562
1238 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1239 O                                   14 'CAPT.TO A/C'                 RE0562
     O                N11 88   BRCA      23                               S01117
     O                N11 88             24 '-'                           S01117
1240 O**********               DACP      39                                            RE0562 CGL029
     O                         DACP      45                                                   CGL029
     O                N12 88   BRCA      51                               S01117
     O                N12 88             52 '-'                           S01117
     O                         CACP      73                                                   CGL029
1241 O**********               CACP      67                                            RE0562 CGL029
1242 O*                                                                   RE0562
1243 O*    LINE 32.                                                       RE0562
1244 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1245 O                                   17 'LAST CAPT.DATE'              RE0562
1246 O                         LPDDAT    39                               RE0562
1247 O                         LPCDAT    67                               RE0562
1248 O*                                                                   RE0562
1249 O*    LINE 33.                                                       RE0562
1250 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1251 O                                   20 'POSTED TO INC/EXP'           RE0562
1252 O                 70      DIIE      40 ' ,   ,   ,   , 0 -'          RE0562
1253 O                 71      DIIE      40 '   ,   ,   , 0 . -'          RE0562
1254 O                 72      DIIE      40 '  ,   ,   , 0 .  -'          RE0562
1255 O                 73      DIIE      40 ' ,   ,   , 0 .   -'          RE0562
1256 O                 70      CIIE      67 ' ,   ,   ,   , 0 '           RE0562
1257 O                 71      CIIE      67 '   ,   ,   , 0 . '           RE0562
1258 O                 72      CIIE      67 '  ,   ,   , 0 .  '           RE0562
1259 O                 73      CIIE      67 ' ,   ,   , 0 .   '           RE0562
1260 O                 63                68 '-'                           RE0562
1261 O*                                                                   RE0562
1262 O*    LINE 34.                                                       RE0562
1263 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1264 O                                   19 'ACR. SINCE CAPT.'            RE0562
1265 O                 70      DAIC      39 ' ,   ,   ,   , 0 '           RE0562
1266 O                 71      DAIC      39 '   ,   ,   , 0 . '           RE0562
1267 O                 72      DAIC      39 '  ,   ,   , 0 .  '           RE0562
1268 O                 73      DAIC      39 ' ,   ,   , 0 .   '           RE0562
1269 O                 70      CAIC      67 ' ,   ,   ,   , 0 '           RE0562
1270 O                 71      CAIC      67 '   ,   ,   , 0 . '           RE0562
1271 O                 72      CAIC      67 '  ,   ,   , 0 .  '           RE0562
1272 O                 73      CAIC      67 ' ,   ,   , 0 .   '           RE0562
1273 O*                                                                   RE0562
1274 O*    LINE 35.                                                       RE0562
1275 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1276 O                                   20 'MAN. ADJ. TO A.I.'           RE0562
1277 O                 70      MADI      40 ' ,   ,   ,   , 0 -'          RE0562
1278 O                 71      MADI      40 '   ,   ,   , 0 . -'          RE0562
1279 O                 72      MADI      40 '  ,   ,   , 0 .  -'          RE0562
1280 O                 73      MADI      40 ' ,   ,   , 0 .   -'          RE0562
1281 O                 55                40 '+'                           RE0562
1282 O                 70      MACI      68 ' ,   ,   ,   , 0 -'          RE0562
1283 O                 71      MACI      68 '   ,   ,   , 0 . -'          RE0562
1284 O                 72      MACI      68 '  ,   ,   , 0 .  -'          RE0562
1285 O                 73      MACI      68 ' ,   ,   , 0 .   -'          RE0562
1286 O                 57                68 '+'                           RE0562
1287 O*                                                                   RE0562
1288 O*    LINE 36.                                                       RE0562
1289 O*****   D  1     21                                                 S01117
     O        D  1     21 69                                              S01117
1290 O                                   20 'GEN. ADJ. TO A.I.'           RE0562
1291 O                 70      GADI      40 ' ,   ,   ,   , 0 -'          RE0562
1292 O                 71      GADI      40 '   ,   ,   , 0 . -'          RE0562
1293 O                 72      GADI      40 '  ,   ,   , 0 .  -'          RE0562
1294 O                 73      GADI      40 ' ,   ,   , 0 .   -'          RE0562
1295 O                 70      GACI      67 ' ,   ,   ,   , 0 '           RE0562
1296 O                 71      GACI      67 '   ,   ,   , 0 . '           RE0562
1297 O                 72      GACI      67 '  ,   ,   , 0 .  '           RE0562
1298 O                 73      GACI      67 ' ,   ,   , 0 .   '           RE0562
1299 O                 66                68 '-'                           RE0562
     O*    HEADINGS FOR NO DETAILS AND DATA BASE ERROR
     O********T**203   LRNU1 77                                           S01117
     O*******OR**      LR U7                                              S01117
1013 O***********                        22 'REFERENCE RE0562'            S01117
1014 O***********              TITL      89                               S01117
1015 O***********                       104 'DATE'                        S01117
1016 O***********              RUNA     113                               S01117
1017 O***********                       122 'PAGE'                        S01117
1018 O***********              PAGE  Z  127                               S01117
     O********T**1     LRNU1 77                                           S01117
     O*******OR**      LR U7                                              S01117
1021 O***********      U1                16 'AUDIT REPORT'                S01117
1022 O***********     NU1                18 'LISTING REPORT'              S01117
1023 O***********                        71 'DEFAULT RETAIL ACCOUNTS'     S01117
     O********T**2     LRNU1 77                                           S01117
     O*******OR**      LR U7                                              S01117
1026 O***********      U1                16 '------------'                S01117
1027 O***********     NU1                18 '--------------'              S01117
1028 O***********                        71 '-----------------------'     S01117
1300 O*                                                                   RE0562
1301 O*  NO DETAILS TO REPORT MESSAGE                                     RE0562
1302 O*                                                                   RE0562
1303 O*****   T   40   LRNU1 77                                           S01117
1303 O        T   40   L1NU1 77                                           S01117
     O       AND          69NU7                                           S01117
1304 O                                   72 '*** NO DETAILS TO REPORT'    RE0562
1305 O                                   76 ' ***'                        RE0562
1349 O*                                                                   S01117
1350 O*  NO INPUT TODAY MESSAGE                                           S01117
1351 O*                                                                   S01117
1352 O        T   40   L1 U1 85                                           S01117
     O       AND            NU7                                           S01117
1352 O       OR        L1 U1 77                                           S01117
     O       AND          69NU7                                           S01117
1353 O                                   73 '*** NO INPUT TODAY ***'      S01117
1306 O*                                                                   RE0562
1307 O*  DATABASE ERROR OUTPUT                                            RE0562
1308 O*                                                                   RE0562
1309 O*****   T 3      LR U7                                              S01117
1309 O        T 3      L1 U7 69                                           S01117
1310 O                                   62 'DATABASE IN ERROR.'          S01117
1310 O*****                              38 'DATABASE ERROR NO.-'         S01117
1311 O*****                    LDBNO     40                               S01117
1312 O*****                              48 'FILE-'                       S01117
1313 O*****                    LFILE     53                               S01117
1314 O*****                              60 'KEY-'                        S01117
1315 O*****                    LKEY      89                               S01117
     O        T 2      L1 69                                              S01117
0529 O*****                              69 '*** END OF REPORT ***'       S01117
     O                       88          66 '*** END OF REPORT FOR'       S01117
     O                       88          74 ' BRANCH '                    S01117
     O                       88BRCA      77                               S01117
     O                       88          81 '***'                         S01117
     O                N88                76 '*** END OF REPORT ***'       S01117
1316 O*                                                                   RE0562
1317 O*  STANDARD FILE CONTROLS                                           RE0562
1318 O*                                                                   RE0562
1319 O*  STANDARD HEADINGS                                                RE0562
1320 O*                                                                   RE0562
1321 O*****   T  203   LR                                                 S01117
1322 O*****                              22 'REFERENCE RE0562'            S01117
     ORE0562AUT  203   LR                                                 S01117
1322 O                                   24 'REFERENCE RE0562AU'          S01117
1323 O                         TITL      89                               RE0562
1324 O                                  104 'DATE'                        RE0562
1325 O                         RUNA     113                               RE0562
1326 O                                  122 'PAGE'                        RE0562
1327 O*****                    PAGE  Z  127                               S01117
     O                                  127 '1'                           S01117
1328 O        T  1     LR                                                 RE0562
1329 O                       U1          16 'AUDIT REPORT'                RE0562
1330 O                      NU1          18 'LISTING REPORT'              RE0562
1331 O*                                                                   RE0562
1332 O*  NAME OF FILE OR RECORD                                           RE0562
1333 O*                                                                   RE0562
1334 O                                   60 'DEFAULT RETAIL ACCOUNTS'     RE0562
1335 O                                   67 '- FILE'                      RE0562
1336 O                                   82 'CONTROL REPORT'              RE0562
1337 O*                                                                   RE0562
1338 O*  STANDARD OUTPUT                                                  RE0562
1339 O*                                                                   RE0562
1340 O        T  1     LR                                                 RE0562
1341 O                       U1          16 '------------'                RE0562
1342 O                      NU1          18 '--------------'              RE0562
1343 O*                                                                   RE0562
1344 O*  UNDERLINE NAME OF FILE OR RECORD                                 RE0562
1345 O*                                                                   RE0562
1346 O                                   60 '-----------------------'     RE0562
1347 O                                   67 '--------'                    RE0562
1348 O***********************************82 '--------------'              E81154
     O                                   82 '---------------'             E81154
1349 O*                                                                   RE0562
1350 O***NO*INPUT TODAY MESSAGE                                           S01117
1351 O***********                                                         S01117
1352 O********T** 40   LR U1 85                                           S01117
1353 O***********                        73 '*** NO INPUT TODAY ***'      S01117
1354 O*                                                                   RE0562
1355 O*  HEADINGS AND RUN CONTROLS COMMON TO AUDIT AND LIST               RE0562
1356 O*                                                                   RE0562
1357 O        T  220   LRN87                                              RE0562
1358 O                                   21 'RUN CONTROLS - '             RE0562
1359 O                                   77 '----------- PROGRAM ----'    RE0562
1360 O                                   84 '-------'                     RE0562
1361 O                                  116 '--------- FILE TRAILER '     RE0562
1362 O                                  124 '--------'                    RE0562
1363 O        T  1     LRN87                                              RE0562
1364 O                                   59 'NUMBER'                      RE0562
1365 O                                   84 'VALUE'                       RE0562
1366 O                                   99 'NUMBER'                      RE0562
1367 O                                  124 'VALUE'                       RE0562
1368 O        T  2     LRN87                                              RE0562
1369 O*************************          13 'S/'                          E81154
1370 O*************************LFILE     18                               E81154
     O                                   18 'S/REDEF'                     E81154
1371 O        T  2     LRN87                                              RE0562
1372 O                                   32 'NUMBER OF ACTIVE RECORDS'    RE0562
1373 O                                   40 'ON FILE'                     RE0562
1374 O                         RN,1  3   59                               RE0562
1375 O                         RW,1  Z   80                               RE0562
1376 O                         RD,1      84 '0   -'                       RE0562
1377 O                         NR,1  3   99                               RE0562
1378 O                         WN,1  Z  120                               RE0562
1379 O                         DC,1     124 '0   -'                       RE0562
1380 O                       79         130 '***'                         RE0562
1381 O*                                                                   RE0562
1382 O*  AUDIT REPORT ONLY RUN CONTROLS                                   RE0562
1383 O*                                                                   RE0562
1384 O        T  3     LR U1N85                                           RE0562
1385 O                                   29 'NUMBER OF RECORDS UPD'       RE0562
1386 O                                   39 'ATED TODAY'                  RE0562
1387 O                         RN,3  3   59                               RE0562
1388 O        T  2     LR U1N85                                           RE0562
1389 O                                   27 'LIVE RECORDS BEFORE'         RE0562
1390 O                                   39 'INPUT CYCLE'                 RE0562
1391 O                         NR,2  3   99                               RE0562
1392 O                         WN,2  Z  120                               RE0562
1393 O                         DC,2     124 '0   -'                       RE0562
1394 O        T  2     LR U1N85                                           RE0562
1395 O                                   26 'RECORDS INSERTED'            RE0562
1396 O                         NR,3  3   99                               RE0562
1397 O                         WN,3  Z  120                               RE0562
1398 O                         DC,3     124 '0   -'                       RE0562
1399 O        T  2     LR U1N85                                           RE0562
1400 O                                   25 'RECORDS AMENDED'             RE0562
1401 O                         NR,4  3   99                               RE0562
1402 O                         WN,4  Z  120                               RE0562
1403 O                         DC,4     124 '0   -'                       RE0562
1404 O        T  2     LR U1N85                                           RE0562
1405 O                                   25 'RECORDS DELETED'             RE0562
1406 O                         NR,5  3   99                               RE0562
1407 O                         WN,5  Z  120                               RE0562
1408 O                         DC,5     124 '0   -'                       RE0562
1409 O        T        LR U1N85                                           RE0562
1410 O                                   32 'LIVE RECORDS AFTER INPUT'    RE0562
1411 O                                   38 'CYCLE'                       RE0562
1412 O                         RN,2  3   59                               RE0562
1413 O                         RW,2  Z   80                               RE0562
1414 O                         RD,2      84 '0   -'                       RE0562
1415 O                         RN,4  3   99                               RE0562
1416 O                         RW,4  Z  120                               RE0562
1417 O                         RD,4     124 '0   -'                       RE0562
1418 O                       78         129 '***'                         RE0562
1419 O*                                                                   RE0562
1420 O*  LISTING REPORT ONLY RUN CONTROLS                                 RE0562
1421 O*                                                                   RE0562
1422 O        T        LRNU1                                              RE0562
1423 O                                   29 'NUMBER OF LIVE RECORD'       RE0562
1424 O                                   38 'S ON FILE'                   RE0562
1425 O                         RN,2  3   59                               RE0562
     O*                                                                   093765
     O*  RUN CONTROL OF CODES WITH MISSING DEFAULT RETAIL ACCOUNTS;       093765
     O*  COMMON TO AUDIT AND LIST                                         093765
     O*                                                                   093765
     O        T 31     LRN87                                              093765
     O                                   26 'LIVE RECORDS WITH '          093765
     O                                   33 'MISSING'                     093765
     O        T        LRN87                                              093765
     O                                   32 'DEFAULT RETAIL ACCOUNT'      093765
     O                         @MSS  3   59                               093765
1426 O*                                                                   RE0562
1427 O*  OUTPUT DETAILS COMMON TO AUDIT AND LIST                          RE0562
1428 O*                                                                   RE0562
1429 O********T***45   LR U8                                              093765
     O        T   49   LR U8                                              093765
     O       AND            NU7                                           S01117
1430 O                                  100 '*** DIFFERENCE ***'          RE0562
1309 O        T 3      LR U7                                              S01117
     O                                   66 'DATABASE ERROR '             S01117
     O                         DBASE     69                               S01117
     O                                   83 'IN PROGRAM '                 S01117
     O                         DBPGM     93                               S01117
     O        T 2      LR U7                                              S01117
     O                                   56 'FILE '                       S01117
     O                         DBFILE    64                               S01117
     O                                   70 ', KEY '                      S01117
     O                         DBKEY     99                               S01117
1349 O*                                                                   S01117
1350 O*  NO INPUT TODAY MESSAGE                                           S01117
1351 O*                                                                   S01117
1352 O        T   48   LR U1 85                                           S01117
     O       AND            NU7                                           S01117
1352 O       OR        LR U1N65                                           S01117
     O       AND            NU7                                           S01117
1353 O                                   73 '*** NO INPUT TODAY ***'      S01117
1303 O        T   48   LRNU7N65                                           S01117
1305 O       AND         NU1                                              S01117
1304 O                                   72 '*** NO DETAILS TO REPORT'    S01117
1305 O                                   76 ' ***'                        S01117
1431 O********T** 50   LR                                                 S01117
1432 O***********                        73 '*** END OF REPORT ***'       S01117
     O*                                                                   093765
     O*  OUTPUT MISSING DEFAULT RETAIL ACCOUNTS.                          093765
     O*                                                                   093765
     ORE0562P2E  203   15                                                 093765
     O                                   22 'REFERENCE RE0562'            093765
     O                         TITL      89                               093765
     O                                  104 'DATE'                        093765
     O                         RUNA     112                               093765
     O                                  122 'PAGE'                        093765
     O                         PAGE1 Z  126                               093765
     O        E        15                                                 093765
     O                                   74 'MISSING DEFAULT RETAIL '     093765
     O                                   82 'ACCOUNTS'                    093765
     O        E  3     15                                                 093765
     O                                   74 '-----------------------'     093765
     O                                   82 '--------'                    093765
     O        E  2     16                                                 093765
     O                                   55 'ACCOUNT CODE'                093765
     O        E  1     17                                                 093765
     O                         ACOD      55                               093765
     O                       19ACNO      79                               093765
     O                      N19CNUM      75                               093765
     O                      N19          76 '-'                           093765
     O                      N19CCY       79                               093765
     O                      N19          80 '-'                           093765
     O                      N19ACSQ      82                               093765
     O/COPY WNCPYSRC,RE0562O002
     O        E 32     18N10                                              093765
     O                                   67 '*** NO DETAILS '             093765
     O                                   80 'TO REPORT ***'               093765
     O        E 2      18                                                 093765
     O                                   77 '*** END OF REPORT ***'       093765
1433 O**REDEF   E        86                                                            RE0562 CRE030
1434 O********                           34 ' '                                        RE0562 CRE030
1435 O********                 RN,1      37P                                           RE0562 CRE030
1436 O********                 RN,2      40P                                           RE0562 CRE030
1437 O********                 ZERO05    43P                                           RE0562 CRE030
1438 O********                 ZERO05    46P                                           RE0562 CRE030
1439 O********                 ZERO05    49P                                           RE0562 CRE030
1440 O********                 RW,1      57P                                           RE0562 CRE030
1441 O********                 RW,2      65P                                           RE0562 CRE030
1442 O********                 ZERO15    73P                                           RE0562 CRE030
1443 O********                 ZERO15    81P                                           RE0562 CRE030
1444 O********                 ZERO15    89P                                           RE0562 CRE030
1445 O********                 RD,1      91P                                           RE0562 CRE030
1446 O********                 RD,2      93P                                           RE0562 CRE030
1447 O********                 ZERO03    95P                                           RE0562 CRE030
1448 O********                 ZERO03    97P                                           RE0562 CRE030
1449 O********                 ZERO03    99P                                           RE0562 CRE030
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
