     H        1                                                           S01117
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Generate entries - standing orders')          *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module                                        *
     F*                                                               *
     F*  RE0730 - GENERATE ENTRIES-STANDING ORDERS                    *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. MD056198           Date 08Jul20               *
      *  Prev Amend No. MD035074           Date 13May20               *
      *                 255449             Date 21Apr20               *
      *                 MD050452           Date 11Feb20               *
      *                 MD054019           Date 11Feb20               *
      *                 MD041832           Date 08Feb17               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL154             Date 13Oct14               *
      *                 MD042714           Date 21Nov16               *
      *                 AR858062           Date 07Dec11               *
      *                 AR1095876          Date 30Sep13               *
      *                 AR1070626          Date 19Dec12               *
      *                 AR1091700          Date 27Feb13               *
      *                 AR1049898          Date 26Oct12               *
      *                 AR799642           Date 26Jul11               *
      *                 AR782815           Date 03Jun11               *
      *                 CAP207             Date 10Feb11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23967           Date 13May09               *
      *                 BUG27982           Date 06Aug10               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CAP205             Date 08Mar10               *
      *                 CAP204             Date 09Feb10               *
      *                 BUG27129           Date 04Mar10               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 BUG12751           Date 26Nov06               *
      *                 BUG12587           Date 09Nov06               *
      *                 BUG9033            Date 16Jun06               *
      *                 239668             Date 27Apr06               *
      *                 CSD031             Date 10Apr06               *
      *                 BUG9063            Date 04Nov05               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9690            Date 21Dec05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6222            Date 23May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 BUG5350            Date 06Jan05               *
      *                 BUG4051 (Reopen)   Date 23Sep04               *
      *                 BUG4051 (Reopen)   Date 17Sep04               *
      *                 BUG4051            Date 24Aug04               *
      *                 BUG3011            Date 28Jun04               *
      *                 CLE025             Date 20Oct03               *
      *                 CRE013             Date 25Jul03               *
      *                 CRE020             Date 20Jan04               *
      *                 CGL029             Date 01Sep03               *
      *                 CGL020             Date 08Nov02               *
      *                 209995             Date 30Sep02               *
      *                 CRE009             Date 27Aug02               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 206632             Date 21Aug02               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4 --------------- Base -------------------------*
      *                 151104             Date 15Jun01               *
      *                 164405             Date 24May01               *
      *                 168936             Date 20Nov00               *
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 02Mar99               *
      *                 CTI002             Date 09Sep98               *
     F*                 128963             DATE 26FEB98               *
      *                 080091             DATE 20JAN98               *
      *                 109434             DATE 25SEP97               *
      *                 104041             DATE 17APR97               *
     F*                 CCB002             DATE 03SEP96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 092500             DATE 05JUL96               *
     F*                 S01408             DATE 16MAY96               *
     F*                 S01408             DATE 18OCT95               *
     F*                 086125             DATE 16MAR95               *
     F*                 S01522             DATE 25JAN95               *
     F*                 S01408             DATE 13MAR95               *
     F*                 S01466             DATE 22MAR94               *
     F*                 047906             DATE 28SEP93               *
     F*                 S01413             DATE 13APR93               *
     F*                 046303             DATE 16JAN94               *
     F*                 034467             DATE 10NOV93               *
     F*                 049680             DATE 18JAN93               *
     F*                 S10736             DATE 03SEP92               *
     F*                 E38323             DATE 31JUL92               *
     F*                 S01255             DATE 16FEB90               *
     F*                 S01182             DATE 12DEC89               *
     F*                 S01195             DATE 15JAN90               *
     F*                 S01117             DATE 09JAN90               *
     F*                 E17948             DATE 19JUN89               *
     F*                 E13024             DATE 10/02/89              *
     F*                 E15459             DATE 10/02/89              *
     F*                 E14458             DATE 25/01/89              *
     F*                 S01154             DATE 16/19/88              *
     F*                 S05452             DATE 20/08/87              *
     F*                                                               *
     F*---------------------------------------------------------------*
      *                                                               *
      *  MD056198 - STOR was processed despite insufficient balance   *
      *  MD035074 - Standing Order failed due to insufficient funds,  *
      *             but account balance show sufficient funds	 *
      *           - Validates available balance when EVTDAT is greater*
      *             than or equal to NXTP.                            *
      *  255449 - FOOB occurred on COB Component REC33, caused by a   *
      *           large value of 'Number of Standing Orders'.         *
      *           Increase the size of NDELS to prevent FOOB on COB.  *
      *         - Applied for MD055622.                               *
      *  MD050452 - SO failed due to insufficient balance. Compare    *
      *             Available Balance to zero to check has balance.   *
      *           - Applied for MD055126                              *
      *  MD054019 - RE0733P1 is reporting a Standing Order as failed  *
      *             even if it is not yet payment date.               *
      *           - Applied for MD055126                              *
      *  MD041832 - Post to suspense account when the dr account is   *
      *             flagged as Block all debits.                      *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL154 - FATCA Reporting (Recompile)                         *
      *  MD042714 - If New Date of Last Payment is less than or equal *
      *             to Data of Last Movement, do not generate the     *
      *             postings as they have already been generated.     *
      *  AR858062 - Insufficient Funds reported due to wrong overdraft*
      *             line consideration. Amended ODLN to contain the   *
      *             appropriate number of decimals. (Child: AR858063) *
      *  AR1095876- ABC - Forward Days 1 should = DNWD-1, not just    *
      *             RUND (Child: AR1095877) (Recompile)               *
      *  AR1070626 - CAP207-related, do not check available balance   *
      *              for GL account. Also, for Retail account check   *
      *              F1IABC flag before checking for available        *
      *              balance. (Child: AR1070627)                      *
      *            - Complete fix AR1070626 as part of BF SP upgrade. *
      *  AR1091700- GLC0600 03002 Component on MSGW                   *
      *  AR1049898 - Insufficient fund only to be check if account    *
      *             is flag to do the check. Else run as before       *
      *             (Child:AR1049900)                                 *
      *  AR799642 - System shows warning msg of insufficient funds.   *
      *             Wrong update of Cleared Balance in MEMOS, supposed*
      *             to be only the total of transactions <= RUND      *
      *             applied 254188. (Child: AR799643)                 *
      *  AR782815 - Projected Insufficient Report did not generate    *
      *             for Standing Orders                               *
      *  CAP207 - Account Balance Check extended to other APIs        *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23967 - Add Local Industry Code Field.                    *
      *  BUG27982 - Component REC7A is looping                        *
      *  CAP205 - Teller Related APIs - Account Balance Check         *
      *  CAP204   - Teller Related APIs-Account Transfer (Recompile)  *
      *  BUG27129 - Applied GEMS fix 261523                           *
      *           - SCC0411 looping in I/C initiation. For PAYF = 'A' *
      *             do not use REPMED to generate shadow posting.     *
      *  BUG12751 - If payment date is zero for some frequency codes  *
      *           then infinite loop happens writing to disk. Try and *
      *           stop this with a database error                     *
      *  BUG12587 - DBERROR details printed on the report and 'NO     *
      *             DETAILS TO REPORT' at the same time.              *
      *             Corrected to print only DBERROR details when      *
      *             there are errors; 'NO DETAILS TO REPORT' when     *
      *             are errors; 'NO DETAILS TO REPORT' when there are *
      *             no records processed and no error is encountered. *
      *  BUG9033 - Incorrect customer for multibranch entries. Same   *
      *            as SC238875.                                       *
      *  239668 - Apply fix 238875.                                   *
      *  238875 - Customer Blank on DR A/C GESOPD due to short array. *
      *           Same fix as BUG9033                                 *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  BUG9063 - SO amount not considered in DR projected balance.  *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9690 - Postings are done on blocked accounts              *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6222 - Remove unnecessary iteration of loop.              *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  BUG5350 - MSGW at REC7A                                      *
      *  BUG4051(REOPEN) - Report all standing orders generated today.*
      *  BUG4051(REOPEN) - Report all standing orders generated today.*
      *  BUG4051 - Report all standing orders generated today.        *
      *  BUG3011 - REC7A failed due to database error 7 in SDACODPD.  *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CRE013 - Report of Failed Standing Orders.                   *
      *  CRE020 - Midas Plus Online Printing of Advices (GE7)         *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  CGL020 - Compliance Watch - Additional A/C Postings          *
      *           Information                                         *
      *  209995 - Apply the following fixes:                          *
      *                                                               *
      *   184635  Deleted Standing Orders are still processed.        *
      *           If RECD is equal to '*' do not process NOSEVT.      *
      *           Also, if both debit and credit are nostro accounts, *
      *           generate nostro events for both.                    *
      *   179918  Further enhancement to 179918, the event date for   *
      *           NOSEXSO should not fall on a holiday.  Also, error  *
      *           on the generation of posting records when the       *
      *           frequency is 'Daily', due on a weekend and matures  *
      *           on a Monday.  Patterned after fix 179058.           *
      *   179918  Further enhancement to 173250 and 144042: SO pymnts *
      *           schedule should be checked against the no. of days  *
      *           fwd to project in GLSTAT to determine if an event   *
      *           should be generated for it or not. Events for pymnt *
      *           scheduled on a non-working day should also be       *
      *           generated.                                          *
      *   173250  Only check if NXTP is a non-working day if it falls *
      *           within the next five working days                   *
      *   144042  Change as per client specification, credit side is  *
      *           flagged as an outgoing amount .                     *
      *   144042  REOPEN DETAILS: The trailer record for NOSEV wich   *
      *           is based partly on NOSEXSO has not been update when *
      *           records are written to NOSEXSO, this is causing     *
      *           a FOB in GL0580 (Events by nostro) .                *
      *   144042  Generate Nostro events if Nostro accounts are used. *
      *                                                               *
      *  CRE009 - Projected Account Movements for Retail Accounts     *
      *  206632   If Retail numbers not used then need to pass        *
      *           standard account key to AOMEMSU0.                   *
      *  151104 - Increase size of branch code & related array so that*
      *           it can hold up to 900 elements.                     *
      *  164405 - Accessed the *PSSR subroutine when an error on      *
      *           program AOMEMSU0 was encountered.  Also, set on     *
      *           indicators U7, U8 and LR to prevent updating of     *
      *           files.                                              *
      *  168936 - Wrong profit centre posted when PCA(CAC001) is ON.  *
      *  CGL007 - Account Postings Enquiry                            *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*  128963 - No associated customer number on S/o generated      *
     F*         - entries, brought in line with similar fix for       *
     F*         - CE entries for HYPO_LDN 065335.                     *
     F*  080091 - Standing order postings generated without retail    *
     F*           account number. Fix is to set up account number     *
     F*           correctly.                                          *
     F*  109434 - Setup posting narrative on RSACMTPD                 *
     F*  104041 - System ignored amendment on Second Payment Date and *
     F*           Amount.  If Last Payment Date is equal to the Next  *
     F*           Payment Date and Last Payment Amount is blank/zero, *
     F*           use Second Payment Amount instead of First Payment  *
     F*           Amount in generating extract file PF/GESOPD.        *
     F*  CCB002 - COB Performance Enhancements                        *
     F*           Access now via access object                        *
     F*           Change MEMOS processing to use access objects.      *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           The profit centre of postings with certain account  *
     F*           types should be assigned as follows:                *
     F*           Retail or Nostro - profit centre of the account     *
     F*           Interbranch Posting - primary funding profit centre *
     F*           GL account - transaction profit centre.             *
     F*  092500 - Narrative which has been input on standing order    *
     F*           details doesn't appear on posting due to UDC. Fix   *
     F*           is to do UDC narr. processing only if PNAR blank.   *
     F*  S01408 - Core hook RE0730CCP3 added.                         *
     F*  S01408 - Addition of core hook RE0730IIP1                    *
     F*           Addition of core hook RE0730CCP1                    *
     F*           Addition of core hook RE0730CCP2                    *
     F*           Addition of core hook RE0730OOP1                    *
     F*         - Correction of RE0330 hook references to RE0730.     *
     F*  086125 - Add new parameter to AOPNARR0                       *
     F*  S01522 - Call to AOPNARR0 if switchable feature installed    *
     F*           and UDC present                                     *
     F*  S01408 - Addition of core hook RE0730FFPG                    *
     F*           Addition of core hook RE0730CCPG                    *
     F*  S01466 - BLI Retail Enhancements                             *
     F*  047906 - Indicator for DR account used on CR side            *
     F*           + pgm did not compile (cfr MEMO)                    *
     F*  S01413 - Retail 3 Incorporation                              *
     F*  046303 - /COPY source subr. ZFWDT amended to prevent array   *
     F*           error if no holiday record found - fixed by S01434. *
     F*           Program recompiled.                                 *
     F*  034467 - Change file control checks on report fields to      *
     F*           correct wrongly reported difference.                *
     F*  049680 - Program no longer compiles at OS/400 release level  *
     F*           V2R2M0, because there are two I-spec lines for      *
     F*           one file, both without record-identifying           *
     F*           codes.                                              *
     F*  S10736 - MANAGEMENT ACCOUNTING                               *
     F*  E38323 - Recompiled due to a change in copy source ZFWDT     *
     F*           subr.                                               *
     F*  S01255 - MIS 1 BD ENHANCEMENTS                               *
     F*  S01182 - WRITES NEW ACCOUNT POSTING FEILDS TO THE            *
     F*           GENERATED ENTRIES FILE LF/GESO FOR MIS.             *
     F*  S01195 - HOLIDAY AMENDMENT                                   *
     F*  S01117 - MULTIBRANCHING                                      *
     F*  E17948 - AMENDED TO GIVE CORRECT ERROR REPORT IF TRANS.      *
     F*           TYPE 91000 NOT FOUND (ERROR CODING INSERTED IN      *
     F*           PROGRAM AND PRINT FILES AMENDED)                    *
     F*  E13024 - ENTRIES GENERATED TO COMP. SUSPENSE HAVE A/C        *
     F*           TYPE 'G' INSTEAD OF 'C'.                            *
     F*  E15459 - FAILURE OF STANDING ORDER TRANSACTIONS TO UPDATE    *
     F*           THE LAST ACTIVITY DATE OF A RETAIL ACCOUNT          *
     F*           CAUSES A/C TO BE TRANSFERRED TO INACTIVE STATUS     *
     F*           INCORRECTLY.                                        *
     F*  E14458 - PAYMENT ON ACCRUAL DATE CAUSES LOOP IN NEXT         *
     F*           PAYMENT DATE CALCULATION.                           *
     F*  S01154 - CHANGES FOR REAL TIME STATEMENTS.                   *
     F*  S05452 - INCLUSION OF AUTO RECONCILIATIONS.                  *
     F*                                                               *
     F*****************************************************************
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0012 F*TAND***UP* F     256  5AI     2 DISK                               S01117
0012 F***STANDL1*UP**F     258  5AI     2 DISK                     S01117 S01466
     F***STANDL1*UP  F     263  5AI     2 DISK                                         S01466 CGL029
     FSTANDL1 UP  F     284  5AI     2 DISK                                                   CGL029
0013 F*CCNT   IF  F     400 15AI     2 DISK                               S01117
     F***ACCNT** IF  F     400 18AI     2 DISK                                         S01117 CGL029
     FACCNT   IF  F     410 24AI     2 DISK                                                   CGL029
0014 FTABLE   IF  F      96 12AI     2 DISK                               RE0730
0015 F***CLINT** IF  F     256  7AI     2 DISK                                       RE0730 BUG23967
     FCLINT   IF  F     264  7AI     2 DISK                                                 BUG23967
     F/COPY WNCPYSRC,RE0730F001
0016 F******MEMO    UF  F      40            DISK                 U1RE0730CCB002
     F/COPY WNCPYSRC,RE0730F002
0016 FRSACMTPDO   E                    DISK                               S01154
0017 FGESOHH  O   F     160            DISK                               RE0730
0017 F**SOPD  O   F     160            DISK                               S05452
0017 F***GESOPD  O   F     200            DISK                      SO5452S01182
0017 F***GESOPD  O   F     268            DISK                      S01182S01413
     F***GESOPD**O   F     279            DISK                     S01413 CGL007
     F*GESOPD*O***F     331            DISK                                            CGL007 CGL020
     F***GESOPD* O   F     589            DISK                                         CGL020 CGL029
     FGESOPD  O   F     620            DISK                                                   CGL029
0017 FGESOZZ  O   F     160            DISK                               RE0730
0018 F***SOEXSO**O***F     256            DISK                 U1  RE0730 S01466
     F***SOEXSO* O   F     261            DISK                           U1            S01466 CGL029
     FSOEXSO  O   F     281            DISK                           U1                      CGL029
0018 FSOEXZZ  O   F     256            DISK                           U1  RE0730
     FRENESOPDO   E                    DISK                               209995
     FDLNEEDPDO   E                    DISK                               209995
0019 F*E0730P2O** F     132     OF     PRINTER                      S01124S01117
     FRE0730AUO   F     132     OF     PRINTER      KINFDS SPOOLU         S01117
0020 F*E0730P1O** F     132     OV     PRINTER                      S01124S01117
     FRE0730P1O   F     132     OV     PRINTER      KINFDS SPOOL      UC  S01117
     FRE0730P2O   F     132     OG     PRINTER      KINFDS SPOOL2     UC                     BUG4051
     FSDBRCHPDIF  E                    DISK                               LN0153
     FRESTORPDO   E                    DISK                           UC                      CRE013
     FGLACNTL3IF  E           K        DISK                                                   CAP207
     F*                                                                   S01408
     F/COPY WNCPYSRC,RE0730FFPG                                           S01408
     F*                                                                   S01408
0021 F* 01            STAND - HEADER                                      RE0730
0022 F* 02            STAND - DETAIL                                      RE0730
0023 F* 03            STAND - TRAILER                                     RE0730
0024 F* 04            STAND - CATCHALL                                    RE0730
0025 F* 05            ACCNT - DETAIL                                      RE0730
0026 F* 06            ACCNT - CATCHALL                                    RE0730
0027 F* 07            TABLE - INSTALLATION CONTROL DATA RECORD 1          RE0730
0028 F* 08            TABLE - INSTALLATION CONTROL DATA RECORD 2          RE0730
0029 F**09*******     TABLE - HOLIDAYS RECORD (USED IN QZFREQ)      E17948S01195
0030 F**10*******     TABLE - BRANCH CODES RECORD                         S01117
0030 F* 10            TABLE - BRANCH CODES ARRAY LOOKUP                   S01117
0031 F* 11            TABLE - CATCHALL                                    RE0730
0032 F* 12            CLINT - CUSTOMER DEATIL RECORD                      RE0730
0033 F* 13            CLINT - CATCHALL                                    RE0730
0034 F**14************MEMO - SHADOW BALANCE RECORD******************RE0730CCB002
0035 F**15************MEMO*-*CATCHALL*************************************049680
0035 F* 18            TABLE - ACCOUNT CODES RECORD 1                      E13024
0036 F*   20          SECOND PAYMENT AMOUNT BLANK ON INPUT                RE0730
0037 F*   21          PNAR BLANK ON INPUT                                 RE0730
0038 F*   22          DEBIT ACCOUNT = RETAIL                              RE0730
0039 F*        23      CREDIT ACCOUNT = RETAIL                            RE0730
0040 F*   24          LAST PAYMENT AMOUNT BLANK ON INPUT                  RE0730
      *       25      CR A/C POSTING ON RSACMTPD                          209995
0040 F*   26          TABLE - TRANSACTIONS TYPE RECORD                    E15459
      *       27      DR A/C IS NOSTRO                                    209995
      *       28      CR A/C IS NOSTRO                                    209995
0040 F*   29          CUSTOMER ORIGINATED TRANS TYPE 91000                E15459
0040 F*   30          STAND FILE DETAIL RECORD FLAGGED FOR DELETION       E17948
0040 F*   31          VALID STAND FILE TRAILER RECORD                     E17948
      *       32      DATE IS WITHIN 5 DAYS PERIOD                        209995
      *       33      USED TO HIT A DATE ON THE NEXT 5 WORKING DATES TABLE209995
0041 F*       34      FIRST SELECTED RECORD IN THE BRANCH                 S01117
0041 F*       35      RECORDS ALREADY SELECTED FROM THE BRANCH            S01117
      *       36      NEGATIVE TOTAL EAMT FOR RENESOPD                    209995
0041 F*       39      PROFIT CENTRE USED = 'Y'                            S01117
0041 F*       40      FIRST CYCLE PROCESSING                              RE0730
0042 F*       41      CHAIN FAIL ON CLINT FILE                            RE0730
0043 F*       42      DR ACCOUNT NON EXISTENT OR CLOSED                   RE0730
0044 F*       43      CR ACCOUNT NON EXISTENT OR CLOSED                   RE0730
0045 F*       44      PROCESS THIS RECORD                                 RE0730
0046 F*       45      NXTP LESS THAN DSPY                                 RE0730
0047 F*       46      CALCULATED NEXT PAY DATE IS LESS OR EQUAL TO RUND   RE0730
0048 F*               -- GENERATE ANOTHER SET OF ENTRIES - OPTION 1       RE0730
0049 F*       47      CALCULATED NEXT PAY DATE IS GREATER THAN FINAL      RE0730
0050 F*                  PAYMENT DATE - EXPIRE                            RE0730
0051 F*       48      LAST PAYMENT HAS BEEN MADE                          RE0730
0051 F********49*     CHAIN FAIL ON TABLETR                         E17948S01117
0051 F*       49      MAIN BRANCH ENTRIES REQUIRED                        S01117
0052 F*       50      NUMBER OF RECORDS ON STAND FILE OUT OF BALANCE      RE0730
0053 F*       51 52   VALUE OF RECORDS ON STAND OUT OF BALANCE            RE0730
0054 F*       53      EXCPT TO UPDATE STAND FILE                          RE0730
0055 F*       54      AMOUNT FOR HASH TOTAL IS -VE,SO CHANGE TO +VE       RE0730
0056 F********55******DATABASE ERROR***********************************   E17948
0055 F*       56      SUSPENSE ACCOUNT NOT FOUND FOR UNPOSTABLE ENTRIES   E17948
     F*       65      Analytical Accounting module is installed           CAC001
     F*       66      Output profit centre of debit account               CAC001
     F*       67      Output profit centre of credit account              CAC001
0056 F*       70      MULTI BRANCHED STANDING ORDER                       S01117
0056 F*       75      P1 REPORT HAS BEEN OPENED                           S01117
0056 F*       77      MBIN = 'Y'                                          S01117
0057 F*       89      CHAIN FAIL - TABLE FILE                             RE0730
0058 F*       88      CHAIN FAIL - ACCNT FILE                             RE0730
0059 F*       87      CHAIN FAIL - MEMO FILE                              RE0730
0060 F*       86      POST FIRST PAYMENT AMOUNT                           RE0730
0061 F*       85      POST LAST PAYMENT AMOUNT                            RE0730
0062 F**************U1OPTION 1*****************************************   E17948
0063 F*************NU1OPTION 2*****************************************   E17948
0062 F*            NU1OPTION 1 - RUN DATE OF TODAY (COB PROCESSING)       E17948
0063 F*             U1OPTION 2 - RUN DATE OF NEXT WORKING DAY (INPUT      E17948
     F*                          CYCLE  INIT. - UPDATES SHADOW FILES)     E17948
     F*             U7 DATABASE ERROR - ERROR IN DATABASE FILES           E17948
     F*             U8 DATABASE ERROR - FILE/HASH TOTALS OUT OF BALANCE   E17948
     E*
     E                    POWER   1   7  7 3                                                AR858062
      *                                                                                     AR858062
      ** Power Array                                                                        AR858062
      *                                                                                     AR858062
     E/COPY WNCPYSRC,RE0730E001
     E*
0064 E***********         ZHC        50  3               ZFREQ SR.ARRAY   S01195
0065 E***********         ZFMD   12  12  2               ZFREQ SR. ARRAY  S01195
0065 E                    ZFMD   12  12  2               FREQ SR. ARRAY   S01195
0066 E**                                                                  RE0730
0067 E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAYRE0730
0068 E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAYRE0730
0069 E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY RE0730
0068 E***********         BCC       150  3               BRANCH CODS01117 151104
     E                    BCC       900  3               BRANCH CODE ARRAY151104
0068 E***********         BCT       150 46               BRANCH DETLS01117S10736
0068 E***********         BCT       150 50               BRANCH DETS10736 151104
     E***********         BCT       900 50               BRANCH DETL ARRAY151104              238875
     E                    BCT       900 62               BRANCH DETL ARRAY                    238875
     E/COPY ZSRSRC,ZHOLE                                                  S01195
     E                    CPY@    1   1 80
     E                    NDAT        5  5 0                              209995
0070 E**                                                                  RE0730
0071 I**                                                                  RE0730
0072 I*    STANDING ORDERS MASTER FILE                                    RE0730
0073 I**                                                                  RE0730
0074 I*TAND***NS* 01   1 CH                                               S01117
0074 ISTANDL1 NS  01   1 CH                                               S01117
0075 I*                                                                   RE0730
0076 I        NS  02   1 CD                                               RE0730
0077 I       OR        1 C*                                               RE0730
0078 I                                        1   1 RECD                  RE0730
0079 I                                        2   60STOR                  RE0730
0080 I***********                             7   90BRCD                  S01117
0080 I                                        7   9 DRBR                  S01117
0081 I**********                             10  150DCUS                               RE0730 CSD027
0081 I                                       10  15 DCUS                                      CSD027
0082 I***********                            16  190DACO                  S01117
0082 I**********                             16  190DACD                               S01117 CGL029
     I                                       16  190DACDQQ                                    CGL029
0083 I                                       26  270DACS                  RE0730
0084 I                                       28  370DRAN            60    RE0730
0085 I**********                             38  430CCUS                               RE0730 CSD027
0085 I                                       38  43 CCUS                                      CSD027
0086 I***********                            44  470CACO                  S01117
0086 I**********                             44  470CSCA                               S01117 CGL029
     I                                       44  470CSCAQQ                                    CGL029
     I                                       48  48 MBSI                  RE0730
     I                                       49  51 TXBRCAL1              S01117
0087 I***********                            54  550CACS                  S01117
0087 I                                       54  550CACD                  S01117
0088 I                                       56  650CRAN            61    RE0730
0089 I                                       66  68 CCY                   RE0730
0090 I                                    P  69  710DFPY                  RE0730
0091 I                                    P  72  780AFPY                  RE0730
0092 I                                    P  79  810DSPY                  RE0730
0093 I                                    P  82  880ASPY            20    RE0730
0094 I                                    P  89  910DLPY                  RE0730
0095 I                                    P  92  980ALPY            24    RE0730
0096 I                                       99  99 PAYF                  RE0730
0097 I                                    P 100 1020DLMV                  RE0730
0098 I                                    P 103 1050NXTP                  RE0730
     I/COPY WNCPYSRC,RE0730I002
0099 I                                      106 135 PNAR            21    RE0730
     I/COPY WNCPYSRC,RE0730I003
0100 I                                      136 155 PNAM                  RE0730
0101 I                                      156 175 PAYR                  RE0730
0102 I                                      176 215 PAYB                  RE0730
0103 I                                      216 225 PAYA                  RE0730
0104 I                                      226 226 METH                  RE0730
0105 I                                      227 2280DYTP                  RE0730
     I***********                           229 239 ISWCRA          S05452S01117
     I***********                           241 245 ISWCRB          S05452S01117
     I                                      229 231 CBRC                  S01117
     I                                      232 235 PRFC                  S01117
     I                                      236 246 ISWCRA                S01117
     I                                      247 251 ISWCRB                S01117
     I                                      252 256 TRAT                  S01466
0106 I                                      176 195 FPAD                  RE0730
0107 I                                      196 215 SPAD                  RE0730
     I                                      265 2740DACD                                      CGL029
     I                                      275 2840CSCA                                      CGL029
0108 I        NS  03   1 CT                                               RE0730
0109 I                                    P  13  150NOSO                  RE0730
0110 I                                    P  16  230VSWN                  RE0730
0111 I                                    P  24  250VSDC                  RE0730
0112 I                                    P  26  280NSOI                  RE0730
0113 I                                    P  29  310NSOA                  RE0730
0114 I                                    P  32  340NSOD                  RE0730
0115 I                                    P  35  420VSIW                  RE0730
0116 I                                    P  43  440VSID                  RE0730
0117 I                                    P  45  520VSAW                  RE0730
0118 I                                    P  53  540VSAD                  RE0730
0119 I                                    P  55  620VSDW                  RE0730
0120 I                                    P  63  640VSDD                  RE0730
0121 I                                    P  65  670NSAU                  RE0730
0122 I                                    P  68  750VSUW                  RE0730
0123 I                                    P  76  770VSUD                  RE0730
0124 I**   CATCHALL                                                       RE0730
0125 I        NS  04                                                      RE0730
0126 I**                                                                  RE0730
0127 I*    ACCOUNTS MASTER FILE                                           RE0730
0128 I**                                                                  RE0730
0129 IACCNT   NS  05   1 CD                                               RE0730
0130 I       OR        1 CC                                               RE0730
0131 I                                        1   1 RECID                 RE0730
     I                                       23  250ABRCD                 RE0730
0132 I                                       26  26 ATYP                  RE0730
0133 I                                       29  29 ACST                  RE0730
     I/COPY WNCPYSRC,RE0730I001
     I                                    P  64  710CLBL                                      CRE013
     I                                      127 130 PRFCA                 CAC001
0134 I                                      190 1990ACNO                  RE0730
     I                                      200 200 RETB                  S01413
     I                                    P 202 2070ODLN                                      CRE013
     I                                    P 208 2100ODED                                    AR858062
     I                                    P 220 2270HELD                                      CRE013
0135 I                                    P 239 2410RRNM                  RE0730
0136 I**   CATCHALL                                                       RE0730
0137 I        NS  06                                                      RE0730
0138 I**                                                                  RE0730
0139 I*    STANDING DATA TABLES FILE                                      RE0730
0140 I**                                                                  RE0730
0141 I*                                                                   RE0730
0142 I*    TABLE FILE - INSTALLATION CONTROL DATA RECORD 1.               RE0730
0143 I*                                                                   RE0730
0144 ITABLE   NS  07   2 C0   3 C1  12 C1                                 RE0730
0145 I       AND      13 C0                                               RE0730
0146 I                                        1   1 RECI                  RE0730
0147 I                                        2   30RECT                  RE0730
0148 I                                       12  130RCDE                  RE0730
0149 I                                       14  66 TITL                  RE0730
0150 I                                       67  67 DATF                  RE0730
0151 I*****                                  68  700DFBR                  S01117
0151 I                                       68  70 DFBM                  S01117
0152 I                                       74  74 MODI1                 RE0730
0153 I                                       75  75 MODI2                 RE0730
0154 I                                       76  76 MODI3                 RE0730
0155 I                                    P  77  790RUND                  RE0730
0156 I                                       80  86 RUNA                  RE0730
0157 I                                       87  870SFLG                  RE0730
0158 I                                    P  90  920LCD                   RE0730
0159 I                                       93  93 CHTP                  RE0730
0160 I                                    P  94  960TNLU                  RE0730
0161 I*                                                                   RE0730
0162 I*                                                                   RE0730
0162 I*                                                                   RE0730
0163 I*    TABLE FILE - INSTALLATION CONTROL DATA RECORD 2.               RE0730
0164 I*                                                                   RE0730
0165 ITABLE   NS  08   1 CD   2 C0   3 C1                                 RE0730
0166 I       AND      12 C1  13 C1                                        RE0730
0167 I                                        1   1 RECI                  RE0730
0168 I                                        2   30RECT                  RE0730
0169 I                                       12  130RCDE                  RE0730
0170 I                                       14  16 BCCY                  RE0730
0171 I                                       17  19 BCYL                  RE0730
0172 I                                       20  22 HOCY                  RE0730
0173 I**********                             23  280HEAD                               RE0730 CSD027
0173 I                                       23  28 HEAD                                      CSD027
0174 I                                    P  29  310APDA                  RE0730
0175 I                                       35  35 APFQ                  RE0730
0176 I                                    P  36  380LOGS                  RE0730
0177 I                                       39  40 CUZR                  RE0730
0178 I                                    P  41  430DNWD                  RE0730
0179 I                                       44  460BVLP                  RE0730
0180 I                                       47  49 LOCY                  RE0730
0181 I                                       50  510FDAY                  RE0730
     I                                       60  62 SLOC                  209995
0182 I                                       86  86 ISAV                  RE0730
0183 I                                    P  87  890LLOG                  RE0730
0184 I                                    P  90  920LCD                   RE0730
0185 I                                       93  93 CHTP                  RE0730
0186 I                                    P  94  960TNLU                  RE0730
0187 I*                                                                   RE0730
0187 I*                                                                   RE0730
0188 I        NS  17   1 CD   2 C0   3 C1                                 RE0730
0189 I       AND      12 C2  13 C0                                        RE0730
0190 I**********                             14  170COMS                               RE0730 CGL029
     I                                       14  230COMS                                      CGL029
0191 I***********                                                         S01195
0192 I*****TABLE*FILE - HOLIDAY RECORD.                                   S01195
0193 I********E-EXCLUDE, I-INCLUDE.                                       S01195
0194 I***********                                                         S01195
0195 I*ABLE***NS* 09   1 CD   2 C2   3 C2                                 S01195
0196 I*******AND*     14 CE                                               S01195
0197 I*******OR**      1 CD   2 C2   3 C2                                 S01195
0198 I*******AND*     14 CI                                               S01195
0199 I***********                             1   1 RECI                  S01195
0200 I***********                             2   30RECT                  S01195
0201 I***********                             8  120HOL                   S01195
0202 I***********                            13  130SREC                  S01195
0203 I***********                            14  14 INEX                  S01195
0204 I***********                            15  89 HCCY                  S01195
0205 I***********                         P  90  920LCD                   S01195
0206 I***********                            93  93 CHTP                  S01195
0207 I***********                         P  94  960TNLU                  S01195
0208 I**                                                                  RE0730
0209 I***********                                                         S01117
0210 I*****TABLE*FILE - BRANCH CODES RECORD.                              S01117
0211 I***********                                                         S01117
0212 I*ABLE***NS* 10   1 CD   2 C1   3 C0                                 S01117
0213 I***********                             1   1 RECI                  S01117
0214 I***********                             2   30RECT                  S01117
0215 I***********                            11  130BRCD                  S01117
0216 I***********                            14  43 BRNM                  S01117
0217 I***********                            44  490BICN                  S01117
0218 I***********                            50  51 LOCC                  S01117
0219 I***********                            52  53 CMPY                  S01117
     I***********                            82  850IBAB                  S01117
     I***********                            86  890IBAH                  S01117
0220 I***********                         P  90  920LCD                   S01117
0221 I***********                            93  93 CHTP                  S01117
0222 I***********                         P  94  960TNLU                  S01117
0141 I*****************************************************************                E13024 CGL029
0142 I*****TABLE*FILE*-*ACCOUNT*CODES*RECORD*1.************************                E13024 CGL029
0143 I*****************************************************************                E13024 CGL029
0144 I***TABLE** NS  18   1 CD   2 C3   3 C0                                           E13024 CGL029
0145 I*******AND      13 C1                                                            E13024 CGL029
0146 I**********                             39  39 ACTP                               E13024 CGL029
0280 I**********                             75  76 ACCS                               S10736 CGL029
0141 I*                                                                   E15459
0142 I*    TABLE FILE - TRANSACTION TYPES RECORD                          E15459
0143 I*                                                                   E15459
0144 ITABLE   NS  26   1 CD   2 C4   3 C1                                 E15459
0146 I                                       44  44 CUOR                  E15459
0223 I*                                                                   RE0730
0224 I*    TABLE FILE - CATCHALL                                          RE0730
0225 I*                                                                   RE0730
0226 I        NS  11                                                      RE0730
0227 I                                        1   1 RECI                  RE0730
0228 I*    CLIENT MASTER FILE                                             RE0730
0229 I**                                                                  RE0730
0230 I*    CLIENT FILE - CUSTOMER STANDING DATA RECORD.                   RE0730
0231 I*                                                                   RE0730
0232 ICLINT   NS  12   1 CD   8 CA                                        RE0730
0233 I                                        1   1 RECI                  RE0730
0234 I**********                              2   70CNUM                               RE0730 CSD027
0234 I                                        2   7 CNUM                                      CSD027
0235 I                                        8   8 RCDT                  RE0730
0236 I                                        9  28 CRNM                  RE0730
0237 I                                       29  38 CTWN                  RE0730
0238 I                                       39  48 CSNM                  RE0730
0239 I                                       49  56 CASK                  RE0730
0240 I                                       57  68 TELX                  RE0730
0241 I                                       69  80 CSID                  RE0730
0242 I                                       81  82 ACOC                  RE0730
0243 I                                       83  83 CBSI                  RE0730
0244 I                                       84  85 CCTZ                  RE0730
0245 I                                       86  87 CLOC                  RE0730
0246 I**********                             88  930CPAR                               RE0730 CSD027
0246 I                                       88  93 CPAR                                      CSD027
0247 I                                       97  98 LINS                  RE0730
0248 I                                       99 101 LIND                  RE0730
0249 I                                    P 102 1040DASU                  RE0730
0250 I                                    P 105 1070CDIC                  RE0730
0251 I                                    P 108 1100DADE                  RE0730
0252 I                                      111 111 CMIN                  RE0730
0253 I                                      112 112 CTYP                  RE0730
0254 I                                      113 124 TELF                  RE0730
0255 I                                    P 250 2520LCD                   RE0730
0256 I                                      253 253 CHTP                  RE0730
0257 I                                    P 254 2560TNLU                  RE0730
     I                                      262 264 LOIC                                    BUG23967
0258 I*                                                                   RE0730
0259 I*    CLIENT CATCHALL                                                RE0730
0260 I*                                                                   RE0730
0261 I        NS  13                                                      RE0730
0262 I***********                                                   RE0730CCB002
0263 I*****SHADOW BALANCES FILE (S/MEMO)                            RE0730CCB002
0264 I***********                                                   RE0730CCB002
0265 I*EMO****NS**14                                                      047906
0265 I*MEMO***NS  14   1 CD                                         047906CCB002
0266 I***********                             2  160GRBL            RE0730CCB002
0267 I***********                            17  310NETB            RE0730CCB002
     I** Record-ID codes cannot be blank on two I-specs for the same file,049680
     I** so remove catchall, as it is redundant in any case.              049680
0268 I*****CATCHALL*******************************************************049680
0269 I********NS  15                                                      049680
     I*                                                                   LN0153
     I*  RENAME OF FIELDS FROM SDBRCHPD                                   LN0153
     ISDBRCHD0                                                            LN0153
     I              A8BRCD                          BRCH                  LN0153
     I              A8DFAC                          ADFR                  LN0153
     I              A8DTAC                          ADTO                  LN0153
     I              A8BICN                          BICN                  LN0153
     I              A8BRNM                          BRNM                  LN0153
0270 I**                                                                  RE0730
0271 I**   DATA STRUCTURE FOR KEY TO ACCNT FILE                           RE0730
0272 I            DS                                                      RE0730
0273 I*****                                   1  15 ACCKEY                S01117
     I**********                              1  18 ACCKEY                             S01117 CGL029
     I                                        1  24 ACCKEY                                    CGL029
0274 I                                        1   6 XCUS                  RE0730
0275 I                                        7   9 CCY                   RE0730
0276 I**********                             10  13 XACO                               RE0730 CGL029
0277 I**********                             14  15 XACS                               RE0730 CGL029
     I**********                             16  18 XBRCD                              S01117 CGL029
     I                                       10  19 XACO                                      CGL029
     I                                       20  21 XACS                                      CGL029
     I                                       22  24 XBRCD                                     CGL029
     I**
     I*                                                                   S05452
     I*    SWIFT COMMON REFERENCE                                         S05452
     I*                                                                   S05452
     I            DS                             16                       S05452
     I                                        1  11 ISWCRA                S05452
     I                                       12  16 ISWCRB                S05452
     I                                        1  16 OSWCR                 S05452
0278 I**                                                                  RE0730
0279 I**   DATA STRUCTURE FOR NARRATIVE                                   RE0730
0280 ILDA        UDS                            256                       RE0730
0281 I                                        1  30 NARR                  RE0730
0282 I                                        1   3 NARR1                 RE0730
0283 I                                        5   9 NARR2                 RE0730
0284 I                                       11  30 NARR3                 RE0730
      *                                                                   209995
      ** Data Structure for GL Module Data Area                           209995
     IGLSTAT     UDS                            256                       209995
     I                                       31  320DYSFWD                209995
0278 I**                                                                  E17948
0279 I**  DATA STRUCTURE FOR ERROR MESSAGES                               E17948
0280 I*                                                                   E17948
0281 I***********                           134 140 DBFILE          E17948S01117
0282 I***********                           141 167 DBKEY           E17948S01117
0283 I***********                           168 175 DBPGM           E17948S01117
0284 I***********                           176 177 DBASE           E17948S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
0257 I*                                                                   S01117
0462 I*    DR A/C BRANCH DETAILS DATA STRUCTURE                           S01117
0257 I*                                                                   S01117
0463 I            DS                                                      S01117
0464 I**********                              1  46 DBCI            S01117S10736
0464 I**********                              1  50 DBCI                               S10736 CGL029
     I                                        1  62 DBCI                                      CGL029
0465 I                                        1   6 DBICN                 S01117
0465 I**********                              7  10 DADTO                              S01117 CGL029
0465 I**********                             11  14 DADFR                              S01117 CGL029
0465 I**********                             15  15 DTYPTO                             S01117 CGL029
0465 I**********                             16  16 DTYPFR                             S01117 CGL029
0465 I**********                             17  46 DBRNM                              S01117 CGL029
0465 I**********                             47  48 DSECTO                             S10736 CGL029
0465 I**********                             49  50 DSECFR                             S10736 CGL029
     I                                        7  16 DADTO                                     CGL029
     I                                       17  26 DADFR                                     CGL029
     I                                       27  27 DTYPTO                                    CGL029
     I                                       28  28 DTYPFR                                    CGL029
     I                                       29  58 DBRNM                                     CGL029
     I                                       59  60 DSECTO                                    CGL029
     I                                       61  62 DSECFR                                    CGL029
0257 I*                                                                   S01117
0462 I*    CR A/C BRANCH DETAILS DATA STRUCTURE                           S01117
0257 I*                                                                   S01117
0463 I            DS                                                      S01117
0464 I**********                              1  46 CBCI            S01117S10736
0464 I**********                              1  50 CBCI                               S10736 CGL029
     I                                        1  62 CBCI                                      CGL029
0465 I                                        1   6 CBICN                 S01117
0465 I**********                              7  10 CADTO                              S01117 CGL029
0465 I**********                             11  14 CADFR                              S01117 CGL029
0465 I**********                             15  15 CTYPTO                             S01117 CGL029
0465 I**********                             16  16 CTYPFR                             S01117 CGL029
0465 I**********                             17  46 CBRNM                              S01117 CGL029
0465 I**********                             47  48 CSECTO                             S10736 CGL029
0465 I**********                             49  50 CSECFR                             S10736 CGL029
     I                                        7  16 CADTO                                     CGL029
     I                                       17  26 CADFR                                     CGL029
     I                                       27  27 CTYPTO                                    CGL029
     I                                       28  28 CTYPFR                                    CGL029
     I                                       29  58 CBRNM                                     CGL029
     I                                       59  60 CSECTO                                    CGL029
     I                                       61  62 CSECFR                                    CGL029
     I*                                                                   S01117
     I*    TRANSACTION BRANCH DETAILS DATA STRUCTURE                      S01117
     I*                                                                   S01117
     I            DS                                                      S01117
     I**********                              1  46 TBCI                  S10736
     I**********                              1  50 TBCI                               S10736 CGL029
     I                                        1  62 TBCI                                      CGL029
     I                                        1   6 TBICN                 S01117
     I**********                              7  10 TADTO                              S01117 CGL029
     I**********                             11  14 TADFR                              S01117 CGL029
     I**********                             15  15 TTYPTO                             S01117 CGL029
     I**********                             16  16 TTYPFR                             S01117 CGL029
     I**********                             17  46 TBRNM                              S01117 CGL029
0465 I**********                             47  48 TSECTO                             S10736 CGL029
0465 I**********                             49  50 TSECFR                             S10736 CGL029
     I                                        7  16 TADTO                                     CGL029
     I                                       17  26 TADFR                                     CGL029
     I                                       27  27 TTYPTO                                    CGL029
     I                                       28  28 TTYPFR                                    CGL029
     I                                       29  58 TBRNM                                     CGL029
     I                                       59  60 TSECTO                                    CGL029
     I                                       61  62 TSECFR                                    CGL029
     I*                                                                   S01117
     I*    MAIN BRANCH DETAILS DATA STRUCTURE                             S01117
     I*                                                                   S01117
     I            DS                                                      S01117
     I**********                              1  46 MBCI                  S10736
     I**********                              1  50 MBCI                               S10736 CGL029
     I                                        1  62 MBCI                                      CGL029
     I                                        1   6 MBICN                 S01117
     I**********                              7  10 MADTO                              S01117 CGL029
     I**********                             11  14 MADFR                              S01117 CGL029
     I**********                             15  15 MTYPTO                             S01117 CGL029
     I**********                             16  16 MTYPFR                             S01117 CGL029
     I**********                             17  46 MBRNM                              S01117 CGL029
0465 I**********                             47  48 MSECTO                             S10736 CGL029
0465 I**********                             49  50 MSECFR                             S10736 CGL029
     I                                        7  16 MADTO                                     CGL029
     I                                       17  26 MADFR                                     CGL029
     I                                       27  27 MTYPTO                                    CGL029
     I                                       28  28 MTYPFR                                    CGL029
     I                                       29  58 MBRNM                                     CGL029
     I                                       59  60 MSECTO                                    CGL029
     I                                       61  62 MSECFR                                    CGL029
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE                                S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     ISPOOL2      DS                                                                         BUG4051
     I                                       83  92 SFILE2                                   BUG4051
     I                                    B 123 1240SFNUM2                                   BUG4051
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I*                                                                   S01117
     I**                                                                  S01117
     ISDACOD    E DSSDACODPD                                              S01117
     I**   EXTERNAL DS FOR ACCOUNT CODES                                  S01117
     I              A5ACTY                          ATYP                  S01117
     I              A5ACSC                          ACSC                  S10736
     I**                                                                  S01117
     I*SDBRCH****E DSSDBRCHPD                                       S01117LN0153
     I****EXTERNAL*DS*FOR*BRANCH*CODE*DETAILS                       S01117LN0153
     I**********    A8BRCD                          BRCH            S01117LN0153
     I**********    A8DFAC                          ADFR            S01117LN0153
     I**********    A8DTAC                          ADTO            S01117LN0153
     I**********    A8BICN                          BICN            S01117LN0153
     I**********    A8BRNM                          BRNM            S01117LN0153
     I*                                                                   S01117
     ISDGELR    E DSSDGELRPD                                              S01117
     I** GENERAL LEDGER DETAILS                                           S01117
     I**     - PROFIT CENTRE USED FLAG                                    S01117
     I**     - GENERATE INTERBRANCH ENTRIES VIA MAIN BRANCH FLAG          S01117
     I**     - MAIN BRANCH CODE                                           S01117
     I              BKPRCU                          PFCU                  S01117
     I              BKIEMB                          GENB                  S01117
     I              BKMABR                          MABR                  S01117
     I              QQACCD                          QQACD1                                    CGL029
     I*                                                                   S01466
     ISDMMOD    E DSSDMMODPD                                              S01522
     I* Module Details Aaccesed via access program                        S01522
     I*                                                                   S01522
     ISCSARD    E DSSCSARDPD                                              S01466
     I**  SAR File Details Accessed via Access Program AOSARDR0           S01466
     I*                                                                   S01466
     ISDPCAC    E DSSDPCACPD                                              CAC001
     I**  SD Profit Centre Accounting ICD                                 CAC001
     I              QQFNAA                          QQFNA1                                    CGL029
     I              QQFNIC                          QQFNI1                                    CGL029
     I*                                                                   CAC001
     ICGPNAR    E DSCGPNARPD                                              S01522
     I* UDC Multi Language Narrative data structure                       S01522
     I*                                                                   S01522
     I##PRM1      DS                                                      086125
      **  Data Structure for Customer and Branch                          086125
      *                                                                   086125
     I                                        1   6 A#CUST                086125
     I                                        7   9 A#BRCA                086125
      *                                                                   086125
     ISDCUST    E DSSDCUSTPD                                              S01522
     I**  External DS for Customer details                                S01522
     I              QQDFAC                          QQDFA1                                    CGL029
     I*                                                                   S01522
     ISDRETR    E DSSDRETRPD                                              S01466
     I**  External DS for Retail Transaction types                        S01466
     I*                                                                   209995
     ISDRETL    E DSSDRETLPD                                              209995
     I              QQACCD                          QQACD3                                    CGL029
     I*                                                                   209995
     I**  External DS for Retail Details                                  209995
     I*                                                                   209995
     ISDBANK    E DSSDBANKPD                                                                AR858062
      *                                                                                     AR858062
      ** Bank Details                                                                       AR858062
      *                                                                                     AR858062
     ISDNOST    E DSSDNOSTPD                                              209995
     I              QQACCD                          QQACD4                                    CGL029
     I*                                                                   209995
     I**  External DS for Nostro Details                                  209995
      *                                                                                      BUG4051
     ISDCURR    E DSSDCURRPD                                                                 BUG4051
      ** SD Currency Details                                                                 BUG4051
      *                                                                   CRE009
      ** Define data area for Projected Movement End date - CRE009        CRE009
     IREPMED      DS                              5                       CRE009
     I*                                                                   S01466
      *                                                                   S01408
     I/COPY WNCPYSRC,RE0730IIP1                                           S01408
      *                                                                   S01408
     I/COPY ZSRSRC,ZHOLI                                                  S01195
     I*                                                                   S01117
     IDSFDY     E DSDSFDY                                                 S01117
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01117
     I*                                                                   S01117
     IDSSDY     E DSDSSDY                                                 S01117
     I* SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE                S01117
     I**                                                                  S01117
      *                                                                                       CRE013
     ISVAL1       DS                            200                                           CRE013
     I                                        1   1 SVAL11                                    CRE013
      ** DS for AOSVALR0                                                                      CRE013
      *                                                                                       CRE013
     I              'ReptFailedSO'        C         SVALKK                                    CRE013
      *                                                                                       CRE013
      *****************************************************************                       CRE013
     C                     MOVEACPY@      BIS@   80
     C*                                                                   E17948
     C*    DEFINE LDA                                                     S01117
     C           *NAMVAR   DEFN           LDA                             S01117
     C           *LOCK     IN   LDA                                       S01117
0137 C*                                                                   S01117
     C**   FOR DATABASE ERROR REFERENCE                                   E17948
     C*                                                                   E17948
     C***********          MOVE 'RE0730  'DBPGM                     E17948S01117
     C                     MOVE *BLANKS   DBFILE                          S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C                     MOVE *BLANKS   DBPGM                           S01117
     C                     Z-ADD0         DBASE                           S01117
     C                     MOVEL'RE0730'  DBPGM                           S01117
     C                     MOVE ' '       BLANKS 27                       E17948
      *                                                                                     AR858062
      ** Access Bank Details                                                                AR858062
      *                                                                                     AR858062
     C                     CALL 'AOBANKR0'                                                  AR858062
     C                     PARM '*BLANKS' WRTCD   7                                         AR858062
     C                     PARM '*FIRST ' WOPTN   7                                         AR858062
     C           SDBANK    PARM SDBANK    DSFDY                                             AR858062
      *                                                                                     AR858062
      ** Database error handler                                                             AR858062
      *                                                                                     AR858062
     C           WRTCD     IFNE *BLANKS                                                     AR858062
     C           *LOCK     IN   LDA                                                         AR858062
     C                     SETON                     U7U8LR                                 AR858062
     C                     SETON                     98                                     AR858062
     C                     MOVELWOPTN     DBKEY                                             AR858062
     C                     MOVEL'SDBANKPD'DBFILE           ****************                 AR858062
     C                     Z-ADD030       DBASE            * DB ERROR 030 *                 AR858062
     C                     OUT  LDA                        ****************                 AR858062
     C                     EXSR *PSSR                                                       AR858062
     C                     ENDIF                                                            AR858062
0285 C**                                                                  RE0730
     C*    DEFINE DUMMY RETAIL ACCOUNT NUMBER FOR OUTPUT TO GESOPD        RE0730
     C           *LIKE     DEFN ACNO      ZERO10                          RE0730
     C*                                                                   RE0730
0286 C**   FIRST CYCLE PROCESSING.                                        RE0730
0287 C   40                GOTO DETAIL                                    RE0730
0288 C                     SETON                     40                   RE0730
0289 C**                                                                  RE0730
0290 C*    SET UP FIELDS OF ZEROS FOR OUTPUT                              RE0730
0291 C                     Z-ADD0         ZERO3   30                      RE0730
0292 C                     Z-ADD0         ZERO5   50                      RE0730
0293 C                     Z-ADD0         ZERO15 150                      RE0730
     C                     Z-ADD0         Z10    100                      S01413
     C                     Z-ADD0         Z6      60                      S01413
     C                     Z-ADD0         Z8      80                      S01413
     C                     Z-ADD0         Z13    130                      S01413
0294 C*                                                                   RE0730
0295 C                     EXSR ZSYSTM                     GET ICDR1      RE0730
0296 C   99                GOTO ERROR                                     RE0730
     C**                                                                  S01117
     C**    IN THE DATAAREA RUNDAT                                        S01117
     C**                                                                  S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                                     S01117
     C**                                                                  S01117
     C**    TEST FOR MULTIBRANCHING                                       S01117
     C**                                                                  S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                     77                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
0297 C**                                                                  RE0730
0298 C**   IF OPTION 2 IS RUNNING, GET ICDR2 FOR NEXT WORKING DATE.       RE0730
0299 C**NU1*****           GOTO BYPAS1                             RE0730 209995
0300 C                     MOVEL'01    '  TABKEY 12                       RE0730
0301 C                     MOVE '    11'  TABKEY                          RE0730
0302 C                     EXSR TABCHN                                    RE0730
     C*                                                                   E17948
     C*   IF CHAIN FAIL ON TABLE FILE, OUTPUT ERROR  REPORT.              E17948
     C           *IN89     IFEQ '1'                                       E17948
     C           *IN08     OREQ '0'                                       E17948
     C                     MOVE '03'      DBASE            ***************E17948
     C                     MOVE 'TABTB11' DBFILE           *   ERROR 03  *E17948
     C                     MOVE BLANKS    DBKEY            ***************E17948
     C                     MOVELTABKEY    DBKEY                           E17948
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     END                                            E17948
0303 C   89                                                               RE0730
0304 CORN08                GOTO ERROR                                     RE0730
0305 C           BYPAS1    TAG                             **  BYPAS1  ** RE0730
     C*                                                                   S01466
     C**  If SAR is switched OFF, perform the following processing        S01466
     C*                                                                   S01466
     C           S01466    IFNE 'Y'                                       S01466
0289 C**                                                                  E15459
0290 C*    CHECK FOR TRANSACTION TYPE 91000 IF CUST ORIGINATED            E15459
0291 C                     MOVEL'41    '  TABKEY                          E15459
0292 C                     MOVE ' 91000'  TABKEY                          E15459
0293 C                     EXSR TABCHN                                    E15459
     C*                                                                   E17948
     C* IF TRANSACTION TYPE RECORD DELETED OR FLAGGED, OUTPUT ERROR REPORTE17948
     C           *IN89     IFEQ '1'                                       E17948
     C           *IN26     OREQ '0'                                       E17948
     C                     MOVE '04'      DBASE            ***************E17948
     C                     MOVE 'TABLETZ' DBFILE           *   ERROR 04  *E17948
     C                     MOVE BLANKS    DBKEY            ***************E17948
     C                     MOVELTABKEY    DBKEY                           E17948
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     END                                            E17948
0296 C   89                                                               E15459
0297 CORN26                GOTO ERROR                                     E15459
     C*                                                                   E17948
     C                     END                                            S01466
      *                                                                                      BUG9690
     C                     MOVEL'01    '  TABKEY                                             BUG9690
     C                     MOVE '    20'  TABKEY                                             BUG9690
     C                     EXSR TABCHN                                                       BUG9690
     C           *IN89     IFEQ '1'                                                          BUG9690
     C                     MOVE '21'      DBASE                                              BUG9690
     C                     MOVE 'TABTB20' DBFILE                                             BUG9690
     C                     MOVE BLANKS    DBKEY                                              BUG9690
     C                     MOVELTABKEY    DBKEY                                              BUG9690
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     GOTO ERROR                                                        BUG9690
     C                     ENDIF                                                             BUG9690
     C*                                                                   S01466
0294 C                     MOVEL'      '  TABKEY                          E15459
0295 C                     MOVE '      '  TABKEY                          E15459
0298 C           CUOR      COMP 'Y'                      29               E15459
0299 C                     BITOF'01234567'PRIN    1                       E15459
0300 C   29                BITON'0'       PRIN                            E15459
0306 C**                                                                  RE0730
0307 C**   INITIALISE SUNDRY FIELDS                                       RE0730
0308 C                     MOVE 'A'       CLIKEY  7        KEY TO S/CLINT.RE0730
0309 C                     MOVE ' '       BLNK30 30                       RE0730
     C/COPY WNCPYSRC,RE0730C018
     C*                                                                   S01117
     C*     SET UP ARRAY OF BRANCH TABLE DETAILS                          S01117
     C*                                                                   S01117
     C                     EXSR BCTARR                                    S01117
     C   U7                GOTO END                                       S01117
     C*                                                                   S01117
     C** ACCESS GENERAL LEDGER DETAILS FOR MAIN BRANCH &                  S01117
     C** GENERATE ENTRIES VIA MAIN BRANCH FLAG                            S01117
     C**********           CALL 'AOGELRR0'                                S01117              CGL029
     C                     CALL 'AOGELRR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*FIRST ' @OPTN   7                       S01117
     C********** SDGELR    PARM SDGELR    DSFDY                           S01117              CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL'SDGELRPD'DBFILE             *************S01117
     C                     MOVEL'008'     DBASE              * DBERR 008 *S01117
     C**********           MOVEL@OPTN     DBOPTN  7          *******S01117LN0153
     C                     MOVEL@OPTN     DBKEY                           S01117
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     GOTO ERROR                                     S01117
     C                     END                                            S01117
     C*                                                                                     MD054019
     C** CALL A/O AOBANKR0 - Access Bank Details                                            MD054019
     C*                                                                                     MD054019
     C                     CALL 'AOBANKR0'                                                  MD054019
     C                     PARM '*MSG   ' @RTCD                                             MD054019
     C                     PARM '*FIRST ' @OPTN                                             MD054019
     C           SDBANK    PARM SDBANK    DSFDY                                             MD054019
     C*                                                                                     MD054019
     C           @RTCD     IFNE *BLANK                                                      MD054019
     C                     MOVEL'SDBANKPD'DBFILE                                            MD054019
     C                     MOVEL'040'     DBASE                                             MD054019
     C                     MOVEL@OPTN     DBKEY                                             MD054019
     C                     MOVE *ON       *INU7                                             MD054019
     C                     MOVE *ON       *IN98                                             MD054019
     C                     GOTO ERROR                                                       MD054019
     C                     END                                                              MD054019
     C*                                                                                     MD054019
     C*                                                                                     MD054019
     C** Get Event Control Date                                                             MD054019
     C** For Accrual for Non-working days Processing Types 0 and 1,                         MD054019
     C** Event Control Date is BJDNWD -1.                                                   MD054019
     C*                                                                                     MD054019
     C                     Z-ADD*ZEROS    EVTDAT  50                                        MD054019
     C           BJDNWD    SUB  1         EVTDAT                                            MD054019
     C*                                                                                     MD054019
     C** If Accrual for Non-working days indicator is equal 2, then                         MD054019
     C** if the Accrual/Profit Date is less than or equal to Date of                        MD054019
     C** Next Working Day minus 1, the Event Control Date should be                         MD054019
     C** the Accrual/Profit Date.  Otherwise, it should be Rundate.                         MD054019
     C*                                                                                     MD054019
     C           BKANWD    IFEQ '2'                                                         MD054019
     C           BKAPDT    IFLE EVTDAT                                                      MD054019
     C                     Z-ADDBKAPDT    EVTDAT                                            MD054019
     C                     ELSE                                                             MD054019
     C                     Z-ADDBJRDNB    EVTDAT                                            MD054019
     C                     END                                                              MD054019
     C                     END                                                              MD054019
     C*                                                                                     MD054019
      *                                                                   S01522
      * Call module prog. for module details.                             S01522
     C                     CALL 'AOMMODR0'                                S01522
     C                     PARM '*MSG   ' @RTCD                           S01522
     C                     PARM '*FIRST ' @OPTN                           S01522
     C           SDMMOD    PARM SDMMOD    DSFDY                           S01522
      *                                                                   S01522
     C           @RTCD     IFNE *BLANK                     B1             S01522
     C                     MOVEL'SDMMODPD'DBFILE           * * * * * * *  S01522
     C                     MOVEL'086'     DBASE            * DBERR 086 *  S01522
     C                     MOVEL@OPTN     DBKEY            * * * * * * *  S01522
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     GOTO ERROR                       1             S01522
     C                     ELSE                            X1             S01522
      *                                                                   CAC001
      **  If Analytical Accounting is installed, get Primary              CAC001
      **  Funding Profit Centre in PCA ICD file                           CAC001
      *                                                                   CAC001
     C                     MOVE '0'       *IN66                           CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '1'       *IN65                           CAC001
      *                                                                   CAC001
     C                     CALL 'AOPCACR0'                                CAC001
     C                     PARM '*MSG   ' @RTCD                           CAC001
     C                     PARM '*FIRST ' @OPTN                           CAC001
     C           SDPCAC    PARM SDPCAC    DSFDY                           CAC001
      *                                                                   CAC001
     C           @RTCD     IFNE *BLANK                                    CAC001
     C                     MOVEL'SDPCACPD'DBFILE           ************   CAC001
     C                     Z-ADD25        DBASE            * DBERR 25 *   CAC001
     C                     MOVEL@OPTN     DBKEY            ************   CAC001
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     GOTO ERROR                                     CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ELSE                                           CAC001
     C                     MOVE '0'       *IN65                           CAC001
     C                     ENDIF                                          CAC001
     C/COPY WNCPYSRC,REH00397
      *                                                                   S01522
      * Call SAR prog. for switchable feature                             S01522
     C           BGN1ST    IFEQ 'Y'                        B2             S01522
     C/COPY WNCPYSRC,REH00398
     C                     CALL 'AOSARDR0'                  2             S01522
     C                     PARM '       ' @RTCD             2             S01522
     C                     PARM '*VERIFY' @OPTN             2             S01522
     C                     PARM 'REPNAR'  @SARD   6         2             S01522
     C           SCSARD    PARM SCSARD    DSFDY             2             S01522
     C           @RTCD     IFNE *BLANK                     B3             S01522
     C           @RTCD     ANDNE'*NRF   '                   3             S01522
     C                     MOVEL'SCSARDPD'DBFILE            ************* S01522
     C                     MOVEL'087'     DBASE             *DBERROR 087* S01522
     C                     MOVEL@SARD     DBKEY             ************* S01522
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     GOTO ERROR                       3             S01522
     C                     END                             E3             S01522
     C           @RTCD     IFEQ *BLANK                     B3             S01522
     C                     MOVEL'Y'       REPNAR  1         3             S01522
     C                     END                             E3             S01522
     C                     END                             E2             S01522
     C                     END                             E1             S01522
      *                                                                   CRE009
      ** Access object to check for CRE009 feature                        CRE009
      *                                                                   CRE009
     C                     CALL 'AOSARDR0'                                CRE009
     C                     PARM '       ' @RTCD                           CRE009
     C                     PARM '*VERIFY' @OPTN                           CRE009
     C                     PARM 'CRE009'  @SARD                           CRE009
     C           SCSARD    PARM SCSARD    DSFDY                           CRE009
      *                                                                   CRE009
     C           @RTCD     IFEQ *BLANKS                                   CRE009
     C                     MOVE 'Y'       CRE009  1                       CRE009
     C                     ELSE                                           CRE009
     C                     MOVE 'N'       CRE009                          CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CRE009
      ** Get value of data area REPMED                                    CRE009
     C           CRE009    IFEQ 'Y'                                       CRE009
     C                     Z-ADD0         @REPMD  50                      CRE009
     C           *NAMVAR   DEFN           REPMED                          CRE009
     C                     IN   REPMED                                    CRE009
     C                     MOVE REPMED    @REPMD                          CRE009
     C                     ENDIF                                          CRE009
      *                                                                                       CGL020
      ** Determine if Midas Compliance Watch is installed                                     CGL020
      *                                                                                       CGL020
     C                     MOVE 'N'       CGL020  1                                           CGL020
     C                     CALL 'AOSARDR0'                                                    CGL020
     C                     PARM '       ' PRTCD   7                                           CGL020
     C                     PARM '*VERIFY' POPTN   7                                           CGL020
     C                     PARM 'CGL020'  PSARD   6                                           CGL020
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL020
      *                                                                                       CGL020
     C           PRTCD     IFNE *BLANK                                                        CGL020
     C           PRTCD     ANDNE'*NRF   '                                                     CGL020
     C           *LOCK     IN   LDA                                                           CGL020
     C                     MOVEL'RE0730'  DBPGM                                               CGL020
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL020
     C                     MOVEL'020'     DBASE                                               CGL020
     C                     MOVELPSARD     DBKEY                                               CGL020
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     OUT  LDA                                                           CGL020
     C                     GOTO ERROR                                                         CGL020
     C                     ENDIF                                                              CGL020
      *                                                                                       CGL020
     C           PRTCD     IFEQ *BLANK                                                        CGL020
     C                     MOVE 'Y'       CGL020                                              CGL020
     C                     ENDIF                                                              CGL020
      *                                                                                       CRE020
      ** Check if CRE020 is enabled.                                                          CRE020
      *                                                                                       CRE020
     C                     CALL 'AOSARDR0'                                                    CRE020
     C                     PARM *BLANKS   PRTCD                                               CRE020
     C                     PARM '*VERIFY' POPTN                                               CRE020
     C                     PARM 'CRE020'  PSARD                                               CRE020
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE020
      *                                                                                       CRE020
     C                     MOVE 'N'       CRE020  1                                           CRE020
      *                                                                                       CRE020
     C           PRTCD     IFEQ *BLANKS                                                       CRE020
     C                     MOVE 'Y'       CRE020                                              CRE020
     C                     ENDIF                                                              CRE020
      *                                                                                       CRE020
     C*                                                                   S01117
     C*   IF INTERBRANCH ENTRIES TO BE GENERATED VIA MAIN BRANCH,         S01117
     C*   SET UP MAIN BRANCH DETAILS                                      S01117
     C*                                                                   S01117
     C           GENB      IFEQ 'Y'                         *B1           S01117
     C                     SETOF                         10               S01117
     C                     Z-ADDSTIX      IX                              S01117
     C           MABR      LOKUPBCC,IX                   10               S01117
     C   10                MOVE BCT,IX    MBCI                            S01117
     C                     END                              *E1           S01117
     C*                                                                   S01117
     C*   CHECK WHETHER PROFIT CENTRE USED                                S01117
     C*                                                                   S01117
     C           PFCU      IFEQ 'Y'                         *B1           S01117
     C                     SETON                         39               S01117
     C                     END                              *E1           S01117
      *                                                                                       CAP205
      ** Determine if SAR CAP205 Teller Related APIs - Account Balance Check                  CAP205
      ** is installed.                                                                        CAP205
      *                                                                                       CAP205
     C                     MOVEL'N'       CAP205  1                                           CAP205
     C                     CALL 'AOSARDR0'                                                    CAP205
     C                     PARM *BLANKS   @RTCD                                               CAP205
     C                     PARM '*VERIFY '@OPTN                                               CAP205
     C                     PARM 'CAP205'  @SARD                                               CAP205
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP205
      *                                                                                       CAP205
     C           @RTCD     IFEQ *BLANKS                                                       CAP205
     C                     MOVEL'Y'       CAP205                                              CAP205
     C                     ELSE                                                               CAP205
     C           @RTCD     IFNE *BLANKS                                                       CAP205
     C           @RTCD     ANDNE'*NRF   '                                                     CAP205
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP205
     C                     MOVEL'038'     DBASE                                               CAP205
     C                     MOVEL'CAP205'  DBKEY                                               CAP205
     C                     SETON                     U7U8                                     CAP205
     C                     EXSR *PSSR                                                         CAP205
     C                     ENDIF                                                              CAP205
     C                     ENDIF                                                              CAP205
      *                                                                                       CAP205
      *                                                                                       CAP207
      ** Determine if SAR CAP207 Account Balance Check extended to other APIs                 CAP207
      ** is installed.                                                                        CAP207
      *                                                                                       CAP207
     C                     MOVEL'N'       CAP207  1                                           CAP207
     C                     CALL 'AOSARDR0'                                                    CAP207
     C                     PARM *BLANKS   @RTCD                                               CAP207
     C                     PARM '*VERIFY '@OPTN                                               CAP207
     C                     PARM 'CAP207'  @SARD                                               CAP207
     C           SCSARD    PARM SCSARD    DSFDY                                               CAP207
      *                                                                                       CAP207
     C           @RTCD     IFEQ *BLANKS                                                       CAP207
     C                     MOVEL'Y'       CAP207                                              CAP207
     C                     ELSE                                                               CAP207
     C           @RTCD     IFNE *BLANKS                                                       CAP207
     C           @RTCD     ANDNE'*NRF   '                                                     CAP207
     C                     MOVEL'SCSARDPD'DBFILE                                              CAP207
     C                     MOVEL'039'     DBASE                                               CAP207
     C                     MOVEL'CAP207'  DBKEY                                               CAP207
     C                     SETON                     U7U8                                     CAP207
     C                     EXSR *PSSR                                                         CAP207
     C                     ENDIF                                                              CAP207
     C                     ENDIF                                                              CAP207
      *                                                                                       CAP207
     C*                                                                   S01182
     C**  INITIALISE ACCOUNT POSTING FEILDS FOR PF/CLEARPD.               S01182
     C                     Z-ADD*ZEROS    SDLB   150                      S01182
     C                     Z-ADD*ZEROS    SDCB   150                      S01182
     C**********           MOVE *BLANKS   PRFC    4                S01182 168936
     C**********           MOVE *BLANKS   OTRF   15                                    S01182 CGL029
     C                     MOVE *BLANKS   OTRF   21                                           CGL029
     C***                  MOVE *BLANKS   OTTP   10                 S01182S01255
     C                     MOVEL'91000'   OTTP   10                       S01255
     C                     MOVE *BLANKS   OTST   10                       S01182
     C                     MOVE *BLANKS   BOKC    2                       S01182
     C**   INITIALISE FIELDS FOR MANAGEMENT ACCOUNTING                    S10736
     C                     Z-ADD0         VOIN    10                      S10736
     C                     Z-ADD235959    PTIM    60                      S10736
      *                                                                   209995
      ** Get the date to be used to determine if an event will be         209995
      ** generated for a payment.                                         209995
      *                                                                   209995
     C********** DYSFWD    IFEQ 99                                                    209995 BUG6222
     C**********           Z-ADD99999     REPDAY  50                                  209995 BUG6222
     C**********           ELSE                                                       209995 BUG6222
     C           DYSFWD    IFLE 5                                         209995
     C                     Z-ADD5         DYSFWD                          209995
     C                     END                                            209995
     C                     Z-ADDDYSFWD    ZNRDYS                          209995
     C                     Z-ADDRUND      ZDAYNO                          209995
     C                     MOVELLOCY      ZCCY                            209995
     C                     MOVE SLOC      ZLOC                            209995
     C                     EXSR ZFWDT                                     209995
     C**********           Z-ADDZDYNBR    REPDAY                                      209995 BUG6222
     C                     Z-ADDZDYNBR    REPDAY  50                                         BUG6222
     C**********           END                                                        209995 BUG6222
      *                                                                                       CRE013
      ** Check if 'ReptFailedSO' is on                                                        CRE013
     C                     CALL 'AOSVALR0'                                                    CRE013
     C                     PARM           @RTCD                                               CRE013
     C                     PARM SVALKK    SVALK1 20                                           CRE013
     C                     PARM           SVAL1 200                                           CRE013
     C                     PARM *BLANK    SVALK2 20                                           CRE013
     C                     PARM           SVAL2 200                                           CRE013
     C                     PARM *BLANK    SVALK3 20                                           CRE013
     C                     PARM           SVAL3 200                                           CRE013
     C                     PARM *BLANK    SVALK4 20                                           CRE013
     C                     PARM           SVAL4 200                                           CRE013
     C                     PARM *BLANK    SVALK5 20                                           CRE013
     C                     PARM           SVAL5 200                                           CRE013
     C                     PARM *BLANK    SVALK6 20                                           CRE013
     C                     PARM           SVAL6 200                                           CRE013
     C                     PARM *BLANK    SVALK7 20                                           CRE013
     C                     PARM           SVAL7 200                                           CRE013
     C                     PARM *BLANK    SVALK8 20                                           CRE013
     C                     PARM           SVAL8 200                                           CRE013
     C                     PARM *BLANK    SVALK9 20                                           CRE013
     C                     PARM           SVAL9 200                                           CRE013
     C                     PARM *BLANK    SVALK0 20                                           CRE013
     C                     PARM           SVAL10200                                           CRE013
     C           @RTCD     IFNE *BLANK                                                        CRE013
     C                     MOVEL'SDSVALPD'DBFILE                                              CRE013
     C                     MOVEL'88'      DBASE                                               CRE013
     C                     MOVELSVALKK    DBKEY                                               CRE013
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     GOTO ERROR                                                         CRE013
     C                     ENDIF                                                              CRE013
      *                                                                                       CRE013
     C           CAP207    IFEQ 'Y'                                                           CAP207
     C                     OPEN RESTORPD                                                      CAP207
     C**********           ELSE                                                      CAP207 MD056198
     C                     ENDIF                                                            MD056198
     C           SVAL11    IFEQ 'Y'                                                           CRE013
     C                     MOVE 'Y'       CRE013  1                                           CRE013
     C                     OPEN RESTORPD                                                      CRE013
     C                     ELSE                                                               CRE013
     C                     MOVE 'N'       CRE013                                              CRE013
     C                     ENDIF                                                              CRE013
     C**********           ENDIF                                                     CAP207 MD056198
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0730CCP1                                           S01408
      *                                                                   S01408
      ** Initialise new fields for CGL020                                                     CGL020
      *                                                                                       CGL020
     C                     MOVE *BLANK    ACKEY  20                                           CGL020
     C                     MOVE *BLANK    FEEFLG  1                                           CGL020
     C                     Z-ADD0         FEEVAL 130                                          CGL020
     C                     Z-ADD0         FEEPCT  52                                          CGL020
     C                     MOVE *BLANKS   RORACT 20                                           CGL020
     C                     MOVE *BLANKS   RORCTY  2                                           CGL020
     C                     MOVE *BLANKS   RORBNK 20                                           CGL020
     C                     MOVE *BLANKS   RORCDE 11                                           CGL020
     C                     MOVE *BLANKS   PORACT 20                                           CGL020
     C                     MOVE *BLANKS   PORCTY  2                                           CGL020
     C                     MOVE *BLANKS   PORBNK 20                                           CGL020
     C                     MOVE *BLANKS   PORCDE 11                                           CGL020
     C                     MOVE *BLANKS   DSTACT 35                                           CGL020
     C                     MOVE *BLANKS   DSTCTY  2                                           CGL020
     C                     MOVE *BLANKS   DSTBNK 20                                           CGL020
     C                     Z-ADD*ZEROS    SETDAT  50                                          CGL020
     C                     MOVE *BLANKS   TICKER 10                                           CGL020
     C                     MOVE *BLANKS   EXCHNG 20                                           CGL020
     C                     Z-ADD*ZEROS    NOMINL 132                                          CGL020
     C                     Z-ADD*ZEROS    ACODQQ  40                                       AR1091700
     C                     Z-ADD*ZEROS    XRFN   100                                       AR1091700
     C                     Z-ADD*ZEROS    ORAMT  130                                       AR1091700
     C                     Z-ADD*ZEROS    LTAI    10                                       AR1091700
0310 C**                                                                  RE0730
0311 C**   I N P U T    C Y C L E    P R O C E S S I N G                  RE0730
0312 C           DETAIL    TAG                             **  DETAIL  ** RE0730
      *                                                                   S01408
     C/COPY WNCPYSRC,RE0730CCP2                                           S01408
      *                                                                   S01408
0313 C**                                                                  RE0730
0314 C**   RESET RESULTING INDICATORS                                     RE0730
0315 C                     SETOF                     30                   RE0730
0316 C                     SETOF                     414243               RE0730
0317 C                     SETOF                     444546               RE0730
0318 C                     SETOF                     474853               RE0730
0315 C                     SETOF                     505152               E17948
     C                     SETOF                     3449                 S01117
     C*                                                                   S01182
     C** SETUP ACCOUNT POSTING FIELD WITH REFERENCE NO.FROM LF/STAND.     S01182
     C                     MOVELSTOR      OTRF                            S01182
0319 C**                                                                  RE0730
0320 C**   ACCUMULATE CONTROL TOTALS OF NUMBER & VALUE OF STANDING ORDERS.RE0730
0321 C  N02                GOTO END                                       RE0730
     C*                                                                   S01117
     C/COPY WNCPYSRC,RE0730C010
     C           *INL1     IFEQ '1'                                       S01117
     C           *INU1     ANDNE'1'                                       S01117
     C                     CLOSERE0730P1                                  S01117
     C**********           CLOSERE0730P2                                             BUG4051 BUG4051
     C                     SETOF                     35                   S01117
     C                     END                                            S01117
0322 C   02      RECD      COMP '*'                      30               RE0730
     C/COPY WNCPYSRC,RE0730C013
0323 C   30                GOTO END                                       RE0730
0324 C           TOTSO     ADD  1         TOTSO   50                      RE0730
0325 C                     Z-ADDVALINT    ZZTOTI                          RE0730
0326 C                     Z-ADDVALDEC    ZZTOTD                          RE0730
0327 C                     EXSR HASH                                      RE0730
0328 C                     Z-ADDZZTOTI    VALINT 150                      RE0730
0329 C                     Z-ADDZZTOTD    VALDEC  30                      RE0730
      *                                                                   209995
     C                     MOVE DCUS      CNUMX   6                       209995
     C**********           MOVE DACD      ACODX   4                                    209995 CGL029
     C                     MOVE DACD      ACODX  10                                           CGL029
     C                     MOVE DACS      ACSQX   2                       209995
     C                     CALL 'AONOSTR0'                                209995
     C                     PARM '*MSG    'W@RTCD  7        B:Return Cd    209995
     C                     PARM '*KEY    'W@OPTN  7        I:Option       209995
     C                     PARM CNUMX     W@CUST  6        I:Customer No. 209995
     C                     PARM CCY       W@CYCD  3        I:Currency Code209995
     C**********           PARM ACODX     W@ACCD  4        I:Account Code              209995 CGL029
     C                     PARM ACODX     W@ACCD 10                                           CGL029
     C                     PARM ACSQX     W@ACSN  2        I:Account Seque209995
     C                     PARM *BLANK    W@NONB  2        I:Nostro Number209995
     C                     PARM DRBR      W@BRCD  3        I:Branch Code  209995
     C                     PARM *BLANK    W@CSSN 10        I:Cust ShortN  209995
     C                     PARM *BLANK    W@PNOI  1        I:Prime Nost In209995
     C           SDNOST    PARM SDNOST    DSFDY            O:Format       209995
     C           W@RTCD    COMP *BLANK                   27               209995
      *                                                                   209995
      ** Save Nostro number if Debit account is Nostro.                   209995
      *                                                                   209995
     C           *IN27     IFEQ '1'                                       209995
     C                     MOVE A7NONB    WNOSD   2                       209995
     C                     ENDIF                                          209995
      *                                                                   209995
     C                     MOVE CCUS      CNUMX                           209995
     C                     MOVE CSCA      ACODX                           209995
     C                     MOVE CACD      ACSQX                           209995
     C                     CALL 'AONOSTR0'                                209995
     C                     PARM '*MSG    'W@RTCD  7        B:Return Cd    209995
     C                     PARM '*KEY    'W@OPTN  7        I:Option       209995
     C                     PARM CNUMX     W@CUST  6        I:Customer No. 209995
     C                     PARM CCY       W@CYCD  3        I:Currency Code209995
     C**********           PARM ACODX     W@ACCD  4        I:Account Code              209995 CGL029
     C                     PARM ACODX     W@ACCD                                              CGL029
     C                     PARM ACSQX     W@ACSN  2        I:Account Seque209995
     C                     PARM *BLANK    W@NONB  2        I:Nostro Number209995
     C                     PARM CBRC      W@BRCD  3        I:Branch Code  209995
     C                     PARM *BLANK    W@CSSN 10        I:Cust ShortN  209995
     C                     PARM *BLANK    W@PNOI  1        I:Prime Nost In209995
     C           SDNOST    PARM SDNOST    DSFDY            O:Format       209995
     C           W@RTCD    COMP *BLANK                   28               209995
      *                                                                   209995
      ** Save Nostro number if Credit account is Nostro.                  209995
      *                                                                   209995
     C           *IN28     IFEQ '1'                                       209995
     C                     MOVE A7NONB    WNOSC   2                       209995
     C                     ENDIF                                          209995
      *                                                                   CRE009
      ** If shadow post run and CRE009 is ON, compare next payment        CRE009
      ** date with the value in dtaara REPMED instead.                    CRE009
     C           *INU1     IFEQ '1'                                       CRE009
     C           CRE009    ANDEQ'Y'                                       CRE009
     C           NXTP      COMP @REPMD                 4444               CRE009
     C                     ELSE                                           CRE009
0332 C********** NXTP      COMP RUND                   4444                         RE0730  MD054019
     C           NXTP      COMP EVTDAT                 4444                                 MD054019
     C                     ENDIF                                          CRE009
0334 C  N44                GOTO END                                       RE0730
      *                                                                                     MD042714
      ** If Date of Last Payment amended to a backvalued date i.e.                          MD042714
      ** expire the SO backvalued, Next Payment Date is automatically                       MD042714
      ** updated to Date of Last Payment                                                    MD042714
      *                                                                                     MD042714
0334 C           *IN44     IFEQ '1'                                                         MD042714
0334 C           NXTP      ANDLTRUND                                                        MD042714
0334 C           NXTP      ANDLEDLMV                                                        MD042714
0334 C                     SETON                     48                                     MD042714
0334 C                     GOTO EXPIRE                                                      MD042714
0334 C                     END                                                              MD042714
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0730CCP3                                           S01408
     C*                                                                   S01408
     C                     CALL 'AOCURRR0'                                                   BUG4051
     C                     PARM *BLANKS   W@RTCD                                             BUG4051
     C                     PARM '*KEY    'W@OPTN                                             BUG4051
     C                     PARM           CCY                                                BUG4051
     C           SDCURR    PARM SDCURR    DSSDY                                              BUG4051
      *                                                                                      BUG4051
     C           W@RTCD    IFNE *BLANK                                                       BUG4051
     C           *LOCK     IN   LDA                                                          BUG4051
     C                     MOVE *ON       *INU7                                              BUG4051
     C                     MOVE *ON       *INU8                                              BUG4051
     C                     MOVE *ON       *INLR                                              BUG4051
     C                     Z-ADD103       DBASE                                              BUG4051
     C                     MOVEL'SDCURRPD'DBFILE                                             BUG4051
     C                     MOVELCCY       DBKEY                                              BUG4051
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     OUT  LDA                                                          BUG4051
     C                     EXSR *PSSR                                                        BUG4051
     C                     ENDIF                                                             BUG4051
      *                                                                                      BUG4051
     C                     MOVEA'0000'    *IN,77                                             BUG4051
     C                     SELEC                                                             BUG4051
     C           A6NBDP    WHEQ 0                                                            BUG4051
     C                     MOVE *ON       *IN78                                              BUG4051
     C           A6NBDP    WHEQ 1                                                            BUG4051
     C                     MOVE *ON       *IN79                                              BUG4051
     C           A6NBDP    WHEQ 2                                                            BUG4051
     C                     MOVE *ON       *IN80                                              BUG4051
     C           A6NBDP    WHEQ 3                                                            BUG4051
     C                     MOVE *ON       *IN81                                              BUG4051
     C                     ENDSL                                                             BUG4051
      *                                                                                      BUG4051
0335 C**                                                                  RE0730
     C**                                                                  RE0730
     C**   CHECK IF STANDING ORDER IS ACROSS BRANCHES                     RE0730
     C  NU1      MBSI      COMP 'Y'                      70               RE0730
     C**                                                                  S01117
     C**  CHECK IF MAIN BRANCH ENTRIES ARE REQUIRED                       S01117
     C**                                                                  S01117
     C   70                DO                                             S01117
     C           GENB      IFEQ 'Y'                                       S01117
     C           MABR      ANDNEDRBR                                      S01117
     C           MABR      ANDNECBRC                                      S01117
     C                     SETON                     49                   S01117
     C                     END                                            S01117
     C                     END                                            S01117
0336 C**                                                                  RE0730
0337 C**   CHAIN TO CLINT FILE FOR DR CUSTOMER DETAILS                    RE0730
0338 C                     MOVELDCUS      CLIKEY                          RE0730
0339 C           CLIKEY    CHAINCLINT                41                   RE0730
     C*                                                                   E17948
     C* IF CUSTOMER DETAILS NOT FOUND, OUTPUT ERROR REPORT.               E17948
     C           *IN41     IFEQ '1'                                       E17948
     C           *IN12     OREQ '0'                                       E17948
     C                     MOVE '05'      DBASE            ***************E17948
     C                     MOVE 'CLINTCB' DBFILE           *   ERROR 05  *E17948
     C                     MOVE BLANKS    DBKEY            ***************E17948
     C                     MOVELCLIKEY    DBKEY                           E17948
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     END                                            E17948
0340 C   41                                                               RE0730
0341 CORN12                GOTO ERROR                                     RE0730
      *                                                                                       CRE013
      ** Initialise Rejection Code workfield                                                  CRE013
     C                     MOVE *BLANK    UGREJC 30                                           CRE013
0342 C**                                                                  RE0730
0343 C**   CHAIN TO ACCNT FILE FOR DR ACCOUNT DETAILS & TEST IF A/C OPEN  RE0730
0344 C                     MOVE DCUS      XCUS                            RE0730
0345 C***********          MOVE DACO      XACO                            S01117
0345 C                     MOVE DACD      XACO                            S01117
0346 C                     MOVE DACS      XACS                            RE0730
     C                     MOVE DRBR      XBRCD                           S01117
0347 C                     EXSR ACCCHN                                    RE0730
      *                                                                                       206632
     C**********           Z-ADD0         W0CNUM                                       206632 CSD027
     C                     MOVE *BLANKS   W0CNUM                                              CSD027
     C                     MOVE *BLANKS   W0CUCD                                              206632
     C                     Z-ADD0         W0ACCD                                              206632
     C                     Z-ADD0         W0ACSQ                                              206632
     C                     MOVE *BLANKS   W0BRCA                                              206632
     C                     MOVE XCUS      W0CNUM                                              206632
     C                     MOVE CCY       W0CUCD                                              206632
     C                     MOVE XACO      W0ACCD                                              206632
     C                     MOVE XACS      W0ACSQ                                              206632
     C                     MOVE XBRCD     W0BRCA                                              206632
     C                     MOVE CCY       RECCYD  3                                         AR858062
      *                                                                                       206632
0348 C   88                SETON                     42    REC NOT FOUND  RE0730
     C           CAP207    IFNE 'Y'                                                           CAP207
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN42     ANDEQ*ON                                                           CRE013
     C           UGREJC    CAT  '01':0    UGREJC                                              CRE013
     C                     ENDIF                                                              CRE013
0349 C  N88      RECID     COMP 'C'                      42A/C CLOSED     RE0730
     C  N88      CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN42     ANDEQ*ON                                                           CRE013
     C           UGREJC    CAT  '02':0    UGREJC                                              CRE013
     C                     ENDIF                                                              CRE013
     C                     ENDIF                                                              CAP207
0350 C  N88      ATYP      COMP 'R'                      22               RE0730
     C  N88 22             Z-ADDACNO      DRAN           60               080091
      *                                                                   CAC001
      **  If Analytical Accounting is installed and account is            CAC001
      **  retail or nostro, use profit centre of the account              CAC001
      *                                                                   CAC001
     C                     MOVE '0'       *IN66                           CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN42     ANDEQ'0'                                       CAC001
     C           ATYP      IFEQ 'R'                                       CAC001
     C           ATYP      OREQ 'N'                                       CAC001
     C                     MOVE '1'       *IN66                           CAC001
     C                     MOVE *BLANKS   PRFCD                           168936
     C                     MOVE PRFCA     PRFCD   4                       168936
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C**NU1***             MOVE ABRCD     DRBRCD  30                      S01117
0351 C                     MOVE ATYP      ATYPDR  1                       RE0730
 822 C*                                                                   S10736
0551 C*    ACCESS ACCOUNT CODES TABLE TO OBTAIN ACCOUNT SECTION           S10736
0551 C*                                                                   S10736
0345 C**********           MOVE DACD      ACODA   4                                    S10736 CGL029
     C                     MOVE DACD      ACODA  10                                           CGL029
     C                     CALL 'AOACODR0'                                S10736
     C                     PARM '*MSG   ' @RTCD   7                       S10736
     C                     PARM '*KEY   ' @OPTN   7                       S10736
     C**********           PARM ACODA     @AFNB   4                                    S10736 CGL029
     C                     PARM ACODA     @AFNB  10                                           CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S10736 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S10736
     C                     MOVEL@AFNB     DBKEY                           S10736
     C                     MOVEL'SDACODPD'DBFILE           ***************S10736
     C                     Z-ADD16        DBASE            * DBERROR 016 *S10736
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     SETON                     U7U8LR***************S10736
     C                     GOTO ERROR                                     S10736
     C                     END                                            S10736
     C                     MOVE ACSC      ASECDR  2                       S10736
      *                                                                                       CRE013
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           CAP207    OREQ 'Y'                                                           CAP207
     C                     EXSR PAYAMT                                                        CRE013
     C                     ENDIF                                                              CRE013
     C*                                                                   S01413
     C**    TEST IF ACCOUNT BLOCKED,BANKRUPT OR BAD DEBT -                S01413
     C**    SEND ENTRY TO SUSPENSE ACCOUNT                                S01413
     C********** *IN22     IFEQ '1'                                                   S01413 BUG9690
     C********** *IN42     ANDEQ'0'                                                   S01413 BUG9690
     C           *IN42     IFEQ '0'                                                          BUG9690
     C                     TESTB'2'       RETB           42BLOCK DEBITS   S01413
     C           *IN42     IFEQ '0'                                                         MD041832
     C           CAP207    IFEQ 'Y'                                                           CAP207
      ** Get today's available balance.                                                       CAP207
     C                     MOVE XACO      XXAC   100                                          CAP207
     C                     MOVE XACS      XXCS    20                                          CAP207
     C           KGLACT    KLIST                                                              CAP207
     C                     KFLD           XCUS                                                CAP207
     C                     KFLD           CCY                                                 CAP207
     C                     KFLD           XXAC                                                CAP207
     C                     KFLD           XXCS                                                CAP207
     C                     KFLD           XBRCD                                               CAP207
     C           KGLACT    CHAINGLACNTL3             90                                       CAP207
      ** Record Not Found                                                                     CAP207
     C           *IN90     IFEQ *OFF                                                          CAP207
     C           ATYP      ANDEQ'R'                                                        AR1070626
     C           F1IABC    ANDEQ'Y'                                                        AR1049898
     C**N42***** AMOUNT    COMP F1AVA1               42                              CAP207 AR782815
      *                                                                                     MD054019
      ** If the Next Payment Date is greater than Event Control Date,                       MD054019
      ** do not validate for available balance.                                             MD054019
     C********** EVTDAT    IFLE NXTP                                               MD054019 MD035074
     C           EVTDAT    IFGE NXTP                                                        MD035074
     C                     Z-SUBF1AVA1    WAVA1  150                                        AR782815
     C**N42***** AMOUNT    COMP WAVA1                42                            AR782815 MD050452
     C  N42      0         COMP WAVA1                42                                     MD050452
     C                     ENDIF                                                            MD054019
      *                                                                                     MD054019
      ** Insufficient                                                                         CAP207
     C           *IN42     IFEQ *ON                                                           CAP207
     C           UGREJC    CAT  '08':0    UGREJC                                              CAP207
     C                     ENDIF                                                              CAP207
     C                     ENDIF                                                              CAP207
     C                     ELSE                                                               CAP207
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN42     ANDEQ*ON                                                           CRE013
     C           UGREJC    CAT  '03':0    UGREJC                                              CRE013
     C                     GOTO INVDR                                                         CRE013
     C                     ENDIF                                                              CRE013
     C  N42                TESTB'6'       RETB           42BANKRUPT/LIQ.  S01413
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN42     ANDEQ*ON                                                           CRE013
     C           UGREJC    CAT  '04':0    UGREJC                                              CRE013
     C                     GOTO INVDR                                                         CRE013
     C                     ENDIF                                                              CRE013
     C  N42                TESTB'7'       RETB           42BAD DEBT       S01413
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN42     IFEQ *ON                                                           CRE013
     C           UGREJC    CAT  '05':0    UGREJC                                              CRE013
     C                     GOTO INVDR                                                         CRE013
     C                     ENDIF                                                              CRE013
     C  N42                TESTB'4'       RETB           42 INACTIVE                          CRE013
     C           *IN42     IFEQ *ON                                                           CRE013
     C           UGREJC    CAT  '06':0    UGREJC                                              CRE013
     C                     GOTO INVDR                                                         CRE013
     C                     ENDIF                                                              CRE013
     C  N42                TESTB'0'       RETB           42 REFER DEBIT                       CRE013
     C           *IN42     IFEQ *ON                                                           CRE013
     C           UGREJC    CAT  '07':0    UGREJC                                              CRE013
     C                     GOTO INVDR                                                         CRE013
     C                     ENDIF                                                              CRE013
      *                                                                                     MD054019
      ** If the Next Payment Date is greater than Event Control Date,                       MD054019
      ** do not validate for available balance.                                             MD054019
     C********** EVTDAT    IFLE NXTP                                               MD054019 MD035074
     C           EVTDAT    IFGE NXTP                                                        MD035074
     C  N42                Z-SUBCLBL      UGCLBL 150                                          CRE013
     C**N42***** UGCLBL    ADD  ODLN      ABAL   150                                 CRE013 AR858062
     C                     Z-ADD0         ABAL   150                                        AR858062
     C  N42      ODED      COMP BJRDNB               37  37                                 AR858062
     C  N42 37             EXSR ODCONV                                                      AR858062
     C  N42 37   UGCLBL    ADD  ZAMTCO    ABAL                                              AR858062
     C  N42N37             ADD  UGCLBL    ABAL                                              AR858062
     C  N42      ABAL      SUB  HELD      ABAL                                                CRE013
     C  N42      ABAL      COMP AMOUNT                 42   INSUFFICIENT                      CRE013
     C                     ENDIF                                                            MD054019
     C           *IN42     IFEQ *ON                                                           CRE013
     C           UGREJC    CAT  '08':0    UGREJC                                              CRE013
     C                     ENDIF                                                              CRE013
     C                     ENDIF                                                              CRE013
     C                     ENDIF                                                              CAP207
     C                     MOVE 'N'       DBLK    1                                         MD041832
     C                     ELSE                                                             MD041832
     C                     MOVE 'Y'       DBLK                                              MD041832
     C                     ENDIF                                                            MD041832
     C                     END                                            S01413
      *                                                                                       CRE013
     C           INVDR     TAG                                                                CRE013
     C/COPY WNCPYSRC,RE0730C001
0352 C**                                                                  RE0730
0353 C**   IF RUNNING OPTION 2 SAVE RRN OF MEMO RECORD FOR LATER UPDATE.  RE0730
0354 C***U1******          Z-ADDRRNM      RRNMDR  50                RE0730CCB002
     C           *INU1     IFEQ *ON                                       CCB002
     C           *LIKE     DEFN ACNO      UDACNO                          CCB002
     C                     Z-ADDACNO      UDACNO                          CCB002
     C                     ENDIF                                          CCB002
0355 C**                                                                  RE0730
0356 C**   CHAIN TO ACCNT FILE FOR CR ACCOUNT DETAILS & TEST IF A/C OPEN. RE0730
0357 C                     MOVE CCUS      XCUS                            RE0730
0358 C***********          MOVE CACO      XACO                            S01117
0358 C                     MOVE CSCA      XACO                            S01117
0359 C***********          MOVE CACS      XACS                            S01117
0359 C                     MOVE CACD      XACS                            S01117
     C                     MOVE CBRC      XBRCD                           S01117
0360 C                     EXSR ACCCHN                                    RE0730
      *                                                                                       206632
     C**********           Z-ADD0         W0CNUM                                       206632 CSD027
     C                     MOVE *BLANKS   W0CNUM                                              CSD027
     C                     MOVE *BLANKS   W0CUCD                                              206632
     C                     Z-ADD0         W0ACCD                                              206632
     C                     Z-ADD0         W0ACSQ                                              206632
     C                     MOVE *BLANKS   W0BRCA                                              206632
     C                     MOVE XCUS      W0CNUM                                              206632
     C                     MOVE CCY       W0CUCD                                              206632
     C                     MOVE XACO      W0ACCD                                              206632
     C                     MOVE XACS      W0ACSQ                                              206632
     C                     MOVE XBRCD     W0BRCA                                              206632
      *                                                                                       206632
0361 C   88                SETON                     43    REC NOT FOUND  RE0730
     C           CAP207    IFNE 'Y'                                                           CAP207
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN43     ANDEQ*ON                                                           CRE013
     C           UGREJC    CAT  '09':0    UGREJC                                              CRE013
     C                     ENDIF                                                              CRE013
0362 C  N88      RECID     COMP 'C'                      43A/C CLOSED     RE0730
     C  N88      CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN43     ANDEQ*ON                                                           CRE013
     C           UGREJC    CAT  '10':0    UGREJC                                              CRE013
     C                     ENDIF                                                              CRE013
     C                     ENDIF                                                              CAP207
0363 C  N88      ATYP      COMP 'R'                      23               RE0730
     C  N88 23             MOVE ACNO      CRAN           61               080091
0364 C                     MOVE ATYP      ATYPCR  1                       RE0730
      *                                                                   CRE009
      ** If none of the accounts are RE and the Next payment date is not  CRE009
      ** greater than the run date & program running in shadow post mode  CRE009
      ** end processing for the record.                                   CRE009
      *                                                                   CRE009
     C           *INU1     IFEQ '1'                                       CRE009
     C           CRE009    ANDEQ'Y'                                       CRE009
     C           ATYPCR    ANDNE'R'                                       CRE009
     C           ATYPDR    ANDNE'R'                                       CRE009
     C           NXTP      IFGT RUND                                      CRE009
     C                     GOTO END                                       CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CRE009
      *                                                                   CAC001
      **  If Analytical Accounting is installed and account is            CAC001
      **  retail or nostro, use profit centre of the account              CAC001
      *                                                                   CAC001
     C                     MOVE '0'       *IN67                           CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN43     ANDEQ'0'                                       CAC001
     C           ATYP      IFEQ 'R'                                       CAC001
     C           ATYP      OREQ 'N'                                       CAC001
     C                     MOVE '1'       *IN67                           CAC001
     C                     MOVE *BLANKS   PRFCC                           168936
     C                     MOVE PRFCA     PRFCC   4                       168936
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C**                                                                  S01413
     C**    TEST IF ACCOUNT BLOCKED,BANKRUPT OR BAD DEBT -                S01413
     C**    SEND ENTRY TO SUSPENSE ACCOUNT                                S01413
     C********** *IN22     IFEQ '1'                                S01413 047906
     C********** *IN23     IFEQ '1'                                                   047906 BUG9690
     C********** *IN43     ANDEQ'0'                                                   S01413 BUG9690
     C           *IN43     IFEQ '0'                                                          BUG9690
     C                     TESTB'3'       RETB           43BLOCK CREDIT   S01413
     C           CAP207    IFNE 'Y'                                                           CAP207
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN43     ANDEQ*ON                                                           CRE013
     C           UGREJC    CAT  '11':0    UGREJC                                              CRE013
     C                     GOTO INVCR                                                         CRE013
     C                     ENDIF                                                              CRE013
     C  N43                TESTB'6'       RETB           43BANKRUPT/LIQ.  S01413
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN43     ANDEQ*ON                                                           CRE013
     C           UGREJC    CAT  '12':0    UGREJC                                              CRE013
     C                     GOTO INVCR                                                         CRE013
     C                     ENDIF                                                              CRE013
     C  N43                TESTB'7'       RETB           43BAD DEBT       S01413
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN43     IFEQ *ON                                                           CRE013
     C           UGREJC    CAT  '13':0    UGREJC                                              CRE013
     C                     GOTO INVCR                                                         CRE013
     C                     ENDIF                                                              CRE013
     C  N43                TESTB'4'       RETB           43 INACTIVE                          CRE013
     C           *IN43     IFEQ *ON                                                           CRE013
     C           UGREJC    CAT  '14':0    UGREJC                                              CRE013
     C                     GOTO INVCR                                                         CRE013
     C                     ENDIF                                                              CRE013
     C  N43                TESTB'1'       RETB           43 REFER CREDIT                      CRE013
     C           *IN43     IFEQ *ON                                                           CRE013
     C           UGREJC    CAT  '15':0    UGREJC                                              CRE013
     C                     ENDIF                                                              CRE013
     C                     ENDIF                                                              CRE013
     C                     ENDIF                                                              CAP207
     C                     END                                            S01413
      *                                                                                       CRE013
     C           INVCR     TAG                                                                CRE013
     C/COPY WNCPYSRC,RE0730C002
 822 C*                                                                   S10736
0551 C*    ACCESS ACCOUNT CODES TABLE TO OBTAIN ACCOUNT SECTION           S10736
0551 C*                                                                   S10736
0345 C                     MOVE CSCA      ACODA                           S10736
     C                     CALL 'AOACODR0'                                S10736
     C                     PARM '*MSG   ' @RTCD   7                       S10736
     C                     PARM '*KEY   ' @OPTN   7                       S10736
     C**********           PARM ACODA     @AFNB   4                                    S10736 CGL029
     C                     PARM ACODA     @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S10736 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S10736
     C                     MOVEL@AFNB     DBKEY                           S10736
     C                     MOVEL'SDACODPD'DBFILE           ***************S10736
     C                     Z-ADD17        DBASE            * DBERROR 017 *S10736
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     SETON                     U7U8LR***************S10736
     C                     GOTO ERROR                                     S10736
     C                     END                                            S10736
     C                     MOVE ACSC      ASECCR  2                       S10736
     C**NU1***             MOVE ABRCD     CRBRCD  30                      S01117
0365 C***U1***             Z-ADDRRNM      RRNMCR  50                RE0730CCB002
     C           *INU1     IFEQ *ON                                       CCB002
     C           *LIKE     DEFN ACNO      UCACNO                          CCB002
     C                     Z-ADDACNO      UCACNO                          CCB002
     C                     ENDIF                                          CCB002
0366 C***********                                                         S01117
     C******FIND*DR AND CR BRANCH CODES AND BR. INT. CUST. NOS.           S01117
     C*****ACCOUNT FOUND                                                  S01117
     C***70NU1***          DO                                             S01117
     C***********          MOVE '     '   TABKEY                          S01117
     C***********          MOVEL'10'      TABKEY                          S01117
     C***********          MOVEL' '       KEY     3                       S01117
     C***********          MOVE DRBRCD    KEY                             S01117
     C***********          MOVE KEY       TABKEY                          S01117
     C***********                                                         S01117
     C***********TABKEY****CHAINTABLE****************47*******************E17948
     C***********TABKEY    CHAINTABLE                49             E17948S01117
     C***********          MOVE BICN      DRBICN  60                      S01117
     C***********          MOVE IBAB      DRIBAB  40                      S01117
     C***********          MOVE IBAH      DRIBAH  40                      S01117
     C***********                                                         S01117
     C***********          MOVE CRBRCD    KEY                             S01117
     C***********          MOVE KEY       TABKEY                          S01117
     C***********                                                         S01117
     C***********TABKEY****CHAINTABLE****************47*******************E17948
     C***********TABKEY    CHAINTABLE                49             E17948S01117
     C***********          MOVE BICN      CRBICN  60                      S01117
     C***********          MOVE IBAB      CRIBAB  40                      S01117
     C***********          MOVE IBAH      CRIBAH  40                      S01117
     C***********                                                         S01117
     C****FIND*OUT WHICH BRANCH CODE (DR OR CR) = BRCD                    S01117
     C***********          SETOF                     7172                 S01117
     C***********DRBRCD    COMP BRCD                     71               S01117
     C**N71******          SETON                     72                   S01117
     C***********                                                         S01117
     C***********          END                                            S01117
     C***********                                                         S01117
0211 C*                                                                   S01117
0238 C*   A/C BRANCH ACCESS BRANCH CODE ARRAY FOR DR BRANCH               S01117
0211 C*                                                                   S01117
     C                     SETOF                         10               S01117
     C                     Z-ADDSTIX      IX                              S01117
0556 C           DRBR      LOKUPBCC,IX                   10               S01117
0556 C   10                MOVE BCT,IX    DBCI                            S01117
0211 C*                                                                   S01117
0238 C*   A/C BRANCH ACCESS BRANCH CODE ARRAY FOR CR BRANCH               S01117
0211 C*       IF MULTIBRANCH                                              S01117
0211 C*                                                                   S01117
     C   70                DO                                             S01117
     C                     SETOF                         10               S01117
     C                     Z-ADDSTIX      IX                              S01117
0556 C           CBRC      LOKUPBCC,IX                   10               S01117
0556 C   10                MOVE BCT,IX    CBCI                            S01117
     C                     END                                            S01117
0211 C*                                                                   S01117
     C** Validate transaction type if SAR 01466 is switched ON            S01466
     C*                                                                   S01466
     C           S01466    IFEQ 'Y'                                       S01466
     C                     MOVE *BLANKS   W0TRAT  5                       S01466
     C                     CALL 'AORETRR0'                                S01466
     C                     PARM *BLANKS   W0RTCD                          S01466
     C                     PARM '*KEY   ' W0OPTN                          S01466
     C                     PARM TRAT      W0TRAT                          S01466
     C           SDRETR    PARM SDRETR    DSFDY                           S01466
     C*                                                                   S01466
     C           W0RTCD    IFNE *BLANKS                                   S01466
     C                     MOVEL'RE0730 ' DBPGM                           S01466
     C                     MOVEL'SDRETRPD'DBFILE           ************   S01466
     C                     MOVELTRAT      DBKEY            * DBERR 18 *   S01466
     C                     Z-ADD18        DBASE            ************   S01466
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     EXSR *PSSR                                     S01466
     C                     SETON                     U7U8LR               S01466
     C                     GOTO ERROR                                     S01466
     C                     END                                            S01466
     C*                                                                   S01466
     C**  If SAR is switched OFF, transaction type is equal to '91000'    S01466
     C*                                                                   S01466
     C                     ELSE                                           S01466
     C                     MOVEL'91000'   TRAT                            S01466
     C                     END                                            S01466
      *                                                                                       CRE013
      ** If Report of Failed Standing Orders is on and                                        CRE013
      ** Debit or Credit UNPOSTABLE,                                                          CRE013
      **   OUTPUT to RESTORPD & DO NOT generate postings                                      CRE013
     C           CRE013    IFEQ 'Y'                                                           CRE013
     C           *IN42     ANDEQ*ON                                                           CRE013
     C           CRE013    OREQ 'Y'                                                           CRE013
     C           *IN43     ANDEQ*ON                                                           CRE013
     C           CAP207    OREQ 'Y'                                                           CAP207
     C           *IN42     ANDEQ*ON                                                           CAP207
     C           DBLK      ANDNE'Y'                                                         MD041832
     C                     EXSR SRSTOR                                                        CRE013
     C  NU1                GOTO USTAND                                                        CRE013
     C   U1                GOTO CMEM                                                          CRE013
     C                     ENDIF                                                              CRE013
0211 C*                                                                   S01117
0367 C   U1                GOTO OPTN2                                     RE0730
0368 C**   MAIN PROCESSING FLOW FOR OPTION 1                              RE0730
0369 C**                                                                  RE0730
0370 C**                1 GENERATE ENTRIES TO GESO                        RE0730
0371 C**                2 UPDATE STAND                                    RE0730
0372 C**                3 IF CALCULATED NEXT PAYMENT DATE NOT LESS THAN   RE0730
0373 C**                  RUND REPEAT STEPS 1 & 2                         RE0730
0374 C**                4 DELETE S/O IF NXTP WAS NOT LESS THAN DLPY &     RE0730
0375 C**                  WRITE EXPIRED RECORD TO REPORT                  RE0730
0376 C**                                                                  RE0730
0377 C**   GENERATE ENTRIES TO GESO                                       RE0730
     C/COPY WNCPYSRC,RE0730C003
0378 C                     EXSR GENRTE                                    RE0730
0379 C   56                GOTO ERROR                                     RE0730
0380 C           GENGE     TAG                             **  GENGE  **  RE0730
     C/COPY WNCPYSRC,RE0730C006
0381 C                     EXSR PAYAMT                                    RE0730
0382 C                     EXSR OUTPUT                                    RE0730
     C/COPY WNCPYSRC,RE0730C014
     C   70                DO                                             RE0730
     C*    EXTRA HASH TOTALLING FOR CROSS BRANCH POSTING                  RE0730
     C*    ALSO FOR MAIN BRANCH ENTRIES IN CASE THEY ARE REQUIRED         S01117
0648 C           GESON     ADD  2         GESON                           RE0730
     C   49      GESON     ADD  2         GESON                           S01117
0651 C                     Z-ADDHASHI     ZZTOTI                          RE0730
0652 C                     Z-ADDHASHD     ZZTOTD                          RE0730
0653 C***********          MOVE AMOUNT    ZZAMT                           S01117
     C  N49      AMOUNT    MULT 2         NUM14  140                      S01117
     C   49      AMOUNT    MULT 4         NUM14                           S01117
     C                     MOVE NUM14     ZZAMT                           S01117
0654 C           ZZAMT     COMP 0                      54                 RE0730
0655 C   54                Z-SUBZZAMT     ZZAMT                           RE0730
0656 C                     SETOF                     54                   RE0730
0657 C                     EXSR GLZADD                                    RE0730
0658 C***********          EXSR GLZADD                                    S01117
0659 C                     Z-ADDZZTOTI    HASHI                           RE0730
0660 C                     Z-ADDZZTOTD    HASHD                           RE0730
0661 C                     END                                            RE0730
     C/COPY WNCPYSRC,RE0730C007
      *                                                                                       CRE013
     C           USTAND    TAG                                                                CRE013
0383 C**                                                                  RE0730
0384 C**   UPDATE STAND FILE.                                             RE0730
0385 C*    IF LAST PAYMENT HAS BEEN MADE , DELETE STANDING ORDER          RE0730
0386 C********** RUND      COMP DLPY                 48  48        RE0730 209995
     C           NXTP      IFGE DLPY                                      209995
     C                     MOVE *ON       *IN48                           209995
     C                     ENDIF                                          209995
      *                                                                   209995
0387 C   48                GOTO EXPIRE                                    RE0730
0388 C* UPDATE DATE LAST MOVEMENT WITH NEXT PAYMENT DATE                  RE0730
0389 C*                                                                   RE0730
0390 C                     MOVE NXTP      DLMVO   50                      RE0730
0391 C*                                                                   RE0730
0392 C*                                                                   RE0730
0393 C* IF NEXT PAYMENT DATE IS LESS THAN 2ND PAYMENT DATE                RE0730
0394 C****DATE NEXT PAYMENT DATE WITH 2ND PAYMENT DATE                    RE0730
0395 C* UPDATE NEW NEXT PAYMENT DATE (NXTPO) WITH 2ND PAYMENT DATE.       RE0730
0396 C                     SETOF                     45                   RE0730
0397 C*                                                                   RE0730
0398 C           NXTP      COMP DSPY                   45                 RE0730
0399 C   45                MOVE DSPY      NXTPO   50                      RE0730
0400 C**                                                                  RE0730
0401 C**   OTHERWISE CALCULATE NEXT PAYMENT DATE USING ZEREQ.             RE0730
0402 C  N45                EXSR FREAK                                     RE0730
0403 C  N45                MOVE ZDAYNO    NXTPO                           RE0730
     C**                                                                  E14458
     C**   IF PAYMENT FREQUENCY IS ON ACCRUAL DATE AND IF THIS DATE IS    E14458
     C**   NOT GREATER THAN RUN DATE,THEN DETERMINE THE NEXT ACCRUAL DATE.E14458
     C**                                                                  E14458
     C           PAYF      IFEQ 'A'                                       E14458
     C           NXTPO     IFLE RUND                                      E14458
     C                     MOVE APFQ      ZFREQ                           E14458
     C                     MOVE LOCY      ZCCY                            E14458
     C                     MOVE FDAY      ZMDAY                           E14458
     C                     MOVE APDA      ZDAYNO                          E14458
     C                     MOVE *BLANKS   ZLOC                            S01195
     C***********          EXSR QZFREQ                              E14458S01195
     C                     EXSR FREQ                                      S01195
     C                     MOVE ZDAYNO    NXTPO                           E14458
     C                     END                                            E14458
     C                     END                                            E14458
0404 C**                                                                  RE0730
0405 C**   IF CALCULATED NEXT PAY. DATE IS GREATER THAN DLPY, REPLACE     RE0730
0406 C**   NEXT PAY. DATE WITH FINAL PAY. DATE                            RE0730
0407 C**   IF FINAL PAYMENT DATE (DLPY) NOT ENTERED - DEFAULT = 99999.    RE0730
0408 C           NXTPO     COMP DLPY                 47  47               RE0730
0409 C   47                MOVE DLPY      NXTPO                           RE0730
0410 C**                                                                  RE0730
0411 C**   IF UPDATED NEXT PAY. DATE IS NOT GREATER THAN RUND.            RE0730
0412 C**   REPEAT GENERATION OF ENTRIES TO GESO & UPDATING OF STAND.      RE0730
0413 C           NXTPO     COMP RUND                   4646               RE0730
0414 C   46                MOVE NXTPO     NXTP                            RE0730
0415 C   46                MOVE DLMVO     DLMV                            RE0730
0416 C   46                GOTO GENGE                                     RE0730
0417 C                     EXSR STUP                                      RE0730
0418 C                     GOTO END                                       RE0730
0419 C**   ACCUMULATE COUNT & VALUE OF EXPIRED S/O.                       RE0730
0420 C           EXPIRE    TAG                             *EXPIRE* TAG   RE0730
     C  N35                SETON                     3435                 S01117
     C           *IN34     IFEQ '1'                                       S01117
     C                     OPEN RE0730P1                                  S01117
     C**                                                                  S01117
     C** INDICATE THAT THE P1 FILE HAS BEEN OPENED                        S01117
     C                     SETON                     75                   S01117
     C                     Z-ADD0         PAGE                            S01117
     C**                                                                  S01117
     C** ENSURE REPORT SPOOL FILE RECORDED BY RCF                         S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C                     OUT  LDA                                       S01117
     C*                                                                   S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM TXBRCA    SENTY   3                       S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7LR                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C**                                                                  S01117
     C** GET BRANCH NAME (IN BRNM)                                        S01117
     C**                                                                  S01117
     C                     SETOF                         10               S01117
     C                     Z-ADDSTIX      IX                              S01117
     C           TXBRCA    LOKUPBCC,IX                   10               S01117
     C   10                MOVE BCT,IX    TBCI                            S01117
     C  N10                DO                                             S01117
     C                     MOVELTXBRCA    DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD12        DBASE            * DBERROR 012 *S01117
     C**********           MOVEL@OPTN     DBOPTN  7        *********S01117LN0153
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     GOTO ERROR                                     S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C                     END                                            S01117
     C**                                                                  S01117
0421 C********** NDELS     ADD  1         NDELS   30                                   RE0730 255449
0421 C           NDELS     ADD  1         NDELS   50                                          255449
0422 C**                                                                  RE0730
0423 C                     MOVE VDELI     ZZTOTI                          RE0730
0424 C                     MOVE VDELD     ZZTOTD                          RE0730
0425 C                     EXSR HASH                                      RE0730
0426 C                     MOVE ZZTOTI    VDELI  150                      RE0730
0427 C                     MOVE ZZTOTD    VDELD   30                      RE0730
0428 C                     EXSR STUP                                      RE0730
0429 C                     GOTO END                                       RE0730
0430 C**                                                                  RE0730
0431 C**   END OF DETAIL PROCESSING FOR OPTION 1                          RE0730
0432 C**                                                                  RE0730
0433 C**   PROCESSING FOR OPTION 2.                                       RE0730
0434 C**                                                                  RE0730
0435 C**   UPDATE MEMO FILE FOR RETAIL POSTINGS.                          RE0730
0436 C**                                                                  RE0730
0437 C           OPTN2     TAG                             **  OPTN2  **  RE0730
0438 C   02      RECD      COMP '*'                      30               RE0730
0439 C   30                GOTO END                                       RE0730
0440 C                     SETOF                     4419                 RE0730
0441 C                     SETOF                     454647               RE0730
     C/COPY WNCPYSRC,RE0730C004
0442 C                     EXSR PAYAMT                                    RE0730
     C/COPY WNCPYSRC,RE0730C008
0436 C*                                                                   S01154
0436 C** UPDATE RSACMTPD FIELDS WHICH ARE THE SAME FOR DR & CR            S01154
0436 C*                                                                   S01154
0436 C                     MOVE CCY       CCYD                            S01154
0436  *                                                                   CRE009
0436  ** If CRE009 is ON, set value date & posting date to payment date   CRE009
0436  *                                                                   CRE009
     C           *INU1     IFEQ *ON                                       CRE009
     C           CRE009    ANDEQ'Y'                                       CRE009
     C                     MOVE NXTP      VUDT                            CRE009
     C           NXTP      IFLT RUND                                      CRE009
     C                     MOVE RUND      PTDT                            CRE009
     C                     ELSE                                           CRE009
     C                     MOVE VUDT      PTDT                            CRE009
     C                     ENDIF                                          CRE009
     C                     ELSE                                           CRE009
0436 C                     MOVE RUND      PTDT                            S01154
0436 C                     MOVE RUND      VUDT                            S01154
     C                     ENDIF                                          CRE009
0436 C                     MOVE 'SO'      TRYP                            S01154
     C           CAP205    IFEQ 'Y'                                                          CAP205
     C                     MOVEL'RE'      CMOD                                               CAP205
     C                     MOVEL'F'       MTYP                                               CAP205
     C                     ELSE                                                              CAP205
     C                     MOVEL*BLANKS   CMOD                                               CAP205
     C                     MOVEL*BLANKS   MTYP                                               CAP205
     C                     ENDIF                                                             CAP205
0436 C                     MOVE STOR      TNMR                            S01154
0436 C                     MOVE AMOUNT    MVAM                            S01154
0436 C                     Z-ADD0         CQNR                            S01154
0443 C                     MOVELPNAR      NRTD                            109434
      *                                                                                       CRE020
     C           CRE020    IFEQ 'Y'                                                           CRE020
     C           RECI      ANDEQ'D'                                                           CRE020
     C                     MOVE 'R '      NRTD                                                CRE020
     C                     ENDIF                                                              CRE020
0436 C*                                                                   S01154
0436 C*                                                                   S01154
0443 C   43                GOTO DMEM                                      RE0730
0444 C**   UPDATE SHADOW BALANCE OF CR ACCOUNT.                           RE0730
0445 C  N23                GOTO DMEM                                      RE0730
0446 C***********          MOVE RRNMCR    RRNUM   50                RE0730CCB002
     C                     Z-ADDUCACNO    W0RETL                          CCB002
0447 C***********          EXSR MEMCHN                              RE0730CCB002
     C*                                                                   E17948
     C* IF SHADOW CREDIT ACCOUNT NOT FOUND, OUTPUT ERROR REPORT.          E17948
     C************IN87     IFEQ '1'                                 E17948CCB002
     C************IN14     OREQ '0'                                 E17948CCB002
     C***********          MOVE '09'      DBASE            *********E17948CCB002
     C***********          MOVE 'MEMOS  ' DBFILE           *ERROR 09E17948CCB002
     C***********          MOVE BLANKS    DBKEY            *********E17948CCB002
     C***********          MOVELRRNUM     DBKEY                     E17948CCB002
     C***********          END                                      E17948CCB002
0448 C***87******                                                   RE0730CCB002
0449 C*ORN14*****           GOTO ERROR                              RE0730CCB002
0450 C***********GRBL      SUB  AMOUNT    GRBLO  150                RE0730CCB002
0451 C***********NETB      SUB  AMOUNT    NETBO  150                RE0730CCB002
     C                     Z-SUBAMOUNT    W0AMT                           CCB002
      *                                                                   CRE009
      ** Only update MEMOS is payment date is less or equal to the run    CRE009
      ** date                                                             CRE009
     C           CRE009    IFNE 'Y'                                                         AR799642
     C           *INU1     IFEQ '1'                                       209995
     C           *IN88     ANDEQ'0'                                       209995
     C           *IN23     ANDEQ'1'                                       209995
     C                     EXSR UPDMEM                                    CCB002
     C                     ENDIF                                                            AR799642
     C                     ELSE                                           209995
      *                                                                   CRE009
     C           *INU1     IFEQ *ON                                       CRE009
     C           CRE009    ANDEQ'Y'                                       CRE009
     C           *IN88     ANDEQ'0'                                                         AR799642
     C           *IN23     ANDEQ'1'                                                         AR799642
     C           NXTP      IFLE RUND                                      CRE009
     C                     EXSR UPDMEM                                    CCB002
     C                     ELSE                                           CRE009
     C                     MOVE *ON       *IN14                           CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          209995
0436 C*                                                                   S01154
0436 C** UPDATE RSACMTPD CREDIT FIELDS                                    S01154
0436 C*                                                                   S01154
0436 C                     MOVE CCUS      CUSN                            S01154
0436 C***********          MOVE CACO      ACDE                      S01154S01117
0436 C                     MOVE CSCA      ACDE                            S01117
0436 C***********          MOVE CACS      ASNC                      S01154S01117
0436 C                     MOVE CACD      ASNC                            S01117
0436 C                     MOVE CBRC      BRCA                            S01117
0436 C                     Z-ADD1         DORC                            S01154
     C/COPY WNCPYSRC,RE0730C015
     C*                                                                   S01522
0452 C                     SETON                     16                   RE0730
     C                     SETON                     25                   209995
0453 C                     EXCPT                                          RE0730
     C*                                                                   S01154
0454 C           DMEM      TAG                             ** DMEM TAG ** RE0730
0455 C   42                GOTO CMEM                                      RE0730
0456 C  N22                GOTO CMEM                                      RE0730
     C*                                                                   S01154
0457 C**   UPDATE SHADOW BALANCE OF DR ACCOUNT                            RE0730
0458 C***********          Z-ADDRRNMDR    RRNUM                     RE0730CCB002
     C                     Z-ADDUDACNO    W0RETL                          CCB002
0459 C***********          EXSR MEMCHN                              RE0730CCB002
     C***********                                                   E17948CCB002
     C**IF*SHADOW DEBIT ACCOUNT NOT FOUND, OUTPUT ERROR REPORT.     E17948CCB002
     C************IN87     IFEQ '1'                                 E17948CCB002
     C************IN14     OREQ '0'                                 E17948CCB002
     C***********          MOVE '10'      DBASE            *********E17948CCB002
     C***********          MOVE 'MEMOS  ' DBFILE           *ERROR10 E17948CCB002
     C***********          MOVE BLANKS    DBKEY            *********E17948CCB002
     C***********          MOVELRRNUM     DBKEY                     E17948CCB002
     C***********          END                                      E17948CCB002
0460 C***87******                                                   RE0730CCB002
0461 C*ORN14*****           GOTO ERROR                              RE0730CCB002
0462 C***********GRBL      ADD  AMOUNT    GRBLO                     RE0730CCB002
0463 C***********NETB      ADD  AMOUNT    NETBO                     RE0730CCB002
     C                     Z-ADDAMOUNT    W0AMT                           CCB002
      *                                                                                     AR799642
     C                     MOVE *BLANKS   W0CNUM                                            AR799642
     C                     MOVE *BLANKS   W0CUCD                                            AR799642
     C                     Z-ADD0         W0ACCD                                            AR799642
     C                     Z-ADD0         W0ACSQ                                            AR799642
     C                     MOVE *BLANKS   W0BRCA                                            AR799642
     C                     MOVE DCUS      W0CNUM                                            AR799642
     C                     MOVE CCY       W0CUCD                                            AR799642
     C                     MOVE DACD      W0ACCD                                            AR799642
     C                     MOVE DACS      W0ACSQ                                            AR799642
     C                     MOVE DRBR      W0BRCA                                            AR799642
      *                                                                   CRE009
      ** Only update MEMOS is payment date is less or equal to the run    CRE009
      ** date                                                             CRE009
     C           CRE009    IFNE 'Y'                                                         AR799642
     C           *INU1     IFEQ '1'                                       209995
     C           *IN88     ANDEQ'0'                                       209995
     C           *IN22     ANDEQ'1'                                       209995
     C                     EXSR UPDMEM                                                       BUG9063
     C                     ENDIF                                                            AR799642
     C                     ELSE                                           209995
      *                                                                   CRE009
     C           *INU1     IFEQ *ON                                       CRE009
     C           CRE009    ANDEQ'Y'                                       CRE009
     C           NXTP      IFLE RUND                                      CRE009
     C           *IN88     ANDEQ'0'                                                         AR799642
     C           *IN22     ANDEQ'1'                                                         AR799642
     C                     EXSR UPDMEM                                    CCB002
     C                     ELSE                                           CRE009
     C                     MOVE *ON       *IN14                           CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          CRE009
     C                     ENDIF                                          209995
0436 C*                                                                   S01154
0436 C** UPDATE RSACMTPD DEBIT FIELDS                                     S01154
0436 C*                                                                   S01154
0436 C                     MOVE DCUS      CUSN                            S01154
0436 C***********          MOVE DACO      ACDE                      S01154S01117
0436 C                     MOVE DACD      ACDE                            S01117
0436 C                     MOVE DACS      ASNC                            S01154
0436 C                     MOVE DRBR      BRCA                            S01117
0436 C                     Z-ADD0         DORC                            S01154
     C/COPY WNCPYSRC,RE0730C016
0436 C*                                                                   S01154
0464 C                     SETON                     16                   RE0730
     C                     SETOF                     25                   209995
0465 C                     EXCPT                                          RE0730
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0730CCPG                                           S01408
     C*                                                                   S01408
0466 C           CMEM      TAG                             ** CMEM TAG ** RE0730
0467 C                     SETOF                     16                   RE0730
0468 C                     SETON                     44                   RE0730
0469 C                     EXSR OUTPUT                                    RE0730
     C**                                                                  RE0730
     C*****IF POSTING*IS*ACROSS*BRANCHES*HASH*RELEVENT*AMOUNT*OF*EXTRA**  RE0730
     C********POSTINGS***                                                 RE0730
     C***70                EXSR OUTPUT                                    RE0730
     C**                                                                  RE0730
0470 C* IF NEXT PAYMENT = LAST PAYMENT EXIT                               RE0730
0471 C           NXTP      COMP DLPY                     19               RE0730
0472 C   19                GOTO END                                       RE0730
0473 C**                                                                  RE0730
0474 C**   CALCULATE NEXT PAYMENT DATE.                                   RE0730
0475 C*    IF NEXT PAY DATE LESS THAN 2ND PAY DATE, UPDATE NXTP WITH DSPY RE0730
0476 C*                                                                   RE0730
0477 C                     SETOF                     45                   RE0730
0478 C           NXTP      COMP DSPY                   45                 RE0730
0479 C   45                MOVE DSPY      NXTPO                           RE0730
0480 C**                                                                  RE0730
0481 C*****OTHERWISE CALCULATE NEXT PAYMENT DATE USING QZFREQ.            S01195
0481 C**   OTHERWISE CALCULATE NEXT PAYMENT DATE USING FREQ.              S01195
0482 C  N45                EXSR FREAK                                     RE0730
0483 C  N45                MOVE ZDAYNO    NXTPO                           RE0730
     C**                                                                  E14458
     C**   IF PAYMENT FREQUENCY IS ON ACCRUAL DATE AND IF THIS DATE IS    E14458
     C**   NOT GREATER THAN RUN DATE,THEN DETERMINE THE NEXT ACCRUAL DATE.E14458
     C**                                                                  E14458
     C           PAYF      IFEQ 'A'                                       E14458
     C           NXTPO     IFLE RUND                                      E14458
     C                     MOVE APFQ      ZFREQ                           E14458
     C                     MOVE LOCY      ZCCY                            E14458
     C                     MOVE FDAY      ZMDAY                           E14458
     C                     MOVE APDA      ZDAYNO                          E14458
     C                     MOVE *BLANKS   ZLOC                            S01195
     C***********          EXSR QZFREQ                              E14458S01195
     C                     EXSR FREQ                                      S01195
     C                     MOVE ZDAYNO    NXTPO                           E14458
     C                     END                                            E14458
     C                     END                                            E14458
0484 C**                                                                  RE0730
0485 C**   IF CALCULATED NEXT PAY. DATE IS GREATER THAN DLPY, REPLACE     RE0730
0486 C**   NEXT PAY. DATE WITH FINAL PAY. DATE                            RE0730
0487 C           NXTPO     COMP DLPY                 47  47               RE0730
0488 C   47                MOVE DLPY      NXTPO                           RE0730
0489 C**                                                                  RE0730
0490 C**   IF UPDATED NEXT PAY. DATE IS NOT GREATER THAN RUND,            RE0730
0491 C**   REPEAT GENERATION OF RECORDS TO SOEX & UPDATING OF NXTP.       RE0730
     C           *INU1     IFEQ *ON                                       CRE009
     C           CRE009    ANDEQ'Y'                                       CRE009
     C           PAYF      ANDNE'A'                                                         BUG27129
0492 C           NXTPO     COMP @REPMD                 4646               CRE009
     C                     ELSE                                           CRE009
0492 C           NXTPO     COMP RUND                   4646               RE0730
     C                     ENDIF                                          CRE009
0493 C   46                MOVE NXTPO     NXTP                            RE0730
0494 C   46N47             GOTO OPTN2                                     RE0730
      *                                                                   209995
      ** If the calculated next payment date is equal to the              209995
      ** the last payment date, generate a posting for last               209995
      ** payment.                                                         209995
      *                                                                   209995
     C           *IN46     IFEQ '1'                                       209995
     C           *INU1     ANDEQ'1'                                       209995
     C                     GOTO OPTN2                                     209995
     C                     ENDIF                                          209995
      *                                                                   209995
0495 C   46 47             EXSR OUTPUT                                    RE0730
0496 C                     GOTO END                                       RE0730
0497 C**                                                                  RE0730
0498 C**   END OF DETAIL PROCESSING                                       RE0730
0499 C           ERROR     TAG                             **  ERROR  **  RE0730
0500 C*********************SETON*********************LRU855************** E17948
0500 C                     SETON                     LRU7                 E17948
0501 C           END       TAG                             **  END  **    RE0730
0497  *
     C           *INU1     IFEQ '0'                                       209995
     C           *IN27     ANDEQ'1'                                       209995
     C           *IN03     ANDEQ'0'                                       209995
     C           RECD      ANDNE'*'                                       209995
     C           *INU1     OREQ '0'                                       209995
     C           *IN28     ANDEQ'1'                                       209995
     C           *IN03     ANDEQ'0'                                       209995
     C           RECD      ANDNE'*'                                       209995
     C                     MOVEL'S'       NSRECI                          209995
     C                     MOVEL'    '    NSETYP                          209995
     C                     MOVELCCY       NSECCY                          209995
     C           *IN28     IFEQ '1'                                       209995
     C                     MOVEL'O'       NSINOI                          209995
     C                     MOVELCBRC      NSBRCA                          209995
     C                     MOVELCCUS      CUSX    6                       209995
     C                     MOVELWNOSC     NSNOSA                          209995
     C                     CALL 'AOCUSTR0'                                209995
     C                     PARM '*MSG    'WRTCD   7                       209995
     C                     PARM '*KEY    'WOPTN   7                       209995
     C                     PARM CUSX      WCNUM  10                       209995
     C                     PARM           WKYST   7                       209995
     C           SDCUST    PARM SDCUST    DSFDY                           209995
     C           WRTCD     IFNE *BLANK                                    209995
     C           *LOCK     IN   LDA                                       209995
     C                     MOVEL'SDCUSTPD'DBFILE                          209995
     C                     MOVEL@OPTN     DBKEY                           209995
     C                     MOVEL@OPTN     DBKEY                           209995
     C                     Z-ADD20        DBASE                           209995
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     OUT  LDA                                       209995
     C                     EXSR *PSSR                                     209995
     C                     SETON                     U7U8LR               209995
     C                     GOTO ERROR                                     209995
     C                     ELSE                                           209995
     C                     MOVELBBCRNM    NSCRNM                          209995
     C                     MOVELBBCRTN    NSCTWN                          209995
     C                     ENDIF                                          209995
     C                     EXSR NOSEVT                                    209995
     C                     ENDIF                                          209995
     C           *IN27     IFEQ '1'                                       209995
     C                     MOVEL'I'       NSINOI                          209995
     C                     MOVELDRBR      NSBRCA                          209995
     C                     MOVELDCUS      CUSX    6                       209995
     C                     MOVELWNOSD     NSNOSA                          209995
     C                     CALL 'AOCUSTR0'                                209995
     C                     PARM '*MSG    'WRTCD   7                       209995
     C                     PARM '*KEY    'WOPTN   7                       209995
     C                     PARM CUSX      WCNUM  10                       209995
     C                     PARM           WKYST   7                       209995
     C           SDCUST    PARM SDCUST    DSFDY                           209995
     C           WRTCD     IFNE *BLANK                                    209995
     C           *LOCK     IN   LDA                                       209995
     C                     MOVEL'SDCUSTPD'DBFILE                          209995
     C                     MOVEL@OPTN     DBKEY                           209995
     C                     MOVEL@OPTN     DBKEY                           209995
     C                     Z-ADD20        DBASE                           209995
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     OUT  LDA                                       209995
     C                     EXSR *PSSR                                     209995
     C                     SETON                     U7U8LR               209995
     C                     GOTO ERROR                                     209995
     C                     ELSE                                           209995
     C                     MOVELBBCRNM    NSCRNM                          209995
     C                     MOVELBBCRTN    NSCTWN                          209995
     C                     ENDIF                                          209995
     C                     EXSR NOSEVT                                    209995
     C                     ENDIF                                          209995
     C                     ENDIF                                          209995
0502 C**                                                                  RE0730
0503 C**   PROCESS STAND FILE TRAILER                                     RE0730
     C*                                                                   E17948
     C   03                SETON                     31                   E17948
0504 C  N03                                                               RE0730
0505 COR U1                GOTO LRPROC                                    RE0730
     C*                                                                   E17948
0506 C**   UPDATE STAND TRAILER WITH NBR & VALUE OF DELETED S/O.          RE0730
0507 C           NSAU      SUB  NDELS     NSAU             NEW NBR S/O    RE0730
0508 C**                                                                  RE0730
0509 C**                                                                  RE0730
0510 C**   - SUB VALUE OF DELETS FROM VALUE OF S/O AFTER UPDATE           RE0730
0511 C                     MOVE VSUW      ZZTOTI                          RE0730
0512 C                     MOVE VSUD      ZZTOTD                          RE0730
0513 C                     Z-SUBVDELI     ZZAMTI                          RE0730
0514 C                     Z-SUBVDELD     ZZAMTD                          RE0730
0515 C                     EXSR GLZSUM                                    RE0730
0516 C                     MOVE ZZTOTI    VSUW             VALUE OF S/O   RE0730
0517 C                     MOVE ZZTOTD    VSUD             AFTER UPDATE   RE0730
0518 C**                                                                  RE0730
0519 C           LRPROC    TAG                             ** LRPROC **   RE0730
0520 C**                                                                  RE0730
0521 C**   COMPARE CONTROL TOTALS FOR STAND FILE.                         RE0730
0522 C**                                                                  RE0730
0523 C**   ACCUMULATE TOTALS OF RECORDS READ FROM STAND MINUS,IF U1,TOTALSRE0730
0524 C**   OF RECORDS DELETED HERE SHOULD EQUAL UPDATED TOTALS ON STAND.  RE0730
0525 C  NU1 03   TOTSO     SUB  NDELS     TOTSO            NBR S/O AFTER  RE0730
0526 C      03   TOTSO     COMP NSAU                 5050    UPDATE.      RE0730
0527 C   50 03             SETON                         U8               RE0730
0528 C**                                                                  RE0730
0529 C  NU1 03             MOVE VALINT    ZZTOTI                          RE0730
0530 C  NU1 03             MOVE VALDEC    ZZTOTD                          RE0730
0531 C  NU1 03             Z-SUBVDELI     ZZAMTI                          RE0730
0532 C  NU1 03             Z-SUBVDELD     ZZAMTD                          RE0730
0533 C  NU1 03             EXSR GLZSUM                                    RE0730
0534 C  NU1 03             MOVE ZZTOTI    VALINT                          RE0730
0535 C  NU1 03             MOVE ZZTOTD    VALDEC                          RE0730
0536 C**NU1*03***ZZTOTI****COMP*VSUW*****************5151**VALUE*OF*S/O** E17948
0537 C***51*03*************SETON*********************U852*****************E17948
0538 C**NU1*03***ZZTOTD****COMP*VSUD*****************5151***AFTER*UPDATE**E17948
0536 C******03***ZZTOTI    COMP VSUW                 5151  VALUE O E17948 034467
0538 C**N51*03***ZZTOTD    COMP VSUD                 5151   AFTER  E17948 034467
     C      03   VALINT    COMP VSUW                 5151  VALUE OF S/O   034467
     C  N51 03   VALDEC    COMP VSUD                 5151   AFTER UPDATE  034467
0539 C   51 03             SETON                     U852                 RE0730
0540 CLRNU1      2         ADD  GESON     GESON                           RE0730
0541 CLR U1      2         ADD  SOEXN     SOEXN                           RE0730
     C*                                                                   E17948
     C*   IF PRIMARY FILE (STAND) CONTAINS NO RECORD, OUTPUT ERROR CODE   E17948
     C*   TO INDICATE HEADER MISSING.                                     E17948
     CLRN40NU7             EXSR ERRSR1                     *** ERROR 01 **E17948
     C*   IF STAND TRAILER FILE CONTAINS NO RECORD OUTPUT ERROR REPORT.   E17948
     CLRN31NU7             EXSR ERRSR2                     *** ERROR 11 **E17948
     C*                                                                   E17948
     C/COPY WNCPYSRC,RE0730C011
     C** TAKE CARE OF AU UNDER COB PROCESSING ONLY                        S01117
     C*                                                                   S01117
     CLR         *INU1     IFNE '1'                                       S01117
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     CLR                   Z-ADDSFNUMU    ZSNUMU  60                      S01117
     CLR                   OUT  LDA                                       S01117
     C**                                                                  S01117
     CLR                   CALL 'ZSFILE'                                  S01117
     CLR                   PARM           SEQ     5                       S01117
     CLR                   PARM *BLANK    SENTY   3                       S01117
     CLR                   PARM           SFILEU                          S01117
     CLR                   PARM           ZSNUMU                          S01117
     CLR                   PARM           ZSERR   1                       S01117
     CLR         *LOCK     IN   LDA                                       S01117
     C*                                                                   S01117
     CLR         ZSERR     IFEQ 'Y'                                       S01117
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     CLR                   SETON                     U7                   S01117
     CLR                   RETRN                                          S01117
     CLR                   END                                            S01117
     C*                                                                   S01117
     CLR         *IN55     IFEQ *ON                                                          BUG4051
     CLR                   EXCPT                                                             BUG5350
     CLR                   CLOSERE0730P2                                                     BUG4051
     CLR                   END                                                               BUG4051
     C*                                                                                      BUG4051
     CLR                   END                                            S01117
      *                                                                                       CRE013
      ** Close Failed Standing Orders Extract                                                 CRE013
     CLR         CRE013    IFEQ 'Y'                                                           CRE013
     CLR         CAP207    OREQ 'Y'                                                           CAP207
     CLR                   CLOSERESTORPD                                                      CRE013
     CLR                   ENDIF                                                              CRE013
     C*                                                                   S01117
     CLR U7                EXSR *PSSR                                     S01117
     CLR                   EXSR HASH1                                     209995
     C********************************************************************209995
     C           HASH1     BEGSR                                          209995
     C           TEAMT     DIV  1000      ZZAMT        36                 209995
     C   36                Z-SUBZZAMT     ZZAMT                           209995
     C                     Z-ADD0         ZZTOTI                          209995
     C                     Z-ADD0         ZZTOTD                          209995
     C                     EXSR GLZADD                                    209995
     C                     MOVE 'T'       NERECI                          209995
     C                     Z-ADDZZTOTI    NEWNSO                          209995
     C                     Z-ADDZZTOTD    NEDCSO                          209995
     C                     Z-ADDTNORE     NERESO                          209995
     C                     WRITEDLNEEDD0                                  209995
      *                                                                   209995
     C                     ENDSR                                          209995
      ********************************************************************                    CRE013
     C           SRSTOR    BEGSR                                                              CRE013
      *                                                                                       CRE013
      ** As most of RESTORPD field names are the same as                                      CRE013
      ** STANDSB field names, there's no need to set them up.                                 CRE013
     C                     MOVE CCY       PCCY                                                CRE013
     C                     Z-ADDAMOUNT    PAMT                                                CRE013
     C                     MOVELUGREJC    REJC                                                CRE013
     C                     WRITERESTORD0                                                      CRE013
      *                                                                                       CRE013
     C                     ENDSR                                                              CRE013
0542 C********************************************************************RE0730
0543 C           STUP      BEGSR                                          RE0730
0544 C                     SETOF                     424344               RE0730
     C                     SETOF                     49                   S01117
0545 C                     SETON                     53                   RE0730
0546 C                     EXCPT                                          RE0730
0547 C                     SETOF                     53                   RE0730
0548 C                     ENDSR                                          RE0730
0549 C********************************************************************RE0730
0550 C**                                                                  RE0730
0551 C           TABCHN    BEGSR                           **  TABCHN  ** RE0730
0552 C           TABKEY    CHAINTABLE                89                   RE0730
0553 C                     ENDSR                                          RE0730
0554 C**                                                                  RE0730
0555 C********************************************************************RE0730
0556 C**                                                                  RE0730
0557 C           ACCCHN    BEGSR                           **  ACCCHN  ** RE0730
0558 C           ACCKEY    CHAINACCNT                88                   RE0730
0559 C                     ENDSR                                          RE0730
0560 C**                                                                  RE0730
0561 C********************************************************************RE0730
0562 C**                                                                  RE0730
0563 C***********MEMCHN    BEGSR                           ** MEMCHNRE0730CCB002
0564 C***********RRNUM     CHAINMEMO                 87             RE0730CCB002
0565 C***********          ENDSR                                    RE0730CCB002
0566 C**                                                                  RE0730
0567 C********************************************************************RE0730
     C**                                                                  CCB002
      *****************************************************************                     AR858062
      *                                                               *                     AR858062
      * ODCONV - Converts overdraft line to its proper decimal        *                     AR858062
      *          places based on the currency involved.               *                     AR858062
      *                                                               *                     AR858062
      * Called by: Mainline                                           *                     AR858062
      *                                                               *                     AR858062
      * Calls: ZCONV                                                  *                     AR858062
      *                                                               *                     AR858062
      *                                                               *                     AR858062
      *****************************************************************                     AR858062
     C           ODCONV    BEGSR                                                            AR858062
      *                                                                                     AR858062
     C                     CALL 'AOCURRR0'                                                  AR858062
     C                     PARM *BLANKS   WRTCD   7                                         AR858062
     C                     PARM '*KEY    'WOPTN   7                                         AR858062
     C                     PARM RECCYD    CCY                                               AR858062
     C           SDCURR    PARM SDCURR    DSSDY                                             AR858062
      *                                                                                     AR858062
      **  Handle Database Error.                                                            AR858062
      *                                                                                     AR858062
     C           WRTCD     IFNE *BLANKS                                                     AR858062
     C           *LOCK     IN   LDA                                                         AR858062
     C                     SETON                     U7U8LR                                 AR858062
     C                     SETON                     98                                     AR858062
     C                     MOVELRECCYD    DBKEY                                             AR858062
     C                     MOVEL'SDCURRPD'DBFILE                                            AR858062
     C                     Z-ADD031       DBASE                                             AR858062
     C                     OUT  LDA                                                         AR858062
     C                     EXSR *PSSR                                                       AR858062
     C                     ENDIF                                                            AR858062
     C                     Z-ADDA6NBDP    ZDECS   10                                        AR858062
     C                     MOVE ODLN      ZAMTCI                                            AR858062
     C                     MOVE RECCYD    ZCCYI                                             AR858062
     C                     MOVE RECCYD    ZCCYO                                             AR858062
     C                     Z-ADD0         ZCDPI                                             AR858062
     C                     Z-ADDZDECS     ZCDPO                                             AR858062
     C                     Z-ADD1         ZEXCH                                             AR858062
     C                     MOVE A6MDIN    ZMD                                               AR858062
     C                     EXSR ZCONV                                                       AR858062
      *                                                                                     AR858062
     C                     ENDSR                                                            AR858062
      *                                                                                     AR858062
      *****************************************************************                     AR858062
     C           UPDMEM    BEGSR                                          CCB002
     C*                                                                   209995
     C                     CALL 'AORETLR0'                                209995
     C                     PARM *BLANK    WRTCD   7                       209995
     C                     PARM '*FIRST  'WOPTN   7                       209995
     C           SDRETL    PARM SDRETL    DSFDY                           209995
     C           WRTCD     IFNE *BLANK                                    209995
     C           *LOCK     IN   LDA                                       209995
     C                     MOVEL'SDRETLPD'DBFILE                          209995
     C                     MOVEL@OPTN     DBKEY                           209995
     C                     Z-ADD10        DBASE                           209995
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     OUT  LDA                                       209995
     C                     EXSR *PSSR                                     209995
     C                     SETON                     U7U8LR               209995
     C                     GOTO ERROR                                     209995
     C                     ENDIF                                          209995
     C*                                                                   209995
     C           BMRANR    IFEQ 'Y'                                       209995
      *                                                                   CCB002
      ** Call Access Object AOMEMSU0                                      CCB002
     C                     CALL 'AOMEMSU0'                                CCB002
     C                     PARM *BLANKS   W0RTCD  7        I:Return code  CCB002
     C                     PARM           W0RETL 100       O:Retail A/C NoCCB002
     C**********           PARM *ZEROS    W0CNUM  60       O:Customer No.              CCB002 206632
     C**********           PARM *BLANKS   W0CUCD  3        O:Currency                  CCB002 206632
     C**********           PARM *ZEROS    W0ACCD  40       O:Account Code              CCB002 206632
     C**********           PARM *ZEROS    W0ACSQ  20       O:Account Seq.              CCB002 206632
     C**********           PARM *BLANKS   W0BRCA  3        O:Branch                    CCB002 206632
     C**********           PARM           W0CNUM  60       O:Customer No.              206632 CSD027
     C                     PARM           W0CNUM  6        O:Customer No.                     CSD027
     C                     PARM           W0CUCD  3        O:Currency                         206632
     C**********           PARM           W0ACCD  40       O:Account Code              206632 CGL029
     C                     PARM           W0ACCD 100                                          CGL029
     C                     PARM           W0ACSQ  20       O:Account Seq.                     206632
     C                     PARM           W0BRCA  3        O:Branch                           206632
     C                     PARM RUND      W0PSTD  50       O:Posting date CCB002
     C                     PARM RUND      W0VDAT  50       O:Value date   CCB002
     C                     PARM           W0AMT  150       O:Movement amt CCB002
     C                     PARM 'N'       W0FTOV  1        O:FT override  CCB002
     C*                                                                   209995
     C                     ELSE                                           209995
     C*                                                                   209995
     C           *IN23     IFEQ '1'                                       209995
     C                     CALL 'AOMEMSU0'                                209995
     C                     PARM *BLANKS   W0RTCD  7        I:Return code  209995
     C                     PARM *ZEROS    W0RETL 100       O:Retail A/C No209995
     C**********           PARM CCUS      W0CNUM  60       O:Customer No.              209995 CSD027
     C                     PARM CCUS      W0CNUM  6        O:Customer No.                     CSD027
     C                     PARM CCY       W0CUCD  3        O:Currency     209995
     C**********           PARM CSCA      W0ACCD  40       O:Account Code              209995 CGL029
     C                     PARM CSCA      W0ACCD                                              CGL029
     C                     PARM CACD      W0ACSQ  20       O:Account Seq. 209995
     C                     PARM CBRC      W0BRCA  3        O:Branch       209995
     C                     PARM RUND      W0PSTD  50       O:Posting date 209995
     C                     PARM RUND      W0VDAT  50       O:Value date   209995
     C                     PARM           W0AMT  150       O:Movement amt 209995
     C                     PARM 'N'       W0FTOV  1        O:FT override  209995
     C                     ENDIF                                          209995
     C*                                                                   209995
     C           *IN22     IFEQ '1'                                       209995
     C                     CALL 'AOMEMSU0'                                209995
     C                     PARM *BLANKS   W0RTCD  7        I:Return code  209995
     C                     PARM *ZEROS    W0RETL 100       O:Retail A/C No209995
     C**********           PARM DCUS      W0CNUM  60       O:Customer No.              209995 CSD027
     C                     PARM DCUS      W0CNUM  6        O:Customer No.                     CSD027
     C                     PARM CCY       W0CUCD  3        O:Currency     209995
     C**********           PARM DACD      W0ACCD  40       O:Account Code              209995 CGL029
     C                     PARM DACD      W0ACCD                                              CGL029
     C                     PARM DACS      W0ACSQ  20       O:Account Seq. 209995
     C                     PARM DRBR      W0BRCA  3        O:Branch       209995
     C                     PARM RUND      W0PSTD  50       O:Posting date 209995
     C                     PARM RUND      W0VDAT  50       O:Value date   209995
     C                     PARM           W0AMT  150       O:Movement amt 209995
     C                     PARM 'N'       W0FTOV  1        O:FT override  209995
     C                     ENDIF                                          209995
     C*                                                                   209995
     C                     ENDIF                                          209995
      *                                                                   CCB002
     C           W0RTCD    IFNE '       '                                 CCB002
     C           *LOCK     IN   LDA                                       209995
     C                     MOVE '09'      DBASE            ***************CCB002
     C                     MOVE 'MEMOS  ' DBFILE           *   ERROR 09  *CCB002
     C           BMRANR    IFEQ 'Y'                                       209995
     C                     MOVELW0RETL    DBKEY            ***************CCB002
     C                     ELSE                                           209995
     C                     MOVELACCKEY    DBKEY                           209995
     C                     ENDIF                                          209995
     C                     OUT  LDA                                       209995
     C                     EXSR *PSSR                                     164405
     C                     MOVE *ON       *INU7                           164405
     C                     MOVE *ON       *INU8                           164405
     C                     MOVE *ON       *INLR                           164405
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     ELSE                                           CCB002
     C                     SETON                     14                   CCB002
     C                     END                                            CCB002
     C/COPY WNCPYSRC,RE0730C017
      *                                                                   CCB002
     C                     ENDSR                                          CCB002
     C**                                                                  CCB002
     C********************************************************************CCB002
0568 C**                                                                  RE0730
0569 C**   HASH SR. ACCUMULATES HASH TOTALS OF THREE PAYMENT AMOUNTS      RE0730
0570 C**   FROM STAND FILE DETAIL RECORDS.                                RE0730
0571 C           HASH      BEGSR                           **  HASH  **   RE0730
0572 C                     MOVE AFPY      ZZAMT                           RE0730
0573 C                     EXSR GLZADD                                    RE0730
0574 C                     MOVE ASPY      ZZAMT                           RE0730
0575 C                     EXSR GLZADD                                    RE0730
0576 C                     MOVE ALPY      ZZAMT                           RE0730
0577 C                     EXSR GLZADD                                    RE0730
0578 C                     ENDSR                                          RE0730
0579 C**                                                                  RE0730
0580 C********************************************************************RE0730
0581 C**                                                                  RE0730
0582 C*****FREAK*SR. CALLS QZFREQ TO CALCULATE NEXT PAYMENT DATE.         S01195
0582 C**   FREAK SR. CALLS FREQ TO CALCULATE NEXT PAYMENT DATE.           S01195
0583 C           FREAK     BEGSR                           **  FREAK  **  RE0730
0584 C                     Z-ADDNXTP      ZDAYNO                          RE0730
0585 C                     MOVE PAYF      ZFREQ                           RE0730
0586 C                     MOVE CCY       ZCCY                            RE0730
0587 C                     Z-ADDDYTP      ZMDAY                           RE0730
     C                     MOVE *BLANKS   ZLOC                            S01195
0588 C***********          EXSR QZFREQ                                    S01195
0588 C                     EXSR FREQ                                      S01195
0589 C                     ENDSR                                          RE0730
0590 C**                                                                  RE0730
0591 C********************************************************************RE0730
0592 C**                                                                  RE0730
0593 C           GENRTE    BEGSR                           **  GENRTE  ** RE0730
0594 C**                                                                  RE0730
0595 C**   SET UP NARRATIVE IF PNAR BLANK.                                RE0730
0596 C  N21                GOTO BYPAS2                     IF NOT BLANK   RE0730
0597 C                     MOVE BLNK30    NARR             RESET          RE0730
0598 C                     MOVE 'S/O'     NARR1                           RE0730
0599 C                     MOVE STOR      NARR2                           RE0730
0600 C                     MOVE PAYR      NARR3                           RE0730
0601 C           BYPAS2    TAG                             **  BYPAS2  ** RE0730
     C/COPY WNCPYSRC,RE0730C019
0602 C**                                                                  RE0730
0603 C**   IF NEITHER DR NOT CR ENTRY UNPOSTABLE, SKIP TO GENEND          RE0730
0604 C  N42N43             GOTO GENEND                                    RE0730
0605 C**                                                                  RE0730
0606 C*        GET COMPUTER SUSPENSE ACCOUNT CODE                         RE0730
0607 C*                                                                   RE0730
0608 C                     MOVEL'01    '  TABKEY 12                       RE0730
0609 C                     MOVE '    20'  TABKEY                          RE0730
0610 C                     EXSR TABCHN                                    RE0730
     C*  IF COMPUTER SUSPENSE ACCOUNT NOT FOUND, OUTPUT ERROR REPORT.     E17948
0611 C   89                                                               RE0730
0612 CORN17                SETON                     56                   RE0730
     C           *IN56     IFEQ '1'                                       E17948
     C                     MOVE '06'      DBASE            ***************E17948
     C                     MOVE 'TABTB20' DBFILE           *   ERROR 06  *E17948
     C                     MOVE BLANKS    DBKEY            ***************E17948
     C                     MOVELTABKEY    DBKEY                           E17948
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     GOTO GENEND                                    E17948
     C                     END                                            E17948
0289 C**                                                                  E13024
0290 C*    GET COMPUTER SUSPENSE ACCOUNT CODE TYPE                        E13024
0291 C*                                                                   E13024
     C                     MOVE COMS      COMSA  10                                          BUG3011
      *                                                                                      BUG3011
     C                     CALL 'AOACODR0'                                                    CGL029
     C                     PARM *BLANKS   @RTCD                                               CGL029
     C                     PARM '*KEY    '@OPTN                                               CGL029
     C**********           PARM           COMS                                        CGL029 BUG3011
     C                     PARM           COMSA                                              BUG3011
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
      *                                                                                       CGL029
      ** Error occured in AOACODR0 Access Program                                             CGL029
      *                                                                                       CGL029
     C           @RTCD     IFNE *BLANKS                                                       CGL029
     C                     MOVELCOMS      DBKEY                                               CGL029
     C                     MOVEL'SDACODPD'DBFILE                                              CGL029
     C                     Z-ADD7         DBASE                                               CGL029
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     MOVE *ON       *IN56                                               CGL029
     C                     GOTO GENEND                                                        CGL029
     C                     END                                                                CGL029
      *                                                                                       CGL029
      ** Move Account Type and section for output                                             CGL029
      *                                                                                       CGL029
     C                     MOVE ATYP      ACTP    1                                           CGL029
     C                     MOVE ACSC      ACCS    2                                           CGL029
      *                                                                                       CGL029
0292 C**********           MOVEL'      '  TABKEY                          E13024       E13024 CGL029
0293 C**********           MOVE '      '  TABKEY                          E13024       E13024 CGL029
0294 C**********           MOVEL'30'      TABKEY                          E13024       E13024 CGL029
0295 C**********           MOVELCOMS      KEYCOD  5                       E13024       E13024 CGL029
0296 C**********           MOVE '1'       KEYCOD                          E13024       E13024 CGL029
0297 C**********           MOVE KEYCOD    TABKEY                          E13024       E13024 CGL029
0298 C**********           EXSR TABCHN                                    E13024       E13024 CGL029
     C**IF*COMP. SUSPENSE A/C CODE TYPE NOT FOUND, OUTPUT ERROR REPORT.                E17948 CGL029
0299 C***89*****                                                                       E13024 CGL029
0300 C*ORN18****            SETON                     56                               E13024 CGL029
     C********** *IN56     IFEQ '1'                                                    E17948 CGL029
     C**********           MOVE '07'      DBASE            ***************             E17948 CGL029
     C**********           MOVE 'TABTB30' DBFILE           *   ERROR 07  *             E17948 CGL029
     C**********           MOVE BLANKS    DBKEY            ***************             E17948 CGL029
     C**********           MOVELTABKEY    DBKEY                                        E17948 CGL029
     C**********           GOTO GENEND                                                 E17948 CGL029
     C**********           END                                                         E17948 CGL029
0613 C***********          MOVEL'      '  TABKEY                          S01117
0614 C***********          MOVE '      '  TABKEY                          S01117
0615 C*****GET*BRANCH INT. CUST. NO. FROM TABLE.                          S01117
0616 C***********          MOVEL'10'      TABKEY                          S01117
0617 C***********          MOVE BRCD      TABKEY                          S01117
0618 C***********          EXSR TABCHN                                    S01117
     C**IF*BRANCH INT. CUS. NO. NOT FOUND, OUTPUT ERROR REPORT.     E17948S01117
0619 C***89******                                                         S01117
0620 C*RN10******          SETON                     56                   S01117
     C************IN56     IFEQ '1'                                 E17948S01117
     C***********          MOVE '08'      DBASE      E17948***************S01117
     C***********          MOVE 'TABTB10' DBFILE     E17948*   ERROR 08  *S01117
     C***********          MOVE BLANKS    DBKEY      E17948***************S01117
     C***********          MOVELTABKEY    DBKEY                     E17948S01117
     C***********          END                                      E17948S01117
     C***********                                                   E17948S01117
0621 C           GENEND    ENDSR                                          RE0730
0622 C**                                                                  RE0730
0623 C********************************************************************RE0730
0624 C**                                                                  RE0730
0625 C           PAYAMT    BEGSR                           **  PAYAMT  ** RE0730
0626 C**                                                                  RE0730
0627 C**   PAYAMT SR. COMPARES PAYMENT DATES TO NEXT PAYMENT DATE         RE0730
0628 C**   & PLACES PAYMENT AMOUNT TO BE POSTED INTO AMOUNT FIELD.        RE0730
0629 C           DFPY      COMP NXTP                     86* 1ST PAYMENT  RE0730
0630 C           DLPY      COMP NXTP                     85* LAST PAYMENT RE0730
0631 C**                                                                  RE0730
0632 C**   IF NEITHER FIRST NOR LAST, & IF SECOND PAYMENT AMOUNT IS BLANK RE0730
0633 C**   USE FIRST PAYMENT AMOUNT.                                      RE0730
0634 C  N86N85 20          SETON                         86               RE0730
0635 C**                                                                  RE0730
0636 C                     Z-ADDASPY      AMOUNT 130                      RE0730
0637 C   86                Z-ADDAFPY      AMOUNT                          RE0730
0638 C   85                Z-ADDALPY      AMOUNT                          RE0730
0639 C***85*24***          Z-ADDAFPY      AMOUNT           -DEFAULT       104041
     C*                                                                   104041
     C** If Last Payment Date is equal to the Next Payment Date and       104041
     C** Last Payment Amount is blank/zero, use Second Payment Amount.    104041
     C*                                                                   104041
     C           *IN85     IFEQ '1'                                       104041
     C           *IN24     ANDEQ'1'                                       104041
0639 C                     Z-ADDASPY      AMOUNT           -DEFAULT       104041
     C*                                                                   104041
     C** If Amount is equal to zero, use the First Payment Amount.        104041
     C*                                                                   104041
     C           AMOUNT    IFEQ 0                                         104041
     C                     Z-ADDAFPY      AMOUNT                          104041
     C                     END                                            104041
     C                     END                                            104041
0640 C                     ENDSR                                          RE0730
0641 C********************************************************************RE0730
0642 C**                                                                  RE0730
0643 C**   OUTPUT SR. PERFORMS EXCEPTION OUTPUT & MAINTAINS COUNTS &      RE0730
0644 C**   HASH TOTALS OF RECORDS WRITTEN TO GESO OR SOEX.                RE0730
0645 C           OUTPUT    BEGSR                           **  OUTPUT  ** RE0730
      *                                                                                      BUG4051
     C                     Z-ADDGESON     RGESON  50                                         BUG4051
     C                     ADD  2         RGESON                                             BUG4051
     C           *IN55     IFEQ *OFF                                                         BUG4051
     C           *IN42     IFEQ *ON                                                          BUG4051
     C           *IN43     OREQ *ON                                                          BUG4051
     C           *IN44     OREQ *ON                                                          BUG4051
     C                     OPEN RE0730P2                                                     BUG4051
     C**********           MOVE *ON       *IN57                                      BUG4051 BUG4051
     C                     MOVE *ON       *IN57                                              BUG4051
     C                     Z-ADD0         PAGE1                                              BUG4051
      *                                                                                      BUG4051
      ** Ensure report Spool File recorded by RCF                                            BUG4051
      *                                                                                      BUG4051
     C                     Z-ADDSFNUM2    ZSNUM                                              BUG4051
     C                     MOVE ' '       ZSERR                                              BUG4051
     C                     OUT  LDA                                                          BUG4051
      *                                                                                      BUG4051
     C                     CALL 'ZSFILE'                                                     BUG4051
     C                     PARM *BLANKS   SEQ                                                BUG4051
     C                     PARM TXBRCA    SENTY                                              BUG4051
     C                     PARM           SFILE2                                             BUG4051
     C                     PARM           ZSNUM                                              BUG4051
     C                     PARM           ZSERR                                              BUG4051
     C           *LOCK     IN   LDA                                                          BUG4051
      *                                                                                      BUG4051
     C           ZSERR     IFEQ 'Y'                                                          BUG4051
      *                                                                                      BUG4051
      ** Error during ZSFILE processing, return to calling program                           BUG4051
      *                                                                                      BUG4051
     C                     MOVE *ON       *INU7                                              BUG4051
     C                     MOVE *ON       *INLR                                              BUG4051
     C                     RETRN                                                             BUG4051
     C                     ENDIF                                                             BUG4051
     C                     ENDIF                                                             BUG4051
     C                     ENDIF                                                             BUG4051
      *                                                                                      BUG4051
     C*                                                                   S01522
     C/COPY WNCPYSRC,RE0730C020
     C* Get the posting narrative values:                                 S01522
      * - DR Account                                                      S01522
     C                     MOVE DRBR      ##BRCA                          S01522
     C                     MOVE DCUS      ##CUST                          S01522
     C                     MOVE CCY       ##CCY                           S01522
     C                     MOVE DACD      ##ACCD                          S01522
     C                     MOVE DACS      ##ACSQ                          S01522
     C                     MOVE DRAN      ##ACNO                          S01522
     C                     MOVE 'GB00730' ##MGID                          S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
     C                     MOVE O#PNAR    O#PNA1 30                       S01522
      * - DR - Different Account                                          S01522
     C                     MOVE 'GB00731' ##MGID                          S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
     C                     MOVE O#PNAR    O#PNA2 30                       S01522
      * - CR Account                                                      S01522
     C                     MOVE CBRC      ##BRCA                          S01522
     C                     MOVE CCUS      ##CUST                          S01522
     C                     MOVE CCY       ##CCY                           S01522
     C                     MOVE CSCA      ##ACCD                          S01522
     C                     MOVE CACD      ##ACSQ                          S01522
     C                     MOVE CRAN      ##ACNO                          S01522
     C                     MOVE 'GB00740' ##MGID                          S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
     C                     MOVE O#PNAR    O#PNA3 30                       S01522
      * - CR - Different Account                                          S01522
     C                     MOVE 'GB00741' ##MGID                          S01522
     C*                                                                   S01522
     C                     EXSR SRPNAR                                    S01522
     C                     MOVE O#PNAR    O#PNA4 30                       S01522
     C*                                                                   S01522
     C/COPY WNCPYSRC,RE0730C009
0646 C                     EXCPT                                          RE0730
      *                                                                                      BUG4051
     C           *IN55     IFEQ *OFF                                                         BUG4051
     C           *IN42     IFEQ *ON                                                          BUG4051
     C           *IN43     OREQ *ON                                                          BUG4051
     C           *IN44     OREQ *ON                                                          BUG4051
     C                     MOVE *ON       *IN55                                              BUG4051
     C                     ENDIF                                                             BUG4051
     C                     ENDIF                                                             BUG4051
     C*                                                                   S01522
0647 C   U1                GOTO COUNT2                                    RE0730
0648 C           GESON     ADD  2         GESON   50                      RE0730
      *                                                                                      BUG4051
     C********** GESON     IFEQ 0                                                    BUG4051 BUG4051
     C**********           MOVE *OFF      *IN55                                      BUG4051 BUG4051
     C**********           ELSE                                                      BUG4051 BUG4051
     C**********           MOVE *ON       *IN55                                      BUG4051 BUG4051
     C**********           ENDIF                                                     BUG4051 BUG4051
      *                                                                                      BUG4051
0649 C           COUNT2    TAG                             **  COUNT2  ** RE0730
0650 C   U1      SOEXN     ADD  1         SOEXN   50                      RE0730
0651 C                     Z-ADDHASHI     ZZTOTI                          RE0730
0652 C                     Z-ADDHASHD     ZZTOTD                          RE0730
0653 C                     MOVE AMOUNT    ZZAMT                           RE0730
0654 C           ZZAMT     COMP 0                      54                 RE0730
0655 C   54                Z-SUBZZAMT     ZZAMT                           RE0730
0656 C                     SETOF                     54                   RE0730
0657 C                     EXSR GLZADD                                    RE0730
0658 C  NU1                EXSR GLZADD                                    RE0730
0659 C                     Z-ADDZZTOTI    HASHI  150                      RE0730
0660 C                     Z-ADDZZTOTD    HASHD   30                      RE0730
0661 C                     ENDSR                                          RE0730
0662 C**                                                                  RE0730
     C*****************************************************************
     C/EJECT                                                              S01522
     C********************************************************************S01522
     C**  Subroutine SRPNAR determines the required narratives.         **S01522
     C********************************************************************S01522
     C           SRPNAR    BEGSR                           * S R P N A R *S01522
     C*                                                                   S01522
     C* Define the data structure parameter:                              S01522
     C*                                                                   S01522
     C           *LIKE     DEFN CGPNAR    ##PNAR                          S01522
     C*                                                                   S01522
     C* Define the work variables:                                        S01522
     C*                                                                   S01522
     C           *LIKE     DEFN MNCUST    ##CUST                          S01522
     C           *LIKE     DEFN MNCYCD    ##CCY                           S01522
     C           *LIKE     DEFN MNACCD    ##ACCD                          S01522
     C           *LIKE     DEFN MNACSQ    ##ACSQ                          S01522
     C           *LIKE     DEFN MNBRCA    ##BRCA                          S01522
     C           *LIKE     DEFN MNRACN    ##ACNO                          S01522
     C*                                                                   S01522
     C* Initialise the narrative with the current value:                  S01522
     C*                                                                   S01522
     C           PNAR      IFNE *BLANKS                                   S01522
     C                     MOVELPNAR      O#PNAR 30                       S01522
     C                     ELSE                                           S01522
     C                     MOVELNARR      O#PNAR                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* If the facility is switched off or unavailable,                   S01522
     C*  or UDC is not installed, exit this subroutine:                   S01522
     C*                                                                   S01522
     C*  If UDC installed and facility is on:                             092500
     C*  narrative from message file should only be used if PNAR          092500
     C*  (from standing order input) is blank - else use PNAR             092500
     C           REPNAR    IFNE 'Y'                                       S01522
     C           PNAR      ORNE *BLANKS                                   092500
     C                     GOTO EXPNAR                                    S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* Determine the customer's name:                                    S01522
     C*                                                                   S01522
     C                     MOVEL##CUST    ##KEY     P                     S01522
     C*                                                                   S01522
     C                     CALL 'AOCUSTR0'                                S01522
     C                     PARM           ##RTN   7                       S01522
     C                     PARM '*KEY   ' ##OPT   7                       S01522
     C                     PARM           ##KEY  10                       S01522
     C                     PARM           ##STS   7                       S01522
     C           SDCUST    PARM SDCUST    DSSDY                           S01522
     C*                                                                   S01522
     C           ##RTN     IFNE *BLANKS                                   S01522
     C                     MOVEL'SDCUSTPD'DBFILE             *************S01522
     C                     MOVEL'101'     DBASE              * DBERR 101 *S01522
     C                     MOVEL##KEY     DBKEY              *************S01522
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     EXSR *PSSR                                     S01522
     C                     ENDIF                                          S01522
     C*...................................................................S01522
     C/EJECT                                                              S01522
     C*...................................................................S01522
     C* Determine the value for the first narrative using AOPNARR0:       S01522
     C*                                                                   S01522
     C                     CLEARCGPNAR                                    S01522
     C                     CLEAR##PRM1                                    086125
      *                                                                   S01522
     C                     MOVE 'RE'      MNMODI                          S01522
     C                     MOVE ##CUST    MNCUST                          S01522
     C                     MOVE ##CCY     MNCYCD                          S01522
     C                     MOVE ##ACCD    MNACCD                          S01522
     C                     MOVE ##ACSQ    MNACSQ                          S01522
     C                     MOVE ##BRCA    MNBRCA                          S01522
     C                     MOVE ##ACNO    MNRACN                          S01522
     C                     MOVE BOKC      MNBOKC                          S01522
     C                     MOVE BBCRNM    MNCRNM                          S01522
     C                     MOVELO#PNAR    MNNARR    P                     S01522
     C/COPY WNCPYSRC,REH00399
     C*                                                                   S01522
     C                     CALL 'AOPNARR0'                                S01522
     C                     PARM           ##RTN                           S01522
     C                     PARM           ##MGID  7                       S01522
     C                     PARM           ##PRM1                          086125
     C           CGPNAR    PARM CGPNAR    ##PNAR                          S01522
     C                     PARM           ##NARR 50                       S01522
     C/COPY WNCPYSRC,REH00400
     C*                                                                   S01522
     C           ##RTN     IFNE *BLANKS                                   S01522
     C                     MOVEL'CGPNARPD'DBFILE             *************S01522
     C                     MOVEL'102'     DBASE              * DBERR 102 *S01522
     C                     MOVELMNCUST    DBKEY              *************S01522
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     EXSR *PSSR                                     S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C                     MOVEL##NARR    O#PNAR    P                     S01522
     C*                                                                   S01522
     C           EXPNAR    TAG                             < EXPNAR       S01522
     C*                                                                   S01522
     C                     ENDSR                                          S01522
     C********************************************************************S01522
     C/EJECT                                                              S01522
0663 C********************************************************************RE0730
0664 C**                                                                  RE0730
0665 C**   ZSYSTM SR. TO CHAIN TO THE INSTALLATION CONTROL DATA RECORD.   RE0730
0666 C**                                                                  RE0730
0667 C           ZSYSTM    BEGSR                           *** ZSYSTM *** RE0730
0668 C**                                                                  RE0730
0669 C**   SET UP KEY FOR INSTALLATION CONTROL RECORD.                    RE0730
0670 C                     MOVEL'01      'ZTABKY 12                       RE0730
0671 C                     MOVE '  10'    ZTABKY                          RE0730
0672 C**                                                                  RE0730
0673 C           ZTABKY    CHAINTABLE                99    ON NOT THERE   RE0730
0674 C  N99      RECI      COMP 'D'                  9999  ON, IS DELETED RE0730
0675 C*                                                                   E17948
     C* IF ICD RECORD DELETED OR FLAGGED FOR DELETION. OUTPUT ERROR REPORTE17948
     C           *IN99     IFEQ '1'                                       E17948
     C                     MOVE '02'      DBASE            ***************E17948
     C                     MOVE 'TABTB10' DBFILE           *   ERROR 02  *E17948
     C                     MOVE BLANKS    DBKEY            ***************E17948
     C                     MOVELZTABKY    DBKEY                           E17948
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     END                                            E17948
0676 C**   CHECK SYSTEM DATE FORMAT, DDMMYY OR MMDDYY.                    RE0730
0677 C           DATF      COMP 'M'                      98MMDDYY, 98 ON  RE0730
0678 C**                                                                  RE0730
     C**  Read switchable features file SCSARDPD using access object      S01466
     C**  to determine if Addition of Transaction Type to Standing        S01466
     C**  Orders feature is switched ON                                   S01466
     C*                                                                   S01466
     C                     CALL 'AOSARDR0'                                S01466
     C                     PARM *BLANKS   W0RTCD  7                       S01466
     C                     PARM '*VERIFY' W0OPTN  7                       S01466
     C                     PARM 'S01466'  W0SARD  6                       S01466
     C           SCSARD    PARM SCSARD    DSFDY                           S01466
     C                     MOVE 'N'       S01466  1                       S01466
     C*                                                                   S01466
     C**  If feature is on, set up SAR flag                               S01466
     C*                                                                   S01466
     C           W0RTCD    IFEQ *BLANKS                                   S01466
     C                     MOVE 'Y'       S01466                          S01466
     C                     ELSE                                           S01466
     C*                                                                   S01466
     C** else, database error (return code other than *NRF)               S01466
     C*                                                                   S01466
     C           W0RTCD    IFNE '*NRF   '                                 S01466
     C                     MOVEL'RE0730'  DBPGM                           S01466
     C                     MOVEL'SCSARDPD'DBFILE           ************   S01466
     C                     MOVEL'*VERIFY' DBKEY            * DBERR 19 *   S01466
     C                     Z-ADD19        DBASE            ************   S01466
     C                     MOVE *ON       *INU7                                             BUG12587
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     EXSR *PSSR                                     S01466
     C                     SETON                     U7U8LR               S01466
     C                     SETON                     99                   S01466
     C                     END                                            S01466
     C*                                                                   S01466
     C                     END                                            S01466
     C*                                                                   S01466
0679 C                     ENDSR                                          RE0730
0680 C**                                                                  RE0730
0681 C**                                                                  RE0730
0682 C********************************************************************RE0730
0683 C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)  RE0730
0684 C*   IND '99' IS SET BY AN OVERFLOW ERROR                            RE0730
0685 C*                                                                   RE0730
0686 CSR         GLZADD    BEGSR                           *** GLZADD ****RE0730
0687 C*                                                                   RE0730
0688 CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT  RE0730
0689 CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS RE0730
0690 C*                                                                   RE0730
0691 C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS                       RE0730
0692 CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD  RE0730
0693 CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD  RE0730
0694 C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW                  RE0730
0695 C*                                                                   RE0730
0696 CSR                   EXSR GLZSUM                                    RE0730
0697 CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *RE0730
0698 C*                                                                   RE0730
0699 C********************************************************************RE0730
0700 C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -            RE0730
0701 C*                        GLZADD, GLZSUB, GLZCMP.                    RE0730
0702 C*          PARAMETERS PASSED -                                      RE0730
0703 C*                     I/P ZZAMTI ZZAMTD                             RE0730
0704 C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.       RE0730
0705 C*                                                                   RE0730
0706 CSR         GLZSUM    BEGSR                           *** GLZSUM ****RE0730
0707 C*                                                                   RE0730
0708 CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI  RE0730
0709 CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD  RE0730
0710 CSR                   SETOF                     919293               RE0730
0711 CSR                   SETOF                     949599               RE0730
0712 C*                                                                   RE0730
0713 C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG                      RE0730
0714 CSR         ZZAMTI    COMP 0                      9293               RE0730
0715 CSR 93      ZZAMTD    COMP 0                      9293               RE0730
0716 CSR 93                GOTO ZZSEND                     ZERO BYPASS    RE0730
0717 C*                                                                   RE0730
0718 C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.                       RE0730
0719 CSR         ZZTOTI    COMP 0                      9193               RE0730
0720 CSR 93      ZZTOTD    COMP 0                      9193               RE0730
0721 C*                                                                   RE0730
0722 C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.                           RE0730
0723 CSR 93                Z-ADDZZAMTI    ZZTOTI                          RE0730
0724 CSR 93                Z-ADDZZAMTD    ZZTOTD                          RE0730
0725 CSR 93                GOTO ZZSEND                     ZERO BYPASS    RE0730
0726 C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.                        RE0730
0727 CSR 91N92                                                            RE0730
0728 CORN91 92             GOTO ZZOFPS                                    RE0730
0729 C*                                                                   RE0730
0730 CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40                      RE0730
0731 CSR         ZZWK2     COMP 999                  93    '93' = CARRY   RE0730
0732 CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.RE0730
0733 C*                                                                   RE0730
0734 CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VERE0730
0735 CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VERE0730
0736 CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3                           RE0730
0737 CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3                           RE0730
0738 C*                                                                   RE0730
0739 C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED    RE0730
0740 CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS. RE0730
0741 CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE      RE0730
0742 CSRN99                Z-ADDZZWK2     ZZTOTD                          RE0730
0743 CSRN99                Z-ADDZZWK3     ZZTOTI                          RE0730
0744 C*                                                                   RE0730
0745 C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT. RE0730
0746 CSR 99                Z-ADD0         ZZAMT  153                      RE0730
0747 CSR                   GOTO ZZSEND                                    RE0730
0748 C*                                                                   RE0730
0749 C* THE 'SIGNS' ARE DIFFERENT                                         RE0730
0750 CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**RE0730
0751 C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT            RE0730
0752 C*                                                                   RE0730
0753 CSR 92                Z-SUBZZAMTI    ZZAMTI 150                      RE0730
0754 CSR 92                Z-SUBZZAMTD    ZZAMTD  30                      RE0730
0755 C*                                                                   RE0730
0756 C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.           RE0730
0757 C*                                                                   RE0730
0758 CSR 91                Z-SUBZZTOTI    ZZTOTI                          RE0730
0759 CSR 91                Z-SUBZZTOTD    ZZTOTD                          RE0730
0760 C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.                            RE0730
0761 C*                                                                   RE0730
0762 CSR         ZZTOTI    COMP ZZAMTI               93  95               RE0730
0763 CSR 95      ZZTOTD    COMP ZZAMTD               93  95               RE0730
0764 C*                                                                   RE0730
0765 C* IF ZZTOT EQ. ZZAMT RETURN ZERO.                                   RE0730
0766 CSR 95                Z-ADD0         ZZTOTI                          RE0730
0767 CSR 95                Z-ADD0         ZZTOTD                          RE0730
0768 CSR 95                GOTO ZZSEND                                    RE0730
0769 C*                                                                   RE0730
0770 C* IF ZZTOT GT. ZZAMT.                                               RE0730
0771 CSR 93      ZZAMTD    COMP ZZTOTD               94                   RE0730
0772 CSR 93 94   ZZTOTI    SUB  1         ZZTOTI                          RE0730
0773 CSR 93 94   ZZTOTD    ADD  1000      ZZWK2                           RE0730
0774 CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI                          RE0730
0775 CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD                          RE0730
0776 CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD                          RE0730
0777 C*                                                                   RE0730
0778 C*                                                                   RE0730
0779 C* IF ZZAMT GT. ZZTOT.                                               RE0730
0780 CSRN93      ZZTOTD    COMP ZZAMTD               94                   RE0730
0781 CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150                      RE0730
0782 CSRN93 94   ZZAMTD    ADD  1000      ZZWK2                           RE0730
0783 CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI                          RE0730
0784 CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI                          RE0730
0785 CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD                          RE0730
0786 CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD                          RE0730
0787 C*                                                                   RE0730
0788 C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE          RE0730
0789 CSR                   SETOF                     94                   RE0730
0790 CSR 93 91                                                            RE0730
0791 CORN93 92             SETON                     94                   RE0730
0792 CSR 94                Z-SUBZZTOTI    ZZTOTI                          RE0730
0793 CSR 94                Z-SUBZZTOTD    ZZTOTD                          RE0730
0794 C**                                                                  RE0730
0795 C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.            RE0730
0796 CSR 92                Z-SUBZZAMTI    ZZAMTI                          RE0730
0797 CSR 92                Z-SUBZZAMTD    ZZAMTD                          RE0730
0798 CSR         ZZSEND    TAG                             ** ZZSEND TAG *RE0730
0799 C**                                                                  RE0730
0800 C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.           RE0730
0801 CSR                   SETOF                     96                   RE0730
0802 CSR         ZZTOTD    COMP 0                        91               RE0730
0803 CSR 91      ZZTOTI    COMP 0                      96                 RE0730
0804 CSR 96                MOVE '.000-'   ZZNEGD  5                       RE0730
0805 CSR                   ENDSR                             ** ENDSR **  RE0730
0806 C********************************************************************RE0730
0807 C**                                                                  RE0730
0808 C*****QZFREQ SR. TO INCREMENT A DAY NUMBER DATE BY A                 S01195
0808 C**   FREQ SR. TO INCREMENT A DAY NUMBER DATE BY A                   S01195
0809 C**             PERIOD VALUE DETERMINED BY A CODE.                   RE0730
0810 C**                                                                  RE0730
0811 C***********QZFREQ    BEGSR                           ** QZFREQ ***  S01195
0811 C           FREQ      BEGSR                           **  FREQ  ***  S01195
0812 C**                                                                  RE0730
0813 C**   CALCULATIONS TO DEFINE/CLEAR FIELDS.                           RE0730
0814 C                     MOVE ZFREQ     ZFREQ   1                       RE0730
0815 C                     Z-ADDZDAYNO    ZDAYNO  50                      RE0730
0816 C                     Z-ADDZMDAY     ZMDAY   20                      RE0730
0817 C                     MOVE ZCCY      ZCCY    3                       RE0730
     C                     MOVE ZLOC      ZLOC    3                       S01195
0818 C**                                                                  RE0730
0819 C***********          MOVE '   '     ZHC                             S01195
0820 C***********          MOVE ' '       ZTABKY 12                       S01195
0821 C**                                                                  RE0730
0822 C**   CONVERT DAY NUMBER TO DATE.                                    RE0730
0823 C                     EXSR ZDATE2                                    RE0730
0824 C**                                                                  RE0730
0825 C**   CHECK FOR AND INCREMENT FOR CODE D-DAILY-WORKING DAY.          RE0730
0826 C***********ZFREQ     COMP 'D'                      91               S01195
0827 C***91******ZDAYNO    ADD  1         ZDAYNO                          S01195
0828 C***91******          GOTO ZFHCHK                                    S01195
     C           ZFREQ     IFEQ 'D'                                       S01195
     C                     Z-ADD1         ZNRDYS                          S01195
     C                     EXSR ZFWDT                                     S01195
     C                     Z-ADDZDYNBR    ZDAYNO                          S01195
     C                     GOTO ZFEND                                     S01195
     C                     END                                            S01195
0829 C**                                                                  RE0730
0830 C**   CHECK FOR AND INCREMENT FOR CODE W-WEEKLY.                     RE0730
0831 C           ZFREQ     COMP 'W'                      91               RE0730
0832 C   91      ZDAYNO    ADD  7         ZDAYNO                          RE0730
0833 C   91                GOTO ZFEND                                     RE0730
0834 C**                                                                  RE0730
0835 C**   CHECK FOR AND INCREMENT FOR CODE F-FORTNIGHTLY.                RE0730
0836 C           ZFREQ     COMP 'F'                      91               RE0730
0837 C   91      ZDAYNO    ADD  14        ZDAYNO                          RE0730
0838 C   91                GOTO ZFEND                                     RE0730
0839 C**                                                                  RE0730
0840 C**   CHECK FOR AND INCREMENT FOR CODE S-SEMI-MONTHLY.               RE0730
0841 C           ZFREQ     COMP 'S'                      91               RE0730
0842 C   91      ZDAY      COMP 15                   939292               RE0730
0843 C   91 92             Z-ADD31        ZDAY                            RE0730
0844 C   91 93             Z-ADD15        ZDAY                            RE0730
0845 C   91 93   ZMTH      ADD  1         ZMTH                            RE0730
0846 C   91                GOTO ZFDATE                                    RE0730
0847 C**                                                                  RE0730
0848 C**   CHECK FOR AND INCREMENT FOR CODE M-MONTHLY.                    RE0730
0849 C           ZFREQ     COMP 'M'                      91               RE0730
0850 C   91                Z-ADDZMDAY     ZDAY                            RE0730
0851 C   91      ZMTH      ADD  1         ZMTH                            RE0730
0852 C   91                GOTO ZFDATE                                    RE0730
0853 C**                                                                  RE0730
0854 C**   CHECK FOR AND INCREMENT FOR CODE R-SIX DAYS BEFORE END OF MONTHRE0730
0855 C           ZFREQ     COMP 'R'                      91               RE0730
0856 C   91                Z-ADD31        ZDAY                            RE0730
0857 C   91      ZMTH      ADD  1         ZMTH                            RE0730
0858 C   91                GOTO ZFDATE                                    RE0730
0859 C**                                                                  RE0730
0860 C**   CHECK FOR AND INCREMENT FOR CODE T-BIMONTHLY.                  RE0730
0861 C           ZFREQ     COMP 'T'                      91               RE0730
0862 C   91                Z-ADDZMDAY     ZDAY                            RE0730
0863 C   91      ZMTH      ADD  2         ZMTH                            RE0730
0864 C   91                GOTO ZFDATE                                    RE0730
0865 C**                                                                  RE0730
0866 C**   CHECK FOR AND INCREMENT FOR CODE Q-QUARTERLY.                  RE0730
0867 C           ZFREQ     COMP 'Q'                      91               RE0730
0868 C   91                Z-ADDZMDAY     ZDAY                            RE0730
0869 C   91      ZMTH      ADD  3         ZMTH                            RE0730
0870 C   91                GOTO ZFDATE                                    RE0730
0871 C**                                                                  RE0730
0872 C**   CHECK FOR AND INCREMENT FOR CODE X-SIX MONTHLY.                RE0730
0873 C           ZFREQ     COMP 'X'                      91               RE0730
0874 C   91                Z-ADDZMDAY     ZDAY                            RE0730
0875 C   91      ZMTH      ADD  6         ZMTH                            RE0730
0876 C   91                GOTO ZFDATE                                    RE0730
0877 C**                                                                  RE0730
0878 C**   CHECK FOR AND INCREMENT FOR CODE Y-YEARLY.                     RE0730
0879 C           ZFREQ     COMP 'Y'                      91               RE0730
0880 C   91      ZYEAR     ADD  1         ZYEAR                           RE0730
0881 C   91                GOTO ZFDATE                                    RE0730
0882 C**                                                                  RE0730
0883 C**   CHECK FOR AND INCREMENT FOR CODE L-LAST CALENDAR DAY OF MONTH. RE0730
0884 C           ZFREQ     COMP 'L'                      91               RE0730
0885 C   91                Z-ADD31        ZDAY                            RE0730
0886 C   91      ZMTH      ADD  1         ZMTH                            RE0730
0887 C   91                GOTO ZFDATE                                    RE0730
0888 C**                                                                  RE0730
0889 C**   CHECK FOR AND INCREMENT FOR CODE B-LAST WORKING DAY OF MONTH.  RE0730
0890 C           ZFREQ     COMP 'B'                      91               RE0730
0891 C   91                Z-ADD31        ZDAY                            RE0730
0892 C   91      ZMTH      ADD  1         ZMTH                            RE0730
0893 C   91                GOTO ZFDATE                                    RE0730
0894 C**                                                                  RE0730
0895 C**   CHECK FOR AND INCREMENT FOR CODE A-MONTHLY ACCRUAL/PROFIT DATE.RE0730
0896 C           ZFREQ     COMP 'A'                      91               RE0730
0897 C                     MOVEL'01    '  ZTABKY                          RE0730
0898 C   91                MOVE '    11'  ZTABKY                          RE0730
0899 C   91      ZTABKY    CHAINTABLE                99    ON NOT THERE   RE0730
0900 C  N99      RECI      COMP '*'                      99               RE0730
0901 C   91N99             Z-ADDAPDA      ZDAYNO                          RE0730
0902 C**                                                                  RE0730
0903 C**   BYPASS IF ZFREQ IS 'A' OR ANY OTHER VALUE                      RE0730
0904 C                     GOTO ZFEND                                     RE0730
0905 C**                                                                  RE0730
0906 C**                                                                  RE0730
0907 C**   REFORMAT DATE AND ENSURE VALID.                                RE0730
0908 C           ZFDATE    TAG                             ** ZFDATE TAG* RE0730
0909 C**                                                                  RE0730
0910 C**   VALIDATE MONTH.                                                RE0730
0911 C           ZMTH      COMP 12                   91                   RE0730
0912 C   91      ZMTH      SUB  12        ZMTH                            RE0730
0913 C   91      ZYEAR     ADD  1         ZYEAR                           RE0730
0914 C**                                                                  RE0730
0915 C**   CHECK FOR LEAP YEAR.                                           RE0730
0916 C           ZYEAR     DIV  4         ZLYR    20                      RE0730
0917 C                     MVR            ZLY     10     92LEAP YEAR-92 ONRE0730
0918 C**                                                                  RE0730
0919 C**   VALIDATE DAY NUMBER.                                           RE0730
0920 C                     MOVE ZFMD,ZMTH ZWRK2   20                      RE0730
0921 C           ZMTH      COMP 2                        93               RE0730
0922 C   92 93             Z-ADD29        ZWRK2                           RE0730
0923 C**                                                                  RE0730
0924 C           ZDAY      COMP ZWRK2                94                   RE0730
0925 C   94                Z-ADDZWRK2     ZDAY                            RE0730
0926 C**                                                                  RE0730
0927 C**   CHECK IF CODE R, TO SUBTRACT 6 DAYS.                           RE0730
0928 C           ZFREQ     COMP 'R'                      91               RE0730
0929 C   91      ZDAY      SUB  6         ZDAY                            RE0730
0930 C**                                                                  RE0730
0931 C**   REFORMAT DATE, DDMMYY OR MMDDYY, AND CONVERT TO DAY NUMBER.    RE0730
0932 C                     MOVELZDAY      ZWRK4   40                      RE0730
0933 C                     MOVE ZMTH      ZWRK4                           RE0730
0934 C   98                MOVELZMTH      ZWRK4                           RE0730
0935 C   98                MOVE ZDAY      ZWRK4                           RE0730
0936 C                     MOVELZWRK4     ZDATE                           RE0730
0937 C                     MOVE ZYEAR     ZDATE                           RE0730
0938 C                     EXSR ZDATE1                                    RE0730
0939 C**                                                                  RE0730
0940 C**   CHECK IF CODE B,TO BE CHECKED FOR HOLIDAY.                     RE0730
0941 C           ZFREQ     COMP 'B'                      91               RE0730
0942 C   91N99             GOTO ZFHCHK                                    RE0730
0943 C**                                                                  RE0730
0944 C                     GOTO ZFEND                                     RE0730
0945 C**                                                                  RE0730
0946 C**                                                                  RE0730
0947 C**   CHECK IF DAY NUMBER IS A HOLIDAY.                              RE0730
0948 C           ZFHCHK    TAG                             ** ZFHCHK TAG *RE0730
     C**                                                                  S01195
     C**   IF FREQUENCY CODE IS 'B', BACK TO FIND THE NON-HOLIDAY         S01195
     C**   BEFORE THE SPECIFIED DAY NO.                                   S01195
     C**                                                                  S01195
     C                     Z-ADD0         ZNRDYS                          S01195
     C                     EXSR ZBKDT                                     S01195
     C                     Z-ADDZDYNBR    ZDAYNO                          S01195
     C*                                                                   S01195
0949 C***********          SETOF                     94                   S01195
0950 C***********                                                         S01195
0951 C*****DETERMINE CODE.                                                S01195
0952 C***********ZFREQ     COMP 'D'                      91               S01195
0953 C***********ZFREQ     COMP 'B'                      92               S01195
0954 C***********                                                         S01195
0955 C*****SET*KEY FOR FIRST HOLIDAY RECORD.                              S01195
0956 C***********          MOVEL'22    '  ZTABKY                          S01195
0957 C***********          MOVELZDAYNO    ZWRK6   6                       S01195
0958 C***********          MOVE 1         ZWRK6                           S01195
0959 C***********          MOVE ZWRK6     ZTABKY                          S01195
0960 C***********                                                         S01195
0961 C*****GET*HOLIDAY RECORD.                                            S01195
0962 C***********ZFHCHN    TAG                             ** ZFHCHN TAG* S01195
0963 C***********ZTABKY    CHAINTABLE                93    ON NOT THERE   S01195
0964 C**N93******RECI      COMP '*'                      93               S01195
0965 C**N94******          MOVE '   '     ZHC                             S01195
0966 C***********                                                         S01195
0967 C*****STORE*CURRENCIES IF RECORD FOUND.                              S01195
0968 C**N94N93***          MOVEAHCCY      ZHC,1                           S01195
0969 C***94N93***          MOVEAHCCY      ZHC,26                          S01195
0970 C***********                                                         S01195
0971 C*****GET*SECORD RECORD, IF NOT ALREADY DONE.                        S01195
0972 C***********          MOVE ZTABKY    ZWRK1   10                      S01195
0973 C***********ZWRK1     COMP 1                        94               S01195
0974 C***********          MOVE '2'       ZTABKY                          S01195
0975 C***94N93***          GOTO ZFHCHN                                    S01195
0976 C***********                                                         S01195
0977 C*****BYPASS TO END IF NO FIRST RECORD FOUND.                        S01195
0978 C***93*94***          GOTO ZFEND                                     S01195
0979 C***********                                                         S01195
0980 C*****DETERMINE HOLIDAY RECORD TYPE.                                 S01195
0981 C***********INEX      COMP 'E'                      95               S01195
0982 C***********INEX      COMP 'I'                      96               S01195
0983 C***********                                                         S01195
0984 C*****CHECK*IF CURRENCY ON HOLIDAY.                                  S01195
0985 C***********ZCCY      LOKUPZHC                      97               S01195
0986 C***********                                                         S01195
0987 C*****BYPASS IF NOT HOLIDAY FOR CURRENCY.                            S01195
0988 C***95*97***                                          EXCLUDE FOUND  S01195
0989 C*R*96N97***          GOTO ZFEND                      INCL. NOT FOUNDS01195
0990 C***********                                                         S01195
0991 C*****INCREMENT OR DECREMENT DAY NUMBER AS REQUIRED.                 S01195
0992 C***91*95N97                                          EXCL. NOT FOUNDS01195
0993 C*R*91*96*97ZDAYNO    ADD  1         ZDAYNO           INCLUDE FOUND  S01195
0994 C***********                                                         S01195
0995 C***92*95N97                                          EXCL. NOT FOUNDS01195
0996 C*R*92*96*97ZDAYNO    SUB  1         ZDAYNO           INCLUDE FOUND  S01195
0997 C***********          GOTO ZFHCHK                                    S01195
0998 C**                                                                  RE0730
0999 C**                                                                  RE0730
1000 C           ZFEND     ENDSR                           * ZFEND ENDSR *RE0730
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZACCH  --- SUBROUTINE TO ACCESS A HOLIDAY RECORD FOR A            S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: ZFWDT, ZBKDT                                         S01195
     C*                                                                   S01195
     C* CALLS: NOTHING                                                    S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZACCH                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZFWDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY            S01195
     C*            FORWARD FROM A GIVEN START DATE FOR ANY                S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: FREQ                                                 S01195
     C*                                                                   S01195
     C* CALLS: ZACCH                                                      S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZFWDT                                                  S01195
     C/EJECT                                                              S01195
     C********************************************************************S01195
     C*                                                                   S01195
     C* ZBKDT  --- SUBROUTINE TO CALCULATE THE NTH WORKING DAY            S01195
     C*            BACKWARD FROM A GIVEN START DATE FOR ANY               S01195
     C*            PARTICULAR CURRENCY AND (OPTIONAL) LOCATION.           S01195
     C*                                                                   S01195
     C* CALLED FROM: FREQ                                                 S01195
     C*                                                                   S01195
     C* CALLS: ZACCH                                                      S01195
     C*                                                                   S01195
     C********************************************************************S01195
     C/COPY ZSRSRC,ZBKDT                                                  S01195
     C/EJECT                                                              S01195
1001 C********************************************************************RE0730
     C/COPY ZSRSRC,ZCHKH                                                  209995
     C/EJECT                                                              209995
1001 C********************************************************************209995
1002 C**                                                                  RE0730
1003 C**   ZDATE1 SR. TO VALIDATE DATES SUBMITTED AND                     RE0730
1004 C**              CONVERT TO A NUMBER OF DAYS.                        RE0730
1005 C**                                                                  RE0730
1006 C           ZDATE1    BEGSR                           *** ZDATE1 *** RE0730
1007 C**                                                                  RE0730
1008 C**   CLEAR DAY NUMBER.                                              RE0730
1009 C                     Z-ADD0         ZDAYNO  50                      RE0730
1010 C**                                                                  RE0730
1011 C**   CALCULATION TO DEFINE INPUT DATE FIELD.                        RE0730
1012 C                     Z-ADDZDATE     ZDATE   60                      RE0730
1013 C**                                                                  RE0730
1014 C**   GET INDIVIDUAL DAY, MONTH AND YEAR FIELDS.                     RE0730
1015 C                     MOVE ZDATE     ZYEAR   20                      RE0730
1016 C  N98                MOVELZDATE     ZDAY    20                      RE0730
1017 C   98                MOVELZDATE     ZMTH    20                      RE0730
1018 C                     MOVE ZDATE     ZWRK4   40                      RE0730
1019 C  N98                MOVELZWRK4     ZMTH                            RE0730
1020 C   98                MOVELZWRK4     ZDAY                            RE0730
1021 C**                                                                  RE0730
1022 C**   ENSURE MONTH IS VALID.                                         RE0730
1023 C           ZMTH      COMP 0                      9999               RE0730
1024 C  N99      ZMTH      COMP 12                   99                   RE0730
1025 C   99                GOTO ZDEND1                     BYPASS IF ERRORRE0730
1026 C**                                                                  RE0730
1027 C**   CHECK FOR 30 DAY MONTHS.                                       RE0730
1028 C           ZMTH      COMP 4                        90IF 90 ON, 30   RE0730
1029 C  N90      ZMTH      COMP 6                        90DAY MONTH.     RE0730
1030 C  N90      ZMTH      COMP 9                        90               RE0730
1031 C  N90      ZMTH      COMP 11                       90               RE0730
1032 C**                                                                  RE0730
1033 C**   ENSURE DAY IS VALID.                                           RE0730
1034 C           ZDAY      COMP 0                      9999               RE0730
1035 C   90N99   ZDAY      COMP 30                   99                   RE0730
1036 C  N90N99   ZDAY      COMP 31                   99                   RE0730
1037 C   99                GOTO ZDEND1                     BYPASS IF ERRORRE0730
1038 C**                                                                  RE0730
1039 C**   CHECK FOR LEAP YEAR AND FEBRUARY.                              RE0730
1040 C           ZYEAR     ADD  28        ZYEAR                           RE0730
1041 C           ZYEAR     DIV  4         ZLYR    20                      RE0730
1042 C                     MVR            ZLY     10     91LEAP YR, 91 ON RE0730
1043 C           ZMTH      COMP 2                    93  92FEB., 92 ON    RE0730
1044 C**                                                   PAST FEB, 93 ONRE0730
1045 C**   IF FEBRUARY FURTHER VALIDATE DAY.                              RE0730
1046 C  N91 92   ZDAY      COMP 28                   99                   RE0730
1047 C   91 92   ZDAY      COMP 29                   99                   RE0730
1048 C   99                GOTO ZDEND1                     BYPASS IF ERRORRE0730
1049 C**                                                                  RE0730
1050 C**   DETERMINE NUMBER OF DAYS FROM 31/12/1971.     NO.OF 4 YR. SPANSRE0730
1051 C           ZLYR      MULT 1461      ZDAYNO           X DAYS IN SPAN.RE0730
1052 C  N91      ZDAYNO    ADD  ZYDY,ZLY  ZDAYNO           SINCE LAST L.YRRE0730
1053 C   91 93   ZDAYNO    ADD  1         ZDAYNO           L.YR.,PAST FEB.RE0730
1054 C           ZDAYNO    ADD  ZMDY,ZMTH ZDAYNO           DAYS THIS YEAR RE0730
1055 C           ZDAYNO    ADD  ZDAY      ZDAYNO           DAYS THIS MONTHRE0730
1056 C**                                                                  RE0730
1057 C           ZDEND1    ENDSR                           * ZDEND1 ENDSR*RE0730
1058 C**                                                                  RE0730
1059 C**                                                                  RE0730
1060 C********************************************************************RE0730
1061 C**                                                                  RE0730
1062 C**   ZDATE2 SR. TO CONVERT A DAY NUMBER TO DATE FORMATS.            RE0730
1063 C**                                                                  RE0730
1064 C           ZDATE2    BEGSR                           *** ZDATE2 *** RE0730
1065 C**                                                                  RE0730
1066 C**   CLEAR DATE FIELDS.                                             RE0730
1067 C                     Z-ADD0         ZDATE   60                      RE0730
1068 C                     MOVEL'       ' ZADATE  7                       RE0730
1069 C**                                                                  RE0730
1070 C**   CALCULATION TO DEFINE INPUT DAY NUMBER.                        RE0730
1071 C                     Z-ADDZDAYNO    ZDAYNO  50                      RE0730
1072 C**                                                                  RE0730
1073 C**   DETERMINE YEAR NUMBER.                                         RE0730
1074 C**                                                                  RE0730
1075 C**   ADJUST DAY NUMBER IN CASE LAST DAY OF YEAR.                    RE0730
1076 C           ZDAYNO    SUB  1         ZDAYN1  50   99                 RE0730
1077 C   99                GOTO ZDEND2                                    RE0730
1078 C**                                                                  RE0730
1079 C**   CALCULATE NUMBER OF 4 YEAR SPANS SINCE 31/12/1971.             RE0730
1080 C           ZDAYN1    DIV  1461      ZLYR    20                      RE0730
1081 C                     MVR            ZDAYN1           SAVE REMAINING RE0730
1082 C**                                                   DAYS           RE0730
1083 C**   CALCULATE NUMBER OF REMAINING YEARS.                           RE0730
1084 C                     Z-ADD1         ZWRK2   20                      RE0730
1085 C           ZDTAG1    TAG                             ** ZDTAG1 TAG *RE0730
1086 C           ZDAYN1    COMP ZYDY,ZWRK2             90                 RE0730
1087 C  N90      ZWRK2     ADD  1         ZWRK2                           RE0730
1088 C  N90                GOTO ZDTAG1                                    RE0730
1089 C           ZWRK2     SUB  1         ZWRK2          91LEAP YR, 91 ON RE0730
1090 C**                                                                  RE0730
1091 C**   DECREMENT DAY NO. BY DAYS IN REMAINING YEARS.                  RE0730
1092 C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1                          RE0730
1093 C**                                                                  RE0730
1094 C**   CALCULATE ACTUAL YEAR NUMBER.                                  RE0730
1095 C           ZLYR      MULT 4         ZWRK3   30                      RE0730
1096 C           ZWRK3     ADD  72        ZWRK3            BASE IS 1972   RE0730
1097 C                     Z-ADDZWRK3     ZYEAR   20                      RE0730
1098 C           ZYEAR     ADD  ZWRK2     ZYEAR            YEAR           RE0730
1099 C**                                                                  RE0730
1100 C**   DETERMINE MONTH NUMBER.                                        RE0730
1101 C**                                                                  RE0730
1102 C**   ADJUST DAY NO. IN CASE LAST DAY OF LEAP YEAR FEBRUARY.         RE0730
1103 C                     SETOF                     9293                 RE0730
1104 C   91      ZDAYN1    COMP 59                     9293               RE0730
1105 C   91N92   ZDAYN1    SUB  1         ZDAYN1                          RE0730
1106 C**                                                                  RE0730
1107 C**   CALCULATE MONTH NUMBER.                                        RE0730
1108 C                     Z-ADD2         ZWRK2                           RE0730
1109 C           ZDTAG2    TAG                             ** ZDTAG2 TAG *RE0730
1110 C           ZDAYN1    COMP ZMDY,ZWRK2             94                 RE0730
1111 C  N94      ZWRK2     ADD  1         ZWRK2                           RE0730
1112 C  N94                GOTO ZDTAG2                                    RE0730
1113 C           ZWRK2     SUB  1         ZWRK2                           RE0730
1114 C**                                                                  RE0730
1115 C                     Z-ADDZWRK2     ZMTH    20       MONTH          RE0730
1116 C**                                                                  RE0730
1117 C**   DETERMINE DAY OF MONTH.                                        RE0730
1118 C**                                                                  RE0730
1119 C**   ADD BACK LAST DAY OF YEAR ADJUSTMENT.                          RE0730
1120 C           ZDAYN1    ADD  1         ZDAYN1                          RE0730
1121 C**                                                                  RE0730
1122 C**   CALCULATE DAY OF MONTH.                                        RE0730
1123 C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY            RE0730
1124 C**                                                                  RE0730
1125 C**   ADD BACK LEAP YEAR 29TH FEBUARY ADJUSTMENT, IF REQUIRED.       RE0730
1126 C   93      ZDAY      ADD  1         ZDAY                            RE0730
1127 C**                                                                  RE0730
1128 C**   FORMAT DATE, DDMMYY OR MMDDYY.                                 RE0730
1129 C  N98                MOVELZDAY      ZWRK4   40                      RE0730
1130 C   98                MOVE ZDAY      ZWRK4                           RE0730
1131 C  N98                MOVE ZMTH      ZWRK4                           RE0730
1132 C   98                MOVELZMTH      ZWRK4                           RE0730
1133 C                     MOVELZWRK4     ZDATE                           RE0730
1134 C                     MOVE ZYEAR     ZDATE                           RE0730
1135 C**                                                                  RE0730
1136 C**   FORMAT ALPHA DATE, DDMMMYY.                                    RE0730
1137 C           ZDAY      COMP 10                     95                 RE0730
1138 C                     MOVELZDAY      ZWRK5   5                       RE0730
1139 C   95                MOVEL' '       ZWRK5                           RE0730
1140 C                     MOVE ZMNM,ZMTH ZWRK5                           RE0730
1141 C                     MOVELZWRK5     ZADATE                          RE0730
1142 C                     MOVE ZYEAR     ZADATE                          RE0730
1143 C**                                                                  RE0730
1144 C           ZDEND2    ENDSR                           * ZDEND2 ENDSR*RE0730
1145 C**                                                                  RE0730
1146 C**                                                                  RE0730
1147 C********************************************************************RE0730
     C**  ERRSR1 - SR TO OUTPUT ERROR REPORT FOR MISSING HEADER FILE.     E17948
     C**                                                                  E17948
     C           ERRSR1    BEGSR                                          E17948
     C                     MOVEL'H'       DBKEY                           E17948
     C                     MOVE 'STANDSA' DBFILE                          E17948
     C                     MOVE '01'      DBASE                           E17948
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     SETON                     U7                   E17948
     C                     ENDSR                                          E17948
     C*                                                                   E17948
1147 C********************************************************************E17948
     C**  ERRSR2 - SR TO OUTPUT ERROR REPORT FOR MISSING TRAILER FILE     E17948
     C**                                                                  E17948
     C           ERRSR2    BEGSR                                          E17948
     C                     MOVEL'11'      DBASE                           E17948
     C                     MOVE 'STANDSC' DBFILE                          E17948
     C                     MOVE BLANKS    DBKEY                           E17948
     C                     MOVE '01'      DBKEY                           E17948
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     SETON                     U7                   E17948
     C                     ENDSR                                          E17948
     C*                                                                   E17948
1147 C********************************************************************E17948
0655 C**                                                                  S01117
0656 C**   SR. TO SET UP AN ARRAY OF BRANCH DETAILS FROM THE BRANCH       S01117
0657 C**   CODE TABLE  - LOADED TOP DOWN                                  S01117
0658 C**                                                                  S01117
0659 C           BCTARR    BEGSR                           *** BCTARR  ***S01117
0660 C**                                                                  S01117
0661 C*****SET*ARRAY*INDEX*TO*150.*********************************S01117 151104
0662 C***********          Z-ADD151       IX      30               S01117 151104
     C**   SET ARRAY INDEX TO 900.                                        151104
     C                     Z-ADD901       IX      30                      151104
     C*                                                                   LN0153
     C                     READ SDBRCHPD                 16               LN0153
     C*                                                                   LN0153
     C* DATABASE ERROR IF EMPTY FILE                                      LN0153
     C*                                                                   LN0153
     C           *IN16     IFEQ '1'                                       LN0153
     C                     MOVEL'SDBRCHPD'DBFILE           ***************LN0153
     C                     Z-ADD13        DBASE            ** DBERR 013 **LN0153
     C                     SETON                     U7LR  ***************LN0153
     C                     GOTO IXEND                                     LN0153
     C*                                                                   LN0153
     C                     ELSE                                           LN0153
     C                     GOTO FOUND                                     LN0153
     C                     END                                            LN0153
     C*                                                                   LN0153
     C*****RESET*THE*FILE*POINTER*TO*TOP*OF*FILE***SDBRCHPD         S01117LN0153
     C*****BY*READING*THE*FIRST*RECORD.                             S01117LN0153
     C**********           CALL 'AOBRCHR0'                          S01117LN0153
     C**********           PARM '*MSG   ' @RTCD   7                 S01117LN0153
     C**********           PARM '*FIRST ' @OPTN   7                 S01117LN0153
     C**********           PARM           @DSNB   3                 S01117LN0153
     C**********           PARM           SDBRCH                    S01117LN0153
     C**********           GOTO TESTRC                              S01117LN0153
0670 C**********                                                    S01117LN0153
0671 C*****LOOP*TO*READ BRANCH DETAIL RECORDS.                      S01117LN0153
0672 C********** IXLOOP    TAG                             **IXLOOP S01117LN0153
     C**********           CALL 'AOBRCHR0'                          S01117LN0153
     C**********           PARM '*MSG   ' @RTCD   7                 S01117LN0153
     C**********           PARM '*NEXT  ' @OPTN   7                 S01117LN0153
     C**********           PARM           @DSNB   3                 S01117LN0153
     C********** SDBRCH    PARM SDBRCH    DSFDY                     S01117LN0153
     C**********                                                    S01117LN0153
     C**********                                                    S01117LN0153
     C*****END*IF*ALL*BRANCH*RECORDS*PROCESSED                      S01117LN0153
     C********** TESTRC    TAG                                      S01117LN0153
     C********** @RTCD     IFEQ '*EOF'                     *B1      S01117LN0153
     C**********           GOTO IXEND                               S01117LN0153
     C**********           ELSE                            *X1      S01117LN0153
     C**********                                                    S01117LN0153
     C*****END*IF*DATABASE*ERROR                                    S01117LN0153
     C********** @RTCD     IFNE *BLANK                     *B2      S01117LN0153
     C**********           MOVEL'SDBRCHPD'DBFILE           *********S01117LN0153
     C**********           MOVEL@OPTN     DBKEY            ** DBERR S01117LN0153
     C**********           Z-ADD13        DBASE            *********S01117LN0153
     C**********           MOVEL@OPTN     DBOPTN  7                 S01117LN0153
     C**********           SETON                     U7LR           S01117LN0153
     C**********           GOTO IXEND                               S01117LN0153
     C**********           END                             *E2      S01117LN0153
     C**********           END                             *E1      S01117LN0153
0684 C**********                                                    S01117LN0153
0685 C*****DECREMENT*ARRAY*INDEX.                                   S01117LN0153
0686 C********** IX        SUB  1         IX                        S01117LN0153
0687 C**********                                                    S01117LN0153
      *                                                                   LN0153
      ** REPLACE WITH READ OF SDBRCHPD                                    LN0153
      *                                                                   LN0153
     C           IXLOOP    TAG                             **IXLOOP S01117LN0153
      *                                                                   LN0153
     C                     READ SDBRCHPD                 16               LN0153
      *                                                                   LN0153
     C           *IN16     IFNE '1'                                       LN0153
     C*                                                                   LN0153
     C           FOUND     TAG                                            LN0153
     C*    DECREMENT ARRAY INDEX.                                         LN0153
     C           IX        SUB  1         IX                              LN0153
     C*                                                                   LN0153
0688 C**   MOVE DATA INTO ARRAYS.                                         S01117
0689 C                     MOVE BRCH      BCC,IX                          S01117
0689 C                     MOVE BICN      DBICN                           S01117
0689 C                     MOVE ADTO      DADTO                           S01117
0689 C                     MOVE ADFR      DADFR                           S01117
0689 C                     MOVE BRNM      DBRNM                           S01117
     C                     MOVE *BLANKS   DTYPTO                          S01117
     C                     MOVE *BLANKS   DTYPFR                          S01117
     C                     MOVE *BLANKS   DSECTO                          S10736
     C                     MOVE *BLANKS   DSECFR                          S10736
 822 C*                                                                   S01117
0551 C*    ACCESS ACCOUNT CODES TABLE TO OBTAIN ACCOUNT TYPES             S01117
0551 C*    WHEN MBIN = 'Y' ONLY                                           S01117
0551 C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C*                                                                   S01117
     C                     CALL 'AOACODR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C**********           PARM DADTO     @AFNB   4                                    S01117 CGL029
     C                     PARM DADTO     @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01117 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@AFNB     DBKEY                           S01117
     C                     MOVEL'SDACODPD'DBFILE           ***************S01117
     C                     Z-ADD14        DBASE            * DBERROR 014 *S01117
     C**********           MOVEL@OPTN     DBOPTN  7        *********S01117LN0153
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     SETON                     U7LR                 S01117
     C                     GOTO IXEND                                     S01117
     C                     END                                            S01117
     C                     MOVE ATYP      DTYPTO                          S01117
     C                     MOVE ACSC      DSECTO                          S10736
     C*                                                                   S01117
     C                     CALL 'AOACODR0'                                S01117
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C**********           PARM DADFR     @AFNB   4                                    S01117 CGL029
     C                     PARM DADFR     @AFNB                                               CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                        S01117 CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@AFNB     DBKEY                           S01117
     C                     MOVEL'SDACODPD'DBFILE           ***************S01117
     C                     Z-ADD15        DBASE            * DBERROR 015 *S01117
     C**********           MOVEL@OPTN     DBOPTN  7        ***************S01117
     C                     MOVE *ON       *IN98                                             BUG12587
     C                     SETON                     U7LR                 S01117
     C                     GOTO IXEND                                     S01117
     C                     END                                            S01117
     C                     MOVE ATYP      DTYPFR                          S01117
     C                     MOVE ACSC      DSECFR                          S10736
     C*                                                                   S01117
     C                     END                                            S01117
     C*                                                                   S01117
0689 C                     MOVE DBCI      BCT,IX                          S01117
0691 C**                                                                  S01117
0692 C**   CHECK FOR FULL ARRAY. 96 ON IF FULL.                           S01117
0693 C           IX        COMP 1                        96               S01117
0694 C**                                                                  S01117
0695 C**   GO TO READ NEXT RECORD.                                        S01117
0696 C  N96                GOTO IXLOOP                                    S01117
0697 C**                                                                  S01117
     C                     END                                            LN0153
     C*                                                                   LN0153
0698 C           IXEND     TAG                             **IXEND TAG  **S01117
0694 C**                                                                  S01117
0695 C**   STORE NO. OF TABLE RECS                                        S01117
0698 C                     Z-ADDIX        STIX    30                      S01117
0699 C                     ENDSR                                          S01117
0700 C**                                                                  S01117
     C*****************************************************************   209995
     C*                                                               *   209995
     C*  NOSEVT - SUBROUTINE TO WRITE NOSTRO EVENTS                   *   209995
     C*                                                               *   209995
     C*  CALLED BY: MAIN PROCESSING                                   *   209995
     C*                                                               *   209995
     C*  CALLS    :                                                   *   209995
     C*                                                               *   209995
     C*****************************************************************   209995
     C*                                                                   209995
     C           NOSEVT    BEGSR                                          209995
      *                                                                   209995
      ** Check if the first payment date falls w/in the no. of days       209995
      ** forward fo project.                                              209995
      *                                                                   209995
     C           DFPY      IFLE REPDAY                                    209995
      *                                                                   209995
     C           DFPY      IFGT RUND                                      209995
      *                                                                   209995
     C                     Z-ADDDFPY      NSEDAT                          209995
     C                     Z-ADDAFPY      NSEAMT                          209995
     C                     EXSR SRHOL                                     209995
     C                     WRITERENESOD0                                  209995
     C                     ADD  1         TNORE   30                      209995
     C                     ADD  NSEAMT    TEAMT  150                      209995
     C*                                                                   209995
     C                     ENDIF                                          209995
      *                                                                   209995
      ** Check if the second payment date falls w/in the no. of days      209995
      ** forward fo project.                                              209995
      *                                                                   209995
     C           DSPY      IFLE REPDAY                                    209995
      *                                                                   209995
     C           DSPY      IFGT RUND                                      209995
      *                                                                   209995
     C                     Z-ADDDSPY      NSEDAT                          209995
     C           ASPY      IFNE *ZERO                                     209995
     C                     Z-ADDASPY      NSEAMT                          209995
     C                     ELSE                                           209995
     C                     Z-ADDAFPY      NSEAMT                          209995
     C                     ENDIF                                          209995
     C                     EXSR SRHOL                                     209995
     C                     WRITERENESOD0                                  209995
     C                     ADD  1         TNORE                           209995
     C                     ADD  NSEAMT    TEAMT                           209995
     C*                                                                   209995
     C                     ENDIF                                          209995
     C*                                                                   209995
     C           NXTP      IFLE DSPY                                      209995
     C                     Z-ADDDSPY      NXTPP                           209995
     C                     ELSE                                           209995
     C                     Z-ADDNXTP      NXTPP   50                      209995
     C                     END                                            209995
     C*                                                                   209995
     C           NXTPP     DOWLEREPDAY                                    209995
     C           NXTPP     ANDLTDLPY                                      209995
      *                                                                   209995
     C           NXTPP     IFNE DFPY                                      209995
     C           NXTPP     ANDNEDSPY                                      209995
     C                     Z-ADDNXTPP     NSEDAT                          209995
     C           ASPY      IFNE *ZERO                                     209995
     C                     Z-ADDASPY      NSEAMT                          209995
     C                     ELSE                                           209995
     C                     Z-ADDAFPY      NSEAMT                          209995
     C                     ENDIF                                          209995
      *                                                                   209995
     C                     EXSR SRHOL                                     209995
     C                     WRITERENESOD0                                  209995
     C                     ADD  1         TNORE                           209995
     C                     ADD  NSEAMT    TEAMT                           209995
     C                     ENDIF                                          209995
      *                                                                   209995
     C           PAYF      IFEQ 'A'                                       209995
     C           NXTPP     ANDLERUND                                      209995
     C                     Z-ADDAPDA      ZDAYNO                          209995
     C                     MOVE APFQ      ZFREQ                           209995
     C                     Z-ADDFDAY      ZMDAY                           209995
     C                     ELSE                                           209995
     C                     Z-ADDNXTPP     ZDAYNO                          209995
     C                     MOVE PAYF      ZFREQ                           209995
     C                     Z-ADDDYTP      ZMDAY                           209995
     C                     END                                            209995
     C                     MOVELCCY       ZCCY                            209995
     C                     MOVE *BLANKS   ZLOC                            209995
     C           PAYF      IFEQ 'A'                                                         BUG27982
     C           APDA      ANDLEREPDAY                                                      BUG27982
     C                     MOVE APFQ      ZFREQ                                             BUG27982
     C                     ENDIF                                                            BUG27982
     C                     EXSR FREQ                                      209995
     C           NXTPP     IFEQ 0                                                           BUG12751
     C* If next payment date = 0 for some frequency codes then this is an                   BUG12751
     C* infinite  loop writing records: Issue database error                                BUG12751
     C                     MOVE '037'     DBASE            ***************                  BUG12751
     C                     MOVE 'STANDSB' DBFILE           *   ERROR 37  *                  BUG12751
     C                     MOVE BLANKS    DBKEY            ***************                  BUG12751
     C                     MOVEL'DYTPY=0' DBKEY                                             BUG12751
     C                     MOVE *ON       *INU7                                             BUG12751
     C                     MOVE *ON       *INU8                                             BUG12751
     C                     MOVE *ON       *INLR                                             BUG12751
     C                     DUMP                                                             BUG12751
     C                     RETRN                                                            BUG12751
     C                     END                                                              BUG12751
     C                     Z-ADDZDAYNO    NXTPP                           209995
      *                                                                   209995
     C                     ENDDO                                          209995
     C*                                                                   209995
     C           DLPY      IFLE REPDAY                                    209995
     C           DLPY      ANDGTRUND                                      209995
      *                                                                   209995
     C                     Z-ADDDLPY      NSEDAT                          209995
      *                                                                   209995
     C           ALPY      IFNE *ZERO                                     209995
     C                     Z-ADDALPY      NSEAMT                          209995
      *                                                                   209995
     C                     ELSE                                           209995
      *                                                                   209995
     C           ASPY      IFNE *ZERO                                     209995
     C                     Z-ADDASPY      NSEAMT                          209995
     C                     ELSE                                           209995
     C                     Z-ADDAFPY      NSEAMT                          209995
     C                     ENDIF                                          209995
      *                                                                   209995
     C                     ENDIF                                          209995
      *                                                                   209995
     C                     EXSR SRHOL                                     209995
     C                     WRITEDLNEEDD0                                  209995
     C                     ADD  1         TNORE                           209995
     C                     ADD  NSEAMT    TEAMT                           209995
      *                                                                   209995
     C                     ENDIF                           ENDIF3         209995
     C*                                                                   209995
     C                     ENDIF                           ENDIF2         209995
     C*                                                                   209995
     C                     ENDIF                           ENDIF1         209995
     C*                                                                   209995
     C           NOSEND    ENDSR                                          209995
     C*                                                                   209995
     C/EJECT                                                              209995
      ****************************************************************    209995
      *                                                                   209995
      * SRHOL  --- Subroutine to check if the event date falls on a       209995
      *            holiday.                                               209995
      *                                                                   209995
      * CALLED FROM: NOSEVT subroutine                                    209995
      *                                                                   209995
      * CALLS: ZCHKH subroutine                                           209995
      *                                                                   209995
      ********************************************************************209995
      *                                                                   209995
     C           SRHOL     BEGSR                           ** SRHOL **    209995
      *                                                                   209995
     C                     Z-ADD0         ZDAYNO                          209995
     C                     MOVE *BLANKS   ZCCY                            209995
     C                     MOVE *BLANKS   ZLOC                            209995
      *                                                                   209995
     C                     Z-ADDNSEDAT    ZDAYNO                          209995
     C                     MOVE CCY       ZCCY                            209995
     C                     MOVE LOCY      ZLOC                            209995
     C                     EXSR ZCHKH                                     209995
      *                                                                   209995
     C           ZIND      DOWEQ'H'                                       209995
     C                     ADD  1         ZDAYNO                          209995
     C                     EXSR ZCHKH                                     209995
     C                     ENDDO                                          209995
      *                                                                   209995
     C                     MOVE ZDAYNO    NSEDAT                          209995
      *                                                                   209995
     C                     ENDSR                           ** SRHOL **    209995
      *                                                                   209995
     C/EJECT                                                              209995
      *                                                                   209995
     C********************************************************************S01117
     C*                                                                   S01117
     C* *PSSR  --- SUBROUTINE TO HANDLE ABNORMAL ERROR CONDITIONS         S01117
     C*                                                                   S01117
     C* CALLED FROM: AFTER ABNORNAL OPERATION OCCURS                      S01117
     C*                                                                   S01117
     C* CALLS: NOTHING                                                    S01117
     C*                                                                   S01117
     C********************************************************************S01117
     C*                                                                   S01117
     C           *PSSR     BEGSR                           ** *PSSR **    S01117
     C*                                                                   S01117
     C           @RUN      IFEQ *BLANKS                                   S01117
     C                     MOVE 'Y'       @RUN    1                       S01117
     C                     DUMP                                           S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C                     ENDSR                           ** *PSSR **    S01117
     C********************************************************************S01117
     C/COPY WNCPYSRC,RE0730C005
     C/COPY ZSRSRC,ZCONVZ1                                                                  AR858062
1148 C*                                                   *               RE0730
1149 O***********                                                   RE0730CCB002
1150 O*****UPDATE MEMO RECORD                                       RE0730CCB002
1151 O***********                                                   RE0730CCB002
1152 O***********MEMO    E        U1 16 14                          RE0730CCB002
1153 O***********                         GRBLO     16              RE0730CCB002
1154 O***********                         NETBO     31              RE0730CCB002
1151 O*                                                                   S01154
1152 ORSACMTPOE        U1 16 14                                           S01154
     O       AND      N25N27N88                                           209995
     O       OR        U1 16 14                                           209995
     O       AND       25N28N88                                           209995
1151 O                         *ALL                                       S01154
     O/COPY WNCPYSRC,RE0730O005
1155 O**                                                                  RE0730
1156 O*    UPDATE STAND RECORD                                            RE0730
1157 O*                                                                   RE0730
1158 O*TAND***E**     NU1 53                                              S01117
1158 OSTANDL1 E       NU1 53                                              S01117
1159 O                       48           1 '*'                           RE0730
1160 O                         DLMVO    102P                              RE0730
1161 O                         NXTPO    105P                              RE0730
1162 O**   UPDATE TRAILER CONTROLS                                        RE0730
1163 O        D        03NU1                                              RE0730
1164 O                         NSAU      67P                              RE0730
1165 O                         VALINT    75P                              RE0730
1166 O                         VALDEC    77P                              RE0730
1167 O**                                                                  RE0730
1168 O**                                                                  RE0730
1169 O*    GENERATED ENTRIES - STANDING ORDERS                            RE0730
1170 OGESOHH  D        1PNU1                                              RE0730
1171 O                                    1 'H'                           RE0730
1172 O*                                                                   RE0730
1173 O*    DEBIT SUSPENSE POSTING RECORD                                  RE0730
1174 O*                                                                   RE0730
1175 OGESOPD  E        42NU1                                              RE0730
1176 O                                    1 'P'                           RE0730
1177 O***                      BICN       7                               RE0730
     O***********           N70BICN       7                               S01117
     O***********            70DRBICN     7                               S01117
     O                         DBICN      7                               S01117
1178 O                         CCY       10                               RE0730
1179 O**********               COMS      14                                            RE0730 CGL029
     O                         ACODQQ    14                                                AR1091700
1180 O                                   16 '01'                          RE0730
     O**********               ZERO10    32                         S01117S01413
     O                         Z10       32                               S01413
1181 O                         RUND      35P                              RE0730
1182 O                         RUND      38P                              RE0730
1183 O***********************************43 '91000'                RE0730 S01466
     O                         TRAT      43                               S01466
1184 O***********              PNAR      73                         RE0730S01522
1185 O***********            21NARR      73                         RE0730S01522
     O                         O#PNA2    73                               S01522
1186 O                         AMOUNT    80P                              RE0730
1187 O                                   81 '0'                           RE0730
     O                                   87 '000000'                      S10736
     O                         Z8        95                               S01413
1188 O                                  102 'GE-SO'                       RE0730
1189 O***                      BRCD     105                               RE0730
     O***********              DRBRCD   105                               S01117
     O                         DRBR     105                               S01117
1190 O                                  106 '0'                           RE0730
     O                         ZERO3    108P                              S01413
     O                         ZERO5    114P                                               AR1091700
1191 O***********                       124 'G'                           E13024
1191 O                         ACTP     124                               E13024
1191 O                         PRIN     128                               E15459
1192 O                                  129 'O'                           RE0730
1193 O                                  130 '1'                           RE0730
     O**********               PRFC     134                         S01182S01117
     O                 39      PRFC     134                               S01117
     O                 39 65   FTPRFP   134                               CAC001
     O                         PTIM     140                               S10736
     O                         VOIN     141                               S10736
     O                         ACCS     146                               S10736
     O                         LTAI     147                                                AR1091700
     O                         OSWCR    176                               S05452
     O                                  200 '000000'                      S05452
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         ZERO5    271P                              S01413
     O                         Z13      279P                              S01413
     O                         ORAMT    316P                                               AR1091700
     O                         XRFN     329                                                AR1091700
     O                         ACKEY    351                                                   CGL020
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         COMS     599                                                   CGL029
     O                         OTRF     620                                                   CGL029
1194 O*                                                                   RE0730
1195 O*    DEBIT POSTING RECORD                                           RE0730
1196 O*                                                                   RE0730
1197 O        E        44NU1                                              RE0730
1198 O                                    1 'P'                           RE0730
1199 O                         DCUS       7                               RE0730
1200 O                         CCY       10                               RE0730
1201 O***********              DACO      14                               S01117
1201 O**********               DACD      14                                            S01117 CGL029
     O                         ACODQQ    14                                                AR1091700
1202 O                         DACS      16                               RE0730
1203 O                      N60DRAN      32                               RE0730
     O**********             60ZERO10    32                         S01117S01413
     O                       60Z10       32                               S01413
1204 O                         RUND      35P                              RE0730
1205 O                         RUND      38P                              RE0730
1206 O***********************************43 '91000'                RE0730 S01466
     O                         TRAT      43                               S01466
1207 O***********              PNAR      73                         RE0730S01522
1208 O***********            21NARR      73                         RE0730S01522
     O                         O#PNA1    73                               S01522
1209 O                         AMOUNT    80P                              RE0730
1210 O                                   81 '0'                           RE0730
     O***********                        87 '000000'                S10736128963
     O** If posting not to suspense, output other Customer number.        128963
     O                         CCUS      87                               128963
     O                         Z8        95                               S01413
1211 O                                  102 'GE-SO'                       RE0730
1212 O***                      BRCD     105                               RE0730
     O***********              DRBRCD   105                               S01117
     O                         DRBR     105                               S01117
1213 O                       22         106 '1'                           RE0730
1214 O                      N22         106 '0'                           RE0730
     O                         ZERO3    108P                              S01413
1215 O                         RRNM     114P                              RE0730
     O/COPY WNCPYSRC,RE0730O006
1216 O                         ATYPDR   124                               RE0730
1191 O                         PRIN     128                               E15459
1217 O                                  129 'O'                           RE0730
1218 O                                  130 '1'                           RE0730
     O**********               PRFC     134                         S01182S01117
     O                 39      PRFC     134                               S01117
     O**********       39 66N42PRFCA    134                        CAC001 168936
     O                 39 66N42PRFCD    134                               168936
     O                         PTIM     140                               S10736
     O                         VOIN     141                               S10736
     O                         ASECDR   146                               S10736
     O                         LTAI     147                                                AR1091700
     O                 22      STOR     159                               RE0730
     O                         OSWCR    176                               S05452
     O                                  200 '000000'                      S05452
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         ZERO5    271P                              S01413
     O                         Z13      279P                              S01413
     O                         ORAMT    316P                                               AR1091700
     O                         XRFN     329                                                AR1091700
     O                         ACKEY    351                                                   CGL020
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         DACD     599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O/COPY WNCPYSRC,RE0730O010
1219 O**   IF UNPOSTABLE OVERWRITE RECID AND NARRATIVE                    RE0730
1220 O                       42           1 '*'                           RE0730
1221 O                       42          58 'UNPOSTABLE     '             RE0730
1222 O                       42          73 '               '             RE0730
1223 O*                                                                   RE0730
1224 O*    CREDIT SUSPENSE POSTING RECORD                                 RE0730
1225 O*                                                                   RE0730
1226 O        E        43NU1                                              RE0730
1227 O                                    1 'P'                           RE0730
1228 O***                      BICN       7                               RE0730
     O***********           N70BICN       7                               S01117
     O***********            70CRBICN     7                               S01117
     O                      N70DBICN      7                               S01117
     O                       70CBICN      7                               S01117
1229 O                         CCY       10                               RE0730
1230 O**********               COMS      14                                            RE0730 CGL029
     O                         ACODQQ    14                                                AR1091700
1231 O                                   16 '01'                          RE0730
     O**********               ZERO10    32                         S01117S01413
     O                         Z10       32                               S01413
1232 O                         RUND      35P                              RE0730
1233 O                         RUND      38P                              RE0730
1234 O***********************************43 '91000'                RE0730 S01466
     O                         TRAT      43                               S01466
1235 O***********              PNAR      73                         RE0730S01522
1236 O***********            21NARR      73                         RE0730S01522
     O                         O#PNA4    73                               S01522
1237 O                         AMOUNT    80P                              RE0730
1238 O                                   81 '1'                           RE0730
     O                                   87 '000000'                      S10736
     O                         Z8        95                               S01413
1239 O                                  102 'GE-SO'                       RE0730
1240 O***                      BRCD     105                               RE0730
     O***********              CRBRCD   105                               S01117
     O                         CBRC     105                               S01117
1241 O                                  106 '0'                           RE0730
     O                         ZERO3    108P                              S01413
     O                         ZERO5    114P                                               AR1091700
1242 O***********                       124 'G'                           E13024
1242 O                         ACTP     124                               E13024
1191 O                         PRIN     128                               E15459
1243 O                                  129 'O'                           RE0730
1244 O                                  130 '1'                           RE0730
     O**********               PRFC     134                         S01182S01117
     O                 39      PRFC     134                               S01117
     O                 39 65   FTPRFP   134                               CAC001
     O                         PTIM     140                               S10736
     O                         VOIN     141                               S10736
     O                         ACCS     146                               S10736
     O                         LTAI     147                                                AR1091700
     O                         OSWCR    176                               S05452
     O                                  200 '000000'                      S05452
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         ZERO5    271P                              S01413
     O                         Z13      279P                              S01413
     O                         ORAMT    316P                                               AR1091700
     O                         XRFN     329                                                AR1091700
     O                         ACKEY    351                                                   CGL020
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         COMS     599                                                   CGL029
     O                         OTRF     620                                                   CGL029
1245 O*                                                                   RE0730
1246 O*    CREDIT POSTING RECORD                                          RE0730
1247 O*                                                                   RE0730
1248 O        E        44NU1                                              RE0730
1249 O                                    1 'P'                           RE0730
1250 O                         CCUS       7                               RE0730
1251 O                         CCY       10                               RE0730
1252 O***********              CACO      14                               S01117
1252 O**********               CSCA      14                                            S01117 CGL029
     O                         ACODQQ    14                                                AR1091700
1253 O***********              CACS      16                               S01117
1253 O                         CACD      16                               S01117
1254 O                      N61CRAN      32                               RE0730
     O**********             61ZERO10    32                         S01117S01413
     O                       61Z10       32                               S01413
1255 O                         RUND      35P                              RE0730
1256 O                         RUND      38P                              RE0730
1257 O***********************************43 '91000'                RE0730 S01466
     O                         TRAT      43                               S01466
1258 O***********              PNAR      73                         RE0730S01522
1259 O***********            21NARR      73                         RE0730S01522
     O                         O#PNA3    73                               S01522
1260 O                         AMOUNT    80P                              RE0730
1261 O                                   81 '1'                           RE0730
     O**********                         87 '000000'                S10736128963
     O** If posting not to suspense, output other Customer number.        128963
     O                         DCUS      87                               128963
     O                         Z8        95                               S01413
1262 O                                  102 'GE-SO'                       RE0730
1263 O***                      BICN     105                               RE0730
     O*********                CRBICN   105                               RE0730
     O***********              CRBRCD   105                               S01117
     O                         CBRC     105                               S01117
1264 O                       23         106 '1'                           RE0730
1265 O                      N23         106 '0'                           RE0730
     O                         ZERO3    108P                              S01413
1266 O                         RRNM     114P                              RE0730
     O/COPY WNCPYSRC,RE0730O007
1267 O                         ATYPCR   124                               RE0730
1191 O                         PRIN     128                               E15459
1268 O                                  129 'O'                           RE0730
1269 O                                  130 '1'                           RE0730
     O**********               PRFC     134                         S01182S01117
     O                 39      PRFC     134                               S01117
     O**********       39 67N43PRFCA    134                        CAC001 168936
     O                 39 67N43PRFCC    134                               168936
     O                         PTIM     140                               S10736
     O                         VOIN     141                               S10736
     O                         ASECCR   146                               S10736
     O                         LTAI     147                                                AR1091700
     O                 23      STOR     159                               RE0730
     O                         OSWCR    176                               S05452
     O                                  200 '000000'                      S05452
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         ZERO5    271P                              S01413
     O                         Z13      279P                              S01413
     O                         ORAMT    316P                                               AR1091700
     O                         XRFN     329                                                AR1091700
     O                         ACKEY    351                                                   CGL020
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         CSCA     599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O/COPY WNCPYSRC,RE0730O011
1270 O**   IF UNPOSTABLE OVERWRITE RECID & NARRATIVE                      RE0730
1271 O                       43           1 '*'                           RE0730
1272 O                       43          58 'UNPOSTABLE     '             RE0730
1273 O                       43          73 '               '             RE0730
     O**  DO NOT GENERATE THE NEXT TWO POSTINGS UNLESS THE STANDING       RE0730
     O**     ORDER IS ACROSS TWO BRANCHES (MBSI ='Y')                     RE0730
     O*                                                                   RE0730
     O*    CREDIT POSTING RECORD                                          RE0730
     O*                                                                   RE0730
     O        E        44NU1 70                                           RE0730
     O/COPY WNCPYSRC,RE0730O001
     O                                    1 'P'                           RE0730
     O***********              DRBICN     7                               S01117
     O                N49      CBICN      7                               S01117
     O                 49      MBICN      7                               S01117
     O                         CCY       10                               RE0730
     O***********      71      DRIBAB    14                               S01117
     O***********      72      DRIBAH    14                               S01117
     O**********               DADTO     14                                            S01117 CGL029
     O                         ACODQQ    14                                                AR1091700
     O                                   16 '01'                          RE0730
     O***                   N60DRAN      32                               RE0730
     O**********               ZERO10    32                               S01413
     O                         Z10       32                               S01413
     O                         RUND      35P                              RE0730
     O                         RUND      38P                              RE0730
     O***********************************43 '91000'                RE0730 S01466
     O                         TRAT      43                               S01466
     O***********              PNAR      73                         RE0730S01522
     O***********            21NARR      73                         RE0730S01522
     O                         O#PNA2    73                               S01522
     O                         AMOUNT    80P                              RE0730
     O***                                81 '0'                           RE0730
     O                                   81 '1'                           RE0730
     O                                   87 '000000'                      S10736
     O                         Z8        95                               S01413
     O                                  102 'GE-SO'                       RE0730
     O***********              DRBRCD   105                               S01117
     O                         DRBR     105                               S01117
     O***********            22         106 '1'                           S01117
     O***********           N22         106 '0'                           S01117
     O                                  106 '0'                           S01117
     O                         ZERO3    108P                              S01413
     O                         RRNM     114P                              RE0730
     O***********                       124 'G'                           S01117
     O                         DTYPTO   124                               S01117
1191 O                         PRIN     128                               E15459
     O                                  129 'O'                           RE0730
     O                                  130 '1'                           RE0730
     O**********               PRFC     134                         S01182S01117
     O                 39      PRFC     134                               S01117
     O                 39 65   FTPRFP   134                               CAC001
     O                         PTIM     140                               S10736
     O                         VOIN     141                               S10736
     O                         DSECTO   146                               S10736
     O                         LTAI     147                                                AR1091700
     O                         OSWCR    176                               S05452
     O                                  200 '000000'                      S05452
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         ZERO5    271P                              S01413
     O                         Z13      279P                              S01413
     O                         ORAMT    316P                                               AR1091700
     O                         XRFN     329                                                AR1091700
     O                         ACKEY    351                                                   CGL020
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         DADTO    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O*                                                                   RE0730
     O*     DEBIT POSTING RECORD                                          RE0730
     O*                                                                   RE0730
     O        E        44NU1 70                                           RE0730
     O/COPY WNCPYSRC,RE0730O002
     O                                    1 'P'                           RE0730
     O***********              CRBICN     7                               S01117
     O                N49      DBICN      7                               S01117
     O                 49      MBICN      7                               S01117
     O                         CCY       10                               RE0730
     O*****            72      CRIBAB    14                               S01117
     O*****            71      CRIBAH    14                               S01117
     O**********               CADFR     14                                            S01117 CGL029
     O                         ACODQQ    14                                                AR1091700
     O                                   16 '01'                          RE0730
     O***                   N61CRAN      32                               RE0730
     O**********               ZERO10    32                               S01413
     O                         Z10       32                               S01413
     O                         RUND      35P                              RE0730
     O                         RUND      38P                              RE0730
     O***********************************43 '91000'                RE0730 S01466
     O                         TRAT      43                               S01466
1184 O***********              PNAR      73                         RE0730S01522
1185 O***********            21NARR      73                         RE0730S01522
     O                         O#PNA4    73                               S01522
     O                         AMOUNT    80P                              RE0730
     O                                   81 '0'                           RE0730
     O                                   87 '000000'                      S10736
     O                         Z8        95                               S01413
     O                                  102 'GE-SO'                       RE0730
     O***********              CRBRCD   105                               S01117
     O                         CBRC     105                               S01117
     O***********            23         106 '1'                           S01117
     O***********           N23         106 '0'                           S01117
     O                                  106 '0'                           S01117
     O                         ZERO3    108P                              S01413
     O                         RRNM     114P                              RE0730
     O***********                       124 'G'                           S01117
     O                         CTYPFR   124                               S01117
1191 O                         PRIN     128                               E15459
     O                                  129 'O'                           RE0730
     O                                  130 '1'                           RE0730
     O**********               PRFC     134                         S01182S01117
     O                 39      PRFC     134                               S01117
     O                 39 65   FTPRFP   134                               CAC001
     O                         PTIM     140                               S10736
     O                         VOIN     141                               S10736
     O                         CSECFR   146                               S10736
     O                         LTAI     147                                                AR1091700
     O                         OSWCR    176                               S05452
     O                                  200 '000000'                      S05452
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         ZERO5    271P                              S01413
     O                         Z13      279P                              S01413
     O                         ORAMT    316P                                               AR1091700
     O                         XRFN     329                                                AR1091700
     O                         ACKEY    351                                                   CGL020
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         CADFR    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**  DO NOT GENERATE THE NEXT TWO POSTINGS UNLESS MBSI = 'Y' AND     S01117
     O**  MAIN BRANCH ENTRIES ARE REQUIRED                                S01117
     O*                                                                   S01117
     O*    CREDIT POSTING RECORD                                          S01117
     O*                                                                   S01117
     O        E        44NU1 49                                           S01117
     O/COPY WNCPYSRC,RE0730O003
     O                                    1 'P'                           S01117
     O                         DBICN      7                               S01117
     O                         CCY       10                               S01117
     O**********               MADFR     14                                            S01117 CGL029
     O                         ACODQQ    14                                                AR1091700
     O                                   16 '01'                          S01117
     O**********               ZERO10    32                         S01117S01413
     O                         Z10       32                               S01413
     O                         RUND      35P                              S01117
     O                         RUND      38P                              S01117
     O***********************************43 '91000'                S01117 S01466
     O                         TRAT      43                               S01466
1184 O***********              PNAR      73                         S01117S01522
1185 O***********            21NARR      73                         S01117S01522
     O                         O#PNA2    73                               S01522
     O                         AMOUNT    80P                              S01117
     O                                   81 '0'                           S01117
     O                                   87 '000000'                      S10736
     O                         Z8        95                               S01413
     O                                  102 'GE-SO'                       S01117
     O                         MABR     105                               S01117
     O                                  106 '0'                           S01117
     O                         ZERO3    108P                              S01413
     O                         ZERO5    114P                              S01117
     O                         MTYPFR   124                               S01117
     O                         PRIN     128                               S01117
     O                                  129 'O'                           S01117
     O                                  130 '1'                           S01117
     O                 39      PRFC     134                               S01117
     O                 39 65   FTPRFP   134                               CAC001
     O                         PTIM     140                               S10736
     O                         VOIN     141                               S10736
     O                         MSECFR   146                               S10736
     O                         LTAI     147                                                AR1091700
     O                         OSWCR    176                               S01117
     O                                  200 '000000'                      S01117
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         ZERO5    271P                              S01413
     O                         Z13      279P                              S01413
     O                         ORAMT    316P                                               AR1091700
     O                         XRFN     329                                                AR1091700
     O                         ACKEY    351                                                   CGL020
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         MADFR    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O*                                                                   S01117
     O*     DEBIT POSTING RECORD                                          S01117
     O*                                                                   S01117
     O        E        44NU1 49                                           S01117
     O/COPY WNCPYSRC,RE0730O004
     O                                    1 'P'                           S01117
     O                         CBICN      7                               S01117
     O                         CCY       10                               S01117
     O**********               MADTO     14                                            S01117 CGL029
     O                         ACODQQ    14                                                AR1091700
     O                                   16 '01'                          S01117
     O**********               ZERO10    32                         S01117S01413
     O                         Z10       32                               S01413
     O                         RUND      35P                              S01117
     O                         RUND      38P                              S01117
     O***********************************43 '91000'                S01117 S01466
     O                         TRAT      43                               S01466
     O***********              PNAR      73                         S01117S01522
     O***********            21NARR      73                         S01117S01522
     O                         O#PNA4    73                               S01522
     O                         AMOUNT    80P                              S01117
     O                                   81 '1'                           S01117
     O                                   87 '000000'                      S10736
     O                         Z8        95                               S01413
     O                                  102 'GE-SO'                       S01117
     O                         MABR     105                               S01117
     O                                  106 '0'                           S01117
     O                         ZERO3    108P                              S01413
     O                         ZERO5    114P                              S01117
     O                         MTYPTO   124                               S01117
     O                         PRIN     128                               S01117
     O                                  129 'O'                           S01117
     O                                  130 '1'                           S01117
     O                 39      PRFC     134                               S01117
     O                 39 65   FTPRFP   134                               CAC001
     O                         PTIM     140                               S10736
     O                         VOIN     141                               S10736
     O                         MSECTO   146                               S10736
     O                         LTAI     147                                                AR1091700
     O                         OSWCR    176                               S01117
     O                                  200 '000000'                      S01117
     O**********               OTRF     230                                            S01182 CGL029
     O                         OTST     240                               S01182
     O                         OTTP     250                               S01182
     O                         SDCB     258P                              S01182
     O                         SDLB     266P                              S01182
     O                         BOKC     268                               S01182
     O                         ZERO5    271P                              S01413
     O                         Z13      279P                              S01413
     O                         ORAMT    316P                                               AR1091700
     O                         XRFN     329                                                AR1091700
     O                         ACKEY    351                                                   CGL020
     O                         FEEFLG   352                                                   CGL020
     O                         FEEVAL   359P                                                  CGL020
     O                         FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         MADTO    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O/COPY WNCPYSRC,RE0730O008
1274 OGESOZZ  T        LRNU1                                              RE0730
1275 O                                    1 'T'                           RE0730
1276 O                         GESON      6                               RE0730
1277 O                         HASHI     14P                              RE0730
1278 O                         HASHD     16P                              RE0730
      *                                                                   S01408
     O/COPY WNCPYSRC,RE0730OOP1                                           S01408
      *                                                                   S01408
1279 O**                                                                  RE0730
1280 O*    RE0730  -  MATURED STANDING ORDERS REPORT                      RE0730
1281 O**                                                                  RE0730
1282 O*E0730P1H** 03   01NU1                                        S01124S01117
     ORE0730P1H   03   34NU1                                              S01117
1283 O*******OR**      OV                                                 S01117
     O       OR        OV 35                                              S01117
1284 O***********                        25 'REFERENCE RE0730'            S01117
1284 O                                   27 'REFERENCE RE0730P1'          S01117
1285 O                         TITL      92                               RE0730
1286 O                                  104 'DATE'                        RE0730
1287 O                         RUNA     112                               RE0730
1288 O                                  122 'PAGE'                        RE0730
1289 O                         PAGE  1  127                               RE0730
1290 O*                                                                   RE0730
1291 O********H*2      01NU1                                              S01117
1291 O        H 2      34NU1                                              S01117
1292 O*******OR**      OV                                                 S01117
1292 O       OR        OV 35                                              S01117
1293 O                                   72 'MATURED STANDING ORDERS '    RE0730
1294 O                                   78 'REPORT'                      RE0730
     O                 77                88 'BRANCH'                      S01117
     O                 77      TXBRCA    92                               S01117
     O                 77                93 '-'                           S01117
     O                 77      TBRNM    123                               S01117
1295 O*                                                                   RE0730
1296 O********H*1      01NU1                                              S01117
1296 O        H 1      34NU1                                              S01117
1297 O*******OR**      OV                                                 S01117
1297 O       OR        OV 35                                              S01117
1298 O                                   72 '------------------------'    RE0730
1299 O                                   78 '------'                      RE0730
1300 O*                                                                   RE0730
1301 O********H*2      01NU1                                              S01117
1301 O        H 2      34NU1                                              S01117
1302 O*******OR**      OV                                                 S01117
1302 O       OR        OV 35                                              S01117
1303 O                                   29 'ACCOUNT NO'                  RE0730
1304 O                                   60 'RETAIL ACCOUNT NO.'          RE0730
1305 O                                   86 'STANDING ORDER '             RE0730
1306 O***********                       104 'BRANCH'                      S01117
1307 O*                                                                   RE0730
1308 O********H*1      01NU1                                              S01117
1308 O        H 1      34NU1                                              S01117
1309 O*******OR**      OV                                                 S01117
1309 O       OR        OV 35                                              S01117
1310 O                                   82 'REF NO.'                     RE0730
1311 O        D 2      48NU1                                              RE0730
     O                 77      DRBR      16                               S01117
     O                 77                17 '-'                           S01117
1312 O                         DCUS      23                               RE0730
1313 O                                   24 '-'                           RE0730
1314 O                         CCY       27                               RE0730
1315 O                                   28 '-'                           RE0730
1316 O***********              DACO      32                               S01117
1316 O**********               DACD      32                                            S01117 CGL029
1317 O**********                         33 '-'                                        RE0730 CGL029
1318 O**********               DACS      35                                            RE0730 CGL029
1319 O**********            N60DRAN      55                                            RE0730 CGL029
     O                         DACD      38                                                   CGL029
     O                                   39 '-'                                               CGL029
     O                         DACS      41                                                   CGL029
     O                      N60DRAN      56                                                   CGL029
1320 O                         STOR      81                               RE0730
1321 O***********              BRCD     102                               S01117
1322 O*                                                                   RE0730
1323 O********T*2      LRNU1                                              S01117
1324 O***********                        61 'NUMBER OF MATURED STANDI'    S01117
1325 O***********                        70 'NG ORDERS'                   S01117
1326 O***********              NDELS 1   94                               S01117
1327 O*                                                                   RE0730
1328 O********T*2      LRNU1                                              S01117
1329 O***********                        61 ' VALUE OF MATURED STANDI'    S01117
1330 O***********                        70 'NG ORDERS'                   S01117
1331 O***********              VDELD     94 '0   '                        S01117
1332 O***********              VDELI Z   91                               S01117
1333 O*                                                                   RE0730
1334 O********T*3      LRNU1                                              S01117
1335 O***********                        38 'END OF REPORT TOTALS'        S01117
1336 O*                                                                   RE0730
1337 O********T*2      LRNU1                                              S01117
1338 O***********                        37 'NUMBER OF STANDING '         S01117
1339 O***********                        56 'ORDERS AFTER UPDATE'         S01117
1340 O***********              NSAU  1   62                               S01117
1341 O***********                        82 'VALUE OF STANDING '          S01117
1342 O***********                       101 'ORDERS AFTER UPDATE'         S01117
1343 O***********              VSUD     125 '0   '                        S01117
1344 O***********              VSUW  Z  122                               S01117
1345 O*                                                                   RE0730
1346 O********T*2      LRNU1 U8                                           S01117
1347 O***********                        18 'CALCULATED -'                S01117
1348 O***********                        37 'NUMBER OF STANDING '         S01117
1349 O***********                        56 'ORDERS AFTER UPDATE'         S01117
1350 O***********              TOTSO 1   62                               S01117
1351 O***********                        82 'VALUE OF STANDING '          S01117
1352 O***********                       101 'ORDERS AFTER UPDATE'         S01117
1353 O***********              VALDEC   125 '0   '                        S01117
1354 O***********              VALINTZ  122                               S01117
1355 O********T*2      LRNU1 U8                                           S01117
1356 O***********            50          62 '***  DIFFERENCE  ***'        S01117
1357 O***********            52         125 '***  DIFFERENCE  ***'        S01117
1358 O*                                                                   RE0730
1359 O********T*2******LRNU1*55*************************************      E17948
1360 O***********************************40 '*** DATABASE ERROR ***'      E17948
1359 O********T*33     LRNU1 U8                                     E17948S01117
1359 O***********                        63 '***   FILE OUT OF'     E17948S01117
1359 O***********                        77 'BALANCE   ***'         E17948S01117
1359 O********T*3      LRNU1 U7                                     E17948S01117
1359 O***********                        49 '***********************E17948S01117
1359 O***********                        73 '***********************E17948S01117
1359 O***********                        97 '***********************E17948S01117
1359 O***********                       106 '*********'             E17948S01117
1359 O********T*1      LRNU1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LRNU1 U7                                     E17948S01117
1359 O***********                        47 '*    DATABASE ERROR - 'E17948S01117
1359 O***********                        68 'REPORT TERMINATED AT ' E17948S01117
1359 O***********                        75 'PROGRAM'               E17948S01117
1359 O***********              DBPGM     85                         E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LRNU1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                        75 'KEY'                   E17948S01117
1359 O***********              DBKEY    104                         E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LRNU1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                        75 'FILE'                  E17948S01117
1359 O***********              DBFILE    84                         E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LRNU1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                        75 'AT'                    E17948S01117
1359 O***********              DBASE     79                         E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LRNU1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*13     LRNU1 U7                                     E17948S01117
1359 O***********                        49 '***********************E17948S01117
1359 O***********                        73 '***********************E17948S01117
1359 O***********                        97 '***********************E17948S01117
1359 O***********                       106 '*********'             E17948S01117
1359 O        T 3      LRNU1 U7                                           S01117
1359 O       AND       35                                                 S01117
     O       OR        U7 98                                                                BUG12587
1359 O                                   74 '*** DATABASE ERROR ***'      S01117
1359 O*                                                                   E17948
1361 O********T*2      LRNU1                                              S01117
1361 O        T 3      L1NU1 35                                           S01117
1362 O***********                        74 '*** END OF REPORT ***'       S01117
     O                 77                66 '*** END OF REPORT FOR'       S01117
     O                 77                74 ' BRANCH '                    S01117
     O                 77      TXBRCA    77                               S01117
     O                 77                81 ' ***'                        S01117
     O                N77                76 '*** END OF REPORT ***'       S01117
1363 O**                                                                  RE0730
1364 O*    STANDING ORDERS FOR NEXT WORKING DAY                           RE0730
1368 O*                                                                   RE0730
1369 OSOEXSO  E        44 U1                                              RE0730
1370 O                                    1 'D'                           RE0730
1371 O                         STOR       6                               RE0730
1372 O***********              BRCD       9                               S01117
1372 O                         DRBR       9                               S01117
1373 O                         DCUS      15                               RE0730
1374 O***********              DACO      19                               S01117
1374 O**********               DACD      19                                            S01117 CGL029
1375 O                         DACS      21                               RE0730
1376 O                      N60DRAN      31                               RE0730
     O***********            60ZERO10    31                         S01117S01413
     O                       60Z10       31                               S01413
1377 O                         CCUS      37                               RE0730
1378 O***********              CACO      41                               S01117
1378 O**********               CSCA      41                                            S01117 CGL029
1379 O***********              CACS      43                               S01117
1379 O                         CACD      43                               S01117
1380 O                         CRAN      53                               RE0730
1381 O                         CCY       56                               RE0730
1382 O                         AMOUNT    63P                              RE0730
1383 O                         CRNM      83                               RE0730
1384 O                         PNAR     113                               RE0730
1385 O                         PAYR     133                               RE0730
1386 O                         PNAM     153                               RE0730
1387 O                         FPAD     173                               RE0730
1388 O                         SPAD     193                               RE0730
1389 O                         PAYA     203                               RE0730
1390 O                         METH     204                               RE0730
     O                         CBRC     207                               S01117
     O                 39      PRFC     211                               S01117
     O                         TXBRCA   214                               S01117
     O                         TRAT     219                               S01466
1391 O                 42                93 '**********'                  RE0730
1392 O                 42               103 'UNPOSTABLE'                  RE0730
1393 O                 42               113 '**********'                  RE0730
1394 O                 43                93 '**********'                  RE0730
1395 O                 43               103 'UNPOSTABLE'                  RE0730
1396 O                 43               113 '**********'                  RE0730
1374 O                         DACD     271                                                   CGL029
1378 O                         CSCA     281                                                   CGL029
     O/COPY WNCPYSRC,RE0730O009
1397 OSOEXZZ  T        U1 LR                                              RE0730
1398 O                                    1 'T'                           RE0730
1399 O                         SOEXN      4P                              RE0730
1400 O**                                                                  RE0730
1401 O****RE0331*-*CONTROL*REPORT***********************************      E17948
1401 O****RE07301 - CONTROL TOTALS REPORT (RE0730P2)                E17948S01117
1401 O*   RE0730  - AUDIT REPORT (RE0730AU)                               S01117
1402 O**                                                                  RE0730
1403 O*E0730P2T** 03   U1 LR                                        S01124S01117
     ORE0730AUT   03      LR                                              S01117
1404 O***********                        26 'REFERENCE RE07301'           S01117
1404 O                                   27 'REFERENCE RE0730AU'          S01117
1405 O                         TITL      92                               RE0730
1406 O                                  104 'DATE'                        RE0730
1407 O                         RUNA     113                               RE0730
1408 O                                  127 'PAGE    1'                   RE0730
1322 O*                                                                   S01117
     O        T 2      LRNU1                                              S01117
     O                                   68 'MATURED STANDING ORDERS '    S01117
     O                                   84 ' - CONTROL REPORT'           S01117
     O        T 1      LRNU1                                              S01117
     O                                   68 '------------------------'    S01117
     O                                   84 '-----------------'           S01117
1323 O        T 2      LRNU1                                              S01117
1324 O                N98                61 'NUMBER OF MATURED STANDI'               S01117 BUG12587
1325 O                N98                70 'NG ORDERS'                              S01117 BUG12587
1326 O                N98      NDELS 1   94                                          S01117 BUG12587
1327 O*                                                                   S01117
1328 O        T 2      LRNU1                                              S01117
1329 O                N98                61 ' VALUE OF MATURED STANDI'               S01117 BUG12587
1330 O                N98                70 'NG ORDERS'                              S01117 BUG12587
1331 O                N98      VDELD     94 '0   '                                   S01117 BUG12587
1332 O                N98      VDELI Z   91                                          S01117 BUG12587
1333 O*                                                                   S01117
1334 O        T 3      LRNU1                                              S01117
1335 O                N98                38 'END OF REPORT TOTALS'                   S01117 BUG12587
1336 O*                                                                   S01117
1337 O        T 2      LRNU1                                              S01117
1338 O                N98                37 'NUMBER OF STANDING '                    S01117 BUG12587
1339 O                N98                56 'ORDERS AFTER UPDATE'                    S01117 BUG12587
1340 O                N98      NSAU  1   62                                          S01117 BUG12587
1341 O                N98                82 'VALUE OF STANDING '                     S01117 BUG12587
1342 O                N98               101 'ORDERS AFTER UPDATE'                    S01117 BUG12587
1343 O                N98      VSUD     125 '0   '                                   S01117 BUG12587
1344 O                N98      VSUW  Z  122                                          S01117 BUG12587
1345 O*                                                                   S01117
1346 O        T 2      LRNU1 U8                                           S01117
1347 O                                   18 'CALCULATED -'                S01117
1348 O                                   37 'NUMBER OF STANDING '         S01117
1349 O                                   56 'ORDERS AFTER UPDATE'         S01117
1350 O                         TOTSO 1   62                               S01117
1351 O                                   82 'VALUE OF STANDING '          S01117
1352 O                                  101 'ORDERS AFTER UPDATE'         S01117
1353 O                         VALDEC   125 '0   '                        S01117
1354 O                         VALINTZ  122                               S01117
1355 O        T 2      LRNU1 U8                                           S01117
1356 O                       50          62 '***  DIFFERENCE  ***'        S01117
1357 O                       52         125 '***  DIFFERENCE  ***'        S01117
     O*                                                                   S01117
     O*  NO DETAILS OUTPUT                                                S01117
     O*                                                                   S01117
     O        T 3      LRNU1N75                                           S01117
     O                                   70 '***   NO DETAILS TO REPO'    S01117
     O                                   78 'RT   ***'                    S01117
1409 O*                                                                   RE0730
1410 O        T 2      U1 LR                                              RE0730
1411 O                                   67 'STANDING ORDERS - EXTRAC'    RE0730
1412 O                                   83 'T CONTROL REPORT'            RE0730
1413 O*                                                                   RE0730
1414 O        T 1      U1 LR                                              RE0730
1415 O                                   67 '------------------------'    RE0730
1416 O                                   83 '----------------'            RE0730
1417 O*                                                                   RE0730
1418 O        T 2      LR U1                                              RE0730
1419 O                                   70 'READ'                        RE0730
1420 O                                  110 'CALCULATED'                  RE0730
1421 O*                                                                   RE0730
1422 O        T 1      LR U1                                              RE0730
1423 O                                   70 '----'                        RE0730
1424 O                                  110 '----------'                  RE0730
1425 O*                                                                   RE0730
1426 O        T 2      LR U1                                              RE0730
1427 O                                   32 'NO. OF STANDING ORDERS '     RE0730
1428 O                         NSAU  1   70                               RE0730
1429 O                         TOTSO 1  110                               RE0730
1430 O                       50         130 '* OUT OF BALANCE *'          RE0730
1431 O*                                                                   RE0730
1432 O        T 2      LR U1                                              RE0730
1433 O                                   31 'VALUE OF STANDING ORDERS'    RE0730
1434 O                         VSUW  Z   67                               RE0730
1435 O                         VSUD      70                               RE0730
1436 O                         VALINTZ  107                               RE0730
1437 O                         VALDEC   110                               RE0730
1438 O                       52         130 '* OUT OF BALANCE *'          RE0730
1439 O*                                                                   RE0730
1440 O********T*2******LR*U1*55************************************       E17948
1440 O********T*23     LR U1 U7                                     E17948S01117
1441 O***********                        70 '*** DATABASE ERROR ***'      S01117
1359 O********T*3      LR U1 U7                                     E17948S01117
1359 O***********                        49 '***********************E17948S01117
1359 O***********                        73 '***********************E17948S01117
1359 O***********                        97 '***********************E17948S01117
1359 O***********                       106 '*********'             E17948S01117
1359 O********T*1      LR U1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LR U1 U7                                     E17948S01117
1359 O***********                        47 '*    DATABASE ERROR - 'E17948S01117
1359 O***********                        68 'REPORT TERMINATED AT ' E17948S01117
1359 O***********                        75 'PROGRAM'               E17948S01117
1359 O***********              DBPGM     85                         E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LR U1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                        75 'KEY'                   E17948S01117
1359 O***********              DBKEY    104                         E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LR U1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                        75 'FILE'                  E17948S01117
1359 O***********              DBFILE    84                         E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LR U1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                        75 'AT'                    E17948S01117
1359 O***********              DBASE     79                         E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*1      LR U1 U7                                     E17948S01117
1359 O***********                        26 '*'                     E17948S01117
1359 O***********                       106 '*'                     E17948S01117
1359 O********T*13     LR U1 U7                                     E17948S01117
1359 O***********                        49 '***********************E17948S01117
1359 O***********                        73 '***********************E17948S01117
1359 O***********                        97 '***********************E17948S01117
1359 O***********                       106 '*********'             E17948S01117
     O*                                                                   S01117
     O*  DATABASE ERROR OUTPUT                                            S01117
     O*                                                                   S01117
     O        T 23     LR U7 98                                                      S01117 BUG12587
     O                                   58 'DATABASE ERROR '             S01117
     O                         DBASE     61                               S01117
     O                                   75 'IN PROGRAM '                 S01117
     O                         DBPGM     85                               S01117
     O        T  2     LR U7 98                                                      S01117 BUG12587
     O                                   48 'FILE '                       S01117
     O                         DBFILE    56                               S01117
     O                                   62 ', KEY '                      S01117
     O                         DBKEY     91                               S01117
1442 O********T*2      LR U1                                              S01117
1443 O***********                        72 '*** END OF REPORT ***'       S01117
     O**RE0730P2E***03**N55NU1                                                       BUG4051 BUG4051
     ORE0730P2E   03  N55NU1 57                                                              BUG4051
     O       OR        OG 55                                                                 BUG4051
     O                                   27 'REFERENCE RE0730P2'                             BUG4051
     O                         TITL      92                                                  BUG4051
     O                                  104 'DATE'                                           BUG4051
     O                         RUNA     112                                                  BUG4051
     O                                  122 'PAGE'                                           BUG4051
     O                         PAGE1 1  127                                                  BUG4051
      *                                                                                      BUG4051
     O********E*2     N55NU1                                                         BUG4051 BUG4051
     O        E 2     N55NU1 57                                                              BUG4051
     O       OR        OG 55                                                                 BUG4051
     O                                   65 'TODAY''S STANDING '                             BUG4051
     O                                   78 'ORDERS REPORT'                                  BUG4051
     O**********       77                88 'BRANCH'                                 BUG4051 BUG4051
     O**********       77      TXBRCA    92                                          BUG4051 BUG4051
     O**********       77                93 '-'                                      BUG4051 BUG4051
     O**********       77      TBRNM    123                                          BUG4051 BUG4051
      *                                                                                      BUG4051
     O********E*1     N55NU1                                                         BUG4051 BUG4051
     O        E 1     N55NU1 57                                                              BUG4051
     O       OR        OG 55                                                                 BUG4051
     O                                   65 '-----------------'                              BUG4051
     O                                   78 '-------------'                                  BUG4051
      *                                                                                      BUG4051
     O        E 2      42NU1                                                                 BUG4051
     O       OR        44NU1                                                                 BUG4051
     O                                   33 'STANDING ORDER REF NO.'                         BUG4051
     O                         STOR      40                                                  BUG4051
      *                                                                                      BUG4051
     O        E 1      42NU1                                                                 BUG4051
     O                                   32 'DEBIT  ACCOUNT NO.'                             BUG4051
     O                 77      DRBR      36                                                  BUG4051
     O                 77                37 '-'                                              BUG4051
     O                         DBICN     43                                                  BUG4051
     O                                   44 '-'                                              BUG4051
     O                         CCY       47                                                  BUG4051
     O                                   48 '-'                                              BUG4051
     O                         COMS      58                                                  BUG4051
     O                                   59 '-'                                              BUG4051
     O                                   61 '01'                                             BUG4051
      *                                                                                      BUG4051
     O        E 1      43NU1                                                                 BUG4051
     O                                   32 'CREDIT ACCOUNT NO.'                             BUG4051
     O                 77      CBRC      36                                                  BUG4051
     O                 77                37 '-'                                              BUG4051
     O                 70      CBICN     43                                                  BUG4051
     O                N70      DBICN     43                                                  BUG4051
     O                                   44 '-'                                              BUG4051
     O                         CCY       47                                                  BUG4051
     O                                   48 '-'                                              BUG4051
     O                         COMS      58                                                  BUG4051
     O                                   59 '-'                                              BUG4051
     O                                   61 '01'                                             BUG4051
      *                                                                                      BUG4051
     O        E 1      42NU1                                                                 BUG4051
     O       OR        43NU1                                                                 BUG4051
     O                                   31 'PAYMENT AMOUNT'                                 BUG4051
     O                 78      AMOUNT    53 ' ,   ,   ,   , 0 '                              BUG4051
     O                 79      AMOUNT    53 '   ,   ,   , 0 . '                              BUG4051
     O                 80      AMOUNT    53 '  ,   ,   , 0 .  '                              BUG4051
     O                 81      AMOUNT    53 ' ,   ,   , 0 .   '                              BUG4051
     O                                   64 'CURRENCY'                                       BUG4051
     O                         CCY       68                                                  BUG4051
     O                                   83 'NARRATIVE'                                      BUG4051
     O                    42   O#PNA2   114                                                  BUG4051
     O                    43   O#PNA4   114                                                  BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1                                                                 BUG4051
     O                                   32 'DEBIT  ACCOUNT NO.'                             BUG4051
     O                 77      DRBR      36                                                  BUG4051
     O                 77                37 '-'                                              BUG4051
     O                         DCUS      43                                                  BUG4051
     O                                   44 '-'                                              BUG4051
     O                         CCY       47                                                  BUG4051
     O                                   48 '-'                                              BUG4051
     O                         DACD      58                                                  BUG4051
     O                                   59 '-'                                              BUG4051
     O                         DACS      61                                                  BUG4051
     O                      N60          82 'RETAIL ACCOUNT NO.'                             BUG4051
     O                      N60DRAN      93                                                  BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1                                                                 BUG4051
     O                                   31 'PAYMENT AMOUNT'                                 BUG4051
     O                 78      AMOUNT    53 ' ,   ,   ,   , 0 '                              BUG4051
     O                 79      AMOUNT    53 '   ,   ,   , 0 . '                              BUG4051
     O                 80      AMOUNT    53 '  ,   ,   , 0 .  '                              BUG4051
     O                 81      AMOUNT    53 ' ,   ,   , 0 .   '                              BUG4051
     O                                   64 'CURRENCY'                                       BUG4051
     O                         CCY       68                                                  BUG4051
     O                                   83 'NARRATIVE'                                      BUG4051
     O                         O#PNA1   114                                                  BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1                                                                 BUG4051
     O                                   32 'CREDIT ACCOUNT NO.'                             BUG4051
     O                 77      CBRC      36                                                  BUG4051
     O                 77                37 '-'                                              BUG4051
     O                         CCUS      43                                                  BUG4051
     O                                   44 '-'                                              BUG4051
     O                         CCY       47                                                  BUG4051
     O                                   48 '-'                                              BUG4051
     O                         CSCA      58                                                  BUG4051
     O                                   59 '-'                                              BUG4051
     O                         CACD      61                                                  BUG4051
     O                      N60          82 'RETAIL ACCOUNT NO.'                             BUG4051
     O                      N60CRAN      93                                                  BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1                                                                 BUG4051
     O                                   31 'PAYMENT AMOUNT'                                 BUG4051
     O                 78      AMOUNT    53 ' ,   ,   ,   , 0 '                              BUG4051
     O                 79      AMOUNT    53 '   ,   ,   , 0 . '                              BUG4051
     O                 80      AMOUNT    53 '  ,   ,   , 0 .  '                              BUG4051
     O                 81      AMOUNT    53 ' ,   ,   , 0 .   '                              BUG4051
     O                                   64 'CURRENCY'                                       BUG4051
     O                         CCY       68                                                  BUG4051
     O                                   83 'NARRATIVE'                                      BUG4051
     O                         O#PNA3   114                                                  BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1 70                                                              BUG4051
     O                                   32 'DEBIT  ACCOUNT NO.'                             BUG4051
     O                         CBRC      36                                                  BUG4051
     O                                   37 '-'                                              BUG4051
     O                N49      DBICN     43                                                  BUG4051
     O                 49      MBICN     43                                                  BUG4051
     O                                   44 '-'                                              BUG4051
     O                         CCY       47                                                  BUG4051
     O                                   48 '-'                                              BUG4051
     O                         CADFR     58                                                  BUG4051
     O                                   59 '-'                                              BUG4051
     O                                   61 '01'                                             BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1 70                                                              BUG4051
     O                                   31 'PAYMENT AMOUNT'                                 BUG4051
     O                 78      AMOUNT    53 ' ,   ,   ,   , 0 '                              BUG4051
     O                 79      AMOUNT    53 '   ,   ,   , 0 . '                              BUG4051
     O                 80      AMOUNT    53 '  ,   ,   , 0 .  '                              BUG4051
     O                 81      AMOUNT    53 ' ,   ,   , 0 .   '                              BUG4051
     O                                   64 'CURRENCY'                                       BUG4051
     O                         CCY       68                                                  BUG4051
     O                                   83 'NARRATIVE'                                      BUG4051
     O                         O#PNA4   114                                                  BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1 70                                                              BUG4051
     O                                   32 'CREDIT ACCOUNT NO.'                             BUG4051
     O                         DRBR      36                                                  BUG4051
     O                                   37 '-'                                              BUG4051
     O                N49      CBICN     43                                                  BUG4051
     O                 49      MBICN     43                                                  BUG4051
     O                                   44 '-'                                              BUG4051
     O                         CCY       47                                                  BUG4051
     O                                   48 '-'                                              BUG4051
     O                         DADTO     58                                                  BUG4051
     O                                   59 '-'                                              BUG4051
     O                                   61 '01'                                             BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1 70                                                              BUG4051
     O                                   31 'PAYMENT AMOUNT'                                 BUG4051
     O                 78      AMOUNT    53 ' ,   ,   ,   , 0 '                              BUG4051
     O                 79      AMOUNT    53 '   ,   ,   , 0 . '                              BUG4051
     O                 80      AMOUNT    53 '  ,   ,   , 0 .  '                              BUG4051
     O                 81      AMOUNT    53 ' ,   ,   , 0 .   '                              BUG4051
     O                                   64 'CURRENCY'                                       BUG4051
     O                         CCY       68                                                  BUG4051
     O                                   83 'NARRATIVE'                                      BUG4051
     O                         O#PNA2   114                                                  BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1 49                                                              BUG4051
     O                                   32 'DEBIT  ACCOUNT NO.'                             BUG4051
     O                         MABR      36                                                  BUG4051
     O                                   37 '-'                                              BUG4051
     O                         DBICN     43                                                  BUG4051
     O                                   44 '-'                                              BUG4051
     O                         CCY       47                                                  BUG4051
     O                                   48 '-'                                              BUG4051
     O                         MADFR     58                                                  BUG4051
     O                                   59 '-'                                              BUG4051
     O                                   61 '01'                                             BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1 49                                                              BUG4051
     O                                   31 'PAYMENT AMOUNT'                                 BUG4051
     O                 78      AMOUNT    53 ' ,   ,   ,   , 0 '                              BUG4051
     O                 79      AMOUNT    53 '   ,   ,   , 0 . '                              BUG4051
     O                 80      AMOUNT    53 '  ,   ,   , 0 .  '                              BUG4051
     O                 81      AMOUNT    53 ' ,   ,   , 0 .   '                              BUG4051
     O                                   64 'CURRENCY'                                       BUG4051
     O                         CCY       68                                                  BUG4051
     O                                   83 'NARRATIVE'                                      BUG4051
     O                         O#PNA2   114                                                  BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1 49                                                              BUG4051
     O                                   32 'CREDIT ACCOUNT NO.'                             BUG4051
     O                         MABR      36                                                  BUG4051
     O                                   37 '-'                                              BUG4051
     O                         CBICN     43                                                  BUG4051
     O                                   44 '-'                                              BUG4051
     O                         CCY       47                                                  BUG4051
     O                                   48 '-'                                              BUG4051
     O                         MADTO     58                                                  BUG4051
     O                                   59 '-'                                              BUG4051
     O                                   61 '01'                                             BUG4051
      *                                                                                      BUG4051
     O        E 1      44NU1 49                                                              BUG4051
     O                                   31 'PAYMENT AMOUNT'                                 BUG4051
     O                 78      AMOUNT    53 ' ,   ,   ,   , 0 '                              BUG4051
     O                 79      AMOUNT    53 '   ,   ,   , 0 . '                              BUG4051
     O                 80      AMOUNT    53 '  ,   ,   , 0 .  '                              BUG4051
     O                 81      AMOUNT    53 ' ,   ,   , 0 .   '                              BUG4051
     O                                   64 'CURRENCY'                                       BUG4051
     O                         CCY       68                                                  BUG4051
     O                                   83 'NARRATIVE'                                      BUG4051
     O                         O#PNA4   114                                                  BUG4051
      *                                                                                      BUG4051
     O********T*3      LRNU1 U7                                                      BUG4051 BUG5350
     O        E 3      LRNU1 U7                                                              BUG5350
     O       AND       55                                                                    BUG4051
     O                                   74 '*** DATABASE ERROR ***'                         BUG4051
      *                                                                                      BUG4051
     O********T*3      L1NU1 55                                                      BUG4051 BUG4051
     O********T*3      LRNU1 55                                                      BUG4051 BUG5350
     O        E 3      LRNU1 55                                                              BUG5350
     O                                   32 'NO. OF ENTRIES GENERATED'                       BUG4051
     O                         RGESON1   70                                                  BUG4051
      *                                                                                      BUG4051
     O********T*2      L1NU1 55                                                      BUG4051 BUG4051
     O**********       77                66 '*** END OF REPORT FOR'                  BUG4051 BUG4051
     O**********       77                74 ' BRANCH '                               BUG4051 BUG4051
     O**********       77      TXBRCA    77                                          BUG4051 BUG4051
     O**********       77                81 ' ***'                                   BUG4051 BUG4051
     O********T*2      LRNU1 55                                                      BUG4051 BUG5350
     O        E 2      LRNU1 55                                                              BUG5350
     O                N77                76 '*** END OF REPORT ***'                          BUG4051
**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
0000001
0000010
0000100
0001000
0010000
0100000
1000000
**   ZFMD  -  NUMBER OF DAYS IN THE MONTH
312831303130313130313031
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
