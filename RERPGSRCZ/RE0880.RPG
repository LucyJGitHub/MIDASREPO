     H        1
      *****************************************************************
/*S*D****RPGBASE*******************************************************                       CSD053
/*STD *  RPGBNOCVT                                                    *                       CSD053
/*EXS *  RPGCVTOPT1                                                   *                       CSD053
/*EXI *  TEXT('Midas RE Retail advices print (input cycle)')          *
/*OVRF*: OVRDBF GLJEXXX1 GLJENPL1                                   : *   S01194
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module                                        *
     F*                                                               *
     F*  RE0880 - RETAIL ADVICES PRINT                                *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. BA6026             Date 18Jan23               *
      *  Prev Amend No. CSD103             Date 10Aug20               *
      *                 MD046248           Date 27Oct17               *
      *                 MD033984           Date 21Jul15               *
      *                 MD027587           Date 19Jun14               *
      *                 CAP207             Date 10Feb11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG25001           Date 20Jul09               *
      *                 BUG25185A          Date 01Aug09               *
      *                 BUG24780           Date 07Jul09               *
      *                 CER030             Date 09Jul08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 246518             DATE 13Jun07               *
      *                 241672A            Date 09Jan07               *
      *                 CRE026             Date 24May06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CSD053             Date 01Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 CSC024             Date 07Feb05               *
      *                 CSW037A            Date 02May05               *
      *                 BUG6198            Date 04Apr05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 BUG2368            Date 30Apr04               *
      *                 CSC022             Date 24Feb04               *
      *                 CGL029             Date 03Sep01               *
      * Midas Release 4.01.02 ----------------------------------------*
      *                 185134             Date 11Apr02               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      *                 CFT004             Date 19Jul99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CEU013             Date 21Apr98               *
      *                 124551 (71136)     Date 18Feb98               *
     F*                 S01408             DATE 08FEB96               *
     F*                 S01408             DATE 13DEC95               *
     F*                 092944             DATE 11SEP95               *
     F*                 S01408             DATE 17MAY94               *
     F*                 044271             DATE 28SEP93               *
     F*                 S01413             DATE 13APR93               *
     F*                 S01340             DATE 20FEB92               *
     F*                 S01267             DATE 18SEP90               *
     F*                 S01251             DATE 03FEB90               *
     F*                 E19461             DATE 19DEC89               *
     F*                 LN0790             DATE 20SEP90               *
     F*                 E21704             DATE 02MAY90               *
     F*                 S01184             DATE 17APR90               *
     F*                 E20356             DATE 02APR90               *
     F*                 E19313             DATE 19MAR90               *
     F*                 E19860             DATE 19MAR90               *
0010 F*                 S01194             DATE 19MAR90               *
0010 F*                 S01247             DATE 16MAR90               *
0010 F*                 S01117             DATE 07DEC89               *
0010 F*                 HK0000             DATE 13DEC89               *
0011 F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  BA6026 - Structuring Current MT940 and SEPA Compliance.      *
      *           Add parameters to MG001901 call.                    *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *             (Recompile)                                       *
      *  MD046248 - Finastra Rebranding                               *
      *  MD033984 - Recompiled due to RE0880P1 changes.               *
      *  MD027587 - Unable to used the C for Copy and T for Template  *
      *             (Recompile)                                       *
      *  CAP207 - Account Balance Check extended to other APIs        *
      *           (Recompile)                                         *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG25001 - Extended Narrative does not follow PAPER's format *
      *  BUG25185A - Workstation Lock error when viewing a batch      *
      *  BUG24780 - No advice generated                               *
      *  CER030 - Multicash German Feature                            *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  246518 - Workstation ID should be unique for RE0880 to avoid *
      *           lock with QZDASOINIT.                               *
      *  241672A- REC0880 in MSGW due to locked record.               *
      *  CRE026 - Consumer Banking                                    *
      *  CSD053 - Correspondence Manager Multilanguage Testing        *
      *         - (Recompile)                                         *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CSC024 - Open Month End (Recompile)                          *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  BUG6198- Cannot save new Details for CUSD (Recompile)        *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  BUG2368- Programs looking at wrong dataarea for CSC022       *
      *  CSC022 - Commitment Control Changes for MidasPlus            *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  185134 - Report does not reference to alternative address set*
      *           in CGCORRPD if S01523 is on. Patterned after fix    *
      *           059892.                                             *
      *  CFT004 - Straight Through Processing Phase 2                 *
      *           International Bank Account Numbers (IBAN)           *
     F*  CEU013 - EMU Account Postings Narrative                      *
     F*  124551 - RETAIL ADVICES DO NOT PRINT NARRATIVE DESCRIPTION   *
     F*           WHEN A NARRATIVE CODE IS USED. APPLY 71136          *
     F*  S01408 - Core hook RE0880IIP1 added                          *
     F*           Core hook RE0880CCP2 added                          *
     F*  S01408 - Core hook RE0880CCP1 added                          *
     F*  092944 - FIELD 'RETAIL ADVICE PRINTED' ON HEADER NEVER       *
     F*           UPDATED. APPLIED 075181.                            *
     F*  S01408 - Core hook RE0880CCPG added                          *
     F*  044271 - Completion of fix B6930 - When terminal names have  *
     F*           10 characters, the last two characters are lost     *
     F*           (B6930  - Only update last two characters of batch  *
     F*           header instead of changing last three to **         *
     F*           and then blanking it out entirely)                  *
     F*  S01413 - Retail 3 incorporation                              *
     F*  S01340 - RECOMPILED FOR MIS RELEASE 10 CHANGES.              *
     F*  S01267 - RECOMPILED FOR MIS RELEASE 2.2 CHANGES.             *
     F*  S01251 - THIS HAS BEEN PUT IN BY S01194                      *
     F*           SYNON FILE/PROGRAM NAME CHANGES                     *
     F*  E19461 - PROGRAM RECOMPILED - PRINT FILE RE0880P1 WAS        *
     F*           AMENDED TO CORRECT OVERPRINTING.                    *
     F*  LN0790 - WRONG FIELD BEING USED TO ACCESS SDBRCHPD           *
     F*  E21704 - NUMERIC DATE FORMAT NOT USED IN ADVICES -           *
     F*           ALPHABETIC (DDMMMYY) FORMAT USED INSTEAD - BUT THE  *
     F*           STATUS OF *IN98 MUST BE UPDATED SOMEWHERE IN THE    *
     F*           PROGRAM, BECAUSE IT IS REFERRED TO IN THE STANDARD  *
     F*           SUBROUTINE ZDATE2.                                  *
     F*  S01184 - BATCH TEMPLATE FACILITY - BATCH NUMBER NOW A        *
     F*           CHARACTER FIELD                                     *
     F*  E20356 - DATABASE ERROR IF RETAIL ACCOUNT NUMBERS NOT        *
     F*           USED IN SYSTEM - ACCOUNT MASTER FILE SHOULD BE      *
     F*           ACCESSED THROUGH ACCNTL0, NOT ACCNTL1.   ALSO,      *
     F*           LOKUP OF CURRENCY ARRAY FAILS ON SECOND PASS        *
     F*           BECAUSE ELEMENT NO. NOT RESET.                      *
     F*  E19313 - RE0880 UNABLE TO ALLOCATE RECORD IN GLJENPL1        *
     F*           WHEN IT HAES READ ALL ITEMS FROM CURRENT            *
     F*           BATCH, IT ATTEMPTS TO READ THE FIRST RECORD         *
     F*           FROM THE NEXT BATCH TO CONFIRM ALL RECORDS          *
     F*           HAVE BEEN READ. THIS RECORD MAY BE LOCKED           *
     F*           BY BATCH INPUT AND READE WILL FAIL.                 *
     F*           FIX BY READING INPUT ONLY FILE FIRST AND            *
     F*           ONLY READING GLJENPL1 IF THE READE IS               *
     F*           SUCCESSFUL.                                         *
     F*  E19860 - BRCKST SET TO 'N' INSTEAD OF ' '                    *
     F*  S01194 - NEW STANDING DATA.                                  *
     F*  S01247 - SUPPRESSION OF 'BRANCH' ON RETAIL ADVICES           *
     F*  HK0000 - 1) SETON INDICATOR 13 WHEN THE LOKUP OPERATION      *
     F*              ON CURRENCY DETAILS ARRAY IS SUCCESSFUL,         *
     F*              ELSE DATABASE ERROR REPORTED.                    *
     F*  S01117 - MULTIBRANCHING                                      *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*
     F/COPY WNCPYSRC,RE0880F003
     F*GLBRREL0UF*E***********K*       DISK         KCOMIT                S01194
     FGLJENHL0UF  E           K        DISK         KCOMIT                S01194
     F                                              KINFDS GLHDS                             241672A
     FGLJEXXX1IF  E           K        DISK         KCOMIT                E19313
     F            @BTREAL                           KRENAME@BTXXX         E19313
     F*GLBTREL1UF*E***********K*       DISK         KCOMIT                S01194
     FGLJENPL1UF  E           K        DISK         KCOMIT                S01194
     FSDCUSTL0IF  E           K        DISK
     F*DBRCHL0IF**E           K        DISK                               S01117
     FSDCURRL0IF  E           K        DISK
     FSDDEPTL0IF  E           K        DISK
     FSDRETRL0IF  E           K        DISK
     F/COPY WNCPYSRC,RE0880F004
     FSDNARRL0IF  E           K        DISK                               071136
     F/COPY WNCPYSRC,RE0880F002
     F*ACCNTL1*IF*E***********K        DISK                               E20356
     FACCNTL0 IF  E           K        DISK                               E20356
     FREIAC   IF  E           K        DISK
      *                                                                                       CER030
      ** Midas GL Journal entry add Info by Batch No                                          CER030
      *                                                                                       CER030
     F***GLJENXL5IF  E           K        DISK                                       CER030 BUG25001
     FGLJENXL1IF  E           K        DISK                                                 BUG25001
      *                                                                                     BUG25001
      ** Midas GL Network Accounts                                                          BUG25001
      *                                                                                     BUG25001
     FGLNWACL1IF  E           K        DISK                                                 BUG25001
      *                                                                                     BUG25001
      ** GL Multicash Narratives File                                                       BUG25001
      *                                                                                     BUG25001
     FGLMNARL1IF  E           K        DISK                                                 BUG25001
      *                                                                                     BUG25001
     F*E0880P1O** E                    PRINTER                            S01117
     FRE0880P1O   E                    PRINTER      KINFDS SPOOL      UC  S01117
     FRE0880AUO   E                    PRINTER      KINFDS SPOOLU     UC  S01117
     F/COPY WNCPYSRC,RE0880F001
     F*
     F*-------------------------------------------------------------------
     F*                                                                  *
     F* ID F  C  H  L    FUNCTION OF INDICATORS                          *
     F*                                                                  *
     F*    01            Get operation on data area RUNDAT               *
     F*    02            Read operation on SDCURRL0                      *
     F**** 03 *****      Chain operation on GLBRREL0                     *S01194
     F**** 04 *****      Update operation on GLBRREL0                    *S01194
     F*    03            Chain operation on GLJENHL0                     *S01194
     F*    04            Update operation on GLJENHL0                    *S01194
     F*    05            Chain operation on SDDEPTL0                     *
     F*    06            Write operation on RE0781P1                     *
     F**** 07 *****      Chain operation on GLBTREL1                     *S01194
     F*    07            Chain operation on GLJENPL1                     *S01194
     F*    08            Chain operation on SDRETRL0                     *
     F*    10            Chain operation on SDCUSTL0                     *
     F*    11            Chain operation on SDBRCHL0                     *
     F*    12            Update operation on GLJENPL1                    *S01251
     F*    13            Lokup - Currency not found (ends Lokup search)  *E20356
     F*    14            Chain Fail on Accounts Master File              *E20356
     F*    15            Lokup - Currency found on array                 *E20356
     F*    19            Chain operation on REIAC                        *
     F*    16            Suppression of 'BRANCH' on Header               *S01247
      *    22            Error occurred on GLJENHPD                      *                   241672A
     F*    40            To indicate amount as debit on advice           *
     F*    41            To indicate abnormal termination on print out   *
     F*    88            Multibranch indicator MBIN = 'Y'                *S01117
     F*       90-99      STANDARD SUBROUTINES / WORK INDS.               *
      *    U3            Record lock on GLJENHPD                         *                   241672A
     F*
     F*                Unused indicators
     F*                -----------------
     F*       ..  ..  ..  ..  ..  ..  ..  ..  ..  ..
     F*       ..  ..  ..  ..  ..  ..  17  18  ..  20                      S01247
     F*       21  22  23  24  25  26  27  28  29  30
     F*       31  32  33  34  35  36  37  38  39  ..
     F*       ..  42  43  44  45  46  47  48  49  50
     F*       51  52  53  54  55  56  57  58  59  60
     F*       61  62  63  64  65  66  67  68  69  70
     F*       71  72  73  74  75  76  77  78  79  80
     F*       81  82  83  84  ..  86  87  ..  89  ..                      S01413
     F*       ..  ..  ..  ..  ..  ..  ..  ..  ..
     F*
     F********************************************************************
     E/EJECT
     E                    CURY      150  3  A            Currency codes
     E                    DECM      150  1 0             Decimal places
     E/COPY WNCPYSRC,RE0880E002
     E                    INCY      150  1               'In' curr flag   CEU013
     E*  Zdate2 array
     E                    ZYDY    4   4  4 0
     E*  Zdate2 array
     E                    ZMDY   13  13  3 0
     E*  Zdate2 array
     E                    ZMNM   12  12  3
     E                    ZS1        15  1 0
     E                    ZS2        22  1
     E                    CPY@    1   1 80
      *                                                                                       CSC022
      ** Array to hold commitment jobs name                                                   CSC022
      *                                                                                       CSC022
     E                    WCMT       10 10                                                    CSC022
      *                                                                                       CSC022
      ** Arrays defined for Error handling                                                    CER030
      *                                                                                       CER030
     E                    FNMARR     40 10                                                    CER030
     E                    MIDARR     40  7                                                    CER030
     E                    MDTARR     40 45                                                    CER030
     E                    WFLDAR     40 10                                                    CER030
     E                    WMIDAR     40  7                                                    CER030
     E                    WMDTAR     40 45                                                    CER030
     E/COPY WNCPYSRC,RE0880E001
      *                                                                                     BUG25001
      ** Array for 22 * 35                                                                  BUG25001
      *                                                                                     BUG25001
     E                    EXT        22 35                                                  BUG25001
      *                                                                                     BUG25001
     I/EJECT
     I/COPY WNCPYSRC,RE0880I001
     I*                                                                   E20356
     I*  D.S. to make up KLIST for file ACCNT                             E20356
     I*                                                                   E20356
     IDSACCT      DS                                                      E20356
     I                                        1   6 CNUMX                 E20356
     I                                        7   9 CCYX                  E20356
     I**********                             10  13 ACODX                              E20356 CGL029
     I**********                             14  15 ACSQX                              E20356 CGL029
     I**********                             16  18 BRCHX                              S01117 CGL029
     I                                       10  19 ACODX                                     CGL029
     I                                       20  21 ACSQX                                     CGL029
     I                                       22  24 BRCHX                                     CGL029
     I*
     I            DS
     I                                        1  150ZWRK15
     I                                        1  150ZS1
     I            DS
     I                                        1  25 ZOUT25
     I                                        1  21 ZOUT0
     I                                        2  23 ZOUT1
     I                                        3  24 ZOUT2
     I                                        5  25 ZOUT3
     I*UNDAT***** DS                             13                       S01117
     I***********                             1   7 RDATE                 S01117
     I**                                                                  S01117
     I** DATA AREA RUNDAT                                                 S01117
     I**                                                                  S01117
     IRUNDT       DS                                                      S01117
     I                                        1   7 RUNA                  S01117
     I                                    P   8  100RUND                  S01117
     I                                       11  11 SSF                   S01117
     I                                       12  12 DATF                  S01117
     I                                       13  13 MBIN                  S01117
     I**                                                                  S01117
     I            DS
     I*
     I*     Sub fields to hold key values of files
     I*
     I                                        1   6 TRNKEY
     I*
     I************                            1   30BTJDNB          S01184S01194
     I                                        1   3 BTBTNB                S01194
     I                                        4   60BTBINB                S01194
     I************                                                        S01194
     I************                            7  21 RETKEY                S01194
     I************                                                        S01194
     I************                            7  120CNUM                  S01194
     I************                           13  15 CCY                   S01194
     I************                           16  190ACOD                  S01194
     I************                           20  210ACSQ                  S01194
     I************                                                        S01194
     I************                           22  31 BTRANB                S01194
     I************                           22  310RTLACC                S01194
     I                                       22  310ACNO                  S01413
     I*
     I***   Local Data Area to identify database errors
     I*
     I*
     I*
     ILDA        UDS                            256
     I***********                           134 138 DBFIL                 S01117
     I***********                           139 167 DBKEY                 S01117
     I***********                           168 175 DBPGM                 S01117
     I***********                           176 1770DBASE                 S01117
     I                                      134 141 DBFILE                S01117
     I                                      142 170 DBKEY                 S01117
     I                                      171 180 DBPGM                 S01117
     I                                      181 1830DBASE                 S01117
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - P1                           S01117
     I**                                                                  S01117
     ISPOOL       DS                                                      S01117
     I                                       83  92 SFILE                 S01117
     I                                    B 123 1240SFNUM                 S01117
     I                                    B 188 1890OFLLN1                                    CER030
     I                                    B 367 3680PRTLN1                                    CER030
     I**                                                                  S01117
     I**   FILE INFORMATION DATA STRUCTURE - AU                           S01117
     I**                                                                  S01117
     ISPOOLU      DS                                                      S01117
     I                                       83  92 SFILEU                S01117
     I                                    B 123 1240SFNUMU                S01117
      *                                                                                      241672A
     IGLHDS       DS                                                                         241672A
     I                                     *STATUS  GLHST                                    241672A
     IGLHDET      DS                                                                         241672A
     I                                        1   5 GH4RTY                                   241672A
     I                                        6  10 GH4WAT                                   241672A
     I                                       11  15 GH8RTY                                   241672A
     I                                       16  20 GH8WAT                                   241672A
      *                                                                                       CER030
     IACCDS       DS                                                                          CER030
     I                                        1  100PACOD                                     CER030
     I                                       11  120PACSQ                                     CER030
      *                                                                                       CER030
     I**                                                                  S01117
     I**   EXTERNAL DATA STRUCTURE FOR BRANCH DETAILS                     S01117
     I**                                                                  S01117
     ISDBRCH    E DSSDBRCHPD                                              S01117
     I**                                                                  S01247
     I**   EXTERNAL DATA STRUCTURE FOR RETAIL DETAILS                     S01247
     I**                                                                  S01247
     ISDRETL    E DSSDRETLPD                                              S01247
     I**                                                                  S01247
     I**                                                                  S01117
     ISCSARD    E DSSCSARDPD                                              CFT004
      ** MIDAS Switchable Features Accessed Via Access Program            CFT004
      *                                                                   CFT004
     IDSFDY     E DSDSFDY                                                 S01117
     I* FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE                S01117
      *                                                                   185134
     ISDALTN    E DSSDALTNPD                                              185134
      ** External DS for Alternative Names and Addresses Details          185134
     I*                                                                   S01247
     IDSSDY     E DSDSSDY                                                 CFT004
      *                                                                   CFT004
      ** Long data structure for access programs.                         CFT004
      *                                                                                       CSC022
     IDSPGM     ESDSY2PGDSP                                                                   CSC022
      ** Program data structure                                                               CSC022
      *                                                                                       CSC022
     IWDSJOB    E DSSCCMTJOB                                                                  CSC022
     I              COMITNUM                        WCMTNO                                    CSC022
     I              COMITJOB1                       WJOB01                                    CSC022
     I              COMITJOB2                       WJOB02                                    CSC022
     I              COMITJOB3                       WJOB03                                    CSC022
     I              COMITJOB4                       WJOB04                                    CSC022
     I              COMITJOB5                       WJOB05                                    CSC022
     I              COMITJOB6                       WJOB06                                    CSC022
     I              COMITJOB7                       WJOB07                                    CSC022
     I              COMITJOB8                       WJOB08                                    CSC022
     I              COMITJOB9                       WJOB09                                    CSC022
     I              COMITJOB10                      WJOB10                                    CSC022
     I                                        4 103 WCJOBS                                    CSC022
      ** Commitment Control dataarea                                                          CSC022
      *                                                                                       CSC022
     I/COPY WNCPYSRC,RE0880IIP1
     I*                                                                   S01117
     I*                                                                   S01117
     I/EJECT
     C                     MOVEACPY@      BIS@   80
     C           *NAMVAR   DEFN           LDA                             S01117
     C*
     C*----------------------Program begins-------------------------------
     C*
     C*     Program initialisation
     C*
     C                     EXSR INITSR
     C*
     C*     Process transaction records and print advices
     C*
     C                     EXSR TRANSR
     C*
     C*     Program termination
     C*
     C                     EXSR TERMSR
     C*
     C********************************************************************
     C*                                                                  *
     C*     TRANSR SR     SUB-ROUTINE                                    *
     C*                                                                  *
     C*     Transaction processing                                       *
     C*                                                                  *
     C********************************************************************
     C*
     C           TRANSR    BEGSR
     C*
     C*     Position pointer on first transaction record of the batch
     C*
     C           BATCH     CHAINGLJEXXX1             07                   E19313
     C  N07      BATCH     CHAINGLJENPL1             07                   E19313
     C***********BATCH     CHAINGLBTREL1             07                   E19313
     C*
     C/COPY WNCPYSRC,RE0880C019
     C*     Data base error if no transaction recs exist for the batch
     C*
     C           *IN07     IFEQ '1'
     C                     Z-ADD01        DBASE            * DB ERROR 01 *
     C                     MOVEL'GLJENPL1'DBFILE                          S01194
     C                     MOVELBATCH     DBFKEY
     C                     EXSR ERORSR
     C                     END
     C**                                                                  S01117
     C*    OPEN RE0880P1 FOR OUTPUT                                       S01117
     C**                                                                  S01117
     C                     OPEN RE0880P1                                  S01117
     C**                                                                  S01117
     C*    ENSURE REPORT SPOOL FILE RECORDED BY RCF                       S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUM     ZSNUM   60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ     5                       S01117
     C                     PARM BTIBCA    SENTY                           S01117
     C                     PARM           SFILE                           S01117
     C                     PARM           ZSNUM                           S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8LR               S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C*
     C*     Process all transactions relating to the batch
     C*
     C           *IN07     DOWEQ'0'
     C*
     C*     Ignore transactions that have not been shadow posted
     C*
     C           BTSHPI    CABNE'Y'       GETREC                          S01194
     C*
     C*     Ignore non retail transactions
     C*
     C           BTACTY    CABNE'R'       GETREC                          S01194
     C*
     C*     Ignore transaction if its advice has been printed
     C*
     C           BTRADP    CABEQ'Y'       GETREC                          S01194
     C*
     C*     Access transaction types file using the narrative code
     C*
     C           BTTRTY    CHAINSDRETRL0             08                   S01194
     C*
     C*     Data base error if record not found
     C*
     C           *IN08     IFEQ '1'                        NARR NOT
     C                     MOVE *BLANK    A1RTNM           FOUND          S01194
     C                     END
     C*
     C*     Ignore transaction if advice not required for this type
     C*
     C           A1PADI    CABNE'Y'       GETREC                          S01194
     C*                                                                   CEU013
     C* Retrieve 'In' currency flag for item currency                     CEU013
     C* If currency is not found, the data base error is not issued,      CEU013
     C*  as this is performed in Print sub routine.                       CEU013
     C*                                                                   CEU013
     C                     Z-ADD1         X                               CEU013
     C           BTCYCD    LOKUPCURY,X                   15               CEU013
     C                     MOVE *BLANK    WKINCY  1                       CEU013
     C           *IN15     IFEQ *ON                                       CEU013
     C                     MOVE INCY,X    WKINCY                          CEU013
     C                     ENDIF                                          CEU013
     C*
     C*     Access accounts master file
     C*
     C                     MOVE BTCUST    CNUM                            E20356
     C                     MOVE BTCYCD    CCY                             E20356
     C                     MOVE BTACCD    ACOD                            E20356
     C                     MOVE BTACSN    ACSQ                            E20356
     C*                                                                   E20356
     C*                                                                   E20356
     C           ACCKEY    KLIST                                          E20356
     C                     KFLD           CNUM                            E20356
     C                     KFLD           CCY                             E20356
     C                     KFLD           ACOD                            E20356
     C                     KFLD           ACSQ                            E20356
     C                     KFLD           BTIBCA                          S01117
     C*
     C***********RTLACC    CHAINACCNTL1              14                   E20356
     C           ACCKEY    CHAINACCNTL0              14                   E20356
     C/COPY WNCPYSRC,RE0880C011
     C*
     C*     Data base error if record not found
     C*     (OR IF ACCOUNT FOUND IS NON-RETAIL)                           E20356
     C*                                                                   CEU013
     C* If switchable feature CEU013 is installed, the batch is an        CEU013
     C*   interface batch and the item currency is an 'In' currency,      CEU013
     C*   then the account may not be existing and hence is not an        CEU013
     C*   error. The Journal entry interface batch maintenance allows     CEU013
     C*   only Retail or Nostro accounts and hence check for Retail       CEU013
     C*   account is not performed.                                       CEU013
     C*
     C           *IN14     IFEQ '1'
     C           CEU013    ANDNE'Y'                                       CEU013
     C           BRTOJE    ANDNE'I'                                       CEU013
     C           WKINCY    ANDNE'Y'                                       CEU013
     C           ATYP      ORNE 'R'                                       E20356
     C           *IN14     ANDEQ*OFF                                      CEU013
     C                     Z-ADD03        DBASE            * DB ERROR 03 *
     C*********************MOVEL'ACCNTL1'*DBFILE                          E20356
     C                     MOVEL'ACCNTL0' DBFILE                          E20356
     C*********************MOVELBTB9NB****DBFKEY                          E20356
     C                     MOVE CNUM      CNUMX                           E20356
     C                     MOVE CCY       CCYX                            E20356
     C                     MOVE ACOD      ACODX                           E20356
     C                     MOVE ACSQ      ACSQX                           E20356
     C                     MOVE BTIBCA    BRCHX                           S01117
     C                     MOVELDSACCT    DBFKEY                          E20356
     C                     EXSR ERORSR
     C                     END
     C*                                                                   S01413
     C* Spool opened at start so check for close and open for new branch  S01413
     C* at each subsequent account                                        S01413
     C*                                                                   S01413
     C* If the account is not found, the further process is bypassed      CEU013
     C*  and the next record is read.                                     CEU013
     C*                                                                   CEU013
     C           *IN14     IFEQ *OFF                                      CEU013
     C           OBRCA     IFNE BRCA                                      S01413
     C           *IN85     IFEQ *ON                                       S01413
     C                     CLOSERE0880P1                                  S01413
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0880CCP1                                           S01408
     C*                                                                   S01408
     C                     OPEN RE0880P1                                  S01413
     C                     ENDIF                                          S01413
     C                     SETON                     85                   S01413
     C                     Z-ADDSFNUM     ZSNUM                           S01413
     C                     CALL 'ZSFILE'                                  S01413
     C                     PARM           SEQ     5                       S01413
     C                     PARM BRCA      SENTY   3                       S01413
     C                     PARM           SFILE                           S01413
     C                     PARM           ZSNUM   60                      S01413
     C                     PARM           ZSERR   1                       S01413
     C*                                                                   S01413
     C           ZSERR     IFEQ 'Y'                                       S01413
     C** ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM        S01413
     C** DBASE, DBFILE AND DBKEY SET WITHIN ZSFILE                        S01413
     C           *LOCK     IN   LDA                                       S01413
     C                     MOVEL'RE0880P1'DBFILE                          S01413
     C                     MOVEL'OPEN    'DBFKEY                          S01413
     C                     Z-ADD02        DBASE            * DB ERROR 02 *S01413
     C                     OUT  LDA                                       S01413
     C                     EXSR ERORSR                                    S01413
     C                     RETRN                                          S01413
     C                     END                                            S01413
     C                     MOVELBRCA      OBRCA   3                       S01413
     C                     ENDIF                                          S01413
     C*
     C*     Access retail interest and charges
     C*
     C***********ACCKEY****KLIST**************                            E20356
     C*********************KFLD***********CNUM                            E20356
     C*********************KFLD***********CCY                             E20356
     C*********************KFLD***********ACOD                            E20356
     C*********************KFLD***********ACSQ                            E20356
     C*
     C*
     C           ACCKEY    CHAINREIAC                09
     C*
     C*     Data base error if record not found
     C*
     C           *IN09     IFEQ '1'
     C                     Z-ADD04        DBASE            * DB ERROR 04 *
     C                     MOVEL'REIAC'   DBFILE
     C*********************MOVELRETKEY****DBFKEY                          E20356
     C                     MOVE CNUM      CNUMX                           E20356
     C                     MOVE CCY       CCYX                            E20356
     C                     MOVE ACOD      ACODX                           E20356
     C                     MOVE ACSQ      ACSQX                           E20356
     C                     MOVE BTIBCA    BRCHX                           S01117
     C                     MOVELDSACCT    DBFKEY                          E20356
     C                     EXSR ERORSR
     C                     END
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
     C* If Retail interest and charges record is not retrieved the        CEU013
     C*   field Print transaction advice has the value of previous        CEU013
     C*   record and hence is initialised.                                CEU013
     C*                                                                   CEU013
     C           *IN14     IFEQ *ON                                       CEU013
     C                     MOVE 'N'       PTRA                            CEU013
     C                     ENDIF                                          CEU013
     C*                                                                   CEU013
     C*
     C*     Ignore transaction if advice not required for this account
     C*
     C           PTRA      CABNE'Y'       GETREC
     C*
     C*     Access customer master
     C*
     C           BTCUST    CHAINSDCUSTL0             10                   S01194
     C*
     C**    Data base error if record not found
     C*
     C           *IN10     IFEQ '1'
     C                     Z-ADD05        DBASE            * DB ERROR 05 *
     C                     MOVEL'SDCUSTL0'DBFILE
     C                     MOVELBTCUST    DBFKEY                          S01194
     C                     EXSR ERORSR
     C                     END
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0880CCPG                                           S01408
     C*                                                                   S01408
     C*
     C*     Retrieve branch name from branch record
     C*
     C***********BTC1CD    CHAINSDBRCHL0             11                   S01117
     C***********                                                         S01117
     C******Data*base error if record not found                           S01117
     C***********                                                         S01117
     C************IN11     IFEQ '1'                                       S01117
     C***********          Z-ADD06        DBASE            * DB ERROR 06 *S01117
     C***********          MOVEL'SDCUSTL0'DBFILE                          S01117
     C***********          MOVELBTCUST    DBFKEY                    S01117S01194
     C***********          EXSR ERORSR                                    S01117
     C***********          END                                            S01117
     C**********           CALL 'AOBRCHR0'                                S01117              CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7                       S01117
     C                     PARM '*KEY   ' @OPTN   7                       S01117
     C*****                PARM BTC1CD    @DSNB   3                S01117 LN0790
     C***********          PARM BTBCBH    @DSNB   3                LN0790 S01413
     C                     PARM BTIBCA    @DSNB   3                       S01413
     C********** SDBRCH    PARM SDBRCH    DSFDY                           S01117              CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C           @RTCD     IFNE *BLANKS                                   S01117
     C                     MOVEL@DSNB     DBKEY                           S01117
     C                     MOVEL'SDBRCHPD'DBFILE           ***************S01117
     C                     Z-ADD06        DBASE            * DBERROR 006 *S01117
     C                     SETON                     U7U8LR               S01117
     C                     EXSR ERORSR                                    S01117
     C                     END                                            S01117
     C*
     C*     Print a retail advice
     C*
     C/COPY WNCPYSRC,RE0880C007
     C                     EXSR PRNTSR
     C/COPY WNCPYSRC,RE0880C008
     C*
     C*     Update transaction record to show that its printed
     C*
     C                     MOVE 'Y'       BTRADP                          S01194
     C                     UPDAT@BTREAL                12
     C*
     C*     Data base error if update fails
     C*
     C           *IN12     IFEQ '1'
     C                     Z-ADD07        DBASE            * DB ERROR 07 *
     C                     MOVEL'GLJENPL1'DBFILE                          S01194
     C                     MOVELTRNKEY    DBFKEY
     C                     EXSR ERORSR
     C                     END
     C*
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCMTSK    ANDEQ'N'                                                           CSC022
     C                     COMIT
     C                     ENDIF                                                              CSC022
     C*
     C           GETREC    TAG
     C*
     C*     Read next transaction record
     C*     READ DUMMY FILE FIRST IN CASE RECORD LOCK                     E19313
     C*
     C           BATCH     READE@BTXXX                   07               E19313
     C********** BATCH     READE@BTREAL                  07               E19313
     C  N07      BATCH     READE@BTREAL                  07
     C/COPY WNCPYSRC,RE0880C020
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C*                                                                  *
     C*     ZDATE2 SR     SUB-ROUTINE                                    *
     C*                                                                  *
     C*     To convert a day number to date formats.                     *
     C*     The year 2000, being divisible by 400, is a leap year.
     C*                                                                  *
     C********************************************************************
     C*
     C           ZDATE2    BEGSR                                       **
     C*
     C*    Clear date fields.
     C*
     C                     Z-ADD0         ZDATE   60
     C                     MOVEL'       ' ZADATE  7
     C*
     C*    Calculation to define input day number.
     C*
     C                     Z-ADDZDAYNO    ZDAYNO  50
     C*
     C*    Determine year number.
     C*    Adjust day number in case last day of year.
     C*
     C           ZDAYNO    SUB  1         ZDAYN1  50   99
     C   99                GOTO ZDEND2
     C*
     C*    Calculate number of 4 year spans since 31/12/1971.
     C*
     C           ZDAYN1    DIV  1461      ZLYR    20
     C                     MVR            ZDAYN1                       NG
     C*
     C*    Calculate number of remaining years.
     C*
     C                     Z-ADD1         ZWRK2   20
     C*
     C           ZDTAG1    TAG                                         G *
     C*
     C           ZDAYN1    COMP ZYDY,ZWRK2             90
     C  N90      ZWRK2     ADD  1         ZWRK2
     C  N90                GOTO ZDTAG1
     C           ZWRK2     SUB  1         ZWRK2          91            ON
     C*
     C*    Decrement day no by days in remaining years.
     C*
     C  N91      ZDAYN1    SUB  ZYDY,ZWRK2ZDAYN1
     C*
     C*    Calculate actual year number.
     C*
     C           ZLYR      MULT 4         ZWRK3   30
     C           ZWRK3     ADD  72        ZWRK3
     C                     Z-ADDZWRK3     ZYEAR   20
     C           ZYEAR     ADD  ZWRK2     ZYEAR
     C*
     C*    Determine month number.
     C*    Adjust day no in case last day of leap year february.
     C*
     C                     SETOF                     9293
     C   91      ZDAYN1    COMP 59                     9293
     C   91N92   ZDAYN1    SUB  1         ZDAYN1
     C*
     C*    Calculate month number.
     C*
     C                     Z-ADD2         ZWRK2
     C           ZDTAG2    TAG                                         G *
     C           ZDAYN1    COMP ZMDY,ZWRK2             94
     C  N94      ZWRK2     ADD  1         ZWRK2
     C  N94                GOTO ZDTAG2
     C           ZWRK2     SUB  1         ZWRK2
     C                     Z-ADDZWRK2     ZMTH    20       MONTH
     C*
     C*    Determine day of month.
     C*    Add back last day of year adjustment.
     C*
     C           ZDAYN1    ADD  1         ZDAYN1
     C*
     C*    Calculate day of month.
     C*
     C           ZDAYN1    SUB  ZMDY,ZWRK2ZDAY    20       DAY
     C*
     C*    Add back leap year 29th Febuary adjustment if required.
     C*
     C   93      ZDAY      ADD  1         ZDAY
     C*
     C*    Format date DDMMYY OR MMDDYY.
     C*
     C  N98                MOVELZDAY      ZWRK4   40
     C   98                MOVE ZDAY      ZWRK4
     C  N98                MOVE ZMTH      ZWRK4
     C   98                MOVELZMTH      ZWRK4
     C                     MOVELZWRK4     ZDATE
     C                     MOVE ZYEAR     ZDATE
     C**
     C**   Format alpha date DDMMMYY.
     C**
     C           ZDAY      COMP 10                     95
     C                     MOVELZDAY      ZWRK5   5
     C   95                MOVEL' '       ZWRK5
     C                     MOVE ZMNM,ZMTH ZWRK5
     C                     MOVELZWRK5     ZADATE
     C                     MOVE ZYEAR     ZADATE
     C*
     C           ZDEND2    ENDSR                                       SR*
     C*
     C*
     C********************************************************************
     C*                                                                  *
     C*     ZFRPED SR     SUB-ROUTINE                                    *
     C*                                                                  *
     C*     ZFRPED subroutine to insert a decimal point and sign into a  *
     C*     numeric field and to blank out leading zeros (optionaly      *
     C*     inserting commas).                                           *
     C*     Input fields:   ZFLD15 15/0                                  *
     C*                     ZDECS  1/0                                   *
     C*                     ZECODE 1/  ('A','C','J','L' or blank)        *
     C*                                ( Default is 'J')                 *
     C*     Arrays:         ZS1    15/1/0                                *
     C*                     ZS2    22/1/                                 *
     C*                                                                  *
     C*     Output fields:  ZOUT22 22                                    *
     C*     Output fields:  ZOUT25 25  (ALIGNED BY DECIMAL POINT)        *
     C*         (The last 2 characters will be '  ','CR',or '- ')        *
     C*
     C********************************************************************
     C*                                                                  *
     C           ZFRPED    BEGSR                                        *
     C*
     C*     Define/Clear fields
     C*
     C                     Z-ADDZFLD15    ZFLD15 150
     C                     Z-ADDZDECS     ZDECS   10
     C                     MOVE ZECODE    ZECODE  1
     C                     MOVE *BLANKS   ZOUT22 22
     C                     MOVE *BLANKS   ZOUT25 25
     C           ZECODE    IFEQ *BLANKS
     C                     MOVE 'J'       ZECODE
     C                     END
     C*
     C*       Set up work fields
     C*
     C                     Z-ADD0         ZS1
     C                     MOVE ' '       ZS2
     C*
     C                     Z-ADD15        Z1      20
     C                     Z-ADD20        Z2      20
     C*
     C           15        SUB  ZDECS     ZINTS   20
     C*
     C* Check if numeric field is negative
     C*
     C           ZFLD15    IFLT *ZEROS
     C           ZECODE    IFEQ 'A'
     C           ZECODE    OREQ 'C'
     C                     MOVEA'CR'      ZS2,21
     C                     ELSE
     C                     MOVE '-'       ZS2,21
     C                     END
     C                     Z-SUBZFLD15    ZFLD15
     C                     END
     C*
     C                     Z-ADDZFLD15    ZWRK15
     C*
     C*       Check to see if there are any decimal places
     C*
     C           ZDECS     CABEQ0         ZS10
     C*
     C*       Set up decimals
     C*
     C                     Z-ADD*ZEROS    ZCNT    10
     C           ZCNT      DOUEQZDECS
     C                     MOVE ZS1,Z1    ZS2,Z2
     C                     SUB  1         Z2
     C                     ADD  1         ZCNT
     C                     SUB  1         Z1
     C                     END
     C*
     C*       Put in decimal place
     C*
     C                     MOVE '.'       ZS2,Z2
     C                     SUB  1         Z2
     C*
     C           ZS10      TAG                             ** ZS10 TAG **
     C*
     C*       Set up integers
     C*
     C                     Z-ADD*ZEROS    CNT3    10
     C           Z1        DOUEQ*ZEROS
     C                     MOVE ZS1,Z1    ZS2,Z2
     C                     SUB  1         Z1
     C                     SUB  1         Z2
     C*
     C* If edit code is 'J', insert a ',' before each group of three
     C* digits - not if beginning of array reached.
     C*
     C           Z2        IFGT *ZEROS
     C           ZECODE    ANDEQ'J'
     C           Z2        ORGT *ZEROS
     C           ZECODE    ANDEQ'A'
     C                     ADD  1         CNT3
     C           CNT3      IFEQ 3
     C                     MOVE ','       ZS2,Z2
     C                     SUB  1         Z2
     C                     Z-ADD*ZEROS    CNT3
     C                     END
     C                     END
     C*
     C                     END
     C*
     C*       Put in leading blanks
     C*
     C                     Z-ADD1         Z2
     C           ZS2,Z2    DOWEQ'0'
     C           ZS2,Z2    OREQ ' '
     C           ZS2,Z2    OREQ ','
     C                     MOVE ' '       ZS2,Z2
     C                     ADD  1         Z2
     C           Z2        CABEQ23        ZS20
     C                     END
     C*
     C*       If no integers put in leading zero
     C*
     C           ZS20      TAG                             ** ZS20 TAG **
     C*
     C           Z2        IFEQ 23
     C                     SUB  2         Z2
     C                     MOVE '0'       ZS2,Z2
     C                     ELSE
     C*
     C           ZS2,Z2    IFEQ '.'
     C                     SUB  1         Z2
     C                     MOVE '0'       ZS2,Z2
     C                     END
     C                     END
     C*
     C*       Sst up output field
     C*
     C                     MOVEAZS2       ZOUT22
     C*
     C           ZDECS     IFEQ 0
     C                     MOVE ZOUT22    ZOUT0
     C                     ELSE
     C*
     C           ZDECS     IFEQ 1
     C                     MOVE ZOUT22    ZOUT1
     C                     ELSE
     C*
     C           ZDECS     IFEQ 2
     C                     MOVE ZOUT22    ZOUT2
     C                     ELSE
     C*
     C                     MOVE ZOUT22    ZOUT3
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C*                                                                  *
     C*     PRNTSR SR     SUB-ROUTINE                                    *
     C*                                                                  *
     C*     Retail advices print                                         *
     C*                                                                  *
     C********************************************************************
     C*
     C           PRNTSR    BEGSR
     C*
     C*     Convert 5 char value date into 7 char value date
     C*
     C                     MOVE BTVLDT    ZDAYNO                          S01194
     C                     EXSR ZDATE2
     C*
     C*     Edit posting amount
     C*
     C                     Z-ADD1         X                               HK0000
     C***********BTCYCD    LOKUPCURY,X               13             HK0000S01194
     C***********BTCYCD    LOKUPCURY,X                   13         HK0000E20356
     C           BTCYCD    LOKUPCURY,X               13  15               E20356
     C*
     C*     Data base error if currency element not found
     C*
     C************IN13     IFEQ '1'                                       HK0000
     C********** *IN13     IFNE '1'                                 HK0000E20356
     C           *IN15     IFEQ '0'                                       E20356
     C                     Z-ADD08        DBASE            * DB ERROR 08 *
     C                     MOVEL'SDCURRL0'DBFILE
     C                     MOVELBTCYCD    DBFKEY                          S01194
     C                     EXSR ERORSR
     C                     END
     C*
     C/COPY WNCPYSRC,RE0880C015
     C                     MOVE BTPTAM    ZFLD15                          S01194
     C/COPY WNCPYSRC,RE0880C016
     C                     MOVE DECM,X    ZDECS
     C                     MOVE 'J'       ZECODE
     C/COPY WNCPYSRC,RE0880C017
     C                     EXSR ZFRPED
     C*
     C*     Move values from file to print line
     C*
     C                     MOVE BTBCBH    BTC1CD                   S01194 LN0790
     C                     MOVE A8BRNM    BRNAME                          S01194
     C                     MOVE BTBTNB    BACHNO                          S01194
     C                     MOVE BTBINB    ITEMNO                          S01194
     C                     MOVE AEDPNM    DEPNAM                          S01194
     C                     MOVE BTRACN    REACNO                          S01194
     C/COPY WNCPYSRC,RE0880C012
     C                     MOVE ZADATE    VDATE
     C/COPY WNCPYSRC,RE0880C013
     C                     MOVE BTCUST    CUSTNO                          S01194
     C                     MOVE BTCYCD    CCYCOD                          S01194
     C                     MOVE BTACCD    ACCODE                          S01194
     C                     MOVE BTACSN    ACCSEQ                          S01194
     C/COPY WNCPYSRC,RE0880C021
     C                     MOVE A1RTNM    TRNNAR                          S01194
      *                                                                   071136
      **    RETRIEVE NARRATIVE DESC IF NARRATIVE CODE USED                071136
      *                                                                   071136
     C           BTNRDC    IFEQ *BLANKS                                   071136
     C           BTNVCD    CHAINSDNARRL0             16                   071136
     C                     MOVELALDON     POSTNR                          071136
     C                     ELSE                                           071136
     C                     MOVE BTNRDC    POSTNR                          S01194
     C                     END                                            071136
     C/COPY WNCPYSRC,RE0880C022
     C                     MOVE ZOUT22    POSAMT
     C/COPY WNCPYSRC,RE0880C009
      *                                                                   185134
      ** Check the first address reference from the ACCNT file.           185134
      *                                                                   185134
     C                     MOVELADREF1    @ADREF  1                       185134
      *                                                                   185134
      ** If the address reference is not blank nor 'B' then get the       185134
      ** address details from the alternative name and address file.      185134
      *                                                                   185134
     C           @ADREF    IFNE *BLANK                                    185134
     C           @ADREF    ANDNE'B'                                       185134
     C                     CALL 'AOALTNR0'                                185134
     C                     PARM *BLANKS   @RTCD                           185134
     C                     PARM '*KEY    '@OPTN                           185134
     C                     PARM BTCUST    @CNUM   6                       185134
     C                     PARM ADREF1    @ADDR   1                       185134
     C           SDALTN    PARM SDALTN    DSFDY                           185134
      *                                                                   185134
     C           @RTCD     IFNE *BLANKS                                   185134
     C                     MOVE *BLANK    @ADREF                          185134
     C                     ELSE                                           185134
     C                     MOVE BCCNA1    CUSAD1                          185134
     C                     MOVE BCCNA2    CUSAD2                          185134
     C                     MOVE BCCNA3    CUSAD3                          185134
     C                     MOVE BCCNA4    CUSAD4                          185134
     C                     ENDIF                                          185134
     C                     ENDIF                                          185134
      *                                                                   185134
      ** Else use the primary addresss from file SDCUSTPD                 185134
      *                                                                   185134
     C           @ADREF    IFEQ *BLANK                                    185134
     C           @ADREF    OREQ 'B'                                       185134
     C                     MOVE BBCNA1    CUSAD1                          S01194
     C                     MOVE BBCNA2    CUSAD2                          S01194
     C                     MOVE BBCNA3    CUSAD3                          S01194
     C                     MOVE BBCNA4    CUSAD4                          S01194
     C                     ENDIF                                          185134
      *                                                                   185134
     C/COPY WNCPYSRC,RE0880C010
     C*
     C*     Set up debit/credit print line
     C*
     C           BTDCIN    IFEQ 'D'                                       S01194
     C                     MOVE '1'       *IN40
     C                     ELSE
     C                     MOVE '0'       *IN40
     C                     END
      *                                                                   CFT004
      ** Format International Bank Account Numbers                        CFT004
      *                                                                   CFT004
     C                     MOVEL*BLANKS   RIBAN                           CFT004
     C                     MOVE '0'       *IN17                           CFT004
     C           CFT004    IFEQ 'Y'                                       CFT004
     C           IBAN      ANDNE*BLANKS                                   CFT004
     C                     CALL 'AOIBANR3'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM IBAN      PIBAN  47                       CFT004
     C                     PARM *BLANKS   PIWITH 47                       CFT004
     C                     PARM *BLANKS   PINOBL 34                       CFT004
      *                                                                   CFT004
     C           PRTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVELPIWITH    RIBAN  47                       CFT004
     C                     MOVE '1'       *IN17                           CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C                     ENDIF                                          CFT004
      *                                                                   CFT004
     C*                                                                   S01247
     C*     Set up 'BRANCH' on Header                                     S01247
     C*                                                                   S01247
     C           BMBNRA    IFEQ 'Y'                                       S01247
     C                     SETON                     16                   S01247
     C                     END                                            S01247
     C/COPY WNCPYSRC,RE0880C004
     C*
     C*     Print common header
     C*
     C                     WRITEADVICE01               06
     C/COPY WNCPYSRC,RE0880C005
     C*
     C*     Print retail account no if account is retail
     C*
     C           BTRACN    IFEQ *ZEROS                                    S01194
     C*********************WRITEADVICE02***************06                 E20356
     C                     WRITEADVICE03               06                 E20356
     C                     ELSE
     C*********************WRITEADVICE03***************06                 E20356
     C                     WRITEADVICE02               06                 E20356
     C                     END
     C/COPY WNCPYSRC,RE0880C018
     C*
     C*     Print common trailer
     C*
     C                     WRITEADVICE04               06
      *                                                                                       CER030
     C           CER031    IFEQ 'Y'                                                           CER030
     C           CER030    OREQ 'Y'                                                         BUG25001
     C                     EXSR EXNARR                                                        CER030
     C                     ENDIF                                                              CER030
     C/COPY WNCPYSRC,RE0880C006
     C*
     C                     ENDSR                                       ***
     C*
     C********************************************************************
     C*
     C           INITSR    BEGSR
     C*
     C*     Accept batch number
     C*
     C           *ENTRY    PLIST
     C                     PARM           PARAM   3
      *                                                                                       CSC022
      ** Access SAR details file to determine if CSC022 switchable feature                    CSC022
      ** is switched on                                                                       CSC022
      *                                                                                       CSC022
     C                     MOVE 'N'       CSC022  1                                           CSC022
     C                     MOVE 'N'       WCMTSK  1                                           CSC022
      *                                                                                       CSC022
     C                     CALL 'AOSARDR0'                                                    CSC022
     C                     PARM *BLANKS   PRTCD                                               CSC022
     C                     PARM '*VERIFY' POPTN                                               CSC022
     C                     PARM 'CSC022'  PSARD                                               CSC022
     C           SCSARD    PARM SCSARD    DSFDY                                               CSC022
      *                                                                                       CSC022
     C           PRTCD     IFEQ *BLANKS                                                       CSC022
     C                     MOVE 'Y'       CSC022                                              CSC022
     C                     MOVE 'N'       WCMTSK                                              CSC022
      *                                                                                       CSC022
     C                     IN   WDSJOB                                                        CSC022
      *                                                                                       CSC022
     C           WCMTNO    IFGT 0                                                             CSC022
     C                     MOVEAWCJOBS    WCMT                                                CSC022
     C                     Z-ADD1         I       20                                          CSC022
      *                                                                                       CSC022
     C           ##JOB     LOKUPWCMT,I                   50                                   CSC022
     C           *IN50     IFEQ *ON                                                           CSC022
     C                     MOVE 'Y'       WCMTSK                                              CSC022
     C                     ENDIF                                                              CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C                     ELSE                                                               CSC022
     C           PRTCD     IFNE '*NRF'                                                        CSC022
     C                     MOVEL'CSC022'  DBFILE                                              CSC022
     C                     MOVEL'SCSARDPD'DBKEY                                               CSC022
     C                     Z-ADD15        DBASE                                               CSC022
     C                     EXSR ERORSR                                                        CSC022
     C                     ENDIF                                                              CSC022
      *                                                                                       CSC022
     C************NAMVAR   DEFN           WDSJOB                                       CSC022BUG2368
     C           *NAMVAR   DEFN SCCMTJOB  WDSJOB                                             BUG2368
      *                                                                                       CSC022
     C                     ENDIF                                                              CSC022
     C*
     C*     Access SDRETLPD                                               S01247
     C*                                                                   S01247
     C                     CALL 'AORETLR0'                                S01247
     C                     PARM '*MSG   ' @RTCD                           S01247
     C                     PARM '*FIRST ' @OPTN                           S01247
     C           SDRETL    PARM SDRETL    DSFDY                           S01247
     C           @RTCD     IFNE *BLANKS                                   S01247
     C                     MOVEL'SDRETLPD'DBFILE           ***************S01247
     C                     Z-ADD14        DBASE            * DBERROR 014 *S01247
     C                     SETON                     U7U8LR***************S01247
     C                     EXSR ERORSR                                    S01247
     C                     END                                            S01247
     C*
     C******Move*alpha*parameter*to*numeric*key*field*                    S01184
     C*     Move Alpha parameter to alpha key field                       S01184
     C*                                                                   S01184
     C******************** MOVE PARAM     BATCH   30                      S01184
     C                     MOVE PARAM     BATCH   3                       S01184
     C*
     C*     Setup program name for reporting DB errors
     C*
     C                     MOVE 'RE0880'  DBPGM
     C                     MOVE *BLANKS   DBFILE                          S01117
     C                     MOVE *BLANKS   DBKEY                           S01117
     C*
     C*     Accept run date
     C*
     C************NAMVAR   DEFN           RUNDAT                          S01117
     C***********          IN   RUNDAT                 01                 S01117
     C***********          UNLCKRUNDAT                                    S01117
     C           *NAMVAR   DEFN RUNDAT    RUNDT                           S01117
     C                     IN   RUNDT                  01                 S01117
     C                     UNLCKRUNDT                                     S01117
     C*
     C*     If error occurs on data area access
     C*
     C           *IN01     IFEQ '1'
     C                     Z-ADD09        DBASE            * DB ERROR 09 *
     C                     MOVEL'RUNDT'   DBFILE                          S01117
     C                     MOVEL'*DTAARA' DBFKEY
     C                     EXSR ERORSR
     C                     END
     C/COPY WNCPYSRC,RE0880C014
     C*
     C* *IN98 MUST BE UPDATED IN THIS PROGRAM SO THAT ITS IN ZDATE2       E21704
     C*    SUBROUTINE WILL NOT CAUSE ERROR DURING COMPILATION.            E21704
     C*                                                                   E21704
     C                     SETON                         98               E21704
     C*                                                                   E21704
     C*      Set on multibranch indicator if MBIN = 'Y'                   S01117
     C*                                                                   S01117
     C           MBIN      IFEQ 'Y'                                       S01117
     C                     SETON                         88               S01117
     C                     END                                            S01117
     C*                                                                   S01117
     C*     Load currency details into array
     C*
     C                     EXSR LOADSR
     C*
      ** Access dataarea to get the number of CHAIN-retries and delay wait                   241672A
      *                                                                                      241672A
     C           *NAMVAR   DEFN GLJENDTA  GLHDET                                             241672A
     C                     IN   GLHDET                 23                                    241672A
     C                     UNLCKGLHDET                                                       241672A
      *                                                                                      241672A
     C                     MOVE GH8RTY    X#RTY   50                                         241672A
     C                     MOVE GH8WAT    X#WAIT  60                                         241672A
     C                     Z-ADDX#RTY     W#RTY   50                                         241672A
     C                     MOVE '000000'  W#WAIT  6                                          241672A
     C                     MOVE X#WAIT    W#WAIT                                             241672A
      *                                                                                      241672A
      ** If error occurs on data area access, not found                                      241672A
      ** or not yet initialised                                                              241672A
      *                                                                                      241672A
     C           *IN23     IFEQ '1'                                                          241672A
     C           GH8RTY    OREQ *BLANKS                                                      241672A
     C           GH8WAT    ANDEQ*BLANKS                                                      241672A
     C                     Z-ADD2         W#RTY                                              241672A
     C                     MOVE '000000'  W#WAIT                                             241672A
     C                     MOVE 2         W#WAIT                                             241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
     C                     MOVE 'N'       GLHLCK  1                                          241672A
     C                     Z-ADD*ZEROS    W#RIED  50                                         241672A
     C                     Z-ADD*ZEROS    W#LOOP  50                                         241672A
     C                     MOVE '0'       *IN22                                              241672A
     C                     MOVE '0'       *INU3                                              241672A
      *                                                                                      241672A
     C           *IN22     DOUEQ'0'                                                          241672A
     C           W#RIED    ORGT W#RTY                                                        241672A
     C           W#LOOP    ORGT 200                                                          241672A
      *                                                                                      241672A
     C*     Access batch header
     C*
     C********** BATCH     CHAINGLJENHL0             03                               S01194 241672A
     C           BATCH     CHAINGLJENHL0             0322                                    241672A
     C*
      ** Check if record locked to another job, wait and retry                               241672A
      **   Delay job if needed                                                               241672A
      **   Retry CHAIN after specified times                                                 241672A
      *                                                                                      241672A
     C           *IN22     IFEQ '1'                                                          241672A
     C           GLHST     ANDEQ01218                                                        241672A
     C           W#RIED    ANDLTW#RTY                                                        241672A
     C                     MOVE 'Y'       GLHLCK                                             241672A
      *                                                                                      241672A
     C           W#WAIT    IFNE '000000'                                                     241672A
     C           W#WAIT    ANDNE'      '                                                     241672A
     C                     CALL 'GLDLY2'                                                     241672A
     C                     PARM           W#WAIT                                             241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
      ** Other database error occurred, end program and dump                                 241672A
      *                                                                                      241672A
     C           *IN22     IFEQ '1'                                                          241672A
     C           GLHST     ANDNE01218                                                        241672A
     C                     Z-ADD22        DBASE            * DB ERROR 22 *                   241672A
     C                     MOVEL'GLJENHL0'DBFILE                                             241672A
     C                     MOVELBATCH     DBFKEY                                             241672A
     C                     EXSR ERORSR                                                       241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
     C                     ADD  1         W#RIED                                             241672A
     C                     ADD  1         W#LOOP                                             241672A
     C                     ENDDO                                                             241672A
      *                                                                                      241672A
      ** Terminate program if number of retries has been reached                             241672A
      *                                                                                      241672A
     C           *IN22     IFEQ '1'                                                          241672A
     C           GLHST     ANDEQ01218                                                        241672A
     C                     MOVE '1'       *INU3                                              241672A
     C                     Z-ADD23        DBASE            * DB ERROR 23 *                   241672A
     C                     MOVEL'GLJENHL0'DBFILE                                             241672A
     C                     MOVELBATCH     DBFKEY                                             241672A
     C                     EXSR ERORSR                                                       241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
     C           *IN22     IFEQ '0'                                                          241672A
     C                     MOVE 'N'       GLHLCK                                             241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
     C*     Data base error if batch not found
     C*
     C           *IN03     IFEQ '1'
     C                     Z-ADD10        DBASE            * DB ERROR 10 *
     C                     MOVEL'GLJENHL0'DBFILE                          S01194
     C                     MOVELBATCH     DBFKEY
     C                     EXSR ERORSR
     C                     END
     C*
     C*     Abort program if batch is in use
     C*
     C           BRBIUF    IFEQ 'Y'                                       S01194
     C                     SETON                     U5LR
     C                     RETRN
     C                     END
     C*
     C*     Abort program if batch posting is outstanding
     C*
     C           BRSHPI    IFNE 'Y'                                       S01194
     C                     SETON                     U6LR
     C                     RETRN
     C                     END
     C*
     C*     Abort program if batch has been printed
     C*
     C           BRRAPI    IFEQ 'P'                                       S01194
     C                     MOVE '1'       *INLR
     C                     RETRN
     C                     END
     C*
     C*     Update batch header (to show that it is in use)
     C*
     C                     MOVE BRWSID    XXWSID 10                       044271
     C*********************MOVE '***'     BRWSID                    S01194044271
     C***********          MOVE '**'      BRWSID                                       044271 246518
     C                     MOVEL'REC0880' BRWSID                                              246518
     C                     MOVE 'Y'       BRBIUF                          S01194
     C                     UPDAT@BRREAG                04
     C*
     C*     Data base error if update fails
     C*
     C           *IN04     IFEQ '1'
     C                     Z-ADD11        DBASE            * DB ERROR 11 *
     C                     MOVEL'GLJENHL0'DBFILE                          S01194
     C                     MOVELBATCH     DBFKEY
     C                     EXSR ERORSR
     C                     END
     C*
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCMTSK    ANDEQ'N'                                                           CSC022
     C                     COMIT
     C                     ENDIF                                                              CSC022
     C*
     C*     Access department name
     C*
     C           BRDPCD    CHAINSDDEPTL0             05                   S01194
     C*
     C*     Data base error if chain fails
     C*
     C           *IN05     IFEQ '1'
     C                     Z-ADD12        DBASE            * DB ERROR 12 *
     C                     MOVEL'SDDEPTL0'DBFILE
     C                     MOVELBRDPCD    DBFKEY                          S01194
     C                     EXSR ERORSR
     C                     END
     C*                                                                   CEU013
     C**  Access SAR details file to see if CEU013 is installed.          CEU013
     C*                                                                   CEU013
     C                     CALL 'AOSARDR0'                                CEU013
     C                     PARM '       ' @RTCD   7                       CEU013
     C                     PARM '*VERIFY' @OPTN   7                       CEU013
     C                     PARM 'CEU013'  WSARD   6                       CEU013
     C*                                                                   CEU013
     C           @RTCD     IFEQ *BLANK                                    CEU013
     C                     MOVE 'Y'       CEU013  1                       CEU013
     C                     ELSE                                           CEU013
     C                     MOVE 'N'       CEU013                          CEU013
     C                     ENDIF                                          CEU013
      *                                                                   CFT004
      **  Access SAR details file to see if CFT004 is installed.          CFT004
      *                                                                   CFT004
     C                     CALL 'AOSARDR0'                                CFT004
     C                     PARM *BLANKS   PRTCD   7                       CFT004
     C                     PARM '*VERIFY' POPTN   7                       CFT004
     C                     PARM 'CFT004'  PSARD   6                       CFT004
     C           SCSARD    PARM SCSARD    DSSDY                           CFT004
     C*                                                                   CFT004
     C                     MOVE 'N'       CFT004                          CFT004
     C           PRTCD     IFEQ *BLANKS                                   CFT004
     C                     MOVE 'Y'       CFT004  1                       CFT004
     C                     ENDIF                                          CFT004
     C*                                                                   CEU013
      *                                                                                       CER030
      ** Check if 'CER031' is switched 'ON'                                                   CER030
      *                                                                                       CER030
     C                     MOVE 'N'       CER031  1                                           CER030
     C                     CALL 'AOSARDR0'                                                    CER030
     C                     PARM *BLANKS   PRTCD                                               CER030
     C                     PARM '*VERIFY' POPTN                                               CER030
     C                     PARM 'CER031'  PSARD                                               CER030
     C           SCSARD    PARM SCSARD    DSFDY                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFEQ *BLANKS                                                       CER030
     C                     MOVE 'Y'       CER031                                              CER030
     C                     ELSE                                                               CER030
      *                                                                                       CER030
     C           PRTCD     IFNE '*NRF   '                                                     CER030
     C                     MOVEL'SCSARDPD'DBFILE                                              CER030
     C                     MOVELPSARD     DBKEY                                               CER030
     C                     Z-ADD26        DBASE                                               CER030
     C                     EXSR ERORSR                                                        CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
      ** Check if 'CER030' is switched 'ON'                                                 BUG25001
      *                                                                                     BUG25001
     C                     MOVE 'N'       CER030  1                                         BUG25001
     C                     CALL 'AOSARDR0'                                                  BUG25001
     C                     PARM *BLANKS   PRTCD                                             BUG25001
     C                     PARM '*VERIFY' POPTN                                             BUG25001
     C                     PARM 'CER030'  PSARD                                             BUG25001
     C           SCSARD    PARM SCSARD    DSFDY                                             BUG25001
      *                                                                                     BUG25001
     C           PRTCD     IFEQ *BLANKS                                                     BUG25001
     C                     MOVE 'Y'       CER030                                            BUG25001
     C                     ELSE                                                             BUG25001
      *                                                                                     BUG25001
     C           PRTCD     IFNE '*NRF   '                                                   BUG25001
     C                     MOVEL'SCSARDPD'DBFILE                                            BUG25001
     C                     MOVELPSARD     DBKEY                                             BUG25001
     C                     Z-ADD29        DBASE                                             BUG25001
     C                     EXSR ERORSR                                                      BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                     BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                     BUG25001
     C/COPY WNCPYSRC,RE0880C001
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C*                                                                  *
     C*     LOADSR SR     SUB-ROUTINE                                    *
     C*                                                                  *
     C*     Load currency details into array                             *
     C*                                                                  *
     C********************************************************************
     C*
     C           LOADSR    BEGSR
     C*
     C                     Z-ADD1         X       30
     C           *LOVAL    SETLLSDCURRL0                                  LN0790
     C                     READ SDCURRL0                 02
     C*
     C*     Load and read loop
     C*
     C           *IN02     DOWEQ'0'
     C*
     C                     MOVE A6CYCD    CURY,X                          S01194
     C/COPY WNCPYSRC,RE0880C002
     C                     Z-ADDA6NBDP    DECM,X                          S01194
     C*                                                                   CEU013
     C* Move 'In' currency flag to the array element                      CEU013
     C                     MOVE A6INCY    INCY,X                          CEU013
     C                     ADD  1         X
     C                     READ SDCURRL0                 02
     C*
     C                     END
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C*                                                                  *
     C*     TERMSR SR     SUB-ROUTINE                                    *
     C*                                                                  *
     C*     Program termination                                          *
     C*                                                                  *
     C********************************************************************
     C*
     C           TERMSR    BEGSR
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0880CCP2                                           S01408
     C*                                                                   S01408
     C                     MOVE 'N'       GLHLCK                                             241672A
     C                     Z-ADD*ZEROS    W#RIED                                             241672A
     C                     Z-ADD*ZEROS    W#LOOP                                             241672A
     C                     MOVE '0'       *IN22                                              241672A
     C                     MOVE '0'       *INU3                                              241672A
      *                                                                                      241672A
     C           *IN22     DOUEQ'0'                                                          241672A
     C           W#RIED    ORGT W#RTY                                                        241672A
     C           W#LOOP    ORGT 200                                                          241672A
     C*
     C*     Access batch header and update it as 'not in use'
     C*
     C********** BATCH     CHAINGLJENHL0             03                               S01194 241672A
     C           BATCH     CHAINGLJENHL0             0322                                    241672A
     C*
      ** Check if record locked to another job, wait and retry                               241672A
      **   Delay job if needed                                                               241672A
      **   Retry CHAIN after specified times                                                 241672A
      *                                                                                      241672A
     C           *IN22     IFEQ '1'                                                          241672A
     C           GLHST     ANDEQ01218                                                        241672A
     C           W#RIED    ANDLTW#RTY                                                        241672A
     C                     MOVE 'Y'       GLHLCK                                             241672A
      *                                                                                      241672A
     C           W#WAIT    IFNE '000000'                                                     241672A
     C           W#WAIT    ANDNE'      '                                                     241672A
     C                     CALL 'GLDLY2'                                                     241672A
     C                     PARM           W#WAIT                                             241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
      ** Other database error occurred, end program and dump                                 241672A
      *                                                                                      241672A
     C           *IN22     IFEQ '1'                                                          241672A
     C           GLHST     ANDNE01218                                                        241672A
     C                     Z-ADD24        DBASE            * DB ERROR 24 *                   241672A
     C                     MOVEL'GLJENHL0'DBFILE                                             241672A
     C                     MOVELBATCH     DBFKEY                                             241672A
     C                     EXSR ERORSR                                                       241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
     C                     ADD  1         W#RIED                                             241672A
     C                     ADD  1         W#LOOP                                             241672A
     C                     ENDDO                                                             241672A
      *                                                                                      241672A
      ** Terminate program if number of retries has been reached                             241672A
      *                                                                                      241672A
     C           *IN22     IFEQ '1'                                                          241672A
     C           GLHST     ANDEQ01218                                                        241672A
     C                     MOVE '1'       *INU3                                              241672A
     C                     Z-ADD25        DBASE            * DB ERROR 25 *                   241672A
     C                     MOVEL'GLJENHL0'DBFILE                                             241672A
     C                     MOVELBATCH     DBFKEY                                             241672A
     C                     EXSR ERORSR                                                       241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
     C           *IN22     IFEQ '0'                                                          241672A
     C                     MOVE 'N'       GLHLCK                                             241672A
     C                     ENDIF                                                             241672A
      *                                                                                      241672A
     C*     Data base error if batch not found
     C*
     C           *IN03     IFEQ '1'
     C                     Z-ADD13        DBASE            * DB ERROR 13 *
     C                     MOVEL'GLJENHL0'DBFILE                          S01194
     C                     MOVELBATCH     DBFKEY
     C                     EXSR ERORSR
     C                     END
     C*
     C************         MOVE *BLANKS   BRWSID                    S01194044271
     C                     MOVE XXWSID    BRWSID                          044271
     C************         MOVE 'N'       BRBIUF                    E19860S01194
     C                     MOVE ' '       BRBIUF                    E19860S01194
     C************         MOVE 'Y'       BRSHPI                    S01194092944
     C                     MOVE 'Y'       BRRAPI                          092944
     C*
     C                     UPDAT@BRREAG                04
     C*
     C*     Data base error if update fails
     C*
     C           *IN04     IFEQ '1'
     C                     Z-ADD14        DBASE            * DB ERROR 14 *
     C                     MOVEL'GLJENHL0'DBFILE                          S01194
     C                     MOVELBATCH     DBFKEY
     C                     EXSR ERORSR
     C                     END
     C*
     C***********          WRITEADVICE05               06                 S01117
     C*
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCMTSK    ANDEQ'N'                                                           CSC022
     C                     COMIT
     C                     ENDIF                                                              CSC022
     C*
     C                     MOVE '1'       *INLR
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C*                                                                  *
     C*     ERORSR SR     SUB-ROUTINE                                    *
     C*                                                                  *
     C*     Error routine                                                *
     C*                                                                  *
     C********************************************************************
     C*
     C           ERORSR    BEGSR
     C*
     C           CSC022    IFEQ 'N'                                                           CSC022
     C           CSC022    OREQ 'Y'                                                           CSC022
     C           WCMTSK    ANDEQ'N'                                                           CSC022
     C                     ROLBK
     C                     ELSE                                                               CSC022
     C                     SETON                     U7U8                                     CSC022
     C                     ENDIF                                                              CSC022
     C*                                                                  *
     C*     Indicate on print that termination was abnormal              *
     C*                                                                  *
     C                     MOVE '1'       *IN41
     C                     MOVE DBFKEY    DBKEY                           S01117
     C*                                                                  *
     C                     OPEN RE0880AU                                 *S01117
     C**                                                                  S01117
     C*       ENSURE TOTAL SPOOL FILE RECORDED BY RCF                     S01117
     C**                                                                  S01117
     C                     Z-ADDSFNUMU    ZSNUMU  60                      S01117
     C**                                                                  S01117
     C                     OUT  LDA                                       S01117
     C                     CALL 'ZSFILE'                                  S01117
     C                     PARM           SEQ                             S01117
     C                     PARM *BLANK    SENTY   3                       S01117
     C                     PARM           SFILEU                          S01117
     C                     PARM           ZSNUMU                          S01117
     C                     PARM           ZSERR   1                       S01117
     C           *LOCK     IN   LDA                                       S01117
      *                                                                   S01117
     C           ZSERR     IFEQ 'Y'                                       S01117
      **  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM       S01117
     C                     SETON                     U7U8                 S01117
     C                     RETRN                                          S01117
     C                     END                                            S01117
     C**                                                                  S01117
     C                     WRITEADVICE05               06
     C***********          MOVELDBFILE    DBFIL                           S01117
     C                     DUMP
     C                     SETON                     U7U8LR
     C                     RETRN
     C*
     C                     ENDSR
     C*
      *****************************************************************                       CER030
      /EJECT                                                                                  CER030
      *****************************************************************                       CER030
      *                                                               *                       CER030
      *  EXNARR - Extended Narrative validation                       *                       CER030
      *                                                               *                       CER030
      *  Called by : PRNTSR                                           *                       CER030
      *                                                               *                       CER030
      *  Calls : ERRORSR,SROFCH                                       *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
      *                                                                                       CER030
     C           EXNARR    BEGSR                                                              CER030
      *                                                                                       CER030
     C           KYADIN    KLIST                                                            BUG25001
     C                     KFLD           BTPTDT                                            BUG25001
     C                     KFLD           BTBTNB                                            BUG25001
     C                     KFLD           BTBINB                                            BUG25001
      *                                                                                     BUG25001
     C           KGLNWC    KLIST                                                            BUG25001
     C                     KFLD           PNWRK                                             BUG25001
     C                     KFLD           PBRCA                                             BUG25001
     C                     KFLD           PCUSNO                                            BUG25001
     C                     KFLD           PCCY                                              BUG25001
     C                     KFLD           PACOD                                             BUG25001
     C                     KFLD           PACSQ                                             BUG25001
      *                                                                                     BUG25001
     C                     MOVE 'N'       WMT22   1                                         BUG25001
      *                                                                                     BUG25001
     C********** BATCH     CHAINGLJENXL5             67                              CER030 BUG25001
     C           KYADIN    CHAINGLJENXL1             67                                     BUG25001
     C********** *IN67     IFEQ *ON                                                 CER030 BUG25185A
     C**********           Z-ADD27        DBASE                                     CER030 BUG25185A
     C**********           MOVEL'GLJENXL5'DBFILE                                    CER030 BUG25185A
     C**********           MOVELBATCH     DBFKEY                                    CER030 BUG25185A
     C**********           EXSR ERORSR                                              CER030 BUG25185A
     C**********           ELSE                                                     CER030 BUG25185A
     C           *IN67     IFEQ *ON                                                  CER030 BUG25001
     C           CER030    ANDEQ'Y'                                                         BUG25001
     C           KYADIN    CHAINGLMNARL1             67                                     BUG25001
     C           *IN67     IFEQ *OFF                                                       BUG25185A
      *                                                                                     BUG25001
     C                     MOVE 'Y'       WMT22                                             BUG25001
     C                     MOVELBAEX1     EXT,1                                             BUG25001
     C                     MOVELBAEX2     EXT,2                                             BUG25001
     C                     MOVELBAEX3     EXT,3                                             BUG25001
     C                     MOVELBAEX4     EXT,4                                             BUG25001
     C                     MOVELBAEX5     EXT,5                                             BUG25001
     C                     MOVELBAEX6     EXT,6                                             BUG25001
     C                     MOVELBAEX7     EXT,7                                             BUG25001
     C                     MOVELBAEX8     EXT,8                                             BUG25001
     C                     MOVELBAEX9     EXT,9                                             BUG25001
     C                     MOVELBAEX10    EXT,10                                            BUG25001
     C                     MOVELBAEX11    EXT,11                                            BUG25001
     C                     MOVELBAEX12    EXT,12                                            BUG25001
     C                     MOVELBAEX13    EXT,13                                            BUG25001
     C                     MOVELBAEX14    EXT,14                                            BUG25001
     C                     MOVELBAEX15    EXT,15                                            BUG25001
     C                     MOVELBAEX16    EXT,16                                            BUG25001
     C                     MOVELBAEX17    EXT,17                                            BUG25001
     C                     MOVELBAEX18    EXT,18                                            BUG25001
     C                     MOVELBAEX19    EXT,19                                            BUG25001
     C                     MOVELBAEX20    EXT,20                                            BUG25001
     C                     MOVELBAEX21    EXT,21                                            BUG25001
     C                     MOVELBAEX22    EXT,22                                            BUG25001
     C                     ENDIF                                                            BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                     BUG25001
     C           *IN67     IFEQ *OFF                                                        BUG25001
      *                                                                                       CER030
     C**********           MOVE BTCUST    PCUSNO  60                                  CER030  CER059
     C                     MOVE BTCUST    PCUSNO  6                                           CER059
     C                     MOVE BTCYCD    PCCY    3                                           CER030
     C                     MOVE BTACCD    PACOD                                               CER030
     C                     MOVE BTACSN    PACSQ                                               CER030
     C                     MOVE BTBCBH    PBRCA   3                                           CER030
     C                     MOVEL'PAPER'   PNWRK                                             BUG25001
      *                                                                                     BUG25001
      ** Check first if account is linked to PAPER network                                  BUG25001
      *                                                                                     BUG25001
     C           KGLNWC    CHAINGLNWACL1             67                                     BUG25001
     C           *IN67     IFEQ *ON                                                         BUG25001
     C                     MOVE *BLANKS   PNWRK                                             BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                       CER030
     C           WMT22     IFEQ 'Y'                                                         BUG25001
      *                                                                                     BUG25001
      ** Call the MG001901 access object to format the extended                             BUG25001
      ** narratives                                                                         BUG25001
      *                                                                                     BUG25001
     C                     CALL 'MG001901'                                                  BUG25001
     C                     PARM *BLANKS   PRTCD                                             BUG25001
     C                     PARM '*FORMAT' POPTN                                             BUG25001
     C                     PARM           PNWRK                                             BUG25001
     C                     PARM           PMSGTP                                            BUG25001
     C                     PARM           PBRCA                                             BUG25001
     C                     PARM           PCUSNO                                            BUG25001
     C                     PARM           PCCY                                              BUG25001
     C                     PARM           PACOD                                             BUG25001
     C                     PARM           PACSQ                                             BUG25001
     C                     PARM           PDCIN                                             BUG25001
     C                     PARM           PRTTY                                             BUG25001
     C                     PARM           PPNARR 30                                           BA6026
     C                     PARM           PNATY   1                                           BA6026
     C                     PARM           PDSTN  11                                           BA6026
      *                                                                                     BUG25001
      ** Extended Narratives of length 22 * 35                                              BUG25001
      *                                                                                     BUG25001
     C                     PARM           EXT                                               BUG25001
      *                                                                                     BUG25001
     C                     PARM *BLANKS   PRTFL1                                            BUG25001
     C                     PARM *BLANKS   PRTFL2                                            BUG25001
     C                     PARM *BLANKS   PRTFL3                                            BUG25001
     C                     PARM *BLANKS   PRTFL4                                            BUG25001
     C                     PARM *BLANKS   PRTFL5                                            BUG25001
     C                     PARM *BLANKS   PRTFL6                                            BUG25001
     C                     PARM *BLANKS   PRTFL7                                            BUG25001
     C                     PARM *BLANKS   PRTFL8                                            BUG25001
     C                     PARM *BLANKS   PRTFL9                                            BUG25001
     C                     PARM *BLANKS   PRTF10                                            BUG25001
     C                     PARM *BLANKS   PRTF11                                            BUG25001
     C                     PARM *BLANKS   PRTF12                                            BUG25001
     C                     PARM *BLANKS   PRTF13                                            BUG25001
     C                     PARM *BLANKS   PRTF14                                            BUG25001
     C                     PARM *BLANKS   PRTF15                                            BUG25001
     C                     PARM *BLANKS   PRTF16                                            BUG25001
     C                     PARM *BLANKS   PRTF17                                            BUG25001
     C                     PARM *BLANKS   PRTF18                                            BUG25001
     C                     PARM *BLANKS   PRTF19                                            BUG25001
     C                     PARM *BLANKS   PRTF20                                            BUG25001
     C                     PARM *BLANKS   PRTF21 70                                         BUG25001
     C                     PARM *BLANKS   PRTF22 70                                         BUG25001
     C                     PARM           IDX                                               BUG25001
     C                     PARM           FNMARR                                            BUG25001
     C                     PARM           MIDARR                                            BUG25001
     C                     PARM           MDTARR                                            BUG25001
     C                     PARM           WFLDAR                                            BUG25001
     C                     PARM           WMIDAR                                            BUG25001
     C                     PARM           WMDTAR                                            BUG25001
     C                     PARM           PPNAR2 30                                           BA6026
      *                                                                                     BUG25001
     C           PRTCD     IFNE *BLANKS                                                     BUG25001
     C           PRTCD     ANDNE'*FORMAT'                                                   BUG25001
     C                     Z-ADD27        DBASE            * DB ERROR 27 *                  BUG25001
     C                     MOVEL'MG001901'DBFILE                                            BUG25001
     C                     MOVELEXT,1     DBFKEY                                            BUG25001
     C                     EXSR ERORSR                                                      BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                     BUG25001
     C                     ELSE                                                             BUG25001
      *                                                                                     BUG25001
     C           CER031    IFEQ 'Y'                                                         BUG25001
     C                     CALL 'MG001900'                                                    CER030
     C                     PARM           PRTCD                                               CER030
     C                     PARM '*FORMAT' POPTN                                               CER030
     C                     PARM           PNWRK   6                                           CER030
     C                     PARM           PMSGTP  3                                           CER030
     C                     PARM           PBRCA                                               CER030
     C                     PARM           PCUSNO                                              CER030
     C                     PARM           PCCY                                                CER030
     C                     PARM           PACOD                                               CER030
     C                     PARM           PACSQ                                               CER030
     C                     PARM           PDCIN   1                                           CER030
     C                     PARM           PRTTY   5                                           CER030
     C                     PARM BAADI1    PNARR1 65                                           CER030
     C                     PARM BAADI2    PNARR2 65                                           CER030
     C                     PARM BAADI3    PNARR3 65                                           CER030
     C                     PARM BAADI4    PNARR4 65                                           CER030
     C                     PARM BAADI5    PNARR5 65                                           CER030
     C                     PARM BAADI6    PNARR6 65                                           CER030
      *                                                                                     BUG24780
     C                     PARM *BLANKS   PRTFL1 70                                         BUG24780
     C                     PARM *BLANKS   PRTFL2 70                                         BUG24780
     C                     PARM *BLANKS   PRTFL3 70                                         BUG24780
     C                     PARM *BLANKS   PRTFL4 70                                         BUG24780
     C                     PARM *BLANKS   PRTFL5 70                                         BUG24780
     C                     PARM *BLANKS   PRTFL6 70                                         BUG24780
     C                     PARM *BLANKS   PRTFL7 70                                         BUG24780
     C                     PARM *BLANKS   PRTFL8 70                                         BUG24780
     C                     PARM *BLANKS   PRTFL9 70                                         BUG24780
     C                     PARM *BLANKS   PRTF10 70                                         BUG24780
     C                     PARM *BLANKS   PRTF11 70                                         BUG24780
     C                     PARM *BLANKS   PRTF12 70                                         BUG24780
     C                     PARM *BLANKS   PRTF13 70                                         BUG24780
     C                     PARM *BLANKS   PRTF14 70                                         BUG24780
     C                     PARM *BLANKS   PRTF15 70                                         BUG24780
     C                     PARM *BLANKS   PRTF16 70                                         BUG24780
     C                     PARM *BLANKS   PRTF17 70                                         BUG24780
     C                     PARM *BLANKS   PRTF18 70                                         BUG24780
     C                     PARM *BLANKS   PRTF19 70                                         BUG24780
     C                     PARM *BLANKS   PRTF20 70                                         BUG24780
      ***********                                                                           BUG24780
     C***********          PARM           PRTFL1 70                                  CER030 BUG24780
     C***********          PARM           PRTFL2 70                                  CER030 BUG24780
     C***********          PARM           PRTFL3 70                                  CER030 BUG24780
     C***********          PARM           PRTFL4 70                                  CER030 BUG24780
     C***********          PARM           PRTFL5 70                                  CER030 BUG24780
     C***********          PARM           PRTFL6 70                                  CER030 BUG24780
     C***********          PARM           PRTFL7 70                                  CER030 BUG24780
     C***********          PARM           PRTFL8 70                                  CER030 BUG24780
     C***********          PARM           PRTFL9 70                                  CER030 BUG24780
     C***********          PARM           PRTF10 70                                  CER030 BUG24780
     C***********          PARM           PRTF11 70                                  CER030 BUG24780
     C***********          PARM           PRTF12 70                                  CER030 BUG24780
     C***********          PARM           PRTF13 70                                  CER030 BUG24780
     C***********          PARM           PRTF14 70                                  CER030 BUG24780
     C***********          PARM           PRTF15 70                                  CER030 BUG24780
     C***********          PARM           PRTF16 70                                  CER030 BUG24780
     C***********          PARM           PRTF17 70                                  CER030 BUG24780
     C***********          PARM           PRTF18 70                                  CER030 BUG24780
     C***********          PARM           PRTF19 70                                  CER030 BUG24780
     C***********          PARM           PRTF20 70                                  CER030 BUG24780
     C                     PARM           IDX     30                                          CER030
     C                     PARM           FNMARR                                              CER030
     C                     PARM           MIDARR                                              CER030
     C                     PARM           MDTARR                                              CER030
     C                     PARM           WFLDAR                                              CER030
     C                     PARM           WMIDAR                                              CER030
     C                     PARM           WMDTAR                                              CER030
     C           PRTCD     IFNE *BLANKS                                                     BUG25001
     C           PRTCD     ANDNE'*FORMAT'                                                   BUG25001
     C                     Z-ADD28        DBASE            * DB ERROR 28 *                  BUG25001
     C                     MOVEL'MG001900'DBFILE                                            BUG25001
     C                     MOVELBAADI1    DBFKEY                                            BUG25001
     C                     EXSR ERORSR                                                      BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                     BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                     BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                       CER030
     C                     EXSR SROFCH                                                        CER030
      *                                                                                       CER030
     C           WREM      IFGE OFLLN1                                                        CER030
     C                     WRITEADVICE01               06                                     CER030
      *                                                                                       CER030
      ** Print retail account no if account is retail                                         CER030
      *                                                                                       CER030
     C           BTRACN    IFEQ *ZEROS                                                        CER030
     C                     WRITEADVICE03               06                                     CER030
     C                     ELSE                                                               CER030
     C                     WRITEADVICE02               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL1    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTFL1    EXTNAR                                              CER030
     C                     WRITEP1HEDR                 06                                     CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL2    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTFL2    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL3    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTFL3    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL4    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTFL4    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL5    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTFL5    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL6    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTFL6    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL7    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTFL7    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL8    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTFL8    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL9    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTFL9    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF10    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF10    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF11    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF11    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF12    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF12    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF13    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF13    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF14    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF14    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF15    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF15    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF16    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF16    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF17    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF17    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF18    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF18    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF19    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF19    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF20    IFNE *BLANKS                                                       CER030
     C                     MOVE PRTF20    EXTNAR                                              CER030
     C                     WRITEP1EXTNAR               06                                     CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF21    IFNE *BLANKS                                                     BUG25001
     C           WMT22     ANDEQ'Y'                                                         BUG25001
     C                     MOVE PRTF21    EXTNAR                                            BUG25001
     C                     WRITEP1EXTNAR               06                                   BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                     BUG25001
     C           PRTF22    IFNE *BLANKS                                                     BUG25001
     C           WMT22     ANDEQ'Y'                                                         BUG25001
     C                     MOVE PRTF22    EXTNAR                                            BUG25001
     C                     WRITEP1EXTNAR               06                                   BUG25001
     C                     ENDIF                                                            BUG25001
      *                                                                                     BUG25001
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ENDSR                                                              CER030
      *****************************************************************                       CER030
      /EJECT                                                                                  CER030
      *****************************************************************                       CER030
      *                                                               *                       CER030
      *  SROFCH - Check for Overflow Indicator                        *                       CER030
      *                                                               *                       CER030
      *  Called by : EXNARR                                           *                       CER030
      *                                                               *                       CER030
      *  Calls : None                                                 *                       CER030
      *                                                               *                       CER030
      *****************************************************************                       CER030
      *                                                                                       CER030
     C           SROFCH    BEGSR                                                              CER030
      *                                                                                       CER030
     C                     Z-ADD2         WREM    20                                          CER030
      *                                                                                       CER030
     C           PRTFL1    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL2    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL3    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL4    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL5    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL6    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL7    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL8    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTFL9    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF10    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF11    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF12    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF13    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF14    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF15    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF16    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF17    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF18    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF19    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C           PRTF20    IFNE *BLANKS                                                       CER030
     C                     ADD  1         WREM                                                CER030
     C                     ENDIF                                                              CER030
      *                                                                                       CER030
     C                     ADD  PRTLN1    WREM                                                CER030
      *                                                                                       CER030
     C                     ENDSR                                                              CER030
      *****************************************************************                       CER030
      /EJECT                                                                                  CER030
      *****************************************************************                       CER030
     C/COPY WNCPYSRC,RE0880C003
     C********************************************************************
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
** CPY@   **      OBJECT COPYRIGHT
(c) Finastra International Limited 2001
