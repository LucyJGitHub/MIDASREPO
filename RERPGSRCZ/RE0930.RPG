0001 H        1                                                           S01413
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas Reorganise Standing Orders File')
0001 H***********                                                         S01413
0002 F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module
0004 F*                                                               *
0005 F*  RE0930 - REORGANISE STANDING ORDERS FILE                     *
0006 F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*      1990, 1993                                               *
0008 F*                                                               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *  Last Amend No. CAP187             Date 21Aug09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *  Prev Amend No. CER001             Date 25Apr05               *
      *                 209727             Date 25Sep02               *
     F*                 TDA102             DATE 30MAR04               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 S01408             DATE 06SEP95               *
     F*                 S01408             DATE 19AUG94               *
     F*                 S01466             DATE 22MAR94               *
     F*                 E45574             DATE 23MAR93               *
     F*                 S01413             DATE 13APR93               *
     F*                                                               *
0010 F*****************************************************************
     F*                                                               *
      *  CAP187 - Document Linkage                                    *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  209727 - Copying file STNDOSx into STANDSx in REC90 produce  *
      *           not needed message into replication. Add flag       *
      *           to forbid this msg creation.                        *
     F*  TDA102 - 10-DIGIT A/C CODE BLANKED OUT                       *
     F*  S01408 - Addition of hook RE0930CCP1.                        *
     F*           Addition of hook RE0930IIP1.                        *
     F*           Addition of hook RE0930OOP1.                        *
     F*  S01408 - Addition of hook RE0930FFPG.                        *
     F*           Addition of hook RE0930CCAU.                        *
     F*  S01466 - BLI Retail Enhancements                             *
     F*  E45574 - STANDSB has been changed to 258 - at present TNLU   *
     F*           gets truncated preventing maint as says updated     *
     F*           by another workstation as a result. Also FRIG       *
     F*           program needed to reset TNLU on existing file.      *
     F*  S01413 - Retail 3 Incorporation                              *
     F*           Recompiled dut to changes to files STAND, STNDOSA,  *
     F*           STNDOSB, STNDOSC                                    *
     F*                                                               *
0010 F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
0011 F***STAND***IP**F     256  5AI     2 DISK                            E45574
     F***STAND***IP**F     258  5AI     2 DISK                     E45574 S01466
     F***STAND***IP**F     263  5AI     2 DISK                     S01466 TDA102
     F***STAND   IP  F     284  5AI     2 DISK                                         TDA102 209727
     F***STAND   IP  F     285  5AI     2 DISK                                         209727 CAP187
     FSTAND   IP  F     311  5AI     2 DISK                                                   CAP187
0012 FSTNDOSA O   F     256  5AI     2 DISK                               RE0930
0012 F***STNDOSB*O***F     256  5AI     2 DISK                            E45574
0012 F***STNDOSB*O***F     258  5AI     2 DISK                     E45574 S01466
     F***STNDOSB*O***F     263  5AI     2 DISK                     S01466 TDA102
     F***STNDOSB O   F     284  5AI     2 DISK                                         TDA102 209727
     F***STNDOSB O   F     285  5AI     2 DISK                                         209727 CAP187
     FSTNDOSB O   F     311  5AI     2 DISK                                                   CAP187
     F/COPY WNCPYSRC,RE0930F001
0012 FSTNDOSC O   F     256  5AI     2 DISK                               RE0930
     F*                                                                   S01408
     F** Core hook for externalisation.                                   S01408
     F/COPY WNCPYSRC,RE0930FFPG                                           S01408
     FRESOX1PDIF  E           K        DISK                           UC                      CER001
     FRESOX2PDO   F     256  5AI     1 DISK                           UC                      CER001
     F*                                                                   S01408
     E                    CPY@    1   1 80
0013 ISTAND   NS  01   1 CH                                               RE0930
0014 I*******OR***02***1*CD***************                                E45574
0015 I       OR   03   1 CT                                               RE0930
0016 I                                    P  65  670NSAU                  RE0930
0017 I                                    P  68  750VSUW                  RE0930
0018 I                                    P  76  770VSUD                  RE0930
0019 I                                        1 256 REC                   RE0930
     I        NS  02   1 CD                                               E45574
     I*                                                                   S01408
     I/COPY WNCPYSRC,RE0930IIP1                                           S01408
     I                                        2   60STOR                                      CER001
     I*                                                                   S01408
     I                                        1 255 REC1                  E45574
     I                                      256 258 REC2                  E45574
     I************************************  259 263 REC3           S01466 TDA102
     I**********                            259 284 REC3                               TDA102 CAP187
     I                                      259 310 REC3                                      CAP187
     I**********                            285 285 REPI                               209727 CAP187
     I                                      311 311 REPI                                      CAP187
0020 I        NS  04   1 C*                                               RE0930
0021 I        NS                                                          RE0930
     I/COPY WNCPYSRC,RE0930I001
      *                                                                                       CER001
     ILDA         DS                            256                                           CER001
      *                                                                                       CER001
      ** Local Data Area for Database Error Details                                           CER001
      *                                                                                       CER001
     I                                      134 141 DBFILE                                    CER001
     I                                      142 170 DBKEY                                     CER001
     I                                      171 180 DBPGM                                     CER001
     I                                      181 1830DBASE                                     CER001
      *                                                                                       CER001
     ISCSARD    E DSSCSARDPD                                                                  CER001
      *                                                                                       CER001
      ** Switchable features file                                                             CER001
      *                                                                                       CER001
     IDSFDY     E DSDSFDY                                                                     CER001
      *                                                                                       CER001
      ** First DS for access programs, short data structure                                   CER001
      *                                                                                       CER001
     C                     MOVEACPY@      BIS@   80
0022 C                     Z-ADD0         ZERO5   50                      RE0930
0023 C                     Z-ADD0         ZERO15 150                      RE0930
0024 C                     Z-ADD0         ZERO3   30                      RE0930
     C                     MOVEL'X'       REPI                            209727
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE0930CCAU                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE0930CCP1                                           S01408
     C           ULX043    IFEQ 'Y'                                                           CER001
     C           STOR      CHAINRESOX1PD             88                                       CER001
     C           *IN88     IFEQ '1'                                                           CER001
     C                     CLEARSTANDSDL                                                      CER001
     C                     Z-ADDSTOR      SOSTOR                                              CER001
     C                     ENDIF                                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
      *****************************************************************                       CER001
      *                                                               *                       CER001
      *  *INZSR - Initialisation routine                              *                       CER001
      *                                                               *                       CER001
      *****************************************************************                       CER001
      *                                                                                       CER001
     C           *INZSR    BEGSR                                                              CER001
      *                                                                                       CER001
      ** Access AOSARDR0 and check if ULX043 is installed                                     CER001
      *                                                                                       CER001
     C           *NAMVAR   DEFN           LDA                                                 CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   PRTCD   7                                           CER001
     C                     PARM '*VERIFY' POPTN   7                                           CER001
     C                     PARM 'ULX043'  PSARD   6                                           CER001
     C           SCSARD    PARM SCSARD    DSFDY                                               CER001
      *                                                                                       CER001
     C           PRTCD     IFNE *BLANKS                                                       CER001
     C           PRTCD     ANDNE'*NRF    '                                                    CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     MOVEL'SCSARDPD'DBFILE           ***************                    CER001
     C                     Z-ADD01        DBASE            * DB ERROR 01 *                    CER001
     C                     MOVEL'ULX043'  DBKEY            ***************                    CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR *PSSR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           PRTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVE 'Y'       ULX043  1                                           CER001
     C                     OPEN RESOX2PD                                                      CER001
     C                     SETON                     60                                       CER001
     C                     ELSE                                                               CER001
     C                     MOVE 'N'       ULX043                                              CER001
     C                     ENDIF                                                              CER001
     C                     OPEN RESOX1PD                                                      CER001
      *                                                                                       CER001
     C                     ENDSR                                                              CER001
      *                                                                                       CER001
      *****************************************************************                       CER001
      *                                                               *                       CER001
      *  *PSSR - Program exception error routine                      *                       CER001
      *                                                               *                       CER001
      *****************************************************************                       CER001
      *                                                                                       CER001
     C           *PSSR     BEGSR                                                              CER001
      *                                                                                       CER001
     C           @RUN      IFEQ *BLANK                                                        CER001
     C                     MOVE 'Y'       @RUN    1                                           CER001
     C                     DUMP                                                               CER001
     C                     ENDIF                                                              CER001
     C                     MOVE '1'       *INU7                                               CER001
     C                     MOVE '1'       *INU8                                               CER001
     C                     MOVE '1'       *INLR                                               CER001
      *                                                                                       CER001
     C                     ENDSR                                                              CER001
      *****************************************************************                       CER001
     C*                                                                   S01408
0025 OSTNDOSA D        01                                                 RE0930
0027 O                         REC      256                               RE0930
     O/COPY WNCPYSRC,RE0930O001
0026 OSTNDOSB D        02                                                 RE0930
0027 O*************************REC      256                               E45574
     O                         REC1     255                               E45574
     O                         REC2     258                               E45574
     O*************************REC3     263                        S01466 TDA102
     O**********               REC3     284                                            TDA102 CAP187
     O                         REC3     310                                                   CAP187
     O**********               REPI     285                                            209727 CAP187
     O                         REPI     311                                                   CAP187
     O*                                                                   S01408
     O/COPY WNCPYSRC,RE0930OOP1                                           S01408
     ORESOX2PDD        02 60                                                                  CER001
     O                         SOSTOR     5                                                   CER001
     O                         SODOPC     8                                                   CER001
     O                         SODCOC    10                                                   CER001
     O                         SODIFC    12                                                   CER001
     O                         SODIDE    21                                                   CER001
     O                         SOCOPC    24                                                   CER001
     O                         SOCCOC    26                                                   CER001
     O                         SOCIFC    28                                                   CER001
     O                         SOCIDE    37                                                   CER001
     O*                                                                   S01408
0028 O**   STAND TRAILER                                                  RE0930
0029 OSTNDOSC D        03                                                 RE0930
0030 O                         REC      256                               RE0930
0031 O                         NSAU      15P                              RE0930
0032 O                         VSUW      23P                              RE0930
0033 O                         VSUD      25P                              RE0930
0034 O                         ZERO5     28P                              RE0930
0035 O                         ZERO5     31P                              RE0930
0036 O                         ZERO5     34P                              RE0930
0037 O                         ZERO15    42P                              RE0930
0038 O                         ZERO3     44P                              RE0930
0039 O                         ZERO15    52P                              RE0930
0040 O                         ZERO3     54P                              RE0930
0041 O                         ZERO15    62P                              RE0930
0042 O                         ZERO3     64P                              RE0930
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
