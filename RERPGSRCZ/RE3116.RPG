     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Commissions capitalisation')                  *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module                                        *
     F*                                                               *
     F*  RE3116  -  COMMISSIONS CAPITALISATION                        *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
      *                                                               *
      *  Last Amend No. MD034990           Date 25May16               *
      *  Prev Amend No. MD027749           Date 27Jun14               *
      *                 CRE100             Date 21Mar14               *
      *                 MD021155           Date 16Jul13               *
      *                 CRE083BL           Date 06Aug12               *
      *                 CRE083BD           Date 06Aug12               *
      *                 AR1005194          Date 15Jul12               *
      *                 AR802662           Date 29Jul11               *
      *                 CER049             Date 06Dec10               *
      *                 AR750273B          Date 09Jun11               *
      *                 AR722444           Date 22Feb11               *
      *                 CER059             Date 19Jul10               *
      *                 CER030             Date 09Jul08               *
      *                 CER043             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 BUG14933           Date 02Oct07               *
      *                 BUG12930           Date 04Jan07               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 CRE027             Date 15Mar06               *
      *                 239665             Date 27Apr06               *
      *                 CSD031             Date 10Apr06               *
      *                 B11353             Date 12May06               *
      *                 CSD027             Date 09Dec05               *
      *                 CER001             Date 25Apr05               *
      *                 BUG6812            Date 04Jul04               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 TDA104             Date 02Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 199706             Date 26Seb02               *
      *                 CGL020             Date 12Dec02               *
      * Midas Release 4.01 -------------------------------------------*
      *                 185188             Date 24Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 21Dec99               *
      *                 170507             Date 08Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.01 -----------------------------------------------*
      *                 CGL007             Date 26Mar99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 CSD005             Date 02Mar99               *
      *                 CTI002             Date 09Sep98               *
      *                 149069             DATE 30Nov98               *
     F*                 119348             DATE 18FEB98               *
     F*                 120958             DATE 18FEB98               *
     F*                 122805             Date 17FEB98               *
     F*                 121054             DATE 28JAN98               *
     F*                 105084             DATE 24SEP97               *
     F*                 099081             DATE 01SEP97               *
     F*                 CCB003             DATE 01Nov96               *
     F*                 CAC001             DATE 01FEB96               *
     F*                 095810             DATE 15DEC95               *
     F*                 086117             DATE 06JUN95               *
     F*                 S01408             DATE 11APR95               *
     F*                 086125             DATE 16MAR95               *
     F*                 S01522             DATE 25JAN95               *
     F*                 069563             DATE 15APR94               *
     F*                 S01413 *CREATE     DATE 13APR93               *
     F*                                                               *
     F*****************************************************************
      *                                                               *
      *  MD034990 - Postings not posted against account sequence of   *
      *             the retail account.                               *
      *  MD027749 - Incorrect value date for postings on commission   *
      *             accounts if capitalisation for the retail account *
      *             was delayed.                                      *
      *  CRE100 - Allow Customer Number For Retail Accrual And Charge *
      *           Postings.                                           *
      *  MD021155 - COB Restructure Phase 1 Remnants                  *
      *           - enhance caching of SDBRCH and SDNARR              *
      *  CRE083BL - COB Restructure - RE COB Optimisation Phase 1     *
      *  CRE083BD - COB Restructure - RE COB Optimisation Phase 1     *
      *  AR1005194 - REC3118 00001 failed                             *
      *  AR802662 - Commission on Min. Average Credit Balance is not  *
      *             posted. Error caused by fix 223451 causing RE ICD *
      *             indicators to contain the wrong value. Read 1st   *
      *             rec. of TABLEV4 if BBCGRP=' ' (Child: AR802663)   *
      *  CER049 - Stamp Tax                                           *
      *  AR750273B - Components failed due to closed customer         *
      *              (Child: AR750274)                                *
      *  AR722444 - REC3116 00001 failed (Child:AR722449)             *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  CER030 - Multicash German Feature (Recompile)                *
      *           (Recompile)                                         *
      *  CER043 - German Features LF041-00 New Fields and Defaulting  *
      *           (Recompile)                                         *
      *  BUG14933 - Error in checking switchable feature CSW207       *
      *             (Recompile)                                       *
      *  BUG12930 - Change the length of data area CBTASKSP to 10     *
      *             characters. (Recompile)                           *
      *  CRE027 - Charges for extra statements and fixed commission   *
      *           enhancement.                                        *
      *  239665 - Apply fix 223451.                                   *
      *  223451 - Generate commission only if the indicator in        *
      *           TABLEV4 is equal to 'Y'.                            *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  B11353 - Work fields for account codes incorrectly defined.  *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CER001 - LUX Upgrade to MidasPlus                            *
      *  BUG6812 - Dbase error in COB due to spot trade a/c code      *
      *            array field WTAC still 4-digit long instead of     *
      *            10 digits.                                         *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  TDA104 - Missed account code changes.                        *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  199706 - Value date of Fixed Account commission should be    *
      *           the credit capitalisation date.                     *
      *         - Fixed Account commision should be generated on      *
      *           credit interest capitalisation period based from FS.*
      *  CGL020 - Compliance Watch - Additional A/C Postings          *
      *           Information                                         *
      *  185188 - When Interbranch postings via Main Branch is used,  *
      *           use the main branch for postings 07 and 08.         *
      *  CDE002 - Data Export - CCRM Revenue Analysis.                *
      *  170507 - Ensure that the correct retail account number is    *
      *           shown on the narrative, if alternate accounts are   *
      *           used                                                *
      *  CGL007 - Account Postings Enquiry                            *
      *  CSD005 - Standing Data Account Narrative.  Add new field     *
      *           to SDACODPD.  Recompilation of programs.            *
      *  CTI002 - Recompiled : File SDACODPD changed                  *
     F*  149069 - 'The Account Posting Narrative' development did not *
     F*           add the new fields XRFI and XRFN to the GECOMD 'O'  *
     F*           spec. The result is that blanks were being written  *
     F*           to the numeric XFIN field.                          *
     F*  119348 - Remove suppression of fixed account charge on a/c   *
     F*           closure (as amount is on OSIC enquiry).             *
     F*         - Remove closure conditioning for charge on daily     *
     F*           statement as should be the same in both cases.      *
     F*           (NB: fixes needed for addresses processing).        *
     F*         - Postings should be valued today on closure.         *
     F*  120958 - Commission posting for closure is output in GEICPD  *
     F*           and not in GECOMD. Use VLDOU for excpt too.         *
     F*  122805 - Accounts should be charged for the turnover         *
     F*           statements which were produced before the statement *
     F*           frequency was changed to something else.            *
     F*  121054 - Only post inactive a/c commission if Charge on      *
     F*           Inactive A/c is 'Y'.                                *
     F*  105084 - Incomplete posting description in Daily Journal     *
     F*  099081 - Hard coded narrative overlaps narrative from        *
     F*           SDNARRPD because only one field is used for all     *
     F*           posting records.  This is changed to one field for  *
     F*           each posting because the narratives may differ.     *
     F*  CCB003 - COB Performance Enhancements - Task Split           *
     F*  CAC001 - Profit Centre Accounting Development:               *
     F*           The profit centre of postings with certain account  *
     F*           types should be assigned as follows:                *
     F*           Interbranch Posting - profit centre from PCA ICD    *
     F*           Suspense Posting - primary funding profit centre    *
     F*           Retail or Nostro alternate a/c - profit centre      *
     F*             of the alternate a/c                              *
     F*           No alternate a/c or non-retail or non-nostro -      *
     F*             profit centre of the generating a/c               *
     F*  095810 - Fields which were added to GECOMD for RTS were not  *
     F*           added to the O-specs of this program.  This         *
     F*           resulted in blanks being written to a numeric field,*
     F*           which caused REC3118 to fail in the CoB.            *
     F*  086117 - Add printer overflow processing for RE3116AU        *
     F*  S01408 - Hook RE3116CCPG added.                              *
     F*           Hook RE3116IIP1 added.                              *
     F*           Hook RE3116IIP2 added.                              *
     F*  086125 - Add new parameter to AOPNARR0                       *
     F*  S01522 - Call to AOPNARR0 if switchable feature installed    *
     F*           and UDC present                                     *
     F*  069563 - D/B error on SDACODPD due to accessing the wrong    *
     F*           account code for VAT processing.                    *
     F*  S01413 - Retail 3 Incorporation                              *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F** VAT
     FABSFI101IF  E                    DISK
     F/COPY WNCPYSRC,RE3116F003
     FABSFAC01IF  E                    DISK
     F/COPY WNCPYSRC,RE3116F004
     F** ----------------------------------------------------------
     F*RECAPML*IF**E           K        DISK                              CCB003
     FRECAPML IF  E           K        DISK                                                 CRE083BD
     F**RECOMCPDUF  E           K        DISK                                        CCB003 CRE083BD
     FRECOMCPDUF  E           K        DISK                           UC                    CRE083BD
     F            RECOMCD0                          KRENAMEDRIVEF                           CRE083BD
     FSDBRCHL1IF  E           K        DISK                                                 CRE083BL
     FSDCUSTL0IF  E           K        DISK                                                 CRE083BL
      *                                                                   CCB003
     FRECOM   UF  E           K        DISK
     F                                              KCOMIT                CCB003
     FACCNT   IF  E           K        DISK
     F            ACCNTAAF                          KIGNORE
     F            ACCNTACF                          KIGNORE
     FACNUM   IF  E           K        DISK
     F            ACCNTABF                          KRENAMEACNUMABF
     FSDCURRL1IF  E           K        DISK
     F            @A6REA3                           KRENAMESDCURRD0
     FRECCY   IF  E           K        DISK
     F            RECCYAF                           KIGNORE
     F            RECCYZF                           KIGNORE
     FREACR   IF  E           K        DISK
     F            REACRAF                           KIGNORE
     F            REACRZF                           KIGNORE
     F/COPY WNCPYSRC,RE3116F002
     FTABLEV4 IF  E                    DISK
     FTABTBRE IF  E                    DISK
     FREACNML0IF  E           K        DISK                               CAC001
     F*GEICZZ**UF**E                    DISK                              CCB003
     FRECOMCPAUF  E                    DISK                      A        CCB003
     F                                              KCOMIT                CCB003
     FREHISBL UF  E           K        DISK
     F                                              KCOMIT                CCB003
     F***GEICPD**O   F     279            DISK                            CGL007
     F***GEICPD**O   F     331            DISK                                         CGL007 CGL020
     F***GEICPD* O   F     589            DISK                                         CGL020 CGL029
     F/COPY WNCPYSRC,REH00468
     FGEICPD  O   F     620            DISK                                                   CGL029
     F/COPY WNCPYSRC,REH00469
     F                                              KCOMIT                CCB003
     F*GECOMD*O***F     279            DISK                               095810
     F*GECOMD*O***F**** 316            DISK                         095810149069
     F***GECOMD**O   F     329            DISK                     149069 CGL007
     F***GECOMD* O   F     331            DISK                                         CGL007 CGL020
     F***GECOMD* O   F     589            DISK                                         CGL020 CGL029
     F/COPY WNCPYSRC,REH00470
     FGECOMD  O   F     620            DISK                                                   CGL029
     F/COPY WNCPYSRC,REH00471
     F                                              KCOMIT                CCB003
     F*RE3116AUO***E                    PRINTER                           CCB003
     FRE3116AUO   E                    PRINTER                        UC  CCB003
     F                                              KINFDS SPOOLF         086117
     F/COPY WNCPYSRC,RE3116F001
      *****************************************************************   CCB003
     F/EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*       01      RECAP - HEADER RECORD                           *
     F*       02            - DETAIL RECORD                           *
     F*       03            - TRAILER RECORD                          *
     F*       04      RECOM - DETAIL RECORD                           *
     F*       25      SDALTNL0 ACCESS FILE                            *
     F*       26      REACR ACCESS FILE                               *
     F*       27      RECAP FILE OUT OF BALANCE                       *
     F*       28      ALTERNATE A/C REFERENCED BY RETAIL NO.          *
     F*       29      SUSPENSE POSTINGS REQUIRED                      *
     F*       30      SYSTEM SUPPORTS BASE CCY EQUIVALENT A/C'S       *
     F*       31      MULTIBRANCHING ENVIRONMENT                      *
     F*       32      MULTICOMPANY ENVIRONMENT                        *
     F*       33      DATE OF NEXT WORKING DAY < ACCRUALS PROFIT DATE *
     F*       34      CR CAPITALISATION IS DUE                        *
     F*       35      DR CAPITALISATION IS DUE                        *
     F*       36      NON-MANAGEMENT CR CAPITALISATION                *
     F*       37      NON-MANAGEMENT DR CAPITALISATION                *
     F*       38      FIRST SET OF POSTINGS FOR THIS A/C              *
     F*       39      ALTERNATE A/C EXISTS TO POST INTEREST           *
     F*       40      ALTERNATE A/C CCY DIFFERS FROM ORIGINAL A/C CCY *
     F*                                                               *
     F*       TYPES OF COMMISSIONS                                    *
     F*       41      FIXED COMMISSION                                *
     F*       42      A/C COMMISSION                                  *
     F*       43      COMMISSION ON DR INTEREST                       *
     F*       44      COMMISSION ON HIGHEST DR BALANCE                *
     F*       45      INACTIVE A/C COMMISSION                         *
     F*       46      COMMISSION ON MINIMUM BALANCE                   *
     F*                                                               *
     F*  **  VAT                                                      *
     F*       47      V.A.T                                           *
     F*       48      CHARGE ON NUMBER OF DAILY STATEMENTS            *
     F*                                                               *
     F*       TYPES OF POSTING RECORDS TO BE OUTPUT FOR A PARTICULAR  *
     F*               COMMISSION                                      *
     F*       50      POSTINGS 01A & 02                               *
     F*       51      POSTINGS 01 & 02                                *
     F*       52      POSTINGS 03 & 04                                *
     F*       53      POSTINGS 05 & 06                                *
     F*       54      POSTINGS 07 & 08                                *
     F*       55      POSTINGS 09 & 10                                *
     F*                                                               *
     F*       57      interbranch postings via main branch            *
     F*                                                               *
     F*       60      MULTIPLY/DIVIDE INDICATOR                       *
     F*       60      MULTIPLY/DIVIDE INDICATOR                       *
     F*       61      MULTIPLY/DIVIDE INDICATOR OF BASE CCY           *
     F*       62      SPOT RATE IS ZERO                               *
     F*       63      CUSTOMER GROUP ARRAY HAS AT LEAST ONE ENTRY     *
     F*                                                               *   CAC001
     F*       65      Analytical Accounting module is installed       *   CAC001
     F*       66      Use FX Position Profit Centre                   *   CAC001
     F*                                                               *   CAC001
     F*       70      FAILURE READING FILE                            *
     F*       71      POSTING AMOUNT IS NON-ZERO                      *
     F*       72      POSTING AMOUNT IS +VE                           *
     F*       73      CURRENCY FOUND ON SDCURRPD                      *
     F*       74      RECAP- FILES OUT OF BALANCE                     *
     F*       75      ACCESS REHISBL                                  *
     F*       76      ACCESS RECOMCPD                                 *
     F*       77      ACCESS RECAPML                                  *
     F*     80-87     USED IN CALCULATING CONVERSION FACTOR           *
     F*               (NO OF D. P.'S)                                 *
     F*     90-97     STANDARD SUBROUTINES                            *
     F*       98      Date Format: DDMMYY (off); MMDDYY (on)          *
     F*       99      STANDARD SUBROUTINES                            *
     F*     U7,U8     DATABASE ERROR                                  *
     F*                                                               *
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  CONTROL                                                      *
     F*                                                               *
     F*  A  - START                                                   *
     F*  B  - MAIN                                                    *
     F*  BA - POST        POSTINGS PROCESSING                         *
     F*  C  - END                                                     *
     F*                                                               *
     F*  AA - CYARRY      SET UP ARRAY FOR CURRENCIES SDCURRPD        *
     F*  AB - SETPGM      SET UP 'PROGRAM' POSTING DETAILS            *
     F*  AC - PGFLDS      PROGRAM-DEFINED FIELDS                      *
     F*                                                               *
     F*  BAA - MULTBR     SET UP MULTIBRANCH DETAILS                  *
     F*  BAB - SETCOM     SET UP 'COMMISSION' POSTING DETAILS         *
     F*  BAC - SET01      SET UP POSTING REC 01                       *
     F*  BAD - SET01A     SET UP POSTING REC 01A                      *
     F*  BAE - SET02      SET UP POSTING REC 02                       *
     F*  BAF - SET03      SET UP POSTING REC 03                       *
     F*  BAG - SET04      SET UP POSTING REC 04                       *
     F*  BAH - SET05      SET UP POSTING REC 05                       *
     F*  BAI - SET06      SET UP POSTING REC 06                       *
     F*  BAJ - SET07      SET UP POSTING REC 07                       *
     F*  BAK - SET08      SET UP POSTING REC 08                       *
     F*  BAL - SET09      SET UP POSTING REC 09                       *
     F*  BAM - SET10      SET UP POSTING REC 10                       *
     F*                                                               *
     F*  XA - DBERR       DATA BASE ERROR                             *
     F*                                                               *
     F*  PN - SRPNAR      POSTING NARRATIVE PREPARATION               *   S01522
     F*                                                               *
     F*  ZA - SYSTEM                                                  *
     F*  ZB - GLZADD                                                  *
     F*  ZC - GLZSUM                                                  *
     F*                                                               *
     F*****************************************************************
     E/EJECT
      *****************************************************************   CCB003
     E                    CPY@    1   1 80
     E/COPY WNCPYSRC,RE3116E001
     E**  Copyright insertion
     E*
     E*    ARRAYS FOR INFORMATION FROM CURRENCIES SDCURRPD
     E**********          WCCY      150  3               CURRENCY                           CRE083BL
     E                    WCCY      250  3                                                  CRE083BL
     E**********          WSPT      150 15 8             SPOT RATES                         CRE083BL
     E                    WSPT      250 15 8                                                CRE083BL
     E**********          WTAC      150  4 0             SPOT TRADE A/C EQ                   BUG6812
     E**********          WTAC      150 10 0             SPOT TRADE A/C EQ          BUG6812 CRE083BL
     E                    WTAC      250 10 0                                                CRE083BL
     E**********          WMDI      150  1               MULTIPLY/DIVIDE                    CRE083BL
     E                    WMDI      250  1                                                  CRE083BL
     E                    BRCH      900  3                                                  CRE083BL
     E                    ABIC      900  6                                                  CRE083BL
     E                    ACRN      900 20                                                  CRE083BL
     E                    AACD      300 10                                                  CRE083BL
     E                    ALRU      300 13 0                                                CRE083BL
     E                    ASRT      300 13 0                                                CRE083BL
     E                    CCSC      300  2                                                  CRE083BL
     E                    CTYP      300  1                                                  CRE083BL
     E                    ANAR    1   8  2                                                  CRE083BL
     E                    ANRD        8 30                                                  CRE083BL
     E                    RI1         8  1               Fixed Com.                         AR802662
     E                    RI2         8  1               Db. Interest Com.                  AR802662
     E                    RI3         8  1               Inact. Acc. Com.                   AR802662
     E                    RI4         8  1               Max. DB. Bal. Com                  AR802662
     E                    RI5         8  1               Min. CR. Bal. Com                  AR802662
     E                    RI6         8  1               Acc. Com Bal. Com                  AR802662
     E                    RI7         8  1               Statement Commiss                  AR802662
     E/COPY WNCPYSRC,RE3116E002
     E                    NAR         8 15
     E                    NR30        8 30
     E                    DN07        8  7
     E                    MGID        8  7                                S01522
     E/COPY WNCPYSRC,RE3116E003
     E**********          ICC       150 12                                                  CRE083BL
     E                    ICC       250 12                                                  CRE083BL
     E**********          MN1       150 13 0                                                CRE083BL
     E                    MN1       250 13 0                                                CRE083BL
     E**********          MX1       150 13 0                                                CRE083BL
     E                    MX1       250 13 0                                                CRE083BL
     E**********          FX1       150 10 8                                                CRE083BL
     E                    FX1       250 10 8                                                CRE083BL
     E**********          MN2       150 13 0                                                CRE083BL
     E                    MN2       250 13 0                                                CRE083BL
     E**********          MX2       150 13 0                                                CRE083BL
     E                    MX2       250 13 0                                                CRE083BL
     E**********          RT2       150 10 8                                                CRE083BL
     E                    RT2       250 10 8                                                CRE083BL
     E                    ADR        10  1               Address reference
      *                                                                                       CRE100
      ** System Values Array Definition                                                       CRE100
     E**********          SVAL    1   1 20                                           CRE100 MD034990
     E                    SVAL    1   2 20                                                  MD034990
     E*
      *****************************************************************   CCB003
     I/EJECT
      *****************************************************************   CCB003
     I**
     IRECOMDF     04
     IRECCYDF
     I              KEY                             CCYKEY
     IACCNTABF
     I              CCY                             CCYA
     I              BRCA                            BRCDA
     IACNUMABF
     I              CCY                             CCYA
     I              BRCA                            BRCDA
     IREACNMF                                                             CAC001
     I              PRFC                            PRFCA                 CAC001
     I              CCY                             CCYA                                   AR1005194
     IABSFACF1
     I*                                                                   S01408
     I/COPY WNCPYSRC,RE3116IIP1                                           S01408
     I*                                                                   S01408
     I              BRCA                            DLBR
     I*                                                                   S01408
     I/COPY WNCPYSRC,RE3116IIP2                                           S01408
     I*                                                                   S01408
     ISDCURRD0
     I              A6SPAE                          TACC
     I              A6SPRT                          SPOT
     I              A6NBDP                          CDP
     I              A6MDIN                          MDIN
     I              A6CYCD                          CCY
     I*
     ISDPCAC    E DSSDPCACPD                                              CAC001
     I**  SD Profit Centre Accounting ICD                                 CAC001
     I*                                                                   CAC001
     ISDPRFC    E DSSDPRFCPD                                              CAC001
     I**  Profit Centre Details                                           CAC001
     I*                                                                   CAC001
     ILDA         DS                            256
     I*
     I** Local Data Area
     I*
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I*
     I*    NARRATIVE FOR CERTAIN DATABASE ERRORS
     I*
     I            DS
     I                                        1  24 NARR
     I                                        1   8 NARR1
     I                                        9  16 NARR2
     I                                       17  24 NARR3
     I            DS
     I                                        1  10 CEXC
     I                                        1  108ORATEC
     I            DS
     I                                        1  12 REYKEY
     I                                        9  11 PCCY
     I                                       12  12 CCYCON
     I            DS
     I*       RECAP KEY FIELD DETAILS
     I**********                              2  19 RECKEY                                    CGL029
     I                                        2  25 RECKEY                                    CGL029
     I                                        2   4 CBRCA
     I                                        5  19 RNARR
     I**********                              5  100CCNUM                                     CSD027
     I                                        5  10 CCNUM                                     CSD027
     I                                       11  13 CCCY
     I**********                             14  170CACOD                                     CGL029
     I**********                             18  190CACSQ                                     CGL029
     I                                       14  230CACOD                                     CGL029
     I                                       24  250CACSQ                                     CGL029
     I            DS
     I*       POSTING A/C NUMBER
     I**********                              1  18 COMPAC                                    CGL029
     I                                        1  24 COMPAC                                    CGL029
     I                                        1   3 CPBRC
     I**********                              4   90CPCNM                                     CSD027
     I                                        4   9 CPCNM                                     CSD027
     I                                       10  12 CPCCY
     I**********                             13  160CPACD                                     CGL029
     I**********                             17  180CPACS                                     CGL029
     I                                       13  220CPACD                                     CGL029
     I                                       23  240CPACS                                     CGL029
     I            DS
     I*       ALTERNATE A/C FIELD DETAILS
     I**********                             15  29 DACP                                      CGL029
     I                                       15  35 DACP                                      CGL029
     I                                       25  29 BLK5D
     I                                       15  240ACNOD
     I**********                             15  200DCNUM                                     CSD027
     I                                       15  20 DCNUM                                     CSD027
     I                                       21  23 CCYD
     I**********                             24  270DACOD                                     CGL029
     I**********                             28  290DACSQ                                     CGL029
     I                                       24  330DACOD                                     CGL029
     I                                       34  350DACSQ                                     CGL029
     I*
     I*    CUSTOMER GROUP DATA AREA (8 OCCURENCES)
     I*
     ICGPDTA      DS                          8
     I                                        1   1 WGRP
     I                                        2  71 GRPA                                      TDA104
     I                                        2  110WGRP1                                     TDA104
     I                                       12  210WGRP2                                     TDA104
     I                                       22  310WGRP3                                     TDA104
     I                                       32  410WGRP4                                     TDA104
     I                                       42  510WGRP5                                     TDA104
     I                                       52  610WGRP6                                     TDA104
     I                                       62  710WGRP7                                     TDA104
     I                                       72  72 IN1                                       TDA104
     I**********                              2  29 GRPA                                      TDA104
     I**********                              2   50WGRP1                                     TDA104
     I**********                              6   90WGRP2                                     TDA104
     I**********                             10  130WGRP3                                     TDA104
     I**********                             14  170WGRP4                                     TDA104
     I**********                             18  210WGRP5                                     TDA104
     I**********                             22  250WGRP6                                     TDA104
     I**********                             26  290WGRP7                                     TDA104
     I**********                             30  30 IN1                                       TDA104
     I*
     I*    CLINT FILE - CUSTOMER TYPE
     I*
     I            DS
     I                                        1   1 CUCGRP
     I                                        1   10CTYPNO
     I*
     I            DS
     I                                        1  12 RECCKY
     I                                        2   8 RECKY1
     I                                        9  11 CCYR1
     I                                       12  12 DEE
     I*******   VAT
     I            DS
     I**********                              1  18 NCODC                                     CGL029
     I                                        1  24 NCODC                                     CGL029
     I**********                              1   60CNUM                                      CSD027
     I                                        1   6 CNUM                                      CSD027
     I                                        7   9 CCY
     I**********                             10  130ACOD                                      CGL029
     I**********                             14  150ACSQ                                      CGL029
     I**********                             16  18 BRCA                                      CGL029
     I                                       10  190ACOD                                      CGL029
     I                                       20  210ACSQ                                      CGL029
     I                                       22  24 BRCA                                      CGL029
     I*****  VAT
     I            DS
     I                                        1   7 CEXF
     I                                        1   70NCEXF
     I*
     I** DATA STRUCTURE : MULTILANGUAGE
     I*
     INARKEY      DS
     I                                        1   2 LRECT
     I                                        3   8 ZZ006
     I                                        9  10 LLGID
     I                                       11  12 LNARC
     I*
     I**   Data structure for full account reference
     IDSNARR      DS
     I                                        1   4 DSNAR5
     I                                        5   5 TIR1
     I                                        6  11 DSNAR1
     I                                       12  12 TIR2
     I                                       13  15 DSNAR2
     I                                       16  16 TIR3
     I**********                             17  20 DSNAR3                                    CGL029
     I**********                             21  21 TIR4                                      CGL029
     I**********                             22  23 DSNAR4                                    CGL029
     I                                       17  26 DSNAR3                                    CGL029
     I                                       27  27 TIR4                                      CGL029
     I                                       28  29 DSNAR4                                    CGL029
     I            DS                                                                        CRE083BD
      *                                                                                     CRE083BD
      ** End Record Key Data Structure                                                      CRE083BD
      *                                                                                     CRE083BD
     I                                        1  26 ENDKEY                                  CRE083BD
     I                                        1   2 ELGID                                   CRE083BD
     I                                        3   5 EBRCA                                   CRE083BD
     I                                        6  11 ECNUM                                   CRE083BD
     I                                       12  14 ECCY                                    CRE083BD
     I                                       15  240EACOD                                   CRE083BD
     I                                       25  260EACSQ                                   CRE083BD
     I            DS                                                                        CRE083BD
      *                                                                                     CRE083BD
      ** Next Record Key Data Structure                                                     CRE083BD
      *                                                                                     CRE083BD
     I                                        1  26 NXTKEY                                  CRE083BD
     I                                        1   2 #LGID                                   CRE083BD
     I                                        3   5 #BRCA                                   CRE083BD
     I                                        6  11 #CNUM                                   CRE083BD
     I                                       12  14 #CCY                                    CRE083BD
     I                                       15  240#ACOD                                   CRE083BD
     I                                       25  260#ACSQ                                   CRE083BD
     I            DS                                                                        CRE083BD
      *                                                                                     CRE083BD
      ** Last Record Key Data Structure                                                     CRE083BD
      *                                                                                     CRE083BD
     I                                        1  26 LSTKEY                                  CRE083BD
     I                                        1   2 @LGID                                   CRE083BD
     I                                        3   5 LBRCA                                   CRE083BD
     I                                        6  11 LCNUM                                   CRE083BD
     I                                       12  14 LCCY                                    CRE083BD
     I                                       15  240LACOD                                   CRE083BD
     I                                       25  260LACSQ                                   CRE083BD
     I*
     ISDACOD    E DSSDACODPD
     I              A5ACSC                          ACSC
     I              A5ACTY                          ATYP
     I              QQFNIC                          QQFNI1                                    CGL029
     I              QQFNAA                          QQFNA1                                    CGL029
     I** Account codes details
     I*
     ISDBANK    E DSSDBANKPD
     I              BJURPT                          TITL
     I              BJCYCD                          BCCY
     I              BJDFIN                          DATF
     I              BJDNWD                          DNWD
     I              BJMRDT                          RUNA
     I              BJRDNB                          RUND
     I** Bank details
     I*
     I***SDBRCH    E DSSDBRCHPD                                                             CRE083BL
     ISDBRCH    E DSSDBRCHPD                900                                             CRE083BL
     I              A8BICN                          BICN
     I              A8CMCD                          CMPY
     I              A8DFAC                          ADFAC2
     I              A8DTAC                          ADTAC2
     I** Branch Details
     I*
     ISDGELR    E DSSDGELRPD
     I              BKACCD                          COMS
     I              BKAPDT                          APDA
     I              QQACCD                          QQACC1                                    CGL029
     I** General Ledger Details
     I*
     ISDMMOD    E DSSDMMODPD
     I              BGMBIN                          MBIN
     I** Midas Modules Details
     I*
     ISCSARD    E DSSCSARDPD                                              S01522
     I* SAR file details accessed via access program AOSARDR0             S01522
     I*                                                                   S01522
     ICGPNAR    E DSCGPNARPD                                              S01522
     I* UDC Multi-Language Narrative Data Structure                       S01522
     I*                                                                   S01522
     I##PRM1      DS                                                      086125
      **  Data Structure for Customer and Branch                          086125
      *                                                                   086125
     I                                        1   6 A#CUST                086125
     I                                        7   9 A#BRCA                086125
      *                                                                   086125
     ISDNARR    E DSSDNARRPD
     I              ALNVCD                          NARC
     I              ALDON                           NARD
     I** Narrative Codes Details
     I*
     ISDRETL    E DSSDRETLPD
     I              BMLDAI                          LDAC
     I              BMRANR                          RACN
     I              QQACCD                          QQACC3                                    CGL029
     I** Retail Details
     I*
     ISDTRAD    E DSSDTRADPD
     I              BLSPTA                          SPAC
     I              QQACCD                          QQACC4                                    CGL029
     I** Trading Data Details
     I*
     ISDCUST    E DSSDCUSTPD
     I              QQDFAC                          QQDFA1                                    CGL029
     I** Customer Details
     I*
     ISDCURR    E DSSDCURRPD
     I** Currency Details
     I/COPY WNCPYSRC,RE3116I001
     I*
     IDSFDY     E DSDSFDY
     I* First DS for access programs, short data structure
     I*
     IDSSDY     E DSDSSDY
     I* Second DS for access programs, long data structure
     I*
     ISPOOLF      DS                                                      086117
     I                                       83  92 SPLF                  086117
     I                                    B 123 1240SFNUM                 086117
     I                                    B 367 3680LINEC                 086117
      *                                                                   CCB003
     ICBTASK    E DSCBTASKSP                                              CCB003
      ** Commitment control size                                          CCB003
      *                                                                   CCB003
      *****************************************************************   CCB003
     C/EJECT
     C*****************************************************************
     C**
     C**   C O N T R O L
     C**
     C*****************************************************************
     C*
     C** Copyright Statement
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C           *ENTRY    PLIST                                          CCB003
     C                     PARM           RSTART  1                       CCB003
     C*
     C**  Parameter list for access object 'AOBANKR0'
     C*
     C           #ABANK    PLIST
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*FIRST'  @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C**  Parameter list for access object 'AOMMODR0'
     C*
     C           #AMMOD    PLIST
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*FIRST ' @OPTN
     C           SDMMOD    PARM SDMMOD    DSFDY
     C*
     C**  Parameter list for access object 'AOGELRR0'
     C*
     C           #AGELR    PLIST
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*FIRST ' @OPTN
     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
     C*
     C**  Parameter list for access object 'AOCURRR0'
     C*
     C           #ACURR    PLIST
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY'    @OPTN
     C                     PARM           @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C****Parameter*list*for*access*object*'AOBRCHR0'******************                       CGL029
     C**  Parameter list for access object 'AOBRCHR1'                                         CGL029
     C*
     C           #ABRCH    PLIST
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY'    @OPTN
     C                     PARM           @BRCH   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*
     C**  Parameter list for access object 'AORETLR0'
     C*
     C           #ARETL    PLIST
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*FIRST ' @OPTN
     C           SDRETL    PARM SDRETL    DSFDY
     C*
     C**  Parameter list for access object 'AOTRADR0'
     C*
     C           #ATRAD    PLIST
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*FIRST ' @OPTN
     C           SDTRAD    PARM SDTRAD    DSFDY
     C*
     C**  Parameter list for access object 'AOACODR0'
     C*
     C           #AACOD    PLIST
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C**********           PARM           @KEYC   4                                           CGL029
     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
     C                     PARM           @KEYC  10                                           CGL029
     C           SDACOD    PARM SDACOD    DSSDY                                               CGL029
     C*
     C**  Parameter list for access object 'AOCUSTR0'
     C*
     C           #ACUST    PLIST
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           @CUST  10
     C                     PARM *BLANKS   @KYST   7
     C           SDCUST    PARM SDCUST    DSSDY
     C*
     C**  Parameter list for access object 'AONARRR0'
     C*
     C           #ANARR    PLIST
     C                     PARM *BLANKS   @RTCD
     C                     PARM '*KEY   ' @OPTN
     C                     PARM           @NVCD   2
     C           SDNARR    PARM SDNARR    DSFDY
     C*
     C           KCCT      KLIST
     C                     KFLD           CNUM
     C                     KFLD           CCY
     C                     KFLD           ACOD
     C                     KFLD           ACSQ
     C                     KFLD           DLBR
     C*
     C*
     C           COMKEY    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C*
     C           COMKY2    KLIST
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           CBRCA
     C*
     C           REAKEY    KLIST
     C                     KFLD           CUST
     C                     KFLD           ACCY
     C                     KFLD           ACOD
     C                     KFLD           ASEQ
     C                     KFLD           BRCA
     C*
     C           ACCKEY    KLIST
     C                     KFLD           DCNUM
     C                     KFLD           CCYD
     C                     KFLD           DACOD
     C                     KFLD           DACSQ
     C                     KFLD           DRBR
     C*
     C***********RECAP     KLIST                                          CCB003
     C***********          KFLD           LGID                            CCB003
     C***********          KFLD           BRCA                            CCB003
     C***********          KFLD           CNUM                            CCB003
     C***********          KFLD           CCY                             CCB003
     C***********          KFLD           ACOD                            CCB003
     C***********          KFLD           ACSQ                            CCB003
      *                                                                                     CRE083BD
     C           RECAP     KLIST                                                            CRE083BD
     C                     KFLD           LGID                                              CRE083BD
     C                     KFLD           CBRCA                                             CRE083BD
     C                     KFLD           CCNUM                                             CRE083BD
     C                     KFLD           CCCY                                              CRE083BD
     C                     KFLD           CACOD                                             CRE083BD
     C                     KFLD           CACSQ                                             CRE083BD
     C*
     C           ALTKEY    KLIST
     C                     KFLD           BRCAO
     C                     KFLD           CNUMO
     C                     KFLD           CCYO
     C                     KFLD           ACDO
     C                     KFLD           ACSQO
     C/COPY WNCPYSRC,RE3116C006
     C*
     C           *LIKE     DEFN APDA      CTLDAT
     C           *LIKE     DEFN CCNUM     CLCNUM
     C           *LIKE     DEFN CDRR      RATE
     C           *LIKE     DEFN HISB      WWCNDS
     C           *LIKE     DEFN DACO      ALTNAD
     C                     MOVEL*BLANKS   MCOI    1
      *                                                                                     CRE083BD
     C           RUNONE    IFEQ ' '                                                         CRE083BD
     C                     MOVE 'Y'       RUNONE  1                                         CRE083BD
     C                     EXSR START
     C                     ENDIF                                                            CRE083BD
      *                                                                                     CRE083BD
     C                     Z-ADD1         #COMIT 100                                        CRE083BD
      *                                                                                     CRE083BD
     C                     OPEN RE3116AU                                                    CRE083BD
     C                     WRITEHEADAU                                                      CRE083BD
      *                                                                                     CRE083BD
     C                     MOVE 'Y'       @HEAD   1                                         CRE083BD
     C                     MOVE 'N'       @MISS   1                                         CRE083BD
     C                     Z-ADD0         NORECI  50                                        CRE083BD
      *                                                                                     CRE083BD
     C                     OPEN RECOMCPD                                                    CRE083BD
      *                                                                                     CRE083BD
      ** Read END key from RECOMCPD                                                         CRE083BD
      *                                                                                     CRE083BD
     C                     MOVE 'Z'       DRVKEY  1                                         CRE083BD
     C           DRVKEY    CHAINRECOMCPD             76                                     CRE083BD
     C           *IN76     IFEQ '0'                                                         CRE083BD
     C                     MOVE LGID      ELGID                                             CRE083BD
     C                     MOVE BRCA      EBRCA                                             CRE083BD
     C                     MOVE CNUM      ECNUM                                             CRE083BD
     C                     MOVE CCY       ECCY                                              CRE083BD
     C                     MOVE ACOD      EACOD                                             CRE083BD
     C                     MOVE ACSQ      EACSQ                                             CRE083BD
     C                     END                                                              CRE083BD
      *                                                                                     CRE083BD
      ** Read START key from RECOMCPD                                                       CRE083BD
      *                                                                                     CRE083BD
     C           *IN76     IFEQ '0'                                                         CRE083BD
     C                     MOVE 'A'       DRVKEY                                            CRE083BD
     C           DRVKEY    CHAINRECOMCPD             76                                     CRE083BD
     C                     END                                                              CRE083BD
      *                                                                                     CRE083BD
      ** Set pointer to the first record.                                                   CRE083BD
      *                                                                                     CRE083BD
     C                     MOVE LGID      #LGID                                             CRE083BD
     C                     MOVE BRCA      #BRCA                                             CRE083BD
     C                     MOVE CNUM      #CNUM                                             CRE083BD
     C                     MOVE CCY       #CCY                                              CRE083BD
     C                     MOVE ACOD      #ACOD                                             CRE083BD
     C                     MOVE ACSQ      #ACSQ                                             CRE083BD
     C                     MOVE '0'       *IN77                                             CRE083BD
      *                                                                                     CRE083BD
     C           NXTKEY    IFGT ENDKEY                                                      CRE083BD
     C           NXTKEY    OREQ ENDKEY                                                      CRE083BD
     C           PROT      ANDEQ'C'                                                         CRE083BD
     C                     MOVE '1'       *IN77                                             CRE083BD
     C                     END                                                              CRE083BD
      *                                                                                     CRE083BD
     C           *IN77     IFEQ '0'                                                         CRE083BD
      *                                                                                     CRE083BD
     C                     MOVE BRCA      CBRCA                                             CRE083BD
     C                     MOVE CNUM      CCNUM                                             CRE083BD
     C                     MOVE CCY       CCCY                                              CRE083BD
     C                     MOVE ACOD      CACOD                                             CRE083BD
     C                     MOVE ACSQ      CACSQ                                             CRE083BD
      *                                                                                     CRE083BD
     C           PROT      IFEQ ' '                                                         CRE083BD
     C           RECAP     SETLLRECAPML                                                     CRE083BD
     C                     ELSE                                                             CRE083BD
     C           RECAP     SETGTRECAPML                                                     CRE083BD
     C                     END                                                              CRE083BD
      *                                                                                     CRE083BD
     C                     READ RECAPMF                  77                                 CRE083BD
     C                     ENDIF                                                            CRE083BD
     C/COPY WNCPYSRC,RE3116C060
     C*
     C********** *INLR     DOWEQ'0'                        B001                             CRE083BD
     C           *IN77     DOWEQ'0'                        B001                             CRE083BD
     C                     EXSR MAIN
     C                     END                             E001
     C*
      ** The trailer record updates must now be included in the same      CCB003
      ** Commitment cycle as the detail processing rather than when       CCB003
      ** all the detail records have been processed. This means that      CCB003
      ** if the program crashes the trailer record will correctly         CCB003
      ** reflect the processing that has occurred.                        CCB003
      *                                                                   CCB003
     C***********          EXSR END                                       CCB003
     C                     CLOSERE3116AU                                  CCB003
     C/COPY WNCPYSRC,RE3116C061
      *                                                                   CCB003
     C                     UNLCKRECOM                                                       CRE083BD
     C                     UNLCKRECOMCPA                                                    CRE083BD
     C                     UNLCKREHISBL                                                     CRE083BD
     C                     CLOSERECOMCPD                                                    CRE083BD
     C*
     C**********           SETON                     LR                                     CRE083BD
     C                     RETRN                                                            CRE083BD
     C*
     C*****************************************************************
     C/EJECT
      *****************************************************************                     CRE083BL
      *                                                               *                     CRE083BL
      *  ACCHKA - Checks array if it has the records needed           *                     CRE083BL
      *                                                               *                     CRE083BL
      *****************************************************************                     CRE083BL
     C           ACCHKA    BEGSR                                                            CRE083BL
     C                     MOVE *IN78     #IN78   1                                         CRE083BL
     C                     ADD  1         ACLC    40                                        CRE083BL
      *                                                                                     CRE083BL
     C                     MOVEL*BLANK    FOIC    1                                         CRE083BL
      *                                                                                     CRE083BL
      ** Restore saved value of B index                                                     CRE083BL
      *                                                                                     CRE083BL
     C                     Z-ADDASAVE     B                                                 CRE083BL
      *                                                                                     CRE083BL
      ** Defend against B == 0                                                              CRE083BL
      *                                                                                     CRE083BL
     C           B         IFEQ 0                                                           CRE083BL
     C                     Z-ADD1         B                                                 CRE083BL
     C                     ENDIF                                                            CRE083BL
      *                                                                                     CRE083BL
      ** Is this the same as the last LOKUP? if so, we can bypass LOKUP                     CRE083BL
      *                                                                                     CRE083BL
     C           AKEY      IFEQ AACD,B                                                      CRE083BL
     C                     SETON                     78                                     CRE083BL
     C                     ELSE                                                             CRE083BL
      *                                                                                     CRE083BL
      ** Start from 1 if array is full, if not start from last saved.                       CRE083BL
      *                                                                                     CRE083BL
     C           AINDX     IFEQ 0                                                           CRE083BL
     C                     Z-ADD1         B                                                 CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     Z-ADDAINDX     B                                                 CRE083BL
     C                     ENDIF                                                            CRE083BL
      *                                                                                     CRE083BL
     C           AKEY      LOKUPAACD,B                   78                                 CRE083BL
     C                     ENDIF                                                            CRE083BL
      *                                                                                     CRE083BL
     C           *IN78     IFEQ *ON                                                         CRE083BL
     C                     MOVE ACLC      ALRU,B                                            CRE083BL
      *                                                                                     CRE083BL
      ** Save the last update to A                                                          CRE083BL
      *                                                                                     CRE083BL
     C                     Z-ADDB         ASAVE                                             CRE083BL
      *                                                                                     CRE083BL
      ** Turn on indicator so that program will know it is in the array                     CRE083BL
      *                                                                                     CRE083BL
     C                     MOVEL'Y'       FOIC                                              CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     MOVE #IN78     *IN78                                             CRE083BL
     C                     ENDSR                                                            CRE083BL
      *****************************************************************                     CRE083BL
      /EJECT                                                                                CRE083BL
      *****************************************************************                     CRE083BL
      *                                                               *                     CRE083BL
      *  ACADDA - Checks where to store the records on the array      *                     CRE083BL
      *                                                               *                     CRE083BL
      *****************************************************************                     CRE083BL
     C           ACADDA    BEGSR                                                            CRE083BL
     C                     MOVE *IN78     #IN78   1                                         CRE083BL
      *                                                                                     CRE083BL
      ** Check of there is still available slot in the array.                               CRE083BL
      *                                                                                     CRE083BL
     C           AINDX     IFNE 0                                                           CRE083BL
     C                     Z-ADDAINDX     B                                                 CRE083BL
     C                     MOVE AKEY      AACD,B                                            CRE083BL
     C                     MOVE ACSC      CCSC,B                                            CRE083BL
     C                     MOVE ATYP      CTYP,B                                            CRE083BL
      *                                                                                     CRE083BL
     C                     MOVE ACLC      ALRU,B                                            CRE083BL
      *                                                                                     CRE083BL
     C                     SUB  1         AINDX                                             CRE083BL
      *                                                                                     CRE083BL
      ** Else replace the LRU                                                               CRE083BL
      *                                                                                     CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     Z-ADD1         B                                                 CRE083BL
     C                     MOVEAALRU      ASRT                                              CRE083BL
     C                     SORTAASRT                                                        CRE083BL
     C                     Z-ADDASRT,1    ALEAST                                            CRE083BL
     C           ALEAST    LOKUPALRU,B                   78                                 CRE083BL
      *                                                                                     CRE083BL
     C                     MOVE AKEY      AACD,B                                            CRE083BL
     C                     MOVE ACSC      CCSC,B                                            CRE083BL
     C                     MOVE ATYP      CTYP,B                                            CRE083BL
      *                                                                                     CRE083BL
     C                     MOVE ACLC      ALRU,B                                            CRE083BL
      *                                                                                     CRE083BL
     C                     ENDIF                                                            CRE083BL
      *                                                                                     CRE083BL
      ** Update ASAVE so next call to ACCHKA checks this newly added                        CRE083BL
      ** element                                                                            CRE083BL
      *                                                                                     CRE083BL
     C                     Z-ADDB         ASAVE                                             CRE083BL
     C                     MOVE #IN78     *IN78                                             CRE083BL
     C                     ENDSR                                                            CRE083BL
      *****************************************************************                     CRE083BL
      /EJECT                                                                                CRE083BL
     C*****************************************************************
     C**
     C**   S T A R T
     C**
     C*****************************************************************
     C           START     BEGSR                           *** START ***
     C*
     C** Access LDA.
     C*
     C           *NAMVAR   DEFN           LDA
     C/COPY WNCPYSRC,RE3116C007
      *                                                                   CCB003
      ** Access data area CBTASKSP for commit block size                  CCB003
     C           *NAMVAR   DEFN CBTASKSP  CBTASK                          CCB003
     C                     IN   CBTASK                                    CCB003
     C**********           MOVE CMTBLK    #OPTIM  60                                 CCB003 CRE083BD
     C                     MOVE CMTBLK    #OPTIM 100                                        CRE083BD
      *                                                                   CCB003
      ** Set commit counter to 1                                          CCB003
     C**********           Z-ADD1         #COMIT  60                                 CCB003 CRE083BD
     C                     Z-ADD0         AINDX   40                                        CRE083BL
     C           *LIKE     DEFN AINDX     B                                                 CRE083BL
     C           *LIKE     DEFN AINDX     ASAVE                                             CRE083BL
     C                     MOVE *BLANKS   AKEY   10                                         CRE083BL
     C                     Z-ADD300       AINDX                                             CRE083BL
     C                     Z-ADD0         ALEAST 130                                        CRE083BL
      *                                                                   CCB003
     C**
     C** READ INITIAL RECORD
     C**
     C           1         SETLLTABTBRE
     C                     READ TABTBRE                  70
     C           *IN70     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'TABTBRE' DBFILE           ************
     C                     MOVEL'       1'DBKEY            * DBERR 34 *
     C                     Z-ADD34        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
      *                                                                                     CRE083BL
      ** Cache the narrative codes                                                          CRE083BL
      *                                                                                     CRE083BL
     C                     Z-ADD1         C       20                                        CRE083BL
     C           C         DOWLE8                                                           CRE083BL
     C                     MOVE ANAR,C    @NVCD                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR                                            CRE083BL
      *                                                                                     CRE083BL
     C           @RTCD     IFEQ *BLANKS                                                     CRE083BL
     C                     MOVELNARD      ANRD,C                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVE *BLANKS   ANRD,C                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ADD  1         C                                                 CRE083BL
     C                     ENDDO                                                            CRE083BL
     C**
     C**   SET UP PROGRAM-DEFINED FIELDS (USING *LIKE)
     C**
     C                     EXSR PGFLDS
     C**
     C**   SET UP INFO FOR PROGRAM LEVEL PROCESSING
     C**
     C                     BITOF'01234567'BITOFF  1
     C                     MOVE ' '       BLK5    5
     C                     MOVE ' '       BLK200200
     C                     MOVE ' '       BLK15  15
     C                     MOVE 'D'       DEE
     C           VATP      IFEQ 'Y'
     C** -------------------------------------------------------------
     C**     VAT
     C** -------------------------------------------------------------
     C**   ACCESS ABSFI101  RECUP DE :
     C**          XTVA           5  4       TEXT('TAUX TVA      ')
     C**          BQCTVA         1          TEXT('TVA BANQUE O=OUI N=NON')
     C**
     C           1         CHAINABSFI1F1             99
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'ABSFI101'DBFILE           ************
     C                     MOVEL'       1'DBKEY            * DBERR 31 *
     C                     Z-ADD31        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C*
     C**   ACCESS ABSFAC01  RECUP DE :
     C**          ACOD    POUR VAT
     C**
     C/COPY WNCPYSRC,RE3116C062
     C           1         CHAINABSFACF1             99    ERROR ACCES
     C/COPY WNCPYSRC,RE3116C063
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'ABSFAC01'DBFILE           ************
     C                     MOVEL'1'       DBKEY            * DBERR 32 *
     C                     Z-ADD32        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3116CCPG                                           S01408
     C*                                                                   S01408
     C*
     C***********          MOVE NC15      NCODC                           069563
     C                     MOVELNC15      NCODC                           069563
     C***********KCCT      SETLLACCNTABF                 99ERROR CPTE     069563
     C************IN99     IFEQ '1'                                       069563
     C************LOCK     IN   LDA                                       069563
     C***********          MOVEL'RE3116'  DBPGM                           069563
     C***********          MOVEL'ACCNT   'DBFILE           ************   069563
     C***********          MOVELNCODC     DBKEY            * DBERR 33 *   069563
     C***********          Z-ADD33        DBASE            ************   069563
     C***********          OUT  LDA                                       069563
     C***********          EXSR DBERR                                     069563
     C***********          END                                            069563
     C**
     C**********           Z-ADDACOD      WACTVA  40                                          CGL029
     C                     Z-ADDACOD      WACTVA 100                                          CGL029
     C**
     C                     END
     C*
     C** Access Bank Details
     C*
     C                     CALL 'AOBANKR0'#ABANK
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDBANKPD'DBFILE           ************
     C                     MOVEL'FIRST'   DBKEY            * DBERR 01 *
     C                     Z-ADD1         DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C*
     C** Check System Date Format, DDMMYY or MMDDYY.
     C*
     C           DATF      IFEQ 'M'
     C                     MOVE '1'       *IN98
     C                     ELSE
     C                     MOVE '0'       *IN98
     C                     ENDIF
     C*
     C**********           OPEN RE3116AU                                             CCB003 CRE083BD
     C**********           WRITEHEADAU                                                      CRE083BD
     C**********           MOVE 'Y'       @HEAD   1                                         CRE083BD
     C**********           MOVE 'N'       @MISS   1                                         CRE083BD
     C           MCOI      COMP 'Y'                      32
     C**
     C**********           Z-ADD0         NORECI  50                                        CRE083BD
     C*
     C** Access Module Details
     C*
     C                     CALL 'AOMMODR0'#AMMOD
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDMMODPD'DBFILE           ************
     C                     MOVEL'FIRST'   DBKEY            * DBERR 03 *
     C                     Z-ADD3         DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
      *                                                                   CAC001
      **  Retrieve Profit Centre Accounting ICD if Analytical             CAC001
      **  Accounting module is installed                                  CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '1'       *IN65                           CAC001
      *                                                                   CAC001
     C                     CALL 'AOPCACR0'                                CAC001
     C                     PARM *BLANKS   @RTCD                           CAC001
     C                     PARM '*FIRST ' @OPTN                           CAC001
     C           SDPCAC    PARM SDPCAC    DSFDY                           CAC001
      *                                                                   CAC001
      **   Database error if not found                                    CAC001
      *                                                                   CAC001
     C           @RTCD     IFNE *BLANKS                                   CAC001
     C           *LOCK     IN   LDA                                       CAC001
     C                     MOVEL'RE3116'  DBPGM            ************   CAC001
     C                     MOVEL'SDPCACPD'DBFILE           * DBERR 15 *   CAC001
     C                     Z-ADD15        DBASE            ************   CAC001
     C                     MOVEL@OPTN     DBKEY                           CAC001
     C                     OUT  LDA                                       CAC001
     C                     EXSR DBERR                                     CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ELSE                                           CAC001
     C                     MOVE '0'       *IN65                           CAC001
     C                     ENDIF                                          CAC001
     C*                                                                   S01522
     C/COPY WNCPYSRC,RE3116C049
     C* Call SAR prog. for switchable feature                             S01522
     C                     MOVE 'N'       REPNAR  1                       S01522
     C           BGN1ST    IFEQ 'Y'                        B1             S01522
     C/COPY WNCPYSRC,REH00401
     C*                                                                   S01522
     C                     CALL 'AOSARDR0'                  1             S01522
     C                     PARM '       ' @RTCD             1             S01522
     C                     PARM '*VERIFY' @OPTN             1             S01522
     C                     PARM 'REPNAR'  @SARD   6         1             S01522
     C           SCSARD    PARM SCSARD    DSFDY             1             S01522
     C*                                                                   S01522
     C           @RTCD     IFNE *BLANK                     B2             S01522
     C           @RTCD     ANDNE'*NRF   '                   2             S01522
     C           *LOCK     IN   LDA                         2             S01522
     C                     MOVEL'RE3116'  DBPGM             2             S01522
     C                     MOVEL'SCSARDPD'DBFILE            ************* S01522
     C                     Z-ADD87        DBASE             *DBERROR 87 * S01522
     C                     MOVEL@SARD     DBKEY             ************* S01522
     C                     OUT  LDA                         2             S01522
     C                     EXSR DBERR                       2             S01522
     C                     ENDIF                           E2             S01522
     C*                                                                   S01522
     C           @RTCD     IFEQ *BLANK                     B2             S01522
     C                     MOVE 'Y'       REPNAR            2             S01522
     C                     ENDIF                           E2             S01522
     C                     ENDIF                           E1             S01522
      *                                                                                       CGL020
     C                     MOVE 'N'       CGL020  1                                           CGL020
     C                     CALL 'AOSARDR0'                                                    CGL020
     C                     PARM '       ' @RTCD                                               CGL020
     C                     PARM '*VERIFY' @OPTN                                               CGL020
     C                     PARM 'CGL020'  @SARD                                               CGL020
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL020
      *                                                                                       CGL020
     C           @RTCD     IFNE *BLANK                                                        CGL020
     C           @RTCD     ANDNE'*NRF   '                                                     CGL020
     C           *LOCK     IN   LDA                                                           CGL020
     C                     MOVEL'RE3116'  DBPGM                                               CGL020
     C                     MOVEL'SCSARDPD'DBFILE                                              CGL020
     C                     Z-ADD91        DBASE                                               CGL020
     C                     MOVEL@SARD     DBKEY                                               CGL020
     C                     OUT  LDA                                                           CGL020
     C                     EXSR DBERR                                                         CGL020
     C                     ENDIF                                                              CGL020
      *                                                                                       CGL020
     C           @RTCD     IFEQ *BLANK                                                        CGL020
     C                     MOVE 'Y'       CGL020                                              CGL020
     C                     ENDIF                                                              CGL020
      *                                                                                       CER001
      ** Check if the feature ULX043 is on                                                    CER001
      *                                                                                       CER001
     C                     MOVEL'N'       ULX043  1                                           CER001
     C                     CALL 'AOSARDR0'                                                    CER001
     C                     PARM *BLANKS   @RTCD                                               CER001
     C                     PARM '*VERIFY' @OPTN                                               CER001
     C                     PARM 'ULX043'  @SARD                                               CER001
      *                                                                                       CER001
     C           @RTCD     IFNE *BLANK                                                        CER001
     C           @RTCD     ANDNE'*NRF   '                                                     CER001
     C           *LOCK     IN   LDA                                                           CER001
     C                     MOVEL'RE3116'  DBPGM                                               CER001
     C                     MOVEL'SCSARDPD'DBFILE            *************                     CER001
     C                     Z-ADD103       DBASE             *DBERROR 103*                     CER001
     C                     MOVEL@SARD     DBKEY             *************                     CER001
     C                     OUT  LDA                                                           CER001
     C                     EXSR DBERR                                                         CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CER001
     C           @RTCD     IFEQ *BLANKS                                                       CER001
     C                     MOVEL'Y'       ULX043                                              CER001
     C                     ENDIF                                                              CER001
      *                                                                                       CGL020
     C/COPY WNCPYSRC,RE3116C001
     C*
     C**  Access General Ledger Details
     C*
     C**********           CALL 'AOGELRR0'#AGELR                                              CGL029
     C                     CALL 'AOGELRR1'#AGELR                                              CGL029
     C/COPY WNCPYSRC,RE3116C084
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDGELRPD'DBFILE           ************
     C                     MOVEL'FIRST'   DBKEY            * DBERR 08 *
     C                     Z-ADD8         DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
      *                                                                                     CRE083BL
      ** Full cache of SDBRCHPD                                                             CRE083BL
      *                                                                                     CRE083BL
     C                     Z-ADD900       A       40                                        CRE083BL
     C           *LOVAL    SETLLSDBRCHL1                                                    CRE083BL
     C           A         OCUR SDBRCH                                                      CRE083BL
     C                     READ SDBRCHL1                 70                                 CRE083BL
     C                     MOVE A8BRCD    BRCH,A                                            CRE083BL
      *                                                                                     CRE083BL
      ** Cache Details of Branch                                                            CRE083BL
      *                                                                                     CRE083BL
     C           *IN70     DOWEQ'0'                                                         CRE083BL
     C           A         ANDGT2                                                           MD021155
      *                                                                                     MD021155
     C           REPNAR    IFEQ 'Y'                                                         CRE083BL
     C                     MOVE A8BICN    ABIC,A                                            CRE083BL
     C           A8BICN    CHAINSDCUSTL0             70                                     CRE083BL
     C           *IN70     IFEQ '0'                                                         CRE083BL
     C                     MOVE BBCRNM    ACRN,A                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     MOVE A8BICN    BICN                                              CRE083BL
     C                     MOVE A8CMCD    CMPY                                              CRE083BL
     C                     MOVE A8DFAC    ADFAC2                                            CRE083BL
     C                     MOVE A8DTAC    ADTAC2                                            CRE083BL
     C                     SUB  1         A                                                 CRE083BL
     C           A         OCUR SDBRCH                                                      CRE083BL
     C                     READ SDBRCHL1                 70                                 CRE083BL
     C                     MOVE A8BRCD    BRCH,A                                            CRE083BL
     C                     ENDDO                                                            CRE083BL
      *                                                                                     MD021155
      ** If total number of records is less than array size.                                MD021155
      *                                                                                     MD021155
     C           *IN70     IFEQ *ON                                                         MD021155
     C           A         ANDLT900                                                         MD021155
     C                     ADD  1         A                                                 MD021155
     C                     ENDIF                                                            MD021155
      *                                                                                     MD021155
      ** If total number of records is equal to array size.                                 MD021155
      *                                                                                     MD021155
     C           A         IFEQ 2                                                           MD021155
     C           REPNAR    IFEQ 'Y'                                                         MD021155
     C                     MOVE A8BICN    ABIC,A                                            MD021155
     C           A8BICN    CHAINSDCUSTL0             70                                     MD021155
     C           *IN70     IFEQ '0'                                                         MD021155
     C                     MOVE BBCRNM    ACRN,A                                            MD021155
     C                     ENDIF                                                            MD021155
     C                     ENDIF                                                            MD021155
     C                     MOVE A8BICN    BICN                                              MD021155
     C                     MOVE A8CMCD    CMPY                                              MD021155
     C                     MOVE A8DFAC    ADFAC2                                            MD021155
     C                     MOVE A8DTAC    ADTAC2                                            MD021155
     C                     ENDIF                                                            MD021155
      *                                                                                     MD021155
     C                     Z-ADDA         BINDX   40                                        CRE083BL
     C*
     C**  Check if interbranch postings are always to go via the
     C**  main branch
     C*
     C           BKIEMB    IFEQ 'Y'
     C                     MOVELBKMABR    @BRCH
     C                     Z-ADDBINDX     A                                                 CRE083BL
     C           @BRCH     LOKUPBRCH,A                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           A         OCUR SDBRCH                                                      CRE083BL
     C                     MOVE *BLANKS   @RTCD                                             MD021155
     C                     ELSE                                                             CRE083BL
     C           1         OCUR SDBRCH                                                      MD021155
     C**********           CALL 'AOBRCHR0'#ABRCH                                              CGL029
     C                     CALL 'AOBRCHR1'#ABRCH                                              CGL029
     C                     ENDIF                                                            MD021155
     C*
     C           @RTCD     IFEQ *BLANKS
     C                     MOVE '1'       *IN57
     C                     END
     C**********           ENDIF                                                   CRE083BL MD021155
     C*
     C                     END
     C*
     C           MBIN      COMP 'Y'                      31
     C           DNWD      COMP APDA                   3333
     C**   CONTROL DATE  NEEDED
     C           DNWD      SUB  1         CTLDAT
     C**
     C           APDA      IFLT DNWD                       - B1
     C                     Z-ADDAPDA      CTLDAT                 .
     C                     END                             - E1
     C*
     C**   Access trades detail
     C*
     C                     CALL 'AOTRADR0'#ATRAD
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDTRADPD'DBFILE           ************
     C                     MOVEL'FIRST'   DBKEY            * DBERR 04 *
     C                     Z-ADD4         DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C*
     C**   Access Retail details
     C*
     C                     CALL 'AORETLR0'#ARETL
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDRETLPD'DBFILE           ************
     C                     MOVEL'FIRST'   DBKEY            * DBERR 05 *
     C                     Z-ADD5         DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C**
     C**   ACCESS CUSTOMER GROUP TABLEV4 AND READ ALL RECS INTO AN ARRAY
     C**
     C                     Z-ADD0         OCCUR   10
     C*
     C                     MOVE *BLANKS   ZTABKY 12
     C                     MOVEL'81'      ZTABKY
     C*
     C                     SETOF                     63
     C*
     C                     Z-ADD0         I2      10                                        AR802662
     C           1         SETLLTABLEV4
     C                     DO   8                          B001
     C                     ADD  1         OCCUR
     C                     ADD  1         I2                                                AR802662
     C           OCCUR     OCUR CGPDTA
     C                     MOVE OCCUR     ZTABKY
     C                     READ TABLEV4                  99
     C  N99      RECI      COMP 'D'                  9999
     C*
     C  N99                MOVE OCCUR     WGRP
     C  N99                Z-ADDFIXA      WGRP1
     C  N99                Z-ADDACMA      WGRP2
     C  N99                Z-ADDDINA      WGRP3
     C  N99                Z-ADDMDBA      WGRP4
     C  N99                Z-ADDINAA      WGRP5
     C  N99                Z-ADDMINA      WGRP6
     C  N99                Z-ADDDYSA      WGRP7
     C  N99                MOVE DINI      IN1
     C                     MOVE FIXI      RI1,I2                                            AR802662
     C                     MOVE DINI      RI2,I2                                            AR802662
     C                     MOVE INAI      RI3,I2                                            AR802662
     C                     MOVE MDBI      RI4,I2                                            AR802662
     C                     MOVE MINI      RI5,I2                                            AR802662
     C                     MOVE ACMI      RI6,I2                                            AR802662
     C                     MOVE DYSI      RI7,I2                                            AR802662
     C  N99N63             SETON                     63
     C                     END                             E001
     C*
     C                     SETOF                     99
     C*
     C           *IN63     IFNE '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'TABLEV4 'DBFILE           ************
     C                     MOVEL*BLANKS   DBKEY            * DBERR 06 *
     C                     Z-ADD6         DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
      *
     C                     MOVE 'D'       CCYCON
      *                                                                  *
      **         Read up to 150 retail ICD by currency records           *
      **         and store details in internal arrays.                   *
      *                                                                  *
     C                     Z-ADD0         I1      30
     C           *LOVAL    SETLLRECCY
      *
     C           *IN10     DOUEQ'1'
     C                     READ RECCY                    10
     C           *IN10     IFEQ '0'
     C                     ADD  1         I1
     C                     MOVE CCYKEY    ICC,I1
      *
      **         Charge on number of daily statement
      *
     C                     Z-ADDDSFC      FX1,I1
     C                     Z-ADDDSMX      MX1,I1
     C                     Z-ADDDSMN      MN1,I1
      *                                                                  *
      **         Debit interest commission.                              *
      *                                                                  *
     C                     Z-ADDDIRT      RT2,I1
     C                     Z-ADDDIMX      MX2,I1
     C                     Z-ADDDIMN      MN2,I1
      *                                                                  *
     C********** I1        IFEQ 150                                                         CRE083BL
     C           I1        IFEQ 250                                                         CRE083BL
     C                     SETON                     10
     C                     END
     C                     END
     C                     END
     C********** I1        DOWLT150                                                         CRE083BL
     C           I1        DOWLT250                                                         CRE083BL
     C                     ADD  1         I1
     C                     MOVE *HIVAL    ICC,I1
     C                     END
     C**
     C**   ACCESS CURRENCIES SDCURRPD AND READ ALL RECS INTO AN ARRAY
     C**
     C                     EXSR CYARRY
     C**
     C**   CHECK TO SEE IF SYSTEM SUPPORTS BASE CCY EQUIVALENT A/C'S
     C**
     C**********           Z-ADD1         X                                                 CRE083BL
     C                     Z-ADDARINDX    X                                                 CRE083BL
     C           BCCY      LOKUPWCCY,X                   99
     C           WTAC,X    COMP 0                    3030
     C   30                Z-ADDWTAC,X    BASEAC
     C**
     C**   SET UP DEALING BRANCH INFO (FOR MULTIBRANCH ENVIRONMENT)
     C**
     C   31N32             DO                              B001
     C*
     C**   Access Branch Details
     C*
     C                     MOVE BKMABR    @BRCH
     C**********           CALL 'AOBRCHR0'#ABRCH                                              CGL029
     C           BKIEMB    IFEQ 'Y'                                                         AR722444
     C                     Z-ADDBINDX     A                                                 CRE083BL
     C           @BRCH     LOKUPBRCH,A                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           A         OCUR SDBRCH                                                      CRE083BL
     C                     MOVE *BLANKS   @RTCD                                             MD021155
     C                     ELSE                                                             CRE083BL
     C           1         OCUR SDBRCH                                                      MD021155
     C                     CALL 'AOBRCHR1'#ABRCH                                              CGL029
     C                     ENDIF                                                            MD021155
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDBRCHPD'DBFILE           ************
     C**********           MOVELDLBR      DBKEY            * DBERR 09 *                       185188
     C                     MOVELBKMABR    DBKEY            * DBERR 09 *                       185188
     C                     Z-ADD9         DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C**********           ENDIF                                                   CRE083BL MD021155
     C*
     C                     MOVEL'01'      ZTABKY
     C                     MOVE '    '    ZTABKY
     C*
     C**********           MOVELDLBR      WADBRC                                              185188
     C**********           MOVELDLBR      WDDBRC                                              185188
     C                     MOVE BKMABR    WADBRC                                              185188
     C                     MOVE BKMABR    WDDBRC                                              185188
     C                     MOVE BICN      WADBIC
     C                     MOVE BICN      WDDBIC
     C                     MOVE ADTAC2    WADITO
     C                     MOVE ADFAC2    WADIFR
     C                     MOVE ADTAC2    WDDITO
     C                     MOVE ADFAC2    WDDIFR
     C                     ENDIF                                                            AR722444
     C*
     C                     END                             E001
     C**
     C**   SET UP FIELDS FOR FOR ALL POSTINGS RECORDS
     C**   WHICH REMAIN UNCHANGED THROUGHOUT THE PROGRAM
     C**
     C                     EXSR SETPGM
     C*
     C*****READ*FIRST*RECAP*DETAIL*REC                                    CCB003
     C***********                                                         CCB003
     C***********          MOVE *BLANK    LGID                            CCB003
     C***********          MOVE *BLANK    BRCA                            CCB003
     C***********          Z-ADD*ZERO     CNUM                            CCB003
     C***********          MOVE *BLANK    CCY                             CCB003
     C***********          Z-ADD*ZERO     ACOD                            CCB003
     C***********          Z-ADD*ZERO     ACSQ                            CCB003
     C***********RECAP     SETLLRECAPML                                   CCB003
      *                                                                   CCB003
     C**********           READ RECAPMF                  LR                                 CRE083BD
      *                                                                                       CRE027
      ** Access SAR details to check if CRE027 is installed                                   CRE027
      *                                                                                       CRE027
     C                     MOVE 'N'       CRE027  1                                           CRE027
     C                     CALL 'AOSARDR0'                                                    CRE027
     C                     PARM *BLANKS   @RTCD                                               CRE027
     C                     PARM '*VERIFY' @OPTN                                               CRE027
     C                     PARM 'CRE027'  @SARD                                               CRE027
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE027
      *                                                                                       CRE027
     C           @RTCD     IFEQ *BLANKS                                                       CRE027
     C                     MOVE 'Y'       CRE027                                              CRE027
     C                     ENDIF                                                              CRE027
      *                                                                                       CRE027
      *                                                                                       CER049
      ** Access SAR details to check if CER049 is installed                                   CER049
      *                                                                                       CER049
     C                     MOVE 'N'       CER049  1                                           CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*VERIFY' @OPTN                                               CER049
     C                     PARM 'CER049'  @SARD                                               CER049
     C           SCSARD    PARM SCSARD    DSFDY                                               CER049
      *                                                                                       CER049
     C           @RTCD     IFEQ *BLANKS                                                       CER049
     C                     MOVE 'Y'       CER049                                              CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
      ** Determine system values whether internal postings for charges                        CRE100
      ** should be posted at customer or bank level.                                          CRE100
      *                                                                                       CRE100
     C                     CALL 'AOSVALR0'                                                    CRE100
     C                     PARM *BLANKS   W0RTCD  7                                           CRE100
     C                     PARM SVAL,1    PVALK1 20                                           CRE100
     C                     PARM *BLANKS   PVAL1 200                                           CRE100
     C**********           PARM *BLANKS   PVALK2 20                                  CRE100 MD034990
     C                     PARM SVAL,2    PVALK2 20                                         MD034990
     C                     PARM *BLANKS   PVAL2 200                                           CRE100
     C                     PARM *BLANKS   PVALK3 20                                           CRE100
     C                     PARM *BLANKS   PVAL3 200                                           CRE100
     C                     PARM *BLANKS   PVALK4 20                                           CRE100
     C                     PARM *BLANKS   PVAL4 200                                           CRE100
     C                     PARM *BLANKS   PVALK5 20                                           CRE100
     C                     PARM *BLANKS   PVAL5 200                                           CRE100
     C                     PARM *BLANKS   PVALK6 20                                           CRE100
     C                     PARM *BLANKS   PVAL6 200                                           CRE100
     C                     PARM *BLANKS   PVALK7 20                                           CRE100
     C                     PARM *BLANKS   PVAL7 200                                           CRE100
     C                     PARM *BLANKS   PVALK8 20                                           CRE100
     C                     PARM *BLANKS   PVAL8 200                                           CRE100
     C                     PARM *BLANKS   PVALK9 20                                           CRE100
     C                     PARM *BLANKS   PVAL9 200                                           CRE100
     C                     PARM *BLANKS   PVALK0 20                                           CRE100
     C                     PARM *BLANKS   PVAL10200                                           CRE100
      *                                                                                       CRE100
     C           W0RTCD    IFEQ *BLANKS                                                       CRE100
      *                                                                                       CRE100
     C           PVAL1     IFEQ 'Y'                                                           CRE100
     C                     MOVE 'Y'       CRE100  1                                           CRE100
     C                     ENDIF                                                              CRE100
      *                                                                                       CRE100
     C           PVAL2     IFEQ 'Y'                                                         MD034990
     C                     MOVE 'Y'       RETSEQ  1                                         MD034990
     C                     ENDIF                                                            MD034990
      *                                                                                     MD034990
     C                     ELSE                                                               CRE100
      *                                                                                       CRE100
     C           W0RTCD    IFNE '*NRF'                                                        CRE100
     C           *LOCK     IN   LDA                                                           CRE100
     C                     Z-ADD10        DBASE                                               CRE100
     C                     MOVEL'SDSVALPD'DBFILE                                              CRE100
     C                     MOVELPVALK1    DBKEY                                               CRE100
     C                     OUT  LDA                                                           CRE100
     C                     EXSR DBERR                                                         CRE100
     C                     ENDIF                                                              CRE100
      *                                                                                       CRE100
     C                     ENDIF                                                              CRE100
      *                                                                                       CRE100
     C/COPY WNCPYSRC,RE3116C008
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   M A I N   P R O C E S S I N G
     C**
     C*****************************************************************
     C           MAIN      BEGSR                           *** MAIN ***
     C*
     C/COPY WNCPYSRC,RE3116C031
     C                     ADD  1         NORECI
     C**
     C**   RESET INDICATORS/FIELDS FOR RECORD LEVEL PROCESSING
     C**
     C/COPY WNCPYSRC,RE3116C009
     C                     SETON                     38
     C                     SETOF                     2829
     C                     SETOF                     3435
     C*       FETCH 'BICN' DERIVED FROM RECAP'S BRANCH CODE
     C                     SETOF                     16
     C                     MOVE CBRCA     @BRCH
     C                     Z-ADDBINDX     A                                                 CRE083BL
     C           @BRCH     LOKUPBRCH,A                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           A         OCUR SDBRCH                                                      CRE083BL
     C                     MOVE *BLANKS   @RTCD                                             MD021155
     C                     ELSE                                                             CRE083BL
     C           1         OCUR SDBRCH                                                      MD021155
     C**********           CALL 'AOBRCHR0'#ABRCH                                              CGL029
     C                     CALL 'AOBRCHR1'#ABRCH                                              CGL029
     C                     ENDIF                                                            MD021155
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDBRCHPD'DBFILE           ************
     C                     MOVELCBRCA     DBKEY            * DBERR 20 *
     C                     Z-ADD20        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C**********           ENDIF                                                   CRE083BL MD021155
     C*
     C                     MOVE BICN      WBICN
     C/COPY WNCPYSRC,RE3116C005
     C*
     C**
     C**   DETERMINE IF CREDIT/DEBIT CAPITALISATION DUE
     C**
     C**      CREDIT
     C*
     C           CCICI     IFNE *BLANK
     C           CCICI     ANDNE'M'
     C                     MOVE '1'       *IN34
     C                     END
     C*
     C**      DEBIT
     C*
     C           CDICI     IFNE *BLANK
     C           CDICI     ANDNE'M'
     C                     MOVE '1'       *IN35
     C                     END
     C**
     C**   CHAIN TO ACCOUNT TO GET RETNO
     C**
     C           COMKY2    CHAINACCNTABF             99
      *                                                                   170507
      ** Save retail account number.                                      170507
     C                     MOVELACNO      WCUST2                          170507
      *                                                                   170507
     C  N99      RECI      COMP 'D'                  9999
     C*
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'ACCNT   'DBFILE           ************
     C                     MOVELRNARR     DBKEY            * DBERR 99 *
     C                     Z-ADD99        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
      *
     C                     MOVELSTFQ      ASTFQ   1
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVELPRFC      WPRFC1  4                       CAC001
     C                     ENDIF                                          CAC001
      *
      * Setup Retail account number
      *
     C                     MOVELACNO      WWACNO 10
      *
      * Format address references from ACCNT
      *
     C                     MOVELADREF1    WWARRY 10
     C                     MOVE ADREF2    WWARRY
     C                     MOVEAWWARRY    ADR              Address referen
     C**
     C**   CHAIN TO RECOM FILE
     C**
     C           COMKEY    CHAINRECOMDF              99
     C  N99      RECI      COMP 'D'                  9999
     C  N04                SETON                     99
     C*
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'RECOM   'DBFILE           ************
     C                     MOVELRNARR     DBKEY            * DBERR 12 *
     C                     Z-ADD12        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
      *
     C                     MOVE CCCY      PCCY
     C                     MOVE 'D'       CCYCON
     C                     Z-ADD1         I1
     C           REYKEY    LOKUPICC,I1                   10
      *
     C           *IN10     IFNE '1'                        -B1
     C                     EXSR CCYICD
     C                     END                             -E1
      *                                                                                     AR802662
      ** Set up of Retail ICD indicators according to Customer Group                        AR802662
      *                                                                                     AR802662
     C                     MOVELCNUM      #CNUM   6                                         AR802662
      *                                                                                     AR802662
     C                     MOVEL#CNUM     @CUST                                             AR802662
     C                     CALL 'AOCUSTR0'#ACUST                                            AR802662
      *                                                                                     AR802662
     C           @RTCD     IFNE *BLANKS                                                     AR802662
     C           *LOCK     IN   LDA                                                         AR802662
     C                     MOVEL'RE3116'  DBPGM                                             AR802662
     C                     MOVEL'SDCUSTPD'DBFILE                                            AR802662
     C                     MOVEL#CNUM     DBKEY                                             AR802662
     C                     Z-ADD105       DBASE                                             AR802662
     C                     OUT  LDA                                                         AR802662
     C                     EXSR DBERR                                                       AR802662
     C                     ENDIF                                                            AR802662
      *                                                                                     AR802662
     C                     Z-ADD1         NN      10                                        AR802662
     C           BBCGRP    IFEQ *BLANK                                                      AR802662
     C                     MOVE '1'       BBCGRP                                            AR802662
     C                     ENDIF                                                            AR802662
     C                     MOVE BBCGRP    NN                                                AR802662
     C                     MOVE RI1,NN    FIXI                                              AR802662
     C                     MOVE RI2,NN    DINI                                              AR802662
     C                     MOVE RI3,NN    INAI                                              AR802662
     C                     MOVE RI4,NN    MDBI                                              AR802662
     C                     MOVE RI5,NN    MINI                                              AR802662
     C                     MOVE RI6,NN    ACMI                                              AR802662
     C                     MOVE RI7,NN    DYSI                                              AR802662
      *                                                                                     AR802662
     C**
     C**     FURTHER SETS OF POSTINGS ARE POSSIBLE FOR
     C**   'NON-MANAGEMENT' DR CAPITALISATION
     C**
     C**    VAT
     C                     Z-ADD0         CUSVAT 130
     C                     Z-ADD0         AMTVAT 130
     C                     Z-ADD0         TOTACC 130                                          CER049
     C*
     C**   ********************
     C**   ** CHARGES        **
     C**   ********************
     C   34                DO                              B001
     C                     Z-ADDCCHGP     PAMT       71
     C**   VAT
     C           VATP      IFEQ 'Y'
     C   71                EXSR CUMVAT
     C           FACCS     IFEQ 'Y'                                                           CER049
     C   71                EXSR ACUMCC                                                        CER049
     C                     ENDIF                                                              CER049
     C                     END
     C                     END
     C*
     C   35                DO                              B001
     C*
     C**   ********************
     C**   ** A/C COMMISSION **
     C**   ********************
     C           ACCC      ADD  CACCC     PAMT       71
     C           ACCC      ADD  CACCC     ACCC
     C                     Z-ADD*ZEROS    CACCC
     C                     MOVE *BLANKS   CACDC
     C           LTAC      IFEQ 0
     C           ACMI      ANDEQ'Y'                                                           223451
     C/COPY WNCPYSRC,RE3116C032
     C   71                SETON                     42
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVEL'COM'     OTRF                                                CER001
     C                     ENDIF                                                              CER001
     C   71                EXSR POST
     C**   VAT
     C           VATP      IFEQ 'Y'
     C           TCDTO     ANDEQ'Y'
     C   71                EXSR CUMVAT
     C           CDTOS     IFEQ 'Y'                                                           CER049
     C   71                EXSR ACUMCC                                                        CER049
     C                     ENDIF                                                              CER049
     C                     END
     C                     END
     C*
     C*****************************************************************                       199706
     C********FIXED*COMMISSION*****************************************                       199706
     C*****************************************************************                       199706
     C***********ACST      IFNE 'C'                        B002           119348
     C**********           Z-ADDFXDC      PAMT       71                                       199706
     C********** LTAC      IFEQ 0                                                             199706
     C/COPY WNCPYSRC,RE3116C033
     C***71*****           SETON                     41                                       199706
     C***71*****           EXSR POST                                                          199706
     C*****VAT*********************************************************                       199706
     C********** VATP      IFEQ 'Y'                                                           199706
     C********** TFXAC     ANDEQ'Y'                                                           199706
     C***71*****           EXSR CUMVAT                                                        199706
     C**********           END                                                                199706
     C**********           END                                                                199706
     C***********          END                             E002           119348
     C**   *******************************
     C**   ** COMMISSION ON DR INTEREST **
     C**   *******************************
     C**********           Z-ADDCCNUM     CLCNUM                                              CSD027
     C                     MOVE CCNUM     CLCNUM                                              CSD027
     C                     MOVELCNUM      #CNUM   6
     C*
     C                     MOVEL#CNUM     @CUST
     C                     CALL 'AOCUSTR0'#ACUST
     C*
     C           @RTCD     IFNE *BLANKS
     C           @RTCD     ANDNE'*CUSCLS'                                                  AR750273B
     C           @RTCD     ANDNE'*CUSDEL'                                                  AR750273B
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVEL#CNUM     DBKEY            * DBERR 31 *
     C                     Z-ADD31        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C*
     C                     MOVELBBCGRP    CUCGRP
     C           CUCGRP    IFEQ *BLANK
     C                     MOVE '1'       CUCGRP
     C                     END
     C*
     C           CTYPNO    OCUR CGPDTA
     C                     Z-ADDWGRP3     ACD02
     C           CEXC      IFNE 'E'
     C           IN1       ANDEQ'Y'
     C                     EXSR SR300
     C           CDICA     ADD  CCDIC     PAMT       71
     C                     Z-ADD*ZEROS    CCDIC
     C           LTAC      IFEQ 0
     C           DINI      ANDEQ'Y'                                                           223451
     C/COPY WNCPYSRC,RE3116C034
     C   71                SETON                     43
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVEL'COM'     OTRF                                                CER001
     C                     ENDIF                                                              CER001
     C   71                EXSR POST
     C**   VAT
     C           VATP      IFEQ 'Y'
     C           TCDRI     ANDEQ'Y'
     C   71                EXSR CUMVAT
     C           DRINS     IFEQ 'Y'                                                           CER049
     C   71                EXSR ACUMCC                                                        CER049
     C                     ENDIF                                                              CER049
     C                     END
     C                     END
     C                     END
     C**   ***************************************
     C**   ** COMMISSION FOR HIGHEST DR BALANCE **
     C**   ***************************************
     C           CHDBC     ADD  CCHDBC    PAMT       71
     C           CSDCI     IFEQ 'S'
     C           CSDCI     OREQ 'O'
     C           CSDCI     OREQ 'L'
     C                     Z-ADD*ZEROS    PAMT       71
     C                     END
     C                     Z-ADD*ZEROS    CCHDBC
     C/COPY WNCPYSRC,RE3116C064
     C           LTAC      IFEQ 0
     C           MDBI      ANDEQ'Y'                                                           223451
     C/COPY WNCPYSRC,RE3116C035
     C   71                SETON                     44
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVEL'COM'     OTRF                                                CER001
     C                     ENDIF                                                              CER001
     C   71                EXSR POST
     C**   NO VAT ON COMMISSION FOR HIGHEST DR BALANCE **
     C           VATP      IFEQ 'Y'
     C           TCHOV     ANDEQ'Y'
     C   71                EXSR CUMVAT
     C           CHODS     IFEQ 'Y'                                                           CER049
     C   71                EXSR ACUMCC                                                        CER049
     C                     ENDIF                                                              CER049
     C*
     C                     END
     C                     END
     C                     END                             E001
     C**
     C**   2 FURTHER SETS OF POSTINGS ARE POSSIBLE FOR
     C**   'NON-MANAGEMENT' CR CAPITALISATION
     C**
     C   34                DO                              B001
      *                                                                                       199706
      **   **********************                                                             199706
      **   ** FIXED COMMISSION **                                                             199706
      **   **********************                                                             199706
      *                                                                                       199706
     C           FXDC      IFGT 0                                                             199706
     C                     Z-ADDFXDC      PAMT                                                199706
      *                                                                                       199706
     C           LTAC      IFEQ 0                                                             199706
     C           CRE027    OREQ 'Y'                                                           CRE027
     C           FIXI      ANDEQ'Y'                                                           223451
     C                     MOVE '1'       *IN41                                               199706
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVEL'COM'     OTRF                                                CER001
     C                     ENDIF                                                              CER001
     C                     EXSR POST                                                          199706
      *                                                                                       199706
      ** VAT                                                                                  199706
      *                                                                                       199706
     C           VATP      IFEQ 'Y'                                                           199706
     C           TFXAC     ANDEQ'Y'                                                           199706
     C                     EXSR CUMVAT                                                        199706
     C           FACOS     IFEQ 'Y'                                                           CER049
     C                     EXSR ACUMCC                                                        CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              199706
     C                     ENDIF                                                              199706
      *                                                                                       199706
     C                     ENDIF                                                              199706
     C*
     C**   *****************************
     C**   ** INACTIVE A/C COMMISSION **
     C**   *****************************
     C           IACCC     ADD  CIACC     PAMT       71
     C/COPY WNCPYSRC,RE3116C082
     C                     Z-ADD*ZEROS    CIACC
     C           LTAC      IFEQ 0
     C           CINA      ANDEQ'Y'                                       121054
     C           INAI      ANDEQ'Y'                                                           223451
     C/COPY WNCPYSRC,RE3116C036
     C   71                SETON                     45
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVEL'COM'     OTRF                                                CER001
     C                     ENDIF                                                              CER001
     C   71                EXSR POST
     C           VATP      IFEQ 'Y'
     C           TCINA     ANDEQ'Y'
     C**   VAT
     C   71                EXSR CUMVAT
     C           CHIAS     IFEQ 'Y'                                                           CER049
     C   71                EXSR ACUMCC                                                        CER049
     C                     ENDIF                                                              CER049
     C                     END
     C                     END
     C/COPY WNCPYSRC,RE3116C083
     C**   *********************************************
     C**   ** COMMISSION ON NUMBER OF DAILY STATEMENT **
     C**   *********************************************
      * Generate Statement Charge if frequency 'E' or No. of statements   122805
      * chargeable has a value                                            122805
     C           ASTFQ     IFEQ 'E'
     C/COPY WNCPYSRC,REH00462
     C           NOIS      ORNE 0                                         122805
      *  If Extra Daily Statement Commission is not exempt and Commission
      *  applicable for this customer group
     C           CEXF      IFNE 'E'                        - B2
     C* COMMISSION IS APPLICABLE
     C***********ACST      IFEQ 'C'                        - B3           119348
     C* ACCOUNT IS FLAGGED FOR CLOSING
     C***********NOIS      ADD  NOCC      WWCNDS                          119348
     C***********          Z-ADD1         ALTNAD                          119348
     C*                    MOVE CCNUM     WCUST
      *
      * Process all addresses (up to 10) found in ADR
      *
     C***********          Z-ADD1         A       10       ADR index      119348
     C***********' '       LOKUPADR,A                    25               119348
     C********** *IN25     IFEQ '0'                                       119348
     C***********          Z-ADD10        ALTNAD                          119348
     C***********          ELSE                                           119348
     C***********A         SUB  1         ALTNAD                          119348
     C***********          SETOF                         25               119348
     C***********          END                                            119348
      *
     C***********WWCNDS    MULT ALTNAD    WWCNDS                          119348
     C***********          ADD  1         LSTP                            119348
     C***********          ELSE                            - X3           119348
     C                     Z-ADDNOIS      WWCNDS
     C                     ADD  1         LSTP
     C***********          END                             - E3           119348
     C           CEXF      IFNE *BLANKS                    - B3
     C           WWCNDS    MULT NCEXF     WWCNDS
     C                     ELSE                            - X3
     C           *IN10     IFEQ '1'
     C           WWCNDS    MULT FX1,I1    WWCNDS
     C                     ELSE
     C                     Z-ADD*ZERO     WWCNDS
     C                     END
     C                     END                             - E3
     C           *IN10     IFEQ '1'
     C           WWCNDS    IFLT MN1,I1                     - B3
     C                     Z-ADDMN1,I1    WWCNDS
     C/COPY WNCPYSRC,RE3116C028
     C                     END                             - E3
     C           WWCNDS    IFGT MX1,I1                     - B3
     C                     Z-ADDMX1,I1    WWCNDS
     C                     END                             - E3
     C                     END
     C           WWCNDS    ADD  CCINST    PAMT       71
     C           LTAC      IFEQ 0
     C           DYSI      ANDEQ'Y'                                                           223451
     C           CRE027    OREQ 'Y'                                                           CRE027
     C/COPY WNCPYSRC,RE3116C037
     C   71                SETON                     48
     C   71                EXSR POST
     C           VATP      IFEQ 'Y'
     C           TCNDS     ANDEQ'Y'
     C   71                EXSR CUMVAT
     C           NDSTS     IFEQ 'Y'                                                           CER049
     C   71                EXSR ACUMCC                                                        CER049
     C                     ENDIF                                                              CER049
     C                     END
     C                     END
     C                     Z-ADD*ZEROS    CCINST
     C                     Z-ADD*ZEROS    NOIS
     C                     Z-ADDLSTP      PESP
     C                     END                             - E2
     C                     ENDIF
     C**   ***************************************
     C**   ** COMMISSION ON MINIMUM BALANCE **
     C**   ***************************************
     C*
     C           CHISB     IFLT *ZEROS                     - B2
     C* CHECK IF BALANCE IS CREDIT ENOUGH
     C                     Z-ADD*ZEROS    TOTISB 150
     C           CHISB     ADD  AMTVAT    TOTISB
     C           TOTISB    ADD  CMBC      TOTISB
     C           TOTISB    ADD  CCMBC     TOTISB
     C* CHECK IF BALANCE IS CREDIT WITH THE COMMISSION
     C           TOTISB    IFLE *ZEROS                     - B3
     C           CMBC      ADD  CCMBC     PAMT       71
     C                     Z-ADD*ZEROS    CCMBC
     C           LTAC      IFEQ 0
     C           MINI      ANDEQ'Y'                                                           223451
     C/COPY WNCPYSRC,RE3116C038
     C   71                SETON                     46
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVEL'COM'     OTRF                                                CER001
     C                     ENDIF                                                              CER001
     C   71                EXSR POST
     C**   VAT
     C           VATP      IFEQ 'Y'
     C           TCMBL     ANDEQ'Y'
     C   71                EXSR CUMVAT
     C           CACBS     IFEQ 'Y'                                                           CER049
     C   71                EXSR ACUMCC                                                        CER049
     C                     ENDIF                                                              CER049
     C                     END
     C                     END
     C                     END                             - E3
     C                     END                             - E2
     C*
     C                     END                             E001
     C**   VAT
     C                     Z-ADD0         VATAM
     C*
     C           VATP      IFEQ 'Y'
     C           AMTVAT    IFGT 0
     C           BQCTVA    IFEQ 'Y'                         AUTO-POST
     C           AMTVAT    MULT XTVA      PAMT      H71
     C           LTAC      IFEQ 0
     C   71                SETON                     47
     C           ULX043    IFEQ 'Y'                                                           CER001
     C                     MOVEL'VAT'     OTRF                                                CER001
     C                     ENDIF                                                              CER001
     C   71                EXSR POST
     C   71                Z-ADDPAMT      VATAM
     C                     END
     C                     END
     C                     END
     C                     END
      *                                                                                       CER049
      ** Update new fields of RECOM                                                           CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
     C           TOTACC    IFNE 0                                                             CER049
     C                     ADD  TOTACC    CHCO                                                CER049
     C                     MOVE 'Y'       STPF2                                               CER049
     C                     ENDIF                                                              CER049
     C                     ENDIF                                                              CER049
     C*
     C                     EXCPTRECOUP
      *                                                                   CCB003
      ** Increase number of records processed                             CCB003
     C                     ADD  1         #COMIT                          CCB003
      *                                                                   CCB003
      ***Delete*record*from*driving*file**                                           CCB003 CRE083BD
     C**********           DELETRECOMCPD                                             CCB003 CRE083BD
      *                                                                   CCB003
      ** Comit if restart status = 'Y' or number of records processed     CCB003
      ** has reached optimum defined in CBTASKSP                          CCB003
     C                     MOVE LGID      #LGID                                             CRE083BD
     C                     MOVE BRCA      #BRCA                                             CRE083BD
     C                     MOVE CNUM      #CNUM                                             CRE083BD
     C                     MOVE CCY       #CCY                                              CRE083BD
     C                     MOVE ACOD      #ACOD                                             CRE083BD
     C                     MOVE ACSQ      #ACSQ                                             CRE083BD
     C                     MOVE NXTKEY    LSTKEY                                            CRE083BD
     C           RSTART    IFEQ 'Y'                                       CCB003
     C           #COMIT    OREQ #OPTIM                                    CCB003
     C                     EXSR END                                       CCB003
     C                     EXSR UPDPTR                                                      CRE083BD
     C                     COMIT                                          CCB003
     C                     Z-ADD0         #COMIT                          CCB003
     C                     ENDIF                                          CCB003
     C*
     C**********           READ RECAPMF                  LR                                 CRE083BD
     C                     READ RECAPMF                  77                                 CRE083BD
      *                                                                                     CRE083BD
      ** Check if end record is read.                                                       CRE083BD
      **                                                                                    CRE083BD
     C           *IN77     IFEQ '0'                                                         CRE083BD
     C                     MOVE LGID      #LGID                                             CRE083BD
     C                     MOVE CBRCA     #BRCA                                             CRE083BD
     C                     MOVE CCNUM     #CNUM                                             CRE083BD
     C                     MOVE CCCY      #CCY                                              CRE083BD
     C                     MOVE CACOD     #ACOD                                             CRE083BD
     C                     MOVE CACSQ     #ACSQ                                             CRE083BD
     C           NXTKEY    IFGT ENDKEY                                                      CRE083BD
     C                     MOVE '1'       *IN77                                             CRE083BD
     C                     END                                                              CRE083BD
     C                     END                                                              CRE083BD
     C           *IN77     IFEQ '1'                                                         CRE083BD
     C                     MOVE LSTKEY    NXTKEY                                            CRE083BD
     C                     END                                                              CRE083BD
      *                                                                   CCB003
      ** Comit if no records left in driving file and number of           CCB003
      ** records processed is not 0                                       CCB003
     C********** *INLR     IFEQ '1'                                                  CCB003 CRE083BD
     C           *IN77     IFEQ '1'                                                         CRE083BD
     C           #COMIT    ANDGT0                                         CCB003
     C                     EXSR END                                       CCB003
     C                     EXSR UPDPTR                                                      CRE083BD
     C                     COMIT                                          CCB003
     C                     ENDIF                                          CCB003
     C*
     C                     ENDSR
     C*****************************************************************
      *****************************************************************                     CRE083BD
      **                                                                 *                  CRE083BD
      **  UPDPTR - Update pointer of RECOMCPD                            *                  CRE083BD
      **                                                                 *                  CRE083BD
      *****************************************************************                     CRE083BD
     C           UPDPTR    BEGSR                                                            CRE083BD
      *                                                                                     CRE083BD
     C                     MOVE 'A'       DRVKEY                                            CRE083BD
     C                     MOVE NXTKEY    LSTKEY                                            CRE083BD
     C           DRVKEY    CHAINRECOMCPD             76                                     CRE083BD
     C           *IN76     IFEQ '0'                                                         CRE083BD
     C                     MOVE LSTKEY    NXTKEY                                            CRE083BD
     C                     MOVE #LGID     LGID                                              CRE083BD
     C                     MOVE #BRCA     BRCA                                              CRE083BD
     C                     MOVE #CNUM     CNUM                                              CRE083BD
     C                     MOVE #CCY      CCY                                               CRE083BD
     C                     MOVE #ACOD     ACOD                                              CRE083BD
     C                     MOVE #ACSQ     ACSQ                                              CRE083BD
     C                     MOVE 'C'       PROT                                              CRE083BD
     C                     UPDATDRIVEF                                                      CRE083BD
     C                     END                                                              CRE083BD
      *                                                                                     CRE083BD
     C                     ENDSR                                                            CRE083BD
      *****************************************************************
      **                                                                 *
      **  CCYICD Subroutine to handle missing currencies on Retail ICD   *
      **                                                                 *
      **  Called By:  SR000                                              *
      **  Calls:      -                                                  *
      **                                                                 *
      **  Indicators:                                                    *
      **  Arrays:                                                        *
      **                                                                 *
      **  Fields:                                                        *
      **                                                                 *
     C           CCYICD    BEGSR
      *                                                                  *
      *                                                                  *
      **         Check if no overflow.                                   *
     C*********  *IN88     IFEQ '1'                                       086117
     C*********  @HEAD     ANDNE'Y'                                       086117
     C           LINEC     IFGT 56                                        086117
     C                     WRITEHEADAU
     C*********            MOVE '0'       *IN88                           086117
     C                     END
      *                                                                  *
      **         Output advice for CCY missing on ICD Account reference  *
     C           @MISS     IFNE 'Y'
     C                     WRITECCYERR
     C                     MOVE 'Y'       @MISS
     C                     END
     C                     WRITECCYERRB
     C                     ENDSR
     C/EJECT
      *****************************************************************
     C/EJECT
      *****************************************************************
      **                                                                 *
      **  SR300 subroutine calculates debit interest commission.         *
      **                                                                 *
      **  Called By:  MAIN                                               *
      **  Calls:      SR310                                              *
      **                                                                 *
      **  Indicators:                                                    *
      **                                                                 *
      **  Arrays:                                                        *
      **                                                                 *
      **  Fields:     TOTDIN  Total debit interest for enquiry.          *
      **              TOTCDI  Total debit interest capitalised.          *
      **                                                                 *
     C           SR300     BEGSR
      *                                                                  *
      **         Retrieve accrued interest.                              *
      *                                                                  *
     C**********           Z-ADDCCNUM     CUST                                                CSD027
     C                     MOVE CCNUM     CUST                                                CSD027
     C                     MOVE CCCY      ACCY
     C                     Z-ADDCACOD     ACOD
     C                     Z-ADDCACSQ     ASEQ
     C           REAKEY    CHAINREACR                11
     C           *IN11     IFEQ '1'
     C                     MOVE CUST      CNUM
     C                     MOVE ACCY      CCY
     C                     MOVE ASEQ      ACSQ
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'REACR   'DBFILE           ************
     C                     MOVELNCODC     DBKEY            * DBERR 31 *
     C                     Z-ADD31        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
      *                                                                  *
      **         Calculate accrued interest as the sum of                *
      **         accrued debit interest , manual adjustments ,           *
      **         generated adjustments less total debit interest         *
      **         capitalised.                                            *
      *                                                                  *
     C           DAIC1     ADD  MADI      TOTDIN 152
     C                     ADD  GADI      TOTDIN
      *                                                                  *
      **         If account is debit capitalising then routine           *
      **         SR310 is executed to calculate the capitalisation       *
      **         amount on debit interest.                               *
      *                                                                  *
     C           *IN35     IFEQ '1'
     C                     EXSR SR310
     C                     END
      *                                                                  *
      **         Calculation interest rate is based on the override      *
      **         rate (if present) else the rate as supplied on the      *
      **         retail ICD record.                                      *
      *                                                                  *
     C           CEXC      IFNE *BLANKS
     C                     Z-ADDORATEC    RATE
     C                     ELSE
     C           *IN10     IFEQ '1'
     C                     Z-ADDRT2,I1    RATE
     C                     ELSE
     C                     Z-ADD*ZERO     RATE
     C                     END
     C                     END
      *
     C                     MULT RATE      TOTDIN    H
     C                     DIV  100       TOTDIN    H
      *                                                                  *
      **         If the calculated commission is less than the minimum   *
      **         commission chargeable then charge the minimum           *
      **         commission.                                             *
      *                                                                  *
     C           *IN10     IFEQ '1'
     C           TOTDIN    IFLT MN2,I1
     C                     Z-ADDMN2,I1    TOTDIN
     C/COPY WNCPYSRC,RE3116C029
     C                     ELSE
      *                                                                  *
      **         If the calculated commission is greater than the        *
      **         maximum commission chargeable then charge the maximum   *
      **         commission.                                             *
      *                                                                  *
     C           TOTDIN    IFGT MX2,I1
     C                     Z-ADDMX2,I1    TOTDIN
     C                     END
     C                     END
     C                     END
      *
     C                     Z-ADDRATE      CDRR
     C                     Z-ADDTOTDIN    CDIE      H
     C*
     C**         Include any manual adjustments to the enquiry value.
     C*
     C                     ADD  CCDIC     CDIE
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
      *****************************************************************
      **                                                                 *
      **  SR310 subroutine to handle capitalisation of commission        *
      **  on debit interest.                                             *
      **                                                                 *
      **  Called By:  SR300                                              *
      **  Calls:      -                                                  *
      **                                                                 *
      **  Indicators:                                                    *
      **                                                                 *
      **  Arrays:                                                        *
      **                                                                 *
     C           SR310     BEGSR
      *
      *                                                                  *
      **         Calculate debit interest for capitalisation as the sum  *
      **         of debit interest capitalised , manual adjustments ,    *
      **         and generated adjustments.                              *
      *                                                                  *
     C           TDINT     ADD  MADI      TOTCDI 152
     C                     ADD  GADI      TOTCDI
      *
      **         Deduct the interest to be capitalised from the
      **         interest for enquiry
      *
     C                     SUB  TOTCDI    TOTDIN
      *                                                                  *
      **         Calculation interest rate is based on the override      *
      **         rate (if present) else the rate as supplied on the      *
      **         retail ICD record.                                      *
      *                                                                  *
     C           CEXC      IFNE *BLANKS
     C                     Z-ADDORATEC    RATE
     C                     ELSE
     C           *IN10     IFEQ '1'
     C                     Z-ADDRT2,I1    RATE
     C                     ELSE
     C                     Z-ADD*ZERO     RATE
     C                     END
     C                     END
      *
     C                     MULT RATE      TOTCDI    H
     C                     DIV  100       TOTCDI    H
      *                                                                  *
      **         If the calculated commission is less than the minimum   *
      **         commission chargeable then charge the minimum           *
      **         commission.                                             *
      *                                                                  *
     C           *IN10     IFEQ '1'
     C           TOTCDI    IFLT MN2,I1
     C                     MOVE 'MIN'     MMCDI
     C                     Z-ADDMN2,I1    TOTCDI
     C/COPY WNCPYSRC,RE3116C030
     C                     ELSE
      *                                                                  *
      **         If the calculated commission is greater than the        *
      **         maximum commission chargeable then charge the maximum   *
      **         commission.                                             *
      *                                                                  *
     C           TOTCDI    IFGT MX2,I1
     C                     MOVE 'MAX'     MMCDI
     C                     Z-ADDMX2,I1    TOTCDI
     C                     END
     C                     END
     C                     END
      *
     C                     Z-ADDTOTCDI    CDICA     H
      *
     C                     ENDSR
      *****************************************************************
     C/EJECT
     C*****************************************************************
     C*
     C**   VAT
     C           CUMVAT    BEGSR
     C           PAMT      IFGT 0
     C                     Z-ADDPAMT      Z13VAT 130
     C                     ELSE
     C                     Z-SUBPAMT      Z13VAT
     C                     END
     C                     ADD  Z13VAT    AMTVAT
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   P O S T I N G S   P R O C E S S I N G
     C**
     C*****************************************************************
     C           POST      BEGSR                           *** POST ***
     C**
     C**   IS THIS THE FIRST POSTING FOR THIS A/C?
     C**
     C   38                DO                              B001
     C*
     C*    ALTERNATE A/C EXISTS?
     C*
     C                     MOVE CSDACP    DACP
     C           DACP      COMP BLK15                3939
     C                     SETOF                     40
     C*
     C   39                DO                              B002
     C* SAVE LAST CAPITALISATION DATE BEFORE ACCESS
     C                     Z-ADDLDID      XLDID   50
     C                     Z-ADDLCID      XLCID   50
     C*
     C*    ACCESS (ACCNT OR ACNUM) USING (KEY SEQ. OR RETAIL NO.)
     C*    (IF NO REC FOUND THEN USE SUSPENSE)
     C           BLK5D     IFNE BLK5                       B003
     C           ACCKEY    CHAINACCNTABF             29
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           ATYP      IFEQ 'R'                                       CAC001
     C           ATYP      OREQ 'N'                                       CAC001
     C                     MOVELPRFC      PRFCA                           CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C                     ELSE                            *003
     C                     SETON                     28
     C           BGN0ST    IFNE 'Y'                                       CAC001
     C           ACNOD     CHAINACNUMABF             29
     C                     ELSE                                           CAC001
     C           ACNOD     CHAINREACNMF              29                   CAC001
     C                     ENDIF                                          CAC001
     C                     END                             E003
     C* RESET LAST CAPITALISATION DATE BEFORE ACCESS
     C                     Z-ADDXLDID     LDID
     C                     Z-ADDXLCID     LCID
     C/COPY WNCPYSRC,RE3116C010
     C*
     C  N29      RECI      COMP 'D'                  2929
     C*
     C*    SET ON IND 40 IF ALTERNATE CCY DIFFERS FROM ORIGINAL CCY
     C  N29N28   CCYD      COMP CCCY                 4040
     C  N29 28   CCYA      COMP CCCY                 4040
     C*
     C*    ALSO, SET UP THOSE FIELDS WHOSE ORIGINS DEPEND ON WHETHER
     C*    'DACP' CONTAINS A KEY SEQUENCE OR A RETAIL NO.
     C*    (DACP IS A KEY SEQUENCE)
     C  N29N28             MOVE CCYD      CCYO
     C**N29N28**           Z-ADDDCNUM     CNUMO                                               CSD027
     C  N29N28             MOVE DCNUM     CNUMO                                               CSD027
     C  N29N28             Z-ADDDACOD     ACDO
     C  N29N28             Z-ADDDACSQ     ACSQO
     C  N29N28             Z-ADDACNO      ACNOO
     C*    (DACP IS A RETAIL NO)
     C  N29 28             MOVE CCYA      CCYO
     C**N29*28**           Z-ADDCNUM      CNUMO                                               CSD027
     C  N29 28             MOVE CNUM      CNUMO                                               CSD027
     C  N29 28             Z-ADDACOD      ACDO
     C  N29 28             Z-ADDACSQ      ACSQO
     C  N29 28             Z-ADDACNO      ACNOO
     C*
     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
     C*
     C           *IN29     IFEQ *OFF
     C           ATYP      ANDEQ'R'
     C*
     C                     MOVELBRCA      BRCAO   3
     C*
     C           ALTKEY    CHAINREHISBL              75
     C*
     C           *IN75     IFEQ *OFF
     C           CHISD     IFLT VDTC
     C                     Z-ADDCHISD     VDTC
     C                     ENDIF
     C                     MOVE 'Y'       ADTY
     C                     UPDATREHISPPF
     C                     ENDIF
     C*
     C                     ENDIF
     C*
     C**  Use profit centre of alternate account if retail or nostro.     CAC001
     C*                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN29     IFEQ '0'                                       CAC001
     C           ATYP      IFEQ 'R'                                       CAC001
     C           ATYP      OREQ 'N'                                       CAC001
     C                     MOVELPRFCA     WPRFC2  4                       CAC001
     C                     ELSE                                           CAC001
     C                     MOVELWPRFC1    WPRFC2                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C*
     C*    SET UP MULTIBRANCHING FIELDS FOR ALTERNATE A/C IF NECESSARY
     C  N29 31             EXSR MULTBR
     C*
     C                     END                             E002
     C*
     C/COPY WNCPYSRC,RE3116C039
     C                     SETOF                     38
     C*
     C                     END                             E001
      *                                                                   CAC001
      **  Use profit centre of generating RE account when not using an    CAC001
      **  alternate account.                                              CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C           *IN39     IFEQ '1'                                       CAC001
     C                     MOVELWPRFC2    PRFC                            CAC001
     C                     ELSE                                           CAC001
     C                     MOVELWPRFC1    PRFC                            CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C*
     C*    SET UP FIELDS FOR ALL POSTINGS RECORDS WHICH
     C*    ARE TO REMAIN THE SAME FOR ANY ONE COMMISSION
     C*
     C                     EXSR SETCOM
     C*
     C*    IF SUSPENSE SET POSTINGS 01A & 02
     C*
     C   29                SETON                     50
     C   29                EXSR SET01A
     C/COPY WNCPYSRC,RE3116C040
     C   29                EXSR SET02
     C   29                GOTO OUTPUT
     C*
     C*    CONVERT POSTING AMOUNT IF ALTERNATE A/C USES BASE CCY
     C*
     C   40                DO                              B001
     C*
     C                     SETOF                     73
     C**********           Z-ADD1         X                                                 CRE083BL
     C                     Z-ADDARINDX    X                                                 CRE083BL
     C           CCCY      LOKUPWCCY,X                   73
     C   73      WMDI,X    COMP 'M'                      60
     C   73 60   PAMT      MULT WSPT,X    PAMTCV    H
     C   73N60   PAMT      DIV  WSPT,X    PAMTCV    H
     C  N73                SETON                     99
     C*
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVELCCCY      DBKEY            * DBERR 13 *
     C                     Z-ADD13        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C*
     C*    CONVERT POSTING AMOUNT INTO ALTERNATE CURRENCY
     C*
     C                     SETOF                     73
     C**********           Z-ADD1         X                                                 CRE083BL
     C                     Z-ADDARINDX    X                                                 CRE083BL
     C           CCYO      LOKUPWCCY,X                   73
     C   73      WMDI,X    COMP 'M'                      60
     C   73N60   PAMTCV    MULT WSPT,X    PAMTCA    H
     C   73 60   PAMTCV    DIV  WSPT,X    PAMTCA    H
     C  N73                SETON                     99
     C*
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVELCCYO      DBKEY            * DBERR  2 *
     C                     Z-ADD2         DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C*
     C                     END                             E001
     C*
     C                     SETON                     51
     C                     EXSR SET01
     C                     EXSR SET02
     C/COPY WNCPYSRC,RE3116C027
     C*
     C*    ORIGINAL/ALTERNATE CCY'S DIFFER?
     C   40                SETON                     52
     C   40                EXSR SET03
     C   40                EXSR SET04
     C/COPY WNCPYSRC,RE3116C011
     C*
     C*    ORIG./ALT. CCY'S DIFFER AND BASE CCY EQUIVALENT A/C SUPPORTED?
     C   40 30             SETON                     53
     C   40 30             EXSR SET05
     C   40 30             EXSR SET06
      *                                                                   CAC001
      **  If Analytical Accounting is installed, check if Profit Centre   CAC001
      **  can hold FX Position                                            CAC001
      *                                                                   CAC001
     C           BGN0ST    IFEQ 'Y'                                       CAC001
     C                     MOVE '0'       *IN66                           CAC001
     C           *IN40     IFEQ '1'                                       CAC001
     C                     EXSR SRPRFC                                    CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
     C*
     C*    ALTERNATE A/C USED AND MULTIBRANCHING ENVIRONMENT AND
     C*    (ORIG./ALT. CCY'S DIFFER OR ORIG./ALT. BRANCHES DIFFER) ?
     C*
     C*    IF YOU CAN ANSWER YES! TO ANY OF THESE QUESTIONS THEN
     C*       SET UP INTERBRANCH POSTINGS.
     C   39 31             DO                              B001
     C*
     C** GENERATE INTERBRANCHING POSTINGS IF REQUIRES
     C*
     C           WDBRCD    IFNE WABRCD
     C                     SETON                     58
     C                     EXSR SET11
     C                     EXSR SET12
     C                     ENDIF
     C*
     C*
     C           *IN57     IFEQ '1'
     C           BKMABR    IFNE WABRCD
     C           BKMABR    ANDNEWDBRCD
     C                     SETON                     54
     C                     EXSR SET07
     C                     EXSR SET08
     C                     ENDIF
     C                     END                             E003
     C*
     C*
     C                     END                             E001
     C/COPY WNCPYSRC,RE3116C041
     C**
     C           OUTPUT    TAG                             ** OUTPUT TAG **
     C*                                                                   S01522
     C* Execute the posting narratives subroutine:                        S01522
     C*                                                                   S01522
     C***********          EXSR SRPNAR                             S01522 099081
     C*                                                                   119348
     C* Setup value date according to normal or closure capitalisation.   119348
     C*                                                                   119348
     C           ACST      IFEQ 'C'                                       119348
     C                     Z-ADDVLD00     VLDOU                           119348
     C                     ELSE                                           119348
     C                     Z-ADDVLD01     VLDOU                           119348
     C                     END                                            119348
     C**
     C**   OUTPUT THE POSTINGS
     C/COPY WNCPYSRC,REH00472
     C**
      *                                                                                       CGL020
      ** Initialise Fee Fields if AML is installed                                            CGL020
      *                                                                                       CGL020
     C                     MOVE *BLANKS   ACKEY  20                                           CGL020
     C                     Z-ADD0         ZERO13 130                                          CGL020
     C                     Z-ADD0         ZERO5   52                                          CGL020
     C                     Z-ADD100       FEEPCT  52                                          CGL020
     C                     MOVE *BLANKS   RORACT 20                                           CGL020
     C                     MOVE *BLANKS   RORCTY  2                                           CGL020
     C                     MOVE *BLANKS   RORBNK 20                                           CGL020
     C                     MOVE *BLANKS   RORCDE 11                                           CGL020
     C                     MOVE *BLANKS   PORACT 20                                           CGL020
     C                     MOVE *BLANKS   PORCTY  2                                           CGL020
     C                     MOVE *BLANKS   PORBNK 20                                           CGL020
     C                     MOVE *BLANKS   PORCDE 11                                           CGL020
     C                     MOVE *BLANKS   DSTACT 35                                           CGL020
     C                     MOVE *BLANKS   DSTCTY  2                                           CGL020
     C                     MOVE *BLANKS   DSTBNK 20                                           CGL020
     C                     Z-ADD*ZEROS    SETDAT  50                                          CGL020
     C                     MOVE *BLANKS   TICKER 10                                           CGL020
     C                     MOVE *BLANKS   EXCHNG 20                                           CGL020
     C                     Z-ADD*ZEROS    NOMINL 132                                          CGL020
     C                     MOVE *BLANKS   FDTRID 16                                           CGL020
      *                                                                                       CGL020
     C   50                EXCPTREC01A
     C/COPY WNCPYSRC,RE3116C042
     C   50                EXCPTREC02
     C/COPY WNCPYSRC,RE3116C050
     C   51                EXCPTREC01
     C/COPY WNCPYSRC,RE3116C051
     C*                                                                   S01522
     C           *IN51     IFEQ '1'
     C           RET01     ANDEQ1
     C***********VLD01     ANDLECTLDAT                                    120958
     C           VLDOU     ANDLECTLDAT                                    120958
     C                     EXCPTRECO1
     C                     END
     C/COPY WNCPYSRC,RE3116C043
     C*                                                                   S01522
     C   51                EXCPTREC02
     C/COPY WNCPYSRC,RE3116C012
     C   52                EXCPTREC03
     C/COPY WNCPYSRC,RE3116C052
     C   52                EXCPTREC04
     C/COPY WNCPYSRC,RE3116C053
     C   53                EXCPTREC05
     C/COPY WNCPYSRC,RE3116C054
     C   53                EXCPTREC06
     C/COPY WNCPYSRC,RE3116C055
     C   58                EXCPTREC11
     C/COPY WNCPYSRC,RE3116C056
     C   58                EXCPTREC12
     C/COPY WNCPYSRC,RE3116C057
     C   54                EXCPTREC07
     C/COPY WNCPYSRC,RE3116C058
     C   54                EXCPTREC08
     C/COPY WNCPYSRC,RE3116C002
     C**
     C**   RECORD COUNTS
     C**
     C   50                ADD  2         NORECO  50
     C   51                ADD  2         NORECO
     C   52                ADD  2         NORECO
     C   53                ADD  2         NORECO
     C   54                ADD  2         NORECO
     C   58                ADD  2         NORECO
     C**
     C**   HASH TOTALS
     C**
     C/COPY WNCPYSRC,RE3116C013
     C   50                MOVE PAM01A    ZZAMT
     C   50                EXSR GLZADD
     C   50                MOVE PAM02     ZZAMT
     C   50                EXSR GLZADD
     C   51                MOVE PAM01     ZZAMT
     C   51                EXSR GLZADD
     C   51                MOVE PAM02     ZZAMT
     C   51                EXSR GLZADD
     C   52                MOVE PAM03     ZZAMT
     C   52                EXSR GLZADD
     C   52                MOVE PAM04     ZZAMT
     C   52                EXSR GLZADD
     C   53                MOVE PAM05     ZZAMT
     C   53                EXSR GLZADD
     C   53                MOVE PAM06     ZZAMT
     C   53                EXSR GLZADD
     C   58                MOVE PAM11     ZZAMT
     C   58                EXSR GLZADD
     C   58                MOVE PAM12     ZZAMT
     C   58                EXSR GLZADD
     C   54                MOVE PAM07     ZZAMT
     C   54                EXSR GLZADD
     C   54                MOVE PAM08     ZZAMT
     C   54                EXSR GLZADD
     C*
     C/COPY WNCPYSRC,RE3116C014
     C                     SETOF                     414243
     C                     SETOF                     444546
     C*** VAT
     C                     SETOF                     4748
     C*
     C                     SETOF                     50
     C                     SETOF                     515253
     C                     SETOF                     5455
     C                     SETOF                     58
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/COPY WNCPYSRC,RE3116C003
      /EJECT                                                              CAC001
      *****************************************************************   CAC001
      **                                                              *   CAC001
      **   SRPRFC - Subroutine to determine if Profit Centre can      *   CAC001
      **            hold FX Position                                  *   CAC001
      **                                                              *   CAC001
      **   Called by: POST                                            *   CAC001
      **                                                              *   CAC001
      **   Calls    : DBERR                                           *   CAC001
      **                                                              *   CAC001
      *****************************************************************   CAC001
     C           SRPRFC    BEGSR                                          CAC001
      *                                                                   CAC001
      **  Access Profit Centre details via access object                  CAC001
      *                                                                   CAC001
     C                     CALL 'AOPRFCR0'                                CAC001
     C                     PARM *BLANKS   WRTCD   7                       CAC001
     C                     PARM '*KEY   ' WOPTN   7                       CAC001
     C                     PARM PRFC      WPRFC   4                       CAC001
     C           SDPRFC    PARM SDPRFC    DSFDY                           CAC001
      *                                                                   CAC001
      **  Database error if not found                                     CAC001
      *                                                                   CAC001
     C           WRTCD     IFNE *BLANKS                                   CAC001
     C           *LOCK     IN   LDA                                       CAC001
     C                     Z-ADD40        DBASE            ************   CAC001
     C                     MOVELPRFC      DBKEY            * DBERR 40 *   CAC001
     C                     MOVEL'SDPRFCPD'DBFILE           ************   CAC001
     C                     OUT  LDA                                       CAC001
     C                     EXSR DBERR                                     CAC001
     C                     ELSE                                           CAC001
      *                                                                   CAC001
      **  Use FX Position Profit Centre if it is not blank                CAC001
      *                                                                   CAC001
     C           DSFPPC    IFNE *BLANK                                    CAC001
     C                     MOVE '1'       *IN66                           CAC001
     C                     ENDIF                                          CAC001
     C                     ENDIF                                          CAC001
      *                                                                   CAC001
     C                     ENDSR                                          CAC001
      ********************************************************************CAC001
     C/EJECT
     C*****************************************************************
     C**
     C**   E N D   P R O C E S S I N G
     C**
     C*****************************************************************
     C           END       BEGSR                           *** END ***
     C**
     C**   READ AND UPDATE GENERATED POSTING FILE TRAILER
     C**
     C***********1         SETLLGEICZZ                                    CCB003
     C***********          READ GEICZZ                   99               CCB003
      *                                                                   CCB003
     C           1         SETLLRECOMCPA                                  CCB003
     C                     READ RECOMCPA                 99               CCB003
      *                                                                   CCB003
      ** No record in RECOMCPA when program called first time             CCB003
      *                                                                   CCB003
     C           *IN99     IFEQ '1'
      *                                                                   CCB003
     C                     MOVEL'T'       RECI                            CCB003
     C                     Z-ADD0         NORE1                           CCB003
     C                     Z-ADD0         HRWN                            CCB003
     C                     Z-ADD0         HRDC                            CCB003
      *                                                                   CCB003
     C************LOCK     IN   LDA                                       CCB003
     C***********          MOVEL'RE3116'  DBPGM                           CCB003
     C***********          MOVEL'GEICZ   'DBFILE           ************   CCB003
     C***********          MOVEL*BLANKS   DBKEY            * DBERR 21 *   CCB003
     C***********          Z-ADD21A       DBASE            ************   CCB003
     C***********          OUT  LDA                                       CCB003
     C***********          EXSR DBERR                                     CCB003
     C                     END
     C*
     C/COPY WNCPYSRC,RE3116C015
     C                     ADD  ZZTOTI    HRWN
     C           ZZTOTD    ADD  HRDC      HRDC2   40
     C/COPY WNCPYSRC,RE3116C016
     C           HRDC2     IFGT 999
     C                     ADD  1         HRWN
     C                     END
     C/COPY WNCPYSRC,RE3116C017
     C                     ADD  ZZTOTD    HRDC
     C/COPY WNCPYSRC,RE3116C018
     C                     ADD  NORECO    NORE1
     C*
     C           *IN99     IFEQ '1'                                       CCB003
     C                     WRITEAPOSTZZF               99                 CCB003
     C                     ELSE                                           CCB003
     C                     UPDATAPOSTZZF               99
     C                     ENDIF                                          CCB003
     C*
     C/COPY WNCPYSRC,RE3116C019
     C                     Z-ADD0         NORECO                          CCB003
     C                     Z-ADD0         ZZTOTI                          CCB003
     C                     Z-ADD0         ZZTOTD                          CCB003
     C/COPY WNCPYSRC,RE3116C059
     C*                                                                   CCB003
     C***********          WRITEPRINTAU                                   CCB003
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   C U R R E N C I E S   A R R A Y
     C**
     C*****************************************************************
     C           CYARRY    BEGSR                           *** CYARRY ***
     C*
     C**********           Z-ADD0         X       30                                        CRE083BL
     C                     Z-ADD0         X       40                                        CRE083BL
     C*
     C*    SET LIMITS TO OBTAIN SPOT RATE FOR BASE CURRENCY
     C*
     C                     MOVE BCCY      @CCY
     C                     CALL 'AOCURRR0'#ACURR
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDCURRPD'DBFILE           ************
     C                     MOVELBCCY      DBKEY            * DBERR 07 *
     C                     Z-ADD7         DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C*
     C*    SAVE SPOT RATE AND DECIMAL PLACES FOR BASE CURRENCY
     C                     Z-ADDA6SPRT    SRATE  138
     C                     Z-ADDA6NBDP    SCDP    10
     C           MDIN      COMP 'D'                      61
     C*
     C*    SET LOWER LIMITS TO ACCESS CURRENCIES FILE
     C                     MOVE *BLANKS   A6CYCD
     C                     Z-ADD250       X                                                 CRE083BL
     C           A6CYCD    SETLLSDCURRD0
     C                     READ SDCURRD0                 70
     C*
     C*    LOOP TO READ CURRENCIES ON TABLES FILE
     C           *IN70     DOWEQ'0'                        B001
     C*
     C*    CALCULATE CONVERSION FACTOR. SPOT RATE FOR ACTUAL CCY
     C*    DIVIDED BY SPOT RATE OF BASE CURRENCY
     C*
     C           MDIN      COMP 'D'                      60
     C           SPOT      COMP 0                        62
     C*
     C   60 61N62
     CORN60N61N62SPOT      DIV  SRATE     SPOT      H
     C   60N61N62
     CORN60 61N62SPOT      MULT SRATE     SPOT      H
     C   62                Z-ADD0         SPOT
     C           CDP       SUB  SCDP      CDP        818280
     C   82                Z-SUBCDP       CDP
     C           CDP       COMP 2                    878586
     C   60 81             SETON                     83
     C   60 83             SETOF                     81
     C   60 82             SETON                     84
     C   60 84             SETOF                     82
     C   60 83             SETON                     82
     C   60 84             SETON                     81
     C                     SETOF                     8384
     C   82 85   SPOT      MULT 10        SPOT
     C   82 86   SPOT      MULT 100       SPOT
     C   82 87   SPOT      MULT 1000      SPOT
     C   81 85   SPOT      DIV  10        SPOT      H
     C   81 86   SPOT      DIV  100       SPOT      H
     C   81 87   SPOT      DIV  1000      SPOT      H
     C*
     C*    MOVE CURRENCY AND CONVERSION FACTOR INTO ARRAYS
     C********** X         ADD  1         X                                                 CRE083BL
     C                     SUB  1         X                                                 CRE083BL
     C                     MOVE CCY       WCCY,X
     C                     Z-ADDSPOT      WSPT,X
     C                     MOVE TACC      WTAC,X
     C                     MOVE MDIN      WMDI,X
     C*
     C           ENDAR     TAG                             ** ENDAR TAG **
     C                     SETOF                     17
     C                     READ SDCURRD0                 70
     C*
     C                     END                             E001
     C                     Z-ADDX         ARINDX  40                                        CRE083BL
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (PROGRAM LEVEL)
     C**
     C*****************************************************************
     C**
     C**   SET UP THE FIELDS COMMON TO ALL POSTINGS RECORDS;
     C**   THESE FIELDS WILL REMAIN THE SAME THROUGHOUT THE PROGRAM
     C**
     C           SETPGM    BEGSR                           *** SETPGM ***
     C*
     C*    Character between Account Sequence fields on narrative.
     C                     MOVE '-'       TIR1
     C                     MOVE '-'       TIR2
     C                     MOVE '-'       TIR3
     C                     MOVE '-'       TIR4
     C*    ACCOUNT SEQUENCE
     C                     MOVE '01'      ACS00
     C*    RETAIL A/C NO
     C                     Z-ADD0         RAN00  100
     C*    POSTING DATE
     C                     Z-ADDRUND      PSD00
     C*    VALUE DATE
     C                     Z-ADDRUND      VLD00
     C*    CHEQUE NO
     C                     Z-ADD0         CQN00   80
     C*    RETAIL INDICATOR
     C                     Z-ADD0         RET00   10
     C*    REJECT CODE
     C                     Z-ADD0         REJ00   20
     C*    RELATIVE RECORD NO OF MEMO
     C                     Z-ADD0         RRN00   50
     C*    ACCUMULATOR
     C                     Z-ADD0         ACM00   10
     C*    DEALT/BORROWER CUSTOMER NO
     C**********           Z-ADD0         DBC00   60                                          CSD027
     C                     MOVE *BLANKS   DBC00   6                                           CSD027
     C*
     C**  Management Accounting fields, VOIN to CHGA
     C*
     C*    Void indicator
     C                     Z-ADD0         VOIN    10
     C*    Posting time
     C                     Z-ADD235959    PTIM    60
     C*    Start of day ledger balance
     C                     Z-ADD0         SDLB   150
     C*    Start of day cleared balance
     C                     Z-ADD0         SDCB   150
     C*    Profit centre
     C                     MOVE *BLANKS   PRFC    4
     C*    Book code
     C                     MOVE *BLANKS   BOKC    2
     C*    Original transaction type
     C                     MOVE *BLANKS   OTTP   10
     C                     MOVEL'91050'   OTTP
     C*    Number of items
     C                     Z-ADD0         NITMS   50
     C*    Charge amount
     C                     Z-ADD0         CHGA   130
     C*    Input document number
     C                     MOVE *BLANKS   IPDN    6
     C*    Message generation transaction
     C                     MOVE *BLANKS   MGTT    3
     C*    Late accrual indicator
     C                     Z-ADD0         LTAI    10
     C*    Retail input number
     C                     MOVE *BLANKS   RINO    6
     C*    Original transaction reference
     C**********           MOVE *BLANKS   OTRF   15                                           CGL029
     C                     MOVE *BLANKS   OTRFQQ 15                                           CGL029
     C                     MOVE *BLANKS   OTRF   21                                           CGL029
     C*    Original transaction sub-type
     C                     MOVE *BLANKS   OTST   10
     C*    Rebatable indicator
     C                     MOVE *BLANKS   REBI    1
     C*                                                                   095810
     C** 095810: add the Retail Teller System fields; the absence of the  095810
     C** numeric one was causing a problem; all have been included for    095810
     C** completeness.                                                    095810
     C*                                                                   095810
     C** Teller input indicator                                           095810
     C                     MOVE *BLANKS   TLIN    1                       095810
     C*                                                                   095810
     C** Transacrion currency                                             095810
     C                     MOVE *BLANKS   TRCCY   3                       095810
     C*                                                                   095810
     C** Account subtype                                                  095810
     C                     MOVE *BLANKS   STYP    1                       095810
     C*                                                                   095810
     C** Cheque indicator/reveral indicator                               095810
     C                     MOVE *BLANKS   CQRI    1                       095810
     C*                                                                   095810
     C** Passbook transaction type                                        095810
     C                     MOVE *BLANKS   PBTT    2                       095810
     C*                                                                   095810
     C** Origintating branch                                              095810
     C                     MOVE *BLANKS   ORBR    3                       095810
     C*                                                                   095810
     C** Original amount - giro                                           095810
     C                     Z-ADD*ZERO     ORAMT  130                      095810
     C*
     C** Extension File Reference ID                                      149069
     C                     MOVEL*BLANKS   XRFI    3                       149069
     C*                                                                   149069
     C** Extension File Reference Number                                  149069
     C                     Z-ADD*ZERO     XRFN   100                      149069
     C*                                                                   149069
     C*    ACCOUNT TYPE OF COMPUTER SUSPENSE A/C CODE
     C*
     C                     MOVE COMS      @KEYC
     C                     MOVE @KEYC     AKEY                                              CRE083BL
     C                     EXSR ACCHKA                                                      CRE083BL
      *                                                                                     CRE083BL
     C           FOIC      IFEQ 'Y'                                                         CRE083BL
     C                     MOVE CCSC,B    ACSC                                              CRE083BL
     C                     MOVE CTYP,B    ATYP                                              CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AOACODR0'#AACOD
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDACODPD'DBFILE           ************
     C                     MOVELCOMS      DBKEY            * DBERR 22 *
     C                     Z-ADD22        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     ELSE                                                             CRE083BL
     C                     EXSR ACADDA                                                      CRE083BL
     C                     END
     C                     ENDIF                                                            CRE083BL
     C                     MOVE ATYP      COMSAT
     C*
     C*    ACCOUNT TYPE OF SPOT TRADE EQ. A/C CODE FROM ICD
     C*
     C                     MOVE SPAC      @KEYC
     C                     MOVE @KEYC     AKEY                                              CRE083BL
     C                     EXSR ACCHKA                                                      CRE083BL
      *                                                                                     CRE083BL
     C           FOIC      IFEQ 'Y'                                                         CRE083BL
     C                     MOVE CCSC,B    ACSC                                              CRE083BL
     C                     MOVE CTYP,B    ATYP                                              CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AOACODR0'#AACOD
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDACODPD'DBFILE           ************
     C                     MOVELSPAC      DBKEY            * DBERR 26 *
     C                     Z-ADD26        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     ELSE                                                             CRE083BL
     C                     EXSR ACADDA                                                      CRE083BL
     C                     END
     C                     ENDIF                                                            CRE083BL
     C                     MOVE ATYP      SPACAT
     C*
     C*    ACCOUNT TYPE OF A/C CODE FOR BASE CCY
     C*
     C   30                DO                              B001
     C                     MOVE BASEAC    @KEYC
     C                     MOVE @KEYC     AKEY                                              CRE083BL
     C                     EXSR ACCHKA                                                      CRE083BL
      *                                                                                     CRE083BL
     C           FOIC      IFEQ 'Y'                                                         CRE083BL
     C                     MOVE CCSC,B    ACSC                                              CRE083BL
     C                     MOVE CTYP,B    ATYP                                              CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AOACODR0'#AACOD
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDACODPD'DBFILE           ************
     C                     MOVELBASEAC    DBKEY            * DBERR 28 *
     C                     Z-ADD28        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     ELSE                                                             CRE083BL
     C                     EXSR ACADDA                                                      CRE083BL
     C                     END
     C                     ENDIF                                                            CRE083BL
     C                     MOVE ATYP      BASEAT
     C                     END                             E001
     C*
     C** SET DEFAULT NARRATIVE
     C*
     C**  BJLANG retained for future use
     C*
     C                     MOVE BJLANG    BJLANG  2
     C                     MOVE BJLANG    LLGID
     C                     MOVE BJLANG    WLGID
     C           BJLANG    IFEQ *BLANKS
     C                     MOVE 'GB'      LLGID
     C                     MOVE 'GB'      WLGID
     C                     END
     C                     MOVE '90'      LRECT
     C*
     C** ACCESS FIXED COMMISSION NARRATIVE
     C*
     C**********           MOVE 'R3'      LNARC                           CDE002
     C                     MOVE 'RC'      LNARC                           CDE002
     C                     MOVEL'FIXED CO'NAR,1
     C                     MOVE 'M.     ' NAR,1
     C                     MOVEL'FIX COM' DN07,1
     C/COPY WNCPYSRC,RE3116C065
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,1                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,1     NR30,1                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B1
     C                     MOVELNARD      NR30,1
     C                     ELSE                            - X1
     C                     MOVELNAR,1     NR30,1
     C                     END                             - E1
     C                     ENDIF                                                            CRE083BL
      *                                                                   S01522
      **  Set up Narrative message: rightmost byte blank                  S01522
     C                     MOVEL'GB0030'  MGID,1    P                     S01522
     C*
     C** ACCESS A/C COMMISSIOON NARRATIVE
     C*
     C**********           MOVE 'R5'      LNARC                           CDE002
     C                     MOVE 'RD'      LNARC                           CDE002
     C                     MOVEL'A/C COM.'NAR,2
     C                     MOVE '       ' NAR,2
     C                     MOVEL'A/C COM' DN07,2
     C/COPY WNCPYSRC,RE3116C066
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,2                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,2     NR30,2                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B1
     C                     MOVELNARD      NR30,2
     C                     ELSE                            - X1
     C                     MOVELNAR,2     NR30,2
     C                     END                             - E1
     C                     ENDIF                                                            CRE083BL
      *                                                                   S01522
      **  Set up Narrative message: rightmost byte blank                  S01522
     C                     MOVEL'GB0031'  MGID,2    P                     S01522
     C*
     C** ACCESS DEBIT INTEREST COMMISSION NARRATIVE
     C*
     C**********           MOVE 'R6'      LNARC                           CDE002
     C                     MOVE 'RE'      LNARC                           CDE002
     C                     MOVEL'DR INT. 'NAR,3
     C                     MOVE 'COM    ' NAR,3
     C                     MOVEL'INT.COM' DN07,3
     C/COPY WNCPYSRC,RE3116C067
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,3                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,3     NR30,3                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B1
     C                     MOVELNARD      NR30,3
     C                     ELSE                            - X1
     C                     MOVELNAR,3     NR30,3
     C                     END                             - E1
     C                     ENDIF                                                            CRE083BL
      *                                                                   S01522
      **  Set up Narrative message: rightmost byte blank                  S01522
     C                     MOVEL'GB0032'  MGID,3    P                     S01522
     C*
     C** ACCESS HIGHEST OVERDRAFT COMMISSION NARRATIVE
     C*
     C                     MOVE 'R7'      LNARC
     C                     MOVEL'DR H/O  'NAR,4
     C                     MOVE 'COM    ' NAR,4
     C                     MOVEL'H/O COM' DN07,4
     C*
     C/COPY WNCPYSRC,RE3116C068
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,4                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,4     NR30,4                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B1
     C                     MOVELNARD      NR30,4
     C                     ELSE                            - X1
     C                     MOVELNAR,4     NR30,4
     C                     END                             - E1
     C                     ENDIF                                                            CRE083BL
      *                                                                   S01522
      **  Set up Narrative message: rightmost byte blank                  S01522
     C                     MOVEL'GB0033'  MGID,4    P                     S01522
     C*
     C*
     C** ACCESS COMMISSION ON INACTIVE ACCOUNT NARRATIVE
     C*
     C                     MOVE 'R8'      LNARC
     C                     MOVEL'INACT. C'NAR,5
     C                     MOVE 'OM.    ' NAR,5
     C                     MOVEL'INACT C' DN07,5
     C/COPY WNCPYSRC,RE3116C069
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,5                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,5     NR30,5                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B1
     C                     MOVELNARD      NR30,5
     C                     ELSE                            - X1
     C                     MOVELNAR,5     NR30,5
     C                     END                             - E1
     C                     ENDIF                                                            CRE083BL
      *                                                                   S01522
      **  Set up Narrative message: rightmost byte blank                  S01522
     C                     MOVEL'GB0034'  MGID,5    P                     S01522
     C*
     C*
     C** ACCESS COMMISION ON MINIMUM BALANCE NARRATIVE
     C*
     C                     MOVE 'R9'      LNARC
     C                     MOVEL'MIN BAL 'NAR,6
     C                     MOVE 'COM    ' NAR,6
     C                     MOVEL'MIN BAL' DN07,6
     C/COPY WNCPYSRC,RE3116C070
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,6                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,6     NR30,6                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B1
     C                     MOVELNARD      NR30,6
     C                     ELSE                            - X1
     C                     MOVELNAR,6     NR30,6
     C                     END                             - E1
     C                     ENDIF                                                            CRE083BL
      *                                                                   S01522
      **  Set up Narrative message: rightmost byte blank                  S01522
     C                     MOVEL'GB0035'  MGID,6    P                     S01522
     C*
     C*
     C** ACCESS CHARGE ON NUMBER OF DAILY STATEMENTS
     C*
     C                     MOVE 'RA'      LNARC
     C                     MOVEL'EXTRA ST'NAR,8
     C                     MOVE 'MT COM.' NAR,8
     C                     MOVEL'EX.STMT' DN07,8
     C/COPY WNCPYSRC,RE3116C071
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,8                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,8     NR30,8                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B1
     C                     MOVELNARD      NR30,8
     C                     ELSE                            - X1
     C                     MOVELNAR,8     NR30,8
     C                     END                             - E1
     C                     ENDIF                                                            CRE083BL
      *                                                                   S01522
      **  Set up Narrative message: rightmost byte blank                  S01522
     C                     MOVEL'GB0036'  MGID,8    P                     S01522
     C*
     C*
     C** ACCESS TVA ON COMMISSION NARRATIVE
     C*
     C                     MOVE 'R0'      LNARC
     C                     MOVEL'** VAT *'NAR,7
     C                     MOVE '*      ' NAR,7
     C                     MOVEL'**VAT**' DN07,7
     C/COPY WNCPYSRC,RE3116C072
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,7                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,7     NR30,7                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B1
     C                     MOVELNARD      NR30,7
     C                     ELSE                            - X1
     C                     MOVELNAR,7     NR30,7
     C                     END                             - E1
     C                     ENDIF                                                            CRE083BL
      *                                                                   S01522
      **  Set up Narrative message: rightmost byte blank                  S01522
     C                     MOVEL'GB0037'  MGID,7    P                     S01522
     C*
     C/COPY WNCPYSRC,RE3116C044
     C                     ENDSR
     C*
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   P R O G R A M - D E F I N E D   F I E L D S
     C**
     C*****************************************************************
     C           PGFLDS    BEGSR                           *** PGFLDS ***
     C*
     C           *LIKE     DEFN ACNO      ACNOO
     C*
     C           *LIKE     DEFN CNUM      ACN00
     C           *LIKE     DEFN CNUM      ACN01
     C           *LIKE     DEFN CNUM      CNM00
     C           *LIKE     DEFN CNUM      CNM01
     C           *LIKE     DEFN CNUM      CNM02
     C           *LIKE     DEFN CNUM      CNM03
     C           *LIKE     DEFN CNUM      CNM04
     C           *LIKE     DEFN CNUM      CNM05
     C           *LIKE     DEFN CNUM      CNM06
     C           *LIKE     DEFN CNUM      CNM07
     C           *LIKE     DEFN CNUM      CNM08
     C           *LIKE     DEFN CNUM      CNM09
     C           *LIKE     DEFN CNUM      CNM10
     C           *LIKE     DEFN CNUM      CNM11
     C           *LIKE     DEFN CNUM      CNM12
     C           *LIKE     DEFN CNUM      CNUMO
     C*
     C           *LIKE     DEFN ACSQ      ACSQO
     C           *LIKE     DEFN ACSQ      ACS00
     C           *LIKE     DEFN ACSQ      ACS01
     C*
     C           *LIKE     DEFN ATYP      ATP01
     C           *LIKE     DEFN ATYP      ATP01A
     C           *LIKE     DEFN ATYP      ATP02
     C           *LIKE     DEFN ATYP      ATP03
     C           *LIKE     DEFN ATYP      ATP04
     C           *LIKE     DEFN ATYP      ATP05
     C           *LIKE     DEFN ATYP      ATP06
     C           *LIKE     DEFN ATYP      ATP07
     C           *LIKE     DEFN ATYP      ATP08
     C           *LIKE     DEFN ATYP      ATP09
     C           *LIKE     DEFN ATYP      ATP10
     C           *LIKE     DEFN ATYP      ATP11
     C           *LIKE     DEFN ATYP      ATP12
     C           *LIKE     DEFN ATYP      BASEAT
     C           *LIKE     DEFN ATYP      SPACAT
     C           *LIKE     DEFN ATYP      COMSAT
     C*
     C           *LIKE     DEFN ACOD      ACDO
     C           *LIKE     DEFN ACOD      ACD01
     C           *LIKE     DEFN ACOD      ACD01A
     C           *LIKE     DEFN ACOD      ACD02
     C           *LIKE     DEFN ACOD      ACD03
     C           *LIKE     DEFN ACOD      ACD04
     C           *LIKE     DEFN ACOD      ACD05
     C           *LIKE     DEFN ACOD      ACD06
     C           *LIKE     DEFN ACOD      ACD07
     C           *LIKE     DEFN ACOD      ACD08
     C           *LIKE     DEFN ACOD      ACD09
     C           *LIKE     DEFN ACOD      ACD10
     C           *LIKE     DEFN ACOD      ACD11
     C           *LIKE     DEFN ACOD      ACD12
     C           *LIKE     DEFN ACOD      BASEAC
     C           *LIKE     DEFN ACOD      WAIBFR
     C           *LIKE     DEFN ACOD      WAIBTO
     C           *LIKE     DEFN ACOD      WDIBFR
     C           *LIKE     DEFN ACOD      WDIBTO
     C           *LIKE     DEFN ACOD      WDDIFR                                              B11353
     C           *LIKE     DEFN ACOD      WDDITO                                              B11353
     C           *LIKE     DEFN ACOD      WADIFR                                              B11353
     C           *LIKE     DEFN ACOD      WADITO                                              B11353
     C*
     C           *LIKE     DEFN CCY       CCYO
     C           *LIKE     DEFN CCY       CCY01
     C           *LIKE     DEFN CCY       CCY01A
     C           *LIKE     DEFN CCY       CCY02
     C           *LIKE     DEFN CCY       CCY03
     C           *LIKE     DEFN CCY       CCY04
     C           *LIKE     DEFN CCY       CCY05
     C           *LIKE     DEFN CCY       CCY06
     C           *LIKE     DEFN CCY       CCY07
     C           *LIKE     DEFN CCY       CCY08
     C           *LIKE     DEFN CCY       CCY09
     C           *LIKE     DEFN CCY       CCY10
     C           *LIKE     DEFN CCY       CCY11
     C           *LIKE     DEFN CCY       CCY12
     C*
     C           *LIKE     DEFN DCI01     DCI01A
     C           *LIKE     DEFN DCI01     DCI02
     C           *LIKE     DEFN DCI01     DCI03
     C           *LIKE     DEFN DCI01     DCI04
     C           *LIKE     DEFN DCI01     DCI05
     C           *LIKE     DEFN DCI01     DCI06
     C           *LIKE     DEFN DCI01     DCI07
     C           *LIKE     DEFN DCI01     DCI08
     C           *LIKE     DEFN DCI01     DCI09
     C           *LIKE     DEFN DCI01     DCI10
     C           *LIKE     DEFN DCI01     DCI11
     C           *LIKE     DEFN DCI01     DCI12
     C*
     C           *LIKE     DEFN ACCC      PAMT
     C           *LIKE     DEFN ACCC      PAMTCV
     C           *LIKE     DEFN ACCC      PAMTCA
     C           *LIKE     DEFN ACCC      PAM01
     C           *LIKE     DEFN ACCC      PAM01A
     C           *LIKE     DEFN ACCC      PAM02
     C           *LIKE     DEFN ACCC      PAM03
     C           *LIKE     DEFN ACCC      PAM04
     C           *LIKE     DEFN ACCC      PAM05
     C           *LIKE     DEFN ACCC      PAM06
     C           *LIKE     DEFN ACCC      PAM07
     C           *LIKE     DEFN ACCC      PAM08
     C           *LIKE     DEFN ACCC      PAM09
     C           *LIKE     DEFN ACCC      PAM10
     C           *LIKE     DEFN ACCC      PAM11
     C           *LIKE     DEFN ACCC      PAM12
     C*
     C           *LIKE     DEFN RUND      PSD00
     C           *LIKE     DEFN RUND      VLD00
     C           *LIKE     DEFN RUND      VLD01
     C           *LIKE     DEFN RUND      VLDOU                           119348
     C*
     C           *LIKE     DEFN BRCA      WABRCD
     C           *LIKE     DEFN BRCA      WADBRC
     C           *LIKE     DEFN BRCA      WDBRCD
     C           *LIKE     DEFN BRCA      WDDBRC
     C           *LIKE     DEFN BRCA      WHDBRC
     C           *LIKE     DEFN BRCA      BRC00
     C           *LIKE     DEFN BRCA      BRC01
     C           *LIKE     DEFN BRCA      BRC01A
     C           *LIKE     DEFN BRCA      BRC02
     C           *LIKE     DEFN BRCA      BRC03
     C           *LIKE     DEFN BRCA      BRC04
     C           *LIKE     DEFN BRCA      BRC05
     C           *LIKE     DEFN BRCA      BRC06
     C           *LIKE     DEFN BRCA      BRC07
     C           *LIKE     DEFN BRCA      BRC08
     C           *LIKE     DEFN BRCA      BRC09
     C           *LIKE     DEFN BRCA      BRC10
     C           *LIKE     DEFN BRCA      BRC11
     C           *LIKE     DEFN BRCA      BRC12
     C*
     C           *LIKE     DEFN HOCO      WACMPY
     C           *LIKE     DEFN HOCO      WDCMPY
     C           *LIKE     DEFN HOCO      WHCMPY
     C*
     C           *LIKE     DEFN BICN      WABICN
     C           *LIKE     DEFN BICN      WADBIC
     C*********  *LIKE     DEFN BICN      WADIFR                                              B11353
     C*********  *LIKE     DEFN BICN      WADITO                                              B11353
     C           *LIKE     DEFN BICN      WADIBH
     C           *LIKE     DEFN BICN      WAIBAB
     C           *LIKE     DEFN BICN      WBICN
     C           *LIKE     DEFN BICN      WDBICN
     C           *LIKE     DEFN BICN      WDDBIC
     C*********  *LIKE     DEFN BICN      WDDIFR                                              B11353
     C*********  *LIKE     DEFN BICN      WDDITO                                              B11353
     C           *LIKE     DEFN BICN      WDDIBH
     C           *LIKE     DEFN BICN      WDIBAB
     C*
     C           *LIKE     DEFN LGID      WLGID
     C*
     C/COPY WNCPYSRC,RE3116C020
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   M U L T I - B R A N C H   P R O C E S S I N G
     C**
     C*****************************************************************
     C           MULTBR    BEGSR                           *** MULTBR ***
     C*
     C*    'ORIGINAL' BRANCH CODE
     C                     MOVE CBRCA     WABRCD
     C*    ALTERNATE A/C BRANCH CODE
     C                     MOVE BRCDA     WDBRCD
     C**
     C**   IF BRANCH CODES DIFFER OR CCY'S DIFFER THEN
     C**   MULTIBRANCH POSTINGS WILL BE REQUIRED
     C**
     C           WDBRCD    IFNE WABRCD                     B001
     C           *IN40     OREQ '1'
     C**
     C**   FIRST WE SET UP THE MULTIBRANCH BITS FOR THE ORIGINAL A/C
     C**
     C*
     C**   Access Branch Details
     C*
     C                     MOVE WABRCD    @BRCH
     C                     Z-ADDBINDX     A                                                 CRE083BL
     C           @BRCH     LOKUPBRCH,A                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           A         OCUR SDBRCH                                                      CRE083BL
     C                     MOVE *BLANKS   @RTCD                                             MD021155
     C                     ELSE                                                             CRE083BL
     C           1         OCUR SDBRCH                                                      MD021155
     C**********           CALL 'AOBRCHR0'#ABRCH                                              CGL029
     C                     CALL 'AOBRCHR1'#ABRCH                                              CGL029
     C                     ENDIF                                                            MD021155
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDBRCHPD'DBFILE           ************
     C                     MOVELWABRCD    DBKEY            * DBERR 35 *
     C                     Z-ADD35        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C**********           ENDIF                                                   CRE083BL MD021155
     C*
     C                     MOVE BICN      WABICN
     C                     MOVE ADFAC2    WAIBFR
     C                     MOVE ADTAC2    WAIBTO
     C*
     C**
     C**   THEN WE SET UP THE MULTIBRANCH BITS FOR THE ALTERNATE A/C
     C**
     C*
     C**   Access Branch Details
     C*
     C                     MOVE WDBRCD    @BRCH
     C                     Z-ADDBINDX     A                                                 CRE083BL
     C           @BRCH     LOKUPBRCH,A                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           A         OCUR SDBRCH                                                      CRE083BL
     C                     MOVE *BLANKS   @RTCD                                             MD021155
     C                     ELSE                                                             CRE083BL
     C           1         OCUR SDBRCH                                                      MD021155
     C**********           CALL 'AOBRCHR0'#ABRCH                                              CGL029
     C                     CALL 'AOBRCHR1'#ABRCH                                              CGL029
     C                     ENDIF                                                            MD021155
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDBRCHPD'DBFILE           ************
     C                     MOVELWDBRCD    DBKEY            * DBERR 17 *
     C                     Z-ADD17        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C**********           ENDIF                                                   CRE083BL MD021155
     C*
     C                     MOVE BICN      WDBICN
     C                     MOVE ADFAC2    WDIBFR
     C                     MOVE ADTAC2    WDIBTO
     C*
     C                     MOVE *BLANKS   ZTABKY
     C                     MOVEL'01'      ZTABKY
     C*
     C                     END                             E001
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (COMMISSION LEVEL)
     C**
     C*****************************************************************
     C**
     C**   SET UP THOSE FIELDS WHICH ARE TO REMAIN THE SAME FOR
     C**   ALL POSTINGS GENERATED FOR ANY ONE COMMISSION
     C**
     C           SETCOM    BEGSR                           ***SETCOM ***
     C*
     C** SET NARRATIVE FOR MULTILANGUAGE FOLLOWING LGID
     C*
     C           LGID      IFEQ *BLANKS                    - B1
     C                     MOVE BJLANG    LGID
     C           BJLANG    IFEQ *BLANKS
     C                     MOVE 'GB'      LGID
     C                     END
     C                     END                             - E1
     C*
     C** SETUP KEY
     C*
     C                     MOVE LGID      LLGID
     C*
     C** PROCESS ONLY IF CHANGE OF LANGUAGE CODE
     C*
     C           LLGID     IFNE WLGID                      - B1
     C                     MOVE LLGID     WLGID
     C/COPY WNCPYSRC,RE3116C045
     C*
     C** ACCESS FIXED COMMISSION NARRATIVE
     C*
     C**********           MOVE 'R3'      LNARC                           CDE002
     C                     MOVE 'RC'      LNARC                           CDE002
     C/COPY WNCPYSRC,RE3116C073
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,1                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,1     NR30,1                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B2
     C                     MOVELNARD      NR30,1
     C                     ELSE                            - X2
     C                     MOVELNAR,1     NR30,1
     C                     END                             - E2
     C                     ENDIF                                                            CRE083BL
     C*
     C** ACCESS A/C COMMISSION NARRATIVE
     C*
     C**********           MOVE 'R5'      LNARC                           CDE002
     C                     MOVE 'RD'      LNARC                           CDE002
     C/COPY WNCPYSRC,RE3116C074
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,2                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,2     NR30,2                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B2
     C                     MOVELNARD      NR30,2
     C                     ELSE                            - X2
     C                     MOVELNAR,2     NR30,2
     C                     END                             - E2
     C                     ENDIF                                                            CRE083BL
     C*
     C** ACCESS DEBIT INTEREST COMMISSION NARRATIVE
     C*
     C**********           MOVE 'R6'      LNARC                           CDE002
     C                     MOVE 'RE'      LNARC                           CDE002
     C/COPY WNCPYSRC,RE3116C075
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,3                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,3     NR30,3                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B2
     C                     MOVELNARD      NR30,3
     C                     ELSE                            - X2
     C                     MOVELNAR,3     NR30,3
     C                     END                             - E2
     C                     ENDIF                                                            CRE083BL
     C*
     C** ACCESS HIGHEST OVERDRAFT COMMISSION NARRATIVE
     C*
     C                     MOVE 'R7'      LNARC
     C/COPY WNCPYSRC,RE3116C076
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,4                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,4     NR30,4                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B2
     C                     MOVELNARD      NR30,4
     C                     ELSE                            - X2
     C                     MOVELNAR,4     NR30,4
     C                     END                             - E2
     C                     ENDIF                                                            CRE083BL
     C*
     C*
     C** ACCESS COMMISSION ON INACTIVE ACCOUNT NARRATIVE
     C*
     C                     MOVE 'R8'      LNARC
     C/COPY WNCPYSRC,RE3116C077
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,5                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,5     NR30,5                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B2
     C                     MOVELNARD      NR30,5
     C                     ELSE                            - X2
     C                     MOVELNAR,5     NR30,5
     C                     END                             - E2
     C                     ENDIF                                                            CRE083BL
     C*
     C*
     C** ACCESS COMMISION ON MINIMUM BALANCE NARRATIVE
     C*
     C                     MOVE 'R9'      LNARC
     C/COPY WNCPYSRC,RE3116C078
     C*
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,6                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,6     NR30,6                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B2
     C                     MOVELNARD      NR30,6
     C                     ELSE                            - X2
     C                     MOVELNAR,6     NR30,6
     C                     END                             - E2
     C                     ENDIF                                                            CRE083BL
     C*
     C*
     C** ACCESS CHARGE ON NUMBER OF DAILY STATEMENTS
     C*
     C                     MOVE 'RA'      LNARC
     C*
     C/COPY WNCPYSRC,RE3116C079
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,8                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,8     NR30,8                                            CRE083BL
     C                     END                                                              CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B2
     C                     MOVELNARD      NR30,8
     C                     ELSE                            - X2
     C                     MOVELNAR,8     NR30,8
     C                     END                             - E2
     C                     ENDIF                                                            CRE083BL
     C*
     C*
     C** ACCESS TVA ON COMMISSION NARRATIVE
     C*
     C                     MOVE 'R0'      LNARC
     C*
     C/COPY WNCPYSRC,RE3116C080
     C                     MOVE LNARC     @NVCD
     C                     Z-ADD1         C                                                 CRE083BL
     C           @NVCD     LOKUPANAR,C                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C           ANRD,C    IFNE *BLANKS                                                     CRE083BL
     C                     MOVE ANRD,C    NR30,1                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     MOVELNAR,7     NR30,7                                            CRE083BL
     C                     ENDIF                                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AONARRR0'#ANARR
     C*
     C           @RTCD     IFEQ *BLANKS                    - B2
     C                     MOVELNARD      NR30,7
     C                     ELSE                            - X2
     C                     MOVELNAR,7     NR30,7
     C                     END                             - E2
     C                     ENDIF                                                            CRE083BL
     C/COPY WNCPYSRC,RE3116C046
     C*
     C                     END                             - E1
     C*
     C*    CUSTOMER NO.
     C                     MOVE WBICN     CNM00
     C*    NARRATIVE
     C           RACN      IFEQ 'Y'                        Retail no. used
     C                     MOVE *BLANKS   KEY00
     C                     MOVE *BLANKS   KEY23
     C                     MOVE WWACNO    KEY00  15
     C*
     C*    POSITION RETAIL NO. CENTRALLY WITHIN KEY23 TEXT
     C*
     C                     MOVE KEY00     KEY18  18
     C**********           MOVELKEY18     KEY23  23                                           CGL029
     C                     MOVELKEY18     KEY23  29                                           CGL029
     C*
     C                     ELSE
     C                     MOVE CCNUM     DSNAR1
     C                     MOVE CCCY      DSNAR2
     C                     MOVE CACOD     DSNAR3
     C                     MOVE CACSQ     DSNAR4
     C                     MOVE CBRCA     DSNAR5
     C                     MOVE DSNARR    KEY23
     C                     END
     C*
     C*    POSTING AMOUNT DR/CR INDICATOR
     C           PAMT      COMP 0                    72
     C   72                Z-ADD0         DCDR1   10
     C   72                Z-ADD1         DCDR2   10
     C  N72                Z-ADD1         DCDR1
     C  N72                Z-ADD0         DCDR2
     C  N72                Z-SUBPAMT      PAMT
     C*
     C*    ASSOCIATE CUST NO.
     C**********           Z-ADDCCNUM     ACN00                                               CSD027
     C                     MOVE CCNUM     ACN00                                               CSD027
     C*    BRANCH CODE
     C                     MOVE CBRCA     BRC00
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 01)
     C**
     C*****************************************************************
     C           SET01     BEGSR                           *** SET01 ***
     C*
     C*    CUSTOMER NUMBER
     C**N39*****           Z-ADDCCNUM     CNM01                                               CSD027
     C***39*****           Z-ADDCNUMO     CNM01                                               CSD027
     C  N39                MOVE CCNUM     CNM01                                               CSD027
     C   39                MOVE CNUMO     CNM01                                               CSD027
     C/COPY WNCPYSRC,RE3116C021
     C*    CURRENCY CODE
     C  N39
     COR 39 29             MOVE CCCY      CCY01
     C   39N29             MOVE CCYO      CCY01
     C*    ACCOUNT CODE
     C  N39                Z-ADDCACOD     ACD01
     C   39                Z-ADDACDO      ACD01
     C/COPY WNCPYSRC,RE3116C022
     C*    ACCOUNT SEQUENCE NO.
     C  N39                MOVE CACSQ     ACS01
     C   39                MOVE ACSQO     ACS01
     C/COPY WNCPYSRC,RE3116C023
     C*    RETAIL A/C NO.
     C  N39                Z-ADDACNO      RAN01  100
     C   39                Z-ADDACNOO     RAN01
     C*    POSTING AMOUNT
     C  N40                Z-ADDPAMT      PAM01
     C   40                Z-ADDPAMTCA    PAM01
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR1     DCI01   10
     C*    ASSOCIATE CUSTOMER NO.
     C**********           Z-ADD0         ACN01                                               CSD027
     C***39*****           Z-ADDCCNUM     ACN01                                               CSD027
     C                     MOVE *BLANKS   ACN01                                               CSD027
     C   39                MOVE CCNUM     ACN01                                               CSD027
     C*    BRANCH CODE
     C                     MOVE BRC00     BRC01
     C   39 31             MOVE WDBRCD    BRC01
     C*    RETAIL INDICATOR
     C/COPY WNCPYSRC,RE3116C024
     C*    ACCOUNT TYPE
     C*
     C                     MOVELACD01     @KEYC
     C                     MOVE @KEYC     AKEY                                              CRE083BL
     C                     EXSR ACCHKA                                                      CRE083BL
      *                                                                                     CRE083BL
     C           FOIC      IFEQ 'Y'                                                         CRE083BL
     C                     MOVE CCSC,B    ACSC                                              CRE083BL
     C                     MOVE CTYP,B    ATYP                                              CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AOACODR0'#AACOD
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDACODPD'DBFILE           ************
     C                     MOVELACD01     DBKEY            * DBERR 25 *
     C                     Z-ADD25        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     ELSE                                                             CRE083BL
     C                     EXSR ACADDA                                                      CRE083BL
     C                     END
     C                     ENDIF                                                            CRE083BL
     C*
     C/COPY WNCPYSRC,RE3116C025
     C                     MOVE ATYP      ATP01
     C           ATYP      IFEQ 'R'
     C                     MOVE '1'       RET01   10
     C                     ELSE
     C                     MOVE '0'       RET01
     C                     END
     C*
     C*    VALUE DATE
     C*       (DR CAPITALISATION DUE)
     C   41
     COR 42 35
     COR 48 35
     COR 47 35
     COR 43
     COR 44                Z-ADDLDID      VLD01
     C*       (CR CAPITALISATION DUE)
     C   42 34
     COR 48 34
     COR 47 34
     COR 45
     COR 46                Z-ADDLCID      VLD01
      *                                                                                       199706
      ** Use Credit Capitalisation date for fixed commission                                  199706
      *                                                                                       199706
     C           *IN41     IFEQ '1'                                                           199706
     C                     Z-ADDLCID      VLD01                                               199706
     C                     ENDIF                                                              199706
     C*
     C           LDAC      IFNE 'Y'                        B001
     C                     ADD  1         VLD01
     C                     END                             E001
     C*
     C           ATP01     IFNE 'R'                        B001
     C                     Z-ADDRUND      VLD01
     C                     END                             E001
     C*
     C**  Set up Account section
     C*
     C**********           MOVELACD01     @ACOD   4                                           CGL029
     C                     MOVELACD01     @ACOD  10                                           CGL029
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC01  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC01     CPBRC
     C**********           Z-ADDCNM01     CPCNM                                               CSD027
     C                     MOVE CNM01     CPCNM                                               CSD027
     C                     MOVELCCY01     CPCCY
     C                     Z-ADDACD01     CPACD
     C                     MOVELACS01     CPACS
     C*                                                                   S01522
     C                     MOVE RAN01     ##RACN                          S01522
     C                     MOVE ACN01     ##ASOC                          S01522
      *                                                                   170507
      ** Save the account number, and then ensure that the originating    170507
      ** account number is put out on the narrative, if an alternate      170507
      ** account is used. *IN39 used to indicate alternate a/c to         170507
      ** post charges.                                                    170507
     C           *LIKE     DEFN ##RACN    WACUST                          170507
     C           *LIKE     DEFN ##RACN    WCUST2                          170507
     C           *IN39     IFEQ '1'                                       170507
     C                     MOVEL##RACN    WACUST    P                     170507
     C                     MOVELWCUST2    ##RACN    P                     170507
     C                     ENDIF                                          170507
     C*
     C                     EXSR SUBNAR
      *                                                                   170507
      ** Restore the variable.                                            170507
     C           *IN39     IFEQ '1'                                       170507
     C                     MOVELWACUST    ##RACN    P                     170507
     C                     ENDIF                                          170507
     C*                                                                   099081
     C** Get narrative for posting REC01.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV01  30                       099081
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 01A)
     C**
     C*****************************************************************
     C           SET01A    BEGSR                           *** SET01A ***
     C*
     C*    CURRENCY CODE
     C                     MOVE CCCY      CCY01A
     C*    ACCOUNT CODE
     C                     MOVE COMS      ACD01A
     C*    POSTING AMOUNT
     C                     Z-ADDPAMT      PAM01A
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR1     DCI01A
     C*    ACCOUNT TYPE
     C                     MOVE COMSAT    ATP01A
     C*
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD01A    @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC1A  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC00     CPBRC
     C**********           Z-ADDCNM00     CPCNM                                               CSD027
     C                     MOVE CNM00     CPCNM                                               CSD027
     C                     MOVELCCY01A    CPCCY
     C                     Z-ADDACD01A    CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*
     C                     EXSR SUBNAR
     C*                                                                   099081
     C** Get narrative for posting REC01A.                                099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV01A 30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/COPY WNCPYSRC,RE3116C026
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 02)
     C**
     C*****************************************************************
     C           SET02     BEGSR                           *** SET02 ***
     C*
     C*    CUSTOMER NUMBER
     C**********           Z-ADDCNM00     CNM02                                               CSD027
     C                     MOVE CNM00     CNM02                                               CSD027
     C/COPY WNCPYSRC,RE3116C085
     C           CRE100    IFEQ 'Y'                                                           CRE100
     C                     MOVE CCNUM     CNM02                                               CRE100
     C                     ENDIF                                                              CRE100
      * Account Sequence                                                                    MD034990
     C           RETSEQ    IFEQ 'Y'                                                         MD034990
     C                     MOVE CACSQ     ACS00                                             MD034990
     C                     ENDIF                                                            MD034990
     C*    CURRENCY CODE
     C*                    MOVE CCYR      CCY02
     C                     MOVE CCCY      CCY02
     C*
     C*    ACCOUNT CODE
     C**********           Z-ADDCCNUM     CLCNUM                                              CSD027
     C                     MOVE CCNUM     CLCNUM                                              CSD027
     C                     MOVELCLCNUM    #CNUM   6
     C*
     C                     MOVEL#CNUM     @CUST
     C                     CALL 'AOCUSTR0'#ACUST
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDCUSTPD'DBFILE           ************
     C                     MOVEL#CNUM     DBKEY            * DBERR 23 *
     C                     Z-ADD23        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     END
     C*
     C                     MOVELBBCGRP    CUCGRP
     C           CUCGRP    IFEQ *BLANK
     C                     MOVE '1'       CUCGRP
     C                     END
     C*
     C           CTYPNO    OCUR CGPDTA
     C   41                Z-ADDWGRP1     ACD02
     C   42                Z-ADDWGRP2     ACD02
     C   43                Z-ADDWGRP3     ACD02
     C   44                Z-ADDWGRP4     ACD02
     C   45                Z-ADDWGRP5     ACD02
     C   46                Z-ADDWGRP6     ACD02
     C   48                Z-ADDWGRP7     ACD02
     C*** VAT
     C   47                Z-ADDWACTVA    ACD02
     C*
     C*    POSTING AMOUNT
     C                     Z-ADDPAMT      PAM02
     C*
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR2     DCI02
     C*
     C**   ACCOUNT TYPE
     C*
     C                     MOVE ACD02     @KEYC
     C                     MOVE @KEYC     AKEY                                              CRE083BL
     C                     EXSR ACCHKA                                                      CRE083BL
      *                                                                                     CRE083BL
     C           FOIC      IFEQ 'Y'                                                         CRE083BL
     C                     MOVE CCSC,B    ACSC                                              CRE083BL
     C                     MOVE CTYP,B    ATYP                                              CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AOACODR0'#AACOD
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDACODPD'DBFILE           ************
     C                     MOVELACD02     DBKEY            * DBERR 24 *
     C                     Z-ADD24        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     ELSE                                                             CRE083BL
     C                     EXSR ACADDA                                                      CRE083BL
     C                     END
     C                     ENDIF                                                            CRE083BL
     C*
     C                     MOVE ATYP      ATP02
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD02     @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC02  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC00     CPBRC
     C**********           Z-ADDCNM02     CPCNM                                               CSD027
     C                     MOVE CNM02     CPCNM                                               CSD027
     C                     MOVELCCY02     CPCCY
     C                     Z-ADDACD02     CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
      *                                                                   170507
      ** Save the account number, and then ensure that the originating    170507
      ** account number is put out on the narrative, if an alternate      170507
      ** account is used. *IN39 used to indicate alternate a/c to         170507
      ** post charges.                                                    170507
     C           *IN39     IFEQ '1'                                       170507
     C                     MOVEL##RACN    WACUST    P                     170507
     C                     MOVELWCUST2    ##RACN    P                     170507
     C                     ENDIF                                          170507
     C*
     C                     EXSR SUBNAR
      *                                                                   170507
      ** Restore the variable.                                            170507
     C           *IN39     IFEQ '1'                                       170507
     C                     MOVELWACUST    ##RACN    P                     170507
     C                     ENDIF                                          170507
     C*                                                                   099081
     C** Get narrative for posting REC02.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV02  30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 03)
     C**
     C*****************************************************************
     C           SET03     BEGSR                           *** SET03 ***
     C*
     C*    CUSTOMER NUMBER
     C**********           Z-ADDCNM00     CNM03                                               CSD027
     C                     MOVE CNM00     CNM03                                               CSD027
     C   31                MOVE WABICN    CNM03
     C*    CURRENCY CODE
     C                     MOVE CCCY      CCY03
     C*    ACCOUNT CODE
     C                     MOVELSPAC      ACD03
     C*    POSTING AMOUNT
     C                     Z-ADDPAMT      PAM03
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR1     DCI03
     C*    BRANCH CODE
     C                     MOVE BRC00     BRC03
     C   31                MOVE WABRCD    BRC03
     C*    ACCOUNT TYPE
     C                     MOVE SPACAT    ATP03
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD03     @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC03  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC03     CPBRC
     C**********           Z-ADDCNM03     CPCNM                                               CSD027
     C                     MOVE CNM03     CPCNM                                               CSD027
     C                     MOVELCCY03     CPCCY
     C                     Z-ADDACD03     CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*
     C                     EXSR SUBNAR
     C*                                                                   099081
     C** Get narrative for posting REC03.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV03  30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 04)
     C**
     C*****************************************************************
     C           SET04     BEGSR                           *** SET04 ***
     C*
     C*    CUSTOMER NUMBER
     C**********           Z-ADDCNM00     CNM04                                               CSD027
     C                     MOVE CNM00     CNM04                                               CSD027
     C   31                MOVE WABICN    CNM04
     C*    CURRENCY CODE
     C                     MOVE CCYO      CCY04
     C*    ACCOUNT CODE
     C                     MOVELSPAC      ACD04
     C*    POSTING AMOUNT
     C                     Z-ADDPAMTCA    PAM04
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR2     DCI04
     C*    BRANCH CODE
     C                     MOVE BRC00     BRC04
     C   31                MOVE WABRCD    BRC04
     C*
     C**   ACCOUNT TYPE
     C*
     C                     MOVE ACD04     @KEYC
     C                     MOVE @KEYC     AKEY                                              CRE083BL
     C                     EXSR ACCHKA                                                      CRE083BL
      *                                                                                     CRE083BL
     C           FOIC      IFEQ 'Y'                                                         CRE083BL
     C                     MOVE CCSC,B    ACSC                                              CRE083BL
     C                     MOVE CTYP,B    ATYP                                              CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AOACODR0'#AACOD
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDACODPD'DBFILE           ************
     C                     MOVELACD04     DBKEY            * DBERR 30 *
     C                     Z-ADD30        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     ELSE                                                             CRE083BL
     C                     EXSR ACADDA                                                      CRE083BL
     C                     END
     C                     ENDIF                                                            CRE083BL
     C*
     C                     MOVE ATYP      ATP04
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD04     @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC04  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC04     CPBRC
     C**********           Z-ADDCNM04     CPCNM                                               CSD027
     C                     MOVE CNM04     CPCNM                                               CSD027
     C                     MOVELCCY04     CPCCY
     C                     Z-ADDACD04     CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*
     C                     EXSR SUBNAR
     C*                                                                   099081
     C** Get narrative for posting REC04.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV04  30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 05)
     C**
     C*****************************************************************
     C           SET05     BEGSR                           *** SET05 ***
     C*
     C*    CUSTOMER NUMBER
     C**********           Z-ADDCNM00     CNM05                                               CSD027
     C                     MOVE CNM00     CNM05                                               CSD027
     C   31                MOVE WABICN    CNM05
     C*    CURRENCY CODE
     C                     MOVE BCCY      CCY05
     C*    ACCOUNT CODE
     C**********           Z-ADD1         X                                                 CRE083BL
     C                     Z-ADDARINDX    X                                                 CRE083BL
     C           CCCY      LOKUPWCCY,X                   73
     C                     Z-ADDWTAC,X    ACD05
     C*    POSTING AMOUNT
     C  N40                Z-ADDPAMT      PAM05
     C   40                Z-ADDPAMTCV    PAM05
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR2     DCI05
     C*    BRANCH CODE
     C                     MOVE BRC00     BRC05
     C   31                MOVE WABRCD    BRC05
     C*    ACCOUNT TYPE
     C                     MOVE SPACAT    ATP05
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD05     @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC05  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC05     CPBRC
     C**********           Z-ADDCNM05     CPCNM                                               CSD027
     C                     MOVE CNM05     CPCNM                                               CSD027
     C                     MOVELCCY05     CPCCY
     C                     Z-ADDACD05     CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*
     C                     EXSR SUBNAR
     C*                                                                   099081
     C** Get narrative for posting REC05.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV05  30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 06)
     C**
     C*****************************************************************
     C           SET06     BEGSR                           *** SET06 ***
     C*
     C*    CUSTOMER NUMBER
     C**********           Z-ADDCNM00     CNM06                                               CSD027
     C                     MOVE CNM00     CNM06                                               CSD027
     C   31                MOVE WABICN    CNM06
     C*    CURRENCY CODE
     C                     MOVE BCCY      CCY06
     C*    ACCOUNT CODE
     C**********           Z-ADD1         X                                                 CRE083BL
     C                     Z-ADDARINDX    X                                                 CRE083BL
     C           CCYO      LOKUPWCCY,X                   73
     C                     Z-ADDWTAC,X    ACD06
     C*    POSTING AMOUNT
     C  N40                Z-ADDPAMT      PAM06
     C   40                Z-ADDPAMTCV    PAM06
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR1     DCI06
     C*    BRANCH CODE
     C                     MOVE BRC00     BRC06
     C   31                MOVE WABRCD    BRC06
     C*    ACCOUNT TYPE
     C                     MOVE BASEAT    ATP06
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD06     @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC06  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC06     CPBRC
     C**********           Z-ADDCNM06     CPCNM                                               CSD027
     C                     MOVE CNM06     CPCNM                                               CSD027
     C                     MOVELCCY06     CPCCY
     C                     Z-ADDACD06     CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*
     C                     EXSR SUBNAR
     C*                                                                   099081
     C** Get narrative for posting REC06.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV06  30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 07)
     C**
     C*****************************************************************
     C           SET07     BEGSR                           *** SET07 ***
     C*
     C*    CUSTOMER NUMBER
     C                     MOVE WABICN    CNM07
     C*    CURRENCY CODE
     C   40                MOVE CCYO      CCY07
     C  N40                MOVE CCCY      CCY07
     C*    ACCOUNT CODE
     C           DCDR2     IFEQ 0
     C                     MOVE WDDIFR    ACD07
     C                     ELSE
     C                     MOVE WDDITO    ACD07
     C                     END
     C*    POSTING AMOUNT
     C  N40                Z-ADDPAMT      PAM07
     C   40                Z-ADDPAMTCA    PAM07
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR2     DCI07
     C*    BRANCH CODE
     C                     MOVE WADBRC    BRC07
     C*    ACCOUNT TYPE
     C                     MOVE 'G'       ATP07
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD07     @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC07  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC07     CPBRC
     C**********           Z-ADDCNM07     CPCNM                                               CSD027
     C                     MOVE CNM07     CPCNM                                               CSD027
     C                     MOVELCCY07     CPCCY
     C                     Z-ADDACD07     CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*
     C                     EXSR SUBNAR
     C*                                                                   099081
     C** Get narrative for posting REC07.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV07  30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 08)
     C**
     C*****************************************************************
     C           SET08     BEGSR                           *** SET08 ***
     C*
     C*    CUSTOMER NUMBER
     C                     MOVE WDBICN    CNM08
     C*    CURRENCY CODE
     C                     MOVE CCYO      CCY08
     C*    ACCOUNT CODE
     C           DCDR1     IFEQ 0
     C                     MOVE WDDIFR    ACD08
     C                     ELSE
     C                     MOVE WDDITO    ACD08
     C                     END
     C*    POSTING AMOUNT
     C  N40                Z-ADDPAMT      PAM08
     C   40                Z-ADDPAMTCA    PAM08
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR1     DCI08
     C*    BRANCH CODE
     C                     MOVE WDDBRC    BRC08
     C*    ACCOUNT TYPE
     C                     MOVE 'G'       ATP08
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD08     @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC08  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC08     CPBRC
     C**********           Z-ADDCNM08     CPCNM                                               CSD027
     C                     MOVE CNM08     CPCNM                                               CSD027
     C                     MOVELCCY08     CPCCY
     C                     Z-ADDACD08     CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*
     C                     EXSR SUBNAR
     C*                                                                   099081
     C** Get narrative for posting REC08.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV08  30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 11)
     C**
     C*****************************************************************
     C           SET11     BEGSR                           *** SET11 ***
     C*
     C*    CUSTOMER NUMBER
     C                     MOVE WABICN    CNM11
     C           *IN57     IFEQ '1'
     C           BKMABR    IFNE WABRCD
     C           BKMABR    ANDNEWDBRCD
     C                     MOVE WADBIC    CNM11
     C                     ENDIF
     C                     ENDIF
     C*    CURRENCY CODE
     C   40                MOVE CCYO      CCY11
     C  N40                MOVE CCCY      CCY11
     C*    ACCOUNT CODE
     C           DCDR2     IFEQ 0
     C                     MOVE WDIBFR    ACD11
     C                     ELSE
     C                     MOVE WDIBTO    ACD11
     C                     END
     C*    POSTING AMOUNT
     C  N40                Z-ADDPAMT      PAM11
     C   40                Z-ADDPAMTCA    PAM11
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR2     DCI11
     C*    BRANCH CODE
     C                     MOVE WDBRCD    BRC11
     C*    ACCOUNT TYPE
     C                     MOVE 'G'       ATP11
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD11     @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC11  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC11     CPBRC
     C**********           Z-ADDCNM11     CPCNM                                               CSD027
     C                     MOVE CNM11     CPCNM                                               CSD027
     C                     MOVELCCY11     CPCCY
     C                     Z-ADDACD11     CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*
     C                     EXSR SUBNAR
     C*                                                                   099081
     C** Get narrative for posting REC11.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV11  30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C**   S E T   U P   F I E L D S   (POSTING REC 12)
     C**
     C*****************************************************************
     C           SET12     BEGSR                           *** SET12 ***
     C*
     C*    CUSTOMER NUMBER
     C                     MOVE WDBICN    CNM12
     C           *IN57     IFEQ '1'
     C           BKMABR    IFNE WABRCD
     C           BKMABR    ANDNEWDBRCD
     C                     MOVE WADBIC    CNM12
     C                     ENDIF
     C                     ENDIF
     C*    CURRENCY CODE
     C   40                MOVE CCYO      CCY12
     C  N40                MOVE CCCY      CCY12
     C*    ACCOUNT CODE
     C           DCDR1     IFEQ 0
     C                     MOVE WAIBFR    ACD12
     C                     ELSE
     C                     MOVE WAIBTO    ACD12
     C                     END
     C*    POSTING AMOUNT
     C  N40                Z-ADDPAMT      PAM12
     C   40                Z-ADDPAMTCA    PAM12
     C*    DR/CR INDICATOR
     C                     Z-ADDDCDR1     DCI12
     C*    BRANCH CODE
     C                     MOVE WABRCD    BRC12
     C*    ACCOUNT TYPE
     C                     MOVE 'G'       ATP12
     C*
     C**  Set up Account section
     C*
     C                     MOVELACD12     @ACOD
     C                     EXSR ACDCHN
     C                     MOVELACSC      ACSC12  2
     C*
     C**  Standardised Posting Narratives
     C*
     C                     MOVELBRC12     CPBRC
     C**********           Z-ADDCNM12     CPCNM                                               CSD027
     C                     MOVE CNM12     CPCNM                                               CSD027
     C                     MOVELCCY12     CPCCY
     C                     Z-ADDACD12     CPACD
     C                     MOVELACS00     CPACS
     C*                                                                   S01522
     C                     MOVE *BLANKS   ##RACN                          S01522
     C                     MOVE *BLANKS   ##ASOC                          S01522
     C*
     C                     EXSR SUBNAR
     C*                                                                   099081
     C** Get narrative for posting REC12.                                 099081
     C*                                                                   099081
     C                     MOVELO#PNAR    NRV12  30                       099081
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C*  SUBNAR - Subroutine to standardised posting narratives.      *
     C*           If posted to the Retail Account, all 30 char. for   *
     C*           narrative is available. If posted to suspense, or   *
     C*           alternative account, or the Contra entry and Retail *
     C*           no. is used then 19 char. is available and 10 char  *
     C*           is for the Retail no. otherwise only 7 char. for    *
     C*           narrative is available and the rest is for the      *
     C*           Midas account number.                               *
     C*                                                               *
     C*  Called By: SETnn                                             *
     C*                                                               *
     C*  Calls:     _                                                 *
     C*                                                               *
     C*****************************************************************
     C*
     C           SUBNAR    BEGSR
     C*                                                                   099081
     C/COPY WNCPYSRC,RE3116C047
     C** Blank out NAR00 just in case previous narrative filled it out.   099081
     C*                                                                   099081
     C                     MOVE *BLANKS   NAR00                           099081
     C*
      **  Set up Narrative message for case                               S01522
     C                     SELEC                                          S01522
     C           *IN41     WHEQ *ON                                       S01522
     C                     MOVE MGID,1    ##MGID
     C           *IN42     WHEQ *ON                                       S01522
     C                     MOVE MGID,2    ##MGID
     C           *IN43     WHEQ *ON                                       S01522
     C                     MOVE MGID,3    ##MGID
     C           *IN44     WHEQ *ON                                       S01522
     C                     MOVE MGID,4    ##MGID
     C           *IN45     WHEQ *ON                                       S01522
     C                     MOVE MGID,5    ##MGID
     C           *IN46     WHEQ *ON                                       S01522
     C                     MOVE MGID,6    ##MGID
     C           *IN47     WHEQ *ON                                       S01522
     C                     MOVE MGID,7    ##MGID
     C           *IN48     WHEQ *ON                                       S01522
     C                     MOVE MGID,8    ##MGID
     C                     ENDSL                                          S01522
      *                                                                   S01522
     C           COMPAC    IFEQ RECKEY
      *                                                                   S01522
      **  Set up final character of MSGID according to Narrative Type     S01522
     C                     MOVE '0'       ##MGID                          S01522
     C*  FIXED COMMISSION
     C   41                MOVELNR30,1    NAR00  30
     C*  A/C COMMISSION
     C   42                MOVELNR30,2    NAR00
     C*  COMMISSION ON DEBIT INTEREST
     C   43                MOVELNR30,3    NAR00
     C*  COMMISSION ON HIGHEST OVERDRAFT
     C   44                MOVELNR30,4    NAR00
     C*  COMMISSION ON INACTIVE ACCOUNT
     C   45                MOVELNR30,5    NAR00
     C*  COMMISSION ON MINIMUM BALANCE
     C   46                MOVELNR30,6    NAR00
     C*** VAT
     C   47                MOVELNR30,7    NAR00
     C*  CHARGE ON NUMBER OF DAILY STATEMENTS
     C   48                MOVELNR30,8    NAR00
     C*
     C                     ELSE
     C*
     C           RACN      IFEQ 'Y'
      *                                                                   S01522
      **  Set up final character of MSGID according to Narrative Type     S01522
     C                     MOVE '1'       ##MGID                          S01522
      *                                                                   S01522
     C                     MOVE WWACNO    NAR00
     C*  FIXED COMMISSION
     C   41                MOVELNAR,1     NAR00
     C*  A/C COMMISSION
     C   42                MOVELNAR,2     NAR00
     C*  COMMISSION ON DEBIT INTEREST
     C   43                MOVELNAR,3     NAR00
     C*  COMMISSION ON HIGHEST OVERDRAFT
     C   44                MOVELNAR,4     NAR00
     C*  COMMISSION ON INACTIVE ACCOUNT
     C   45                MOVELNAR,5     NAR00
     C*  COMMISSION ON MINIMUM BALANCE
     C   46                MOVELNAR,6     NAR00
     C*** VAT
     C   47                MOVELNAR,7     NAR00
     C*  CHARGE ON NUMBER OF DAILY STATEMENTS
     C   48                MOVELNAR,8     NAR00
     C*
     C                     ELSE
      *                                                                   S01522
      **  Set up final character of MSGID according to Narrative Type     S01522
     C                     MOVE '2'       ##MGID                          S01522
      *                                                                   S01522
     C                     MOVE KEY23     NAR00
     C*  FIXED COMMISSION
     C   41                MOVELDN07,1    NAR00
     C*  A/C COMMISSION
     C   42                MOVELDN07,2    NAR00
     C*  COMMISSION ON DEBIT INTEREST
     C   43                MOVELDN07,3    NAR00
     C*  COMMISSION ON HIGHEST OVERDRAFT
     C   44                MOVELDN07,4    NAR00
     C*  COMMISSION ON INACTIVE ACCOUNT
     C   45                MOVELDN07,5    NAR00
     C*  COMMISSION ON MINIMUM BALANCE
     C   46                MOVELDN07,6    NAR00
     C*** VAT
     C   47                MOVELDN07,7    NAR00
     C*  CHARGE ON NUMBER OF DAILY STATEMENTS
     C   48                MOVELDN07,8    NAR00
     C*
     C                     END
     C*
     C                     END
     C/COPY WNCPYSRC,RE3116C004
     C*                                                                   099081
     C** Determine required narrative.                                    099081
     C*                                                                   099081
     C                     EXSR SRPNAR                                    099081
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C*                                                               *
     C* ACDCHN - This subroutine uses the account code of the posting *
     C*          in SETnn subroutines to retrieve the account section *
     C*          from the account codes file.                         *
     C*                                                               *
     C*  Called By: SETnn                                             *
     C*                                                               *
     C*  Calls:     DBERR                                             *
     C*                                                               *
     C*****************************************************************
     C*
     C           ACDCHN    BEGSR
     C*
     C                     MOVE @ACOD     @KEYC
     C                     MOVE @KEYC     AKEY                                              CRE083BL
     C                     EXSR ACCHKA                                                      CRE083BL
      *                                                                                     CRE083BL
     C           FOIC      IFEQ 'Y'                                                         CRE083BL
     C                     MOVE CCSC,B    ACSC                                              CRE083BL
     C                     MOVE CTYP,B    ATYP                                              CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AOACODR0'#AACOD
     C*
     C           @RTCD     IFNE *BLANKS
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3116'  DBPGM
     C                     MOVEL'SDACODPD'DBFILE           ************
     C                     MOVEL@ACOD     DBKEY            * DBERR 34 *
     C                     Z-ADD34        DBASE            ************
     C                     OUT  LDA
     C                     EXSR DBERR
     C                     ELSE                                                             CRE083BL
     C                     EXSR ACADDA                                                      CRE083BL
     C                     END
     C                     ENDIF                                                            CRE083BL
     C*
     C                     ENDSR
     C*****************************************************************
     C/EJECT
     C**
     C**   D A T A B A S E   E R R O R  P R O C E S S I N G
     C**
     C*****************************************************************
     C           DBERR     BEGSR                           *** DBERR ***
     C*
     C                     SETON                     U7U8LR
     C                     DUMP
     C*
     C           @HEAD     IFNE 'Y'
     C                     OPEN RE3116AU                                  CCB003
     C                     WRITEHEADAU
     C                     END
     C*
     C                     WRITEERRORAU
      *                                                                   CCB003
     C                     CLOSERE3116AU                                  CCB003
      *                                                                   CCB003
     C                     ROLBK                                          CCB003
     C*
     C                     RETRN
     C*
     C                     ENDSR
     C*
     C*****************************************************************
     C/EJECT
     C********************************************************************S01522
     C**  Subroutine SRPNAR determines the required narratives.         **S01522
     C********************************************************************S01522
     C           SRPNAR    BEGSR                           * S R P N A R *S01522
     C*                                                                   S01522
     C* Define the destination narrative fields:                          S01522
     C*                                                                   S01522
     C           *LIKE     DEFN NAR00     O#PNAR                          S01522
     C           *LIKE     DEFN MNASOC    ##ASOC                          S01522
     C           *LIKE     DEFN MNRACN    ##RACN                          S01522
     C*                                                                   S01522
     C* Define the data structure parameter:                              S01522
     C*                                                                   S01522
     C           *LIKE     DEFN CGPNAR    ##PNAR                          S01522
     C*                                                                   S01522
     C* Fill the narrative fields with the existing values:               S01522
     C*                                                                   S01522
     C                     MOVE NAR00     O#PNAR                          S01522
     C*                                                                   S01522
     C* If the facility is switched off or unavailable,                   S01522
     C*  or UDC is not installed, exit this subroutine:                   S01522
     C*                                                                   S01522
     C           REPNAR    IFNE 'Y'                                       S01522
     C                     GOTO EXPNAR                                    S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C* Determine the customer's name:                                    S01522
     C*                                                                   S01522
     C                     MOVELCPCNM     ##KEY     P                     S01522
     C*                                                                   S01522
     C                     Z-ADDBINDX     A                                                 CRE083BL
     C           CPCNM     LOKUPABIC,A                   78                                 CRE083BL
     C           *IN78     IFEQ '1'                                                         CRE083BL
     C                     MOVE ACRN,A    BBCRNM                                            CRE083BL
     C                     ELSE                                                             CRE083BL
     C                     CALL 'AOCUSTR0'                                S01522
     C                     PARM           ##RTN   7                       S01522
     C                     PARM '*KEY   ' ##OPT   7                       S01522
     C                     PARM           ##KEY  10                       S01522
     C                     PARM           ##STS   7                       S01522
     C           SDCUST    PARM SDCUST    DSSDY                           S01522
     C*                                                                   S01522
     C           ##RTN     IFNE *BLANKS                                   S01522
     C                     MOVEL'SDCUSTPD'DBFILE             *************S01522
     C                     MOVEL'101'     DBASE              * DBERR 101 *S01522
     C                     MOVELCPCNM     DBKEY              *************S01522
     C                     EXSR DBERR                                     S01522
     C                     RETRN                                          S01522
     C                     ENDIF                                          S01522
     C                     ENDIF                                                            CRE083BL
     C*...................................................................S01522
     C/EJECT                                                              S01522
     C*...................................................................S01522
     C* Determine the value for the NAR00 narrative using AOPNARR0:       S01522
     C*                                                                   S01522
     C                     CLEARCGPNAR                                    S01522
     C                     CLEAR##PRM1                                    086125
     C*                                                                   S01522
     C                     MOVE 'RE'      MNMODI                          S01522
     C                     MOVE CPBRC     MNBRCA                          S01522
     C                     MOVE CPCNM     MNCUST                          S01522
     C                     MOVE CPCCY     MNCYCD                          S01522
     C                     MOVE CPACD     MNACCD                          S01522
     C                     MOVE CPACS     MNACSQ                          S01522
     C                     MOVE BBCRNM    MNCRNM                          S01522
     C                     MOVELNAR00     MNNARR    P                     S01522
     C                     MOVE ##RACN    MNRACN                          S01522
     C                     MOVE ##ASOC    MNASOC                          S01522
     C/COPY WNCPYSRC,REH00402
     C*                                                                   S01522
     C                     CALL 'AOPNARR0'                                S01522
     C                     PARM           ##RTN                           S01522
     C                     PARM           ##MGID  7                       S01522
     C                     PARM           ##PRM1                          086125
     C           CGPNAR    PARM CGPNAR    ##PNAR                          S01522
     C                     PARM           ##NARR 50                       S01522
     C/COPY WNCPYSRC,REH00403
     C*                                                                   S01522
     C           ##RTN     IFNE *BLANKS                                   S01522
     C                     MOVEL'CGPNARPD'DBFILE             *************S01522
     C                     MOVEL'102'     DBASE              * DBERR 102 *S01522
     C                     MOVELMNCUST    DBKEY              *************S01522
     C                     EXSR DBERR                                     S01522
     C                     RETRN                                          S01522
     C                     ENDIF                                          S01522
     C*                                                                   S01522
     C                     MOVEL##NARR    O#PNAR    P                     S01522
     C/COPY WNCPYSRC,RE3116C081
     C*...................................................................S01522
     C*                                                                   S01522
     C           EXPNAR    TAG                             < EXPNAR       S01522
     C*                                                                   S01522
     C                     ENDSR                                          S01522
     C********************************************************************S01522
     C/EJECT
     C********************************************************************
     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
     C*   IND '99' IS SET BY AN OVERFLOW ERROR
     C*
     C*****************************************************************
     CSR         GLZADD    BEGSR                           *** GLZADD ****
     C*
     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
     C*
     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
     C*
     CSR                   EXSR GLZSUM
     CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
     C*
     C********************************************************************
     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
     C*                        GLZADD, GLZSUB, GLZCMP.
     C*          PARAMETERS PASSED -
     C*                     I/P ZZAMTI ZZAMTD
     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
     C*
     C*****************************************************************
     CSR         GLZSUM    BEGSR                           *** GLZSUM ****
     C*
     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
     CSR                   SETOF                     919293
     CSR                   SETOF                     949599
     C*
     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
     CSR         ZZAMTI    COMP 0                      9293
     CSR 93      ZZAMTD    COMP 0                      9293
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*
     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
     CSR         ZZTOTI    COMP 0                      9193
     CSR 93      ZZTOTD    COMP 0                      9193
     C*
     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
     CSR 93                Z-ADDZZAMTI    ZZTOTI
     CSR 93                Z-ADDZZAMTD    ZZTOTD
     CSR 93                GOTO ZZSEND                     ZERO BYPASS
     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
     CSR 91N92
     CORN91 92             GOTO ZZOFPS
     C*
     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
     C*
     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
     C*
     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
     CSRN99                Z-ADDZZWK2     ZZTOTD
     CSRN99                Z-ADDZZWK3     ZZTOTI
     C*
     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
     CSR 99                Z-ADD0         ZZAMT  153
     CSR                   GOTO ZZSEND
     C*
     C* THE 'SIGNS' ARE DIFFERENT
     CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
     C*
     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
     C*
     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
     C*
     CSR 91                Z-SUBZZTOTI    ZZTOTI
     CSR 91                Z-SUBZZTOTD    ZZTOTD
     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
     C*
     CSR         ZZTOTI    COMP ZZAMTI               93  95
     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
     C*
     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
     CSR 95                Z-ADD0         ZZTOTI
     CSR 95                Z-ADD0         ZZTOTD
     CSR 95                GOTO ZZSEND
     C*
     C* IF ZZTOT GT. ZZAMT.
     CSR 93      ZZAMTD    COMP ZZTOTD               94
     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
     C*
     C*
     C* IF ZZAMT GT. ZZTOT.
     CSRN93      ZZTOTD    COMP ZZAMTD               94
     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
     C*
     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
     CSR                   SETOF                     94
     CSR 93 91
     CORN93 92             SETON                     94
     CSR 94                Z-SUBZZTOTI    ZZTOTI
     CSR 94                Z-SUBZZTOTD    ZZTOTD
     C**
     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
     CSR 92                Z-SUBZZAMTI    ZZAMTI
     CSR 92                Z-SUBZZAMTD    ZZAMTD
     CSR         ZZSEND    TAG                             ** ZZSEND TAG *
     C**
     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
     CSR                   SETOF                     96
     CSR         ZZTOTD    COMP 0                        91
     CSR 91      ZZTOTI    COMP 0                      96
     CSR 96                MOVE '.000-'   ZZNEGD  5
     CSR                   ENDSR                             ** ENDSR **
     C/COPY WNCPYSRC,RE3116C048
      ********************************************************************                    CER049
      *                                                                                       CER049
      *  Accumulate charges based on Stamp Tax indicator                                      CER049
      *                                                                                       CER049
      *  Called after every call on CUMVAT subroutine                                         CER049
      *                                                                                       CER049
      *                                                                                       CER049
      *****************************************************************                       CER049
     C           ACUMCC    BEGSR                                                              CER049
      *                                                                                       CER049
     C           CER049    IFEQ 'Y'                                                           CER049
      *                                                                                       CER049
     C                     ADD  PAMT      TOTACC                                              CER049
      *                                                                                       CER049
     C                     ENDIF                                                              CER049
      *                                                                                       CER049
     C                     ENDSR                                                              CER049
     O/EJECT
     O*****************************************************************
     O**
     O**   P O S T I N G   R E C O R D S
     O**
     O*****************************************************************
     O**
     O**   POSTING RECORD 01
     OGECOMD  E                RECO1
     O                                    1 'P'
     O                         CNM01      7
     O                         CCY01     10
     O**********               ACD01     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS01     16
     O                         IPDN      22
     O                         RAN01     32
     O/COPY WNCPYSRC,RE3116O016
     O                         PSD00     35P
     O***********              VLD01     38P                              119348
     O                         VLDOU     38P                              119348
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O003
     O*********** S01522       NAR00     73                               S01522
     O*********** S01522       KEY23     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV01     73                               099081
     O                         PAM01     80P
     O                         DCI01     81
     O                         ACN01     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC01    105
     O                         RET01    106
     O/COPY WNCPYSRC,RE3116O017
     O                         REJ00    108P
     O*************                     111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP01    124
     O/COPY WNCPYSRC,RE3116O018
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC01   146
     O                         LTAI     147
     O                         RINO     160
     O                         DBC00    200
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00473
     O*
     O** 095810: add the Retail Teller System fields; the absence of the
     O** numeric one was causing a problem; all have been included for
     O** completeness.
     O                         TLIN     299                               095810
     O                         TRCCY    302                               095810
     O                         STYP     303                               095810
     O                         CQRI     304                               095810
     O                         PBTT     306                               095810
     O                         ORBR     309                               095810
     O                         ORAMT    316P                              095810
     O                         XRFI     319                               149069
     O                         XRFN     329                               149069
     O                         ACKEY    351                                                   CGL020
     O                 47               352 ' '                                               CGL020
     O                 47      ZERO13   359P                                                  CGL020
     O                 47      ZERO5    364                                                   CGL020
     O                N47               352 'F'                                               CGL020
     O                N47      PAM01    359P                                                  CGL020
     O                N47      FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD01    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O/COPY WNCPYSRC,RE3116O004
     O**
     O**
     O**   POSTING RECORD 01
     OGEICPD  E                REC01
     O                                    1 'P'
     O                         CNM01      7
     O                         CCY01     10
     O**********               ACD01     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS01     16
     O                         IPDN      22
     O                         RAN01     32
     O/COPY WNCPYSRC,RE3116O019
     O                         PSD00     35P
     O***********              VLD01     38P                              119348
     O                         VLDOU     38P                              119348
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O005
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV01     73                               099081
     O                         PAM01     80P
     O                         DCI01     81
     O                         ACN01     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC01    105
     O                         RET01    106
     O/COPY WNCPYSRC,RE3116O020
     O                         REJ00    108P
     O************                      111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP01    124
     O/COPY WNCPYSRC,RE3116O021
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC01   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O022
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00474
     O                         ACKEY    351                                                   CGL020
     O                 47               352 ' '                                               CGL020
     O                 47      ZERO13   359P                                                  CGL020
     O                 47      ZERO5    364                                                   CGL020
     O                N47               352 'F'                                               CGL020
     O                N47      PAM01    359P                                                  CGL020
     O                N47      FEEPCT   364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD01    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 01A
     O        E                REC01A
     O                                    1 'P'
     O                         CNM00      7
     O                         CCY01A    10
     O**********               ACD01A    14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O                         VLD00     38P
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O006
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV01A    73                               099081
     O                         PAM01A    80P
     O                         DCI01A    81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC00    105
     O                         RET00    106
     O                         REJ00    108P
     O***********                       111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP01A   124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65      FTPRFP   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC1A   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O023
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00475
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD01A   599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 02
     O        E                REC02
     O                                    1 'P'
     O                         CNM02      7
     O                         CCY02     10
     O**********               ACD02     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O**********               VLD00     38P                                                MD027749
     O                         VLDOU     38P                                                MD027749
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O007
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV02     73                               099081
     O                         PAM02     80P
     O                         DCI02     81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC00    105
     O                         RET00    106
     O                         REJ00    108P
     O*************                     111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP02    124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65 50   FTPRFP   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC02   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O024
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00476
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD02    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 03
     O        E                REC03
     O                                    1 'P'
     O                         CNM03      7
     O                         CCY03     10
     O**********               ACD03     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O                         VLD00     38P
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O008
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV03     73                               099081
     O                         PAM03     80P
     O                         DCI03     81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC03    105
     O                         RET00    106
     O                         REJ00    108P
     O************                      111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP03    124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65 66   DSFPPC   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC03   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O025
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00477
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD03    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 04
     O        E                REC04
     O                                    1 'P'
     O                         CNM04      7
     O                         CCY04     10
     O**********               ACD04     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O                         VLD00     38P
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O009
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV04     73                               099081
     O                         PAM04     80P
     O                         DCI04     81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC04    105
     O                         RET00    106
     O                         REJ00    108P
     O************                      111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP04    124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65 66   DSFPPC   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC04   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O026
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00478
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD04    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 05
     O        E                REC05
     O                                    1 'P'
     O                         CNM05      7
     O                         CCY05     10
     O**********               ACD05     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O                         VLD00     38P
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O010
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV05     73                               099081
     O                         PAM05     80P
     O                         DCI05     81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC05    105
     O                         RET00    106
     O                         REJ00    108P
     O***********                       111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP05    124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65 66   DSFPPC   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC05   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O027
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00479
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD05    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 06
     O        E                REC06
     O                                    1 'P'
     O                         CNM06      7
     O                         CCY06     10
     O**********               ACD06     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O                         VLD00     38P
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O011
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV06     73                               099081
     O                         PAM06     80P
     O                         DCI06     81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC06    105
     O                         RET00    106
     O                         REJ00    108P
     O************                      111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP06    124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65 66   DSFPPC   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC06   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O032
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00480
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD06    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 07
     O        E                REC07
     O                                    1 'P'
     O                         CNM07      7
     O                         CCY07     10
     O**********               ACD07     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O                         VLD00     38P
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O012
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV07     73                               099081
     O                         PAM07     80P
     O                         DCI07     81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC07    105
     O                         RET00    106
     O                         REJ00    108P
     O************                      111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP07    124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65      FTPRFP   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC07   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O028
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00481
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD07    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 08
     O        E                REC08
     O                                    1 'P'
     O                         CNM08      7
     O                         CCY08     10
     O**********               ACD08     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O                         VLD00     38P
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O013
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV08     73                               099081
     O                         PAM08     80P
     O                         DCI08     81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC08    105
     O                         RET00    106
     O                         REJ00    108P
     O************                      111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP08    124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65      FTPRFP   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC08   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O029
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00482
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD08    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 11
     O        E                REC11
     O                                    1 'P'
     O                         CNM11      7
     O                         CCY11     10
     O**********               ACD11     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O                         VLD00     38P
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O014
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV11     73                               099081
     O                         PAM11     80P
     O                         DCI11     81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC11    105
     O                         RET00    106
     O                         REJ00    108P
     O**************                    111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP11    124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65      FTPRFP   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC11   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O030
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00483
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD11    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O**
     O**   POSTING RECORD 12
     O        E                REC12
     O                                    1 'P'
     O                         CNM12      7
     O                         CCY12     10
     O**********               ACD12     14                                                   CGL029
     O                         ACODQQ    14                                                   CGL029
     O                         ACS00     16
     O                         IPDN      22
     O                         RAN00     32
     O                         PSD00     35P
     O                         VLD00     38P
     O                                   43 '91050'
     O/COPY WNCPYSRC,RE3116O015
     O*********** S01522       NAR00     73                               S01522
     O***********              O#PNAR    73                        S01522 099081
     O                         NRV12     73                               099081
     O                         PAM12     80P
     O                         DCI12     81
     O                         ACN00     87
     O                         CQN00     95
     O                                  102 '  GE-IC'
     O                         BRC12    105
     O                         RET00    106
     O                         REJ00    108P
     O************                      111 '000'                         105084
     O                                  111 '   '                         105084
     O                         RRN00    114P
     O                         ATP12    124
     O                         BITOFF   128
     O                                  129 'C'
     O                         ACM00    130
     O                         PRFC     134
     O                 65      FTPRFP   134                               CAC001
     O                         PTIM     140
     O                         VOIN     141
     O                         MGTT     144
     O                         ACSC12   146
     O                         LTAI     147
     O                         RINO     160
     O/COPY WNCPYSRC,RE3116O031
     O**********               OTRF     230                                                   CGL029
     O                         OTRFQQ   230                                                   CGL029
     O                         OTST     240
     O                         OTTP     250
     O                         SDCB     258P
     O                         SDLB     266P
     O                         BOKC     268
     O                         NITMS    271P
     O                         REBI     272
     O                         CHGA     279P
     O/COPY WNCPYSRC,REH00484
     O                         ACKEY    351                                                   CGL020
     O                                  352 ' '                                               CGL020
     O                         ZERO13   359P                                                  CGL020
     O                         ZERO5    364                                                   CGL020
     O                         RORACT   384                                                   CGL020
     O                         RORCTY   386                                                   CGL020
     O                         RORBNK   406                                                   CGL020
     O                         RORCDE   417                                                   CGL020
     O                         PORACT   437                                                   CGL020
     O                         PORCTY   439                                                   CGL020
     O                         PORBNK   459                                                   CGL020
     O                         PORCDE   470                                                   CGL020
     O                         DSTACT   505                                                   CGL020
     O                         DSTCTY   507                                                   CGL020
     O                         DSTBNK   527                                                   CGL020
     O                         SETDAT   530P                                                  CGL020
     O                         TICKER   540                                                   CGL020
     O                         EXCHNG   560                                                   CGL020
     O                         NOMINL   573                                                   CGL020
     O                         FDTRID   589                                                   CGL020
     O                         ACD12    599                                                   CGL029
     O                         OTRF     620                                                   CGL029
     O/EJECT
     O/COPY WNCPYSRC,RE3116O002
     ORECOMDF E                RECOUP
     O                         CACCC
     O                         CCDIC
     O                         CCHDBC
     O                         CIACC
     O                         CCMBC
     O                         CACDC
     O                         CCINST
     O                         VATAM
     O                         NOIS
     O                         CHCO                                                           CER049
     O                         STPF2                                                          CER049
     O/COPY WNCPYSRC,RE3116O001
     O/EJECT
** CPY@   **      OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
** ANAR                                                                                     CRE083BL
RA                                                                                          CRE083BL
RC                                                                                          CRE083BL
RD                                                                                          CRE083BL
RE                                                                                          CRE083BL
R0                                                                                          CRE083BL
R7                                                                                          CRE083BL
R8                                                                                          CRE083BL
R9                                                                                          CRE083BL
** SVAL  -  Systen Values Array                                                               CRE100
RET_CHG_CUST_LVL                                                                              CRE100
RET_SEQ_CUST_LVL                                                                            MD034990
