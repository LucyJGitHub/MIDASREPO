     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Outstanding interest/charges enquiry')        *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module                                        *
     F*                                                               *
     F*  RE3360  - RETAIL LINK ENQUIRY                                *
     F*            OUTSTANDING INTEREST/CHARGES                       *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
      *                                                               *
      *  Last Amend No. CSD103             Date 10Aug20               *
      *  Prev Amend No. CER050             Date 16Jun19               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL186             Date 06Oct17               *
      *                 MD044981           Date 29Mar17               *
      *                 226604             Date 12Dec16               *
      *                 CGL183             Date 07Dec16               *
      *                 198547             Date 30Sep16               *
      *                 152698             Date 30Sep16               *
      *                 MD039579           Date 27Jul16               *
      *                 MD035448           Date 01Dec15               *
      *                 CGL165             Date 23Feb15               *
      *                 MD031352           Date 13Feb15               *
      *                 CER070             Date 19Aug14               *
      *                 CER069             Date 03Jul14               *
      *                 MD027025A          Date 20Jun14               *
      *                 MD027192           Date 26May14               *
      *                 MD027139           Date 22May14               *
      *                 MD027105           Date 21May14               *
      *                 MD027052           Date 20May14               *
      *                 MD026943           Date 16May14               *
      *                 MD026867           Date 15May14               *
      *                 MD026805           Date 12May14               *
      *                 CRE090A            Date 14Feb14               *
      *                 CRE090             Date 14Feb14               *
      *                 MD025641           Date 14Mar14               *
      *                 MD025640           Date 12Mar14               *
      *                 262397             Date 08Aug12               *
      *                 261086             Date 08Aug12               *
      *                 AR823701           Date 07Sep11               *
      *                 CER049             Date 06Dec10               *
      *                 AR787620           Date 10Jun11               *
      *                 AR784694           Date 06Jun11               *
      *                 AR763412           Date 29May11               *
      *                 AR755349           Date 11May11               *
      *                 AR751622           Date 02May11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG26839           Date 05Jan10               *
      *                 BUG26363           Date 13Oct09               *
      *                 BUG25942           Date 11Sep09               *
      *                 BUG23777           Date 10Jun09               *
      *                 BUG24137           Date 13May09               *
      *                 CER054             Date 07Apr09               *
      *                 BUG23987           Date 13May09               *
      *                 BUG23325           Date 01Apr09               *
      *                 BUG23178           Date 04Mar09               *
      *                 BUG23126           Date 26Feb09               *
      *                 BUG22911           Date 17Feb09               *
      *                 BUG22953           Date 17Feb09               *
      *                 CER048             Date 19May08               *
      *                 CER016             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 CDL081             Date 14Dec09               *
      *                 BUG26486           Date 19Oct09               *
      *                 260297             Date 19May09               *
      *                 260322             Date 23May09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 CRE026             Date 24May06               *
      *                 249907             Date 13Sep06               *
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 241027             Date 11Jul06               *
      *                 239964             Date 30Jun06               *
      *                 BUG11679           Date 05Jul06               *
      *                 CRE024             Date 07Oct05               *
      *                 CSD031             Date 10Apr06               *
      *                 240452             Date 08Jun06               *
      *                 239966             Date 08Jun06               *
      *                 211909             Date 06Jun06               *
      *                 206669             Date 06Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 240079             Date 08Jun06               *
      *                 238209             Date 01Feb06               *
      *                 CDL013             Date 08Jun06               *
      *                 229202             Date 26May06               *
      *                 236095             Date 22Sep05               *
      *                 234034             Date 09Jun05               *
      *                 CGL035             Date 01Mar05               *
      *                 CGL031             Date 05Jul04               *
      *                 CSW037A            Date 02May05               *
      *                 CSD025             Date 11Jan05               *
      *                 CSW037             Date 15Dec04               *
      *                 CSW036             Date 15Dec04               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 21Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01.03 ----------------------------------------*
      *                 209861             Date 17Jan03               *
      * Midas Release 4.01 -------------------------------------------*
      * Midas Release 4.01 -------------------------------------------*
      *                 196856             Date 29Jan02               *
      * Midas Release 4 --------------- Base -------------------------*
      *                 CDE002             Date 21Dec99               *
      * Midas DBA 3.04 -----------------------------------------------*
      *                 185277             Date 25Oct00               *
      *                 CSD007             Date 28Aug00               *
     F*                 174820             Date 20Sep00
      * Midas DBA 3.03 -----------------------------------------------*
     F*                 159536             DATE 30APR99               *
      * Midas DBA 3.02 -----------------------------------------------*
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 153001             Date 23Apr99               *
     F*                 130468             Date 28Apr99               *
     F*                 103460             DATE 06MAR98               *
     F*                 117208             DATE 26FEV98               *
     F*                 124019             Date 08OCT97               *
     F*                 CRE001             Date 18Feb97               *
     F*                 CRT002             Date  1DEC95               *
     F*                 CCB002             DATE 19AUG96               *
     F*                 S01408             DATE 12SEP96               *
     F*                 099515             Date 31MAY96               *
     F*                 089811             DATE 31MAY96               *
     F*                 086086             DATE 31MAY96               *
     F*                 075071             DATE 31MAY96               *
     F*                 094431             DATE 16OCT95               *
     F*                 088734             DATE 28JUN95               *
     F*                 S01408             DATE 18APR96               *
     F*                 094687             DATE 28FEB96               *
     F*                 S01408             DATE 20FEB96               *
     F*                 S01408             DATE 06FEB96               *
     F*                 088029             DATE 23JUN95               *
     F*                 077563             DATE 09JUN95               *
     F*                 077563             DATE 21JUN95               *
     F*                 077872             DATE 24OCT94               *
     F*                 076189             DATE 20SEP94               *
     F*                 S01408             DATE 31AUG94               *
     F*                 074590             DATE 22AUG94               *
     F*                 074578             DATE 17AUG94               *
     F*                 S01413 *CREATE     DATE 13APR93               *
     F*                                                               *
     F*****************************************************************
      *                                                               *
      *  CSD103 - LIBOR Deregulation - Common Layer/Standing Data     *
      *  CER050 - Annualised Percentage Rte (Recompile)               *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL186 - Customer Report Name on Enquiries                   *
      *         - Add Cust Report Name to Account Movements & OSIC.   *
      *  MD044981 - Min. CR Interest to Cap is not displayed in OSIC. *
      *             Recompile due to changes in RE3360DF.             *
      *  226604 - Recompile due to changes in RE3360DF.               *
      *           Applied for MD041654                                *
      *  CGL183 - User Access Audit of Account Enquiry functions      *
      *  198547 - Overdraft interest calculation, if ovred.int. was   *
      *           inputted, should be calculated also if overdraft    *
      *           limit = *Zero.                                      *
      *           Applied for MD-41736.                               *
      *  152698 - Overdraft Interest Calculation:                     *
      *           Correct DR interest calculation for a/cs without    *
      *           OD Expiry Date i.e. ODED = 0                        *
      *           Applied for MD-41736.                               *
      *  MD039579 - OSIC Enquiry - issue in RE336* programs when F12  *
      *             is pressed from RE3363                            *
      *  MD035448 - CER016 only applies to cal basis 0. Need to       *
      *             apply on calc basis.                              *
      *  CGL165 - Dual Withholding Tax                                *
      *  MD031352 - Midas allows base rate changes with value date in *
      *             the future that causes DRCD / CRCD to be updated  *
      *             with this date. Because the rate changes have not *
      *             valued yet, there are no records in REHPOSR1 yet. *
      *             This causes OSIC not to retrieve the correct last *
      *             rate (always zero in this case) and not to        *
      *             calculate the correct accruals in OSIC.           *
      *  CER070 - BuBa Reporting / BAIS V.1.16.0 (Recompile)          *
      *  CER069 - German Tax Enhancement                              *
      *  MD027025A - Incorrect details shown in Interest Details      *
      *              Enquiry of a delayed capitalisation record.      *
      *  MD027192 - Unable to enquire accounts with credit cap date   *
      *             equal to account opening date, and already on     *
      *             delay period.                                     *
      *  MD027139 - Missing screen title and menu keys on accounts    *
      *             without capitalisation record.                    *
      *  MD027105 - Incorrect accrued interest for accounts with      *
      *             debit and credit capitalisation both delayed.     *
      *  MD027052 - Demand capitalisation not executed for bulk       *
      *             request on accounts with either Cr or Dr on delay.*
      *  MD026943 - Incorrect outstanding accrued interest of         *
      *             accounts in delay period for first day accrual.   *
      *  MD026867 - Debit Turnover and Minimum Balance commissions    *
      *             not generated correctly.                          *
      *  MD026805 - Discrepancy on displayed details when enquiring   *
      *             different accounts.                               *
      *  CRE090A - Delay Capitalization of Interest                   *
      *  CRE090 - Delay Capitalisation of Interest                    *
      *  MD025641 - Wrong computation of debit interest and OD        *
      *             interest for tiered type                          *
      *  MD025640 - Wrong computation of the penalty interest charge  *
      *             for threshold type                                *
      *  262397 - OSIC displays database error for some accounts.     *
      *           Issue an error message if closed account being      *
      *           enquired has no historic records.                   *
      *  261086 - Closed account in OSIC option.                      *
      *           Reinstate fix for 196856 to be able to access the   *
      *           data of a closed account as in the client's R4      *
      *           system. At the same time reversed fix 229202.       *
      *  AR823701 - Incorrect calculated Debit interest for Account   *
      *             with Tiered and Threshold                         *
      *  CER049 - Stamp Tax                                           *
      *  AR787620 - Hooks Incorporation                               *
      *             WNCPYSRC,REH00001                                 *
      *             WNCPYSRC,REH00003                                 *
      *             WNCPYSRC,REH00004                                 *
      *             WNCPYSRC,REH00005                                 *
      *             WNCPYSRC,REH00006                                 *
      *             WNCPYSRC,REH00007                                 *
      *             WNCPYSRC,REH00002                                 *
      *  AR784694 - Negative amount shown in Tax field for            *
      *             non-resident                                      *
      *  AR763412 - The tax resident field reflected the total tax    *
      *             amount of joint customer and primary customer     *
      *             in OSIC screen                                    *
      *  AR755349 - TAX AMOUNT IS STILL AVAILABLE WHEN AVAILABLE      *
      *             BALANCE IS ZERO. (Child: AR755350)                *
      *  AR751622 - Erroneous generated interest for Retail Account   *
      *             (non-leap year) when calculation basis is 0. Need *
      *             to include SR ZICD CER016 changes in /COPY        *
      *             ZICDREZ2 - (Recompile)                            *
      *             (Child: AR751623)                                 *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG26839 - JA1_Threshold limit of the main joint customer was*
      *             utilized by the member                            *
      *  BUG26363 - Tax/Resident" field name in the "Outstanding      *
      *             Interest / Charges" is missing                    *
      *  BUG25942 - Incorrect taxes on joint account w/o members      *
      *  BUG23777 - User cannot enquire another account after an      *
      *             enquiry                                           *
      *  BUG24137 - OSIC Fields not in line (Recompile)               *
      *  CER054 - German Features - Church Tax                        *
      *  BUG23987 - Local Tax Customer scenario not correct           *
      *  BUG23325 - Enquiries have been changed only to show the local*
      *             tax that has been calculated for residents where a*
      *             threshold method is used. This is because we      *
      *             cannot predict how much the tax will be in the    *
      *             future as we do not know how much of the threshold*
      *             will have been used at that time.                 *
      *  BUG23178 - Total Outstanding for OSIC Enquiry incorrect      *
      *  BUG23126 - Enquiry showing tax deducted for non taxable      *
      *           customer                                            *
      *  BUG22911 - Changes for Correct Tax Calculation               *
      *  BUG22953 - Secondary and Main tax not calculated on OSIC     *
      *  CER048 - German Features - Taxes                             *
      *  CER016 - German Interest Calculation: Upgrade of FGE059      *
      *           to Midas Plus                                       *
      *  CDL081 - Tiered withholding tax rounding upgrade             *
      *  BUG26486 - Coding standard (recompile)                       *
      *  260297 - Incorrect interest calculation w/ calc basis 6.     *
      *           Externalise SR/ZICD and patterned additional fix    *
      *           from ZINTDYZ2. Applied fix 220323.                  *
      *  260322 - Manual debit/credit adjustment not reflected when   *
      *           inquired in Outstanding Interest enquiry (F14).     *
      *           Reposition MADI and MACI in LDA to coincide with    *
      *           the changes in RE3363.                              *
      *  CRE026 - Consumer Banking                                    *
      *  249907 - Applied core fix 243718                             *
      *  243718 - Interest credit zero on first account enquired on,  *
      *           or wrong interest credit amount shown if previous   *
      *           account had been viewed. Rename HISB field.         *
      *  241027 - Replace full GL account number with retail account  *
      *           to reflect link account information whenever retail *
      *           account numbers are used in the system.             *
      *  239964 - Applied fix 239966.                                 *
      *  BUG11679 - Additional Conversion of Customer Number to Alpha.*
      *  CRE024  -  Country Level Switchable Feature :                *
      *             Security Features for Restricted Accounts.        *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  240452 - Refresh is not done if new account is input         *
      *           and command F13 or F14 were taken before            *
      *  211909 - Fixed not to issue DBASE error when RECI = 'C'.     *
      *           Fix covered by 229202                               *
      *  206669 - Include generated adjustments as well as manual     *
      *           adjustments in the calculation of withholding tax.  *
      *           Patterned after fix 202415.                         *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  240079 - Applied fix 239966.                                 *
      *  239966 - Remove transfer job.                                *
      *  238209 - Interest calculation in OSIC and RE3662 has a       *
      *           difference of 0.01.  Access LF/REHISL to compute    *
      *           for the interest. Fix annotated as 220566           *
      *  CDL013 - Tiered Withholding Tax                              *
      *  229202 - Fixed not to issue DBASE error when RECI = 'C' on   *
      *           REACR file (closed account).  Also display error    *
      *           message "ACCOUNT CLOSED" when closed account is     *
      *           chosen.  Applied fix 227030.                        *
      *  236095 - EU tax field not initialised.                       *
      *  234034 - OSIC and capitalisation of interest should not      *
      *           calculate any EU taxes before effective date        *
      *  CGL035 - EUSD Upgrade to MidasPlus                           *
      *  CGL031 - Taxation of Savings Income                          *
      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
      *  CSD025 - Customer De-Activation                              *
      *  CSW037 - Additional Field Data on MT300/MT320                *
      *  CSW036 - Dual SWIFT BIC held on Client Details               *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Webfacing Changes.                                  *
      *           Reverse image is showing in Webface without error.  *
      *           Recompile due to changes in RE3360DF.               *
      *         - Recompiled due to change in RE3360DF by CAAA02.     *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  209861 - Record not found when retail account number used.   *
      *  196856 - Allow OSIC enquiry of closed accounts.              *
      *  CDE002 - Revenue Analysis - Recompiled due to changes in     *
      *           PF/ACCNTBXC.                                        *
     F*  185277 - Recompile due to change in /COPY member RBEQENC1    *
      *  CSD007 - Customer Closing                                    *
     F*  174820 - If Account is not taxable, don't calculate taxes.   *
     F*  159536 - Display primary or secondary linked account if the  *
     F*           account is a primary or secondary linked account.   *
     F*  153001 - A/c failed to close because minimum charge posted   *
     F*           so balance was not zero. If a/c flagged for closure *
     F*           show actual charges, ie. do not apply minimum or    *
     F*           maximum charge. Also if a/c not flagged for closure *
     F*           ensure maximum is shown if one is set up.           *
     F*  130468 - BRT not deducted from CR interest adjustments.      *
     F*           Do not calculate BRT if total of CR interest plus   *
     F*           adjustments is debit.                               *
     F*  103460 - Only charge interest if the balance exceeds the     *
     F*           initial threshhold.                                 *
     F*  117208 - Commissions on no of daily statements is wrongly    *
     F*           calculated.                                         *
     F*  124019 - Set up field WBRCH to avoid DB Error in later pgms. *
     F*  CRE001  -  Overdraft Interest Calculation:                   *
     F*             To include the Additional Overdraft Rate in       *
     F*             the calculation of all DR interest and DR         *
     F*             accrual amounts shown on enquiry.                 *
     F*  CRT002 - Retail Branch Access.                               *
     F*  CCB002 - COB Performance Enhancements                        *
     F*           Access now via access object                        *
     F*           Change MEMOS processing to use access objects.      *
     F*  S01408  -  Hook RE3360IIP1 added.                            *
     F*             Hook RE3360IIP2 added.                            *
     F*             Hook RE3360CP15 added.                            *
     F*             Hook RE3360CP14 added.                            *
     F*             Hook RE3360CP13 added.                            *
     F*             Hook RE3360CP12 added.                            *
     F*             Hook RE3360CP11 added.                            *
     F*             Hook RE3360CP10 added.                            *
     F*             Hook RE3360CCP9 added.                            *
     F*  089811 - A/c no. highlighted if a/c flagged for closure. Do  *
     F*           not use ind. 25 when processing SDALTNL0.           *
     A*  086086 - Don't allow CF14 (RE3363) if RECI not D (closed     *
     A*           during previous COB) . If closed accnt RE3363 shows *
     A*           spurious capitalisation record THEN RE3364E dumps   *
     A*           with DBERR as no REHISL .                           *
     A*           Indicator 86 if RECI=D (ie Live).                   *
     F*  075071 - Recompiled over amended DSPF, although the amended  *  *
     F*           are ignored in this pgm.                            *  *
     F*  094431 - Problem with manual adjustments not displayed.      *  *
     F*  088734 - Show minimum/maximum amounts to capitalise if these *
     F*           are defined on the Retail ICD by currency for the   *
     F*           currency of the account.                            *
     F*  S01408 - Addition of core hooks RE3360CCP8.                  *
     F*  094687 - DB error in TABLEV4 : When the statement frequency  *
     F*           for the account is 'E' the program requires a       *
     F*           customer group; if blank, default to 1.             *
     F*  S01408 - Addition of core hooks RE3360CCP7.                  *
     F*  S01408 - Addition of core hooks RE3360CCP5.                  *
     F*                                  RE3360CCP6.                  *
     F*                                  RE3360FFP1.                  *
     F*  088029 - Field 'RESULT' Not Correctly Formatted When         *
     F*           American Date Format is Used.                       *
     F*  S01408 - Addition of core hooks RE3360CCP1.                  *
     F*                                  RE3360CCP2.                  *
     F*                                  RE3360IIPG.                  *
     F*                                  RE3360CCPG.                  *
     F*                                  RE3360CCP3.                  *
     F*                                  RE3360CCP4.                  *
     F*  077563  -  If a DBE occured in an FF/EOC, reopen was not     *
     F*             possible because PF/MEMOSM1 was allocated         *
     F*  077872  -  CORRECT BRT DETAILS FIELD EDITING ETC.            *
     F*  076189  -  CHAIN TO ABSFI101 SHOULD BE CONDITIONED ON VAT    *
     F*             BEING USED.                                       *
     F*  S01408  -  Hook RE3262CLD1 added.                            *
     F*             Hook RE3262CLD2 added.                            *
     F*             Hook RE3262CLD3 added.                            *
     F*             Hook RE3262CLD4 added.                            *
     F*             Hook RE3262CLD5 added.                            *
     F*             Hook RE3262CLD6 added.                            *
     F*  074590  -  Add account name to screen format. (Recompiled).  *
     F*  074578  -  Tiered interest not rounded correctly             *
     F*  S01413 - Retail 3 Incorporation                              *
     F*                                                               *
     F*****************************************************************
     F***RE3360DFCF  E                    WORKSTN                         CRT002
     FRE3360DFCF  E                    WORKSTN                        UC  CRT002
     F            RE3361F0                          KIGNORE
     F            RE3361ER                          KIGNORE
     F            RE3361F1                          KIGNORE
     F            RE3361SB                          KIGNORE
     F            RE3361SC                          KIGNORE
     F            RE3362E0                          KIGNORE
     F            RE3362F0                          KIGNORE
     F            RE3362HE                          KIGNORE
     F            RE3362PB                          KIGNORE
     F            RE3362PC                          KIGNORE
     F            RE3363F0                          KIGNORE
     F            RE3363F1                          KIGNORE
     F            RE3363F2                          KIGNORE
     F            RE3363F3                          KIGNORE
     F            RE3363B1                          KIGNORE
     F            RE3363C1                          KIGNORE
     F            RE3363B2                          KIGNORE
     F            RE3363C2                          KIGNORE
     F            RE3364E3                          KIGNORE
     F            RE3364F3                          KIGNORE
     F            RE3364F1                          KIGNORE
     F            RE3364B1                          KIGNORE
     F            RE3364C1                          KIGNORE
     F            RE3364B2                          KIGNORE
     F            RE3364C2                          KIGNORE
     F            RE3364B3                          KIGNORE
     F            RE3364C3                          KIGNORE
     FREHISL  IF  E           K        DISK                                                   220566
     F            REHISPMF                          KIGNORE                                   220566
     F                                              KINFDS REHDS                              220566
     F                                              KINFSR REHSR                              220566
     FSDBRTDL1IF  E           K        DISK
     FACCNT   IF  E           K        DISK
     F            ACCNTAAF                          KIGNORE
     F            ACCNTACF                          KIGNORE
     FACCNTBXCIF  E           K        DISK                               CRE001
     F*MEMOS***IF**E                    DISK                              CCB002
     F*MEMOSM1*IF**E           K        DISK                              077563
     FMEMOSM1 IF  E           K        DISK                           UC  077563
     FREIAC   IF  E           K        DISK
     F            REIACAF                           KIGNORE
     F            REIACZF                           KIGNORE
     FRECRG   IF  E           K        DISK
     F            RECRGAF                           KIGNORE
     F            RECRGZF                           KIGNORE
     FACNUM   IF  E           K        DISK
     F            ACCNTABF                          KRENAMEACNUMF
     FREHRCJ  IF  E           K        DISK
     FREHRDJ  IF  E           K        DISK
     FRECCY   IF  E           K        DISK
     F            RECCYAF                           KIGNORE
     F            RECCYZF                           KIGNORE
     FRECOM   IF  E           K        DISK
      *                                                                                       CDL013
     FACCNTBY0IF  E           K        DISK         KINFSR DBSR                               CDL013
     F            ACCNTBD0                          KRENAMEACCNTE                             CDL013
      ** Account Details extension file                                                       CDL013
      *                                                                                       CDL013
     FSDSTAAL1IF  E           K        DISK         KINFSR DBSR                               CDL013
      ** Withholding Tax ICD extension file                                                   CDL013
     FSDALTNL0IF  E           K        DISK
     FSDSTAXPDIF  E                    DISK
     FABSFI101IF  E                    DISK
     FTABTBRE IF  E                    DISK
     FTABLEV4 IF  E                    DISK
     FREACR   IF  E           K        DISK                           UC
     F                                              KINFDS READS
     F                                              KINFSR REASR
     F            REACRAF                           KIGNORE
     F            REACRZF                           KIGNORE
      *                                                                                     BUG23325
      ** Midas SD Customer Income by Deal/Trade Number                                      BUG23325
      *                                                                                     BUG23325
     FSDCSINLGIF  E           K        DISK         KINFSR *PSSR                            BUG23325
      *                                                                                     BUG23325
     FSDCSINLLIF  E           K        DISK         KINFSR *PSSR                            AR763412
     F            SDCSIND0                          KRENAMESDCSIND1                         AR763412
      *                                                                                     AR763412
     FRELINKL1IF  E           K        DISK                               159536
     FRELINKJ2IF  E           K        DISK                               159536
     FSDJACCLBIF  E           K        DISK                                                   CGL031
     FREHISDL IF  E           K        DISK                                                   CRE090
     F            REHISPPF                          KRENAMEREHISPAF                           CRE090
     FRE3360AUO   E                    PRINTER
      *                                                                   CRT002
      /COPY ZSRSRC,RBWLOGF1                                               CRT002
     F*
     F/COPY WNCPYSRC,RE3360FFP1
     FREEAUDPPO   E                    DISK                                                   CGL183
     F*
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
      *       05       READE INDICATOR - SDJACCLB                     *                       CGL031
     F*       11       COMMISSION ON DEBIT TURNOVER                   *
     F*       12       COMMISSION ON HIGHEST OVERDRAFT                *
     F*       13       FIXED ACCOUNT CHARGE                           *
     F*       14       CHARGE ON NUMBER OF DAILY STATEMENTS           *
     F*       15       COMMISSION ON DEBIT INTEREST                   *
     F*       16       COMMISSION ON MINIMUM AVERAGE BALANCE          *
     F*       17       CHARGE ON INACTIVE ACCOUNT                     *
     F*       18       VAT PROCESSING                                 *
     F*                                                               *
     F*       20       NON-DISPLAY ERROR MESSAGE AND ERROR CODE.      *
     F*       21       NON-DISPLAY BALANCE FIELDS FOR INITIAL SCREEN. *
     F*       22       CONDITION OUTPUT FOR MESSAGE                   *
     F*       23       CONDITION OUTPUT FOR BRANCH                    *
     F*       24       REVERSE IMAGE A/C DETAILS                      *
     F*       25       REVERSE IMAGE RETAIL NO.                       *
     F*       26       REVERSE IMAGE BRANCH CODE.                     *
     F*                                                               *
     F*       28       BRT LIABLE                                     *
      *       29       EU WITHHOLDING TAX <> 0                        *                       CGL031
     F*       30       BRANCH CODE FIELD BLANK ON INPUT               *
     F*       33       ACCOUNT IS A PRIMARY ACCOUNT.                  *   159536
     F*       34       ACCOUNT IS A SECONDARY ACCOUNT.                *   159536
     F*       36       BRANCH CODE FIELD BLANK (MBIN = 'Y')           *
     F*       37       MULTIBRANCHING INDICATOR                       *
     F*       42       NON-DISPLAY DR INTEREST ALTERNATIVE A/C FIELDS *
     F*       43       NON-DISPLAY CR INTEREST ALTERNATIVE A/C FIELDS *
     F*       44       NON-DISPLAY CHARGES ALTERNATIVE A/C FIELDS     *
     F*       45       NON-DISPLAY THE PHRASE 'ALTERNATIVE ACCOUNT'   *
     F*                                                               *
     F*       46       MODI5 BIT0 ON FOR FF MODULE                    *
     F*       47       READE MEMOSM1 INDICATOR FF AMENDMENT           *
     F*       49       Record not found on REHISL file                *                       220566
     F*       50       CHAIN FAIL IN ACCNTBXC                         *   CRE001
     F*       51       END-OF-FILE / BEGINNING-OF-FILE IND. REHRDJ    *
     F*       52       END-OF-FILE / BEGINNING-OF-FILE IND. REHRCJ    *
     F*       54       SAR CRE001 IS ACTIVE                           *   CRE001
     F*       56       MAXIMUM CHARGE VALUE IS NON-ZERO               *
     F*       57       MINIMUM CHARGE VALUE IS NON-ZERO               *
     F*       58       NON-DISPLAY CORRECTED CHARGE AMOUNT            *
     F*       60       VALID GROUP INDICATOR (IN TABLEV4)             *
     F*       61       CHAIN FAIL IN RECCY                            *
     F*       62       CHAIN FAIL IN RECOM                            *
     F*       65       File ind. - SDALTNL0                           *   089811
     F*       68       RACN = 'Y'                                     *
     F*                                                               *
     F*       70       NUMBER OF DECIMAL POSITION WITH CURRENCY = 0   *
     F*       71       NUMBER OF DECIMAL POSITION WITH CURRENCY = 1   *
     F*       72       NUMBER OF DECIMAL POSITION WITH CURRENCY = 2   *
     F*       73       NUMBER OF DECIMAL POSITION WITH CURRENCY = 3   *
     F/COPY WNCPYSRC,RE3360F001
     F*                                                               *
      *       81       CGL031 FEATURE IS SWITCHED ON                  *                       CGL031
     F*       87       UNABLE TO ALLOCATE RECORD                      *
     F*       88       SHOW STATUS ON DB ERROR REPORT                 *
     F*       89       COMPLETE AUDIT FOR DATABASE ERROR              *
     F*       98       DATE FORMAT FLAG                               *
     F*       99       GENERAL ERROR AND CHAINING                     *
     F*                                                               *
     F*       LR       END OF PROGRAM                                 *
     F*                                                               *
     F*       U7       DATABASE ERROR                                 *
     F*       U8       DATABASE ERROR                                 *
     F*                                                               *
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  ACCNUM - A/C details have been entered                       *
     F*  CRINIT - Credit rate fields init processing                  *
     F*  DATEIN - Searching end-of-month date processing              *
     F*  DBSR   - Database error handling processing                  *
     F*  DFPROC - Display file processing                             *
     F*  DRINIT - Debit rate fields init processing                   *
     F*  DTQERR - Error processing for PC mode                        *   CRT002
     F*  DTQOUT - Format screen to output to data queue               *   CRT002
      *  SREUTX - Calculate European Withholding Tax.                 *                       CGL031
      *  SRJACC - Process records from SDJACCLB (CGL031 Feature)      *                       CGL031
     F*  FIRST  - First cycle processing                              *
     F*  INTCAL - Interest calculation between two dates              *
     F*  MAIN   - Main processing                                     *
     F*  REHSR  - REHISL file exception/error handling                *                       220566
     F*  MOVDTQ - Send details to data queue                          *   CRT002
     F*  *PSSR  - Handles abnormal error conditions                   *
     F*  RETNUM - Retail number only has been entered                 *
     F*  SCROUT - Live record found - format screen output            *
     F*  TFPARM - Transfering parameters processing                   *
     F*  WRLOG  - Update log file                                     *   CRT002
     F*  ZDATE1 - Validates and Converts a Date to Number of Days     *
     F*  ZDATE2 - Validates and Converts Number of Days to a Date     *
     F*  ZICD   - Find number of days to calculate interest according *
     F*           to calculation basis processing                     *
     F*  ZIC00  - Interest calculation (type=00) processing           *
     F*  ZIC01  - Interest calculation (type=01) processing           *
     F*  ZIC02  - Interest calculation (type=02) processing           *
     F*                                                               *
     F*****************************************************************
     E/EJECT
     E                    CPY@    1   1 80               COPYRIGHT
     E                    ZYDY    4   4  4 0             ZDATE1/2 SR.ARRAY
     E                    ZMDY   13  13  3 0             ZDATE1/2 SR.ARRAY
     E                    ZMNM   12  12  3               ZDATE2 SR. ARRAY
     E/COPY WNCPYSRC,RE3360E001
     E**********          ERCM    1   9 79               ERROR MESSAGES                       262397
     E                    ERCM    1  10 79               Error Messages                       262397
     E/COPY WNCPYSRC,RE3360E002
     E                    SRCD       19  4               ERROR CODES
     E***********         CMDL    1   1 80               Command Key Line CRT002
     E                    ZIR        11 11 7             ZIC. INT.RATES
     E                    ZIRD       11 11 7             ZIC. INT.RATES
     E                    ZIRC       11 11 7             ZIC. INT.RATES
     E                    ZIB        11 15 0A            ZIC. INT.BALANCES
     E                    ZIBD       11 15 0             ZIC. INT.BALANCES
     E                    ZIBC       11 15 0             ZIC. INT.BALANCES
     E                    ZIN        11 13 0             ZIC. INT.CALC
     E**********          ZIN1       11 18 5             ZIC. INT.CALC                 074578 220323
     E                    ZIN1       11 30 9             ZIC. INT.CALC                        220323
     E                    ZIA        11 15 0             ZIC. WORK ARRAY
     E**********          ZIA1       11 15 5             ZIC. WORK ARRAY                      220323
     E                    ZIA1       11 30 9             ZIC. WORK ARRAY                      220323
     E                    ZIA2       11 15 0                                                  CER016
     E                    WZIB       11 15 0A                                               AR823701
      /COPY ZSRSRC,ZFRPEDZ1                                               CRT002
     I/EJECT
     IREHISPPF                                                                                220566
      *                                                                                       220566
      ** RENAME REHISPPF FORMAT RECI - REHISL FILE                                            220566
      *                                                                                       220566
     I              RECI                            WRECI                                     220566
     I              HISD                            DHISD                                     220566
     I              MNBL                            BMNBL                                     220566
     I              MACI                            BMACI                                     220566
     I              MADI                            BMADI                                     220566
     I              DRCD                            BDRCD                                     220566
     I              CRCD                            BCRCD                                     220566
     I              HISB                            BHISB                                     220566
     IREHISPSF                                                                                220566
      *                                                                                       220566
      ** RENAME REHISPSF FORMAT RECI - REHISL FILE                                            220566
      *                                                                                       220566
     I              RECI                            WRECI                                     220566
     I              HISD                            DHISD                                     220566
     I              HISB                            BHISB                                     243718
     I              MNBL                            DMNBL                                     220566
     I              CRIS                            DCRIS                                     220566
     I              DRIS                            DDRIS                                     220566
     I              DRCD                            DDRCD                                     220566
     I              CRCD                            DCRCD                                     220566
     I              DAIC                            DDAIC                                     220566
     I              CAIC                            DCAIC                                     220566
     I              SDACP                           DSDCP                                     220566
     I              SCACP                           DSCCP                                     220566
     I              DRBR                            DDRBR                                     220566
     I              CRBR                            DCRBR                                     220566
     I              CHBR                            DCHBR                                     220566
     I*
     IREACRDF
     I*
     I** RENAME REACRDF FORMAT FIELDS - REACR FILE
     I*
     I              RECI                            RRECI
     I              ACOD                            RACOD
     I              BRCA                            RBRCA
     I              LCD                             RHISD
     I              TNLU                            RTNLU
     I              ORED                            RORED
     I              CHTP                            RCHTP
     I              DAIC1                           DAIC
     I              CAIC1                           CAIC
     I              HISB                            RHISB
     I*
     IACCNTABF
     I*
     I** RENAME ACCNTABF FORMAT FIELDS - ACCNT FILE
     I*
     I              CAIC                            ACAIC
     I              DAIC                            ADAIC
     I              GACI                            AGACI
     I              GADI                            AGADI
     I              MACI                            AMACI
     I              MADI                            AMADI
     I              BRTCA                           ABRTCA
     IREHRCJF
     I*
     I** RENAME REHRCJF FORMAT FIELDS - REHRCJ FILE
     I*
     I              INTH                            INTHC
     I*
     IREHRDJF
     I*
     I** RENAME REHRDJF FORMAT FIELDS - REHRDJ FILE
     I*
     I              INTH                            INTHD
     I*                                                                   159536
     IFUSIONJF                                                            159536
     I*                                                                   159536
     I** RENAME FUSIONJF FORMAT FIELDS - RELINKJ2 FILE                    159536
     I*                                                                   159536
     I              BRCA                            W#BRCH                159536
     I              CNUM                            W#CUST                159536
     I              CCY                             W#CCY                 159536
     I              ACOD                            W#ACOD                159536
     I              ACSQ                            W#ACSQ                159536
     I              ACNO                            W#ACNO                159536
     IREHISPAF                                                                                CRE090
     I              RECI                            RARECI                                    CRE090
     I              ZZ001                           RAZZ01                                    CRE090
     I              BRCA                            RABRCA                                    CRE090
     I              CNUM                            RACNUM                                    CRE090
     I              CCY                             RACCY                                     CRE090
     I              ACODQQ                          RAACDQ                                    CRE090
     I              ACSQ                            RAACSQ                                    CRE090
     I              HISD                            RAHISD                                    CRE090
     I              HISB                            RAHISB                                    CRE090
     I              MNBL                            RAMNBL                                    CRE090
     I              CHGAR                           RACHGA                                    CRE090
     I              TCHGAR                          RATCHR                                    CRE090
     I              CHGAN                           RACHGN                                    CRE090
     I              TCHGAN                          RATCHG                                    CRE090
     I              DMVT                            RADMVT                                    CRE090
     I              DICT                            RADICT                                    CRE090
     I              DRCB                            RADRCB                                    CRE090
     I              DRIR                            RADRIR                                    CRE090
     I              DRCD                            RADRCD                                    CRE090
     I              DAID                            RADAID                                    CRE090
     I              MADI                            RAMADI                                    CRE090
     I              TMADI                           RATMAI                                    CRE090
     I              PDID                            RAPDID                                    CRE090
     I              DMINT                           RADMNT                                    CRE090
     I              CMVT                            RACMVT                                    CRE090
     I              CICT                            RACICT                                    CRE090
     I              CRCB                            RACRCB                                    CRE090
     I              CRIR                            RACRIR                                    CRE090
     I              CRCD                            RACRCD                                    CRE090
     I              CAID                            RACAID                                    CRE090
     I              MACI                            RAMACI                                    CRE090
     I              TMACI                           RATMCI                                    CRE090
     I              PCID                            RAPCID                                    CRE090
     I              CMINT                           RACMNT                                    CRE090
     I              DICI                            RADICI                                    CRE090
     I              CICI                            RACICI                                    CRE090
     I              DRCI                            RADRCI                                    CRE090
     I              CRCI                            RACRCI                                    CRE090
     I              VDTC                            RAVDTC                                    CRE090
     I              ADTY                            RAADTY                                    CRE090
     I              ALTI                            RAALTI                                    CRE090
     I              MNBCP                           RAMNBP                                    CRE090
     I              LGID                            RALGID                                    CRE090
     I              VALL                            RAVALL                                    CRE090
     I              LINK                            RALINK                                    CRE090
     I              ZZ008                           RAZZ08                                    CRE090
     I              AODR                            RAAODR                                    CRE090
     I              ODRL                            RAODRL                                    CRE090
     I              ODLI                            RAODLI                                    CRE090
     I              ODIA                            RAODIA                                    CRE090
     I              ACOD                            RAACOD                                    CRE090
     I*
      *
     I/COPY WNCPYSRC,RE3360IIP1
      *
     IREADS       DS
     I*
     I** DATA STRUCTURE FOR RPG ERROR HANDLING
     I*
     I                                     *STATUS  STSREA
     IREHDS       DS                                                                          220566
     I                                     *STATUS  STSREH                                    220566
     I*
     I** DATA STRUCTURE FOR ALTERNATIVE ACCOUNTS
     I*
     I            DS
     I**********                              1  15 DACP                                      CGL029
     I                                        1  21 DACP                                      CGL029
     I                                        1   5 DRA05
     I**********                              6  15 DRA15                                     CGL029
     I**********                             16  30 CACP                                      CGL029
     I**********                             16  20 CRA05                                     CGL029
     I**********                             21  30 CRA15                                     CGL029
     I**********                             31  45 CHAC                                      CGL029
     I**********                             31  35 CHA05                                     CGL029
     I**********                             36  45 CHA15                                     CGL029
     I                                        6  21 DRA15                                     CGL029
     I                                       22  42 CACP                                      CGL029
     I                                       22  26 CRA05                                     CGL029
     I                                       27  42 CRA15                                     CGL029
     I                                       43  63 CHAC                                      CGL029
     I                                       43  47 CHA05                                     CGL029
     I                                       48  63 CHA15                                     CGL029
     I*
     I** DATA STRUCTURE FOR DATE FORMAT DD/MM/YY
     I*
     I            DS
     I                                        1   60RESULT
     I                                        1   20ZDAY
     I                                        3   40ZMTH
     I                                        5   60ZYEAR
     I*
     I** DATA STRUCTURE FOR BEGINNING DATE
     I*
     I            DS
     I                                        1   60SRES
     I                                        1   20ZISD
     I                                        3   40ZISM
     I                                        5   60ZISY
     I*
     I** DATA STRUCTURE FOR FINISHING DATE
     I*
     I            DS
     I                                        1   60FRES
     I                                        1   20ZIFD
     I                                        3   40ZIFM
     I                                        5   60ZIFY
     I*                                                                   088029
     I** DATA STRUCTURE FOR DATE FORMAT MM/DD/YY                          088029
     I*                                                                   088029
     I            DS                                                      088029
     I                                        1   60RESULX                088029
     I                                        1   20ZMTHX                 088029
     I                                        3   40ZDAYX                 088029
     I                                        5   60ZYEARX                088029
     I*                                                                   088029
     I** DATA STRUCTURE FOR BEGINNING DATE MM/DD/YY                       088029
     I*                                                                   088029
     I            DS                                                      088029
     I                                        1   60SRESX                 088029
     I                                        1   20ZISMX                 088029
     I                                        3   40ZISDX                 088029
     I                                        5   60ZISYX                 088029
     I*                                                                   088029
     I** DATA STRUCTURE FOR FINISHING DATE MM/DD/YY                       088029
     I*                                                                   088029
     I            DS                                                      088029
     I                                        1   60FRESX                 088029
     I                                        1   20ZIFMX                 088029
     I                                        3   40ZIFDX                 088029
     I                                        5   60ZIFYX                 088029
     I*
     IWDBAL       DS
     I*
     I** DATA STRUCTURE TO SPLIT FROM ALPHA TO NUMERIC DEBIT AND
     I** CREDIT BALANCES
     I*
     I                                    P   1  880ZIBD
     I                                    P   1   80ZBD01
     I                                    P   9  160ZBD02
     I                                    P  17  240ZBD03
     I                                    P  25  320ZBD04
     I                                    P  33  400ZBD05
     I                                    P  41  480ZBD06
     I                                    P  49  560ZBD07
     I                                    P  57  640ZBD08
     I                                    P  65  720ZBD09
     I                                    P  73  800ZBD10
     I                                    P  81  880ZBD11
     I                                    P  89  960ZBD12
     I*
     IWCBAL       DS
     I                                    P   1  880ZIBC
     I                                    P   1   80ZBC01
     I                                    P   9  160ZBC02
     I                                    P  17  240ZBC03
     I                                    P  25  320ZBC04
     I                                    P  33  400ZBC05
     I                                    P  41  480ZBC06
     I                                    P  49  560ZBC07
     I                                    P  57  640ZBC08
     I                                    P  65  720ZBC09
     I                                    P  73  800ZBC10
     I                                    P  81  880ZBC11
     I                                    P  89  960ZBC12
     I*
     IWDRAT       DS
     I*
     I** DATA STRUCTURE TO SPLIT FROM ALPHA TO NUMERIC DEBIT & CREDIT RATES
     I*
     I                                    P   1  667ZIRD
     I                                    P   1   67ZRD01
     I                                    P   7  127ZRD02
     I                                    P  13  187ZRD03
     I                                    P  19  247ZRD04
     I                                    P  25  307ZRD05
     I                                    P  31  367ZRD06
     I                                    P  37  427ZRD07
     I                                    P  43  487ZRD08
     I                                    P  49  547ZRD09
     I                                    P  55  607ZRD10
     I                                    P  61  667ZRD11
     I                                    P  67  727ZRD12
     I*
     IWCRAT       DS
     I                                    P   1  667ZIRC
     I                                    P   1   67ZRC01
     I                                    P   7  117ZRC02
     I                                    P  13  187ZRC03
     I                                    P  19  247ZRC04
     I                                    P  25  307ZRC05
     I                                    P  31  367ZRC06
     I                                    P  37  427ZRC07
     I                                    P  43  487ZRC08
     I                                    P  49  547ZRC09
     I                                    P  55  607ZRC10
     I                                    P  61  667ZRC11
     I                                    P  67  727ZRC12
     I*
     I** DATA STRUCTURE FOR CURRENCY DECIMAL
     I*
     I            DS
     I                                        1  150HISB0
     I                                        1  151HISB1
     I                                        1  152HISB2
     I                                        1  153HISB3
     I*
     I            DS
     I                                        1  150SLDBL0
     I                                        1  151SLDBL1
     I                                        1  152SLDBL2
     I                                        1  153SLDBL3
     I*
     I            DS
     I                                        1  150SCLBL0
     I                                        1  151SCLBL1
     I                                        1  152SCLBL2
     I                                        1  153SCLBL3
     I*
     I            DS
     I                                        1  150DAIC0
     I                                        1  151DAIC1
     I                                        1  152DAIC2
     I                                        1  153DAIC3
     I*
     I            DS
     I                                        1  150CAIC0
     I                                        1  151CAIC1
     I                                        1  152CAIC2
     I                                        1  153CAIC3
     I*                                                                   077872
     I            DS                                                      077872
     I                                        1  130BRTOT0                077872
     I                                        1  131BRTOT1                077872
     I                                        1  132BRTOT2                077872
     I                                        1  133BRTOT3                077872
     I*
     I            DS
     I                                        1  150GADI0
     I                                        1  151GADI1
     I                                        1  152GADI2
     I                                        1  153GADI3
     I*
     I            DS
     I                                        1  150GACI0
     I                                        1  151GACI1
     I                                        1  152GACI2
     I                                        1  153GACI3
     I*
     I            DS
     I                                        1  150MADI0
     I                                        1  151MADI1
     I                                        1  152MADI2
     I                                        1  153MADI3
     I*
     I            DS
     I                                        1  150MACI0
     I                                        1  151MACI1
     I                                        1  152MACI2
     I                                        1  153MACI3
     I*
     I            DS
     I                                        1  150RCA0
     I                                        1  151RCA1
     I                                        1  152RCA2
     I                                        1  153RCA3
     I*
     I            DS
     I                                        1  150NRCA0
     I                                        1  151NRCA1
     I                                        1  152NRCA2
     I                                        1  153NRCA3
     I*
     I            DS
     I                                        1  150MAXC0
     I                                        1  151MAXC1
     I                                        1  152MAXC2
     I                                        1  153MAXC3
     I*
     I            DS
     I                                        1  150MINC0
     I                                        1  151MINC1
     I                                        1  152MINC2
     I                                        1  153MINC3
     I*
     I            DS
     I                                        1  150SCACC0
     I                                        1  151SCACC1
     I                                        1  152SCACC2
     I                                        1  153SCACC3
     I*
     I            DS
     I                                        1  150SCHDB0
     I                                        1  151SCHDB1
     I                                        1  152SCHDB2
     I                                        1  153SCHDB3
     I*
     I            DS
     I                                        1  150SACCE0
     I                                        1  151SACCE1
     I                                        1  152SACCE2
     I                                        1  153SACCE3
     I*
     I            DS
     I                                        1  150SCDIE0
     I                                        1  151SCDIE1
     I                                        1  152SCDIE2
     I                                        1  153SCDIE3
     I*
     I            DS
     I                                        1  150SIACE0
     I                                        1  151SIACE1
     I                                        1  152SIACE2
     I                                        1  153SIACE3
     I*
     I            DS
     I                                        1  150SCMBE0
     I                                        1  151SCMBE1
     I                                        1  152SCMBE2
     I                                        1  153SCMBE3
     I*
     I            DS
     I                                        1  150SCDYS0
     I                                        1  151SCDYS1
     I                                        1  152SCDYS2
     I                                        1  153SCDYS3
     I*
     I            DS
     I                                        1  150SFXDC0
     I                                        1  151SFXDC1
     I                                        1  152SFXDC2
     I                                        1  153SFXDC3
     I*
     I            DS
     I                                        1  150STVAT0
     I                                        1  151STVAT1
     I                                        1  152STVAT2
     I                                        1  153STVAT3
     I*
     I            DS
     I                                        1  150STOTO0
     I                                        1  151STOTO1
     I                                        1  152STOTO2
     I                                        1  153STOTO3
     I            DS                                                      088734
     I                                        1  130MINBD0                088734
     I                                        1  131MINBD1                088734
     I                                        1  132MINBD2                088734
     I                                        1  133MINBD3                088734
     I            DS                                                      088734
     I                                        1  130MAXBD0                088734
     I                                        1  131MAXBD1                088734
     I                                        1  132MAXBD2                088734
     I                                        1  133MAXBD3                088734
     I            DS                                                      088734
     I                                        1  130MINBC0                088734
     I                                        1  131MINBC1                088734
     I                                        1  132MINBC2                088734
     I                                        1  133MINBC3                088734
     I            DS                                                      088734
     I                                        1  130MAXBC0                088734
     I                                        1  131MAXBC1                088734
     I                                        1  132MAXBC2                088734
     I                                        1  133MAXBC3                088734
      *                                                                                       CGL031
     I            DS                                                                          CGL031
     I                                        1  150EUTAX0                                    CGL031
     I                                        1  151EUTAX1                                    CGL031
     I                                        1  152EUTAX2                                    CGL031
     I                                        1  153EUTAX3                                    CGL031
      *                                                                                       CER048
     I**********  DS                                                                 CER048 BUG23325
     I**********                              1  150SSTAX0                           CER048 BUG23325
     I**********                              1  151SSTAX1                           CER048 BUG23325
     I**********                              1  152SSTAX2                           CER048 BUG23325
     I**********                              1  153SSTAX3                           CER048 BUG23325
     I            DS                                                                          CGL165
     I                                        1  150SSTAX0                                    CGL165
     I                                        1  151SSTAX1                                    CGL165
     I                                        1  152SSTAX2                                    CGL165
     I                                        1  153SSTAX3                                    CGL165
     I            DS                                                                          CER049
     I                                        1  150SCHCO0                                    CER049
     I                                        1  151SCHCO1                                    CER049
     I                                        1  152SCHCO2                                    CER049
     I                                        1  153SCHCO3                                    CER049
     I*
     I** SRTNO DATA STRUCTURE
     I*
     I            DS
     I                                        1  10 SRTNO
     I                                        1  100RETNO
     I*
     I** SRTNO DATA STRUCTURE
     I*
     I            DS
     I                                        1   7 CEXF
     I****************                    p   1   70NCEXF                 117208
     I                                        1   70NCEXF                 117208
     I*
     I** KEY DATA STRUCTURE : RKEY TO FILL DBKEY IF ERROR
     I*
     I            DS
     I**********                              1  18 RKEY                                      CGL029
     I                                        1  24 RKEY                                      CGL029
     I                                        1   6 SCNUM
     I**********                              1   60CNUMK                                     CSD027
     I                                        1   6 CNUMK                                     CSD027
     I                                        7   9 SCCY
     I**********                             10  13 SACOD                                     CGL029
     I**********                             10  130ACODK                                     CGL029
     I**********                             14  15 SACSQ                                     CGL029
     I**********                             14  150ACSQK                                     CGL029
     I**********                             16  18 SBRCA                                     CGL029
     I                                       10  19 SACOD                                     CGL029
     I                                       10  190ACODK                                     CGL029
     I                                       20  21 SACSQ                                     CGL029
     I                                       20  210ACSQK                                     CGL029
     I                                       22  24 SBRCA                                     CGL029
     I*
     I** KEY DATA STRUCTURE : REHKEY TO FILL DBKEY IF ERROR
     I*
     I            DS
     I**********                              1  23 REHKEY                                    CGL029
     I                                        1  29 REHKEY                                    CGL029
     I                                        1   3 BRCA
     I**********                              4   90CNUM                                      CSD027
     I                                        4   9 CNUM                                      CSD027
     I                                       10  12 REHCCY
     I**********                             13  160ACOD                                      CGL029
     I**********                             17  180ACSQ                                      CGL029
     I**********                             19  230REHDAT                                    CGL029
     I                                       13  220ACOD                                      CGL029
     I                                       23  240ACSQ                                      CGL029
     I                                       25  290REHDAT                                    CGL029
     I*
     I** KEY DATA STRUCTURE : RECHRK TO CHAIN TO RECRG FILE
     I*
     I            DS
     I                                        1  12 RECHRK
     I                                        2   30CHGT
     I                                        4   80CHST
     I                                        9  11 CCY
     I                                       12  12 DEE
     I*
     I** KEY DATA STRUCTURE : CKEY TO FILL RECKEY IF ERROR
     I*
     I            DS
     I                                        1  12 CKEY
     I                                       12  12 KRECI
     I                                        9  11 KSCCY
     I                                        1   8 KBLK8
     I*
     I** DATA STRUCTURE : FOR CUSTOMER GROUP NO. (TABLEV4)
     I*
     I            DS
     I                                        1  10 ZZ010
     I                                       10  10 CGRP
      *                                                                   CRT002
     ITTIME       DS                             12                       CRT002
      *                                                                   CRT002
     I                                        1   2 WTHR                  CRT002
     I                                        3   4 WTMN                  CRT002
     I                                        5   6 WTSS                  CRT002
      *                                                                   CRT002
     I                                        7   8 WDT1                  CRT002
     I                                        9  10 WDT2                  CRT002
     I                                       11  12 WDT3                  CRT002
      *                                                                   CRT002
     I                                        1  120WTMDS                 CRT002
      *                                                                                       CGL031
      ** Data Structure: For Transaction Reference                                            CGL031
      *                                                                                       CGL031
     I            DS                                                                          CGL031
     I                                        1  24 ZTRRF                                     CGL035
     I                                        1   3 ZBRCA                                     CGL035
     I                                        4   9 ZCNUMK                                    CGL035
     I                                       10  12 ZCCY                                      CGL035
     I                                       13  22 ZCODK                                     CGL035
     I                                       23  24 ZCSQK                                     CGL035
      *                                                                                       CGL035
     I**********                              1  18 ZTRRF                              CGL031 CGL035
     I**********                              1   3 ZBRCA                              CGL031 CGL035
     I**********                              4   9 ZCNUMK                             CGL031 CGL035
     I**********                             10  12 ZCCY                               CGL031 CGL035
     I**********                             13  16 ZCODK                              CGL031 CGL035
     I**********                             17  18 ZCSQK                              CGL031 CGL035
     I*
     I/COPY WNCPYSRC,RE3360I001
     IDSLDA       DS
     I*
     I** LDA FOR TRANSFERING ENQUIRY SELECTION CRITERIA
     I*
     I****************************************2   4 WBRCA                 CRT002
     I                                        2   4 WBRCH                 CRT002
     I                                        2   4 @BRCA
     I                                        5  10 WCNUM
     I                                       11  13 WCCY
     I**********                             14  17 WACOD                                     CGL029
     I**********                             18  19 WACSQ                                     CGL029
     I**********                             20  24 WHISD                                     CGL029
     I**********                             25  34 WACNO                                     CGL029
     I**********                             35  35 WZADEC                                    CGL029
     I**********                             36  42 WRUNA                                     CGL029
     I**********                             43  43 WDATF                                     CGL029
     I**********                             44  44 WCANC                                     CGL029
     I**********                             45  46 WFROM1                                    CGL029
     I**********                             47  48 WFROM2                                    CGL029
     I**********                             51  63 DAICCH                                    CGL029
     I**********                             64  76 CAICCH                                    CGL029
     I                                       14  23 WACOD                                     CGL029
     I                                       24  25 WACSQ                                     CGL029
     I                                       26  30 WHISD                                     CGL029
     I                                       31  40 WACNO                                     CGL029
     I                                       41  41 WZADEC                                    CGL029
     I                                       42  48 WRUNA                                     CGL029
     I                                       49  49 WDATF                                     CGL029
     I                                       50  50 WCANC                                     CGL029
     I                                       51  52 WFROM1                                    CGL029
     I                                       53  54 WFROM2                                    CGL029
     I                                       57  69 DAICCH                                    CGL029
     I                                       70  82 CAICCH                                    CGL029
     I                                       83  85 FUNC                                      239966
     I**********                          P 195 2010MADI                               094431 260322
     I**********                          P 277 2830MACI                               094431 260322
     I                                    P 201 2070MADI                                      260322
     I                                    P 289 2950MACI                                      260322
     I                                      397 401 PNDID                                     CRE090
     I                                      402 406 PNCID                                     CRE090
     I                                      407 419 PDCHGA                                    CRE090
     I                                      420 434 PHISB1                                    CRE090
     I                                      435 449 PHISB2                                    CRE090
     I                                      450 464 PCAP1                                     CRE090
     I                                      465 479 PCAP2                                     CRE090
     I                                      480 492 PDRACD                                    CRE090
     I                                      493 505 PCRACD                                    CRE090
     I                                      506 520 PINT1                                  MD027025A
     I                                      521 535 PINT2                                  MD027025A
     I*                                                                   S01408
     I/COPY WNCPYSRC,RE3360IIPG                                           S01408
     I*                                                                   S01408
      *                                                                                       CGL183
     I            DS                                                                          CGL183
     I                                        1  140TIMDAT                                    CGL183
     I                                        1   60WTIM                                      CGL183
     I                                        7  140WDAT                                      CGL183
     I            DS                                                                          CGL183
     I                                        1   80ISODAT                                    CGL183
     I                                        1   40WISCY                                     CGL183
     I                                        5   60WISMM                                     CGL183
     I                                        7   80WISDD                                     CGL183
     IDSAAUD      DS                                                      CGL183
     I                                        1   1 VLOSIC                CGL183
     I                                        2   2 VLACMV                CGL183
     I                                        3   3 VLCACB                CGL183
     I                                        4   4 VLPAMV                CGL183
     I*
     I** RETRIEVE WSID FROM PROGRAM STATUS DATA STRUCTURE
     I*
     I** Data structure for withholding taxe
     I*
     I            DS
     I                                        1  150SWTAX0
     I                                        1  151SWTAX1
     I                                        1  152SWTAX2
     I                                        1  153SWTAX3
     I*                                                                   CRT002
     I/COPY ZSRSRC,RBEQENI1                                               CRT002
     I*                                                                   CRT002
     IPSDS       SDS
     I*
     I** RETRIEVE WSID FROM PROGRAM STATUS DATA STRUCTURE
     I*
     I                                      244 253 SWSID
     I                                      254 263 SUSER
     I*
     ILDA         DS                            256
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I                                      131 183 DBLOT                 CRT002
     I*
     IRUNDT       DS
     I*
     I** DATA AREA RUNDAT
     I*
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     I*
     IZMUSER      DS                             17
     I*  DATA AREA OF MENU USER
     I                                       11  13 DFBM
     I*
     ISDBANK    E DSSDBANKPD
     I*
     I** DATA STRUCTURE FOR BANK DETAILS
     I*
     I              BJURPT                          TITL
     I*
     ISDMMOD    E DSSDMMODPD
     I*
     I** DATA STRUCTURE FOR MIDAS MODULE DETAILS
     I*
     I              BGFNMO                          MODI5
     I*
     ISDBRCH    E DSSDBRCHPD
     I*
     I** DATA STRUCTURE FOR BRANCH DETAILS
     I*
     ISDCURR    E DSSDCURRPD
     I*
     I** DATA STRUCTURE FOR CURRENCY CODE DETAILS
     I*
     I              A6NBDP                          CDP
     I*
     ISDRETL    E DSSDRETLPD
     I*
     I** DATA STRUCTURE FOR RETAIL DETAILS
     I*
     I              BMRANR                          RACN
     I*
     ISDCUST    E DSSDCUSTPD
     I              QQDFAC                          QQDFA1                                    CGL029
     I*
     I** DATA STRUCTURE FOR CUSTOMER DETAILS
     I*
     I              BBCGRP                          @WCGRP
     I*
     ISCSARD    E DSSCSARDPD                                              CRE001
     I*                                                                   CRE001
     I** Data structure for Switchable features details                   CRE001
     I*                                                                   CRE001
     ISDLOCN    E DSSDLOCNPD                                                                  234034
      ** Data structure for Location Details                                                  234034
     ISDACUS    E DSSDACUSPD                                                                AR763412
      ** Data structure for Additional Customer Details                                     AR763412
      *                                                                                       234034
     ISDCTTX    E DSSDCTTXPD                                                                  234034
      ** Data Structure for Country of Tax Codes                                              234034
      *                                                                                       234034
     ISDTXPA    E DSSDTXPAPD                                                                BUG22911
      ** Data structure for Tax Parameter File                                              BUG22911
      *                                                                                     BUG22911
     ISDACTX    E DSSDACTXPD                                                                  CER069
      **  External DS for customer details by country of tax                                  CER069
      *                                                                                       CER069
     IDSFDY     E DSDSFDY
     I*
     I** FIRST DS FOR ACCESS PROGRAMS, SHORT DATA STRUCTURE
     I*
     IDSSDY     E DSDSSDY
     I*
     I** SECOND DS FOR ACCESS PROGRAMS, LONG DATA STRUCTURE
     IDSLDY     E DSDSLDY                                                 CSD007
      ** Third DS for access programs, very long data structure           CSD007
      *                                                                   CSD007
     I*
     IDSMEMS    E DSMEMOS                                                 CCB002
     I** External data structure for MEMOS Details                        CCB002
     I** Renamed fields in PF/MEMOS                                       CCB002
     I              RECI                            MERECI                CCB002
     I              CNUM                            MECNUM                CCB002
     I              CCY                             MECCY                 CCB002
     I              ACOD                            MEACOD                CCB002
     I              ACSQ                            MEACSQ                CCB002
     I              BRCA                            MEBRCA                CCB002
     I              ACNO                            MEACNO                CCB002
     I              ZZ005                           ZZ005X                CCB002
     IUMEMER      DS                                                      CCB002
      ** Data structure for database error on call to AOMEMSR0.           CCB002
     I**********                              1   60U0CNUM                             CCB002 CSD027
     I                                        1   6 U0CNUM                                    CSD027
     I                                        7   9 U0CUCD                CCB002
     I**********                             10  130U0ACCD                             CCB002 CGL029
     I**********                             14  150U0ACSQ                             CCB002 CGL029
     I**********                             16  18 U0BRCA                             CCB002 CGL029
     I                                       10  190U0ACCD                                    CGL029
     I                                       20  210U0ACSQ                                    CGL029
     I                                       22  24 U0BRCA                                    CGL029
     I*                                                                   159536
     I** DATA STRUCTURE FOR LINKS                                         159536
     I**                                                                  159536
     ILINKDS      DS                                                      159536
     I**********                              1  18 LINKS                              159536 CGL029
     I                                        1  24 LINKS                                     CGL029
      **********                                                                              241027
     I**********                              1   3 LTAB                  159536              241027
     I**********                              4   90LTCUST                             159536 CSD027
     I**********                              4   9 LTCUST                             CSD027 241027
     I**********                             10  12 W#CCY                 159536              241027
     I**********                             13  160LTAC                               159536 CGL029
     I**********                             17  180LTAS                               159536 CGL029
     I**********                             13  220LTAC                               CGL029 241027
     I**********                             23  240LTAS                               CGL029 241027
     I                                        1  10 LACNO                                     241027
     I                                        1   3 LBRCH                                     241027
     I                                        4   90LCNUM                                     241027
     I                                       10  12 LCCY                                      241027
     I                                       13  220LACOD                                     241027
     I                                       23  240LACSQ                                     241027
      *                                                                                       241027
     ISVAL1       DS                            200                                           241027
     I                                        1   1 SVAL11                                    241027
      ** DS for AOSVALR0                                                                      241027
      *                                                                                       241027
     I              'OSICshowPrmRet'      C         SVALKK                                    241027
     I              'BasCcyTaxRoundDown'  C         C#BASE                                    CDL081
     I              'NBasCcyTaxRoundDown' C         C#NBAS                                    CDL081
      *                                                                                       CER016
      ** Constant value for Interest Calculation Method                                       CER016
      *                                                                                       CER016
     I              'InterestNumber'      C         PSYSVL                                    CER016
     I              'UserEnqAccessAudit'  C         V#AAUD                                    CGL183
      *                                                                   S01408
     I/COPY WNCPYSRC,RE3360IIP2                                           S01408
      *                                                                   S01408
     I/COPY ZSRSRC,RBEQENI2                                               CRT002
     I*                                                                   CRT002
     I/COPY ZSRSRC,RBWLOGI1                                               CRT002
     I*                                                                   CRT002
     I/COPY ZSRSRC,ZFRPEDZ2                                               CRT002
     I*                                                                   CRT002
     C/EJECT
     C*===================================================================
      *                                                                   CRT002
      **  Input parameter(s) :                                            CRT002
      *                                                                   CRT002
     C           *ENTRY    PLIST                           Entry parameterCRT002
     C                     PARM           PMODE   1        Processing ModeCRT002
     C*
     C** COPYRIGHT INSERTION
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C** KEY LISTS
     C*
     C** KEY FIELD TO CHAIN TO RETAIL FILES
     C*
     C           RETKEY    KLIST
     C                     KFLD           CNUMK
     C                     KFLD           SCCY
     C                     KFLD           ACODK
     C                     KFLD           ACSQK
     C                     KFLD           SBRCA
      *                                                                                       220566
      ** Key field to access LF/REHISL                                                        220566
      *                                                                                       220566
     C           R1KEY     KLIST                                                              220566
     C                     KFLD           BRCA                                                220566
     C                     KFLD           CNUM                                                220566
     C                     KFLD           CCY                                                 220566
     C                     KFLD           ACOD                                                220566
     C                     KFLD           ACSQ                                                220566
     C*
     C** KEY FIELD TO CHAIN TO MEMOSM1 AND RECOM FILES
     C*
     C           MREKEY    KLIST
     C                     KFLD           SBRCA
     C                     KFLD           CNUMK
     C                     KFLD           SCCY
     C                     KFLD           ACODK
     C                     KFLD           ACSQK
     C*
     C** KEY FIELD TO ACCESS TO REHRDJ/REHRCJ FILE
     C*
     C           DCKEY     KLIST
     C                     KFLD           BRCA
     C                     KFLD           CNUM
     C                     KFLD           CCY
     C                     KFLD           ACOD
     C                     KFLD           ACSQ
     C                     KFLD           KDATE
     C*
     C** KEY FIELD TO ACCESS TO CLINT FILE
     C*
     C           CLIKEY    KLIST
     C                     KFLD           CNUMK
     C                     KFLD           ALPHA
     C*
     C** KEY FIELD TO ACCESS TO RECCY FILE
     C*
     C           RECKEY    KLIST
     C                     KFLD           CKEY
      *                                                                   CRE001
      ** Key fields to access to ACCNTBXC file                            CRE001
      *                                                                   CRE001
     C           ACCKEY    KLIST                                          CRE001
     C                     KFLD           CNUMK                           CRE001
     C                     KFLD           SCCY                            CRE001
     C                     KFLD           ACODK                           CRE001
     C                     KFLD           ACSQK                           CRE001
     C                     KFLD           SBRCA                           CRE001
      *                                                                                     BUG23325
      ** Key fields to access to SDCSINLG file                                              BUG23325
      *                                                                                     BUG23325
     C           WKEY1     KLIST                                                            BUG23325
     C                     KFLD           KCNUM                                             BUG23325
     C                     KFLD           KCCY                                              BUG23325
     C                     KFLD           KACOD                                             BUG23325
     C                     KFLD           KACSQ                                             BUG23325
     C                     KFLD           KBRCA                                             BUG23325
     C                     KFLD           KMODI                                             BUG23325
      *                                                                   S01408
     C/COPY WNCPYSRC,RE3360CCP9                                           S01408
      *                                                                   S01408
     C*
     C** WORK FIELDS DEFINITION
     C*
     C           *LIKE     DEFN KEY       BLK8  - 4
     C           *LIKE     DEFN ATYP      ALPHA
     C           *LIKE     DEFN RHISB     STOTX
     C           *LIKE     DEFN KEY       ERRDAT
     C           *LIKE     DEFN KEY       TAB4  - 8
     C           *LIKE     DEFN KEY       WPROG - 4
     C           *LIKE     DEFN KEY       FLD10 - 2
     C           *LIKE     DEFN KEY       FLD6  - 6
     C********** *LIKE     DEFN KEY       FLD4  - 8                                           CGL029
     C           *LIKE     DEFN KEY       FLD4  - 2                                           CGL029
     C           *LIKE     DEFN KEY       FLD2  -10
     C           *LIKE     DEFN KEY       ACNOC - 2
     C           *LIKE     DEFN KEY       HBPGM - 4
     C           *LIKE     DEFN KEY       PARAM - 2
     C           *LIKE     DEFN ACNO      FLD11 + 1
     C********** *LIKE     DEFN CNUM      FLD70 + 1                                           CSD027
     C                     Z-ADDFLD70     FLD70   70                                          CSD027
     C           *LIKE     DEFN ACOD      ZLYCHK
     C           *LIKE     DEFN ACOD      FLD50 + 1
     C           *LIKE     DEFN ACSQ      ZLYREM
     C           *LIKE     DEFN ACSQ      ZIM1
     C           *LIKE     DEFN ACSQ      ZIMAN
     C           *LIKE     DEFN ACSQ      ZIDW1
     C           *LIKE     DEFN ACSQ      ZIY1
     C           *LIKE     DEFN ACSQ      Z
     C           *LIKE     DEFN ACSQ      Y
     C           *LIKE     DEFN ACSQ      X                                                   CER016
     C           *LIKE     DEFN ACSQ      FLD30 + 1
     C           *LIKE     DEFN RCA       SOACC0
     C           *LIKE     DEFN RCA       SDRIN0
     C           *LIKE     DEFN RCA       SCRIN0
     C           *LIKE     DEFN RCA       WSCRN0                                            AR784694
     C           *LIKE     DEFN RCA       ZINTR
     C           *LIKE     DEFN RHISB     DINT
     C           *LIKE     DEFN RHISB     CINT
     C           *LIKE     DEFN RHISB     ZIAMT
     C           *LIKE     DEFN RHISB     ZIAMT1
     C           *LIKE     DEFN RHISB     ZIAMTR
     C           *LIKE     DEFN RHISB     ZITHR
     C           *LIKE     DEFN RHISB     ZBAL
     C           *LIKE     DEFN RHISB     NCNDS
     C********** *LIKE     DEFN DRIB      ZICT                                                CSD103
     C                     Z-ADD*ZEROS    ZICT    20                                          CSD103
     C           *LIKE     DEFN RUND      ZIBEG
     C           *LIKE     DEFN RUND      ZIEND
     C           *LIKE     DEFN RUND      ZLDTM
     C           *LIKE     DEFN RUND      ZIDREM
     C           *LIKE     DEFN RUND      ZID1
     C           *LIKE     DEFN RUND      ZID2
     C           *LIKE     DEFN RUND      ZIDW2
     C           *LIKE     DEFN RUND      ZILPCP
     C           *LIKE     DEFN RUND      KDATE
     C           *LIKE     DEFN RUND      ZIBW1
     C           *LIKE     DEFN RUND      ZIREM
     C           *LIKE     DEFN DRIC      ZERROR
     C           *LIKE     DEFN DRIC      ZICALC
     C           *LIKE     DEFN DRIS      ZIRATE
     C           *LIKE     DEFN DACO      ALTNAD
     C           *LIKE     DEFN BCCUST    WCUST
     C           *LIKE     DEFN SBRCA     OBRCA
     C           *LIKE     DEFN SCNUM     OCNUM
     C           *LIKE     DEFN SCCY      OCCY
     C           *LIKE     DEFN SACOD     OACOD
     C           *LIKE     DEFN SACSQ     OACSQ
     C           *LIKE     DEFN SRTNO     ORTNO
     C********** *LIKE     DEFN CNUM      FLD80 - 2                                           CSD027
     C                     Z-ADD*ZEROS    FLD80   40                                          CSD027
     C           *LIKE     DEFN KEY       FLD3  - 9
     C********** *LIKE     DEFN DRIB      ZDCT                                         CRE090 CSD103
     C                     Z-ADD*ZEROS    ZDCT    20                                          CSD103
     C           *LIKE     DEFN DRIC      ZDCALC                                              CRE090
     C           *LIKE     DEFN DRIS      ZDRATE                                              CRE090
     C********** *LIKE     DEFN DRIB      ZCCT                                         CRE090 CSD103
     C                     Z-ADD*ZEROS    ZCCT    20                                          CSD103
     C           *LIKE     DEFN DRIC      ZCCALC                                              CRE090
     C           *LIKE     DEFN DRIS      ZCRATE                                              CRE090
     C*
     C/COPY WNCPYSRC,RE3360C005
     C                     Z-ADD*ZEROS    ZIFY2   30
     C                     Z-ADD*ZEROS    ZISY2   30
     C                     Z-ADD*ZEROS    ZINOM   30
     C                     Z-ADD*ZEROS    ZIM2    30
     C                     Z-ADD*ZEROS    S       10
     C                     Z-ADD*ZEROS    LOOP    10
     C                     MOVE 'N'       WDRDLY  1                                         MD027052
     C                     MOVE 'N'       WCRDLY  1                                         MD027052
      *                                                                   CRE001
      ** Three new fields to be initialised                               CRE001
     C                     Z-ADD*ZEROS    FINTR  150                      CRE001
     C                     Z-ADD*ZEROS    FDINT  150                      CRE001
     C                     Z-ADD*ZEROS    FOINT  150                      CRE001
     C*
     C           *NAMVAR   DEFN *LDA      DSLDA
     C           *NAMVAR   DEFN           LDA
     C*
     C/EJECT
     C*===================================================================
     C** P R O G R A M     S T A R T
     C*===================================================================
     C*
     C** FIRST CYCLE PROCESSING
     C*
     C                     EXSR FIRST
     C*
     C** MAIN PROCESSING UNTIL CK3 OR ERROR
     C*
     C           *INKC     DOWEQ'0'                        - B1
     C           EXTFLG    ANDEQ'N'                                                           239966
     C*
     C                     EXSR MAIN
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3360CCPG                                           S01408
     C*                                                                   S01408
     C*
     C                     END                             - E1
     C*
     C                     MOVE '1'       *INLR
      *                                                                                       239966
     C           *INKC     IFEQ '1'                                                           239966
     C                     MOVEL'F03'     FUNC                                                239966
     C                     OUT  DSLDA                                                         239966
     C                     ENDIF                                                              239966
      *                                                                   CRT002
     C           PMODE     IFEQ 'I'                                       CRT002
     C                     CLOSE*ALL                                      CRT002
     C                     END                                            CRT002
     C*
     C*===================================================================
     C** P R O G R A M     E N D
     C*===================================================================
     C/EJECT
     C********************************************************************
     C**
     C** FIRST subroutine to execute first cycle.
     C**
     C**     Called by       S T A R T
     C**     Calls           DBSR, DFPROC
     C**
     C           FIRST     BEGSR                           **FIRST BEGSR**
     C*
     C** READING DSLDA
     C*
     C                     IN   DSLDA
     C*
     C** SET UP FORMAT INDICATOR
     C*
     C                     MOVEA'11'      *IN,20
     C                     MOVEA'111'     *IN,42
     C                     MOVEA'111'     *IN,56
     C                     MOVEL'0'       *IN59
     C                     MOVE 'N'       EXTFLG  1                                           239966
     C*
     C** PREPARE LDA VARIABLES
     C*
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3360'  DBPGM
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     Z-ADD0         DBASE
     C                     OUT  LDA
     C*
     C** PREPARE WORK VARIABLES
     C*
     C                     Z-ADD0         S
     C                     MOVE 'D'       DEE
     C                     MOVE 'RE3360'  WPROG
     C**********           Z-ADD*ZEROS    ZIWRK1 155                                          220323
     C**********           Z-ADD*ZEROS    ZIWRK2 155                                          220323
     C                     Z-ADD*ZEROS    ZIWRK1 309                                          220323
     C                     Z-ADD*ZEROS    ZIWRK2 309                                          220323
     C                     Z-ADD*ZEROS    ZDAYN2  94
     C                     MOVE '0'       WCANC
     C*
     C** IN THE DATAAREA RUNDAT
     C*
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
     C*
     C** SET UP INDICATOR 98 BASED ON THE DATE FORMAT.
     C*
     C           DATF      IFEQ 'M'
     C                     MOVE '1'       *IN98
     C                     ELSE
     C                     MOVE '0'       *IN98
     C                     END
     C*
     C** CHECK MULTIBRANCHING INDICATOR
     C*
     C           MBIN      IFEQ 'Y'
     C                     MOVE '1'       *IN37
     C                     END
     C*
     C** IN THE DATAAREA ZMUSER
     C*
     C           *NAMVAR   DEFN           ZMUSER
     C                     IN   ZMUSER
      *                                                                   CRT002
      **  Initialise MSG text and MSG return code                         CRT002
      *                                                                   CRT002
     C                     MOVE *BLANKS   LINEB  80                       CRT002
     C                     MOVEL'RE4135'  P@QRC                           CRT002
     C                     MOVE 'RAE '    P@QRC                           CRT002
     C                     MOVE '1'       @FIRST  1                       CRT002
     C*
     C** GET BANK DETAILS
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C** ERROR IN SDBANKPD
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL'SDBANKPD'DBFILE           ***************
     C                     MOVEL@OPTN     DBKEY            * DBERROR 001 *
     C                     Z-ADD001       DBASE            ***************
     C                     OUT  LDA
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END
     C           BJRDNB    SUB  1         PRDNB   50                                          CRE090
     C*
     C** ACCESS SDMMODPD
     C*
     C                     CALL 'AOMMODR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDMMOD    PARM SDMMOD    DSFDY
     C*
     C** ERROR IN SDMMODPD
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     MOVEL'SDMMODPD'DBFILE           ***************
     C                     MOVEL@OPTN     DBKEY            * DBERROR 017 *
     C                     Z-ADD017       DBASE            ***************
     C                     OUT  LDA
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END
     C           BGNTST    IFEQ 'Y'
     C                     MOVEL'1'       *IN59
     C                     END
     C*
     C** ACCESS RETAIL ICD FOR OPTIONAL FEATURES (TABTBRE)
     C*
     C                     READ TABTBRE                  99
     C*
     C** ERROR IN TABTBRE
     C*
     C           *IN99     IFEQ '1'                        - B1
     C           RECI      ORNE 'D'
     C           *LOCK     IN   LDA
     C                     Z-ADD002       DBASE            ***************
     C                     MOVE 'TABTBRE' DBFILE           * DBERROR 002 *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C/COPY WNCPYSRC,RE3360C016
     C*
     C** CHECK IF COMMISSIONS ARE PRESENT OR NOT
     C*
     C                     MOVE '0'       *IN11
     C                     MOVE '0'       *IN12
     C                     MOVE '0'       *IN13
     C                     MOVE '0'       *IN14
     C                     MOVE '0'       *IN15
     C                     MOVE '0'       *IN16
     C                     MOVE '0'       *IN17
     C                     MOVE '0'       *IN18
     C                     MOVE '0'       *IN69
      ** Initialize below field, so session device error will                                 CRE090
      ** not not be encountered from RE3363 back to RE3360                                    CRE090
     C                     Z-ADD0         SCACC0                                              CRE090
     C*
     C** COMMISSION ON DEBIT TURNOVER
     C*
     C           CDTO      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN11
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C*
     C** COMMISSION ON HIGHEST OVERDRAFT
     C*
     C           CHOV      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN12
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C*
     C** FIXED ACCOUNT CHARGE
     C*
     C           FXAC      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN13
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C*
     C** CHARGE ON NUMBER OF DAILY STATEMENTS
     C*
     C           CNDS      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN14
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C*
     C** COMMISSION ON DEBIT INTEREST
     C*
     C           CDRI      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN15
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C*
     C** COMMISSION ON MINIMUM AVERAGE BALANCE
     C*
     C           CMBL      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN16
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C*
     C** CHARGE ON INACTIVE ACCOUNT
     C*
     C           CINA      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN17
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C*
     C** VAT PROCESSING
     C*
     C           VATP      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN18
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C*
     C** ACCESS RETAIL DETAILS (SDRETLPD)
     C*
     C                     CALL 'AORETLR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDRETL    PARM SDRETL    DSFDY
     C*
     C** ERROR IN SDRETLPD
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     Z-ADD003       DBASE            ***************
     C                     MOVE 'SDRETLPD'DBFILE           * DBERROR 003 *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END
     C*
     C** CHECK IF RETAIL NUMBER PRESENT
     C*
     C           RACN      IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN68
     C                     END                             - E1
      *                                                                                       241027
      * Access system values file                                                             241027
     C                     CALL 'AOSVALR0'                                                    241027
     C                     PARM           @RTCD                                               241027
     C                     PARM SVALKK    SVALK1 20                                           241027
     C                     PARM           SVAL1 200                                           241027
     C                     PARM *BLANK    SVALK2 20                                           241027
     C                     PARM           SVAL2 200                                           241027
     C                     PARM *BLANK    SVALK3 20                                           241027
     C                     PARM           SVAL3 200                                           241027
     C                     PARM *BLANK    SVALK4 20                                           241027
     C                     PARM           SVAL4 200                                           241027
     C                     PARM *BLANK    SVALK5 20                                           241027
     C                     PARM           SVAL5 200                                           241027
     C                     PARM *BLANK    SVALK6 20                                           241027
     C                     PARM           SVAL6 200                                           241027
     C                     PARM *BLANK    SVALK7 20                                           241027
     C                     PARM           SVAL7 200                                           241027
     C                     PARM *BLANK    SVALK8 20                                           241027
     C                     PARM           SVAL8 200                                           241027
     C                     PARM *BLANK    SVALK9 20                                           241027
     C                     PARM           SVAL9 200                                           241027
     C                     PARM *BLANK    SVALK0 20                                           241027
     C                     PARM           SVAL10200                                           241027
      *                                                                                       241027
     C           @RTCD     IFNE *BLANK                                                        241027
     C           *LOCK     IN   LDA                                                           241027
     C                     MOVEL'*KEY    'DBKEY                                               241027
     C                     MOVEL'SDSVALPD'DBFILE           ***************                    241027
     C                     Z-ADD018       DBASE            * DBERROR 018 *                    241027
     C                     OUT  LDA                        ************* *                    241027
     C                     MOVEA'0'       *IN,89                                              241027
     C                     EXSR DBSR                                                          241027
     C                     ENDIF                                                              241027
     C                     MOVE SVAL11    PRMRET  1                                           241027
     C*
     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED
     C*
     C                     CALL 'AOSARDR0'
     C                     PARM '       ' @RTCD
     C                     PARM '*VERIFY' @OPTN
     C                     PARM 'S01383'  @SARD   6
     C*
     C** IF IN ERROR
     C*
     C           @RTCD     IFNE *BLANK
     C           @RTCD     ANDNE'*NRF   '
     C                     SETON                     U7LR
     C           *LOCK     IN   LDA
     C                     MOVEL'SCSARDPD'DBFILE            **************
     C                     Z-ADD004       DBASE             * DBERROR 004*
     C                     MOVEL@RTCD     DBKEY             **************
     C                     OUT  LDA
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END
     C*
     C           @RTCD     IFEQ *BLANK
     C                     MOVEL'Y'       S01383  1
     C                     END
      *                                                                   CSD007
      ** Access SAR details to check if 'Customer Closing' is             CSD007
      ** installed.                                                       CSD007
      *                                                                   CSD007
     C                     MOVE 'N'       CSD007  1                       CSD007
     C                     CALL 'AOSARDR0'                                CSD007
     C                     PARM *BLANKS   PRTCD   7                       CSD007
     C                     PARM '*VERIFY' POPTN   7                       CSD007
     C                     PARM 'CSD007'  PSARD   6                       CSD007
     C           SCSARD    PARM SCSARD    DSFDY                           CSD007
      *                                                                   CSD007
     C           PRTCD     IFEQ *BLANKS                                   CSD007
     C                     MOVE 'Y'       CSD007                          CSD007
     C                     ELSE                                           CSD007
     C           PRTCD     IFNE '*NRF   '                                 CSD007
     C                     SETON                     U7LR                 CSD007
     C           *LOCK     IN   LDA                                       CSD007
     C                     MOVE 'SCSARDPD'DBFILE                          CSD007
     C                     MOVEL'CSD007'  DBKEY                           CSD007
     C                     Z-ADD5         DBASE                           CSD007
     C                     OUT  LDA                                       CSD007
     C                     EXSR DBSR                                      CSD007
     C                     ENDIF                                          CSD007
     C                     ENDIF                                          CSD007
     C*
     C** IF BRT SAR INSTALLED, ACCESS BRT INSTALLATION CONTROL DATA
     C*
     C           S01383    IFEQ 'Y'
     C                     MOVE 'D'       KRECI   1
     C           KRECI     CHAINSDBRTDD0             99
     C           *IN99     IFEQ '1'
     C           *LOCK     IN   LDA
     C                     SETON                     U7LR   **************
     C                     MOVEL'SDBRTDPD'DBFILE            * DBERROR 005*
     C                     Z-ADD005       DBASE             **************
     C                     MOVE *BLANKS   DBKEY
     C                     OUT  LDA
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END
     C                     END
      *                                                                   CRE001
      ** Check if SAR CRE001 is set on                                    CRE001
      *                                                                   CRE001
     C                     MOVE 'N'       CRE001  1                       CRE001
     C                     MOVE '0'       *IN54                           CRE001
     C                     CALL 'AOSARDR0'                                CRE001
     C                     PARM *BLANKS   @RTCD   7                       CRE001
     C                     PARM '*VERIFY' @OPTN   7                       CRE001
     C                     PARM 'CRE001'  @SARD   6                       CRE001
     C           SCSARD    PARM SCSARD    DSFDY                           CRE001
      *                                                                   CRE001
     C           @RTCD     IFNE *BLANKS                                   CRE001
     C           @RTCD     ANDNE'*NRF   '                                 CRE001
     C           *LOCK     IN   LDA                                       CRE001
     C                     Z-ADD050       DBASE                           CRE001
     C                     MOVE 'SCSARDPD'DBFILE           ***************CRE001
     C                     MOVEL'CRE001'  DBKEY            * DBERR0R 050 *CRE001
     C                     OUT  LDA                        ***************CRE001
     C                     MOVEA'0'       *IN,89                          CRE001
     C                     EXSR DBSR                                      CRE001
     C                     END                                            CRE001
      *                                                                   CRE001
     C           @RTCD     IFEQ *BLANKS                                   CRE001
     C                     MOVE 'Y'       CRE001                          CRE001
     C                     MOVE '1'       *IN54                           CRE001
     C                     END                                            CRE001
      *                                                                                       CER048
      ** Check if CER048 is enabled                                                           CER048
      *                                                                                       CER048
     C                     MOVE 'N'       CER048  1                                           CER048
     C**********           MOVE '0'       *IN10                                      CER048 BUG23325
      *                                                                                       CER048
     C                     CALL 'AOSARDR0'                                                    CER048
     C                     PARM *BLANKS   PRTCD                                               CER048
     C                     PARM '*VERIFY' POPTN                                               CER048
     C                     PARM 'CER048'  PSARD                                               CER048
     C           SCSARD    PARM SCSARD    DSFDY                                               CER048
      *                                                                                       CER048
     C           PRTCD     IFNE *BLANKS                                                       CER048
     C           PRTCD     ANDNE'*NRF'                                                        CER048
      *                                                                                       CER048
     C           *LOCK     IN   LDA                                                           CER048
     C                     MOVE 'SCSARDPD'DBFILE                                              CER048
     C                     MOVE 'CER048'  DBKEY                                               CER048
     C                     MOVE 97        DBASE                                               CER048
     C                     OUT  LDA                                                           CER048
     C                     EXSR *PSSR                                                         CER048
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER048
     C           PRTCD     IFEQ *BLANKS                                                       CER048
      *                                                                                       CER048
     C                     MOVE 'Y'       CER048                                              CER048
     C**********           MOVE '1'       *IN10                                      CER048 BUG23325
      *                                                                                       CER048
     C                     ENDIF                                                              CER048
      *                                                                                       CER054
      ** Check if CER054 is enabled                                                           CER054
      *                                                                                       CER054
     C                     MOVE 'N'       CER054  1                                           CER054
      *                                                                                       CER054
     C                     CALL 'AOSARDR0'                                                    CER054
     C                     PARM *BLANKS   PRTCD                                               CER054
     C                     PARM '*VERIFY' POPTN                                               CER054
     C                     PARM 'CER054'  PSARD                                               CER054
     C           SCSARD    PARM SCSARD    DSFDY                                               CER054
      *                                                                                       CER054
     C           PRTCD     IFNE *BLANKS                                                       CER054
     C           PRTCD     ANDNE'*NRF'                                                        CER054
      *                                                                                       CER054
     C           *LOCK     IN   LDA                                                           CER054
     C                     MOVE 'SCSARDPD'DBFILE                                              CER054
     C                     MOVE 'CER054'  DBKEY                                               CER054
     C                     MOVE 98        DBASE                                               CER054
     C                     OUT  LDA                                                           CER054
     C                     EXSR *PSSR                                                         CER054
      *                                                                                       CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER054
     C           PRTCD     IFEQ *BLANKS                                                       CER054
     C                     MOVE 'Y'       CER054                                              CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CGL031
      ** Check if CGL031 is switched ON.                                                      CGL031
      *                                                                                       CGL031
     C                     MOVE 'N'       CGL031  1                                           CGL031
     C                     MOVE *OFF      *IN81                                               CGL031
     C                     CALL 'AOSARDR0'                                                    CGL031
     C                     PARM *BLANKS   PRTCD   7                                           CGL031
     C                     PARM '*VERIFY' POPTN   7                                           CGL031
     C                     PARM 'CGL031'  PSARD   6                                           CGL031
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL031
      *                                                                                       CGL031
     C           PRTCD     IFNE *BLANKS                                                       CGL031
     C           PRTCD     ANDNE'*NRF   '                                                     CGL031
     C           *LOCK     IN   LDA                                                           CGL031
     C                     Z-ADD022       DBASE                                               CGL031
     C                     MOVE 'SCSARDPD'DBFILE           ***************                    CGL031
     C                     MOVEL'CGL031'  DBKEY            * DBERR0R 022 *                    CGL031
     C                     OUT  LDA                        ***************                    CGL031
     C                     MOVE *OFF      *IN89                                               CGL031
     C                     EXSR DBSR                                                          CGL031
     C                     END                                                                CGL031
      *                                                                                       CGL031
     C           PRTCD     IFEQ *BLANKS                                                       CGL031
     C                     MOVE 'Y'       CGL031                                              CGL031
     C                     MOVE *ON       *IN81                                               CGL031
     C                     END                                                                CGL031
      *                                                                                       CDL081
      ** Check if CDL081 is installed                                                         CDL081
      *                                                                                       CDL081
     C                     MOVE 'N'       CDL081  1                                           CDL081
     C                     CALL 'AOSARDR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD                                               CDL081
     C                     PARM '*VERIFY' POPTN                                               CDL081
     C                     PARM 'CDL081'  PSARD                                               CDL081
     C           SCSARD    PARM SCSARD    DSFDY                                               CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C           PRTCD     ANDNE'*NRF   '                                                     CDL081
     C           *LOCK     IN   LDA                                                           CDL081
     C                     Z-ADD023       DBASE                                               CDL081
     C                     MOVE 'SCSARDPD'DBFILE                                              CDL081
     C                     MOVEL'CDL081'  DBKEY                                               CDL081
     C                     OUT  LDA                                                           CDL081
     C                     MOVE *OFF      *IN89                                               CDL081
     C                     EXSR DBSR                                                          CDL081
     C                     END                                                                CDL081
      *                                                                                       CDL081
     C           PRTCD     IFEQ *BLANKS                                                       CDL081
     C                     MOVE 'Y'       CDL081                                              CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Access withholding tax round down system values if CDL081 is on                      CDL081
      *                                                                                       CDL081
     C           CDL081    IFEQ 'Y'                                                           CDL081
     C                     CALL 'AOSVALR0'                                                    CDL081
     C                     PARM *BLANKS   PRTCD                                               CDL081
     C                     PARM C#BASE    SVALK1                                              CDL081
     C                     PARM           SVAL1                                               CDL081
     C                     PARM C#NBAS    SVALK2                                              CDL081
     C                     PARM           SVAL2                                               CDL081
     C                     PARM *BLANK    SVALK3                                              CDL081
     C                     PARM           SVAL3                                               CDL081
     C                     PARM *BLANK    SVALK4                                              CDL081
     C                     PARM           SVAL4                                               CDL081
     C                     PARM *BLANK    SVALK5                                              CDL081
     C                     PARM           SVAL5                                               CDL081
     C                     PARM *BLANK    SVALK6                                              CDL081
     C                     PARM           SVAL6                                               CDL081
     C                     PARM *BLANK    SVALK7                                              CDL081
     C                     PARM           SVAL7                                               CDL081
     C                     PARM *BLANK    SVALK8                                              CDL081
     C                     PARM           SVAL8                                               CDL081
     C                     PARM *BLANK    SVALK9                                              CDL081
     C                     PARM           SVAL9                                               CDL081
     C                     PARM *BLANK    SVALK0                                              CDL081
     C                     PARM           SVAL10                                              CDL081
      *                                                                                       CDL081
     C           PRTCD     IFNE *BLANKS                                                       CDL081
     C           *LOCK     IN   LDA                                                           CDL081
     C                     Z-ADD024       DBASE                                               CDL081
     C                     MOVE 'SDSVALPD'DBFILE                                              CDL081
     C           SVAL1     IFEQ '*NRF'                                                        CDL081
     C                     MOVELSVALK1    DBKEY                                               CDL081
     C                     ENDIF                                                              CDL081
     C           SVAL2     IFEQ '*NRF'                                                        CDL081
     C                     MOVELSVALK2    DBKEY                                               CDL081
     C                     ENDIF                                                              CDL081
     C                     OUT  LDA                                                           CDL081
     C                     MOVE *OFF      *IN89                                               CDL081
     C                     EXSR DBSR                                                          CDL081
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL081
      ** Setup tax amount rounding down indicators                                            CDL081
      *                                                                                       CDL081
     C                     MOVELSVAL1     W#BSRD  1                                           CDL081
     C                     MOVELSVAL2     W#NBRD  1                                           CDL081
     C                     ENDIF                                                              CDL081
     C*
     C                     Z-ADD0         SSTAX0                                            MD039579
      * Check if Dual Witholding Tax feature is switched On                                   CGL165
     C                     MOVE 'N'       CGL165  1                                           CGL165
     C                     SETOF                     10                                       CGL165
     C                     CALL 'AOSARDR0'                                                    CGL165
     C                     PARM *BLANKS   PRTCD   7                                           CGL165
     C                     PARM '*VERIFY' POPTN   7                                           CGL165
     C                     PARM 'CGL165'  PSARD   6                                           CGL165
     C           SCSARD    PARM SCSARD    DSFDY                                               CGL165
      *                                                                                       CGL165
     C           PRTCD     IFEQ *BLANKS                                                       CGL165
     C                     MOVE 'Y'       CGL165                                              CGL165
     C                     SETON                     10                                       CGL165
     C                     ENDIF                                                              CGL165
     C                     MOVE RUNA      SRUNA
     C                     TESTB'0'       MODI5          46
     C/COPY WNCPYSRC,RE3360C015
      *                                                                   CGL183
      ** Check if feaure CGL183 is On                                     CGL183
      *                                                                   CGL183
     C                     CALL 'AOSARDR0'                                CGL183
     C                     PARM *BLANKS   @RTCD   7                       CGL183
     C                     PARM '*VERIFY' @OPTN   7                       CGL183
     C                     PARM 'CGL183'  @SARD   6                       CGL183
     C           SCSARD    PARM SCSARD    DSFDY                           CGL183
      *                                                                   CGL183
     C           @RTCD     IFEQ *BLANKS                                   CGL183
     C                     MOVE 'Y'       CGL183  1                       CGL183
     C                     ELSE                                           CGL183
     C                     MOVE 'N'       CGL183                          CGL183
     C                     END                                            CGL183
      *                                                                   CGL183
      ** System value that controls user access audit for this enquiry    CGL183
      *                                                                   CGL183
     C                     MOVELV#AAUD    P@OP01                          CGL183
      *                                                                   CGL183
     C                     CALL 'AOSVALR0'                                CGL183
     C                     PARM *BLANKS   @RTCD   7                       CGL183
     C                     PARM           P@OP01 20                       CGL183
     C                     PARM *BLANKS   P@VL01200                       CGL183
     C                     PARM *BLANKS   P@OP02 20                       CGL183
     C                     PARM *BLANKS   P@VL02200                       CGL183
     C                     PARM *BLANKS   P@OP03 20                       CGL183
     C                     PARM *BLANKS   P@VL03200                       CGL183
     C                     PARM *BLANKS   P@OP04 20                       CGL183
     C                     PARM *BLANKS   P@VL04200                       CGL183
     C                     PARM *BLANKS   P@OP05 20                       CGL183
     C                     PARM *BLANKS   P@VL05200                       CGL183
     C                     PARM *BLANKS   P@OP06 20                       CGL183
     C                     PARM *BLANKS   P@VL06200                       CGL183
     C                     PARM *BLANKS   P@OP07 20                       CGL183
     C                     PARM *BLANKS   P@VL07200                       CGL183
     C                     PARM *BLANKS   P@OP08 20                       CGL183
     C                     PARM *BLANKS   P@VL08200                       CGL183
     C                     PARM *BLANKS   P@OP09 20                       CGL183
     C                     PARM *BLANKS   P@VL09200                       CGL183
     C                     PARM *BLANKS   P@OP10 20                       CGL183
     C                     PARM *BLANKS   P@VL10200                       CGL183
      *                                                                   CGL183
     C                     MOVELP@VL01    DSAAUD                          CGL183
      *                                                                   CGL183
      ** Get time and date, but only format date-CCYYMMDD                 CGL183
      *                                                                   CGL183
     C                     TIME           TIMDAT                          CGL183
      *                                                                   CGL183
     C                     MOVELWDAT      WISDD                           CGL183
     C                     MOVE WDAT      WISCY                           CGL183
     C                     MOVELWDAT      WDDMM   4                       CGL183
     C                     MOVE WDDMM     WISMM                           CGL183
      *                                                                   CGL183
     C** -------------------------------------------------------------
     C**     VAT
     C** -------------------------------------------------------------
     C**   ACCESS ABSFI101
     C**          XTVA           5  4       TEXT('VAT Rate      ')
     C**          BQCTVA         1          TEXT('VAT Bank Y=Yes N=No')
     C**
     C*                                                                   076189
     C**   IF VAT IS ON - CHAIN TO ABSFI101                               076189
     C           VATP      IFEQ 'Y'                                       076189
     C           1         CHAINABSFI1F1             99
     C           *IN99     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA
     C                     Z-ADD012       DBASE            ***************
     C                     MOVE 'ABSFI'   DBFILE           * DBERROR 012 *
     C                     MOVEL'1'       DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C                     END                                            076189
      *                                                                   CRT002
     C                     MOVE '0'       @FIRST                          CRT002
      *                                                                   CRT002
     C           PMODE     IFEQ 'I'                                       CRT002
     C                     OPEN RE3360DF                                  CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C/COPY ZSRSRC,RBEQENC1                                               CRT002
      *                                                                   CRT002
     C**
     C** -------------------------------------------------------------
     C*
     C** DISPLAY FILE PROCESSING
     C*
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3360CCP1                                           S01408
     C*                                                                   S01408
     C           FUNC      IFNE 'F12'                                                         239966
     C                     EXSR DFPROC
     C                     ENDIF                                                              239966
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3360CCP2                                           S01408
     C*                                                                   S01408
      *                                                                                       CER016
      ** Call AOSARDR0 to check for CER016                                                    CER016
      *                                                                                       CER016
     C                     CALL 'AOSARDR0'                                                    CER016
     C                     PARM *BLANKS   PRTCD   7                                           CER016
     C                     PARM '*VERIFY' POPTN   7                                           CER016
     C                     PARM 'CER016'  PSARD   6                                           CER016
     C           SCSARD    PARM SCSARD    DSFDY                                               CER016
      *                                                                                       CER016
     C           PRTCD     IFEQ *BLANKS                                                       CER016
     C                     MOVE 'Y'       CER016  1                                           CER016
     C                     MOVE 'Y'       WFIRST  1                                           CER016
     C                     ELSE                                                               CER016
      *                                                                                       CER016
     C                     MOVE 'N'       CER016                                              CER016
     C                     MOVE 'N'       WFIRST                                              CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C           PRTCD     IFNE *BLANKS                                                       CER016
     C           PRTCD     ANDNE'*NRF   '                                                     CER016
     C           *LOCK     IN   LDA                                                           CER016
     C                     MOVEL'CER016'  DBKEY                                               CER016
     C                     MOVEL'SCSARDPD'DBFILE                                              CER016
     C                     Z-ADD046       DBASE                                               CER016
     C                     OUT  LDA                                                           CER016
     C                     EXSR *PSSR                                                         CER016
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C*
     C                     ENDSR                           **FIRST ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** MAIN subroutine to execute main processing.
     C**
     C**     Called by       S T A R T
     C**     Calls           ACCNUM, DFPROC, INTCAL, RETNUM, TFPARM
     C**
     C           MAIN      BEGSR                           **MAIN BEGSR**
     C*
     C** SET UP FORMAT INDICATORS
     C*
     C                     MOVE '1'       *IN21
     C                     MOVEA'111'     *IN,42
     C                     MOVEA'111'     *IN,56
     C           FUNC      IFEQ 'F12'                                                         239966
     C           SBRCA     ANDEQOBRCA                                                         240452
     C           SCNUM     ANDEQOCNUM                                                         240452
     C           SCCY      ANDEQOCCY                                                          240452
     C           SACOD     ANDEQOACOD                                                         240452
     C           SACSQ     ANDEQOACSQ                                                         240452
     C           SRTNO     ANDEQORTNO                                                         240452
     C                     MOVE WACNO     SRTNO                                               239966
     C                     ENDIF                                                              239966
     C           SBRCA     IFNE OBRCA                                                         240452
     C           SCNUM     ORNE OCNUM                                                         240452
     C           SCCY      ORNE OCCY                                                          240452
     C           SACOD     ORNE OACOD                                                         240452
     C           SACSQ     ORNE OACSQ                                                         240452
     C           SRTNO     ORNE ORTNO                                                         240452
     C                     MOVE 'N'       EXTFLG                                              240452
     C                     ENDIF                                                              240452
     C/COPY WNCPYSRC,RE3360C033
     C*
     C** TRANSFER CONTROL TO OTHER ENQUIRIES VIA GROUP JOB
     C*
     C           SBRCA     IFEQ OBRCA
     C           SCNUM     ANDEQOCNUM
     C           SCCY      ANDEQOCCY
     C           SACOD     ANDEQOACOD
     C           SACSQ     ANDEQOACSQ
     C           SRTNO     ANDEQORTNO
     C*
     C/COPY WNCPYSRC,RE3360C051
     C** CMD13 - HISTORY POSITION
     C*
     C           *INKM     IFEQ '1'                                                           239966
     C                     MOVEL'F13'     FUNC                                                239966
     C                     EXSR TFPARM                                                        239966
     C                     OUT  DSLDA                                                         239966
     C                     MOVE 'Y'       EXTFLG                                              239966
     C                     ENDIF                                                              239966
      *                                                                                       239966
     C           *INKN     IFEQ '1'                                                           239966
     C                     MOVEL'F14'     FUNC                                                239966
     C                     EXSR TFPARM                                                        239966
     C                     OUT  DSLDA                                                         239966
     C                     MOVE 'Y'       EXTFLG                                              239966
     C                     ENDIF                                                              239966
      *                                                                                       239966
     C********** *INKM     IFEQ '1'                        - B1                               239966
     C**********           EXSR TFPARM                                                        239966
     C**********           OUT  DSLDA                                                         239966
     C**********           CALL 'RE360C'                                                      239966
     C**********           PARM 'RE3361 ' PARAM                                               239966
     C**********           MOVE *BLANKS   SRTNO                                               239966
     C**********           END                             - E1                               239966
     C**********                                                                              239966
     C***CMD14*-*INTEREST DETAILS                                                             239966
     C**********                                                                              239966
     C********** *INKN     IFEQ '1'                        - B1                               239966
     C**********           EXSR TFPARM                                                        239966
     C**********           OUT  DSLDA                                                         239966
     C**********           CALL 'RE360C'                                                      239966
     C**********           PARM 'RE3363 ' PARAM                                               239966
     C**********           MOVE *BLANKS   SRTNO                                               239966
     C**********           END                             - E1                               239966
     C*
     C** CMD11 - COMMISSION DETAILS
     C*
     C           *INKK     IFEQ '1'
     C*
     C                     MOVE '0'       *IN21
     C*
     C                     EXFMTRE3360F2
     C*
     C                     MOVE '1'       *IN21
     C                     MOVE *BLANK    SRTNO
     C*
     C                     END
     C*
     C                     END
     C*
     C** IF RETAIL NUMBER IS NOT USED, FORCE BLANK OVER ZERO IN SRTNO
     C*
     C           *IN68     IFEQ '0'
     C                     MOVE *BLANKS   SRTNO
     C                     END
     C*
     C** PREPARE WORK VARIABLES AND FORMAT INDICATORS
     C*
     C                     Z-ADD0         S
     C                     MOVE *BLANKS   ERMSG
     C                     MOVE '1'       *IN20
     C                     MOVEA'00'      *IN,24
     C                     MOVE '0'       *IN26
     C*
     C                     MOVE '0'       *IN45
     C                     MOVE '0'       *IN36
     C                     MOVE '0'       *IN85                           196856
     C*
     C** SET UP INDICATOR 36 IF BRANCH CODE IS BLANK (IN MULTI-
     C** BRANCHING ENVIRONMENT)
     C*
     C           MBIN      IFEQ 'Y'
     C           SBRCA     ANDEQ*BLANKS
     C                     MOVE '1'       *IN36
     C                     END
      *                                                                                       CDL013
      ** Check if CDL013 is installed                                                         CDL013
     C                     CALL 'AOSARDR0'                                                    CDL013
     C                     PARM *BLANKS   @RTCD   7                                           CDL013
     C                     PARM '*VERIFY' @OPTN   7                                           CDL013
     C                     PARM 'CDL013'  @SARD   6                                           CDL013
     C                     PARM           DSFDY                                               CDL013
      *                                                                                       CDL013
      ** If CDL013 NOT installed, set field to 0                                              CDL013
     C           @RTCD     IFNE *BLANKS                                                       CDL013
     C                     MOVE '0'       CDL013  1                                           CDL013
      *                                                                                       CDL013
      ** If CDL013 installed                                                                  CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
     C                     MOVE '1'       CDL013                                              CDL013
     C                     MOVEL'RETAIL'  WTYPE  10 P                                         CDL013
      *                                                                                       CDL013
      ** Access ICD to determine WHT rate                                                     CDL013
     C           WTYPE     CHAINSDSTAAL1             74                                       CDL013
      *                                                                                       CDL013
      ** If CHAIN failed                                                                      CDL013
     C           *IN74     IFEQ '1'                                                           CDL013
     C           *LOCK     IN   LDA                                                           CDL013
     C                     Z-ADD18        DBASE            ************                       CDL013
     C                     MOVEL'SDSTAAL1'DBFILE           * DBERR 18 *                       CDL013
     C                     MOVELWTYPE     DBKEY            ************                       CDL013
     C                     OUT  LDA                                                           CDL013
     C                     MOVE *OFF      *IN89                                               CDL013
     C                     EXSR DBSR                                                          CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CER049
      ** Check if CER049 is installed                                                         CER049
     C                     CALL 'AOSARDR0'                                                    CER049
     C                     PARM *BLANKS   @RTCD                                               CER049
     C                     PARM '*VERIFY' @OPTN                                               CER049
     C                     PARM 'CER049'  @SARD                                               CER049
     C                     PARM           DSFDY                                               CER049
      *                                                                                       CER049
      ** If CER049 NOT installed, set field to N                                              CER049
     C           @RTCD     IFNE *BLANKS                                                       CER049
     C                     MOVE 'N'       CER049  1                                           CER049
     C                     SETOF                     19                                       CER049
      *                                                                                       CER049
      ** If CER049 installed                                                                  CER049
     C                     ELSE                                                               CER049
      *                                                                                       CER049
     C                     MOVE 'Y'       CER049                                              CER049
     C                     SETON                     19                                       CER049
     C                     ENDIF                                                              CER049
      *                                                                                     AR823701
      ** Check if CER055 is installed                                                       AR823701
     C                     CALL 'AOSARDR0'                                                  AR823701
     C                     PARM *BLANKS   @RTCD                                             AR823701
     C                     PARM '*VERIFY' @OPTN                                             AR823701
     C                     PARM 'CER055'  @SARD                                             AR823701
     C                     PARM           DSFDY                                             AR823701
      *                                                                                     AR823701
     C           @RTCD     IFNE *BLANKS                                                     AR823701
     C                     MOVE 'N'       CER055  1                                         AR823701
     C                     ELSE                                                             AR823701
     C                     MOVE 'Y'       CER055                                            AR823701
     C                     ENDIF                                                            AR823701
      *                                                                                       CRE090
      ** Check if CRE090 is installed                                                         CRE090
      *                                                                                       CRE090
     C                     CALL 'AOSARDR0'                                                    CRE090
     C                     PARM *BLANKS   @RTCD                                               CRE090
     C                     PARM '*VERIFY' @OPTN                                               CRE090
     C                     PARM 'CRE090'  @SARD                                               CRE090
     C                     PARM           DSFDY                                               CRE090
      *                                                                                       CRE090
     C           @RTCD     IFNE *BLANKS                                                       CRE090
     C                     MOVE 'N'       CRE090  1                                           CRE090
     C                     ELSE                                                               CRE090
     C                     MOVE 'Y'       CRE090                                              CRE090
     C                     ENDIF                                                              CRE090
     C*
     C/COPY WNCPYSRC,RE3360CCP8
     C*
     C** CHECK FOR FIELDS WHICH HAVE BEEN ENTERED
     C*
     C           EXTFLG    IFEQ 'N'                                                           239966
      *                                                                                       239966
     C           MBIN      IFEQ 'Y'                                                           209861
     C           SCNUM     IFEQ *BLANKS                    - B2
     C           SCCY      ANDEQ*BLANKS
     C           SACOD     ANDEQ*BLANKS
     C           SACSQ     ANDEQ*BLANKS
     C           *IN36     ANDEQ'1'
     C*
     C           SRTNO     IFEQ *BLANKS                    - B3
     C                     ADD  1         S
     C                     MOVE '001'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,1    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     MOVE '1'       *IN25
     C                     MOVE '1'       *IN24
     C                     MOVE '1'       *IN26
     C                     ELSE                            - X3
     C*
     C** RETAIL NUMBER ONLY HAS BEEN ENTERED
     C*
     C                     EXSR RETNUM
     C*
     C                     END                             - E3
     C*
     C                     ELSE                            - X2
     C*
     C           SCNUM     IFNE *BLANKS                    - B3
     C           SRTNO     ANDNE*BLANKS
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3360CCP3                                           S01408
     C*                                                                   S01408
     C                     ADD  1         S
     C                     MOVE '004'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,4    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     MOVE '1'       *IN25
     C                     MOVE '1'       *IN24
     C                     MOVE '1'       *IN26
     C*
     C                     ELSE                            - X3
     C*
     C           SACSQ     IFEQ *BLANKS                    - B4
     C                     MOVE '01'      SACSQ
     C                     END                             - E4
     C*
     C** A/C DETAILS HAVE BEEN ENTERED
     C*
     C/COPY WNCPYSRC,RE3360C017
     C                     EXSR ACCNUM
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2
      *                                                                                       209861
     C                     ELSE                                                               209861
     C           SCNUM     IFEQ *BLANKS                    - B2                               209861
     C           SCCY      ANDEQ*BLANKS                                                       209861
     C           SACOD     ANDEQ*BLANKS                                                       209861
     C           SACSQ     ANDEQ*BLANKS                                                       209861
      *                                                                                       209861
     C           SRTNO     IFEQ *BLANKS                    - B3                               209861
     C                     ADD  1         S                                                   209861
     C                     MOVE '001'     SRCD,S                                              209861
     C                     MOVELSRCD,S    ERCD                                                209861
     C                     MOVELERCM,1    ERMSG                                               209861
     C                     MOVE *BLANKS   WANAM                                               209861
     C                     MOVE '1'       *IN25                                               209861
     C                     MOVE '1'       *IN24                                               209861
     C                     MOVE '1'       *IN26                                               209861
     C                     ELSE                            - X3                               209861
      *                                                                                       209861
      ** RETAIL NUMBER ONLY HAS BEEN ENTERED                                                  209861
      *                                                                                       209861
     C                     EXSR RETNUM                                                        209861
      *                                                                                       209861
     C                     ENDIF                           - E3                               209861
      *                                                                                       209861
     C                     ELSE                            - X2                               209861
      *                                                                                       209861
     C           SCNUM     IFNE *BLANKS                    - B3                               209861
     C           SRTNO     ANDNE*BLANKS                                                       209861
      *                                                                                       209861
      *                                                                                       209861
     C                     ADD  1         S                                                   209861
     C                     MOVE '004'     SRCD,S                                              209861
     C                     MOVELSRCD,S    ERCD                                                209861
     C                     MOVELERCM,4    ERMSG                                               209861
     C                     MOVE *BLANKS   WANAM                                               209861
     C                     MOVE '1'       *IN25                                               209861
     C                     MOVE '1'       *IN24                                               209861
     C                     MOVE '1'       *IN26                                               209861
      *                                                                                       209861
     C                     ELSE                            - X3                               209861
      *                                                                                       209861
     C           SACSQ     IFEQ *BLANKS                    - B4                               209861
     C                     MOVE '01'      SACSQ                                               209861
     C                     ENDIF                           - E4                               209861
      *                                                                                       209861
      ** A/C DETAILS HAVE BEEN ENTERED                                                        209861
      *                                                                                       209861
     C                     EXSR ACCNUM                                                        209861
      *                                                                                       209861
     C                     ENDIF                           - E3                               209861
      *                                                                                       209861
     C                     ENDIF                           - E2                               209861
     C                     ENDIF                           - E1                               209861
     C*
     C/COPY WNCPYSRC,RE3360CCP7
     C*
     C                     EXSR SRDSP                                                         CER016
     C*
     C** DISPLAY FILE PROCESSING
     C*
     C                     EXSR DFPROC
     C                     ENDIF                                                              239966
     C/COPY WNCPYSRC,RE3360C001
     C*
     C                     ENDSR                           **MAIN ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ACCNUM   A/C details have been entered
     C**
     C**     Called by       MAIN
     C**     Calls           DBSR, SCROUT
     C**
     C           ACCNUM    BEGSR                           **ACCNUM BEGSR**
     C**********                                                                              CSD027
     C***CHECK*FOR NUMERIC CUSTOMER NUMBER                                                    CSD027
     C**********                                                                              CSD027
     C**********           MOVELSCNUM     FLD70                                               CSD027
     C**********           MOVELFLD70     FLD6                                                CSD027
     C*
     C** CHECK FOR NUMERIC ACCOUNT CODE
     C*
     C                     MOVELSACOD     FLD50
     C                     MOVELFLD50     FLD4
     C*
     C** CHECK FOR NUMERIC SEQUENCE NUMBER
     C*
     C                     MOVELSACSQ     FLD30
     C                     MOVELFLD30     FLD2
     C*
     C** CHECK IF BRANCH CODE IS NOT ENTERED
     C** BRANCH CODE NOT ENTERED, MOVE DEFAULT VALUE.
     C*
     C                     MOVE '0'       *IN30
     C           SBRCA     IFEQ *BLANKS
     C                     MOVE '1'       *IN30
     C                     MOVE DFBM      SBRCA
     C                     END
     C*
     C** CHECK FOR NUMERIC BRANCH NUMBER
     C*
     C                     MOVELSBRCA     FLD80
     C                     MOVELFLD80     FLD3
     C*
     C********** SCNUM     IFEQ FLD6                                                          CSD027
     C********** SACOD     ANDEQFLD4                                                          CSD027
     C           SACOD     IFEQ FLD4                                                          CSD027
     C           SACSQ     ANDEQFLD2
     C*
     C** CHAIN TO REIAC ONLY IF SCNUM, SACOD AND SACSQ ARE NUMERIC
     C*
     C** BASIC VALIDATION OF INPUT BRANCH CODE
     C*
     C                     MOVE '0'       *IN26
     C           MBIN      IFEQ 'Y'                        IF MULTIBRANCH
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM *BLANKS   @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM SBRCA     @DSNB   3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*
     C           @RTCD     IFNE *BLANKS
     C                     ADD  1         S
     C                     MOVE '007'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,7    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     MOVE '1'       *IN26
     C                     ELSE
     C                     MOVE A8BRCD    SBRCA
     C                     MOVELA8BRNM    WBRNM  30
     C*
     C** BRANCH CODE VALIDATION: USER'S AUTHORITY TO BRANCH ENTERED
     C*
     C                     Z-ADD0         ERR
     C*
     C                     CALL 'ZVBBU'
     C                     PARM SBRCA     ZBRCAX  3
     C                     PARM           ERR     10
     C*
     C           ERR       IFNE *ZERO
     C                     ADD  1         S
     C*
     C           ERR       IFEQ 1
     C                     MOVE '308'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,8    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     ELSE
     C                     MOVE '309'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,9    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     END
     C*
     C                     MOVE '1'       *IN26
     C*
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C           *IN26     IFEQ '0'
     C           RETKEY    CHAINREIAC                99
     C*
     C           NOALT     IFNE *ZERO
     C                     MOVE '1'       *IN45
     C                     END
     C*
     C                     END
     C                     END
     C*
     C           *IN26     IFEQ '0'
     C*
     C********** SCNUM     IFNE FLD6                       - B1                               CSD027
     C********** SACOD     ORNE FLD4                                                          CSD027
     C           SACOD     IFNE FLD4                                                          CSD027
     C           SACSQ     ORNE FLD2
     C           *IN99     OREQ '1'
     C                     ADD  1         S
     C                     MOVE '002'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,2    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     MOVE '1'       *IN25
     C           *IN30     IFEQ '0'
     C                     MOVE '1'       *IN26
     C                     ELSE
     C                     MOVE *BLANKS   SBRCA
     C                     END
     C*
     C                     ELSE                            - X1
     C/COPY WNCPYSRC,RE3360C002
     C*
     C** RECORD FOUND - CHAIN TO ACCNT
     C*
     C           RETKEY    CHAINACCNT                99
     C*
     C** ERROR IN ACCNTABF
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD006       DBASE            ***************
     C                     MOVE 'ACCNT'   DBFILE           * DBERROR 006 *
     C                     MOVELRKEY      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C/COPY WNCPYSRC,RE3360C034
     C***********RECI      IFNE 'D'                        - B2           196856
     C***********          ADD  1         S                               196856
     C***********          MOVE '005'     SRCD,S                          196856
     C***********          MOVELSRCD,S    ERCD                            196856
     C***********          MOVELERCM,5    ERMSG                           196856
     C***********          MOVE *BLANKS   WANAM                    074590 196856
     C***********          MOVE *OFF      *IN86            N86 = CF086086 196856
     C***********          ELSE                            - X2           196856
     C*
     C********** RECI      IFNE 'D'                        - B2                        229202 261086
     C**********           ADD  1         S                                            229202 261086
     C**********           MOVE '005'     SRCD,S                                       229202 261086
     C**********           MOVELSRCD,S    ERCD                                         229202 261086
     C**********           MOVELERCM,5    ERMSG                                        229202 261086
     C**********           MOVE ACNO      SRTNO                                        229202 261086
     C**********           MOVE *BLANKS   WANAM                                        229202 261086
     C**********           MOVE *OFF      *IN86            N86                         229202 261086
     C**********           MOVE *ON       *IN85                                        229202 261086
     C**********           ELSE                            - X2                        229202 261086
      *                                                                                       262397
      ** If account is already closed, check if there are still retail history records.       262397
      ** If no records found, send an error message                                           262397
      *                                                                                       262397
     C                     MOVE 0         *IN49                                               262397
     C           RECI      IFEQ 'C'                                                           262397
     C           R1KEY     SETGTREHISL                                                        262397
     C           R1KEY     REDPEREHISL                   49                                   262397
     C                     ENDIF                                                              262397
      *                                                                                       262397
     C           *IN49     IFEQ '1'                                                           262397
     C                     ADD  1         S                                                   262397
     C                     MOVE '010'     SRCD,S                                              262397
     C                     MOVELSRCD,S    ERCD                                                262397
     C                     MOVELERCM,10   ERMSG                                               262397
     C                     MOVE *BLANKS   WANAM                                               262397
     C                     MOVE *OFF      *IN86                                               262397
     C                     ELSE                                                               262397
      * If no errors and feature not off, check user authority                                CRE024
      * to account code                                                                       CRE024
     C           CRE024    IFNE 'N'                                                           CRE024
     C                     CALL 'SF0930'                                                      CRE024
     C                     PARM           CRE024  1                                           CRE024
     C                     PARM *BLANKS   UMAUTH  1                                           CRE024
     C                     PARM ACOD      UMACOD 100                                          CRE024
     C**********           PARM CNUM      UMCNUM  60                                 CRE024 BUG11679
     C                     PARM CNUM      UMCNUM  6                                         BUG11679
     C                     PARM CCY       UMCCY   3                                           CRE024
     C                     PARM ACSQ      UMACSQ  20                                          CRE024
     C                     PARM BRCA      UMBRCA  3                                           CRE024
     C                     PARM 'RE3360'  UMPGM  10                                           CRE024
     C                     PARM '*REPT'   UMOPTN  5                                           CRE024
     C                     PARM *BLANKS   UMEMSG 50                                           CRE024
     C                     END                                                                CRE024
      *                                                                                       CRE024
      * If user not authorised, set on error indicators                                       CRE024
     C           UMAUTH    IFEQ 'N'                                                           CRE024
     C                     MOVEA'11'      *IN,25                                              CRE024
     C                     ADD  1         S                                                   CRE024
     C                     MOVE *BLANKS   ERCD                                                CRE024
     C                     MOVELUMEMSG    ERMSG     P                                         CRE024
     C                     MOVE *BLANKS   WANAM                                               CRE024
     C                     ELSE                                                               CRE024
      *                                                                                       CGL186
      ** Access Customer details.                                                             CGL186
      *                                                                                       CGL186
     C                     CALL 'AOCUSTR2'                                                    CGL186
     C                     PARM *BLANKS   P@RTCD  7                                           CGL186
     C                     PARM '*KEY'    P@OPTN  7                                           CGL186
     C                     PARM SCNUM     P@KEY1 10                                           CGL186
     C                     PARM           P@ANY   7                                           CGL186
     C           SDCUST    PARM SDCUST    DSLDY                                               CGL186
      *                                                                                       CGL186
     C/COPY WNCPYSRC,RE3360C009
     C                     MOVE *ON       *IN86            86 = CF14 on   086086
     C                     MOVE ACNO      SRTNO
     C                     MOVE ACNO      WACNO                                            240452
     C                     MOVE SRTNO     ORTNO
     C                     MOVE SBRCA     OBRCA
     C                     MOVE SCNUM     OCNUM
     C                     MOVE SCCY      OCCY
     C                     MOVE SACOD     OACOD
     C                     MOVE SACSQ     OACSQ
     C                     MOVE ANAM      WANAM                           074590
     C*
     C** LIVE RECORD FOUND - FORMAT SCREEN OUTPUT
     C*
     C                     EXSR SCROUT
     C                     END                                                                CRE024
      *                                                                                       CRE024
     C/COPY WNCPYSRC,RE3360C010
     C*
     C***********          END                             - E2           196856
     C**********           ENDIF                           - E2                        229202 261086
      *                                                                                       262397
     C                     ENDIF                                                              262397
     C/COPY WNCPYSRC,RE3360C035
     C*
     C                     END                             - E1
     C*
     C                     END
     C*
     C                     ENDSR                           **ACCNUM ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RETNUM retail number only has been entered
     C**
     C**     Called by       MAIN
     C**     Calls           SCROUT
     C**
     C           RETNUM    BEGSR                           **RETNUM BEGSR*
     C*
     C** CHECK FOR NUMERIC RETAIL NUMBER
     C*
     C                     MOVELSRTNO     FLD11
     C                     MOVELFLD11     FLD10
     C*
     C           SRTNO     IFEQ FLD10                      - B1
     C           RETNO     CHAINACNUM                99
     C                     END                             - E1
     C*
     C           SRTNO     IFNE FLD10
     C           *IN99     OREQ '1'
     C                     ADD  1         S
     C                     MOVE '003'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,3    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     MOVE '1'       *IN24
     C                     ELSE
     C*                                                                   074590
     C** Chain to ACCNT for account name.                                 074590
     C*                                                                   074590
     C                     MOVE CNUM      CNUMK                           074590
     C                     MOVE CCY       SCCY                            074590
     C                     MOVE ACOD      ACODK                           074590
     C                     MOVE ACSQ      ACSQK                           074590
     C                     MOVE BRCA      SBRCA                           074590
     C*                                                                   074590
     C/COPY WNCPYSRC,RE3360C052
     C           RETKEY    CHAINACCNT                97                   074590
     C*                                                                   074590
     C** ERROR IN ACCNTABF                                                074590
     C*                                                                   074590
     C           *IN97     IFEQ '1'                                       074590
     C           *LOCK     IN   LDA                                       074590
     C                     Z-ADD017       DBASE            ***************074590
     C                     MOVE 'ACCNT'   DBFILE           * DBERROR 017 *074590
     C                     MOVELRKEY      DBKEY            ***************074590
     C                     OUT  LDA                                       074590
     C                     MOVEA'1'       *IN,89                          074590
     C                     EXSR DBSR                                      074590
     C                     ELSE                                           074590
     C                     MOVE ANAM      WANAM                           074590
     C                     END                                            074590
     C*
      * Only allow CF14 if still Live                                     086086
     C           RECI      COMP 'D'                      86LIVE=86        086086
      *                                                                   086086
     C** VALIDATE BOOKING BRANCH
     C*
     C                     Z-ADD0         ERR
     C                     MOVE '0'       *IN26
     C*
     C           MBIN      IFEQ 'Y'
     C                     CALL 'ZVBBU'
     C                     PARM BRCA      ZBRCAX
     C                     PARM           ERR
     C           ERR       IFNE *ZERO
     C                     ADD  1         S
     C*
     C           ERR       IFEQ 1
     C                     MOVE '308'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,8    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     ELSE
     C                     MOVE '309'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,9    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     END
     C*
     C                     MOVE '1'       *IN26
     C                     END
     C                     END
      *                                                                                       CRE024
      * If no errors and feature not off, check user authority                                CRE024
      * to account code                                                                       CRE024
     C           CRE024    IFNE 'N'                                                           CRE024
     C           *IN26     ANDEQ'0'                                                           CRE024
     C                     CALL 'SF0930'                                                      CRE024
     C                     PARM           CRE024  1                                           CRE024
     C                     PARM *BLANKS   UMAUTH  1                                           CRE024
     C                     PARM ACOD      UMACOD 100                                          CRE024
     C**********           PARM CNUM      UMCNUM  60                                 CRE024 BUG11679
     C                     PARM CNUM      UMCNUM  6                                         BUG11679
     C                     PARM CCY       UMCCY   3                                           CRE024
     C                     PARM ACSQ      UMACSQ  20                                          CRE024
     C                     PARM BRCA      UMBRCA  3                                           CRE024
     C                     PARM 'RE3360'  UMPGM  10                                           CRE024
     C                     PARM '*REPT'   UMOPTN  5                                           CRE024
     C                     PARM *BLANKS   UMEMSG 50                                           CRE024
      *                                                                                       CRE024
      * If user not authorised, set on error indicators                                       CRE024
     C           UMAUTH    IFEQ 'N'                                                           CRE024
     C                     MOVEA'111'     *IN,24                                              CRE024
     C                     ADD  1         S                                                   CRE024
     C                     MOVE *BLANKS   ERCD                                                CRE024
     C                     MOVELUMEMSG    ERMSG     P                                         CRE024
     C                     MOVE *BLANKS   WANAM                                               CRE024
     C                     END                                                                CRE024
     C                     END                                                                CRE024
     C/COPY WNCPYSRC,RE3360C011
     C*
     C** IF THERE IS NO ERROR
     C*
     C           *IN26     IFEQ '0'
     C*
     C** RECORD FOUND - USE FIELDS TO CHAIN REIAC
     C*
     C                     MOVE CNUM      SCNUM
     C                     MOVE CCY       SCCY
     C                     MOVE ACOD      SACOD
     C                     MOVE ACSQ      SACSQ
     C                     MOVE BRCA      SBRCA
     C*
     C           PMODE     IFEQ 'I'                                       CRT002
     C                     MOVE SRTNO     ORTNO
     C                     MOVE SRTNO     WACNO                                             240452
     C                     MOVE SBRCA     OBRCA
     C                     MOVE SCNUM     OCNUM
     C                     MOVE SCCY      OCCY
     C                     MOVE SACOD     OACOD
     C                     MOVE SACSQ     OACSQ
     C                     ENDIF                                          CRT002
     C*
     C           RETKEY    CHAINREIAC                99
     C*
     C           *IN99     IFEQ '1'
     C                     ADD  1         S
     C                     MOVE '002'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,2    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     MOVE '1'       *IN25
     C           *IN30     IFEQ '0'
     C                     MOVE '1'       *IN26
     C                     END
     C*
     C                     ELSE
     C/COPY WNCPYSRC,RE3360C003
     C*
     C** IF THE ACCOUNT IS ALTERNATIVE, SETON THE INDICATOR
     C*
     C           NOALT     IFNE *ZERO
     C                     MOVE '1'       *IN45
     C                     END
      *                                                                                       262397
      ** If account is already closed, check if there are still retail history records.       262397
      ** If no records found, send an error message                                           262397
      *                                                                                       262397
     C                     MOVE 0         *IN49                                               262397
     C           RECI      IFEQ 'C'                                                           262397
     C           R1KEY     SETGTREHISL                                                        262397
     C           R1KEY     REDPEREHISL                   49                                   262397
     C                     ENDIF                                                              262397
      *                                                                                       262397
     C           *IN49     IFEQ '1'                                                           262397
     C                     ADD  1         S                                                   262397
     C                     MOVE '010'     SRCD,S                                              262397
     C                     MOVELSRCD,S    ERCD                                                262397
     C                     MOVELERCM,10   ERMSG                                               262397
     C                     MOVE *BLANKS   WANAM                                               262397
     C                     ELSE                                                               262397
     C*
     C** LIVE RECORD FOUND - FORMAT SCREEN OUTPUT
     C*
     C                     EXSR SCROUT
     C*
     C                     ENDIF                                                              262397
      *                                                                                       262397
     C                     END
     C*
     C                     END
     C*
     C                     END
     C*
     C           PMODE     IFEQ 'P'                                       CRT002
     C           ERMSG     ANDNE*BLANKS                                   CRT002
     C                     EXSR DTQERR                                    CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     ENDSR                           **RETNUM ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SCROUT live record found - format screen output
     C**
     C**     Called by       ACCNUM, RETNUM
     C**     Calls           DBSR
     C**
     C           SCROUT    BEGSR                           **SCROUT BEGSR*
     C*                                                                   159536
     C** Set up keys for chain to RELINKL1 (secondary account) and        159536
     C** RELINKJ2 (primary account) files.                                159536
     C*                                                                   159536
     C           LINKKY    KLIST                                          159536
     C                     KFLD           W#BRCH                          159536
     C                     KFLD           W#CUST                          159536
     C                     KFLD           W#CCY                           159536
     C                     KFLD           W#ACOD                          159536
     C                     KFLD           W#ACSQ                          159536
     C*                                                                   159536
     C** Now move values into variables used in key.                      159536
     C*                                                                   159536
     C                     MOVELSBRCA     W#BRCH                          159536
     C*********            MOVELACNO      W#CUST                          159536
     C                     MOVELSCNUM     W#CUST                          159536
     C                     MOVELSCCY      W#CCY                           159536
     C                     MOVELSACOD     W#ACOD                          159536
     C                     MOVELSACSQ     W#ACSQ                          159536
     C                     Z-ADD0         MAXC0                                               239966
     C                     Z-ADD0         MAXC1                                               239966
     C                     Z-ADD0         MAXC2                                               239966
     C                     Z-ADD0         MAXC3                                               239966
     C                     Z-ADD0         MINC0                                               239966
     C                     Z-ADD0         MINC1                                               239966
     C                     Z-ADD0         MINC2                                               239966
     C                     Z-ADD0         MINC3                                               239966
     C*                                                                   159536
     C** Chain to RELINKJ2 to see if A/c is a primary A/c. If it is       159536
     C** found, set on IN33.                                              159536
     C*                                                                   159536
     C           LINKKY    CHAINRELINKJ2             99                   159536
     C           *IN99     IFEQ *OFF                                      159536
     C                     SETON                     33                   159536
     C                     ELSE                                           159536
     C                     SETOF                     33                   159536
     C                     ENDIF                                          159536
     C*                                                                   159536
     C** Chain to RELINKL1 to see if A/c is a secondary A/c if it         159536
     C** is not a primary A/c. If it is found, set on IN34 to display     159536
     C** details on screen.                                               159536
     C*                                                                   159536
     C                     MOVE '0'       *IN34                                               241027
     C           *IN33     IFNE *ON                                       159536
     C           LINKKY    CHAINRELINKL1             99                   159536
     C           *IN99     IFEQ *OFF                                      159536
     C                     SETON                     34                   159536
     C                     ELSE                                           159536
     C                     SETOF                     34                   159536
     C                     ENDIF                                          159536
     C                     ENDIF                                          159536
      *                                                                                       241027
     C           *IN34     IFEQ '1'                                                           241027
     C                     MOVE LTCUST    CNUMK                                               241027
     C                     MOVE W#CCY     SCCY                                                241027
     C                     MOVE LTAC      ACODK                                               241027
     C                     MOVE LTAS      ACSQK                                               241027
     C                     MOVE LTAB      SBRCA                                               241027
      *                                                                                       241027
      ** Check if Primary Account exists in PF/ACCNTAB                                        241027
      *                                                                                       241027
     C           RETKEY    CHAINACCNT                97                                       241027
     C*                                                                                       241027
     C** ERROR IN ACCNTABF                                                                    241027
     C*                                                                                       241027
     C           *IN97     IFEQ '1'                                                           241027
     C           *LOCK     IN   LDA                                                           241027
     C                     Z-ADD019       DBASE            ***************                    241027
     C                     MOVE 'ACCNT'   DBFILE           * DBERROR 019 *                    241027
     C                     MOVELRKEY      DBKEY            ***************                    241027
     C                     OUT  LDA                                                           241027
     C                     MOVEA'1'       *IN,89                                              241027
     C                     EXSR DBSR                                                          241027
     C                     ELSE                                                               241027
      *                                                                                       241027
      ** If Retail Account Number Used, display the retail account number otherwise use       241027
      ** Full GL account number                                                               241027
      *                                                                                       241027
     C           *IN68     IFEQ '1'                                                           241027
     C           ACNO      ANDNE0                                                             241027
     C           PRMRET    ANDEQ'Y'                                                           241027
     C                     MOVE ACNO      LACNO                                               241027
     C                     ELSE                                                               241027
     C                     MOVE CNUM      LCNUM                                               241027
     C                     MOVE CCY       LCCY                                                241027
     C                     MOVE ACOD      LACOD                                               241027
     C                     MOVE ACSQ      LACSQ                                               241027
     C                     MOVE BRCA      LBRCH                                               241027
     C                     ENDIF                                                              241027
     C                     ENDIF                                                              241027
      *                                                                                       241027
      ** Return Secondary account values to LF/ACCNT fields.                                  241027
      *                                                                                       241027
     C                     MOVE W#CUST    CNUMK                                               241027
     C                     MOVE W#CCY     SCCY                                                241027
     C                     MOVE W#ACOD    ACODK                                               241027
     C                     MOVE W#ACSQ    ACSQK                                               241027
     C                     MOVE W#BRCH    SBRCA                                               241027
     C           RETKEY    CHAINACCNT                97                                       241027
     C                     ENDIF                                                              241027
     C*
     C** SET OFF FORMAT INDICATOR
     C*
     C                     MOVE '0'       *IN21
     C                     MOVE '0'       *IN23
     C*
     C** CONDITION OUTPUT FOR BRANCH (IF MBIN = 'N')
     C*
     C           *IN37     IFEQ '0'
     C                     MOVE '1'       *IN23
     C                     END
     C*
     C** REBATABLE / NON-REBATABLE ACCUMULATED FOR CHARGES TOTAL.
     C*
     C                     Z-ADDNRCA      NRCA0
     C                     Z-ADDRCA       RCA0
     C*
     C           NRCA      ADD  RCA       SOACC0
     C*
     C           CHGT      IFEQ 0                          - B1
     C                     Z-ADD0         NRCA0
     C                     Z-ADD0         RCA0
     C                     Z-ADD0         SOACC0
     C                     Z-ADD0         SCACC0
     C*
     C                     ELSE                            - X1
     C*
     C** CHECK CHARGE IS WITHIN MAX AND MIN CHARGES
     C*
     C                     MOVE SCCY      CCY
      *                                                                   153001
      * Minimum/maximum does not apply at a/c closure.                    153001
     C           ACST      IFNE 'C'                                       153001
     C*
     C** CHAIN TO CHARGES FILE - RECRG
     C*
     C           RECHRK    CHAINRECRG                99
     C*
     C** ERROR IN RECRGDF
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           RECI      ORNE 'D'
     C           *LOCK     IN   LDA
     C                     Z-ADD007       DBASE            ***************
     C                     MOVE 'RECRG'   DBFILE           * DBERROR 007 *
     C                     MOVELRECHRK    DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C/COPY WNCPYSRC,RE3360C023
     C*
     C           MAXC      IFNE 0                          - B2
     C           MAXC      ANDNE*HIVAL                                    153001
     C                     MOVE '0'       *IN56
     C                     MOVE '0'       *IN58
     C                     Z-ADDMAXC      MAXC0
     C           SOACC0    IFGT MAXC                       - B3
     C                     Z-ADDMAXC      SOACC0
     C                     END                             - E3
     C                     END                             - E2
     C*
     C/COPY WNCPYSRC,RE3360C021
     C           MINC      IFNE 0                          - B2
     C                     MOVEA'00'      *IN,57
     C                     Z-ADDMINC      MINC0
     C           SOACC0    IFLT MINC                       - B3
     C                     Z-ADDMINC      SOACC0
     C                     END                             - E3
     C                     END                             - E2
     C/COPY WNCPYSRC,RE3360C022
      *                                                                   153001
     C                     ENDIF                                          153001
     C                     END                             - E1
     C*
     C** PICK UP LEDGER/CLEARED BALANCES.
     C*
     C           RETKEY    CHAINACCNT                99
     C*
     C** ERROR IN ACCNTABF
     C*
     C           *IN99     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA
     C                     Z-ADD008       DBASE            ***************
     C                     MOVE 'ACCNT'   DBFILE           * DBERROR 008 *
     C                     MOVELRKEY      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C**  IF BRT LIABLE FLAG IS ON
     C*
     C                     MOVE '0'       *IN28
     C           ABRTCA    IFEQ 'L'
     C           ABRTCA    OREQ 'P'
     C                     MOVE '1'       *IN28
     C                     END
     C*
     C/COPY WNCPYSRC,RE3360C036
     C***********RECI      IFNE 'D'                        - B1           196856
     C***********          ADD  1         S                               196856
     C***********          MOVE '005'     SRCD,S                          196856
     C***********          MOVELSRCD,S    ERCD                            196856
     C***********          MOVELERCM,5    ERMSG                           196856
     C***********          MOVE *BLANKS   WANAM                    074590 196856
     C***********          ELSE                            - X1           196856
     C********** RECI      IFNE 'D'                        - B1                        229202 261086
     C**********           ADD  1         S                                            229202 261086
     C**********           MOVE '005'     SRCD,S                                       229202 261086
     C**********           MOVELSRCD,S    ERCD                                         229202 261086
     C**********           MOVELERCM,5    ERMSG                                        229202 261086
     C**********           MOVE *BLANKS   WANAM                                        229202 261086
     C           RECI      IFNE 'D'                                       196856
     C                     MOVE '1'       *IN85                           196856
     C                     ENDIF                                          196856
     C**********           ELSE                            - X1                        229202 261086
     C*
     C/COPY WNCPYSRC,RE3360C037
     C***********                                                         CCB002
     C*****LIVE*ACCNT RECORD FOUND - USE MEMOS RRN FROM FILE FOR CHAIN.   CCB002
     C***********                                                         CCB002
     C***********RRNM      CHAINMEMOS                99                   CCB002
     C***********                                                         CCB002
     C***ERROR*IN MEMOSMDF                                                CCB002
     C***********                                                         CCB002
      *                                                                   CCB002
      ** Call Access Object AOMEMSR0                                      CCB002
     C                     CALL 'AOMEMSR0'                                CCB002
     C                     PARM *BLANKS   W0RTCD  7        I:Return code  CCB002
     C                     PARM '*KEY   ' W0OPTN  7        O:Option       CCB002
     C                     PARM 0         W0RETL 100       O:Retail A/C NoCCB002
     C**********           PARM CNUMK     W0CNUM  60       O:Customer No.              CCB002 CSD027
     C                     PARM CNUMK     W0CNUM  6        O:Customer No.                     CSD027
     C                     PARM SCCY      W0CUCD  3        O:Currency     CCB002
     C**********           PARM ACODK     W0ACCD  40       O:Account Code              CCB002 CGL029
     C                     PARM ACODK     W0ACCD 100                                          CGL029
     C                     PARM ACSQK     W0ACSQ  20       O:Account Seq. CCB002
     C                     PARM SBRCA     W0BRCA  3        O:Branch       CCB002
     C           DSMEMS    PARM DSMEMS    DSFDY                           CCB002
      *                                                                   CCB002
     C************IN99     IFEQ '1'                        - B2           CCB002
     C           W0RTCD    IFNE '       '                                 CCB002
     C***********RECI      ORNE 'D'                                       CCB002
     C*
     C           *LOCK     IN   LDA
     C                     Z-ADD009       DBASE            ***************
     C***********          MOVE 'MEMOS'   DBFILE           * DBERROR 009 *CCB002
     C***********          MOVELRRNM      DBKEY            ***************CCB002
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     MOVE 'AOMEMSU0'DBFILE                          CCB002
     C**********           Z-ADDW0CNUM    U0CNUM                                       CCB002 CSD027
     C                     MOVE W0CNUM    U0CNUM                                              CSD027
     C                     MOVE W0CUCD    U0CUCD                          CCB002
     C                     Z-ADDW0ACCD    U0ACCD                          CCB002
     C                     Z-ADDW0ACSQ    U0ACSQ                          CCB002
     C                     MOVE W0BRCA    U0BRCA                          CCB002
     C                     MOVELUMEMER    DBKEY                           CCB002
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C** IF FF MODULE PRESENT IN MIDAS , MODI5 BIT0 IS ON = *IN46 IS'1'
     C** CHECK MEMOSM1 FOR ANY 'CHANGES' TO LEDGER/CLEARED BALANCES
     C** ADD CHANGES TO EXISTING BALANCE BEFORE DISPLAYING DETAILS
     C*
     C           *IN46     IFEQ '1'                        - B2
     C                     OPEN MEMOSM1                                   077563
     C           MREKEY    SETLLMEMOSM1                47
     C           *IN47     DOWEQ'0'                        - B3
     C           MREKEY    READEMEMOSM1                  47
     C           *IN47     IFEQ '0'                        - B4
     C           RECI      ANDNE'*'
     C                     ADD  LDBL      LDBLN
     C                     ADD  CLBL      CLBLN
     C                     END                             - E4
     C                     END                             - E3
     C                     CLOSEMEMOSM1                                   077563
     C                     END                             - E2
     C*
     C                     Z-ADDLDBLN     SLDBL0
     C                     Z-ADDCLBLN     SCLBL0
     C*
     C** CHECK WHETHER BALANCES IN CREDIT
     C*
     C** PICK UP ACCRUED INTEREST FIELDS
     C*
     C                     OPEN REACR
     C           RETKEY    CHAINREACR                9987
     C*
     C** ERROR IN REACRDF
     C*
     C           *IN87     IFEQ '1'                        - B2
     C           STSREA    ANDEQ01218
     C                     ADD  1         S
     C                     MOVE '006'     SRCD,S
     C                     MOVELSRCD,S    ERCD
     C                     MOVELERCM,6    ERMSG
     C                     MOVE *BLANKS   WANAM                           074590
     C                     MOVE '1'       *IN25
     C                     GOTO ENDSRC
     C                     END                             - E2
     C*
     C           *IN99     IFEQ '1'                        - B2
     C/COPY WNCPYSRC,RE3360C038
     C********** RECI      ORNE 'D'                                                           229202
     C/COPY WNCPYSRC,RE3360C039
     C           *LOCK     IN   LDA
     C                     Z-ADD010       DBASE            ***************
     C                     MOVE 'REACR'   DBFILE           * DBERROR 010 *
     C                     MOVELRKEY      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
      *                                                                                       220566
      ** Access the last record from LF/REHISL                                                220566
      *                                                                                       220566
     C           R1KEY     SETGTREHISL                                                        220566
     C           R1KEY     REDPEREHISL                   49                                   220566
     C           *IN49     IFEQ '1'                                                           220566
     C                     EXSR REHSR                                                         220566
     C                     END                             - E2                               220566
     C*
     C** PICK UP BRANCH CODE
     C*
     C                     MOVE BRCA      SBRCA
     C*
     C** ACCESS CURRENCY DECIMAL PLACES (SDCURRPD)
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM SCCY      @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C** ERROR IN SDCURRPD
     C*
     C           @RTCD     IFNE *BLANKS                    - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD011       DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERROR 011 *
     C                     MOVELSCCY      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
     C                     MOVEA'0000'    *IN,70                          CRE001
      *                                                                   CRE001
     C           CDP       IFEQ 0                                         CRE001
     C                     MOVE '1'       *IN70                           CRE001
     C                     ELSE                                           CRE001
     C           CDP       IFEQ 1                                         CRE001
     C                     MOVE '1'       *IN71                           CRE001
     C                     ELSE                                           CRE001
     C           CDP       IFEQ 2                                         CRE001
     C                     MOVE '1'       *IN72                           CRE001
     C                     ELSE                                           CRE001
     C           CDP       IFEQ 3                                         CRE001
     C                     MOVE '1'       *IN73                           CRE001
     C                     END                                            CRE001
     C                     END                                            CRE001
     C                     END                                            CRE001
     C                     END                                            CRE001
     C                     END                                            CRE001
     C*
     C** INTEREST CALCULATION BETWEEN TWO DATES & UPDATE DR/CR INTEREST ON
     C** REACR FILE
     C*
     C                     Z-ADD*ZEROS    DINT
     C                     Z-ADD*ZEROS    CINT
     C                     Z-ADD*ZEROS    INRT
     C                     Z-ADD*ZEROS    INTP
     C                     Z-ADD*ZEROS    ZINTR
     C                     Z-ADD*ZEROS    ZLDTM
     C                     MOVE 'N'       WDRDLY                                            MD026805
     C                     MOVE 'N'       WCRDLY                                            MD026805
     C                     MOVE NDID      PNDID                                             MD026805
     C                     MOVE NCID      PNCID                                             MD026805
     C           CRE090    IFEQ 'Y'                                                         MD027052
     C           NDID      IFLE PRDNB                                                       MD027052
     C           NDID      ANDNE0                                                           MD027052
     C                     MOVE 'Y'       WDRDLY                                            MD027052
     C                     ENDIF                                                            MD027052
     C           NCID      IFLE PRDNB                                                       MD027052
     C           NCID      ANDNE0                                                           MD027052
     C                     MOVE 'Y'       WCRDLY                                            MD027052
     C                     ENDIF                                                            MD027052
     C                     ENDIF                                                            MD027052
     C*
     C********** RHISD     IFNE RUND                       - B2                               220566
     C           DHISD     IFNE RUND                                                          220566
     C           WDRDLY    OREQ 'Y'                                                         MD027052
     C           WCRDLY    OREQ 'Y'                                                         MD027052
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
      ** Access extension file                                            CRE001
      *                                                                   CRE001
     C           ACCKEY    CHAINACCNTBXC             50                   CRE001
     C           *IN50     IFEQ '1'                        - B2           CRE001
     C           *LOCK     IN   LDA                                       CRE001
     C                     Z-ADD030       DBASE            ***************CRE001
     C                     MOVE 'ACCNT'   DBFILE           * DBERROR 030 *CRE001
     C                     MOVELRKEY      DBKEY            ***************CRE001
     C                     OUT  LDA                                       CRE001
     C                     MOVEA'1'       *IN,89                          CRE001
     C                     EXSR DBSR                                      CRE001
     C                     END                             - E2           CRE001
      *                                                                   CRE001
     C                     END                                            CRE001
     C*                                                                   CRE001
     C**********           MOVE 'N'       WDRDLY  1                                  CRE090 MD027052
     C**********           MOVE 'N'       WCRDLY  1                                  CRE090 MD027052
     C**********           MOVE NDID      PNDID                                      CRE090 MD027052
     C**********           MOVE NCID      PNCID                                      CRE090 MD027052
     C********** CRE090    IFEQ 'Y'                                                  CRE090 MD027052
     C********** NDID      IFLE PRDNB                                                CRE090 MD027052
     C********** NDID      ANDNE0                                                    CRE090 MD027052
     C**********           MOVE 'Y'       WDRDLY                                     CRE090 MD027052
     C**********           ENDIF                                                     CRE090 MD027052
     C********** NCID      IFLE PRDNB                                                CRE090 MD027052
     C********** NCID      ANDNE0                                                    CRE090 MD027052
     C**********           MOVE 'Y'       WCRDLY                                     CRE090 MD027052
     C**********           ENDIF                                                     CRE090 MD027052
     C**********           ENDIF                                                     CRE090 MD027052
      *                                                                              CRE090 MD027052
     C           WDRDLY    IFEQ 'N'                                                         MD026943
     C           WCRDLY    ANDEQ'N'                                                         MD026943
     C           BMLDAI    OREQ 'Y'                                                         MD026943
     C                     EXSR INTCAL
     C                     ENDIF                                                            MD026943
      *                                                                                       220566
      ** Initialise DAIC/CAIC with accruals from last balance                                 220566
      ** date of REHISL                                                                       220566
      *                                                                                       220566
     C           WRECI     IFEQ 'S'                                                           220566
     C           WDRDLY    ANDEQ'N'                                                         MD027052
     C           WCRDLY    ANDEQ'N'                                                         MD027052
     C                     Z-ADDDDAIC     DAIC                                                220566
     C                     Z-ADDDCAIC     CAIC                                                220566
     C                     ELSE                                                               220566
     C           WDRDLY    IFEQ 'N'                                                           CRE090
     C           WCRDLY    ANDEQ'N'                                                           CRE090
     C                     Z-ADDDAID      DAIC                                                220566
     C                     Z-ADDCAID      CAIC                                                220566
     C                     ENDIF                                                              CRE090
     C                     ENDIF                                                              220566
     C*
     C                     ADD  DINT      DAIC
      *                                                                   S01408
     C/COPY WNCPYSRC,RE3360CP10                                           S01408
      *                                                                   S01408
     C                     ADD  CINT      CAIC
      *                                                                   S01408
     C/COPY WNCPYSRC,RE3360CP11                                           S01408
      *                                                                   S01408
     C                     Z-ADDZIEND     RHISD
     C                     END                             - E3
     C                     MOVE DAIC      DAICCH
     C                     MOVE CAIC      CAICCH
     C                     CLOSEREACR
     C*                                                                   088734
     C** ACCESS RETAIL ICD BY CURRENCY HERE TO PICK UP MINIMUM AND        088734
     C** MAXIMUM AMOUNTS TO CAPITALISE. ACCESS MOVED FROM SR/CMDTL.       088734
     C** DETAILS ARE MANDATORY ONLY IF COMMISSIONS ARE USED.              088734
     C*                                                                   088734
     C                     MOVE *BLANKS   KBLK8                           088734
     C                     MOVE 'D'       KRECI                           088734
     C                     MOVE SCCY      KSCCY                           088734
     C*                                                                   088734
     C           RECKEY    CHAINRECCY                61                   088734
     C*                                                                   088734
     C           *IN61     IFEQ '1'                                       088734
     C                     Z-ADD*ZERO     MINBD0                          088734
     C                     Z-ADD*HIVAL    MAXBD0                          088734
     C                     Z-ADD*ZERO     MINBC0                          088734
     C                     Z-ADD*HIVAL    MAXBC0                          088734
     C           *IN69     IFEQ '1'                                       088734
     C           *LOCK     IN   LDA                                       088734
     C                     Z-ADD015       DBASE            ***************088734
     C                     MOVE 'RECCY'   DBFILE           * DBERROR 015 *088734
     C                     MOVELCKEY      DBKEY            ***************088734
     C                     OUT  LDA                                       088734
     C                     MOVE '1'       *IN89                           088734
     C                     EXSR DBSR                                      088734
     C                     ENDIF                                          088734
     C                     ELSE                                           088734
     C                     Z-ADDMIDC      MINBD0                          088734
     C                     Z-ADDMADC      MAXBD0                          088734
     C                     Z-ADDMICC      MINBC0                          088734
     C                     Z-ADDMACC      MAXBC0                          088734
     C                     ENDIF                                          088734
     C*                                                                   088734
     C** IF ANY MINIMUMS OR MAXIMUMS ARE SET UP, DISPLAY VALUES.          088734
     C*                                                                   088734
     C           MINBD0    IFNE *ZERO                                     088734
     C           MAXBD0    ORNE *HIVAL                                    088734
     C           MINBC0    ORNE *ZERO                                     088734
     C           MAXBC0    ORNE *HIVAL                                    088734
     C                     MOVE '1'       *IN27                           088734
     C                     ELSE                                           088734
     C                     MOVE '0'       *IN27                           088734
     C                     ENDIF                                          088734
     C*
     C** INITIALISE THE COMMISSIONS SCREEN
     C*
     C           *IN69     IFEQ '1'
     C                     EXSR CMDTL
     C                     END
      *                                                                                       CRE090
     C           CRE090    IFEQ 'Y'                                                           CRE090
     C                     EXSR SRDLAY                                                        CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
     C*
     C** PICK UP HISTORY BALANCE, DR/CR INTEREST, DR/CR GENERATED ADJUSTMENT
     C** DR/CR MANUAL ADJUSTMENT
     C*
     C                     Z-ADDRHISB     HISB0
     C                     Z-ADDDAIC      DAIC0
     C                     Z-ADDCAIC      CAIC0
     C/COPY WNCPYSRC,RE3360C018
     C                     Z-ADDGADI      GADI0
     C                     Z-ADDGACI      GACI0
     C                     Z-ADDMADI      MADI0
     C                     Z-ADDMACI      MACI0
     C*
     C** CHECK FOR ALTERNATIVE A/C TO POST INTEREST
     C*
     C                     MOVE ACNO      ACNOC
     C*
     C           DACP      IFNE *BLANKS                    - B2
     C           DRA05     IFEQ *BLANKS                    - B3
     C           DRA15     IFNE ACNOC                      - B4
     C                     MOVE DRBR      SDACP
     C                     MOVELDACP      SDACP
     C                     MOVE '0'       *IN42
     C                     END                             - E4
     C                     ELSE                            - X3
     C           DACP      IFNE RKEY                       - B4
     C                     MOVE DRBR      SDACP
     C                     MOVELDACP      SDACP
     C                     MOVE '0'       *IN42
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
     C*
     C           CACP      IFNE *BLANKS                    - B2
     C           CRA05     IFEQ *BLANKS                    - B3
     C           CRA15     IFNE ACNOC                      - B4
     C                     MOVE CRBR      SCACP
     C                     MOVELCACP      SCACP
     C                     MOVE '0'       *IN43
     C                     END                             - E4
     C                     ELSE                            - X3
     C           CACP      IFNE RKEY                       - B4
     C                     MOVE CRBR      SCACP
     C                     MOVELCACP      SCACP
     C                     MOVE '0'       *IN43
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
     C*
     C** CHECK FOR ALTERNATIVE A/C TO POST CHARGES
     C*
     C           CHAC      IFNE *BLANKS                    - B2
     C           CHA05     IFEQ *BLANKS                    - B3
     C           CHA15     IFNE ACNOC                      - B4
     C                     MOVE CHBR      CHAC1
     C                     MOVE CHBR      CHAC2
     C                     MOVELCHAC      CHAC1
     C                     MOVELCHAC      CHAC2
     C                     MOVE '0'       *IN44
     C                     END                             - E4
     C                     ELSE                            - X3
     C           CHAC      IFNE RKEY                       - B4
     C                     MOVE CHBR      CHAC1
     C                     MOVE CHBR      CHAC2
     C                     MOVELCHAC      CHAC1
     C                     MOVELCHAC      CHAC2
     C                     MOVE '0'       *IN44
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
     C*
     C** ACCUMULATE TOTALS FOR DEBIT AND CREDIT INTEREST
     C*
     C           DAIC      ADD  MADI      SDRIN0
     C           SDRIN0    ADD  GADI      SDRIN0
     C*
     C                     Z-SUBCAIC      SCRIN0
     C                     SUB  MACI      SCRIN0
     C                     SUB  GACI      SCRIN0
     C/COPY WNCPYSRC,RE3360C019
      *                                                                                       CGL031
      ** Calculate European Withholding Tax if CGL031 is installed                            CGL031
      *                                                                                       CGL031
     C                     MOVE *OFF      *IN75                                             BUG23325
     C                     MOVE *OFF      *IN76                                             BUG23325
      *                                                                                     BUG23325
     C           CGL031    IFEQ 'Y'                                                           CGL031
     C                     Z-ADD*ZERO     EUTAX0                                              236095
     C           SCRIN0    IFLT 0                                                             CGL031
     C                     MOVE *OFF      *IN29                                               CGL031
     C                     EXSR SRRDAT                                                        234034
     C           WSKIP     IFEQ 'N'                                                           234034
     C                     EXSR SREUTX                                                        CGL031
     C                     ENDIF                                                              234034
      *                                                                                     BUG23325
     C                     ELSE                                                             BUG23325
      *                                                                                     BUG23325
      ** Processing Done just to show the correct Field Label                               BUG23325
      *                                                                                     BUG23325
     C           CER048    IFEQ 'Y'                                                         BUG23325
     C                     EXSR SRRDAT                                                      BUG23325
      *                                                                                     AR755349
      ** This will not display the value of EUTAX if history balance is zero.               AR755349
      *                                                                                     AR755349
     C           BHISB     IFEQ 0                                                           AR755349
     C                     Z-ADD0         EUTAX0                                            AR755349
     C                     ENDIF                                                            AR755349
      *                                                                                     AR755349
     C                     ENDIF                                                            BUG23325
      *                                                                                     BUG23325
     C                     ENDIF                                                              CGL031
     C                     ENDIF                                                              CGL031
     C*
     C** CALCULATE WITHHOLDING TAX
     C*
     C           *IN59     IFEQ '1'
     C           CGL165    ANDNE'Y'
     C/COPY WNCPYSRC,RE3360C031
     C                     EXSR WTAXSR
     C                     ELSE                                                               239966
     C                     Z-ADD0         SWTAX0                                              239966
     C                     Z-ADD0         SWTAX1                                              239966
     C                     Z-ADD0         SWTAX2                                              239966
     C                     Z-ADD0         SWTAX3                                              239966
     C                     END
      *                                                                                       CGL165
      * If Dual Withholding Tax feature is On and A/C is taxable                              CGL165
     C           CGL165    IFEQ 'Y'                                                           CGL165
     C                     Z-ADD0         SWTAX0                                              CGL165
     C                     Z-ADD0         SSTAX0                                              CGL165
      *                                                                                       CGL165
     C                     Z-ADDCAIC      PINTA                                               CGL165
      *                                                                                       CGL165
      ** Also take into consideration the generated adjustments and                           CGL165
      ** manual adjustment to accrued interests.                                              CGL165
     C                     ADD  MACI      PINTA                                               CGL165
     C                     ADD  GACI      PINTA                                               CGL165
     C           ATITAX    IFEQ 'Y'                                                           CGL165
     C           PINTA     ANDNE0                                                             CGL165
      *                                                                                       CGL165
     C                     CALL 'GL024000'                                                    CGL165
     C                     PARM           PRCOD1  1                                           CGL165
     C                     PARM 'RE3360'  PCPGM   6                                           CGL165
     C                     PARM *BLANKS   PBRCA   3                                           CGL165
     C                     PARM *BLANKS   PCNUM   6                                           CGL165
     C                     PARM *BLANKS   PACNO  10                                           CGL165
     C                     PARM CCY       PCCY    3                                           CGL165
     C                     PARM           PINTA  150                                          CGL165
     C                     PARM ATTXC1    PTXC1   2                                           CGL165
     C                     PARM ATTXC2    PTXC2   2                                           CGL165
     C                     PARM *ZEROS    PCPDT   50                                          CGL165
     C                     PARM *ZEROS    PVDAT   50                                          CGL165
     C                     PARM *ZEROS    PMDAT   50                                          CGL165
     C                     PARM *ZEROS    PINTR  117                                          CGL165
     C                     PARM *BLANKS   PDTYP   2                                           CGL165
     C                     PARM *ZEROS    PPCPL  150                                          CGL165
     C                     PARM *BLANKS   PACOD  10                                           CGL165
     C                     PARM *ZEROS    PACSQ   20                                          CGL165
     C                     PARM           PWTXA  150                                          CGL165
     C                     PARM           PSTXA  150                                          CGL165
      *                                                                                       CGL165
     C                     Z-ADDPWTXA     SWTAX0                                              CGL165
     C                     Z-ADDPSTXA     SSTAX0                                              CGL165
      *                                                                                       CGL165
     C                     ENDIF                                                              CGL165
     C                     ENDIF                                                              CGL165
      *                                                                                       CGL165
     C*
     C***CHECK*IF*SCRIN0*IS*EQUAL*TO*ZERO*****************************    077872
     C** CHECK IF SCRIN0 IS GREATER THAN ZERO                             077872
      * Only calculate BRT is SCRIN0 is negative ie. a credit.            130468
     C*                                                                   077872
     C                     MOVE '0'       *IN55                           077872
     C********** SCRIN0    IFEQ 0                                         077872
     C********** SCRIN0    IFNE 0                                  077872 130468
     C           SCRIN0    IFLT 0                                         130468
     C                     MOVE '1'       *IN55
     C                     END
     C                     Z-ADD0         BRTOT                           077872
     C/COPY WNCPYSRC,RE3360C027
     C*
     C** IF CREDIT INTEREST(*IN55) AND BRT LIABLE(*IN28)
     C** THEN PROCESS RECORD WITH BRT RATE APPLIED
     C*
     C           *IN55     IFEQ '1'
     C           *IN28     ANDEQ'1'
     C*
     C** APPLY NEW OR OLD RATE?
     C*
     C           RUND      IFGE DEFF
     C                     Z-ADDBRTR      @BRT    75
     C                     ELSE
     C                     Z-ADDPBRTR     @BRT    75
     C                     END
     C*
     C           ABRTCA    IFEQ 'L'
     C********** SCRIN0    MULT @BRT      BRTOT1 155                      077872
     C********** BRTOT1    DIV  100       BRTOT  130H                     077872
     C           SCRIN0    MULT @BRT      BRTOTY 155                      077872
     C           BRTOTY    DIV  100       BRTOT  130H                     077872
     C                     END
     C*
     C           ABRTCA    IFEQ 'P'
     C           @BRT      MULT 0.5       BRTH   155
     C********** SCRIN0    MULT BRTH      BRTOT1 155                      077872
     C********** BRTOT1    DIV  100       BRTOT  130H                     077872
     C           SCRIN0    MULT BRTH      BRTOTY 155                      077872
     C           BRTOTY    DIV  100       BRTOT  130H                     077872
     C                     END
     C*
     C                     END
     C                     Z-ADDBRTOT     BRTOT0                          077872
     C/COPY WNCPYSRC,RE3360C028
     C*
     C** WORK OUT TOTAL OUTSTANDING FIELD.
     C*
     C                     Z-ADDCLBLN     STOTO0
     C*
     C           DACP      IFEQ *BLANKS                    - B2
     C           DRA15     OREQ ACNOC
     C           DACP      OREQ RKEY
     C           CLBLN     ADD  SDRIN0    STOTO0
     C                     END                             - E2
     C*
     C           CACP      IFEQ *BLANKS                    - B2
     C           CRA15     OREQ ACNOC
     C           CACP      OREQ RKEY
     C           STOTO0    ADD  SCRIN0    STOTO0
     C                     END                             - E2
     C*
     C           CHAC      IFEQ *BLANKS                    - B2
     C           CHA15     OREQ ACNOC
     C           CHAC      OREQ RKEY
     C           STOTO0    ADD  SCACC0    STOTO0
     C           STOTO0    ADD  SOACC0    STOTO0
     C                     END                             - E2
     C*
     C           *IN59     IFEQ '1'
     C/COPY WNCPYSRC,REH00424
     C           SWTAX0    IFNE 0                          - B2
     C/COPY WNCPYSRC,RE3360C032
     C           CGL165    IFEQ 'Y'                                                           CGL165
     C           SSTAX0    ANDNE0                                                             CGL165
     C           STOTO0    ADD  SSTAX0    STOTO0                                              CGL165
     C                     ENDIF                                                              CGL165
     C           STOTO0    ADD  SWTAX0    STOTO0
     C/COPY WNCPYSRC,REH00386
     C                     END                             - E2
     C                     END                             - E2
     C*
     C** IF BRT LIABLE ALLOW FOR BRT IN THE TOTAL
     C*  - ONLY IF CREDIT INTEREST IS NOT POSTED TO AN ALTERNATE A/C      099515
     C/COPY WNCPYSRC,RE3360C029
     C*
     C           *IN55     IFEQ '1'
     C           *IN28     ANDEQ'1'
     C*                                                                   099515
     C           CACP      IFEQ *BLANKS                                   099515
     C           CACP      OREQ RKEY                                      099515
     C           CRA15     OREQ ACNOC                                     099515
     C           STOTO0    SUB  BRTOT     STOTO0
     C                     END                                            099515
     C*                                                                   099515
     C                     END
      *                                                                                       CGL031
     C           *IN55     IFEQ '1'                                                           CGL031
     C           *IN29     ANDEQ'1'                                                           CGL031
     C           CGL031    ANDEQ'Y'                                                           CGL031
     C           CACP      IFEQ *BLANKS                                                       CGL031
     C           CACP      OREQ RKEY                                                          CGL031
     C           CRA15     OREQ ACNOC                                                         CGL031
     C********** STOTO0    SUB  EUTAX0    STOTO0                                     CGL031 BUG23178
     C           STOTO0    ADD  EUTAX0    STOTO0                                            BUG23178
     C                     ENDIF                                                              CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C********** CER048    IFEQ 'Y'                                                  CER048 BUG23325
     C********** STOTO0    SUB  SSTAX0    STOTO0                                   BUG23178 BUG23325
     C********** STOTO0    ADD  SSTAX0    STOTO0                                   BUG23178 BUG23325
     C**********           ENDIF                                                     CER048 BUG23325
      **********                                                                     CER048 BUG23325
      *                                                                                       CER048
     C/COPY WNCPYSRC,RE3360C030
     C*
     C** ACCESS CURRENCY DECIMAL PLACES (SDCURRPD)
     C*
     C                     CALL 'AOCURRR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM SCCY      @CCY    3
     C           SDCURR    PARM SDCURR    DSSDY
     C*
     C** ERROR IN SDCURRPD
     C*
     C           @RTCD     IFNE *BLANKS                    - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD012       DBASE            ***************
     C                     MOVEL'SDCURRPD'DBFILE           * DBERROR 012 *
     C                     MOVELSCCY      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     MOVEA'0000'    *IN,70
     C*
     C           CDP       IFEQ 0                          - B2
     C                     MOVE '1'       *IN70
     C                     ELSE                            - X2
     C           CDP       IFEQ 1                          - B3
     C                     MOVE '1'       *IN71
     C                     ELSE                            - X3
     C           CDP       IFEQ 2                          - B4
     C                     MOVE '1'       *IN72
     C                     ELSE                            - X4
     C           CDP       IFEQ 3                          - B5
     C                     MOVE '1'       *IN73
     C                     END                             - E5
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
     C/COPY WNCPYSRC,RE3360C040
     C***********          END                             - E1           196856
     C**********           ENDIF                           - E1                        229202 261086
     C/COPY WNCPYSRC,RE3360C041
     C*
     C           NOALT     IFNE *ZERO
     C                     SETON                     22
     C                     ELSE
     C                     SETOF                     22
     C                     END
     C/COPY WNCPYSRC,RE3360C004
     C*
     C           ENDSRC    TAG                                            CRT002
      *                                                                   CRT002
     C           PMODE     IFEQ 'P'                                       CRT002
     C           ERMSG     ANDEQ*BLANKS                                   CRT002
     C                     EXSR DTQOUT                                    CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C/COPY WNCPYSRC,RE3360C042
      *                                                                   CGL183
      * Only write to file REEAUDPP if CGL183 is on                       CGL183
      *                                                                   CGL183
     C           CGL183    IFEQ 'Y'                                       CGL183
     C           VLOSIC    ANDEQ'Y'                                       CGL183
      *                                                                   CGL183
      * Format the fields for output                                      CGL183
      *                                                                   CGL183
     C                     MOVELSUSER     LG1ID                           CGL183
     C                     MOVELSWSID     LG1WRK                          CGL183
      *                                                                   CGL183
      * Format Time and Date (ccyymmdd) Fields.                           CGL183
      *                                                                   CGL183
     C                     TIME           TIMDAT                          CGL183
     C                     Z-ADDWTIM      LG1TIM                          CGL183
     C                     Z-ADDISODAT    LG1DAT                          CGL183
      *                                                                   CGL183
     C                     Z-ADDRETNO     LG1RTN                          CGL183
     C                     MOVELW#BRCH    LG1BRN                          CGL183
     C                     MOVE CNUMK     LG1CUN                          CGL183
     C                     MOVELSCCY      LG1CCY                          CGL183
     C                     Z-ADDACODK     LG1ACD                          CGL183
     C                     Z-ADDACSQK     LG1ASQ                          CGL183
     C                     MOVEL'OS'      LG1ZDR                          CGL183
     C                     MOVEL'A'       LG1TYP                          CGL183
     C                     MOVE *BLANKS   LG1REF                          CGL183
      *                                                                   CGL183
     C                     WRITEREEAUDR1                                  CGL183
      *                                                                   CGL183
     C                     ENDIF                                          CGL183
      *                                                                   CGL183
     C                     ENDSR                           **SCROUT ENDSR CRT002
     C***********ENDSRC    ENDSR                           **SCROUT ENDSR CRT002
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DFPROC subroutine for display file processing
     C**
     C**     Called by       FIRST, MAIN
     C**     Calls           -
     C**
     C           DFPROC    BEGSR                           **DFPROC BEGSR*
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3360CCP4                                           S01408
     C*                                                                   S01408
     C*
     C** MESSAGE ERROR HANDLING
     C*
     C           S         IFGT 0                          - B1
     C                     MOVE '1'       *IN21
     C                     MOVE '0'       *IN20
     C                     MOVE '0'       *IN45
     C                     MOVE '0'       *IN27                           088734
     C                     END                             - E1
     C*
     C** READING FORMAT
     C*
     C                     SELEC                                          CRT002
      *                                                                   CRT002
     C           PMODE     WHEQ 'I'                                       CRT002
      *                                                                   CRT002
     C                     EXFMTRE3360F1
     C/COPY WNCPYSRC,RE3360C014
      *                                                                   CRT002
     C           PMODE     WHEQ 'P'                                       CRT002
      *                                                                   CRT002
     C                     MOVEL*BLANKS   REPEQI                          CRT002
     C                     MOVEL*BLANKS   RKEY                            CRT002
     C                     EXSR RDQMS                                     CRT002
     C*                                                                   CRT002
     C***  If error received after call to QRCVDTAQ, QSNDDTAQ,            CRT002
     C***  issue DB error.                                                CRT002
     C*                                                                   CRT002
     C           *IN70     IFEQ '1'                                       CRT002
     C           *LOCK     IN   LDA                        ***************CRT002
     C                     Z-ADD80        DBASE            ** DB ERR 80 **CRT002
     C                     MOVE P@QRS     DBFILE           ***************CRT002
     C                     MOVELP@QKY     DBKEY                           CRT002
     C                     EXSR DBSR                                      CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     MOVELP@QDR     REPEQI                          CRT002
      *                                                                   CRT002
     C           RJMSTY    IFNE '*END'                                    CRT002
      *                                                                   CRT002
     C                     MOVE WAACN     SRTNO                           CRT002
      *                                                                   CRT002
     C                     CLEARLOGDS                                     CRT002
     C                     CLEARWCMSG                                     CRT002
     C                     MOVE RJCMSQ    WCMSQ                           CRT002
     C                     MOVELRJBRCA    WBRCA                           CRT002
     C                     MOVELRJUSID    WUSID                           CRT002
     C                     MOVE 'N'       WSUCM                           CRT002
     C                     MOVE 'DR'      WSTAT                           CRT002
     C                     TIME           WTMDS  120                      CRT002
     C           WTHR      CAT  ':'       WA      3                       CRT002
     C           WTMN      CAT  ':'       WB      3                       CRT002
     C           WA        CAT  WB        WC      6                       CRT002
     C           WC        CAT  WTSS      WSTTM                           CRT002
     C                     MOVELWSTTM     WRCTM   8                       CRT002
     C           WDT1      CAT  '/'       WA                              CRT002
     C           WDT2      CAT  '/'       WB                              CRT002
     C           WA        CAT  WB        WC                              CRT002
     C           WC        CAT  WDT3      WRCDT   8                       CRT002
     C                     MOVELREPEQI    WCMSG                           CRT002
     C                     EXSR WRLOG                                     CRT002
      *                                                                   CRT002
     C                     COMIT                                          CRT002
      *                                                                   CRT002
     C                     MOVE '0'       *INKC                           CRT002
     C                     MOVE '0'       *INKK                           CRT002
     C                     MOVE '0'       *INKM                           CRT002
     C                     MOVE '0'       *INKN                           CRT002
      *                                                                   CRT002
     C                     ELSE                                           CRT002
      *                                                                   CRT002
     C                     MOVE '1'       *INKC                           CRT002
     C                     MOVEL'F03'     FUNC                                                239966
     C                     OUT  DSLDA                                                         239966
      *                                                                   CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C                     ENDSL                                          CRT002
     C*
     C                     ENDSR                           **DFPROC ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** CMDTL subroutine for displayed commission details
     C**
     C**     Called by       MAIN
     C**     Calls           -
     C**
     C           CMDTL     BEGSR                           **CMDTL BEGSR**
     C*
     C                     MOVE 'A'       ALPHA
     C*
     C** GET CUSTOMER DETAILS (SDCUSTPD)
     C*
     C***********          CALL 'AOCUSTR0'                                CSD007
     C                     CALL 'AOCUSTR2'                                CSD007
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM SCNUM     @CNUM  10
     C                     PARM           @KYST   7
     C***********SDCUST    PARM SDCUST    DSSDY                           CSD007
     C           SDCUST    PARM SDCUST    DSLDY                           CSD007
     C*
     C           @RTCD     IFNE *BLANKS                    - B1
     C           CSD007    ANDNE'Y'                                       CSD007
      *                                                                   CSD007
     C           @RTCD     ORNE *BLANKS                                   CSD007
     C           @RTCD     ANDEQ'*NRF   '                                 CSD007
     C           BBDTDL    ANDNE*ZEROS                                    CSD007
     C           CSD007    ANDEQ'Y'                                       CSD007
      *                                                                   CSD007
     C           @RTCD     ORNE *BLANKS                                   CSD007
     C           @RTCD     ANDNE'*NRF   '                                 CSD007
     C           CSD007    ANDEQ'Y'                                       CSD007
      *                                                                   CSD007
     C           *LOCK     IN   LDA
     C                     Z-ADD013       DBASE            ***************
     C                     MOVE 'SDCUSTPD'DBFILE           * DBERROR 013 *
     C                     MOVELCNUMK     DBKEY            ***************
     C                     OUT  LDA
     C                     MOVE '1'       *IN89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C           STFQ      IFEQ 'E'                        - B1
     C/COPY WNCPYSRC,REH00463
     C*
     C** CHECK IF IT IS A VALID GROUP (IN TABLEV4)
     C           @WCGRP    IFEQ *BLANK                                    094687
     C                     MOVEL'1'       @WCGRP                          094687
     C                     END                                            094687
     C*
     C                     MOVE '0'       *IN60
     C                     Z-ADD1         Y
     C           1         SETLLTABLEV4
     C                     READ TABLEV4                  99
     C*
     C           *IN99     DOWEQ'0'
     C           RECI      IFEQ 'D'
     C*
     C           @WCGRP    IFEQ CGRP
     C                     MOVE '1'       *IN60
     C                     LEAVE
     C                     END
     C*
     C                     ADD  1         Y
     C                     READ TABLEV4                  99
     C*
     C                     END
     C                     END
     C*
     C** CHECK IF ERROR
     C*
     C           *IN60     IFEQ '0'
     C           *LOCK     IN   LDA
     C                     Z-ADD014       DBASE            ***************
     C                     MOVEL'TABLEV4' DBFILE           * DBERROR 014 *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     MOVEL@WCGRP    DBKEY                        ***
     C                     OUT  LDA
     C                     MOVE '0'       *IN89
     C                     EXSR DBSR
     C                     END
     C*
     C           DYSI      IFEQ 'Y'                        - B2
     C                     MOVELCEXF      ALPHA
     C*
     C** ACCESS TO RETAIL ICD BY CURRENCY MOVED TO MAIN STREAM PROCESS    088734
     C** AS NEEDS TO BE DONE ALL THE TIME.                                088734
     C*                                                                   088734
     C***********ALPHA     IFNE 'E'                        - B3           088734
     C***********          MOVE *BLANKS   KBLK8                           088734
     C***********          MOVE 'D'       KRECI                           088734
     C***********          MOVE SCCY      KSCCY                           088734
     C***********                                                         088734
     C***********RECKEY    CHAINRECCY                61                   088734
     C***********                                                         088734
     C************IN61     IFEQ '1'                        - B4           088734
     C************LOCK     IN   LDA                                       088734
     C***********          Z-ADD015       DBASE            ***************088734
     C***********          MOVE 'RECCY'   DBFILE           * DBERROR 015 *088734
     C***********          MOVELCKEY      DBKEY            ***************088734
     C***********          OUT  LDA                                       088734
     C***********          MOVE '1'       *IN89                           088734
     C***********          EXSR DBSR                                      088734
     C***********          END                             - E4           088734
     C**PROCESS*ONLY FOR B                                                088734
     C***********                                                         088734
     C***********          END                             - E3           088734
     C           ALPHA     IFNE 'E'                        - B3
     C                     MOVE *BLANKS   KBLK8
     C                     MOVE 'D'       KRECI
     C                     MOVE SCCY      KSCCY
     C*
     C           RECKEY    CHAINRECCY                61
     C*
     C           *IN61     IFEQ '1'                        - B4
     C           *LOCK     IN   LDA
     C                     Z-ADD015       DBASE            ***************
     C                     MOVE 'RECCY'   DBFILE           * DBERROR 015 *
     C                     MOVELCKEY      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVE '1'       *IN89
     C                     EXSR DBSR
     C                     END                             - E4
     C* PROCESS ONLY FOR B
     C*
     C                     END                             - E3
     C                     END                             - E2
     C                     END                             - E1
     C*
     C           MREKEY    CHAINRECOM                62
     C*
     C           *IN62     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA
     C                     Z-ADD016       DBASE            ***************
     C                     MOVE 'RECOM'   DBFILE           * DBERROR 016 *
     C                     MOVELRKEY      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVE '1'       *IN89
     C                     EXSR DBSR
     C                     END                             - E1
     C/COPY WNCPYSRC,RE3360C006
     C*
     C                     Z-ADD*ZEROS    SCDYS0
     C                     Z-ADDCMBE      SCMBE0
     C                     Z-ADDCHDBE     SCHDB0
     C                     Z-ADDACCEA     SACCE0
     C                     Z-ADDCDIE      SCDIE0
     C                     Z-ADDIACE      SIACE0
     C                     Z-ADDFXDC      SFXDC0
     C                     Z-ADDCHCO      SCHCO0                                              CER049
     C/COPY WNCPYSRC,RE3360C007
     C*
     C** PROCESS ONLY FOR B
     C*
     C** IF THE OUTSTANDING BALANCE IS ZERO O NEGATIVE
     C*
     C** IF THE OUTSTANDING BALANCE IS GREATER THAN ZERO
     C*
     C                     Z-ADDSCDYS0    SCACC0
     C                     ADD  SCMBE0    SCACC0
     C                     ADD  SCHDB0    SCACC0
     C                     ADD  SACCE0    SCACC0
     C                     ADD  SCDIE0    SCACC0
     C                     ADD  SIACE0    SCACC0
     C                     ADD  SFXDC0    SCACC0
     C           CER049    IFEQ 'Y'                                                           CER049
     C                     ADD  SCHCO0    SCACC0                                              CER049
     C                     ENDIF                                                              CER049
     C/COPY WNCPYSRC,RE3360C008
     C*
     C** CALCULATE THE COMMISSSION ON NUMBER OF DAILY STATEMENTS
     C*
     C           CEXF      IFNE 'E'
     C*
     C** COMMISSION IS APPLICABLE
     C*
     C           ACST      IFEQ 'C'                        - B3
     C*
     C** ACCOUNT IS FLAGGED FOR CLOSING
     C*
     C           NOIS      ADD  NOCC      NCNDS
     C                     Z-ADD1         ALTNAD
     C                     MOVE CNUM      WCUST
     C***********WCUST     SETLLSDALTNL0                 25               089811
     C***********WCUST     READESDALTNL0                 25               089811
     C************IN25     DOWEQ'0'                        - B4           089811
     C           WCUST     SETLLSDALTNL0                 65               089811
     C           WCUST     READESDALTNL0                 65               089811
     C           *IN65     DOWEQ'0'                        - B4           089811
     C                     ADD  1         ALTNAD
     C***********WCUST     READESDALTNL0                 25               089811
     C           WCUST     READESDALTNL0                 65               089811
     C                     END                             - E4
     C           NCNDS     MULT ALTNAD    NCNDS
     C                     ADD  1         LSTP
     C                     ELSE                            - X3
     C                     Z-ADDNOIS      NCNDS
     C                     ADD  1         LSTP
     C                     END                             - E3
     C           CEXF      IFNE *BLANKS                    - B3
     C           NCNDS     MULT NCEXF     NCNDS
     C                     ELSE                            - X3
     C           NCNDS     MULT DSFC      NCNDS
     C                     END                             - E3
     C           NCNDS     IFLT DSMN                       - B3
     C                     Z-ADDDSMN      NCNDS
     C                     END                             - E3
     C           NCNDS     IFGT DSMX                       - B3
     C                     Z-ADDDSMX      NCNDS
     C                     END                             - E3
     C                     Z-ADDNCNDS     SCDYS0
     C                     END                             - E2
     C                     ADD  SCDYS0    SCACC0
     C*
     C** CALCULATE THE AMOUNT OF COMMISSION LIABLE TO VAT
     C*
     C           VATP      IFEQ 'Y'                                       076189
     C*                                                                   076189
     C                     Z-ADD*ZEROS    VATCC0 150
     C*
     C           TCNDS     IFEQ 'Y'
     C                     ADD  SCDYS0    VATCC0
     C                     ENDIF
     C*
     C           TCMBL     IFEQ 'Y'
     C                     ADD  SCMBE0    VATCC0
     C                     ENDIF
     C*
     C           TCHOV     IFEQ 'Y'
     C                     ADD  SCHDB0    VATCC0
     C                     ENDIF
     C*
     C           TCDTO     IFEQ 'Y'
     C                     ADD  SACCE0    VATCC0
     C                     ENDIF
     C*
     C           TCDRI     IFEQ 'Y'
     C                     ADD  SCDIE0    VATCC0
     C                     ENDIF
     C*
     C           TCINA     IFEQ 'Y'
     C                     ADD  SIACE0    VATCC0
     C                     ENDIF
     C*
     C           TFXAC     IFEQ 'Y'
     C                     ADD  SFXDC0    VATCC0
     C                     ENDIF
     C*
     C           *IN18     IFEQ '1'
     C/COPY WNCPYSRC,RE3360C012
     C           VATCC0    MULT XTVA      STVAT0
     C                     ADD  STVAT0    SCACC0
     C                     ENDIF
     C/COPY WNCPYSRC,RE3360C013
     C*
     C                     END                                            076189
     C*                                                                   076189
     C                     ENDSR                           **CMDTL ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** TFPARM subroutine for transfering parameters
     C**
     C**     Called by       MAIN
     C**     Calls           -
     C**
     C           TFPARM    BEGSR                           **TFPARM BEGSR*
     C*
     C                     MOVE SBRCA     WBRCA
     C                     MOVE SBRCA     WBRCH                           124019
     C                     MOVE SCNUM     WCNUM
     C                     MOVE SCCY      WCCY
     C                     MOVE SACOD     WACOD
     C                     MOVE SACSQ     WACSQ
     C                     MOVE SRTNO     WACNO
     C                     MOVE CDP       WZADEC
     C                     MOVE SRUNA     WRUNA
     C                     MOVE DATF      WDATF
     C                     MOVE *BLANKS   WFROM1
     C                     MOVE *BLANKS   WFROM2
     C*
     C                     ENDSR                           **TFPARM ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** INTCAL subroutine for interest calculation between two dates
     C**
     C**
     C**     Called by       External program
     C**     Calls           CRINIT, DATEIN, DRINIT, ZIC00, ZIC01,
     C**                     ZIC02
     C**
     C           INTCAL    BEGSR                           **INTCAL BEGSR*
     C/COPY WNCPYSRC,RE3360C024
     C*
     C** LOADING OF CURRENCY TO CHAIN TO REHRDJ/REHRCJ FILES
     C*
     C                     MOVE CCY       REHCCY
     C                     Z-ADD*ZEROS    INRT
     C                     Z-ADD*ZEROS    INTP
     C                     Z-ADD*ZEROS    INST
     C                     Z-ADD*ZEROS    ZINTR
     C                     Z-ADD*ZEROS    ZLDTM
      *                                                                                       CER016
     C           WFIRST    IFEQ 'Y'                                                           CER016
     C                     EXSR SRAOS                                                         CER016
     C                     ENDIF                                                              CER016
     C*
     C** DEBIT PROCESSING
     C*
     C           RHISB     IFGT *ZEROS                     - B1
     C           MNBL      ORGT *ZEROS
     C                     EXSR DRINIT
     C                     END                             - E1
     C*
     C                     Z-ADDINRT      ZIRATE
     C                     Z-ADDINTP      ZICT
     C                     Z-ADDDRIC      ZICALC
     C**********           Z-ADDRHISD     ZIBEG                                               220566
     C           CRE090    IFEQ 'Y'                                                           CRE090
     C           WDRDLY    ANDEQ'Y'                                                           CRE090
     C           CRE090    OREQ 'Y'                                                           CRE090
     C           WCRDLY    ANDEQ'Y'                                                           CRE090
     C                     Z-ADDPRDNB     ZIBEG                                               CRE090
     C                     ELSE                                                               CRE090
     C                     Z-ADDDHISD     ZIBEG                                               220566
     C                     ENDIF                                                              CRE090
     C                     Z-ADDRUND      ZIEND
     C/COPY WNCPYSRC,RE3360C043
     C*
     C           INTP      IFLT 3                          - B1
     C           RHISB     IFGT 0                          - B2
     C**********           Z-ADDRHISB     ZIAMT                                               220566
     C                     Z-ADDBHISB     ZIAMT                                               220566
      **                                                                  CRE001
     C***********ZICT      CASEQ0         ZIC00                           CRE001
     C   54      ZICT      CASEQ0         ZICOD                           CRE001
     C  N54      ZICT      CASEQ0         ZIC00                           CRE001
      **                                                                  CRE001
     C           ZICT      CASEQ1         ZIC01
     C           ZICT      CASEQ2         ZIC02
     C                     END
     C                     Z-ADDZINTR     DINT
     C                     END                             - E2
     C*
     C                     ELSE                            - X1
     C*
     C** SEARCHING END-OF-MONTH DATE
     C*
     C                     EXSR DATEIN
     C*
     C           RUND      IFLE ZLDTM                      - B2
     C           MNBL      IFGT 0                          - B3
     C                     Z-ADDMNBL      ZIAMT
     C           INTP      IFEQ 3                          - B4
     C                     Z-ADD1         ZICT
     C                     ELSE                            - X4
     C                     Z-ADD2         ZICT
     C                     END                             - E4
     C           ZICT      CASEQ1         ZIC01
     C           ZICT      CASEQ2         ZIC02
     C                     END
     C                     Z-ADDZINTR     DINT
     C                     END                             - E3
     C*
     C                     ELSE                            - X2
     C*
     C** IF CHANGE OF MONTH OCCURS WITH METHODS 3 & 4 THEN TWO PROCESSINGS
     C** FIRST PROCESSING:
     C*
     C           MNBL      IFGT 0                          - B3
     C                     Z-ADDMNBL      ZIAMT
     C                     Z-ADDZLDTM     ZIEND
     C           INTP      IFEQ 3                          - B4
     C                     Z-ADD1         ZICT
     C                     ELSE                            - X4
     C                     Z-ADD2         ZICT
     C                     END                             - E4
     C           ZICT      CASEQ1         ZIC01
     C           ZICT      CASEQ2         ZIC02
     C                     END
     C                     Z-ADDZINTR     DINT
     C                     END                             - E3
     C*
     C** SECOND PROCESSING:
     C*
     C           RHISB     IFGT 0                          - B3
     C**********           Z-ADDRHISB     ZIAMT                                               220566
     C                     Z-ADDBHISB     ZIAMT                                               220566
     C                     Z-ADDZLDTM     ZIBEG
     C                     Z-ADDRUND      ZIEND
     C           INTP      IFEQ 3                          - B4
     C                     Z-ADD1         ZICT
     C                     ELSE                            - X4
     C                     Z-ADD2         ZICT
     C                     END                             - E4
     C           ZICT      CASEQ1         ZIC01
     C           ZICT      CASEQ2         ZIC02
     C                     END
     C                     ADD  ZINTR     DINT
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C/COPY WNCPYSRC,RE3360C044
     C*
     C** CREDIT PROCESSING
     C*
     C                     Z-ADD*ZEROS    INRT
     C                     Z-ADD*ZEROS    INTP
     C                     Z-ADD*ZEROS    INST
     C                     Z-ADD*ZEROS    ZINTR
     C                     Z-ADD*ZEROS    ZLDTM
     C*
     C           RHISB     IFLT *ZEROS                     - B1
     C           MNBL      ORLT *ZEROS
     C                     EXSR CRINIT
     C                     END                             - E1
      *                                                                   S01408
     C/COPY WNCPYSRC,RE3360CP12                                           S01408
      *                                                                   S01408
     C*
     C                     Z-ADDINRT      ZIRATE
     C                     Z-ADDINTP      ZICT
     C                     Z-ADDCRIC      ZICALC
     C**********           Z-ADDRHISD     ZIBEG                                               220566
     C           CRE090    IFEQ 'Y'                                                           CRE090
     C           WDRDLY    ANDEQ'Y'                                                           CRE090
     C           CRE090    OREQ 'Y'                                                           CRE090
     C           WCRDLY    ANDEQ'Y'                                                           CRE090
     C                     Z-ADDPRDNB     ZIBEG                                               CRE090
     C                     ELSE                                                               CRE090
     C                     Z-ADDDHISD     ZIBEG                                               220566
     C                     ENDIF                                                              CRE090
     C                     Z-ADDRUND      ZIEND
     C*
     C           INTP      IFLT 3                          - B1
     C           RHISB     IFLT 0                          - B2
     C**********           Z-ADDRHISB     ZIAMT                                               220566
     C                     Z-ADDBHISB     ZIAMT                                               220566
     C           ZICT      CASEQ0         ZIC00
     C           ZICT      CASEQ1         ZIC01
     C           ZICT      CASEQ2         ZIC02
     C                     END
     C                     Z-ADDZINTR     CINT
     C                     END                             - E2
     C*
     C                     ELSE                            - X1
      *                                                                   S01408
     C/COPY WNCPYSRC,RE3360CP13                                           S01408
      *                                                                   S01408
     C*
     C** SEARCHING END-OF-MONTH DATE
     C*
     C                     EXSR DATEIN
     C*
     C           RUND      IFLE ZLDTM                      - B2
     C           MNBL      IFGT 0                          - B3
     C                     Z-ADDMNBL      ZIAMT
     C           INTP      IFEQ 3                          - B4
     C                     Z-ADD1         ZICT
     C                     ELSE                            - X4
     C                     Z-ADD2         ZICT
     C                     END                             - E4
     C           ZICT      CASEQ1         ZIC01
     C           ZICT      CASEQ2         ZIC02
     C                     END
     C                     Z-ADDZINTR     CINT
     C                     END                             - E3
     C*
     C                     ELSE                            - X2
     C*
     C** IF CHANGE OF MONTH OCCURS WITH METHODS 3 & 4 THEN TWO PROCESSINGS
     C** FIRST PROCESSING:
     C*
     C           MNBL      IFGT 0                          - B3
     C                     Z-ADDMNBL      ZIAMT
     C                     Z-ADDZLDTM     ZIEND
     C           INTP      IFEQ 3                          - B4
     C                     Z-ADD1         ZICT
     C                     ELSE                            - X4
     C                     Z-ADD2         ZICT
     C                     END                             - E4
     C           ZICT      CASEQ1         ZIC01
     C           ZICT      CASEQ2         ZIC02
     C                     END
     C                     Z-ADDZINTR     CINT
     C                     END                             - E3
     C*
     C** SECOND PROCESSING:
     C*
     C           RHISB     IFGT 0                          - B3
     C**********           Z-ADDRHISB     ZIAMT                                               220566
     C                     Z-ADDBHISB     ZIAMT                                               220566
     C                     Z-ADDZLDTM     ZIBEG
     C                     Z-ADDRUND      ZIEND
     C           INTP      IFEQ 3                          - B4
     C                     Z-ADD1         ZICT
     C                     ELSE                            - X4
     C                     Z-ADD2         ZICT
     C                     END                             - E4
     C           ZICT      CASEQ1         ZIC01
     C           ZICT      CASEQ2         ZIC02
     C                     END
     C                     ADD  ZINTR     CINT
     C                     END                             - E3
     C*
     C                     END                             - E2
      *                                                                   S01408
     C/COPY WNCPYSRC,RE3360CP14                                           S01408
      *                                                                   S01408
     C*
     C                     END                             - E1
     C*
     C/COPY WNCPYSRC,RE3360C025
     C                     ENDSR                           **INTCAL ENDSR*
     C********************************************************************                    CRE090
     C/EJECT                                                                                  CRE090
     C********************************************************************                    CRE090
     C**                                                                                      CRE090
     C** SRDLAY - subroutine for delayed capitalisation interest                              CRE090
     C**                                                                                      CRE090
     C**     Called by       SCROUT                                                           CRE090
     C**     Calls           CRINIT, DRINIT, ZICOD, ZIC00, ZIC01, ZIC02                       CRE090
     C**                                                                                      CRE090
     C********************************************************************                    CRE090
     C           SRDLAY    BEGSR                           **SRDLAY BEGSR*                    CRE090
      *                                                                                       CRE090
      ** Store history balance                                                                CRE090
      *                                                                                       CRE090
     C                     Z-ADDRHISB     WRHISB 150                                          CRE090
      *                                                                                       CRE090
      ** Initialize delay work fields and parameters                                          CRE090
      *                                                                                       CRE090
     C                     Z-ADD0         WDRACD 130                                          CRE090
     C                     Z-ADD0         WCRACD 130                                          CRE090
     C                     Z-ADD0         WACCRD 130                                          CRE090
     C                     Z-ADD0         WCAP1  150                                          CRE090
     C                     Z-ADD0         WCAP2  150                                          CRE090
     C                     Z-ADD0         WDATE1  50                                          CRE090
     C                     Z-ADD0         WDATE2  50                                          CRE090
     C                     Z-ADD0         RCHSB1 150                                          CRE090
     C                     Z-ADD0         RCHSB2 150                                          CRE090
     C                     Z-ADD0         TCHGA  150                                          CRE090
     C                     Z-ADD0         DRCOM  130                                          CRE090
     C                     Z-ADD0         WHHISB 150                                          CRE090
     C                     Z-ADD0         HDRCOM 130                                          CRE090
     C                     Z-ADD0         MINCBC 150                                         CRE090A
     C                     Z-ADD0         WCMBC  130                                         CRE090A
     C                     Z-ADD0         WTOCOM 130                                         CRE090A
     C                     MOVE *BLANKS   PHISB1                                              CRE090
     C                     MOVE *BLANKS   PHISB2                                              CRE090
     C                     MOVE *BLANKS   PCAP1                                               CRE090
     C                     MOVE *BLANKS   PCAP2                                               CRE090
     C                     MOVE *BLANKS   PDRACD                                              CRE090
     C                     MOVE *BLANKS   PCRACD                                              CRE090
     C                     MOVE *BLANKS   PDCHGA                                              CRE090
     C                     Z-ADD0         WINT1  150                                       MD027025A
     C                     Z-ADD0         WINT2  150                                       MD027025A
      *                                                                                       CRE090
      ** If account capitalisation not for delay, exit subroutine                             CRE090
      *                                                                                       CRE090
     C           WDRDLY    IFEQ 'N'                                                           CRE090
     C           WCRDLY    ANDEQ'N'                                                           CRE090
     C                     GOTO DLYTAG                                                        CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
      ** Get debit interest details                                                           CRE090
      *                                                                                       CRE090
     C                     MOVE CCY       REHCCY                                              CRE090
     C                     Z-ADD*ZEROS    INRT                                                CRE090
     C                     Z-ADD*ZEROS    INTP                                                CRE090
     C                     Z-ADD*ZEROS    INST                                                CRE090
     C                     Z-ADD*ZEROS    ZINTR                                               CRE090
     C                     Z-ADD*ZEROS    ZLDTM                                               CRE090
     C           NDID      IFNE 0                                                             CRE090
     C                     EXSR DRINIT                                                        CRE090
     C                     ENDIF                                                              CRE090
     C                     Z-ADDINRT      ZDRATE                                              CRE090
     C                     Z-ADDINTP      ZDCT                                                CRE090
     C                     Z-ADDDRIC      ZDCALC                                              CRE090
      *                                                                                       CRE090
      ** Get credit interest details                                                          CRE090
      *                                                                                       CRE090
     C                     Z-ADD*ZEROS    INRT                                                CRE090
     C                     Z-ADD*ZEROS    INTP                                                CRE090
     C                     Z-ADD*ZEROS    INST                                                CRE090
     C                     Z-ADD*ZEROS    ZINTR                                               CRE090
     C                     Z-ADD*ZEROS    ZLDTM                                               CRE090
     C           NCID      IFNE 0                                                             CRE090
     C                     EXSR CRINIT                                                        CRE090
     C                     ENDIF                                                              CRE090
     C                     Z-ADDINRT      ZCRATE                                              CRE090
     C                     Z-ADDINTP      ZCCT                                                CRE090
     C                     Z-ADDDRIC      ZCCALC                                              CRE090
      *                                                                                       CRE090
      ** Check highest overdraft from last cap. date                                          CRE090
      *                                                                                       CRE090
     C           WDRDLY    IFEQ 'Y'                        - B1                               CRE090
     C                     Z-ADDLDID      KDATE                                               CRE090
     C           BMLDAI    IFNE 'Y'                                                         MD026943
     C           LDID      ANDNEDACO                                                        MD026943
     C                     ADD  1         KDATE                                             MD026943
     C                     ENDIF                                                            MD026943
     C           DCKEY     SETLLREHISDL                                                       CRE090
     C           R1KEY     READEREHISDL                  99                                   CRE090
     C           *IN99     DOWEQ'0'                        - B2                               CRE090
     C           RAHISD    ANDLTNDID                                                          CRE090
     C           BMLDAI    ANDEQ'Y'                                                         MD026943
     C           *IN99     OREQ '0'                                                         MD026943
     C           RAHISD    ANDLENDID                                                        MD026943
     C           BMLDAI    ANDNE'Y'                                                         MD026943
     C           RAHISB    IFGT WHHISB                                                        CRE090
     C                     Z-ADDRAHISB    WHHISB                                              CRE090
     C                     ENDIF                                                              CRE090
     C           R1KEY     READEREHISDL                  99                                   CRE090
     C                     ENDDO                           - E2                               CRE090
     C                     ENDIF                           - E1                               CRE090
     C           WHHISB    MULT CHDBR     HDRCOM                                              CRE090
     C**********           MULT .01       HDRCOM                                      CRE090 CRE090A
     C                     MULT .01       HDRCOM    H                                        CRE090A
      *                                                                                      CRE090A
      ** Check for minimum credit balance commission                                         CRE090A
      *                                                                                      CRE090A
     C           WCRDLY    IFEQ 'Y'                        - B1                              CRE090A
      *                                                                                      CRE090A
     C                     Z-ADDLCID      KDATE                                              CRE090A
     C                     Z-ADDLCID      PRAHSD                                             CRE090A
     C           BMLDAI    IFNE 'Y'                                                         MD026943
     C           LCID      ANDNEDACO                                                        MD026943
     C                     ADD  1         KDATE                                             MD026943
     C                     ADD  1         PRAHSD                                            MD026943
     C                     ENDIF                                                            MD026943
     C           DCKEY     SETLLREHISDL                                                      CRE090A
     C           R1KEY     READEREHISDL                  99                                  CRE090A
     C           *IN99     DOWEQ'0'                        - B2                              CRE090A
     C           RAHISD    ANDLTNCID                                                         CRE090A
     C           BMLDAI    ANDEQ'Y'                                                         MD026943
     C           *IN99     OREQ '0'                                                         MD026943
     C           RAHISD    ANDLENCID                                                        MD026943
     C           BMLDAI    ANDNE'Y'                                                         MD026943
     C           RAHISB    IFLT 0                                                            CRE090A
     C                     Z-ADDRAHISB    PRAHSB                                             CRE090A
     C                     ELSE                                                              CRE090A
     C                     Z-ADD0         PRAHSB                                             CRE090A
     C                     ENDIF                                                             CRE090A
     C           R1KEY     READEREHISDL                  99                                  CRE090A
     C           RAHISD    IFGE NCID                                                         CRE090A
     C           BMLDAI    ANDEQ'Y'                                                         MD027105
     C           RAHISD    ORGT NCID                                                        MD027105
     C           BMLDAI    ANDNE'Y'                                                         MD027105
     C           *IN99     OREQ '1'                                                          CRE090A
     C                     Z-ADDNCID      RAHISD                                             CRE090A
     C           BMLDAI    IFNE 'Y'                                                         MD027105
     C                     ADD  1         RAHISD                                            MD027105
     C                     ENDIF                                                            MD027105
     C                     ENDIF                                                             CRE090A
     C           RAHISD    SUB  PRAHSD    DIFFDD  50                                         CRE090A
     C           PRAHSB    MULT DIFFDD    WKVAL1 150H                                        CRE090A
     C                     ADD  WKVAL1    MINCBC                                             CRE090A
     C                     Z-ADDRAHISD    PRAHSD                                             CRE090A
     C                     ENDDO                           - E2                              CRE090A
      *                                                                                      CRE090A
     C           PRAHSB    IFLT 0                          - B2                              CRE090A
     C           NCID      SUB  LCID      DIFFDD                                             CRE090A
     C           LCID      IFEQ DACO                                                        MD027192
     C           BMLDAI    ANDNE'Y'                                                         MD027192
     C                     ADD  1         DIFFDD                                            MD027192
     C                     ENDIF                                                            MD027192
     C           MINCBC    DIV  DIFFDD    WKVAL1    H                                        CRE090A
     C                     Z-SUBWKVAL1    WKVAL1                                             CRE090A
     C           STYP      IFEQ 'C'                        - B3                              CRE090A
     C           WKVAL1    ANDLTAMBC                                                         CRE090A
     C           WKVAL1    ANDGT0                                                            CRE090A
     C                     Z-ADDMCFC      WCMBC                                              CRE090A
     C           CEXE      IFNE *BLANKS                                                     MD026867
     C                     MOVE CEXE      WCMBC                                             MD026867
     C                     END                                                              MD026867
     C                     ELSE                            - X3                              CRE090A
     C           STYP      IFEQ 'S'                        - B4                              CRE090A
     C           WKVAL1    ANDLTAMBS                                                         CRE090A
     C           WKVAL1    ANDGT0                                                            CRE090A
     C                     Z-ADDMSFC      WCMBC                                              CRE090A
     C           CEXE      IFNE *BLANKS                                                     MD026867
     C                     MOVE CEXE      WCMBC                                             MD026867
     C                     END                                                              MD026867
     C                     ELSE                            - X4                              CRE090A
     C                     Z-ADD0         WCMBC                                              CRE090A
     C                     ENDIF                           - E4                              CRE090A
     C                     ENDIF                           - E3                              CRE090A
     C                     ENDIF                           - E2                              CRE090A
      *                                                                                      CRE090A
     C                     ENDIF                           - E1                              CRE090A
      *                                                                                      CRE090A
      ** Check for debit turnover commission                                                 CRE090A
      *                                                                                      CRE090A
     C           WDRDLY    IFEQ 'Y'                        - B1                              CRE090A
      *                                                                                      CRE090A
     C           CEXB      IFNE *BLANKS                    - B2                              CRE090A
     C                     MOVE CEXB      WTORAT 108                                         CRE090A
     C                     ELSE                            - X2                              CRE090A
     C                     Z-ADDACRT      WTORAT                                             CRE090A
     C                     ENDIF                           - E2                              CRE090A
     C********** GVDPE     MULT WTORAT    WKVAL1    H                               CRE090A MD026867
     C           GVDPC     MULT WTORAT    WKVAL1    H                                       MD026867
     C                     DIV  100       WKVAL1    H                                        CRE090A
     C           WKVAL1    IFLE ACMN                       - B2                              CRE090A
     C                     Z-ADDACMN      WTOCOM                                             CRE090A
     C                     ELSE                            - X2                              CRE090A
     C           WKVAL1    IFGE ACMX                       - B3                              CRE090A
     C                     Z-ADDACMX      WTOCOM                                             CRE090A
     C                     ELSE                            - X3                              CRE090A
     C                     Z-ADDWKVAL1    WTOCOM                                             CRE090A
     C                     ENDIF                           - E3                              CRE090A
     C                     ENDIF                           - E2                              CRE090A
      *                                                                                      CRE090A
     C                     ENDIF                           - E1                              CRE090A
      *                                                                                       CRE090
      ** Start reading REHISDL from earlier debit or credit cap date.                         CRE090
      *                                                                                       CRE090
     C           NDID      IFLE NCID                       - B1                               CRE090
     C           NDID      ANDNE0                                                             CRE090
     C           NDID      ORGT NCID                                                          CRE090
     C           NCID      ANDEQ0                                                             CRE090
     C                     Z-ADDNDID      WDATE1                                              CRE090
     C           WCRDLY    IFEQ 'Y'                        - B2                               CRE090
     C           NCID      ANDNENDID                                                          CRE090
     C                     Z-ADDNCID      WDATE2                                              CRE090
     C                     ENDIF                           - E2                               CRE090
     C                     ELSE                            - X1                               CRE090
     C           NCID      IFNE 0                          - B2                               CRE090
     C                     Z-ADDNCID      WDATE1                                              CRE090
     C           WDRDLY    IFEQ 'Y'                        - B3                               CRE090
     C                     Z-ADDNDID      WDATE2                                              CRE090
     C                     ENDIF                           - E3                               CRE090
     C                     ENDIF                           - E2                               CRE090
     C                     ENDIF                           - E1                               CRE090
      *                                                                                       CRE090
      ** Compute total interests and charges.                                                 CRE090
      *                                                                                       CRE090
     C                     Z-ADD0         CTL     10                                          CRE090
     C                     Z-ADDWDATE1    KDATE                                               CRE090
     C           DCKEY     SETLLREHISDL                                                       CRE090
     C           R1KEY     REDPEREHISDL                  99                                   CRE090
     C           *IN99     IFEQ '1'                                                         MD027139
     C           DCKEY     SETLLREHISDL                                                     MD027139
     C           R1KEY     READEREHISDL                  99                                 MD027139
     C                     ENDIF                                                            MD027139
     C                     Z-ADDRAHISB    PRAHSB 150                                          CRE090
     C                     Z-ADDRAHISD    PRAHSD  50                                          CRE090
     C                     Z-ADDRADAID    PRDAID 130                                          CRE090
     C                     Z-ADDRACAID    PRCAID 130                                          CRE090
     C                     Z-ADDRATCHR    PRATCH 130                                          CRE090
      *                                                                                       CRE090
     C           *IN99     DOWEQ'0'                        - B1                               CRE090
      *                                                                                       CRE090
      ** Compute interest capitalisation if hisd of next record                               CRE090
      ** is >= DR/CR cap date, or already on end of file.                                     CRE090
      *                                                                                       CRE090
     C           CTL       IFEQ 0                          - B2                               CRE090
     C           RAHISD    ANDGEWDATE1                                                        CRE090
     C           BMLDAI    ANDEQ'Y'                                                         MD026943
     C           CTL       OREQ 1                                                             CRE090
     C           RAHISD    ANDGEWDATE2                                                        CRE090
     C           WDATE2    ANDNE0                                                             CRE090
     C           BMLDAI    ANDEQ'Y'                                                         MD026943
     C           CTL       OREQ 0                                                           MD026943
     C           RAHISD    ANDGTWDATE1                                                      MD026943
     C           BMLDAI    ANDNE'Y'                                                         MD026943
     C           CTL       OREQ 1                                                           MD026943
     C           RAHISD    ANDGTWDATE2                                                      MD026943
     C           WDATE2    ANDNE0                                                           MD026943
     C           BMLDAI    ANDNE'Y'                                                         MD026943
      *                                                                                       CRE090
     C           CAPTAG    TAG                                                                CRE090
      *                                                                                       CRE090
     C           CTL       IFEQ 0                          - B3                               CRE090
     C                     Z-ADDPRAHSB    RCHSB1                                              CRE090
     C                     Z-ADDRCHSB1    ZIAMT                                               CRE090
     C                     Z-ADDWDATE1    ZIEND                                               CRE090
     C                     ELSE                            - X3                               CRE090
     C           PRAHSB    ADD  WCAP1     RCHSB2                                              CRE090
     C                     Z-ADDRCHSB2    ZIAMT                                               CRE090
     C                     Z-ADDWDATE2    ZIEND                                               CRE090
     C                     ENDIF                           - E3                               CRE090
      *                                                                                       CRE090
     C                     Z-ADDZIAMT     RHISB                                               CRE090
     C                     Z-ADDPRAHSD    ZIBEG                                               CRE090
     C           BMLDAI    IFNE 'Y'                                                         MD026943
     C                     SUB  1         ZIBEG                                             MD026943
     C                     ENDIF                                                            MD026943
      *                                                                                       CRE090
      ** Compute charge amount to be capitalised                                              CRE090
      *                                                                                       CRE090
     C           WDATE1    IFEQ NCID                       - B3                               CRE090
     C           CHGT      ANDNE0                                                             CRE090
     C           CTL       ANDEQ0                                                             CRE090
     C           WDATE2    OREQ NCID                                                          CRE090
     C           CHGT      ANDNE0                                                             CRE090
     C           CTL       ANDEQ1                                                             CRE090
      *                                                                                       CRE090
     C                     Z-ADDPRATCH    TCHRGE 130                                          CRE090
     C           TCHRGE    IFGT MAXC                                                          CRE090
     C           MAXC      ANDNE0                                                             CRE090
     C                     Z-ADDMAXC      TCHRGE                                              CRE090
     C                     ENDIF                                                              CRE090
     C           TCHRGE    IFLT MINC                                                          CRE090
     C           MINC      ANDNE0                                                             CRE090
     C                     Z-ADDMINC      TCHRGE                                              CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
     C                     ENDIF                           - E3                               CRE090
      *                                                                                       CRE090
     C                     Z-ADD*ZEROS    ZINTR                                               CRE090
     C           RHISB     IFGT 0                          - B3                               CRE090
     C                     Z-ADDZDRATE    ZIRATE                                              CRE090
     C                     Z-ADDZDCT      ZICT                                                CRE090
     C                     Z-ADDZDCALC    ZICALC                                              CRE090
     C                     ELSE                            - X3                               CRE090
     C                     Z-ADDZCRATE    ZIRATE                                              CRE090
     C                     Z-ADDZCCT      ZICT                                                CRE090
     C                     Z-ADDZCCALC    ZICALC                                              CRE090
     C                     ENDIF                           - E3                               CRE090
      *                                                                                       CRE090
     C   54      ZICT      CASEQ0         ZICOD                                               CRE090
     C  N54      ZICT      CASEQ0         ZIC00                                               CRE090
     C           ZICT      CASEQ1         ZIC01                                               CRE090
     C           ZICT      CASEQ2         ZIC02                                               CRE090
     C                     ENDCS                                                              CRE090
      *                                                                                       CRE090
     C           CTL       IFEQ 0                          - B3                               CRE090
      *                                                                                       CRE090
      ** If balance > 0: If Dr cap date, add to cap amount 1;                                 CRE090
      **                 else, add to debit accrued.                                          CRE090
      ** If balance < 0: If Cr cap date, add to cap amount 1;                                 CRE090
      **                 else, add to credit accrued.                                         CRE090
      *                                                                                       CRE090
     C           RHISB     IFGT 0                          - B4                               CRE090
      *                                                                                       CRE090
     C           WDATE1    IFEQ NDID                       - B5                               CRE090
     C                     Z-ADDZINTR     WCAP1                                               CRE090
     C********** ZINTR     MULT CDRR      DRCOM                                       CRE090 CRE090A
     C           ZINTR     ADD  PRDAID    DRCOM                                              CRE090A
     C                     MULT CDRR      DRCOM     H                                        CRE090A
     C**********           MULT .01       DRCOM                                       CRE090 CRE090A
     C                     MULT .01       DRCOM     H                                         CRE090
     C                     Z-ADD0         WDRACD                                              CRE090
     C                     ELSE                            - X5                               CRE090
     C           NDID      IFNE 0                                                             CRE090
     C                     Z-ADDZINTR     WDRACD                                              CRE090
     C                     ENDIF                                                              CRE090
     C                     ENDIF                           - E5                               CRE090
      *                                                                                       CRE090
     C                     ELSE                            - X4                               CRE090
      *                                                                                       CRE090
     C           WDATE1    IFEQ NCID                       - B5                               CRE090
     C                     Z-SUBZINTR     WCAP1                                               CRE090
     C                     Z-ADD0         WCRACD                                              CRE090
     C                     ELSE                            - X5                               CRE090
     C           NCID      IFNE 0                                                             CRE090
     C                     Z-ADDZINTR     WCRACD                                              CRE090
     C                     ENDIF                                                              CRE090
     C           PRDAID    MULT CDRR      DRCOM     H                                        CRE090A
     C                     MULT .01       DRCOM     H                                        CRE090A
     C                     ENDIF                           - E5                               CRE090
      *                                                                                       CRE090
     C                     ENDIF                           - E4                               CRE090
      *                                                                                       CRE090
      ** If Dr Cr cap, add both accrued to cap amount 1.                                      CRE090
      ** Else, add the first one to cap amount 1, then                                        CRE090
      **   add/sub the other one to accrued.                                                  CRE090
      *                                                                                       CRE090
     C           NDID      IFEQ NCID                       - B4                               CRE090
     C                     ADD  PRDAID    WCAP1                                               CRE090
     C                     SUB  PRCAID    WCAP1                                               CRE090
     C                     Z-ADD0         WDRACD                                            MD027105
     C                     Z-ADD0         WCRACD                                            MD027105
     C                     ELSE                            - X4                               CRE090
     C           WDATE1    IFEQ NDID                                                          CRE090
     C                     ADD  PRDAID    WCAP1                                               CRE090
     C                     Z-ADD0         WDRACD                                            MD027105
     C           WDATE2    IFNE 0                                                            CRE090A
     C                     SUB  PRCAID    WACCRD                                              CRE090
     C                     ELSE                                                              CRE090A
     C                     ADD  PRCAID    WCRACD                                             CRE090A
     C                     ENDIF                                                             CRE090A
     C                     ELSE                                                               CRE090
     C                     SUB  PRCAID    WCAP1                                               CRE090
     C                     Z-ADD0         WCRACD                                            MD027105
     C           WDATE2    IFNE 0                                                            CRE090A
     C                     ADD  PRDAID    WACCRD                                              CRE090
     C                     ELSE                                                              CRE090A
     C                     ADD  PRDAID    WDRACD                                             CRE090A
     C                     ENDIF                                                             CRE090A
     C                     ENDIF                                                              CRE090
     C                     ENDIF                           - E4                               CRE090
     C                     Z-ADDWCAP1     WINT1                                            MD027025A
      *                                                                                       CRE090
      ** Add charges and commissions to cap amount 1                                          CRE090
      *                                                                                       CRE090
     C                     ADD  TCHRGE    WCAP1                                               CRE090
     C           WDATE1    IFEQ NCID                       - B4                               CRE090
     C********** CHDBE     ANDEQ0                                                     CRE090 CRE090A
     C           NCID      ANDNENDID                                                         CRE090A
     C**********           ADD  SCACC0    WCAP1                                       CRE090 CRE090A
     C                     ADD  FXDC      WCAP1                                              CRE090A
     C                     ADD  WCMBC     WCAP1                                              CRE090A
     C                     ELSE                            - X4                               CRE090
     C                     ADD  HDRCOM    WCAP1                                               CRE090
     C                     Z-ADD0         HDRCOM                                              CRE090
     C                     ADD  DRCOM     WCAP1                                               CRE090
     C                     Z-ADD0         DRCOM                                               CRE090
     C                     ADD  WTOCOM    WCAP1                                              CRE090A
     C           NDID      IFEQ NCID                                                          CRE090
     C                     ADD  FXDC      WCAP1                                               CRE090
     C                     ADD  WCMBC     WCAP1                                              CRE090A
     C                     ENDIF                                                              CRE090
     C                     ENDIF                           - E4                               CRE090
     C           PRAHSB    ADD  WCAP1     ZIAMT                                               CRE090
     C                     Z-ADDZIAMT     RHISB                                               CRE090
     C                     Z-ADDWDATE1    ZIBEG                                               CRE090
     C                     Z-ADDWDATE1    PRAHSD                                              CRE090
     C           BMLDAI    IFNE 'Y'                                                         MD026943
     C                     ADD  1         ZIBEG                                             MD026943
     C                     ADD  1         PRAHSD                                            MD026943
     C                     ENDIF                                                            MD026943
      *                                                                                       CRE090
     C                     ELSE                            - X3                               CRE090
      *                                                                                       CRE090
      ** If balance > 0: If Dr cap date, add debit accrued to cap                             CRE090
      **    amount 2; else, add to outstanding debit accrued,                                 CRE090
      **    and sub credit accrued to cap amount 2.                                           CRE090
      ** If balance < 0: If Cr cap date, sub credit accrued to cap                            CRE090
      **    amount 2; else, add to outstanding credit accrued,                                CRE090
      **    and add debit accrued to cap amount 2.                                            CRE090
      *                                                                                       CRE090
     C           RHISB     IFGT 0                          - B4                               CRE090
      *                                                                                       CRE090
     C           WDATE2    IFEQ NDID                       - B5                               CRE090
     C                     Z-ADDZINTR     WCAP2                                               CRE090
     C                     ADD  WDRACD    WCAP2                                               CRE090
     C                     ADD  WACCRD    WCAP2                                              CRE090A
     C********** ZINTR     MULT CDRR      DRCOM                                       CRE090 CRE090A
     C           WCAP2     MULT CDRR      DRCOM     H                                        CRE090A
     C**********           MULT .01       DRCOM                                       CRE090 CRE090A
     C                     MULT .01       DRCOM     H                                        CRE090A
     C                     Z-ADD0         WDRACD                                              CRE090
     C                     ELSE                            - X5                               CRE090
     C                     ADD  ZINTR     WDRACD                                              CRE090
     C                     SUB  WCRACD    WCAP2                                               CRE090
     C                     ADD  WACCRD    WCAP2                                              CRE090A
     C                     Z-ADD0         WCRACD                                              CRE090
     C                     ENDIF                           - E5                               CRE090
      *                                                                                       CRE090
     C                     ELSE                            - X4                               CRE090
      *                                                                                       CRE090
     C           WDATE2    IFEQ NCID                       - B5                               CRE090
     C                     Z-SUBZINTR     WCAP2                                               CRE090
     C                     SUB  WCRACD    WCAP2                                               CRE090
     C                     Z-ADD0         WCRACD                                              CRE090
     C                     ADD  WACCRD    WCAP2                                              CRE090A
     C                     ELSE                            - X5                               CRE090
     C                     ADD  ZINTR     WCRACD                                              CRE090
     C                     ADD  WDRACD    WCAP2                                               CRE090
     C                     Z-ADD0         WDRACD                                              CRE090
     C                     ADD  WACCRD    WCAP2                                              CRE090A
     C           WCAP2     MULT CDRR      DRCOM     H                                        CRE090A
     C                     MULT .01       DRCOM     H                                        CRE090A
     C                     ENDIF                           - E5                               CRE090
      *                                                                                       CRE090
     C                     ENDIF                           - E4                               CRE090
     C                     Z-ADDWCAP2     WINT2                                            MD027025A
      *                                                                                       CRE090
      ** Add charges and commissions to cap amount 2                                          CRE090
      *                                                                                       CRE090
     C                     ADD  TCHRGE    WCAP2                                               CRE090
     C**********           ADD  WACCRD    WCAP2                                       CRE090 CRE090A
     C           WDATE2    IFEQ NCID                       - B4                               CRE090
     C********** CHDBE     ANDEQ0                                                     CRE090 CRE090A
     C**********           ADD  SCACC0    WCAP2                                       CRE090 CRE090A
     C                     ADD  FXDC      WCAP2                                              CRE090A
     C                     ADD  WCMBC     WCAP2                                              CRE090A
     C                     ELSE                                                               CRE090
     C                     ADD  HDRCOM    WCAP2                                               CRE090
     C                     ADD  DRCOM     WCAP2                                               CRE090
     C                     ADD  WTOCOM    WCAP2                                              CRE090A
     C********** WDATE2    IFEQ NCID                                                  CRE090 CRE090A
     C**********           ADD  FXDC      WCAP2                                       CRE090 CRE090A
     C**********           ENDIF                                                      CRE090 CRE090A
     C                     ENDIF                           - E4                               CRE090
      *                                                                                       CRE090
     C           PRAHSB    ADD  WCAP1     ZIAMT                                               CRE090
     C                     ADD  WCAP2     ZIAMT                                               CRE090
     C                     Z-ADDZIAMT     RHISB                                               CRE090
     C                     Z-ADDWDATE2    ZIBEG                                               CRE090
     C                     Z-ADDWDATE2    PRAHSD                                              CRE090
     C           BMLDAI    IFNE 'Y'                                                         MD026943
     C                     ADD  1         ZIBEG                                             MD026943
     C                     ADD  1         PRAHSD                                            MD026943
     C                     ENDIF                                                            MD026943
      *                                                                                       CRE090
     C                     ENDIF                           - E3                               CRE090
      *                                                                                       CRE090
      ** If no history record between the two cap dates, do next                              CRE090
      ** capitalisation processing                                                            CRE090
      *                                                                                       CRE090
     C           CTL       IFEQ 0                                                             CRE090
     C           RAHISD    ANDGEWDATE2                                                        CRE090
     C           WDATE2    ANDNE0                                                             CRE090
     C           BMLDAI    ANDEQ'Y'                                                         MD027105
     C           CTL       OREQ 0                                                           MD027105
     C           RAHISD    ANDGTWDATE2                                                      MD027105
     C           WDATE2    ANDNE0                                                           MD027105
     C           BMLDAI    ANDNE'Y'                                                         MD027105
     C           CTL       OREQ 0                                                          MD027025A
     C           WDATE2    ANDNE0                                                          MD027025A
     C           *IN99     ANDEQ'1'                                                        MD027025A
     C                     ADD  1         CTL                                                 CRE090
     C                     Z-ADD0         TCHRGE                                              CRE090
     C                     GOTO CAPTAG                                                        CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
      ** If a history record after cap date exists, set hisd                                  CRE090
      ** as end date, and add charge amount to outstanding;                                   CRE090
      ** else, compute until run date                                                         CRE090
      *                                                                                       CRE090
     C           *IN99     IFEQ '0'                         - B3                              CRE090
     C                     Z-ADDRAHISD    ZIEND                                               CRE090
     C           RAHISD    IFGE NCID                                                          CRE090
     C           WCRDLY    ANDEQ'Y'                                                           CRE090
     C           BMLDAI    ANDEQ'Y'                                                         MD027105
     C           RAHISD    ORGT NCID                                                        MD027105
     C           WCRDLY    ANDEQ'Y'                                                         MD027105
     C           BMLDAI    ANDNE'Y'                                                         MD027105
     C                     ADD  RACHGA    TCHGA                                               CRE090
     C                     ENDIF                                                              CRE090
     C                     ELSE                                                               CRE090
     C                     Z-ADDRUND      ZIEND                                               CRE090
     C                     ENDIF                            - E3                              CRE090
      *                                                                                       CRE090
     C                     Z-ADD*ZEROS    ZINTR                                               CRE090
     C           RHISB     IFGT 0                           - B3                              CRE090
     C                     Z-ADDZDRATE    ZIRATE                                              CRE090
     C                     Z-ADDZDCT      ZICT                                                CRE090
     C                     Z-ADDZDCALC    ZICALC                                              CRE090
     C                     ELSE                             - X3                              CRE090
     C                     Z-ADDZCRATE    ZIRATE                                              CRE090
     C                     Z-ADDZCCT      ZICT                                                CRE090
     C                     Z-ADDZCCALC    ZICALC                                              CRE090
     C                     ENDIF                            - E3                              CRE090
      *                                                                                       CRE090
     C   54      ZICT      CASEQ0         ZICOD                                               CRE090
     C  N54      ZICT      CASEQ0         ZIC00                                               CRE090
     C           ZICT      CASEQ1         ZIC01                                               CRE090
     C           ZICT      CASEQ2         ZIC02                                               CRE090
     C                     ENDCS                                                              CRE090
      *                                                                                       CRE090
     C           RHISB     IFGT 0                                                             CRE090
     C                     ADD  ZINTR     WDRACD                                              CRE090
     C                     ELSE                                                               CRE090
     C                     ADD  ZINTR     WCRACD                                              CRE090
     C                     ENDIF                                                              CRE090
     C                     ADD  1         CTL                                                 CRE090
     C                     Z-ADD0         TCHRGE                                              CRE090
      *                                                                                       CRE090
     C                     ELSE                            - X2                               CRE090
      *                                                                                       CRE090
     C           RAHISB    ADD  WCAP1     ZIAMT                                               CRE090
     C                     ADD  WCAP2     ZIAMT                                               CRE090
     C                     Z-ADDZIAMT     RHISB                                               CRE090
     C                     Z-ADDRAHISD    ZIBEG                                               CRE090
     C                     Z-ADDRAHISB    PRAHSB                                              CRE090
     C                     Z-ADDRAHISD    PRAHSD                                              CRE090
     C                     Z-ADDRADAID    PRDAID                                              CRE090
     C                     Z-ADDRACAID    PRCAID                                              CRE090
     C                     Z-ADDRATCHR    PRATCH                                              CRE090
     C           R1KEY     READEREHISDL                  99                                   CRE090
      *                                                                                       CRE090
      ** If hisd of next record read is >= Dr/Cr Cap date,                                    CRE090
      ** or already on end of file, do next cap processing                                    CRE090
      *                                                                                       CRE090
     C           *IN99     IFEQ '0'                                                           CRE090
     C           CTL       ANDEQ0                                                             CRE090
     C           RAHISD    ANDGEWDATE1                                                        CRE090
     C           BMLDAI    ANDEQ'Y'                                                         MD026943
     C           *IN99     OREQ '0'                                                           CRE090
     C           CTL       ANDEQ1                                                             CRE090
     C           RAHISD    ANDGEWDATE2                                                        CRE090
     C           WDATE2    ANDNE0                                                             CRE090
     C           BMLDAI    ANDEQ'Y'                                                         MD026943
     C           *IN99     OREQ '0'                                                         MD026943
     C           CTL       ANDEQ0                                                           MD026943
     C           RAHISD    ANDGTWDATE1                                                      MD026943
     C           BMLDAI    ANDNE'Y'                                                         MD026943
     C           *IN99     OREQ '0'                                                         MD026943
     C           CTL       ANDEQ1                                                           MD026943
     C           RAHISD    ANDGTWDATE2                                                      MD026943
     C           WDATE2    ANDNE0                                                           MD026943
     C           BMLDAI    ANDNE'Y'                                                         MD026943
     C           *IN99     OREQ '1'                                                           CRE090
     C           CTL       ANDEQ0                                                             CRE090
     C           *IN99     OREQ '1'                                                           CRE090
     C           CTL       ANDEQ1                                                             CRE090
     C           WDATE2    ANDNE0                                                             CRE090
     C                     GOTO CAPTAG                                                        CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
      ** If a history record after cap date exists, set hisd                                  CRE090
      ** as end date, and add charge amount to outstanding;                                   CRE090
      ** else, compute until run date                                                         CRE090
      *                                                                                       CRE090
     C           *IN99     IFEQ '0'                         - B3                              CRE090
     C                     Z-ADDRAHISD    ZIEND                                               CRE090
     C           RAHISD    IFGE NCID                                                          CRE090
     C           WCRDLY    ANDEQ'Y'                                                           CRE090
     C           BMLDAI    ANDEQ'Y'                                                         MD027105
     C           RAHISD    ORGT NCID                                                        MD027105
     C           WCRDLY    ANDEQ'Y'                                                         MD027105
     C           BMLDAI    ANDNE'Y'                                                         MD027105
     C                     ADD  RACHGA    TCHGA                                               CRE090
     C                     ENDIF                                                              CRE090
     C                     ELSE                             - X3                              CRE090
     C                     Z-ADDRUND      ZIEND                                               CRE090
     C                     ENDIF                            - E3                              CRE090
      *                                                                                       CRE090
     C                     Z-ADD*ZEROS    ZINTR                                               CRE090
     C           RHISB     IFGT 0                           - B3                              CRE090
     C                     Z-ADDZDRATE    ZIRATE                                              CRE090
     C                     Z-ADDZDCT      ZICT                                                CRE090
     C                     Z-ADDZDCALC    ZICALC                                              CRE090
     C                     ELSE                             - X3                              CRE090
     C                     Z-ADDZCRATE    ZIRATE                                              CRE090
     C                     Z-ADDZCCT      ZICT                                                CRE090
     C                     Z-ADDZCCALC    ZICALC                                              CRE090
     C                     ENDIF                            - E3                              CRE090
      *                                                                                       CRE090
     C   54      ZICT      CASEQ0         ZICOD                                               CRE090
     C  N54      ZICT      CASEQ0         ZIC00                                               CRE090
     C           ZICT      CASEQ1         ZIC01                                               CRE090
     C           ZICT      CASEQ2         ZIC02                                               CRE090
     C                     ENDCS                                                              CRE090
      *                                                                                       CRE090
     C           RHISB     IFGT 0                                                             CRE090
     C                     ADD  ZINTR     WDRACD                                              CRE090
     C                     ELSE                                                               CRE090
     C                     ADD  ZINTR     WCRACD                                              CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
     C                     ENDIF                           - E2                               CRE090
      *                                                                                       CRE090
     C                     ENDDO                           - E1                               CRE090
      *                                                                                       CRE090
      ** Move computed amounts for RE3363 display                                             CRE090
      *                                                                                       CRE090
     C                     MOVE RCHSB1    PHISB1                                              CRE090
     C                     MOVE RCHSB2    PHISB2                                              CRE090
     C                     MOVE WCAP1     PCAP1                                               CRE090
     C                     MOVE WCAP2     PCAP2                                               CRE090
     C                     MOVE WDRACD    PDRACD                                              CRE090
     C                     MOVE WCRACD    PCRACD                                              CRE090
     C                     MOVE TCHGA     PDCHGA                                              CRE090
     C                     MOVE WINT1     PINT1                                            MD027025A
     C                     MOVE WINT2     PINT2                                            MD027025A
      *                                                                                       CRE090
     C                     Z-ADDWRHISB    RHISB                                               CRE090
      *                                                                                       CRE090
     C           DLYTAG    TAG                                                                CRE090
     C                     ENDSR                           **SRDLAY ENDSR*                    CRE090
      ********************************************************************                    CGL031
      /EJECT                                                                                  234034
      *****************************************************************                       234034
      *                                                               *                       234034
      *  SRRDAT - Subroutine to check the effective date              *                       234034
      *                                                               *                       234034
      *****************************************************************                       234034
     C           SRRDAT    BEGSR                                                              234034
      *                                                                                       234034
      ** Branch details                                                                       234034
      *                                                                                       234034
     C                     CALL 'AOBRCHR0'                                                    234034
     C                     PARM *BLANKS   PRTCD                                               234034
     C                     PARM '*KEY   ' POPTN                                               234034
     C                     PARM SBRCA     PBRCA   3                                           234034
     C           SDBRCH    PARM SDBRCH    DSSDY                                               234034
      *                                                                                       234034
      **  Database Error                                                                      234034
      *                                                                                       234034
     C           PRTCD     IFNE *BLANKS                                                       234034
     C                     MOVELSBRCA     DBKEY                                               234034
     C                     MOVEL'SDBRCHPD'DBFILE                                              234034
     C                     Z-ADD41        DBASE                                               234034
     C                     EXSR *PSSR                                                         234034
     C                     ENDIF                                                              234034
      *                                                                                       234034
      ** Country code details                                                                 234034
      *                                                                                       234034
     C                     CALL 'AOLOCNR0'                                                    234034
     C                     PARM *BLANKS   PRTCD                                               234034
     C                     PARM '*KEY   ' POPTN                                               234034
     C                     PARM A8LCCD    PLCCD   3                                           234034
     C           SDLOCN    PARM SDLOCN    DSFDY                                               234034
      *                                                                                       234034
      **  Database Error                                                                      234034
      *                                                                                       234034
     C           PRTCD     IFNE *BLANKS                                                       234034
     C                     MOVELA8LCCD    DBKEY                                               234034
     C                     MOVEL'SDLOCNPD'DBFILE                                              234034
     C                     Z-ADD42        DBASE                                               234034
     C                     EXSR *PSSR                                                         234034
     C                     ENDIF                                                              234034
      *                                                                                     AR763412
      ** Additional Customer details                                                        AR763412
      *                                                                                     AR763412
     C                     CALL 'AOACUSR0'                                                  AR763412
     C                     PARM *BLANK    PRTCD                                             AR763412
     C                     PARM '*KEY   ' POPTN                                             AR763412
     C                     PARM           CNUMK                                             AR763412
     C           SDACUS    PARM SDACUS    DSSDY                                             AR763412
      *                                                                                       234034
      ** Customer details                                                                     234034
      *                                                                                       234034
     C                     MOVEL*BLANKS   @PKEY1 10                                           234034
     C                     MOVELCNUMK     @PKEY1                                              234034
      *                                                                                       234034
     C                     CALL 'AOCUSTR0'                                                    234034
     C                     PARM *BLANK    PRTCD                                               234034
     C                     PARM '*KEY   ' POPTN                                               234034
     C                     PARM           @PKEY1                                              234034
     C                     PARM           @PKYST  7                                           234034
     C           SDCUST    PARM SDCUST    DSSDY                                               234034
      *                                                                                       234034
      ** Database Error                                                                       234034
      *                                                                                       234034
     C           PRTCD     IFNE *BLANKS                                                       234034
     C                     MOVEL@PKYST    DBKEY                                               234034
     C                     MOVEL'SDCUSTPD'DBFILE                                              234034
     C                     Z-ADD43        DBASE                                               234034
     C                     EXSR *PSSR                                                         234034
     C                     ENDIF                                                              234034
      *                                                                                       234034
      ** Country of Tax                                                                       234034
      *                                                                                       234034
     C                     MOVE DVCNCD    WCNCD   2                                           234034
     C                     MOVE BBCOLC    WCOLC   2                                           234034
      *                                                                                       234034
     C                     CALL 'AOCTTXR0'                                                    234034
     C                     PARM *BLANKS   PRTCD                                               234034
     C                     PARM '*KEY   ' POPTN                                               234034
     C                     PARM           WCNCD                                               234034
     C                     PARM           WCOLC                                               234034
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234034
      *                                                                                       234034
     C           PRTCD     IFEQ '*NRF   '                                                     234034
     C                     MOVE *BLANKS   WCOLC                                               234034
     C                     CALL 'AOCTTXR0'                                                    234034
     C                     PARM *BLANKS   PRTCD                                               234034
     C                     PARM '*KEY   ' POPTN                                               234034
     C                     PARM           WCNCD                                               234034
     C                     PARM           WCOLC                                               234034
     C           SDCTTX    PARM SDCTTX    DSFDY                                               234034
      *                                                                                       234034
      ** Database Error                                                                       234034
      *                                                                                       234034
     C           PRTCD     IFNE *BLANKS                                                       234034
     C                     MOVELWCNCD     DBKEY                                               234034
     C                     MOVELWCOLC     DBKEY                                               234034
     C                     MOVEL'SDCTTXPD'DBFILE                                              234034
     C                     Z-ADD44        DBASE                                               234034
     C                     EXSR *PSSR                                                         234034
     C                     ENDIF                                                              234034
     C                     ENDIF                                                              234034
      *                                                                                       234034
     C                     MOVE *BLANKS   WELGTX  1                                         BUG23325
      *                                                                                     BUG23325
     C           BBCOLC    IFNE EWCTRT                                                      BUG23325
     C                     MOVE 'E'       WELGTX                                            BUG23325
     C                     MOVE *ON       *IN75                                             BUG23325
     C                     ELSE                                                             BUG23325
      *                                                                                     BUG23325
     C           CER048    IFEQ 'Y'                                                         BUG23325
      *                                                                                     BUG23325
     C                     MOVE *ON       *IN76                                             BUG23325
      *                                                                                     BUG23325
     C           EWTHMD    IFEQ 'Y'                                                         BUG23325
     C                     MOVE 'G'       WELGTX                                            BUG23325
     C                     ELSE                                                             BUG23325
     C                     MOVE 'L'       WELGTX                                            BUG23325
     C                     ENDIF                                                            BUG23325
      *                                                                                     BUG23325
     C                     ELSE                                                             BUG23325
     C                     MOVE *OFF      *IN76                                             BUG23325
     C                     MOVE 'G'       WELGTX                                            BUG23325
     C                     ENDIF                                                            BUG23325
      *                                                                                     BUG23325
     C                     ENDIF                                                            BUG23325
      *                                                                                     BUG23325
      ** Retrive record from Customer income file                                           BUG23325
      *                                                                                     BUG23325
     C           CER048    IFEQ 'Y'                                                         BUG23325
     C           WELGTX    ANDEQ'G'                                                         BUG23325
      *                                                                                     BUG23325
     C                     RESETWSGINT                                                      BUG23325
     C                     RESETWSTXSR                                                      BUG23325
     C                     RESETWSSTDO                                                      BUG23325
     C                     RESETWSTTDO                                                        CER054
     C                     MOVE 'N'       WLOOP   1                                         BUG23325
      *                                                                                     BUG23325
     C                     MOVE 'G'       KMODI   1                                         BUG23325
     C                     MOVE SBRCA     KBRCA   3                                         BUG23325
     C                     MOVE CNUMK     KCNUM   6                                         BUG23325
     C                     MOVE SCCY      KCCY    3                                         BUG23325
     C                     MOVE ACODK     KACOD  100                                        BUG23325
     C                     MOVE ACSQK     KACSQ   20                                        BUG23325
     C           E5JATP    IFEQ 'Y'                                                         AR763412
     C                     SETON                     82                                     AR763412
     C                     ELSE                                                             AR763412
     C                     SETOF                     82                                     AR763412
     C                     ENDIF                                                            AR763412
      *                                                                                     BUG23325
     C********** WKEY1     SETLLSDCSINLG                                           BUG23325 AR763412
     C********** WKEY1     READESDCSINLG                 88                        BUG23325 AR763412
     C  N82      WKEY1     SETLLSDCSINLG                                                    AR763412
     C  N82      WKEY1     READESDCSINLG                 88                                 AR763412
     C   82      WKEY1     SETLLSDCSINLL                                                    AR763412
     C   82      WKEY1     READESDCSINLL                 88                                 AR763412
      *                                                                                     BUG23325
     C           *IN88     DOWEQ*OFF                                                        BUG23325
      *                                                                                     BUG23325
     C           E5JATP    IFEQ 'I'                                                         AR763412
     C           TSJOIN    ANDEQ*BLANKS                                                     AR763412
     C           E5JATP    OREQ 'Y'                                                         AR763412
     C                     ADD  TSGINT    WSGINT 150                                        BUG23325
     C                     ADD  TSTXSR    WSTXSR 150                                        BUG23325
     C                     ADD  TSSTDO    WSSTDO 150                                        BUG23325
     C                     ADD  TSTTDO    WSTTDO 150                                          CER054
     C                     MOVE 'Y'       WLOOP                                             BUG23325
     C                     ENDIF                                                            AR763412
      *                                                                                     BUG23325
     C********** WKEY1     READESDCSINLG                 88                        BUG23325 AR763412
     C  N82      WKEY1     READESDCSINLG                 88                                 AR763412
     C   82      WKEY1     READESDCSINLL                 88                                 AR763412
      *                                                                                     BUG23325
     C                     ENDDO                                                            BUG23325
      *                                                                                     BUG23325
     C********** WLOOP     IFEQ 'N'                                                BUG23325 BUG26363
     C**********           MOVE *OFF      *IN76                                    BUG23325 BUG26363
     C**********           ELSE                                                    BUG23325 BUG26363
     C           WLOOP     IFEQ 'Y'                                                         BUG26363
     C                     Z-ADDWSGINT    PTOTI                                             BUG23325
     C                     Z-ADDWSTXSR    EUTAX0                                            BUG23325
     C                     ADD  WSSTDO    EUTAX0                                            BUG23325
      *                                                                                       CER054
     C           CER054    IFEQ 'Y'                                                           CER054
     C                     ADD  WSTTDO    EUTAX0                                              CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER054
     C                     MOVE *ON       *IN29                                             BUG23987
     C                     ENDIF                                                            BUG23325
      *                                                                                     BUG23325
     C                     ENDIF                                                            BUG23325
      *                                                                                     BUG23325
     C           RHISD     IFLT EWEDT1                                                        234034
     C           WELGTX    OREQ 'G'                                                         BUG23325
     C                     MOVE 'Y'       WSKIP   1                                           234034
     C                     ELSE                                                               234034
     C                     MOVE 'N'       WSKIP                                               234034
     C                     ENDIF                                                              234034
      *                                                                                       234034
     C                     ENDSR                                                              234034
      *****************************************************************                       234034
      /EJECT                                                                                  CGL031
      *****************************************************************                       CGL031
      *                                                               *                       CGL031
      *  SREUTX - Subroutine to calculate European Withholding Tax    *                       CGL031
      *                                                               *                       CGL031
      *****************************************************************                       CGL031
     C           SREUTX    BEGSR                                                              CGL031
      *                                                                                       CGL031
      ** Initialise parameter fields (Input)                                                  CGL031
      *                                                                                       CGL031
     C                     MOVE *BLANKS   PMODI   1                                           CGL031
     C**********           MOVE *BLANKS   PTRRF  18                                    CGL031 CGL035
     C                     MOVE *BLANKS   PTRRF  24                                           CGL035
     C                     MOVE *BLANKS   PBRCA   3                                           CGL031
     C                     MOVE *BLANKS   PJANO   6                                           CGL031
     C                     MOVE *BLANKS   PCUST   6                                           CGL031
     C                     MOVE *BLANKS   PNARF  10                                           CGL031
     C                     MOVE *BLANKS   PINVP  10                                           CGL031
     C                     Z-ADD*ZERO     PSTRD   50                                          CGL031
     C                     Z-ADD*ZERO     PENDD   50                                          CGL031
     C                     Z-ADD*ZERO     PTOTI  150                                          CGL031
     C                     Z-ADD*ZERO     PTAXR   64                                          CGL031
     C                     MOVE *BLANK    POCCY   3                                           CGL031
      *                                                                                       CGL031
      ** Initialise parameter fields (Output)                                                 CGL031
      *                                                                                       CGL031
     C                     Z-ADD*ZERO     PIAED  150                                          CGL031
     C                     Z-ADD*ZERO     PTAXA  150                                          CGL031
     C                     Z-ADD*ZERO     PTOTO  150                                          CGL031
     C                     MOVE *BLANKS   PTXCY   3                                           CGL031
     C                     MOVE *BLANKS   PCTAX   2                                           CGL031
     C                     MOVE *BLANKS   PTXBS   2                                           CGL031
     C**********           Z-ADD*ZERO     PWTAC   40                                   CGL031 CGL035
     C                     Z-ADD*ZERO     PWTAC  100                                          CGL035
     C                     MOVE *BLANKS   PCOLC   2                                           CGL031
     C                     MOVE *BLANKS   PSTAT   5                                           CGL031
     C                     MOVE *BLANKS   PTRTE   1                                           CGL031
     C                     Z-ADD*ZERO     PTXR1   64                                          CGL031
     C                     MOVE *BLANKS   PKEY   10                                           CGL031
     C                     MOVE *BLANKS   PFILE  10                                           CGL031
     C                     MOVE *BLANKS   PRTRN   7                                           CGL031
      *                                                                                       CGL031
      ** Initialise working variables                                                         CGL031
      *                                                                                       CGL031
     C                     Z-ADD*ZERO     WWTAXA 150                                          CGL031
     C                     Z-ADD*ZERO     WSTAXA 150                                          CER048
     C                     Z-ADD*ZERO     WTTAXA 150                                          CER054
     C                     MOVE CNUMK     WCNUMK  6                                           CGL031
      *                                                                                       CGL031
     C                     MOVE WCNUMK    ZCNUMK                                              CGL031
     C                     MOVE SCCY      ZCCY                                                CGL031
     C                     MOVE ACODK     ZCODK                                               CGL031
     C                     MOVE ACSQK     ZCSQK                                               CGL031
     C                     MOVE SBRCA     ZBRCA                                               CGL031
     C                     MOVE *BLANKS   PINTH                                             BUG23325
      *                                                                                     BUG23126
     C           CER048    IFEQ 'Y'                                                         BUG23126
     C           WELGTX    ANDEQ'L'                                                         BUG23325
      *                                                                                     BUG23126
     C           ACCKEY    CHAINACCNTBXC             50                                     BUG23126
     C           *IN50     IFEQ *OFF                                                        BUG23126
     C           ATITAX    IFEQ 'A'                                                           CER069
     C                     EXSR SRACTX                                                        CER069
     C                     ENDIF                                                              CER069
     C                     MOVE ATITAX    PINTH                                             BUG23126
     C                     ELSE                                                             BUG23126
     C                     MOVE *BLANKS   PINTH                                             BUG23126
     C                     ENDIF                                                            BUG23126
      *                                                                                     BUG23126
     C                     ENDIF                                                            BUG23126
      *                                                                                     AR784694
      ** Convert the neg. accum. crd. int. to positive thus positive tax amount             AR784694
      *                                                                                     AR784694
     C           SCRIN0    MULT -1        WSCRN0                                            AR784694
      *                                                                                       CGL031
      ** Call RPG/ZATXCLPI                                                                    CGL031
      *                                                                                       CGL031
     C                     CALL 'ZATXCLPI'                                                    CGL031
     C                     PARM 'G'       PMODI                                               CGL031
     C                     PARM ZTRRF     PTRRF                                               CGL031
     C                     PARM SBRCA     PBRCA                                               CGL031
     C                     PARM WCNUMK    PCUST                                               CGL031
     C                     PARM RHISD     PSTRD                                               CGL031
     C                     PARM RUND      PENDD                                               CGL031
     C**********           PARM SCRIN0    PTOTI                                      CGL031 AR784694
     C                     PARM WSCRN0    PTOTI                                             AR784694
     C                     PARM *ZERO     PTAXR                                               CGL031
     C                     PARM SCCY      POCCY                                               CGL031
     C**********           PARM 'T'       PINTH   1                                 CER048  BUG23126
     C                     PARM           PINTH   1                                         BUG23126
     C                     PARM           PIAED                                               CGL031
     C                     PARM           PTAXA                                               CGL031
     C                     PARM           PTOTO                                               CGL031
     C                     PARM           PTXCY                                               CGL031
     C                     PARM           PCTAX                                               CGL031
     C                     PARM           PTXBS                                               CGL031
     C                     PARM           PWTAC                                               CGL031
     C                     PARM           PCOLC                                               CGL031
     C                     PARM           PSTAT                                               CGL031
     C                     PARM           PTRTE                                               CGL031
     C                     PARM           PTXR1                                               CGL031
     C**********           PARM *ZERO     PSTXB   20                                 CER048 BUG22911
     C**********           PARM *ZERO     PSTAC  100                                 CER048 BUG22911
     C**********           PARM *ZERO     PSTTR   64                                 CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP   1                                  CER048 BUG22911
     C**********           PARM *ZERO     PSTXA  150                                 CER048 BUG22911
     C                     PARM           PKEY                                                CGL031
     C                     PARM           PFILE                                               CGL031
     C                     PARM           PRTRN                                               CGL031
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       CGL031
      ** If Return Code = *Blanks and PSTAT = 'TAXAB'                                         CGL031
      ** cumulate PTAXA to WWTAXA                                                             CGL031
      *                                                                                       CGL031
     C           PRTRN     IFEQ *BLANKS                                                       CGL031
     C           PSTAT     ANDEQ'TAXAB'                                                       CGL031
     C                     Z-ADDPTAXA     WWTAXA                                              CGL031
     C           CER048    IFEQ 'Y'                                                         BUG23325
     C           WELGTX    ANDEQ'L'                                                         BUG23325
     C**********           Z-ADDPSTXA     WSTAXA                                     CER048 BUG23325
     C                     ADD  PSTXA     WWTAXA                                            BUG23325
      *                                                                                       CER054
     C           CER054    IFEQ 'Y'                                                           CER054
     C                     ADD  PTTXA     WWTAXA                                              CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER054
     C                     ENDIF                                                            BUG23325
     C                     MOVE *ON       *IN29                                               CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
      ** If Return Code = 'ERROR', perform DB error management                                CGL031
      *                                                                                       CGL031
     C           PRTRN     IFEQ 'ERROR  '                                                     CGL031
     C           *LOCK     IN   LDA                                                           CGL031
     C                     MOVE PFILE     DBFILE           ***************                    CGL031
     C                     MOVE PKEY      DBKEY            * DBERROR 020 *                    CGL031
     C                     Z-ADD020       DBASE            ***************                    CGL031
     C                     OUT  LDA                                                           CGL031
     C                     MOVE *OFF      *IN89                                               CGL031
     C                     EXSR DBSR                                                          CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
      ** If Return Code = 'JOINT', process LF/SDJACCLB                                        CGL031
      *                                                                                       CGL031
     C           PRTRN     IFEQ 'JOINT  '                                                     CGL031
      *                                                                                       CGL031
     C           WCNUMK    SETLLSDJACCLB                                                      CGL031
     C           WCNUMK    READESDJACCLB                 05                                   CGL031
     C********** *IN05     DOWEQ*OFF                                                 CGL031 BUG25942
     C           *IN05     DOUEQ*ON                                                         BUG25942
      *                                                                                     BUG25942
     C           *IN05     IFEQ *ON                                                         BUG25942
     C                     MOVELWCNUMK    JCCUST                                            BUG25942
     C                     MOVE *BLANKS   JCNAHO                                            BUG25942
     C                     MOVE *BLANKS   JCINVP                                            BUG25942
     C                     MOVEL'1/1'     JCINVP                                            BUG25942
     C                     ENDIF                                                            BUG25942
      *                                                                                     BUG25942
     C                     EXSR SRJACC                                                        CGL031
     C           WCNUMK    READESDJACCLB                 05                                   CGL031
      *                                                                                       CGL031
     C           PRTRN     IFEQ 'LAST   '                                                     CGL031
     C                     MOVE *ON       *IN05                                               CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C                     ENDDO                                                              CGL031
      *                                                                                       CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C                     Z-ADDWWTAXA    EUTAX0                                              CGL031
      *                                                                                     BUG23325
     C           CER048    IFEQ 'Y'                                                         BUG23325
     C           WELGTX    ANDEQ'L'                                                         BUG23325
     C                     ADD  WSTAXA    EUTAX0                                            BUG23325
     C                     ENDIF                                                            BUG23325
      *                                                                                     BUG23325
     C**********           Z-ADDWSTAXA    SSTAX0                                     CER048 BUG23325
      *                                                                                       CGL031
     C                     ENDSR                                                              CGL031
      ********************************************************************                    CGL031
      /EJECT                                                                                  CGL031
      *****************************************************************                       CGL031
      *                                                               *                       CGL031
      *  SRJACC - Subroutine to process records fr SDJACCL1/SDJACCL3  *                       CGL031
      *                                                               *                       CGL031
      *****************************************************************                       CGL031
     C           SRJACC    BEGSR                                                              CGL031
      *                                                                                       CGL031
      ** Call RPG/ZATXCLJA                                                                    CGL031
      *                                                                                       CGL031
     C                     CALL 'ZATXCLJA'                                                    CGL031
     C                     PARM 'G'       PMODI                                               CGL031
     C                     PARM ZTRRF     PTRRF                                               CGL031
     C                     PARM SBRCA     PBRCA                                               CGL031
     C                     PARM WCNUMK    PJANO                                               CGL031
     C                     PARM JCCUST    PCUST                                               CGL031
     C                     PARM JCNAHO    PNARF                                               CGL031
     C                     PARM JCINVP    PINVP                                               CGL031
     C                     PARM JCPAHT    PPAHT   1                                         BUG26839
     C                     PARM RHISD     PSTRD                                               CGL031
     C                     PARM RUND      PENDD                                               CGL031
     C**********           PARM SCRIN0    PTOTI                                      CGL031 AR784694
     C                     PARM WSCRN0    PTOTI                                             AR784694
     C                     PARM *ZERO     PTAXR                                               CGL031
     C                     PARM SCCY      POCCY                                               CGL031
     C**********           PARM 'T'       PINTH   1                                  CER048 BUG23126
     C                     PARM           PINTH                                             BUG23126
     C                     PARM           PIAED                                               CGL031
     C                     PARM           PTAXA                                               CGL031
     C                     PARM           PTOTO                                               CGL031
     C                     PARM           PTXCY                                               CGL031
     C                     PARM           PCTAX                                               CGL031
     C                     PARM           PTXBS                                               CGL031
     C                     PARM           PWTAC                                               CGL031
     C                     PARM           PCOLC                                               CGL031
     C                     PARM           PSTAT                                               CGL031
     C                     PARM           PTRTE                                               CGL031
     C                     PARM           PTXR1                                               CGL031
     C                     PARM           PJAMG   1                                           CGL031
     C**********           PARM *ZERO     PSTXB                                      CER048 BUG22911
     C**********           PARM *ZERO     PSTAC                                      CER048 BUG22911
     C**********           PARM *ZERO     PSTTR                                      CER048 BUG22911
     C**********           PARM *BLANKS   PSTTP                                      CER048 BUG22911
     C**********           PARM *ZERO     PSTXA                                      CER048 BUG22911
     C                     PARM           PKEY                                                CGL031
     C                     PARM           PFILE                                               CGL031
     C**********           PARM           PRTRN                                      CGL031 BUG22953
     C                     PARM *BLANKS   PRTRN                                             BUG22953
     C           SDTXPA    PARM SDTXPA    DSSDY                                             BUG22911
      *                                                                                       CGL031
      ** If Return Code = 'LAST ' or *Blank, Add PTAXA to WWTAXA                              CGL031
      *                                                                                       CGL031
     C           PRTRN     IFEQ 'LAST   '                                                     CGL031
     C           PRTRN     OREQ *BLANKS                                                       CGL031
     C           PRTRN     OREQ 'TAXAB'                                                     BUG22953
     C                     ADD  PTAXA     WWTAXA                                              CGL031
     C           CER048    IFEQ 'Y'                                                         BUG23325
     C           WELGTX    ANDEQ'L'                                                         BUG23325
     C**********           ADD  PSTXA     WSTAXA                                     CER048 BUG23325
     C                     ADD  PSTXA     WWTAXA                                            BUG23325
      *                                                                                       CER054
     C           CER054    IFEQ 'Y'                                                           CER054
     C                     ADD  PTTXA     WWTAXA                                              CER054
     C                     ENDIF                                                              CER054
      *                                                                                       CER054
     C                     ENDIF                                                            BUG23325
     C                     MOVE *ON       *IN29                                               CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
      ** If Return Code = 'ERROR', perform DB error                                           CGL031
      *                                                                                       CGL031
     C           PRTRN     IFEQ 'ERROR  '                                                     CGL031
     C           *LOCK     IN   LDA                                                           CGL031
     C                     MOVE PFILE     DBFILE           ***************                    CGL031
     C                     MOVE PKEY      DBKEY            * DBERROR 021 *                    CGL031
     C                     Z-ADD021       DBASE            ***************                    CGL031
     C                     OUT  LDA                                                           CGL031
     C                     MOVE *OFF      *IN89                                               CGL031
     C                     EXSR DBSR                                                          CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CGL031
     C                     ENDSR                                                              CGL031
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** WTAXSR subroutine to calculate withholding Tax on Credit interest
     C**
     C**     Called by     MAIN
     C**     Calls
     C**
     C           WTAXSR    BEGSR                           **WTAXSR BEGSR*
     C*
     C** ACCESS ICD WITHHOLDING TAX (SDSTAXPD)
     C*
     C           1         SETLLSDSTAXPD
     C                     READ SDSTAXPD                 99
     C*
     C** ERROR IN SDSTAXPD
     C*
     C           *IN99     IFEQ '1'                        - B1
     C                     Z-ADD1         DBASE            ***************
     C                     MOVE 'STAXP'   DBFILE           **DB ERROR 01**
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     MOVEA'0'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C                     Z-ADD0         WTXTOT 150
     C                     Z-ADD0         WTAX   150
     C                     Z-ADD0         SWTAX0
      *                                                                                       CDL013
      ** If CDL013 installed, calculate WHT amount                                            CDL013
     C           CDL013    IFEQ '1'                                                           CDL013
      *                                                                                       CDL013
      ** Access account details extension file                                                CDL013
     C           RETKEY    CHAINACCNTE               74                                       CDL013
      *                                                                                       CDL013
      ** If CHAIN failed, terminate the program                                               CDL013
     C           *IN74     IFEQ '1'                                                           CDL013
     C           *LOCK     IN   LDA                                                           CDL013
     C                     Z-ADD19        DBASE            ************                       CDL013
     C                     MOVEL'ACCNTBY0'DBFILE           * DBERR 19 *                       CDL013
     C                     MOVELRKEY      DBKEY            ************                       CDL013
     C                     OUT  LDA                                                           CDL013
     C                     MOVE *OFF      *IN89                                               CDL013
     C                     EXSR DBSR                                                          CDL013
     C                     ENDIF                                                              CDL013
     C/COPY WNCPYSRC,REH00001
      *                                                                                       CDL013
      ** Set WHT rate                                                                         CDL013
     C                     SELEC                                                              CDL013
     C           ATITAX    WHEQ '0'                                                           CDL013
     C**********           Z-ADD0         WRATE   52                                   CDL013 CER059
     C                     Z-ADD0         WRATE                                               CER059
     C           ATITAX    WHEQ '1'                                                           CDL013
     C                     Z-ADDETXR1     WRATE                                               CDL013
     C           ATITAX    WHEQ '2'                                                           CDL013
     C                     Z-ADDETXR2     WRATE                                               CDL013
     C           ATITAX    WHEQ '3'                                                           CDL013
     C                     Z-ADDETXR3     WRATE                                               CDL013
     C           ATITAX    WHEQ '4'                                                           CDL013
     C                     Z-ADDETXR4     WRATE                                               CDL013
     C           ATITAX    WHEQ '5'                                                           CDL013
     C                     Z-ADDETXR5     WRATE                                               CDL013
     C           ATITAX    WHEQ '6'                                                           CDL013
     C                     Z-ADDETXR6     WRATE                                               CDL013
     C           ATITAX    WHEQ '7'                                                           CDL013
     C                     Z-ADDETXR7     WRATE                                               CDL013
     C           ATITAX    WHEQ '8'                                                           CDL013
     C                     Z-ADDETXR8     WRATE                                               CDL013
     C           ATITAX    WHEQ '9'                                                           CDL013
     C                     Z-ADDETXR9     WRATE                                               CDL013
     C                     ENDSL                                                              CDL013
     C/COPY WNCPYSRC,REH00003
      *                                                                                       CDL013
      ** If WHT rate is NOT 0, calculate Interest amount.                                     CDL013
     C           WRATE     IFNE 0                                                             CDL013
      *                                                                                       CDL013
      ** If Retail Netting of Debit Interest is 'Y' AND                                       CDL013
      ** Next Debit int.cap.date is Next Credit int.cap.date,                                 CDL013
      ** Interest amount is Credit Acrrued Int. minus Debit Acrrued Int                       CDL013
     C           TXWNDI    IFEQ 'Y'                                                           CDL013
     C           NDID      ANDEQNCID                                                          CDL013
     C           CAIC      SUB  DAIC      WTXTOT                                              CDL013
      *                                                                                       CDL013
      ** Otherwise, Interest amount is Credit Acrrued Int.                                    CDL013
     C                     ELSE                                                               CDL013
     C                     Z-ADDCAIC      WTXTOT                                              CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
      ** If Interest amount is GT 0, calculate WHT.                                           CDL013
     C           WTXTOT    IFGT 0                                                             CDL013
      *                                                                                       CDL013
      ** If Deal Ccy is equal to Base Ccy                                                     CDL013
      ** and CDL081 is off                                                                    CDL081
      *                                                                                       CDL081
     C           ATCCY     IFEQ BJCYCD                                                        CDL013
     C           CDL081    ANDEQ'N'                                                           CDL081
      *                                                                                       CDL013
      ** Set work adjustment field according to decimal places.                               CDL013
     C                     SELEC                                                              CDL013
     C           CDP       WHEQ 0                                                             CDL013
     C                     Z-ADD1         WADJ    40                                          CDL013
     C           CDP       WHEQ 1                                                             CDL013
     C                     Z-ADD10        WADJ                                                CDL013
     C           CDP       WHEQ 2                                                             CDL013
     C                     Z-ADD100       WADJ                                                CDL013
     C           CDP       WHEQ 3                                                             CDL013
     C                     Z-ADD1000      WADJ                                                CDL013
     C                     ENDSL                                                              CDL013
     C/COPY WNCPYSRC,REH00004
      *                                                                                       CDL013
      ** Round down Interest amount                                                           CDL013
     C           WTXTOT    DIV  WADJ      SWTAX0                                              CDL013
     C           SWTAX0    MULT WADJ      WTXTOT                                              CDL013
     C/COPY WNCPYSRC,REH00005
      *                                                                                       CDL013
      ** Calculate and then round down WHT                                                    CDL013
     C           WTXTOT    MULT WRATE     SWTAX0                                              CDL013
     C                     DIV  100       SWTAX0                                              CDL013
     C/COPY WNCPYSRC,REH00006
     C           SWTAX0    DIV  WADJ      WTXTOT                                              CDL013
     C           WTXTOT    MULT WADJ      SWTAX0                                              CDL013
     C/COPY WNCPYSRC,REH00007
      *                                                                                       CDL013
      ** If Deal Ccy is NOT equal to Base Ccy                                                 CDL013
     C                     ELSE                                                               CDL013
      *                                                                                       CDL013
      ** Calculate WHT without rounding down.                                                 CDL013
     C           WTXTOT    MULT WRATE     SWTAX0                                              CDL013
      *                                                                                       CDL081
      ** Check if tax amount will be rounded down                                             CDL081
      *                                                                                       CDL081
     C           ATCCY     IFEQ BJCYCD                                                        CDL081
     C           CDL081    ANDEQ'Y'                                                           CDL081
     C           W#BSRD    ANDEQ'Y'                                                           CDL081
     C           ATCCY     ORNE BJCYCD                                                        CDL081
     C           CDL081    ANDEQ'Y'                                                           CDL081
     C           W#NBRD    ANDEQ'Y'                                                           CDL081
     C                     DIV  100       SWTAX0                                              CDL081
     C                     ELSE                                                               CDL081
     C                     DIV  100       SWTAX0    H                                         CDL013
     C                     ENDIF                                                              CDL081
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
     C/COPY WNCPYSRC,REH00002
      *                                                                                       CDL013
      ** If CDL013 NOT installed                                                              CDL013
     C                     ELSE                                                               CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3360CCP5                                           S01408
     C*                                                                   S01408
     C*
     C           ACCKEY    CHAINACCNTBXC             99                   174820
      *                                                                                       CER069
      ** If Tax value at Account level is 'A', this means the EU Tax                          CER069
      ** indicator at Customer level should be used to determine whether                      CER069
      ** the account is taxable.                                                              CER069
      *                                                                                       CER069
     C           *IN99     IFEQ '0'                                                           CER069
     C           ATITAX    ANDEQ'A'                                                           CER069
     C                     EXSR SRACTX                                                        CER069
     C                     ENDIF                                                              CER069
      *                                                                                       CER069
     C           *IN99     IFEQ '1'                                       174820
     C           ATITAX    OREQ 'N'                                       174820
     C                     ELSE                                           174820
     C           TXWNDI    IFEQ 'Y'
     C           NDID      ANDEQNCID
     C           CAIC      SUB  DAIC      WTXTOT
     C/COPY WNCPYSRC,REH00442
      *                                                                                       206669
      ** Also take into consideration the generated adjustments and                           206669
      ** manual adjustments to accrued interests.                                             206669
      *                                                                                       206669
     C                     ADD  MACI      WTXTOT                                              206669
     C                     SUB  MADI      WTXTOT                                              206669
     C                     ADD  GACI      WTXTOT                                              206669
     C                     SUB  GADI      WTXTOT                                              206669
     C/COPY WNCPYSRC,REH00387
     C*
     C           WTXTOT    IFGT 0
     C/COPY WNCPYSRC,REH00388
     C           WTXTOT    MULT TXWTRR    WTAX
     C           WTAX      DIV  100       SWTAX0
     C/COPY WNCPYSRC,REH00389
     C                     END
     C*
     C                     END
     C*
     C           TXWNDI    IFEQ 'N'
     C           NDID      ORNE NCID
     C                     Z-ADDCAIC      WTXTOT
     C/COPY WNCPYSRC,REH00443
      *                                                                                       206669
      ** Also take into consideration the generated adjustments and                           206669
      ** manual adjustment to accrued interests.                                              206669
      *                                                                                       206669
     C                     ADD  MACI      WTXTOT                                              206669
     C                     ADD  GACI      WTXTOT                                              206669
     C/COPY WNCPYSRC,REH00390
     C*
     C           WTXTOT    IFGT 0
     C/COPY WNCPYSRC,REH00444
     C           WTXTOT    MULT TXWTRR    WTAX
     C           WTAX      DIV  100       SWTAX0
     C/COPY WNCPYSRC,REH00391
     C                     END
     C*
     C                     END
     C                     END                                            174820
      *                                                                                       CDL013
     C                     ENDIF                                                              CDL013
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3360CCP6                                           S01408
     C*                                                                   S01408
     C*
     C                     ENDSR                           **WTAXSR ENDSR*
     C/COPY WNCPYSRC,REH00392
     C*
     C********************************************************************
     C/EJECT
     C/COPY ZSRSRC,ZICDREZ2                                                                   220323
     C*****************************************************************                       220323
     C**********                                                                              220323
     C***ZICD*subroutine*to*find*number*of*days*to*calculate*interest**                       220323
     C********according*to*calculation*basis***************************                       220323
     C**********                                                                              220323
     C*******Called*by*******ZIC00,*ZIC01,*ZIC02***********************                       220323
     C*******Calls***********DBSR**************************************                       220323
     C**********                                                                              220323
     C********** ZICD      BEGSR                           **ZICD BEGSR**                     220323
     C**********                                                                              220323
     C***TO*DETERMINE*NUMBER*OF*DAYS*INTEREST*TO*BE*CALCULATED*********                       220323
     C**********                                                                              220323
     C********** ZIEND     SUB  ZIBEG     ZDAYN2                                              220323
     C**********                                                                              220323
     C***CHECK*FOR*INTEREST*CALCULATION*BASIS**************************                       220323
     C**********                                                                              220323
     C********** ZICALC    IFEQ 3                          - B1                               220323
     C********** ZIEND     IFGT ZIBEG                      - B2                               220323
     C**********                                                                              220323
     C***CALCULATING*DATE*FROM*DAY*NUMBER*(BEGINNING*DATE)*************                       220323
     C**********                                                                              220323
     C**********           Z-ADDZIBEG     ZDAYNO                                              220323
     C**********           EXSR ZDATE2                                                        220323
     C**********                                                                              220323
     C***VERIFY*IF*ERROR***********************************************                       220323
     C**********                                                                              220323
     C********** *IN99     IFEQ '1'                        - B3                               220323
     C********** *LOCK     IN   LDA                                                           220323
     C**********           Z-ADD090       DBASE            ***************                    220323
     C**********           MOVE 'ZDATE2'  DBFILE           * DBERROR 090 *                    220323
     C**********           MOVE *BLANKS   DBKEY            ***************                    220323
     C**********           OUT  LDA                                                           220323
     C**********           MOVEA'1'       *IN,89                                              220323
     C**********           EXSR DBSR                                                          220323
     C**********           END                             - E3                               220323
     C**********                                                                              220323
     C********** *IN98     IFEQ '0'                        - B3                        088029 220323
     C**********           Z-ADDZDATE     SRES                                                220323
     C**********           ELSE                            - X3                        088029 220323
     C**********           Z-ADDZDATE     SRESX                                        088029 220323
     C**********           Z-ADDZISDX     ZISD                                         088029 220323
     C**********           Z-ADDZISMX     ZISM                                         088029 220323
     C**********           Z-ADDZISYX     ZISY                                         088029 220323
     C**********           END                             - E3                        088029 220323
     C**********                                                                              220323
     C***CALCULATING*DATE*FROM*DAY*NUMBER*(FINISHING*DATE)*************                       220323
     C**********                                                                              220323
     C**********           Z-ADDZIEND     ZDAYNO                                              220323
     C**********           EXSR ZDATE2                                                        220323
     C**********                                                                              220323
     C***VERIFY*IF*ERROR***********************************************                       220323
     C**********                                                                              220323
     C********** *IN99     IFEQ '1'                        - B3                               220323
     C********** *LOCK     IN   LDA                                                           220323
     C**********           Z-ADD091       DBASE            ***************                    220323
     C**********           MOVE 'ZDATE2'  DBFILE           * DBERROR 091 *                    220323
     C**********           MOVE *BLANKS   DBKEY            ***************                    220323
     C**********           OUT  LDA                                                           220323
     C**********           MOVEA'1'       *IN,89                                              220323
     C**********           EXSR DBSR                                                          220323
     C**********           END                             - E3                               220323
     C**********                                                                              220323
     C********** *IN98     IFEQ '0'                        - B3                        088029 220323
     C**********           Z-ADDZDATE     FRES                                                220323
     C**********           ELSE                            - X3                        088029 220323
     C**********           Z-ADDZDATE     FRESX                                        088029 220323
     C**********           Z-ADDZIFDX     ZIFD                                         088029 220323
     C**********           Z-ADDZIFMX     ZIFM                                         088029 220323
     C**********           Z-ADDZIFYX     ZIFY                                         088029 220323
     C**********           END                             - E3                        088029 220323
     C**********                                                                              220323
     C***IN*ORDER*FOR*THE*FINISH*YEAR*TO*BE*LESS*THAN*THE*START*YEAR*IF*ZIEND                 220323
     C***IS*GREATER*THAN*ZIBEG,*THEN*THE*DATE*ZIEND*MUST*BE*IN*A*DIFFERENT                    220323
     C***CENTURY*TO*ZIBEG.*IF*SO*ADD*100*YEARS*TO*IT.******************                       220323
     C**********                                                                              220323
     C********** ZIFY      IFLT ZISY                       - B3                               220323
     C********** ZIFY      ADD  100       ZIFY2                                               220323
     C**********           ELSE                            - X3                               220323
     C**********           Z-ADDZIFY      ZIFY2                                               220323
     C**********           END                             - E3                               220323
     C**********                                                                              220323
     C**********           Z-ADDZISY      ZISY2                                               220323
     C**********                                                                              220323
     C***DETERMINE*WHETHER*START*YEAR*IS*A*LEAP*YEAR*AND*IF*START*MONTH                       220323
     C***IS*FEBRUARY**THEN*CONSIDER*LAST*DAY*OF*FEBRUARY*AS*DATE*30ND.*                       220323
     C***OF*THE*MONTH**************************************************                       220323
     C**********                                                                              220323
     C********** ZISM      IFEQ 2                          - B3                               220323
     C********** ZISY2     ADD  1900      ZLYCHK                                              220323
     C********** ZLYCHK    DIV  4         ZLYCHK                                              220323
     C**********           MVR            ZLYREM                                              220323
     C********** ZLYREM    IFEQ 0                          - B4                               220323
     C********** ZISD      IFEQ 29                         - B5                               220323
     C**********           Z-ADD30        ZISD                                                220323
     C**********           END                             - E5                               220323
     C**********           ELSE                            - X4                               220323
     C********** ZISD      IFEQ 28                         - B5                               220323
     C**********           Z-ADD30        ZISD                                                220323
     C**********           END                             - E5                               220323
     C**********           END                             - E4                               220323
     C**********           END                             - E3                               220323
     C**********                                                                              220323
     C********** 30        SUB  ZISD      ZID1                                                220323
     C**********                                                                              220323
     C********** ZID1      IFLT 0                          - B3                               220323
     C**********           Z-ADD*ZEROS    ZID1                                                220323
     C**********           END                             - E3                               220323
     C**********                                                                              220323
     C********** ZISM      IFEQ 12                         - B3                               220323
     C**********           Z-ADD*ZEROS    ZISM                                                220323
     C**********           ADD  1         ZISY                                                220323
     C**********           ADD  1         ZISY2                                               220323
     C**********           END                             - E3                               220323
     C**********                                                                              220323
     C***DETERMINE*WHETHER*END*YEAR*IS*A*LEAP*YEAR*AND*IF*END*MONTH*IS*FEBRUARY               220323
     C**********                                                                              220323
     C********** ZIFM      IFEQ 2                          - B3                               220323
     C********** ZIFY2     ADD  1900      ZLYCHK                                              220323
     C********** ZLYCHK    DIV  4         ZLYCHK                                              220323
     C**********           MVR            ZLYREM                                              220323
     C********** ZLYREM    IFEQ 0                          - B4                               220323
     C********** ZIFD      IFEQ 29                         - B5                               220323
     C**********           Z-ADD30        ZIFD                                                220323
     C**********           END                             - E5                               220323
     C**********           ELSE                            - X4                               220323
     C********** ZIFD      IFEQ 28                         - B5                               220323
     C**********           Z-ADD30        ZIFD                                                220323
     C**********           END                             - E5                               220323
     C**********           END                             - E4                               220323
     C**********           END                             - E3                               220323
     C**********                                                                              220323
     C********** ZIFD      IFEQ 31                         - B3                               220323
     C**********           ADD  30        ZID1                                                220323
     C**********           ELSE                            - X3                               220323
     C**********           ADD  ZIFD      ZID1                                                220323
     C**********           END                             - E3                               220323
     C**********                                                                              220323
     C**********           SUB  1         ZIFM                                                220323
     C**********                                                                              220323
     C********** ZISY      IFEQ ZIFY                       - B3                               220323
     C********** ZIFM      SUB  ZISM      ZINOM                                               220323
     C**********           ELSE                            - X3                               220323
     C********** 12        SUB  ZISM      ZIM1                                                220323
     C**********           Z-ADD1         ZISM                                                220323
     C**********                                                                              220323
     C***USE*ENLARGE*FIELDS*THAT*CAN*HANDLE*1999*ONWARDS***************                       220323
     C**********                                                                              220323
     C**********           ADD  1         ZISY2                                               220323
     C********** ZIFY2     SUB  ZISY2     ZIY1                                                220323
     C********** ZIY1      MULT 12        ZIM2                                                220323
     C********** ZIM2      ADD  ZIFM      ZIM2                                                220323
     C********** ZIM2      ADD  ZIM1      ZINOM                                               220323
     C**********                                                                              220323
     C**********           END                             - E3                               220323
     C**********                                                                              220323
     C********** ZINOM     MULT 30        ZID2                                                220323
     C********** ZID2      ADD  ZID1      ZDAYN2                                              220323
     C**********                                                                              220323
     C**********           END                             - E2                               220323
     C**********                                                                              220323
     C**********           END                             - E1                               220323
     C**********                                                                              220323
     C********** ZICALC    IFEQ 4                          - B1                               220323
     C********** ZICALC    OREQ 5                                                             220323
     C**********                                                                              220323
     C***ONE*DAY*IS*SUBTRACTED*FROM*ZDAYN2*FOR*EACH*OCCURANCE*OF*29*FEB*IN                    220323
     C***THE*INTEREST*CALCULATION*PERIOD*INCLUSIVE*OF*ZIBEG*AND*ZIEND**                       220323
     C**********                                                                              220323
     C***FIND*NO*OF*FOUR*YEAR*PERIODS*BETWEEN*DATES********************                       220323
     C**********                                                                              220323
     C********** ZDAYN2    DIV  1461      ZIMAN                                               220323
     C**********           MVR            ZIREM                                               220323
     C**********                                                                              220323
     C***FIND*NEXT*29*FEB*DAY*NO.*ON*OR*AFTER*ZIBEG.*******************                       220323
     C**********                                                                              220323
     C********** ZIBEG     SUB  60        ZIBW1                                               220323
     C********** ZIBW1     DIV  1461      ZIDW1                                               220323
     C**********           MVR            ZIDREM                                              220323
     C**********                                                                              220323
     C********** ZIDREM    IFEQ 0                          - B2                               220323
     C**********           Z-ADDZIBEG     ZIDW2                                               220323
     C**********           END                             - E2                               220323
     C**********                                                                              220323
     C***ROUND*UP*RESULT***********************************************                       220323
     C**********                                                                              220323
     C********** ZIDW1     ADD  1         ZIDW2                                               220323
     C**********                                                                              220323
     C***CALCULATE*NEXT*29*FEB.****************************************                       220323
     C**********                                                                              220323
     C********** ZIDW2     MULT 1461      ZIDW2                                               220323
     C********** ZIDW2     ADD  60        ZIDW2                                               220323
     C**********                                                                              220323
     C***IF*THIS*NEXT*29*FEB.*DAYNO*-*ZIBEG*IS*GREATER*OR*EQUAL*TO*ZIREM                      220323
     C***THEN*ADD*1*TO*ZIMAN.******************************************                       220323
     C**********                                                                              220323
     C********** ZIDW2     SUB  ZIBEG     ZILPCP                                              220323
     C**********                                                                              220323
     C********** ZIREM     IFGE ZILPCP                     - B2                               220323
     C**********           ADD  1         ZIMAN                                               220323
     C**********           END                             - E2                               220323
     C**********                                                                              220323
     C***SUBTRACT*ZIMAN*FROM*ZDAYN2*TO*GIVE*VALUE*OF*ZDAYN2*REQUIRED*FOR                      220323
     C***THIS*INTEREST*CALCULATION*************************************                       220323
     C**********                                                                              220323
     C********** ZDAYN2    SUB  ZIMAN     ZDAYN2                                              220323
     C**********                                                                              220323
     C**********           END                             - E1                               220323
     C**********                                                                              220323
     C**********           ENDSR                           **ZICD ENDSR**                     220323
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZIC00 subroutine to calculate interest (type=00)
     C**
     C**     Called by       INTCAL
     C**     Calls           ZICD
     C**
     C           ZIC00     BEGSR                           **ZIC00 BEGSR**
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE3360CLD1                                           S01408
     C*                                                                   S01408
     C*
     C** REVERSE SIGN OF AMOUNT IF IT'S NEGATIVE
     C*
     C           ZIAMT     IFLT 0                          - B1
     C                     Z-SUBZIAMT     ZIAMT
     C                     END                             - E1
     C*
     C** FIND NUMBER OF DAYS TO CALCULATE INTEREST ACCORDING TO CALC. BASIS
     C*
     C                     EXSR ZICD
     C*
     C********** ZIAMT     MULT ZDAYN2    WWMULT 150                                          220566
     C********** WWMULT    DIV  100       WWDIV  150H                                         220566
     C********** WWDIV     MULT ZIRATE    WWRATE 150                                          220566
      *                                                                                       220323
      ** For calc basis 6, use the factored number of days                                    220323
      *                                                                                       220323
     C           ZICALC    IFEQ 6                                                             220323
     C           ZIAMT     MULT INT6DY    WWMULT 309                                          220323
      *                                                                                       220323
     C                     ELSE                                                               220323
     C           ZIAMT     MULT ZDAYN2    WWMULT                                              220323
     C                     ENDIF                                                              220323
      *                                                                                       220323
      ** Change field length to prevent 0.01 difference                                       220323
      *                                                                                       220323
     C           WWMULT    MULT ZIRATE    WWMULT                                              220323
     C*
     C********** ZICALC    IFEQ 7                          - B1                             MD035448
     C********** ZICALC    OREQ 5                                                           MD035448
     C********** ZICALC    OREQ 3                                                           MD035448
     C********** ZICALC    OREQ 2                                                           MD035448
     C********** ZICALC    OREQ 0                                                    CER016 MD035448
      *                                                                                       CER016
     C********   ZICALC    IFEQ 0                                                    CER016 MD035448
     C           CER016    IFEQ 'Y'                                                         MD035448
     C           PINTN     ANDEQ'Y'                                                           CER016
     C                     Z-ADDZIAMT     WAMT   150                                          CER016
     C                     Z-ADDZIRATE    WRATE  117                                          CER016
     C                     EXSR SRINT0                                                        CER016
     C                     ELSE                                                               CER016
     C           ZICALC    IFEQ 7                          - B1                             MD035448
     C           ZICALC    OREQ 5                                                           MD035448
     C           ZICALC    OREQ 3                                                           MD035448
     C           ZICALC    OREQ 2                                                           MD035448
     C           ZICALC    OREQ 0                                                           MD035448
      *                                                                                       CER016
     C********** WWRATE    DIV  360       ZIWRK1    H                                         220566
     C*********  ZIAMT     DIV  36000     ZIWRK1    H                                  220566 220323
     C           WWMULT    DIV  36000     ZIWRK1    H                                         220323
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C**********           END                             - E1                             MD035448
     C*
     C           ZICALC    IFEQ 4                          - B1
     C           ZICALC    OREQ 1
     C********** WWRATE    DIV  365       ZIWRK1    H                                         220566
     C********** ZIAMT     DIV  36500     ZIWRK1    H                                  220566 220323
     C           WWMULT    DIV  36500     ZIWRK1    H                                         220323
     C                     END                             - E1
     C*
     C           ZICALC    IFEQ 6                          - B1
     C********** WWRATE    DIV  366       ZIWRK1    H                                         220566
     C********** ZIAMT     DIV  36600     ZIWRK1    H                                  220566 220323
     C           WWMULT    DIV  36600     ZIWRK1    H                                         220323
     C                     END                             - E1
     C                     ENDIF                                                            MD035448
      *                                                                                       CER016
     C********** ZICALC    IFNE 0                                                    CER016 MD035448
     C           CER016    IFNE 'Y'                                                         MD035448
     C           PINTN     ORNE 'Y'                                                           CER016
     C*
     C********** ZIWRK1    MULT ZIRATE    ZIWRK2    H                                  220566 220323
     C********** ZIWRK2    MULT ZDAYN2    ZINTR     H                                         220323
     C***********          Z-ADDZIWRK1    ZINTR                           074578
     C**********           Z-ADDZIWRK1    ZINTR     H                                  074578 220566
     C                     Z-ADDZIWRK1    ZINTR     H                                         220323
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C*
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE3360CLD2                                           S01408
     C*                                                                   S01408
     C                     ENDSR                           **ZIC00 ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZIC01 subroutine to calculate interest (type=01)
     C**
     C**     Called by       INTCAL
     C**     Calls           ZICD
     C**
     C           ZIC01     BEGSR                           **ZIC01 BEGSR**
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE3360CLD3                                           S01408
     C*                                                                   S01408
     C*
     C** REVERSE SIGN OF AMOUNT IF IT'S NEGATIVE
     C*
     C           ZIAMT     IFLT 0                          - B1
     C                     Z-SUBZIAMT     ZIAMT
     C                     END                             - E1
     C*
     C** INITIALIZE WORK FIELDS
     C*
     C                     Z-ADDZIAMT     ZIAMT1
     C                     Z-ADD1         Z
     C                     Z-ADD*ZEROS    ZIAMTR
     C                     Z-ADD*ZEROS    ZIA
     C                     Z-ADD*ZEROS    ZIA1
     C                     Z-ADD*ZEROS    LOOP
     C                     Z-ADD*ZEROS    Y
     C                     Z-ADD*ZEROS    ZIN
     C*
     C***INTEREST*IS*ONLY*CALCULATED*ON*AN*AMOUNT*THAT*EXCEEDS*OR*IS*EQUAL103460
     C***TO*THE*INITIAL*THRESHOLD*BALANCE                                 103460
      *  INTEREST IS ONLY CALCULATED ON AN AMOUNT THAT EXCEEDS THE        103460
      *  INITIAL THRESHOLD BALANCE                                        103460
     C*
     C***********ZIAMT     IFGE ZITHR                      - B1           103460
     C           ZIAMT     IFGT ZITHR                      - B1           103460
     C*
     C** FIND NUMBER OF DAYS TO CALCULATE INTEREST ACCORDING TO CALC. BASIS
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADD0         WOVRIN 117                                        AR823701
     C           LOOP      DOWEQ0                          - B2
     C                     Z-ADDZIAMT1    ZIAMTR
      ** Skip and exit if BAL is -2                                                         AR823701
     C           CER055    IFEQ 'Y'                                                         AR823701
     C           ZIB,Z     IFEQ -2                                                          AR823701
     C                     Z-ADDZIR,Z     WOVRIN                                            AR823701
     C                     Z-ADDZIAMTR    ZIA,Y                                             AR823701
     C                     Z-ADD1         LOOP                                              AR823701
     C                     GOTO SKIP                                                        AR823701
     C                     ENDIF                                                            AR823701
     C                     ENDIF                                                            AR823701
     C*
     C           Z         IFEQ 11                         - B3
     C                     Z-ADDZIAMTR    ZIA,Z
     C                     Z-ADD1         LOOP
     C*
     C                     ELSE                            - X3
     C                     ADD  1         Y
     C                     ADD  1         Z
     C*
     C           ZIB,Z     IFEQ 0                          - B4
     C                     ADD  ZIAMTR    ZIA,Y
     C                     Z-ADD1         LOOP
     C*
     C                     ELSE                            - X4
      ** Skip and exit if BAL is -2                                                         AR823701
     C           CER055    IFEQ 'Y'                                                         AR823701
     C           ZIB,Z     IFEQ -2                                                          AR823701
     C                     Z-ADDZIR,Z     WOVRIN                                            AR823701
     C                     Z-ADDZIAMTR    ZIA,Y                                             AR823701
     C                     Z-ADD1         LOOP                                              AR823701
     C                     GOTO SKIP                                                        AR823701
     C                     ENDIF                                                            AR823701
     C                     ENDIF                                                            AR823701
     C           ZIB,Z     SUB  ZIB,Y     ZBAL
     C           ZIAMTR    SUB  ZBAL      ZIAMT1
     C*
     C           ZIAMT1    IFLE 0                          - B5
     C                     ADD  ZIAMTR    ZIA,Y
     C                     Z-ADD1         LOOP
      ** Skip and exit if BAL is -2                                                         AR823701
     C           CER055    IFEQ 'Y'                                                         AR823701
     C           ZIB,Z     IFEQ -2                                                          AR823701
     C                     Z-ADDZIR,Z     WOVRIN                                            AR823701
     C                     Z-ADDZIAMTR    ZIA,Y                                             AR823701
     C                     Z-ADD1         LOOP                                              AR823701
     C                     GOTO SKIP                                                        AR823701
     C                     ENDIF                                                            AR823701
     C                     ENDIF                                                            AR823701
     C*
     C                     ELSE                            - X5
     C                     ADD  ZBAL      ZIA,Y
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C           SKIP      TAG                                                              AR823701
     C                     END                             - E2
     C*
     C* IF THE SUB-TYPE IS FROM 50000 TO 99999, CALCULATE THE INTEREST
     C* ON THE AMOUNT EXCEEDING THE INITIAL THRESHOLD. OTHERWISE, THE
     C* INTEREST IS CALCULATED ON THE WHOLE BALANCE WHENEVER IT EXCEEDS
     C* THE INITIAL THRESHOLD.
     C*
     C           INST      IFGE 50000                      - B2
     C                     Z-ADD1         Z
     C           Z         DOWLT12                         - B3
     C           ZITHR     ANDGT0
     C           ZIA,Z     SUB  ZITHR     ZIA,Z
     C           ZIA,Z     IFLT 0                          - B4
     C                     Z-SUBZIA,Z     ZITHR
     C                     Z-ADD0         ZIA,Z
     C                     ELSE                            - X4
     C                     Z-ADD0         ZITHR
     C                     END                             - E4
     C                     ADD  1         Z
     C                     END                             - E3
     C                     END                             - E2
     C*
     C/COPY WNCPYSRC,RE3360C026
     C                     MOVEAZIA       ZIA2                                                CER016
     C********** ZIA       MULT ZDAYN2    ZIA                                                 220566
     C********** ZIA       DIV  100       ZIA                                                 220566
     C********** ZIA       MULT ZIR       ZIA                                                 220566
     C*
     C           ZICALC    IFEQ 6                                                             220323
     C           ZIA       MULT INT6DY    ZIA1                                                220323
     C                     ELSE                                                               220323
     C           ZIA       MULT ZDAYN2    ZIA1                                                220323
     C                     ENDIF                                                              220323
     C           ZIA1      MULT ZIR       ZIA1                                                220323
      *                                                                                       220323
     C********** ZICALC    IFEQ 7                          - B2                             MD035448
     C********** ZICALC    OREQ 5                                                           MD035448
     C********** ZICALC    OREQ 3                                                           MD035448
     C********** ZICALC    OREQ 2                                                           MD035448
     C********** ZICALC    OREQ 0                                                    CER016 MD035448
      **********                                                                     CER016 MD035448
     C********** ZICALC    IFEQ 0                                                    CER016 MD035448
     C           CER016    IFEQ 'Y'                                                         MD035448
     C           PINTN     ANDEQ'Y'                                                           CER016
     C                     Z-ADD1         X                                                   CER016
      *                                                                                       CER016
     C           X         DOWLT12                                                            CER016
     C                     Z-ADDZIA2,X    WAMT                                                CER016
     C                     Z-ADDZIR,X     WRATE                                               CER016
     C                     EXSR SRINT0                                                        CER016
     C                     Z-ADDZINTR     ZIN1,X                                              CER016
     C                     ADD  1         X                                                   CER016
     C                     ENDDO                                                              CER016
      *                                                                                       CER016
     C                     XFOOTZIN1      ZINTR                                               CER016
     C                     ELSE                                                               CER016
      *                                                                                       CER016
     C           ZICALC    IFEQ 7                          - B2                             MD035448
     C           ZICALC    OREQ 5                                                           MD035448
     C           ZICALC    OREQ 3                                                           MD035448
     C           ZICALC    OREQ 2                                                           MD035448
     C           ZICALC    OREQ 0                                                           MD035448
     C***********ZIA       DIV  360       ZIN       H                     074578
     C********** ZIA       DIV  360       ZIN1      H                                  074578 220566
     C********** ZIA       DIV  36000     ZIN1      H                                  220566 220323
     C           ZIA1      DIV  36000     ZIN1      H                                         220323
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C*
     C**********           END                             - E2                             MD035448
     C*
     C           ZICALC    IFEQ 4                          - B2
     C           ZICALC    OREQ 1
     C***********ZIA       DIV  365       ZIN       H                     074578
     C********** ZIA       DIV  365       ZIN1      H                                  074578 220566
     C********** ZIA       DIV  36500     ZIN1      H                                  220566 220323
     C           ZIA1      DIV  36500     ZIN1      H                                         220323
     C*
     C                     END                             - E2
     C*
     C           ZICALC    IFEQ 6                          - B2
     C***********ZIA       DIV  366       ZIN       H                     074578
     C********** ZIA       DIV  366       ZIN1      H                                  074578 220566
     C********** ZIA       DIV  36600     ZIN1      H                                  220566 220323
     C           ZIA1      DIV  36600     ZIN1      H                                         220323
     C*
     C                     END                             - E2
     C                     ENDIF                                                            MD035448
      *                                                                                       CER016
     C********** ZICALC    IFNE 0                                                    CER016 MD035448
     C           CER016    IFNE 'Y'                                                         MD035448
     C           PINTN     ORNE 'Y'                                                           CER016
     C*
     C***********          XFOOTZIN       ZINTR                           074578
     C********** ZIN1      MULT ZIR       ZIN1      H                                  220566 220323
     C********** ZIN1      MULT ZDAYN2    ZIN1      H                                  220566 220323
     C                     XFOOTZIN1      ZINTR1 185H                     074578
     C                     Z-ADDZINTR1    ZINTR     H                     074578
     C*
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C                     END                             - E1
      *                                                                                     AR823701
      ** If OVERDRAFT exists, get account debit balance                                     AR823701
      *                                                                                     AR823701
     C           WOVRIN    IFNE 0                                                           AR823701
     C                     Z-ADD0         WODLN  110                                        AR823701
     C                     Z-ADD0         WODLN2 150                                        AR823701
     C                     Z-ADD0         WACTDB 110                                        AR823701
     C                     Z-ADD0         WZIA   155                                        AR823701
     C                     Z-ADD0         WZIN   185                                        AR823701
     C                     Z-ADDODLN      WODLN                                             AR823701
     C           WODLN     MULT 100       WODLN2                                            AR823701
     C                     Z-ADDBHISB     WACTDB                                            AR823701
     C           WODLN     IFNE 0                                                           AR823701
     C           BJRDNB    ANDLEODED                                                        AR823701
     C           BHISB     SUB  WODLN2    WACTDB                                            AR823701
     C                     ENDIF                                                            AR823701
      ** Get calculation basis                                                              AR823701
     C********** ZICALC    IFEQ 7                                                  AR823701 MD035448
     C********** ZICALC    OREQ 5                                                  AR823701 MD035448
     C********** ZICALC    OREQ 3                                                  AR823701 MD035448
     C********** ZICALC    OREQ 2                                                  AR823701 MD035448
     C********** ZICALC    OREQ 0                                                  AR823701 MD035448
      *                                                                                     AR823701
     C********** ZICALC    IFEQ 0                                                  AR823701 MD035448
     C           CER016    IFEQ 'Y'                                                         MD035448
     C           PINTN     ANDEQ'Y'                                                         AR823701
      *                                                                                     AR823701
     C                     Z-ADD1         C       20                                        AR823701
      *                                                                                     AR823701
     C           C         DOWLT12                                                          AR823701
      ** Skip if BAL is -2                                                                  AR823701
     C           CER055    IFEQ 'Y'                                                         AR823701
     C           ZIB,Z     ANDEQ-2                                                          AR823701
     C                     Z-ADDZIA,C     WAMT                                              AR823701
     C                     Z-ADDZIR,C     WRATE                                             AR823701
     C                     EXSR SRINT0                                                      AR823701
     C                     Z-ADDZINTR     ZIN1,C                                            AR823701
     C                     ADD  1         C                                                 AR823701
     C                     ENDIF                                                            AR823701
     C                     ENDDO                                                            AR823701
      *                                                                                     AR823701
     C                     XFOOTZIN1      ZINTR1    H                                       AR823701
     C                     Z-ADDZINTR1    ZINTR     H                                       AR823701
      *                                                                                     AR823701
     C                     ELSE                                                             AR823701
     C           ZICALC    IFEQ 7                                                           MD035448
     C           ZICALC    OREQ 5                                                           MD035448
     C           ZICALC    OREQ 3                                                           MD035448
     C           ZICALC    OREQ 2                                                           MD035448
     C           ZICALC    OREQ 0                                                           MD035448
      *                                                                                     AR823701
     C           WACTDB    DIV  36000     WZIA      H                                       AR823701
     C                     ENDIF                                                            AR823701
      *                                                                                     AR823701
     C**********           ENDIF                                                   AR823701 MD035448
      *                                                                                     AR823701
     C           ZICALC    IFEQ 4                                                           AR823701
     C           ZICALC    OREQ 1                                                           AR823701
     C           WACTDB    DIV  36500     WZIA      H                                       AR823701
      *                                                                                     AR823701
     C                     ENDIF                                                            AR823701
      *                                                                                     AR823701
     C           ZICALC    IFEQ 6                                                           AR823701
     C           WACTDB    DIV  36600     WZIA      H                                       AR823701
      *                                                                                     AR823701
     C                     ENDIF                                                            AR823701
      *                                                                                     AR823701
     C           WZIA      MULT WOVRIN    WZIA                                              AR823701
     C           WZIA      MULT ZDAYN2    WZIN                                              AR823701
      *                                                                                     AR823701
     C**********           ADD  WZIN      ZINTR                                    AR823701 MD025641
     C                     Z-ADDWZIN      WRKINT    H                                       MD025641
     C                     ADD  WRKINT    ZINTR                                             MD025641
     C                     ENDIF                                                            AR823701
     C                     ENDIF                                                            MD035448
     C*
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE3360CLD4                                           S01408
     C*                                                                   S01408
     C                     ENDSR                           **ZIC01 ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZIC02 subroutine to calculate interest (type=02)
     C**
     C**     Called by       INTCAL
     C**     Calls           ZICD
     C**
     C           ZIC02     BEGSR                           **ZIC02 BEGSR**
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE3360CLD5                                           S01408
     C*                                                                   S01408
     C*
      *                                                                                     AR823701
      ** Check if OVERDRAFT exist in ZIB array                                              AR823701
      **  and save the original ZIB in WZIB array                                           AR823701
      *                                                                                     AR823701
     C                     Z-ADD0         WACTDB                                            AR823701
     C           CER055    IFEQ 'Y'                                                         AR823701
      *                                                                                     AR823701
     C                     Z-ADD2         Z                                                 AR823701
     C                     Z-ADD0         WOVRIN                                            AR823701
     C           Z         DOWLE11                                                          AR823701
     C           ZIB,Z     IFEQ -2                                                          AR823701
     C                     Z-ADDZIR,Z     WOVRIN                                            AR823701
      ** Save original Balance array(ZIB)                                                   AR823701
     C                     MOVE ZIB       WZIB                                              AR823701
     C                     Z-ADD0         ZIB,Z                                             AR823701
     C                     LEAVE                                                            AR823701
     C                     ENDIF                                                            AR823701
     C                     ADD  1         Z                                                 AR823701
     C                     ENDDO                                                            AR823701
     C                     ENDIF                                                            AR823701
     C** FILL THE END OF THE TABLE WITH HIGHVAL
     C*
     C                     Z-ADD2         Z
     C           Z         DOWLE11
     C           ZIB,Z     IFEQ *ZEROS
     C                     Z-ADD*HIVAL    ZIB,Z
     C                     END
     C                     ADD  1         Z
     C                     END
     C*
     C** REVERSE SIGN OF AMOUNT IF IT'S NEGATIVE
     C*
     C           ZIAMT     IFLT 0                          - B1
     C                     Z-SUBZIAMT     ZIAMT
     C                     END                             - E1
     C*
     C***INTEREST*IS*ONLY*CALCULATED*ON*AN*AMOUNT*THAT*EXCEEDS*OR*IS*EQUAL103460
     C***TO*THE*INITIAL*THRESHOLD*BALACEE                                 103460
      *  INTEREST IS ONLY CALCULATED ON AN AMOUNT THAT EXCEEDS THE        103460
      *  INITIAL THRESHOLD BALANCE                                        103460
     C*
     C***********ZIAMT     IFGE ZITHR                      - B1           103460
     C           ZIAMT     IFGT ZITHR                      - B1           103460
     C*
     C** FIND NUMBER OF DAYS TO CALCULATE INTEREST ACCORDING TO CALC. BASIS
     C*
     C                     EXSR ZICD
     C*
     C                     Z-ADD1         Z
     C*
     C           ZIAMT     LOKUPZIB,Z                  40
      ** Move back Original Balance array(ZIB)                                              AR823701
     C           WOVRIN    IFNE 0                                                           AR823701
     C                     MOVE WZIB      ZIB                                               AR823701
     C                     ENDIF                                                            AR823701
     C*
     C* IF THE SUB-TYPE IS FROM 50000 TO 99999, CALCULATE THE INTEREST
     C* ON THE AMOUNT EXCEEDING THE INITIAL THRESHOLD. OTHERWISE, THE
     C* INTEREST IS CALCULATED ON THE WHOLE BALANCE WHENEVER IT EXCEEDS
     C* THE INITIAL THRESHOLD.
     C*
     C           INST      IFGE 50000                      - B2
     C           ZIAMT     SUB  ZITHR     ZIAMT
     C                     END                             - E2
     C/COPY WNCPYSRC,RE3360C046
     C*
     C********** ZIAMT     MULT ZDAYN2    WWMUL3 150                                          220566
     C********** WWMUL3    DIV  100       WWDIV3 150H                                         220566
     C********** WWDIV3    MULT ZIR,Z     WWZIR  150                                          220566
     C*
     C           ZICALC    IFEQ 6                                                             220323
     C           ZIAMT     MULT INT6DY    WWMUL3 309                                          220323
     C                     ELSE                                                               220323
     C           ZIAMT     MULT ZDAYN2    WWMUL3                                              220323
     C                     ENDIF                                                              220323
     C           WWMUL3    MULT ZIR,Z     WWDIV3 309                                          220323
      *                                                                                       220323
     C********** ZICALC    IFEQ 7                          - B2                             MD035448
     C********** ZICALC    OREQ 5                                                           MD035448
     C********** ZICALC    OREQ 3                                                           MD035448
     C********** ZICALC    OREQ 2                                                           MD035448
     C********** ZICALC    OREQ 0                                                    CER016 MD035448
      *                                                                                       CER016
     C********** ZICALC    IFEQ 0                                                    CER016 MD035448
     C           CER016    IFEQ 'Y'                                                         MD035448
     C           PINTN     ANDEQ'Y'                                                           CER016
     C                     Z-ADDZIAMT     WAMT                                                CER016
     C                     Z-ADDZIR,Z     WRATE                                               CER016
     C                     EXSR SRINT0                                                        CER016
     C                     ELSE                                                               CER016
     C           ZICALC    IFEQ 7                          - B2                             MD035448
     C           ZICALC    OREQ 5                                                           MD035448
     C           ZICALC    OREQ 3                                                           MD035448
     C           ZICALC    OREQ 2                                                           MD035448
     C           ZICALC    OREQ 0                                                           MD035448
      *                                                                                       CER016
     C********** WWZIR     DIV  360       ZIWRK1    H                                         220566
     C********** ZIAMT     DIV  36000     ZIWRK1    H                                  220566 220323
     C           WWDIV3    DIV  36000     ZIWRK1    H                                         220323
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
     C*
     C**********           END                             - E2                             MD035448
     C*
     C           ZICALC    IFEQ 4                          - B2
     C           ZICALC    OREQ 1
     C********** WWZIR     DIV  365       ZIWRK1    H                                         220566
     C********** ZIAMT     DIV  36500     ZIWRK1    H                                  220566 220323
     C           WWDIV3    DIV  36500     ZIWRK1    H                                         220323
     C*
     C                     END                             - E2
     C*
     C           ZICALC    IFEQ 6                          - B2
     C********** WWZIR     DIV  366       ZIWRK1    H                                         220566
     C********** ZIAMT     DIV  36600     ZIWRK1    H                                  220566 220323
     C           WWDIV3    DIV  36600     ZIWRK1    H                                         220323
     C*
     C                     END                             - E2
     C                     ENDIF                                                            MD035448
      *                                                                                       CER016
     C********** ZICALC    IFNE 0                                                    CER016 MD035448
     C           CER016    IFNE 'Y'                                                         MD035448
     C           PINTN     ORNE 'Y'                                                           CER016
     C*
     C********** ZIWRK1    MULT ZIR,Z     WWMULT 155H                                  220566 220323
     C********** WWMULT    MULT ZDAYN2    ZIWRK1    H                                  220566 220323
     C***********          ADD  ZIWRK1    ZINTR                           074578
     C                     ADD  ZIWRK1    ZINTR     H                     074578
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C/COPY WNCPYSRC,RE3360C045
     C*
     C                     END                             - E1
      ** If OVERDRAFT exists                                                                AR823701
     C           WOVRIN    IFNE 0                                                           AR823701
     C                     Z-ADDBHISB     WACTDB                                            AR823701
      *                                                                                     AR823701
     C********** ZICALC    IFEQ 7                                                  AR823701 MD035448
     C********** ZICALC    OREQ 5                                                  AR823701 MD035448
     C********** ZICALC    OREQ 3                                                  AR823701 MD035448
     C********** ZICALC    OREQ 2                                                  AR823701 MD035448
     C********** ZICALC    OREQ 0                                                  AR823701 MD035448
      *                                                                                     AR823701
     C********** ZICALC    IFEQ 0                                                  AR823701 MD035448
     C           CER016    IFEQ 'Y'                                                         MD035448
     C           PINTN     ANDEQ'Y'                                                         AR823701
      *                                                                                     AR823701
     C                     Z-ADD1         C       20                                        AR823701
      *                                                                                     AR823701
     C           C         DOWLT12                                                          AR823701
     C                     Z-ADDZIA,C     WAMT                                              AR823701
     C                     Z-ADDZIR,C     WRATE                                             AR823701
     C                     EXSR SRINT0                                                      AR823701
     C                     Z-ADDZINTR     ZIN1,C                                            AR823701
     C                     ADD  1         C                                                 AR823701
     C                     ENDDO                                                            AR823701
      *                                                                                     AR823701
     C                     XFOOTZIN1      ZINTR1    H                                       AR823701
     C                     Z-ADDZINTR1    ZINTR     H                                       AR823701
      *                                                                                     AR823701
     C                     ELSE                                                             AR823701
     C           ZICALC    IFEQ 7                                                           MD035448
     C           ZICALC    OREQ 5                                                           MD035448
     C           ZICALC    OREQ 3                                                           MD035448
     C           ZICALC    OREQ 2                                                           MD035448
     C           ZICALC    OREQ 0                                                           MD035448
      *                                                                                     AR823701
     C           WACTDB    DIV  36000     WZIA      H                                       AR823701
     C                     ENDIF                                                            AR823701
      *                                                                                     AR823701
     C**********           ENDIF                                                   AR823701 MD035448
      *                                                                                     AR823701
     C           ZICALC    IFEQ 4                                                           AR823701
     C           ZICALC    OREQ 1                                                           AR823701
     C           WACTDB    DIV  36500     WZIA      H                                       AR823701
      *                                                                                     AR823701
     C                     ENDIF                                                            AR823701
      *                                                                                     AR823701
     C           ZICALC    IFEQ 6                                                           AR823701
     C           WACTDB    DIV  36600     WZIA      H                                       AR823701
      *                                                                                     AR823701
     C                     ENDIF                                                            AR823701
      *                                                                                     AR823701
     C           WZIA      MULT WOVRIN    WZIA                                              AR823701
     C           WZIA      MULT ZDAYN2    WZIN                                              AR823701
      *                                                                                     AR823701
     C**********           ADD  WZIN      ZINTR                                    AR823701 MD025640
     C                     Z-ADDWZIN      WRKINT 130H                                       MD025640
     C                     ADD  WRKINT    ZINTR                                             MD025640
     C                     ENDIF                                                            AR823701
     C                     ENDIF                                                            MD035448
      *                                                                                     AR823701
     C*
     C*                                                                   S01408
     C** Core hook for externalisation.                                   S01408
     C/COPY WNCPYSRC,RE3360CLD6                                           S01408
     C*                                                                   S01408
     C                     ENDSR                           **ZIC02 ENDSR**
     C/EJECT                                                              CRE001
     C********************************************************************CRE001
     C**                                                                  CRE001
     C** ZICOD subroutine to calculate interest with overdraft            CRE001
     C**                                                                  CRE001
     C**     Called by       INTCAL                                       CRE001
     C**     Calls           ZIC00                                        CRE001
     C**                                                                  CRE001
     C           ZICOD     BEGSR                           **ZICOD BEGSR**CRE001
      *                                                                   CRE001
      ** Initialise work fields                                           CRE001
      *                                                                   CRE001
     C                     Z-ADD*ZEROS    FINTR             * INTEREST    CRE001
     C                     Z-ADD*ZEROS    FOINT             * O/D INT     CRE001
     C                     Z-ADD*ZEROS    FDINT             * DEBIT INT   CRE001
      *                                                                   CRE001
      ** Set overdraft line amount with decimal places of currency        CRE001
      *                                                                   CRE001
     C   70      1         MULT ODLN      FODLN  150                      CRE001
     C   71      10        MULT ODLN      FODLN  150                      CRE001
     C   72      100       MULT ODLN      FODLN  150                      CRE001
     C   73      1000      MULT ODLN      FODLN  150                      CRE001
     C/COPY WNCPYSRC,RE3360C047
      *                                                                   CRE001
      **  If history balance is more than work overdraft line, and        CRE001
      **  the additional overdraft interest rate is non-zero and the      CRE001
      **  end date of the period is less than or equal to the overdraft   CRE001
      **  expiry date.                                                    CRE001
      *                                                                   CRE001
     C           RHISB     IFGT FODLN                       - B1          CRE001
     C           ATAODR    ANDNE0                                         CRE001
     C********** ZIEND     ANDLEODED                                                   CRE001 152698
     C/COPY WNCPYSRC,RE3360C049
      *                                                                                       152698
     C           ZIEND     IFLE ODED                        - B3                              152698
      *                                                                                       152698
     C                     Z-ADDRHISB     ZIAMT                           CRE001
     C/COPY WNCPYSRC,RE3360C050
      *                                                                   CRE001
     C                     EXSR ZIC00                                     CRE001
      *                                                                   CRE001
      ** Set the interest field to the returned interest amount           CRE001
     C                     Z-ADDZINTR     FINTR                           CRE001
      *                                                                   CRE001
      ** Initialise work fields                                           CRE001
      *                                                                   CRE001
     C           RHISB     SUB  FODLN     ZIAMT                           CRE001
     C                     Z-ADDATAODR    ZIRATE                          CRE001
      *                                                                   CRE001
     C                     EXSR ZIC00                                     CRE001
      *                                                                   CRE001
     C                     Z-ADDZINTR     FOINT                           CRE001
     C           FOINT     ADD  FINTR     FDINT                           CRE001
      *                                                                   CRE001
     C                     ELSE                            - X1           CRE001
     C           ZIEND     IFGT ODED                                      CRE001
     C           ODED      ANDGT*ZEROS                                    CRE001
      *                                                                   CRE001
     C                     Z-ADDRHISB     ZIAMT                           CRE001
     C                     EXSR ZIC00                                     CRE001
     C                     Z-ADDZINTR     FINTR                           CRE001
      *                                                                   CRE001
     C                     Z-ADDRHISB     ZIAMT                           CRE001
     C                     Z-ADDATAODR    ZIRATE                          CRE001
     C                     EXSR ZIC00                                     CRE001
      *                                                                   CRE001
     C                     Z-ADDZINTR     FOINT                           CRE001
      *                                                                   CRE001
      ** Reset the interest calculation work fields                       CRE001
      *                                                                   CRE001
     C           FOINT     ADD  FINTR     FDINT                           CRE001
     C                     ELSE                                           CRE001
     C                     Z-ADDRHISB     ZIAMT                           CRE001
     C                     EXSR ZIC00                                     CRE001
     C                     Z-ADDZINTR     FDINT                           CRE001
      *                                                                                       152698
     C                     Z-ADDRHISB     ZIAMT                                               152698
     C                     Z-ADDATAODR    ZIRATE                                              152698
     C                     EXSR ZIC00                                                         152698
      *                                                                                       152698
     C                     Z-ADDZINTR     FOINT                                               152698
      *                                                                                       152698
      ** Reset the interest calculation work fields                                           152698
      *                                                                                       152698
     C           FDINT     ADD  FOINT     FDINT                                               152698
      *                                                                                       152698
     C                     END                             - E3                               152698
      *                                                                                       152698
     C                     END                             - E2                               152698
     C                     ELSE                                                               152698
     C                     Z-ADDRHISB     ZIAMT                                               152698
     C                     EXSR ZIC00                                                         152698
     C                     Z-ADDZINTR     FDINT                                               152698
      *                                                                                       152698
     C                     END                                            CRE001
      *                                                                   CRE001
     C**********           END                                                         CRE001 198547
     C                     Z-ADDFDINT     ZINTR                           CRE001
     C/COPY WNCPYSRC,RE3360C048
     C                     ENDSR                                          CRE001
     C********************************************************************CRE001
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DRINIT subroutine for debit rates loading
     C**
     C**     Called by       INTCAL
     C**     Calls           DBSR
     C**
     C           DRINIT    BEGSR                           **DRINIT BEGSR**
     C*
     C                     Z-ADD*ZEROS    ZIRD
     C                     Z-ADD*ZEROS    ZIBD
     C                     Z-ADD*ZERO     ZITHR
     C                     Z-ADD*ZEROS    INTHD
     C*
     C** CHAIN TO DEBIT RATE CHANGES FILE
     C*
     C           WRECI     IFEQ 'S'                                                         MD031352
     C                     Z-ADDDDRCD     KDATE                                             MD031352
     C                     ENDIF                                                            MD031352
     C           WRECI     IFEQ 'B'                                                         MD031352
     C           WRECI     OREQ 'D'                                                         MD031352
     C                     Z-ADDBDRCD     KDATE                                             MD031352
     C                     ENDIF                                                            MD031352
     C**********           Z-ADDDRCD      KDATE                                             MD031352
     C*
     C           DCKEY     CHAINREHRDJ               99
     C*
     C** ERROR IN REHRDJ
     C*
     C           *IN99     IFEQ '1'                        - B1
     C********** DRIB      ANDEQ*ZEROS                                                        CSD103
     C           DRIB      ANDEQ*BLANKS                                                       CSD103
     C           DRIS      ANDEQ*ZEROS
     C           OLDR      ORNE *ZEROS
     C                     MOVE '0'       *IN99
     C                     END                             - E1
     C*
     C           *IN99     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA
     C                     Z-ADD092       DBASE            ***************
     C                     MOVE 'REHRDJ'  DBFILE           * DBERROR 092 *
     C                     Z-ADDKDATE     REHDAT           ***************
     C                     MOVE *BLANKS   DBKEY
     C                     MOVELREHKEY    DBKEY
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C** PICK-UP DEBIT THRESHOLD BALANCE
     C*
     C                     Z-ADDINTHD     ZITHR
     C*
     C** SETUP WORK DEBIT FIELDS WITH FIELDS READ
     C*
     C           RAT2      IFNE *BLANKS                    - B1
     C                     MOVELRAT2      WDRAT
     C                     END                             - E1
     C*
     C           RAT3      IFNE *BLANKS                    - B1
     C                     MOVE RAT3      WDRAT
     C                     END                             - E1
     C*
     C           BAL2      IFNE *BLANKS                    - B1
     C                     MOVELBAL2      WDBAL
     C                     END                             - E1
     C*
     C           BAL3      IFNE *BLANKS                    - B1
     C                     MOVE BAL3      WDBAL
     C                     END                             - E1
     C*
     C** LOADING OF DEBIT INTEREST RATES AND DEBIT INTEREST BALANCES
     C*
     C                     Z-ADDZIRD      ZIR
     C                     Z-ADDZIBD      ZIB
     C*
     C                     ENDSR                           **DRINIT ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** CRINIT subroutine for credit rates loading
     C**
     C**     Called by       INTCAL
     C**     Calls           DBSR
     C**
     C           CRINIT    BEGSR                           **CRINIT BEGSR*
     C*
     C                     Z-ADD*ZEROS    ZIRC
     C                     Z-ADD*ZEROS    ZIBC
     C                     Z-ADD*ZERO     ZITHR
     C                     Z-ADD*ZEROS    INTHC
     C*
     C** CHAIN TO CREDIT RATE CHANGES FILE
     C*
     C           WRECI     IFEQ 'S'                                                         MD031352
     C                     Z-ADDDCRCD     KDATE                                             MD031352
     C                     ENDIF                                                            MD031352
     C           WRECI     IFEQ 'B'                                                         MD031352
     C           WRECI     OREQ 'D'                                                         MD031352
     C                     Z-ADDBCRCD     KDATE                                             MD031352
     C                     ENDIF                                                            MD031352
     C**********           Z-ADDCRCD      KDATE                                             MD031352
     C*
     C           DCKEY     CHAINREHRCJ               99
     C*
     C** ERROR IN REHRCJ
     C*
     C           *IN99     IFEQ '1'                        - B1
     C********** CRIB      ANDEQ*ZEROS                                                        CSD103
     C           CRIB      ANDEQ*BLANKS                                                       CSD103
     C           CRIS      ANDEQ*ZEROS
     C           OLCR      ORNE *ZEROS
     C                     MOVE '0'       *IN99
     C                     END                             - E1
     C*
     C           *IN99     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA
     C                     Z-ADD093       DBASE            ***************
     C                     MOVE 'REHRCJ'  DBFILE           * DBERROR 093 *
     C                     Z-ADDKDATE     REHDAT           ***************
     C                     MOVE *BLANKS   DBKEY
     C                     MOVELREHKEY    DBKEY
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C** PICK-UP CREDIT THRESHOLD BALANCE
     C*
     C                     Z-ADDINTHC     ZITHR
     C*
     C** SETUP WORK CREDIT FIELDS WITH FIELDS READ PROCESSING
     C*
     C           RAT2      IFNE *BLANKS                    - B1
     C                     MOVELRAT2      WCRAT
     C                     END                             - E1
     C*
     C           RAT3      IFNE *BLANKS                    - B1
     C                     MOVE RAT3      WCRAT
     C                     END                             - E1
     C*
     C           BAL2      IFNE *BLANKS                    - B1
     C                     MOVELBAL2      WCBAL
     C                     END                             - E1
     C*
     C           BAL3      IFNE *BLANKS                    - B1
     C                     MOVE BAL3      WCBAL
     C                     END                             - E1
     C*
     C** LOADING OF CREDIT INTEREST RATES AND CREDIT INTEREST BALANCES
     C*
     C                     Z-ADDZIRC      ZIR
     C                     Z-ADDZIBC      ZIB
     C*
     C                     ENDSR                           **CRINIT ENDSR*
      *                                                                   S01408
     C/COPY WNCPYSRC,RE3360CP15                                           S01408
      *                                                                   S01408
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DATEIN subroutine for date init processing
     C**
     C**     Called by       INTCAL
     C**     Calls           DBSR
     C**
     C           DATEIN    BEGSR                           **DATEIN BEGSR*
     C*
     C** WORK FIELD INIT
     C*
     C                     Z-ADD*ZEROS    ZLDTM
     C*
     C***CALCULATING*DATE*FROM*DAY*NUMBER*(REACR*HISTORY*DATE)*********                       220566
      ** Calculating date from history day number (REHISL History Date)                       220566
     C*
     C**********           Z-ADDRHISD     ZDAYNO                                              220566
     C                     Z-ADDDHISD     ZDAYNO                                              220566
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA                        - B1
     C                     Z-ADD094       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           **DB ERROR 94**
     C                     MOVE ZERROR    ERRDAT           ***************
     C                     MOVE *BLANKS   DBKEY
     C                     MOVELERRDAT    DBKEY
     C           *LOCK     IN   LDA                        - B1
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C** CALCULATING FIRST DAY OF THIS MONTH TO CALCULATE THE LAST ONE
     C*
     C           *IN98     IFEQ '0'                        - B1           088029
     C                     Z-ADDZDATE     RESULT
     C                     Z-ADD1         ZDAY
     C                     Z-ADDRESULT    ZDATE
     C                     ELSE                            - X1           088029
     C                     Z-ADDZDATE     RESULX                          088029
     C                     Z-ADD1         ZDAYX                           088029
     C                     Z-ADDRESULX    ZDATE                           088029
     C                     END                             - E1           088029
     C                     EXSR ZDATE1
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA
     C                     Z-ADD095       DBASE            ***************
     C                     MOVE 'ZDATE1'  DBFILE           * DBERROR 095 *
     C                     MOVE ZERROR    ERRDAT           ***************
     C                     MOVE *BLANKS   DBKEY
     C                     MOVELERRDAT    DBKEY
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C           *IN98     IFEQ '0'                        - B0           088029
     C           ZMTH      IFEQ 12                         - B1
     C                     Z-ADD1         ZMTH
     C                     ADD  1         ZYEAR
     C                     ELSE                            - X1
     C                     ADD  1         ZMTH
     C                     END                             - E1
     C*
     C                     Z-ADDRESULT    ZDATE
     C                     ELSE                            - X0           088029
     C           ZMTHX     IFEQ 12                         - B1           088029
     C                     Z-ADD1         ZMTHX                           088029
     C                     ADD  1         ZYEARX                          088029
     C                     ELSE                            - X1           088029
     C                     ADD  1         ZMTHX                           088029
     C                     END                             - E1           088029
     C*                                                                   088029
     C                     Z-ADDRESULX    ZDATE                           088029
     C                     END                             - E0           088029
     C                     EXSR ZDATE1
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B1
     C           *LOCK     IN   LDA
     C                     Z-ADD096       DBASE            ***************
     C                     MOVE 'ZDATE1'  DBFILE           * DBERROR 096**
     C                     MOVE ZERROR    ERRDAT           ***************
     C                     MOVE *BLANKS   DBKEY
     C                     MOVELERRDAT    DBKEY
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E1
     C*
     C           ZDAYNO    SUB  1         ZLDTM
     C*
     C                     ENDSR                           **DATEIN ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DBSR subroutine for database error handling
     C**
     C**     Called by       ACCNUM, FIRST, SCROUT
     C**     Calls           -
     C**
     C           DBSR      BEGSR                           **DBSR BEGSR**
     C*
     C           *IN89     IFEQ '1'                        - B1
     C           PMODE     ANDEQ'I'                        - B1           CRT002
     C                     WRITEHEADAU
     C                     END                             - E1
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
      *                                                                   CRT002
     C           PMODE     IFEQ 'I'                        - B1           CRT002
     C                     WRITEERRAU
     C                     ENDIF                                          CRT002
     C*
     C                     EXSR *PSSR
     C*
     C                     RETRN
     C*
     C                     ENDSR                           **DBSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** REASR subroutine for REACR file exception/error handling
     C**
     C**     Called by       Input specifications
     C**     Calls           DBSR
     C**
     C           REASR     BEGSR                           **REASR BEGSR**
     C*
     C                     MOVE 'REACR'   DBFILE           ***************
     C                     Z-ADD40        DBASE            **DBERR  040 **
     C                     MOVELRKEY      DBKEY            **STATUS ERR **
     C                     MOVELSTSREA    DBSTAT  5        ***************
     C                     MOVEA'11'      *IN,88
     C                     EXSR DBSR
     C*
     C                     ENDSR                           **REASR ENDSR**
     C********************************************************************                    220566
     C/EJECT                                                                                  220566
     C********************************************************************                    220566
     C**                                                                                      220566
     C** REHSR subroutine for REHISL file exception/error handling                            220566
     C**                                                                                      220566
     C**     Called by       Input specifications                                             220566
     C**     Calls           DBSR                                                             220566
     C**                                                                                      220566
     C           REHSR     BEGSR                           **REHSR BEGSR*                     220566
      *                                                                                       220566
     C           *LOCK     IN   LDA                                                           220566
     C                     MOVE 'REHISL'  DBFILE           **************                     220566
     C                     Z-ADD18        DBASE            **DBERR  018**                     220566
     C                     MOVELRKEY      DBKEY            **STATUS ERR**                     220566
     C                     MOVELSTSREH    DBSTAT  5        **************                     220566
     C                     OUT  LDA                                                           220566
     C                     MOVEA'1'       *IN,88                                              220566
     C                     EXSR DBSR                                                          220566
      *                                                                                       220566
     C                     ENDSR                           **REHSR ENDSR*                     220566
     C/COPY WNCPYSRC,RE3360C020
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** *PSSR  - Subroutine to handle abnormal error conditions
     C**
     C**      Called by     DBSR
     C**      Calls         -
     C**
     C           *PSSR     BEGSR                           ** *PSSR **
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
      *                                                                   CRT002
     C           PMODE     IFEQ 'P'                                       CRT002
     C           @FIRST    ANDEQ'0'                                       CRT002
      *                                                                   CRT002
     C                     ROLBK                                          CRT002
      *                                                                   CRT002
     C                     MOVELRJMSTY    RKMSTY                          CRT002
     C                     MOVELDBLOT     RKHSMS                          CRT002
     C                     MOVEL'DBER'    RKHMSI                          CRT002
     C                     MOVEL'E'       RKHMSS                          CRT002
      *                                                                   CRT002
     C                     CLEARLOGDS                                     CRT002
      *                                                                   CRT002
     C                     MOVEL'MEM0001' @MSGID                          CRT002
     C                     MOVEL'MIDAS   '@MSGF                           CRT002
     C                     MOVELDBLOT     @MSGDT                          CRT002
     C                     EXSR RTVMSG                                    CRT002
     C                     MOVEL@MSGTX    RKHSMS                          CRT002
      *                                                                   CRT002
     C                     MOVE RJCMSQ    WCMSQ                           CRT002
     C                     MOVELRJBRCA    WBRCA                           CRT002
     C                     MOVELRJUSID    WUSID                           CRT002
     C                     MOVE 'N'       WSUCM                           CRT002
     C                     MOVE 'DS'      WSTAT                           CRT002
     C                     TIME           WTMDS                           CRT002
     C           WTHR      CAT  ':'       WA                              CRT002
     C           WTMN      CAT  ':'       WB                              CRT002
     C           WA        CAT  WB        WC                              CRT002
     C           WC        CAT  WTSS      WSTTM                           CRT002
      *                                                                   CRT002
      **  Send to data queue                                              CRT002
      *                                                                   CRT002
     C                     MOVELREPEQO    P@QDS                           CRT002
     C                     CLEARWCMSG                                     CRT002
     C                     MOVELP@QDS     WCMSG                           CRT002
     C                     EXSR SDQMS                                     CRT002
     C*                                                                   CRT002
     C***  If error received after call to QRCVDTAQ, QSNDDTAQ,            CRT002
     C***  issue DB error.                                                CRT002
     C*                                                                   CRT002
     C           *IN70     IFEQ '1'                                       CRT002
     C           *LOCK     IN   LDA                        ***************CRT002
     C                     Z-ADD80        DBASE            ** DB ERR 80 **CRT002
     C                     MOVE P@QRS     DBFILE           ***************CRT002
     C                     MOVELP@QKY     DBKEY                           CRT002
     C                     EXSR DBSR                                      CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     EXSR WRLOG                                     CRT002
     C                     COMIT                                          CRT002
      *                                                                   CRT002
     C                     MOVEL*BLANKS   REPEQO                          CRT002
      *                                                                   CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
      **  If *PSSR already run, then just end the program here            CRT002
      *                                                                   CRT002
     C                     SETON                     U7U8LR               CRT002
     C                     RETRN                                          CRT002
      *                                                                   CRT002
     C                     END
     C*
     C                     ENDSR                           ** *PSSR **
     C********************************************************************
     C/EJECT                                                              CRT002
      *****************************************************************   CRT002
      *                                                               *   CRT002
      *            DTQOUT - Format screen to output to data queue     *   CRT002
      *                                                               *   CRT002
      * CALLS      ZFRPED - Format amounts                            *   CRT002
      *            MOVDTQ - Send details to output queue              *   CRT002
      *                                                               *   CRT002
      * CALLED BY  SCROUT - Format screen to output to data queue     *   CRT002
      *                                                               *   CRT002
      * FLDS USED         -                                           *   CRT002
      *                                                               *   CRT002
      *****************************************************************   CRT002
      *                                                                   CRT002
     C           DTQOUT    BEGSR                           ** DTQOUT **   CRT002
      *                                                                   CRT002
      **  EDTCDE K                                                        CRT002
      *                                                                   CRT002
     C                     Z-ADDCDP       ZDECS                           CRT002
     C                     MOVE 'A'       ZECODE                          CRT002
      *                                                                   CRT002
     C                     MOVE HISB0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @HISB                           CRT002
      *                                                                   CRT002
     C                     MOVE SLDBL0    ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @LDBL                           CRT002
      *                                                                   CRT002
     C                     MOVE SCLBL0    ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @CLBL                           CRT002
      *                                                                   CRT002
     C           *IN69     IFEQ '1'                                       CRT002
     C           *IN21     OREQ '0'                                       CRT002
     C                     MOVE SCACC0    ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @CACC                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C                     MOVE STOTO0    ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @TOTO                           CRT002
      *                                                                   CRT002
     C           *IN56     IFEQ '0'                                       CRT002
     C                     MOVE MINC0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @MINC                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           *IN57     IFEQ '0'                                       CRT002
     C                     MOVE MAXC0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @MAXC                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
      **  EDTCDE K                                                        CRT002
      *                                                                   CRT002
     C                     MOVE 'J'       ZECODE                          CRT002
      *                                                                   CRT002
     C           DAIC0     IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @DAIC                           CRT002
     C                     ELSE                                           CRT002
     C                     MOVE DAIC0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @DAIC                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           CAIC0     IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @CAIC                           CRT002
     C                     ELSE                                           CRT002
     C                     MOVE CAIC0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @CAIC                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           BRTOT0    IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @BRTOT                          CRT002
     C                     ELSE                                           CRT002
     C                     MOVE BRTOT0    ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @BRTOT                          CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           GADI0     IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @GADI                           CRT002
     C                     ELSE                                           CRT002
     C                     MOVE GADI0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @GADI                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           GACI0     IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @GACI                           CRT002
     C                     ELSE                                           CRT002
     C                     MOVE GACI0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @GACI                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           MADI0     IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @MADI                           CRT002
     C                     ELSE                                           CRT002
     C                     MOVE MADI0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @MADI                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           MACI0     IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @MACI                           CRT002
     C                     ELSE                                           CRT002
     C                     MOVE MACI0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @MACI                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           RCA0      IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @RCA                            CRT002
     C                     ELSE                                           CRT002
     C                     MOVE RCA0      ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @RCA                            CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           NRCA0     IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @NRCA                           CRT002
     C                     ELSE                                           CRT002
     C                     MOVE NRCA0     ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @NRCA                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C           SWTAX0    IFEQ 0                                         CRT002
     C                     MOVE *BLANKS   @WTAX                           CRT002
     C                     ELSE                                           CRT002
     C                     MOVE SWTAX0    ZFLD15                          CRT002
     C                     EXSR ZFRPED                                    CRT002
     C                     MOVE ZOUT22    @WTAX                           CRT002
     C                     ENDIF                                          CRT002
      *                                                                                       CGL031
     C           CGL031    IFEQ 'Y'                                                           CGL031
     C           EUTAX0    IFEQ 0                                                             CGL031
     C                     MOVE *BLANKS   @EUTAX                                              CGL031
     C                     ELSE                                                               CGL031
     C                     MOVE EUTAX0    ZFLD15                                              CGL031
     C                     EXSR ZFRPED                                                        CGL031
     C                     MOVE ZOUT22    @EUTAX                                              CGL031
     C                     ENDIF                                                              CGL031
     C                     ENDIF                                                              CGL031
      *                                                                                       CER048
     C********** CER048    IFEQ 'Y'                                                  CER048 BUG23325
      **********                                                                     CER048 BUG23325
     C********** SSTAX0    IFEQ *ZEROS                                               CER048 BUG23325
      **********                                                                     CER048 BUG23325
     C**********           MOVE *BLANKS   @STAX                                      CER048 BUG23325
     C**********           ELSE                                                      CER048 BUG23325
      **********                                                                     CER048 BUG23325
     C**********           MOVE SSTAX0    ZFLD15                                     CER048 BUG23325
     C**********           EXSR ZFRPED                                               CER048 BUG23325
     C**********           MOVE ZOUT22    @STAX                                      CER048 BUG23325
      **********                                                                     CER048 BUG23325
     C**********           ENDIF                                                     CER048 BUG23325
      **********                                                                     CER048 BUG23325
     C**********           ENDIF                                                     CER048 BUG23325
      *                                                                   CRT002
      **  Clear enquiry lines                                             CRT002
      *                                                                   CRT002
     C                     CLEARREPEQO                                    CRT002
      *                                                                   CRT002
      **  Message Type and Host Message Id.                               CRT002
      *                                                                   CRT002
     C                     MOVELRJMSTY    RKMSTY                          CRT002
     C                     MOVEL*BLANKS   RKHMSI                          CRT002
     C                     MOVEL*BLANKS   RKHMSS                          CRT002
     C                     MOVEL*BLANKS   RKHSMS                          CRT002
      *                                                                   CRT002
      **  Send screen                                                     CRT002
      *                                                                   CRT002
     C                     MOVELSBRCA     QBRCA                           CRT002
     C                     MOVELSCNUM     QCNUM                           CRT002
     C                     MOVELSACOD     QACOD                           CRT002
     C                     MOVELSACSQ     QACSQ                           CRT002
     C                     MOVELSRTNO     QRTNO                           CRT002
     C                     MOVELSCCY      QCCY                            CRT002
      *                                                                   CRT002
     C                     MOVELLINEB     RKEQ01                          CRT002
     C                     MOVELLINE2     RKEQ02                          CRT002
     C                     MOVELLINE3     RKEQ03                          CRT002
     C                     MOVELLINE4     RKEQ04                          CRT002
     C                     MOVELLINE5     RKEQ05                          CRT002
     C                     MOVELLINEB     RKEQ06                          CRT002
     C                     MOVELLINE7     RKEQ07                          CRT002
     C                     MOVELLINE8     RKEQ08                          CRT002
     C                     MOVELLINE9     RKEQ09                          CRT002
     C           CGL031    IFEQ 'Y'                                                           CGL031
     C                     MOVELLINE9B    RKEQ9B                                              CGL031
     C                     ENDIF                                                              CGL031
     C                     MOVELLINE10    RKEQ10                          CRT002
     C                     MOVELLINE11    RKEQ11                          CRT002
     C                     MOVELLINE12    RKEQ12                          CRT002
     C                     MOVELLINE13    RKEQ13                          CRT002
     C                     MOVELLINE14    RKEQ14                          CRT002
     C                     MOVELLINE15    RKEQ15                          CRT002
     C                     MOVELLINE16    RKEQ16                          CRT002
      **********                                                                     CER048 BUG23325
     C********** CER048    IFEQ 'Y'                                                  CER048 BUG23325
     C**********           MOVE NLN16B    RKE16B                                     CER048 BUG23325
     C**********           ENDIF                                                     CER048 BUG23325
      **********                                                                     CER048 BUG23325
     C           *IN56     IFEQ '0'                                       CRT002
     C                     MOVELLIN172    RKEQ17                          CRT002
     C                     ENDIF                                          CRT002
     C           *IN69     IFEQ '1'                                       CRT002
     C           *IN21     OREQ '0'                                       CRT002
     C                     MOVELLIN171    RKEQ17                          CRT002
     C                     ENDIF                                          CRT002
     C           *IN57     IFEQ '0'                                       CRT002
     C                     MOVELLINE18    RKEQ18                          CRT002
     C                     ELSE                                           CRT002
     C                     MOVELLINEB     RKEQ18                          CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C                     MOVELLINE19    RKEQ19                          CRT002
     C                     MOVELLINEB     RKEQ20                          CRT002
      *                                                                   CRT002
     C                     MOVEL'Y'       RKEQCF                          CRT002
      *                                                                   CRT002
     C                     MOVE 'N'       WSUCM                           CRT002
     C                     MOVE 'DS'      WSTAT                           CRT002
     C                     TIME           WTMDS                           CRT002
     C           WTHR      CAT  ':'       WA                              CRT002
     C           WTMN      CAT  ':'       WB                              CRT002
     C           WA        CAT  WB        WC                              CRT002
     C           WC        CAT  WTSS      WSTTM                           CRT002
      *                                                                   CRT002
     C                     EXSR MOVDTQ                                    CRT002
      *                                                                   CRT002
     C                     ENDSR                           ** DTQOUT**    CRT002
      *****************************************************************   CRT002
     C/EJECT                                                              CRT002
      *****************************************************************   CRT002
      *                                                               *   CRT002
      *            MOVDTQ - Send details to data queue                *   CRT002
      *                                                               *   CRT002
      * CALLS      WRLOG  - Write details to log file                 *   CRT002
      *                                                               *   CRT002
      * CALLED BY  DTQOUT - Format screen to output to data queue     *   CRT002
      *                                                               *   CRT002
      * FLDS USED         -                                           *   CRT002
      *                                                               *   CRT002
      *****************************************************************   CRT002
      *                                                                   CRT002
     C           MOVDTQ    BEGSR                           ** MOVDTQ **   CRT002
      *                                                                   CRT002
     C                     MOVELREPEQO    P@QDS                           CRT002
     C                     EXSR SDQMS                                     CRT002
      *                                                                   CRT002
      **  If error received after call to QRCVDTAQ, QSNDDTAQ,             CRT002
      **  issue DB error.                                                 CRT002
      *                                                                   CRT002
     C           *IN70     IFEQ '1'                                       CRT002
     C           *LOCK     IN   LDA                        ***************CRT002
     C                     Z-ADD80        DBASE            ** DB ERR 80 **CRT002
     C                     MOVE P@QRS     DBFILE           ***************CRT002
     C                     MOVELP@QKY     DBKEY                           CRT002
     C                     EXSR DBSR                                      CRT002
     C                     END                                            CRT002
      *                                                                   CRT002
     C                     MOVE RJCMSQ    WCMSQ                           CRT002
     C                     MOVELRJUSID    WUSID                           CRT002
     C                     MOVELREPEQO    WCMSG                           CRT002
     C                     EXSR WRLOG                                     CRT002
      *                                                                   CRT002
     C                     COMIT                                          CRT002
      *                                                                   CRT002
     C                     MOVEL*BLANKS   REPEQO                          CRT002
      *                                                                   CRT002
     C                     ENDSR                           ** WRLOG **    CRT002
      *****************************************************************   CRT002
     C/EJECT                                                              CRT002
      *****************************************************************   CRT002
      *                                                               *   CRT002
      *            DTQERR - Error Processing for PC Mode              *   CRT002
      *                                                               *   CRT002
      * CALLS      MOVDTQ - Move details to data queue                *   CRT002
      *                                                               *   CRT002
      * CALLED BY  FIRST  - Initial Processing                        *   CRT002
      *            WRKACC - Work with account                         *   CRT002
      *                                                               *   CRT002
      * FLDS USED         -                                           *   CRT002
      *                                                               *   CRT002
      *****************************************************************   CRT002
      *                                                                   CRT002
     C           DTQERR    BEGSR                           ** DTQERR **   CRT002
      *                                                                   CRT002
     C                     CLEARREPEQO                                    CRT002
      *                                                                   CRT002
     C                     MOVE RJMSTY    RKMSTY                          CRT002
     C                     MOVELERCD      RKHMSI                          CRT002
     C                     MOVELERMSG     RKHSMS                          CRT002
     C                     MOVE 'W'       RKHMSS                          CRT002
      *                                                                   CRT002
     C                     MOVE 'N'       WSUCM                           CRT002
     C                     MOVE 'DS'      WSTAT                           CRT002
     C                     TIME           WTMDS                           CRT002
     C           WTHR      CAT  ':'       WA                              CRT002
     C           WTMN      CAT  ':'       WB                              CRT002
     C           WA        CAT  WB        WC                              CRT002
     C           WC        CAT  WTSS      WSTTM                           CRT002
     C                     MOVELWSTTM     WCMTM                           CRT002
      *                                                                   CRT002
     C                     EXSR MOVDTQ                                    CRT002
      *                                                                   CRT002
     C                     ENDSR                           ** DTQERR **   CRT002
      *****************************************************************   CRT002
     C/EJECT                                                              CRT002
      *****************************************************************   CRT002
      *                                                               *   CRT002
      *            WRLOG  - Format screen to output to data queue     *   CRT002
      *                                                               *   CRT002
      * CALLS             -                                           *   CRT002
      *                                                               *   CRT002
      * CALLED BY  DFPROC - Display File Processing.                  *   CRT002
      *            MOVDTQ - Send Details to Dataqueue.                *   CRT002
      *            *PSSR  - Program Error.                            *   CRT002
      *                                                               *   CRT002
      * FLDS USED         -                                           *   CRT002
      *                                                               *   CRT002
      *****************************************************************   CRT002
     C           WRLOG     BEGSR                                          CRT002
      *                                                                   CRT002
     C           WCMSQ     CHAINREPLOGL0             80                   CRT002
      *                                                                   CRT002
     C           *IN80     IFEQ '0'                                       CRT002
      *                                                                   CRT002
     C                     MOVELWBRCA     RIBRCA                          CRT002
     C                     MOVELWUSID     RITELD                          CRT002
     C                     MOVELWSUCM     RISUCM                          CRT002
     C                     MOVELWCMTM     RITMPS                          CRT002
     C                     MOVELWSTAT     RISTAT                          CRT002
     C                     MOVELWSTTM     RISTTM                          CRT002
     C                     MOVELWCMSG     RICMSG                          CRT002
     C                     MOVELWRCTM     RIRCTM                          CRT002
     C                     MOVELWRCDT     RIRCDT                          CRT002
     C                     UPDATREPLOGD0                                  CRT002
      *                                                                   CRT002
     C                     ELSE                                           CRT002
     C           *LOCK     IN   LDA                                       CRT002
     C                     MOVEL'REPLOGL0'DBFILE                          CRT002
     C                     Z-ADD32        DBASE                           CRT002
     C                     MOVELWCMSQ     DBKEY                           CRT002
     C                     EXSR DBSR                                      CRT002
     C                     ENDIF                                          CRT002
      *                                                                   CRT002
     C                     ENDSR                                          CRT002
     C*****************************************************************   CRT002
      /EJECT                                                              CRT002
      *****************************************************************                       CER016
      *                                                               *                       CER016
      *  SRINT0 - Subroutine to calculate interest for Retail type    *                       CER016
      *           account (Method 0)                                  *                       CER016
      *                                                               *                       CER016
      *  Called By: ZIC00, ZIC01 and ZIC02 Subroutine                 *                       CER016
      *                                                               *                       CER016
      *  Calls: None                                                  *                       CER016
      *                                                               *                       CER016
      *****************************************************************                       CER016
      *                                                                                       CER016
     C           SRINT0    BEGSR                                                              CER016
      *                                                                                       CER016
     C                     MOVE CDP       WNDP    10                                          CER016
     C                     Z-ADD1         WNDTMP 150                                          CER016
      *                                                                                       CER016
     C           WNDP      IFEQ 0                                                             CER016
     C                     Z-ADD1         WNDTMP 150                                          CER016
     C                     ELSE                                                               CER016
      *                                                                                       CER016
     C                     DO   WNDP                                                          CER016
     C           10        MULT WNDTMP    WNDTMP                                              CER016
     C                     ENDDO                                                              CER016
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C           WAMT      MULT ZDAYN2    WINAMT 150                                          CER016
     C           WINAMT    DIV  100       WNAMT1 150H                                         CER016
     C           WNAMT1    DIV  WNDTMP    WNAMT2 150H                                         CER016
     C           WNAMT2    MULT WNDTMP    WRKFLD 150                                          CER016
     C           WRKFLD    MULT WRATE     ZINT1  150                                          CER016
     C                     SELEC                                                            MD035448
     C           ZICALC    WHEQ 4                                                           MD035448
     C           ZICALC    OREQ 1                                                           MD035448
     C           ZINT1     DIV  365       ZINT2  150H                                       MD035448
     C           ZICALC    WHEQ 6                                                           MD035448
     C           ZINT1     DIV  366       ZINT2                                             MD035448
     C                     OTHER                                                            MD035448
     C           ZINT1     DIV  360       ZINT2  150H                                         CER016
     C                     ENDSL                                                            MD035448
     C                     Z-ADDZINT2     ZINTR                                               CER016
      *                                                                                       CER016
     C                     ENDSR                                                              CER016
      *****************************************************************                       CER016
      /EJECT                                                                                  CER016
      *****************************************************************                       CER016
      *                                                               *                       CER016
      *  SRAOS - Subroutine to call AOSVALR0 for New system valuele   *                       CER016
      *          Interest Number                                      *                       CER016
      *                                                               *                       CER016
      *  Called By: INTCAL Subroutine                                 *                       CER016
      *                                                               *                       CER016
      *  Calls: AOSVALR0                                              *                       CER016
      *                                                               *                       CER016
      *****************************************************************                       CER016
      *                                                                                       CER016
     C           SRAOS     BEGSR                                                              CER016
     C                     MOVE 'N'       WFIRST                                              CER016
      *                                                                                       CER016
     C                     CALL 'AOSVALR0'                                                    CER016
     C                     PARM *BLANKS   PRTCD   7                                           CER016
     C                     PARM PSYSVL    PSVLK1 20                                           CER016
     C                     PARM           PSVL1 200                                           CER016
     C                     PARM *BLANKS   PSVLK2 20                                           CER016
     C                     PARM           PSVL2 200                                           CER016
     C                     PARM *BLANKS   PSVLK3 20                                           CER016
     C                     PARM           PSVL3 200                                           CER016
     C                     PARM *BLANKS   PSVLK4 20                                           CER016
     C                     PARM           PSVL4 200                                           CER016
     C                     PARM *BLANKS   PSVLK5 20                                           CER016
     C                     PARM           PSVL5 200                                           CER016
     C                     PARM *BLANKS   PSVLK6 20                                           CER016
     C                     PARM           PSVL6 200                                           CER016
     C                     PARM *BLANKS   PSVLK7 20                                           CER016
     C                     PARM           PSVL7 200                                           CER016
     C                     PARM *BLANKS   PSVLK8 20                                           CER016
     C                     PARM           PSVL8 200                                           CER016
     C                     PARM *BLANKS   PSVLK9 20                                           CER016
     C                     PARM           PSVL9 200                                           CER016
     C                     PARM *BLANKS   PSVLK0 20                                           CER016
     C                     PARM           PSVL10200                                           CER016
      *                                                                                       CER016
     C           PRTCD     IFNE *BLANKS                                                       CER016
     C           PSVL1     ANDEQ'*NRF'                                                        CER016
      *                                                                                       CER016
     C                     EXSR *PSSR                                                         CER016
     C                     ELSE                                                               CER016
      *                                                                                       CER016
     C                     MOVELPSVL1     PINTN   1                                           CER016
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C                     ENDSR                                                              CER016
      *****************************************************************                       CER016
      /EJECT                                                                                  CER016
      *****************************************************************                       CER016
      *                                                               *                       CER016
      *  SRDSP - Subroutine to DISPLAY Interest Number and Allocated  *                       CER016
      *          Overdraft Lines and Additional Overdraft Rate        *                       CER016
      *                                                               *                       CER016
      *  Called By: MAIN Processing                                   *                       CER016
      *                                                               *                       CER016
      *  Calls: ZEDIT                                                 *                       CER016
      *                                                               *                       CER016
      *****************************************************************                       CER016
      *                                                                                       CER016
     C           SRDSP     BEGSR                                                              CER016
      *                                                                                       CER016
     C           ZICALC    IFEQ 0                                                             CER016
     C           PINTN     ANDEQ'Y'                                                           CER016
     C                     MOVE *ON       *IN51                                               CER016
     C                     MOVE 'Y'       INTN    1                                           CER016
     C                     ELSE                                                               CER016
      *                                                                                       CER016
     C                     MOVE *OFF      *IN51                                               CER016
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C           CER016    IFEQ 'Y'                                                           CER016
     C           RHISB     IFGT *ZEROS                                                        CER016
     C           MNBL      ORGT *ZEROS                                                        CER016
     C                     MOVE *ON       *IN52                                               CER016
     C                     MOVE FODLN     DODLN                                               CER016
     C                     MOVE ATAODR    WUZASF 16                                           CER016
      *                                                                                       CER016
     C                     CALL 'ZEDIT'                90                                     CER016
     C           WUZASF    PARM WUZASF    WQ0001 16                                           CER016
     C                     PARM 7         WQ0002  10                                          CER016
      *                                                                                       CER016
     C           *IN90     IFEQ '1'                                                           CER016
     C           *LOCK     IN   LDA                                                           CER016
     C                     MOVEL'ZEDIT'   DBKEY                                               CER016
     C                     MOVEL'RE3360'  DBFILE                                              CER016
     C                     Z-ADD045       DBASE                                               CER016
     C                     OUT  LDA                                                           CER016
     C                     EXSR *PSSR                                                         CER016
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C                     MOVE WUZASF    DAODR                                               CER016
     C                     ELSE                                                               CER016
      *                                                                                       CER016
     C                     MOVE *OFF      *IN52                                               CER016
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C                     ELSE                                                               CER016
     C                     MOVE *OFF      *IN52                                               CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C                     ENDSR                                                              CER016
      *****************************************************************                       CER069
     C/SPACE 5                                                                                CER069
      *****************************************************************                       CER069
      * Subroutine  :  SRACTX                                         *                       CER069
      * Function    :  Retrieve customer details by country of tax    *                       CER069
      *                                                               *                       CER069
      * Called by   :  SREUTX, WTAXSR                                 *                       CER069
      * Calls       :  AOACTXR0                                       *                       CER069
      *****************************************************************                       CER069
     C           SRACTX    BEGSR                                                              CER069
      *                                                                                       CER069
     C                     CALL 'AOACTXR0'                                                    CER069
     C                     PARM *BLANKS   @RTCD                                               CER069
     C                     PARM '*KEY'    @OPTN                                               CER069
     C                     PARM ATCNUM    PCUST                                               CER069
     C                     PARM ATBRCA    PBRCA                                               CER069
     C           SDACTX    PARM SDACTX    DSFDY                                               CER069
      *                                                                                       CER069
     C           @RTCD     IFNE *BLANKS                                                       CER069
     C           AXETXS    OREQ ' '                                                           CER069
     C           AXETXS    OREQ 'S'                                                           CER069
     C           AXETXS    OREQ 'E'                                                           CER069
     C           AXETXS    OREQ 'D'                                                           CER069
     C                     MOVE 'N'       ATITAX                                              CER069
     C                     ELSE                                                               CER069
     C                     MOVE AXETXS    ATITAX                                              CER069
     C                     ENDIF                                                              CER069
      *                                                                                       CER069
     C                     ENDSR                                                              CER069
      *****************************************************************                       CER016
      /EJECT                                                                                  CER016
      *****************************************************************                       CER016
      *                                                                                       CER016
      /COPY ZSRSRC,RBRMSGC1                                               CRT002
      *                                                                   CRT002
      /EJECT                                                              CRT002
      /COPY ZSRSRC,RBSDQMS                                                CRT002
      *                                                                   CRT002
      /EJECT                                                              CRT002
      /COPY ZSRSRC,RBRDQMS                                                CRT002
      *                                                                   CRT002
      /EJECT                                                              CRT002
      /COPY ZSRSRC,ZFRPEDZ3                                               CRT002
      *                                                                   CRT002
     C/EJECT
     C*****************************************************************
     C**
     C** ZDATE1 Subroutine to convert a date format to a day number.
     C**
     C**     Called by       DATEIN
     C**     Calls           -
     C**
     C/COPY ZSRSRC,ZDATE1Z2
     C*
     C*****************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C** ZDATE2 Subroutine to convert a day number to date formats.
     C**
     C**     Called by       DATEIN, MAIN, ZICD
     C**     Calls           -
     C**
     C/COPY ZSRSRC,ZDATE2Z2
     C*
     C*****************************************************************
     C/EJECT
     C* ADD MESSAGE 'UNABLE TO ALLOCATE RECORD' IN ERCM
     C* ADD 3 MESSAGES FOR BRANCH VALIDATION/AUTHORISATION IN ERCM
** CPY@ OBJECT COPYRIGHT
(c) Finastra International Limited 2001
** ZYDY - YEARS IN DAYS CUMULATIVE IN FOUR YEAR SPAN
0366073110961461
** ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
** ZMNM - MONTH SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   ERCM - ERROR MESSAGES
A/C DETAILS OR RETAIL A/C NUMBER MUST BE ENTERED
RECORD NOT FOUND ON RETAIL INTEREST/CHARGES FILE
RECORD NOT FOUND ON RETAIL A/C NUMBERS FILE
INPUT EITHER A CUSTOMER A/C NO. OR A RETAIL A/C NO. - BUT NOT BOTH
ACCOUNT CLOSED
UNABLE TO ALLOCATE RECORD
BRANCH ENTERED IS INVALID OR NOT VALID FOR USER
USER IS NOT AUTHORISED TO ANY BOOKING BRANCHES
USER IS NOT AUTHORISED TO THE BOOKING BRANCH
RETAIL HISTORY RECORDS OF ACCOUNT ALREADY DROPPED                                             262397
