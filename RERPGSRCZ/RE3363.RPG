     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Interest details enquiry')                    *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module
     F*                                                               *
     F*  RE3363 - RETAIL LINK ENQUIRY                                 *
     F*           RETAIL INTEREST DETAILS                             *
     F*                                                               *
      *  (c) Misys International Banking Systems Ltd. 2001            *
     F*                                                               *
      *  Last Amend No. CGL186             Date 06Oct17               *
      *  Prev Amend No. MD027025A          Date 20Jun14               *
      *                 MD027245           Date 12Jun14               *
      *                 MD027025           Date 23May14               *
      *                 MD027139           Date 22May14               *
      *                 MD027052           Date 20May14               *
      *                 MD026964           Date 16May14               *
      *                 MD026963           Date 16May14               *
      *                 MD026817           Date 12May14               *
      *                 MD026757           Date 12May14               *
      *                 CRE090             Date 14Feb14               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
     F*                 239964             Date 30Jun06               *
      *                 240079             Date 09Jun06               *
      *                 239966             Date 08Jun06               *
      *                 CSD027             Date 09Dec05               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 21Apr04               *
      *                 CGL029             Date 01Sep03               *
      * Midas Release 4.01 -------------------------------------------*
      *                 192551             Date 20Nov01               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 159536             Date 29Apr99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
      *                 125622             Date 26Feb98               *
     F*                 106210             DATE 19JAN98               *
     F*                 125857             DATE 17MAR97               *
     F*                 101476             DATE 26APR96               *
     F*                 098818             DATE 15APR96               *
     F*                 094431             DATE 16OCT95               *
     F*                 092181             DATE 09OCT95               *
     F*                 090958             DATE 09OCT95               *
     F*                 092564             DATE 29SEP95               *
     F*                 088734             DATE 28JUN95               *
     F*                 086373             DATE 09MAY95               *
     F*                 077176             DATE 18OCT94               *
     F*                 075195             DATE 08SEP94               *
     F*                 075072             DATE 08SEP94               *
     F*                 074600             DATE 11AUG94               *
     F*                 074590             DATE 26JUL94               *
     F*                 049765             DATE 28SEP93               *
     F*                 046091             DATE 28SEP93               *
     F*                 044314             DATE 28SEP93               *
     F*                 048574             DATE 28SEP93               *
     F*                 S01413 *CREATE     DATE 13APR93               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  CGL186 - Customer Report Name on Enquiries                   *
      *         - Add Cust Report Name to Account Movements & OSIC.   *
      *  MD027025A - Incorrect details shown in Interest Details      *
      *              Enquiry of a delayed capitalisation record.      *
      *  MD027245 - Interest capitalisation not performed on delay    *
      *             date when demand capitalisation was requested     *
      *             during delay period.                              *
      *  MD027025 - Incorrect screen shown for Interest Details       *
      *             Enquiry of a delayed capitalisation record.       *
      *  MD027139 - Missing screen title and menu keys on accounts    *
      *             without capitalisation record.                    *
      *  MD027052 - Demand capitalisation not executed for bulk       *
      *             request on accounts with either Cr or Dr on delay.*
      *  MD026964 - Capitalised Interest Enquiry not working on       *
      *             delayed accounts that have never capitalised.     *
      *  MD026963 - No outstanding interest record displayed for      *
      *             delayed accounts for first day accrual.           *
      *  MD026817 - Inconsistent displayed details on accounts for    *
      *             first day accruals.                               *
      *  MD026757 - Incorrect date displayed on delayed cap. of       *
      *             interest for first day accruals.                  *
      *  CRE090 - Delay Capitalisation of Interest                    *
      *  239964 - Applied fix 239966.                                 *
      *  240079 - Applied fix 239966.                                 *
      *  239966 - Remove transfer job.                                *
      *           Use OVRDBF SHARE(*NO) for REHISL.                   *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Reverse image is showing in Webface without error.  *
      *           Recompile due to changes in RE3360DF.               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  192551 - Amend program to default account name without       *
      *           any condition.                                      *
     F*  159536 - Recompile due to changes in RE3360DF.               *
     F*  125622  -  Outstanding charge amount displayed for a/c which *
     F*             is non-chargeable. Applied fix 122256.            *
     F*  106210 - Incorrect cap. periods displayed once an a/c which  *
     F*           had a closure cap. the previous day is selected.    *
     F*  125857 - After SUBEND writes out ACCRACJ record, when you    *
     F*           roll up, causes duplicate record on RE3363B1.       *
     F*  101476 - If Previous Cap Period End was attempted acc closure*
     F*           do not SUB 1 from the CLDID and CLCID before a call *
     F*           to RE3364E.                                         *
     F*  098818 - The useage if SCICI/SDICI flags within COB is changed
     F*           to retain the original values of C,D,Y & ' '.       *
     F*           This should allow the I/C enquiries to differenciate*
     F*           between Attempted Closure, Capitalisation & Demand  *
     F*           Capitalisation and allow for adjustemt to HISD for  *
     F*           Capitalisatrion without causing the corruption of the
     F*           same HISD for the Atempted Account Closure (XXICI=C)*
     F*  101476 - Pgm changed to pass correct Last/Next Capitalisation*
     F*           Dates for both DR and CR sides when the DR Cap Date *
     F*           (Last) *NE Last CR Cap Date. SCICI/SDICI values may *
     F*           be Y,D,C  or ' ', and not as the pgm assumes Y, or  *
     F*           ' ' only.                                           *
     F*  094431 - Manual adjustments are not displayed on last line.  *
     F*  092181 - If 1st day accruals and 1 side (DR or CR) cap'd the *
     F*           day before rundate (ie. value date = rundate),      *
     F*           selection of latest date (now rundate - 1) should   *
     F*           only show interest for the side which didn't        *
     F*           capitalise as otherwise a report for zero days will *
     F*           be produced for the side which capitalised.         *
     F*  090958 - For 1st day accruals, display actual cap. date      *
     F*           instead of cap. value date and display rundate - 1  *
     F*           as latest date if displayed as a selection date     *
     F*           (ie. only 1 side cap'd the day before rundate).     *
     F*           NB. This is only a cosmetic change; the periods     *
     F*           displayed by RE3364E are still the same.            *
     F*  092564 - Interest appears incorrectly with DR and CR only    *  *
     F*           capitalisation dates.                               *  *
     F*  088734 - Show minimum/maximum amounts. Recompiled only.      *
     F*  086373 - If CMD3 returned from called program process as if  *
     F*           CMD3 entered in this program .                      *
     F*           CMD3 - generally - return to menu .                 *
     F*  077176 - PREVENT SUBFILE ERROR FOR A/C'S OPENED TODAY        *
     F*  075195 - For accounts which have not yet capitalised, DB     *
     F*           error caused in RE3364E.                            *
     F*  075072 - Number of days incorrect for last period (RE3364E)  *
     F*  074600 - DB errors in RE3664E not reported to screen.        *
     F*  074590 - Add account name to screen format.                  *
     F*  049765 - DB error caused by 46091 for accounts which         *
     F*           did not capitailse yet - Only CHISD should be       *
     F*           changed for first day accruals. Not PDID/PCID       *
     F*  046091 - If first day accruals wrong date generated for      *
     F*           last record in subfile (ACCRACJ record) and         *
     F*           passed to RE3364E (DB error on REHISL)              *
     F*  044314 - Only one page shown even when more                  *
     F*           capitailsation dates on file                        *
     F*  048574 - Use parameters passed from RE3360 to output         *
     F*           accrued interest instead of DAIC1 and CAIC1         *
     F*           from the file REACRD                                *
     F*  S01413 - Retail 3 Incorporation                              *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     FREHISL  IF  E           K        DISK
     F            REHISPPF                          KIGNORE
     F            REHISPMF                          KIGNORE
     FACCRACJ IF  E           K        DISK                           UC
     FRE3360DFCF  E                    WORKSTN
     F                                        RN    KSFILE RE3363B1
     F**********                              RN    KSFILE RE3363B2                           CRE090
     F                                        RN2   KSFILE RE3363B2                           CRE090
     F            RE3360F1                          KIGNORE
     F            RE3361F0                          KIGNORE
     F            RE3361ER                          KIGNORE
     F            RE3361F1                          KIGNORE
     F            RE3361SB                          KIGNORE
     F            RE3361SC                          KIGNORE
     F            RE3362E0                          KIGNORE
     F            RE3362F0                          KIGNORE
     F            RE3362HE                          KIGNORE
     F            RE3362PB                          KIGNORE
     F            RE3362PC                          KIGNORE
     F            RE3364E3                          KIGNORE
     F            RE3364F3                          KIGNORE
     F            RE3364F1                          KIGNORE
     F            RE3364B1                          KIGNORE
     F            RE3364C1                          KIGNORE
     F            RE3364B2                          KIGNORE
     F            RE3364C2                          KIGNORE
     F            RE3364B3                          KIGNORE
     F            RE3364C3                          KIGNORE
     F*
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*       09       LOOP IN MAIN PROCESSING                        *
     F*       25       SFLCLR CONTROL                                 *
     F*       27       ROLLUP INDICATOR                               *
     F*       28       ROLLDOWN INDICATOR                             *
     F*       29       REVERSE IMAGE SELECT FIELD IF IN ERROR         *
     F*       30       ERROR IN SUBFILE SELECTION                     *
     F*       31       DISPLAY 'PRINT IN PROGRESS' MESSAGE            *
     F*       51       READ/CHAIN ERROR                               *
     F*       90       GENERAL PURPOSE INDICATOR                      *
     F*       96       NO INPUT IN SUBFILE                            *
     F*       98       DATE IN FORMAT 'MMDDYY'                        *
     F*                                                               *
     F*       KC       EXIT PROGRAM WITH CMD 3                        *
     F*       KL       EXIT PROGRAM WITH CMD 12                       *
     F*       KM       CALL 'RE3361'                                  *
     F*       KU       SWAP SUBFILE                                   *
     F*       KY       DISPLAY MORE FUNCTION KEYS                     *
     F*       LR       END OF PROGRAM                                 *
     F*                                                               *
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  CMD3   - End of group job if CMD 3 is pressed                *
     F*  CMD12  - Call previous program if CMD 12 is pressed          *
     F*  CMD13  - Call RE3361 if CMD 13 is pressed                    *
     F*  FIRST  - Performs initialisation                             *
     F*  FROM60 - Execute only if we come from re3360 or re3361       *
     F*  INIT   - Initialise subfiles fields                          *
     F*  KEYRE  - Swap display of available function keys             *
     F*  MOREDN - Check if more records available for next rolldown   *
     F*  MOREUP - Check if more records available for next rollup     *
     F*  PE3364 - Call RE3364 with print or enquiry option            *
     F*  ROLDN  - Refill subfile in case of rolldown                  *
     F*  ROLUP  - Refill subfile in case of rollup                    *
     F*  RSTENQ - Reset enquiry selection of CMD 12 taken from RE3364 *
     F*  SFLDSP - Swap from one subfile to the other                  *
     F*  SFLMOD - Handle subfile modification                         *
     F*  SUBEND - Add ACCRACJ record in subfile                       *
     F*  SUBFIL - Fill the subfile                                    *
     F*  SUBFMT - Format subfile fields                               *
     F*  ZDATE1 - Convert date in number of days                      *
     F*  ZDATE2 - Convert number of days in date                      *
     F*  ZEDIT  - Add decimal point and suppress leading zeroes       *
     F*  *PSSR  - Handles abnormal error conditions                   *
     F*                                                               *
     F*****************************************************************
     E/EJECT
     E                    WRK       365  5 0A
     E/COPY ZSRSRC,ZDATE2Z1
     E/COPY ZSRSRC,ZEDITZ1
     E*
     E                    NAR     1   3 79
     E*
     E                    TIT     1   2 30
     E*
     E                    CPY@    1   1 80
     E**********          CMD     1   2 41                                                    239966
     E                    CMD     1   3 45                                                    239966
     I/EJECT
     I*
     IACCRACJF
     I*
     I** Rename ACCRACJF format fields - ACCRACJ file
     I*
     I              DAIC1                           ZDAIC1
     I              CAIC1                           ZCAIC1
     IREHISPSF
     I*
     I** Rename REHISPSF format fields - REHISL file
     I*
     I              RECI                            CRECI
     I              BRCA                            CBRCA
     I              CNUM                            CCNUM
     I              CCY                             CCCY
     I              ACOD                            CACOD
     I              ACSQ                            CACSQ
     I              HISD                            CHISD
     I              HISB                            CHISB
     I              MNBL                            CMNBL
     I              PCHGAR                          CPHGAR
     I              TCHGAR                          CTHGAR
     I              PCHGAN                          CPHGAN
     I              TCHGAN                          CTHGAN
     I              DICT                            CDICT
     I              DRCB                            CDRCB
     I              DRIR                            CDRIR
     I              DRCD                            CDRCD
     I              DAIC                            CDAIC
     I              PMADI                           CPMADI
     I**************TMADI                           CTMADI                094431
     I              DMINT                           CDMINT
     I              SGADI                           CSGADI
     I              DRIP                            CDRIP
     I              SDICI                           CDICI
     I              DRIS                            CDRIS
     I              SDACP                           CSDACP
     I              SDCI                            CSDCI
     I              CICT                            CCICT
     I              CRCB                            CCRCB
     I              CRIR                            CCRIR
     I              CRCD                            CCRCD
     I              CAIC                            CCAIC
     I              PMACI                           CPMACI
     I**************TMACI                           CTMACI                094431
     I              CMINT                           CCMINT
     I              SGACI                           CSGACI
     I              CRIP                            CCRIP
     I              SCICI                           CCICI
     I              CRIS                            CCRIS
     I              SCACP                           CSCACP
     I              SCCI                            CSCCI
     I              STBL                            CSTBL
     I              CHGP                            CCHGP
     I              SCHAC                           CSCHAC
     I              MNBCP                           CMNBCP
     I              SCHGI                           CSCHGI
     ISRUNA       DS
     I*
     I** Data structures to transform date from DDMMMYY to DDMMYY
     I*
     I                                        1   2 SDY
     I                                        3   5 SMT
     I                                        6   7 SYR
     I*
     I            DS
     I                                        1   60ZDATE
     I                                        1   20ZDY
     I                                        3   40ZMT
     I                                        5   60ZYR
     IPSDS       SDS
     I*
     I** Retrieve WSID from program status data structure
     I*
     I                                      244 253 SWSID
     I                                      254 263 SUSER
     ISHISB       DS
     I*
     I** Data structure to handle negative history balance
     I*
     I                                        1  19 SHIS0
     I                                       20  21 SHIS1
     ISSTBL       DS
     I*
     I** Data structure to handle negative statement balance
     I*
     I                                        1  19 SSTB0
     I                                       20  21 SSTB1
     ISDIP        DS
     I*
     I** Data structure to handle negative debit interest
     I*
     I                                        1  12 SDIP0
     I                                       13  13 SDIP1
     ISDIA        DS
     I*
     I** Data structure to handle negative debit interest
     I*
     I                                        1  12 SDIA0
     I                                       13  13 SDIA1
     ISCIP        DS
     I*
     I** Data structure to handle negative credit interest
     I*
     I                                        1  12 SCIP0
     I                                       13  13 SCIP1
     ISCIA        DS
     I*
     I** Data structure to handle negative credit interest
     I*
     I                                        1  12 SCIA0
     I                                       13  13 SCIA1
     I*
     I            DS
     I*
     I** Data structure to override message file
     I*
     I**********                              1  41 CMD2                                      239966
     I                                        1  45 CMD2                                      239966
     I                                       31  32 WWLGID
     IDSLDA       DS
     I*
     I** Data structure to transfer parameters
     I*
     I                                        1   1 WTYP
     I                                        2   4 WBRCA
     I                                        2   4 KBRCA
     I                                        5  10 WCNUM
     I**********                              5  100KCNUM                                     CSD027
     I                                        5  10 KCNUM                                     CSD027
     I                                       11  13 WCCY
     I**********                             14  17 WACOD                                     CGL029
     I**********                             14  170KACOD                                     CGL029
     I**********                             18  19 WACSQ                                     CGL029
     I**********                             18  190KACSQ                                     CGL029
     I**********                             20  24 WHISD                                     CGL029
     I**********                             25  34 WACNO                                     CGL029
     I**********                             35  35 WZADEC                                    CGL029
     I**********                             36  42 WRUNA                                     CGL029
     I**********                             43  43 WDATF                                     CGL029
     I**********                             44  44 WCANC                                     CGL029
     I**********                             45  46 WFROM1                                    CGL029
     I**********                             47  48 WFROM2                                    CGL029
     I**********                             49  49 WPRINT                                    CGL029
     I**********                             50  50 WOPT                                      CGL029
     I**********                             51  63 DAICCH                             048574 CGL029
     I**********                             64  76 CAICCH                             048574 CGL029
     I                                       14  23 WACOD                                     CGL029
     I                                       14  230KACOD                                     CGL029
     I                                       24  25 WACSQ                                     CGL029
     I                                       24  250KACSQ                                     CGL029
     I                                       26  30 WHISD                                     CGL029
     I                                       31  40 WACNO                                     CGL029
     I                                       41  41 WZADEC                                    CGL029
     I                                       42  48 WRUNA                                     CGL029
     I                                       49  49 WDATF                                     CGL029
     I                                       50  50 WCANC                                     CGL029
     I                                       51  52 WFROM1                                    CGL029
     I                                       53  54 WFROM2                                    CGL029
     I                                       55  55 WPRINT                                    CGL029
     I                                       56  56 WOPT                                      CGL029
     I                                       57  69 DAICCH                                    CGL029
     I                                       70  82 CAICCH                                    CGL029
     I                                       83  85 FUNC                                      239966
     I*
     I** The remaining fields are defined exactly as in PF/RECAPM
     I*
     I                                      101 101 CRECI
     I                                      103 105 CBRCA
     I**********                            106 1110CCNUM                                     CSD027
     I                                      106 111 CCNUM                                     CSD027
     I                                      112 114 CCCY
     I**********                            115 1180CACOD                                     CGL029
     I**********                            119 1200CACSQ                                     CGL029
     I**********                          P 121 1230CHISD                                     CGL029
     I**********                          P 124 1310CHISB                                     CGL029
     I**********                          P 132 1390CMNBL                                     CGL029
     I**********                          P 140 1460CPHGAR                                    CGL029
     I**********                          P 147 1530CTHGAR                                    CGL029
     I**********                          P 154 1600CPHGAN                                    CGL029
     I**********                          P 161 1670CTHGAN                                    CGL029
     I**********                            168 1690CDICT                                     CGL029
     I**********                            170 1700CDRCB                                     CGL029
     I**********                          P 171 1767CDRIR                                     CGL029
     I**********                          P 177 1790CDRCD                                     CGL029
     I**********                          P 180 1870CDAIC                                     CGL029
     I**********                          P 188 1940CPMADI                                    CGL029
     I**********                          P 195 2010CTMADI                                    CGL029
     I**********                          P 202 2040CLDID                                     CGL029
     I**********                          P 205 2110CDMINT                                    CGL029
     I**********                          P 212 2180CSGADI                                    CGL029
     I**********                          P 219 2250CDRIP                                     CGL029
     I**********                            226 226 CDICI                                     CGL029
     I**********                          P 227 2330CDRIS                                     CGL029
     I**********                            234 248 CSDACP                                    CGL029
     I**********                            249 249 CSDCI                                     CGL029
     I**********                            250 2510CCICT                                     CGL029
     I**********                            252 2520CCRCB                                     CGL029
     I**********                          P 253 2587CCRIR                                     CGL029
     I**********                          P 259 2610CCRCD                                     CGL029
     I**********                          P 262 2690CCAIC                                     CGL029
     I**********                          P 270 2760CPMACI                                    CGL029
     I**********                          P 277 2830CTMACI                                    CGL029
     I**********                          P 284 2860CLCID                                     CGL029
     I**********                          P 287 2930CCMINT                                    CGL029
     I**********                          P 294 3000CSGACI                                    CGL029
     I**********                          P 301 3070CCRIP                                     CGL029
     I**********                            308 308 CCICI                                     CGL029
     I**********                          P 309 3150CCRIS                                     CGL029
     I**********                            316 330 CSCACP                                    CGL029
     I**********                            331 331 CSCCI                                     CGL029
     I**********                          P 332 3390CSTBL                                     CGL029
     I**********                          P 340 3460CCHGP                                     CGL029
     I**********                            347 361 CSCHAC                                    CGL029
     I**********                          P 362 3690CMNBCP                                    CGL029
     I**********                            370 370 CSCHGI                                    CGL029
     I**********                            371 372 LGID                                      CGL029
     I**********                            101 356 PSDTA1                                    CGL029
     I**********                            357 372 PSDTA2                                    CGL029
     I                                      115 1240CACOD                                     CGL029
     I                                      125 1260CACSQ                                     CGL029
     I                                    P 127 1290CHISD                                     CGL029
     I                                    P 130 1370CHISB                                     CGL029
     I                                    P 138 1450CMNBL                                     CGL029
     I                                    P 146 1520CPHGAR                                    CGL029
     I                                    P 153 1590CTHGAR                                    CGL029
     I                                    P 160 1660CPHGAN                                    CGL029
     I                                    P 167 1730CTHGAN                                    CGL029
     I                                      174 1750CDICT                                     CGL029
     I                                      176 1760CDRCB                                     CGL029
     I                                    P 177 1827CDRIR                                     CGL029
     I                                    P 183 1850CDRCD                                     CGL029
     I                                    P 186 1930CDAIC                                     CGL029
     I                                    P 194 2000CPMADI                                    CGL029
     I                                    P 201 2070CTMADI                                    CGL029
     I                                    P 208 2100CLDID                                     CGL029
     I                                    P 211 2170CDMINT                                    CGL029
     I                                    P 218 2240CSGADI                                    CGL029
     I                                    P 225 2310CDRIP                                     CGL029
     I                                      232 232 CDICI                                     CGL029
     I                                    P 233 2390CDRIS                                     CGL029
     I                                      240 260 CSDACP                                    CGL029
     I                                      261 261 CSDCI                                     CGL029
     I                                      262 2630CCICT                                     CGL029
     I                                      264 2640CCRCB                                     CGL029
     I                                    P 265 2707CCRIR                                     CGL029
     I                                    P 271 2730CCRCD                                     CGL029
     I                                    P 274 2810CCAIC                                     CGL029
     I                                    P 282 2880CPMACI                                    CGL029
     I                                    P 289 2950CTMACI                                    CGL029
     I                                    P 296 2980CLCID                                     CGL029
     I                                    P 299 3050CCMINT                                    CGL029
     I                                    P 306 3120CSGACI                                    CGL029
     I                                    P 313 3190CCRIP                                     CGL029
     I                                      320 320 CCICI                                     CGL029
     I                                    P 321 3270CCRIS                                     CGL029
     I                                      328 348 CSCACP                                    CGL029
     I                                      349 349 CSCCI                                     CGL029
     I                                    P 350 3570CSTBL                                     CGL029
     I                                    P 358 3640CCHGP                                     CGL029
     I                                      365 385 CSCHAC                                    CGL029
     I                                    P 386 3930CMNBCP                                    CGL029
     I                                      394 394 CSCHGI                                    CGL029
     I                                      395 396 LGID                                      CGL029
     I                                      101 356 PSDTA1                                    CGL029
     I                                      357 396 PSDTA2                                    CGL029
     I                                      397 401 PNDID                                     CRE090
     I                                      402 406 PNCID                                     CRE090
     I                                      407 419 PDCHGA                                    CRE090
     I                                      420 434 PHISB1                                    CRE090
     I                                      435 449 PHISB2                                    CRE090
     I                                      450 464 PCAP1                                     CRE090
     I                                      465 479 PCAP2                                     CRE090
     I                                      480 492 PDRACD                                    CRE090
     I                                      493 505 PCRACD                                    CRE090
     I                                      506 520 PINT1                                  MD027025A
     I                                      521 535 PINT2                                  MD027025A
     I                                      536 536 SIND2                                  MD027025A
     I                                      537 549 PDRADJ                                 MD027025A
     I                                      550 562 PCRADJ                                 MD027025A
     ISRCA        DS
     I*
     I** Data structures to calculate interest fields
     I*
     I                                        1  130SRCAN
     IMSGDTA      DS
     I*
     I** Data structure to containing message data for ZA0440
     I*
     I                                        1   30YPRT
     I                                        4   60NPRT
     I*
     ILDA         DS                            256
     I*
     I** Local data area - database errors
     I*
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     ISDBANK    E DSSDBANKPD
     I*
     I** Data structure for bank details
     I*
     I*
     ISDRETL    E DSSDRETLPD
     I*
     I** Data structure for retail details
     I*
     IDSFDY     E DSDSFDY
     I*
     I** First DS for access programs, short data structure
     I*
     ISCSARD    E DSSCSARDPD                                                                  CRE090
     I*                                                                                       CRE090
     I** Data structure for Switchable features details                                       CRE090
     I*                                                                                       CRE090
     ISDCUST    E DSSDCUSTPD                                                                  CGL186
      ** Data structure for Customer Details                                                  CGL186
      *                                                                                       CGL186
     IDSLDY     E DSDSLDY                                                                     CGL186
      ** Second DS for access programs, Long data structure                                   CGL186
      *                                                                                       CGL186
     I/COPY WNCPYSRC,RE3363I001
     C/EJECT
     C*===================================================================
     C*
     C** Copyright Insertion
     C*
     C                     MOVEACPY@      BIS@   80
      *                                                                   098818
      ** Initialise Last Acc. Closure Attempt Date                        098818
      *                                                                   098818
     C           *LIKE     DEFN CHISD     LCLOSE                          098818
     C                     Z-ADD*ZEROS    LCLOSE                          098818
     C*
     C** Key field to access to REHISL
     C*
     C           KEYL6     KLIST
     C                     KFLD           KBRCA
     C                     KFLD           KCNUM
     C                     KFLD           WCCY
     C                     KFLD           KACOD
     C                     KFLD           KACSQ
     C                     KFLD           CHISD
     C*
     C** Key field to access to ACCRACJ
     C*
     C           KEYL5     KLIST
     C                     KFLD           KBRCA
     C                     KFLD           KCNUM
     C                     KFLD           WCCY
     C                     KFLD           KACOD
     C                     KFLD           KACSQ
     C*
     C           *NAMVAR   DEFN *LDA      DSLDA
     C           *NAMVAR   DEFN           LDA
     C*
     C** Work fields definitions
     C*
     C           *LIKE     DEFN ACOD      ACODB
     C           *LIKE     DEFN ACSQ      ACSQB
     C           *LIKE     DEFN BRCA      BRCAB
     C           *LIKE     DEFN CNUM      CNUMB
     C           *LIKE     DEFN CHISD     HISDD
     C           *LIKE     DEFN CHISD     HISDU
     C           *LIKE     DEFN CHISD     LASTR
     C           *LIKE     DEFN RN        SFLTYP
     C           *LIKE     DEFN RN        COUNT
     C           *LIKE     DEFN WCCY      PARAM + 7
     C           *LIKE     DEFN WCCY      WCCYB
     C           *LIKE     DEFN HISB      WWHISB
     C           *LIKE     DEFN RN        RN2                                                 CRE090
     C           *LIKE     DEFN RN        WRN                                               MD027139
     C           *LIKE     DEFN CDAIC     WCDAIC                                           MD027025A
     C           *LIKE     DEFN CCAIC     WCCAIC                                           MD027025A
     C           *LIKE     DEFN CDAIC     WDRADJ                                           MD027025A
     C           *LIKE     DEFN CCAIC     WCRADJ                                           MD027025A
     C*
     C/EJECT
     C*===================================================================
     C** P R O G R A M     S T A R T
     C*===================================================================
     C*
     C                     EXSR FIRST
     C*
     C** Start processing - loop until F3
     C*
     C                     OPEN ACCRACJ
     C*
     C* Set up program queue for message subfile
     C*
     C                     MOVEL'*'       DDPGMQ
     C*
     C                     Z-ADD0         WDRADJ                                           MD027025A
     C                     Z-ADD0         WCRADJ                                           MD027025A
     C                     MOVE *BLANKS   PDRADJ                                           MD027025A
     C                     MOVE *BLANKS   PCRADJ                                           MD027025A
      *                                                                                    MD027025A
     C           *IN09     DOWEQ'0'                        - B1
     C           EXTFLG    ANDEQ'N'                                                           239966
     C*
     C** Reading DSLDA
     C*
     C                     IN   DSLDA
      *                                                                                       CRE090
      ** Check if interest capitalisation delayed                                             CRE090
      **   for Debit, Credit, or both                                                         CRE090
      *                                                                                       CRE090
     C                     MOVE 'N'       WDRDLY  1                                           CRE090
     C                     MOVE 'N'       WCRDLY  1                                           CRE090
     C                     Z-ADD0         WCHGAR 130                                          CRE090
     C           CRE090    IFEQ 'Y'                        - B1                               CRE090
      *                                                                                       CRE090
     C                     MOVE PNDID     WNDID0  50                                          CRE090
     C                     MOVE PNCID     WNCID0  50                                          CRE090
     C                     MOVE PDCHGA    WCHGAR                                              CRE090
      *                                                                                       CRE090
     C           WNDID0    IFLE PRDNB                      - B2                               CRE090
     C           WNDID0    ANDNE0                                                             CRE090
     C           WNDID0    ANDEQWNCID0                                                        CRE090
     C                     MOVE 'B'       WDRDLY                                              CRE090
     C                     MOVE 'B'       WCRDLY                                              CRE090
     C                     ELSE                            - X2                               CRE090
     C           WNDID0    IFLE PRDNB                      - B3                               CRE090
     C           WNDID0    ANDNE0                                                             CRE090
     C                     MOVE 'Y'       WDRDLY                                              CRE090
     C                     ENDIF                           - E3                               CRE090
     C           WNCID0    IFLE PRDNB                      - B3                               CRE090
     C           WNCID0    ANDNE0                                                             CRE090
     C                     MOVE 'Y'       WCRDLY                                              CRE090
     C                     ENDIF                           - E3                               CRE090
     C                     ENDIF                           - E2                               CRE090
     C           WDRDLY    IFEQ 'N'                                                        MD027025A
     C           WCRDLY    ANDEQ'N'                                                        MD027025A
     C                     MOVE *BLANKS   PDRADJ                                           MD027025A
     C                     MOVE *BLANKS   PCRADJ                                           MD027025A
     C                     ENDIF                                                           MD027025A
      *                                                                                       CRE090
     C                     ENDIF                           - E1                               CRE090
      *                                                                                       CGL186
      ** Access Customer details.                                                             CGL186
      *                                                                                       CGL186
     C                     CALL 'AOCUSTR2'                                                    CGL186
     C                     PARM *BLANKS   P@RTCD  7                                           CGL186
     C                     PARM '*KEY'    P@OPTN  7                                           CGL186
     C                     PARM WCNUM     P@KEY1 10                                           CGL186
     C                     PARM           P@ANY   7                                           CGL186
     C           SDCUST    PARM SDCUST    DSLDY                                               CGL186
      *                                                                                       CGL186
     C/COPY WNCPYSRC,RE3363C003
     C*
     C** Don't fill the subfile if we come from RE3364
     C*
     C           WFROM2    IFNE '64'                       - B2
     C                     EXSR FROM60
     C                     END                             - E2
     C*
     C                     WRITERE3363F0
     C                     WRITERE3363F3
     C*
     C** If no errors in subfile selection to display, position cursor
     C** on first record
     C*
     C           *IN30     IFNE '1'
     C                     Z-ADD1         RN
     C                     Z-ADD1         RN2                                                 CRE090
     C                     END
     C*
     C           SFLTYP    IFEQ 1                          - B2
     C                     WRITERE3363F1
     C                     EXFMTRE3363C1
     C                     READCRE3363B1                 96
     C                     ELSE                            - X2
     C                     WRITERE3363F2
     C**********           EXFMTRE3363C2                                                    MD026964
     C                     EXFMTRE3363C2               91                                   MD026964
     C           *IN91     IFEQ '0'                        - B3                             MD026964
     C                     READCRE3363B2                 96
     C                     ELSE                            - X3                             MD026964
     C                     MOVE *BLANKS   SIND                                              MD026964
     C                     MOVE *BLANKS   SIND2                                             MD026964
     C                     MOVE *BLANKS   SSTBL                                             MD026964
     C                     MOVE '-  '     SSTBL                                             MD026964
     C                     MOVE *BLANKS   SDIP                                              MD026964
     C                     MOVE *BLANKS   SCIP                                              MD026964
     C                     MOVE *BLANKS   SCHGP                                             MD026964
     C                     WRITERE3363B2                                                    MD026964
     C                     EXFMTRE3363C2                                                    MD026964
     C                     SETON                     96                                     MD026964
     C                     ENDIF                           - E3                             MD026964
     C                     END                             - E2
     C*
     C* Clear program message queue
     C*
     C                     CALL 'ZA0250'
     C                     WRITERE3363C3
     C*
     C           *INKC     CASEQ'1'       CMD3
     C           *INKL     CASEQ'1'       CMD12
     C           *INKM     CASEQ'1'       CMD13
     C           *INKU     CASEQ'1'       SFLDSP
     C           *INKY     CASEQ'1'       KEYRE
     C********** *IN96     CASEQ'0'       SFLMOD                          044314
     C           *IN27     CASEQ'1'       ROLUP
     C           *IN28     CASEQ'1'       ROLDN
     C           *IN96     CASEQ'0'       SFLMOD                          044314
     C                     END
     C*
     C                     END                             - E1 IF F3
     C*
     C                     CLOSEACCRACJ
     C*
     C                     MOVE '1'       *INLR
     C*
     C*===================================================================
     C** P R O G R A M     E N D
     C*===================================================================
     C/EJECT
     C********************************************************************
     C**
     C** CMD3 End of group job if CMD3 pressed
     C**
     C**     Called by       START
     C**     Calls           -
     C**
     C           CMD3      BEGSR                           **CMD3 BEGSR**
     C*
     C                     MOVE '1'       *IN09
     C                     MOVEL'F03'     FUNC                                                239966
     C                     OUT  DSLDA                                                         239966
     C*
     C                     ENDSR                           **CMD3 ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** CMD12  Call previous program if CMD12 pressed
     C**
     C**     Called by       START
     C**     Calls           INIT
     C**
     C           CMD12     BEGSR                           **CMD12 BEGSR**
     C*
     C** Return control to previous enquiry via group job
     C*
     C** CMD12 - Initial screen
     C*
     C                     EXSR INIT
     C*
     C**********           CALL 'RE360C'                                                      239966
     C**********           PARM 'RE3360 ' PARAM                                               239966
     C                     MOVEL'F12'     FUNC                                                239966
     C                     OUT  DSLDA                                                         239966
     C                     MOVE 'Y'       EXTFLG                                              239966
     C*
     C                     ENDSR                           **CMD12 ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** CMD13  Call RE3361 if CMD13 pressed
     C**
     C**     Called by       START
     C**     Calls           INIT
     C**
     C           CMD13     BEGSR                           **CMD13 BEGSR**
     C*
     C** Transfer control to other enquiries via group job
     C*
     C** CMD13 - History position
     C*
     C                     EXSR INIT
     C*
     C                     MOVE *BLANKS   WFROM2
     C                     MOVEL'F13'     FUNC                                                239966
     C                     OUT  DSLDA
     C                     MOVE 'Y'       EXTFLG                                              239966
     C**********           CALL 'RE360C'                                                      239966
     C**********           PARM 'RE3361 ' PARAM                                               239966
     C*
     C                     ENDSR                           **CMD13 ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** FIRST Subroutine to perform initialisation.
     C**
     C**     Called by     START
     C**     Calls         -
     C**
     C           FIRST     BEGSR                           **FIRST BEGSR**
     C*
     C** Prepare LDA variables
     C*
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3363'  DBPGM
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     Z-ADD0         DBASE
     C                     OUT  LDA
     C*
     C** Get bank details
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C** Check if error
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     Z-ADD001       DBASE            ***************
     C                     MOVE 'SDBANKPD'DBFILE           * DBERROR 001 *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C           BJRDNB    SUB  1         PRDNB   50                                          CRE090
     C/COPY WNCPYSRC,RE3363C001
     C*
     C** Access SDRETLPD
     C*
     C                     CALL 'AORETLR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDRETL    PARM SDRETL    DSFDY
     C*
     C** Check if error
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     Z-ADD002       DBASE            ***************
     C                     MOVE 'SDRETLPD'DBFILE           * DBERROR 002 *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR *PSSR
     C                     END
     C*
     C** Check if retail number present
     C*
     C           BMRANR    IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN69
     C                     END                             - E1
      *                                                                                       CRE090
      ** Access SAR details file to determine if CRE090 is installed                          CRE090
      *                                                                                       CRE090
     C                     MOVE 'N'       CRE090  1                                           CRE090
     C                     CALL 'AOSARDR0'                                                    CRE090
     C                     PARM *BLANKS   @RTCD                                               CRE090
     C                     PARM '*VERIFY' @OPTN                                               CRE090
     C                     PARM 'CRE090'  @SARD   6                                           CRE090
     C           SCSARD    PARM SCSARD    DSFDY                                               CRE090
      *                                                                                       CRE090
     C           @RTCD     IFEQ *BLANKS                                                       CRE090
     C                     MOVE 'Y'       CRE090                                              CRE090
     C                     ELSE                                                               CRE090
     C           @RTCD     IFNE '*NRF   '                                                     CRE090
     C                     SETON                     U7LR                                     CRE090
     C           *LOCK     IN   LDA                                                           CRE090
     C                     MOVE 'SCSARDPD'DBFILE                                              CRE090
     C                     MOVEL'CRE090'  DBKEY                                               CRE090
     C                     Z-ADD003       DBASE                                               CRE090
     C                     OUT  LDA                                                           CRE090
     C                     EXSR *PSSR                                                         CRE090
     C                     ENDIF                                                              CRE090
     C                     ENDIF                                                              CRE090
     C*
     C**  Override message file
     C*
     C**  Fill in fields for subroutine ZASNMS
     C*
     C                     MOVEL*BLANK    ZAPGM  10        Message queue
     C                     MOVEL'REUSRMSG'ZAMSGF 10        Message file
     C                     MOVEL*BLANK    ZAPGRL  5        Rel queue
     C                     MOVEL*BLANK    ZAMSID  7        Message Id.
     C                     MOVEL*BLANK    ZAMSDA132        Message data.
     C                     MOVEL*BLANK    ZAMSTP  7        Message type.
     C*
     C                     MOVE 'N'       EXTFLG  1                                           239966
     C**********           Z-ADD41        MSGLEN 155                                          239966
     C                     Z-ADD45        MSGLEN 155                                          239966
     C**********           MOVE CMD,2     CMD2                                                239966
     C                     MOVELCMD,2     CMD2                                                239966
     C*
     C**  BJLANG retained for future use
     C*
     C                     MOVE BJLANG    BJLANG  2
     C           BJLANG    IFNE *BLANKS
     C                     MOVE BJLANG    WWLGID
     C                     ELSE
     C                     MOVE 'GB'      WWLGID
     C                     END
     C*
     C                     CALL 'QCMDEXC'
     C                     PARM           CMD2
     C                     PARM           MSGLEN
     C*
     C/COPY WNCPYSRC,RE3363C004
     C                     ENDSR                           **FIRST ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C**   FROM60 subroutine to fill subfile
     C**
     C**     Called by       START
     C**     Calls           ROLDN, ZDATE1
     C**
     C           FROM60    BEGSR                           **FROM60 BEGSR**
     C*
     C                     MOVE WBRCA     BRCAB
     C                     MOVE WCNUM     CNUMB
     C                     MOVE WCCY      WCCYB
     C                     MOVE WACOD     ACODB
     C                     MOVE WACSQ     ACSQB
     C                     MOVE WRUNA     SRUNA
     C                     MOVE WZADEC    ZADEC   10
     C                     MOVE *BLANKS   SIND
     C                     Z-ADD1         SFLTYP
     C                     Z-ADD1         RN
     C                     Z-ADD1         RN2                                                 CRE090
     C                     MOVELNAR,1     BOLI
     C                     Z-ADD1         BB      10
     C                     MOVELTIT,1     TITLE
     C*                    Z-ADD0         COUNT
     C                     Z-ADD0         LASTR
     C                     Z-ADD99999     HISDD
     C*
     C           WDATF     IFEQ 'M'
     C                     SETON                     98
     C                     END
     C*
     C** Fill the subfile
     C*
     C                     EXSR ROLDN
     C*
     C                     MOVE SDY       ZDY
     C                     MOVE SYR       ZYR
     C                     Z-ADD1         ZMT
     C           SMT       LOKUPZMNM,ZMT                 90
     C                     EXSR ZDATE1
     C                     Z-ADDZDAYNO    LASTR
     C*
     C** Process 'ENTER'
     C*
     C                     MOVE '64'      WFROM2           - B1
     C                     OUT  DSLDA
     C*
     C                     ENDSR                           **FROM60 ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** INIT Subroutine to initialize subfiles fields
     C**
     C**     Called by     CMD12, CMD13, ROLDN, ROLUP
     C**     Calls         -
     C**
     C           INIT      BEGSR                           **INIT BEGSR**
     C*
     C** Clear subfile
     C*
     C                     MOVE 'N'       END     1                       125857
     C                     MOVE '1'       *IN25
     C                     WRITERE3363C1
     C                     WRITERE3363C2
     C                     MOVE '0'       *IN25
     C*
     C                     ENDSR                           **INIT ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** KEYRE subroutine to display more keys
     C**
     C**     Called by       START
     C**     Calls           -
     C**
     C           KEYRE     BEGSR                           **START KEYRE**
     C*
     C                     MOVE *BLANKS   BOLI
     C                     ADD  1         BB
     C*
     C           BB        IFEQ 1                          - B1
     C                     MOVELNAR,1     BOLI
     C                     ELSE                            - X1
     C*                                                                *
     C           SFLTYP    IFEQ 1                          - B2
     C                     MOVELNAR,2     BOLI
     C                     ELSE                            - X2
     C                     MOVELNAR,3     BOLI
     C                     END                             - E2
     C*                                                                *
     C                     Z-ADD0         BB
     C                     END                             - E1
     C*                                                                *
     C                     ENDSR                           **END KEYRE**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** MOREDN Subroutine to look for more records for next rolldown
     C**
     C**     Called by     ROLDN, ROLUP
     C**     Calls         -
     C**
     C           MOREDN    BEGSR                           **START MOREDN**
     C*
     C** Display '+' if next rolldown can show more records
     C*
     C           COUNT     IFEQ 14                         - B1
     C                     READPREHISPSF                 52
     C*
     C           *IN52     IFEQ '0'                        - B2
     C           CBRCA     ANDEQBRCAB
     C           CCNUM     ANDEQCNUMB
     C           CCCY      ANDEQWCCYB
     C           CACOD     ANDEQACODB
     C           CACSQ     ANDEQACSQB
     C                     MOVE '+'       SMDN
     C                     Z-ADDCHISD     HISDD
     C                     ELSE                            - X2
     C                     MOVE *BLANK    SMDN
     C                     Z-ADD0         HISDD
     C                     END                             - E2
     C*
     C                     READ REHISPSF                 51
     C                     ELSE                            - X1
     C                     MOVE *BLANK    SMDN
     C                     Z-ADD0         HISDD
     C                     END                             - E1
     C*
     C                     ENDSR                           **END MOREDN**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** MOREUP Subroutine to look for more records for next rollup
     C**
     C**     Called by     ROLDN, ROLUP
     C**     Calls         -
     C**
     C           MOREUP    BEGSR                           **START MOREUP**
     C*
     C** Display '+' if next rollup can show more records
     C*
     C           COUNT     IFEQ 0                          - B1
     C           LASTR     ANDGT0
     C*
     C           *IN51     IFEQ '0'                        - B2
     C                     MOVE '+'       SMUP
     C                     Z-ADDCHISD     HISDU
     C                     ELSE                            - X2
     C                     MOVE *BLANK    SMUP
     C                     Z-ADDLASTR     HISDU
     C                     END                             - E2
     C*
     C                     READPREHISPSF                 51
     C                     ELSE                            - X1
     C                     MOVE *BLANK    SMUP
     C                     Z-ADD0         HISDU
     C                     END                             - E1
     C*
     C                     MOVE BRCAB     CBRCA
     C                     MOVE CNUMB     CCNUM
     C                     MOVE WCCYB     CCCY
     C                     MOVE ACODB     CACOD
     C                     MOVE ACSQB     CACSQ
     C*
     C                     ENDSR                           **END MOREUP**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** PE3364  Subroutine to call RE3364 with print or enquiry option
     C**
     C**      Called by    SFLMOD
     C**      Calls        RE3364
     C**
     C           PE3364    BEGSR
     C*
     C** Prepare data for RE3364
     C*
     C           CDICI     IFNE *BLANK                                    101476
     C                     MOVE PDID      CLDID                           101476
     C                     ENDIF                                          101476
     C           CCICI     IFNE *BLANK                                    101476
     C                     MOVE PCID      CLCID                           101476
     C                     ENDIF                                          101476
      *                                                                   101476
     C***********CDICI***  IFEQ 'Y'                        - B2           101476
     C*******************  MOVE PDID      CLDID                           101476
     C*******************  ELSE                            - X2           101476
     C*******************  MOVE PCID      CLDID                           101476
     C*******************  END                             - E2           101476
     C*******************                                                 101476
     C***********CCICI***  IFEQ 'Y'                        - B2           101476
     C*******************  MOVE PCID      CLCID                           101476
     C*******************  ELSE                            - X2           101476
     C*******************  MOVE PDID      CLCID                           101476
     C*******************  END                             - E2           101476
      *                                                                   101476
     C                     MOVE 'C'       RECI
     C*
     C** Prepare data area for RE3364
     C*
     C                     MOVE CHISD     WHISD
     C           SELECT    IFEQ '5'
     C                     MOVE 'E'       WTYP
     C                     ELSE
     C                     MOVE 'P'       WTYP
     C                     END
     C                     OUT  DSLDA
     C                     CLOSEACCRACJ
     C           SELECT    IFEQ '5'
     C*
     C** Delete override message file
     C*
     C                     CALL 'QCMDEXC'
     C                     PARM           CMD,1
     C                     PARM           MSGLEN
     C*
     C** SHARE(*NO) for REHISL                                                                239966
     C                     CALL 'QCMDEXC'                                                     239966
     C                     PARM           CMD,3                                               239966
     C                     PARM           MSGLEN                                              239966
     C*                                                                                       239966
     C                     CALL 'RE3364E'
     C*
     C** Override message file
     C*
     C**********           MOVE CMD,2     CMD2                                                239966
     C                     MOVELCMD,2     CMD2                                                239966
     C*
     C           BJLANG    IFNE *BLANKS
     C                     MOVE BJLANG    WWLGID
     C                     ELSE
     C                     MOVE 'GB'      WWLGID
     C                     END
     C*
     C                     CALL 'QCMDEXC'
     C                     PARM           CMD2
     C                     PARM           MSGLEN
     C*
     C                     ELSE
     C*
     C** Delete override message file
     C*
     C                     CALL 'QCMDEXC'
     C                     PARM           CMD,1
     C                     PARM           MSGLEN
     C*
     C                     CALL 'QCMDEXC'                                                     239966
     C                     PARM           CMD,3                                               239966
     C                     PARM           MSGLEN                                              239966
     C*                                                                                       239966
     C** SHARE(*NO) for REHISL                                                                239966
     C                     CALL 'RE3364E'
     C*
     C** Override message file
     C*
     C**********           MOVE CMD,2     CMD2                                                239966
     C                     MOVELCMD,2     CMD2                                                239966
     C*
     C           BJLANG    IFNE *BLANKS
     C                     MOVE BJLANG    WWLGID
     C                     ELSE
     C                     MOVE 'GB'      WWLGID
     C                     END
     C*
     C                     CALL 'QCMDEXC'
     C                     PARM           CMD2
     C                     PARM           MSGLEN
     C*
     C                     END
     C*
     C                     OPEN ACCRACJ
     C                     IN   DSLDA
     C*
     C** Clear used print data from DSLDA
     C*
     C                     OUT  DSLDA
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ROLDN Refill subfile in case of rolldown
     C**
     C**     Called by     START, ROLDN
     C**     Calls         INIT, SUBFIL, SUBEND, MOREDN, MOREUP
     C**
     C           ROLDN     BEGSR                           **ROLDN  BEGSR**
     C*
     C                     Z-ADD1         RN
     C                     Z-ADD1         RN2                                                 CRE090
     C*
     C           HISDD     IFGT 0                          - B1
     C                     EXSR INIT
     C                     Z-ADDHISDD     CHISD
     C           KEYL6     SETGTREHISL
     C*
     C** Reserve space for ACCRACJ if last page
     C*
     C           LASTR     IFEQ 0                          - B2
     C           WDRDLY    IFEQ 'N'                        - B3                               CRE090
     C           WCRDLY    ANDEQ'N'                                                           CRE090
     C                     Z-ADD1         COUNT
     C                     ELSE                            - X3                               CRE090
      ** Reserve space/s for delayed cap. if last page                                        CRE090
     C           WDRDLY    IFEQ 'Y'                        - B4                               CRE090
     C           WCRDLY    ANDEQ'Y'                                                           CRE090
     C                     Z-ADD3         COUNT                                               CRE090
     C                     ELSE                            - X4                               CRE090
     C                     Z-ADD2         COUNT                                               CRE090
     C                     ENDIF                           - E4                               CRE090
     C                     ENDIF                           - E3                               CRE090
     C                     ELSE                            - X2
     C                     Z-ADD0         COUNT
     C                     END                             - E2
     C**                                                                  044314
     C** INITIALIZE FIELDS                                                044314
     C                     MOVE KBRCA     CBRCA                           044314
     C                     MOVE KCNUM     CCNUM                           044314
     C                     MOVE WCCY      CCCY                            044314
     C                     MOVE KACOD     CACOD                           044314
     C                     MOVE KACSQ     CACSQ                           044314
     C*
     C** READP until 14 records read or first record reached
     C*
     C           *IN51     DOWEQ'0'                        - B2
     C           CBRCA     ANDEQBRCAB
     C           CCNUM     ANDEQCNUMB
     C           CCCY      ANDEQWCCYB
     C           CACOD     ANDEQACODB
     C           CACSQ     ANDEQACSQB
     C           COUNT     ANDLT14
     C                     READPREHISPSF                 51
     C*
     C           *IN51     IFEQ '0'                        - B3
     C                     ADD  1         COUNT
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C           CBRCA     IFNE BRCAB                      - B2
     C           CCNUM     ORNE CNUMB
     C           CCCY      ORNE WCCYB
     C           CACOD     ORNE ACODB
     C           CACSQ     ORNE ACSQB
     C           *IN51     OREQ '1'
     C                     MOVE BRCAB     CBRCA
     C                     MOVE CNUMB     CCNUM
     C                     MOVE WCCYB     CCCY
     C                     MOVE ACODB     CACOD
     C                     MOVE ACSQB     CACSQ
     C           KEYL5     SETLLREHISL               51
     C*
     C** Read only record for the account
     C*
     C           KEYL5     READEREHISPSF                 51
     C                     END                             - E2
     C*
     C** Check if more records for next rolldown
     C*
     C                     EXSR MOREDN
     C*
     C** Allow full subfile if first record reached
     C*
     C                     Z-ADD14        COUNT
     C*
     C** Fill subfile
     C*
     C                     MOVE *BLANKS   SIND2                                            MD027025A
     C                     MOVE 'N'       WDEMND  1                                         MD027052
     C           COUNT     DOWGT0                          - B2
     C           *IN51     ANDEQ'0'
      *                                                                                     MD027052
     C                     Z-ADDCHISD     WCHISD                                            MD027245
     C           BMLDAI    IFNE 'Y'                                                         MD027052
     C           CHISD     SUB  1         WCHISD  50                                        MD027052
     C                     ENDIF                                                            MD027052
     C           WDRDLY    IFNE 'N'                                                         MD027052
     C           WCHISD    ANDGTWNDID0                                                      MD027052
     C           *IN51     ANDEQ'0'                                                         MD027052
     C           WDEMND    ANDEQ'N'                                                         MD027245
     C           WCRDLY    ORNE 'N'                                                         MD027052
     C           WCHISD    ANDGTWNCID0                                                      MD027052
     C           *IN51     ANDEQ'0'                                                         MD027052
     C           WDEMND    ANDEQ'N'                                                         MD027245
     C                     Z-ADDCHISD     WWHISD  50                                        MD027052
     C                     MOVE 'Y'       WDEMND                                            MD027052
     C                     EXSR DSPDC                                                       MD027052
     C                     Z-ADDWWHISD    CHISD                                             MD027052
     C           KEYL6     SETLLREHISPSF                                                    MD027052
     C           KEYL5     READEREHISPSF                 51                                 MD027052
     C                     ENDIF                                                            MD027052
     C*
     C                     EXSR SUBFIL
     C                     SUB  1         COUNT
     C           CDICI     IFNE *BLANKS                                                     MD027025
     C                     Z-ADDCHISD     WPDID   50                                        MD027025
     C                     ENDIF                                                            MD027025
     C           CCICI     IFNE *BLANKS                                                     MD027025
     C                     Z-ADDCHISD     WPCID   50                                        MD027025
     C                     ENDIF                                                            MD027025
     C*
     C           KEYL5     READEREHISPSF                 51
     C                     END                             - E2
     C*
     C** Check if more records for next rollup
     C*
     C                     EXSR MOREUP
     C*
     C** Add ACCRACJ record if last page
     C*
      *                                                                                       CRE090
      ** Display Delayed Capitalisation                                                       CRE090
      *                                                                                       CRE090
     C           CRE090    IFEQ 'Y'                                                           CRE090
     C           WDEMND    ANDEQ'N'                                                         MD027052
     C                     EXSR DSPDC                                                         CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
     C           LASTR     IFEQ 0                          - B2
     C           RN        SUB  1         WRN                                               MD027139
     C           WRN       IFNE 0                                                           MD027139
     C                     Z-ADDWRK,WRN   WDATE   50                                        MD027139
     C                     ELSE                                                             MD027139
     C                     Z-ADD0         WDATE                                             MD027139
     C                     ENDIF                                                            MD027139
     C                     EXSR SUBEND
     C                     ELSE                            - X2
     C                     SUB  1         RN
     C                     SUB  1         RN2                                                 CRE090
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **ROLDN  ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ROLUP Refill subfile in case of rollup
     C**
     C**     Called by     START
     C**     Calls         INIT, SUBFIL, SUBEND, MOREDN, MOREUP
     C**
     C           ROLUP     BEGSR                           **ROLUP  BEGSR**
     C*
     C                     Z-ADD0         COUNT
     C                     Z-ADD1         RN
     C                     Z-ADD1         RN2                                                 CRE090
     C*
     C** Display ACCRACJ record alone
     C*
     C           HISDU     IFEQ LASTR                      - B1
     C           END       ANDNE'Y'                        - B1           125857
      *                                                                                       CRE090
      ** Display Delayed Capitalisation                                                       CRE090
      *                                                                                       CRE090
     C           CRE090    IFEQ 'Y'                                                           CRE090
     C                     EXSR DSPDC                                                         CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
     C           RN        SUB  1         WRN                                               MD027139
     C           WRN       IFNE 0                                                           MD027139
     C                     Z-ADDWRK,WRN   WDATE                                             MD027139
     C                     ELSE                                                             MD027139
     C                     Z-ADD0         WDATE                                             MD027139
     C                     ENDIF                                                            MD027139
      *                                                                                     MD027139
     C                     EXSR SUBEND
     C                     Z-ADD0         HISDU
     C                     ELSE
     C*
     C           HISDU     IFGT 0                          - B2
     C                     EXSR INIT
     C                     Z-ADDHISDU     CHISD
     C                     Z-ADD14        COUNT
     C           KEYL6     SETLLREHISL
     C*
     C** Check if more records for next rolldown
     C*
     C                     EXSR MOREDN
     C*
     C** Fill subfile
     C*
     C                     MOVE *BLANKS   SIND2                                            MD027025A
     C                     MOVE 'N'       WDEMND                                            MD027052
     C           *IN51     DOWEQ'0'                        - B3
     C           COUNT     ANDGT0
      *                                                                                     MD027052
     C                     Z-ADDCHISD     WCHISD                                            MD027245
     C           BMLDAI    IFNE 'Y'                                                         MD027052
     C           CHISD     SUB  1         WCHISD  50                                        MD027052
     C                     ENDIF                                                            MD027052
     C           WDRDLY    IFNE 'N'                                                         MD027052
     C           WCHISD    ANDGTWNDID0                                                      MD027052
     C           *IN51     ANDEQ'0'                                                         MD027052
     C           WDEMND    ANDEQ'N'                                                         MD027245
     C           WCRDLY    ORNE 'N'                                                         MD027052
     C           WCHISD    ANDGTWNCID0                                                      MD027052
     C           *IN51     ANDEQ'0'                                                         MD027052
     C           WDEMND    ANDEQ'N'                                                         MD027245
     C                     Z-ADDCHISD     WWHISD  50                                        MD027052
     C                     MOVE 'Y'       WDEMND                                            MD027052
     C                     EXSR DSPDC                                                       MD027052
     C                     Z-ADDWWHISD    CHISD                                             MD027052
     C           KEYL6     SETLLREHISPSF                                                    MD027052
     C           KEYL5     READEREHISPSF                 51                                 MD027052
     C                     ENDIF                                                            MD027052
     C*
     C                     SUB  1         COUNT
     C                     EXSR SUBFIL
     C           CDICI     IFNE *BLANKS                                                     MD027025
     C                     Z-ADDCHISD     WPDID                                             MD027025
     C                     ENDIF                                                            MD027025
     C           CCICI     IFNE *BLANKS                                                     MD027025
     C                     Z-ADDCHISD     WPCID                                             MD027025
     C                     ENDIF                                                            MD027025
     C*
     C           KEYL5     READEREHISPSF                 51
     C                     END                             - E3
     C*
     C** Check if more records for next rollup
     C*
     C                     EXSR MOREUP
      *                                                                                       CRE090
      ** Display Delayed Capitalisation                                                       CRE090
      *                                                                                       CRE090
     C           CRE090    IFEQ 'Y'                                                           CRE090
     C           WDEMND    ANDEQ'N'                                                         MD027052
     C                     EXSR DSPDC                                                         CRE090
     C                     ENDIF                                                              CRE090
     C*
     C           COUNT     IFGT 0                          - B3
     C           RN        SUB  1         WRN                                               MD027139
     C           WRN       IFNE 0                                                           MD027139
     C                     Z-ADDWRK,WRN   WDATE                                             MD027139
     C                     ELSE                                                             MD027139
     C                     Z-ADD0         WDATE                                             MD027139
     C                     ENDIF                                                            MD027139
     C                     EXSR SUBEND
     C                     ELSE
     C                     SUB  1         RN
     C                     SUB  1         RN2                                                 CRE090
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **ROLUP  ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RSTENQ Subroutine to reset enquiry selections if CMD12
     C**        taken from RE3364
     C**
     C**     Called by     SFLMOD
     C**     Calls         -
     C**
     C           RSTENQ    BEGSR
     C*
     C** Reset last record selected
     C*
     C                     MOVE *BLANKS   SELECT
     C           SFLTYP    IFEQ 1                          - B1
     C                     UPDATRE3363B1
     C                     READCRE3363B1                 96
     C                     ELSE                            - X1
     C                     UPDATRE3363B2
     C                     READCRE3363B2                 96
     C                     END                             - E1
     C*
     C           *IN96     DOWEQ'0'                        - B1
     C*
     C                     MOVE *BLANKS   SELECT
     C           SFLTYP    IFEQ 1                          - B2
     C                     UPDATRE3363B1
     C                     READCRE3363B1                 96
     C                     ELSE                            - X2
     C                     UPDATRE3363B2
     C                     READCRE3363B2                 96
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     MOVE '0'       WCANC
     C                     OUT  DSLDA
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SFLDSP Swap from one subfile to the other
     C**
     C**     Called by     START
     C**     Calls         _
     C**
     C           SFLDSP    BEGSR                           **SFLDSP BEGSR**
     C*
     C           SFLTYP    IFEQ 1                           - B1
     C                     ADD  1         SFLTYP
     C                     MOVELTIT,2     TITLE
     C*
     C           BB        IFNE 1                           - B2
     C                     MOVELNAR,3     BOLI
     C                     END                              - E2
     C*
     C                     ELSE                             - X1
     C                     SUB  1         SFLTYP
     C                     MOVELTIT,1     TITLE
     C*
     C           BB        IFNE 1                          - B2
     C                     MOVELNAR,2     BOLI
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **SFLDSP ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SFLMOD Subroutine used if subfile has been modified
     C**
     C**     Called by       START
     C**     Calls           PE3364, RSTENQ, ZASNMS
     C**
     C           SFLMOD    BEGSR                           **SFLMOD BEGSR**
     C*
     C**  Subfile is now processed as follows:
     C**   1. Read through subfile changed records, if any fields
     C**      in error highlight, send message & exit routine
     C**   2. Read through subfile changed records and process
     C**      all option '6' for print, send message & exit routine
     C**   3. Read through subfile changed records and process
     C**      all option '5' for enquiry
     C*
     C** Bypass record if user entered a space
     C*
     C           *IN96     DOWEQ'0'                        - B1
     C           SELECT    ANDEQ*BLANKS
     C*
     C           SFLTYP    IFEQ 1                          - B2
     C                     UPDATRE3363B1
     C                     READCRE3363B1                 96
     C                     ELSE                            - X2
     C                     UPDATRE3363B2
     C                     READCRE3363B2                 96
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C** Error processing
     C*
     C                     MOVE '0'       *IN29
     C                     MOVE '0'       *IN30
     C*
     C           *IN96     DOWEQ'0'                            B1
     C           SELECT    IFNE '5'                            B2
     C           SELECT    ANDNE'6'
     C           SELECT    ANDNE*BLANKS
     C                     MOVE '1'       *IN29
     C                     MOVE '1'       *IN30
     C                     END                                 E2
     C*
     C           SFLTYP    IFEQ 1                              B2
     C                     UPDATRE3363B1
     C                     READCRE3363B1                 96
     C                     ELSE                                X2
     C                     UPDATRE3363B2
     C                     READCRE3363B2                 96
     C                     END                                 E2
     C                     MOVE '0'       *IN29
     C                     END                                 E1
     C*
     C** If any errors, send message & return to main processing
     C*
     C           *IN30     IFEQ '1'                            B1
     C                     MOVEL'REI0034' ZAMSID
     C                     EXSR ZASNMS
     C                     WRITERE3363C3
     C                     GOTO MODEND
     C                     END                                 E1
     C*
     C** Report processing
     C*
     C                     MOVE '6'       WOPT
     C                     Z-ADD0         YPRT
     C                     Z-ADD0         NPRT
     C*
     C** Position cursor at beginning of subfile
     C*
     C                     Z-ADD1         RN
     C                     Z-ADD1         RN2                                                 CRE090
     C           SFLTYP    IFEQ 1                              B1
     C                     READCRE3363B1                 96
     C                     ELSE                                X1
     C                     READCRE3363B2                 96
     C                     END                                 E1
     C*
     C           *IN96     DOWEQ'0'                            B1
     C           SELECT    IFEQ '6'                            B2
     C*
     C** At least one report to print so send 'in progress'
     C** message to screen with FRCDTA in effect
     C** Only send message once
     C*
     C           YPRT      IFEQ 0
     C           NPRT      ANDEQ0
     C                     CALL 'ZA0250'
     C                     MOVE '1'       *IN31
     C                     MOVEL'REI0033' ZAMSID
     C                     EXSR ZASNMS
     C                     WRITERE3363C3
     C                     END
     C*
     C                     EXSR PE3364
     C*
     C** Set up data for 'No. of Reports' message
     C*
     C           WPRINT    IFEQ 'Y'                            B3
     C                     ADD  1         YPRT
     C                     ELSE                                X3
     C                     ADD  1         NPRT
     C                     END                                 E3
     C                     END                                 E2
     C*
     C** Update field with blanks only if it is '6'
     C*
     C           SELECT    IFEQ '6'                            B2
     C                     MOVE *BLANKS   SELECT
     C                     END                                 E2
     C*
     C           SFLTYP    IFEQ 1                              B2
     C                     UPDATRE3363B1
     C                     READCRE3363B1                 96
     C                     ELSE                                X2
     C                     UPDATRE3363B2
     C                     READCRE3363B2                 96
     C                     END                                 E2
     C                     END                                 E1
     C*
     C** If any reports were processed, send message with data
     C*
     C           YPRT      IFGT 0                              B1
     C           NPRT      ORGT 0
     C                     MOVE '0'       *IN31
     C                     CALL 'ZA0250'
     C                     MOVEL'REI0029' ZAMSID
     C                     MOVELMSGDTA    ZAMSDA
     C                     EXSR ZASNMS
     C                     WRITERE3363C3
     C                     GOTO MODEND
     C                     END                                 E1
     C*
     C** Enquiry processing
     C*
     C                     MOVE '5'       WOPT
     C*
     C** Position cursor at beginning of subfile
     C*
     C                     Z-ADD1         RN
     C                     Z-ADD1         RN2                                                 CRE090
     C           SFLTYP    IFEQ 1                              B1
     C                     READCRE3363B1                 96
     C                     ELSE                                X1
     C                     READCRE3363B2                 96
     C                     END                                 E1
     C*
     C           *IN96     DOWEQ'0'                            B1
     C           SELECT    IFEQ '5'                            B2
     C                     EXSR PE3364
     C*                                                                   074600
     C** If enquiry failed on databasse error send message                074600
     C*                                                                   074600
     C           WCANC     IFEQ '3'                            B3         074600
     C                     MOVE '0'       *IN31                           074600
     C                     CALL 'ZA0250'                                  074600
     C                     MOVEL'Y2U0004' ZAMSID                          074600
     C                     MOVEL*BLANKS   ZAMSDA                          074600
     C                     EXSR ZASNMS                                    074600
     C                     WRITERE3363C3                                  074600
     C                     GOTO MODEND                                    074600
     C                     END                                 E3         074600
     C*
     C** If CMD12 from RE3364, reset remaining enquiry selections
     C*
     C           WCANC     IFEQ '2'                            B3
     C                     EXSR RSTENQ
     C                     GOTO MODEND
     C                     END                                 E3
     C*
      ** If CMD3 from RE3364, return as if CMD3 in this program           086313
     C           WCANC     IFEQ '1'                                       086313
     C                     EXSR CMD3                           setInd exit086313
     C                     GOTO MODEND                         goto endsr 086313
     C                     ENDIF                                          086313
      *                                                                   086313
     C                     END                                 E2
     C*
     C                     MOVE *BLANKS   SELECT
     C           SFLTYP    IFEQ 1                              B2
     C                     UPDATRE3363B1
     C                     READCRE3363B1                 96
     C                     ELSE                                X2
     C                     UPDATRE3363B2
     C                     READCRE3363B2                 96
     C                     END                                 E2
     C                     END                                 E1
     C*
     C           MODEND    ENDSR                           **SFLMOD ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SUBEND Subroutine to write ACCRACJ into subfile
     C**
     C**     Called by     ROLDN, ROLUP
     C**     Calls         SUBFMT, ZDATE2
     C**
     C           SUBEND    BEGSR                           **SUBEND BEGSR**
     C*
     C           KEYL5     CHAINACCRACJ              51
     C/COPY WNCPYSRC,RE3363C002
     C                     MOVE 'S'       CRECI
     C                     MOVE BRCA      CBRCA
     C**********           Z-ADDCNUM      CCNUM                                               CSD027
     C                     MOVE CNUM      CCNUM                                               CSD027
     C                     MOVE CCY       CCCY
     C                     Z-ADDACOD      CACOD
     C                     Z-ADDACSQ      CACSQ
     C******************** Z-ADDBJRDNB    CHISD                           046091
     C                     Z-ADDHISB      CHISB
     C                     Z-ADDMNBL      CMNBL
     C                     Z-ADD*ZEROS    CPHGAR
     C                     Z-ADDNRCA      CTHGAR
     C                     Z-ADD*ZEROS    CPHGAN
     C                     Z-ADDRCA       CTHGAN
     C                     Z-ADDDICT      CDICT
     C                     Z-ADDDRIC      CDRCB
     C                     Z-ADDDRCD      CDRCD
     C*********************Z-ADDZDAIC1    CDAIC                           094431
     C                     Z-ADD*ZEROS    CDAIC                           094431
     C                     MOVE DAICCH    CDAIC                           094431
     C                     Z-ADD*ZEROS    CPMADI
     C*********************Z-ADD*ZEROS    CTMADI                          094431
     C******************** Z-ADDLDID      PDID                            046091
     C                     Z-ADD*ZEROS    CDMINT
     C                     Z-ADDGADI      CSGADI
     C                     Z-ADD*ZEROS    CDRIP
     C                     MOVE 'Y'       CDICI
     C                     Z-ADD*ZEROS    CDRIS
     C                     MOVE *BLANKS   CSDACP
     C                     MOVE *BLANKS   CSDCI
     C                     Z-ADDCICT      CCICT
     C                     Z-ADDCRIC      CCRCB
     C                     Z-ADDCRCD      CCRCD
     C*********************Z-ADDZCAIC1    CCAIC                           094431
     C                     Z-ADD*ZEROS    CCAIC                           094431
     C                     MOVE CAICCH    CCAIC                           094431
     C                     Z-ADD*ZEROS    CPMACI
     C*********************Z-ADD*ZEROS    CTMACI                          094431
     C******************** Z-ADDLCID      PCID                            046091
     C                     Z-ADD*ZEROS    CCMINT
     C                     Z-ADDGACI      CSGACI
     C                     Z-ADD*ZEROS    CCRIP
     C                     MOVE 'Y'       CCICI
     C                     Z-ADD*ZEROS    CCRIS
     C                     MOVE *BLANKS   CSCACP
     C                     MOVE *BLANKS   CSCCI
     C                     Z-ADDHISB      CSTBL
     C                     Z-ADD*ZEROS    CCHGP
     C                     MOVE *BLANKS   CSCHAC
     C                     Z-ADD*ZEROS    CMNBCP
     C                     MOVE *BLANKS   CSCHGI
     C********             Z-ADDZDAIC1    SDIAN                           048574
     C********             Z-ADDZCAIC1    SCIAN                           048574
     C           WDRDLY    IFEQ 'Y'                                                           CRE090
     C           WCRDLY    OREQ 'Y'                                                           CRE090
     C           WDRDLY    OREQ 'B'                                                           CRE090
     C                     ADD  RCCAP1    CHISB                                               CRE090
     C                     ADD  RCCAP2    CHISB                                               CRE090
     C                     MOVE PDRACD    DAICCH                                              CRE090
     C                     MOVE PCRACD    CAICCH                                              CRE090
     C                     MOVE DAICCH    WDRADJ                                           MD027025A
     C                     ADD  WCDAIC    WDRADJ                                           MD027025A
     C                     SUB  CDAIC     WDRADJ                                           MD027025A
     C                     MOVE CAICCH    WCRADJ                                           MD027025A
     C                     ADD  WCCAIC    WCRADJ                                           MD027025A
     C                     SUB  CCAIC     WCRADJ                                           MD027025A
     C                     MOVE WDRADJ    PDRADJ                                           MD027025A
     C                     MOVE WCRADJ    PCRADJ                                           MD027025A
     C                     ENDIF                                                              CRE090
     C                     MOVE DAICCH    WWINTD 130                      094431
     C                     ADD  CTMADI    WWINTD                          094431
     C                     MOVE WWINTD    SDIAN                           094431
     C*********************MOVE DAICCH    SDIAN                    048574 094431
     C                     MOVE CAICCH    WWINTC 130                      094431
     C                     ADD  CTMACI    WWINTC                          094431
     C                     MOVE WWINTC    SCIAN                           094431
     C*********************MOVE CAICCH    SCIAN                    048574 094431
      *                                                                   125622
      * If a/c is non-chargeable, outstanding charges must be displayed   125622
      * as zero.                                                          125622
     C                     Z-ADD0         SRCAN                           125622
     C           CHGT      IFNE *ZERO                                     125622
     C           WCRDLY    IFEQ 'Y'                                                           CRE090
     C           WCRDLY    OREQ 'B'                                                           CRE090
     C                     Z-ADDWCHGAR    RCA                                                 CRE090
     C                     ENDIF                                                              CRE090
     C           RCA       ADD  NRCA      SRCAN
     C**********           MOVE ANAM      WANAM                    074590 192551
     C                     END                                            125622
     C                     MOVE ANAM      WANAM                           192551
     C*                                                                   046091
     C* IF FIRST DAY ACCRUALS ADD 1 IN DIFFERENT DATES                    046091
     C*                                                                   046091
     C                     Z-ADDBJRDNB    CHISD                           046091
      *                                                                   098818
     C           BMLDAI    IFEQ 'Y'                                       046091
     C                     Z-ADDLDID      PDID                            046091
     C                     Z-ADDLCID      PCID                            046091
      *                                                                   098818
     C                     ELSE                                           098818
      * DR                                                                098818
     C           LDID      IFNE DACO                                      098818
     C           LDID      IFNE LCLOSE                                    098818
     C           LDID      ADD  1         PDID                            098818
      * LAST CAP WAS = CLOSURE                                            101476
     C                     ELSE                                           101476
     C           BMLDAI    IFNE 'Y'                                       101476
     C           LDID      ANDNE*ZEROS                                    101476
     C                     Z-ADDLDID      PDID                            101476
     C                     ENDIF                                          101476
      *                                                                   101476
     C                     ENDIF                                          098818
     C                     ELSE                                           098818
     C                     Z-ADDLDID      PDID                            098818
     C                     ENDIF                                          098818
      * CR                                                                098818
     C           LCID      IFNE DACO                                      098818
     C           LCID      IFNE LCLOSE                                    098818
     C           LCID      ADD  1         PCID                            098818
      * LAST CAP WAS = CLOSURE                                            101476
     C                     ELSE                                           101476
     C           BMLDAI    IFNE 'Y'                                       101476
     C           LCID      ANDNE*ZEROS                                    101476
     C                     Z-ADDLCID      PCID                            101476
     C                     ENDIF                                          101476
      *                                                                   101476
     C                     ENDIF                                          098818
     C                     ELSE                                           098818
     C                     Z-ADDLCID      PCID                            098818
     C                     ENDIF                                          098818
      *                                                                   098818
     C                     ENDIF                                          098818
      *                                                                   098818
     C******************** ELSE                                     046091098818
     C********** BJRDNB    ADD  1         CHISD                     046091075072
     C******************** Z-ADDBJRDNB    CHISD                     075072098818
     C********** LDID      ADD  1         PDID                      046091049765
     C**********           Z-ADDLDID      PDID                            049765
     C********** LCID      ADD  1         PCID                      046091049765
     C**********           Z-ADDLCID      PCID                            049765
      ********************                                                098818
     C***********LDID***** IFNE DACO                                      098818
     C***********LDID***** ADD  1         PDID                            098818
     C******************** ELSE                                     075195098818
     C******************** Z-ADDLDID      PDID                      075195098818
     C******************** END                                            098818
     C***********LCID***** IFNE DACO                                      098818
     C***********LCID***** ADD  1         PCID                            098818
     C******************** ELSE                                     075195098818
     C******************** Z-ADDLCID      PCID                      075195098818
     C******************** END                                            098818
     C******************** END                                      046091098818
     C*                                                                   075072
     C** Avoid to display two records with the same date (For first day   075072
     C** accruals and capitalisation during last EOD)                     075072
     C*                                                                   075072
     C           CHISD     IFNE PCID                                      075072
     C           BMLDAI    ANDEQ'Y'                                                         MD026817
     C           CHISD     ORNE PCID                                                        MD026817
     C           LCID      ANDGELDID                                                        MD026817
     C********** LCID      ANDNEDACO                                               MD026817 MD026963
     C           LCID      ANDNEPRDNB                                                       MD026963
     C           WNCID0    ANDGEWNDID0                                                      MD026963
     C           WNCID0    ANDNEPRDNB                                                       MD026963
     C           WNCID0    ANDNE0                                                           MD026963
     C           BMLDAI    ANDNE'Y'                                                         MD026817
     C           CHISD     ORNE PDID                                      075072
     C           BMLDAI    ANDEQ'Y'                                                         MD026817
     C           CHISD     ORNE PDID                                                        MD026817
     C           LDID      ANDGELCID                                                        MD026817
     C********** LDID      ANDNEDACO                                               MD026817 MD026963
     C           LDID      ANDNEPRDNB                                                       MD026963
     C           WNDID0    ANDGEWNCID0                                                      MD026963
     C           WNDID0    ANDNEPRDNB                                                       MD026963
     C           WNDID0    ANDNE0                                                           MD026963
     C           BMLDAI    ANDNE'Y'                                                         MD026817
     C           WDATE     ORNE CHISD                                                       MD027139
     C           BMLDAI    ANDNE'Y'                                                         MD027139
     C           ORED      OREQ BJRDNB                                    077176
     C           DACO      OREQ BJRDNB                                    077176
      *                                                                   092181
      * If 1st day accruals and there is either a DR cap. or a CR cap.    092181
      * valued today, RE3364E should only display the side which didn't   092181
      * capitalise.                                                       092181
     C           BMLDAI    IFNE 'Y'                                       092181
     C           PDID      IFEQ CHISD                                     092181
     C           PCID      ANDNECHISD                                     092181
     C                     MOVE *BLANK    CDICI                           092181
     C                     ELSE                                           092181
     C           PCID      IFEQ CHISD                                     092181
     C           PDID      ANDNECHISD                                     092181
     C                     MOVE *BLANK    CCICI                           092181
     C                     END                                            092181
     C                     END                                            092181
     C                     END                                            092181
     C*
     C** Convert number of days in date
     C*
     C******************** Z-ADDBJRDNB    ZDAYNO                          046091
     C                     Z-ADDCHISD     ZDAYNO                          046091
      *                                                                   090958
      * For 1st day accruals, display latest date as rundate - 1.         090958
     C           BMLDAI    IFNE 'Y'                                       090958
     C                     SUB  1         ZDAYNO                          090958
     C                     END                                            090958
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     SHID
     C*
     C                     MOVE *BLANKS   SIND
     C                     EXSR SUBFMT
     C*
     C                     MOVE *BLANKS   SSTBL
     C                     MOVE *BLANKS   SDIP
     C                     MOVE *BLANKS   SCIP
     C                     MOVE *BLANKS   SCHGP
     C                     MOVE '-  '     SSTBL
     C                     WRITERE3363B1
     C                     WRITERE3363B2
     C                     MOVE CHISD     WRK,RN
     C                     MOVE 'Y'       END                             125857
     C*                                                                   075072
     C                     END                                            075072
     C*
     C                     ENDSR                           **SUBEND ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SUBFIL Subroutine to fill the subfile
     C**
     C**     Called by       ROLDN, ROLUP
     C**     Calls           ZDATE2, SUBFMT
     C**
     C           SUBFIL    BEGSR                           **SUBFIL BEGSR**
     C*
     C** Loop on same account
     C*
     C** Calculate interest amounts to be displayed
     C*
     C           CDRIP     ADD  CDRIS     SDIPN  150
     C********   CDAIC     ADD  CTMADI    SDIAN  150                      048574
     C***********          ADD  CTMADI    SDIAN  150                      048574
     C                     Z-ADDCDAIC     SDIAN  150
     C           CCRIP     ADD  CCRIS     SCIPN  150
     C********   CCAIC     ADD  CTMACI    SCIAN  150                      048574
     C***********          ADD  CTMACI    SCIAN  150                      048574
     C                     Z-ADDCCAIC     SCIAN  150
      *                                                                   098818
      ** Check for Account Closure. If this capitalisation caused by      098818
      ** Acc Closure request, save the CAP Date for future use            098818
      *                                                                   098818
     C           CDICI     IFEQ 'C'                                       098818
     C                     Z-ADDCHISD     LCLOSE                          098818
     C                     ELSE                                           106210
     C                     Z-ADD0         LCLOSE                          106210
     C                     ENDIF                                          098818
     C*
     C** Handle negative statement balance
     C*
     C** Convert number of days in date
     C*
     C                     Z-ADDCHISD     ZDAYNO
      *                                                                   090958
      * For 1st day accruals, display actual cap. date.                   090958
      * NOTE: Only applies to xxICI *NE 'C' Acc Closure                   098818
      *                                                                   098818
     C           BMLDAI    IFNE 'Y'                                       090958
     C           CDICI     ANDNE'C'                                       098818
     C                     SUB  1         ZDAYNO                          090958
     C                     END                                            090958
     C                     EXSR ZDATE2
     C                     MOVE ZDATE     SHID
     C************         EXSR SUBFMT                                    092564
     C*
     C** Set SIND to B(oth), D(ebit), C(redit), or blank
     C*
     C           CDICI     IFNE ' '                        - B3
     C           CCICI     ANDNE' '
     C                     MOVE 'B'       SIND
     C                     ELSE                            - X3
     C*
     C           CDICI     IFNE ' '                        - B4
     C                     MOVE 'D'       SIND
     C                     Z-ADD0         SCIAN                           092564
     C                     ELSE                            - X4
     C*
     C           CCICI     IFNE ' '                        - B5
     C                     MOVE 'C'       SIND
     C                     Z-ADD0         SDIAN                           092564
     C                     ELSE                            - X5
     C                     MOVE *BLANKS   SIND
     C                     Z-ADD0         SCIAN                           092564
     C                     Z-ADD0         SDIAN                           092564
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C                     EXSR SUBFMT                                    092564
     C*
     C                     MOVE *BLANKS   SRCA
     C                     MOVE '-'       SRCA
     C                     WRITERE3363B1
     C                     WRITERE3363B2
     C                     MOVE CHISD     WRK,RN
     C                     ADD  1         RN
     C                     ADD  1         RN2                                                 CRE090
     C*
     C                     ENDSR                           **SUBFIL ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SUBFMT Subroutine to format subfile fields
     C**
     C**     Called by     SUBFIL, SUBEND
     C**     Calls         ZEDIT
     C**
     C           SUBFMT    BEGSR                           **SUBFMT BEGSR**
     C*
     C** Handle negative history balance
     C*
     C           CHISB     IFLT 0                          - B1
     C                     Z-SUBCHISB     WWHISB
     C                     MOVE 'CR'      SHIS1
     C                     ELSE                            - E1
     C                     Z-ADDCHISB     WWHISB
     C                     MOVE '  '      SHIS1
     C                     END
     C           CSTBL     IFLT 0                          - B1
     C                     Z-SUBCSTBL     CSTBL
     C                     MOVE 'CR'      SSTB1
     C                     ELSE                            - E1
     C                     MOVE '  '      SSTB1
     C                     END
     C           SDIAN     IFLT 0                          - B1
     C                     Z-SUBSDIAN     SDIAN
     C                     MOVE '-'       SDIA1
     C                     ELSE                            - E1
     C                     MOVE ' '       SDIA1
     C                     END
     C           SCIAN     IFLT 0                          - B1
     C                     Z-SUBSCIAN     SCIAN
     C                     MOVE '-'       SCIA1
     C                     ELSE                            - E1
     C                     MOVE ' '       SCIA1
     C                     END
     C           SDIPN     IFLT 0                          - B1
     C                     Z-SUBSDIPN     SDIPN
     C                     MOVE '-'       SDIP1
     C                     ELSE                            - E1
     C                     MOVE ' '       SDIP1
     C                     END
     C           SCIPN     IFLT 0                          - B1
     C                     Z-SUBSCIPN     SCIPN
     C                     MOVE '-'       SCIP1
     C                     ELSE                            - E1
     C                     MOVE ' '       SCIP1
     C                     END
     C*
     C** Insert decimal points if needed
     C*
     C                     MOVE WWHISB    ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SHIS0
     C                     MOVE CSTBL     ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SSTB0
     C                     MOVE SDIPN     ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SDIP0
     C                     MOVE SCIPN     ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCIP0
     C                     MOVE SDIAN     ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SDIA0
     C                     MOVE SCIAN     ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCIA0
     C                     MOVE CCHGP     ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SCHGP
     C                     MOVE SRCAN     ZFIELD
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    SRCA
     C*
     C                     ENDSR                           **SUBFMT ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZDATE1 Subroutine to convert a date to day number.
     C**
     C**     Called by      FROM60
     C**     Calls          -
     C**
     C/COPY ZSRSRC,ZDATE1Z2
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZDATE2 Subroutine to convert a day number to date formats.
     C**
     C**     Called by      SUBFIL, SUBEND
     C**     Calls          -
     C**
     C/COPY ZSRSRC,ZDATE2Z2
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZASNMS Subroutine to send error messages to program queue
     C**
     C**     Called by     SFLMOD
     C**     Calls         -
     C**
     C           ZASNMS    BEGSR
     C*
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM            Program queue
     C                     PARM           ZAPGRL           Rel queue
     C                     PARM           ZAMSID           Message Id.
     C                     PARM           ZAMSGF           Message file.
     C                     PARM           ZAMSDA           Message data.
     C                     PARM           ZAMSTP           Message type.
     C*
     C** Clear all fields for default mechanism next time.
     C*
     C                     MOVEL*BLANK    ZAPGM            Message queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
     C*
     C           ZASNM9    ENDSR                           ZASNM9 TAG
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZEDIT  Insert decimal point and suppress leading zeroes
     C**
     C**     Called by     SUBFIL, SUBFMT
     C**     Calls         _
     C**
     C/COPY ZSRSRC,ZEDITZ2
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** *PSSR  Subroutine to handle abnormal error conditions
     C**
     C**     Called by     FIRST
     C**     Calls         -
     C**
     C           *PSSR     BEGSR                           ** *PSSR **
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C*
     C                     RETRN
     C*
     C                     ENDSR                           ** *PSSR **
     C********************************************************************                    CRE090
     C/EJECT                                                                                  CRE090
     C********************************************************************                    CRE090
      *                                                                                       CRE090
      ** DSPDC  Subroutine to Display Delay Capitalisation                                    CRE090
      *                                                                                       CRE090
      **     Called by                                                                        CRE090
      **     Calls         -                                                                  CRE090
      *                                                                                       CRE090
     C********************************************************************                    CRE090
     C           DSPDC     BEGSR                                                              CRE090
      *                                                                                       CRE090
     C                     MOVE ' '       SIND                                                CRE090
     C                     MOVE ' '       SIND2                                               CRE090
     C                     MOVE ' '       INDDLY  1                                           CRE090
     C           COUNT     IFGT 0                          - B1                               CRE090
      *                                                                                       CRE090
     C           WDRDLY    IFEQ 'Y'                        - B2                               CRE090
     C           WCRDLY    OREQ 'Y'                                                           CRE090
     C           WDRDLY    OREQ 'B'                                                           CRE090
      *                                                                                       CRE090
     C                     MOVE 'X'       SIND2                                               CRE090
     C                     Z-ADD0         SCIAN                                               CRE090
     C                     Z-ADD0         SDIAN                                               CRE090
     C                     MOVE PCAP1     RCCAP1 150                                          CRE090
     C                     MOVE PCAP2     RCCAP2 150                                          CRE090
     C                     MOVE PHISB1    RCHISB 150                                          CRE090
     C                     MOVE PHISB2    WCHISB 150                                          CRE090
     C                     MOVE PINT1     WINT1  150                                       MD027025A
     C                     MOVE PINT2     WINT2  150                                       MD027025A
     C                     Z-ADD0         CDAIC                                            MD027025A
     C                     Z-ADD0         CDRIP                                            MD027025A
     C                     Z-ADD0         CCAIC                                            MD027025A
     C                     Z-ADD0         CCRIP                                            MD027025A
      *                                                                                       CRE090
      ** If both Debit and Credit cap, whose dates are not equal,                             CRE090
      ** are delayed, check which will be displayed first                                     CRE090
      *                                                                                       CRE090
     C           WDRDLY    IFEQ 'Y'                        - B3                               CRE090
     C           WCRDLY    ANDEQ'Y'                                                           CRE090
      *                                                                                       CRE090
     C           PNDID     IFLT PNCID                      - B4                               CRE090
     C                     Z-ADDWNDID0    RCHISD  50                                          CRE090
     C                     MOVE 'D'       SIND                                                CRE090
     C                     Z-ADDWNCID0    WCHISD  50                                          CRE090
     C                     MOVE 'C'       WSIND   1                                           CRE090
     C                     Z-ADDWINT1     CDAIC                                            MD027025A
     C                     ELSE                            - X4                               CRE090
     C                     Z-ADDWNCID0    RCHISD                                              CRE090
     C                     MOVE 'C'       SIND                                                CRE090
     C                     Z-ADDWNDID0    WCHISD                                              CRE090
     C                     MOVE 'D'       WSIND                                               CRE090
     C                     Z-SUBWINT1     CCAIC                                            MD027025A
     C                     ENDIF                           - E4                               CRE090
      *                                                                                       CRE090
     C                     ELSE                            - X3                               CRE090
      *                                                                                       CRE090
     C                     MOVE PHISB1    RCHISB                                              CRE090
     C           WDRDLY    IFEQ 'Y'                        - B4                               CRE090
     C           WDRDLY    OREQ 'B'                                                           CRE090
     C           RCHISB    ANDGT0                                                             CRE090
     C                     Z-ADDWNDID0    RCHISD                                              CRE090
     C                     MOVE 'D'       SIND                                                CRE090
     C                     Z-ADDWINT1     CDAIC                                            MD027025A
     C           WDRDLY    IFEQ 'B'                                                           CRE090
     C                     MOVE 'B'       SIND                                                CRE090
     C                     ENDIF                                                              CRE090
     C                     ELSE                            - X4                               CRE090
     C                     Z-ADDWNCID0    RCHISD                                              CRE090
     C                     MOVE 'C'       SIND                                                CRE090
     C                     Z-SUBWINT1     CCAIC                                            MD027025A
     C           WCRDLY    IFEQ 'B'                                                           CRE090
     C                     MOVE 'B'       SIND                                                CRE090
     C                     ENDIF                                                              CRE090
     C                     ENDIF                           - E4                               CRE090
      *                                                                                       CRE090
     C                     ENDIF                           - E3                               CRE090
      *                                                                                       CRE090
     C           DLYTAG    TAG                                                                CRE090
      *                                                                                       CRE090
     C                     MOVE RCHISB    CHISB                                               CRE090
      *                                                                                       CRE090
      ** Convert number of days in date                                                       CRE090
      *                                                                                       CRE090
     C                     Z-ADDRCHISD    ZDAYNO                                              CRE090
      *                                                                                       CRE090
      ** For 1st day accruals, display actual cap. date.                                      CRE090
      *                                                                                       CRE090
     C********** BMLDAI    IFNE 'Y'                                                  CRE090 MD026757
     C**********           SUB  1         ZDAYNO                                     CRE090 MD026757
     C**********           END                                                       CRE090 MD026757
     C                     EXSR ZDATE2                                                        CRE090
     C                     MOVE ZDATE     SHID                                                CRE090
     C                     EXSR SUBFMT                                                        CRE090
      *                                                                                       CRE090
     C                     MOVE RCHISD    CHISD                                            MD027025A
     C           BMLDAI    IFNE 'Y'                                                        MD027025A
     C                     ADD  1         CHISD                                            MD027025A
     C                     END                                                             MD027025A
     C                     MOVE *BLANKS   CDICI                                             MD027025
     C                     MOVE *BLANKS   CCICI                                             MD027025
     C           SIND      IFEQ 'D'                                                         MD027025
     C           SIND      OREQ 'B'                                                         MD027025
     C                     MOVE 'Y'       CDICI                                             MD027025
     C                     ENDIF                                                            MD027025
     C           SIND      IFEQ 'C'                                                         MD027025
     C           SIND      OREQ 'B'                                                         MD027025
     C                     MOVE 'Y'       CCICI                                             MD027025
     C                     ENDIF                                                            MD027025
     C                     Z-ADDWPDID     PDID                                              MD027025
     C                     Z-ADDWPCID     PCID                                              MD027025
      *                                                                                     MD027025
     C                     MOVE *BLANKS   SRCA                                                CRE090
     C                     MOVE '-'       SRCA                                                CRE090
     C                     WRITERE3363B1                                                      CRE090
      ** Skip writing on F20 Charges subfile(RE3363B1) for Delayed Cap                        CRE090
      *                                                                                       CRE090
     C                     MOVE RCHISD    WRK,RN                                              CRE090
     C           BMLDAI    IFNE 'Y'                                                         MD027139
     C                     ADD  1         WRK,RN                                            MD027139
     C                     END                                                              MD027139
     C                     ADD  1         RN                                                  CRE090
     C                     SUB  1         COUNT                                               CRE090
      *                                                                                       CRE090
      ** Display next delayed cap record (if any)                                             CRE090
      *                                                                                       CRE090
     C           WDRDLY    IFEQ 'Y'                                                           CRE090
     C           WCRDLY    ANDEQ'Y'                                                           CRE090
     C           INDDLY    ANDEQ' '                                                           CRE090
     C                     MOVE 'Y'       INDDLY                                              CRE090
     C                     MOVE WCHISB    RCHISB                                              CRE090
     C                     Z-ADDWCHISD    RCHISD                                              CRE090
     C                     MOVE WSIND     SIND                                                CRE090
     C           RCHISD    IFEQ WNDID0                                                     MD027025A
     C                     Z-ADDWINT2     CDAIC                                            MD027025A
     C                     ELSE                                                            MD027025A
     C                     Z-SUBWINT2     CCAIC                                            MD027025A
     C                     ENDIF                                                           MD027025A
     C                     GOTO DLYTAG                                                        CRE090
     C                     ENDIF                                                              CRE090
      *                                                                                       CRE090
     C                     MOVE ' '       SIND2                                               CRE090
     C                     Z-ADDCDAIC     WCDAIC                                           MD027025A
     C                     Z-ADDCCAIC     WCCAIC                                           MD027025A
      *                                                                                       CRE090
     C                     ENDIF                           - E2                               CRE090
      *                                                                                       CRE090
     C                     ENDIF                           - E1                               CRE090
      *                                                                                       CRE090
     C                     ENDSR                                                              CRE090
     C********************************************************************
     C/EJECT
     C********************************************************************
     C*
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**   NAR  -  NARRATIVES
F3=Exit      F12=Initial screen      F13=History position      F24=More keys
                                     F20=Capit.interest        F24=More keys
                                     F20=Outst.interest        F24=More keys
**   TIT  -  TITLES
OUTSTANDING INTEREST ENQUIRY
CAPITALIZED INTEREST ENQUIRY
**  CPY@ OBJECT COPYRIGHT
(c) Misys International Banking Systems Ltd. 2001
**   CMD - COMMAND TO OVERIDE MESSAGE FILE
DLTOVR FILE(*ALL)
OVRMSGF MSGF(REUSRMSG) TOMSGF(  REUSRMSG)
OVRDBF FILE(REHISL) TOFILE(REHISL) SHARE(*NO)                                                 239966
