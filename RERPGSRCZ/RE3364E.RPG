     H        1
      *****************************************************************
/*STD *  RPGBASE                                                      *
/*EXI *  TEXT('Midas RE Interest details enquiry')                    *
     F*****************************************************************
     F*                                                               *
     F*  Midas - Retail Module                                        *
     F*                                                               *
     F*  RE3364E - RETAIL LINK ENQUIRY                                *
     F*            RETAIL INTEREST DETAILS                            *
     F*                                                               *
      *  (c) Finastra International Limited 2001                      *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  NOTE : BRT applies to Credit Interest and Credit Interest    *
     F*          Adjustments within the GIVEN CREDIT PERIOD ONLY !!!  *
     F*         It is not calculated on the adjustments to CR intr for*
     F*          previous Capitalisation Periods.                     *
     F*                                                               *
     F*  NOTE : For both DR & CR cap./run date selection (Days*Balance)
     F*         (1) should be added to TOTAL DEBIT NUMBER ONLY        *
     F*          if positive and if DR details are being processed.   *
     F*         (2) should be subtracted from TOTAL CREDIT NUMBER ONLY*
     F*          if negative and if CR details are being processed.   *
     F*         NOTE: ZICALC value is the best indicator of which     *
     F*          side is being currently processed.                   *
     F*                                                               *
     F*  NOTE : Backvalued RATE CHANGES are printed before the OPENING*
     F*          BALANCE as 'R-CHANGES'. All other changes within the *
     F*          Cap Period are printed after the Cap.Period Original *
     F*          Rate (OPENING RATE) as 'RATE CHANGES' as well.       *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  Last Amend No. MD056835           Date 23Mar21               *
      *  Prev Amend No. MD056973           Date 08Mar21               *
      *                 CER050             Date 16Jun19               *
      *                 MD046248           Date 27Oct17               *
      *                 CGL186             Date 06Oct17               *
      *                 MD027025A          Date 20Jun14               *
      *                 CRE090             Date 14Feb14               *
      *                 AR751622           Date 02May11               *
      *                 AR744736           Date 13Apr11               *
      *                 CER059             Date 19Jul10               *
      *                 BUG23024           Date 19Feb09               *
      *                 BUG22235           Date 15Jan09               *
      *                 CER016             Date 19May08               *
      * Bank Fusion Midas 1.4 Base -----------------------------------*
      *                 BUG26486           Date 19Oct09               *
      *                 260297             Date 19May09               *
      * Midas Plus 1.4 Base 04 ---------------------------------------*
      *                 249907             Date 13Sep07               *
      * Midas Plus 1.4 Base ------------------------------------------*
      * Midas Plus 1.3 ----------- Base ------------------------------*
      *                 206671             Date 06Jun06               *
      *                 CSD031             Date 10Apr06               *
      *                 CSD027             Date 09Dec05               *
      *                 BUG9057            Date 25Nov05               *
      *                 CLE025             Date 20Oct03               *
      *                 CAAA03             Date 21Apr04               *
      *                 CGL029             Date 01Sep03               *
      *                 214716             Date 14Mar03               *
      * Midas Release 4 --------------- Base -------------------------*
      * Midas DBA 3.05 -----------------------------------------------*
      *                 162759             Date 29Nov00               *
      * Midas DBA 3.04 -----------------------------------------------*
      * Midas DBA 3.03 -----------------------------------------------*
      *                 159536             Date 29Apr99               *
      *                 159560             Date 08Oct99               *
     F*                 158433             DATE 08Oct99               *
     F*                 152283             DATE 08Oct99               *
      * Midas DBA 3.00 ---------------- Base -------------------------*
     F*                 103860             DATE 20May98               *
     F*                 103862             DATE 07May98               *
     F*                 118816             DATE 26FEB98               *
     F*                 106369             DATE 24FEB98               *
     F*                 106277             DATE 24FEB98               *
     F*                 107791 (089107)    DATE 11FEB98               *
     F*                 104489             DATE 06FEB98               *
     F*                 113955             DATE 03FEB98               *
     F*                 093412             DATE 19JAN98               *
     F*                 CRE001             Date 18Feb97               *
     F*                 084790             Date 17Sep96               *
     F*                 089002             Date 01Jul96               *
     F*                 CRE003             DATE 10JUN96               *
     F*                 099509             DATE 25APR96               *
     F*                 101770             DATE 18APR96               *
     F*                 101483             DATE 17APR96               *
     F*                 098818             DATE 15APR96               *
     F*                 101473             DATE 15APR96               *
     F*                 100992             DATE 14APR96               *
     F*                 101332             DATE 28MAR96               *
     F*                 099508             DATE 12MAR96               *
     F*                 099513             DATE 12MAR96               *
     F*                 097423             DATE 21FEB96               *
     F*                 099511             DATE 20FEB96               *
     F*                 094433             DATE 25OCT95               *
     F*                 094431             DATE 16OCT95               *
     F*                 092181             DATE 10OCT95               *
     F*                 092182             DATE 18SEP95               *
     F*                 091612             DATE 14SEP95               *
     F*                 089497             DATE 19JUL95               *
     F*                 088733             DATE 13JUL95               *
     F*                 089027             DATE 30JUN95               *
     F*                 088827             DATE 30JUN95               *
     F*                 088737             DATE 30JUN95               *
     F*                 088734             DATE 28JUN95               *
     F*                 088726             DATE 27JUN95               *
     F*                 088826             DATE 27JUN95               *
     F*                 088746             DATE 27JUN95               *
     F*                 086560             DATE 06JUN95               *
     F*                 086559             DATE 06MAY95               *
     F*                 086094             DATE 04MAY95               *
     F*                 086254             DATE 20APR95               *
     F*                 086093             DATE 20APR95               *
     F*                 086230             DATE 13APR95               *
     F*                 075071             DATE 23FEB95               *
     F*                 078272             DATE 01NOV94               *
     F*                 077980             DATE 27OCT94               *
     F*                 077684             DATE 17OCT94               *
     F*                 075248             DATE 13OCT94               *
     F*                 077129             DATE 06OCT94               *
     F*                 075196             DATE 06OCT94               *
     F*                 075082             DATE 08SEP94               *
     F*                 075080             DATE 08SEP94               *
     F*                 075079             DATE 08SEP94               *
     F*                 075076             DATE 08SEP94               *
     F*                 S01408             DATE 31AUG94               *
     F*                 074600             DATE 23AUG94               *
     F*                 074595             DATE 23AUG94               *
     F*                 074594             DATE 22AUG94               *
     F*                 074590             DATE 22AUG94               *
     F*                 074581             DATE 19AUG94               *
     F*                 065773             DATE 08MAR94               *
     F*                 060823             DATE 27JAN94               *
     F*                 064993             DATE 27JAN94               *
     F*                 040447             DATE 27JAN94               *
     F*                 038151             DATE 27JAN94               *
     F*                 049678             DATE 27JAN94               *
     F*                 057291             DATE 15NOV93               *
     F*                 048247             DATE 28SEP93               *
     F*                 045322             DATE 28SEP93               *
     F*                 043037             DATE 28SEP93               *
     F*                 048574             DATE 28SEP93               *
     F*                 S01413 *CREATE     DATE 13APR93               *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
      *  MD056835 - Rate change for account with type 03/04 is shown  *
      *             in OSIC multiple times.                           *
      *  MD056973 - OSIC Enquiry - Number of Days for Total Interest  *
      *             is Incorrect. Do not adjust last cap. date if     *
      *             record read is from REHISPM.                      *
      *  CER050 - Annualised Percentage Rate                          *
      *  MD046248 - Finastra Rebranding                               *
      *  CGL186 - Customer Report Name on Enquiries                   *
      *         - Add Cust Report Name to Account Movements & OSIC.   *
      *  MD027025A - Incorrect details shown in Interest Details      *
      *              Enquiry of a delayed capitalisation record.      *
      *  CRE090 - Delay Capitalisation of Interest                    *
      *  AR751622 - Erroneous generated interest for Retail Account   *
      *             (non-leap year) when calculation basis is 0. Need *
      *             to include SR ZICD CER016 changes in /COPY        *
      *             ZICDREZ2 - (Recompile)                            *
      *             (Child: AR751623)                                 *
      *  AR744736 - Incorrect word on OSIC (Child: AR744737)          *
      *  CER059 - German Feature Upgrade to Delhi                     *
      *  BUG23024 - description 'For Retail' should be written        *
      *             as 'ACR/366' to be more descriptive               *
      *  BUG22235 - Array out of index error in RE3364E               *
      *  CER016 - German Interest Calculation: Upgrade of FGE059      *
      *           to Midas Plus                                       *
      *  BUG26486 - Coding standard (recompile)                       *
      *  260297 - Incorrect interest calculation w/ calc basis 6.     *
      *           Applied fix MQ1590.                                 *
      *  249907 - Use the correct rebatable and non-rebatable fields  *
      *           retrieved from RPG/RE3363 instead of using the      *
      *           previous charges fields in computing for the total  *
      *           credit posted field.                                *
      *  206671 - Overdraft information missing.                      *
      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
      *  CSD027 - Conversion Of Customer Number to Alpha              *
      *  BUG9057- AMEND/REINSTATE THE CODE BY 086230 TO SKIP          *
      *           PROCESSING ACCNT MOVEMENT DATA TO ACCESS CORRECT    *
      *           CAPITALISATION DATA IN REHISPS.                     *
      *         - Correct key field CKEY                              *
      *  CLE025 - Credit Lines (Recompile)                            *
      *  CAAA03 - Reverse image is showing in Webface without error.  *
      *           Recompile due to changes in RE3360DF.               *
      *  CGL029 - Increase Account Code to 10 digits                  *
      *  214716 - Total Debit Number is incorrect which is caused by  *
      *           core fix 159560. Reverse fix 159560.                *
      *  162759 - Move narrative in position 43-48 rather than        *
      *           position 37-42 in subroutine #ADJ during enquiry    *
      *           of interest details in screen OSIC.                 *
     F*  159536 - Recompile due to changes in RE3360DF.               *
     F*  159560 - Total Credit Number doesn't show correct digits.    *
     F*  158433 - Complete fix 152283 as the last interest displayed  *
     F*           in last capitalisation period is wrong when no      *
     F*           movements since capitalisation date.                *
     F*  152283 - Interest amount displayed is wrong when last event  *
     F*           is a rate change.                                   *
     F*  103860 - (& 103861) Incorrect reporting of generated         *
     F*           adjustments; review whole of gen. adj. processing.  *
     F*  103862 - Backvalued rate change incorrectly displayed as     *
     F*           zero for cap. for both sides/rundate.               *
     F*  118816 - Format used for interest amounts adjusted to        *
     F*           avoid amount truncation.                            *
     F*  106369 - Rate change on start date for DR or CR only cap'n   *
     F*           not reported. Fix is to check that the History Date *
     F*           is greater than OR equal to the DR/CR cap'n date.   *
     F*         - Amend SR/DRSR to set on highlight indicator *IN86   *
     F*           after outputting blank line after opening rate, as  *
     F*           per SR/CRSR.                                        *
     F*  107791 - 1 day interest missing for last period correction   *
     F*           of 48574 : use fields setup by RE3360               *
     F*  104489 - Use correct charge amounts when calculating total   *
     F*           credit posted & total to be posted.                 *
     F*  113955 - Session or device error on enquiry option caused by *
     F*           more than 9999 subfile records. Display 'Maximum    *
     F*           number of records displayed. Please use option 6.'  *
     F*           in 9999th record and do not output any more records.*
     F*  093412 - Move account name away from G/L number - recompile  *
     F*           over amended print files.                           *
     F*  CRE001 - Overdraft Interest Calculation:                     *
     F*           To show any changes to the allocated overdraft      *
     F*           line and allocated overdraft interest rate. Also    *
     F*           include the overdraft interest amount generated     *
     F*           together with normal DR interest calculation.       *
     F*  084790 - Improve display of Interest Calculation method.     *
     F*           Change the narrative to be more informative.        *
     F*         - Add missing array element 7 to the array.           *
     F*  089002 - Session or device error - correct use of *IN50      *
     F*  CRE003 - Ledger Balance Accruals                             *
     F*  099509 - Setup naratives for Rate changes (backvalued).      *
     F*         - Print 'Gen Adj to be Posted' if they are to be      *
     F*           posted to this account, Alternate Acc, or a Suspence*
     F*           Acc (SDCI : 'Y'= post to this acc, 'S'= post to Sus-*
     F*           pence Acc  and  'A'= post to Alternate Acc.         *
     F*         - Print 'Gen Adj to be posted' on both DR and CR.     *
     F*  101770 - For both DR & CR cap./run date selection, days X    *
     F*           balance should be added to total debit number ONLY  *
     F*           if positive and if DR details are being processed   *
     F*           and subtracted from total credit number ONLY if     *
     F*           negative and if CR details are being processed.     *
     F*          NOTE: ZICALC value is the best indicator of which    *
     F*           side is being currently processed.                  *
     F*  101483 - Manual adjustments not added into totals correctly. *
     F*           extention of 094433 fix = WWADJD/C not used !!!.    *
     F*         - Created RESET routine to clear partially setup work *
     F*           narrative fields.                                   *
     F*  098818 - The useage if SCICI/SDICI flags within COB is changed
     F*           to retain the original values of C,D,Y & ' '.       *
     F*           This should allow the I/C enquiries to differenciate*
     F*           between Attempted Closure, Capitalisation & Demand  *
     F*           Capitalisation and allow for adjustemt to HISD for  *
     F*           Capitalisatrion without causing the corruption of the
     F*           same HISD for the Atempted Account Closure (do not  *
     F*           SUB 1, if xxICI = 'C').                             *
     F*         - Stop the Backvalued Adjustments from corrupting     *
     F*           the Opening Interest Rate.                          *
     F*  101473 - Correct the ABOVE/BELOW narrative setup.            *
     F*  100992 - CR text not always reset to blanks.                 *
     F*  101332 - Before calling subroutine ZDATE2 set off *IN99      *
     F*           as the version of the s/r used here does not use    *
     F*           this indicator but it is used elsewhere in the pgm. *
     F*  099508 - Duplicated processing of 'Rate Change' on the  DR   *
     F*           side caused by error in 094431 fix application.     *
     F*  099513 - Generated Adj printed twice on the Credit side.     *
     F*           Caused by CLDID being used instead of CLCID for     *
     F*           credit Cap Date check agaist Adjustment date.       *
     F*  097423 - 075079 wrong for DR int. Fix 089027 should have     *
     F*           changed the indicator to work for DR and CR.        *
     F*  099511 - Stop same Man Adj from being retrieved twice for    *
     F*           the same DHISD (History Date)                       *
     F*  094433 - If there are no DR (or CR) interest details, then   *
     F*           fields should be set to represent zero rate.        *
     F*         - Postings are sometimes not displayed with           *
     F*           backvalued value date.                              *
     F*         - Manual adjustment amounts incorrectly added into    *
     F*           interest calculated for the following period.       *
     F*         - Manual adjustments not added into totals correctly. *
     F*           WWADJD/C not used. CPMADI/CTMADI CPMACI/CTMACI now. *
     F*           *IN51 '1' current period displayed. (in mid period) *
     F*           @CPTDY 'Y' DR or CR capitalisation yesterday.       *
     F*           SDICI/SCICI used for case displaying CR details     *
     F*           when DR only cap yesterday and vice versa.          *
     F*  094431 - Correct anomalies in interest amounts and totals.   *
     F*         - Further history selection processing.               *
     F*         - DB error if no rate change for history balance date.*
     F*         - Manual adjustments not displayed (although posted). *
     F*         - Improve display of Interest Calculation method.     *
     F*         - Display charge amounts correctly.                   *
     F*         - Change editing of negative values so the last digit *
     F*           does not show as a letter.                          *
     F*  092181 - If 1st day accruals and 1 side (DR or CR) cap'd the *
     F*           day before rundate (ie. value date = rundate),      *
     F*           selection of latest date (now rundate - 1) should   *
     F*           only show interest for the side which didn't        *
     F*           capitalise as otherwise a report for zero days will *
     F*           be produced for the side which capitalised. Also    *
     F*           for 1st day accruals, when a cap. for both DR & CR  *
     F*           on the day before rundate (ie. value date = rundate)*
     F*           is selected, total interest should be taken from    *
     F*           the cap. record instead of REACR (passed into pgm)  *
     F*           as DAIC/CAIC on REACR will now be zero. Also show   *
     F*           total debit/credit posted.                          *
     F*  092182 - Rate change on start date not displayed if start    *
     F*           point is a cap. for both DR and CR and selection    *
     F*           date is both DR & CR cap./run date.                 *
     F*  091612 a) Balance and days X bal. on interest line displayed *
     F*            as 0 if start point is a cap. with no movement on  *
     F*            that date. Error only occurs on selection of DR or *
     F*            CR cap. (not both). If no posting exists for start *
     F*            date, set history bal. to opening bal.             *
     F*         b) Total debit number/total credit number incorrect   *
     F*            and also not printed for DR or CR only cap. date.  *
     F*            For both DR & CR cap./run date selection, days X   *
     F*            balance should be added to total debit number only *
     F*            if positive and if DR details are being processed  *
     F*            and subtracted from total credit number only if    *
     F*            negative and if CR details are being processed.    *
     F*  089497 a) Back valued posting appears in more than one cap.  *
     F*            period ie. displayed as normal in value date period*
     F*            and displayed between B/F Bal. & Opening Bal in    *
     F*            posting date period. Not really an error because   *
     F*            B/F Bal. is the statement balance, so a backvalued *
     F*            posting has to be displayed at that point for the  *
     F*            opening bal to be correct. However this produces an*
     F*            inconsistency between C/F Bal in value date period *
     F*            and B/F bal in posting date period. Therefore      *
     F*            display ** Adjusted Balance C/F ** for the value   *
     F*            date period if a backvalued posting is found with  *
     F*            posting date after end of period.                  *
     F*         b) If no movements in a period, bal. and days X bal.  *
     F*            on interest line are displayed as 0. Error only    *
     F*            occurs for DR or CR cap. (not both). If no postings*
     F*            exist for period, set history bal. to opening bal. *
     F*         c) Final interest amount split because of cap. with   *
     F*            no interest posted or movement on that date. Do not*
     F*            assume there is a 'D' record for the same date and *
     F*            check for EOF/change of a/c. Also in RATESR do not *
     F*            set work history date & bal. if hist. date before  *
     F*            last cap. date.                                    *
     F*  088733 - Null record on REHISL (ie. no rate change, manual   *
     F*           adj. or movement) causes interest to be 'split' as  *
     F*           interest is output with no associated event.        *
     F*  089027 - Wrong text on credit opening rate: shows 'change to'*
     F*           Problem with 075079.                                *
     F*  088827 - Opening CR rate is output as blank when it has the  *
     F*           correct value on file.                              *
     F*  088737 - 'Total to be Posted' not always shown and also the  *
     F*           order of the 'Total to be Posted' and 'Total Posted'*
     F*           narratives can be inconsistent.                     *
     F*  088734 - Show minimum/maximum amounts. Recompiled only.      *
     F*  088726 - Wrong interest amount shown on enquiry if no further*
     F*           movements after capitalisation. Total is correct.   *
     F*  088826 - Attempted (but failed) closure results in a REHSPOP *
     F*           record with Value Date = Posting Date (normally     *
     F*           Value Date = Posting Date plus one) , this results  *
     F*           in the record being omitted from enquiry .          *
     F*           Ideally (i think) in case of failed closure the     *
     F*           Posting Date should be (automatically) adjusted to  *
     F*           the following day but I'm going to start the search *
     F*           a day early only selecting PostDate=ValueDate and   *
     F*           EntryType='C' (capitalisation).                     *
     F*           This fix should be applied with 088746 .            *
     F*  088746 - Too few days showing & opening balance date too late*
     F*           problem connected with failed closure , coding for  *
     F*           077684 adjusted .                                   *
     F*           This fix should be applied with 088826 .            *
     F*  086230 - Reopened bacause a database error is still reported *
     F*           if enquiry is taken into a period after a failed    *
     F*           closure attempt. Last cap record not accessed       *
     F*           correctly. Infact, previous fix 077684 needs more   *
     F*           processing added to it.                             *
     F*  086560 - Following tiers/theshholds not displayed after rate *
     F*           of 0.00000000+ found.                               *
     F*  086559 - CATER FOR BAL3 AND RAT3 BLANK DUE TO NO REHPOSR3 REC*
     F*  086094 - Amendment to 075071 (fix in DDS) .                  *
     F*           Cause - Last line on last page still blanks pos79/80*
     F*                   '  ' put out (as opposed to ' +')           *
     F*           Action- Use SFLEND(*MORE) to display 'more' on      *
     F*                   following line (as opposed to ' +')         *
     F*           Result- No need for line of blanks with just '+'.   *
     F*           (NOTE: actual code from 075071 deleted) .           *
     F*  086254 - a) -ve interest amount prints as letter (last char.)*
     F*              changed to ignore sign (use absolute)            *
     F*           b) Bad editing prints '0. 9' instead of '0.09'.     *
     F*              Caused by 077129 earlier attempt to remedy some  *
     F*              of a) - (number of days ND mixed up with total   *
     F*                       interest)                               *
     F*           c) Text 'CF12 Previous  screen' changed             *
     F*                to 'CF12 Previous screen'                      *
     F*  086093 - -ve interest rate prints as squiggle should have - .*
     F*           Remove GHOST .                                      *
     F*  086230 - Doesn't exit correctly after printing report - Error*
     F*           displayed - write to closed file.                   *
     F*           Problem caused by 075071 .                          *
     F*  075071 - Additional mod to prevent '+' for SflEnd overwriting*
     F*           last two characters of SflRecord.                   *
     F*           If bottom line on SflPag and more records to show   *
     F*           output blank line to Sfl and display actual record  *
     F*           on next page .                                      *
     F*         - Previous interest details show current subtype.     *
     F*  078272 - ONLY SHOW RATES ETC IF BOTH BALANCE AND RATE NOT 0  *
     F*  077980 - TIERS NOT ALWAYS SHOWN IF FIRST BAL ZERO            *
     F*  077684 - TRY TO PREVENT DBASE ERROR                          *
     F*  075248 - Int. amount wrong if rate change in previous period.*
     F*  077129 - Enquiry shows negative interest rates of 1.2345678- *
     F*           as 1.234567}. Negative amounts of 135.24 show as    *
     F*           135.2M etc...                                       *
     F*  075196 - Addition to 075079 re interest type.                *
     F*  075082 - Extra band appears on the tiers which is not        *
     F*           required.                                           *
     F*  075080 - No. of days wrong if rate change in previous period.*
     F*  075079 - Rate narratives appear inconsistently. Ensure first *
     F*           is 'Opening Rate' and rest are 'Rate Change To'.    *
     F*           Also where Type/Subtype has been previously entered *
     F*           and removed, display 0% rate, not Subtype '00000'.  *
     F*  075076 - Interest sub period amount sometimes shown as 0.00  *
     F*           when it should be an amount. The total is correct.  *
     F*  S01408 - Addition of Hooks RE3364EPDR, RE3364EPLT.           *
     F*  074600 - Attempted to open RE3364AU twice if DB error.       *
     F*           Also pass failed status to RE3363 for screen error. *
     F*  074595 - No. of days for credit 'Total interest' wrong.      *
     F*  074594 - Nothing happens on pressing F20 if charge           *
     F*           amount is exactly zero.                             *
     F*  074590 - Add Account name to enquiry details.                *
     F*  074581 - I/O error on print request. Trying to write to      *
     F*           printer file when still closed.                     *
     F*  065773 - Show correct manual adjustement                     *
     F*  060823 - When total charges equal zero message given         *
     F*           '008 - Total Charges Lower Than Zero'               *
     F*  064993 - Add '*' if Turnover Commission                      *
     F*  040447 - Print the correct opening rate                      *
     F*  038151 - Only reset the previous interest values when        *
     F*           necessary.                                          *
     F*  049678 - Numbers are false.                                  *
     F*  057291 - Opening rate incorrect                              *
     F*  048247 - Suppress DB err 023                                 *
     F*  045322 - Fields not cleared for output of interest rates     *
     F*  043037 - Interest line duplicated when postings are being    *
     F*           displayed                                           *
     F*  048574 - Use parameters CCAIC and CDAIC rather than          *
     F*           CAICP1 and DAIC1 from REACRD file when              *
     F*           outputting total interest.                          *
     F*  S01413 - Retail 3 Incorporation                              *
     F*                                                               *
     F*****************************************************************
     F*                                                               *
     F*  C R E A T I O N     P A R A M E T E R S                      *
     F*                                                               *
     F*                                                               *
     F*****************************************************************
     F*GHOST**CF* F      79            SPECIAL       RE#IO                086093
     FRE3360DFCF  E                    WORKSTN
     F                                        RECN1 KSFILE RE3364B1
     F                                        RECN2 KSFILE RE3364B2
     F                                        RECN3 KSFILE RE3364B3
     F            RE3360F1                          KIGNORE
     F            RE3360F2                          KIGNORE
     F            RE3361F0                          KIGNORE
     F            RE3361ER                          KIGNORE
     F            RE3361F1                          KIGNORE
     F            RE3361SB                          KIGNORE
     F            RE3361SC                          KIGNORE
     F            RE3362E0                          KIGNORE
     F            RE3362F0                          KIGNORE
     F            RE3362HE                          KIGNORE
     F            RE3362PB                          KIGNORE
     F            RE3362PC                          KIGNORE
     F            RE3363F0                          KIGNORE
     F            RE3363F1                          KIGNORE
     F            RE3363F2                          KIGNORE
     F            RE3363F3                          KIGNORE
     F            RE3363B1                          KIGNORE
     F            RE3363C1                          KIGNORE
     F            RE3363B2                          KIGNORE
     F            RE3363C2                          KIGNORE
     F*
     FREHISL  IF  E           K        DISK
     F*
     FREHPOPH IF  E           K        DISK
     F            REHPOSPF                          KRENAMEREHPOPHF
     F*
     FREHPOPL IF  E           K        DISK
     F            REHPOSPF                          KRENAMEREHPOPLF
     F*                                                                   094431
     FREHPOML3IF  E           K        DISK                               094431
     F*
     FACCRACJ IF  E           K        DISK
     F*
     FREHRDJ  IF  E           K        DISK
     F*
     FREHRCJ  IF  E           K        DISK
     F*
     FREHISSL IF  E           K        DISK
     F            REHISPSF                          KRENAMEREADJF
     F*
     FRE3364AUO   E                    PRINTER      KINFDS SPOLAU     UC
     FRE3364DRO   E             63     PRINTER      KINFDS SPOLDR     UC
     FRE3364CRO   E             64     PRINTER      KINFDS SPOLCR     UC
     F            RE3364C1                          KRENAMERE33641C
     F            RE3364C2                          KRENAMERE33642C
     FRE3364CHO   E             65     PRINTER      KINFDS SPOLCH     UC
     F/COPY WNCPYSRC,RE3364EF01
     FREAPRHI0IF  E           K        DISK                                                   CER050
     FREAPRHI1IF  E           K        DISK                                                   CER050
     F            REAPRHD0                          KRENAMEREAPRHD1                           CER050
     FACCNTBY0IF  E           K        DISK                                                   CER050
     F*
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  F U N C T I O N   O F   I N D I C A T O R S                  *
     F*                                                               *
     F*   03  -  End of job                                           *
     F*   12  -  Initial screen                                       *
     F*   18  -  Debit interest                                       *
     F*   19  -  Credit interest                                      *
     F*   20  -  Alternative view of Interests and Charges            *
     F*   24  -  Overdraft Line change indicator is blank             *   CRE001
     F*   50  -  SFLDSPCTL and SFLCLR indicator                       *
     F*   85  -  Underline                                            *
     F*   86  -  Highlight                                            *
     F*   88  -  Do not print retail nbr                              *
     F*                                                               *
     F*   LR  -  End of program                                       *
     F*   03  -  Cancel Job                                           *
     F*   12  -  Return to RE3363                                     *
     F*   18  -  Calls Subfile 1 to show Debit interest               *
     F*   19  -  Calls Subfile 2 to show Credit interest              *
     F*   20  -  Calls Subfile 3 to show Charges                      *
     F*   08  -  To loop in subroutine CRED2                          *
     F*   09  -  To loop in subroutine DEBI, CRED, BOTH               *
     F*   21  -  Control Debit Rate text                              *   075079
     F*   22  -  Control Credit Rate text                             *   075079
     F*   25  -  To display the '%' sign                              *
     F*   26  -  To display valid date when change date               *
     F*   55  -  To detect end of file (REHPOPH & REHPOPL)            *
     F*   51  -  To detect end of file (REHISL)                       *
     F*   89  -  Error indicator                                      *
     F*   60  -  To position in file (REHRDJ)                         *
     F*   62  -  To detect end of file (REHRDJ)                       *
     F*   63  -  To detect OVERFLOW    (RE3364DR)                     *
     F*   64  -  To detect OVERFLOW    (RE3364CR)                     *
     F*   65  -  To detect OVERFLOW    (RE3364CH)                     *
     F*   80  -  File indicator - REHISSL                             *   103860
     F*   96  -  To detect end of file (RECAPM)                       *
     F*   99  -  Special file indicator                               *
     F*   98  -  To detect end of file (ACCRACJ)                      *
     F*                                                               *
     F*****************************************************************
      /EJECT
     F*****************************************************************
     F*                                                               *
     F*  S U B R O U T I N E   I N D E X                              *
     F*                                                               *
     F*  FIRST  -  To execute first cycle, initialize fields          *
     F*  MAIN   -  Display formats following debit or credit ind.     *
     F*  DEBI   -  To display debit interest                          *
     F*  CRED   -  To display credit interest                         *
     F*  BOTH   -  To display both debit and credit                   *
     F*  CRED2  -  To display interest or charges                     *
     F*  EXIT   -  To get out of program                              *
     F*  SPLI   -  To initialize indicator for charges or interests   *
     F*  BFOPSR -  To B/F and OP BALANCE output processing            *
     F*  DRSR   -  To fill subfile 1 - Debit only                     *
     F*  RATED  -  Debit output processing                            *
     F*  RDRSR  -  Rate output processing                             *
     F*  CRSR   -  To fill subfiles 2 and 3 - Credit only             *
     F*  RATEC  -  Credit output processing                           *
     F*  RCRSR  -  Rate output processing                             *
     F*  DAYCSR -  Subtotal output processing                         *
     F*  BOTHSR -  To fill both subfiles 1, 2 and 3 - Debit and Credit*
     F*  B1EQ   -  Begin when same date                               *
     F*  B1LT   -  Begin when debit lower than credit                 *
     F*  B1GT   -  Begin when debit greater than credit               *
     F*  POSTSR -  Posting output                                     *
     F*  OPENDR -  Debit output - Opening balance and rate            *
     F*  OPENCR -  Credit output - Opening balance and rate           *
     F*  RATESR -  Debit and credit rate change                       *
     F*  SUBW1  -  Write in subfile 1                                 *
     F*  SUBW2  -  Write in subfiles 2 and 3                          *
     F*  SUBW3  -  To write subfile record                            *
     F*  LINE1  -  Add blank line in subfile 1                        *
     F*  LINE2  -  Add blank line in subfiles 2 and 3                 *
     F*  ZICD   -  Nbr of days to calc. int. according to calc. basis *
     F*  DBSR   -  Subroutine for data base error                     *
     F*  #MADI  -  To display manual adjustment                       *
     F*  #MACI  -  To display manual adjustment                       *
     F*  ZASNMS -  To send message to program message queue           *
     F*  ZDATE2 -  To convert day number to date format               *
     F*  ZEDIT  -  To insert decimal point and suppress leading zeros *
     F*                                                               *
     F*****************************************************************
     E/EJECT
     E*
     E/COPY ZSRSRC,ZDATE2Z1
     E*
     E/COPY ZSRSRC,ZEDITZ1
     E/COPY ZSRSRC,RTINDEF1                                                                   MQ1590
     E*
     E/COPY WNCPYSRC,RE3364EE01
     E                    CPY@    1   1 80
     E*
     E********************NAR     1  32 79                                074594
     E********************NAR     1  33 79                          074594CRE003
     E********************NAR     1  38 79                          CRE003089497
     E********************NAR     1  39 79                          089497099509
     E******************* NAR     1  41 79                         099509 113955
     E********************NAR     1  42 79                         113955 103860
     E********************NAR     1  48 79                                             103860 CRE090
     E********************NAR     1  49 79                                          CRE090 MD027025A
     E                    NAR     1  50 79                                                 MD027025A
     E*
     E                    AR         79  1               line display     086093
      *                                                                   086254
     E                    Z#2        18  1  A            bracket editing  086254
      *                                                  (size ZA2 + 2)   086254
      *                                                                   086254
      *                                                                   086254
     E                    Z#3        19  1  A            bracket edit + % 086254
      *                                                  (size ZA2 + 3).  086254
      *                                                                   086254
     E                    ARB        12 16
     E*
     E                    ARR        12 16
     E*
     E                    NEG        12  1                                077129
     E/COPY WNCPYSRC,RE3364EE02
     E*                                                                   077129
     E********************CAC     1   6 20                                094431
     E**********          CAC     1   7 38                                             094431 CER016
     E                    CAC     1   8 38                                                    CER016
     E/COPY WNCPYSRC,RE3364EE03
     E*
     E                    CMD     1   2 41
     I/EJECT
     I*
     I*GHOST**NS*                                                         086093
     I***********                             1  79 AREA                  086093
     I*                                                                   094431
     IREHPOSMF                                                            094431
     I              DRCR                            MDRCR                 094431
     I              VALD                            MVALD                 094431
     I              HISD                            HISDM                 094431
     IREHISPMF
     I*
     I** RENAME REHISPMF FORMAT FIELDS - REHISL  FILE
     I*
     I              RECI                            DRECI
     I              HISD                            MHISD
     I*
     IREHISPSF
     I*
     I** RENAME REHISPSF FORMAT FIELDS - REHISL  FILE
     I*
     I              RECI                            DRECI
     I              BRCA                            SBRCA
     I              CNUM                            SSCNUM
     I              CCY                             SCCY
     I              ACOD                            SSACOD
     I              ACSQ                            SSACSQ
     I              HISD                            DHISD
     I              HISB                            SHISB
     I              MNBL                            SMNBL
     I              PCHGAR                          SCHGAR
     I              TCHGAR                          STHGAR
     I              PCHGAN                          SCHGAN
     I              TCHGAN                          STHGAN
     I              DICT                            DDICT
     I              DRCB                            SDRCB
     I              DRCD                            SDRCD
     I              DAIC                            SDAIC
     I              PMADI                           SPMADI
     I              TMADI                           STMADI
     I              PDID                            SPDID
     I              DMINT                           SDMINT
     I              DRIP                            SDRIP
     I              DRIS                            SDRIS
     I              CICT                            DCICT
     I              CRCB                            SCRCB
     I              CRCD                            SCRCD
     I              CAIC                            SCAIC
     I              PMACI                           SPMACI
     I              TMACI                           STMACI
     I              PCID                            SPCID
     I              CMINT                           SCMINT
     I              CRIP                            SCRIP
     I              CRIS                            SCRIS
     I              STBL                            SSTBL
     I              CHGP                            SCHGP
      *                                                                   CRE001
     I              AODR                            SAODR                 CRE001
     I              ODRL                            SODRL                 CRE001
     I              ODIA                            SODIA                 CRE001
      *                                                                   CRE001
     IREHISPPF
     I*
     I** RENAME REHISPPF FORMAT FIELDS - REHISL  FILE
     I*
     I              RECI                            DRECI
     I              BRCA                            DBRCA
     I              CNUM                            DCNUM
     I              CCY                             DCCY
     I              ACOD                            DACOD
     I              ACSQ                            DACSQ
     I              HISD                            DHISD
     I              HISB                            DHISB
     I              MNBL                            DMNBL
     I              CHGAR                           DCHGAR
     I              TCHGAR                          DTHGAR
     I              CHGAN                           DCHGAN
     I              TCHGAN                          DTHGAN
     I              DMVT                            DDMVT
     I              DICT                            DDICT
     I              DRCB                            DDRCB
     I              DRCD                            DDRCD
     I              DAID                            DDAID
     I              MADI                            DMADI
     I              TMADI                           DTMADI
     I              PDID                            DPDID
     I              DMINT                           DDMINT
     I              CMVT                            DCMVT
     I              CICT                            DCICT
     I              CRCB                            DCRCB
     I              CRCD                            DCRCD
     I              CAID                            DCAID
     I              MACI                            DMACI
     I              TMACI                           DTMACI
     I              PCID                            DPCID
     I              CMINT                           DCMINT
     I              DICI                            DDICI
     I              CICI                            DCICI
     I              DRCI                            DDRCI
     I              CRCI                            DCRCI
     I              VDTC                            DVDTC
     I              ADTY                            DADTY
     I              ALTI                            DALTI
     I              MNBCP                           DMNBCP
      *                                                                   CRE001
     I              AODR                            DAODR                 CRE001
     I              ODRL                            DODRL                 CRE001
     I              ODIA                            DODIA                 CRE001
     I*
     IREHRDJF
     I*
     I** RENAME REHRDJF  FORMAT FIELDS - REHRDJ  FILE
     I*
     I              RECI                            RRECI
     I              PSTD                            RPSTD
     I              VALD                            RVALD
     I              HISD                            RHISD
     I              PNAR                            RPNAR
     I              DRCR                            RDRCR
     I              INTP                            RINTP                 075196
     I              INST                            RINST                 075071
     I*
     IREHRCJF
     I*
     I** RENAME REHRCJF  FORMAT FIELDS - REHRCJ  FILE
     I*
     I              RECI                            RRECI
     I              PSTD                            RPSTD
     I              VALD                            RVALD
     I              HISD                            RHISD
     I              PNAR                            RPNAR
     I              DRCR                            RDRCR
     I              INTP                            RINTP                 075196
     I              INST                            RINST                 075071
     IREADJF
     I*
     I** RENAME READJF   FORMAT FIELDS - REHISSL FILE
     I*
     I              RECI                            ARECI
     I              BRCA                            ABRCA
     I              CNUM                            ACNUM
     I              CCY                             ACCY
     I              ACOD                            AACOD
     I              ACSQ                            AACSQ
     I              HISD                            AHISD
     I              HISB                            AHISB
     I              MNBL                            AMNBL
     I              PCHGAR                          ACHGAR
     I              TCHGAR                          ATHGAR
     I              PCHGAN                          ACHGAN
     I              TCHGAN                          ATHGAN
     I              DICT                            ADICT
     I              DRCB                            ADRCB
     I              DRIR                            ADRIR                 103860
     I              DRCD                            ADRCD
     I              DAIC                            ADAIC
     I              PMADI                           APMADI
     I              TMADI                           ATMADI
     I              PDID                            APDID
     I              DMINT                           ADMINT
     I              SGADI                           ASGADI                103860
     I              DRIP                            ADRIP
     I              SDICI                           ASDICI                103860
     I              DRIS                            ADRIS
     I              SDCI                            ASDCI                 103860
     I              CICT                            ACICT
     I              CRCB                            ACRCB
     I              CRIR                            ACRIR                 103860
     I              CRCD                            ACRCD
     I              CAIC                            ACAIC
     I              PMACI                           APMACI
     I              TMACI                           ATMACI
     I              PCID                            APCID
     I              CMINT                           ACMINT
     I              SGACI                           ASGACI                103860
     I              CRIP                            ACRIP
     I              SCICI                           ASCICI                103860
     I              CRIS                            ACRIS
     I              SCCI                            ASCCI                 103860
     I              STBL                            ASTBL
     I              CHGP                            ACHGP
     I*                                                                   CRE001
     I              AODR                            AAODR                 CRE001
     I              ODRL                            AODRL                 CRE001
     I              ODIA                            AODIA                 CRE001
     I*                                                                   CRE001
     IPSDS       SDS
     I*
     I** RETRIEVE WSID FROM PROGRAM STATUS DATA STRUCTURE
     I*
     I                                      244 253 SWSID
     I                                      254 263 SUSER
     I*
     I            DS
     I                                        1  150NUMR
     I*
     I            DS
     I                                        1  150NUMB0
     I                                       16  300HISB0
      *                                                                   CRE001
     I                                       16  301HISB1                 CRE001
     I                                       16  302HISB2                 CRE001
     I                                       16  303HISB3                 CRE001
      *                                                                   CRE001
     I                                       31  450INTD0
     I                                       46  600INTC0
     I                                       61  750TINTD0
     I                                       76  900TINTC0
     I*                                                                   CRE001
     I** DATA STRUCTURE FOR OVERDRAFT LINE WORK FIELD                     CRE001
     I*                                                                   CRE001
     I            DS                                                      CRE001
     I                                        1  150FODRL                 CRE001
     I                                        1  151FODRL1                CRE001
     I                                        1  152FODRL2                CRE001
     I                                        1  153FODRL3                CRE001
     I*
     I** DATA STRUCTURE FOR BEGINNING DATE
     I*
     I            DS
     I                                        1   60SRES
     I                                        1   20ZISD
     I                                        3   40ZISM
     I                                        5   60ZISY
     I*
     I** DATA STRUCTURE FOR FINISHING DATE
     I*
     I            DS
     I                                        1   60FRES
     I                                        1   20ZIFD
     I                                        3   40ZIFM
     I                                        5   60ZIFY
     I*
     I** DATA STRUCTURE FOR RATE
     I*
     I            DS
     I                                        1  117ORAT1
     I                                       12  227ORAT2
     I                                       23  337ORAT3
     I*
     I** DATA STRUCTURE FOR BALANCE
     I*
     I            DS
     I                                        1  150OBAL01
     I                                       16  300OBAL02
     I                                       31  450OBAL03
     I*
     I** DATA STRUCTURE FOR RATE SPREAD
     I*
     I            DS
     I                                        1  36 RAT2
     I                                    P   1   67RAT21
     I                                    P   7  127RAT22
     I                                    P  13  187RAT23
     I                                    P  19  247RAT24
     I                                    P  25  307RAT25
     I                                    P  31  367RAT26
     I                                        1   6 RATC21
     I                                        7  12 RATC22
     I                                       13  18 RATC23
     I                                       19  24 RATC24
     I                                       25  30 RATC25
     I                                       31  36 RATC26
     I*
     I            DS
     I                                        1  36 RAT3
     I                                    P   1   67RAT31
     I                                    P   7  127RAT32
     I                                    P  13  187RAT33
     I                                    P  19  247RAT34
     I                                    P  25  307RAT35
     I                                    P  31  367RAT36
     I                                        1   6 RATC31
     I                                        7  12 RATC32
     I                                       13  18 RATC33
     I                                       19  24 RATC34
     I                                       25  30 RATC35
     I                                       31  36 RATC36
     I*
     I** DATA STRUCTURE FOR BALANCE
     I*
     I            DS
     I                                        1  48 BAL2
     I                                    P   1   80BAL21
     I                                    P   9  160BAL22
     I                                    P  17  240BAL23
     I                                    P  25  320BAL24
     I                                    P  33  400BAL25
     I                                    P  41  480BAL26
     I*
     I            DS
     I                                        1  48 BAL3
     I                                    P   1   80BAL31
     I                                    P   9  160BAL32
     I                                    P  17  240BAL33
     I                                    P  25  320BAL34
     I                                    P  33  400BAL35
     I                                    P  41  480BAL36
      *                                                                                       MQ1590
      ** Data Structure for date format MM/DD/YY                                              MQ1590
      *                                                                                       MQ1590
     I            DS                                                                          MQ1590
     I                                        1   60RESULX                                    MQ1590
     I                                        1   20ZMTHX                                     MQ1590
     I                                        3   40ZDAYX                                     MQ1590
     I                                        5   60ZYEARX                                    MQ1590
      *                                                                                       MQ1590
      ** Data Structure for beginning date MM/DD/YY                                           MQ1590
      *                                                                                       MQ1590
     I            DS                                                                          MQ1590
     I                                        1   60SRESX                                     MQ1590
     I                                        1   20ZISMX                                     MQ1590
     I                                        3   40ZISDX                                     MQ1590
     I                                        5   60ZISYX                                     MQ1590
      *                                                                                       MQ1590
      ** Data Structure for finishing date MM/DD/YY                                           MQ1590
      *                                                                                       MQ1590
     I            DS                                                                          MQ1590
     I                                        1   60FRESX                                     MQ1590
     I                                        1   20ZIFMX                                     MQ1590
     I                                        3   40ZIFDX                                     MQ1590
     I                                        5   60ZIFYX                                     MQ1590
     IRKEY2       DS
     I*************************************   1  18 RKEY                                     BUG9057
     I************************************** 19  230WDATE                                    BUG9057
     I                                        1  24 RKEY                                     BUG9057
     I                                       25  290WDATE                                    BUG9057
     IDSLDA      UDS
     I*
     I** AREA TO GET PARAMETERS FROM CALLING PROGRAM
     I                                        1   1 WTYP
     I                                        2   4 WBRCA
     I                                        2   4 @BRCA
     I                                        5  10 WCNUM
     I                                       11  13 WCCY
     I**********                             14  17 WACOD                                     CGL029
     I**********                             18  19 WACSQ                                     CGL029
     I**********                             20  24 WHISD                                     CGL029
     I**********                             25  34 WACNO                                     CGL029
     I**********                             35  35 WZAD                                      CGL029
     I**********                             36  42 WRUNA                                     CGL029
     I**********                             43  43 WDATF                                     CGL029
     I**********                             44  44 WCANC                                     CGL029
     I**********                             45  46 WFROM1                                    CGL029
     I**********                             47  48 WFROM2                                    CGL029
     I**********                             49  49 WPRINT                                    CGL029
     I**********                             51  63 DAICCH                             107791 CGL029
     I**********                             64  76 CAICCH                             107791 CGL029
     I**********                            101 101 CRECI                                     CGL029
     I**********                            103 105 CBRCA                                     CGL029
     I**********                            106 1110CCNUM                                     CGL029
     I**********                            112 114 CCCY                                      CGL029
     I**********                            115 1180CACOD                                     CGL029
     I**********                            119 1200CACSQ                                     CGL029
     I**********                            103 120 CKEY                                      CGL029
     I**********                          P 121 1230CHISD                                     CGL029
     I**********                          P 124 1310CHISB                                     CGL029
     I**********                          P 132 1390CMNBL                                     CGL029
     I**********                          P 140 1460CPHGAR                                    CGL029
     I**********                          P 147 1530CTHGAR                                    CGL029
     I**********                          P 154 1600CPHGAN                                    CGL029
     I**********                          P 161 1670CTHGAN                                    CGL029
     I**********                            168 1690CDICT                                     CGL029
     I**********                            170 1700CDRCB                                     CGL029
     I**********                          P 171 1767CDRIR                                     CGL029
     I**********                          P 177 1790CDRCD                                     CGL029
     I**********                          P 180 1870CDAIC                                     CGL029
     I**********                          P 188 1940CPMADI                                    CGL029
     I**********                          P 195 2010CTMADI                                    CGL029
     I**********                          P 202 2040CLDID                                     CGL029
     I**********                          P 205 2110CDMINT                                    CGL029
     I**********                          P 212 2180CSGADI                                    CGL029
     I**********                          P 219 2250CDRIP                                     CGL029
     I**********                            226 226 CDICI                                     CGL029
     I**********                          P 227 2330CDRIS                                     CGL029
     I**********                            234 248 CSDACP                                    CGL029
     I**********                            249 249 CSDCI                                     CGL029
     I**********                            250 2510CCICT                                     CGL029
     I**********                            252 2520CCRCB                                     CGL029
     I**********                          P 253 2587CCRIR                                     CGL029
     I**********                          P 259 2610CCRCD                                     CGL029
     I**********                          P 262 2690CCAIC                                     CGL029
     I**********                          P 270 2760CPMACI                                    CGL029
     I**********                          P 277 2830CTMACI                                    CGL029
     I**********                          P 284 2860CLCID                                     CGL029
     I**********                          P 287 2930CCMINT                                    CGL029
     I**********                          P 294 3000CSGACI                                    CGL029
     I**********                          P 301 3070CCRIP                                     CGL029
     I**********                            308 308 CCICI                                     CGL029
     I**********                          P 309 3150CCRIS                                     CGL029
     I**********                            316 330 CSCACP                                    CGL029
     I**********                            331 331 CSCCI                                     CGL029
     I**********                          P 332 3390CSTBL                                     CGL029
     I**********                          P 340 3460CCHGP                                     CGL029
     I**********                            347 361 CSCHAC                                    CGL029
     I**********                          P 362 3690CMNBCP                                    CGL029
     I**********                            370 370 CSCHGI                                    CGL029
     I                                       14  23 WACOD                                     CGL029
     I                                       24  25 WACSQ                                     CGL029
     I                                       26  30 WHISD                                     CGL029
     I                                       31  40 WACNO                                     CGL029
     I                                       41  41 WZAD                                      CGL029
     I                                       42  48 WRUNA                                     CGL029
     I                                       49  49 WDATF                                     CGL029
     I                                       50  50 WCANC                                     CGL029
     I                                       51  52 WFROM1                                    CGL029
     I                                       53  54 WFROM2                                    CGL029
     I                                       55  55 WPRINT                                    CGL029
     I                                       57  69 DAICCH                                    CGL029
     I                                       70  82 CAICCH                                    CGL029
     I                                      101 101 CRECI                                     CGL029
     I                                      103 105 CBRCA                                     CGL029
     I**********                            106 1110CCNUM                              CGL029 CSD027
     I                                      106 111 CCNUM                                     CSD027
     I                                      112 114 CCCY                                      CGL029
     I                                      115 1240CACOD                                     CGL029
     I                                      125 1260CACSQ                                     CGL029
     I**************************************109 126 CKEY                              CGL029 BUG9057
     I                                      103 126 CKEY                                     BUG9057
     I                                    P 127 1290CHISD                                     CGL029
     I                                    P 130 1370CHISB                                     CGL029
     I                                    P 138 1450CMNBL                                     CGL029
     I                                    P 146 1520CPHGAR                                    CGL029
     I                                    P 153 1590CTHGAR                                    CGL029
     I                                    P 160 1660CPHGAN                                    CGL029
     I                                    P 167 1730CTHGAN                                    CGL029
     I                                      174 1750CDICT                                     CGL029
     I                                      176 1760CDRCB                                     CGL029
     I                                    P 177 1827CDRIR                                     CGL029
     I                                    P 183 1850CDRCD                                     CGL029
     I                                    P 186 1930CDAIC                                     CGL029
     I                                    P 194 2000CPMADI                                    CGL029
     I                                    P 201 2070CTMADI                                    CGL029
     I                                    P 208 2100CLDID                                     CGL029
     I                                    P 211 2170CDMINT                                    CGL029
     I                                    P 218 2240CSGADI                                    CGL029
     I                                    P 225 2310CDRIP                                     CGL029
     I                                      232 232 CDICI                                     CGL029
     I                                    P 233 2390CDRIS                                     CGL029
     I                                      240 260 CSDACP                                    CGL029
     I                                      261 261 CSDCI                                     CGL029
     I                                      262 2630CCICT                                     CGL029
     I                                      264 2640CCRCB                                     CGL029
     I                                    P 265 2707CCRIR                                     CGL029
     I                                    P 271 2730CCRCD                                     CGL029
     I                                    P 274 2810CCAIC                                     CGL029
     I                                    P 282 2880CPMACI                                    CGL029
     I                                    P 289 2950CTMACI                                    CGL029
     I                                    P 296 2980CLCID                                     CGL029
     I                                    P 299 3050CCMINT                                    CGL029
     I                                    P 306 3120CSGACI                                    CGL029
     I                                    P 313 3190CCRIP                                     CGL029
     I                                      320 320 CCICI                                     CGL029
     I                                    P 321 3270CCRIS                                     CGL029
     I                                      328 348 CSCACP                                    CGL029
     I                                      349 349 CSCCI                                     CGL029
     I                                    P 350 3570CSTBL                                     CGL029
     I                                    P 358 3640CCHGP                                     CGL029
     I                                      365 385 CSCHAC                                    CGL029
     I                                    P 386 3930CMNBCP                                    CGL029
     I                                      394 394 CSCHGI                                    CGL029
     I                                      536 536 SIND2                                  MD027025A
     I                                      537 549 PDRADJ                                 MD027025A
     I                                      550 562 PCRADJ                                 MD027025A
     I            DS
     I                                        1  41 CMD2
     I                                       31  32 WWLGID
     ILDA         DS                            256
     I*
     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
     I*
     I                                      134 141 DBFILE
     I                                      142 170 DBKEY
     I                                      171 180 DBPGM
     I                                      181 1830DBASE
     I*
     I            DS
     I                                        1  15 TPSBT
     I                                        1   7 COMT
     I                                        8   9 TYPE
     I                                       10  10 FLD01
     I                                       11  15 SBTP
     ISPOLAU      DS
     I*
     I**  FILE INFORMATION DATA STRUCTURE (FOR RE3364AU)
     I*
     I                                       83  92 SFILEA
     I                                    B 123 1240SFNUMA
     ISPOLDR      DS
     I*
     I**  FILE INFORMATION DATA STRUCTURE (FOR RE3364DR)
     I*
     I                                       83  92 SFILED
     I                                    B 123 1240SFNUMD
     ISPOLCR      DS
     I*
     I**  FILE INFORMATION DATA STRUCTURE (FOR RE3364CR)
     I*
     I                                       83  92 SFILEC
     I                                    B 123 1240SFNUMC
     ISPOLCH      DS
     I*
     I**  FILE INFORMATION DATA STRUCTURE (FOR RE3364CR)
     I*
     I                                       83  92 SFILEH
     I                                    B 123 1240SFNUMH
     I*
     IRUNDT       DS
     I*
     I** Standard data area RUNDAT
     I*
     I                                        1   7 RUNA
     I                                    P   8  100RUND
     I                                       11  11 SSF
     I                                       12  12 DATF
     I                                       13  13 MBIN
     I*
     ISDBANK    E DSSDBANKPD
     I*
     I** Data structure for bank details
     I*
     I              BJURPT                          TITL
     ISDCUST    E DSSDCUSTPD                                                                  CGL186
      ** Data structure for Customer Details                                                  CGL186
      *                                                                                       CGL186
     I              QQDFAC                          XXDFAC                                    CGL186
     IDSLDY     E DSDSLDY                                                                     CGL186
      ** Second DS for access programs, Long data structure                                   CGL186
      *                                                                                       CGL186
     I/COPY WNCPYSRC,RE3364EI01
     I*
     ISDBRCH    E DSSDBRCHPD
     I*
     I** Data structure for branch details
     I*
     ISDRETL    E DSSDRETLPD
     I*
     I** Data structure for retail details
     I*
     ISCSARD    E DSSCSARDPD                                              CRE001
     I*                                                                   CRE001
     I** Data structure for Switchable features details                   CRE001
     I*                                                                   CRE001
     IDSFDY     E DSDSFDY
     I*
     I** First DS for access programs, short data structure
     I*
      *                                                                   086093
      * Redefine work field for a line as array.                          086093
     IAREA        DS                                                      086093
     I                                        1  79 AR                    086093
      *                                                                   086093
      * constant for zero rate                                            086093
     I              '     0.0000000% '    C         ZRCTCN                086093
     I/COPY WNCPYSRC,RE3364EI02
      *                                                                                       CGL029
     IDSSDY     E DSDSSDY                                                                     CGL029
      *                                                                                       CGL029
      *                                                                                       CER050
      ** APR Rate DS.                                                                         CER050
      ** Formatted APR Rate + % are later moved to screen field RATOMP                        CER050
     I            DS                                                                          CER050
     I                                        1  15 APR                                       CER050
     I                                        1  14 APRNO                                     CER050
     I                                       14  15 APRPER                                    CER050
      *                                                                                       CER050
      ** Constant for APR Narrative.                                                          CER050
     I              '    APR Rate:'       C         UIANAR                                    CER050
      *                                                                                       CER050
      ** Constant that holds percentage sign.                                                 CER050
     I              '%'                   C         UIAPER                                    CER050
      *                                                                                       CER050
      ** Constant for zero APR rates.                                                         CER050
     I              '0.00'                C         APR0                                      CER050
     C/EJECT
     C*===================================================================
     C*
     C** COPYRIGHT INSERTION
     C*
     C                     MOVEACPY@      BIS@   80
     C*
     C** KEY LISTS
     C*
     C** KEY FIELD TO ACCESS TO FILE
     C*
     C**  KLIST TO CHAIN ON REHPOPH & REHPOPL
     C*
     C           KLIST1    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C*
     C**  KLIST TO READ REHISL FOR DEBIT
     C*                         or Credit                                 086254
     C           KLIST2    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           CLDID
     C*
     C**  KLIST TO READ REHISL FOR CREDIT
     C*
     C           KLIST3    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           CLCID
     C*
     C**  KLIST TO CHAIN ON REHRDJ
     C*
     C           KLIST5    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           DDRCD
     C*
     C**  KLIST TO CHAIN ON REHRCJ
     C*
     C           KLIST6    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           DCRCD
     C*
     C**  KLIST TO CHAIN ON REHISSL
     C*
     C           KLIST7    KLIST
     C                     KFLD           CBRCA
     C                     KFLD           CCNUM
     C                     KFLD           CCCY
     C                     KFLD           CACOD
     C                     KFLD           CACSQ
     C                     KFLD           DHISD
     C*                                                                   094431
     C**  KLIST TO READ REHPOML3 FOR DEBIT                                094431
     C*                                                                   094431
     C           KMANUD    KLIST                                          094431
     C                     KFLD           CBRCA                           094431
     C                     KFLD           CCNUM                           094431
     C                     KFLD           CCCY                            094431
     C                     KFLD           CACOD                           094431
     C                     KFLD           CACSQ                           094431
     C                     KFLD           WWDATD                          094431
     C*                                                                   094431
     C**  KLIST TO READ REHPOML3 FOR CREDIT                               094431
     C*                                                                   094431
     C           KMANUC    KLIST                                          094431
     C                     KFLD           CBRCA                           094431
     C                     KFLD           CCNUM                           094431
     C                     KFLD           CCCY                            094431
     C                     KFLD           CACOD                           094431
     C                     KFLD           CACSQ                           094431
     C                     KFLD           WWDATC                          094431
      *                                                                                       CER050
      **  KLIST to read ACCNTBY0                                                              CER050
      *                                                                                       CER050
     C           KACCNT    KLIST                                                              CER050
     C                     KFLD           CCNUM                                               CER050
     C                     KFLD           CCCY                                                CER050
     C                     KFLD           CACOD                                               CER050
     C                     KFLD           CACSQ                                               CER050
     C                     KFLD           CBRCA                                               CER050
     C*
     C** WORK FIELDS DEFINITION
     C*
     C           *LIKE     DEFN RUND      PPSTD
     C************LIKE     DEFN RUNA      PSTDO                           086254
     C           *LIKE     DEFN RUND      PVALD
     C           *LIKE     DEFN RUNA      VALDO
     C           *LIKE     DEFN DADTY     WADTY
     C           *LIKE     DEFN DALTI     WALTI
     C           *LIKE     DEFN DCAID     WCAID
     C           *LIKE     DEFN DCHGAN    WCHGAN
     C           *LIKE     DEFN DCHGAR    WCHGAR
     C           *LIKE     DEFN DCICI     WCICI
     C           *LIKE     DEFN DCICT     WCICT
     C           *LIKE     DEFN DCMINT    WCMINT
     C           *LIKE     DEFN DCMVT     WCMVT
     C           *LIKE     DEFN DCRCB     WCRCB
     C           *LIKE     DEFN DCRCD     WCRCD
     C           *LIKE     DEFN DCRCI     WCRCI
     C           *LIKE     DEFN CRIR      WCRIR
     C           *LIKE     DEFN DDAID     WDAID
     C           *LIKE     DEFN DDAID     WDAID2
     C           *LIKE     DEFN DDICI     WDICI
     C           *LIKE     DEFN DDICT     WDICT
     C           *LIKE     DEFN DDMINT    WDMINT
     C           *LIKE     DEFN DDMVT     WDMVT
     C           *LIKE     DEFN DDRCB     WDRCB
     C           *LIKE     DEFN DDRCD     WDRCD
     C           *LIKE     DEFN DDRCI     WDRCI
     C           *LIKE     DEFN DRIR      WDRIR
     C           *LIKE     DEFN DHISB     WHISB
     C           *LIKE     DEFN DHISB     WHISBC
     C           *LIKE     DEFN DHISB     WHISBD
     C           *LIKE     DEFN DHISB     WHISBI
     C           *LIKE     DEFN DHISD     WWHISD
     C           *LIKE     DEFN DHISD     WHISDC
     C           *LIKE     DEFN DHISD     WHISDD
     C           *LIKE     DEFN DMACI     WMACI
     C           *LIKE     DEFN DMADI     WMADI
     C           *LIKE     DEFN DMNBCP    WMNBCP
     C           *LIKE     DEFN DMNBL     WMNBL
     C           *LIKE     DEFN DPCID     WPCID
     C           *LIKE     DEFN DPDID     WPDID
     C           *LIKE     DEFN RECI      WRECI
     C           *LIKE     DEFN DTHGAN    WTHGAN
     C           *LIKE     DEFN DTHGAR    WTHGAR
     C           *LIKE     DEFN DTMACI    WTMACI
     C           *LIKE     DEFN DTMADI    WTMADI
     C           *LIKE     DEFN DVDTC     WVDTC
     C           *LIKE     DEFN DHISB     W1STBL
     C           *LIKE     DEFN DHISB     W2STBL
     C           *LIKE     DEFN DHISB     W1HISB
     C           *LIKE     DEFN DHISB     W2HISB
     C           *LIKE     DEFN RUND      ZIBEG
     C           *LIKE     DEFN RUND      ZIBW1
     C           *LIKE     DEFN RUND      ZIDREM
     C           *LIKE     DEFN CICT      ZIDW1
     C           *LIKE     DEFN RUND      ZIDW2
     C           *LIKE     DEFN RUND      ZID1
     C           *LIKE     DEFN RUND      ZID2
     C           *LIKE     DEFN RUND      ZIEND
     C           *LIKE     DEFN RUND      ZILPCP
     C           *LIKE     DEFN CICT      ZIMAN
     C           *LIKE     DEFN CICT      ZIM1
     C           *LIKE     DEFN RUND      ZIREM
     C           *LIKE     DEFN CICT      ZIY1
     C           *LIKE     DEFN XDAT1     ZDAT1                           075071
     C           *LIKE     DEFN XDAT2     ZDAT2                           075071
     C           *LIKE     DEFN XDAT3     ZDAT3                           075071
     C           *LIKE     DEFN ACOD      ZLYCHK                                              MQ1590
     C           *LIKE     DEFN ACSQ      ZLYREM                                              MQ1590
     C           *LIKE     DEFN TINTD0    WDRADJ                                           MD027025A
     C           *LIKE     DEFN TINTC0    WCRADJ                                           MD027025A
     C*
     C           *NAMVAR   DEFN *LDA      DSLDA
     C           *NAMVAR   DEFN           LDA
     C*
     C*===================================================================
     C/EJECT
     C*===================================================================
     C**          PROGRAM START
     C*===================================================================
     C*
     C                     EXSR FIRST
     C*
     C                     EXSR MAIN
     C*
     C                     CALL 'QCMDEXC'
     C                     PARM           CMD,1
     C                     PARM           MSGLEN 155
     C                     MOVE '1'       *INLR
     C                     RETRN
     C*
     C*===================================================================
     C**            PROGRAM  END
     C*===================================================================
     C/EJECT
     C********************************************************************
     C**
     C** FIRST subroutine to execute first cycle.
     C**
     C**     Called by       S T A R T
     C**
     C**     Calls           DBSR
     C**
     C           FIRST     BEGSR                                       R**
     C*
     C** READING DSLDA
     C*
     C                     IN   DSLDA
     C/COPY WNCPYSRC,RE3364EC23
      *                                                                   099509
      * Make sure the Backvalued Rate-changes are as CHANGE not OPENING   099509
      *   RATE.                                                           099509
     C                     MOVE *ON       *IN21                           099509
     C                     MOVE *ON       *IN22                           099509
      *                                                                   088826
      * Store start dates for check on postings (REHPOPL)                 088826
      * as CLCID,CLDID may be adjusted back one for failed closure .      088826
     C           *LIKE     DEFN CLDID     CLDIDX                          088826
     C           *LIKE     DEFN CLCID     CLCIDX                          088826
     C                     Z-ADDCLCID     CLCIDX           Cap.Day + 1.   088826
     C                     Z-ADDCLDID     CLDIDX           Cap.Day + 1.   088826
      *                                                                   088826
     C                     MOVE '0'       WCANC
     C*
     C** PREPARE LDA VARIABLES
     C*
     C           *LOCK     IN   LDA
     C                     MOVEL'RE3364E 'DBPGM
     C                     MOVE *BLANKS   DBFILE
     C                     MOVE *BLANKS   DBKEY
     C                     Z-ADD0         DBASE
     C                     OUT  LDA
     C*
     C                     MOVEL'*'       DDPGMQ
     C*
     C**   Select the program MSGQ for error msg.
     C*
     C                     MOVEL'*'       TOPQ   10
     C                     MOVEL'*PRV'    TOPRQ   5
     C*
     C** OVERIDE MESSAGE FILE
     C*
     C                     Z-ADD41        MSGLEN
     C*
     C                     MOVE CMD,2     CMD2
     C           LGID      IFNE *BLANKS
     C                     MOVE LGID      WWLGID
     C                     ELSE
     C                     MOVE 'GB'      WWLGID
     C                     END
     C*
     C                     CALL 'QCMDEXC'
     C                     PARM           CMD2
     C                     PARM           MSGLEN
     C*
     C**   Fill in fields for subroutine ZASNMS
     C*
     C                     MOVEL*BLANK    ZAPGM  10        Message queue
     C                     MOVEL'REUSRMSG'ZAMSGF 10        Message file
     C                     MOVEL*BLANK    ZAPGRL  5        Rel queue
     C                     MOVEL*BLANK    ZAMSID  7        Message Id.
     C                     MOVEL*BLANK    ZAMSDA132        Message data.
     C                     MOVEL*BLANK    ZAMSTP  7        Message type.
     C*
     C** IN THE DATA AREA RUNDAT
     C*
     C           *NAMVAR   DEFN RUNDAT    RUNDT
     C                     IN   RUNDT
     C*
     C** SET UP INDICATOR 98 BASED ON THE DATE FORMAT.
     C*
     C           DATF      IFEQ 'M'
     C                     MOVE '1'       *IN98
     C                     ELSE
     C                     MOVE '0'       *IN98
     C                     END
     C*
     C** GET BANK DETAILS
     C*
     C                     CALL 'AOBANKR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDBANK    PARM SDBANK    DSFDY
     C*
     C** CHECK IF ERROR
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     Z-ADD050       DBASE            ***************
     C                     MOVE 'SDBANKPD'DBFILE           * DBERROR 050 *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR DBSR
     C                     END
     C*
     C** ACCESS SDRETLPD
     C*
     C                     CALL 'AORETLR0'
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*FIRST ' @OPTN   7
     C           SDRETL    PARM SDRETL    DSFDY
     C*
     C** CHECK IF ERROR
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     Z-ADD051       DBASE            ***************
     C                     MOVE 'SDRETLPD'DBFILE           * DBERROR 051 *
     C                     MOVEL*BLANKS   DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR DBSR
     C                     END
     C*
     C** CHECK IF RETAIL NUMBER PRESENT
     C*
     C           BMRANR    IFEQ 'Y'                        - B1
     C                     MOVE '1'       *IN69
     C                     END                             - E1
     C*
     C** GET BRANCH DETAILS
     C*
     C**********           CALL 'AOBRCHR0'                                                    CGL029
     C                     CALL 'AOBRCHR1'                                                    CGL029
     C                     PARM '*MSG   ' @RTCD   7
     C                     PARM '*KEY   ' @OPTN   7
     C                     PARM WBRCA     @KBRCA  3
     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
     C*
     C** CHECK IF ERROR
     C*
     C           @RTCD     IFNE *BLANK
     C           *LOCK     IN   LDA
     C                     Z-ADD052       DBASE            ***************
     C                     MOVE 'SDBRCHPD'DBFILE           * DBERROR 052 *
     C                     MOVELWBRCA     DBKEY            ***************
     C                     OUT  LDA
     C                     EXSR DBSR
     C                     END
     C*
     C                     MOVE A8BRNM    WBRNM  30
      *                                                                   CRE001
      ** Check if SAR CRE001 is set on                                    CRE001
      *                                                                   CRE001
     C                     MOVE 'N'       CRE001  1                       CRE001
     C                     CALL 'AOSARDR0'                                CRE001
     C                     PARM *BLANKS   @RTCD   7                       CRE001
     C                     PARM '*VERIFY' @OPTN   7                       CRE001
     C                     PARM 'CRE001'  @SARD   6                       CRE001
     C           SCSARD    PARM SCSARD    DSFDY                           CRE001
      *                                                                   CRE001
     C           @RTCD     IFNE *BLANKS                                   CRE001
     C           @RTCD     ANDNE'*NRF   '                                 CRE001
     C           *LOCK     IN   LDA                                       CRE001
     C                     SETON                     U7U8LR               CRE001
     C                     MOVEL'CRE001'  DBKEY                           CRE001
     C                     MOVE 'SCSARDPD'DBFILE           ***************CRE001
     C                     Z-ADD023       DBASE            * DBERR0R 001 *CRE001
     C                     OUT  LDA                        ***************CRE001
     C                     EXSR DBSR                                      CRE001
     C                     END                                            CRE001
      *                                                                   CRE001
     C           @RTCD     IFEQ *BLANKS                                   CRE001
     C                     MOVE 'Y'       CRE001                          CRE001
     C                     ELSE                                           CRE001
     C                     MOVE 'N'       CRE001                          CRE001
     C                     END                                            CRE001
      *                                                                                       CER050
      ** Check if CER050 is set on                                                            CER050
      *                                                                                       CER050
     C                     MOVE 'N'       CER050  1                                           CER050
     C                     CALL 'AOSARDR0'                                                    CER050
     C                     PARM *BLANKS   @RTCD   7                                           CER050
     C                     PARM '*VERIFY' @OPTN   7                                           CER050
     C                     PARM 'CER050'  @SARD   6                                           CER050
     C           SCSARD    PARM SCSARD    DSFDY                                               CER050
      *                                                                                       CER050
     C           @RTCD     IFEQ *BLANKS                                                       CER050
     C                     MOVE 'Y'       CER050                                              CER050
     C                     MOVE UIAPER    APRPER                                              CER050
     C                     ELSE                                                               CER050
     C                     MOVE 'N'       CER050                                              CER050
     C                     END                                                                CER050
     C/COPY WNCPYSRC,RE3364EC01
     C*
      ** Access Customer details.                                                             CGL186
      *                                                                                       CGL186
     C                     CALL 'AOCUSTR2'                                                    CGL186
     C                     PARM *BLANKS   P@RTCD  7                                           CGL186
     C                     PARM '*KEY'    P@OPTN  7                                           CGL186
     C                     PARM WCNUM     P@KEY1 10                                           CGL186
     C                     PARM           P@ANY   7                                           CGL186
     C           SDCUST    PARM SDCUST    DSLDY                                               CGL186
      *                                                                                       CGL186
     C                     Z-ADD*ZEROS    TOTND  160
     C                     Z-ADD*ZEROS    TOTNC  160
     C*
     C                     MOVE WBRCA     BRCA    3
     C*                    MOVE WCNUM     CCNUM   60
     C**********           MOVE WCNUM     CNUM    60                                          CSD027
     C                     MOVE WCNUM     CNUM    6                                           CSD027
     C*                    MOVE WCCY      CCCY    3
     C                     MOVE WCCY      CCY     3
     C*                    MOVE WACOD     CACOD   40
     C**********           MOVE WACOD     ACOD    40                                          CGL029
     C                     MOVE WACOD     ACOD   100                                          CGL029
     C*                    MOVE WACSQ     CACSQ   20
     C                     MOVE WACSQ     ACSQ    20
     C                     MOVE WACNO     ACNO   100
     C                     MOVE WRUNA     SRUNA   7
     C                     MOVE WZAD      ZADEC   10
     C*
     C** INITIALISE WORK FIELDS
     C*
     C                     Z-ADD*ZEROS    PPSTD
     C                     Z-ADD*ZEROS    PVALD
     C                     Z-ADD*ZEROS    DHISD
     C                     Z-ADD*ZEROS    WWHISD
     C                     Z-ADD*ZEROS    DAYS    40
     C                     Z-ADD*ZEROS    DAYD    40
     C                     Z-ADD*ZEROS    DAYC    40
     C                     Z-ADD*ZEROS    NUMB0
     C                     Z-ADD*ZEROS    NUMR
     C                     Z-ADD*ZEROS    HISB0
     C                     Z-ADD*ZEROS    INTD0
     C                     Z-ADD*ZEROS    INTC0
     C                     Z-ADD*ZEROS    TINTD0
     C                     Z-ADD*ZEROS    TINTC0
     C                     Z-ADD*ZEROS    WWADJC
     C                     Z-ADD*ZEROS    WWADJD
     C                     Z-ADD*ZEROS    TOTCH  150
     C                     Z-ADD*ZEROS    WDICT
     C                     Z-ADD*ZEROS    ZICALC  20
     C                     Z-ADD*ZEROS    ZDAYN2  94
     C                     Z-SUB1         SUBT    10
     C                     MOVE *OFF      SFLEN1  1                       075071
     C                     MOVE *OFF      SFLEN2  1                       075071
     C                     MOVE *OFF      SFLEN3  1                       075071
     C                     Z-ADD0         RECN1   50
     C                     Z-ADD0         RECN2   50
     C                     Z-ADD0         RECN3   50
     C                     Z-ADD0         PAGE1   20
     C                     Z-ADD0         PAGE2   20
     C                     Z-ADD0         PAGE3   40
     C                     Z-ADDZADEC     SAVEZ   10
     C           15        SUB  ZADEC     DECI1   20
     C           11        SUB  7         DECI2   20
     C*
     C** INITIALISE SUBFILES
     C*
     C************         MOVE '1'       *IN50                           089002
     C                     MOVE '1'       *IN70
     C                     WRITERE3364C1
     C                     WRITERE3364C2
     C                     WRITERE3364C3
     C************         MOVE '0'       *IN50                           089002
     C                     MOVE '0'       *IN70
     C                     MOVE 'N'       @FLAG1  1
     C                     MOVE 'N'       @FLAG2  1
     C                     MOVE 'N'       @FLAG3  1
     C                     MOVE *BLANK    SF1F    1                       113955
     C                     MOVE *BLANK    SF2F    1                       113955
     C                     MOVE *BLANK    SF3F    1                       113955
     C*
     C** INITIALISE OUTPUT FIELDS
     C*
     C                     MOVE *BLANK    FLD01
     C                     MOVE 'Ref  : ' COMT
     C                     MOVE *BLANKS   ADJDT   6
     C                     MOVE *BLANKS   TPST   15
     C                     MOVE *BLANKS   PSTDA   6
     C                     MOVE *BLANKS   VALDA   6
     C                     MOVE *BLANKS   PSTD2   6
     C                     MOVE *BLANKS   VALD2   6
     C                     Z-ADD0         ZDATE   60
     C                     MOVE *BLANKS   NARR   30
     C                     MOVE *BLANKS   NARR2  30
     C***********          MOVE *BLANKS   AMON   13                       118816
     C***********          MOVE *BLANKS   AMON2  13                       118816
     C                     MOVE *BLANKS   AMON   14                       118816
     C                     MOVE *BLANKS   AMON2  14                       118816
     C                     MOVE *BLANKS   RATO   12
     C                     MOVE *BLANKS   CR      2
     C                     MOVE *BLANKS   CR2     2
     C***********          MOVE *BLANKS   INTR   11                       118816
     C***********          MOVE *BLANKS   NUMB   13                       118816
     C                     MOVE *BLANKS   INTR   12                       118816
     C                     MOVE *BLANKS   NUMB   14                       118816
     C                     MOVE *BLANKS   DAY     4
     C                     MOVE *BLANKS   NUMD   13
     C                     MOVE *BLANKS   ND      4
     C                     MOVE *BLANKS   CHAR   13
     C                     MOVE *BLANK    REB     1
     C                     MOVE *BLANKS   ADJT   11
     C                     MOVE *BLANKS   ADJS    1
     C*
     C** READ RECAPM
     C*
      *                                                                                       CER016
      ** Access SAR Details File to determine if CER016 is installed                          CER016
      *                                                                                       CER016
     C                     CALL 'AOSARDR0'                                                    CER016
     C                     PARM *BLANKS   PRTCD   7                                           CER016
     C                     PARM '*VERIFY' POPTN   7                                           CER016
     C                     PARM 'CER016'  PSARD   6                                           CER016
     C           SCSARD    PARM SCSARD    DSFDY                                               CER016
      *                                                                                       CER016
      ** CER016 is installed                                                                  CER016
      *                                                                                       CER016
     C           PRTCD     IFEQ *BLANKS                                                       CER016
     C                     MOVE 'Y'       CER016  1                                           CER016
     C                     ELSE                                                               CER016
     C                     MOVE 'N'       CER016                                              CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
      ** Database error                                                                       CER016
      *                                                                                       CER016
     C           PRTCD     IFNE *BLANKS                                                       CER016
     C           PRTCD     ANDNE'*NRF   '                                                     CER016
      *                                                                                       CER016
     C           *LOCK     IN   LDA                                                           CER016
     C                     MOVEL'SCSARDPD'DBFILE                                              CER016
     C                     MOVEL'CER016'  DBKEY                                               CER016
     C                     Z-ADD053       DBASE                                               CER016
     C                     OUT  LDA                                                           CER016
     C                     EXSR *PSSR                                                         CER016
      *                                                                                       CER016
     C                     ENDIF                                                              CER016
      *                                                                                       CER016
     C                     ENDSR                           **FIRST ENDSR**
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** MAIN subroutine for detail processing to display formats
     C**      following debit or credit indicator.
     C**
     C**     Called by     S T A R T
     C**
     C**     Calls         BOTHSR, BOTH, CRSR, CRED, DRSR, DEBI
     C**
     C           MAIN      BEGSR                           **MAIN  BEGSR**
     C*
     C**  ACCESS ACCRACJ (ACCNTAB, REIACD, REACRD)
     C*
     C***********KLIST1    SETLLACCRACJ                  99               075071
     C*
     C***********KLIST1    READEACCRACJ                  98               075071
     C           KLIST1    CHAINACCRACJ              98                   075071
     C/COPY WNCPYSRC,RE3364EC07
     C*
     C                     MOVE ANAM      WANAM                           074590
     C/COPY WNCPYSRC,RE3364EC21
     C*                                                                   074590
     C           CER050    IFEQ 'Y'                                                           CER050
     C           KACCNT    CHAINACCNTBY0             99                                       CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C           CCICI     IFNE *BLANKS                    - B1
     C           CDICI     ANDNE*BLANKS
     C           WTYP      IFEQ 'P'
     C                     SETON                     636465
     C                     END
     C                     EXSR BOTHSR
     C           WTYP      CASEQ'P'       EXIT
     C                     END
     C                     WRITERE3364F1
     C                     EXSR BOTH
     C                     ELSE                            - X1
     C           CCICI     IFNE *BLANKS                    - B2
     C           WTYP      IFEQ 'P'
     C                     SETON                       6465
     C                     END
     C                     EXSR CRSR
     C           WTYP      CASEQ'P'       EXIT
     C                     END
     C                     WRITERE3364F1
     C                     EXSR CRED
     C                     END                             - E2
     C           CDICI     IFNE *BLANKS                    - B2
     C           WTYP      IFEQ 'P'
     C                     SETON                       63
     C                     END
     C                     EXSR DRSR
     C           WTYP      CASEQ'P'       EXIT
     C                     END
     C                     WRITERE3364F1
     C                     EXSR DEBI
     C                     END                             - E2
     C                     END                             - E1
     C*
     C                     ENDSR                           **MAIN  ENDSR**
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DEBI Subroutine to display debit interest.
     C**
     C**     Called by       MAIN
     C**
     C**     Calls           SUBW1, SUBW2, EXIT
     C**
     C           DEBI      BEGSR
     C*
     C           RECN1     IFEQ *ZEROS
     C                     EXSR SUBW1
     C                     END
     C*
     C           RECN2     IFEQ *ZEROS
     C           RECN3     ANDEQ*ZEROS
     C                     EXSR SUBW2
     C                     END
     C*
     C           *IN09     DOWEQ'0'                        - B1
     C*
     C                     MOVELNAR,18    BOTT
     C                     WRITERE3364F3
     C                     MOVE *ON       SFLEN1  1        Output last sfl075071
     C                     EXSR ADDRC1                     record .       075071
     C                     EXFMTRE3364C1
     C                     CALL 'Y2CLMSC'
     C                     PARM           TOPQ
     C                     PARM           TOPRQ
     C*
     C           *IN03     CASEQ'1'       EXIT
     C           *IN12     CASEQ'1'       EXIT
     C                     CAS            EXIT
     C                     END
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **DEBI END**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** CRED subroutine to display credit interest
     C**
     C**     Called by       MAIN
     C**
     C**     Calls           EXIT, SPLI
     C**
     C           CRED      BEGSR
     C*
     C           *IN09     DOWEQ'0'                        - B1
     C*
     C                     MOVELNAR,19    BOTT
     C                     WRITERE3364F3
     C           *IN10     IFEQ '0'                        - B2
     C                     MOVE *ON       SFLEN2  1        Output last sfl075071
     C                     EXSR ADDRC2                     record .       075071
     C                     EXFMTRE3364C2
     C                     ELSE
     C                     MOVE *ON       SFLEN3  1        Output last sfl075071
     C                     EXSR ADDRC3                     record .       075071
     C                     EXFMTRE3364C3
     C                     END                             - E2
     C*
     C                     CALL 'Y2CLMSC'
     C                     PARM           TOPQ
     C                     PARM           TOPRQ
     C*
     C           *IN03     CASEQ'1'       EXIT
     C           *IN12     CASEQ'1'       EXIT
     C           *IN20     CASEQ'1'       SPLI
     C                     CAS            EXIT
     C                     END
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **CRED END**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** BOTH subroutine to display credit  and debit interest
     C**
     C**     Called by       MAIN
     C**
     C**     Calls           EXIT, CRED2
     C**
     C           BOTH      BEGSR                           **BOTH START**
     C*
     C           *IN09     DOWEQ'0'                        - B1
     C*
     C                     MOVE '0'       *IN
     C*
     C                     MOVELNAR,20    BOTT
     C                     WRITERE3364F3
     C*
     C                     MOVE *ON       SFLEN1  1        Output last sfl075071
     C                     EXSR ADDRC1                     record .       075071
     C                     EXFMTRE3364C1
     C                     CALL 'Y2CLMSC'
     C                     PARM           TOPQ
     C                     PARM           TOPRQ
     C*
     C           *IN03     CASEQ'1'       EXIT
     C           *IN12     CASEQ'1'       EXIT
     C           *IN19     CASEQ'1'       CRED2
     C                     CAS            EXIT
     C                     END
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **BOTH END**
     C******************************************************************
     C/EJECT
     C******************************************************************
     C**
     C** CRED2 subroutine to display interest or charges
     C**
     C**     Called by     BOTH
     C**
     C**     Calls         EXIT, SPLI
     C**
     C           CRED2     BEGSR
     C*
     C           *IN08     DOWEQ'0'                        - B1
     C*
     C           *IN10     IFEQ '0'                        - B2           074594
     C                     MOVELNAR,21    BOTT
     C                     ELSE                            - X2           074594
     C***********          MOVELNAR,33    BOTT                      074594CRE003
     C***********          MOVELNAR,36    BOTT                                         CRE003 CRE090
     C                     MOVELNAR,49    BOTT                                                CRE090
     C                     END                             - E2           074594
     C                     WRITERE3364F3
     C*
     C           *IN10     IFEQ '0'                        - B2
     C                     MOVE *ON       SFLEN2  1        Output last sfl075071
     C                     EXSR ADDRC2                     record .       075071
     C                     EXFMTRE3364C2
     C                     ELSE
     C                     MOVE *ON       SFLEN3  1        Output last sfl075071
     C                     EXSR ADDRC3                     record .       075071
     C                     EXFMTRE3364C3
     C                     END                             - E2
     C*
     C                     CALL 'Y2CLMSC'
     C                     PARM           TOPQ
     C                     PARM           TOPRQ
     C*
     C           *IN03     CASEQ'1'       EXIT
     C           *IN12     CASEQ'1'       EXIT
     C           *IN18     CASEQ'1'       EXIT
     C           *IN20     CASEQ'1'       SPLI
     C                     CAS            EXIT
     C                     END
     C*
     C                     END                             - E1
     C*
     C                     ENDSR                           **CRED2 END**
     C******************************************************************
     C/EJECT
     C******************************************************************
     C**
     C** EXIT  subroutine  to get out of program
     C**
     C**     Called by       DEBI, CRED, BOTH, CRED2
     C**
     C**     Calls           -
     C**
     C           EXIT      BEGSR
     C*
     C           *IN03     IFEQ '1'                        - B1
     C                     MOVE '1'       WCANC
     C                     MOVEA'11'      *IN,08
     C                     ELSE                            - X1
     C           *IN12     IFEQ '1'                        - B2
     C                     MOVE '2'       WCANC
     C                     MOVEA'11'      *IN,08
     C                     ELSE                            - X2
     C           *IN18     IFEQ '1'                        - B3
     C                     MOVE '1'       *IN08
     C                     ELSE                            - X3
     C                     MOVE '0'       WCANC
     C                     MOVEA'11'      *IN,08
     C                     END                             - E3
     C*
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C                     MOVE '64'      WFROM2
     C                     MOVE ' '       WPRINT
     C           WTYP      IFEQ 'P'
     C                     MOVE 'Y'       WPRINT
     C                     END
     C                     OUT  DSLDA
     C*
     C                     CLOSERE3364DR
     C                     CLOSERE3364CR
     C                     CLOSERE3364CH
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SPLI  Subroutine  to initialise indicator for charges or
     C**       interests.
     C**
     C**     Called by     CRED, CRED2
     C**
     C**     Calls         ZASNMS
     C**
     C           SPLI      BEGSR                           **SPLI START**
     C*
     C           *IN10     IFEQ '0'                        - B1
     C           TOTCH     ANDGT0
     C                     MOVE '1'       *IN10
     C                     ELSE                            - X1
     C***********TOTCH     IFLE 0                          - B2           060823
     C           TOTCH     IFLT 0                          - B2           060823
     C                     MOVEL'RES0008' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE                            - X2
     C           TOTCH     IFNE 0                          - B3           060823
     C                     MOVE '0'       *IN10
     C                     END                             - E3           060823
     C                     END                             - E2
     C           TOTCH     IFEQ 0                          - B2           074594
     C                     MOVEL'RES0009' ZAMSID                          074594
     C                     EXSR ZASNMS                                    074594
     C                     END                             - E2           074594
     C                     END                             - E1
     C*
     C                     ENDSR                           **SPLI END**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** BFOPSR SUbroutine for B/F AND OP BALANCE output processing
     C**
     C**     Called by     DRSR, CRSR, BOTHSR
     C**
     C**     Calls         -
     C**
     C           BFOPSR    BEGSR                           **BFOPSREGSR**
     C*
     C***********KLIST7    SETLLREHPOPL                  99               075071
     C************IN99     IFEQ '1'                                       075071
     C***********KLIST7    READEREHPOPL                  99               075071
     C           KLIST7    CHAINREHPOPL              99                   075071
     C           *IN99     DOWEQ'0'
     C           DRCR      IFEQ 0
     C                     SUB  PSTA      WWHISB 150
     C                     ELSE
     C                     ADD  PSTA      WWHISB
     C                     END
     C           KLIST7    READEREHPOPL                  99
     C                     END
     C***********          END                                            075071
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DRSR  Subroutine for debit output processing (to fill
     C**       subfile 1 - debit only)
     C**
     C**     Called by     MAIN
     C**
     C**     Calls         SUBW1, LINE1, BFOPSR, ZEDIT,ZDATE2,
     C**                   DBSR, RDRSR, RATED, ZICD
     C**
     C           DRSR      BEGSR                           **DRSR BEGSR**
     C*                                                                   075079
     C*******************  MOVE '0'       *IN21                     075079099509
     C*
     C** WRITE SUBFILE HEADERS
     C*
     C                     MOVEA'11'      *IN,85
     C                     MOVELNAR,15    SDAT1
     C                     EXSR SUBW1
     C                     MOVEA'00'      *IN,85
     C*
     C           WTYP      IFNE 'P'
     C*
     C** ADD BLANK LINE
     C*
     C                     EXSR LINE1
     C*
     C           BMCBAI    IFEQ 'Y'                                       CRE003
     C                     MOVELNAR,16    SDAT1
     C                     ELSE                                           CRE003
     C                     MOVELNAR,37    SDAT1                           CRE003
     C                     END                                            CRE003
     C                     EXSR SUBW1
     C*
     C** ADD BLANK LINE
     C*
     C           CER016    IFEQ 'Y'                                                         BUG22235
     C           DRIC      ANDEQ*ZERO                                                       BUG22235
     C                     Z-ADD8         J                                                 BUG22235
     C                     ELSE                                                             BUG22235
     C                     Z-ADDDRIC      J       10
     C                     ENDIF                                                            BUG22235
     C                     MOVEL*BLANKS   SDAT1
     C                     MOVE CAC,J     SDAT1
     C/COPY WNCPYSRC,RE3364EC08
     C                     EXSR SUBW1
     C*
     C                     MOVE '1'       *IN85            *UNDERLINE*
     C                     EXSR LINE1
     C                     MOVE '0'       *IN85
     C                     END
     C*
     C**  ACCESS REHISL WITH LAST DEBIT CAPITALISATION DATE
     C*
     C           KLIST2    SETLLREHISL               51
     C*
     C           KLIST1    READEREHISL                   51
      *                                                                                     MD056973
     C           DRECI     DOWEQ'M'                                                         MD056973
     C           *IN51     ANDEQ'0'                                                         MD056973
     C           KLIST1    READEREHISL                   51                                 MD056973
     C                     ENDDO                                                            MD056973
      *                                                                   092181
      * If a/c header or cap. rec. not found, read the previous record    092181
      * as if demand or closure cap. CLDID is not equal to cap. date as   092181
      * LDID is not 1 day behind cap. value date (see fix 077684/086230   092181
      * in BOTHSR and setup of PDID in RE3363).                           092181
     C           *IN51     IFEQ '1'                                       092181
     C           DRECI     ORNE 'B'                                       092181
     C           DRECI     ANDNE'S'                                       092181
     C                     SUB  1         CLDID                           092181
     C           KLIST2    SETLLREHISL                                    092181
     C           KLIST1    READEREHISL                   51               092181
     C                     END                                            092181
     C*
     C           *IN51     DOWEQ'0'                        - B1
     C           DRECI     ANDEQ'S'
     C           SCICI     ANDNE*BLANKS
     C           SDICI     ANDEQ*BLANKS
     C           DHISD     ANDLTCHISD
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C           DCRCI     ANDEQ*BLANKS
     C           DMADI     ANDEQ*ZEROS
     C           DMACI     ANDNE*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C           DCRCI     ANDEQ'Y'
     C           DMADI     ANDEQ*ZEROS
     C           DMACI     ANDEQ*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C           DCRCI     ANDEQ'Y'
     C           DMADI     ANDEQ*ZEROS
     C           DMACI     ANDNE*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           *IN51     OREQ '0'                                       088733
     C           DRECI     ANDEQ'D'                                       088733
     C           DDRCI     ANDEQ*BLANKS                                   088733
     C           DCRCI     ANDEQ*BLANKS                                   088733
     C           DMADI     ANDEQ*ZEROS                                    088733
     C           DMACI     ANDEQ*ZEROS                                    088733
     C           DDMVT     ANDEQ*ZEROS                                    088733
     C           DCMVT     ANDEQ*ZEROS                                    088733
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C                     END                             - E1
     C*
     C**  PREPARE B/F BALANCE
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADDDHISD     CLDID
     C                     Z-ADDDHISB     WWHISB
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDDODRL     WODRL  110                      CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     EXSR BFOPSR
     C                     Z-ADDWWHISB    HISB0  150
     C                     Z-ADDWWHISB    W1HISB
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     HISB0
     C                     Z-ADDSHISB     W1HISB
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSODRL     WODRL                           CRE001
     C                     ENDIF                                          CRE001
      *                                                                   CRE001
     C                     END                             - E2
     C                     END                             - E1
     C                     MOVE DRECI     WWRECI  1
     C*
     C           HISB0     IFLT 0                          - B1
     C           HISB0     MULT SUBT      HISB0
     C                     MOVE 'CR'      CR
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVELNAR,1     NARR
     C*
     C**  OUTPUT B/F BALANCE
     C*
     C                     MOVE '1'       *IN86
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C** OUTPUT INTEREST BEFORE DROP IF EXIST.
     C*
     C           DRECI     IFEQ 'B'
     C           DDAID     ANDNE*ZERO
     C           DDAID     IFLT 0                          - B1
     C           DDAID     MULT SUBT      DDAID
     C                     MOVE 'CR'      CR
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DDAID     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVELNAR,30    NARR
     C*
     C**  OUTPUT INTEREST OF PREVIOUS DATE
     C*
     C                     MOVE '1'       *IN86
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END
     C*
     C           KLIST2    SETLLREHPOPH                  55
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C**  BACK VALUE PROCESSING START
     C*
     C           *IN55     DOWEQ'0'                        - B1
     C           PSTD      ANDLECHISD                                     094431
     C***********HISD      ANDLTCLDID                                     094431
     C***********PSTD      IFGE CLDID                              065773 094431
     C********** PSTD      IFGT CLDID                                     065773
     C           HISD      IFLT CLDID                                     094431
     C           PSTD      ANDGTCLDID                                     094431
     C           BMLDAI    ANDEQ'N'                                       094431
     C           HISD      ORLT CLDID                                     094431
     C           PSTD      ANDGECLDID                                     094431
     C           BMLDAI    ANDEQ'Y'                                       094431
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE PSTD                       - B2
     C                     Z-ADDPSTD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B3
     C           *LOCK     IN   LDA
     C                     Z-ADD001       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 001*
     C                     MOVELPSTD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E3
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     MOVELZDATE     PPSTDO
     C                     END                             - E2
     C*
     C                     MOVELPPSTDO    PSTDA
     C*
     C           PSTDA     IFNE CHECK
     C                     MOVE '0'       *IN26
     C                     ELSE
     C                     MOVE '1'       *IN26
     C                     END
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B2
     C                     Z-ADDHISD      ZDAYNO
     C                     MOVE '0'       *IN99                           101332
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B3
     C           *LOCK     IN   LDA
     C                     Z-ADD002       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 002*
     C                     MOVELHISD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E3
     C*
     C                     Z-ADDHISD      PVALD
     C                     MOVELZDATE     PVALDO
     C                     END                             - E2
     C*
     C                     MOVELPNAR      NARR
     C*                    MOVELZDATE     VALDA
     C                     MOVELPVALDO    VALDA
     C                     MOVELVALDA     CHECK   6
      *                                                                   100992
     C                     MOVE *BLANKS   CR                              100992
      *                                                                   100992
     C           RECI      IFEQ 'P'                                       094431
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           DRCR      IFEQ 1                          - B2
     C                     MOVE 'CR'      CR
     C                     END                             - E2
     C*
     C                     Z-ADDPSTA      PSTD0  150
     C                     MOVE *BLANKS   ZFIELD 16
     C                     MOVE PSTD0     ZFIELD
     C                     Z-ADDDECI1     ZADIG   20
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C**  OUTPUT BACK VALUE
     C*
     C           TURN      IFEQ 'Y'                                       064993
     C                     MOVE '*'       COMMVT  1                       064993
     C                     ENDIF                                          064993
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     MOVE *BLANKS   COMMVT                          064993
     C*
     C** RESET INDICATOR
      *                                                                   099508
     C                     ELSE                                           099508
     C           DRCR      IFEQ 0                                         099508
     C                     Z-ADDHISD      DDRCD                           099508
     C                     EXSR RATED                                     099508
     C                     END                                            099508
     C                     END                                            099508
     C*
     C                     MOVE '0'       *IN26
     C                     END
      *                                                                   099508
     C*********************ELSE                                     094431099508
     C***********DRCR******IFEQ 0                                   094431099508
     C*********************Z-ADDHISD      DDRCD                     094431099508
     C*********************EXSR RATED                               094431099508
     C*********************END                                      094431099508
     C*********************END                                      094431099508
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C                     END                             - E1
     C*
     C**  BACK VALUE PROCESSING END
      *                                                                   098818
      ** Stop the Back value processing from corrupting the Openning Rate 098818
      ** & Reset partially setup output narratives                        101483
      *                                                                   098818
     C                     Z-ADD0         INRT                            098818
     C                     EXSR RESET                                     101483
      *                                                                   099509
      ***Check*for*'Generated*Adjustments*To*be*Posted'*********** 099509 103860
      ** Check for generated adjustments before start date.               103860
      *                                                                   099509
     C           KLIST1    SETLLREHISSL                  80               103860
     C           *IN80     IFEQ '1'                                       103860
     C           KLIST1    READEREADJF                   80               103860
     C           *IN80     DOWEQ'0'                                       103860
     C           AHISD     ANDLTCLDID                                     103860
     C                     MOVE *ON       *IN41                           099509
     C                     EXSR #ADJ                                      099509
     C                     MOVE *OFF      *IN41                           099509
     C           KLIST1    READEREADJF                   80               103860
     C                     END                                            103860
     C                     END                                            103860
     C*
     C***********KLIST2    SETLLREHPOPL                  55               088826
      *                                                                   088826
      * Set Limits with  Debit Capitalisation day                         088826
     C                     EXSR SETPOD                     Setll REHPOPL. 088826
     C***********KLIST1    READEREHPOPL                  55               088826
     C*
     C**  PREPARE OPENING BALANCE OUTPUT
      *                                                                   099509
      *  Reset the Backvalued Rate-changes Indicators                     099509
      *                                                                   099509
     C                     MOVE *OFF      *IN21                           099509
     C*
     C                     Z-ADDW1HISB    HISB0
      *                                                                   089497
      * If no posting found for period, set history bal to opening bal.   089497
      * If no posting on start date, set history bal to opening bal.      091612
     C           *IN55     IFEQ '1'                                       089497
     C           DHISD     ORNE HISD                                      091612
     C                     Z-ADDW1HISB    DHISB                           089497
     C                     END                                            089497
     C*
     C                     MOVELNAR,2     NARR
     C                     MOVE *BLANKS   CR                              100992
     C*
     C           HISB0     IFLT 0                          - B1
     C           HISB0     MULT SUBT      HISB0
     C                     MOVE 'CR'      CR
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C** RESET CLOSING BALANCE OF FIRST DAY
     C*
     C           DRECI     IFEQ 'B'
     C                     Z-ADDDHISD     HISB0
     C                     END
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           CLDID     IFNE *ZEROS
     C           CLDID     IFNE PVALD                      - B1
     C*
     C                     Z-ADDCLDID     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD003       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 003*
     C                     MOVELHISD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDCLDID     PVALD
     C                     MOVELZDATE     PVALDO
     C*
     C                     END                             - E1
     C                     ELSE
     C                     Z-ADDDHISD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD045       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 045*
     C                     MOVELDHISD     DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDDHISD     PVALD
     C                     MOVELZDATE     PVALDO
     C                     Z-ADDDHISD     WHISD2  50
     C                     END
     C*
     C*                    MOVELZDATE     VALDA
     C                     MOVELPVALDO    VALDA
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C**  PREPARE OPENING RATE OUTPUT
     C*
     C           KLIST2    SETLLREHRDJ
     C           CLDID     IFEQ DACO                                      057291
     C           KLIST2    READEREHRDJ                   99               057291
     C           *IN99     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     ELSE                                           057291
     C           KLIST1    REDPEREHRDJ                   99
     C           *IN99     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     END                                            057291
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C           *IN21     IFEQ '0'                                       075079
     C                     MOVELNAR,3     NARR
     C                     ELSE                                           075079
     C                     MOVELNAR,4     NARR                            075079
     C                     END                                            075079
     C*
     C**  OUTPUT OPENING RATE
     C*
     C                     EXSR RDRSR
     C*
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
     C********** DDICT     IFEQ 0                                                      CRE001 206671
     C                     MOVELNAR,34    NARR                            CRE001
     C                     EXSR RDRAO                                     CRE001
     C                     MOVELNAR,33    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C**********           END                                                         CRE001 206671
      *                                                                   CRE001
     C                     END                                            CRE001
      *                                                                   CRE001
     C                     MOVEA'10'      *IN,85
     C                     EXSR LINE1
     C***********          MOVE '0'       *IN85                           106369
     C                     MOVEA'01'      *IN,85                          106369
     C                     MOVE *BLANK    ADJFLG                          103860
     C*
     C           *IN51     DOWEQ'0'                        - B1
     C           DHISD     ANDLTCHISD
      *                                                                   103860
      **  Process generated adjustment at start or within cap. period.    103860
     C           DRECI     IFEQ 'S'                                       103860
     C           SGADI     IFNE 0                                         103860
     C           SGACI     ORNE 0                                         103860
     C                     Z-ADDDHISD     AHISD                           103860
     C                     Z-ADDSDAIC     ADAIC                           103860
     C                     Z-ADDSCAIC     ACAIC                           103860
     C                     MOVE SDCI      ASDCI                           103860
     C                     MOVE SCCI      ASCCI                           103860
     C                     MOVE '1'       *IN41                           103860
     C                     EXSR #ADJ                                      103860
     C                     MOVE '0'       *IN41                           103860
     C                     END                                            103860
     C                     ELSE                                           103860
     C*
     C**  PROCESS POSTING AT THE SAME DATE
     C*
     C           *IN55     DOWEQ'0'                        - B2
     C           DHISD     ANDEQHISD
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B3
     C                     Z-ADDHISD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B4
     C           *LOCK     IN   LDA
     C                     Z-ADD004       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVE HISD      DBKEY            * DB ERROR 004*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E4
     C*
     C                     Z-ADDHISD      PVALD
     C                     MOVE ZDATE     PVALDO
     C*
     C                     END                             - E3
     C*
     C                     MOVE PVALDO    VALDA
     C                     MOVE PVALDO    VALD2
     C*
     C           PSTDA     IFNE CHECK
     C                     MOVE '0'       *IN26
     C                     ELSE
     C                     MOVE '1'       *IN26
     C                     END
     C           PPSTD     IFNE PSTD                       - B3
     C                     Z-ADDPSTD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B4
     C           *LOCK     IN   LDA
     C                     Z-ADD005       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVE PSTD      DBKEY            * DB ERROR 005*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E4
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     MOVE ZDATE     PPSTDO
     C*
     C                     END                             - E3
     C                     MOVE PPSTDO    PSTDA
     C                     MOVE PPSTDO    PSTD2
     C                     MOVELPNAR      NARR
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C                     MOVE *BLANKS   CR                              100992
     C*
     C           DRCR      IFEQ 1                          - B3
     C                     MOVE 'CR'      CR
     C                     END                             - E3
     C*
     C                     Z-ADDPSTA      PSTD0
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE PSTD0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C**  OUPUT POSTING
     C*
     C                     MOVEA'01'      *IN,85
     C           TURN      IFEQ 'Y'                                       064993
     C                     MOVE '*'       COMMVT                          064993
     C                     ENDIF                                          064993
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     MOVE *BLANKS   COMMVT                          064993
      *                                                                   089497
      * If backvalued posting found with posting date after end of        089497
      * period, set flag to print 'Adjusted Balance C/F'.                 089497
     C           PSTD      IFGE CHISD                                     089497
     C                     MOVE *ON       DEBBAK  1                       089497
     C                     ENDIF                                          089497
     C*
     C** RESET INDICATOR
     C*
     C                     MOVE '0'       *IN26
     C*
      *                                                                   088826
      * Get Next Posting Record                                           088826
     C                     EXSR NXTPOP                                    088826
     C***********KLIST1    READEREHPOPL                  55               088826
      *                                                                   113955
      * Stop processing if DR interest subfile full                       113955
     C           SF1F      IFEQ 'Y'                                       113955
     C                     SETON                     5155                 113955
     C                     END                                            113955
     C*
     C                     END                             - E2
      *                                                                   113955
     C           DHISD     IFNE WWDATD                                    099511
     C           SF1F      ANDEQ*BLANK                                    113955
     C                     Z-ADDDHISD     WWDATD                          094431
     C                     EXSR MANUDR                                    094431
     C                     ENDIF                                          099511
     C*
     C**  DEBIT RATE CHANGE TO
     C*
     C           DDRCI     IFEQ 'Y'                        - B2
     C           SF1F      ANDEQ*BLANK                                    113955
     C           DRECI     ANDNE'M'                                                         MD056835
     C***********DHISD     IFGT CLDID                                     106369
     C           DHISD     IFGE CLDID                                     106369
     C*
     C                     EXSR RATED
     C*
     C                     END                             - E2
     C                     END                             - E2
      *                                                                   103860
     C                     END                                            103860
      *                                                                   113955
     C           SF1F      IFEQ *BLANK                                    113955
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     MOVE DRECI     WRECI
     C                     Z-ADDDHISD     WWHISD
     C                     Z-ADDDHISB     WHISB
     C                     Z-ADDDMNBL     WMNBL
     C                     Z-ADDDCHGAR    WCHGAR
     C                     Z-ADDDTHGAR    WTHGAR
     C                     Z-ADDDCHGAN    WCHGAN
     C                     Z-ADDDTHGAN    WTHGAN
     C                     Z-ADDDDMVT     WDMVT
     C                     MOVE DDICT     WDICT
     C           DRECI     IFEQ 'M'                                       065773
     C                     MOVE DRIC      WDRCB                           065773
     C                     ELSE                                           065773
     C                     MOVE DDRCB     WDRCB
     C                     END                                            065773
     C                     Z-ADDDRIR      WDRIR
     C                     Z-ADDDDRCD     WDRCD
     C                     Z-ADDWDAID     WDAID2
     C                     Z-ADDDDAID     WDAID
     C                     Z-ADDDMADI     WMADI
     C                     Z-ADDDTMADI    WTMADI
     C                     Z-ADDDPDID     WPDID
     C                     Z-ADDDDMINT    WDMINT
     C                     Z-ADDDCMVT     WCMVT
     C                     Z-ADDDCICT     WCICT
     C           DRECI     IFEQ 'M'                                       065773
     C                     MOVE CRIC      WCRCB                           065773
     C                     ELSE                                           065773
     C                     Z-ADDDCRCB     WCRCB
     C                     END                                            065773
     C                     Z-ADDCRIR      WCRIR
     C                     Z-ADDDCRCD     WCRCD
     C                     Z-ADDDCAID     WCAID
     C                     Z-ADDDMACI     WMACI
     C                     Z-ADDDTMACI    WTMACI
     C                     Z-ADDDPCID     WPCID
     C                     Z-ADDDCMINT    WCMINT
     C                     MOVE DDICI     WDICI
     C                     MOVE DCICI     WCICI
     C                     MOVE DDRCI     WDRCI
     C                     MOVE DCRCI     WCRCI
     C                     Z-ADDDVDTC     WVDTC
     C                     MOVE DADTY     WADTY
     C                     MOVE DALTI     WALTI
     C                     Z-ADDDMNBCP    WMNBCP
      *                                                                   103860
     C           DRECI     IFEQ 'S'                                       103860
     C                     Z-ADDSHISB     WHISB                           103860
     C                     MOVE SDRCB     WDRCB                           103860
     C           SDICI     IFEQ *BLANK                                    103860
     C                     Z-ADDSDAIC     WDAID                           103860
     C                     END                                            103860
     C                     ELSE                                           103860
     C                     MOVE *BLANKS   ADJFLG  1                       103860
     C                     END                                            103860
     C*
     C           KLIST1    READEREHISL                   51
     C*                                                                   CRE001
     C           CRE001    IFEQ 'N'                                       CRE001
     C           CRE001    OREQ 'Y'                                       CRE001
     C           ODLI      ANDEQ*BLANKS                                   CRE001
     C                     MOVE '1'       *IN24   1                       CRE001
     C                     ELSE                                           CRE001
     C                     MOVE '0'       *IN24   1                       CRE001
     C                     ENDIF                                          CRE001
     C*
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C           SCICI     ANDNE*BLANKS
     C           SDICI     ANDEQ*BLANKS
     C           SGACI     ANDEQ*ZEROS                                    103860
     C           DHISD     ANDLTCHISD
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C           DCRCI     ANDEQ*BLANKS
     C           DMADI     ANDEQ*ZEROS
     C           DMACI     ANDNE*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           ADJFLG    ANDEQ*BLANKS                                   103860
     C           *IN24     ANDEQ'1'                                       CRE001
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C           DCRCI     ANDEQ'Y'
     C           DMADI     ANDEQ*ZEROS
     C           DMACI     ANDEQ*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           ADJFLG    ANDEQ*BLANKS                                   103860
     C           *IN24     ANDEQ'1'                                       CRE001
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C           DCRCI     ANDEQ'Y'
     C           DMADI     ANDEQ*ZEROS
     C           DMACI     ANDNE*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           ADJFLG    ANDEQ*BLANKS                                   103860
     C           *IN24     ANDEQ'1'                                       CRE001
     C           *IN51     OREQ '0'                                       088733
     C           DRECI     ANDEQ'D'                                       088733
     C           DDRCI     ANDEQ*BLANKS                                   088733
     C           DCRCI     ANDEQ*BLANKS                                   088733
     C           DMADI     ANDEQ*ZEROS                                    088733
     C           DMACI     ANDEQ*ZEROS                                    088733
     C           DDMVT     ANDEQ*ZEROS                                    088733
     C           DCMVT     ANDEQ*ZEROS                                    088733
     C           ADJFLG    ANDEQ*BLANKS                                   103860
     C           *IN24     ANDEQ'1'                                       CRE001
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C                     END                             - E2
     C*
     C           *IN51     IFEQ '0'
     C           *IN51     OREQ '1'                                                        MD027025A
     C           SIND2     ANDEQ'X'                                                        MD027025A
     C           CDICT     IFLT 3                          - B2
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C           *IN51     IFEQ '1'                                                        MD027025A
     C           *IN50     OREQ '0'                                                        MD027025A
     C           SIND2     ANDEQ'X'                                                        MD027025A
     C           DHISD     ANDGTCHISD                                                      MD027025A
     C                     Z-ADDCHISD     DHISD                                            MD027025A
     C                     ENDIF                                                           MD027025A
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
      *                                                                                       MQ1590
      ** For calc basis 6, use the factored number of days                                    MQ1590
      *                                                                                       MQ1590
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                                                MQ1590
     C                     Z-ADDZDAYN2    DAYD                                                MQ1590
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C********** ZDAYN2    IFNE *ZERO                                                         MQ1590
     C           DAYS      IFGT *ZERO                                                         MQ1590
     C                     MOVEA'01'      *IN,85                          089497
     C**********           Z-ADDZDAYN2    DAYS                                                MQ1590
     C**********           Z-ADDZDAYN2    DAYD                                                MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C                     MOVE *BLANKS   CR                              100992
     C*
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     END                             - E1
     C           DHISD     IFLT CHISD
     C******************   ADD  WWADJD    WDAID                     094431101483
      *                                                                   103860
     C           DRECI     IFEQ 'S'                                       103860
     C           SDAIC     SUB  WDAID     INTD0                           103860
     C                     ELSE                                           103860
     C           DDAID     SUB  WDAID     INTD0
     C                     END                                            103860
      *                                                                   103860
     C                     ELSE
     C           CDRIP     SUB  WDAID     INTD0
     C           INTD0     ADD  CDRIS     INTD0
     C           INTD0     ADD  CDAIC     INTD0
     C***********INTD0     ADD  CPMADI    INTD0                     065773094433
     C***********INTD0     SUB  CTMADI    INTD0                     065773094433
     C                     END
     C*
     C           NUMB0     IFGT *ZEROS
     C                     ADD  NUMB0     TOTND
     C                     ELSE
     C******************   SUB  NUMB0     TOTNC                           101770
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTD0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT SUBTOTAL
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*                                                                   CRE001
     C** OUTPUT NEW OVERDRAFT LIMIT IF OVERDRAFT LINE PROCESSED           CRE001
     C*                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C           ODLI      IFEQ 'Y'                        - B5           CRE001
     C                     Z-ADDDODRL     WODRL                           CRE001
     C                     Z-ADDDHISD     ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE '0'       *IN99                           CRE001
     C                     MOVELZDATE     VALDA                           CRE001
     C                     MOVELNAR,35    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C                     END                             - E5           CRE001
     C                     END                                            CRE001
     C*
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
      *                                                                   113955
     C                     END                                            113955
      *                                                                   113955
     C           SF1F      IFEQ 'Y'                                       113955
     C                     MOVE '1'       *IN51                           113955
     C                     END                                            113955
     C*
     C                     END                             - E1
     C*
     C**  OUTPUT SUBTOTAL LINE
      *                                                                   113955
     C           SF1F      IFEQ *BLANK                                    113955
      *                                                                   091612
      * Output total debit number                                         091612
     C                     MOVELNAR,26    NARR                            091612
     C                     MOVE *BLANKS   ZFIELD                          091612
     C                     MOVE TOTND     ZFIELD                          091612
     C                     Z-ADDDECI1     ZADIG                           091612
     C                     EXSR ZEDIT                                     091612
     C                     MOVE ZFIELD    TOTN   16                       091612
     C                     EXSR OUT7SR                     formatAREAType1091612
     C                     MOVELAREA      SDAT1                           091612
     C                     EXSR SUBW1                                     091612
     C*
     C** PREPARE C/F BALANCE
     C*
     C           DEBBAK    IFEQ *ON                                       089497
     C                     MOVE *OFF      DEBBAK                          089497
     C                     MOVELNAR,39    NARR                            089497
     C                     ELSE                                           089497
     C                     MOVELNAR,6     NARR
     C                     ENDIF                                          089497
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE CHISD                      - B1
     C                     Z-ADDCHISD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA                        ***************
     C                     Z-ADD006       DBASE            * DB ERROR 006*
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVE CHISD     DBKEY
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDCHISD     PVALD
     C                     MOVELZDATE     PVALDO
     C*
     C                     END                             - E1
     C*
     C                     MOVELPVALDO    VALDA
     C                     Z-ADDCHISB     HISB0
     C           SIND2     IFEQ 'X'                                                        MD027025A
     C                     Z-ADDWHISB     HISB0                                            MD027025A
     C                     ENDIF                                                           MD027025A
     C*
     C                     MOVE *BLANKS   CR                              100992
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVEA'10'      *IN,85
     C                     EXSR LINE1
     C                     MOVEA'01'      *IN,85
     C*
     C**  OUTPUT BALANCE C/F
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C**  PREPARE TOTAL INTEREST OUTPUT
     C*
     C                     Z-ADDWDRCB     ZICALC
     C           CLDID     IFNE *ZEROS
     C                     Z-ADDCLDID     ZIBEG
     C                     ELSE
     C                     Z-ADDWHISD2    ZIBEG
     C                     END
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD
     C                     ENDIF                                                              MQ1590
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C                     MOVELNAR,5     NARR
     C*                                                                   094433
     C* Total interest DR capitalisation only.                            094433
     C*                                                                   094433
     C           *IN51     IFEQ '0'                                       094433
     C                     Z-ADDCDRIP     TINTD0
     C                     ADD  CDRIS     TINTD0
     C                     ADD  CDAIC     TINTD0
     C           SDICI     IFEQ ' '                                       094433
     C                     ADD  CTMADI    TINTD0                          094431
     C                     ELSE                                           094433
     C                     ADD  CPMADI    TINTD0                          094433
     C                     END                                            094433
     C                     ELSE                                           094433
     C           WDAID     ADD  INTD0     TINTD0                          094433
     C           @CPTDY    IFEQ 'Y'                                       094433
     C                     ADD  CPMADI    TINTD0                          094433
     C                     ELSE                                           094433
     C                     ADD  CTMADI    TINTD0                          094433
     C                     END                                            094433
     C                     END                                            094433
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********TINTD0    IFLT 0                                   077129086254
     C***********          Z-SUBTINTD0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          ELSE                                     077129086254
     C***********          MOVE TINTD0    ZFIELD                          086254
     C***********          END                                      077129086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG   20
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTD0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT TOTAL INTEREST
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C********************************************************************088737
     C****PREPARE*to*be*posted**OUTPUT************************************088737
     C********************************************************************088737
     C***********          MOVE ' '       WSIG    1                       088737
     C***********CDAIC     IFNE *ZERO                                     088737
     C***********                                                         088737
     C***********          MOVELNAR,28    NARR                            088737
     C***********          Z-ADD*ZEROS    TINTD0                          088737
     C***********                                                         088737
     C***********CDAIC     IFLT *ZERO                                     088737
     C***********          Z-SUBCDAIC     TINTD0                          088737
     C***********          MOVE '-'       WSIG                            088737
     C***********          ELSE                                           088737
     C***********          Z-ADDCDAIC     TINTD0                          088737
     C***********          END                                            088737
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********TINTD0    IFLT 0                                   077129086254
     C***********          Z-SUBTINTD0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          ELSE                                     077129086254
     C***********          MOVE TINTD0    ZFIELD                          086254
     C***********          END                                      077129086254
      **************************************************************086254088737
      **edit*amount*with*minus*sign*********************************086254088737
     C***********          Z-ADDDECI1     ZADIG                           088737
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C***********          Z-ADDTINTD0    WKINT            set SR pa086254088737
     C***********          EXSR EDTINT                     editIntrs086254088737
     C********************************************************************088737
     C****OUTPUT*TOTAL*DEBITED********************************************088737
     C********************************************************************088737
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR                     formatARE086093088737
     C***********          MOVELAREA      SDAT1                           088737
     C***********          EXSR SUBW1                                     088737
     C***********          END                                            088737
     C                     MOVE ' '       WSIG    1
     C*
     C**  PREPARE TOTAL DEBITED OUTPUT
     C*
     C                     MOVELNAR,7     NARR
     C                     Z-ADD*ZEROS    TINTD0
     C*
     C*                                                                   094433
     C* Total posted DR capitalisation only.                              094433
     C*                                                                   094433
     C           *IN51     IFEQ '0'                                       094433
     C                     Z-ADDCDRIP     TINTD0
     C                     ADD  CDRIS     TINTD0
     C                     ADD  CPMADI    TINTD0                          094433
     C                     ELSE                                           094433
     C           @CPTDY    IFEQ 'Y'                                       094433
     C           SDRIP     ADD  SDRIS     TINTD0                          094433
     C                     ADD  CPMADI    TINTD0                          094433
     C                     ELSE                                           094433
     C           CDRIS     ADD  CDRIP     TINTD0                          094433
     C                     ADD  CPMADI    TINTD0                          094433
     C                     END                                            094433
     C                     END                                            094433
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********TINTD0    IFLT 0                                   077129086254
     C***********          Z-SUBTINTD0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          ELSE                                     077129086254
     C***********          MOVE TINTD0    ZFIELD                          086254
     C***********          END                                      077129086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTD0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT TOTAL DEBITED
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*                                                                   088737
     C**  PREPARE TO BE POSTED OUTPUT                                     088737
     C*                                                                   088737
     C                     MOVE ' '       WSIG    1                       088737
     C*                                                                   088737
     C                     MOVELNAR,28    NARR                            088737
     C                     Z-ADD*ZEROS    TINTD0                          088737
     C*                                                                   088737
     C                     Z-ADDCDAIC     TINTD0                          094433
     C***********          ADD  CPMADI    CDAIC                     094431094433
     C***********          ADD  CTMADI    CDAIC                     094431094433
     C***********CDAIC     IFLT *ZERO                               088737094433
     C***********          Z-SUBCDAIC     TINTD0                    088737094433
     C***********          MOVE '-'       WSIG                      088737094433
     C***********          ELSE                                     088737094433
     C***********          Z-ADDCDAIC     TINTD0                    088737094433
     C***********          END                                      088737094433
     C*                                                                   094433
     C* Total to be posted DR capitalisation only.                        094433
     C*                                                                   094433
     C           *IN51     IFEQ '0'                                       094433
     C           SDICI     IFEQ ' '                                       094433
     C                     ADD  CTMADI    TINTD0                          094433
     C                     END                                            094433
     C                     ELSE                                           094433
     C                     ADD  CTMADI    TINTD0                          094433
     C                     END                                            094433
      *                                                                   088737
      * edit amount with minus sign                                       088737
     C                     Z-ADDDECI1     ZADIG                           088737
     C                     Z-ADDTINTD0    WKINT                           088737
     C                     EXSR EDTINT                                    088737
     C*                                                                   088737
     C**  OUTPUT TOTAL TO BE POSTED                                       088737
     C*                                                                   088737
     C                     EXSR OUT2SR                                    088737
     C                     MOVELAREA      SDAT1                           088737
     C                     EXSR SUBW1                                     088737
     C/COPY WNCPYSRC,RE3364EC02
     C           CER050    IFEQ 'Y'                                                           CER050
     C                     EXSR SRDRAP                                                        CER050
     C                     ENDIF                                                              CER050
     C*
     C           WTYP      IFEQ 'P'                                       086230
     C                     Z-ADD1         RECN1                           086230
     C***********          Z-ADD1         RECN1                           075071
     C                     ENDIF                                          086230
      *                                                                   113955
     C                     END                                            113955
     C*
     C                     ENDSR                           **DRSR ENDSR**
     C*
     C*******************************************************************
     C/EJECT                                                              101483
     C******************************************************************* 101483
     C**                                                                  101483
     C** RESET subroutine to clear partially setup narratives             101483
     C**                                                                  101483
     C**     Called by     ............                                   101483
     C**                                                                  101483
     C**     Calls         none                                           101483
     C**                                                                  101483
     C           RESET     BEGSR                           **RESET BEGSR**101483
      *                                                                   101483
     C                     RESETNARR                                      101483
     C                     RESETNARR2                                     101483
      *                                                                   101483
     C                     RESETND                                        101483
     C                     RESETCR                                        101483
     C                     RESETCR2                                       101483
     C                     RESETCHAR                                      101483
     C                     RESETHSIG                                      101483
     C                     RESETNUMB                                      101483
      *                                                                   101483
     C                     RESETPSTDA                                     101483
     C                     RESETVALDA                                     101483
     C                     RESETPSTD2                                     101483
     C                     RESETVALD2                                     101483
      *                                                                   101483
     C                     RESETAMON                                      101483
     C                     RESETAMON2                                     101483
      *                                                                   101483
     C                     RESETRATOMP                                    101483
     C                     RESETCOMMVT                                    101483
     C                     RESETINTRM                                     101483
     C                     RESETTOTN                                      101483
      *                                                                   101483
     C                     ENDSR                           **RESET ENDSR**101483
      *                                                                   101483
     C******************************************************************* 101483
     C/EJECT
     C*******************************************************************
     C**
     C** RATED subroutine for Dedit output processing
     C**
     C**     Called by     DRSR, RATESR
     C**
     C**     Calls         ZDATE2, DBSR, RDRSR
     C**
     C           RATED     BEGSR                           **RATED BEGSR**
     C*
     C**  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR DEBIT RATE CHANGE TO
     C*
     C***********KLIST5    SETLLREHRDJ                   60               075071
     C*
     C***********KLIST5    READEREHRDJ                   62               075071
     C           KLIST5    CHAINREHRDJ               62                   075071
     C           *IN62     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
      *    Go to end if record is not found                               094431
      *                                                                   094431
     C           RVALD     IFNE 0                                         094431
     C           PVALD     IFNE RVALD                      - B1
     C                     Z-ADDRVALD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD007       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVELDDRCD     DBKEY            * DB ERROR 007*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDRVALD     PVALD
     C                     MOVELZDATE     PVALDO
     C*
     C                     END                             - E1
     C                     MOVELPVALDO    VALDA
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE RPSTD                      - B1
     C                     Z-ADDRPSTD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD008       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVELRPSTD     DBKEY            * DB ERROR 008*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDRPSTD     PPSTD
     C                     MOVELZDATE     PPSTDO
     C*
     C                     END                             - E1
     C*
     C**  PREPARE DEBIT RATE CHANGE TO OUTPUT
     C*
     C                     MOVELPPSTDO    PSTDA
     C*
     C           *IN21     IFEQ '0'                                       075079
     C                     MOVELNAR,3     NARR                            075079
     C                     ELSE                                           075079
     C                     MOVELNAR,4     NARR
     C                     END                                            075079
     C*
     C**  OUTPUT DEBIT RATE CHANGE TO
     C*
     C                     EXSR RDRSR
      *                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
      *                                                                   CRE001
     C********** DDICT     IFEQ 0                                                      CRE001 206671
     C                     MOVELNAR,34    NARR                            CRE001
     C                     EXSR RDRAO                                     CRE001
     C**********           END                                                         CRE001 206671
      *                                                                   CRE001
     C                     END                                            CRE001
     C*
     C                     END                                            094431
     C                     ENDSR                           **RATED ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RDRSR subroutine for rate output processing
     C**
     C**     Called by     DRSR, RATED, B1EQ, B1LT, B1GT, OPENDR,
     C**                   POSTSR
     C**
     C**     Calls         ZEDIT, SUBW1
     C**
     C           RDRSR     BEGSR                           **RDRSR BEGSR**
     C                     MOVE *BLANKS   CR                              100992
      *                                                                   099509
     C           *IN21     IFEQ '0'                                       099509
     C                     MOVELNAR,3     NARR                            099509
     C                     ELSE                                           099509
     C                     MOVELNAR,4     NARR                            099509
     C                     ENDIF                                          099509
     C*
     C***********DDICT     IFEQ *ZEROS                     - B1           075196
     C           RINTP     IFEQ *ZEROS                     - B1           075196
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C*                    MOVE DRIR      ZFIELD
     C***********          MOVE INRT      ZFIELD                          086254
      *                                                                   086254
      * edit Percentage rate with brackets & percent sign                 086254
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    RATO                            086254
     C                     Z-ADDINRT      WKRAT            set SR parm    086254
     C                     EXSR EDTPER                     editIntrstWith%086254
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C***********          MOVE '1'       *IN87                           086093
     C***********          EXCPTOUT1                                      086093
     C                     EXSR OUT1SR                     formatAREAType1086093
     C                     MOVE '1'       *IN21                           075079
     C***********          MOVE '0'       *IN87                           086093
     C***********          READ GHOST                    99               086093
     C                     MOVELAREA      SDAT1
     C/COPY WNCPYSRC,RE3364EC09
     C                     EXSR SUBW1
     C*
     C                     ELSE                            - X1
     C*
     C           RINST     IFEQ 0                          - B2           075079
     C*                                                                   075079
     C* If Type/Subtype have been previously used, display as zero rate   075079
     C* rather than 0x 00000 for this report.                             075079
     C*                                                                   075079
     C***********          Z-ADD0         ZRATE  117                075079086254
     C***********          MOVE ZRATE     ZFIELD                    075079086254
     C***********          Z-ADDDECI2     ZADIG                     075079086254
     C***********          Z-ADD7         ZADEC                     075079086254
     C***********          EXSR ZEDIT                               075079086254
     C***********          MOVE ZFIELD    RATO                      075079086254
     C*                                                                   075079
      * output 0% Percentage rate (using constant)                        086254
     C                     MOVELZRCTCN    RATOMP           '0.0000000%'   086254
      *                                                                   086254
     C***********          MOVE '1'       *IN87                     075079086093
     C***********          EXCPTOUT1                                075079086093
     C                     EXSR OUT1SR                     formatAREAType1086093
     C                     MOVE '1'       *IN21                           075079
     C***********          MOVE '0'       *IN87                     075079086093
     C***********          READ GHOST                    99         075079086093
     C                     MOVELAREA      SDAT1                           075079
     C/COPY WNCPYSRC,RE3364EC10
     C                     EXSR SUBW1                                     075079
     C*                                                                   075079
     C                     ELSE                            - X2           075079
     C*
     C                     MOVE '1'       *IN25
     C           *IN21     IFEQ '0'                        - B3           075079
     C                     MOVELNAR,3     NARR                            075079
     C                     ELSE                            - X3           075079
     C***********          MOVELNAR,11    NARR                            075079
     C                     MOVELNAR,4     NARR                            075079
     C                     END                             - E3           075079
     C*                                                                   075079
     C**
     C***********          MOVE INTP      TYPE                            075071
     C***********          MOVE INST      SBTP                            075071
     C                     MOVE RINTP     TYPE                            075071
     C                     MOVE RINST     SBTP                            075071
     C                     MOVELTPSBT     TPST
     C*
     C***********          EXCPTOUT9                                      086093
     C                     MOVE '1'       *IN21                           075079
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT9SR                     formatAREAType1086093
     C                     MOVE '0'       *IN25
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C           INTH      IFGT *ZEROS                     - B3
     C                     Z-ADDINTH      HISB0
     C*****************    MOVELNAR,13    NARR                            101473
     C                     MOVELNAR,14    NARR                            101473
     C                     ELSE                            - X3
     C                     Z-SUBINTH      HISB0
     C*****************    MOVELNAR,14    NARR                            101473
     C                     MOVELNAR,13    NARR                            101473
     C                     END                             - E3
     C*
     C           HISB0     IFLT 0                          - B3
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     END                             - E3
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C* CLEAR ARRAYS                                                      045322
     C                     MOVEA*BLANKS   ARR                             045322
     C                     MOVEA*BLANKS   NEG                             077129
     C                     MOVEA*BLANKS   ARB                             045322
     C*                                                                   045322
     C***********RAT21     IFNE *ZEROS                     - B3           077980
     C***********BAL21     ORNE *ZEROS                                    077980
     C           RAT21     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT21     ORAT1                           077129
     C                     MOVE '-'       NEG,1                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT21     ORAT1
     C                     END                                            077129
     C                     Z-ADDBAL21     OBAL01
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT1     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,1
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL01    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,1
     C***********RAT22     IFNE *ZEROS                     - B4           086560
     C***********BAL22     ORNE *ZEROS                                    078272
     C***********BAL22     ANDNE*ZEROS                              078272086560
     C           BAL22     IFNE *ZEROS                                    086560
     C           RAT22     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT22     ORAT2                           077129
     C                     MOVE '-'       NEG,2                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT22     ORAT2
     C                     END                                            077129
     C                     Z-ADDBAL22     OBAL02
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT2     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,2
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL02    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,2
     C***********RAT23     IFNE *ZEROS                     - B5           086560
     C***********BAL23     ORNE *ZEROS                                    078272
     C***********BAL23     ANDNE*ZEROS                              078272086560
     C           BAL23     IFNE *ZEROS                                    086560
     C           RAT23     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT23     ORAT3                           077129
     C                     MOVE '-'       NEG,3                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT23     ORAT3
     C                     END                                            077129
     C                     Z-ADDBAL23     OBAL03
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT3     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,3
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL03    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,3
     C                     ELSE                            - X5
     C                     Z-ADD*ZEROS    ORAT3
     C                     Z-ADD*ZEROS    OBAL03
     C                     MOVE *BLANKS   ARR,3
     C                     MOVE *BLANKS   ARB,3
     C                     END                             - E5
     C                     ELSE                            - X4
     C                     Z-ADD*ZEROS    ORAT2
     C                     Z-ADD*ZEROS    OBAL02
     C                     MOVE *BLANKS   ARR,2
     C                     MOVE *BLANKS   ARB,2
     C                     END                             - E4
     C***********          END                             - E3           077980
     C*
     C***********RAT24     IFNE *ZEROS                     - B3           086560
     C***********BAL24     ORNE *ZEROS                                    078272
     C***********BAL24     ANDNE*ZEROS                              078272086560
     C           BAL24     IFNE *ZEROS                                    086560
     C           RAT24     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT24     ORAT1                           077129
     C                     MOVE '-'       NEG,4                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT24     ORAT1
     C                     END                                            077129
     C                     Z-ADDBAL24     OBAL01
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT1     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,4
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL01    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,4
     C***********RAT25     IFNE *ZEROS                     - B4           086560
     C***********BAL25     ORNE *ZEROS                                    078272
     C***********BAL25     ANDNE*ZEROS                              078272086560
     C           BAL25     IFNE *ZEROS                                    086560
     C           RAT25     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT25     ORAT2                           077129
     C                     MOVE '-'       NEG,5                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT25     ORAT2
     C                     END                                            077129
     C                     Z-ADDBAL25     OBAL02
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT2     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,5
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL02    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,5
     C***********RAT26     IFNE *ZEROS                     - B5           086560
     C***********BAL26     ORNE *ZEROS                                    078272
     C***********BAL26     ANDNE*ZEROS                              078272086560
     C           BAL26     IFNE *ZEROS                                    086560
     C           RAT26     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT26     ORAT3                           077129
     C                     MOVE '-'       NEG,6                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT26     ORAT3
     C                     END                                            077129
     C                     Z-ADDBAL26     OBAL03
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT3     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,6
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL03    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,6
     C                     ELSE                            - X5
     C                     Z-ADD*ZEROS    ORAT3
     C                     Z-ADD*ZEROS    OBAL03
     C                     MOVE *BLANKS   ARR,6
     C                     MOVE *BLANKS   ARB,6
     C                     END                             - E5
     C                     ELSE                            - X4
     C                     Z-ADD*ZEROS    ORAT2
     C                     Z-ADD*ZEROS    OBAL02
     C                     MOVE *BLANKS   ARR,5
     C                     MOVE *BLANKS   ARB,5
     C                     END                             - E4
     C*
     C* IF RAT3 AND BAL3 ARE BLANK SET ELEMENTS TO ZERO AS                086559
     C* MEANS NO RECORD ON REHPOSR3                                       086559
     C*                                                                   086559
     C           RAT3      IFEQ *BLANKS                                   086559
     C                     Z-ADD0         RAT31                           086559
     C                     Z-ADD0         RAT32                           086559
     C                     Z-ADD0         RAT33                           086559
     C                     Z-ADD0         RAT34                           086559
     C                     Z-ADD0         RAT35                           086559
     C                     Z-ADD0         RAT36                           086559
     C                     END                                            086559
     C*                                                                   086559
     C           BAL3      IFEQ *BLANKS                                   086559
     C                     Z-ADD0         BAL31                           086559
     C                     Z-ADD0         BAL32                           086559
     C                     Z-ADD0         BAL33                           086559
     C                     Z-ADD0         BAL34                           086559
     C                     Z-ADD0         BAL35                           086559
     C                     Z-ADD0         BAL36                           086559
     C                     END                                            086559
     C*                                                                   086559
     C***********RAT31     IFNE *ZEROS                     - B4           086560
     C***********BAL31     ORNE *ZEROS                                    078272
     C***********BAL31     ANDNE*ZEROS                              078272086560
     C           BAL31     IFNE *ZEROS                                    086560
     C           RAT31     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT31     ORAT1                           077129
     C                     MOVE '-'       NEG,7                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT31     ORAT1
     C                     END                                            077129
     C                     Z-ADDBAL31     OBAL01
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT1     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,7
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL01    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,7
     C***********RAT32     IFNE *ZEROS                     - B5           086560
     C***********BAL32     ORNE *ZEROS                                    078272
     C***********BAL32     ANDNE*ZEROS                              078272086560
     C           BAL32     IFNE *ZEROS                                    086560
     C           RAT32     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT32     ORAT2                           077129
     C                     MOVE '-'       NEG,8                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT32     ORAT2
     C                     END                                            077129
     C                     Z-ADDBAL32     OBAL02
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT2     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,8
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL02    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,8
     C***********RAT33     IFNE *ZEROS                     - B6           086560
     C***********BAL33     ORNE *ZEROS                                    078272
     C***********BAL33     ANDNE*ZEROS                              078272086560
     C           BAL33     IFNE *ZEROS                                    086560
     C           RAT33     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT33     ORAT3                           077129
     C                     MOVE '-'       NEG,9                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT33     ORAT3
     C                     END                                            077129
     C                     Z-ADDBAL33     OBAL03
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT3     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,9
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL03    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,9
     C                     ELSE                            - X6
     C                     Z-ADD*ZEROS    ORAT3
     C                     Z-ADD*ZEROS    OBAL03
     C                     MOVE *BLANKS   ARR,9
     C                     MOVE *BLANKS   ARB,9
     C                     END                             - E6
     C                     ELSE                            - X5
     C                     Z-ADD*ZEROS    ORAT2
     C                     Z-ADD*ZEROS    OBAL02
     C                     MOVE *BLANKS   ARR,8
     C                     MOVE *BLANKS   ARB,8
     C                     END                             - E5
     C*
     C***********RAT34     IFNE *ZEROS                     - B5           086560
     C***********BAL34     ORNE *ZEROS                                    078272
     C***********BAL34     ANDNE*ZEROS                              078272086560
     C           BAL34     IFNE *ZEROS                                    086560
     C           RAT34     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT34     ORAT1                           077129
     C                     MOVE '-'       NEG,10                          077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT34     ORAT1
     C                     END                                            077129
     C                     Z-ADDBAL34     OBAL01
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT1     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,10
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL01    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,10
     C***********RAT35     IFNE *ZEROS                     - B6           086560
     C***********BAL35     ORNE *ZEROS                                    078272
     C***********BAL35     ANDNE*ZEROS                              078272086560
     C           BAL35     IFNE *ZEROS                                    086560
     C           RAT35     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT35     ORAT2                           077129
     C                     MOVE '-'       NEG,11                          077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT35     ORAT2
     C                     END                                            077129
     C                     Z-ADDBAL35     OBAL02
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT2     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,11
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL02    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,11
     C*                                                                   075082
     C** Note: RAT36 and BAL36 are surplus to requirements.               075082
     C*                                                                   075082
     C***********RAT36     IFNE *ZEROS                     - B7           075082
     C***********BAL36     ORNE *ZEROS                                    075082
     C***********          Z-ADDRAT36     ORAT3                           075082
     C***********          Z-ADDBAL36     OBAL03                          075082
     C***********          MOVE *BLANKS   ZFIELD                          075082
     C***********          MOVE ORAT3     ZFIELD                          075082
     C***********          Z-ADDDECI2     ZADIG                           075082
     C***********          Z-ADD7         ZADEC                           075082
     C***********          EXSR ZEDIT                                     075082
     C***********          MOVE ZFIELD    ARR,12                          075082
     C***********          MOVE *BLANKS   ZFIELD                          075082
     C***********          MOVE OBAL03    ZFIELD                          075082
     C***********          Z-ADDDECI1     ZADIG                           075082
     C***********          Z-ADDSAVEZ     ZADEC                           075082
     C***********          EXSR ZEDIT                                     075082
     C***********          MOVE ZFIELD    ARB,12                          075082
     C***********          ELSE                            - X7           075082
     C                     Z-ADD*ZEROS    ORAT3
     C                     Z-ADD*ZEROS    OBAL03
     C                     MOVE *BLANKS   ARR,12
     C                     MOVE *BLANKS   ARB,12
     C***********          END                             - E7           075082
     C                     ELSE                            - X6
     C                     Z-ADD*ZEROS    ORAT2
     C                     Z-ADD*ZEROS    OBAL02
     C                     MOVE *BLANKS   ARR,11
     C                     MOVE *BLANKS   ARB,11
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     Z-ADD1         Y       20
     C           Y         DOWLE12                         - B3
     C           ARB,Y     IFNE *BLANKS                    - B4
     C           ARR,Y     ORNE *BLANKS
     C***********          MOVE ARB,Y     ZN1    16                       086093
     C***********          MOVE ARR,Y     ZN2    16                       086093
     C***********          MOVE NEG,Y     ZN3     1                 077129086093
     C*
     C***********          EXCPTOUT4                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT4SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C/COPY WNCPYSRC,RE3364EC11
     C                     EXSR SUBW1
     C                     ADD  1         Y
     C                     ELSE                            - X4
     C                     Z-ADD13        Y
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2           075079
     C*                                                                   075079
     C                     END                             - E1
     C*
     C                     ENDSR                           **RDRSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** CRSR Subroutine for credit output processing (to fill subfiles
     C**      2 and 3 - credit only)
     C**
     C**     Called by     MAIN
     C**
     C**     Calls         SUBW2, SUBW3, LINE2, BFOPSR, ZEDIT, ZDATE2,
     C**                   DBSR, RCRSR, RATEC, ZICD
     C**
     C           CRSR      BEGSR                           **CRSR BEGSR**
     C*                                                                   075079
     C******************   MOVE '0'       *IN22                     075079099509
     C*
     C**  OUTPUT HEADER LINES
     C*
     C                     MOVEA'11'      *IN,85
     C                     MOVELNAR,17    SDAT2
     C                     EXSR SUBW2
     C                     MOVEA'00'      *IN,85
     C*
     C           WTYP      IFNE 'P'
     C*
     C** ADD BLANK LINE
     C*
     C                     EXSR LINE2
     C*
     C           BMCBAI    IFEQ 'Y'                                       CRE003
     C                     MOVELNAR,16    SDAT2
     C                     MOVELNAR,22    SDAT3
     C                     ELSE                                           CRE003
     C                     MOVELNAR,37    SDAT2                           CRE003
     C                     MOVELNAR,38    SDAT3                           CRE003
     C                     END                                            CRE003
     C                     EXSR SUBW2
     C                     EXSR SUBW3
     C*
     C                     MOVEL*BLANK    SDAT3
     C                     EXSR SUBW3
     C           CER016    IFEQ 'Y'                                                         BUG22235
     C           CRIC      ANDEQ*ZERO                                                       BUG22235
     C                     Z-ADD8         J                                                 BUG22235
     C                     ELSE                                                             BUG22235
     C                     Z-ADDCRIC      J
     C                     ENDIF                                                            BUG22235
     C                     MOVEL*BLANKS   SDAT2
     C                     MOVE CAC,J     SDAT2
     C/COPY WNCPYSRC,RE3364EC12
     C                     EXSR SUBW2
     C*
     C                     MOVE '1'       *IN85
     C                     EXSR LINE2
     C                     EXSR SUBW3
     C                     MOVEA'01'      *IN,85
     C                     END
     C*
     C**  ACCESS REHISL WITH LAST CREDIT CAPITALISATION DATE
     C*
     C***********KLIST3    SETLLREHISL               52                   086254
     C           KLIST3    SETLLREHISL                                    086254
     C*
     C           KLIST1    READEREHISL                   52
      *                                                                                     MD056973
     C           DRECI     DOWEQ'M'                                                         MD056973
     C           *IN52     ANDEQ'0'                                                         MD056973
     C           KLIST1    READEREHISL                   52                                 MD056973
     C                     ENDDO                                                            MD056973
      *                                                                   092181
      * If a/c header or cap. rec. not found, read the previous record    092181
      * as if demand or closure cap. CLCID is not equal to cap. date as   092181
      * LCID is not 1 day behind cap. value date (see fix 077684/086230   092181
      * in BOTHSR and setup of PCID in RE3363).                           092181
     C           *IN52     IFEQ '1'                                       092181
     C           DRECI     ORNE 'B'                                       092181
     C           DRECI     ANDNE'S'                                       092181
     C                     SUB  1         CLCID                           092181
     C           KLIST3    SETLLREHISL                                    092181
     C           KLIST1    READEREHISL                   52               092181
     C                     END                                            092181
     C*
     C           *IN52     DOWEQ'0'                        - B1
     C           DRECI     ANDEQ'S'
     C           SDICI     ANDNE*BLANKS
     C           SCICI     ANDEQ*BLANKS
     C           DHISD     ANDLTCHISD
     C           *IN52     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C           DCRCI     ANDEQ*BLANKS
     C           DMADI     ANDNE*ZEROS
     C           DMACI     ANDEQ*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           *IN52     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DCRCI     ANDEQ*BLANKS
     C           DDRCI     ANDEQ'Y'
     C           DMADI     ANDEQ*ZEROS
     C           DMACI     ANDEQ*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           *IN52     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DCRCI     ANDEQ*BLANKS
     C           DDRCI     ANDEQ'Y'
     C           DMADI     ANDNE*ZEROS
     C           DMACI     ANDEQ*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           *IN52     OREQ '0'                                       088733
     C           DRECI     ANDEQ'D'                                       088733
     C           DDRCI     ANDEQ*BLANKS                                   088733
     C           DCRCI     ANDEQ*BLANKS                                   088733
     C           DMADI     ANDEQ*ZEROS                                    088733
     C           DMACI     ANDEQ*ZEROS                                    088733
     C           DDMVT     ANDEQ*ZEROS                                    088733
     C           DCMVT     ANDEQ*ZEROS                                    088733
     C*
     C           KLIST1    READEREHISL                   52
     C*
     C                     END                             - E1
     C*
     C**  PREPARE B/F BALANCE
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADDDHISD     CLCID
     C                     Z-ADDDHISB     WWHISB
     C                     EXSR BFOPSR
     C                     Z-ADDWWHISB    HISB0  150
     C                     Z-ADDWWHISB    W2HISB
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     HISB0
     C                     Z-ADDSHISB     W2HISB
     C                     END                             - E2
     C                     END                             - E1
     C                     MOVE DRECI     WWRECI
     C*
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVELNAR,1     NARR
     C*
     C**  OUTPUT B/F BALANCE
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     MOVELAREA      SDAT3
     C                     EXSR SUBW2
     C*
     C** OUTPUT INTEREST BEFORE DROP IF EXIST.
     C*
     C           DRECI     IFEQ 'B'
     C           DCAID     ANDNE*ZERO
     C           DCAID     IFLT 0                          - B1
     C           DCAID     MULT SUBT      DCAID
     C                     MOVE 'CR'      CR
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DCAID     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVELNAR,30    NARR
     C*
     C**  OUTPUT INTEREST OF PREVIOUS DATE
     C*
     C                     MOVE '1'       *IN86
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END
     C*
     C***********KLIST3    SETLLREHPOPH                  55               086254
     C           KLIST3    SETLLREHPOPH                                   086254
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C**  BACK VALUE PROCESSING START
     C*
     C           *IN55     DOWEQ'0'                        - B1
     C           PSTD      ANDLECHISD                                     094431
     C***********HISD      ANDLTCLCID                                     094431
     C********   PSTD      IFGT CLCID                                     065773
     C***********PSTD      IFGE CLCID                              065773 094431
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           HISD      IFLT CLCID                                     094431
     C           PSTD      ANDGTCLCID                      - B2           094431
     C           BMLDAI    ANDEQ'N'                                       094431
     C           HISD      ORLT CLCID                                     094431
     C           PSTD      ANDGECLCID                                     094431
     C           BMLDAI    ANDEQ'Y'                                       094431
     C           PPSTD     IFNE PSTD                       - B2
     C                     Z-ADDPSTD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B3
     C           *LOCK     IN   LDA
     C                     Z-ADD009       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 009*
     C                     MOVELPSTD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E3
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     MOVELZDATE     PPSTDO
     C                     END                             - E2
     C*
     C                     MOVELPPSTDO    PSTDA
     C                     MOVELPPSTDO    PSTD2
     C*
     C           PSTDA     IFNE CHECK
     C                     MOVE '0'       *IN26
     C                     ELSE
     C                     MOVE '1'       *IN26
     C                     END
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B2
     C                     Z-ADDHISD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B3
     C           *LOCK     IN   LDA
     C                     Z-ADD010       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 010*
     C                     MOVELHISD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E3
     C*
     C                     Z-ADDHISD      PVALD
     C                     MOVELZDATE     PVALDO
     C                     END                             - E2
     C*
     C                     MOVELPNAR      NARR
     C                     MOVELPNAR      NARR2
     C                     MOVELPVALDO    VALDA
     C                     MOVELPVALDO    VALD2
     C                     MOVELVALDA     CHECK
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           RECI      IFEQ 'P'                        - B3           094431
     C           DRCR      IFEQ 1                          - B2
     C                     MOVE 'CR'      CR
     C                     MOVE 'CR'      CR2
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     MOVE *BLANKS   CR2                             100992
     C                     END                             - E2
     C*
     C                     Z-ADDPSTA      PSTD0
     C           CHGT      IFGT 0                          - B2
     C           CCHGP     ORGT 0
     C           CHGA      IFNE 0
     C           REBI      IFEQ 'Y'                        - B3
     C                     MOVE 'Y'       REB
     C                     ELSE
     C                     MOVE ' '       REB
     C                     END                             - E3
     C                     ADD  CHGA      TOTCH
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ' '       HSIG    1
     C           CHGA      IFLT *ZERO
     C                     Z-SUBCHGA      CHGA
     C                     MOVE '-'       HSIG    1
     C                     END
     C                     MOVE CHGA      ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    CHAR
     C                     END                             - E2
     C                     END                             - E2
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE PSTD0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C                     MOVE ZFIELD    AMON2
     C*
     C**  OUTPUT BACK VALUE
     C*
     C           TURN      IFEQ 'Y'                                       064993
     C                     MOVE '*'       COMMVT                          064993
     C                     ENDIF                                          064993
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     MOVE *BLANKS   COMMVT                          064993
     C*
     C           CHGT      IFGT 0                          - B2
     C           CCHGP     ORGT 0
     C           CHGA      IFNE 0
     C***********          EXCPTOUT3                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT3SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT3
     C                     EXSR SUBW3
     C                     END
     C                     END
     C*
     C** RESET INDICATOR
     C*
     C                     ELSE                             - X3          094431
     C           DRCR      IFEQ 1                           - B4          094431
     C                     Z-ADDHISD      DCRCD                           094431
     C                     EXSR RATEC                                     094431
     C                     END                              - E4          094431
     C                     END                              - E3          094431
     C                     MOVE '0'       *IN26
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C                     END                             - E1
     C*
     C**  BACK VALUE PROCESSING END
      *                                                                   098818
      ** Stop the Back value processing from corrupting the Openning Rate 098818
      ** & Reset partially setup output narratives                        101483
      *                                                                   098818
     C                     Z-ADD0         INRT                            098818
     C                     EXSR RESET                                     101483
      *                                                                   099509
      ***Check*for*'Generated*Adjustments*To*be*Posted'*********** 099509 103860
      ** Check for generated adjustments before start date.               103860
      *                                                                   099509
     C           KLIST1    SETLLREHISSL                  80               103860
     C           *IN80     IFEQ '1'                                       103860
     C           KLIST1    READEREADJF                   80               103860
     C           *IN80     DOWEQ'0'                                       103860
     C           AHISD     ANDLTCLCID                                     103860
     C                     MOVE *ON       *IN42                           099509
     C                     EXSR #ADJ                                      099509
     C                     MOVE *OFF      *IN42                           099509
     C           KLIST1    READEREADJF                   80               103860
     C                     END                                            103860
     C                     END                                            103860
     C*
     C***********KLIST3    SETLLREHPOPL                  55               088826
      *                                                                   088826
      * Set Limits with Credit Capitalisation day                         088826
     C                     EXSR SETPOC                     Setll REHPOPL. 088826
      *                                                                   088826
     C***********KLIST1    READEREHPOPL                  55               088826
     C*
     C**  PREPARE OPENING BALANCE OUTPUT
      *                                                                   099509
      *  Reset the Backvalued Rate-changes Indicators                     099509
      *                                                                   099509
     C                     MOVE *OFF      *IN22                           099509
     C*
     C                     Z-ADDW2HISB    HISB0
      *                                                                   089497
      * If no posting found for period, set history bal to opening bal.   089497
      * If no posting on start date, set history bal to opening bal.      091612
     C           *IN55     IFEQ '1'                                       089497
     C           DHISD     ORNE HISD                                      091612
     C                     Z-ADDW2HISB    DHISB                           089497
     C                     END                                            089497
      *                                                                   089497
     C                     MOVELNAR,2     NARR
     C*
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C** RESET FIRST DAY HISTORY BALANCE
     C*
     C           DRECI     IFEQ 'B'
     C                     Z-ADDDHISD     HISB0
     C                     END
     C*
     C** TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           CLCID     IFNE PVALD                      - B1
     C*
     C                     Z-ADDCLCID     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD011       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 011*
     C                     MOVELHISD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDCLCID     PVALD
     C                     MOVELZDATE     PVALDO
     C*
     C                     END                             - E1
     C*
     C                     MOVELPVALDO    VALDA
     C*
     C**  OUTPUT OPENING BALANCE
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C**  PREPARE OPENING RATE OUTPUT
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C           *IN22     IFEQ '0'                                       075079
     C                     MOVELNAR,8     NARR
     C                     ELSE                                           075079
     C                     MOVELNAR,9     NARR                            075079
     C                     END                                            075079
     C           KLIST3    SETLLREHRCJ
     C           CLCID     IFEQ DACO                                      057291
     C           KLIST3    READEREHRCJ                   99               057291
     C           *IN99     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     ELSE                                           057291
     C           KLIST1    REDPEREHRCJ                   99
     C           *IN99     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     END                                            057291
     C*
     C**  OUTPUT OPENING RATE
     C*
     C                     EXSR RCRSR
     C*
     C                     MOVEA'10'      *IN,85
     C                     EXSR LINE2
     C                     MOVEA'01'      *IN,85
     C                     MOVE *BLANK    ADJFLG                          103860
     C*
     C           *IN51     DOWEQ'0'                        - B1
     C           DHISD     ANDLTCHISD
      *                                                                   103860
      **  Process generated adjustment at start or within cap. period.    103860
      *                                                                   103860
     C           DRECI     IFEQ 'S'                                       103860
     C           SGADI     IFNE 0                                         103860
     C           SGACI     ORNE 0                                         103860
     C                     Z-ADDDHISD     AHISD                           103860
     C                     Z-ADDSDAIC     ADAIC                           103860
     C                     Z-ADDSCAIC     ACAIC                           103860
     C                     MOVE SDCI      ASDCI                           103860
     C                     MOVE SCCI      ASCCI                           103860
     C                     MOVE '1'       *IN42                           103860
     C                     EXSR #ADJ                                      103860
     C                     MOVE '0'       *IN42                           103860
     C                     END                                            103860
     C                     ELSE                                           103860
     C*
     C**  PROCESS POSTING AT THE SAME DATE
     C*
     C           *IN55     DOWEQ'0'                        - B2
     C           DHISD     ANDEQHISD
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE PSTD                       - B3
     C                     Z-ADDPSTD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B5
     C           *LOCK     IN   LDA
     C                     Z-ADD012       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVE PSTD      DBKEY            * DB ERROR 012*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E4
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     MOVELZDATE     PPSTDO
     C                     END                             - E3
     C*
     C                     MOVELPPSTDO    PSTDA
     C                     MOVELPPSTDO    PSTD2
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE HISD                       - B3
     C                     Z-ADDHISD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B4
     C           *LOCK     IN   LDA
     C                     Z-ADD013       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVE HISD      DBKEY            * DB ERROR 013*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E4
     C*
     C                     Z-ADDHISD      PVALD
     C                     MOVELZDATE     PVALDO
     C                     END                             - E3
     C*
     C                     MOVELPVALDO    VALDA
     C                     MOVELPVALDO    VALD2
     C                     MOVELPNAR      NARR
     C                     MOVELPNAR      NARR2
     C*
     C**  CHECK IF DEBIT OR CREDIT
     C*
     C           DRCR      IFEQ 1                          - B3
     C                     MOVE 'CR'      CR
     C                     MOVE 'CR'      CR2
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     MOVE *BLANKS   CR2                             100992
     C                     END                             - E3
     C*
     C                     Z-ADDPSTA      PSTD0
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE PSTD0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C                     MOVE ZFIELD    AMON2
     C*
     C           CCHGP     IFGT 0                          - B1
     C           CHGT      ORGT 0                          - B1
     C           CHGA      IFNE 0
     C           REBI      IFEQ 'Y'                        - B2
     C                     MOVE 'Y'       REB
     C                     ELSE                            - X2
     C                     MOVE 'N'       REB
     C                     END                             - E2
     C                     ADD  CHGA      TOTCH
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ' '       HSIG
     C           CHGA      IFLT 0
     C                     Z-SUBCHGA      CHGA
     C                     MOVE '-'       HSIG
     C                     END
     C                     MOVE CHGA      ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    CHAR
     C                     END                             - E1
     C                     END
     C*
     C**  OUTPUT POSTING
     C*
     C           TURN      IFEQ 'Y'                                       064993
     C                     MOVE '*'       COMMVT                          064993
     C                     ENDIF                                          064993
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     MOVE *BLANKS   COMMVT                          064993
     C*
     C           CCHGP     IFGT 0                          - B1
     C           CHGT      ORGT 0                          - B1
     C           CHGA      IFNE 0
     C***********          EXCPTOUT3                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT3SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT3
     C                     EXSR SUBW3
     C                     END
     C                     END
      *                                                                   089497
      * If backvalued posting found with posting date after end of        089497
      * period, set flag to print 'Adjusted Balance C/F'.                 089497
     C           PSTD      IFGE CHISD                                     089497
     C                     MOVE *ON       CREBAK  1                       089497
     C                     ENDIF                                          089497
     C*
      *                                                                   088826
      * Get Next Posting Record                                           088826
     C                     EXSR NXTPOP                                    088826
     C***********KLIST1    READEREHPOPL                  55               088826
      *                                                                   113955
      * Stop processing if CR interest & charges subfiles full            113955
     C           SF2F      IFEQ 'Y'                                       113955
     C           SF3F      ANDEQ'Y'                                       113955
     C                     SETON                     5155                 113955
     C                     END                                            113955
     C*
     C                     END                             - E3
      *                                                                   113955
     C           DHISD     IFNE WWDATC                                    099511
     C           SF2F      ANDEQ*BLANK                                    113955
     C                     Z-ADDDHISD     WWDATC                          094431
     C                     Z-ADD0         WWADJC                          101483
     C                     EXSR MANUCR                                    094431
     C                     ENDIF                                          099511
     C*
     C**  CREDIT RATE CHANGE TO
     C*
     C           DCRCI     IFEQ 'Y'                        - B3
     C           SF2F      ANDEQ*BLANK                                    113955
     C           DRECI     ANDNE'M'                                                         MD056835
     C***********DHISD     IFGT CLCID                                     106369
     C           DHISD     IFGE CLCID                                     106369
     C*
     C                     EXSR RATEC
     C*
     C                     END
     C                     END                             - E3
      *                                                                   103860
     C                     END                                            103860
      *                                                                   113955
     C           SF2F      IFEQ *BLANK                                    113955
     C           SF3F      OREQ *BLANK                                    113955
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     MOVE DRECI     WRECI
     C                     Z-ADDDHISD     WWHISD
     C                     Z-ADDDHISB     WHISB
     C                     Z-ADDDMNBL     WMNBL
     C                     Z-ADDDCHGAR    WCHGAR
     C                     Z-ADDDTHGAR    WTHGAR
     C                     Z-ADDDCHGAN    WCHGAN
     C                     Z-ADDDTHGAN    WTHGAN
     C                     Z-ADDDDMVT     WDMVT
     C                     MOVE DDICT     WDICT
     C                     MOVE DDRCB     WDRCB
     C                     Z-ADDDRIR      WDRIR
     C                     Z-ADDDDRCD     WDRCD
     C                     Z-ADDWDAID     WDAID2
     C                     Z-ADDDDAID     WDAID
     C                     Z-ADDDMADI     WMADI
     C                     Z-ADDDTMADI    WTMADI
     C                     Z-ADDDPDID     WPDID
     C                     Z-ADDDDMINT    WDMINT
     C                     Z-ADDDCMVT     WCMVT
     C                     Z-ADDDCICT     WCICT
     C                     Z-ADDDCRCB     WCRCB
     C                     Z-ADDCRIR      WCRIR
     C                     Z-ADDDCRCD     WCRCD
     C                     Z-ADDDCAID     WCAID
     C                     Z-ADDDMACI     WMACI
     C                     Z-ADDDTMACI    WTMACI
     C                     Z-ADDDPCID     WPCID
     C                     Z-ADDDCMINT    WCMINT
     C                     MOVE DDICI     WDICI
     C                     MOVE DCICI     WCICI
     C                     MOVE DDRCI     WDRCI
     C                     MOVE DCRCI     WCRCI
     C                     Z-ADDDVDTC     WVDTC
     C                     MOVE DADTY     WADTY
     C                     MOVE DALTI     WALTI
     C                     Z-ADDDMNBCP    WMNBCP
      *                                                                   103860
     C           DRECI     IFEQ 'S'                                       103860
     C                     Z-ADDSHISB     WHISB                           103860
     C                     MOVE SCRCB     WCRCB                           103860
     C           SCICI     IFEQ *BLANK                                    103860
     C                     Z-ADDSCAIC     WCAID                           103860
     C                     END                                            103860
     C                     ELSE                                           103860
     C                     MOVE *BLANKS   ADJFLG                          103860
     C                     END                                            103860
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     DOWEQ'0'                        - B2
     C           DRECI     ANDEQ'S'
     C           SDICI     ANDNE*BLANKS
     C           SCICI     ANDEQ*BLANKS
     C           SGADI     ANDEQ*ZEROS                                    103860
     C           DHISD     ANDLTCHISD
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DDRCI     ANDEQ*BLANKS
     C           DCRCI     ANDEQ*BLANKS
     C           DMADI     ANDNE*ZEROS
     C           DMACI     ANDEQ*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           ADJFLG    ANDEQ*BLANKS                                   103860
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DCRCI     ANDEQ*BLANKS
     C           DDRCI     ANDEQ'Y'
     C           DMADI     ANDEQ*ZEROS
     C           DMACI     ANDEQ*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           ADJFLG    ANDEQ*BLANKS                                   103860
     C           *IN51     OREQ '0'
     C           DRECI     ANDEQ'D'
     C           DCRCI     ANDEQ*BLANKS
     C           DDRCI     ANDEQ'Y'
     C           DMADI     ANDNE*ZEROS
     C           DMACI     ANDEQ*ZEROS
     C           DDMVT     ANDEQ*ZEROS
     C           DCMVT     ANDEQ*ZEROS
     C           ADJFLG    ANDEQ*BLANKS                                   103860
     C           *IN51     OREQ '0'                                       088733
     C           DRECI     ANDEQ'D'                                       088733
     C           DDRCI     ANDEQ*BLANKS                                   088733
     C           DCRCI     ANDEQ*BLANKS                                   088733
     C           DMADI     ANDEQ*ZEROS                                    088733
     C           DMACI     ANDEQ*ZEROS                                    088733
     C           DDMVT     ANDEQ*ZEROS                                    088733
     C           DCMVT     ANDEQ*ZEROS                                    088733
     C           ADJFLG    ANDEQ*BLANKS                                   103860
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C                     END                             - E2
     C*
     C**  OUTPUT SUBTOTAL LINE
     C*
     C           *IN51     IFEQ '0'                        - B1
     C           *IN51     OREQ '1'                                                        MD027025A
     C           SIND2     ANDEQ'X'                                                        MD027025A
     C*
     C           CCICT     IFLT 3                          - B2
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWWHISD    ZIBEG
     C           *IN51     IFEQ '1'                                                        MD027025A
     C           *IN50     OREQ '0'                                                        MD027025A
     C           SIND2     ANDEQ'X'                                                        MD027025A
     C           DHISD     ANDGTCHISD                                                      MD027025A
     C                     Z-ADDCHISD     DHISD                                            MD027025A
     C                     ENDIF                                                           MD027025A
     C                     Z-ADDDHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                                                MQ1590
     C                     Z-ADDZDAYN2    DAYC                                                MQ1590
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C********** ZDAYN2    IFNE *ZERO                                                         MQ1590
     C           DAYS      IFGT *ZERO                                                         MQ1590
     C                     MOVEA'01'      *IN,85                          089497
     C**********           Z-ADDZDAYN2    DAYS                                                MQ1590
     C******************** Z-ADDZDAYN2    DAYD                            101770
     C**********           Z-ADDZDAYN2    DAYC                                         101770 MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDWHISB     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C           DHISD     IFLT CHISD
     C*******************  ADD  WWADJC    WCAID                     094431101483
      *                                                                   103860
     C           DRECI     IFEQ 'S'                                       103860
     C           SCAIC     SUB  WCAID     INTC0                           103860
     C                     ELSE                                           103860
     C           DCAID     SUB  WCAID     INTC0
     C                     END                                            103860
      *                                                                   103860
     C                     ELSE
     C           CCRIP     SUB  WCAID     INTC0
     C           INTC0     ADD  CCRIS     INTC0
     C           INTC0     ADD  CCAIC     INTC0
     C***********INTC0     ADD  CPMACI    INTC0                     065773094433
     C***********INTC0     SUB  CTMACI    INTC0                     065773094433
     C                     END
     C*
     C           NUMB0     IFGT *ZEROS
     C******************   ADD  NUMB0     TOTND                           101770
     C                     ELSE
     C                     SUB  NUMB0     TOTNC
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT SUBTOTAL
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C                     END                             - E4
     C                     END                             - E3
     C                     END                             - E2
      *                                                                   113955
     C                     END                                            113955
      *                                                                   113955
     C           SF2F      IFEQ 'Y'                                       113955
     C           SF3F      ANDEQ'Y'                                       113955
     C                     MOVE '1'       *IN51                           113955
     C                     END                                            113955
     C*
     C**  CHECK IF READ RECORD IS A CHANGE RATE
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     END                             - E1
      *                                                                   113955
     C           SF2F      IFEQ *BLANK                                    113955
     C           SF3F      OREQ *BLANK                                    113955
      *                                                                   091612
      * Output total credit balance                                       091612
     C                     MOVELNAR,27    NARR                            091612
     C                     MOVE *BLANKS   ZFIELD                          091612
     C                     MOVE TOTNC     ZFIELD                          091612
     C                     Z-ADDDECI1     ZADIG                           091612
     C                     EXSR ZEDIT                                     091612
     C                     MOVE ZFIELD    TOTN                            091612
     C                     EXSR OUT7SR                     formatAREAType1091612
     C                     MOVELAREA      SDAT2                           091612
     C                     EXSR SUBW2                                     091612
     C*
     C** PREPARE C/F BALANCE
     C*
     C           CREBAK    IFEQ *ON                                       089497
     C                     MOVE *OFF      CREBAK                          089497
     C                     MOVELNAR,39    NARR                            089497
     C                     ELSE                                           089497
     C                     MOVELNAR,6     NARR
     C                     ENDIF                                          089497
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE CHISD                      - B1
     C                     Z-ADDCHISD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD014       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 014*
     C                     MOVE CHISD     DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDCHISD     PVALD
     C                     MOVELZDATE     PVALDO
     C*
     C                     END                             - E1
     C*
     C                     MOVELPVALDO    VALDA
     C                     Z-ADDCHISB     HISB0
     C           SIND2     IFEQ 'X'                                                        MD027025A
     C                     Z-ADDWHISB     HISB0                                            MD027025A
     C                     ENDIF                                                           MD027025A
     C*
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C**  OUTPUT BALANCE C/F
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C**  PREPARE TOTAL INTEREST OUTPUT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDCLCID     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYC
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     MOVELNAR,5     NARR
     C*                                                                   094433
     C* Total interest CR capitalisation only.                            094433
     C*                                                                   094433
     C           *IN51     IFEQ '0'                                       094433
     C                     Z-ADDCCRIP     TINTC0
     C                     ADD  CCRIS     TINTC0
     C                     ADD  CCAIC     TINTC0
     C           SCICI     IFEQ ' '                                       094433
     C                     ADD  CTMACI    TINTC0                          094431
     C                     ELSE                                           094433
     C                     ADD  CPMACI    TINTC0                          094433
     C                     END                                            094433
     C                     ELSE                                           094433
     C           WCAID     ADD  INTC0     TINTC0                          094433
     C           @CPTDY    IFEQ 'Y'                                       094433
     C                     ADD  CPMACI    TINTC0                          094433
     C                     ELSE                                           094433
     C                     ADD  CTMACI    TINTC0                          094433
     C                     END                                            094433
     C                     END                                            094433
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********TINTC0    IFLT 0                                   077129086254
     C***********          Z-SUBTINTC0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          ELSE                                     077129086254
     C***********          MOVE TINTC0    ZFIELD                          086254
     C***********          END                                      077129086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTC0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT TOTAL INTEREST
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C** PREPARE TOTAL CHARGES
     C*
     C           CHGT      IFGT 0                          - B1
     C           CCHGP     ORGT 0
     C           TOTCH     IFGT 0
     C                     MOVELNAR,25    NARR
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE TOTCH     ZFIELD                          086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTOTCH     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     MOVELAREA      SDAT3
     C                     EXSR SUBW2
     C                     EXSR SUBW3
     C                     END                             - E1
     C                     END                             - E1
     C********************************************************************088737
     C****PREPARE*To*be*posted********************************************088737
     C********************************************************************088737
     C***********CCAIC     IFNE *ZERO                                     088737
     C***********          MOVELNAR,28    NARR                            088737
     C***********CDAIC     IFLT *ZERO                                     088737
     C***********          Z-SUBCCAIC     TINTC0                          088737
     C***********          MOVE '-'       WSIG                            088737
     C***********          ELSE                                           088737
     C***********          Z-ADDCCAIC     TINTC0                          088737
     C***********          END                                            088737
     C********************************************************************088737
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********TINTC0    IFLT 0                                   077129086254
     C***********          Z-SUBTINTC0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          ELSE                                     077129086254
     C***********          MOVE TINTC0    ZFIELD                          086254
     C***********          END                                      077129086254
      **************************************************************086254088737
      **edit*amount*with*minus*sign*********************************086254088737
     C***********          Z-ADDDECI1     ZADIG                           088737
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C***********          Z-ADDTINTC0    WKINT            set SR pa086254088737
     C***********          EXSR EDTINT                     editIntrs086254088737
     C********************************************************************088737
     C****OUTPUT*TOTAL*to*be*posted***************************************088737
     C********************************************************************088737
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR                     formatARE086093088737
     C***********          MOVELAREA      SDAT2                           088737
     C***********          EXSR SUBW2                                     088737
     C********************************************************************088737
     C***********          END                                            088737
     C                     MOVE ' '       WSIG
     C*
     C**  PREPARE TOTAL CREDITED OUTPUT
     C*
     C                     MOVELNAR,10    NARR
     C*                                                                   094433
     C* Total posted CR capitalisation only.                              094433
     C*                                                                   094433
     C           *IN51     IFEQ '0'                                       094433
     C           CCRIP     ADD  CCRIS     TINTC0
     C********** TINTC0    ADD  TOTCH     TINTC0                          104489
     C                     ADD  CPMACI    TINTC0                          094433
     C                     ELSE                                           094433
     C           @CPTDY    IFEQ 'Y'                                       094433
     C           SCRIP     ADD  SCRIS     TINTC0                          094433
     C                     ADD  CPMACI    TINTC0                          094433
     C                     ELSE                                           094433
     C           CCRIS     ADD  CCRIP     TINTC0                          094433
     C                     ADD  CPMACI    TINTC0                          094433
     C                     END                                            094433
     C                     END                                            094433
      *                                                                   104489
      * Subtract posted non-rebatable & rebatable charges.                104489
     C**********           SUB  CPHGAN    TINTC0                                       104489 249907
     C**********           SUB  CPHGAR    TINTC0                                       104489 249907
     C           @CPTDY    IFEQ 'Y'                                                           249907
     C                     SUB  CTHGAN    TINTC0                                              249907
     C                     SUB  CTHGAR    TINTC0                                              249907
     C                     ENDIF                                                              249907
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********TINTC0    IFLT 0                                   077129086254
     C***********          Z-SUBTINTC0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          ELSE                                     077129086254
     C***********          MOVE TINTC0    ZFIELD                          086254
     C***********          END                                      077129086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTC0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT TOTAL CREDITED
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*                                                                   088737
     C**  PREPARE TOTAL TO BE POSTED                                      088737
     C*                                                                   088737
     C                     MOVELNAR,28    NARR                            088737
     C                     Z-ADDCCAIC     TINTC0                          094433
     C***********          ADD  CPMACI    CCAIC                     094431094433
     C***********          ADD  CTMACI    CCAIC                     094431094433
     C***********CCAIC     IFLT *ZERO                               088737094433
     C***********          Z-SUBCCAIC     TINTC0                    088737094433
     C***********          MOVE '-'       WSIG                      088737094433
     C***********          ELSE                                     088737094433
     C***********          Z-ADDCCAIC     TINTC0                    088737094433
     C***********          END                                      088737094433
     C*                                                                   094433
     C* Total to be posted CR capitalisation only.                        094433
     C*                                                                   094433
     C           *IN51     IFEQ '0'                                       094433
     C           SCICI     IFEQ ' '                                       094433
     C                     ADD  CTMACI    TINTC0                          094433
     C                     END                                            094433
     C                     ELSE                                           094433
     C                     ADD  CTMACI    TINTC0                          094433
     C                     END                                            094433
      *                                                                   104489
      * Subtract outstanding non-rebatable & rebatable charges.           104489
     C           CHGT      IFGT 0                                         104489
     C                     SUB  CTHGAN    TINTC0                          104489
     C                     SUB  CTHGAR    TINTC0                          104489
     C                     END                                            104489
      *                                                                   088737
      * edit amount with minus sign                                       088737
     C                     Z-ADDDECI1     ZADIG                           088737
     C                     Z-ADDTINTC0    WKINT                           088737
     C                     EXSR EDTINT                                    088737
     C*                                                                   088737
     C**  OUTPUT TOTAL TO BE POSTED                                       088737
     C*                                                                   088737
     C                     EXSR OUT2SR                                    088737
     C                     MOVELAREA      SDAT2                           088737
     C                     EXSR SUBW2                                     088737
     C/COPY WNCPYSRC,RE3364EC03
     C           CER050    IFEQ 'Y'                                                           CER050
     C                     EXSR SRCRAP                                                        CER050
     C                     ENDIF                                                              CER050
     C*
     C           WTYP      IFEQ 'P'                                       086230
     C                     Z-ADD1         RECN2                           086230
     C***********          Z-ADD1         RECN2                           075071
     C***********          Z-ADD1         RECN3                           075071
     C                     Z-ADD1         RECN3                           086230
     C                     ENDIF                                          086230
      *                                                                   113955
     C                     END                                            113955
     C*
     C                     ENDSR                           **CRSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RATEC subroutine for crdeit output processing
     C**
     C**     Called by     CRSR, RATESR
     C**
     C**     Calls         ZDATE2, DBSR, RCRSR
     C**
     C           RATEC     BEGSR                           **RATEC BEGSR**
     C*
     C**  ACCESS REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR CREDIT RATE CHANGE TO
     C*
     C***********KLIST6    SETLLREHRCJ                   60               075071
     C*
     C***********KLIST6    READEREHRCJ                   62               075071
     C           KLIST6    CHAINREHRCJ               62                   075071
     C           *IN62     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE RVALD                      - B1
     C                     Z-ADDRVALD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD015       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVE RVALD     DBKEY            * DB ERROR 015*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDRVALD     PVALD
     C                     MOVELZDATE     PVALDO
     C*
     C                     END                             - E1
     C                     MOVELPVALDO    VALDA
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PPSTD     IFNE RPSTD                      - B1
     C                     Z-ADDRPSTD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD016       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVE RPSTD     DBKEY            * DB ERROR 016*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDRPSTD     PPSTD
     C                     MOVELZDATE     PPSTDO
     C*
     C                     END                             - E1
     C*
     C**  PREPARE DEBIT RATE CHANGE TO OUTPUT
     C*
     C                     MOVELPPSTDO    PSTDA
     C*
     C           *IN22     IFEQ '0'                                       075079
     C                     MOVELNAR,8     NARR                            075079
     C                     ELSE                                           075079
     C                     MOVELNAR,9     NARR
     C                     END                                            075079
     C*
     C**  OUTPUT DEBIT RATE CHANGE TO
     C*
     C                     EXSR RCRSR
     C*
     C                     ENDSR                           **RATEC ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RCRSR subroutine for rate output processing
     C**
     C**     Called by     CRSR, RATEC, B1EQ, B1LT, B1GT, OPENCR
     C**
     C**     Calls         ZEDIT, SUBW2
     C**
     C           RCRSR     BEGSR                           **RCRSR BEGSR**
      *                                                                   099509
     C           *IN22     IFEQ '0'                                       099509
     C                     MOVELNAR,8     NARR                            099509
     C                     ELSE                                           099509
     C                     MOVELNAR,9     NARR                            099509
     C                     ENDIF                                          099509
     C*
     C***********DCICT     IFEQ *ZEROS                     - B1           075196
     C           RINTP     IFEQ *ZEROS                     - B1           075196
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INRT      ZFIELD                          086254
      *                                                                   086254
      * edit Percentage rate with brackets & percent sign                 086254
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    RATO                            086254
     C                     Z-ADDINRT      WKRAT            set SR parm    086254
     C                     EXSR EDTPER                     editIntrstWith%086254
      *                                                                   086254
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C**  OUTPUT RATE CHANGE
     C*
     C***********          MOVE '1'       *IN87                           086093
     C***********          EXCPTOUT1                                      086093
     C                     EXSR OUT1SR                     formatAREAType1086093
     C                     MOVE '1'       *IN22                           075079
     C***********          MOVE '0'       *IN87                           086093
     C***********          READ GHOST                    99               086093
     C                     MOVELAREA      SDAT2
     C/COPY WNCPYSRC,RE3364EC13
     C                     EXSR SUBW2
     C*
     C                     ELSE                            - X1
     C*
     C           RINST     IFEQ 0                          - B2           075079
     C*                                                                   075079
     C* If Type/Subtype have been previously used, display as zero rate   075079
     C* rather than 0x 00000 for this report.                             075079
     C*                                                                   075079
     C***********          Z-ADD0         ZRATE  117                075079086254
     C***********          MOVE ZRATE     ZFIELD                    075079086254
     C*                                                                   075079
     C***********          Z-ADDDECI2     ZADIG                     075079086254
     C***********          Z-ADD7         ZADEC                     075079086254
     C***********          EXSR ZEDIT                               075079086254
     C***********          MOVE ZFIELD    RATO                      075079086254
     C*                                                                   075079
      * output 0% Percentage rate (using constant)                        086254
     C                     MOVELZRCTCN    RATOMP    P      '0.0000000%'   086254
     C*                                                                   075079
     C***********          MOVE '1'       *IN87                     075079086093
     C***********          EXCPTOUT1                                075079086093
     C                     EXSR OUT1SR                     formatAREAType1086093
     C                     MOVE '1'       *IN22                           075079
     C***********          MOVE '0'       *IN87                     075079086093
     C***********          READ GHOST                    99         075079086093
     C                     MOVELAREA      SDAT2                           075079
     C/COPY WNCPYSRC,RE3364EC14
     C                     EXSR SUBW2                                     075079
     C*                                                                   075079
     C                     ELSE                            - X2           075079
     C*
     C                     MOVE '1'       *IN25
     C           *IN22     IFEQ '0'                        - B3           075079
     C                     MOVELNAR,8     NARR                            075079
     C                     ELSE                            - X3           075079
     C***********          MOVELNAR,12    NARR                            075079
     C                     MOVELNAR,9     NARR                            075079
     C                     END                             _ E3           075079
     C*                                                                   075079
     C*********************MOVE DCICT     TYPE                            075196
     C                     MOVE RINTP     TYPE                            075196
     C***********          MOVE CCST      SBTP                            074595
     C                     MOVE RINST     SBTP                            074595
     C                     MOVELTPSBT     TPST
     C*
     C***********          EXCPTOUT9                                      086093
     C                     MOVE '1'       *IN22                           075079
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT9SR                     formatAREAType1086093
     C                     MOVE '0'       *IN25
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C           INTH      IFGT *ZEROS                     - B3
     C                     Z-ADDINTH      HISB0
     C*****************    MOVELNAR,13    NARR                            101473
     C                     MOVELNAR,14    NARR                            101473
     C                     ELSE                            - X3
     C                     Z-SUBINTH      HISB0
     C*****************    MOVELNAR,14    NARR                            101473
     C                     MOVELNAR,13    NARR                            101473
     C                     END                             - E3
     C*
     C           HISB0     IFLT 0                          - B3
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E3
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C* CLEAR ARRAYS                                                      045322
     C                     MOVEA*BLANKS   ARR                             045322
     C                     MOVEA*BLANKS   NEG                             077129
     C                     MOVEA*BLANKS   ARB                             045322
     C*                                                                   045322
     C***********RAT21     IFNE *ZEROS                     - B3           077980
     C***********BAL21     ORNE *ZEROS                                    077980
     C           RAT21     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT21     ORAT1                           077129
     C                     MOVE '-'       NEG,1                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT21     ORAT1
     C                     END                                            077129
     C                     Z-ADDBAL21     OBAL01
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT1     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,1
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL01    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,1
     C***********RAT22     IFNE *ZEROS                     - B4           086560
     C***********BAL22     ORNE *ZEROS                                    078272
     C***********BAL22     ANDNE*ZEROS                              078272086560
     C           BAL22     IFNE *ZEROS                                    086560
     C           RAT22     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT22     ORAT2                           077129
     C                     MOVE '-'       NEG,2                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT22     ORAT2
     C                     END                                            077129
     C                     Z-ADDBAL22     OBAL02
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT2     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,2
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL02    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,2
     C***********RAT23     IFNE *ZEROS                     - B5           086560
     C***********BAL23     ORNE *ZEROS                                    078272
     C***********BAL23     ANDNE*ZEROS                              078272086560
     C           BAL23     IFNE *ZEROS                                    086560
     C           RAT23     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT23     ORAT3                           077129
     C                     MOVE '-'       NEG,3                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT23     ORAT3
     C                     END                                            077129
     C                     Z-ADDBAL23     OBAL03
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT3     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,3
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL03    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,3
     C                     ELSE                            - X5
     C                     Z-ADD*ZEROS    ORAT3
     C                     Z-ADD*ZEROS    OBAL03
     C                     MOVE *BLANKS   ARR,3
     C                     MOVE *BLANKS   ARB,3
     C                     END                             - E5
     C                     ELSE                            - X4
     C                     Z-ADD*ZEROS    ORAT2
     C                     Z-ADD*ZEROS    OBAL02
     C                     MOVE *BLANKS   ARR,2
     C                     MOVE *BLANKS   ARB,2
     C                     END                             - E4
     C***********          END                             - E3           077980
     C*
     C***********RAT24     IFNE *ZEROS                     - B3           086560
     C***********BAL24     ORNE *ZEROS                                    078272
     C***********BAL24     ANDNE*ZEROS                              078272086560
     C           BAL24     IFNE *ZEROS                                    086560
     C           RAT24     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT24     ORAT1                           077129
     C                     MOVE '-'       NEG,4                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT24     ORAT1
     C                     END                                            077129
     C                     Z-ADDBAL24     OBAL01
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT1     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,4
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL01    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,4
     C***********RAT25     IFNE *ZEROS                     - B4           086560
     C***********BAL25     ORNE *ZEROS                                    078272
     C***********BAL25     ANDNE*ZEROS                              078272086560
     C           BAL25     IFNE *ZEROS                                    086560
     C           RAT25     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT25     ORAT2                           077129
     C                     MOVE '-'       NEG,5                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT25     ORAT2
     C                     END                                            077129
     C                     Z-ADDBAL25     OBAL02
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT2     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,5
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL02    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,5
     C***********RAT26     IFNE *ZEROS                     - B5           086560
     C***********BAL26     ORNE *ZEROS                                    078272
     C***********BAL26     ANDNE*ZEROS                              078272086560
     C           BAL26     IFNE *ZEROS                                    086560
     C           RAT26     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT26     ORAT3                           077129
     C                     MOVE '-'       NEG,6                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT26     ORAT3
     C                     END                                            077129
     C                     Z-ADDBAL26     OBAL03
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT3     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,6
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL03    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,6
     C                     ELSE                            - X5
     C                     Z-ADD*ZEROS    ORAT3
     C                     Z-ADD*ZEROS    OBAL03
     C                     MOVE *BLANKS   ARR,6
     C                     MOVE *BLANKS   ARB,6
     C                     END                             - E5
     C                     ELSE                            - X4
     C                     Z-ADD*ZEROS    ORAT2
     C                     Z-ADD*ZEROS    OBAL02
     C                     MOVE *BLANKS   ARR,5
     C                     MOVE *BLANKS   ARB,5
     C                     END                             - E4
     C*
     C* IF RAT3 AND BAL3 ARE BLANK SET ELEMENTS TO ZERO AS                086559
     C* MEANS NO RECORD ON REHPOSR3                                       086559
     C*                                                                   086559
     C           RAT3      IFEQ *BLANKS                                   086559
     C                     Z-ADD0         RAT31                           086559
     C                     Z-ADD0         RAT32                           086559
     C                     Z-ADD0         RAT33                           086559
     C                     Z-ADD0         RAT34                           086559
     C                     Z-ADD0         RAT35                           086559
     C                     Z-ADD0         RAT36                           086559
     C                     END                                            086559
     C*                                                                   086559
     C           BAL3      IFEQ *BLANKS                                   086559
     C                     Z-ADD0         BAL31                           086559
     C                     Z-ADD0         BAL32                           086559
     C                     Z-ADD0         BAL33                           086559
     C                     Z-ADD0         BAL34                           086559
     C                     Z-ADD0         BAL35                           086559
     C                     Z-ADD0         BAL36                           086559
     C                     END                                            086559
     C*                                                                   086559
     C***********RAT31     IFNE *ZEROS                     - B4           086560
     C***********BAL31     ORNE *ZEROS                                    078272
     C***********BAL31     ANDNE*ZEROS                              078272086560
     C           BAL31     IFNE *ZEROS                                    086560
     C           RAT31     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT31     ORAT1                           077129
     C                     MOVE '-'       NEG,7                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT31     ORAT1
     C                     END                                            077129
     C                     Z-ADDBAL31     OBAL01
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT1     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,7
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL01    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,7
     C***********RAT32     IFNE *ZEROS                     - B5           086560
     C***********BAL32     ORNE *ZEROS                                    078272
     C***********BAL32     ANDNE*ZEROS                              078272086560
     C           BAL32     IFNE *ZEROS                                    086560
     C           RAT32     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT32     ORAT2                           077129
     C                     MOVE '-'       NEG,8                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT32     ORAT2
     C                     END                                            077129
     C                     Z-ADDBAL32     OBAL02
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT2     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,8
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL02    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,8
     C***********RAT33     IFNE *ZEROS                     - B6           086560
     C***********BAL33     ORNE *ZEROS                                    078272
     C***********BAL33     ANDNE*ZEROS                              078272086560
     C           BAL33     IFNE *ZEROS                                    086560
     C           RAT33     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT33     ORAT3                           077129
     C                     MOVE '-'       NEG,9                           077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT33     ORAT3
     C                     END                                            077129
     C                     Z-ADDBAL33     OBAL03
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT3     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,9
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL03    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,9
     C                     ELSE                            - X6
     C                     Z-ADD*ZEROS    ORAT3
     C                     Z-ADD*ZEROS    OBAL03
     C                     MOVE *BLANKS   ARR,9
     C                     MOVE *BLANKS   ARB,9
     C                     END                             - E6
     C                     ELSE                            - X5
     C                     Z-ADD*ZEROS    ORAT2
     C                     Z-ADD*ZEROS    OBAL02
     C                     MOVE *BLANKS   ARR,8
     C                     MOVE *BLANKS   ARB,8
     C                     END                             - E5
     C*
     C***********RAT34     IFNE *ZEROS                     - B5           086560
     C***********BAL34     ORNE *ZEROS                                    078272
     C***********BAL34     ANDNE*ZEROS                              078272086560
     C           BAL34     IFNE *ZEROS                                    086560
     C           RAT34     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT34     ORAT1                           077129
     C                     MOVE '-'       NEG,10                          077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT34     ORAT1
     C                     END                                            077129
     C                     Z-ADDBAL34     OBAL01
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT1     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,10
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL01    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,10
     C***********RAT35     IFNE *ZEROS                     - B6           086560
     C***********BAL35     ORNE *ZEROS                                    078272
     C***********BAL35     ANDNE*ZEROS                              078272086560
     C           BAL35     IFNE *ZEROS                                    086560
     C           RAT35     IFLT *ZEROS                                    077129
     C                     Z-SUBRAT35     ORAT2                           077129
     C                     MOVE '-'       NEG,11                          077129
     C                     ELSE                                           077129
     C                     Z-ADDRAT35     ORAT2
     C                     END                                            077129
     C                     Z-ADDBAL35     OBAL02
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ORAT2     ZFIELD
     C                     Z-ADDDECI2     ZADIG
     C                     Z-ADD7         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARR,11
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE OBAL02    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     Z-ADDSAVEZ     ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ARB,11
     C*                                                                   075082
     C** Note: RAT36 and BAL36 are surplus to requirements.               075082
     C*                                                                   075082
     C***********RAT36     IFNE *ZEROS                     - B7           075082
     C***********BAL36     ORNE *ZEROS                                    075082
     C***********          Z-ADDRAT36     ORAT3                           075082
     C***********          Z-ADDBAL36     OBAL03                          075082
     C***********          MOVE *BLANKS   ZFIELD                          075082
     C***********          MOVE ORAT3     ZFIELD                          075082
     C***********          Z-ADDDECI2     ZADIG                           075082
     C***********          Z-ADD7         ZADEC                           075082
     C***********          EXSR ZEDIT                                     075082
     C***********          MOVE ZFIELD    ARR,12                          075082
     C***********          MOVE *BLANKS   ZFIELD                          075082
     C***********          MOVE OBAL03    ZFIELD                          075082
     C***********          Z-ADDDECI1     ZADIG                           075082
     C***********          Z-ADDSAVEZ     ZADEC                           075082
     C***********          EXSR ZEDIT                                     075082
     C***********          MOVE ZFIELD    ARB,12                          075082
     C***********          ELSE                            - X7           075082
     C                     Z-ADD*ZEROS    ORAT3
     C                     Z-ADD*ZEROS    OBAL03
     C                     MOVE *BLANKS   ARR,12
     C                     MOVE *BLANKS   ARB,12
     C***********          END                             - E7           075082
     C                     ELSE                            - X6
     C                     Z-ADD*ZEROS    ORAT2
     C                     Z-ADD*ZEROS    OBAL02
     C                     MOVE *BLANKS   ARR,11
     C                     MOVE *BLANKS   ARB,11
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     Z-ADD1         Y       20
     C           Y         DOWLE12                         - B3
     C           ARB,Y     IFNE *BLANKS                    - B4
     C           ARR,Y     ORNE *BLANKS
     C***********          MOVE ARB,Y     ZN1    16                       086093
     C***********          MOVE ARR,Y     ZN2    16                       086093
     C***********          MOVE NEG,Y     ZN3     1                 077129086093
     C*
     C***********          EXCPTOUT4                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT4SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C/COPY WNCPYSRC,RE3364EC15
     C                     EXSR SUBW2
     C                     ADD  1         Y
     C                     ELSE
     C                     Z-ADD13        Y
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     END                             - E2           075079
     C*                                                                   075079
     C                     END                             - E1
     C*
     C                     ENDSR                           **RCRSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** BOTHSR subroutine for debit and credit output processing
     C**        (to fill both subfiles 1, 2 and 3 - debit & credit)
     C**
     C**     Called by     MAIN
     C**
     C**     Calls         DBSR, BFOPSR, SUBW1, SUBW2, LINE1, LINE2,
     C**                   SUBW3, ZEDIT, B1EQ, B1LT, B1GT, ZDATE2,
     C**                   POSTSR, RATESR, ZICD, #MADI, #MACI
     C**
     C           BOTHSR    BEGSR                           **BOTHSR BEGSR*
     C*
     C***********          MOVE '00'      *IN21                     075079099509
     C***********          Z-ADD0         SAVED   50                077684088746
     C*                                                                   075079
     C           KLIST2    SETLLREHISL               52
     C           KLIST1    READEREHISL                   52
     C*
     C***********DRECI     DOWEQ'M'                                       086230
     C************IN52     ANDEQ'0'                                       086230
     C***********KLIST1    READEREHISL                   52               086230
     C***********          ENDDO                                          086230
     C           DRECI     DOWEQ'M'                                                          BUG9057
     C           *IN52     ANDEQ'0'                                                          BUG9057
     C           KLIST1    READEREHISL                   52                                  BUG9057
     C                     ENDDO                                                             BUG9057
     C*
     C           *IN52     IFEQ '1'                        - B1
     C           DRECI     ORNE 'B'                                       086230
     C           DRECI     ANDNE'S'                                       086230
     C***********          Z-ADDCLDID     SAVED                     077684088746
     C           CLDID     SUB  1         CLDID                           077684
     C           KLIST2    SETLLREHISL               52                   077684
     C           KLIST1    READEREHISL                   52               077684
     C           *IN52     IFEQ '1'                        - B2           077684
     C                     Z-ADDCLDID     WDATE
     C           *LOCK     IN   LDA
     C                     Z-ADD017       DBASE
     C                     MOVE 'REHISL'  DBFILE
     C                     MOVELCKEY      RKEY             ***************
     C                     MOVELRKEY2     DBKEY            * DB ERROR 017*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2           077684
     C                     END                             - E1
     C*
     C                     Z-ADD*ZERO     WWDADJ 130
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADDDHISD     CLDID
     C                     Z-ADDDDAID     WWDADJ
     C                     Z-ADDDHISB     WWHISB
     C                     Z-ADDDHISB     WHISBD
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDDODRL     WODRL                           CRE001
     C                     ENDIF                                          CRE001
     C                     EXSR BFOPSR
     C                     Z-ADDWWHISB    W1STBL
     C                     Z-ADDWWHISB    W1HISB
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     W1STBL
     C                     Z-ADDSHISB     W1HISB
     C                     Z-ADDSHISB     WHISBD
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSODRL     WODRL                           CRE001
     C                     ENDIF                                          CRE001
     C                     ELSE                            - X2
     C                     Z-ADDCLDID     WDATE
     C           *LOCK     IN   LDA
     C                     Z-ADD018       DBASE
     C                     MOVE 'REHISL'  DBFILE
     C                     MOVELCKEY      RKEY             ***************
     C                     MOVELRKEY2     DBKEY            * DB ERROR 018*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     END                             - E1
     C*
     C***********SAVED     IFNE 0                                   077684088746
     C***********          Z-ADDSAVED     CLDID                     077684088746
     C***********          Z-ADD0         SAVED                     077684088746
     C***********          END                                      077684088746
     C                     Z-ADDCLDID     WHISDD
     C*
     C***********KLIST3    SETLLREHISL               52                   086254
     C           KLIST3    SETLLREHISL                                    086254
     C*
     C           KLIST1    READEREHISL                   52
     C*
     C***********DRECI     DOWEQ'M'                                       086230
     C************IN52     ANDEQ'0'                                       086230
     C***********KLIST1    READEREHISL                   52               086230
     C***********          ENDDO                                          086230
     C           DRECI     DOWEQ'M'                                                          BUG9057
     C           *IN52     ANDEQ'0'                                                          BUG9057
     C           KLIST1    READEREHISL                   52                                  BUG9057
     C                     ENDDO                                                             BUG9057
     C*
     C           *IN52     IFEQ '1'                        - B1
     C           DRECI     ORNE 'B'                                       086230
     C           DRECI     ANDNE'S'                                       086230
     C***********          Z-ADDCLDID     SAVED                     077684088746
     C           CLCID     SUB  1         CLCID                           077684
     C***********KLIST3    SETLLREHISL               52             077684086254
     C           KLIST3    SETLLREHISL                                    086254
     C           KLIST1    READEREHISL                   52               077684
     C           *IN52     IFEQ '1'                        - B2           077684
     C                     Z-ADDCLCID     WDATE
     C           *LOCK     IN   LDA
     C                     Z-ADD019       DBASE
     C                     MOVE 'REHISL'  DBFILE
     C                     MOVELCKEY      RKEY             ***************
     C                     MOVELRKEY2     DBKEY            * DB ERROR 019*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2           077684
     C                     END                             - E1
     C*
     C***********DRECI     DOWEQ'M'                                       086230
     C************IN52     ANDEQ'0'                                       086230
     C***********KLIST1    READEREHISL                   52               086230
     C***********          ENDDO                                          086230
     C           DRECI     DOWEQ'M'                                                          BUG9057
     C           *IN52     ANDEQ'0'                                                          BUG9057
     C           KLIST1    READEREHISL                   52                                  BUG9057
     C                     ENDDO                                                             BUG9057
     C*
     C                     Z-ADD*ZERO     WWCADJ 130
     C*
     C           DRECI     IFEQ 'B'                        - B1
     C                     Z-ADDDHISD     CLCID
     C                     Z-ADDDCAID     WWCADJ
     C                     Z-ADDDHISB     WWHISB
     C                     Z-ADDDHISB     WHISBC
     C                     EXSR BFOPSR
     C                     Z-ADDWWHISB    W2STBL
     C                     Z-ADDWWHISB    W2HISB
     C                     ELSE                            - X1
     C           DRECI     IFEQ 'S'                        - B2
     C                     Z-ADDSSTBL     W2STBL
     C                     Z-ADDSHISB     W2HISB
     C                     Z-ADDSHISB     WHISBC
     C                     ELSE                            - X2
     C                     Z-ADDCLCID     WDATE
     C           *LOCK     IN   LDA
     C                     Z-ADD020       DBASE
     C                     MOVE 'REHISL'  DBFILE
     C                     MOVELCKEY      RKEY             ***************
     C                     MOVELRKEY2     DBKEY            * DB ERROR 020*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C                     END                             - E1
     C*
     C***********SAVED     IFNE 0                                   077684088746
     C***********          Z-ADDSAVED     CLCID                     077684088746
     C***********          Z-ADD0         SAVED                     077684088746
     C***********          END                                      077684088746
     C                     Z-ADDCLCID     WHISDC
     C*
     C           CLDID     IFLT CLCID                      - B1
     C           KLIST2    SETLLREHISL
     C           KLIST1    READEREHISL                   52
     C                     END                             - E1
     C*
     C                     MOVEA'11'      *IN,85
     C                     MOVELNAR,15    SDAT1
     C                     MOVELNAR,17    SDAT2
     C                     EXSR SUBW1
     C                     EXSR SUBW2
     C                     MOVEA'00'      *IN,85
     C*
     C           WTYP      IFNE 'P'
     C*
     C** ADD BLANK LINE
     C*
     C                     EXSR LINE1
     C                     EXSR LINE2
     C*
     C           BMCBAI    IFEQ 'Y'                                       CRE003
     C                     MOVELNAR,16    SDAT1
     C                     MOVELNAR,16    SDAT2
     C                     ELSE                                           CRE003
     C                     MOVELNAR,37    SDAT1                           CRE003
     C                     MOVELNAR,37    SDAT2                           CRE003
     C                     END                                            CRE003
     C                     EXSR SUBW1
     C                     EXSR SUBW2
     C           CHGT      IFGT *ZERO
     C           CCHGP     ORGT *ZERO
     C           BMCBAI    IFEQ 'Y'                                       CRE003
     C                     MOVELNAR,22    SDAT3
     C                     ELSE                                           CRE003
     C                     MOVELNAR,38    SDAT3                           CRE003
     C                     END                                            CRE003
     C                     EXSR SUBW3
     C                     END
     C*
     C           CER016    IFEQ 'Y'                                                         BUG22235
     C           DRIC      ANDEQ*ZERO                                                       BUG22235
     C                     Z-ADD8         J                                                 BUG22235
     C                     ELSE                                                             BUG22235
     C                     Z-ADDDRIC      J
     C                     ENDIF                                                            BUG22235
     C                     MOVEL*BLANKS   SDAT1
     C                     MOVE CAC,J     SDAT1
     C/COPY WNCPYSRC,RE3364EC16
     C                     EXSR SUBW1
     C           CER016    IFEQ 'Y'                                                         BUG22235
     C           CRIC      ANDEQ*ZERO                                                       BUG22235
     C                     Z-ADD8         J                                                 BUG22235
     C                     ELSE                                                             BUG22235
     C                     Z-ADDCRIC      J
     C                     ENDIF                                                            BUG22235
     C                     MOVEL*BLANKS   SDAT2
     C                     MOVE CAC,J     SDAT2
     C/COPY WNCPYSRC,RE3364EC17
     C                     EXSR SUBW2
     C                     MOVE *BLANK    SDAT3
     C                     EXSR SUBW3
     C*
     C                     MOVE '1'       *IN85
     C                     EXSR LINE1
     C                     EXSR LINE2
     C                     EXSR SUBW3
     C                     MOVE '0'       *IN85
     C*
     C                     END
     C                     MOVE '1'       *IN86
     C*
     C                     MOVE *BLANKS   VALDA
     C*
     C                     MOVELNAR,1     NARR
     C*
     C                     Z-ADDW1STBL    HISB0
     C*
     C**  B/F BALANCE DEBIT OUTPUT
     C*
     C** TEST              WRITETITLEDR
     C*
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C           WWDADJ    IFNE *ZERO
     C           WWDADJ    IFLT 0                          - B1
     C           WWDADJ    MULT SUBT      WWDADJ
     C                     MOVE 'CR'      CR
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE WWDADJ    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVELNAR,30    NARR
     C*
     C**  OUTPUT INTEREST OF PREVIOUS DATE
     C*
     C                     MOVE '1'       *IN86
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVELNAR,1     NARR
     C*
     C                     Z-ADDW2STBL    HISB0
     C                     MOVE *BLANKS   CR
     C*
     C**  B/F BALANCE CREDIT OUTPUT
     C*
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     MOVE *BLANKS   CR
     C           WWCADJ    IFNE *ZERO
     C           WWCADJ    IFLT 0                          - B1
     C           WWCADJ    MULT SUBT      WWCADJ
     C                     MOVE 'CR'      CR
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE WWCADJ    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVELNAR,30    NARR
     C*
     C**  OUTPUT INTEREST OF PREVIOUS DATE
     C*
     C                     MOVE '1'       *IN86
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END
     C*
     C**  PROCESS BACK VALUE AND OPENING
     C*
     C                     Z-ADDCLDID     WWDATD                          094431
     C                     Z-ADDCLCID     WWDATC                          094431
     C           CLDID     CASEQCLCID     B1EQ
     C           CLDID     CASLTCLCID     B1LT
     C           CLDID     CASGTCLCID     B1GT
     C                     CAS            DBSR
     C                     END
     C*
     C                     MOVEA'10'      *IN,85
     C                     EXSR LINE1
     C                     EXSR LINE2
     C                     MOVEA'01'      *IN,85
     C*
     C** DISPLAY MANUAL ADJUSTMENTS FOR THE LAST CAPITALISATION DATE      094431
     C           CLDID     IFNE SVDATD                                    099511
     C           CLCID     ORNE SVDATC                                    099511
      *                                                                   099511
     C           *LIKE     DEFN WWDATD    SVDATD                          099511
     C           *LIKE     DEFN WWDATC    SVDATC                          099511
     C                     Z-ADDWWDATD    SVDATD                          099511
     C                     Z-ADDWWDATC    SVDATC                          099511
      *                                                                   099511
     C           WWDATD    IFEQ WWDATC                                    094431
     C                     EXSR MANUEQ                                    094431
     C                     ELSE                                           094431
     C                     EXSR MANUDR                                    094431
     C                     EXSR MANUCR                                    094431
     C                     END                                            094431
     C                     ENDIF                                          099511
      *                                                                   103860
     C                     MOVE *BLANK    ADJFLG                          103860
     C*                                                                   094431
     C           DRECI     IFEQ 'S'                        - B1
      *                                                                   103860
      **  Process generated adjustment for start date.                    103860
     C           SGADI     IFNE 0                                         103860
     C           SGACI     ORNE 0                                         103860
     C                     Z-ADDDHISD     AHISD                           103860
     C                     Z-ADDSDAIC     ADAIC                           103860
     C                     Z-ADDSCAIC     ACAIC                           103860
     C                     MOVE SDCI      ASDCI                           103860
     C                     MOVE SCCI      ASCCI                           103860
     C           DHISD     IFEQ CLDID                                     103860
     C                     MOVE '1'       *IN41                           103860
     C                     END                                            103860
     C           DHISD     IFEQ CLCID                                     103860
     C                     MOVE '1'       *IN42                           103860
     C                     END                                            103860
     C                     EXSR #ADJ                                      103860
     C                     SETOF                     4142                 103860
     C                     END                                            103860
      *                                                                   103860
     C           KLIST1    READEREHISL                   51
      *----------------------------------------------------               094431
     C*                                                                   094431
     C**  OUTPUT SUBTOTAL LINE                                            094431
     C*                                                                   094431
     C*                                                                   094431
     C**  CHECK INTEREST TYPE                                             094431
     C*                                                                   094431
     C           CDICT     IFLT 3                          - B3           094431
     C           CCICT     ANDLT3                                         094431
     C*                                                                   094431
     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH LESS THAN 3           094431
     C*                                                                   094431
     C           DDRCI     IFEQ 'Y'                        - B4           094431
     C           DDMVT     ORNE *ZEROS                                    094431
     C           DCMVT     ORNE *ZEROS                                    094431
     C           DMADI     ORNE *ZEROS                                    094431
     C           DRECI     OREQ 'D'                                       103860
     C           ADJFLG    ANDEQ'Y'                                       103860
     C           DRECI     OREQ 'S'                                       103860
     C           SGACI     ANDNE*ZEROS                                    103860
     C           DHISD     IFGE CLDID                                     094431
     C           DHISD     ANDLTCHISD                                     094431
     C*                                                                   094431
     C**  PROCESS WHEN CHANGE RATE DEBIT                                  094431
     C*                                                                   094431
     C***********          Z-ADDWDRCB     ZICALC                   094431 103860
     C           DRECI     IFEQ 'S'                                       103860
     C                     Z-ADDSDRCB     ZICALC                          103860
     C                     ELSE                                           103860
     C                     Z-ADDDDRCB     ZICALC                          103860
     C                     END                                            103860
     C                     Z-ADDWHISDD    ZIBEG                           094431
     C                     Z-ADDDHISD     ZIEND                           094431
     C*                                                                   094431
     C                     EXSR ZICD                                      094431
     C*                                                                   094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                                                MQ1590
     C                     Z-ADDZDAYN2    DAYD                                                MQ1590
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C********** ZDAYN2    IFNE *ZEROS                                                 103860 MQ1590
     C           DAYS      IFGT *ZERO                                                         MQ1590
      *                                                                   103860
     C**********           Z-ADDZDAYN2    DAYS                                         094431 MQ1590
     C**********           Z-ADDZDAYN2    DAYD                                         094431 MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C**                                                                  094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C                     Z-ADDWHISBD    HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
      *                                                                   103860
     C           DRECI     IFEQ 'S'                                       103860
     C           SDAIC     SUB  WDAID     INTD0                           103860
     C                     ELSE                                           103860
     C           DDAID     SUB  WDAID     INTD0                           094431
     C                     END                                            103860
     C*                                                                   094431
     C***********DAYS      IFNE *ZEROS                     - B5    094431 103860
     C**                                                                  094431
     C           NUMB0     IFLT *ZEROS                                    094431
     C******************   SUB  NUMB0     TOTNC                     094431101770
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     ELSE                                           101770
     C                     ADD  NUMB0     TOTND                           101770
     C                     END                                            094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTD0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                     formatAREAType1094431
     C           DHISD     IFGT CLDID                                     094431
     C                     MOVELAREA      SDAT1                           094431
     C                     EXSR SUBW1                                     094431
     C                     END                             - E4           094431
     C                     MOVE *BLANKS   CR                              094431
     C                     Z-ADDDHISD     WHISDD                          094431
     C           DHISD     IFNE WWDATD                                    099511
     C                     Z-ADDDHISD     WWDATD                          094431
     C                     EXSR MANUDR                                    094431
     C                     ENDIF                                          099511
     C*                                                                   094431
     C                     END                             - E5           094431
     C*                                                                   094431
     C                     END                                            094431
     C                     END                             - E4           094431
     C*                                                                   094431
     C           DCRCI     IFEQ 'Y'                        - B4           094431
     C           DDMVT     ORNE *ZEROS                     - B4           094431
     C           DCMVT     ORNE *ZEROS                     - B4           094431
     C           DMACI     ORNE *ZEROS                                    094431
     C           DRECI     OREQ 'S'                                       103860
     C           SGADI     ANDNE*ZEROS                                    103860
     C           DHISD     IFGE CLCID                                     094431
     C           DHISD     ANDLTCHISD                                     094431
     C*                                                                   094431
     C**  PROCESS WHEN CHANGE RATE CREDIT                                 094431
     C*                                                                   094431
     C***********          Z-ADDWCRCB     ZICALC                   094431 103860
     C           DRECI     IFEQ 'S'                                       103860
     C                     Z-ADDSCRCB     ZICALC                          103860
     C                     ELSE                                           103860
     C                     Z-ADDDCRCB     ZICALC                          103860
     C                     END                                            103860
     C                     Z-ADDWHISDC    ZIBEG                           094431
     C                     Z-ADDDHISD     ZIEND                           094431
     C*                                                                   094431
     C                     EXSR ZICD                                      094431
     C*                                                                   094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                                                MQ1590
     C                     Z-ADDZDAYN2    DAYC                                                MQ1590
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C********** ZDAYN2    IFNE *ZEROS                                                 103860 MQ1590
     C           DAYS      IFGT *ZERO                                                         MQ1590
      *                                                                   103860
     C**********           Z-ADDZDAYN2    DAYS                                         094431 MQ1590
     C**********           Z-ADDZDAYN2    DAYC                                         094431 MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C**                                                                  094431
     C                     Z-ADDWHISBC    HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
      *                                                                   103860
     C           DRECI     IFEQ 'S'                                       103860
     C           SCAIC     SUB  WCAID     INTC0                           103860
     C                     ELSE                                           103860
     C           DCAID     SUB  WCAID     INTC0                           094431
     C                     END                                            103860
     C*                                                                   094431
     C***********DAYS      IFNE *ZEROS                     - B5    094431 103860
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C******************   ADD  NUMB0     TOTND                     094431101770
     C                     ELSE                                           094431
     C                     SUB  NUMB0     TOTNC                           101770
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C**                                                                  094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTC0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           DHISD     IFGT CLCID                                     094431
     C                     MOVELAREA      SDAT2                           094431
     C                     EXSR SUBW2                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     MOVE *BLANKS   CR                              094431
     C                     Z-ADDDHISD     WHISDC                          094431
     C           DHISD     IFNE WWDATC                                    099511
     C                     Z-ADDDHISD     WWDATC                          094431
     C                     EXSR MANUCR                                    094431
     C                     ENDIF                                          099511
     C*                                                                   094431
     C                     END                             - E5           094431
     C*                                                                   094431
     C                     END                                            094431
     C                     END                             - E4           094431
     C*                                                                   094431
     C                     ELSE                            - X3           094431
     C*                                                                   094431
     C           CDICT     IFGT 2                          - B4           094431
     C           CCICT     ANDGT2                                         094431
     C*                                                                   094431
     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH GREATER THAN 3        094431
     C*                                                                   094431
     C           DRECI     IFEQ 'M'                        - B5           094431
     C*                                                                   094431
     C           DSDAT     IFNE *ZEROS                     - B6           094431
     C*                                                                   094431
     C**  PROCESS DEBIT                                                   094431
     C*                                                                   094431
     C                     Z-ADDWDRCB     ZICALC                          094431
     C                     Z-ADDWHISDD    ZIBEG                           094431
     C                     Z-ADDMHISD     ZIEND                           094431
     C                     EXSR ZICD                                      094431
      *                                                                                       MQ1590
      ** For calc basis 6, use the factored number of days                                    MQ1590
      *                                                                                       MQ1590
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1159
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYD                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C**                                                                  094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C*                                                                   094431
     C                     Z-ADDMNBL      HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C                     ADD  NUMB0     TOTND                           094431
     C                     ELSE                                           094431
     C******************   SUB  NUMB0     TOTNC                     094431101770
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           MNBL      IFGT *ZEROS                     - B7           094431
     C                     Z-ADDDINT      INTD0                           094431
     C                     ELSE                            - X7           094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E7           094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTD0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           MHISD     IFGT CLDID                                     094431
     C                     MOVELAREA      SDAT1                           094431
     C                     EXSR SUBW1                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDMHISD     WHISDD                          094431
     C*                                                                   094431
     C                     END                             - E6           094431
     C*                                                                   094431
     C           CSDAT     IFNE *ZEROS                     - B6           094431
     C*                                                                   094431
     C**  PROCESS CREDIT                                                  094431
     C*                                                                   094431
     C                     Z-ADDWCRCB     ZICALC                          094431
     C                     Z-ADDWHISDC    ZIBEG                           094431
     C                     Z-ADDMHISD     ZIEND                           094431
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYC                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C**                                                                  094431
     C                     Z-ADDMNBL      HISB0                           094431
     C**                                                                  094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C******************   ADD  NUMB0     TOTND                     094431101770
     C                     ELSE                                           094431
     C                     SUB  NUMB0     TOTNC                           094431
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           MNBL      IFGT *ZEROS                     - B7           094431
     C                     Z-ADDCINT      INTC0                           094431
     C                     ELSE                            - X7           094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E7           094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C**                                                                  094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTC0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           MHISD     IFGT CLCID                                     094431
     C                     MOVELAREA      SDAT2                           094431
     C                     EXSR SUBW2                                     094431
     C                     END                                            094431
     C                     Z-ADDMHISD     WHISDC                          094431
     C*                                                                   094431
     C                     END                             - E6           094431
     C*                                                                   094431
     C**  PROCESS UNTIL READING OTHER THAN 'M'                            094431
     C*                                                                   094431
     C           DRECI     DOWEQ'M'                        - B6           094431
     C           *IN51     ANDEQ'0'                                       094431
     C*                                                                   094431
     C           KLIST1    READEREHISL                   51               094431
     C*                                                                   094431
     C           *IN51     IFEQ '0'                        - B7           094431
     C           *IN51     OREQ '1'                                                        MD027025A
     C           SIND2     ANDEQ'X'                                                        MD027025A
      *                                                                                    MD027025A
     C           *IN51     IFEQ '1'                                                        MD027025A
     C           *IN50     OREQ '0'                                                        MD027025A
     C           SIND2     ANDEQ'X'                                                        MD027025A
     C           DHISD     ANDGTCHISD                                                      MD027025A
     C                     Z-ADDCHISD     DHISD                                            MD027025A
     C                     ENDIF                                                           MD027025A
     C*                                                                   094431
     C           DRECI     IFEQ 'M'                        - B8           094431
     C*                                                                   094431
     C           DSDAT     IFNE *ZEROS                     - B9           094431
     C*                                                                   094431
     C**  PROCESS DEBIT                                                   094431
     C*                                                                   094431
     C                     Z-ADDWDRCB     ZICALC                          094431
     C                     Z-ADDWHISDD    ZIBEG                           094431
     C                     Z-ADDMHISD     ZIEND                           094431
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYD                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C**                                                                  094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C                     Z-ADDMNBL      HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C                     ADD  NUMB0     TOTND                           094431
     C                     ELSE                                           094431
     C******************   SUB  NUMB0     TOTNC                     094431101770
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           MNBL      IFGT *ZEROS                     - B10          094431
     C                     Z-ADDDINT      INTD0                           094431
     C                     ELSE                            - X10          094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E10          094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE INTD0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    INTR                            094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           MHISD     IFGT CLDID                                     094431
     C                     MOVELAREA      SDAT1                           094431
     C                     EXSR SUBW1                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C*                                                                   094431
     C                     Z-ADDMHISD     WHISDD                          094431
     C*                                                                   094431
     C                     END                             - E9           094431
     C*                                                                   094431
     C           CSDAT     IFNE *ZEROS                     - B9           094431
     C*                                                                   094431
     C**  PROCESS CREDIT                                                  094431
     C*                                                                   094431
     C                     Z-ADDWCRCB     ZICALC                          094431
     C                     Z-ADDWHISDC    ZIBEG                           094431
     C                     Z-ADDMHISD     ZIEND                           094431
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYC                            094431
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C**                                                                  094431
     C*                                                                   094431
     C                     Z-ADDMNBL      HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C******************   ADD  NUMB0     TOTND                     094431101770
     C                     ELSE                                           094431
     C                     SUB  NUMB0     TOTNC                           094431
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           MNBL      IFGT *ZEROS                     - B10          094431
     C                     Z-ADDCINT      INTC0                           094431
     C                     ELSE                            - X10          094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E10          094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C**                                                                  094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTC0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           MHISD     IFGT CLCID                                     094431
     C                     MOVELAREA      SDAT2                           094431
     C                     EXSR SUBW2                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDMHISD     WHISDC                          094431
     C*                                                                   094431
     C                     END                             - E9           094431
     C*                                                                   094431
     C                     ELSE                            - X8           094431
     C*                                                                   094431
     C           DRECI     IFEQ 'S'                        - B9           094431
     C*                                                                   094431
     C**  PROCESS A S RECORD                                              094431
     C*                                                                   094431
     C********** SDICI     IFEQ 'Y'                        - B10    094431098818
     C           SDICI     IFNE *BLANK                     - B10          098818
     C*                                                                   094431
     C**  PROCESS IF DEBIT CAPITALISATION                                 094431
     C*                                                                   094431
     C                     Z-ADDWDRCB     ZICALC                          094431
     C                     Z-ADDWHISDD    ZIBEG                           094431
     C                     Z-ADDDHISD     ZIEND                           094431
     C           SDICI     IFEQ 'C'                                       098818
     C           DHISD     ADD  1         ZIEND                           098818
     C                     ENDIF                                          098818
     C                     EXSR ZICD                                      094431
      *                                                                                       MQ1590
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYD                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C**                                                                  094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C*                                                                   094431
     C                     Z-ADDSMNBL     HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C                     ADD  NUMB0     TOTND                           094431
     C                     ELSE                                           094431
     C******************   SUB  NUMB0     TOTNC                     094431101770
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           SMNBL     IFGT *ZEROS                     - B11          094431
     C                     Z-ADDDINT      INTD0                           094431
     C                     ELSE                            - X11          094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E11          094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTD0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           DHISD     IFGT CLDID                                     094431
     C                     MOVELAREA      SDAT1                           094431
     C                     EXSR SUBW1                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDDHISD     WHISDD                          094431
     C*                                                                   094431
     C                     END                             - E10          094431
     C*                                                                   094431
     C***********SCICI     IFEQ 'Y'                        - B10    094431098818
     C           SCICI     IFNE *BLANK                                    098818
     C*                                                                   094431
     C**  PROCESS IF CREDIT CAPITALISATION                                094431
     C*                                                                   094431
     C                     Z-ADDWCRCB     ZICALC                          094431
     C                     Z-ADDWHISDC    ZIBEG                           094431
     C                     Z-ADDDHISD     ZIEND                           094431
     C           SCICI     IFEQ 'C'                                       098818
     C           DHISD     ADD  1         ZIEND                           098818
     C                     ENDIF                                          098818
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYC                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C**                                                                  094431
     C                     Z-ADDSMNBL     HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C******************   ADD  NUMB0     TOTND                     094431101770
     C                     ELSE                                           094431
     C                     SUB  NUMB0     TOTNC                           094431
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           SMNBL     IFGT *ZEROS                     - B11          094431
     C                     Z-ADDCINT      INTC0                           094431
     C                     ELSE                            - X11          094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E11          094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C**                                                                  094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTC0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           DHISD     IFGT CLCID                                     094431
     C                     MOVELAREA      SDAT2                           094431
     C                     EXSR SUBW2                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDDHISD     WHISDC                          094431
     C*                                                                   094431
     C                     END                             - E10          094431
     C*                                                                   094431
     C                     END                             - E9           094431
     C*                                                                   094431
     C                     END                             - E8           094431
     C*                                                                   094431
     C                     END                             - E7           094431
     C*                                                                   094431
     C                     END                             - E6           094431
     C*                                                                   094431
     C                     END                             - E5           094431
     C*                                                                   094431
     C                     ELSE                            - X4           094431
     C*                                                                   094431
     C           CDICT     IFGT 2                          - B5           094431
     C           CCICT     ANDLT3                                         094431
     C*                                                                   094431
     C**  PROCESS IN CASE OF INTEREST TYPE CREDIT IS LESS THAN 3          094431
     C**  AND INTEREST TYPE DEBIT IS GREATER THAN 2                       094431
     C*                                                                   094431
     C                     Z-ADDWCRCB     ZICALC                          094431
     C                     Z-ADDWHISDC    ZIBEG                           094431
     C                     Z-ADDDHISD     ZIEND                           094431
     C*                                                                   094431
     C                     EXSR ZICD                                      094431
     C*                                                                   094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYC                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C**                                                                  094431
     C                     Z-ADDWHISBD    HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C           DCAID     SUB  WCAID     INTC0                           094431
     C*                                                                   094431
     C           DAYS      IFNE *ZEROS                     - B6           094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C******************   ADD  NUMB0     TOTND                     094431101770
     C                     ELSE                                           094431
     C                     SUB  NUMB0     TOTNC                           094431
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C**                                                                  094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTC0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           DHISD     IFGT CLCID                                     094431
     C                     MOVELAREA      SDAT2                           094431
     C                     EXSR SUBW2                                     094431
     C                     Z-ADDDHISD     WHISDC                          094431
     C                     END                                            094431
     C*                                                                   094431
     C           DHISD     IFNE WWDATC                                    099511
     C                     Z-ADDDHISD     WWDATC                          094431
     C                     EXSR MANUCR                                    094431
     C                     ENDIF                                          099511
     C*                                                                   094431
     C           DHISD     IFNE WWDATD                                    099511
     C                     Z-ADDDHISD     WWDATD                          094431
     C                     EXSR MANUDR                                    094431
     C                     ENDIF                                          099511
     C                     END                             - E6           094431
     C*                                                                   094431
     C**  PROCESS END OF MONTH OR CHANGE RATE FOR DEBIT                   094431
     C*                                                                   094431
     C           DRECI     IFEQ 'M'                        - B6           094431
     C           DSDAT     ANDNE*ZEROS                                    094431
     C*                                                                   094431
     C                     Z-ADDWDRCB     ZICALC                          094431
     C           WHISDD    IFEQ 0                                         094431
     C                     Z-ADDCLDID     WHISDD                          094431
     C                     END                                            094431
     C                     Z-ADDWHISDD    ZIBEG                           094431
     C                     Z-ADDMHISD     ZIEND                           094431
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYD                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C**                                                                  094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C*                                                                   094431
     C                     Z-ADDMNBL      HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C                     ADD  NUMB0     TOTND                           094431
     C                     ELSE                                           094431
     C******************   SUB  NUMB0     TOTNC                     094431101770
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           MNBL      IFGT *ZEROS                     - B7           094431
     C                     Z-ADDDINT      INTD0                           094431
     C                     ELSE                            - X7           094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E7           094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTD0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           MHISD     IFGT CLDID                                     094431
     C                     MOVELAREA      SDAT1                           094431
     C                     EXSR SUBW1                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDMHISD     WHISDD                          094431
     C*                                                                   094431
     C                     END                             - E6           094431
     C*                                                                   094431
     C           DRECI     DOWEQ'M'                        - B6           094431
     C           *IN51     ANDEQ'0'                                       094431
     C*                                                                   094431
     C           KLIST1    READEREHISL                   51               094431
     C*                                                                   094431
     C           *IN51     IFEQ '0'                        - B7           094431
     C*                                                                   094431
     C           DRECI     IFEQ 'M'                        - B8           094431
     C           DSDAT     ANDNE*ZEROS                                    094431
     C*                                                                   094431
     C                     Z-ADDWDRCB     ZICALC                          094431
     C                     Z-ADDWHISDD    ZIBEG                           094431
     C                     Z-ADDMHISD     ZIEND                           094431
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYD                            094431
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C**                                                                  094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C*                                                                   094431
     C                     Z-ADDMNBL      HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C                     ADD  NUMB0     TOTND                           094431
     C                     ELSE                                           094431
     C******************   SUB  NUMB0     TOTNC                     094431101770
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           MNBL      IFGT *ZEROS                     - B9           094431
     C                     Z-ADDDINT      INTD0                           094431
     C                     ELSE                            - X9           094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E9           094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTD0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           MHISD     IFGT CLDID                                     094431
     C                     MOVELAREA      SDAT1                           094431
     C                     EXSR SUBW1                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDMHISD     WHISDD                          094431
     C*                                                                   094431
     C                     ELSE                            - X8           094431
     C*                                                                   094431
     C           DRECI     IFEQ 'S'                        - B9           094431
     C***********SDICI     ANDEQ'Y'                                 094431098818
     C           SDICI     ANDNE*BLANK                                    098818
     C*                                                                   094431
     C                     Z-ADDWDRCB     ZICALC                          094431
     C                     Z-ADDWHISDD    ZIBEG                           094431
     C                     Z-ADDDHISD     ZIEND                           094431
     C           SDICI     IFEQ 'C'                                       098818
     C           DHISD     ADD  1         ZIEND                           098818
     C                     ENDIF                                          098818
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYD                            094431
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C**                                                                  094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C*                                                                   094431
     C                     Z-ADDSMNBL     HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C                     ADD  NUMB0     TOTND                           094431
     C                     ELSE                                           094431
     C******************   SUB  NUMB0     TOTNC                     094431101770
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           SMNBL     IFGT *ZEROS                     - B10          094431
     C                     Z-ADDDINT      INTD0                           094431
     C                     ELSE                            - X10          094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E10          094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTD0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           DHISD     IFGT CLDID                                     094431
     C                     MOVELAREA      SDAT1                           094431
     C                     EXSR SUBW1                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDDHISD     WHISDD                          094431
     C*                                                                   094431
     C                     END                             - E9           094431
     C*                                                                   094431
     C                     END                             - E8           094431
     C*                                                                   094431
     C                     END                             - E7           094431
     C*                                                                   094431
     C                     END                             - E6           094431
     C*                                                                   094431
     C                     ELSE                            - X5           094431
     C*                                                                   094431
     C**  PROCESS IN CASE OF INTEREST TYPE DEBIT IS LESS THAN 3           094431
     C**  AND INTEREST TYPE CREDIT IS GREATER THAN 2                      094431
     C*                                                                   094431
     C                     Z-ADDWDRCB     ZICALC                          094431
     C                     Z-ADDWHISDD    ZIBEG                           094431
     C                     Z-ADDDHISD     ZIEND                           094431
     C*                                                                   094431
     C                     EXSR ZICD                                      094431
     C*                                                                   094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYD                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C**                                                                  094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C                     Z-ADDWHISBD    HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C           DDAID     SUB  WDAID     INTD0                           094431
     C*                                                                   094431
     C           DAYS      IFNE *ZEROS                     - B6           094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C                     ADD  NUMB0     TOTND                           094431
     C                     ELSE                                           094431
     C******************   SUB  NUMB0     TOTNC                     094431101770
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTD0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           DHISD     IFGT CLDID                                     094431
     C                     MOVELAREA      SDAT1                           094431
     C                     EXSR SUBW1                                     094431
     C                     END                                            094431
     C                     Z-ADDDHISD     WHISDD                          094431
     C*                                                                   094431
     C*                                                                   094431
     C                     END                             - E6           094431
     C*                                                                   094431
     C**  CREDIT END OF MONTH OR CREDIT RATE CHANGE                       094431
     C*                                                                   094431
     C           DRECI     IFEQ 'M'                        - B6           094431
     C           CSDAT     ANDNE*ZEROS                                    094431
     C*                                                                   094431
     C                     Z-ADDWCRCB     ZICALC                          094431
     C                     Z-ADDWHISDC    ZIBEG                           094431
     C                     Z-ADDMHISD     ZIEND                           094431
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYC                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C**                                                                  094431
     C                     Z-ADDMNBL      HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C******************   ADD  NUMB0     TOTND                     094431101770
     C                     ELSE                                           094431
     C                     SUB  NUMB0     TOTNC                           094431
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           MNBL      IFGT *ZEROS                     - B7           094431
     C                     Z-ADDCINT      INTC0                           094431
     C                     ELSE                            - X7           094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E7           094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C**                                                                  094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTC0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           MHISD     IFGT CLCID                                     094431
     C                     MOVELAREA      SDAT2                           094431
     C                     EXSR SUBW2                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDMHISD     WHISDC                          094431
     C*                                                                   094431
     C                     END                             - E6           094431
     C*                                                                   094431
     C           DRECI     DOWEQ'M'                        - B6           094431
     C           *IN51     ANDEQ'0'                                       094431
     C*                                                                   094431
     C           KLIST1    READEREHISL                   51               094431
     C*                                                                   094431
     C           *IN51     IFEQ '0'                        - B7           094431
     C*                                                                   094431
     C           DRECI     IFEQ 'M'                        - B8           094431
     C           CSDAT     ANDNE*ZEROS                                    094431
     C*                                                                   094431
     C                     Z-ADDWCRCB     ZICALC                          094431
     C                     Z-ADDWHISDC    ZIBEG                           094431
     C                     Z-ADDMHISD     ZIEND                           094431
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYC                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C**                                                                  094431
     C                     Z-ADDMNBL      HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C******************   ADD  NUMB0     TOTND                     094431101770
     C                     ELSE                                           094431
     C                     SUB  NUMB0     TOTNC                           094431
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           MNBL      IFGT *ZEROS                     - B9           094431
     C                     Z-ADDCINT      INTC0                           094431
     C                     ELSE                            - X9           094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E9           094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C**                                                                  094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTC0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           MHISD     IFGT CLCID                                     094431
     C                     MOVELAREA      SDAT2                           094431
     C                     EXSR SUBW2                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDMHISD     WHISDC                          094431
     C*                                                                   094431
     C                     ELSE                            - X8           094431
     C*                                                                   094431
     C           DRECI     IFEQ 'S'                        - B9           094431
     C***********SCICI     ANDEQ'Y'                                 094431098818
     C           SCICI     ANDNE*BLANK                                    098818
     C*                                                                   094431
     C                     Z-ADDWCRCB     ZICALC                          094431
     C                     Z-ADDWHISDC    ZIBEG                           094431
     C                     Z-ADDDHISD     ZIEND                           094431
     C           SCICI     IFEQ 'C'                                       098818
     C           DHISD     ADD  1         ZIEND                           098818
     C                     ENDIF                                          098818
     C                     EXSR ZICD                                      094431
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            094431
     C                     Z-ADDZDAYN2    DAYC                            094431
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE DAYS      ZFIELD                          094431
     C                     Z-ADD0         ZADEC                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ND                              094431
     C                     Z-ADDSAVEZ     ZADEC                           094431
     C**                                                                  094431
     C                     Z-ADDSMNBL     HISB0                           094431
     C           HISB0     MULT DAYS      NUMB0                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1           094431
     C                     MOVE 'CR'      CR                              094431
     C           HISB0     MULT SUBT      HISB0                           094431
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1           094431
     C*                                                                   094431
     C**                                                                  094431
     C           NUMB0     IFGT *ZEROS                                    094431
     C******************   ADD  NUMB0     TOTND                     094431101770
     C                     ELSE                                           094431
     C                     SUB  NUMB0     TOTNC                           094431
     C           NUMB0     MULT SUBT      NUMB0                           094431
     C                     END                                            094431
     C           SMNBL     IFGT *ZEROS                     - B10          094431
     C                     Z-ADDCINT      INTC0                           094431
     C                     ELSE                            - X10          094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E10          094431
     C*                                                                   094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE HISB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    AMON                            094431
     C**                                                                  094431
     C                     MOVE *BLANKS   ZFIELD                          094431
     C                     MOVE NUMB0     ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    NUMB                            094431
     C**                                                                  094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     Z-ADDINTC0     WKINT                           094431
     C                     EXSR EDTINT                                    094431
     C*                                                                   094431
     C                     EXSR OUT5SR                                    094431
     C           DHISD     IFGT CLCID                                     094431
     C                     MOVELAREA      SDAT2                           094431
     C                     EXSR SUBW2                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C                     Z-ADDDHISD     WHISDC                          094431
     C*                                                                   094431
     C                     END                             - E9           094431
     C*                                                                   094431
     C                     END                             - E8           094431
     C*                                                                   094431
     C                     END                             - E7           094431
     C*                                                                   094431
     C                     END                             - E6           094431
     C*                                                                   094431
     C                     END                             - E5           094431
     C*                                                                   094431
     C                     END                             - E4           094431
     C*                                                                   094431
     C                     END                             - E3           094431
      *----------------------------------------------------               094431
     C                     END                             - E1
     C*
     C                     Z-ADD*ZEROS    PPSTD
     C                     Z-ADD*ZEROS    PVALD
     C                     MOVE *BLANKS   PPSTDO
     C                     MOVE *BLANKS   PVALDO
     C*
     C           *IN51     DOWEQ'0'                        - B1
     C           DHISD     ANDLTCHISD
      *                                                                   103860
      **  Process generated adjustment within cap. period.                103860
     C           DRECI     IFEQ 'S'                                       103860
     C           SGADI     IFNE 0                                         103860
     C           SGACI     ORNE 0                                         103860
     C                     Z-ADDDHISD     AHISD                           103860
     C                     Z-ADDSDAIC     ADAIC                           103860
     C                     Z-ADDSCAIC     ACAIC                           103860
     C                     MOVE SDCI      ASDCI                           103860
     C                     MOVE SCCI      ASCCI                           103860
     C           DHISD     IFGE CLDID                                     103860
     C                     MOVE '1'       *IN41                           103860
     C                     END                                            103860
     C           DHISD     IFGE CLCID                                     103860
     C                     MOVE '1'       *IN42                           103860
     C                     END                                            103860
     C                     EXSR #ADJ                                      103860
     C                     SETOF                     4142                 103860
     C                     END                                            103860
     C                     ELSE                                           103860
     C*
     C**  PROCESS POSTING AT THE SAME DATE
     C*
     C           *IN55     DOWEQ'0'                        - B2
     C           DHISD     ANDGEHISD
     C*
     C***********PVALD     IFNE DHISD                                     103860
     C***********KLIST7    CHAINREHISSL              99                   103860
     C************IN99     IFEQ '0'                                       103860
     C***********SDCI      IFEQ 'Y'                                       099509
     C***********SCCI      OREQ 'Y'                                       099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C***********SCCI      ORNE *BLANK                             099509 103860
     C*
     C***********PPSTD     IFNE RUND                       - B1           103860
     C***********          Z-ADDRUND      ZDAYNO                          103860
     C***********          MOVE '0'       *IN99                           103860
     C***********          EXSR ZDATE2                                    103860
     C*
     C**  VERIFY IF ERROR
     C*
     C************IN99     IFEQ '1'                        - B2           103860
     C************LOCK     IN   LDA                                       103860
     C***********          MOVELRUND      DBKEY                           103860
     C***********          Z-ADD021       DBASE                           103860
     C***********          MOVE 'ZDATE2'  DBFILE           ***************103860
     C***********          OUT  LDA                        * DB ERROR 021*103860
     C***********          MOVEA'1'       *IN,89           ***************103860
     C***********          EXSR DBSR                                      103860
     C***********          END                             - E2           103860
     C*
     C***********          Z-ADDRUND      PPSTD                           103860
     C***********          MOVE ZDATE     PPSTDO                          103860
     C*
     C***********          END                             - E1           103860
     C*
     C***********          MOVE PPSTDO    PSTDA                           103860
     C***********          MOVE PPSTDO    PSTD2                           103860
     C*
     C***********PVALD     IFNE AHISD                      - B1           103860
     C***********          Z-ADDAHISD     ZDAYNO                          103860
     C***********          MOVE '0'       *IN99                           103860
     C***********          EXSR ZDATE2                                    103860
     C*
     C**  VERIFY IF ERROR
     C*
     C************IN99     IFEQ '1'                        - B2           103860
     C************LOCK     IN   LDA                                       103860
     C***********          MOVELAHISD     DBKEY                           103860
     C***********          Z-ADD022       DBASE                           103860
     C***********          MOVE 'ZDATE2'  DBFILE           ***************103860
     C***********          OUT  LDA                        * DB ERROR 022*103860
     C***********          MOVEA'1'       *IN,89           ***************103860
     C***********          EXSR DBSR                                      103860
     C***********          END                             - E2           103860
     C*
     C***********          Z-ADDAHISD     PVALD                           103860
     C***********          MOVE ZDATE     PVALDO                          103860
     C*
     C***********          END                             - E1           103860
     C*
     C***********          MOVE PVALDO    VALDA                           103860
     C***********          MOVE PVALDO    VALD2                           103860
     C*
      **Check*where*the*adjustment*is*to*be*posted*to*:*********** 099509 103860
      ************************************************************ 099509 103860
     C***********          SELEC                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SDCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR                     099509 103860
      **Suspence*acc********************************************** 099509 103860
     C***********SDCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR                     099509 103860
      **this*acc************************************************** 099509 103860
     C***********          OTHER                                   099509 103860
     C***********          MOVELNAR,29    NARR                            103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********          SELEC                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SCCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR2                    099509 103860
      **Suspence*acc********************************************** 099509 103860
     C***********SCCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR2                    099509 103860
      **this*acc************************************************** 099509 103860
     C***********          OTHER                                   099509 103860
     C***********          MOVELNAR,29    NARR2                           103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********AHISD     IFGT CLCID                                     103860
     C***********AHISD     ORGT CLDID                                     103860
     C***********SDCI      IFEQ 'Y'                                       099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C***********ADAIC     IFNE *ZEROS                                    103860
     C***********ADAIC     IFLT *ZERO                                     103860
     C***********          Z-SUBADAIC     PSTD0                           103860
     C***********          MOVEL'CR'      CR                              103860
     C***********          MOVEL'CR'      CR2                             103860
     C***********          ELSE                                           103860
     C***********          Z-ADDADAIC     PSTD0                           103860
     C***********          MOVEL'  '      CR                              103860
     C***********          MOVEL'  '      CR2                             103860
     C***********          END                                            103860
     C***********          MOVE *BLANK    ZFIELD                          103860
     C***********          MOVE PSTD0     ZFIELD                          103860
     C***********          Z-ADDDECI1     ZADIG                           103860
     C***********          EXSR ZEDIT                                     103860
     C***********          MOVE ZFIELD    AMON                            103860
     C***********          MOVE ZFIELD    AMON2                           103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR             formatAREAType1 086093 103860
     C***********          MOVELAREA      SDAT1                           103860
     C***********          MOVELAREA      SDAT2                           103860
     C***********AHISD     IFGT CLDID                                     103860
     C***********          EXSR SUBW1                                     103860
     C***********          END                                            103860
     C***********AHISD     IFGT CLCID                                     103860
     C***********          EXSR SUBW2                                     103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********SCCI      IFEQ 'Y'                                       099509
     C***********SCCI      IFNE *BLANK                             099509 103860
     C***********ACAIC     IFNE *ZEROS                                    103860
     C***********ACAIC     IFLT *ZERO                                     103860
     C***********          Z-SUBACAIC     PSTD0                           103860
     C***********          MOVEL'  '      CR                              103860
     C***********          MOVEL'  '      CR2                             103860
     C***********          ELSE                                           103860
     C***********          Z-ADDACAIC     PSTD0                           103860
     C***********          MOVEL'CR'      CR                              103860
     C***********          MOVEL'CR'      CR2                             103860
     C***********          END                                            103860
     C***********          MOVE *BLANK    ZFIELD                          103860
     C***********          MOVE PSTD0     ZFIELD                          103860
     C***********          Z-ADDDECI1     ZADIG                           103860
     C***********          EXSR ZEDIT                                     103860
     C***********          MOVE ZFIELD    AMON                            103860
     C***********          MOVE ZFIELD    AMON2                           103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR             formatAREAType1 086093 103860
     C***********          MOVELAREA      SDAT1                           103860
     C***********          MOVELAREA      SDAT2                           103860
     C***********AHISD     IFGT CLDID                                     103860
     C***********          EXSR SUBW1                                     103860
     C***********          END                                            103860
     C***********AHISD     IFGT CLCID                                     103860
     C***********          EXSR SUBW2                                     103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********          END                                            103860
     C*
     C***********          END                                            103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********          END                                            103860
     C                     EXSR POSTSR
     C*
      *                                                                   088826
      * Get Next Posting Record                                           088826
     C                     EXSR NXTPOP                                    088826
     C***********KLIST1    READEREHPOPL                  55               088826
      *                                                                   113955
      * Stop processing if all subfiles full                              113955
     C           SF1F      IFEQ 'Y'                                       113955
     C           SF2F      ANDEQ'Y'                                       113955
     C           SF3F      ANDEQ'Y'                                       113955
     C                     SETON                     5155                 113955
     C                     END                                            113955
     C*
     C                     END                             - E2
      *                                                                   103860
     C                     END                                            103860
     C*
     C**  PROCESS IN CASE THERE IS ONE RATE CHANGE
     C*
     C           *IN51     IFEQ '0'                        - B2
     C           DHISD     ANDLTCHISD
     C                     EXSR RATESR
      *                                                                   113955
      * Stop processing if all subfiles full                              113955
     C           SF1F      IFEQ 'Y'                                       113955
     C           SF2F      ANDEQ'Y'                                       113955
     C           SF3F      ANDEQ'Y'                                       113955
     C                     MOVE '1'       *IN51                           113955
     C                     END                                            113955
      *                                                                   089497
     C           *IN51     IFEQ '0'                                       089497
     C*
     C**  OUTPUT SUBTOTAL LINE
     C*
     C**  CHECK INTEREST TYPE
     C*
     C           CDICT     IFLT 3                          - B3
     C           CCICT     ANDLT3
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH LESS THAN 3
      *                                                                   089497
      *   Bypass monthly interest & cap. records on REHISL                089497
     C           DRECI     DOWEQ'M'                                       089497
     C           *IN51     ANDEQ'0'                                       089497
     C           DRECI     OREQ 'S'                                       089497
     C           SGADI     ANDEQ0                                         103860
     C           SGACI     ANDEQ0                                         103860
     C           *IN51     ANDEQ'0'                                       089497
     C           KLIST1    READEREHISL                   51               089497
     C                     END                                            089497
      *                                                                   089497
     C           *IN51     IFEQ '0'                                       089497
     C*
     C***********DCRCI     IFNE 'Y'                        - B4           049678
     C           DDRCI     IFEQ 'Y'                        - B4           049678
     C           DRECI     ANDEQ'D'                                       103860
     C           DDMVT     ORNE *ZEROS                                    049678
     C           DRECI     ANDEQ'D'                                       103860
     C           DCMVT     ORNE *ZEROS                                    049678
     C           DRECI     ANDEQ'D'                                       103860
     C           DMADI     ORNE *ZEROS                                    065773
     C           DRECI     ANDEQ'D'                                       103860
     C           ADJFLG    OREQ 'Y'                                       103860
     C           DRECI     ANDEQ'D'                                       103860
     C           SGACI     ORNE *ZEROS                                    103860
     C           DRECI     ANDEQ'S'                                       103860
     C           CRE001    OREQ 'Y'                                       CRE001
     C           ODLI      ANDNE*BLANKS                                   CRE001
     C***********DHISD     IFGT CLDID                                     094431
     C           DHISD     IFGE CLDID                                     094431
     C           DHISD     ANDLTCHISD
     C           SF1F      ANDEQ*BLANK                                    113955
     C*
     C** IF CAPITALISATION RECORD READ, CHECK IF IT IS FOR DEBIT          094431
     C***********DDRCI     IFEQ 'Y'                        - B4    094431 103860
     C***********DRECI     ANDEQ'S'                        - B4    094431 103860
     C***********DRECI     ORNE 'S'                        - B4    094431 103860
     C*                                                                   094431
     C**  PROCESS WHEN CHANGE RATE DEBIT
     C*
     C*                                                                   075076
     C**  Access REHISPD record for DDAID at historic date.               075076
     C*                                                                   075076
     C****Process*until*reading*a*'D'*record*from*REHISL.          075076 089497
     C****Use*KLIST7*for*the*ZIEND*history*date.                   075076 089497
     C*                                                                   075076
     C***********DRECI     DOWEQ'M'                                075076 089497
     C************IN51     ANDEQ'0'                                075076 089497
     C***********DRECI     OREQ 'S'                                075076 089497
     C************IN51     ANDEQ'0'                                075076 089497
     C***********KLIST7    READEREHISL                   51        075076 089497
     C***********          END                                     075076 089497
     C*                                                                   075076
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                                                MQ1590
     C                     Z-ADDZDAYN2    DAYD                                                MQ1590
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C********** ZDAYN2    IFNE *ZEROS                                                 103860 MQ1590
     C           DAYS      IFGT *ZERO                                                         MQ1590
      *                                                                   103860
     C**********           Z-ADDZDAYN2    DAYS                                                MQ1590
     C**********           Z-ADDZDAYN2    DAYD                                                MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C                     Z-ADDWHISBD    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
      *                                                                   103860
     C           DRECI     IFEQ 'S'                                       103860
     C           SDAIC     SUB  WDAID     INTD0                           103860
     C                     ELSE                                           103860
     C           DDAID     SUB  WDAID     INTD0
     C                     END                                            103860
     C*
     C***********DAYS      IFNE *ZEROS                     - B5           103860
     C*
     C           NUMB0     IFLT *ZEROS
     C***********          SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     ELSE                                           091612
     C                     ADD  NUMB0     TOTND                           091612
     C                     END
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
      *                                                                   086254
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTD0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           DHISD     IFGT CLDID                                     065773
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*                                                                   CRE001
     C** OUTPUT NEW OVERDRAFT LIMIT IF OVERDRAFT LINE PROCESSED           CRE001
     C*                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C           ODLI      IFEQ 'Y'                        - B8           CRE001
     C                     Z-ADDDODRL     WODRL                           CRE001
     C                     Z-ADDDHISD     ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE '0'       *IN99                           CRE001
     C                     MOVELZDATE     VALDA                           CRE001
     C                     MOVELNAR,35    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C                     END                             - E8           CRE001
     C                     END                                            CRE001
     C                     END                             - E4           065773
     C                     MOVE *BLANKS   CR
     C                     Z-ADDDHISD     WHISDD                          043037
     C***********DMADI     IFNE 0                                         094431
     C***********          EXSR #MADI                                     094431
     C***********          END                                            094431
     C           DHISD     IFNE WWDATD                                    099511
     C           DRECI     ANDEQ'D'                                       103860
     C           SF1F      ANDEQ*BLANK                                    113955
     C                     Z-ADDDHISD     WWDATD  50                      094431
     C                     EXSR MANUDR                                    094431
     C                     ENDIF                                          099511
     C*
     C*
     C                     END                             - E5
     C*
     C***********          END                                     094431 103860
     C                     END
     C                     END                             - E4
     C*
     C***********DDRCI     IFNE 'Y'                        - B4           049678
     C           DCRCI     IFEQ 'Y'                                       049678
     C           DRECI     ANDEQ'D'                                       103860
     C           DDMVT     ORNE *ZEROS                                    049678
     C           DRECI     ANDEQ'D'                                       103860
     C           DCMVT     ORNE *ZEROS                                    049678
     C           DRECI     ANDEQ'D'                                       103860
     C           DMACI     ORNE *ZEROS                                    094431
     C           DRECI     ANDEQ'D'                                       103860
     C           ADJFLG    OREQ 'Y'                                       103860
     C           DRECI     ANDEQ'D'                                       103860
     C           SGADI     ORNE *ZEROS                                    103860
     C           DRECI     ANDEQ'S'                                       103860
     C********** DHISD     IFGT CLCID                                     094431
     C           DHISD     IFGE CLCID                                     094431
     C           DHISD     ANDLTCHISD
     C           SF2F      ANDEQ*BLANK                                    113955
     C*
     C** IF CAPITALISATION RECORD READ, CHECK IF IT IS FOR CREDIT         094431
     C***********DCRCI     IFEQ 'Y'                        - B4    094431 103860
     C***********DRECI     ANDEQ'S'                        - B4    094431 103860
     C***********DRECI     ORNE 'S'                        - B4    094431 103860
     C*                                                                   094431
     C**  PROCESS WHEN CHANGE RATE CREDIT
     C*
     C*                                                                   075076
     C**  Access REHISPD record for DCAID at historic date.               075076
     C*                                                                   075076
     C****Process*until*reading*a*'D'*record*from*REHISL.          075076 089497
     C****Use*KLIST7*for*the*ZIEND*history*date.                   075076 089497
     C*                                                                   075076
     C***********DRECI     DOWEQ'M'                                075076 089497
     C************IN51     ANDEQ'0'                                075076 089497
     C***********DRECI     OREQ 'S'                                075076 089497
     C************IN51     ANDEQ'0'                                075076 089497
     C***********KLIST7    READEREHISL                   51        075076 089497
     C***********          END                                     075076 089497
     C*                                                                   075076
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                                                MQ1590
     C                     Z-ADDZDAYN2    DAYC                                                MQ1590
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C********** ZDAYN2    IFNE *ZEROS                                                 103860 MQ1590
     C           DAYS      IFGT *ZERO                                                         MQ1590
     C**********           Z-ADDZDAYN2    DAYS                                                MQ1590
     C**********           Z-ADDZDAYN2    DAYC                                                MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDWHISBC    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
      *                                                                   103860
     C           DRECI     IFEQ 'S'                                       103860
     C           SCAIC     SUB  WCAID     INTC0                           103860
     C                     ELSE                                           103860
     C           DCAID     SUB  WCAID     INTC0
     C                     END                                            103860
     C*
     C***********DAYS      IFNE *ZEROS                     - B5           103860
     C*
     C***********NUMB0     IFGT *ZEROS                                    091612
     C***********          ADD  NUMB0     TOTND                           091612
     C***********          ELSE                                           091612
     C           NUMB0     IFLT *ZEROS                                    091612
     C                     SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           DHISD     IFGT CLCID                                     065773
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                                            065773
     C                     MOVE *BLANKS   CR
     C                     Z-ADDDHISD     WHISDC                          043037
     C*
     C***********DMACI     IFNE 0                                         094431
     C***********          EXSR #MACI                                     094431
     C***********          END                                            094431
     C           DHISD     IFNE WWDATC                                    099511
     C           DRECI     ANDEQ'D'                                       103860
     C           SF2F      ANDEQ*BLANK                                    113955
     C                     Z-ADDDHISD     WWDATC  50                      094431
     C                     EXSR MANUCR                                    094431
     C                     ENDIF                                          099511
     C*
     C                     END                             - E5
     C*
     C***********          END                                     094431 103860
     C                     END
     C                     END                             - E4
      *                                                                   089497
     C                     END                                            089497
     C*
     C***********DDRCI     IFEQ 'Y'                        - B4           049678
     C***********DCRCI     ANDEQ'Y'                                       049678
     C*
     C**  PROCESS WHEN CHANGE RATE DEBIT AND CREDIT
     C*
     C***********DHISD     IFGE CLDID                                     049678
     C***********DHISD     ANDLTCHISD                                     049678
     C***********          Z-ADDWDRCB     ZICALC                          049678
     C***********          Z-ADDWHISDD    ZIBEG                           049678
     C***********          Z-ADDDHISD     ZIEND                           049678
     C*
     C***********          EXSR ZICD                                      049678
     C*
     C***********          Z-ADDZDAYN2    DAYS                            049678
     C***********          Z-ADDZDAYN2    DAYD                            049678
     C***********          MOVE *BLANKS   ZFIELD                          049678
     C***********          MOVE DAYS      ZFIELD                          049678
     C***********          Z-ADD0         ZADEC                           049678
     C***********          EXSR ZEDIT                                     049678
     C***********          MOVE ZFIELD    ND                              049678
     C*
     C***********          Z-ADDSAVEZ     ZADEC                           049678
     C***********          Z-ADDWHISBD    HISB0                           049678
     C***********HISB0     MULT DAYS      NUMB0                           049678
     C***********HISB0     IFLT 0                          - B1           049678
     C***********          MOVE 'CR'      CR                              049678
     C***********HISB0     MULT SUBT      HISB0                           049678
     C***********          END                             - E1           049678
     C***********DDAID     SUB  WDAID     INTD0                           049678
     C*
     C***********DAYS      IFNE *ZEROS                     - B5           049678
     C*
     C***********NUMB0     IFGT *ZEROS                                    049678
     C***********          ADD  NUMB0     TOTND                           049678
     C***********          ELSE                                           049678
     C***********          SUB  NUMB0     TOTNC                           049678
     C***********NUMB0     MULT SUBT      NUMB0                           049678
     C***********          END                                            049678
     C***********          MOVE *BLANKS   ZFIELD                          049678
     C***********          MOVE HISB0     ZFIELD                          049678
     C***********          Z-ADDDECI1     ZADIG                           049678
     C***********          EXSR ZEDIT                                     049678
     C***********          MOVE ZFIELD    AMON                            049678
     C*
     C***********          MOVE *BLANKS   ZFIELD                          049678
     C***********          MOVE NUMB0     ZFIELD                          049678
     C***********          Z-ADDDECI1     ZADIG                           049678
     C***********          EXSR ZEDIT                                     049678
     C***********          MOVE ZFIELD    NUMB                            049678
     C***********          MOVE *BLANKS   ZFIELD                          049678
     C***********          MOVE INTD0     ZFIELD                          049678
     C***********          Z-ADDDECI1     ZADIG                           049678
     C***********          EXSR ZEDIT                                     049678
     C***********          MOVE ZFIELD    INTR                            049678
     C*
     C***********          EXCPTOUT5                                      049678
     C***********          READ GHOST                    99               049678
     C***********          MOVELAREA      SDAT1                           049678
     C***********          EXSR SUBW1                                     049678
     C***********          MOVE *BLANKS   CR                              049678
     C***********          Z-ADDDHISD     WHISDD                   043037 049678
     C*
     C***********          END                             - E5           049678
     C***********          END                                            049678
     C*
     C***********DHISD     IFGE CLCID                                     049678
     C***********DHISD     ANDLTCHISD                                     049678
     C***********          Z-ADDWCRCB     ZICALC                          049678
     C***********          Z-ADDWHISDC    ZIBEG                           049678
     C***********          Z-ADDDHISD     ZIEND                           049678
     C*
     C***********          EXSR ZICD                                      049678
     C*
     C***********          Z-ADDZDAYN2    DAYS                            049678
     C***********          Z-ADDZDAYN2    DAYC                            049678
     C***********          MOVE *BLANKS   ZFIELD                          049678
     C***********          MOVE DAYS      ZFIELD                          049678
     C***********          Z-ADD0         ZADEC                           049678
     C***********          EXSR ZEDIT                                     049678
     C***********          MOVE ZFIELD    ND                              049678
     C***********          Z-ADDSAVEZ     ZADEC                           049678
     C*
     C***********          Z-ADDWHISBD    HISB0                           049678
     C*
     C***********HISB0     MULT DAYS      NUMB0                           049678
     C***********HISB0     IFLT 0                          - B1           049678
     C***********          MOVE 'CR'      CR                              049678
     C***********HISB0     MULT SUBT      HISB0                           049678
     C***********          END                             - E1           049678
     C***********DCAID     SUB  WCAID     INTC0                           049678
     C*
     C***********DAYS      IFNE *ZEROS                     - B5           049678
     C*
     C***********NUMB0     IFGT *ZEROS                                    049678
     C***********          ADD  NUMB0     TOTND                           049678
     C***********          ELSE                                           049678
     C***********          SUB  NUMB0     TOTNC                           049678
     C***********NUMB0     MULT SUBT      NUMB0                           049678
     C***********          END                                            049678
     C***********          MOVE *BLANKS   ZFIELD                          049678
     C***********          MOVE HISB0     ZFIELD                          049678
     C***********          Z-ADDDECI1     ZADIG                           049678
     C***********          EXSR ZEDIT                                     049678
     C***********          MOVE ZFIELD    AMON                            049678
     C*
     C***********          MOVE *BLANKS   ZFIELD                          049678
     C***********          MOVE NUMB0     ZFIELD                          049678
     C***********          Z-ADDDECI1     ZADIG                           049678
     C***********          EXSR ZEDIT                                     049678
     C***********          MOVE ZFIELD    NUMB                            049678
     C*
     C***********          MOVE *BLANKS   ZFIELD                          049678
     C***********          MOVE INTC0     ZFIELD                          049678
     C***********          Z-ADDDECI1     ZADIG                           049678
     C***********          EXSR ZEDIT                                     049678
     C***********          MOVE ZFIELD    INTR                            049678
     C*
     C***********          EXCPTOUT5                                      049678
     C***********          READ GHOST                    99               049678
     C***********          MOVELAREA      SDAT2                           049678
     C***********          EXSR SUBW2                                     049678
     C***********          MOVE *BLANKS   CR                              049678
     C***********          Z-ADDDHISD     WHISDC                   043037 049678
     C*
     C***********          END                             - E5           049678
     C***********          END                                            049678
     C*
     C***********          END                             - E4           049678
     C*
     C                     ELSE                            - X3
     C*
     C           CDICT     IFGT 2                          - B4
     C           CCICT     ANDGT2
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE ARE BOTH GREATER THAN 3
     C*
     C           DRECI     IFEQ 'M'                        - B5
     C*
     C           DSDAT     IFNE *ZEROS                     - B6
     C*
     C**  PROCESS DEBIT
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDMNBL      HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C           NUMB0     IFGT *ZEROS
     C                     ADD  NUMB0     TOTND
     C                     ELSE
     C***********          SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           MNBL      IFGT *ZEROS                     - B7           094431
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X7           094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E7           094431
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTD0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           MHISD     IFGT CLDID                                     065773
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END                                            065773
     C*
     C                     Z-ADDMHISD     WHISDD
     C*
     C                     END                             - E6
     C*
     C           CSDAT     IFNE *ZEROS                     - B6
     C*
     C**  PROCESS CREDIT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYC
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDMNBL      HISB0
     C*
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C***********NUMB0     IFGT *ZEROS                                    091612
     C***********          ADD  NUMB0     TOTND                           091612
     C***********          ELSE                                           091612
     C           NUMB0     IFLT *ZEROS                                    091612
     C                     SUB  NUMB0     TOTNC
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           MNBL      IFGT *ZEROS                     - B7           094431
     C                     Z-ADDCINT      INTC0
     C                     ELSE                            - X7           094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E7           094431
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           MHISD     IFGT CLCID                                     065773
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                                            065773
     C                     Z-ADDMHISD     WHISDC
     C*
     C                     END                             - E6
     C*
     C**  PROCESS UNTIL READING OTHER THAN 'M'
     C*
     C           DRECI     DOWEQ'M'                        - B6
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B7
     C*
     C           DRECI     IFEQ 'M'                        - B8
     C*
     C           DSDAT     IFNE *ZEROS                     - B9
     C*
     C**  PROCESS DEBIT
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C                     Z-ADDMNBL      HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C           NUMB0     IFGT *ZEROS
     C                     ADD  NUMB0     TOTND
     C                     ELSE
     C***********          SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           MNBL      IFGT *ZEROS                     - B10          094431
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X10          094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E10          094431
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTD0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           MHISD     IFGT CLDID                                     065773
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END                                            065773
     C*
     C                     Z-ADDMHISD     WHISDD
     C*
     C                     END                             - E9
     C*
     C           CSDAT     IFNE *ZEROS                     - B9
     C*
     C**  PROCESS CREDIT
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYC
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDMNBL      HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C***********NUMB0     IFGT *ZEROS                                    091612
     C***********          ADD  NUMB0     TOTND                           091612
     C***********          ELSE                                           091612
     C           NUMB0     IFLT *ZEROS                                    091612
     C                     SUB  NUMB0     TOTNC
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           MNBL      IFGT *ZEROS                     - B10          094431
     C                     Z-ADDCINT      INTC0
     C                     ELSE                            - X10          094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E10          094431
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           MHISD     IFGT CLCID                                     065773
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                                            065773
     C*
     C                     Z-ADDMHISD     WHISDC
     C*
     C                     END                             - E9
     C*
     C                     ELSE                            - X8
     C*
     C           DRECI     IFEQ 'S'                        - B9
     C*
     C**  PROCESS A S RECORD
     C*
     C***********SDICI     IFEQ 'Y'                        - B10          098818
     C           SDICI     IFNE *BLANK                     - B10          098818
     C*
     C**  PROCESS IF DEBIT CAPITALISATION
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C           SDICI     IFEQ 'C'                                       098818
     C           DHISD     ADD  1         ZIEND                           098818
     C                     ENDIF                                          098818
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDSMNBL     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C           NUMB0     IFGT *ZEROS
     C                     ADD  NUMB0     TOTND
     C                     ELSE
     C***********          SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           SMNBL     IFGT *ZEROS                     - B11
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X11
     C                     Z-SUBDINT      INTD0
     C                     END                             - E11
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTD0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           DHISD     IFGT CLDID                                     065773
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END                                            065773
     C*
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E10
     C*
     C***********SCICI     IFEQ 'Y'                        - B10          098818
     C           SCICI     IFNE *BLANK                     - B10          098818
     C*
     C**  PROCESS IF CREDIT CAPITALISATION
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C           SCICI     IFEQ 'C'                                       098818
     C           DHISD     ADD  1         ZIEND                           098818
     C                     ENDIF                                          098818
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYC
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDSMNBL     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C***********NUMB0     IFGT *ZEROS                                    091612
     C***********          ADD  NUMB0     TOTND                           091612
     C***********          ELSE                                           091612
     C           NUMB0     IFLT *ZEROS                                    091612
     C                     SUB  NUMB0     TOTNC
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           SMNBL     IFGT *ZEROS                     - B11
     C                     Z-ADDCINT      INTC0
     C                     ELSE                            - X11
     C                     Z-SUBCINT      INTC0
     C                     END                             - E11
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           DHISD     IFGT CLCID                                     065773
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                                            065773
     C*
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E10
     C*
     C                     END                             - E9
     C*
     C                     END                             - E8
     C*
     C                     END                             - E7
     C*
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C           DHISD     IFNE WWDATD                                    099511
     C                     Z-ADDDHISD     WWDATD                          094431
     C                     EXSR MANUDR                                    094431
     C                     ENDIF                                          099511
     C*                                                                   094431
     C           DHISD     IFNE WWDATC                                    099511
     C                     Z-ADDDHISD     WWDATC                          094431
     C                     EXSR MANUCR                                    094431
     C                     ENDIF                                          099511
     C                     ELSE                            - X4
     C*
     C           CDICT     IFGT 2                          - B5
     C           CCICT     ANDLT3
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE CREDIT IS LESS THAN 3
     C**  AND INTEREST TYPE DEBIT IS GREATER THAN 2
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYC
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDWHISBD    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C           DCAID     SUB  WCAID     INTC0
     C*
     C           DAYS      IFNE *ZEROS                     - B6
     C*
     C***********NUMB0     IFGT *ZEROS                                    091612
     C***********          ADD  NUMB0     TOTND                           091612
     C***********          ELSE                                           091612
     C           NUMB0     IFLT *ZEROS                                    091612
     C                     SUB  NUMB0     TOTNC
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           DHISD     IFGT CLCID                                     065773
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                                            065773
     C                     Z-ADDDHISD     WHISDC                          043037
     C*
     C***********DMACI     IFNE 0                                  065773 094431
     C***********          EXSR #MACI                              065773 094431
     C***********          END                                     065773 094431
     C*
     C***********DMADI     IFNE 0                                  065773 094431
     C***********          EXSR #MADI                              065773 094431
     C***********          END                                     065773 094431
     C                     END                             - E6
     C*                                                                   094431
     C           DHISD     IFNE WWDATD                                    099511
     C                     Z-ADDDHISD     WWDATD                          094431
     C                     EXSR MANUDR                                    094431
     C                     ENDIF                                          099511
     C*                                                                   094431
     C           DHISD     IFNE WWDATC                                    099511
     C                     Z-ADDDHISD     WWDATC                          094431
     C                     EXSR MANUCR                                    094431
     C                     ENDIF                                          099511
     C*
     C**  PROCESS END OF MONTH OR CHANGE RATE FOR DEBIT
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           DSDAT     ANDNE*ZEROS
     C*
     C                     Z-ADDWDRCB     ZICALC
     C           WHISDD    IFEQ 0                                         065773
     C                     Z-ADDCLDID     WHISDD                          065773
     C                     END                                            065773
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDMNBL      HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C           NUMB0     IFGT *ZEROS
     C                     ADD  NUMB0     TOTND
     C                     ELSE
     C***********          SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           MNBL      IFGT *ZEROS                     - B7           094431
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X7           094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E7           094431
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTD0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           MHISD     IFGT CLDID                                     065773
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END                                            065773
     C*
     C                     Z-ADDMHISD     WHISDD
     C*
     C                     END                             - E6
     C*
     C           DRECI     DOWEQ'M'                        - B6
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B7
     C*
     C           DRECI     IFEQ 'M'                        - B8
     C           DSDAT     ANDNE*ZEROS
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDMNBL      HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C           NUMB0     IFGT *ZEROS
     C                     ADD  NUMB0     TOTND
     C                     ELSE
     C***********          SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           MNBL      IFGT *ZEROS                     - B9           094431
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X9           094431
     C                     Z-SUBDINT      INTD0                           094431
     C                     END                             - E9           094431
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTD0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           MHISD     IFGT CLDID                                     065773
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END                                            065773
     C*
     C                     Z-ADDMHISD     WHISDD
     C*
     C                     ELSE                            - X8
     C*
     C           DRECI     IFEQ 'S'                        - B9
     C***********SDICI     ANDEQ'Y'                                       098818
     C           SDICI     ANDNE*BLANK                                    098818
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C           SDICI     IFEQ 'C'                                       098818
     C           DHISD     ADD  1         ZIEND                           098818
     C                     ENDIF                                          098818
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDSMNBL     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C           NUMB0     IFGT *ZEROS
     C                     ADD  NUMB0     TOTND
     C                     ELSE
     C***********          SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           SMNBL     IFGT *ZEROS                     - B10
     C                     Z-ADDDINT      INTD0
     C                     ELSE                            - X10
     C                     Z-SUBDINT      INTD0
     C                     END                             - E10
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTD0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           DHISD     IFGT CLDID                                     065773
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*                                                                   CRE001
     C** OUTPUT NEW OVERDRAFT LIMIT IF OVERDRAFT LINE PROCESSED           CRE001
     C*                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C           ODLI      IFEQ 'Y'                        - B8           CRE001
     C                     Z-ADDDODRL     WODRL                           CRE001
     C                     Z-ADDDHISD     ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE '0'       *IN99                           CRE001
     C                     MOVELZDATE     VALDA                           CRE001
     C                     MOVELNAR,35    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C                     END                             - E8           CRE001
     C                     END                                            CRE001
     C                     END                                            065773
     C*
     C                     Z-ADDDHISD     WHISDD
     C*
     C                     END                             - E9
     C*
     C                     END                             - E8
     C*
     C                     END                             - E7
     C*
     C                     END                             - E6
     C*
     C                     ELSE                            - X5
     C*
     C**  PROCESS IN CASE OF INTEREST TYPE DEBIT IS LESS THAN 3
     C**  AND INTEREST TYPE CREDIT IS GREATER THAN 2
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDWHISDD    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C*
     C                     EXSR ZICD
     C*
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C                     Z-ADDWHISBD    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C           DDAID     SUB  WDAID     INTD0
     C*
     C           DAYS      IFNE *ZEROS                     - B6
     C*
     C           NUMB0     IFGT *ZEROS
     C                     ADD  NUMB0     TOTND
     C                     ELSE
     C***********          SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTD0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           DHISD     IFGT CLDID                                     065773
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END                                            065773
     C                     Z-ADDDHISD     WHISDD                          043037
     C*
     C                     END                             - E6
     C*                                                                   094431
     C           DHISD     IFNE WWDATD                                    099511
     C                     Z-ADDDHISD     WWDATD                          094431
     C                     EXSR MANUDR                                    094431
     C                     ENDIF                                          099511
     C*                                                                   094431
     C           DHISD     IFNE WWDATC                                    099511
     C                     Z-ADDDHISD     WWDATC                          094431
     C                     EXSR MANUCR                                    094431
     C                     ENDIF                                          099511
     C*
     C**  CREDIT END OF MONTH OR CREDIT RATE CHANGE
     C*
     C           DRECI     IFEQ 'M'                        - B6
     C           CSDAT     ANDNE*ZEROS
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYC
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDMNBL      HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C***********NUMB0     IFGT *ZEROS                                    091612
     C***********          ADD  NUMB0     TOTND                           091612
     C***********          ELSE                                           091612
     C           NUMB0     IFLT *ZEROS                                    091612
     C                     SUB  NUMB0     TOTNC
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           MNBL      IFGT *ZEROS                     - B7           094431
     C                     Z-ADDCINT      INTC0
     C                     ELSE                            - X7           094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E7           094431
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           MHISD     IFGT CLCID                                     065773
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                                            065773
     C*
     C                     Z-ADDMHISD     WHISDC
     C*
     C                     END                             - E6
     C*
     C           DRECI     DOWEQ'M'                        - B6
     C           *IN51     ANDEQ'0'
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C           *IN51     IFEQ '0'                        - B7
     C*
     C           DRECI     IFEQ 'M'                        - B8
     C           CSDAT     ANDNE*ZEROS
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDMHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYC
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDMNBL      HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C***********NUMB0     IFGT *ZEROS                                    091612
     C***********          ADD  NUMB0     TOTND                           091612
     C***********          ELSE                                           091612
     C           NUMB0     IFLT *ZEROS                                    091612
     C                     SUB  NUMB0     TOTNC
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           MNBL      IFGT *ZEROS                     - B9           094431
     C                     Z-ADDCINT      INTC0
     C                     ELSE                            - X9           094431
     C                     Z-SUBCINT      INTC0                           094431
     C                     END                             - E9           094431
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           MHISD     IFGT CLCID                                     065773
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                                            065773
     C*
     C                     Z-ADDMHISD     WHISDC
     C*
     C                     ELSE                            - X8
     C*
     C           DRECI     IFEQ 'S'                        - B9
     C***********SCICI     ANDEQ'Y'                                       098818
     C           SCICI     ANDNE*BLANK                                    098818
     C*
     C                     Z-ADDWCRCB     ZICALC
     C                     Z-ADDWHISDC    ZIBEG
     C                     Z-ADDDHISD     ZIEND
     C           SCICI     IFEQ 'C'                                       098818
     C           DHISD     ADD  1         ZIEND                           098818
     C                     ENDIF                                          098818
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYC
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDSMNBL     HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C***********NUMB0     IFGT *ZEROS                                    091612
     C***********          ADD  NUMB0     TOTND                           091612
     C***********          ELSE                                           091612
     C           NUMB0     IFLT *ZEROS                                    091612
     C                     SUB  NUMB0     TOTNC
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           SMNBL     IFGT *ZEROS                     - B10
     C                     Z-ADDCINT      INTC0
     C                     ELSE                            - X10
     C                     Z-SUBCINT      INTC0
     C                     END                             - E10
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C           DHISD     IFGT CLCID                                     065773
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                                            065773
     C*
     C                     Z-ADDDHISD     WHISDC
     C*
     C                     END                             - E9
     C*
     C                     END                             - E8
     C*
     C                     END                             - E7
     C*
     C                     END                             - E6
     C*
     C                     END                             - E5
     C*
     C                     END                             - E4
     C*
     C                     END                             - E3
      *                                                                   113955
      * Stop processing if all subfiles full                              113955
     C           SF1F      IFEQ 'Y'                                       113955
     C           SF2F      ANDEQ'Y'                                       113955
     C           SF3F      ANDEQ'Y'                                       113955
     C                     MOVE '1'       *IN51                           113955
     C                     END                                            113955
     C*
     C************IN51     DOWEQ'0'                        - B3    094431 103860
     C***********DHISD     ANDLTHISD                               094431 103860
     C***********CHISD     ANDLTHISD                               094431 103860
     C*
     C********** DDMVT     IFNE *ZEROS                     - B4           048247
     C********** DCMVT     ORNE *ZEROS                                    048247
     C******************** Z-ADDDHISD     WDATE                           048247
     C********** *LOCK**** IN   LDA                                       048247
     C******************** Z-ADD023       DBASE            ***************048247
     C******************** MOVE 'REHISL'  DBFILE           * DB ERROR 023*048247
     C******************** MOVELCKEY      RKEY             ***************048247
     C******************** MOVELRKEY2     DBKEY                           048247
     C******************** OUT  LDA                                       048247
     C******************** MOVEA'1'       *IN,89                          048247
     C******************** EXSR DBSR                                      048247
     C******************** END                             - E4           048247
     C*                                                                   094431
     C****RATE*CHANGE********************************************* 094431 103860
     C*                                                                   094431
     C***********          EXSR RATESR                             094431 103860
     C*                                                                   094431
     C****SUB*TOTAL*OUTPUT**************************************** 094431 103860
     C*                                                                   094431
     C***********WHISDD    IFGE CLDID                              094431 103860
     C***********DDRCI     IFEQ 'Y'                        - B1    094431 103860
     C***********SF1F      ANDEQ*BLANK                             113955 103860
     C*                                                                   094431
     C***********CDICT     IFLT 3                          - B2    094431 103860
     C*                                                                   094431
     C***********          Z-ADDWDICT     ZICALC                   094431 103860
     C***********          Z-ADDWHISDD    ZIBEG                    094431 103860
     C***********          Z-ADDDHISD     ZIEND                    094431 103860
     C*                                                                   094431
     C***********          EXSR ZICD                               094431 103860
     C*                                                                   094431
     C***********          Z-ADDZDAYN2    DAYS                     094431 103860
     C***********          Z-ADDZDAYN2    DAYD                     094431 103860
     C***********          MOVE *BLANKS   ZFIELD                   094431 103860
     C***********          MOVE DAYS      ZFIELD                   094431 103860
     C***********          Z-ADD0         ZADEC                    094431 103860
     C***********          EXSR ZEDIT                              094431 103860
     C***********          MOVE ZFIELD    ND                       094431 103860
     C***********          Z-ADDSAVEZ     ZADEC                    094431 103860
     C**                                                                  094431
     C***********          Z-ADDWHISBD    HISB0                    094431 103860
     C***********HISB0     MULT DAYS      NUMB0                    094431 103860
     C***********HISB0     IFLT 0                          - B1    094431 103860
     C***********          MOVE 'CR'      CR                       094431 103860
     C***********HISB0     MULT SUBT      HISB0                    094431 103860
     C***********          ELSE                            - E1    100992 103860
     C***********          MOVE *BLANKS   CR                       100992 103860
     C***********          END                             - E1    094431 103860
     C*                                                                   094431
     C***********NUMB0     IFLT 0                                  094431 103860
     C***********NUMB0     MULT SUBT      NUMB0                    094431 103860
     C***********          ELSE                                    101770 103860
     C***********          ADD  NUMB0     TOTND                    101770 103860
     C***********          END                                     094431 103860
     C*                                                                   094431
     C***********          MOVE *BLANKS   ZFIELD                   094431 103860
     C***********          MOVE HISB0     ZFIELD                   094431 103860
     C***********          Z-ADDDECI1     ZADIG                    094431 103860
     C***********          EXSR ZEDIT                              094431 103860
     C***********          MOVE ZFIELD    AMON                     094431 103860
     C*                                                                   094431
     C***********          MOVE *BLANKS   ZFIELD                   094431 103860
     C***********          MOVE NUMB0     ZFIELD                   094431 103860
     C***********          Z-ADDDECI1     ZADIG                    094431 103860
     C***********          EXSR ZEDIT                              094431 103860
     C***********          MOVE ZFIELD    NUMB                     094431 103860
     C*                                                                   094431
     C***********          EXSR OUT5SR             formatAREAType1 094431 103860
     C***********DHISD     IFGT CLDID                              094431 103860
     C***********          MOVELAREA      SDAT1                    094431 103860
     C***********          EXSR SUBW1                              094431 103860
     C***********          END                                     094431 103860
     C*                                                                   094431
     C***********          ELSE                            - X2    094431 103860
     C*                                                                   094431
     C**  SEE LATER                                                       094431
     C*                                                                   094431
     C***********          END                             - E2    094431 103860
     C*                                                                   094431
     C***********          END                             - E1    094431 103860
     C***********          END                             - E1    094431 103860
     C*                                                                   094431
     C***********WHISDC    IFGE CLCID                              094431 103860
     C***********DCRCI     IFEQ 'Y'                        - B1    094431 103860
     C***********SF2F      ANDEQ*BLANK                             113955 103860
     C*                                                                   094431
     C***********CCICT     IFLT 3                          - B2    094431 103860
     C*                                                                   094431
     C***********          Z-ADDWCICT     ZICALC                   094431 103860
     C***********          Z-ADDWHISDC    ZIBEG                    094431 103860
     C***********          Z-ADDDHISD     ZIEND                    094431 103860
     C*                                                                   094431
     C***********          EXSR ZICD                               094431 103860
     C*                                                                   094431
     C***********          Z-ADDZDAYN2    DAYS                     094431 103860
     C***********          Z-ADDZDAYN2    DAYC                     094431 103860
     C***********          MOVE *BLANKS   ZFIELD                   094431 103860
     C***********          MOVE DAYS      ZFIELD                   094431 103860
     C***********          Z-ADD0         ZADEC                    094431 103860
     C***********          EXSR ZEDIT                              094431 103860
     C***********          MOVE ZFIELD    ND                       094431 103860
     C***********          Z-ADDSAVEZ     ZADEC                    094431 103860
     C*                                                                   094431
     C***********          Z-ADDWHISBC    HISB0                    094431 103860
     C***********HISB0     MULT DAYS      NUMB0                    094431 103860
     C***********HISB0     IFLT 0                          - B1    094431 103860
     C***********          MOVE 'CR'      CR                       094431 103860
     C***********HISB0     MULT SUBT      HISB0                    094431 103860
     C***********          ELSE                            - E1    100992 103860
     C***********          MOVE *BLANKS   CR                       100992 103860
     C***********          END                             - E1    094431 103860
     C*                                                                   094431
     C***********NUMB0     IFLT 0                                  094431 103860
     C***********          SUB  NUMB0     TOTNC                    101770 103860
     C***********NUMB0     MULT SUBT      NUMB0                    094431 103860
     C***********          END                                     094431 103860
     C*                                                                   094431
     C***********          MOVE *BLANKS   ZFIELD                   094431 103860
     C***********          MOVE HISB0     ZFIELD                   094431 103860
     C***********          Z-ADDDECI1     ZADIG                    094431 103860
     C***********          EXSR ZEDIT                              094431 103860
     C***********          MOVE ZFIELD    AMON                     094431 103860
     C*                                                                   094431
     C***********          MOVE *BLANKS   ZFIELD                   094431 103860
     C***********          MOVE NUMB0     ZFIELD                   094431 103860
     C***********          Z-ADDDECI1     ZADIG                    094431 103860
     C***********          EXSR ZEDIT                              094431 103860
     C***********          MOVE ZFIELD    NUMB                     094431 103860
     C*                                                                   094431
     C***********          EXSR OUT5SR             formatAREAType1 094431 103860
     C***********DHISD     IFGT CLCID                              094431 103860
     C***********          MOVELAREA      SDAT2                    094431 103860
     C***********          EXSR SUBW2                              094431 103860
     C***********          END                                     094431 103860
     C*                                                                   094431
     C***********          ELSE                            - X2    094431 103860
     C*                                                                   094431
     C**  SEE LATER                                                       094431
     C*                                                                   094431
     C***********          END                             - E2    094431 103860
     C*                                                                   094431
     C***********          END                             - E1    094431 103860
     C***********          END                             - E1    094431 103860
     C*                                                                   094431
     C***********          END                             - E3    094431 103860
      *                                                                   089497
     C                     END                                            089497
     C*                                                                   094431
     C                     END                             - E2           094431
      *                                                                   113955
      * Stop processing if all subfiles full                              113955
     C           SF1F      IFEQ 'Y'                                       113955
     C           SF2F      ANDEQ'Y'                                       113955
     C           SF3F      ANDEQ'Y'                                       113955
     C                     MOVE '1'       *IN51                           113955
     C                     END                                            113955
     C*                                                                   094431
     C                     END                             - E1
      *                                                                   113955
     C           SF1F      IFEQ *BLANK                                    113955
     C           SF2F      OREQ *BLANK                                    113955
     C           SF3F      OREQ *BLANK                                    113955
      *                                                                   092181
      * Check if system is on 1st day accruals and there is a             092181
      * capitalisation valued today.                                      092181
     C                     MOVE *BLANK    @CPTDY  1                       092181
     C           BMLDAI    IFEQ 'N'                                       092181
     C           DRECI     ANDEQ'S'                                       092181
     C           DHISD     ANDEQRUND                                      092181
     C           CHISD     ANDEQRUND                                      092181
     C                     MOVE 'Y'       @CPTDY                          092181
     C                     END                                            092181
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C           PVALD     IFNE CHISD                      - B1
     C                     Z-ADDCHISD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C                     Z-ADDCHISD     WDATE
     C           *LOCK     IN   LDA
     C                     Z-ADD024       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVELWDATE     DBKEY            * DB ERROR 024*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     MOVE CHISD     PVALD
     C*
     C                     END                             - E1
     C*
     C                     MOVE VALDO     VALDA
     C*
     C           WHISDD    IFLT CHISD                                     065773
     C                     Z-ADDWDRCB     ZICALC
     C*                                                                   075080
     C* Days should only run from the start of this reporting period.     075080
     C*                                                                   075080
     C           WHISDD    IFLT CLDID                                     075080
     C                     Z-ADDCLDID     ZIBEG                           075080
     C***********          Z-ADDDDAID     WDAID                     075248088726
     C                     ELSE                                           075080
     C                     Z-ADDWHISDD    ZIBEG
     C                     END                                            075080
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD                            101770
     C                     ENDIF                                                              MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*
     C                     Z-ADDSAVEZ     ZADEC
     C                     Z-ADDWHISBD    HISB0
     C           HISB0     MULT DAYS      NUMB0
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C           NUMB0     IFGT *ZEROS
     C***********          ADD  NUMB0     TOTND                           159560
     C**********           Z-ADDNUMB0     TOTND                                        159560 214716
     C                     ADD  NUMB0     TOTND                                               214716
     C                     ELSE
     C***********          SUB  NUMB0     TOTNC                           091612
     C**********           Z-SUBNUMB0     TOTNC                                        159560 214716
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C           *IN51     IFEQ '0'
     C           CDRIP     SUB  WDAID     WDAID
     C           WDAID     ADD  CDRIS     INTD0
     C           INTD0     ADD  CDAIC     INTD0
     C***********INTD0     ADD  CPMADI    INTD0                     065773094433
     C***********INTD0     SUB  CTMADI    INTD0                     065773094433
     C                     ELSE
      *                                                                   092181
      * If 1st day accruals and there is a cap. valued today, show        092181
      * interest amount.                                                  092181
     C           @CPTDY    IFEQ 'Y'                                       092181
     C           SDRIP     ADD  SDRIS     INTD0                           092181
     C                     SUB  WDAID     INTD0                           092181
     C                     ELSE                                           092181
     C********   DAIC1     SUB  WDAID     INTD0                           048574
     C***********CDAIC     SUB  WDAID     INTD0                     048574107791
     C           DHISD     IFEQ RUND                                      152283
     C           CHISD     ANDEQRUND                                      152283
     C                     Z-ADD0         INTD0                           107791
     C                     MOVE DAICCH    INTD0                           107791
     C           INTD0     SUB  WDAID     INTD0                           107791
     C                     ADD  CDRIP     INTD0                           094431
     C                     ELSE                                           152283
     C           CDRIP     SUB  WDAID     INTD0                           152283
     C                     ADD  CDRIS     INTD0                           152283
     C                     ADD  CDAIC     INTD0                           152283
     C                     END                                            152283
     C                     END                                            092181
     C                     END
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********INTD0     IFLT *ZEROS                              077129086254
     C***********          Z-SUBINTD0     INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          ELSE                                     077129086254
     C***********          MOVE INTD0     ZFIELD                          086254
     C***********          END                                      077129086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C           CRE001    IFEQ 'Y'                                       CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     ENDIF                                          CRE001
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTD0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C                     MOVE *BLANKS   VALDA
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END                                            065773
     C*
     C           WHISDC    IFLT CHISD                                     065773
     C******************** Z-ADDWDRCB     ZICALC                          065773
     C                     Z-ADDWCRCB     ZICALC                          065773
     C*                                                                   075080
     C* Days should only run from the start of this reporting period.     075080
     C*                                                                   075080
     C           WHISDC    IFLT CLCID                                     075080
     C                     Z-ADDCLCID     ZIBEG                           075080
     C***********          Z-ADDDCAID     WCAID                     075248088726
     C                     ELSE                                           075080
     C                     Z-ADDWHISDC    ZIBEG
     C                     END                                            075080
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYC                            101770
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     Z-ADDWHISBC    HISB0
     C           HISB0     MULT DAYS      NUMB0                           091612
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C           *IN51     IFEQ '0'
     C           CCRIP     SUB  WCAID     WCAID
     C           WCAID     ADD  CCRIS     INTC0
     C           INTC0     ADD  CCAIC     INTC0
     C***********INTC0     ADD  CPMACI    INTC0                     065773094433
     C***********INTC0     SUB  CTMACI    INTC0                     065773094433
     C                     ELSE
      *                                                                   092181
      * If 1st day accruals and there is a cap. valued today, show        092181
      * interest amount.                                                  092181
     C           @CPTDY    IFEQ 'Y'                                       092181
     C           SCRIP     ADD  SCRIS     INTC0                           092181
     C                     SUB  WCAID     INTC0                           092181
     C                     ELSE                                           092181
     C********   CAIC1     SUB  WCAID     INTC0                          048574
     C***********CCAIC     SUB  WCAID     INTC0                     048574107791
     C           DHISD     IFEQ RUND                                      158433
     C           CHISD     ANDEQRUND                                      158433
     C                     Z-ADD0         INTC0                           107791
     C                     MOVE CAICCH    INTC0                           107791
     C           INTC0     SUB  WCAID     INTC0                           107791
     C                     ADD  CCRIP     INTC0                           094431
     C                     ELSE                                           158433
     C           CCRIP     SUB  WCAID     INTC0                           158433
     C                     ADD  CCRIS     INTC0                           158433
     C                     ADD  CCAIC     INTC0                           158433
     C                     END                                            158433
     C                     END                                            092181
     C                     END
     C***********HISB0     MULT DAYS      NUMB0                           091612
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPDR                                           S01408
     C*                                                                   S01408
     C           NUMB0     IFLT 0
     C                     SUB  NUMB0     TOTNC                           091612
     C           NUMB0     MULT SUBT      NUMB0
     C                     END
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE NUMB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    NUMB
     C*
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE INTC0     ZFIELD                          086254
      *                                                                   086254
      * edit Interest rate with trailing minus sign                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDINTC0     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C                     MOVE *BLANKS   VALDA
     C*
     C***********          EXCPTOUT5                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT5SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                                            065773
     C*
     C** PREPARE C/F BALANCE
     C*
     C**  TRANSFER DATE MIDAS INTO DDMMMYY
     C*
     C                     Z-ADDCHISD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD025       DBASE
     C                     MOVE 'ZDATE2'  DBFILE           ***************
     C                     MOVE CHISD     DBKEY            * DB ERROR 025*
     C                     OUT  LDA                        ***************
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     MOVE CHISD     PVALD
     C                     MOVE ZDATE     PVALDO
     C*
     C                     MOVE PVALDO    VALDA
     C***********          MOVELNAR,6     NARR                            089497
     C*
     C                     Z-ADDWHISBC    HISB0
     C                     MOVE *BLANKS   CR
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C**  OUTPUT TOTAL NUMBER
     C*
     C                     MOVELNAR,26    NARR
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE TOTND     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    TOTN   16
     C***********          EXCPTOUT7                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT7SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C                     MOVELNAR,27    NARR
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE TOTNC     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C*                                                                   S01408
     C/COPY WNCPYSRC,RE3364EPLT                                           S01408
     C*                                                                   S01408
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    TOTN
     C***********          EXCPTOUT7                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT7SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C**  OUTPUT BALANCE C/F
     C*
     C           DEBBAK    IFEQ *ON                                       089497
     C                     MOVE *OFF      DEBBAK                          089497
     C                     MOVELNAR,39    NARR                            089497
     C                     ELSE                                           089497
     C                     MOVELNAR,6     NARR
     C                     ENDIF                                          089497
     C***********          EXCPTOUT6                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT6SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C***********          MOVELAREA      SDAT2                           089497
     C                     EXSR SUBW1
     C           CREBAK    IFEQ *ON                                       089497
     C                     MOVE *OFF      CREBAK                          089497
     C                     MOVELNAR,39    NARR                            089497
     C                     ELSE                                           089497
     C                     MOVELNAR,6     NARR                            089497
     C                     ENDIF                                          089497
     C                     MOVEANARR      AR,18                           089497
     C                     MOVELAREA      SDAT2                           089497
     C                     EXSR SUBW2
     C*
     C****PREPARE TOTAL INTEREST OUTPUT                                  065773
     C**  PREPARE TOTAL INTEREST OUTPUT FOR DEBIT SIDE                   065773
     C*
     C                     Z-ADDWDRCB     ZICALC
     C                     Z-ADDCLDID     ZIBEG
     C                     Z-ADDCHISD     ZIEND
     C                     EXSR ZICD
     C*
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYD                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS
     C                     Z-ADDZDAYN2    DAYD                            101770
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE DAYS      ZFIELD
     C                     Z-ADD0         ZADEC
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ND
     C*******************  MOVE ZFIELD    ND2     4                       065773
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C                     MOVELNAR,5     NARR
     C*
     C*                                                                   094433
     C* Total interest DR and CR capitalisation. Calculated together.     094433
     C*                                                                   094433
     C           *IN51     IFEQ '0'
     C                     Z-ADDCDRIP     TINTD0
     C                     ADD  CDRIS     TINTD0
     C                     ADD  CDAIC     TINTD0
     C***********          ADD  WWADJD    TINTD0                    094431094433
     C                     ADD  CPMADI    TINTD0                          094433
     C                     Z-ADDCCRIP     TINTC0
     C                     ADD  CCRIS     TINTC0
     C                     ADD  CCAIC     TINTC0
     C***********          ADD  WWADJC    TINTC0                    094431094433
     C                     ADD  CPMACI    TINTC0                          094433
     C                     ELSE
     C           WDAID     ADD  INTD0     WDAID
     C***********          ADD  WWADJD    WDAID                     094431094433
     C           WCAID     ADD  INTC0     WCAID
     C***********          ADD  WWADJC    WCAID                     094431094433
     C           @CPTDY    IFEQ 'Y'                                       094433
     C                     ADD  CPMADI    WDAID                           094433
     C                     ADD  CPMACI    WCAID                           094433
     C                     ELSE                                           094433
     C                     ADD  CTMADI    WDAID                           094433
     C                     ADD  CTMACI    WCAID                           094433
     C                     END                                            094433
     C                     Z-ADDWDAID     TINTD0
     C                     Z-ADDWCAID     TINTC0
     C                     END
     C*
     C**********           ADD  WWADJC    TINTC0                          065773
     C**********           ADD  WWADJD    TINTD0                          065773
     C*
     C***********TINTD0    IFLT *ZEROS                                    086254
     C***********          Z-SUBTINTD0    TINTD0                          077129
     C***********          Z-SUBTINTD0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          END                                            077129
     C***********          ELSE                                     077129086254
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE TINTD0    ZFIELD                          086254
     C***********          END                                      077129086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTD0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
      *                                                                   086254
     C***********TINTC0    IFLT *ZEROS                              077129086254
     C***********          Z-SUBTINTC0    TINTC0                          077129
     C***********          Z-SUBTINTC0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          END                                            086254
     C                     MOVELNAR,5     NARR
     C*                                                                   065773
     C**  PREPARE TOTAL INTEREST OUTPUT FOR CREDIT SIDE                   065773
     C*                                                                   065773
     C                     Z-ADDWCRCB     ZICALC                          065773
     C                     Z-ADDCLCID     ZIBEG                           065773
     C                     Z-ADDCHISD     ZIEND                           065773
     C                     EXSR ZICD                                      065773
     C*                                                                   065773
     C***********          Z-ADDZDAYN1    DAYS                     065773 074595
     C           ZICALC    IFEQ 6                                                             MQ1590
     C                     Z-ADDINT6DY    DAYS                                                MQ1590
     C                     Z-ADDINT6DY    DAYC                                                MQ1590
     C                     ELSE                                                               MQ1590
     C                     Z-ADDZDAYN2    DAYS                            074595
     C                     Z-ADDZDAYN2    DAYC                            101770
     C                     ENDIF                                                              MQ1590
      *                                                                                       MQ1590
     C                     MOVE *BLANKS   ZFIELD                          065773
     C                     MOVE DAYS      ZFIELD                          065773
     C                     Z-ADD0         ZADEC                           065773
     C                     EXSR ZEDIT                                     065773
     C                     MOVE ZFIELD    ND                              065773
     C******************** MOVE ND2       ND                              065773
     C                     Z-ADDSAVEZ     ZADEC                           065773
      *                                                                   086254
     C***********TINTC0    IFGE 0                                   077129086254
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE TINTC0    ZFIELD                          086254
     C***********          END                                      077129086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTC0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C*
     C                     EXSR SUBW1
     C                     EXSR SUBW2
      *                                                                                    MD027025A
      ** Prepare Delay Adjustment                                                          MD027025A
      *                                                                                    MD027025A
     C                     Z-ADD0         WDRADJ                                           MD027025A
     C                     Z-ADD0         WCRADJ                                           MD027025A
     C           PDRADJ    IFNE *BLANKS                                                    MD027025A
     C           CHISD     ANDEQRUND                                                       MD027025A
     C           SIND2     ANDNE'X'                                                        MD027025A
     C           PCRADJ    ORNE *BLANKS                                                    MD027025A
     C           CHISD     ANDEQRUND                                                       MD027025A
     C           SIND2     ANDNE'X'                                                        MD027025A
      *                                                                                    MD027025A
      ** Output Delay Debit Adjustment                                                     MD027025A
      *                                                                                    MD027025A
     C                     MOVELNAR,50    NARR                                             MD027025A
     C                     Z-ADDDECI1     ZADIG                                            MD027025A
     C                     MOVE PDRADJ    WDRADJ                                           MD027025A
     C                     MOVE PDRADJ    WKINT                                            MD027025A
     C                     EXSR EDTINT                                                     MD027025A
     C                     EXSR OUT2SR                                                     MD027025A
     C                     MOVELAREA      SDAT1                                            MD027025A
     C                     EXSR SUBW1                                                      MD027025A
      *                                                                                    MD027025A
      ** Output Delay Credit Adjustment                                                    MD027025A
      *                                                                                    MD027025A
     C                     MOVELNAR,50    NARR                                             MD027025A
     C                     Z-ADDDECI1     ZADIG                                            MD027025A
     C                     MOVE PCRADJ    WCRADJ                                           MD027025A
     C                     MOVE PCRADJ    WKINT                                            MD027025A
     C                     EXSR EDTINT                                                     MD027025A
     C                     EXSR OUT2SR                                                     MD027025A
     C                     MOVELAREA      SDAT2                                            MD027025A
     C                     EXSR SUBW2                                                      MD027025A
      *                                                                                    MD027025A
     C                     ENDIF                                                           MD027025A
     C*
     C**  OUTPUT TOTAL INTEREST
     C*
     C**  PREPARE TOTAL DEBITED OUTPUT
     C*
     C                     MOVELNAR,7     NARR
     C*
     C*                                                                   094433
     C* Total posted DR and CR capitalisation. DR calculation.            094433
     C*                                                                   094433
     C           *IN51     IFEQ '0'
     C           CDRIS     ADD  CDRIP     TINTD0
     C                     ADD  CPMADI    TINTD0                          094431
     C                     ELSE
      *                                                                   092181
      * If 1st day accruals and cap. valued today, report total           092181
      * interest posted.                                                  092181
     C           @CPTDY    IFEQ 'Y'                                       092181
     C           SDRIP     ADD  SDRIS     TINTD0                          092181
     C                     ADD  CPMADI    TINTD0                          094433
     C                     ELSE                                           092181
     C***********          Z-ADD0         TINTD0                          094431
     C           CDRIS     ADD  CDRIP     TINTD0                          094431
     C                     ADD  CPMADI    TINTD0                          094431
     C                     END                                            094431
     C                     END
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********TINTD0    IFLT *ZEROS                                    086254
     C***********          Z-SUBTINTD0    TINTD0                          077129
     C***********          Z-SUBTINTD0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          END                                            077129
     C***********          ELSE                                     077129086254
     C***********          MOVE TINTD0    ZFIELD                          086254
     C***********          END                                      077129086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTD0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT TOTAL DEBITED
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C**  PREPARE TOTAL TO BE DEBITED OUTPUT
     C*
     C                     MOVELNAR,28    NARR
     C*
     C                     Z-ADDCDAIC     TINTD0
     C                     ADD  WDRADJ    TINTD0                                           MD027025A
     C***********          ADD  WWADJD    TINTD0                          094433
     C***********          ADD  WWADJD    TINTD0                          094431
     C***********          ADD  WWADJD    TINTD0                          065773
     C***********          ADD  CPMADI    TINTD0                    094431094433
     C*                                                                   094433
     C* Total to be posted DR and CR capitalisation. DR calculation.      094433
     C*                                                                   094433
     C           *IN51     IFEQ '1'                                       094433
     C                     ADD  CTMADI    TINTD0                          094431
     C                     END                                            094433
     C***********TINTD0    IFLT *ZEROS                                    086254
     C***********          Z-SUBTINTD0    TINTD0                          086254
     C***********          MOVE '-'       WSIG                            086254
     C***********          END                                            086254
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE TINTD0    ZFIELD                          086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTD0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT TOTAL DEBITED
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C/COPY WNCPYSRC,RE3364EC04
     C           CER050    IFEQ 'Y'                                                           CER050
     C                     EXSR SRBDRA                                                        CER050
     C                     ENDIF                                                              CER050
     C*
     C** PREPARE TOTAL CHARGES
     C*
     C           CHGT      IFGT 0                          - B1
     C           CCHGP     ORGT 0
     C           TOTCH     IFGT 0
     C                     MOVELNAR,25    NARR
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE TOTCH     ZFIELD                          086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTOTCH     WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT3
     C                     EXSR SUBW3
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END                             - E1
     C                     END                             - E1
     C*
     C** PREPARE TOTAL CREDITED OUTPUT
     C*
     C                     MOVELNAR,10    NARR
     C*                                                                   094433
     C* Total posted DR and CR capitalisation. CR calculation.            094433
     C*                                                                   094433
     C           *IN51     IFEQ '0'
     C           CCRIS     ADD  CCRIP     TINTC0
     C                     ADD  CPMACI    TINTC0                          094431
     C                     ELSE
      *                                                                   092181
      * If 1st day accruals and cap. valued today, report total           092181
      * interest posted.                                                  092181
     C           @CPTDY    IFEQ 'Y'                                       092181
     C           SCRIP     ADD  SCRIS     TINTC0                          092181
     C                     ADD  CPMACI    TINTC0                          094433
     C                     ELSE                                           092181
     C***********          Z-ADD0         TINTC0                          094431
     C           CCRIS     ADD  CCRIP     TINTC0                          094431
     C                     ADD  CPMACI    TINTC0                          094431
     C                     END                                            092181
     C                     END
      *                                                                   104489
      * Subtract posted non-rebatable & rebatable charges.                104489
     C********** TINTC0    SUB  TOTCH     TINTC0                          104489
     C**********           SUB  CPHGAN    TINTC0                                       104489 249907
     C**********           SUB  CPHGAR    TINTC0                                       104489 249907
     C           @CPTDY    IFEQ 'Y'                                                           249907
     C                     SUB  CTHGAN    TINTC0                                              249907
     C                     SUB  CTHGAR    TINTC0                                              249907
     C                     ENDIF                                                              249907
     C*
     C***********TINTC0    IFLT 0                                         086254
     C***********          Z-SUBTINTC0    TINTC0                          077129
     C***********          Z-SUBTINTC0    INTWRK                    077129086254
     C***********          MOVE INTWRK    ZFIELD                    077129086254
     C***********          MOVE '-'       WSIG                      077129086254
     C***********          END                                            077129
     C***********          ELSE                                     077129086254
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE TINTC0    ZFIELD                          086254
     C***********          END                                      077129086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTC0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT TOTAL CREDITED
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C** PREPARE TOTAL TO BE CREDITED OUTPUT
     C*
     C                     MOVELNAR,28    NARR
     C                     Z-ADDCCAIC     TINTC0
     C                     ADD  WCRADJ    TINTC0                                           MD027025A
      *                                                                   104489
      * Subtract outstanding non-rebatable & rebatable charges.           104489
     C           CHGT      IFGT 0                                         104489
     C********** TINTC0    SUB  TOTCH     TINTC0                          104489
     C                     SUB  CTHGAN    TINTC0                          104489
     C                     SUB  CTHGAR    TINTC0                          104489
     C                     END                                            104489
     C*************        ADD  WWADJC    TINTC0                          065773
     C*
     C*                                                                   094433
     C* Total to be posted DR and CR capitalisation. CR calculation.      094433
     C*                                                                   094433
     C           *IN51     IFEQ '1'                                       094433
     C                     ADD  CTMACI    TINTC0                          094433
     C                     END                                            094433
     C***********TINTC0    IFLT *ZEROS                                    086254
     C***********          Z-SUBTINTC0    TINTC0                          086254
     C***********          MOVE '-'       WSIG                            086254
     C***********          END                                            086254
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE TINTC0    ZFIELD                          086254
      *                                                                   086254
      * edit amount with minus sign                                       086254
     C                     Z-ADDDECI1     ZADIG
     C***********          EXSR ZEDIT                                     086254
     C***********          MOVE ZFIELD    INTR                            086254
     C                     Z-ADDTINTC0    WKINT            set SR parm    086254
     C                     EXSR EDTINT                     editIntrstWith-086254
     C*
     C**  OUTPUT TOTAL CREDITED
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C/COPY WNCPYSRC,RE3364EC05
     C           CER050    IFEQ 'Y'                                                           CER050
     C                     EXSR SRBCRA                                                        CER050
     C                     ENDIF                                                              CER050
      *
     C                     Z-ADDCCRIP     TINTC0
      *                                                                   113955
     C                     END                                            113955
     C*
     C                     ENDSR                           **BOTHSR ENDSR*
     C********************************************************************                    CER050
     C**                                                                                      CER050
     C**  SRBDRA - APR Both Processing Debit                                                  CER050
     C**                                                                                      CER050
     C********************************************************************                    CER050
     C           SRBDRA    BEGSR                           **SRBDRA BEGSR*                    CER050
      *                                                                                       CER050
     C                     MOVE *OFF      *IN84                                               CER050
     C                     MOVE *BLANKS   VALDA                                               CER050
     C                     MOVE *BLANKS   PSTDA                                               CER050
      *                                                                                       CER050
      ** Move APR narrative to screen narrative field.                                        CER050
     C                     MOVELUIANAR    NARR                                                CER050
      *                                                                                       CER050
      ** Get debit APR rate from LF/REAPRHI0.                                                 CER050
     C           ACNO      CHAINREAPRHI0             84                                       CER050
      *                                                                                       CER050
      ** If rate not found move *ZEROs to field, else move rate.                              CER050
     C                     MOVE *BLANKS   ZFIELD                                              CER050
     C           *IN84     IFEQ *ON                                                           CER050
     C           ATAPRC    ORNE 'Y'                                                           CER050
     C                     MOVE APR0      APRNO                                               CER050
     C                     ELSE                                                               CER050
     C                     MOVE IAPRR     ZFIELD                                              CER050
      *                                                                                       CER050
      ** format APR rate and move to screen field.                                            CER050
     C                     Z-ADD2         ZADEC                                               CER050
     C                     EXSR ZEDIT                                                         CER050
     C           *IN99     IFEQ *OFF                                                          CER050
     C                     MOVE ZFIELD    APRNO                                               CER050
     C                     ENDIF                                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     MOVELAPR       RATOMP                                              CER050
     C                     Z-ADDSAVEZ     ZADEC                                               CER050
      *                                                                                       CER050
     C                     EXSR OUT1SR                                                        CER050
     C                     MOVELAREA      SDAT1                                               CER050
     C                     EXSR SUBW1                                                         CER050
     C                     ENDSR                           **SRBDRA ENDSR*                    CER050
     C/EJECT                                                                                  CER050
     C********************************************************************                    CER050
     C**                                                                                      CER050
     C**  SRBCRA - APR Both Processing Credit                                                 CER050
     C**                                                                                      CER050
     C********************************************************************                    CER050
     C           SRBCRA    BEGSR                           **SRBCRA BEGSR*                    CER050
      *                                                                                       CER050
     C                     MOVE *OFF      *IN84                                               CER050
     C                     MOVE *BLANKS   VALDA                                               CER050
     C                     MOVE *BLANKS   PSTDA                                               CER050
      *                                                                                       CER050
      ** Move APR narrative to screen narrative field                                         CER050
     C                     MOVELUIANAR    NARR                                                CER050
      *                                                                                       CER050
      ** Get credit APR rate from LF/REAPRHI1.                                                CER050
     C           ACNO      CHAINREAPRHI1             84                                       CER050
      *                                                                                       CER050
      ** If rate not found move *ZEROs to field, else move rate.                              CER050
     C                     MOVE *BLANKS   ZFIELD                                              CER050
     C           *IN84     IFEQ *ON                                                           CER050
     C           ATAPRC    ORNE 'Y'                                                           CER050
     C                     MOVE APR0      APRNO                                               CER050
     C                     ELSE                                                               CER050
     C                     MOVE IAPRR     ZFIELD                                              CER050
      *                                                                                       CER050
      ** format APR rate and move to screen field.                                            CER050
     C                     Z-ADD2         ZADEC                                               CER050
     C                     EXSR ZEDIT                                                         CER050
     C           *IN99     IFEQ *OFF                                                          CER050
     C                     MOVE ZFIELD    APRNO                                               CER050
     C                     ENDIF                                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     MOVELAPR       RATOMP                                              CER050
     C                     Z-ADDSAVEZ     ZADEC                                               CER050
      *                                                                                       CER050
     C                     EXSR OUT1SR                                                        CER050
     C                     MOVELAREA      SDAT2                                               CER050
     C                     EXSR SUBW2                                                         CER050
     C                     ENDSR                           **SRBCRA ENDSR*                    CER050
     C/EJECT                                                                                  CER050
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** B1EQ subroutine for begin when same date
     C**
     C**     Called by     BOTHSR
     C**
     C**     Calls         ZDATE2, RDRSR, RCRSR, POSTSR, DBSR, ZEDIT,
     C**                   SUBW1, SUBW2
     C**
     C           B1EQ      BEGSR                           **B1EQ   BEGSR*
     C*
     C           KLIST2    SETLLREHPOPH                  55
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C           *IN55     DOWEQ'0'                        - B1
     C           PSTD      ANDLECHISD                                     094431
     C***********PSTD      ANDLTCHISD                                     040447
     C********** PSTD      ANDLECHISD                              040447 065773
     C***********PSTD      ANDGECLDID                              065773 094431
     C*
     C           HISD      IFLT CLDID
     C           PSTD      ANDGTCLDID                                     094431
     C           BMLDAI    ANDEQ'N'                                       094431
     C           HISD      ORLT CLDID                                     094431
     C           PSTD      ANDGECLDID                                     094431
     C           BMLDAI    ANDEQ'Y'                                       094431
     C*
     C           RECI      IFEQ 'P'
     C                     EXSR POSTSR
     C                     END
     C*
     C           RECI      IFEQ 'R'
     C           DRCR      IFEQ 0
     C***********HISD      ANDLTCLDID                                     094431
     C*********  PSTD      ANDGTCLDID                                     065773
     C***********PSTD      ANDGECLDID                              065773 094431
     C                     Z-ADDHISD      DDRCD
     C***********          EXSR RDRSR                                     103862
     C                     EXSR RATED                                     103862
      *                                                                   CRE001
      **  OUTPUT ADDITIONAL OVERDRAFT RATE IF INTEREST TYPE IS ZERO       CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C********** DDICT     IFEQ *ZEROS                                                 CRE001 206671
     C                     MOVELNAR,34    NARR                            CRE001
     C                     EXSR RDRAO                                     CRE001
     C                     MOVELNAR,33    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C**********           END                                                         CRE001 206671
     C                     END                                            CRE001
      *                                                                   CRE001
     C                     END
     C*
     C           DRCR      IFEQ 1
     C***********HISD      ANDLTCLCID                                     094431
     C*********  PSTD      ANDGTCLCID                                     065773
     C***********PSTD      ANDGECLCID                              065773 094431
     C                     Z-ADDHISD      DCRCD
     C***********          EXSR RCRSR                                     103862
     C                     EXSR RATEC                                     103862
     C                     END
     C*
     C                     END
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C                     END                             - E1
      *                                                                   101483
      ** & Reset partially setup output narratives                        101483
     C                     EXSR RESET                                     101483
      *                                                                   099509
      *  Reset the Backvalued Rate-changes Indicators                     099509
      *                                                                   099509
     C                     MOVE *OFF      *IN21                           099509
     C                     MOVE *OFF      *IN22                           099509
     C*
     C***********KLIST1    SETLLREHISSL                  20               075071
     C*
     C************IN20     IFEQ '1'                        - B2           075071
     C***********KLIST1    READEREADJF                   20               075071
      ***********                                                         103860
     C***********KLIST1    CHAINREADJF               20            075071 103860
     C************IN20     DOWEQ'0'                        - B3           103860
     C***********AHISD     IFLT CLDID                                     103860
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C***********SDCI      IFEQ 'Y'                                       099509
     C***********SCCI      OREQ 'Y'                                       099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C***********SCCI      ORNE *BLANK                             099509 103860
     C*
     C***********PPSTD     IFNE RUND                       - B1           103860
     C***********          Z-ADDRUND      ZDAYNO                          103860
     C***********          MOVE '0'       *IN99                           103860
     C***********          EXSR ZDATE2                                    103860
     C*
     C****VERIFY*IF*ERROR**********************************************   103860
     C*
     C************IN99     IFEQ '1'                        - B2           103860
     C************LOCK     IN   LDA                                       103860
     C***********          MOVELRUND      DBKEY                           103860
     C***********          Z-ADD026       DBASE                           103860
     C***********          MOVE 'ZDATE2'  DBFILE           ***************103860
     C***********          OUT  LDA                        * DB ERROR 026*103860
     C***********          MOVEA'1'       *IN,89           ***************103860
     C***********          EXSR DBSR                                      103860
      ***********                                                         103860
      *****************************************************************   103860
     C***********          END                             - E2           103860
     C*
     C***********          Z-ADDRUND      PPSTD                           103860
     C***********          MOVE ZDATE     PPSTDO                          103860
     C*
     C***********          END                             - E1           103860
     C*
     C***********          MOVE PPSTDO    PSTDA                           103860
     C***********          MOVE PPSTDO    PSTD2                           103860
     C*
     C***********PVALD     IFNE AHISD                      - B1           103860
     C***********          Z-ADDAHISD     ZDAYNO                          103860
     C***********          MOVE '0'       *IN99                           103860
     C***********          EXSR ZDATE2                                    103860
     C*
     C****VERIFY*IF*ERROR**********************************************   103860
     C*
     C************IN99     IFEQ '1'                        - B2           103860
     C************LOCK     IN   LDA                                       103860
     C***********          MOVELAHISD     DBKEY                           103860
     C***********          Z-ADD027       DBASE                           103860
     C***********          MOVE 'ZDATE2'  DBFILE           ***************103860
     C***********          OUT  LDA                        * DB ERROR 027*103860
     C***********          MOVEA'1'       *IN,89           ***************103860
     C***********          EXSR DBSR                                      103860
     C***********          END                             - E2           103860
     C*
     C***********          Z-ADDAHISD     PVALD                           103860
     C***********          MOVE ZDATE     PVALDO                          103860
     C*
     C***********          END                             - E1           103860
     C*
     C***********          MOVE PVALDO    VALDA                           103860
     C***********          MOVE PVALDO    VALD2                           103860
     C*
      **Check*where*the*adjustment*is*to*be*posted*to*:*********** 099509 103860
      *                                                                   099509
     C***********          SELEC                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SDCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR                     099509 103860
      **Suspence*acc********************************************** 099509 103860
     C***********SDCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR                     099509 103860
      **this*acc************************************************** 099509 103860
     C***********          OTHER                                   099509 103860
     C***********          MOVELNAR,29    NARR                            103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********          SELEC                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SCCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR2                    099509 103860
      **Suspence*acc********************************************** 099509 103860
     C***********SCCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR2                    099509 103860
      **this*acc************************************************** 099509 103860
     C***********          OTHER                                   099509 103860
     C***********          MOVELNAR,29    NARR2                           103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********SDCI      IFEQ 'Y'                                       099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C***********ADAIC     ANDNE*ZEROS                                    103860
     C***********ADAIC     IFLT *ZERO                                     103860
     C***********          Z-SUBADAIC     PSTD0                           103860
     C***********          MOVEL'CR'      CR                              103860
     C***********          MOVEL'CR'      CR2                             103860
     C***********          ELSE                                           103860
     C***********          Z-ADDADAIC     PSTD0                           103860
     C***********          MOVEL'  '      CR                              103860
     C***********          MOVEL'  '      CR2                             103860
     C***********          END                                            103860
     C***********          MOVE *BLANK    ZFIELD                          103860
     C***********          MOVE PSTD0     ZFIELD                          103860
     C***********          Z-ADDDECI1     ZADIG                           103860
     C***********          EXSR ZEDIT                                     103860
     C***********          MOVE ZFIELD    AMON                            103860
     C***********          MOVE ZFIELD    AMON2                           103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR             formatAREAType1 086093 103860
     C***********          MOVELAREA      SDAT1                           103860
     C***********          MOVELAREA      SDAT2                           103860
     C***********          EXSR SUBW1                                     103860
      ************************************************************ CRE001 103860
      ****OUTPUT*ADDITIONAL*OVERDRAFT*RATE*IF*INTEREST*TYPE*IS*ZER CRE001 103860
     C***********CRE001    IFEQ 'Y'                                CRE001 103860
     C***********DDICT     IFEQ *ZEROS                             CRE001 103860
     C***********          MOVELNAR,34    NARR                     CRE001 103860
     C***********          EXSR RDRAO                              CRE001 103860
     C***********          MOVELNAR,33    NARR                     CRE001 103860
     C***********          EXSR RDROD                              CRE001 103860
     C***********          END                                     CRE001 103860
     C***********          END                                     CRE001 103860
      *                                                                   CRE001
     C***********          EXSR SUBW2                                     103860
     C***********          END                                            103860
     C***********SCCI      IFEQ 'Y'                                       099509
     C***********SCCI      IFNE *BLANK                             099509 103860
     C***********ACAIC     ANDNE*ZEROS                                    103860
     C***********ACAIC     IFLT *ZERO                                     103860
     C***********          Z-SUBACAIC     PSTD0                           103860
     C***********          MOVEL'  '      CR                              103860
     C***********          MOVEL'  '      CR2                             103860
     C***********          ELSE                                           103860
     C***********          Z-ADDACAIC     PSTD0                           103860
     C***********          MOVEL'CR'      CR                              103860
     C***********          MOVEL'CR'      CR2                             103860
     C***********          END                                            103860
     C***********          MOVE *BLANK    ZFIELD                          103860
     C***********          MOVE PSTD0     ZFIELD                          103860
     C***********          Z-ADDDECI1     ZADIG                           103860
     C***********          EXSR ZEDIT                                     103860
     C***********          MOVE ZFIELD    AMON                            103860
     C***********          MOVE ZFIELD    AMON2                           103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR             formatAREAType1 086093 103860
     C***********          MOVELAREA      SDAT1                           103860
     C***********          MOVELAREA      SDAT2                           103860
     C***********          EXSR SUBW1                                     103860
     C***********          EXSR SUBW2                                     103860
     C***********          END                                            103860
     C*
     C***********          END                                            103860
     C*
     C***********          END                             - E3           103860
     C***********KLIST1    READEREADJF                   20               103860
     C***********          END                             - E3           103860
     C***********          END                             - E3           075071
      *                                                                   103860
      ** Check for generated adjustments before start date.               103860
      *                                                                   103860
     C           KLIST1    SETLLREHISSL                  80               103860
     C           *IN80     IFEQ '1'                                       103860
     C           KLIST1    READEREADJF                   80               103860
     C           *IN80     DOWEQ'0'                                       103860
     C           AHISD     ANDLTCLDID                                     103860
     C                     SETON                     4142                 103860
     C                     EXSR #ADJ                                      103860
     C                     SETOF                     4142                 103860
     C           KLIST1    READEREADJF                   80               103860
     C                     END                                            103860
     C                     END                                            103860
      *                                                                   103860
     C                     Z-ADDW1HISB    HISB0
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C                     MOVELNAR,2     NARR
     C*
     C           PVALD     IFNE CLDID                      - B1
     C                     Z-ADDCLDID     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD028       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 028*
     C                     MOVELCLDID     DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDCLDID     PVALD
     C                     MOVELZDATE     PVALDO
     C*
     C                     END                             - E1
     C*
     C                     MOVELPVALDO    VALDA
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW1
     C                     EXSR SUBW2
     C*
     C* RESET HISTORY BALANCE
     C*
     C                     Z-ADDWHISBD    HISB0
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C           *IN21     IFEQ '0'                                       075079
     C                     MOVELNAR,3     NARR
     C                     ELSE                                           075079
     C                     MOVELNAR,4     NARR                            075079
     C                     END                                            075079
     C*
     C**  ACCESS REHRDJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR DEBIT RATE CHANGE TO
     C*
     C           KLIST2    SETLLREHRDJ                   60
     C*
     C           DRECI     IFEQ 'B'
     C           *IN60     ANDEQ'1'
     C           KLIST2    READEREHRDJ                   62
     C           *IN62     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     END
     C*****N60   KLIST1    REDPEREHRDJ                   62               092182
     C           *IN60     IFEQ '0'                                       092182
     C           DRECI     OREQ 'S'                                       092182
     C           *IN60     ANDEQ'1'                                       092182
     C           KLIST1    REDPEREHRDJ                   62               092182
     C                     END                                            092182
     C           *IN62     IFEQ '1'
     C                     Z-ADD*ZEROS    DRIR
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE DRIR      ZFIELD                          086254
     C*                                                                   075079
     C***********          Z-ADDDECI2     ZADIG                     075079086254
     C***********          Z-ADD7         ZADEC                     075079086254
     C***********          EXSR ZEDIT                               075079086254
     C***********          MOVE ZFIELD    RATO                      075079086254
     C*                                                                   075079
      * output 0% Percentage rate (using constant)                        086254
     C                     MOVELZRCTCN    RATOMP           '0.0000000%'   086254
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C***********          MOVE '1'       *IN87                           086093
     C***********          EXCPTOUT1                                      086093
     C                     EXSR OUT1SR                     formatAREAType1086093
     C                     MOVE '1'       *IN21                           097423
     C***********          MOVE '1'       *IN22                     075079089027
     C***********          MOVE '0'       *IN87                           086093
     C***********          READ GHOST                    99               086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C                     ELSE                            - X1
     C*
     C**  OUTPUT DEBIT RATE CHANGE TO
     C*
     C                     EXSR RDRSR
      *                                                                   CRE001
      **  OUTPUT ADDITIONAL OVERDRAFT RATE IF INTEREST TYPE IS ZERO       CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C********** DDICT     IFEQ *ZEROS                                                 CRE001 206671
     C                     MOVELNAR,34    NARR                            CRE001
     C                     EXSR RDRAO                                     CRE001
     C                     MOVELNAR,33    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C**********           END                                                         CRE001 206671
     C                     END                                            CRE001
      *                                                                   CRE001
     C                     END
     C*
     C           *IN22     IFEQ '0'                                       075079
     C                     MOVELNAR,8     NARR
     C                     ELSE                                           075079
     C                     MOVELNAR,9     NARR                            075079
     C                     END                                            075079
     C*
     C**  ACCESS REHRCJ (REHPOSR1 REHPOSR2 REHPOSR3) WHICH CONTAINS
     C**  THE GOOD DATES FOR CREDIT RATE CHANGE TO
     C*
     C           KLIST3    SETLLREHRCJ                   60
     C*
     C           DRECI     IFEQ 'B'
     C           *IN60     ANDEQ'1'
     C           KLIST3    READEREHRCJ                   62
     C           *IN62     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     END
     C*****N60   KLIST1    REDPEREHRCJ                   62               092182
     C           *IN60     IFEQ '0'                                       092182
     C           DRECI     OREQ 'S'                                       092182
     C           *IN60     ANDEQ'1'                                       092182
     C           KLIST1    REDPEREHRCJ                   62               092182
     C                     END                                            092182
     C           *IN62     IFEQ '1'
     C                     Z-ADD*ZEROS    CRIR
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C***********          MOVE *BLANKS   ZFIELD                          086254
     C***********          MOVE CRIR      ZFIELD                          086254
     C***********          Z-ADDDECI2     ZADIG                     075079086254
     C***********          Z-ADD7         ZADEC                     075079086254
     C***********          EXSR ZEDIT                               075079086254
     C***********          MOVE ZFIELD    RATO                      075079086254
     C*                                                                   075079
      * output 0% Percentage rate (using constant)                        086254
     C                     MOVELZRCTCN    RATOMP           '0.0000000%'   086254
     C                     Z-ADDSAVEZ     ZADEC
     C*
     C***********          MOVE '1'       *IN87                           086093
     C***********          EXCPTOUT1                                      086093
     C                     EXSR OUT1SR                     formatAREAType1086093
     C                     MOVE '1'       *IN22                           075079
     C***********          MOVE '0'       *IN87                           086093
     C***********          READ GHOST                    99               086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C                     ELSE                            - X1
     C*
     C****OUTPUT*DEBIT*RATE*CHANGE*TO                                     094433
     C**  OUTPUT CREDIT RATE CHANGE TO                                    094433
     C*
     C                     EXSR RCRSR
     C                     END
     C*
      *                                                                   099509
      ***Check*for*'Generated*Adjustments*To*be*Posted'*********** 099509 103860
      *                                                                   099509
     C***********          MOVE *ON       *IN41                    099509 103860
     C***********          MOVE *ON       *IN42                    099509 103860
     C***********          EXSR #ADJ                               065773 103860
     C***********          MOVE *OFF      *IN41                    099509 103860
     C***********          MOVE *OFF      *IN42                    099509 103860
     C***********KLIST2    SETLLREHPOPL                  55               086254
      *                                                                   088826
      * Set Limits with  Debit Capitalisation day                         088826
     C                     EXSR SETPOD                     Setll REHPOPL. 088826
      *                                                                   088826
     C***********KLIST1    READEREHPOPL                  55               088826
     C*
     C                     ENDSR                           **B1EQ   ENDSR*
     C********************************************************************
     C/EJECT                                                              065773
     C********************************************************************065773
     C**                                                                  065773
     C***#ADJ*subroutine*for*begin*OF*PERIOD*ADJUSTEMENT*DUE****** 065773 103860
     C** #ADJ subroutine for processing generated adjustments             103860
     C**                                                                  065773
     C*******Called by*******#ADJ                                   065773099509
     C*******Called*by*******DRSR*CRSR*B1EQ*B1LT****************** 099509 103860
     C**     Called by       DRSR CRSR B1EQ B1LT B1GT BOTHSR              103860
     C** NOTE:   Hadrcoded within B1GT                                    099509
     C**                                                                  065773
     C*******Calls***********ZDATE2, RDRSR, RCRSR                   065773099509
     C**     Calls           SUBW1 SUBW2 OUT2SR ZDATE2 ZEDIT              099509
     C**                                                                  065773
     C           #ADJ      BEGSR                           **#ADJ   BEGSR*065773
     C***********KLIST1    SETLLREHISSL                  20        086230 103860
     C***********KLIST1    SETLLREHISSL                  20         065773075071
     C*                                                                   065773
     C************IN20     IFEQ *ON                                086230 103860
     C***********KLIST1    READEREADJF                   20        086230 103860
     C************IN20     IFEQ '1'                        - B2     065773075071
     C***********KLIST1    READEREADJF                   20         065773075071
     C***********KLIST1    CHAINREADJF               20             075071086230
     C************IN20     DOWEQ'0'                        - B3    065773 103860
     C***********AHISD     IFEQ CLDID                              065773 103860
     C************IN41     ANDEQ*ON                                099509 103860
     C***********AHISD     OREQ CLCID                              099509 103860
     C************IN42     ANDEQ*ON                                099509 103860
     C*                                                                   065773
     C** PRINT INTEREST OF THE BACK VALUE DATE                            065773
     C*                                                                   065773
     C                     MOVEA'01'      *IN,85                          103860
     C                     MOVE *BLANK    ADJFLG                          103860
      *                                                                   103860
     C***********SDCI      IFEQ 'Y'                                 065773099509
     C***********SCCI      OREQ 'Y'                                 065773099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C***********SCCI      ORNE *BLANK                             099509 103860
     C           ASDCI     IFNE *BLANK                                    103860
     C           ASCCI     ORNE *BLANK                                    103860
     C*                                                                   065773
     C           PPSTD     IFNE RUND                       - B1           065773
     C                     Z-ADDRUND      ZDAYNO                          065773
     C                     MOVE '0'       *IN99                           101332
     C                     EXSR ZDATE2                                    065773
     C*                                                                   065773
     C**  VERIFY IF ERROR                                                 065773
     C*                                                                   065773
     C           *IN99     IFEQ '1'                        - B2           065773
     C           *LOCK     IN   LDA                                       065773
     C                     MOVELRUND      DBKEY                           065773
     C                     Z-ADD41        DBASE                           065773
     C                     MOVE 'ZDAT2'   DBFILE           ***************065773
     C*                                                    **DB ERROR 41**065773
     C                     OUT  LDA                        ***************065773
     C                     MOVEA'1'       *IN,89                          065773
     C                     EXSR DBSR                                      065773
     C                     END                             - E2           065773
     C*                                                                   065773
     C                     Z-ADDRUND      PPSTD                           065773
     C                     MOVE ZDATE     PPSTDO                          065773
     C*                                                                   065773
     C                     END                             - E1           065773
     C*                                                                   065773
     C                     MOVE PPSTDO    PSTDA                           065773
     C***********          MOVE PPSTDO    PSTD2                    065773 103860
     C*                                                                   065773
     C           PVALD     IFNE AHISD                      - B1           065773
     C                     Z-ADDAHISD     ZDAYNO                          065773
     C                     MOVE '0'       *IN99                           101332
     C                     EXSR ZDATE2                                    065773
     C*                                                                   065773
     C**  VERIFY IF ERROR                                                 065773
     C*                                                                   065773
     C           *IN99     IFEQ '1'                        - B2           065773
     C           *LOCK     IN   LDA
     C                     MOVELAHISD     DBKEY                           065773
     C                     Z-ADD422       DBASE                           065773
     C                     MOVE 'ZDAT2'   DBFILE           ***************065773
     C*                                                    **DB ERROR 42**065773
     C                     OUT  LDA                        ***************065773
     C                     MOVEA'1'       *IN,89                          065773
     C                     EXSR DBSR                                      065773
     C                     END                             - E2           065773
     C*                                                                   065773
     C                     Z-ADDAHISD     PVALD                           065773
     C                     MOVE ZDATE     PVALDO                          065773
     C*                                                                   065773
     C                     END                             - E1           065773
     C*                                                                   065773
     C                     MOVE PVALDO    VALDA                           065773
     C***********          MOVE PVALDO    VALD2                    065773 103860
     C*                                                                   065773
     C                     MOVE *BLANKS   ND                              103860
      *                                                                   103860
      **Check*where*the*adjustment*is*to*be*posted*to*:*********** 099509 103860
      *                                                                   099509
     C***********          SELEC                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SDCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR                     099509 103860
      **Suspence*acc********************************************** 099509 103860
     C***********SDCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR                     099509 103860
      **this*acc************************************************** 099509 103860
     C***********          MOVELNAR,29    NARR                     065773 103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********          SELEC                                   099509 103860
     C***********          OTHER                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SCCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR2                    099509 103860
      **Suspence*acc**********************************************        099509
     C***********SCCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR2                    099509 103860
      **this*acc************************************************** 099509 103860
     C***********          OTHER                                   099509 103860
     C***********          MOVELNAR,29    NARR2                    065773 103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********SDCI      IFEQ 'Y'                                 065773099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C           ASDCI     IFNE *BLANK                                    103860
     C           ADAIC     ANDNE*ZEROS                                    065773
      *                                                                   103860
      * Check where the adjustment is to be posted to.                    103860
     C                     SELEC                                          103860
      * Alt acc                                                           103860
     C           ASDCI     WHEQ 'A'                                       103860
     C**********           MOVELNAR,40    NARR                     103860 162759
     C                     MOVELNAR,46    NARR                            162759
      * Suspense acc                                                      103860
     C           ASDCI     WHEQ 'S'                                       103860
     C**********           MOVELNAR,42    NARR                     103860 162759
     C                     MOVELNAR,48    NARR                            162759
      * this acc                                                          103860
     C                     OTHER                                          103860
     C**********           MOVELNAR,38    NARR                     103860 162759
     C                     MOVELNAR,44    NARR                            162759
     C                     MOVE 'Y'       ADJFLG                          103860
     C                     ENDSL                                          103860
      *                                                                   103860
     C           ADAIC     IFLT *ZERO                                     065773
     C                     Z-SUBADAIC     PSTD0                           065773
     C                     MOVEL'CR'      CR                              065773
     C***********          MOVEL'CR'      CR2                      065773 103860
     C                     ELSE                                           065773
     C                     Z-ADDADAIC     PSTD0                           065773
     C                     MOVEL'  '      CR                              065773
     C***********          MOVEL'  '      CR2                      065773 103860
     C                     END                                            065773
     C                     MOVE *BLANK    ZFIELD                          065773
     C                     MOVE PSTD0     ZFIELD                          065773
     C                     Z-ADDDECI1     ZADIG                           065773
     C                     EXSR ZEDIT                                     065773
     C                     MOVE ZFIELD    AMON                            065773
     C***********          MOVE ZFIELD    AMON2                    065773 103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1                           065773
     C                     MOVELAREA      SDAT2                           065773
     C           *IN41     IFEQ *ON                                       099509
     C                     EXSR SUBW1                                     065773
     C                     ENDIF                                          099509
     C           *IN42     IFEQ *ON                                       099509
     C                     EXSR SUBW2                                     065773
     C                     ENDIF                                          099509
     C                     END                                            065773
     C***********SCCI      IFEQ 'Y'                                 065773099509
     C***********SCCI      IFNE *BLANK                             099509 103860
     C           ASCCI     IFNE *BLANK                                    103860
     C           ACAIC     ANDNE*ZEROS                                    065773
      *                                                                   103860
      * Check where the adjustment is to be posted to.                    103860
     C                     SELEC                                          103860
      * Alt acc                                                           103860
     C           ASCCI     WHEQ 'A'                                       103860
     C**********           MOVELNAR,39    NARR                     103860 162759
     C                     MOVELNAR,45    NARR                            162759
      * Suspense acc                                                      103860
     C           ASCCI     WHEQ 'S'                                       103860
     C**********           MOVELNAR,41    NARR                     103860 162759
     C                     MOVELNAR,47    NARR                            162759
      * this acc                                                          103860
     C                     OTHER                                          103860
     C**********           MOVELNAR,37    NARR                     103860 162759
     C                     MOVELNAR,43    NARR                            162759
     C                     MOVE 'Y'       ADJFLG                          103860
     C                     ENDSL                                          103860
      *                                                                   103860
     C           ACAIC     IFLT *ZERO                                     065773
     C                     Z-SUBACAIC     PSTD0                           065773
     C                     MOVEL'  '      CR                              065773
     C***********          MOVEL'  '      CR2                      065773 103860
     C                     ELSE                                           065773
     C                     Z-ADDACAIC     PSTD0                           065773
     C                     MOVEL'CR'      CR                              065773
     C**********           MOVEL'CR'      CR2                      065773 103860
     C                     END                                            065773
     C                     MOVE *BLANK    ZFIELD                          065773
     C                     MOVE PSTD0     ZFIELD                          065773
     C                     Z-ADDDECI1     ZADIG                           065773
     C                     EXSR ZEDIT                                     065773
     C                     MOVE ZFIELD    AMON                            065773
     C***********          MOVE ZFIELD    AMON2                    065773 103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1                           065773
     C                     MOVELAREA      SDAT2                           065773
     C           *IN41     IFEQ *ON                                       099509
     C                     EXSR SUBW1                                     065773
     C                     ENDIF                                          099509
     C           *IN42     IFEQ *ON                                       099509
     C                     EXSR SUBW2                                     065773
     C                     ENDIF                                          099509
     C                     END                                            065773
     C*                                                                   065773
     C                     END                                            065773
     C*                                                                   065773
     C***********          END                             - E3    065773 103860
     C***********KLIST1    READEREADJF                   20        065773 103860
     C***********          END                             - E3    065773 103860
     C***********          END                             - E3     065773075071
     C***********          ENDIF                                   086230 103860
     C                     ENDSR                           - E3           065773
     C********************************************************************065773
     C/EJECT                                                              094431
     C********************************************************************094431
     C**                                                                  094431
     C** MANUEQ SUBROUTINE TO DISPLAY MANUAL ADJUSTMENT -                 094431
     C** CALLED FROM B1EQ                                                 094431
     C**                                                                  094431
     C********************************************************************094431
     C           MANUEQ    BEGSR                           **MANUEQ BEGSR*094431
     C*                                                                   094431
     C           KMANUD    SETLLREHPOML3                 91               094431
     C*                                                                   094431
     C           KMANUD    READEREHPOML3                 91               094431
     C*                                                                   094431
     C           *IN91     DOWEQ'0'                        - B1           094431
     C*                                                                   094431
     C           CRIA      IFNE 0                                         094431
     C           CLCID     ANDNESVDATC                                    099511
     C                     EXSR #CREDI                                    094431
     C                     END                                            094431
     C*                                                                   094431
     C           DRIA      IFNE 0                                         094431
     C           CLDID     ANDNESVDATD                                    099511
     C                     EXSR #DEBI                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C           KMANUD    READEREHPOML3                 91               094431
     C                     END                             - E1           094431
     C*                                                                   094431
     C                     ENDSR                           **MANU   ENDSR*094431
     C********************************************************************094431
     C/EJECT                                                              094431
     C********************************************************************094431
     C**                                                                  094431
     C** MANUDR  SUBROUTINE TO DISPLAY MANUAL ADJUSTMENT -                094431
     C** CALLED FROM B1LT - B1GT                                          094431
     C**                                                                  094431
     C********************************************************************094431
     C           MANUDR    BEGSR                           **MANUDR BEGSR*094431
     C*                                                                   094431
     C** PROCESS DR MANUAL ADJUSTMENTS                                    094431
     C           KMANUD    SETLLREHPOML3                 91               094431
     C*                                                                   094431
     C           KMANUD    READEREHPOML3                 91               094431
     C*                                                                   094431
     C           *IN91     DOWEQ'0'                        - B1           094431
     C*                                                                   094431
     C           DRIA      IFNE 0                                         094431
     C                     EXSR #DEBI                                     094431
     C                     END                                            094431
     C*                                                                   094431
     C           KMANUD    READEREHPOML3                 91               094431
     C                     END                             - E1           094431
     C*                                                                   094431
     C                     ENDSR                           **MANUDR ENDSR*094431
     C********************************************************************094431
     C/EJECT                                                              094431
     C********************************************************************094431
     C**                                                                  094431
     C** MANUCR  SUBROUTINE TO DISPLAY MANUAL ADJUSTMENT -                094431
     C** CALLED FROM B1LT - B1GT                                          094431
     C**                                                                  094431
     C********************************************************************094431
     C           MANUCR    BEGSR                           **MANUCR BEGSR*094431
     C** PROCESS CR MANUAL ADJUSTMENTS                                    094431
     C           KMANUC    SETLLREHPOML3                 91               094431
     C*                                                                   094431
     C           KMANUC    READEREHPOML3                 91               094431
     C*                                                                   094431
     C           *IN91     DOWEQ'0'                        - B1           094431
     C*                                                                   094431
     C           CRIA      IFNE 0                                         094431
     C                     EXSR #CREDI                                    094431
     C                     END                                            094431
     C*                                                                   094431
     C           KMANUC    READEREHPOML3                 91               094431
     C                     END                             - E1           094431
     C*                                                                   094431
     C                     ENDSR                           **MANUCR ENDSR*094431
     C********************************************************************094431
     C/EJECT
     C********************************************************************
     C**
     C** B1LT subroutine for begin when debit lower than credit
     C**
     C**     Called by     BOTHSR
     C**
     C**     Calls         ZDATE2, RDRSR, RCRSR, DBSR, ZEDIT, SUBW1,
     C**                   SUBW2, SUBW3, OPENCR, OPENDR
     C**
     C           B1LT      BEGSR                           **B1LT   BEGSR*
     C*
     C           KLIST2    SETLLREHPOPH                  55
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C           *IN55     DOWEQ'0'                        - B1
     C*********  PSTD      ANDLTRUND                                      065773
     C           PSTD      ANDLERUND                                      065773
     C*
     C           HISD      IFLT CLDID
     C           HISD      ORLT CLCID
     C*
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD029       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 029*
     C                     MOVELPSTD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     MOVE ZDATE     PPSTDO  6
     C*
     C                     END                             - E1
     C*
     C                     MOVE PPSTDO    PSTDA
     C                     MOVE PPSTDO    PSTD2
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD030       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 030*
     C                     MOVELHISD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDHISD      PVALD
     C                     MOVE ZDATE     PVALDO  6
     C*
     C                     END                             - E1
     C*
     C                     MOVE PVALDO    VALDA
     C                     MOVE PVALDO    VALD2
     C*
     C           RECI      IFEQ 'P'
     C                     MOVELPNAR      NARR
     C                     MOVELPNAR      NARR2
     C*
     C                     Z-ADDPSTA      PSTD0
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE PSTD0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C                     MOVE ZFIELD    AMON2
     C*
     C           CCHGP     IFGT 0                          - B1
     C           CHGT      ORGT 0                          - B1
     C           CHGA      IFNE 0
     C           REBI      IFEQ 'Y'                        - B2
     C                     MOVE 'Y'       REB
     C                     ELSE                            - X2
     C                     MOVE ' '       REB
     C                     END                             - E2
     C***********          ADD  CHGA      TOTCH                           094431
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ' '       HSIG
     C           CHGA      IFLT 0
     C                     MOVE '-'       HSIG
     C                     Z-SUBCHGA      CHGA
     C                     END
     C                     MOVE CHGA      ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    CHAR
     C                     END                             - E1
     C                     END                             - E1
     C*
     C           DRCR      IFEQ 1                          - B1
     C                     MOVE 'CR'      CR               - X1
     C                     MOVE 'CR'      CR2
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     MOVE *BLANKS   CR2                             100992
     C                     END                             - E1
     C*
     C           HISD      IFLT CLCID
     C*********  PSTD      ANDGTCLCID                                     065773
     C           PSTD      ANDGECLCID                                     065773
     C           CCHGP     IFGT 0                          - B1
     C           CHGT      ORGT 0                          - B1
     C           CHGA      IFNE 0
     C                     ADD  CHGA      TOTCH                           094431
     C***********          EXCPTOUT3                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT3SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT3
     C                     EXSR SUBW3
     C                     END
     C                     END
     C                     END
     C*
     C           TURN      IFEQ 'Y'                                       064993
     C                     MOVE '*'       COMMVT                          064993
     C                     ENDIF                                          064993
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C           HISD      IFLT CLDID                                     065773
     C           PSTD      ANDGECLDID                                     065773
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END                                            065773
     C           HISD      IFLT CLCID
     C***********PSTD      ANDGTCLCID                                     065773
     C           PSTD      ANDGECLCID                                     065773
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END
     C                     MOVE *BLANKS   COMMVT                          064993
     C                     END
     C           RECI      IFEQ 'R'
     C           DRCR      IFEQ 0
     C           HISD      ANDLTCLDID
     C***********PSTD      ANDGTCLDID                                     065773
     C           PSTD      ANDGECLDID                                     065773
     C                     Z-ADDHISD      DDRCD
     C***********          EXSR RDRSR                                     103862
     C                     EXSR RATED                                     103862
      *                                                                   CRE001
      **  OUTPUT ADDITIONAL OVERDRAFT RATE IF INTEREST TYPE IS ZERO       CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C********** DDICT     IFEQ *ZEROS                                                 CRE001 206671
     C                     MOVELNAR,34    NARR                            CRE001
     C                     EXSR RDRAO                                     CRE001
     C                     MOVELNAR,33    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C**********           END                                                         CRE001 206671
     C                     END                                            CRE001
      *                                                                   CRE001
     C                     END
     C*
     C           DRCR      IFEQ 1
     C           HISD      ANDLTCLCID
     C***********PSTD      ANDGTCLCID                                     065773
     C           PSTD      ANDGECLCID                                     065773
     C                     Z-ADDHISD      DCRCD
     C***********          EXSR RCRSR                                     103862
     C                     EXSR RATEC                                     103862
     C                     END
     C*
     C                     END
     C*
     C** RESET INDICATOR
     C*
     C                     MOVE '0'       *IN26
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C                     END                             - E1
      *                                                                   101483
      ** & Reset partially setup output narratives                        101483
     C                     EXSR RESET                                     101483
      *                                                                   099509
      *  Reset the Backvalued Rate-changes Indicators                     099509
      *                                                                   099509
     C                     MOVE *OFF      *IN21                           099509
     C                     MOVE *OFF      *IN22                           099509
      *                                                                   103860
      ** Check for generated adjustments before start date.               103860
     C           KLIST1    SETLLREHISSL                  80               103860
     C           *IN80     IFEQ '1'                                       103860
     C           KLIST1    READEREADJF                   80               103860
     C           *IN80     DOWEQ'0'                                       103860
     C           AHISD     ANDLTCLCID                                     103860
     C           AHISD     IFLT CLDID                                     103860
     C                     MOVE '1'       *IN41                           103860
     C                     END                                            103860
     C                     MOVE '1'       *IN42                           103860
     C                     EXSR #ADJ                                      103860
     C                     SETOF                     4142                 103860
     C           KLIST1    READEREADJF                   80               103860
     C                     END                                            103860
     C                     END                                            103860
     C*
     C                     EXSR OPENCR
     C*
      ** & Reset partially setup output narratives                        101483
     C                     EXSR RESET                                     101483
      *                                                                   101483
     C                     EXSR OPENDR
      *                                                                   099509
      ***Check*for*'Generated*Adjustments*To*be*Posted'*********** 099509 103860
      *                                                                   099509
     C***********          MOVE *ON       *IN41                    099509 103860
     C***********          MOVE *ON       *IN42                    099509 103860
     C***********          EXSR #ADJ                               099509 103860
     C***********          MOVE *OFF      *IN41                    099509 103860
     C***********          MOVE *OFF      *IN42                    099509 103860
     C*
     C***********KLIST2    SETLLREHPOPL                  55               086254
      *                                                                   088826
      * Set Limits with  Debit Capitalisation day                         088826
     C                     EXSR SETPOD                     Setll REHPOPL. 088826
      *                                                                   088826
     C***********KLIST1    READEREHPOPL                  55               088826
     C*
     C                     ENDSR                           **B1LT   ENDSR*
     C********************************************************************
      /EJECT                                                              075071
      *****************************************************************   075071
      *                                                               *   075071
      *  ADDRC1   Subroutine to add subfile record                    *   075071
      *                                                               *   075071
      *  Called by:                                                   *   075071
      *                                                               *   075071
      *  Calls    :  -                                                *   075071
      *                                                               *   075071
      *****************************************************************   075071
     C           ADDRC1    BEGSR                                          075071
      *                                                                   113955
      * Bypass if subfile full                                            113955
     C           SF1F      IFEQ *BLANK                                    113955
      *                                                                   075071
      * save screen attribute indicators 85,86                            075071
     C                     MOVE XIN1X     XIN1    2        restore        075071
     C                     MOVEA*IN,85    XIN1X   2        save           075071
      *                                                                   075071
     C           XFRST1    IFNE *ON                        If 1st time    075071
     C                     MOVE *ON       XFRST1  1                       075071
     C                     ELSE                                           075071
     C                     ADD  1         RECN1                           075071
      *                                                                   113955
      * Check if maximum no. of records in subfile reached                113955
     C           RECN1     IFEQ 9999                                      113955
     C                     MOVELNAR,42    XDAT1                           113955
     C                     MOVE 'Y'       SF1F                            113955
     C                     ENDIF                                          113955
      *                                                                   113955
     C                     MOVEAXIN1      *IN,85           Inds 85,86     075071
     C                     WRITERE3364B1                   Add SflRecord  075071
     C                     MOVEAXIN1X     *IN,85           restore inds   075071
     C                     ENDIF                                          075071
     C                     ENDIF                                          113955
      *                                                                   075071
     C           SFLEN1    IFEQ *ON                        If sfl end     075071
     C                     CLEARXDAT1                      trigger start  075071
     C                     CLEARSFLEN1                                    075071
     C                     CLEARXFRST1                                    075071
     C                     ELSE                                           075071
      *                                                                   075071
     C           SF1F      IFEQ *BLANK                                    113955
     C                     MOVE SDAT1     XDAT1            Move next to   075071
      *                                                    buffer .       075071
     C                     ENDIF                                          113955
     C                     ENDIF                                          075071
      *                                                                   075071
     C                     ENDSR                                          075071
     C/EJECT
      *****************************************************************   075071
      *                                                               *   075071
      *  ADDRC2   Subroutine to add subfile record                    *   075071
      *                                                               *   075071
      *  Called by:                                                   *   075071
      *                                                               *   075071
      *  Calls    :  -                                                *   075071
      *                                                               *   075071
      *****************************************************************   075071
     C           ADDRC2    BEGSR                                          075071
      *                                                                   113955
      * Bypass if subfile full                                            113955
     C           SF2F      IFEQ *BLANK                                    113955
      *                                                                   075071
      * save screen attribute indicators 85,86                            075071
     C                     MOVE XIN2X     XIN2    2        restore        075071
     C                     MOVEA*IN,85    XIN2X   2        save           075071
      *                                                                   075071
     C           XFRST2    IFNE *ON                        If 1st time    075071
     C                     MOVE *ON       XFRST2  1                       075071
     C                     ELSE                                           075071
     C                     ADD  1         RECN2                           075071
      *                                                                   113955
      * Check if maximum no. of records in subfile reached                113955
     C           RECN2     IFEQ 9999                                      113955
     C                     MOVELNAR,42    XDAT2                           113955
     C                     MOVE 'Y'       SF2F                            113955
      *                                                                   113955
      * If no charges for a/c, set subfile flag to avoid unnecessary      113955
      * processing.                                                       113955
     C           CCHGP     IFEQ 0                                         113955
     C           CHGT      ANDEQ0                                         113955
     C                     MOVE 'Y'       SF3F                            113955
     C                     ENDIF                                          113955
     C                     ENDIF                                          113955
      *                                                                   113955
     C                     MOVEAXIN2      *IN,85           Inds 85,86     075071
     C                     WRITERE3364B2                   Add SflRecord  075071
     C                     MOVEAXIN2X     *IN,85           restore inds   075071
     C                     ENDIF                                          075071
     C                     ENDIF                                          113955
      *                                                                   075071
     C           SFLEN2    IFEQ *ON                        If sfl end     075071
     C                     CLEARXDAT2                      trigger start  075071
     C                     CLEARSFLEN2                                    075071
     C                     CLEARXFRST2                                    075071
     C                     ELSE                                           075071
     C           SF2F      IFEQ *BLANK                                    113955
     C                     MOVE SDAT2     XDAT2            Move next to   075071
      *                                                    buffer .       075071
     C                     ENDIF                                          113955
     C                     ENDIF                                          075071
      *                                                                   075071
     C                     ENDSR                                          075071
     C/EJECT
      *****************************************************************   075071
      *                                                               *   075071
      *  ADDRC3   Subroutine to add subfile record                    *   075071
      *                                                               *   075071
      *  Called by:                                                   *   075071
      *                                                               *   075071
      *  Calls    :  -                                                *   075071
      *                                                               *   075071
      *****************************************************************   075071
     C           ADDRC3    BEGSR                                          075071
      *                                                                   113955
      * Bypass if subfile full                                            113955
     C           SF3F      IFEQ *BLANK                                    113955
      *                                                                   075071
      * save screen attribute indicators 85,86                            075071
     C                     MOVE XIN3X     XIN3    2        restore        075071
     C                     MOVEA*IN,85    XIN3X   2        save           075071
      *                                                                   075071
     C           XFRST3    IFNE *ON                        If 1st time    075071
     C                     MOVE *ON       XFRST3  1                       075071
     C                     ELSE                                           075071
      *                                                                   075071
     C                     ADD  1         RECN3                           075071
      *                                                                   113955
      * Check if maximum no. of records in subfile reached                113955
     C           RECN3     IFEQ 9999                                      113955
     C                     MOVELNAR,42    XDAT3                           113955
     C                     MOVE 'Y'       SF3F                            113955
     C                     ENDIF                                          113955
      *                                                                   113955
     C                     MOVEAXIN3      *IN,85           Inds 85,86     075071
     C                     WRITERE3364B3                   Add SflRecord  075071
     C                     MOVEAXIN3X     *IN,85           restore inds   075071
     C                     ENDIF                                          075071
     C                     ENDIF                                          113955
      *                                                                   075071
     C           SFLEN3    IFEQ *ON                        If sfl end     075071
     C                     CLEARXDAT3                                       5071
     C                     CLEARSFLEN3                                    075071
     C                     CLEARXFRST3                                    075071
     C                     ELSE                                           075071
     C           SF3F      IFEQ *BLANK                                    113955
     C                     MOVE SDAT3     XDAT3            Move next to   075071
      *                                                    buffer .       075071
     C                     ENDIF                                          113955
     C                     ENDIF                                          075071
      *                                                                   075071
     C                     ENDSR                                          075071
     C/EJECT
     C********************************************************************
     C**
     C** B1GT subroutine for begin when debit greater than credit
     C**
     C**     Called by     BOTHSR
     C**
     C**     Calls         ZDATE2, RDRSR, RCRSR, DBSR, ZEDIT, SUBW1,
     C**                   SUBW2, SUBW3, OPENCR, OPENDR
     C**
     C           B1GT      BEGSR                           **B1GT   BEGSR*
     C*
     C** POSITION TO EARLIST PSTD IN THIS CASE CLCID
     C*
     C           KLIST3    SETLLREHPOPH                  55
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C           *IN55     DOWEQ'0'                        - B1
     C*********  PSTD      ANDLTRUND                                      065773
     C           PSTD      ANDLERUND                                      065773
     C*
     C           HISD      IFLT CLDID
     C           HISD      ORLT CLCID
     C*
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD031       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 031*
     C                     MOVELPSTD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     MOVE ZDATE     PPSTDO  6
     C*
     C                     END                             - E1
     C*
     C                     MOVE PPSTDO    PSTDA
     C                     MOVE PPSTDO    PSTD2
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD032       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 032*
     C                     MOVELHISD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDHISD      PVALD
     C                     MOVE ZDATE     PVALDO  6
     C*
     C                     END                             - E1
     C*
     C                     MOVE PVALDO    VALDA
     C                     MOVE PVALDO    VALD2
     C*
     C           RECI      IFEQ 'P'
     C                     MOVELPNAR      NARR
     C                     MOVELPNAR      NARR2
     C*
     C                     Z-ADDPSTA      PSTD0
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE PSTD0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C                     MOVE ZFIELD    AMON2
     C*
     C           CCHGP     IFGT 0
     C           CHGT      ORGT 0                          - B1
     C           CHGA      IFNE 0
     C           REBI      IFEQ 'Y'                        - B2
     C                     MOVE 'Y'       REB
     C                     ELSE                            - X2
     C                     MOVE ' '       REB
     C                     END                             - E2
     C***********          ADD  CHGA      TOTCH                           094431
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE ' '       HSIG
     C           CHGA      IFLT 0
     C                     Z-SUBCHGA      CHGA
     C                     MOVE '-'       HSIG
     C                     END                             - E1
     C                     MOVE CHGA      ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    CHAR
     C                     END                             - E1
     C                     END                             - E1
     C*
     C           DRCR      IFEQ 1                          - B1
     C                     MOVE 'CR'      CR               - X1
     C                     MOVE 'CR'      CR2
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     MOVE *BLANKS   CR2                             100992
     C                     END                             - E1
     C*
     C           TURN      IFEQ 'Y'                                       064993
     C                     MOVE '*'       COMMVT                          064993
     C                     ENDIF                                          064993
     C           HISD      IFLT CLDID
     C           PSTD      ANDGTCLDID
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C                     END
     C*
     C           HISD      IFLT CLCID
     C           PSTD      ANDGTCLCID
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C                     END
     C                     MOVE *BLANKS   COMMVT                          064993
     C           HISD      IFLT CLCID                                     094431
     C           PSTD      ANDGTCLCID                                     094431
     C           CCHGP     IFGT 0
     C           CHGT      ORGT 0                          - B1
     C           CHGA      IFNE 0
     C                     ADD  CHGA      TOTCH                           094431
     C***********          EXCPTOUT3                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT3SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT3
     C***********          END                                            094431
     C                     EXSR SUBW3
     C                     END                                            094431
     C                     END                                            094431
     C                     END
     C                     END
     C           RECI      IFEQ 'R'
     C           DRCR      IFEQ 0
     C           HISD      ANDLTCLDID
     C           PSTD      ANDGTCLDID
     C                     Z-ADDHISD      DDRCD
     C***********          EXSR RDRSR                                     103862
     C                     EXSR RATED                                     103862
      *                                                                   CRE001
      **  OUTPUT ADDITIONAL OVERDRAFT RATE IF INTEREST TYPE IS ZERO       CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C********** DDICT     IFEQ *ZEROS                                                 CRE001 206671
     C                     MOVELNAR,34    NARR                            CRE001
     C                     EXSR RDRAO                                     CRE001
     C                     MOVELNAR,33    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C**********           END                                                         CRE001 206671
     C                     END                                            CRE001
      *                                                                   CRE001
     C                     END
     C*
     C           DRCR      IFEQ 1
     C           HISD      ANDLTCLCID
     C           PSTD      ANDGTCLCID
     C                     Z-ADDHISD      DCRCD
     C***********          EXSR RCRSR                                     103862
     C                     EXSR RATEC                                     103862
     C                     END
     C*
     C                     END
     C*
     C** RESET INDICATOR
     C*
     C                     MOVE '0'       *IN26
     C*
     C                     END
     C*
     C           KLIST1    READEREHPOPH                  55
     C*
     C                     END                             - E1
      *                                                                   101483
      ** & Reset partially setup output narratives                        101483
     C                     EXSR RESET                                     101483
      *                                                                   099509
      *  Reset the Backvalued Rate-changes Indicators                     099509
      *                                                                   099509
     C                     MOVE *OFF      *IN21                           099509
     C                     MOVE *OFF      *IN22                           099509
      *                                                                   101483
     C***********KLIST1    SETLLREHISSL                  20        086230 103860
     C***********KLIST1    SETLLREHISSL                  20               075071
     C*
     C************IN20     IFEQ *ON                                086230 103860
     C***********KLIST1    READEREADJF                   20        086230 103860
     C************IN20     IFEQ '1'                        - B2           075071
     C***********KLIST1    READEREADJF                   20               075071
     C***********KLIST1    CHAINREADJF               20             075071086230
     C************IN20     DOWEQ'0'                        - B3           103860
     C***********AHISD     IFLT CLDID                                     103860
     C***********AHISD     ORLT CLCID                                     103860
     C*
     C***PRINT*INTEREST*OF*THE*BACK*VALUE*DATE************************    103860
     C*
     C***********SDCI      IFEQ 'Y'                                       099509
     C***********SCCI      OREQ 'Y'                                       099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C***********SCCI      OREQ *BLANK                             099509 103860
     C*
     C***********PPSTD     IFNE RUND                       - B1           103860
     C***********          Z-ADDRUND      ZDAYNO                          103860
     C***********          MOVE '0'       *IN99                           103860
     C***********          EXSR ZDATE2                                    103860
     C*
     C****VERIFY*IF*ERROR*********************************************    103860
     C*
     C************IN99     IFEQ '1'                        - B2           103860
     C************LOCK     IN   LDA                                       103860
     C***********          MOVELRUND      DBKEY                           103860
     C***********          Z-ADD033       DBASE                           103860
     C***********          MOVE 'ZDATE2'  DBFILE           ***************103860
     C***********          OUT  LDA                        * DB ERROR 033*103860
     C***********          MOVEA'1'       *IN,89           ***************103860
     C***********          EXSR DBSR                                      103860
     C***********          END                             - E2           103860
     C*
     C***********          Z-ADDRUND      PPSTD                           103860
     C***********          MOVE ZDATE     PPSTDO                          103860
     C*
     C***********          END                             - E1           103860
     C*
     C***********          MOVE PPSTDO    PSTDA                           103860
     C***********          MOVE PPSTDO    PSTD2                           103860
     C*
     C***********PVALD     IFNE AHISD                      - B1           103860
     C***********          Z-ADDAHISD     ZDAYNO                          103860
     C***********          MOVE '0'       *IN99                           103860
     C***********          EXSR ZDATE2                                    103860
     C*
     C****VERIFY*IF*ERROR*********************************************    103860
     C*
     C************IN99     IFEQ '1'                        - B2           103860
     C************LOCK     IN   LDA                                       103860
     C***********          MOVELAHISD     DBKEY                           103860
     C***********          Z-ADD034       DBASE                           103860
     C***********          MOVE 'ZDATE2'  DBFILE           ***************103860
     C***********          OUT  LDA                        * DB ERROR 034*103860
     C***********          MOVEA'1'       *IN,89           ***************103860
     C***********          EXSR DBSR                                      103860
     C***********          END                             - E2           103860
     C*
     C***********          Z-ADDAHISD     PVALD                           103860
     C***********          MOVE ZDATE     PVALDO                          103860
     C*
     C***********          END                             - E1           103860
     C*
     C***********          MOVE PVALDO    VALDA                           103860
     C***********          MOVE PVALDO    VALD2                           103860
     C*
      **Check*where*the*adjustment*is*to*be*posted*to*:*********** 099509 103860
      *                                                                   099509
     C***********          SELEC                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SDCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR                     099509 103860
      **Suspence*acc********************************************** 099509 103860
     C***********SDCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR                     099509 103860
      **this*acc************************************************** 099509 103860
     C***********          OTHER                                   099509 103860
     C***********          MOVELNAR,29    NARR                            103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********          SELEC                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SCCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR2                    099509 103860
      **Suspence*acc********************************************** 099509 103860
     C***********SCCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR2                    099509 103860
      **this*acc************************************************** 099509 103860
     C***********          OTHER                                   099509 103860
     C***********          MOVELNAR,29    NARR2                           103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********AHISD     IFLT CLCID                                     103860
     C***********AHISD     ORLT CLDID                                     103860
     C***********SDCI      IFEQ 'Y'                                       099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C***********ADAIC     IFNE *ZEROS                                    103860
     C***********ADAIC     IFLT *ZERO                                     103860
     C***********          Z-SUBADAIC     PSTD0                           103860
     C***********          MOVEL'CR'      CR                              103860
     C***********          MOVEL'CR'      CR2                             103860
     C***********          ELSE                                           103860
     C***********          Z-ADDADAIC     PSTD0                           103860
     C***********          MOVEL'  '      CR                              103860
     C***********          MOVEL'  '      CR2                             103860
     C***********          END                                            103860
     C***********          MOVE *BLANK    ZFIELD                          103860
     C***********          MOVE PSTD0     ZFIELD                          103860
     C***********          Z-ADDDECI1     ZADIG                           103860
     C***********          EXSR ZEDIT                                     103860
     C***********          MOVE ZFIELD    AMON                            103860
     C***********          MOVE ZFIELD    AMON2                           103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR              formatAREAType1086093 103860
     C***********          MOVELAREA      SDAT1                           103860
     C***********          MOVELAREA      SDAT2                           103860
     C***********AHISD     IFLT CLDID                                     103860
     C***********          EXSR SUBW1                                     103860
     C***********          END                                            103860
     C***********AHISD     IFLT CLCID                                     103860
     C***********          EXSR SUBW2                                     103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********SCCI      IFEQ 'Y'                                       099509
     C***********SCCI      IFNE *BLANK                             099509 103860
     C***********ACAIC     IFNE *ZEROS                                    103860
     C***********ACAIC     IFLT *ZERO                                     103860
     C***********          Z-SUBACAIC     PSTD0                           103860
     C***********          MOVEL'  '      CR                              103860
     C***********          MOVEL'  '      CR2                             103860
     C***********          ELSE                                           103860
     C***********          Z-ADDACAIC     PSTD0                           103860
     C***********          MOVEL'CR'      CR                              103860
     C***********          MOVEL'CR'      CR2                             103860
     C***********          END                                            103860
     C***********          MOVE *BLANK    ZFIELD                          103860
     C***********          MOVE PSTD0     ZFIELD                          103860
     C***********          Z-ADDDECI1     ZADIG                           103860
     C***********          EXSR ZEDIT                                     103860
     C***********          MOVE ZFIELD    AMON                            103860
     C***********          MOVE ZFIELD    AMON2                           103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR              formatAREAType1086093 103860
     C***********          MOVELAREA      SDAT1                           103860
     C***********          MOVELAREA      SDAT2                           103860
     C***********AHISD     IFLT CLDID                                     103860
     C***********          EXSR SUBW1                                     103860
     C***********          END                                            103860
     C********** AHISD ****IFLT CLDID                                     099513
     C***********AHISD     IFLT CLCID                              099513 103860
     C***********          EXSR SUBW2                                     103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********          END                                            103860
     C*
     C***********          END                                            103860
     C*
     C***********          END                             - E3           103860
     C***********KLIST1    READEREADJF                   20               103860
     C***********          END                             - E3           103860
     C***********          END                             - E3           075071
     C***********          ENDIF                                   086230 103860
      *                                                                   103860
      ** Check for generated adjustments before start date.               103860
     C           KLIST1    SETLLREHISSL                  80               103860
     C           *IN80     IFEQ '1'                                       103860
     C           KLIST1    READEREADJF                   80               103860
     C           *IN80     DOWEQ'0'                                       103860
     C           AHISD     ANDLTCLDID                                     103860
     C           AHISD     IFLT CLCID                                     103860
     C                     MOVE '1'       *IN42                           103860
     C                     END                                            103860
     C                     MOVE '1'       *IN41                           103860
     C                     EXSR #ADJ                                      103860
     C                     SETOF                     4142                 103860
     C           KLIST1    READEREADJF                   80               103860
     C                     END                                            103860
     C                     END                                            103860
     C*
     C                     EXSR OPENCR
     C*
     C                     EXSR OPENDR
      *                                                                   099509
      ***Equivalant*of*#ADJ*coded*into*this*routine*!!!!!!!*in*the 099509 103860
      *****that*follows*this*comment****************************** 099509 103860
     C*
     C***********KLIST1    SETLLREHISSL                  20               103860
     C*
     C************IN20     IFEQ '1'                        - B2           103860
     C***********KLIST1    READEREADJF                   20               103860
     C************IN20     DOWEQ'0'                        - B3           103860
     C***********AHISD     IFEQ CLDID                                     103860
     C***********AHISD     OREQ CLCID                                     103860
     C*
     C** PRINT INTEREST OF THE BACK VALUE DATE
     C*
     C***********SDCI      IFEQ 'Y'                                       099509
     C***********SCCI      OREQ 'Y'                                       099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C***********SCCI      ORNE *BLANK                             099509 103860
     C*
     C***********PPSTD     IFNE RUND                       - B1           103860
     C***********          Z-ADDRUND      ZDAYNO                          103860
     C***********          MOVE '0'       *IN99                           103860
     C***********          EXSR ZDATE2                                    103860
     C*
     C****VERIFY*IF*ERROR*********************************************    103860
     C*
     C************IN99     IFEQ '1'                        - B2           103860
     C************LOCK     IN   LDA                                       103860
     C***********          MOVELRUND      DBKEY                           103860
     C***********          Z-ADD035       DBASE                           103860
     C***********          MOVE 'ZDATE2'  DBFILE           ***************103860
     C***********          OUT  LDA                        * DB ERROR 035*103860
     C***********          MOVEA'1'       *IN,89           ***************103860
     C***********          EXSR DBSR                                      103860
     C***********          END                             - E2           103860
     C*
     C***********          Z-ADDRUND      PPSTD                           103860
     C***********          MOVE ZDATE     PPSTDO                          103860
     C*
     C***********          END                             - E1           103860
     C*
     C***********          MOVE PPSTDO    PSTDA                           103860
     C***********          MOVE PPSTDO    PSTD2                           103860
     C*
     C***********PVALD     IFNE AHISD                      - B1           103860
     C***********          Z-ADDAHISD     ZDAYNO                          103860
     C***********          MOVE '0'       *IN99                           103860
     C***********          EXSR ZDATE2                                    103860
     C*
     C****VERIFY*IF*ERROR*********************************************    103860
     C*
     C************IN99     IFEQ '1'                        - B2           103860
     C************LOCK     IN   LDA                                       103860
     C***********          MOVELAHISD     DBKEY                           103860
     C***********          Z-ADD036       DBASE                           103860
     C***********          MOVE 'ZDATE2'  DBFILE           ***************103860
     C***********          OUT  LDA                        * DB ERROR 036*103860
     C***********          MOVEA'1'       *IN,89           ***************103860
     C***********          EXSR DBSR                                      103860
     C***********          END                             - E2           103860
     C*
     C***********          Z-ADDAHISD     PVALD                           103860
     C***********          MOVE ZDATE     PVALDO                          103860
     C*
     C***********          END                             - E1           103860
     C*
     C***********          MOVE PVALDO    VALDA                           103860
     C***********          MOVE PVALDO    VALD2                           103860
     C*
      **Check*where*the*adjustment*is*to*be*posted*to*:*********** 099509 103860
      *                                                                   099509
     C***********          SELEC                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SDCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR                     099509 103860
      **Suspence*acc********************************************** 099509 103860
     C***********SDCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR                     099509 103860
      **this*acc************************************************** 099509 103860
     C***********          OTHER                                   099509 103860
     C***********          MOVELNAR,29    NARR                            103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********          SELEC                                   099509 103860
      **Alt*acc*************************************************** 099509 103860
     C***********SCCI      WHEQ 'A'                                099509 103860
     C***********          MOVELNAR,40    NARR2                    099509 103860
      **Suspence*acc********************************************** 099509 103860
     C***********SCCI      WHEQ 'S'                                099509 103860
     C***********          MOVELNAR,41    NARR2                    099509 103860
      **this*acc************************************************** 099509 103860
     C***********          OTHER                                   099509 103860
     C***********          MOVELNAR,29    NARR2                           103860
     C***********          ENDSL                                   099509 103860
      *                                                                   099509
     C***********SDCI      IFEQ 'Y'                                       099509
     C***********SDCI      IFNE *BLANK                             099509 103860
     C***********ADAIC     IFNE *ZERO                                     103860
     C***********ADAIC     IFLT *ZERO                                     103860
     C***********          Z-SUBADAIC     PSTD0                           103860
     C***********          MOVEL'CR'      CR                              103860
     C***********          MOVEL'CR'      CR2                             103860
     C***********          ELSE                                           103860
     C***********          Z-ADDADAIC     PSTD0                           103860
     C***********          MOVEL'  '      CR                              103860
     C***********          MOVEL'  '      CR2                             103860
     C***********          END                                            103860
     C***********          MOVE *BLANK    ZFIELD                          103860
     C***********          MOVE PSTD0     ZFIELD                          103860
     C***********          Z-ADDDECI1     ZADIG                           103860
     C***********          EXSR ZEDIT                                     103860
     C***********          MOVE ZFIELD    AMON                            103860
     C***********          MOVE ZFIELD    AMON2                           103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR              formatAREAType1086093 103860
     C***********          MOVELAREA      SDAT1                           103860
     C***********          MOVELAREA      SDAT2                           103860
     C***********AHISD     IFEQ CLDID                                     103860
     C***********          EXSR SUBW1                                     103860
     C***********          END                                            103860
     C***********AHISD     IFEQ CLCID                                     103860
     C***********          EXSR SUBW2                                     103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********SCCI      IFEQ 'Y'                                       099509
     C***********SCCI      IFNE *BLANK                             099509 103860
     C***********ACAIC     IFNE *ZEROS                                    103860
     C***********ACAIC     IFLT *ZERO                                     103860
     C***********          Z-SUBACAIC     PSTD0                           103860
     C***********          MOVEL'  '      CR                              103860
     C***********          MOVEL'  '      CR2                             103860
     C***********          ELSE                                           103860
     C***********          Z-ADDACAIC     PSTD0                           103860
     C***********          MOVEL'CR'      CR                              103860
     C***********          MOVEL'CR'      CR2                             103860
     C***********          END                                            103860
     C***********          MOVE *BLANK    ZFIELD                          103860
     C***********          MOVE PSTD0     ZFIELD                          103860
     C***********          Z-ADDDECI1     ZADIG                           103860
     C***********          EXSR ZEDIT                                     103860
     C***********          MOVE ZFIELD    AMON                            103860
     C***********          MOVE ZFIELD    AMON2                           103860
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C***********          EXSR OUT2SR              formatAREAType1086093 103860
     C***********          MOVELAREA      SDAT1                           103860
     C***********          MOVELAREA      SDAT2                           103860
     C***********AHISD     IFEQ CLDID                                     103860
     C***********          EXSR SUBW1                                     103860
     C***********          END                                            103860
     C***********AHISD     IFEQ CLCID                                     103860
     C***********          EXSR SUBW2                                     103860
     C***********          END                                            103860
     C***********          END                                            103860
     C***********          END                                            103860
     C*
     C***********          END                                            103860
     C*
     C***********          END                             - E3           103860
     C***********KLIST1    READEREADJF                   20               103860
     C***********          END                             - E3           103860
     C***********          END                             - E3           103860
     C*
     C***********KLIST3    SETLLREHPOPL                  55               086254
      *                                                                   088826
      * Set Limits with Credit Capitalisation day                         088826
     C                     EXSR SETPOC                     Setll REHPOPL. 088826
      *                                                                   088826
     C***********KLIST1    READEREHPOPL                  55               088826
     C*
     C                     ENDSR                           **B1GT   ENDSR*
     C******************************************************************
      /EJECT                                                              088826
      ******************************************************************* 088826
      **                                                                  088826
      ** SETPOC                                                           088826
      **                                                                  088826
      * Position Posting Records for Credit Capiatlisation                088826
      **                                                                  088826
     C           SETPOC    BEGSR                                          088826
      *                                                                   088826
     C                     Z-ADDCLCIDX    CLCOMP           cap.day + 1.   088826
     C                     Z-ADDCLCID     CLPREV                          088826
     C           KLIST3    SETLLREHPOPL                                   088826
      *                                                                   088826
      * Get First Posting Record                                          088826
     C                     EXSR NXTPOP                                    088826
      *                                                                   088826
     C                     ENDSR                                          088826
      /EJECT                                                              088826
      ******************************************************************* 088826
      **                                                                  088826
      ** SETPOD                                                           088826
      **                                                                  088826
      * Position Posting Records for  Debit Capiatlisation                088826
      **                                                                  088826
     C           SETPOD    BEGSR                                          088826
      *                                                                   088826
     C                     Z-ADDCLDIDX    CLCOMP           cap.day + 1.   088826
     C                     Z-ADDCLDID     CLPREV           previous day   088826
     C           KLIST2    SETLLREHPOPL                                   088826
      *                                                                   088826
      * Get First Posting Record                                          088826
     C                     EXSR NXTPOP                                    088826
      *                                                                   088826
     C                     ENDSR                                          088826
      /EJECT                                                              088826
      ******************************************************************* 088826
      **                                                                  088826
      ** NXTPOP                                                           088826
      **                                                                  088826
      * Get Next Posting Record                                           088826
      **                                                                  088826
     C           NXTPOP    BEGSR                                          088826
     C           *LIKE     DEFN CLCID     CLCOMP           Original Day . 088826
     C           *LIKE     DEFN CLCID     CLPREV           capitlistionDay088826
      *                                                                   088826
      * select If Post & Value date or greater (than Cap.Day or start-1)  088826
      * OR if Post=ValueDate=Cap.Day & event=capitalisation               088826
      *                   (for special case - failed closure)             088826
     C           *IN55     DOUEQ*ON                        EndOfFile(etc).088826
      * Select starting record for display of postings. If the value date 094433
      * is within the period, a backvalued posting date should not matter.094433
     C           PSTD      ORGE CLCOMP                                    088826
     C           VALD      ANDGECLCOMP                                    088826
     C           PSTD      ORLE CLPREV                                    088826
     C           VALD      ANDGECLCOMP                                    088826
     C           PSTD      OREQ CLPREV                     PostDate=Cap.Dt088826
     C           VALD      ANDEQCLPREV                     ValDate=Cap.Dte088826
     C           GETP      ANDEQ'C'                        EventType=Cap. 088826
     C           VALD      OREQ CLPREV                                    094433
     C           KLIST1    READEREHPOPL                  55               088826
     C                     ENDDO                                          088826
      *                                                                   088826
     C                     ENDSR                                          088826
     C/EJECT
     C********************************************************************
     C*                                                                   CRE001
     C** RDROD  SUBROUTINE FOR PROCESSING THE OVERDRAFT LIMIT             CRE001
     C*                                                                   CRE001
     C           RDROD     BEGSR                                          CRE001
     C*                                                                   CRE001
     C                     MOVE *BLANKS   CR                              CRE001
     C                     MOVE *BLANKS   ZFIELD                          CRE001
     C*                                                                   CRE001
     C           SAVEZ     IFEQ 0                                         CRE001
     C                     Z-ADDWODRL     FODRL                           CRE001
     C                     END                                            CRE001
      *                                                                   CRE001
     C           SAVEZ     IFEQ 1                                         CRE001
     C                     Z-ADDWODRL     FODRL1                          CRE001
     C                     END                                            CRE001
      *                                                                   CRE001
     C           SAVEZ     IFEQ 2                                         CRE001
     C                     Z-ADDWODRL     FODRL2                          CRE001
     C                     END                                            CRE001
      *                                                                   CRE001
     C           SAVEZ     IFEQ 3                                         CRE001
     C                     Z-ADDWODRL     FODRL3                          CRE001
     C                     END                                            CRE001
      *                                                                   CRE001
     C                     MOVE FODRL     ZFIELD                          CRE001
     C                     Z-ADD11        ZADIG                           CRE001
     C                     EXSR ZEDIT                                     CRE001
      *                                                                   CRE001
     C                     MOVE ZFIELD    AMON                            CRE001
      *                                                                   CRE001
     C                     EXSR OUT2SR                                    CRE001
     C                     MOVELAREA      SDAT1                           CRE001
     C                     EXSR SUBW1                                     CRE001
      *                                                                   CRE001
     C                     ENDSR                                          CRE001
     C/EJECT                                                              CRE001
     C********************************************************************CRE001
     C/EJECT                                                              CRE001
     C********************************************************************CRE001
     C*                                                                   CRE001
     C** RDRAO  SUBROUTINE FOR PROCESSING THE ADDITIONAL OVERDRAFT RATE   CRE001
     C*                                                                   CRE001
     C           RDRAO     BEGSR                                          CRE001
     C*                                                                   CRE001
     C                     MOVE *BLANKS   ZFIELD                          CRE001
     C*                                                                   CRE001
     C**  FORMAT ADDITIONAL OVERDRAFT RATE FROM JLF/REHRDJ.               CRE001
     C*                                                                   CRE001
     C                     MOVE AODR      ZFIELD                          CRE001
     C                     Z-ADD4         ZADIG                           CRE001
     C                     Z-ADD7         ZADEC                           CRE001
     C                     EXSR ZEDIT                                     CRE001
      *                                                                   CRE001
     C                     MOVE ZFIELD    RATO                            CRE001
      *                                                                   CRE001
     C                     Z-ADDAODR      WKRAT            Reformat the   CRE001
     C                     EXSR EDTPER                     Add O/D Rateth%CRE001
      *                                                                   CRE001
     C                     Z-ADDSAVEZ     ZADEC                           CRE001
     C                     MOVEL'1'       *IN87                           CRE001
     C                     EXSR OUT1SR                                    CRE001
     C                     MOVEL'0'       *IN87                           CRE001
      *                                                                   CRE001
     C/COPY WNCPYSRC,RE3364EC22
     C                     MOVELAREA      SDAT1                           CRE001
     C                     EXSR SUBW1                                     CRE001
      *                                                                   CRE001
     C                     ENDSR                                          CRE001
     C/EJECT                                                              CRE001
     C********************************************************************CRE001
     C**
     C** POSTSR subroutine for posting output
     C**
     C**     Called by     BOTHSR, B1EQ
     C**
     C**     Calls         ZDATE2, DBSR, ZEDIT, SUBW1, SUBW2, SUBW3
     C**                   RDRSR
     C**
     C           POSTSR    BEGSR                           **POSTSR BEGSR*
     C*
     C           PPSTD     IFNE PSTD                       - B1
     C                     Z-ADDPSTD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD037       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 037*
     C                     MOVELPSTD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDPSTD      PPSTD
     C                     MOVE ZDATE     PPSTDO  6
     C*
     C                     END                             - E1
     C*
     C                     MOVE PPSTDO    PSTDA
     C                     MOVE PPSTDO    PSTD2
     C*
     C           PVALD     IFNE HISD                       - B1
     C                     Z-ADDHISD      ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD038       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 038*
     C                     MOVELHISD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDHISD      PVALD
     C                     MOVE ZDATE     PVALDO  6
     C*
     C                     END                             - E1
     C*
     C                     MOVE PVALDO    VALDA
     C                     MOVE PVALDO    VALD2
     C*
     C                     MOVELPNAR      NARR
     C                     MOVELPNAR      NARR2
     C*
     C                     Z-ADDPSTA      PSTD0
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE PSTD0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C                     MOVE ZFIELD    AMON2
     C*
     C           CCHGP     IFGT 0
     C           CHGT      ORGT 0                          - B1
     C           CHGA      IFNE 0
     C           REBI      IFEQ 'Y'                        - B2
     C                     MOVE 'Y'       REB
     C                     ELSE                            - X2
     C                     MOVE ' '       REB
     C                     END                             - E2
     C***********          ADD  CHGA      TOTCH                           094431
     C                     MOVE ' '       HSIG
     C           CHGA      IFLT 0
     C                     MOVE '-'       HSIG
     C                     Z-SUBCHGA      CHGA
     C                     END                             - E2
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE CHGA      ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    CHAR
     C                     END                             - E1
     C                     END                             - E1
     C*
     C           DRCR      IFEQ 1                          - B1
     C                     MOVE 'CR'      CR               - X1
     C                     MOVE 'CR'      CR2
     C                     ELSE                                           094431
     C                     MOVE '  '      CR               - X1           094431
     C                     MOVE '  '      CR2                             094431
     C                     END                             - E1
     C*
     C           ND        IFEQ '   0'                                    094431
     C                     MOVEL*BLANKS   ND                              094431
     C                     END                                            094431
     C*                                                                   094431
     C           TURN      IFEQ 'Y'                                       064993
     C                     MOVE '*'       COMMVT                          064993
     C                     ENDIF                                          064993
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     MOVELAREA      SDAT2
     C           HISD      IFGE CLDIDX                                    088826
     C***********HISD      IFGE CLDID                                     088826
     C***********PSTD      OREQ CLDID                      PostDate=088826094433
     C***********VALD      ANDGECLDID                      ValDte>=C088826094433
     C           VALD      ORGE CLDID                                     094433
     C***********GETP      ANDEQ'C'                        Capitalis088826094433
     C***********HISD      ORLT CLDID                               065773088826
     C***********PSTD      ANDGECLDID                               065773088826
     C           HISD      ORLT CLDIDX                                    088826
     C           PSTD      ANDGECLDIDX                                    088826
     C           CLDIDX    ANDEQCLCIDX                                    094431
      *                                                                   089497
      * If backvalued posting found with posting date after end of        089497
      * period, set flag to print 'Adjusted Balance C/F'.                 089497
     C           PSTD      IFGE CHISD                                     089497
     C                     MOVE *ON       DEBBAK                          089497
     C                     ENDIF                                          089497
      *                                                                   089497
     C                     EXSR SUBW1
     C                     END
     C*
     C***********          EXCPTOUT3                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT3SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT3
     C           HISD      IFGE CLCIDX                                    088826
     C***********HISD      IFGE CLCID                                     088826
     C***********PSTD      OREQ CLCID                      PostDate=088826094433
     C***********VALD      ANDGECLCID                      ValDte>=C088826094433
     C           VALD      ORGE CLCID                                     094433
     C***********GETP      ANDEQ'C'                        Capitalis088826094433
     C***********HISD      ORLT CLCID                               065773088826
     C***********PSTD      ANDGECLCID                               065773088826
     C           HISD      ORLT CLCIDX                                    088826
     C           PSTD      ANDGECLCIDX                                    088826
     C           CLCIDX    ANDEQCLDIDX                                    094431
      *                                                                   089497
      * If backvalued posting found with posting date after end of        089497
      * period, set flag to print 'Adjusted Balance C/F'.                 089497
     C           PSTD      IFGE CHISD                                     089497
     C                     MOVE *ON       CREBAK                          089497
     C                     ENDIF                                          089497
      *                                                                   089497
     C                     EXSR SUBW2
     C           CCHGP     IFGT 0
     C           CHGT      ORGT 0                          - B1
     C           CHGA      IFNE 0
     C                     ADD  CHGA      TOTCH                           094431
     C                     EXSR SUBW3
     C                     END
     C                     END
     C                     END
     C                     MOVE *BLANKS   COMMVT                          064993
     C*
     C** RESET INDICATOR
     C*
     C                     MOVE '0'       *IN26
     C*
     C                     ENDSR                           **POSTSR ENDSR*
     C******************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** OPENDR subroutine for debit output - opening balance and
     C**                                      opening rate
     C**
     C**     Called by     B1LT, B1GT
     C**
     C**     Calls         RDRSR, ZEDIT, ZDATE2, DBSR, SUBW1
     C**
     C           OPENDR    BEGSR                           **OPENDR BEGSR*
     C*
     C                     Z-ADDW1HISB    HISB0
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C                     MOVELNAR,2     NARR
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C           PVALD     IFNE CLDID                      - B1
     C                     Z-ADDCLDID     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD039       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 039*
     C                     MOVELCLDID     DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDCLDID     PVALD
     C                     MOVELZDATE     PVALDO
     C*
     C                     END                             - E1
     C*
     C*                    MOVE ZDATE     VALDA
     C                     MOVELPVALDO    VALDA
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C           *IN21     IFEQ '0'                                       075079
     C                     MOVELNAR,3     NARR
     C                     ELSE                                           075079
     C                     MOVELNAR,4     NARR                            075079
     C                     END                                            075079
     C           KLIST2    SETLLREHRDJ
     C           CLDID     IFEQ DACO                                      057291
     C           KLIST2    READEREHRDJ                   99               057291
     C           *IN99     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     ELSE                                           057291
     C           KLIST1    REDPEREHRDJ                   99
     C           *IN99     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     END                                            057291
     C*
     C                     EXSR RDRSR
     C           CRE001    IFEQ 'Y'                                       CRE001
     C********** DDICT     IFEQ *ZEROS                                                 CRE001 206671
     C                     MOVELNAR,34    NARR                            CRE001
     C                     EXSR RDRAO                                     CRE001
     C                     MOVELNAR,33    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C**********           END                                                         CRE001 206671
     C                     END                                            CRE001
     C*
     C                     ENDSR                           **OPENDR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** OPENCR subroutine for credit output - opening balance and
     C**                                       opening rate
     C**
     C**     Called by     B1LT, B1GT
     C**
     C**     Calls         RCRSR, ZEDIT, ZDATE2, DBSR, SUBW2
     C**
     C           OPENCR    BEGSR                           **OPENCR BEGSR*
     C*
     C                     Z-ADDW2HISB    HISB0
     C           HISB0     IFLT 0                          - B1
     C                     MOVE 'CR'      CR
     C           HISB0     MULT SUBT      HISB0
     C                     ELSE                            - E1           100992
     C                     MOVE *BLANKS   CR                              100992
     C                     END                             - E1
     C                     MOVELNAR,2     NARR
     C*
     C                     MOVE *BLANKS   ZFIELD
     C                     MOVE HISB0     ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    AMON
     C*
     C           PVALD     IFNE CLCID                      - B1
     C                     Z-ADDCLCID     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C**  VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B2
     C           *LOCK     IN   LDA
     C                     Z-ADD040       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 040*
     C                     MOVELCLCID     DBKEY            ***************
     C                     IN   LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E2
     C*
     C                     Z-ADDCLCID     PVALD
     C                     MOVELZDATE     PVALDO
     C*
     C                     END                             - E1
     C*
     C                     MOVELPVALDO    VALDA
     C*
     C***********          EXCPTOUT2                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT2SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C                     MOVE *BLANKS   VALDA
     C                     MOVE *BLANKS   PSTDA
     C           *IN22     IFEQ '0'                                       075079
     C                     MOVELNAR,8     NARR
     C                     ELSE                                           075079
     C                     MOVELNAR,9     NARR                            075079
     C                     END                                            075079
     C           KLIST3    SETLLREHRCJ
     C           CLCID     IFEQ DACO                                      057291
     C           KLIST3    READEREHRCJ                   99               057291
     C           *IN99     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     ELSE                                           057291
     C           KLIST1    REDPEREHRCJ                   99
     C           *IN99     IFEQ '1'                                       094433
     C                     Z-ADD0         RINTP                           094433
     C                     Z-ADD0         RINST                           094433
     C                     Z-ADD0         INRT                            098818
     C                     END                                            094433
     C                     END                                            057291
     C*
     C                     EXSR RCRSR
     C*
     C                     ENDSR                           **OPENCR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** RATESR subroutine for debit and credit rate change
     C**
     C**     Called by     BOTHSR
     C**
     C**     Calls         RATEC, RATED
     C**
     C           RATESR    BEGSR                           **RATESR BEGSR*
     C*
     C           DRECI     IFNE 'S'
     C           DRECI     IFNE 'B'
     C           DDRCI     ANDEQ'Y'                        - B1
     C           DHISD     IFGE CLDID
     C           SF1F      ANDEQ*BLANK                                    113955
     C*
     C                     EXSR RATED
     C*
     C                     Z-ADDDHISD     WHISDD
     C                     Z-ADDDHISB     WHISBD
     C*
     C                     END                             - E1
     C                     END                             - E1
     C*                                                                   CRE001
     C** OUTPUT NEW OVERDRAFT LIMIT IF OVERDRAFT LINE PROCESSED           CRE001
     C*                                                                   CRE001
     C           CRE001    IFEQ 'Y'                                       CRE001
     C           DRECI     IFNE 'B'                                       CRE001
     C           ODLI      ANDEQ'Y'                        - B2           CRE001
     C           DHISD     IFEQ CLDID                      - B3           CRE001
     C                     Z-ADDDODRL     WODRL                           CRE001
     C                     Z-ADDDHISD     ZDAYNO                          CRE001
     C                     EXSR ZDATE2                                    CRE001
     C                     MOVE '0'       *IN99                           CRE001
     C                     MOVELZDATE     VALDA                           CRE001
     C                     MOVELNAR,35    NARR                            CRE001
     C                     EXSR RDROD                                     CRE001
     C                     END                             - E3           CRE001
     C                     END                             - E2           CRE001
     C                     END                                            CRE001
     C*
     C           DRECI     IFNE 'B'
     C           DCRCI     ANDEQ'Y'                        - B1
     C           DHISD     IFGE CLCID
     C           SF2F      ANDEQ*BLANK                                    113955
     C*
     C                     EXSR RATEC
     C*
     C                     Z-ADDDHISD     WHISDC
     C                     Z-ADDDHISB     WHISBC
     C*
     C                     END                             - E1
     C                     END                             - E1
     C*
     C***********DDRCI     IFEQ *BLANKS                    - B1           049678
     C***********DCRCI     ANDEQ*BLANKS                                   049678
     C           DDMVT     IFNE *ZEROS                     - B1           049678
     C           DCMVT     ORNE *ZEROS                                    049678
     C           ADJFLG    OREQ 'Y'                                       103860
     C*
     C           DDICT     IFLT 3                                         065773
     C           DHISD     ANDGECLDID                                     089497
     C                     Z-ADDDHISD     WHISDD
     C                     Z-ADDDHISB     WHISBD
     C                     END                                            065773
     C           DCICT     IFLT 3                                         065773
     C           DHISD     ANDGECLCID                                     089497
     C                     Z-ADDDHISD     WHISDC
     C                     Z-ADDDHISB     WHISBC
     C                     END                                            065773
     C*
     C           DHISD     IFGE CLDID                                     088726
     C                     Z-ADDDDAID     WDAID                           038151
     C                     END                                            088726
     C           DHISD     IFGE CLCID                                     088726
     C                     Z-ADDDCAID     WCAID                           038151
     C                     END                                            088726
     C*                                                                   038151
     C                     END                             - E1
     C***********          END                             - E1           088726
     C*
     C**  SAVE REHISL  AS PREVIOUS
     C*
     C                     MOVE DRECI     WRECI
     C                     Z-ADDDMNBL     WMNBL
     C                     Z-ADDDCHGAR    WCHGAR
     C                     Z-ADDDTHGAR    WTHGAR
     C                     Z-ADDDCHGAN    WCHGAN
     C                     Z-ADDDTHGAN    WTHGAN
     C                     Z-ADDDDMVT     WDMVT
     C                     MOVE DDICT     WDICT
     C                     MOVE DDRCB     WDRCB
     C                     Z-ADDDRIR      WDRIR
     C                     Z-ADDDDRCD     WDRCD
     C                     Z-ADDWDAID     WDAID2
     C***********          Z-ADDDDAID     WDAID                           038151
     C                     Z-ADDDMADI     WMADI
     C                     Z-ADDDTMADI    WTMADI
     C                     Z-ADDDPDID     WPDID
     C                     Z-ADDDDMINT    WDMINT
     C                     Z-ADDDCMVT     WCMVT
     C                     Z-ADDDCICT     WCICT
     C                     Z-ADDDCRCB     WCRCB
     C                     Z-ADDCRIR      WCRIR
     C                     Z-ADDDCRCD     WCRCD
     C***********          Z-ADDDCAID     WCAID                           038151
     C                     Z-ADDDMACI     WMACI
     C                     Z-ADDDTMACI    WTMACI
     C                     Z-ADDDPCID     WPCID
     C                     Z-ADDDCMINT    WCMINT
     C                     MOVE DDICI     WDICI
     C                     MOVE DCICI     WCICI
     C                     MOVE DDRCI     WDRCI
     C                     MOVE DCRCI     WCRCI
     C                     Z-ADDDVDTC     WVDTC
     C                     MOVE DADTY     WADTY
     C                     MOVE DALTI     WALTI
     C                     Z-ADDDMNBCP    WMNBCP
     C                     MOVE *BLANK    ADJFLG                          103860
     C*                                                                   038151
     C           DDMVT     IFEQ 0                                         038151
     C           DCMVT     ANDEQ0                                         038151
     C           DDRCI     IFEQ 'Y'                                       038151
     C           DMADI     ORNE 0                                         038151
     C           CRE001    OREQ 'Y'                                       CRE001
     C           ODLI      ANDNE*BLANKS                                   CRE001
     C           DHISD     IFGE CLDID                                     088726
     C                     Z-ADDDDAID     WDAID                           038151
     C                     END                                            088726
     C                     END                                            038151
     C           DCRCI     IFEQ 'Y'                                       038151
     C           DMACI     ORNE 0                                         038151
     C           DHISD     IFGE CLCID                                     088726
     C                     Z-ADDDCAID     WCAID                           038151
     C                     END                                            088726
     C                     END                                            038151
     C                     END                                            038151
      *                                                                   103860
     C                     ELSE                                           103860
     C           SGADI     IFNE 0                                         103860
     C           SGACI     ORNE 0                                         103860
      *                                                                   103860
      ** Save details from 'S' record                                     103860
     C                     Z-ADDDDICT     WDICT                           103860
     C                     Z-ADDSDRCB     WDRCB                           103860
     C                     Z-ADDDCICT     WCICT                           103860
     C                     Z-ADDSCRCB     WCRCB                           103860
     C           DHISD     IFGE CLDID                                     103860
     C                     Z-ADDDHISD     WHISDD                          103860
     C                     Z-ADDSHISB     WHISBD                          103860
     C           SDICI     IFEQ *BLANK                                    103860
     C                     Z-ADDSDAIC     WDAID                           103860
     C                     END                                            103860
     C                     END                                            103860
     C           DHISD     IFGE CLCID                                     103860
     C                     Z-ADDDHISD     WHISDC                          103860
     C                     Z-ADDSHISB     WHISBC                          103860
     C           SCICI     IFEQ *BLANK                                    103860
     C                     Z-ADDSCAIC     WCAID                           103860
     C                     END                                            103860
     C                     END                                            103860
     C                     END                                            103860
      *                                                                   103860
     C                     END                             - E1           088726
     C*
     C           KLIST1    READEREHISL                   51
     C*
     C                     ENDSR                           **RATESR ENDSR*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SUBW1 Subroutine to write subfile record (subfile 1)
     C**
     C**       Called by   DEBI, DRSR, RDRSR, BOTHSR, OPENDR, B1EQ,
     C**                   B1LT, B1GT, POSTSR, LINE1, #MADI
     C**
     C**       Calls       -
     C**
     C           SUBW1     BEGSR
     C*
     C           WTYP      IFEQ 'P'
     C           *IN63     IFEQ '1'
     C*
     C           @FLAG1    IFEQ 'N'
     C                     OPEN RE3364DR
     C                     MOVE 'Y'       @FLAG1
     C*
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C*
     C                     Z-ADDSFNUMD    ZSNUMD  60
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ     5
     C                     PARM *BLANK    SENTY   3
     C                     PARM           SFILED
     C                     PARM           ZSNUMD
     C                     PARM           ZSERR   1
     C*
     C           ZSERR     IFEQ 'Y'
     C*
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C*
     C                     SETON                     U7U8LR
     C                     MOVE '3'       WCANC                           074600
     C                     RETRN
     C                     END
     C*
     C                     END
     C*
     C                     ADD  1         PAGD
     C                     WRITERE3364D1
     C                     MOVE '0'       *IN63
     C                     MOVEL*BLANK    SDAT1
     C                     WRITERE3364D2
     C           BMCBAI    IFEQ 'Y'                                       CRE003
     C                     MOVELNAR,16    SDAT1
     C                     ELSE                                           CRE003
     C                     MOVELNAR,37    SDAT1                           CRE003
     C                     END                                            CRE003
     C                     WRITERE3364D2
     C           CER016    IFEQ 'Y'                                                         BUG22235
     C           DRIC      ANDEQ*ZERO                                                       BUG22235
     C                     Z-ADD8         J                                                 BUG22235
     C                     ELSE                                                             BUG22235
     C                     Z-ADDDRIC      J       10
     C                     ENDIF                                                            BUG22235
     C                     MOVEL*BLANKS   SDAT1
     C                     MOVE CAC,J     SDAT1
     C/COPY WNCPYSRC,RE3364EC18
     C                     WRITERE3364D2
     C                     MOVEL*BLANK    SDAT1
     C                     WRITERE3364D2
     C                     MOVELAREA      SDAT1
     C                     END
     C           CDICI     IFNE *BLANKS                                   074581
     C                     WRITERE3364D2
     C                     END                                            074581
     C                     ELSE
     C                     ADD  1         PAGE1
     C*
     C***********          ADD  1         RECN1                           075071
     C***********          WRITERE3364B1                                  075071
     C                     EXSR ADDRC1                                    075071
     C*
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SUBW2 Subroutine to write subfile record (subfiles 2 and 3)
     C**
     C**       Called by   DEBI, CRSR, BOTHSR, POSTSR, RCRSR, DAYCSR,
     C**                   B1EQ, B1LT, B1GT, OPENCR, LINE2, #MACI
     C**
     C**       Calls       -
     C**
     C           SUBW2     BEGSR
     C*
     C           WTYP      IFEQ 'P'
     C           *IN64     IFEQ '1'
     C*
     C           @FLAG2    IFEQ 'N'
     C                     OPEN RE3364CR
     C                     MOVE 'Y'       @FLAG2
     C*
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C*
     C                     Z-ADDSFNUMC    ZSNUMC  60
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM *BLANK    SENTY
     C                     PARM           SFILEC
     C                     PARM           ZSNUMC
     C                     PARM           ZSERR   1
     C*
     C           ZSERR     IFEQ 'Y'
     C*
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C*
     C                     SETON                     U7U8LR
     C                     MOVE '3'       WCANC                           074600
     C                     RETRN
     C                     END
     C*
     C                     END
     C*
     C                     ADD  1         PAGC
     C                     WRITERE33641C
     C                     MOVE '0'       *IN64
     C                     MOVEL*BLANK    SDAT2
     C                     WRITERE33642C
     C           BMCBAI    IFEQ 'Y'                                       CRE003
     C                     MOVELNAR,16    SDAT2
     C                     ELSE                                           CRE003
     C                     MOVELNAR,37    SDAT2                           CRE003
     C                     END                                            CRE003
     C                     WRITERE33642C
     C           CER016    IFEQ 'Y'                                                         BUG22235
     C           CRIC      ANDEQ*ZERO                                                       BUG22235
     C                     Z-ADD8         J                                                 BUG22235
     C                     ELSE                                                             BUG22235
     C                     Z-ADDCRIC      J       10
     C                     ENDIF                                                            BUG22235
     C                     MOVEL*BLANKS   SDAT2
     C                     MOVE CAC,J     SDAT2
     C/COPY WNCPYSRC,RE3364EC19
     C                     WRITERE33642C
     C                     MOVEL*BLANK    SDAT2
     C                     WRITERE33642C
     C                     MOVELAREA      SDAT2
     C                     END
     C           CCICI     IFNE *BLANKS                                   074581
     C                     WRITERE33642C
     C                     END                                            074581
     C                     ELSE
     C                     ADD  1         PAGE2
     C*
     C***********          ADD  1         RECN2                           075071
     C***********          WRITERE3364B2                                  075071
     C                     EXSR ADDRC2                                    075071
     C*
     C                     END
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** SUBW3 Subroutine to write subfile record
     C**
     C**      Called by    POSTSR, CRSR, BOTHSR, B1LT
     C**
     C**      Calls        -
     C**
     C           SUBW3     BEGSR
     C*
     C           WTYP      IFEQ 'P'                        - B1
     C           *IN65     IFEQ '1'                        - B2
     C*
     C           @FLAG3    IFEQ 'N'                        - B3
     C                     OPEN RE3364CH
     C                     MOVE 'Y'       @FLAG3
     C*
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C*
     C                     Z-ADDSFNUMH    ZSNUMH  60
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM *BLANK    SENTY
     C                     PARM           SFILEH
     C                     PARM           ZSNUMH
     C                     PARM           ZSERR   1
     C*
     C           ZSERR     IFEQ 'Y'                        - B4
     C*
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C*
     C                     SETON                     U7U8LR
     C                     MOVE '3'       WCANC                           074600
     C                     RETRN
     C                     END                             - E4
     C*
     C                     END                             - E3
     C*
     C                     ADD  1         PAGH
     C                     WRITERE3364H1
     C                     MOVE '0'       *IN65
     C                     MOVEL*BLANK    SDAT3
     C                     WRITERE3364H2
     C           BMCBAI    IFEQ 'Y'                                       CRE003
     C                     MOVELNAR,22    SDAT3
     C                     ELSE                                           CRE003
     C                     MOVELNAR,38    SDAT3                           CRE003
     C                     END                                            CRE003
     C                     WRITERE3364H2
     C                     MOVEL*BLANK    SDAT3
     C                     WRITERE3364H2
     C                     MOVELAREA      SDAT3
     C                     END                             - E2
     C           CCICI     IFNE *BLANKS                                   074581
     C                     WRITERE3364H2
     C                     END                                            074581
     C                     ELSE                            - X1
     C*
     C***********          ADD  1         RECN3                           075071
     C***********          WRITERE3364B3                                  075071
     C                     EXSR ADDRC3                                    075071
     C*
     C                     END                             - E1
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** LINE1 Subroutine to add a blank line in subfile 1
     C**
     C**     Called by     DRSR, BOTHSR
     C**
     C**     Calls         SUBW1
     C**
     C           LINE1     BEGSR
     C*
     C                     MOVE *BLANKS   SDAT1
     C                     EXSR SUBW1
     C*
     C                     ENDSR
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** LINE2 Subroutine to insert blank line in subfile
     C**       RE3364B2 and B3  (subfiles 2 & 3)
     C**
     C**      Called by    CRSR, BOTHSR
     C**
     C**      Calls        SUBW2
     C**
     C           LINE2     BEGSR
     C*
     C                     MOVE *BLANKS   SDAT2
     C                     EXSR SUBW2
     C*
     C                     ENDSR
     C*
     C********************************************************************
     C/EJECT
     C/COPY ZSRSRC,ZICDREZ2                                                                   MQ1590
     C*****************************************************************                       MQ1590
     C**********                                                                              MQ1590
     C***ZICD*subroutine*to*find*number*of*days*to*calculate*interest**                       MQ1590
     C********according*to*calculation*basis***************************                       MQ1590
     C**********                                                                              MQ1590
     C*******Called*by*******DRSR,*CRSR,*BOTHSR************************                       MQ1590
     C*******Calls***********ZDATE2,*DBSR******************************                       MQ1590
     C**********                                                                              MQ1590
     C********** ZICD      BEGSR                           **ZICD BEGSR**                     MQ1590
     C**********                                                                              MQ1590
     C***TO*DETERMINE*NUMBER*OF*DAYS*INTEREST*TO*BE*CALCULATED*********                       MQ1590
     C**********                                                                              MQ1590
     C********** ZIEND     SUB  ZIBEG     ZDAYN2                                              MQ1590
     C**********                                                                              MQ1590
     C***CHECK*FOR*INTEREST*CALCULATION*BASIS**************************                       MQ1590
     C**********                                                                              MQ1590
     C********** ZICALC    IFEQ 3                          - B1                               MQ1590
     C*COPY*WNCPYSRC,RE3364EC20                                                               MQ1590
     C********** ZIEND     IFGT ZIBEG                      - B2                               MQ1590
     C**********                                                                              MQ1590
     C***CALCULATING*DATE*FROM*DAY*NUMBER*(BEGINNING*DATE)*************                       MQ1590
     C**********                                                                              MQ1590
     C**********           Z-ADDZIBEG     ZDAYNO                                              MQ1590
     C**********           MOVE '0'       *IN99                                               MQ1590
     C**********           EXSR ZDATE2                                                        MQ1590
     C**********                                                                              MQ1590
     C***VERIFY*IF*ERROR***********************************************                       MQ1590
     C**********                                                                              MQ1590
     C********** *IN99     IFEQ '1'                        - B3                               MQ1590
     C********** *LOCK     IN   LDA                                                           MQ1590
     C**********           Z-ADD041       DBASE            ***************                    MQ1590
     C**********           MOVE 'ZDATE2'  DBFILE           * DB ERROR 041*                    MQ1590
     C**********           MOVE *BLANKS   DBKEY            ***************                    MQ1590
     C**********           OUT  LDA                                                           MQ1590
     C**********           MOVEA'1'       *IN,89                                              MQ1590
     C**********           EXSR DBSR                                                          MQ1590
     C**********           END                             - E3                               MQ1590
     C**********                                                                              MQ1590
     C**********           Z-ADDZDATE     SRES                                                MQ1590
     C**********                                                                              MQ1590
     C***CALCULATING*DATE*FROM*DAY*NUMBER*(FINISHING*DATE)*************                       MQ1590
     C**********                                                                              MQ1590
     C**********           Z-ADDZIEND     ZDAYNO                                              MQ1590
     C**********           MOVE '0'       *IN99                                               MQ1590
     C**********           EXSR ZDATE2                                                        MQ1590
     C**********                                                                              MQ1590
     C***VERIFY*IF*ERROR***********************************************                       MQ1590
     C**********                                                                              MQ1590
     C********** *IN99     IFEQ '1'                        - B3                               MQ1590
     C********** *LOCK     IN   LDA                                                           MQ1590
     C**********           Z-ADD042       DBASE            ***************                    MQ1590
     C**********           MOVE 'ZDATE2'  DBFILE           * DB ERROR 042*                    MQ1590
     C**********           MOVE *BLANKS   DBKEY            ***************                    MQ1590
     C**********           OUT  LDA                                                           MQ1590
     C**********           MOVEA'1'       *IN,89                                              MQ1590
     C**********           EXSR DBSR                                                          MQ1590
     C**********           END                             - E3                               MQ1590
     C**********                                                                              MQ1590
     C**********           Z-ADDZDATE     FRES                                                MQ1590
     C**********                                                                              MQ1590
     C***IN*ORDER*FOR*THE*FINISH*YEAR*TO*BE*LESS*THAN*THE*START*YEAR*IF*ZIEND                 MQ1590
     C***IS*GREATER*THAN*ZIBEG,*THEN*THE*DATE*ZIEND*MUST*BE*IN*A*DIFFERENT                    MQ1590
     C***CENTURY*TO*ZIBEG.*IF*SO*ADD*100*YEARS*TO*IT.******************                       MQ1590
     C**********                                                                              MQ1590
     C********** ZIFY      IFLT ZISY                       - B3                               MQ1590
     C********** ZIFY      ADD  100       ZIFY2   30                                          MQ1590
     C**********           ELSE                            - X3                               MQ1590
     C**********           Z-ADDZIFY      ZIFY2                                               MQ1590
     C**********           END                             - E3                               MQ1590
     C**********                                                                              MQ1590
     C**********           Z-ADDZISY      ZISY2   30                                          MQ1590
     C**********                                                                              MQ1590
     C***DETERMINE*WHETHER*START*YEAR*IS*A*LEAP*YEAR*AND*IF*START*MONTH                       MQ1590
     C***IS*FEBRUARY**THEN*CONSIDER*LAST*DAY*OF*FEBRUARY*AS*DATE*30ND.*OF*THE                 MQ1590
     C***MONTH**                                                                              MQ1590
     C**********                                                                              MQ1590
     C*COPY*WNCPYSRC,RE3364EC24                                                               MQ1590
     C********** ZISM      IFEQ 2                          - B3                               MQ1590
     C********** ZISY2     ADD  1900      ZLYCHK  40                                          MQ1590
     C********** ZLYCHK    DIV  4         ZLYCHK                                              MQ1590
     C**********           MVR            ZLYREM  20                                          MQ1590
     C********** ZLYREM    IFEQ 0                          - B4                               MQ1590
     C********** ZISD      IFEQ 29                         - B5                               MQ1590
     C**********           Z-ADD30        ZISD                                                MQ1590
     C**********           END                             - E5                               MQ1590
     C**********           ELSE                            - X4                               MQ1590
     C********** ZISD      IFEQ 28                         - B5                               MQ1590
     C**********           Z-ADD30        ZISD                                                MQ1590
     C**********           END                             - E5                               MQ1590
     C**********           END                             - E4                               MQ1590
     C**********           END                             - E3                               MQ1590
     C*COPY*WNCPYSRC,RE3364EC25                                                               MQ1590
     C**********                                                                              MQ1590
     C********** 30        SUB  ZISD      ZID1                                                MQ1590
     C**********                                                                              MQ1590
     C********** ZID1      IFLT 0                          - B3                               MQ1590
     C**********           Z-ADD*ZEROS    ZID1                                                MQ1590
     C**********           END                             - E3                               MQ1590
     C**********                                                                              MQ1590
     C********** ZISM      IFEQ 12                         - B3                               MQ1590
     C**********           Z-ADD*ZEROS    ZISM                                                MQ1590
     C**********           ADD  1         ZISY                                                MQ1590
     C**********           ADD  1         ZISY2                                               MQ1590
     C**********           END                             - E3                               MQ1590
     C**********                                                                              MQ1590
     C***DETERMINE*WHETHER*END*YEAR*IS*A*LEAP*YEAR*AND*IF*END*MONTH*IS*FEBRUARY               MQ1590
     C**********                                                                              MQ1590
     C*COPY*WNCPYSRC,RE3364EC26                                                               MQ1590
     C********** ZIFM      IFEQ 2                          - B3                               MQ1590
     C********** ZIFY2     ADD  1900      ZLYCHK  40                                          MQ1590
     C********** ZLYCHK    DIV  4         ZLYCHK                                              MQ1590
     C**********           MVR            ZLYREM  20                                          MQ1590
     C********** ZLYREM    IFEQ 0                          - B4                               MQ1590
     C********** ZIFD      IFEQ 29                         - B5                               MQ1590
     C**********           Z-ADD30        ZIFD                                                MQ1590
     C**********           END                             - E5                               MQ1590
     C**********           ELSE                            - X4                               MQ1590
     C********** ZIFD      IFEQ 28                         - B5                               MQ1590
     C**********           Z-ADD30        ZIFD                                                MQ1590
     C**********           END                             - E5                               MQ1590
     C**********           END                             - E4                               MQ1590
     C**********           END                             - E3                               MQ1590
     C*COPY*WNCPYSRC,RE3364EC27                                                               MQ1590
     C**********                                                                              MQ1590
     C********** ZIFD      IFEQ 31                         - B3                               MQ1590
     C**********           ADD  30        ZID1                                                MQ1590
     C**********           ELSE                            - X3                               MQ1590
     C**********           ADD  ZIFD      ZID1                                                MQ1590
     C**********           END                             - E3                               MQ1590
     C**********                                                                              MQ1590
     C**********           SUB  1         ZIFM                                                MQ1590
     C**********                                                                              MQ1590
     C********** ZISY      IFEQ ZIFY                       - B3                               MQ1590
     C********** ZIFM      SUB  ZISM      ZINOM   30                                          MQ1590
     C**********           ELSE                            - X3                               MQ1590
     C********** 12        SUB  ZISM      ZIM1                                                MQ1590
     C**********           Z-ADD1         ZISM                                                MQ1590
     C**********                                                                              MQ1590
     C***USE*ENLARGE*FIELDS*THAT*CAN*HANDLE*1999*ONWARDS***************                       MQ1590
     C**********                                                                              MQ1590
     C**********           ADD  1         ZISY2                                               MQ1590
     C********** ZIFY2     SUB  ZISY2     ZIY1                                                MQ1590
     C********** ZIY1      MULT 12        ZIM2    30                                          MQ1590
     C********** ZIM2      ADD  ZIFM      ZIM2                                                MQ1590
     C********** ZIM2      ADD  ZIM1      ZINOM                                               MQ1590
     C**********                                                                              MQ1590
     C**********           END                             - E3                               MQ1590
     C**********                                                                              MQ1590
     C********** ZINOM     MULT 30        ZID2                                                MQ1590
     C********** ZID2      ADD  ZID1      ZDAYN2                                              MQ1590
     C**********                                                                              MQ1590
     C**********           END                             - E2                               MQ1590
     C**********                                                                              MQ1590
     C**********           END                             - E1                               MQ1590
     C**********                                                                              MQ1590
     C********** ZICALC    IFEQ 4                          - B1                               MQ1590
     C********** ZICALC    OREQ 5                                                             MQ1590
     C**********                                                                              MQ1590
     C***ONE*DAY*IS*SUBTRACTED*FROM*ZDAYN2*FOR*EACH*OCCURANCE*OF*29*FEB*IN*THE                MQ1590
     C***THE*INTEREST*CALCULATION*PERIOD*INCLUSIVE*OF*ZIBEG*AND*ZIEND**                       MQ1590
     C**********                                                                              MQ1590
     C***FIND*NO*OF*FOUR*YEAR*PERIODS*BETWEEN*DATES********************                       MQ1590
     C**********                                                                              MQ1590
     C********** ZDAYN2    DIV  1461      ZIMAN                                               MQ1590
     C**********           MVR            ZIREM                                               MQ1590
     C**********                                                                              MQ1590
     C***FIND*NEXT*29*FEB*DAY*NO.*ON*OR*AFTER*ZIBEG.*******************                       MQ1590
     C**********                                                                              MQ1590
     C********** ZIBEG     SUB  60        ZIBW1                                               MQ1590
     C********** ZIBW1     DIV  1461      ZIDW1                                               MQ1590
     C**********           MVR            ZIDREM                                              MQ1590
     C**********                                                                              MQ1590
     C********** ZIDREM    IFEQ 0                          - B2                               MQ1590
     C**********           Z-ADDZIBEG     ZIDW2                                               MQ1590
     C**********           END                             - E2                               MQ1590
     C**********                                                                              MQ1590
     C***ROUND*UP*RESULT***********************************************                       MQ1590
     C**********                                                                              MQ1590
     C********** ZIDW1     ADD  1         ZIDW2                                               MQ1590
     C**********                                                                              MQ1590
     C***CALCULATE*NEXT*29*FEB.****************************************                       MQ1590
     C**********                                                                              MQ1590
     C********** ZIDW2     MULT 1461      ZIDW2                                               MQ1590
     C********** ZIDW2     ADD  60        ZIDW2                                               MQ1590
     C**********                                                                              MQ1590
     C***IF*THIS*NEXT*29*FEB.*DAYNO*-*ZIBEG*IS*GREATER*OR*EQUAL*TO*ZIREM*THEN                 MQ1590
     C***ADD*1*TO*ZIMAN.***********************************************                       MQ1590
     C**********                                                                              MQ1590
     C********** ZIDW2     SUB  ZIBEG     ZILPCP                                              MQ1590
     C**********                                                                              MQ1590
     C********** ZIREM     IFGE ZILPCP                     - B2                               MQ1590
     C**********           ADD  1         ZIMAN                                               MQ1590
     C**********           END                             - E2                               MQ1590
     C**********                                                                              MQ1590
     C***SUBTRACT*ZIMAN*FROM*ZDAYN2*TO*GIVE*VALUE*OF*ZDAYN2*REQUIRED*FOR*THIS                 MQ1590
     C***INTEREST*CALCULATION******************************************                       MQ1590
     C**********                                                                              MQ1590
     C********** ZDAYN2    SUB  ZIMAN     ZDAYN2                                              MQ1590
     C**********                                                                              MQ1590
     C**********           END                             - E1                               MQ1590
     C**********                                                                              MQ1590
     C**********           ENDSR                           **ZICD ENDSR**                     MQ1590
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** DBSR subroutine for database error handling
     C**
     C**     Called by     FIRST, DRSR, RATED, CRSR, RATEC, BOTHSR,
     C**                   B1EQ, B1LT, B1GT, OPENDR, POSTSR, OPENCR,
     C**                   ZICD, #MACI, #MADI
     C**
     C**     Calls         *PSSR
     C**
     C           DBSR      BEGSR                           **DBSR BEGSR**
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C                     MOVE '3'       WCANC                           074600
     C*                                                                   LN0111
     C                     OPEN RE3364AU
     C*
     C**   ENSURE REPORT SPOOL FILE RECORDED BY RCF
     C*
     C                     Z-ADDSFNUMA    ZSNUMA  60
     C*
     C                     CALL 'ZSFILE'
     C                     PARM           SEQ
     C                     PARM *BLANK    SENTY
     C                     PARM           SFILEA
     C                     PARM           ZSNUMA
     C                     PARM           ZSERR   1
     C*
     C           ZSERR     IFEQ 'Y'
     C*
     C**  ERROR DURING ZSFILE PROCESSING, RETURN TO CALLING PROGRAM
     C*
     C                     SETON                     U7U8LR
     C                     MOVE '3'       WCANC                           074600
     C                     RETRN
     C                     END
     C*
     C***********          OPEN RE3364AU                                  074600
     C*
     C                     WRITEHEADAU
     C*
     C                     WRITEERRAU
     C*
     C                     CLOSERE3364AU
     C*
     C                     EXSR *PSSR
     C*
     C                     RETRN
     C*
     C                     ENDSR                           **DBSR ENDSR**
     C********************************************************************094431
     C/EJECT                                                              094431
     C********************************************************************094431
     C**                                                                  094431
     C** CREDI SUBROUTINE TO DISPLAY MANUAL ADJUSTMENT - CR               094431
     C**                                                                  094431
     C********************************************************************094431
     C           #CREDI    BEGSR                           *CREDI BEGSR** 094431
     C*                                                                   094431
     C                     Z-ADDHISDM     ZDAYNO                          094431
     C                     MOVE '0'       *IN99                           094431
     C                     EXSR ZDATE2                                    094431
     C*                                                                   094431
     C** VERIFY IF ERROR                                                  094431
     C*                                                                   094431
     C           *IN99     IFEQ '1'                        - B3           094431
     C           *LOCK     IN   LDA                                       094431
     C                     Z-ADD046       DBASE            ***************094431
     C                     MOVE 'ZDAT2'   DBFILE           * DB ERROR 046*094431
     C                     MOVELHISDM     DBKEY            ***************094431
     C                     OUT  LDA                                       094431
     C                     MOVEA'1'       *IN,89                          094431
     C                     EXSR DBSR                                      094431
     C                     END                             - E3           094431
     C*                                                                   094431
     C                     ADD  CRIA      WWADJC                          094431
     C                     MOVELZDATE     ADJDT                           094431
     C                     MOVELNAR,32    NARR                            094431
     C           CRIA      IFLT 0                                         094431
     C           CRIA      MULT SUBT      CRIA                            094431
     C                     MOVE '-'       ADJS                            094431
     C                     END                                            094431
     C                     Z-ADDCRIA      WWMACI                          094431
     C*                                                                   094431
     C                     MOVEL*BLANKS   ZFIELD                          094431
     C                     MOVE WWMACI    ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ADJT                            094431
     C                     EXSR OUT8SR                                    094431
     C                     MOVELAREA      SDAT2                           094431
     C                     EXSR SUBW2                                     094431
     C*                                                                   094431
     C                     ENDSR                           **     ENDSR** 094431
     C/EJECT                                                              094431
     C********************************************************************094431
     C**                                                                  094431
     C** #DEBI SUBROUTINE TO DISPLAY MANUAL ADJUSTMENT - DR               094431
     C**                                                                  094431
     C********************************************************************094431
     C           #DEBI     BEGSR                           **DEBI BEGSR** 094431
     C*                                                                   094431
     C                     Z-ADDHISDM     ZDAYNO                          094431
     C                     MOVE '0'       *IN99                           094431
     C                     EXSR ZDATE2                                    094431
     C*                                                                   094431
     C** VERIFY IF ERROR                                                  094431
     C*                                                                   094431
     C           *IN99     IFEQ '1'                        - B3           094431
     C           *LOCK     IN   LDA                                       094431
     C                     Z-ADD047       DBASE            ***************094431
     C                     MOVE 'ZDAT2'   DBFILE           * DB ERROR 047*094431
     C                     MOVELHISDM     DBKEY            ***************094431
     C                     OUT  LDA                                       094431
     C                     MOVEA'1'       *IN,89                          094431
     C                     EXSR DBSR                                      094431
     C                     END                             - E3           094431
     C*                                                                   094431
     C                     ADD  DRIA      WWADJD                          094431
     C                     MOVELZDATE     ADJDT                           094431
     C                     MOVELNAR,31    NARR                            094431
     C           DRIA      IFLT 0                                         094431
     C           DRIA      MULT SUBT      DRIA                            094431
     C                     MOVE '-'       ADJS                            094431
     C                     END                                            094431
     C                     Z-ADDDRIA      WWMADI                          094431
     C*                                                                   094431
     C                     MOVEL*BLANKS   ZFIELD                          094431
     C                     MOVE WWMADI    ZFIELD                          094431
     C                     Z-ADDDECI1     ZADIG                           094431
     C                     EXSR ZEDIT                                     094431
     C                     MOVE ZFIELD    ADJT                            094431
     C                     EXSR OUT8SR                                    094431
     C                     MOVELAREA      SDAT1                           094431
     C                     EXSR SUBW1                                     094431
     C*                                                                   094431
     C                     ENDSR                              **  ENDSR** 094431
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** #MADI Subroutine to display manual adjustment
     C**
     C**     Called by     BOTHSR
     C**
     C**     Calls         ZDATE2, DBSR, ZEDIT, SUBW1
     C**
     C           #MADI     BEGSR                           **DBSR BEGSR**
     C*
     C           *LIKE     DEFN DMADI     WWMADI
     C           *LIKE     DEFN DMADI     WWADJD
     C                     Z-ADDDHISD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B3
     C           *LOCK     IN   LDA
     C                     Z-ADD0043      DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 043*
     C                     MOVELHISD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E3
     C*
     C                     MOVELZDATE     ADJDT
     C                     MOVELNAR,31    NARR
     C                     Z-ADDDMADI     WWMADI
     C                     ADD  WWMADI    WWADJD
     C           WWMADI    IFLT 0
     C                     MOVE '-'       ADJS
     C           WWMADI    MULT SUBT      WWMADI
     C                     END
     C*
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WWMADI    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ADJT
     C***********          EXCPTOUT8                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT8SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT1
     C                     EXSR SUBW1
     C*
     C                     ENDSR                           **DBSR ENDSR**
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** #MACI Subroutine to display manual adjustment
     C**
     C**     Called by     BOTHSR
     C**
     C**     Calls         ZDATE2, DBSR, ZEDIT, SUBW2
     C**
     C           #MACI     BEGSR                           **DBSR BEGSR**
     C*
     C           *LIKE     DEFN DMACI     WWMACI
     C           *LIKE     DEFN DMACI     WWADJC
     C*
     C                     Z-ADDDHISD     ZDAYNO
     C                     MOVE '0'       *IN99
     C                     EXSR ZDATE2
     C*
     C** VERIFY IF ERROR
     C*
     C           *IN99     IFEQ '1'                        - B3
     C           *LOCK     IN   LDA
     C                     Z-ADD044       DBASE            ***************
     C                     MOVE 'ZDATE2'  DBFILE           * DB ERROR 044*
     C                     MOVELHISD      DBKEY            ***************
     C                     OUT  LDA
     C                     MOVEA'1'       *IN,89
     C                     EXSR DBSR
     C                     END                             - E3
     C*
     C                     MOVELZDATE     ADJDT
     C                     MOVELNAR,32    NARR
     C                     Z-ADDDMACI     WWMACI
     C                     ADD  WWMACI    WWADJC
     C           WWMACI    IFLT 0
     C                     MOVE '-'       ADJS
     C           WWMACI    MULT SUBT      WWMACI
     C                     END
     C*
     C                     MOVEL*BLANKS   ZFIELD
     C                     MOVE WWMACI    ZFIELD
     C                     Z-ADDDECI1     ZADIG
     C                     EXSR ZEDIT
     C                     MOVE ZFIELD    ADJT
     C***********          EXCPTOUT8                                      086093
     C***********          READ GHOST                    99               086093
     C                     EXSR OUT8SR                     formatAREAType1086093
     C                     MOVELAREA      SDAT2
     C                     EXSR SUBW2
     C*
     C                     ENDSR                           **DBSR ENDSR**
     C********************************************************************
     C/EJECT
     C*****************************************************************
     C**
     C** ZASNMS  Subroutine to send message to program message queue
     C**
     C**      Called by    SPLI
     C**
     C**      Calls        Y2SNMGC
     C**
     C           ZASNMS    BEGSR
     C*
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGM            Program queue
     C                     PARM           ZAPGRL           Rel queue
     C                     PARM           ZAMSID           Message Id.
     C                     PARM           ZAMSGF           Message file.
     C                     PARM           ZAMSDA           Message data.
     C                     PARM           ZAMSTP           Message type.
     C*
     C** Clear all fields for default mechanism next time.
     C*
     C                     MOVEL*BLANK    ZAPGM            Message queue
     C                     MOVEL*BLANK    ZAPGRL           Rel queue
     C                     MOVEL*BLANK    ZAMSDA           Message data.
     C                     MOVEL*BLANK    ZAMSTP           Message type.
     C*
     C           ZASNM9    ENDSR                           ZASNM9 TAG
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZDATE2  Subroutine to convert day number to date format
     C**
     C**       Called by   DRSR, RATED, CRSR, RATEC, BOTHSR, B1EQ,
     C**                   B1LT, B1GT, OPENDR, POSTSR, OPENCR, ZICD,
     C**                   #MACI, #MADI
     C**
     C**       Calls       -
     C**
     C/COPY ZSRSRC,ZDATE2Z2
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** ZEDIT  Subroutine to insert decimal point and suppress
     C**        leading zeros
     C**
     C**       Called by    DRSR, RDRSR, CRSR, RCRSR, DAYCSR, BOTHSR,
     C**                    B1EQ, B1LT, B1GT, OPENDR, POSTSR, OPENCR,
     C**                    #MACI, #MADI
     C**
     C**       Calls        -
     C**
     C/COPY ZSRSRC,ZEDITZ2
     C/COPY ZSRSRC,ZDATE1Z2                                                                   MQ1590
     C*
     C********************************************************************
     C/EJECT
     C********************************************************************
     C**
     C** *PSSR  Subroutine to handle abnormal error conditions
     C**
     C**     Called by     DBSR
     C**
     C**     Calls         -
     C**
     C           *PSSR     BEGSR                           ** *PSSR **
     C*
     C           @RUN      IFEQ *BLANKS
     C                     MOVE 'Y'       @RUN    1
     C                     DUMP
     C                     END
     C*
     C                     MOVE '1'       *INU7
     C                     MOVE '1'       *INU8
     C                     MOVE '1'       *INLR
     C                     MOVE '3'       WCANC                           074600
     C*
     C                     ENDSR                           ** *PSSR **
     C********************************************************************
      /EJECT                                                              086254
      *****************************************************************   086254
      *                                                               *   086254
      *  EDTPER   Edit Interest Rate Percentage                       *   086254
      *                                with trailing minus            *   086254
      *                                                               *   086254
      *  Called by:                                                   *   086254
      *                                                               *   086254
      *****************************************************************   086254
     C           EDTPER    BEGSR                                          086254
      *                                                                   086254
     C                     MOVE WKRAT     WRK150 150P      set SR parm    086254
      *                                                                   086093
     C           *IN25     IFEQ *ON                                       086093
     C                     EXSR ZEDITB                     edit with brckt086254
     C***********          MOVE ZFLDBP    WRK14  14        unload rm086254088827
     C                     MOVE ZFLDB     WRK14  14        unload SR Parm 088827
     C                     MOVELWRK14     RATOMP 15 P                     086254
     C                     ELSE                                           086093
     C                     EXSR ZEDTBP                     edit brckt/%age086254
     C***********          MOVE ZFLDB     RATOMP 15        unload rm086254088827
     C                     MOVE ZFLDBP    RATOMP 15        unload SR Parm 088827
     C                     ENDIF                                          086093
      *                                                                   086254
     C           *LIKE     DEFN INRT      WKRAT                           086254
      *                                                                   086254
     C                     ENDSR                                          086254
      *****************************************************************   086254
      *                                                               *   086254
      *  EDTINT   Edit Interest Rate - with trailing minus            *   086254
      *                                                               *   086254
      *  Called by:                                                   *   086254
      *                                                               *   086254
      *****************************************************************   086254
     C           EDTINT    BEGSR                                          086254
      *                                                                   086254
     C                     MOVE WKINT     WRK150 150P      set SR parm    086254
     C                     EXSR ZEDITM                     edit with minus086254
     C***********          MOVE ZFLDM     INTRM  12        unload S086254 118816
     C                     MOVE ZFLDM     INTRM  13        unload SR parm 118816
      *                                                                   086254
     C           *LIKE     DEFN INTD0     WKINT                           086254
     C                     ENDSR                                          086254
      /EJECT                                                              086254
      *****************************************************************   086254
      *                                                               *   086254
      *  ZEDITM   Edit With Trailing Minus sign                       *   086254
      *                                                               *   086254
      *  Called by: EDTINT                                            *   086254
      *                                                               *   086254
      *****************************************************************   086254
     C           ZEDITM    BEGSR                                          086254
      *                                                                   086254
     C           WRK150    IFLT 0                                         086254
     C                     Z-SUBWRK150    WRK150                          086254
     C                     MOVE '-'       ZFLDM                           086254
     C                     ELSE                                           086254
     C                     MOVE ' '       ZFLDM                           086254
     C                     ENDIF                                          086254
      *                                                                   086254
     C                     MOVE WRK150    ZFIELD    P      set SR parm    086254
     C                     EXSR ZEDIT                      edit           086254
     C                     MOVELZFIELD    ZFLDM            unload SR parm 086254
      *                                                                   086254
     C           *LIKE     DEFN ZFIELD    ZFLDM + 1                       086254
      *                                                                   086254
     C                     ENDSR                                          086254
      *****************************************************************   086254
      *                                                               *   086254
      *  ZEDITB   Edit With Brackets                                  *   086254
      *                                                               *   086254
      *  Called by:                                                   *   086254
      *                                                               *   086254
      *****************************************************************   086254
     C           ZEDITB    BEGSR                                          086254
      *                                                                   086254
      * set up ZFIELD (& ZA2) + Negative Indicator                        086254
     C                     EXSR ZWRKNG                     edit           086254
      *                                                                   086254
     C           WNEGTV    IFEQ *ON                                       086254
     C                     MOVE ' '       Z#2,1                           086254
     C                     MOVEAZFIELD    Z#2,2                           086254
     C                     Z-ADD1         X#      30                      086254
     C           ' '       LOKUPZ#2,X#               99    get 1st nonBlnk086254
     C                     SUB  1         X#                              086254
     C                     MOVE '('       Z#2,X#                          086254
     C                     MOVEAZ#2,1     ZFLDB                           086254
     C                     MOVE ')'       ZFLDB                           086254
     C                     ELSE                                           086254
     C                     MOVELZFIELD    ZFLDB                           088826
     C                     MOVE ' '       ZFLDB                           086254
     C                     ENDIF                                          086254
      *                                                                   086254
     C***********          MOVELZFIELD    ZFLDB                     086254088826
      *                                                                   086254
     C           *LIKE     DEFN ZFIELD    ZFLDB + 2                       086254
      *                                                                   086254
     C                     ENDSR                                          086254
      *****************************************************************   086254
      *                                                               *   086254
      *  ZEDTBP   Edit With Brackets & Percent sign                   *   086254
      *                                                               *   086254
      *  Called by: EDTPER                                            *   086254
      *                                                               *   086254
      *****************************************************************   086254
     C           ZEDTBP    BEGSR                                          086254
      *                                                                   086254
      * set up ZFIELD (& ZA2) + Negative Indicator                        086254
     C                     EXSR ZWRKNG                     edit           086254
      *                                                                   086254
     C           WNEGTV    IFEQ *ON                                       086254
     C                     MOVE ' '       Z#3,1                           086254
     C                     MOVEAZFIELD    Z#3,2                           086254
     C                     Z-ADD1         X#      30                      086254
     C           ' '       LOKUPZ#3,X#               99    get 1st nonBlnk086254
     C                     SUB  1         X#                              086254
     C                     MOVE '('       Z#3,X#                          086254
     C                     MOVEAZ#3,1     ZFLDBP                          086254
     C                     MOVE '%)'      ZFLDBP                          086254
     C                     ELSE                                           086254
     C                     MOVELZFIELD    ZFLDBP                          088826
     C                     MOVE '% '      ZFLDBP                          086254
     C                     ENDIF                                          086254
      *                                                                   086254
     C***********          MOVELZFIELD    ZFLDBP                    086254088826
      *                                                                   086254
     C           *LIKE     DEFN ZFIELD    ZFLDBP+ 3                       086254
      *                                                                   086254
     C                     ENDSR                                          086254
      /EJECT                                                              086254
      *****************************************************************   086254
      *                                                               *   086254
      *  ZWRKNG   Utility for editing if maybe negative               *   086254
      *           using WRK15.0                                       *   086254
      *                                                               *   086254
      *  Called by: ZEDTBP,ZEDITB                                     *   086254
      *                                                               *   086254
      *****************************************************************   086254
     C           ZWRKNG    BEGSR                                          086254
      *                                                                   086254
     C           WRK150    IFLT 0                                         086254
     C                     Z-SUBWRK150    WRK150                          086254
     C                     MOVE *ON       WNEGTV  1                       086254
     C                     ELSE                                           086254
     C                     MOVE *OFF      WNEGTV                          086254
     C                     ENDIF                                          086254
      *                                                                   086254
     C                     MOVE WRK150    ZFIELD    P      set SR parm    086254
     C                     EXSR ZEDIT                      edit           086254
      *                                                                   086254
     C                     ENDSR                                          086254
     C/EJECT
      *****************************************************************   086093
      *                                                               *   086093
      *  OUT1SR   Format AREA (as formerly in EXCPT OUT1)             *   086093
      *                                                               *   086093
      *  Called by:                                                   *   086093
      *                                                               *   086093
      *****************************************************************   086093
     C           OUT1SR    BEGSR                                          086093
      *                                                                   086093
     C                     MOVE *BLANKS   AREA             initialize     086093
      *                                                                   086093
     C                     MOVEAPSTDA     AR,1             Post Date      086093
     C                     MOVEAVALDA     AR,8             Value Date     086093
     C                     MOVEANARR      AR,18                           086093
     C***********          MOVEARATOMP    AR,50                    086093 118816
     C                     MOVEARATOMP    AR,51                           118816
      *                                                                   086093
     C                     RESETPSTDA                                     086093
     C                     RESETVALDA                                     086093
     C                     RESETNARR                                      086093
     C                     RESETRATOMP                                    086093
      *                                                                   086093
     C                     ENDSR                                          086093
      *****************************************************************   086093
      *                                                               *   086093
      *  OUT2SR   Format AREA (as formerly in EXCPT OUT2)             *   086093
      *                                                               *   086093
      *  Called by:                                                   *   086093
      *                                                               *   086093
      *****************************************************************   086093
     C           OUT2SR    BEGSR                                          086093
      *                                                                   086093
     C                     MOVE *BLANKS   AREA             initialize     086093
      *                                                                   086093
     C                     MOVEAPSTDA     AR,1             Post Date      086093
     C                     MOVEAVALDA     AR,8             Value Date     086093
     C                     MOVEAND        AR,14            NumberOfDays   086093
     C                     MOVEANARR      AR,18                           086093
     C                     MOVEAAMON      AR,49                           086093
     C***********          MOVEACR        AR,62            'CR' or 086093 118816
     C                     MOVEACR        AR,63            'CR' or blank. 118816
     C                     MOVE COMMVT    AR,65            '*' or blank.  086093
     C***********          MOVEAINTRM     AR,68            interest086093 118816
     C                     MOVEAINTRM     AR,67            interest incl  118816
      *                                                    '-' or blank.  086093
      *                                                                   086093
     C                     RESETPSTDA                                     086093
     C                     RESETVALDA                                     086093
     C                     RESETND                                        086093
     C                     RESETNARR                                      086093
     C                     RESETAMON                                      086093
     C                     RESETCR                                        086093
     C                     RESETCOMMVT                                    086093
     C                     RESETINTRM                                     086093
      *                                                                   086093
     C                     ENDSR                                          086093
      *****************************************************************   086093
      *                                                               *   086093
      *  OUT3SR   Format AREA (as formerly in EXCPT OUT3)             *   086093
      *                                                               *   086093
      *  Called by:                                                   *   086093
      *                                                               *   086093
      *****************************************************************   086093
     C           OUT3SR    BEGSR                                          086093
      *                                                                   086093
     C                     MOVE *BLANKS   AREA             initialize     086093
      *                                                                   086093
     C                     MOVEAPSTD2     AR,1             Post Date      086093
     C                     MOVEAVALD2     AR,8             Value Date     086093
     C                     MOVEAND        AR,14            NumberOfDays   086093
     C                     MOVEANARR2     AR,18                           086093
     C                     MOVEAAMON2     AR,49                           086093
     C***********          MOVEACR2       AR,62            'CR' or 086093 118816
     C***********          MOVEACHAR      AR,64                    086093 118816
     C***********          MOVE HSIG      AR,77            '-' or b086093 118816
     C                     MOVEACR2       AR,63            'CR' or blank. 118816
     C                     MOVEACHAR      AR,65                           118816
     C                     MOVE HSIG      AR,78            '-' or blank.  118816
      *                                                                   086093
     C                     RESETPSTD2                                     086093
     C                     RESETVALD2                                     086093
     C                     RESETND                                        086093
     C                     RESETNARR2                                     086093
     C                     RESETAMON2                                     086093
     C                     RESETCR2                                       086093
     C                     RESETCHAR                                      086093
     C                     RESETHSIG                                      086093
      *                                                                   086093
     C                     ENDSR                                          086093
      *****************************************************************   086093
      *                                                               *   086093
      *  OUT4SR   Format AREA (as formerly in EXCPT OUT4)             *   086093
      *                                                               *   086093
      *  Called by:                                                   *   086093
      *                                                               *   086093
      *****************************************************************   086093
     C           OUT4SR    BEGSR                                          086093
      *                                                                   086093
     C                     MOVE *BLANKS   AREA             initialize     086093
      *                                                                   086093
     C                     MOVEA'****'    AR,25                           086093
     C                     MOVE ARB,Y     WRK16  16                       086093
     C                     MOVEAWRK16     AR,31            balance        086093
     C                     MOVEA'****'    AR,48                           086093
     C                     MOVE ARR,Y     WRK16  16                       086093
     C                     MOVEAWRK16     AR,53            rate           086093
     C                     MOVE NEG,Y     AR,69            '-' or blank.  086093
     C                     MOVEA'****'    AR,70                           086093
      *                                                                   086093
     C                     ENDSR                                          086093
      *****************************************************************   086093
      *                                                               *   086093
      *  OUT5SR   Format AREA (as formerly in EXCPT OUT5)             *   086093
      *                                                               *   086093
      *  Called by:                                                   *   086093
      *                                                               *   086093
      *****************************************************************   086093
     C           OUT5SR    BEGSR                                          086093
      *                                                                   086093
     C                     MOVE *BLANKS   AREA             initialize     086093
      *                                                                   086093
     C                     MOVEAND        AR,14            NumberOfDays   086093
     C                     MOVEANUMB      AR,24                           086093
     C***********          MOVEAAMON      AR,53                    086093 118816
     C***********          MOVEACR        AR,66            'CR' or 086093 118816
     C***********          MOVEAINTRM     AR,68            interest086093 118816
     C                     MOVEAAMON      AR,51                           118816
     C                     MOVEACR        AR,65            'CR' or blank. 118816
     C                     MOVEAINTRM     AR,67            interest incl  118816
      *                                                    '-' or blank.  086093
      *                                                                   086093
     C                     RESETND                                        086093
     C                     RESETNUMB                                      086093
     C                     RESETAMON                                      086093
     C                     RESETCR                                        086093
     C                     RESETINTRM                                     086093
      *                                                                   086093
     C                     ENDSR                                          086093
      *****************************************************************   086093
      *                                                               *   086093
      *  OUT6SR   Format AREA (as formerly in EXCPT OUT6)             *   086093
      *                                                               *   086093
      *  Called by:                                                   *   086093
      *                                                               *   086093
      *****************************************************************   086093
     C           OUT6SR    BEGSR                                          086093
      *                                                                   086093
     C                     MOVE *BLANKS   AREA             initialize     086093
      *                                                                   086093
     C                     MOVEAVALDA     AR,8             Value Date     086093
     C                     MOVEANARR      AR,18                           086093
     C***********          MOVEAAMON      AR,53                    086093 118816
     C***********          MOVEACR        AR,66            'CR' or 086093 118816
     C                     MOVEAAMON      AR,51                           118816
     C                     MOVEACR        AR,65            'CR' or blank. 118816
      *                                                                   086093
     C                     RESETVALDA                                     086093
     C                     RESETNARR                                      086093
     C                     RESETAMON                                      086093
     C                     RESETCR                                        086093
      *                                                                   086093
     C                     ENDSR                                          086093
      *****************************************************************   086093
      *                                                               *   086093
      *  OUT7SR   Format AREA (as formerly in EXCPT OUT7)             *   086093
      *                                                               *   086093
      *  Called by:                                                   *   086093
      *                                                               *   086093
      *****************************************************************   086093
     C           OUT7SR    BEGSR                                          086093
      *                                                                   086093
     C                     MOVE *BLANKS   AREA             initialize     086093
      *                                                                   086093
     C                     MOVEANARR      AR,3                            086093
     C                     MOVEATOTN      AR,35                           086093
      *                                                                   086093
     C                     RESETNARR                                      086093
     C                     RESETTOTN                                      086093
      *                                                                   086093
     C                     ENDSR                                          086093
      *****************************************************************   086093
      *                                                               *   086093
      *  OUT8SR   Format AREA (as formerly in EXCPT OUT8)             *   086093
      *                                                               *   086093
      *  Called by:                                                   *   086093
      *                                                               *   086093
      *****************************************************************   086093
     C           OUT8SR    BEGSR                                          086093
      *                                                                   086093
     C                     MOVE *BLANKS   AREA             initialize     086093
      *                                                                   086093
     C                     MOVEAADJDT     AR,8                            086093
     C                     MOVEANARR      AR,21                           086093
     C                     MOVEAADJT      AR,68                           086093
     C                     MOVE ADJS      AR,79            '-' or blank.  086093
      *                                                                   086093
     C                     RESETADJDT                                     086093
     C                     RESETNARR                                      086093
     C                     RESETADJT                                      086093
     C                     RESETADJS                                      086093
      *                                                                   086093
     C                     ENDSR                                          086093
      *****************************************************************   086093
      *                                                               *   086093
      *  OUT9SR   Format AREA (as formerly in EXCPT OUT9)             *   086093
      *                                                               *   086093
      *  Called by:                                                   *   086093
      *                                                               *   086093
      *****************************************************************   086093
     C           OUT9SR    BEGSR                                          086093
      *                                                                   086093
     C                     MOVE *BLANKS   AREA             initialize     086093
      *                                                                   086093
     C                     MOVEAPSTDA     AR,1             Post Date      086093
     C                     MOVEAVALDA     AR,8             Value Date     086093
     C                     MOVEANARR      AR,18                           086093
     C                     MOVEATPST      AR,61                           086093
      *                                                                   086093
     C                     RESETPSTDA                                     086093
     C                     RESETVALDA                                     086093
     C                     RESETNARR                                      086093
     C                     RESETTPST                                      086093
      *                                                                   086093
     C                     ENDSR                                          086093
      *****************************************************************                       CER050
      *  SRDRAP  APR Debit Processing                                 *                       CER050
      *****************************************************************                       CER050
     C           SRDRAP    BEGSR                                                              CER050
      *                                                                                       CER050
     C                     MOVE *OFF      *IN84                                               CER050
     C                     MOVE *BLANKS   VALDA                                               CER050
     C                     MOVE *BLANKS   PSTDA                                               CER050
      *                                                                                       CER050
      ** Move APR narrative to screen narrative field.                                        CER050
     C                     MOVELUIANAR    NARR                                                CER050
      *                                                                                       CER050
      ** Get debit APR rate from LF/REEAPHL0.                                                 CER050
     C           ACNO      CHAINREAPRHI0             84                                       CER050
      *                                                                                       CER050
      ** If rate not found move *ZEROs to field, else move rate.                              CER050
     C                     MOVE *BLANKS   ZFIELD                                              CER050
     C           *IN84     IFEQ *ON                                                           CER050
     C           ATAPRC    ORNE 'Y'                                                           CER050
     C                     MOVE APR0      APRNO                                               CER050
     C                     ELSE                                                               CER050
     C                     MOVE IAPRR     ZFIELD                                              CER050
      *                                                                                       CER050
      ** format APR rate and move to screen field.                                            CER050
     C                     Z-ADD2         ZADEC                                               CER050
     C                     EXSR ZEDIT                                                         CER050
     C           *IN99     IFEQ *OFF                                                          CER050
     C                     MOVE ZFIELD    APRNO                                               CER050
     C                     ENDIF                                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     MOVELAPR       RATOMP                                              CER050
     C                     Z-ADDSAVEZ     ZADEC                                               CER050
      *                                                                                       CER050
     C                     EXSR OUT1SR                                                        CER050
     C                     MOVELAREA      SDAT1                                               CER050
     C                     EXSR SUBW1                                                         CER050
      *                                                                                       CER050
     C                     ENDSR                                                              CER050
      *****************************************************************                       CER050
      *  SRCRAP - APR Credit Processing                               *                       CER050
      *****************************************************************                       CER050
     C           SRCRAP    BEGSR                                                              CER050
      *                                                                                       CER050
     C                     MOVE *OFF      *IN84                                               CER050
     C                     MOVE *BLANKS   VALDA                                               CER050
     C                     MOVE *BLANKS   PSTDA                                               CER050
      ** Move APR narrative to screen narrative field.                                        CER050
     C                     MOVELUIANAR    NARR                                                CER050
      ** Get credit APR rate from LF/REAPRHI1.                                                CER050
     C           ACNO      CHAINREAPRHI1             84                                       CER050
      ** If rate not found move *ZEROs to field, else move rate.                              CER050
     C                     MOVE *BLANKS   ZFIELD                                              CER050
     C           *IN84     IFEQ *ON                                                           CER050
     C           ATAPRC    ORNE 'Y'                                                           CER050
     C                     MOVE APR0      APRNO                                               CER050
     C                     ELSE                                                               CER050
     C                     MOVE IAPRR     ZFIELD                                              CER050
      *                                                                                       CER050
      ** format APR rate and move to screen field.                                            CER050
     C                     Z-ADD2         ZADEC                                               CER050
     C                     EXSR ZEDIT                                                         CER050
     C           *IN99     IFEQ *OFF                                                          CER050
     C                     MOVE ZFIELD    APRNO                                               CER050
     C                     ENDIF                                                              CER050
     C                     ENDIF                                                              CER050
      *                                                                                       CER050
     C                     MOVELAPR       RATOMP                                              CER050
     C                     Z-ADDSAVEZ     ZADEC                                               CER050
      *                                                                                       CER050
     C                     EXSR OUT1SR                                                        CER050
     C                     MOVELAREA      SDAT2                                               CER050
     C                     EXSR SUBW2                                                         CER050
      *                                                                                       CER050
     C                     ENDSR                                                              CER050
     C/COPY WNCPYSRC,RE3364EC06
     O*
     O*GHOST**E**              OUT1                                       086093
     O***********              PSTDA  B   6                               086093
     O***********              VALDA  B  13                               086093
     O***********     N87      ND     B  17                               086093
     O***********              NARR   B  47                               086093
     O***********              RATO   B  61                               086093
     O***********     N25                62 '%'                           086093
     O*GHOST**E**              OUT2                                       086093
     O***********              PSTDA  B   6                               086093
     O***********              VALDA  B  13                               086093
     O***********              ND     B  17                               086093
     O***********              NARR   B  47                               086093
     O***********              AMON   B  61                               086093
     O***********              CR     B  63                               086093
     O***********              COMMVT B  65                         064993086093
     O***********              INTR   B  78                               086093
     O***********              WSIG   B  79                               086093
     O*GHOST**E**              OUT3                                       086093
     O***********              PSTD2  B   6                               086093
     O***********              VALD2  B  13                               086093
     O***********              ND     B  17                               086093
     O***********              NARR2  B  47                               086093
     O***********              AMON2  B  61                               086093
     O***********              CR2    B  63                               086093
     O***********              CHAR   B  76                               086093
     O***********              HSIG   B  77                               086093
     O***********              REB    B  79                               086093
     O*GHOST**E**              OUT4                                       086093
     O***********                        28 '****'                        086093
     O***********              ZN1    B  46                               086093
     O***********                        51 '****'                        086093
     O***********              ZN2    B  68                               086093
     O***********              ZN3    B  69                         077129086093
     O***********                        73 '****'                        086093
     O*GHOST**E**              OUT5                                       086093
     O***********              ND     B  17                               086093
     O***********              NUMB   B  36                               086093
     O***********              AMON   B  65                               086093
     O***********              CR     B  67                               086093
     O***********              INTR   B  78                               086093
     O***********              WSIG   B  79                               086093
     O*GHOST**E**              OUT6                                       086093
     O***********              VALDA  B  13                               086093
     O***********              NARR   B  47                               086093
     O***********              AMON   B  65                               086093
     O***********              CR     B  67                               086093
     O*GHOST**E**              OUT7                                       086093
     O***********              NARR   B  32                               086093
     O***********              TOTN   B  50                               086093
     O*GHOST**E**              OUT8                                       086093
     O***********              ADJDT  B  13                               086093
     O***********              NARR   B  50                               086093
     O***********              ADJT   B  78                               086093
     O***********              ADJS   B  79                               086093
     O*GHOST**E**              OUT9                                       086093
     O***********              PSTDA  B   6                               086093
     O***********              VALDA  B  13                               086093
     O***********              NARR   B  47                               086093
     O***********              TPST   B  75                               086093
     O*
     O*  1 ELEMENT  ADDED TO CAC FOR DISPLAY OF INTEREST CALC METHOD      084790
     O*  3 ELEMENTS ADDED TO NAR FOR GERMAN FEATURES (33 - 35) AND        CRE003
     O*  ELEMENT 33 MOVED TO 36 AND                                       CRE003
     O*  2 ELEMENTS ADDED FOR LEDGER BALANCE ACCRUALS (37 & 38)           CRE003
     O*  1 ELEMENT ADDED TO ARRAY NAR                                     089497
     O*  2 ELEMENTS ADDED TO ARRAY NAR                                    099509
     O*  1 ELEMENT ADDED TO ARRAY NAR ('Maximum number of records....')   113955
      *                                                                                     BUG23024
      ** Array CAC - Calculation method (element #8)                                        BUG23024
      ** ** FOR RETAIL **                    **   ACR/366  **   CER016                      BUG23024
      *                                                                                     BUG23024
      ** Array NAR - changed ** Tot debit number ** to ** Total debit number **             AR744736
      ** changed ** Tot credit number ** to ** Total credit number **                       AR744736
      *                                                                                     AR744736
**   ZYDY - YEARS IN DAYS CUMULATIVE, FOUR YEAR SPAN
0366073110961461
**   ZMDY - MONTHS IN DAYS CUMULATIVE THROUGH YEAR
000031059090120151181212243273304334365
**   ZMNM - MONTHS SHORT NAMES
JANFEBMARAPRMAYJUNJULAUGSEPOCTNOVDEC
**  CPY@  OBJECT COPYRIGHT
(c) Finastra International Limited 2001
**  NAR
 ** B/F Balance             **
 ** Opening Balance         **
 ** Debit Opening Rate      **
 ** Debit Rate Change To    **
 ** Total Interest          **
 ** Balance C/F             **
 ** Total Debit posted      **
 ** Credit Opening Rate     **
 ** Credit Rate Change To   **
 ** Total Credit posted     **
 ** Debit Rate Change       **
 ** Credit Rate Change      **
 ** For Balances Over       **
 ** For Balances Over       **
Debit Interest
P.Date V.Date Nd          Narrative              Amount          Interest
Credit Interest
F3=Exit  F12=Previous screen
F3=Exit  F12=Previous screen  F20=Interest/Charges
F3=Exit  F12=Previous screen  F19=Credit
F3=Exit  F12=Previous screen  F18=Debit  F20=Interest/Charges
P.Date V.Date Nd          Narrative              Amount          Charges     R
                                                                         >>   +
                                                                         <<   +
 ** Total Charges           **
 ** Total debit number **                                                                   AR744736
 ** Total credit number**                                                                   AR744736
 ** Total to be posted      **
 ** Adjustment to be posted **
 ** Interest due at start   **
 ** Debit Manual Adjustment **
 **Credit Manual Adjustment **
 ** Overdraft limit         **
 ** Additional overdr. rate **
 ** New limit               **
F3=Exit  F12=Previous  screen  F18=Debit  F20=Credit
P.Date E.Date Nd          Narrative              Amount          Interest
P.Date E.Date Nd          Narrative              Amount          Charges     R
 ** Adjusted Balance C/F    **
 ** Adj.to be posted ***ALT***
 ** Adj.to be posted ***SUSP**
 *** Maximum number of records displayed. Please use option 6. ***
 ** CR Int.Adj.to be posted **
 ** DR Int.Adj.to be posted **
 ** CR Adj.to be posted**ALT**
 ** DR Adj.to be posted**ALT**
 ** CR Adj.to be posted*SUSP**
 ** DR Adj.to be posted*SUSP**
F3=Exit  F12=Previous screen  F18=Debit  F20=Credit                                           CRE090
 ** Delay Adjustment        **                                                             MD027025A
** CAC - Calculation method
                   ** Actual/365 **                    ** Actual/365 **   084790
                   ** Actual/360 **                    ** Actual/360 **   084790
             ** 30 day month/360 **                    **   360/360  **   084790
       ** Actual/365 excl 29/Feb **                    **   365/365  **   084790
       ** Actual/360 excl 29/Feb **                    **   365/360  **   084790
                   ** Actual/366 **                    ** Actual/366 **   084790
 ** Apportioned 30 day month/360 **                    ** App 30/360 **   084790
                   **   ACR/366  **
     X/COPY WNCPYSRC,RE3364EX01
**   CMD - COMMAND TO OVERIDE MESSAGE FILE
DLTOVR FILE(*ALL)
OVRMSGF MSGF(REUSRMSG) TOMSGF(  REUSRMSG)
