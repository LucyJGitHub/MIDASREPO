000100200529     H        1
000110200529      *****************************************************************
000120200529/*S*D****RPGBASE*******************************************************                       CRE105
000130200529/*STD *  RPGSQL                                                       *                       CRE105
000140200529/*EXI *  TEXT('Midas RE Interest and charges capitalisation')         *
000150200529/*XBIA*: OVRDBF FILE(ACCNTX) TOFILE(ACCNT) SHARE(*NO)               : *
000160200529      *****************************************************************
000170200529      *                                                               *
000180200529      *  Midas - Retail Module                                        *
000190200529      *                                                               *
000200200529      *  RE3664 - INTEREST AND CHARGE CAPITALISATION                  *
000210200529      *                                                               *
000220200529      *  (c) Finastra International Limited 2001                      *
000230200529      *                                                               *
000240200604      *  Last Amend No. 260545             Date 22May20               *
000250200529      *  Prev Amend No. MD053762           Date 16Jun19               *
000260200529      *                 MD054559           Date 20Nov19               *
000270200529      *                 CER050             Date 16Jun19               *
000280200529      *                 AR666241           Date 12Aug19               *
000290200529      *                 MD045084           Date 03Aug18               *
000300200529      *                 MD046248           Date 27Oct17               *
000310200529      *                 MD045460           Date 20Jun17               *
000320200529      *                 MD040758           Date 21Oct16               *
000330200529      *                 MD039280A          Date 18Oct16               *
000340200529      *                 MD039001           Date 12Aug16               *
000350200529      *                 MD039280           Date 27Jul16               *
000360200529      *                 MD034990           Date 25May16               *
000370200529      *                 MD032185           Date 02Jun15               *
000380200529      *                 AR676495A          Date 02Jun15               *
000390200529      *                 AR676495           Date 02Jun15               *
000400200529      *                 CRE105             Date 17Mar15               *
000410200529      *                 MD034383           Date 12May15               *
000420200529      *                 CGL165             Date 23Feb15               *
000430200529      *                 228966             Date 28Oct14               *
000440200529      *                 231617             Date 19Aug14               *
000450200529      *                 MD027841           Date 01Jul14               *
000460200529      *                 MD027245           Date 12Jun14               *
000470200529      *                 CRE090             Date 14Feb14               *
000480200529      *                 MD024001           Date 06May14               *
000490200529      *                 MD026742           Date 22May14               *
000500200529      *                 CRE100             Date 21Mar14               *
000510200529      *                 MD024557           Date 14Feb14               *
000520200529      *                 AR830076           Date 16Sep11               *
000530200529      *                 MD022635           Date 30Sep13               *
000540200529      *                 MD022410           Date 13Sep13               *
000550200529      *                 MD022379           Date 12Sep13               *
000560200529      *                 MD021155           Date 16Jul13               *
000570200529      *                 MD020956           Date 18Jun13               *
000580200529      *                 MD020687           Date 11Jun13               *
000590200529      *                 AR577206           Date 16Mar11               *
000600200529      *                 AR1096650          Date 19Mar13               *
000610200529      *                 AR1093681          Date 04Mar13               *
000620200529      *                 AR1089863          Date 19Feb13               *
000630200529      *                 CRE083BK           Date 06Aug12               *
000640200529      *                 AR978914           Date 13Dec12               *
000650200529      *                 261620             Date 28Nov12               *
000660200529      *                 CRE083BE           Date 06Aug12               *
000670200529      *                 AR851468B          Date 27Oct11               *
000680200529      *                 AR851468A          Date 25Oct11               *
000690200529      *                 AR851468           Date 19Oct11               *
000700200529      *                 AR831847           Date 20Sep11               *
000710200529      *                 AR813717           Date 06Sep11               *
000720200529      *                 CER049             Date 06Dec10               *
000730200529      *                 CRE073             Date 06Dec10               *
000740200529      *                 AR787620           Date 10Jun11               *
000750200529      *                 AR784212           Date 03Jun11               *
000760200529      *                 AR762246           Date 27May11               *
000770200529      *                 CRE075             Date 06Dec10               *
000780200529      *                 CLE064             Date 06Dec10               *
000790200529      *                 AR744480           Date 15Apr11               *
000800200529      *                 AR676213           Date 19Nov10               *
000810200529      *                 CER059             Date 19Jul10               *
000820200529      *                 BUG26900           Date 16Jan10               *
000830200529      *                 BUG25530           Date 14Aug08               *
000840200529      *                 BUG26566           Date 28Oct09               *
000850200529      *                 BUG25295           Date 10Aug08               *
000860200529      *                 BUG24341           Date 16Jun09               *
000870200529      *                 CER054             Date 07Apr09               *
000880200529      *                 BUG23309B          Date 29Jun09               *
000890200529      *                 BUG23309A          Date 17Jun09               *
000900200529      *                 BUG24114           Date 09May09               *
000910200529      *                 BUG23732           Date 23Apr09               *
000920200529      *                 BUG23163A          Date 30Apr09               *
000930200529      *                 BUG23163           Date 25Mar09               *
000940200529      *                 BUG23681           Date 03Apr09               *
000950200529      *                 BUG23587           Date 25Mar09               *
000960200529      *                 BUG23123           Date 09Mar09               *
000970200529      *                 BUG23347           Date 18Mar09               *
000980200529      *                 BUG23097A          Date 10Mar09               *
000990200529      *                 CER048             Date 19May08               *
001000200529      *                 CER047             Date 19May08               *
001010200529      *                 CER030             Date 09Jul08               *
001020200529      * Bank Fusion Midas 1.4 Base -----------------------------------*
001030200529      *                 CDL081             Date 14Dec09               *
001040200529      * Midas Plus 1.4 Base 04 ---------------------------------------*
001050200529      *                 BUG14933           Date 02Oct07               *
001060200529      *                 246184             Date 14Mar07               *
001070200529      *                 CRE026             Date 19Feb07               *
001080200529      *                 250998             Date 25Oct07               *
001090200529      *                 BUG12930           Date 04Jan07               *
001100200529      *                 244623             Date 19Jan07               *
001110200529      * Midas Plus 1.3 ----------- Base ------------------------------*
001120200529      *                 135809R            Date 29Jun06               *
001130200529      *                 CDL013             Date 27Jun06               *
001140200529      *                 239314             Date 25May06               *
001150200529      *                 CSD031             Date 10Apr06               *
001160200529      *                 CSD027A            Date 09May06               *
001170200529      *                 CSD027             Date 09Dec05               *
001180200529      *                 BUG9030            Date 22Nov05               *
001190200529      *                 236352             Date 06Sep05               *
001200200529      *                 235917             Date 06Sep05               *
001210200529      *                 235875             Date 06Sep05               *
001220200529      *                 235328             Date 18Aug05               *
001230200529      *                 235174             Date 27Jul05               *
001240200529      *                 235368             Date 05Aug05               *
001250200529      *                 235307             Date 03Aug05               *
001260200529      *                 234870             Date 22Jul05               *
001270200529      *                 234661             Date 04Jul05               *
001280200529      *                 234438             Date 27Jun05               *
001290200529      *                 234003             Date 21Jun05               *
001300200529      *                 233720             Date 26May05               *
001310200529      *                 233719             Date 26May05               *
001320200529      *                 232543             Date 10Mar05               *
001330200529      *                 CGL031             Date 04Jul05               *
001340200529      *                 CSW037A            Date 02May05               *
001350200529      *                 CSD025             Date 11Jan05               *
001360200529      *                 CSW037             Date 15Dec04               *
001370200529      *                 CSW036             Date 15Dec04               *
001380200529      *                 BUG3644            Date 12Jul04               *
001390200529      *                 CLE025             Date 20Oct03               *
001400200529      *                 CGL029             Date 01Sep03               *
001410200529      *                 218393             Date 10Jun03               *
001420200529      *                 217910             Date 30May03               *
001430200529      *                 CRE008             Date 19Feb02               *
001440200529      *                 CGL020             Date 12Dec02               *
001450200529      * Midas Release 4.01.02 ----------------------------------------*
001460200529      *                 211084             Date 25Oct02               *
001470200529      *                 198082             Date 06Mar02               *
001480200529      * Midas Release 4.01 -------------------------------------------*
001490200529      *                 189038             Date 20Aug01               *
001500200529      *                 184965             Date 20Aug01               *
001510200529      *                 183947             Date 20Aug01               *
001520200529      *                 164975             Date 20Aug01               *
001530200529      * Midas Release 4 --------------- Base -------------------------*
001540200529      *                 CDE002             Date 04Apr00               *
001550200529      * Midas DBA 3.05 -----------------------------------------------*
001560200529      *                 CMX001             Data 18Apr01               *
001570200529     F*                 CRE007             Date 01Mar01               *
001580200529     F*                 162319             Date 17Jun99               *
001590200529     F*                 150714             Date 19May99               *
001600200529     F*                 161803             Date 21JUN99               *
001610200529     F*                 129099             Date 07May98               *
001620200529      * Midas DBA 3.04 -----------------------------------------------*
001630200529      * Midas DBA 3.03 -----------------------------------------------*
001640200529      *                 179300             DATE 29Nov99               *
001650200529      *                 156767             DATE 24Nov99               *
001660200529      *                 131825             Date 22Nov99               *
001670200529      * Midas DBA 3.02 -----------------------------------------------*
001680200529      *                 CPB001             Date 01Jun99               *
001690200529      *                 135809             Date 07Jul99               *
001700200529      * Midas DBA 3.01 -----------------------------------------------*
001710200529      *                 CGL007             Date 26Mar99               *
001720200529      * Midas DBA 3.00 ---------------- Base -------------------------*
001730200529      *                 CSD005             Date 02Mar99               *
001740200529      *                 135401             Date 30Apr99               *
001750200529      *                 130468             Date 29Apr99               *
001760200529      *                 CTI002             DATE 09Sep98               *
001770200529     F*                 101861             DATE 18Jun98               *
001780200529     F*                 123519             DATE 27May98               *
001790200529     F*                 091680             DATE 18May98               *
001800200529     F*                 112808 SL          DATE 17Feb98               *
001810200529     F*                 104489             DATE 06Feb98               *
001820200529     F*                 120254             DATE 06FEB98               *
001830200529     F*                 S01408             DATE 26Jan98               *
001840200529     F*                 122952             Date 28OCT97               *
001850200529     F*                 105084             DATE 24SEP97               *
001860200529     F*                 106604             DATE 13MAY97               *
001870200529     F*                 CRE002             Date 18Feb97               *
001880200529     F*                 101656             Date 12Dec96               *
001890200529     F*                 CCB003             Date 31Oct96               *
001900200529     F*                 111921             Date 16Dec96               *
001910200529     F*                 S01408             Date 02Sep96               *
001920200529     F*                 CAC001             Date 01Feb96               *
001930200529     F*                 106213             DATE 22JUL96               *
001940200529     F*                 100086             DATE 18JUL96               *
001950200529     F*                 101847             DATE 04JUN96               *
001960200529     F*                 098818             DATE 15APR96               *
001970200529     F*                 094681             DATE 24NOV95               *
001980200529     F*                 093582             DATE 24APR96               *
001990200529     F*                 092564             DATE 26SEP95               *
002000200529     F*                 091906             DATE 24APR96               *
002010200529     F*                 091896             DATE 24APR96               *
002020200529     F*                 S01408             DATE 11APR96               *
002030200529     F*                 S01408             DATE 29MAR96               *
002040200529     F*                 095656             DATE  8NOV95               *
002050200529     F*                 S01408             DATE 18OCT95               *
002060200529     F*                 085762             DATE 27APR95               *
002070200529     F*                 088181             DATE 15JUN95               *
002080200529     F*                 086125             DATE 16MAR95               *
002090200529     F*                 S01522             DATE 25JAN95               *
002100200529     F*                 081545             DATE 10MAR95               *
002110200529     F*                 088273             DATE 25SEP95               *
002120200529     F*                 092064             DATE 21AUG95               *
002130200529     F*                 089741             DATE 21JUL95               *
002140200529     F*                 087513             DATE 23JUN95               *
002150200529     F*                 087842             DATE 02JUN95               *
002160200529     F*                 084082             DATE 01JUN95               *
002170200529     F*                 085787             DATE 10APR95               *
002180200529     F*                 082592             DATE 06MAR95               *
002190200529     F*                 S01408             DATE 22FEB95               *
002200200529     F*                 076557             DATE 26SEP94               *
002210200529     F*                 084054             DATE 01MAR95               *
002220200529     F*                 080978             DATE 21FEB95               *
002230200529     F*                 075073             DATE 02MAR95               *
002240200529     F*                 074598             DATE 05AUG94               *
002250200529     F*                 071428             DATE 01JUN94               *
002260200529     F*                 071427             DATE 01JUN94               *
002270200529     F*                 071053             DATE 23MAY94               *
002280200529     F*                 069558             DATE 18MAY94               *
002290200529     F*                 057048             DATE 07MAR94               *
002300200529     F*                 060828             DATE 28JAN94               *
002310200529     F*                 048430             DATE 28JAN94               *
002320200529     F*                 B8200              DATE 29SEP93               *
002330200529     F*                 LN0106             DATE 06DEC93               *
002340200529     F*                 049320             DATE 29SEP93               *
002350200529     F*                 052739             DATE 29SEP93               *
002360200529     F*                 S01413 *CREATE     DATE 13APR93               *
002370200529     F*                                                               *
002380200529     F*---------------------------------------------------------------*
002390200529      *                                                               *
002400200529      *  260545 - Incorrect tax postings happened for those accounts  *
002410200529      *           with small interest amount. change condition by     *
002420200529      *           using CINW instead of BCINW.                        *
002430200529      *  MD053762 - Tiered Witholding Tax System Values               *
002440200529      *  MD054559 - Add WWHTAL condition for Alt processing.          *
002450200529      *  CER050 - Annualised Percentage Rate (Recompile)              *
002460200529      *  AR666241 - Discrepancy in RE3810 report due HISB being       *
002470200529      *             updated twice with WHT. Caused by CDL013.         *
002480200529      *             Apply 216656 to ensure HISB is updated once       *
002490200529      *             (Child: AR666242)                                 *
002500200529      *           - Applied for MD054157.                             *
002510200529      *  MD045084 - Complete MD022410. REHISPD can be updated using   *
002520200529      *             more than one format so still get rcd locks.      *
002530200529      *             Apply fix for MD051614.                           *
002540200529      *  MD046248 - Finastra Rebranding                               *
002550200529      *  MD045460 - Net interest for Retail Accounts with defined     *
002560200529      *             alternate account is not posted to main account   *
002570200529      *  MD040758 - Interest posting and tax posting in the main and  *
002580200529      *             alternate account is incorrect when CDL013 is on  *
002590200529      *  MD039280A - Ensure that counterposting of tax to alternate   *
002600200529      *              is done correctly.                               *
002610200529      *  MD039001 - Incorrect multilanguage narrative for Interest    *
002620200529      *             Capitalization. Review MD022635.                  *
002630200529      *  MD039280 - RE AC Int. Capitalised tax to alternate AC in     *
002640200529      *             another ccy, amount not converted.                *
002650200529      *  MD034990 - Postings not posted against account sequence of   *
002660200529      *             the retail account.                               *
002670200529      *  MD032185 -  Job GLC0340 00003 (Midas GL Daily journal - post *
002680200529      *              1) failed with accounting imbalance of EUR 0.02  *
002690200529      *              from Retail Interest Adjustments                 *
002700200529      *  AR676495A - Wrong posting still generated if int. adj. and   *
002710200529      *              AVRT=WLEVEL. Added condition not to use Average  *
002720200529      *              rate limit if CER054 is ON.                      *
002730200529      *            - Applied for MD032185                             *
002740200529      *  AR676495 - Wrong posting when interest adjustment occurred,  *
002750200529      *             Posted gross instead of net for interest adj. and *
002760200529      *             net for int adj. was deducted on total interest   *
002770200529      *             Amended pgm to post net int adj. by reading file  *
002780200529      *             LF/SDCSINL7 and this will correct the deduction of*
002790200529      *             taxes for the total interest.                     *
002800200529      *            - Applied for MD032185                             *
002810200529      *  CRE105 - Modelo 123 and 193 Reports                          *
002820200529      *           Added /COPYs: CRE105_007, CRE105_008, CRE105_009    *
002830200529      *                         CRE105_010, CRE105_011                *
002840200529      *  MD034383 - Amendment to Tax Calculation Program              *
002850200529      *  CGL165 - Dual Withholding Tax                                *
002860200529      *  228966 - Database error caused by a blank Spot Trade Accnt   *
002870200529      *           Equivalent in PF/SDCURRPD. Applied fix 121398.      *
002880200529      *  231617 - Amend 198082 to use WACN0 rather than AAACNO.       *
002890200529      *  MD027841 - Inconsistent display for Interest when system     *
002900200529      *             values RET_CHG_CUS_LVL = 'N' & RET_INTAC_CUST_LVL *
002910200529      *             = 'Y' against RET_CHG_CUS_LVL = 'Y' &             *
002920200529      *             RET_INTAC_CUST_LVL = 'Y'.                         *
002930200529      *  MD027245 - Interest capitalisation not performed on delay    *
002940200529      *             date when demand capitalisation was requested     *
002950200529      *             during delay period.                              *
002960200529      *  CRE090 - Delay Capitalization of Interest                    *
002970200529      *  MD024001 - Avoid ZZ001 update on REHISPS from RETRG.         *
002980200529      *  MD026742 - Accounting Imbalance due to Retail Withholding    *
002990200529      *             Tax.                                              *
003000200529      *  CRE100 - Allow Customer Number For Retail Accrual And Charge *
003010200529      *           Postings.                                           *
003020200529      *  MD024557 - REC64N failed with REHISL file locking error      *
003030200529      *  AR830076 - Apply fix AR318139 (Child:AR830077)               *
003040200529      *  AR318139 - Wrong narrative for when UDC is on. Need to use   *
003050200529      *             German translated narrative when this feature is  *
003060200529      *             on by enhancing BUG23163A. (Child:AR318140)       *
003070200529      *  MD022635 - Multiple reconciliation differences field OTRF,   *
003080200529      *             OTST, FACO needs to be populated.                 *
003090200529      *           - Field PRFC incorrect due to interbranch Fix.      *
003100200529      *           - NAR is not updated. Only blank inside the table.  *
003110200529      *           - Inconsistent index used to udate NARD, causing    *
003120200529      *             incorrect narrative in PNAR.                      *
003130200529      *  MD022410 - Record allocation problem in REC64N               *
003140200529      *  MD022379 - EODPOPD Wrong customer for interbranch            *
003150200529      *  MD021155 - COB Restructure Phase 1 Remnants                  *
003160200529      *           - Caching Issues                                    *
003170200529      *  MD020956 - Blank Posting Narrative on Customer Account       *
003180200529      *             in GE-IC Module.                                  *
003190200529      *  MD020687 - Component REC64N 01005 & 01007 failed             *
003200200529      *  AR577206 - AJAX Narrative on the interest capitalisation     *
003210200529      *             entry (CHILD: AR577207)                           *
003220200529      *           - Amend MGD index to retrieve narrative             *
003230200529      *             "Interest nnnnnnnnnn"                             *
003240200529      *  AR1096650 - Caching flaw found in linked test                *
003250200529      *  AR1093681 - REC64N eror encountered in link test             *
003260200529      *  AR1089863 - Merging issues of 2.0 and 2.1 releases           *
003270200529      *  CRE083BK - COB Restructure - RE COB Optimisation Phase 1     *
003280200529      *  AR978914 - Reinstated fix 135809 for data reconciliation     *
003290200529      *             purposes. (Child: AR978915)                       *
003300200529      *  261620 - Multiple reconciliation differences that seem to be *
003310200529      *           caused by CRE008.                                   *
003320200529      *           Amended in such a way that the population of FACO,  *
003330200529      *           OTRF & OTST will be correct.                        *
003340200529      *         - Applied for AR1006287 (Child: AR1006288)            *
003350200529      *  CRE083BE - COB Restructure - RE COB Optimisation Phase 1     *
003360200529      *  AR851468B - Do not use withholding tax account when          *
003370200529      *              CGL031 is switched on (Child:AR851469)           *
003380200529      *  AR851468A - Wtax and main tax are posted simultaneously      *
003390200529      *              (Child:AR851469)                                 *
003400200529      *  AR851468 - No tax when CR interest posted on alternate       *
003410200529      *             account (Child:AR851469)                          *
003420200529      *  AR831847 - Missing PostNetInterest system value              *
003430200529      *             (Child:AR831848)                                  *
003440200529      *  AR813717 - Main and secondary taxes not found(Child:AR814547)*
003450200529      *  CER049 - Stamp Tax                                           *
003460200529      *  CRE073 - Interest Rate Rounding (Recompile)                  *
003470200529      *  AR787620 - Hooks Incorporation                               *
003480200529      *             WNCPYSRC,REH00026                                 *
003490200529      *             WNCPYSRC,REH00015                                 *
003500200529      *             WNCPYSRC,REH00016                                 *
003510200529      *             WNCPYSRC,REH00024                                 *
003520200529      *             WNCPYSRC,REH00025                                 *
003530200529      *             WNCPYSRC,REH00017                                 *
003540200529      *             WNCPYSRC,REH00018                                 *
003550200529      *             WNCPYSRC,REH00019                                 *
003560200529      *             WNCPYSRC,REH00020                                 *
003570200529      *             WNCPYSRC,REH00021                                 *
003580200529      *             WNCPYSRC,REH00022                                 *
003590200529      *             WNCPYSRC,REH00023                                 *
003600200529      *  AR784212 - Next interest capitalisation date does not default*
003610200529      *             based on defined currency and location holiday    *
003620200529      *             table. Applied fix 252356                         *
003630200529      *  252356 - Amended system to pass variable BJSLCD before       *
003640200529      *           chaining to the holidays file.                      *
003650200529      *  AR762246 - Incorrect tax amount posted in ACMV               *
003660200529      *  CRE075 - Effective Date for Retail Accounts (Recompile)      *
003670200529      *  CLE064 - Enhancement of Lending Frequencies (Recompile)      *
003680200529      *  AR744480 - Taxes not reflected in the Account movements while*
003690200529      *             interest is posted  (Child: AR744481)             *
003700200529      *  AR676213 - Incorrect definition of CLGLAI field (Recompile)  *
003710200529      *  CER059 - German Feature Upgrade to Delhi                     *
003720200529      *  BUG26900 - Double posting of taxes in apostpd                *
003730200529      *  BUG25530 - Difference in value dates for main tax, interest  *
003740200529      *             and 2nd, 3rd tax                                  *
003750200529      *  BUG26566 - GLC30 0001: At least one currency is out of bal.  *
003760200529      *           - Applied fix BUG25343                              *
003770200529      *  BUG25295 - 24114 and 23347 Extended for Church Tax           *
003780200529      *  BUG24341 - Thresholds were not considered in calculation of  *
003790200529      *             Main tax and the label for Third Tax is incorrect *
003800200529      *  CER054 - German Features - Church Tax                        *
003810200529      *  BUG23309B -  REACR updated only for the positive value of    *
003820200529      *               History Balance.                                *
003830200529      *  BUG23309A -  OSIC showing difference between History and     *
003840200529      *               Ledger Balance                                  *
003850200529      *  BUG24114 - Limit Utilisation Enquiry and report is showing a *
003860200529      *             Minus figure                                      *
003870200529      *  BUG23732 - Joint Account threshold (Recompile)               *
003880200529      *  BUG23163A - Posting Narrative needs to be changed re-open    *
003890200529      *  BUG23163 - Interest posting Narrative needs to be changed    *
003900200529      *  BUG23681 - REC64N Error - Updating SDINPHL2 w/out prior read *
003910200529      *  BUG23587 - Saving Account Threshold no more required         *
003920200529      *  BUG23123 - Report: Does not show Retail Account Number       *
003930200529      *                     Date is not Midas Standard Date           *
003940200529      *                     Period should be actual int. calc. period *
003950200529      *                     Secondary Tax amount is not printed       *
003960200529      *                     Added field TSSLID                        *
003970200529      *                     (Recompile)                               *
003980200529      *  BUG23347 - Average rate less than the Retail Accounts rate   *
003990200529      *             defined on Country of Taxes                       *
004000200529      *  BUG23097A - Various errors in GLC30 00001                    *
004010200529      *  CER048 - German Features - Taxes                             *
004020200529      *  CER047 - German Features LF037-00 Reporting §24c KWG         *
004030200529      *           (Recompile)                                         *
004040200529      *  CER030 - Multicash German Feature (Recompile)                *
004050200529      *  CDL081 - Tiered withholding tax rounding upgrade             *
004060200529      *  BUG14933 - Error in checking switchable feature CSW207       *
004070200529      *             (Recompile)                                       *
004080200529      *  246184 - If spot trade account code field is blank, do not   *
004090200529      *           chain to SDACODPD anymore to prevent DBERROR 86.    *
004100200529      *  CRE026 - Consumer Banking                                    *
004110200529      *  250998 - Added SR/DETPR to allow the system to compute for   *
004120200529      *           charges for transaction type 91060 seperately.      *
004130200529      *  BUG12930 - Change the length of data area CBTASKSP to 10     *
004140200529      *             characters. (Recompile)                           *
004150200529      *  244623 - Retail Accnt is not accruing (in RE3380P1) daily.   *
004160200529      *           If the Account's interest capitalisation frequency  *
004170200529      *           is 'A', the system updates the next capitalisation  *
004180200529      *           date with the current accrual date instead of the   *
004190200529      *           next accrual date. Applied fix 226373.              *
004200200529      *           Coding done by Bug9030.                             *
004210200529      *  135809R- Remove fix 135809 as it clashes with CDL013         *
004220200529      *  CDL013 - Tiered Withholding Tax                              *
004230200529      *  239314 - If spot trade equivalent is not existing, do not    *
004240200529      *           generate postings for spot trade equivalent.        *
004250200529      *           Apply 161915.                                       *
004260200529      *  CSD031 - Enhanced Centralised Static Data (Recompile)        *
004270200529      *  CSD027A- Conversion of cust. no. to alpha (post 103 build)   *
004280200529      *  CSD027 - Conversion Of Customer Number to Alpha              *
004290200529      *  BUG9030 - Problem with Accruals (Applied fix 226373).        *
004300200529      *  236352 - Wrong narrative for EU tax postings (with REPNAR)   *
004310200529      *           MsgID GB00243 replaced by GB00540/GB00541/GB00542   *
004320200529      *           because GB0024X are used for withholding taxes      *
004330200529      *  235917 - Wrong and duplicate EU tax postings for joint A/C   *
004340200529      *  235875 - Allow negative EU tax amounts (for neg. CR int.adj.)*
004350200529      *  235328 - Wrong narrative for CR int adjustments due to       *
004360200529      *           EU tax changes                                      *
004370200529      *  235174 - Trade a/c keys do not consider Joint A/c country.   *
004380200529      *  235368 - Value date for EU tax postings must be set to SHISD *
004390200529      *  235307 - No debit posting must be generated in account       *
004400200529      *           currency on the EU tax account                      *
004410200529      *  234870 - Several errors in EU tax management                 *
004420200529      *  234661 - TOF is showing incorrect amounts.                   *
004430200529      *  234438 - Narrative missing on RE capitalization posting.     *
004440200529      *  234003 - No tax calculated on interest for retail a/c.       *
004450200529      *  233720 - Process must be based on RCAIC                      *
004460200529      *  233719 - WTAOC must be put in PIORAM                         *
004470200529      *  232543 - Fix to CGL031                                       *
004480200529      *  CGL031 - Taxation on Savings Income                          *
004490200529      *  CSW037A- Additional Field extended to 40 chars (recompile)   *
004500200529      *  CSD025 - Customer De-Activation                              *
004510200529      *  CSW037 - Additional Field Data on MT300/MT320                *
004520200529      *  CSW036 - Dual SWIFT BIC held on Client Details               *
004530200529      *  BUG3644 - Serious Error in Collateralised Lending (Recompile)*
004540200529      *  CLE025 - Credit Lines (Recompile)                            *
004550200529      *  CGL029 - Increase Account Code to 10 digits                  *
004560200529      *  218393 - GA unlink errors (CRE008 fix)                       *
004570200529      *  217910 - Show retail old retail account on postings          *
004580200529      *           for mapped GAs  (CRE008 fix)                        *
004590200529      *  CRE008 - Cash Management                                     *
004600200529      *  CGL020 - Compliance Watch - Additional A/C Postings          *
004610200529      *           Information                                         *
004620200529      *  211084 - Complete 184965 : The size of the fields passed to  *
004630200529      *           AOPRFMR0 doesn't correspond to the entry fields of  *
004640200529      *           this access object                                  *
004650200529      *  198082 - Posting narrative should be <MSG> brca-<cust><ccy>  *
004660200529      *           <acno> when retail account number is already zero   *
004670200529      *           due to mapping.                                     *
004680200529      *  189038 - Interest posted on closing account shows the wrong  *
004690200529      *           narrative. Changed narrative to 'Interest'. Applied *
004700200529      *           fixes 183578 and 167772.                            *
004710200529      *  184965 - Postings with SPOS = 'GE-IC' do not contain profit  *
004720200529      *           centre. Applied fix 143578.                         *
004730200529      *  183947 - Remove '-' from posting narrative if account is not *
004740200529     F*  164975 - For accounts capitalising on a weekly, forthnightly *
004750200529     F*           or semi-monthly basis, the next cap. date should be *
004760200529     F*           set on or after the next working date.              *
004770200529      *  CDE002 - Revenue Analysis - Recompiled due to changes in     *
004780200529      *           PF/RECCYD.                                          *
004790200529     F*  CMX001 - Meridian Export                                     *
004800200529     F*  CRE007 - Base Rate Tax 2001.                                 *
004810200529     F*  162319 - Incorrect transaction type                          *
004820200529     F*  150714 - Complete 129099                                     *
004830200529     F*           ADD TEST FOR INTEREST OF CAPITALIZATION             *
004840200529     F*  161803 - INCORRECT TRANSACTION TYPE TRANSFERRED TO INTERFACE *
004850200529     F*  129099 - Identify Capitalisation Postings:                   *
004860200529     F*           Split 91060 to 91061 / 91062                        *
004870200529     F*                 91040 to 91041 / 91042                        *
004880200529     F*  179300 - Ensure that IPDT is set up correctly, as NCID is    *
004890200529     F*           now updated before BRT procedures are called.       *
004900200529     F*           Save NCID, and use this saved value rather than     *
004910200529     F*           NCID in OUTBRT sub.                                 *
004920200529     F*  156767 - Prohibit generation of entry to REINCXPD if account *
004930200529     F*           is secondary.  This would ensure that no posting is *
004940200529     F*           reported in RE5420 for the secondary account.       *
004950200529     F*  131825 - Postings should not be produced if Dr Interest      *
004960200529     F*           payment account codes are equal for Dr and Cr       *
004970200529     F*           or Cr Interest payment account codes Cr is equal    *
004980200529     F*           debit interest sub to tax or not subject to tax.    *
004990200529     F*  CPB001 - Meridian DBA Middleware Replication Customization.  *
005000200529     F*           Midas/TOF Interface.                                *
005010200529      *  135809 - Withholding tax retained in the wrong branch when   *
005020200529      *           alternative a/c used. Post gross interest and tax   *
005030200529      *           to main a/c, then transfer net interest to alt. a/c.*
005040200529      *  CGL007 - Account Postings Enquiry.  Recompile.               *
005050200529      *  CSD005 - Standing Data Account Narrative.  Add new field     *
005060200529      *           to SDACODPD.  Recompilation of programs.            *
005070200529     F*  135401 - Change the posting narratives to specify whether an *
005080200529     F*           Interest Adjustment is a DR or CR.                  *
005090200529     F*  130468 - BRT not deducted from CR interest adjustments.      *
005100200529     F*           BRT processing amended to calculate BRT on total of *
005110200529     F*           CR adjustments plus CR interest and to output BRT   *
005120200529     F*           as a separate DR posting to the retail a/c (instead *
005130200529     F*           of deducting it from the interest). Also BRT should *
005140200529     F*           be deducted when an alternative a/c is used.        *
005150200529      *  CTI002 - Recompiled : File SDACODPD changed                  *
005160200529     F*  101861 - No Withholding tax is ever deducted if an           *
005170200529     F*           alternative account for credit interest is defined. *
005180200529     F*           CACP should be moved left into the work field.      *
005190200529     F*  123519 - Interest posted to suspense instead of alternative  *
005200200529     F*           a/c when full a/c no. used for alt a/c. Ensure alt. *
005210200529     F*           a/c branch code is taken from the REHISPS record.   *
005220200529     F*  091680 - Ensure manual adjustment reversing out accrued      *
005230200529     F*           interest is correctly processed.                    *
005240200529     F*           NB. This fix depends on REHISSL selecting on        *
005250200529     F*           SDICI *NE ' ' & PMADI *NE TMADI or SCICI *NE ' ' &  *
005260200529     F*           PMACI *NE TMACI (fix 084790).                       *
005270200529     F*  112808 - VALUE DATE NOT SET UP FOR POSTINGS TO ALTERNATE A/C *
005280200529     F*  104489 - Control cap. date for closure cap. for 1st day      *
005290200529     F*           accruals should be run date instead of run date + 1.*
005300200529     F*           Charge fields were not set correctly for closure    *
005310200529     F*           cap. due to wrong control cap. date., causing       *
005320200529     F*           capitalised charges to show as outstanding in OSIC. *
005330200529     F*  120254 - Value date missing from Account Movement Screen.    *
005340200529     F*         - ( Applied Fix 100086 )                              *
005350200529     F*  S01408 - Missing core hooks in Midas DBAR2                   *
005360200529     F*           Addition of core hook RE3664C004                    *
005370200529     F*           Addition of core hook RE3664C005                    *
005380200529     F*           Addition of core hook RE3664C006                    *
005390200529     F*           Addition of core hook RE3664C007                    *
005400200529     F*           Addition of core hook RE3664C008                    *
005410200529     F*           Addition of core hook RE3664C009                    *
005420200529     F*  122952 - Database error 41 in REHISBC, key *NRF, caused by   *
005430200529     F*           program changing Added Today Indicator from 'C' to  *
005440200529     F*           'Y' in the middle of the program, so the record is  *
005450200529     F*           excluded when the logical file is accessed later.   *
005460200529     F*           Fix is not to update the ADTY flag if the REHISPD   *
005470200529     F*           'B' record is updated other than at the end of the  *
005480200529     F*           program.                                            *
005490200529     F*         - Changes to REHISBC not rolled back if an error      *
005500200529     F*           occurs - add a KCOMIT line for this file.           *
005510200529     F*         - Make DB Error output more meaningful for error 41   *
005520200529     F*  105084 - Incomplete posting description in Daily Journal.    *
005530200529     F*  106604 - Withholding tax posting has not the same value date *
005540200529     F*           as interest posting still.                          *
005550200529     F*  CRE002 - Post Retail Accrual to Interim Accounts.            *
005560200529     F*           To initialise values of the Additional Overdraft    *
005570200529     F*           Interest Rate, Overdraft Line, Overdraft Line       *
005580200529     F*           Change Indicator, and the Overdraft Interest Amount *
005590200529     F*           on Retail History files.                            *
005600200529     F*  101656 - Withholding Tax code is never executed because      *
005610200529     F*           field BCICI is cleared before SR/TOTTAX. Also,      *
005620200529     F*           REACRD should be updated AFTER the withholding      *
005630200529     F*           tax routine.                                        *
005640200529     F*  CCB003 - COB Performance Enhancements - Task Split           *
005650200529     F*  111921 - Zero Value date for suspense postings.              *
005660200529     F*  S01408 - Addition of core hook RE3664CP36                    *
005670200529     F*           Addition of core hook RE3664CP35                    *
005680200529     F*           Addition of core hook RE3664CP34                    *
005690200529     F*           Addition of core hook RE3664CP33                    *
005700200529     F*           Addition of core hook RE3664CP32                    *
005710200529     F*           Addition of core hook RE3664CP31                    *
005720200529     F*           Addition of core hook RE3664CP30                    *
005730200529     F*           Addition of core hook RE3664CP29                    *
005740200529     F*           Addition of core hook RE3664CP28                    *
005750200529     F*           Addition of core hook RE3664CP27                    *
005760200529     F*  CAC001 - Profit Centre Accounting Development:               *
005770200529     F*           The profit centre of postings with certain account  *
005780200529     F*           types should be assigned as follows:                *
005790200529     F*           Interbranch Posting - profit centre from PCA ICD    *
005800200529     F*           Suspense Posting - primary funding profit centre    *
005810200529     F*           Retail or Nostro alternate a/c - profit centre of   *
005820200529     F*             the account                                       *
005830200529     F*           Other - profit centre of the generating a/c.        *
005840200529     F*  106213 - Error exists in program because *IN40 is never      *
005850200529     F*           reset if TXWTRR *EQ 0, causing DBError 003.         *
005860200529     F*           Fix resets *IN40 to 0 before conditional chain      *
005870200529     F*           to ACCNTBXC.                                        *
005880200529     F*  100086 - Value date is 0 for postings, due to incorrect fix  *
005890200529     F*           082592 - fix is to move RUND to VALD, but only if   *
005900200529     F*           VALD is 0.                                          *
005910200529     F*  101847 - Multiply/divide indicatore are inverted - the M/D   *
005920200529     F*           indicator of the 'From' currency has to be moved to *
005930200529     F*           the cross-rate M/D indicator before calling ZCONV.  *
005940200529     F*  098818 - Allow for interest capital indicator on RSHISPS     *
005950200529     F*           to retain its original values of 'C' 'D' 'Y' &      *
005960200529     F*           ' ' to be used by input cycle enquiries.            *
005970200529     F*  094681 - Ensure that 'CLOS.INT.' posting narrative is only   *
005980200529     F*           used for closing interest and not for interest      *
005990200529     F*           adjustment applied at closure capitalisation.       *
006000200529     F*  093582 - Withholding tax posting has not the same value date *
006010200529     F*           as interest posting because SR WVALD is called      *
006020200529     F*           before these postings are created but the SR        *
006030200529     F*           changes the value date. Remove WVALD since 060828   *
006040200529     F*           determines value date.                              *
006050200529     F*  092564 - NDID and NCID can fall behind on daily accruals.    *
006060200529     F*           Always use local currency for check for next        *
006070200529     F*           working day.                                        *
006080200529     F*  091906 - Withholding tax minimum threshold is incorrect,     *
006090200529     F*           Use correct work field WKMISU not WMISU.            *
006100200529     F*  091896 - Postings for withholding tax do not get created     *
006110200529     F*           in COB since BDICI and BCICI is initialised after   *
006120200529     F*           TOTTAX. Initialise fields after this SR.            *
006130200529     F*  S01408 - Addition of core hook RE3664CP26                    *
006140200529     F*           Addition of core hook RE3664CP25                    *
006150200529     F*           Addition of core hook RE3664CP24                    *
006160200529     F*           Addition of core hook RE3664CP23                    *
006170200529     F*           Addition of core hook RE3664CP22                    *
006180200529     F*           Addition of core hook RE3664CP21                    *
006190200529     F*           Addition of core hook RE3664CP20                    *
006200200529     F*           Addition of core hook RE3664CP19                    *
006210200529     F*           Addition of core hook RE3664CP18                    *
006220200529     F*  S01408 - Rename duplicate hook RE3664CCP4 to RE3664CP17      *
006230200529     F*  095656 - Ensure ZZ001 blank before chain to RECRG            *
006240200529     F*  S01408 - Addition of core hook RE3664CP12                    *
006250200529     F*           Addition of core hook RE3664CP13                    *
006260200529     F*           Addition of core hook RE3664CP14                    *
006270200529     F*           Addition of core hook RE3664CP15                    *
006280200529     F*           Addition of core hook RE3664CP16                    *
006290200529     F*  085762 - If no records on file, P1 report was being produced *
006300200529     F*           for branch 000 with no details on it - amended pgm  *
006310200529     F*           to not produce this report.                         *
006320200529     F*  088181 - A) I/O operation on closed RE3664P1 file in INITPR  *
006330200529     F*              and FIRST SRs.                                   *
006340200529     F*              Removed WRITE to P1 file as adequate info is     *
006350200529     F*              supplied in RE3664AU by the *PSSR routine.       *
006360200529     F*           B) Error was incorrect anyway because ACOD may be   *
006370200529     F*              blank for base ccy Trade Equivalent a/c.         *
006380200529     F*              Suppress read of SDACODPD if WBTACC is blank.    *
006390200529     F*           C) Change test of Sterling ccy A/C code to look for *
006400200529     F*              blanks rather than '0000' for not entered.       *
006410200529     F*  086125 - Add new parameter to AOPNARR0                       *
006420200529     F*  S01522 - Call to AOPNARR0 if switchable feature installed    *
006430200529     F*           and UDC present                                     *
006440200529     F*  081545 - Page is a preerved word and should not be           *
006450200529     F*           accumulated in the program. Also initialise *IN85   *
006460200529     F*           to zero or the first page produced is blank.        *
006470200529     F*  088273 - A/C closure generated entry has blank narrative.    *
006480200529     F*           Affects 087513 and 084082.                          *
006490200529     F*  092064 - The wrong interest amount is being output to BRT    *
006500200529     F*           hisory if the category is 'N'. This is because      *
006510200529     F*           the work field PACR1 is not being set up correctly. *
006520200529     F*  089741 - Ensure that BRT processing is performed when an     *
006530200529     F*           account is closed.                                  *
006540200529     F*  087513 - Interest is capitalised twice, if closure           *
006550200529     F*           requested on day after normal capitalisation.       *
006560200529     F*           This is fixed within RE3662. However, narrative for *
006570200529     F*           this posting was also wrong. It was set to          *
006580200529     F*           'ACCR.A/C.' when this should have been 'INT.CAP.'.  *
006590200529     F*  087842 - BRT history records are being output with wrong     *
006600200529     F*           account details.                                    *
006610200529     F*  084082 - Posting narrative is defaulting to 'CLOSURE' for    *
006620200529     F*           BRT postings - amend to default to 'BRT INTEREST'   *
006630200529     F*  085787 - Inconsistent page numbers, last posting date,       *
006640200529     F*           eroneous reporting of posted field.                 *
006650200529     F*         - Print details of accounts which have capitalised    *
006660200529     F*           today but have accrued zero interest, to avoid      *
006670200529     F*           blank reports for a branch being produced.          *
006680200529     F*         - Do not print anything in posted today field if      *
006690200529     F*           zero interest calculated.                           *
006700200529     F*         - If no details to print in any branch, say so        *
006710200529     F*         - Overprinting is occuring in posted today field      *
006720200529     F*           on RE3364P1 report, due to an error in fix 075073   *
006730200529     F*         - Add JOB NAME text to the report header to indicate  *
006740200529     F*           from which run of the RE3664 this report is produced*
006750200529     F*  082592 - Dates being wrongly overwritten.                    *
006760200529     F*  S01408 - Addition of core hook RE3664FFPG                    *
006770200529     F*           Addition of core hook RE3664IIPG                    *
006780200529     F*           Addition of core hook RE3664CCPG                    *
006790200529     F*           Addition of core hook RE3664CCP1                    *
006800200529     F*           Addition of core hook RE3664CCP2                    *
006810200529     F*           Addition of core hook RE3664CCP3                    *
006820200529     F*           Addition of core hook RE3664CCP4                    *
006830200529     F*           Addition of core hook RE3664CCP5                    *
006840200529     F*           Addition of core hook RE3664CCP6                    *
006850200529     F*           Addition of core hook RE3664CCP7                    *
006860200529     F*           Addition of core hook RE3664CCP8                    *
006870200529     F*           Addition of core hook RE3664CCP9                    *
006880200529     F*           Addition of core hook RE3664CP10                    *
006890200529     F*           Addition of core hook RE3664CP11                    *
006900200529     F*  076557 - IF REHIS IS BLANK THEN NO BRANCH CODE IS REPORTED   *
006910200529     F*  084054 - WHEN CONVERTING TO STG OR NOT USES WRONG CURRENCY   *
006920200529     F*  080978 - SET UP CORRECT A/C REFERENCE ON BRT FILES AS PICKS  *
006930200529     F*           WRONG REFERENCE AND SOMETIMES BLANK                 *
006940200529     F*         - ALSO USE CUST NO OF A/C CAUSING GEN ENTRY AS        *
006950200529     F*           ASSOCIATED CUSTOMER                                 *
006960200529     F*  075073 - Overflow not working for RE3664P1.                  *
006970200529     F*           *IN90 is also used by /COPY Z* routines.            *
006980200529     F*         - False YES into posting today field if standard      *
006990200529     F*           defaults fail. Program also recompiled as           *
007000200529     F*           printer file RE3664P1 changed
007010200529     F*  074598 - Accrual narrative on capitalisation via RE3664      *
007020200529     F*           to have same layout as accruals via RE3666.         *
007030200529     F*  071428 - Incorrect narratives being set-up within BRT        *
007040200529     F*  071427 - Exchange conversion to STG for BRT wrong            *
007050200529     F*  071053 - Capitalisations due today are not actioned when the *
007060200529     F*           branch code of the account is alphanumeric as the   *
007070200529     F*           file pointer is set to the wrong position in file.  *
007080200529     F*  069558 - Array index error in routine ZFRQA when this is     *
007090200529     F*           called for accounts capitalising with Freq = 'Z'.   *
007100200529     F*  057048 - Problem with account closure if first day accrual   *
007110200529     F*  060828 - Value date of withholding tax posting must be       *
007120200529     F*           the same as interest posting value date             *
007130200529     F*  048430 - Discrepancies with withholding taxe the day the     *
007140200529     F*           account capitalise in credit                        *
007150200529     F*  B8200  - Correct the narrative for Withholding Tax           *
007160200529     F*  LN0106 - To add one day to VALD/HISD if LDAC not equal 'Y'   *
007170200529     F*  049320 - Incorrect Combination of Branch Internal Customer   *
007180200529     F*           and Branch Code Output to GEICPD.                   *
007190200529     F*  052739 - Ensure Last Change Date is Updated on REACRD.       *
007200200529     F*  S01413 - Retail 3 Incorporation                              *
007210200529     F*  BRTSAR - BRT apply only in this period interest credit and   *
007220200529     F*           not an adjustment                                   *
007230200529     F*                                                               *
007240200529     F*****************************************************************
007250200529     F/COPY WNCPYSRC,RE3664F001
007260200529     FACCNTX  UF  E           K        DISK
007270200529     F                                              KCOMIT
007280200529     F            ACCNTABF                          KRENAMEACCNTXF
007290200529     F            ACCNTAAF                          KIGNORE
007300200529     F            ACCNTACF                          KIGNORE
007310200529     F                                              KINFDS ACXDS
007320200529     F                                              KINFSR ACXSR
007330200529     FSDBRTDL1IF  E           K        DISK
007340200529     FSDCBRTL1IF  E           K        DISK
007350200529     FSDFRCTL0IF  E           K        DISK                               CRE007
007360200529      *                                                                                       CGL031
007370200529     F***SDCSINL7IF  E        K        DISK                                            CGL031 232543
007380200529     F**********                                    KINFSR *PSSR                       CGL031 232543
007390200529      ***Midas*SD Customer Income by Account Number                                    CGL031 232543
007400200529      **********                                                                       CGL031 232543
007410200529     FSDCSINL7IF  E           K        DISK         KINFSR *PSSR                              232543
007420200529     F            SDCSIND0                          KRENAMESDCSIND7                           232543
007430200529      ** Midas SD Customer Income - Customer Number Retrieve Index                            232543
007440200529      *                                                                                       232543
007450200529     FSDCSINLCIF  E           K        DISK         KINFSR *PSSR                              232543
007460200529     F            SDCSIND0                          KRENAMESDCSINDC                           232543
007470200529      ** Midas SD Customer Income - Joint A/c Number Retrieve Index                           232543
007480200529      *                                                                                       232543
007490200529     FSDJACCL1IF  E           K        DISK         KINFSR *PSSR                              232543
007500200529      ** Midas SD Joint A/c Member Details - Retrieve Index                                   232543
007510200529      *                                                                                       232543
007520200529     FREHISBC UF  E           K        DISK
007530200529     F                                              KCOMIT                122952
007540200529     F**********  REHISPPF                          KRENAMEREHISBP1                  CCB003 CRE083BE
007550200529     F***REINTCPDUF  E                    DISK                                       CCB003 CRE083BE
007560200529     FREINTCPDUF  E           K        DISK                           UC                    CRE083BE
007570200529     F            REINTCD0                          KRENAMEREHISBP1                         CRE083BE
007580200529     F                                              KCOMIT
007590200529     F                                              KINFDS RECDS
007600200529     F                                              KINFSR RECSR
007610200529     FREHISBL UF  E           K        DISK
007620200529     F                                              KCOMIT
007630200529     F            REHISPPF                          KRENAMEREHISPBF
007640200529     F                                              KINFDS REBDS
007650200529     F                                              KINFSR REBSR
007660200529     FREHISL  UF  E           K        DISK                      A
007670200529     F                                              KCOMIT
007680200529     F            REHISPPF                          KRENAMEREHISPDF
007690200529     F            REHISPSF                          KIGNORE
007700200529     F                                              KINFDS RELDS
007710200529     F                                              KINFSR RELSR
007720200529     FREHISSL UF  E           K        DISK
007730200529     F                                              KCOMIT
007740200529     F                                              KINFDS RESDS
007750200529     F                                              KINFSR RESSR
007760200529     FRELINKL1IF  E           K        DISK
007770200529     F/COPY WNCPYSRC,REH00167
007780200529     FACCRACJ IF  E           K        DISK
007790200529     FRECRG   IF  E           K        DISK
007800200529     F            RECRGAF                           KIGNORE
007810200529     F            RECRGZF                           KIGNORE
007820200529     FACNUM   IF  E           K        DISK
007830200529     F            ACCNTABF                          KRENAMEACNUMABF
007840200529     FREACNML0IF  E           K        DISK                               CAC001
007850200529     FACCNT   UF  E           K        DISK
007860200529     F                                              KCOMIT
007870200529     F            ACCNTAAF                          KIGNORE
007880200529     F            ACCNTACF                          KIGNORE
007890200529     F                                              KINFDS ACCDS
007900200529     F                                              KINFSR ACCSR
007910200529     FREACR   UF  E           K        DISK
007920200529     F                                              KCOMIT
007930200529     F            REACRAF                           KIGNORE
007940200529     F            REACRZF                           KIGNORE
007950200529     F                                              KINFDS ACRDS
007960200529     F                                              KINFSR ACRSR
007970200529     FRETRG   IF  E           K        DISK                                                   250998
007980200529     F            RETRGAF                           KIGNORE                                   250998
007990200529     F            RETRGZF                           KIGNORE                                   250998
008000200529     FREIAC   UF  E           K        DISK
008010200529     F                                              KCOMIT
008020200529     F            REIACAF                           KIGNORE
008030200529     F            REIACZF                           KIGNORE
008040200529     F                                              KINFDS IACDS
008050200529     F                                              KINFSR IACSR
008060200529     F*GEICZZ**UF**E                    DISK                      A    UC CCB003
008070200529     FREINTCPAUF  E                    DISK                      A    UC  CCB003
008080200529     F                                              KCOMIT
008090200529     FSDSTAXPDIF  E                    DISK                           UC
008100200529      *                                                                                       CDL013
008110200529     FSDSTAAL1IF  E           K        DISK                           UC                      CDL013
008120200529      ** WHT ICD extension file                                                               CDL013
008130200529      *                                                                                       CDL013
008140200529     FGLWHTCL0UF  E           K        DISK                      A    UC                      CDL013
008150200529      ** WHT Customer History file                                                            CDL013
008160200529      *                                                                                       CDL013
008170200529     FGLXTAXL0O   E                    DISK                      A    UC                      CDL013
008180200529      ** Retail WHT Extract file                                                              CDL013
008190200529      *                                                                                       CDL013
008200200529     FACCNTBY0IF  E           K        DISK                           UC                      CDL013
008210200529     F            ACCNTBD0                          KRENAMEACCNTYD0                           CDL013
008220200529      ** Account Details Extension file                                                       CDL013
008230200529      *                                                                                       CDL013
008240200529     FSDACOAL0IF  E           K        DISK                           UC                      CDL013
008250200529      ** Account Code Extension file                                                          CDL013
008260200529     FACCNTBXCIF  E           K        DISK
008270200529     FREGAHLJ2IF  E           K        DISK                           UC  CRE008
008280200529     FREZSHLJ2IF  E           K        DISK                           UC  CRE008
008290200529     FRECIEUL2IF  E           K        DISK                           UC  CRE008
008300200529     FREHPOSPPO   E           K        DISK
008310200529     F                                              KCOMIT
008320200529     F                                              KINFDS REPDS
008330200529     F                                              KINFSR REPSR
008340200529     F***GEICPD* O   E           K        DISK                                                CGL020
008350200529     FGEICPD  UF  E           K        DISK                      A                            CGL020
008360200529     F                                              KCOMIT
008370200529     F                                              KINFDS GEIDS
008380200529     F                                              KINFSR GEISR
008390200529     FINTPSDD O   E                    DISK                      A
008400200529     F                                              KCOMIT                CCB003
008410200529     FCOINTDD O   E                    DISK
008420200529     F                                              KCOMIT                CCB003
008430200529      *                                                                   CPB001
008440200529      **  End of Day interests for Private Banking Customers.             CPB001
008450200529     FRPEODIPDO   E                    DISK                               CPB001
008460200529      *                                                                   CPB001
008470200529     FREINCXPDUF  E                    DISK         KCOMIT       A        CCB003
008480200529      *                                                                   CCB003
008490200529     F*RE3664AUO***E                    PRINTER      KINFDS SPOOLU        CCB003
008500200529     FRE3664AUO   E                    PRINTER      KINFDS SPOOLU     UC  CCB003
008510200529      *                                                                   CCB003
008520200529     F*RE3664P1O***E*******     90     PRINTER       KINFDS SPOOL      UC 075073
008530200529     F*RE3664P1O***E            85     PRINTER       KINFDS SPOOL UC07507 CCB003
008540200529      *                                                                                     BUG23347
008550200529      ** Midas SD Interest Payment History File                                             BUG23347
008560200529     FSDINPHL2UF  E           K        DISK                                                 BUG23347
008570200529     F                                              KCOMIT                                  BUG23347
008580200529      *                                                                                     BUG23347
008590200529      ** Midas SD Customer Income File                                                      BUG24114
008600200529     FSDCSINLJUF  E           K        DISK         KINFSR *PSSR                            BUG24114
008610200529     F            SDCSIND0                          KRENAMESDCSINDJ                         BUG24114
008620200529      *                                                                                     BUG24114
008630200529     FSDBRCHL1IF  E                    DISK                                                 CRE083BK
008640200529     F**********SDCURRL1IF  E                    DISK                                 CRE083BKCGL165
008650200529     FSDCURRL1IF  E                    DISK                           UC                      CGL165
008660200529     FSDNARRL1IF  E                    DISK                                                 CRE083BK
008670200529     FSDWTRCL0IF  E           K        DISK                                                   CGL165
008680200529     F*
008690200529     F*                                                                   S01408
008700200529     F/COPY WNCPYSRC,RE3664FFPG                                           S01408
008710200529     F*                                                                   S01408
008720200529     F*****************************************************************
008730200529     F**          FUNCTION OF INDICATORS                              *
008740200529     F*                                                               *
008750200529     F*       26      OUTPUT CREDIT POSTING & BRT POSTING TO GEICCPD  *
008760200529     F*       27      - OUTPUT CREDIT BASE CCY EQUIV. A/C - STERLING  *
008770200529     F*               - OUTPUT DEBIT BASE CCY EQUIV. A/C - CURRENCY   *
008780200529     F*               - OUTPUT DEBIT CCY WITHHOLDING TAX A/C          *
008790200529     F*               - OUTPUT CREDIT CCY SPOT POSITION A/C.          *
008800200529     F*               - OUTPUT CREDIT STERLING WITHHOLDING TAX A/C    *
008810200529     F*               - OUTPUT DEBIT STERLING SPOT POSITION A/C       *
008820200529     F*       29      NO BASE CCY EQUIV A/C CODE FOR STERLING         *
008830200529     F*       30      CAPITALISATION IS ON DEMAND OR FOR MANGT. STATMT*
008840200529     F********35******DR*INT.*CAPITAL'N*TYPE*&*SUBTYPE*IS*ZERO        *   CCB003
008850200529     F********36******CR*INT.*CAPITAL'N*TYPE*&*SUBTYPE*IS*ZERO        *   CCB003
008860200529      *       37      Indicator for dummy read of REINCXPD            *   CCB003
008870200529      *       38      CHAIN indicator for REHISBC                     *   CCB003
008880200529     F*       40      ACCESS SUCCED ON FILE                           *
008890200529     F*       41      NO DETAILS TO REPORT                            *
008900200529     F********43******DETAILS*WRITTEN*TO*PRINTER*FILE                 *   CCB003
008910200529     F*       50      SECONDARY ACCOUNT                               *
008920200529     F********53******RETAIL*A/C*NUMBER*REQUIRED                      *   CCB003
008930200529     F*       60      RECORD FOUND ON REHISSL FILE                    *
008940200529     F*****61*->*75***POSTED*INDICATORS*ON*RE3664PR                   *   CCB003
008950200529     F*       79      MULTIBRANCHING INDICATOR                        *
008960200529     F*       80      DECIMAL POSITION IS 0                           *
008970200529     F*       81      DECIMAL POSITION IS 1                           *
008980200529     F*       82      DECIMAL POSITION IS 2                           *
008990200529     F*       83      DECIMAL POSITION IS 3                           *
009000200529     F********85******OVERFLOW*INDICATOR*ON*RE3664P1                075073CCB003
009010200529     F********87******WRITE*'END*OF*BRANCH...'*TEXT                   *   CCB003
009020200529     F*       88      SHOW STATUS ON DB ERROR REPORT                  *
009030200529     F********90      OVERFLOW INDICATOR ON RE3664PR                  *   075073
009040200529     F*    90 -> 99   USED BY /COPY SUBROUTINES                       *   075073
009050200529     F*       92      CHECK LEAP YEAR                                 *
009060200529     F*       98      DATE FORMAT IS 'M'                              *
009070200529     F*       99      ACCESS SUCCED ON FILE                           *
009080200529     F*                                                               *
009090200529     F*       LR      END OF PROGRAM                                  *
009100200529     F*                                                               *
009110200529     F*       U7      DATABASE ERROR                                  *
009120200529     F*       U8      DATABASE ERROR                                  *
009130200529     F*                                                               *
009140200529     F*****************************************************************
009150200529     F**          SUBROUTINES INDEX                                   *
009160200529     F*                                                               *
009170200529     F*   ACCPR  - Account processing                                 *
009180200529     F*   ACCSR  - Accnt file exception/error handling                *
009190200529     F*   ACRSR  - Reacr file exception/error handling                *
009200200529     F*   ALTPR  - Alternate processing                               *
009210200529     F*   CHGPR  - Charges processing                                 *
009220200529     F*   CREPR  - Credit processing                                  *
009230200529     F*   *PSSR  - Database error handling                            *
009240200529     F*   DCIND  - Checking debit/credit indicator processing         *
009250200529     F*   DEBPR  - Debit processing                                   *
009260200529     F*   FIRST  - First cycle                                        *
009270200529     F*   GEICPR - Geicpd file processing                             *
009280200529     F*   GEISR  - Geicpd file exception/error handling               *
009290200529     F*   IACSR  - Reiac file exception/error handling                *
009300200529     F*   INITPR - Work fields init processing                        *
009310200529     F*   MAIN   - Main processing                                    *
009320200529     F*   MTHEND - Establish if end of month falls between accrual    *
009330200529     F*            date and following working day                     *
009340200529     F****OVERSR*-*Processing*when*overflow*on*RE3664PR               *   CCB003
009350200529     F*   PLPR   - Profit and loss processing                         *
009360200529     F*   POSPR  - Update position records for alternate account      *
009370200529     F*            Processing                                         *
009380200529     F*   PRCHG  - Output of charges on RE3664PR                      *
009390200529     F*   PRCR   - Output of credit on RE3664PR                       *
009400200529     F*   PRDR   - Output of debit on RE3664PR                        *
009410200529     F*   REBSR  - Rehisbl file exception/error handling              *
009420200529     F****RECSR**-*Rehisbc*file*exception/error*handling              *   CCB003
009430200529     F*   RECSR  - Reintcpd file exception/error handling             *   CCB003
009440200529     F*   RELSR  - Rehisl file exception/error handling               *
009450200529     F*   REPSR  - Rehpospp file exception/error handling             *
009460200529     F*   RESSR  - Rehissl file exception/error handling              *
009470200529     F*   SETPR  - Setup accnt work fields processing                 *
009480200529     F*   SSETUP - Setup capitalisation record processing             *
009490200529     F*   SUSPR  - Suspense processing                                *
009500200529     F*   TOTAC  - Total account processing                           *
009510200529     F*   SRMOV  - Copy data from REINTCPD to REHISBC                 *   CCB003
009520200529     F*   TOTAL  - TRAILER PROCESSING                                 *
009530200529     F*   WVALD  - To add one day to VALD/HISD if LDAC not equal 'Y'  *   LN0106
009540200529     F*   ZDATE2 - To convert day number to date format               *
009550200529     F*   ZFDATE - Reformat date and ensure valid                     *
009560200529     F*   ZFRQA  - Increment a day number date by a period value      *
009570200529     F*   SRPNAR - Determine the posting narrative                    *   S01522
009580200529     F*****************************************************************
009590200529     F/EJECT
009600200529      *****************************************************************   CCB003
009610200529     E*
009620200529     E/COPY ZSRSRC,ZDATE2Z1
009630200529     E/COPY ZSRSRC,ZHOLE
009640200529     E*
009650200529     E                    ZA1        16  1               ZEDIT ARRAY
009660200529     E                    ZA2        16  1               ZEDIT ARRAY
009670200529     E                    CPY@    1   1 80
009680200529     E                    ABRC      900  3                                                  CRE083BK
009690200529     E                    ACUR      250  3                                                  CRE083BK
009700200529     E                    ANAR      300  2                                                  CRE083BK
009710200529     E                    ARET      250 12                                                  CRE083BK
009720200529     E                    CDAC      300 10 0                                                CRE083BK
009730200529      *                                                                                     CRE083BK
009740200529      ** Least recently used array and sorted LRU array                                     CRE083BK
009750200529      *                                                                                     CRE083BK
009760200529     E                    LRUA      300 13 0                                                CRE083BK
009770200529     E                    LRUS      300 13 0                                                CRE083BK
009780200529     E/COPY WNCPYSRC,RE3664E002
009790200529     E********************NAR        10 12                                B8200
009800200529     E********************DNAR       10 12                                B8200
009810200529     E********************NAR        10 30                           B8200057048
009820200529     E********************NAR        11 30                         057048 135401
009830200529     E**********          NAR        12 30                         135401 135809
009840200529     E********************NR16       10 16                                057048
009850200529     E********************DN07       10  7                                057048
009860200529     E********************NR16       11 16                         057048 135401
009870200529     E**********          NR16       12 16                         135401 135809
009880200529     E**********          DN07       11  7                         057048 135809
009890200529     E********************MGD        11  7                         S01522 135401
009900200529     E**********          MGD        12  7                         135401 135809
009910200529     E**********          NAR        13 30                                             135809 234438
009920200529     E**********          NR16       13 16                                             135809 234438
009930200529     E**********          DN07       13  7                                             135809 CGL029
009940200529     E**********          DN07       13  6                                             CGL029 234438
009950200529     E/COPY WNCPYSRC,RE3664E004
009960200529     E**********          MGD        13  7                                             135809 234438
009970200529     E                    NAR        14 30                                                    234438
009980200529     E                    NR16       14 16                                                    234438
009990200529     E                    DN07       14  6                                                    234438
010000200529     E                    MGD        14  7                                                    234438
010010200529     E/COPY WNCPYSRC,RE3664E003
010020200529     E                    ZFMD   12  12  2
010030200529     E                    POWER   1   7  7 3             POWER ARRAY
010040200529      *                                                                   085787
010050200529      ** Translate the JOB Name to Job Title                              085787
010060200529     E                    TAB1    1   2 10   TABA   14   ALT A/C title    085787
010070200529     E                    EUTXN2  1   1 30                                                  AR318139
010080200529     E/COPY WNCPYSRC,RE3664E001
010090200529      *                                                                                       CRE100
010100200529      ** System Values Array Definition                                                       CRE100
010110200529     E**********          SVAL    1   2 20                                           CRE100 MD034990
010120200529     E**********          SVAL    1   3 20                                         MD034990 MD045460
010130200529     E                    SVAL    1   4 20                                                  MD045460
010140200529      *****************************************************************   CCB003
010150200529     E/EJECT
010160200529      *****************************************************************   CCB003
010170200529     IACCNTXF
010180200529     I*
010190200529     I** RENAME ACCNTXF FORMAT FIELD
010200200529     I*
010210200529     I              RECI                            #RECI
010220200529     I              CNUM                            #CNUM
010230200529     I              CCY                             #CCY
010240200529     I              ACOD                            #ACOD
010250200529     I              ACSQ                            #ACSQ
010260200529     I              LTAB                            #LTAB
010270200529     I              LTAS                            #LTAS
010280200529     I              BRCA                            #BRCA
010290200529     I              ATYP                            #ATYP
010300200529     I              STYP                            #STYP
010310200529     I              MFFQ                            #MFFQ
010320200529     I              ACST                            #ACST
010330200529     I              DACO                            #DACO
010340200529     I              DACC                            #DACC
010350200529     I              ANAM                            #ANAM
010360200529     I              LDBL                            #LDBL
010370200529     I              CLBL                            #CLBL
010380200529     I              STFQ                            #STFQ
010390200529     I              STDY                            #STDY
010400200529     I              LSTD                            #LSTD
010410200529     I              NSTD                            #NSTD
010420200529     I              LSTP                            #LSTP
010430200529     I              CFSB                            #CFSB
010440200529     I              LMVD                            #LMVD
010450200529     I              EPLB                            #EPLB
010460200529     I              EPCB                            #EPCB
010470200529     I              YTDB                            #YTDB
010480200529     I              GLBT                            #GLBT
010490200529     I              ADREF1                          #ADRE1
010500200529     I              PRFC                            #PRFC
010510200529     I              LTAC                            #LTAC
010520200529     I              ORED                            #ORED
010530200529     I              DLIM                            #DLIM
010540200529     I              LRCR                            #LRCR
010550200529     I              RTCB                            #RTCB
010560200529     I              RTLB                            #RTLB
010570200529     I              DITM                            #DITM
010580200529     I              CITM                            #CITM
010590200529     I              ADREF2                          #ADRE2
010600200529     I              CDIR                            #CDIR
010610200529     I              CCIR                            #CCIR
010620200529     I              ACNO                            #ACNO
010630200529     I              RETB                            #RETB
010640200529     I              ODSC                            #ODSC
010650200529     I              ODLN                            #ODLN
010660200529     I              ODED                            #ODED
010670200529     I              DIOD                            #DIOD
010680200529     I              FACT                            #FACT
010690200529     I              FCNO                            #FCNO
010700200529     I              EFAC                            #EFAC
010710200529     I              HELD                            #HELD
010720200529     I              MINB                            #MINB
010730200529     I              LACD                            #LACD
010740200529     I              LISP                            #LISP
010750200529     I              RRNM                            #RRNM
010760200529     I              DRIB                            #DRIB
010770200529     I              DRIS                            #DRIS
010780200529     I              DRCD                            #DRCD
010790200529     I              DRIC                            #DRIC
010800200529     I              DRIF                            #DRIF
010810200529     I              DRDY                            #DRDY
010820200529     I              NDID                            #NDID
010830200529     I              LDID                            #LDID
010840200529     I              LDIA                            #LDIA
010850200529     I              SDAP                            #SDAP
010860200529     I              LPAR                            #LPAR
010870200529     I              DIIE                            #DIIE
010880200529     I              DAIC                            #DAIC
010890200529     I              MADI                            #MADI
010900200529     I              GADI                            #GADI
010910200529     I              DDIS                            #DDIS
010920200529     I              DDIA                            #DDIA
010930200529     I              OLDR                            #OLDR
010940200529     I              OLDB                            #OLDB
010950200529     I              OLDS                            #OLDS
010960200529     I              CRIB                            #CRIB
010970200529     I              CRIS                            #CRIS
010980200529     I              CRCD                            #CRCD
010990200529     I              CRIC                            #CRIC
011000200529     I              CRIF                            #CRIF
011010200529     I              CRDY                            #CRDY
011020200529     I              NCID                            #NCID
011030200529     I              LCID                            #LCID
011040200529     I              LCIA                            #LCIA
011050200529     I              SCAP                            #SCAP
011060200529     I              LPAP                            #LPAP
011070200529     I              CIIE                            #CIIE
011080200529     I              CAIC                            #CAIC
011090200529     I              MACI                            #MACI
011100200529     I              GACI                            #GACI
011110200529     I              CDIS                            #CDIS
011120200529     I              DCIA                            #DCIA
011130200529     I              OLCR                            #OLCR
011140200529     I              OLCB                            #OLCB
011150200529     I              OLCS                            #OLCS
011160200529     I              LCD                             #LCD
011170200529     I              CHTP                            #CHTP
011180200529     I              TNLU                            #TNLU
011190200529     I              ENOC                            #ENOC
011200200529     I              EPNO                            #EPNO
011210200529     I              ECFB                            #ECFB
011220200529      *                                                                   CCB003
011230200529     I***RETRGDF                                                                     250998 CRE083BK
011240200529      ****************************************************************               250998 CRE083BK
011250200529      ***Rename*RECI*field*in*RETRGDF*format**-*RETRG*file************               250998 CRE083BK
011260200529     I**********    RECI                            RECID                            250998 CRE083BK
011270200529     I**********    REBI                            REBID                            250998 CRE083BK
011280200529     IRETRGDF                                                                               MD021155
011290200529      *                                                                                     MD021155
011300200529      ** Rename RECI field in* ETRGDF format  - RETRG file                                  MD021155
011310200529     I              RECI                            RECID                                   MD021155
011320200529     I              REBI                            REBID                                   MD021155
011330200529      *                                                                                       250998
011340200529      ** RENAME REHISBC FORMAT FIELD                                      CCB003
011350200529     IREHISBP1                                                            CCB003
011360200529     I**********    RECI                            NRECI                            CCB003 CRE083BE
011370200529     I              RECID                           NRECID                                  CRE083BE
011380200529     I              BRCA                            NBRCA                 CCB003
011390200529     I              CNUM                            NCNUM                 CCB003
011400200529     I              CCY                             NCCY                  CCB003
011410200529     I              ACOD                            NACOD                 CCB003
011420200529     I              ACSQ                            NACSQ                 CCB003
011430200529     I**********    HISD                            NHISD                            CCB003 CRE083BE
011440200529     I**********    HISB                            NHISB                            CCB003 CRE083BE
011450200529     I**********    MNBL                            NMNBL                            CCB003 CRE083BE
011460200529     I**********    CHGAR                           NCHGAR                           CCB003 CRE083BE
011470200529     I**********    TCHGAR                          NTHGAR                           CCB003 CRE083BE
011480200529     I**********    CHGAN                           NCHGAN                           CCB003 CRE083BE
011490200529     I**********    TCHGAN                          NTHGAN                           CCB003 CRE083BE
011500200529     I**********    DMVT                            NDMVT                            CCB003 CRE083BE
011510200529     I**********    DICT                            NDICT                            CCB003 CRE083BE
011520200529     I**********    DRCB                            NDRCB                            CCB003 CRE083BE
011530200529     I**********    DRIR                            NDRIR                            CCB003 CRE083BE
011540200529     I**********    DRCD                            NDRCD                            CCB003 CRE083BE
011550200529     I**********    DAID                            NDAID                            CCB003 CRE083BE
011560200529     I**********    MADI                            NMADI                            CCB003 CRE083BE
011570200529     I**********    TMADI                           NTMADI                           CCB003 CRE083BE
011580200529     I**********    PDID                            NPDID                            CCB003 CRE083BE
011590200529     I**********    DMINT                           NDMINT                           CCB003 CRE083BE
011600200529     I**********    CMVT                            NCMVT                            CCB003 CRE083BE
011610200529     I**********    CICT                            NCICT                            CCB003 CRE083BE
011620200529     I**********    CRCB                            NCRCB                            CCB003 CRE083BE
011630200529     I**********    CRIR                            NCRIR                            CCB003 CRE083BE
011640200529     I**********    CRCD                            NCRCD                            CCB003 CRE083BE
011650200529     I**********    CAID                            NCAID                            CCB003 CRE083BE
011660200529     I**********    MACI                            NMACI                            CCB003 CRE083BE
011670200529     I**********    TMACI                           NTMACI                           CCB003 CRE083BE
011680200529     I**********    PCID                            NPCID                            CCB003 CRE083BE
011690200529     I**********    CMINT                           NCMINT                           CCB003 CRE083BE
011700200529     I**********    DICI                            NDICI                            CCB003 CRE083BE
011710200529     I**********    CICI                            NCICI                            CCB003 CRE083BE
011720200529     I**********    DRCI                            NDRCI                            CCB003 CRE083BE
011730200529     I**********    CRCI                            NCRCI                            CCB003 CRE083BE
011740200529     I**********    VDTC                            NVDTC                            CCB003 CRE083BE
011750200529     I**********    ADTY                            NADTY                            CCB003 CRE083BE
011760200529     I**********    ALTI                            NALTI                            CCB003 CRE083BE
011770200529     I**********    MNBCP                           NMNBCP                           CCB003 CRE083BE
011780200529     I              LGID                            NLGID                 CCB003
011790200529     I**********    VALL                            NVALL                            CCB003 CRE083BE
011800200529     I**********    LINK                            NLINK                            CCB003 CRE083BE
011810200529     I**********    AODR                            BAODR                            CRE002 CRE083BE
011820200529     I**********    ODRL                            BODRL                            CRE002 CRE083BE
011830200529     I**********    ODLI                            BODLI                            CRE002 CRE083BE
011840200529     I**********    ODIA                            BODIA                            CRE002 CRE083BE
011850200529      *                                                                   CCB003
011860200529     IREHISPDF
011870200529     I*
011880200529     I** RENAME REHISPDF FORMAT FIELDS
011890200529     I*
011900200529     I              LGID                            DLGID
011910200529      *                                                                   CCB003
011920200529     IREHISPPF
011930200529     I*
011940200529     I***RENAME*REHISPPF*FORMAT*FIELDS*-*REHISBC*FILE                     CCB003
011950200529     I***RENAME*REHISPPF*FORMAT*FIELDS*-*REINTCPD*FILE***************                CCB003 CRE083BE
011960200529      ** Rename REHISPPF format fields - REHISBC file                                       CRE083BE
011970200529     I*
011980200529     I              RECI                            BRECI
011990200529     I              BRCA                            BBRCA
012000200529     I              CNUM                            BCNUM
012010200529     I              CCY                             BCCY
012020200529     I              ACOD                            BACOD
012030200529     I              ACSQ                            BACSQ
012040200529     I              HISD                            BHISD
012050200529     I              HISB                            BHISB
012060200529     I              MNBL                            BMNBL
012070200529     I              CHGAR                           BCHGAR
012080200529     I              TCHGAR                          BTHGAR
012090200529     I              CHGAN                           BCHGAN
012100200529     I              TCHGAN                          BTHGAN
012110200529     I              DMVT                            BDMVT
012120200529     I              DICT                            BDICT
012130200529     I              DRCB                            BDRCB
012140200529     I              DRIR                            BDRIR
012150200529     I              DRCD                            BDRCD
012160200529     I              DAID                            BDAID
012170200529     I              MADI                            BMADI
012180200529     I              TMADI                           BTMADI
012190200529     I              PDID                            BPDID
012200200529     I              DMINT                           BDMINT
012210200529     I              CMVT                            BCMVT
012220200529     I              CICT                            BCICT
012230200529     I              CRCB                            BCRCB
012240200529     I              CRIR                            BCRIR
012250200529     I              CRCD                            BCRCD
012260200529     I              CAID                            BCAID
012270200529     I              MACI                            BMACI
012280200529     I              TMACI                           BTMACI
012290200529     I              PCID                            BPCID
012300200529     I              CMINT                           BCMINT
012310200529     I              DICI                            BDICI
012320200529     I              CICI                            BCICI
012330200529     I              DRCI                            BDRCI
012340200529     I              CRCI                            BCRCI
012350200529     I              VDTC                            BVDTC
012360200529     I              ADTY                            BADTY
012370200529     I              ALTI                            BALTI
012380200529     I              MNBCP                           BMNBCP
012390200529     I              LGID                            BLGID
012400200529     I              VALL                            BVALL
012410200529     I              LINK                            BLINK
012420200529      *                                                                   CCB003
012430200529     IREACRDF
012440200529     I*
012450200529     I** RENAME REACRDF  FORMAT FIELDS - REACRD  FILE
012460200529     I*
012470200529     I              RECI                            RERECI
012480200529     I              CUST                            RECUST
012490200529     I              ACCY                            REACCY
012500200529     I              ACOD                            REACOD
012510200529     I              ASEQ                            REASEQ
012520200529     I              BRCA                            REBRCA
012530200529     I              LCD                             RELCD
012540200529      *                                                                   CCB003
012550200529     IREHISPSF
012560200529     I*
012570200529     I** RENAME REHISPSF FORMAT FIELDS - REHISSL FILE
012580200529     I*
012590200529     I              RECI                            SRECI
012600200529     I              BRCA                            SBRCA
012610200529     I              CNUM                            SCNUM
012620200529     I              CCY                             SCCY
012630200529     I              ACOD                            SACOD
012640200529     I              ACSQ                            SACSQ
012650200529     I              HISD                            SHISD
012660200529     I              HISB                            SHISB
012670200529     I              MNBL                            SMNBL
012680200529     I              TCHGAR                          SCHGAR
012690200529     I              TCHGAN                          SCHGAN
012700200529     I              DICT                            SDICT
012710200529     I              DRCB                            SDRCB
012720200529     I              DRIR                            SDRIR
012730200529     I              DRCD                            SDRCD
012740200529     I              TMADI                           SMADI
012750200529     I              PDID                            SPDID
012760200529     I              DMINT                           SDMINT
012770200529     I              CICT                            SCICT
012780200529     I              CRCB                            SCRCB
012790200529     I              CRIR                            SCRIR
012800200529     I              CRCD                            SCRCD
012810200529     I              TMACI                           SMACI
012820200529     I              PCID                            SPCID
012830200529     I              CMINT                           SCMINT
012840200529     I              DRBR                            SDRBR                 123519
012850200529     I              CRBR                            SCRBR                 123519
012860200529     I              CHBR                            SCHBR                 123519
012870200529     I              AODR                            SAODR                 CRE002
012880200529     I              ODRL                            SODRL                 CRE002
012890200529     I              ODIA                            SODIA                 CRE002
012900200529      *                                                                   CCB003
012910200529     IACCRACJF
012920200529     I*
012930200529     I** RENAME ACCRACJF FORMAT FIELDS - ACCRACJ FILE
012940200529     I*
012950200529     I              RECI                            ARECI
012960200529     I              CNUM                            ACCNUM
012970200529     I              CCY                             ACCCY
012980200529     I              ACOD                            AACOD
012990200529     I              ACSQ                            AACSQ
013000200529     I              BRCA                            ABRCA
013010200529     I              ATYP                            AATYP
013020200529     I              ACNO                            AACNO
013030200529     I              DRCD                            ADRCD
013040200529     I              DAIC                            ADAIC
013050200529     I              CRCD                            ACRCD
013060200529     I              CAIC                            ACAIC
013070200529     I              DICT                            ADICT
013080200529     I              CICT                            ACICT
013090200529     I              HISB                            AHISB
013100200529     I              TEGLIS                          REGLIS
013110200529      *                                                                   CCB003
013120200529     IACNUMABF
013130200529     I*
013140200529     I** RENAME ACNUMABF FORMAT FIELDS - ACNUM FILE
013150200529     I*
013160200529     I              RECI                            RRRECI
013170200529     I              ACNO                            RACNO
013180200529     I              CNUM                            RCNUM
013190200529     I              CCY                             RCCY
013200200529     I              ACOD                            RACOD
013210200529     I              ACSQ                            RACSQ
013220200529     I              ATYP                            RATYP
013230200529     I              BRCA                            RBRCA
013240200529     I*                                                                   CAC001
013250200529     IREACNMF                                                             CAC001
013260200529     I              RECI                            TRECI                 CAC001
013270200529     I              ACNO                            TACNO                 CAC001
013280200529     I              CNUM                            TCNUM                 CAC001
013290200529     I              CCY                             TCCY                  CAC001
013300200529     I              ACOD                            TACOD                 CAC001
013310200529     I              ACSQ                            TACSQ                 CAC001
013320200529     I              ATYP                            TATYP                 CAC001
013330200529     I              BRCA                            TBRCA                 CAC001
013340200529     I              PRFC                            TPRFC                 CAC001
013350200529      *                                                                   CCB003
013360200529     IACCNTABF
013370200529     I*
013380200529     I** RENAME ACCNTABF FORMAT FIELDS - ACCNT FILE
013390200529     I*
013400200529     I              RECI                            AARECI
013410200529     I              ACNO                            AAACNO
013420200529     I              CNUM                            AACNUM
013430200529     I              CCY                             AACCY
013440200529     I              ACOD                            AAACOD
013450200529     I              ACSQ                            AAACSQ
013460200529     I              ATYP                            AAATYP
013470200529     I************* BRCA                            ABRCA                 049320
013480200529     I              BRCA                            AABRCA                049320
013490200529     I              PRFC                            AAPRFC                CAC001
013500200529     I              RRNM                            ARRNM
013510200529     I              DRIS                            ADRIS
013520200529     I              DRCD                            ADRCD
013530200529     I              DAIC                            ADAIC
013540200529     I              MADI                            AMADI
013550200529     I              GADI                            AGADI
013560200529     I              CRIS                            ACRIS
013570200529     I              CRCD                            ACRCD
013580200529     I              CAIC                            ACAIC
013590200529     I              MACI                            AMACI
013600200529     I              GACI                            AGACI
013610200529     I              BRTCA                           ABRTCA
013620200529     I              NACSG                           ANACSG
013630200529      *                                                                   CCB003
013640200529     IRECRGDF
013650200529     I*
013660200529     I** RENAME RECRGDF FORMAT FIELDS - RECRG FILE
013670200529     I*
013680200529     I              RECI                            RRECI
013690200529     I              ACOD                            CACOD
013700200529      *                                                                   CCB003
013710200529      ** RENAME REINCXD0 FORMAT FIELDS - REINCXPD FILE                    CCB003
013720200529     IREINCXD0                                                            CCB003
013730200529     I              CNUM                            RACNUM                CCB003
013740200529     I              CCY                             RACCY                 CCB003
013750200529     I              ACOD                            RAACOD                CCB003
013760200529     I              ACSQ                            RAACSQ                CCB003
013770200529     I              BRCA                            RABRCA                CCB003
013780200529     I              ACNO                            RAACNO                CCB003
013790200529     I              POST                            RAPOST                CCB003
013800200529     I              CPDA                            RACPDA                CCB003
013810200529     I              INTR                            RAINTR                CCB003
013820200529     I              INTP                            RAINTP                CCB003
013830200529     I              INST                            RAINST                CCB003
013840200529     I              MADJ                            RAMADJ                CCB003
013850200529     I              GADT                            RAGADT                CCB003
013860200529     I              AIAP                            RAAIAP                CCB003
013870200529     I              PTFL                            RAPTFL                CCB003
013880200529     I*
013890200529     ISDBRTDD0
013900200529     I              ACOD                            ACOD1
013910200529      *                                                                                       CGL020
013920200529     IAPOSTPDF                                                                                CGL020
013930200529     I              ACKEY                           ACKFLD                                    CGL020
013940200529     I**  Access BRT
013950200529     I/COPY WNCPYSRC,RE3664I001
013960200529     I*
013970200529     IACXDS       DS
013980200529     I                                     *STATUS  STSACX
013990200529     IACCDS       DS
014000200529     I                                     *STATUS  STSACC
014010200529     IACRDS       DS
014020200529     I                                     *STATUS  STSACR
014030200529     IIACDS       DS
014040200529     I                                     *STATUS  STSIAC
014050200529     IREBDS       DS
014060200529     I                                     *STATUS  STSREB
014070200529     IRECDS       DS
014080200529     I                                     *STATUS  STSREC
014090200529     IRELDS       DS
014100200529     I                                     *STATUS  STSREL
014110200529     IREPDS       DS
014120200529     I                                     *STATUS  STSREP
014130200529     IRESDS       DS
014140200529     I                                     *STATUS  STSRES
014150200529     IGEIDS       DS
014160200529     I                                     *STATUS  STSGEI
014170200529     I*
014180200529     I** DATA STRUCTURE FOR CURRENCY DECIMAL
014190200529     I*
014200200529     I            DS
014210200529     I                                        1  150MADI0
014220200529     I                                        1  151MADI1
014230200529     I                                        1  152MADI2
014240200529     I                                        1  153MADI3
014250200529     I*
014260200529     I            DS
014270200529     I                                        1  150GADI0
014280200529     I                                        1  151GADI1
014290200529     I                                        1  152GADI2
014300200529     I                                        1  153GADI3
014310200529     I*
014320200529     I            DS
014330200529     I                                        1  150DRCP0
014340200529     I                                        1  151DRCP1
014350200529     I                                        1  152DRCP2
014360200529     I                                        1  153DRCP3
014370200529     I*
014380200529     I            DS
014390200529     I                                        1  150MACI0
014400200529     I                                        1  151MACI1
014410200529     I                                        1  152MACI2
014420200529     I                                        1  153MACI3
014430200529     I*
014440200529     I            DS
014450200529     I                                        1  150GACI0
014460200529     I                                        1  151GACI1
014470200529     I                                        1  152GACI2
014480200529     I                                        1  153GACI3
014490200529     I*
014500200529     I            DS
014510200529     I                                        1  150CRCP0
014520200529     I                                        1  151CRCP1
014530200529     I                                        1  152CRCP2
014540200529     I                                        1  153CRCP3
014550200529     I*
014560200529     I*********** DS                                                      CCB003
014570200529     I***********                             1  150CHCP0                 CCB003
014580200529     I***********                             1  151CHCP1                 CCB003
014590200529     I***********                             1  152CHCP2                 CCB003
014600200529     I***********                             1  153CHCP3                 CCB003
014610200529     I*
014620200529     I** DATA STRUCTURE FOR DATE FORMAT DD/MM/YY
014630200529     I*
014640200529     I            DS
014650200529     I                                        1   60RESULT
014660200529     I                                        1   20ZDAY
014670200529     I                                        3   40ZMTH
014680200529     I                                        5   60ZYEAR
014690200529     I*                                                                   CRE002
014700200529     I** Data Structure for Capitalisation Narrative                      CRE002
014710200529     I*                                                                   CRE002
014720200529     I            DS                                                      CRE002
014730200529     I                                        1  14 NR16DS                CRE002
014740200529     I                                        1   7 NR16P1                CRE002
014750200529     I                                        8  14 NR16P2                CRE002
014760200529     I/COPY WNCPYSRC,REH00429
014770200529     I*
014780200529     I** KEYS DATA STRUCTURE : RKEY TO FILL DBKEY IF ERROR
014790200529     I**                       AKEY TO FILL DBKEY IF ERROR
014800200529     I*
014810200529     I            DS
014820200529     I**********                              1  20 RKEY                                      CGL029
014830200529     I**********                              3  20 AKEY                                      CGL029
014840200529     I                                        1  26 RKEY                                      CGL029
014850200529     I                                        3  26 AKEY                                      CGL029
014860200529     I                                        1   2 LGID
014870200529     I                                        3   5 BBRCA
014880200529     I**********                              6  20 RKEY4                                     CGL029
014890200529     I                                        6  26 RKEY4                                     CGL029
014900200529     I**********                              6  110BCNUM                                     CSD027
014910200529     I                                        6  11 BCNUM                                     CSD027
014920200529     I                                       12  14 BCCY
014930200529     I**********                             15  180BACOD                                     CGL029
014940200529     I**********                             19  200BACSQ                                     CGL029
014950200529     I**********                             21  39 RKEY2                                     CGL029
014960200529     I**********                             21  23 BRCA                                      CGL029
014970200529     I**********                             24  290CNUM                                      CGL029
014980200529     I**********                             30  32 CCY                                       CGL029
014990200529     I**********                             33  360ACOD                                      CGL029
015000200529     I**********                             37  380ACSQ                                      CGL029
015010200529     I                                       15  240BACOD                                     CGL029
015020200529     I                                       25  260BACSQ                                     CGL029
015030200529     I                                       27  50 RKEY2                                     CGL029
015040200529     I                                       27  29 BRCA                                      CGL029
015050200529     I**********                             30  350CNUM                               CGL029 CSD027
015060200529     I                                       30  35 CNUM                                      CSD027
015070200529     I                                       36  38 CCY                                       CGL029
015080200529     I                                       39  480ACOD                                      CGL029
015090200529     I                                       49  500ACSQ                                      CGL029
015100200529     I*
015110200529     I** DATA STRUCTURE : WORK RETAIL OR ACCOUNT KEY
015120200529     I*
015130200529     I            DS
015140200529     I**********                              1  18 WALT                                      CGL029
015150200529     I                                        1  24 WALT                                      CGL029
015160200529     I**********                              1   60WCNUM                                     CSD027
015170200529     I                                        1   6 WCNUM                                     CSD027
015180200529     I                                        7   9 WCCY
015190200529     I**********                             10  130WACOD                                     CGL029
015200200529     I**********                             14  150WACSQ                                     CGL029
015210200529     I**********                             16  18 WBRCA                                     CGL029
015220200529     I                                       10  190WACOD                                     CGL029
015230200529     I                                       20  210WACSQ                                     CGL029
015240200529     I                                       22  24 WBRCA                                     CGL029
015250200529     I                                       11  15 WALT5
015260200529     I                                        1  100WALT10
015270200529     I*
015280200529     I** KEY DATA STRUCTURE : CHKEY TO CHAIN TO RECRG FILE
015290200529     I*
015300200529     I            DS
015310200529     I                                        1  12 CHKEY
015320200529     I                                        1   1 ZZ001
015330200529     I                                        2   30CHGT
015340200529     I                                        4   80CHST
015350200529     I                                        9  11 ACCCY
015360200529     I                                       12  12 ENDK
015370200529      *                                                                                       232543
015380200529      ** Key Data Structure : Key Fields for SDCSINPD LFs                                     232543
015390200529      *                                                                                       232543
015400200529     I            DS                                                                          232543
015410200529     I                                        1   20KACSQ                                     232543
015420200529     I**********                              3   80KJOIN                             232543 CSD027A
015430200529     I                                        3   8 KJOIN                                    CSD027A
015440200529     I*
015450200529     I** DATA STRUCTURE : TO CHECK SAME ACCOUNT
015460200529     I*
015470200529     I            DS
015480200529     I**********                              1  18 OKEY                                      CGL029
015490200529     I                                        1  24 OKEY                                      CGL029
015500200529     I**********                              1   60OCNUM                                     CSD027
015510200529     I                                        1   6 OCNUM                                     CSD027
015520200529     I                                        7   9 OCCY
015530200529     I**********                             10  130OACOD                                     CGL029
015540200529     I**********                             14  150OACSQ                                     CGL029
015550200529     I**********                             16  18 OBRCA                                     CGL029
015560200529     I                                       10  190OACOD                                     CGL029
015570200529     I                                       20  210OACSQ                                     CGL029
015580200529     I                                       22  24 OBRCA                                     CGL029
015590200529     I** DATA STRUCTURE : TO CHECK RETRG                                                      250998
015600200529      *                                                                                       250998
015610200529     ITRGDS       DS                                                                          250998
015620200529     I                                        1   3 BLNKS                                     250998
015630200529     I**********                              4   80DTRTY                            250998 CRE083BK
015640200529     I                                        4   8 DTRTY                                   CRE083BK
015650200529     I                                        9  11 DCCY                                      250998
015660200529     I                                       12  12 D                                         250998
015670200529      *                                                                                       250998
015680200529     I*
015690200529     I** DATA STRUCTURE : POSTING NARRATIVE
015700200529     I*
015710200529     I            DS
015720200529     I                                        1  30 NARS
015730200529     I************                            1  19 NAR1                  B8200
015740200529     I                                        1  30 NAR1                  B8200
015750200529     I            DS
015760200529     I**********                              1  22 WNARS                                     CGL029
015770200529     I                                        1  24 WNARS                                     CGL029
015780200529     I                                        1   3 XBRCA
015790200529     I**********                              4   4 TIR1                                      CGL029
015800200529     I**********                              5  100XCNUM                                     CGL029
015810200529     I**********                              5  10 XCNUMA                             CRE008 CGL029
015820200529     I**********                             11  11 TIR2                                      CGL029
015830200529     I**********                             12  14 XCCY                                      CGL029
015840200529     I**********                             15  15 TIR3                                      CGL029
015850200529     I**********                             16  190XACOD                                     CGL029
015860200529     I**********                             20  20 TIR4                                      CGL029
015870200529     I**********                             21  220XACSQ                                     CGL029
015880200529     I**********                             21  22 XACSQA                             CRE008 CGL029
015890200529     I**********                             23  32 WACNO                                     CGL029
015900200529     I**********                             23  320WACN0                                     CGL029
015910200529     I**********                              4   90XCNUM                              CGL029 CSD027
015920200529     I                                        4   9 XCNUM                                     CSD027
015930200529     I                                        4   9 XCNUMA                                    CGL029
015940200529     I                                       10  12 XCCY                                      CGL029
015950200529     I                                       13  220XACOD                                     CGL029
015960200529     I                                       23  240XACSQ                                     CGL029
015970200529     I                                       23  24 XACSQA                                    CGL029
015980200529     I                                       25  34 WACNO                                     CGL029
015990200529     I                                       25  340WACN0                                     CGL029
016000200529     I*
016010200529     I** DATA STRUCTURE : POSTING NARRATIVE
016020200529     I*
016030200529     I            DS
016040200529     I                                        1   64NEXRT
016050200529     I*
016060200529     I** DATA STRUCTURE : HOLIDAY DATE
016070200529     I*
016080200529     I            DS
016090200529     I                                        1  12 KEY
016100200529     I                                        8  120HOL
016110200529     I*
016120200529     I**   FILE INFORMATION DATA STRUCTURE
016130200529     I**
016140200529     I*SPOOL*******DS                                                     CCB003
016150200529     I*************                          83  92 SFILE                 CCB003
016160200529     I*************                       B 123 1240SFNUM                 CCB003
016170200529      *                                                                   CCB003
016180200529     ISPOOLU      DS
016190200529     I                                       83  92 SFILEU
016200200529     I                                    B 123 1240SFNUMU
016210200529     I/COPY WNCPYSRC,RE3664I004
016220200529     I*
016230200529     I** LOCAL DATA AREA FOR DATABASE ERROR DETAILS
016240200529     I*
016250200529     ILDA       EUDSLDA                         256                       CCB003
016260200529      *                                                                   CCB003
016270200529     I*LDA******* UDS                            256                      CCB003
016280200529     I***********                           134 141 DBFILE                CCB003
016290200529     I***********                           142 170 DBKEY                 CCB003
016300200529     I***********                           171 180 DBPGM                 CCB003
016310200529     I***********                           181 1830DBASE                 CCB003
016320200529     I*
016330200529     I/COPY WNCPYSRC,RE3664I002
016340200529     IRUNDT       DS
016350200529     I                                        1   7 RUNA
016360200529     I                                    P   8  100RUND
016370200529     I                                       11  11 SSF
016380200529     I                                       12  12 DATF
016390200529     I                                       13  13 MBIN
016400200529     I*
016410200529     I**  Data Area RUNDAT
016420200529     I*
016430200529      ** Commitment control size                                          CCB003
016440200529     ICBTASK    E DSCBTASKSP                                              CCB003
016450200529     I*
016460200529     IDSFDY     E DSDSFDY
016470200529     I*
016480200529     I** First DS for access programs, Short data structure
016490200529     I*
016500200529     IDSSDY     E DSDSSDY
016510200529     I*
016520200529     I** Second DS for access progrmas, Long data structure
016530200529     I*
016540200529     IDSLDY     E DSDSLDY                                                 CPB001
016550200529     I*                                                                   CPB001
016560200529     I** Third DS for access progrmas, Very Long data structure           CPB001
016570200529     I*                                                                   CPB001
016580200529     ISDBANK    E DSSDBANKPD
016590200529     I              BJURPT                          TITL
016600200529     I              BJCYCD                          BACCY
016610200529     I              BJDNWD                          DNWD
016620200529     I*
016630200529     I** Bank Details
016640200529     I*
016650200529     I***SDBRCH*   E DSSDBRCHPD                                                             CRE083BK
016660200529     ISDBRCH    E DSSDBRCHPD                900                                             CRE083BK
016670200529     I***********   A8BRNM                          BRNM                  CCB003
016680200529     I              A8BICN                          BICN
016690200529     I              A8DTAC                          NBACB
016700200529     I*
016710200529     I**  External DS for Branch Codes.
016720200529     I*
016730200529     I***SDCURR*   E DSSDCURRPD                                                             CRE083BK
016740200529     ISDCURR    E DSSDCURRPD                250                                             CRE083BK
016750200529     I              A6NBDP                          CDP
016760200529     I              A6SPRT                          SPOT
016770200529     I              A6MDIN                          MDIN
016780200529     I              A6ERLC                          ERLC
016790200529     I              A6TXND                          TNOT
016800200529     I              A6CYNM                          CCNM
016810200529     I              A6SPAE                          TACC
016820200529     I              A6SSNB                          SSNO
016830200529     I              A6TXCR                          TXCR                                      CGL165
016840200529     I*
016850200529     I**  External DS for Currency Codes.
016860200529     I*
016870200529     ISDGELR    E DSSDGELRPD
016880200529     I*****         BKAPDT                          APDA
016890200529     I              BKACCD                          COMS
016900200529     I              BKPRCU                          PCUS                  184965
016910200529     I              BKPCDU                          PCMU                  184965
016920200529     I*
016930200529     I**  General Ledger Details.
016940200529     I*
016950200529     ISDRETL    E DSSDRETLPD
016960200529     I              BMLDAI                          LDAC
016970200529     I              BMCBAI                          CBAI
016980200529     I              BMNDFV                          NDFV
016990200529     I              BMNDBI                          NDBI
017000200529     I              BMRCPI                          RCPT
017010200529     I              BMRANR                          RACN
017020200529     I              QQACCD                          QQACC1                                    CGL029
017030200529     I*
017040200529     I**  Retail Details
017050200529     I*
017060200529     ISDTRAD    E DSSDTRADPD
017070200529     I              BLSPTA                          SPAC
017080200529     I              QQACCD                          QQACC2                                    CGL029
017090200529     I*
017100200529     I**  Trading Details.
017110200529     I*
017120200529     ISDMMOD    E DSSDMMODPD
017130200529     I*
017140200529     I**  Access Midas Modules.
017150200529     I*
017160200529     ISDCTRY    E DSSDCTRYPD                                              CRE007
017170200529      ** Country Code Details                                             CRE007
017180200529      *                                                                   CRE007
017190200529     ISCSARD    E DSSCSARDPD                                              S01522
017200200529     I* SAR file details accessed via access program AOSARDR0             S01522
017210200529     I*                                                                   S01522
017220200529     ISDPCAC    E DSSDPCACPD                                              CAC001
017230200529     I**  Profit Centre Accounting ICD                                    CAC001
017240200529     I*                                                                   CAC001
017250200529     ISDPRFC    E DSSDPRFCPD                                              CAC001
017260200529     I**  Profit Centre Details                                           CAC001
017270200529     I*                                                                   CAC001
017280200529     ICGPNAR    E DSCGPNARPD                                              S01522
017290200529      * UDC Multi Language Narrative Datastructure                        S01522
017300200529     I/COPY WNCPYSRC,RE3664I005
017310200529      *                                                                   S01522
017320200529     I##PRM1      DS                                                      086125
017330200529      **  Data Structure for Customer and Branch                          086125
017340200529      *                                                                   086125
017350200529     I                                        1   6 A#CUST                086125
017360200529     I                                        7   9 A#BRCA                086125
017370200529      *                                                                   086125
017380200529     I***SDNARR*   E DSSDNARRPD                                                             CRE083BK
017390200529     ISDNARR    E DSSDNARRPD                300                                             CRE083BK
017400200529     I              ALDON                           NARD
017410200529     I*
017420200529     I**  Narrative Codes.
017430200529     I*
017440200529     I***SDACOD*   E DSSDACODPD                                                             CRE083BK
017450200529     ISDACOD    E DSSDACODPD                300                                             CRE083BK
017460200529     I              QQACCD                          QQACC4                                    CGL029
017470200529     I              QQFNIC                          QQFNI1                                    CGL029
017480200529     I              QQFNAA                          QQFNA1                                    CGL029
017490200529     I*
017500200529     I**  Access Account Codes.
017510200529     I*
017520200529     ISDCUST    E DSSDCUSTPD
017530200529     I              BBCRNM                          CRNM
017540200529     I              QQDFAC                          QQDFA1                                    CGL029
017550200529     I*
017560200529     I**  Access Account Codes.
017570200529     I*
017580200529     I/COPY ZSRSRC,ZHOLI
017590200529     I/COPY WNCPYSRC,RE3664I003
017600200529     I*
017610200529      ** Data Structure for Country of Tax Codes                                              CER048
017620200529      *                                                                                       CER048
017630200529     ISDCTTX    E DSSDCTTXPD                                                                  CER048
017640200529      *                                                                                       CER048
017650200529      ** Data Structure for Location Codes                                                    CER048
017660200529      *                                                                                       CER048
017670200529     ISDLOCN    E DSSDLOCNPD                                                                  CER048
017680200529     ISDRETR    E DSRETRGD                  250                                             CRE083BK
017690200529     I              RECI                            RECID                                   CRE083BK
017700200529     I              REBI                            REBID                                   CRE083BK
017710200529     I              KEY                             KEYD                                    CRE083BK
017720200529     I              LCD                             LCDD                                    CRE083BK
017730200529     I              ZZ001                           ZZ001D                                  CRE083BK
017740200529     I/COPY OFCPYSRCZ,CRE105_007                                                              CRE105
017750200529     IKYRETR      DS                             12                                         MD021155
017760200529     I                                        1   3 RETRBK                                  MD021155
017770200529     I                                        4   8 RETRID                                  MD021155
017780200529     I                                        9  11 RETRCY                                  MD021155
017790200529     I                                       12  12 RETRRC                                  MD021155
017800200529      *                                                                   085787
017810200529     IPGMDS      SDS                                                      085787
017820200529      * Pgm/Job information System-DS                                     085787
017830200529     I                                        1  10 PGNAME                085787
017840200529     I                                       81  90 PGLIBR                085787
017850200529     I                                      244 253 PGJBNM                085787
017860200529     I                                      254 263 PGUSER                085787
017870200529     I                                      264 269 PGJBNO                085787
017880200529      *                                                                   085787
017890200529      ** Data Structure for Finishing Date                                                    CER048
017900200529      *                                                                                       CER048
017910200529     I            DS                                                                          CER048
017920200529     I                                        1   60FRES                                      CER048
017930200529     I                                        1   20ZIFD                                      CER048
017940200529     I                                        3   40ZIFM                                      CER048
017950200529     I                                        5   60ZIFY                                      CER048
017960200529      *                                                                                       CER048
017970200529      ** Data Structure for Finishing Date MM/DD/YY                                           CER048
017980200529      *                                                                                       CER048
017990200529     I            DS                                                                          CER048
018000200529     I                                        1   60FRESX                                     CER048
018010200529     I                                        1   20ZIFMX                                     CER048
018020200529     I                                        3   40ZIFDX                                     CER048
018030200529     I                                        5   60ZIFYX                                     CER048
018040200529      *                                                                                       CER048
018050200529      ** Data structure for Begining date                                                     CER048
018060200529      *                                                                                       CER048
018070200529     I            DS                                                                          CER048
018080200529     I                                        1   60SRES                                      CER048
018090200529     I                                        1   20ZISD                                      CER048
018100200529     I                                        3   40ZISM                                      CER048
018110200529     I                                        5   60ZISY                                      CER048
018120200529      *                                                                                       CER048
018130200529      ** Data Structure for Begining Date MM/DD/YY                                            CER048
018140200529      *                                                                                       CER048
018150200529     I            DS                                                                          CER048
018160200529     I                                        1   60SRESX                                     CER048
018170200529     I                                        1   20ZISMX                                     CER048
018180200529     I                                        3   40ZISDX                                     CER048
018190200529     I                                        5   60ZISYX                                     CER048
018200200529      *                                                                                       CER048
018210200529      ** Data Structure for Date in DD/MM/YY                                                  CER048
018220200529      *                                                                                       CER048
018230200529     I            DS                                                                          CER048
018240200529     I                                        1   60WDATE6                                    CER048
018250200529     I                                        1   20WDD                                       CER048
018260200529     I                                        3   40WMM                                       CER048
018270200529     I                                        5   60WYY                                       CER048
018280200529      *                                                                                       CER048
018290200529     I              'REC64A    '          C         REC64A                085787
018300200529     I              'REC64N    '          C         REC64N                085787
018310200529     I              'BasCcyTaxRoundDown'  C         C#BASE                                    CDL081
018320200529     I              'NBasCcyTaxRoundDown' C         C#NBAS                                    CDL081
018330200529     I              'SuppressFCCYWHTConv' C         C#SCON                                  MD053762
018340200529      *                                                                   085787
018350200529     I              'MAIN TAX'            C         CPRITX                                  BUG23163
018360200529     I              'SECONDARY TAX'       C         C2NDTX                                  BUG23163
018370200529     I              'THIRD TAX'           C         C3RDTX                                  BUG24341
018380200529     I              'EU TAXATION'         C         EUTAXN                                 BUG23163A
018390200529     I              'PostNetInterest   '  C         PSNET                                   AR831847
018400200529      *                                                                                     BUG23163
018410200529     I/COPY WNCPYSRC,RE3664IIPG                                           S01408
018420200529     I*                                                                   S01408
018430200529      *                                                                                     CRE083BE
018440200529      ** End Record Key Data Structure                                                      CRE083BE
018450200529      *                                                                                     CRE083BE
018460200529     I            DS                                                                        CRE083BE
018470200529     I                                        1  26 ENDKEY                                  CRE083BE
018480200529     I                                        1   2 JLGID                                   CRE083BE
018490200529     I                                        3   5 JBRCA                                   CRE083BE
018500200529     I                                        6  11 JCNUM                                   CRE083BE
018510200529     I                                       12  14 JCCY                                    CRE083BE
018520200529     I                                       15  240JACOD                                   CRE083BE
018530200529     I                                       25  260JACSQ                                   CRE083BE
018540200529      *                                                                                     CRE083BE
018550200529      ** Next Record Key Data Structure                                                     CRE083BE
018560200529      *                                                                                     CRE083BE
018570200529     I            DS                                                                        CRE083BE
018580200529     I                                        1  26 NXTKEY                                  CRE083BE
018590200529     I                                        1   2 YLGID                                   CRE083BE
018600200529     I                                        3   5 YBRCA                                   CRE083BE
018610200529     I                                        6  11 YCNUM                                   CRE083BE
018620200529     I                                       12  14 YCCY                                    CRE083BE
018630200529     I                                       15  240YACOD                                   CRE083BE
018640200529     I                                       25  260YACSQ                                   CRE083BE
018650200529      *                                                                                     CRE083BE
018660200529      ** Last Record Key Data Structure                                                     CRE083BE
018670200529      *                                                                                     CRE083BE
018680200529     I            DS                                                                        CRE083BE
018690200529     I                                        1  26 LSTKEY                                  CRE083BE
018700200529     I                                        1   2 LLGID                                   CRE083BE
018710200529     I                                        3   5 LBRCA                                   CRE083BE
018720200529     I                                        6  11 LCNUM                                   CRE083BE
018730200529     I                                       12  14 LCCY                                    CRE083BE
018740200529     I                                       15  240LACOD                                   CRE083BE
018750200529     I                                       25  260LACSQ                                   CRE083BE
018760200529     I/EJECT
018770200529     C*===================================================================
018780200529     C                     MOVEACPY@      BIS@   80
018790200529     C*
018800200529     C** KEY LISTS
018810200529     C*
018820200529     C/COPY WNCPYSRC,RE3664CP26                                           S01408
018830200529      *                                                                                       CDL013
018840200529      ** Set up a key list to access GLWHTCL0                                                 CDL013
018850200529     C           HISKEY    KLIST                                                              CDL013
018860200529     C                     KFLD           ECUST                                               CDL013
018870200529     C                     KFLD           EDLAC                                               CDL013
018880200529     C                     KFLD           EDAIN                                               CDL013
018890200529     C*
018900200529     C** KEY FIELD TO ACCESS TO REHISL  FILE
018910200529     C*
018920200529     C           R3KEY     KLIST
018930200529     C                     KFLD           BRCA
018940200529     C                     KFLD           CNUM
018950200529     C                     KFLD           CCY
018960200529     C                     KFLD           ACOD
018970200529     C                     KFLD           ACSQ
018980200529     C                     KFLD           HISD
018990200529      *                                                                                       CER048
019000200529      ** Partial key list to access REHISL file                                               CER048
019010200529      *                                                                                       CER048
019020200529     C           R3KEYA    KLIST                                                              CER048
019030200529     C                     KFLD           BRCA                                                CER048
019040200529     C                     KFLD           CNUM                                                CER048
019050200529     C                     KFLD           CCY                                                 CER048
019060200529     C                     KFLD           ACOD                                                CER048
019070200529     C                     KFLD           ACSQ                                                CER048
019080200529      *                                                                                     BUG23347
019090200529      ** Key list to access SDINPHPD file                                                   BUG23347
019100200529      *                                                                                     BUG23347
019110200529     C           R3KEYB    KLIST                                                            BUG23347
019120200529     C                     KFLD           KCNUM   6                                         BUG23347
019130200529     C                     KFLD           KBRCH   3                                         BUG23347
019140200529      *                                                                                     BUG24114
019150200529     C           KCILJ     KLIST                                                            BUG24114
019160200529     C                     KFLD           KMODI                                             BUG24114
019170200529     C                     KFLD           KCUST                                             BUG24114
019180200529     C                     KFLD           KSCCY                                             BUG24114
019190200529     C                     KFLD           KACDE                                             BUG24114
019200200529     C                     KFLD           KACSQ                                             BUG24114
019210200529     C                     KFLD           KBRCA                                             BUG24114
019220200529     C                     KFLD           KRDNB                                             BUG24114
019230200529     C*
019240200529     C** KEY FIELD TO ACCESS TO REHISBL FILE
019250200529     C*
019260200529     C           R2KEY     KLIST
019270200529     C                     KFLD           BRCA
019280200529     C                     KFLD           CNUM
019290200529     C                     KFLD           CCY
019300200529     C                     KFLD           ACOD
019310200529     C                     KFLD           ACSQ
019320200529     C*
019330200529     C** KEY FIELD TO ACCESS TO REHISSL FILE
019340200529     C*
019350200529     C***********R1KEY     KLIST                                          CCB003
019360200529     C***********          KFLD           LGID                            CCB003
019370200529     C***********          KFLD           BBRCA                           CCB003
019380200529     C***********          KFLD           BCNUM                           CCB003
019390200529     C***********          KFLD           BCCY                            CCB003
019400200529     C***********          KFLD           BACOD                           CCB003
019410200529     C***********          KFLD           BACSQ                           CCB003
019420200529     C*
019430200529     C** KEY FIELD TO ACCESS TO ACCRACJ FILE
019440200529     C*
019450200529     C********** ACKEY     KLIST                                                              CGL029
019460200529     C           ACKEY2    KLIST                                                              CGL029
019470200529     C                     KFLD           BBRCA
019480200529     C                     KFLD           BCNUM
019490200529     C                     KFLD           BCCY
019500200529     C                     KFLD           BACOD
019510200529     C                     KFLD           BACSQ
019520200529     C*
019530200529     C           ACKEY1    KLIST
019540200529     C                     KFLD           BCNUM
019550200529     C                     KFLD           BCCY
019560200529     C                     KFLD           BACOD
019570200529     C                     KFLD           BACSQ
019580200529     C                     KFLD           BBRCA
019590200529     C*
019600200529     C** KEY FIELD TO ACCESS TO ACCNT/REACR/REIAC FOR UPDATE
019610200529     C*
019620200529     C           R4KEY     KLIST
019630200529     C                     KFLD           BCNUM
019640200529     C                     KFLD           BCCY
019650200529     C                     KFLD           BACOD
019660200529     C                     KFLD           BACSQ
019670200529     C*
019680200529     C** KEY FIELD TO ACCESS TO ACCNT FILE
019690200529     C*
019700200529     C           WALTK     KLIST
019710200529     C                     KFLD           WCNUM
019720200529     C                     KFLD           WCCY
019730200529     C                     KFLD           WACOD
019740200529     C                     KFLD           WACSQ
019750200529     C                     KFLD           WBRCA
019760200529     C*****                                                               NNN
019770200529     C***** KEY FIELD TO ACCESS TO REHISBC FILE                           NNN
019780200529     C*****                                                               NNN
019790200529     C***********RBKEY     KLIST                                          NNN
019800200529     C***********          KFLD           BLGID                           NNN
019810200529     C***********          KFLD           BBRCA                           NNN
019820200529     C***********          KFLD           BCNUM                           NNN
019830200529     C***********          KFLD           BCCY                            NNN
019840200529     C***********          KFLD           BACOD                           NNN
019850200529     C***********          KFLD           BACSQ                           NNN
019860200529      *                                                                   CCB003
019870200529      ** Key field to access REHISBC file                                 CCB003
019880200529     C           KKEY01    KLIST                                          CCB003
019890200529     C                     KFLD           BLGID                           CCB003
019900200529     C                     KFLD           BBRCA                           CCB003
019910200529     C                     KFLD           BCNUM                           CCB003
019920200529     C                     KFLD           BCCY                            CCB003
019930200529     C                     KFLD           BACOD                           CCB003
019940200529     C                     KFLD           BACSQ                           CCB003
019950200529      *                                                                                     CRE083BE
019960200529      ** Key field to access first record of REHISBC file                                   CRE083BE
019970200529      *                                                                                     CRE083BE
019980200529     C           REHKEY    KLIST                                                            CRE083BE
019990200529     C                     KFLD           YLGID                                             CRE083BE
020000200529     C                     KFLD           YBRCA                                             CRE083BE
020010200529     C                     KFLD           YCNUM                                             CRE083BE
020020200529     C                     KFLD           YCCY                                              CRE083BE
020030200529     C                     KFLD           YACOD                                             CRE083BE
020040200529     C                     KFLD           YACSQ                                             CRE083BE
020050200529      *                                                                                       232543
020060200529      ** Key fields to access LF/SDCSINL7.                                                    232543
020070200529      *                                                                                       232543
020080200529     C           KCIL7     KLIST                                                              232543
020090200529     C                     KFLD           KRDNB   50                                          232543
020100200529     C                     KFLD           KMODI   1                                           232543
020110200529     C                     KFLD           KCUST   6                                           232543
020120200529     C                     KFLD           KSCCY   3                                           232543
020130200529     C                     KFLD           KACDE                                               232543
020140200529     C                     KFLD           KACSQ                                               232543
020150200529     C                     KFLD           KBRCA   3                                           232543
020160200529      *                                                                                       232543
020170200529      ** Key fields to access LF/SDCSINLC.                                                    232543
020180200529      *                                                                                       232543
020190200529     C           KCILC     KLIST                                                              232543
020200200529     C                     KFLD           KRDNB                                               232543
020210200529     C                     KFLD           KMODI                                               232543
020220200529     C                     KFLD           KJOIN                                               232543
020230200529     C                     KFLD           KSCCY                                               232543
020240200529     C                     KFLD           KACDE                                               232543
020250200529     C                     KFLD           KACSQ                                               232543
020260200529     C                     KFLD           KBRCA                                               232543
020270200529      *                                                                                     CRE083BE
020280200529      ** Key Fields for pointer                                                             CRE083BE
020290200529      *                                                                                     CRE083BE
020300200529     C*
020310200529     C** WORK FIELDS DEFINITION
020320200529     C*
020330200529     C           *LIKE     DEFN TRAT      WTRAT
020340200529     C           *LIKE     DEFN LGID      WLGID
020350200529     C           *LIKE     DEFN BKAPDT    NAPDA
020360200529     C           *LIKE     DEFN GADI      RGADI
020370200529     C           *LIKE     DEFN GACI      RGACI
020380200529     C           *LIKE     DEFN DAIC1     RDAIC
020390200529     C           *LIKE     DEFN CAIC1     RCAIC
020400200529     C           *LIKE     DEFN ATYP      WCOMST
020410200529     C           *LIKE     DEFN ATYP      WCAPDT
020420200529     C           *LIKE     DEFN ATYP      WCAPCT
020430200529     C           *LIKE     DEFN ATYP      WDIACT
020440200529     C           *LIKE     DEFN ATYP      WDIADT
020450200529     C           *LIKE     DEFN ATYP      WCIADT
020460200529     C           *LIKE     DEFN ATYP      WCIACT
020470200529     C           *LIKE     DEFN ATYP      WCHGT
020480200529     C********** *LIKE     DEFN CNUM      WDATE - 1                                           CSD027
020490200529     C                     Z-ADD*ZEROS    WDATE   50                                          CSD027
020500200529     C           *LIKE     DEFN RECI      WDRCR
020510200529     C           *LIKE     DEFN DAIC      WPSTA
020520200529     C           *LIKE     DEFN RUND      CNDID
020530200529     C           *LIKE     DEFN RUND      CNCID
020540200529     C           *LIKE     DEFN RUND      CTLDAT
020550200529     C********** *LIKE     DEFN CNUM      IND   - 3                                           CSD027
020560200529     C                     Z-ADD*ZEROS    IND     30                                          CSD027
020570200529     C           *LIKE     DEFN KEY       ERRDAT
020580200529     C********** *LIKE     DEFN CNUM      ZERROR- 5                                           CSD027
020590200529     C                     Z-ADD*ZEROS    ZERROR  10                                          CSD027
020600200529     C           *LIKE     DEFN NORE1     WNORE
020610200529     C           *LIKE     DEFN CDP       WBCDP
020620200529     C           *LIKE     DEFN SPOT      WBSPOT
020630200529     C           *LIKE     DEFN MDIN      WBMDIN
020640200529     C           *LIKE     DEFN TACC      WBTACC
020650200529     C           *LIKE     DEFN CDP       WOCDP
020660200529     C           *LIKE     DEFN SPOT      WOSPOT
020670200529     C           *LIKE     DEFN MDIN      WOMDIN
020680200529     C           *LIKE     DEFN TACC      WOTACC
020690200529     C           *LIKE     DEFN CDP       WACDP
020700200529     C           *LIKE     DEFN SPOT      WASPOT
020710200529     C           *LIKE     DEFN MDIN      WAMDIN
020720200529     C           *LIKE     DEFN TACC      WATACC
020730200529     C           *LIKE     DEFN CCY       ALCCY
020740200529     C           *LIKE     DEFN ACOD      ALACOD
020750200529     C           *LIKE     DEFN ACSQ      ALACSQ
020760200529     C           *LIKE     DEFN BRCA      ALBRCA
020770200529     C           *LIKE     DEFN CNUM      ALCNUM
020780200529     C           *LIKE     DEFN BICN      BBICN
020790200529     C           *LIKE     DEFN BICN      ALBICN
020800200529     C           *LIKE     DEFN BICN      BKBICN
020810200529     C           *LIKE     DEFN PSTA      WOPSTA
020820200529     C           *LIKE     DEFN PSTA      WPSTAA
020830200529     C           *LIKE     DEFN PSTA      WPSTAB
020840200529     C           *LIKE     DEFN DEXRT     EXRT
020850200529     C           *LIKE     DEFN A5DIPD    WDIPD
020860200529     C           *LIKE     DEFN A5DIPC    WDIPC
020870200529     C           *LIKE     DEFN A5CIPC    WCIPC
020880200529     C           *LIKE     DEFN A5CISU    WCISU
020890200529     C           *LIKE     DEFN A5CINS    WCINS
020900200529     C           *LIKE     DEFN A5WTAC    WWTAC
020910200529     C           *LIKE     DEFN A5MISU    WMISU
020920200529     C           *LIKE     DEFN A5ACTY    WTDIPD
020930200529     C           *LIKE     DEFN A5ACTY    WTDIPC
020940200529     C           *LIKE     DEFN A5ACTY    WTCIPC
020950200529     C           *LIKE     DEFN A5ACTY    WTCISU
020960200529     C           *LIKE     DEFN A5ACTY    WTCINS
020970200529     C           *LIKE     DEFN A5ACTY    WTWTAC
020980200529     C           *LIKE     DEFN ACOD      CIAC
020990200529     C           *LIKE     DEFN ACOD      CIAD
021000200529     C           *LIKE     DEFN ACOD      DIAC
021010200529     C           *LIKE     DEFN ACOD      DIAD
021020200529     C           *LIKE     DEFN ACOD      CAPC
021030200529     C           *LIKE     DEFN ACOD      CAPD
021040200529     C           *LIKE     DEFN NBACB     BNBACB
021050200529     C           *LIKE     DEFN A5ACTY    BNBACT
021060200529     C           *LIKE     DEFN NBACB     BNDFAC
021070200529     C           *LIKE     DEFN A5ACTY    BNDFAT
021080200529     C           *LIKE     DEFN A5ACTY    WATACT
021090200529     C           *LIKE     DEFN A5ACTY    WOTACT
021100200529     C           *LIKE     DEFN A5ACTY    WBTACT
021110200529     C           *LIKE     DEFN A5ACTY    WSPACT
021120200529     C           *LIKE     DEFN CINW      BCINW
021130200529     C           *LIKE     DEFN WOTACT    WATYP
021140200529     C           *LIKE     DEFN BICN      WBICN
021150200529     C           *LIKE     DEFN DINW      WCIWT
021160200529     C           *LIKE     DEFN DINW      WDIWT
021170200529     C           *LIKE     DEFN WOTACC    WTACC
021180200529     C           *LIKE     DEFN WPSTA     @WPSTA
021190200529     C           *LIKE     DEFN WPSTA     PACR1
021200200529     C           *LIKE     DEFN RUND      CTFDAT                         052739
021210200529     C           *LIKE     DEFN BRCA      @CBRCA                          130468
021220200529     C           *LIKE     DEFN BRCA      @SBRCA                          130468
021230200529     C           *LIKE     DEFN CCY       @CCCY                           130468
021240200529     C           *LIKE     DEFN CCY       @SCCY                           130468
021250200529     C           *LIKE     DEFN BICN      @CBICN                          130468
021260200529     C           *LIKE     DEFN BICN      @SBICN                          130468
021270200529     C           *LIKE     DEFN CNUM      @CCNUM                          130468
021280200529     C           *LIKE     DEFN ACOD      @CACOD                          130468
021290200529     C           *LIKE     DEFN ACSQ      @CACSQ                          130468
021300200529     C           *LIKE     DEFN ACNO      @CACNO                          130468
021310200529     C           *LIKE     DEFN PRFC      WFXPC                           130468
021320200529     C           *LIKE     DEFN PRFC      @CPRFC                          130468
021330200529     C           *LIKE     DEFN CAIC      @WCAIC                          130468
021340200529     C           *LIKE     DEFN BRTAMT    BRTAM2                          130468
021350200529     C           *LIKE     DEFN CAIC      @CRINT                          135809
021360200529     C           *LIKE     DEFN CAIC      @CRNET                          135809
021370200529     C           *LIKE     DEFN ATYP      @CATYP                          135809
021380200529     C           *LIKE     DEFN HISB      @RHISB                          135809
021390200529     C/COPY WNCPYSRC,REH00430
021400200529     C           *LIKE     DEFN TCHO      WTCHO                                               250998
021410200529     C           *LIKE     DEFN CHGA      WCHGA                                               250998
021420200529     C           *LIKE     DEFN PSTA      WPSTA2                                              250998
021430200529     C           *LIKE     DEFN TSWTAC    WEWTA                                               232543
021440200529     C           *LIKE     DEFN TSACOD    KACDE                                               232543
021450200529     C           *LIKE     DEFN HISD      WCDAT                                               CER048
021460200529     C           *LIKE     DEFN SHISB     WHISB                                               CER048
021470200529     C           *LIKE     DEFN RUND      ZIBEG                                               CER048
021480200529     C           *LIKE     DEFN RUND      ZIEND                                               CER048
021490200529     C           *LIKE     DEFN RUND      ZIBW1                                               CER048
021500200529     C           *LIKE     DEFN CRCB      ZICALC                                              CER048
021510200529     C           *LIKE     DEFN RUND      ZIDREM                                              CER048
021520200529     C           *LIKE     DEFN CICT      ZIMAN                                               CER048
021530200529     C           *LIKE     DEFN CICT      ZIDW1                                               CER048
021540200529     C           *LIKE     DEFN RUND      ZIDW2                                               CER048
021550200529     C           *LIKE     DEFN RUND      ZID1                                                CER048
021560200529     C           *LIKE     DEFN RUND      ZID2                                                CER048
021570200529     C           *LIKE     DEFN RUND      ZILPCP                                              CER048
021580200529     C           *LIKE     DEFN TSSTAC    WSTAC                                               CER048
021590200529     C           *LIKE     DEFN FACT      ZIFY2                                               CER048
021600200529     C           *LIKE     DEFN CICT      ZIM1                                                CER048
021610200529     C           *LIKE     DEFN FACT      ZIM2                                                CER048
021620200529     C           *LIKE     DEFN FACT      ZINOM                                               CER048
021630200529     C           *LIKE     DEFN RUND      ZIREM                                               CER048
021640200529     C           *LIKE     DEFN FACT      ZISY2                                               CER048
021650200529     C           *LIKE     DEFN CICT      ZIY1                                                CER048
021660200529     C           *LIKE     DEFN ACOD      ZLYCHK                                              CER048
021670200529     C           *LIKE     DEFN ACSQ      ZLYREM                                              CER048
021680200529     C           *LIKE     DEFN LCID      WSEDAT                                              CER048
021690200529      *                                                                                     CRE083BK
021700200529     C                     Z-ADD300       ARRSZ   30                                        CRE083BK
021710200529      *                                                                                     CRE083BK
021720200529     C                     Z-ADD0         LEASTE 130                                        CRE083BK
021730200529     C           *LIKE     DEFN LEASTE    RCSQ                                              CRE083BK
021740200529      *                                                                                     CRE083BK
021750200529     C                     Z-ADDARRSZ     TIDX    40                                        CRE083BK
021760200529     C           *LIKE     DEFN TIDX      PIDX                                              CRE083BK
021770200529     C           *LIKE     DEFN TIDX      E                                                 CRE083BK
021780200529     C           *LIKE     DEFN ACOD      KEYACD                                            CRE083BK
021790200529     C           *LIKE     DEFN DBASE     WDBASE                                            CRE083BK
021800200529     C                     MOVE *BLANKS   ACDALP 10                                         CRE083BK
021810200529      *                                                                                     CRE083BK
021820200529     C                     MOVE *BLANK    ACFIC   1                                         CRE083BK
021830200529     C*                    MOVE *BLANKS   KEYACD                                            CRE083BK
021840200529     C                     Z-ADDARRSZ     PIDX                                              CRE083BK
021850200529     C                     Z-ADDARRSZ     E                                                 CRE083BK
021860200529      *                                                                                     CRE083BK
021870200529     C           *LIKE     DEFN EWPARL    WLEVEL                                              CER048
021880200529     C           *LIKE     DEFN TSTTAC    WTTAC                                               CER054
021890200529     C           *LIKE     DEFN TRAT      SVTRAT                                            AR831847
021900200529     C           *LIKE     DEFN CAIC1     SVRCIC                                            AR831847
021910200529     C           *LIKE     DEFN CAIC      SVCAIC                                            AR831847
021920200529     C           *LIKE     DEFN CDP       WLCDP                                               CGL165
021930200529     C           *LIKE     DEFN SPOT      WLSPOT                                              CGL165
021940200529     C           *LIKE     DEFN MDIN      WLMDIN                                              CGL165
021950200529     C           *LIKE     DEFN TACC      WLTACC                                              CGL165
021960200529     C           *LIKE     DEFN A5ACTY    WLTACT                                              CGL165
021970200529     C           *LIKE     DEFN TXCR      WBTXCR                                              CGL165
021980200529     C           *LIKE     DEFN TXCR      WLTXCR                                              CGL165
021990200529     C           *LIKE     DEFN TXCR      WOTXCR                                              CGL165
022000200529     C/COPY WNCPYSRC,RE3664C038
022010200529     C*
022020200529     C/EJECT
022030200529     C*===================================================================
022040200529     C** P R O G R A M     S T A R T
022050200529     C*===================================================================
022060200529     C*                                                                   CCB003
022070200529     C           *ENTRY    PLIST                                          CCB003
022080200529     C                     PARM           RSTART  1        Restart if Y   CCB003
022090200529      *                                                                                       CGL020
022100200529      ** This is just a Dummy access. This will never be executed by                          CGL020
022110200529      ** the program                                                                          CGL020
022120200529      *                                                                                       CGL020
022130200529     C           *INLR     IFEQ '0'                                                           CGL020
022140200529     C           *INLR     ANDEQ'1'                                                           CGL020
022150200529     C                     READ APOSTPDF                 LR                                   CGL020
022160200529     C                     ENDIF                                                              CGL020
022170200529      *                                                                   CCB003
022180200529     C*
022190200529     C** FIRST CYCLE PROCESSING
022200200529     C*
022210200529     C           NFIRST    IFEQ ' '                                                         CRE083BE
022220200529     C                     EXSR FIRST
022230200529     C                     MOVE 'Y'       NFIRST  1                                         CRE083BE
022240200529     C                     ENDIF                                                            CRE083BE
022250200529      *                                                                                     CRE083BE
022260200529     C                     MOVE 'N'       FCOMIT  1                                         MD022410
022270200529     C           CDL013    IFEQ '1'                                                         CRE083BE
022280200529      *                                                                                     CRE083BE
022290200529      ** Open & access WHT ICD extension file to retrieve WHT rate                          CRE083BE
022300200529      *                                                                                     CRE083BE
022310200529     C                     OPEN SDSTAAL1                                                    CRE083BE
022320200529     C           WTYPE     CHAINSDSTAAL1             40                                     CRE083BE
022330200529      *                                                                                     CRE083BE
022340200529      ** If CHAIN failed, terminate the program                                             CRE083BE
022350200529      *                                                                                     CRE083BE
022360200529     C           *IN40     IFEQ *ON                                                         CRE083BE
022370200529     C           *LOCK     IN   LDA                                                         CRE083BE
022380200529     C                     MOVEL'SDSTAAL1'DBFILE                                            CRE083BE
022390200529     C                     MOVELWTYPE     DBKEY                                             CRE083BE
022400200529     C                     Z-ADD141       DBASE                                             CRE083BE
022410200529     C                     OUT  LDA                                                         CRE083BE
022420200529     C                     EXSR *PSSR                                                       CRE083BE
022430200529     C                     ENDIF                                                            CRE083BE
022440200529      *                                                                                     CRE083BE
022450200529      ** Open WHT Customer History file, Retail WHT Extract file,                           CRE083BE
022460200529      ** Account Details Extension file & Account Code Extension file.                      CRE083BE
022470200529     C                     OPEN GLWHTCL0                                                    CRE083BE
022480200529     C                     OPEN GLXTAXL0                                                    CRE083BE
022490200529     C                     OPEN ACCNTBY0                                                    CRE083BE
022500200529     C                     OPEN SDACOAL0                                                    CRE083BE
022510200529      *                                                                                     CRE083BE
022520200529     C                     ENDIF                                                            CRE083BE
022530200529      *                                                                                     CRE083BE
022540200529      ** Initialize work fields                                                             CRE083BE
022550200529      *                                                                                     CRE083BE
022560200529     C                     MOVE *BLANKS   ZZ001                                             CRE083BE
022570200529     C                     MOVE *BLANKS   ZZ006                                             CRE083BE
022580200529     C                     MOVE *BLANKS   ZZ009                                             CRE083BE
022590200529     C                     MOVE *BLANKS   SWCR                                              CRE083BE
022600200529     C                     MOVE *BLANKS   DLREF                                             CRE083BE
022610200529     C                     MOVE *BLANKS   REBI                                              CRE083BE
022620200529     C                     MOVE *BLANKS   FACO                                              CRE083BE
022630200529     C                     MOVE *BLANKS   PREF                                              CRE083BE
022640200529     C                     MOVE 'D'       ENDK                                              CRE083BE
022650200529     C                     Z-ADD*ZEROS    NBRREC  50                                        CRE083BE
022660200529     C                     MOVE *BLANKS   DBCNUM                                            CRE083BE
022670200529     C                     Z-ADD*ZEROS    CHGA                                              CRE083BE
022680200529     C                     Z-ADD*ZEROS    DRIP                                              CRE083BE
022690200529     C                     Z-ADD*ZEROS    CRIP                                              CRE083BE
022700200529     C                     MOVEL'91060'   OTTP                                              CRE083BE
022710200529      *                                                                                     CRE083BE
022720200529     C           CRE008    IFEQ 'Y'                                                         CRE083BE
022730200529     C                     OPEN REGAHLJ2                                                    CRE083BE
022740200529     C                     OPEN REZSHLJ2                                                    CRE083BE
022750200529     C                     OPEN RECIEUL2                                                    CRE083BE
022760200529     C                     ENDIF                                                            CRE083BE
022770200529      *                                                                                     CRE083BE
022780200529     C                     OPEN REINTCPD                                                    CRE083BE
022790200529      *                                                                                     CRE083BE
022800200529      ** Read END key from REINTCPD                                                         CRE083BE
022810200529      *                                                                                     CRE083BE
022820200529     C                     MOVE 'Z'       IXCKEY  1                                         CRE083BE
022830200529     C           IXCKEY    CHAINREINTCPD             38                                     CRE083BE
022840200529     C           *IN38     IFEQ *OFF                                                        CRE083BE
022850200529     C                     MOVE NLGID     JLGID                                             CRE083BE
022860200529     C                     MOVE NBRCA     JBRCA                                             CRE083BE
022870200529     C                     MOVE NCNUM     JCNUM                                             CRE083BE
022880200529     C                     MOVE NCCY      JCCY                                              CRE083BE
022890200529     C                     MOVE NACOD     JACOD                                             CRE083BE
022900200529     C                     MOVE NACSQ     JACSQ                                             CRE083BE
022910200529     C                     ENDIF                                                            CRE083BE
022920200529      *                                                                                     CRE083BE
022930200529      ** Read START key from REINTCPD                                                       CRE083BE
022940200529      *                                                                                     CRE083BE
022950200529     C           *IN38     IFEQ *OFF                                                        CRE083BE
022960200529     C                     MOVE 'A'       IXCKEY                                            CRE083BE
022970200529     C           IXCKEY    CHAINREINTCPD             38                                     CRE083BE
022980200529     C                     ENDIF                                                            CRE083BE
022990200529      *                                                                                     CRE083BE
023000200529     C           *IN38     IFEQ *ON                                                         CRE083BE
023010200529     C                     EXSR *PSSR                                                       CRE083BE
023020200529     C                     ENDIF                                                            CRE083BE
023030200529      *                                                                                     CRE083BE
023040200529      ** Set pointer to the first record.                                                   CRE083BE
023050200529      *                                                                                     CRE083BE
023060200529     C                     MOVE NLGID     YLGID                                             CRE083BE
023070200529     C                     MOVE NBRCA     YBRCA                                             CRE083BE
023080200529     C                     MOVE NCNUM     YCNUM                                             CRE083BE
023090200529     C                     MOVE NCCY      YCCY                                              CRE083BE
023100200529     C                     MOVE NACOD     YACOD                                             CRE083BE
023110200529     C                     MOVE NACSQ     YACSQ                                             CRE083BE
023120200529     C                     MOVE *OFF      *IN19                                             CRE083BE
023130200529      *                                                                                     CRE083BE
023140200529     C           NXTKEY    IFGT ENDKEY                                                      CRE083BE
023150200529     C           NXTKEY    OREQ ENDKEY                                                      CRE083BE
023160200529     C           PROT      ANDEQ'C'                                                         CRE083BE
023170200529     C                     MOVE *ON       *IN19                                             CRE083BE
023180200529     C                     ENDIF                                                            CRE083BE
023190200529      *                                                                                     CRE083BE
023200200529     C           *IN19     IFEQ *OFF                                                        CRE083BE
023210200529      *                                                                                     CRE083BE
023220200529     C           PROT      IFEQ ' '                                                         CRE083BE
023230200529     C           REHKEY    SETLLREHISBC                                                     CRE083BE
023240200529     C                     ELSE                                                             CRE083BE
023250200529     C           REHKEY    SETGTREHISBC                                                     CRE083BE
023260200529     C                     ENDIF                                                            CRE083BE
023270200529      *
023280200529     C*
023290200529     C** MAIN PROCESSING
023300200529     C*
023310200529     C***********          MOVE *ZERO     RKEY                            CCB003
023320200529     C***********          MOVE *BLANK    LGID                            CCB003
023330200529     C***********          MOVE *BLANK    BCCY                            CCB003
023340200529     C                     MOVE BBRCA     ZBRCA   3                       076557
023350200529     C***********          Z-ADD99        DBASE                           CRE002
023360200529     C                     Z-ADD001       DBASE            * DB ERROR 001*CRE002
023370200529     C*
023380200529     C                     MOVE *BLANKS   CCY#    3
023390200529     C                     MOVE *BLANKS   BRCA#   3
023400200529     C***********          MOVE *BLANKS   BBRCA                    071053 CCB003
023410200529     C*
023420200529     C***********R1KEY     SETLLREHISBC                                   CCB003
023430200529     C*
023440200529     C***********          Z-ADD98        DBASE                           CRE002
023450200529     C                     Z-ADD002       DBASE            * DB ERROR 002 CRE002
023460200529     C***********          READ REHISBC                  LR               CCB003
023470200529     C**********           READ REINTCPD                 LR                          CCB003 CRE083BE
023480200529     C                     READ REHISBC                  19                                 CRE083BE
023490200529     C                     ENDIF                                                            CRE083BE
023500200529     C*
023510200529     C* DEFINE IF ACCOUNT IS SECONDARY
023520200529     C*
023530200529     C                     SETOF                         50
023540200529     C********** ACKEY     SETLLRELINKL1                 50                                   CGL029
023550200529     C           ACKEY2    SETLLRELINKL1                 50                                   CGL029
023560200529     C/COPY WNCPYSRC,RE3664C039
023570200529     C                     MOVE ' '       BADTY
023580200529     C* SET NARRATIVE WNARS
023590200529     C                     MOVE BCNUM     XCNUM
023600200529     C                     MOVE BCCY      XCCY
023610200529     C                     MOVE BACOD     XACOD
023620200529     C                     MOVE BACSQ     XACSQ
023630200529     C                     MOVE BBRCA     XBRCA                           LN0120
023640200529     C                     MOVE BCNUM     ASOC                            080978
023650200529     C*
023660200529     C********** *INLR     DOWEQ'0'                        - B1                             CRE083BE
023670200529     C           *IN19     DOWEQ*OFF                                                        CRE083BE
023680200529     C/COPY WNCPYSRC,RE3664C018
023690200529     C                     SETOF                     41
023700200529     C*
023710200529     C** MULTIBRANCHING PROCESSING
023720200529     C*
023730200529     C           BBRCA     IFNE BRCA#
023740200529      *                                                                   CCB003
023750200529     C************IN87     IFEQ '1'                                       CCB003
023760200529     C***********                                                   085762CCB003
023770200529     C***IF*THERE*ARE*NO*DETAILS*FOR*THIS*BRANCH,*WRITE*NODET*FORMAT085762CCB003
023780200529     C************IN43     IFEQ '0'                                 085762CCB003
023790200529     C***********          WRITENODET                               085762CCB003
023800200529     C***********          END                                      085762CCB003
023810200529     C***********          WRITEENDP1                                     CCB003
023820200529     C***********          SETOF                     87                   CCB003
023830200529     C***********          END                                            CCB003
023840200529     C/COPY WNCPYSRC,RE3664C001
023850200529      *                                                                   CCB003
023860200529     C                     MOVE BBRCA     BRCA#
023870200529      *                                                                   CCB003
023880200529     C*********            CLOSERE3664P1                                  CCB003
023890200529     C*********            OPEN RE3664P1                                  CCB003
023900200529     C***********          SETON                     87                   CCB003
023910200529     C*********            Z-ADD0         PAGE                            081545
023920200529     C***********                                                         CCB003
023930200529     C***Ensure*Report*Spool*File*Recorded*by*RCF                         CCB003
023940200529     C***********                                                         CCB003
023950200529     C***********          Z-ADDSFNUM     ZSNUM   60                      CCB003
023960200529     C***********          CALL 'ZSFILE'                                  CCB003
023970200529     C***********          PARM *BLANKS   @SEQ    5                       CCB003
023980200529     C***********          PARM BBRCA     SENTY   3                       CCB003
023990200529     C***********          PARM           SFILE                           CCB003
024000200529     C***********          PARM           ZSNUM                           CCB003
024010200529     C***********          PARM *BLANKS   ZSERR   1                       CCB003
024020200529     C***********                                                         CCB003
024030200529     C***Error*During*ZSFILE*Processing,*Return*to*Calling*Program        CCB003
024040200529     C***********                                                         CCB003
024050200529     C***********ZSERR     IFEQ 'Y'                                       CCB003
024060200529     C***********          MOVE '1'       *INU7                           CCB003
024070200529     C***********          MOVE '1'       *INU8                           CCB003
024080200529     C***********          MOVE '1'       *INLR                           CCB003
024090200529     C************LOCK     IN   LDA                                       CCB003
024100200529     C***********          MOVEL'ZSFILE  'DBFILE           ***************CCB003
024110200529     C***********          MOVELBBRCA     DBKEY            * DB ERROR 35 *CCB003
024120200529     C***********          Z-ADD35        DBASE            ***************CCB003
024130200529     C***********          OUT  LDA                                       CCB003
024140200529     C***********          WRITEERRP1                                     CCB003
024150200529     C***********          EXSR *PSSR                                     CCB003
024160200529     C***********          RETRN                                          CCB003
024170200529     C***********          END                                            CCB003
024180200529     C*
024190200529     C** Retrieve Branch Name
024200200529     C*
024210200529     C                     Z-ADDCUBRCA    C                                                 CRE083BK
024220200529     C           BBRCA     LOKUPABRC,C                   16                                 CRE083BK
024230200529      *                                                                                     CRE083BK
024240200529     C           *IN16     IFEQ '1'                                                         CRE083BK
024250200529     C           C         OCUR SDBRCH                                                      CRE083BK
024260200529     C                     ELSE                                                             CRE083BK
024270200529     C**********           CALL 'AOBRCHR0'                                                    CGL029
024280200529     C           1         OCUR SDBRCH                                                      MD021155
024290200529     C                     CALL 'AOBRCHR1'                                                    CGL029
024300200529     C                     PARM '*MSG   ' @RTCD
024310200529     C                     PARM '*KEY   ' @OPTN
024320200529     C                     PARM BBRCA     @BRCA   3
024330200529     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
024340200529     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
024350200529     C           @RTCD     IFNE *BLANK
024360200529     C           *LOCK     IN   LDA
024370200529     C                     MOVEL'SDBRCHPD'DBFILE           ***************
024380200529     C***********          MOVEL@BRCA     DBKEY            * DB ERROR 2  *CRE002
024390200529     C***********          Z-ADD2         DBASE            ***************CRE002
024400200529     C                     MOVEL@BRCA     DBKEY            * DB ERROR 004*CRE002
024410200529     C                     Z-ADD004       DBASE            ***************CRE002
024420200529     C                     OUT  LDA
024430200529     C                     MOVE '1'       *INLR
024440200529     C                     MOVE '1'       *INU7
024450200529     C                     MOVE '1'       *INU8
024460200529     C***********          WRITEERRP1                                     CCB003
024470200529     C                     EXSR *PSSR
024480200529     C                     END
024490200529     C                     ENDIF                                                            CRE083BK
024500200529     C*
024510200529     C***********          WRITEHEADP1                                    CCB003
024520200529     C/COPY WNCPYSRC,RE3664C002
024530200529     C                     END
024540200529     C*
024550200529     C/COPY WNCPYSRC,RE3664C201
024560200529     C                     EXSR MAIN
024570200529     C/COPY WNCPYSRC,RE3664C202
024580200529     C***********          Z-ADD97        DBASE                           CRE002
024590200529     C                     Z-ADD005       DBASE            * DB ERROR 005*CRE002
024600200529      *                                                                   CCB003
024610200529      ** Increase number of records processed                             CCB003
024620200529     C                     ADD  1         #COMIT                          CCB003
024630200529      ***************************************************************                CCB003 CRE083BE
024640200529      ***Delete*record*from*driving*file*****************************                CCB003 CRE083BE
024650200529     C**********           DELETREHISPPF                                             CCB003 CRE083BE
024660200529      *                                                                   CCB003
024670200529      ** Comit if restart status = 'Y' or number of records processed     CCB003
024680200529      ** has reached optimum defined in CBTASKSP                          CCB003
024690200529      *
024700200529     C                     MOVE BLGID     YLGID                                             CRE083BE
024710200529     C                     MOVE BBRCA     YBRCA                                             CRE083BE
024720200529     C                     MOVE BCNUM     YCNUM                                             CRE083BE
024730200529     C                     MOVE BCCY      YCCY                                              CRE083BE
024740200529     C                     MOVE BACOD     YACOD                                             CRE083BE
024750200529     C                     MOVE BACSQ     YACSQ                                             CRE083BE
024760200529     C                     MOVE NXTKEY    LSTKEY                                            CRE083BE
024770200529      *
024780200529     C           RSTART    IFEQ 'Y'                                       CCB003
024790200529     C           #COMIT    OREQ #OPTIM                                    CCB003
024800200529     C           FCOMIT    OREQ 'Y'                                                         MD022410
024810200529     C                     EXSR UPDPTR                                                      CRE083BE
024820200529     C                     COMIT                                          CCB003
024830200529     C                     MOVE 'N'       FCOMIT                                            MD022410
024840200529     C                     Z-ADD0         #COMIT                          CCB003
024850200529     C                     ENDIF                                          CCB003
024860200529      *                                                                   CCB003
024870200529     C***********          READ REHISBC                  LR               CCB003
024880200529     C**********           READ REINTCPD                 LR                          CCB003 CRE083BE
024890200529     C                     READ REHISBC                  19                                 CRE083BE
024900200529      *                                                                                     CRE083BE
024910200529      ** Check if end record is read.                                                       CRE083BE
024920200529      **                                                                                    CRE083BE
024930200529     C           *IN19     IFEQ *OFF                                                        CRE083BE
024940200529     C                     MOVE BLGID     YLGID                                             CRE083BE
024950200529     C                     MOVE BBRCA     YBRCA                                             CRE083BE
024960200529     C                     MOVE BCNUM     YCNUM                                             CRE083BE
024970200529     C                     MOVE BCCY      YCCY                                              CRE083BE
024980200529     C                     MOVE BACOD     YACOD                                             CRE083BE
024990200529     C                     MOVE BACSQ     YACSQ                                             CRE083BE
025000200529      *                                                                                     CRE083BE
025010200529     C           NXTKEY    IFGT ENDKEY                                                      CRE083BE
025020200529     C                     MOVE *ON       *IN19                                             CRE083BE
025030200529     C                     ENDIF                                                            CRE083BE
025040200529      *                                                                                     CRE083BE
025050200529     C                     ENDIF                                                            CRE083BE
025060200529      *                                                                                     CRE083BE
025070200529     C           *IN19     IFEQ *ON                                                         CRE083BE
025080200529     C                     MOVE LSTKEY    NXTKEY                                            CRE083BE
025090200529     C                     ENDIF                                                            CRE083BE
025100200529      *                                                                   CCB003
025110200529      ** Comit if no records left in driving file and number of           CCB003
025120200529      ** records processed is not 0                                       CCB003
025130200529     C********** *INLR     IFEQ '1'                                                  CCB003 CRE083BE
025140200529     C           *IN19     IFEQ *ON                                                         CRE083BE
025150200529     C           #COMIT    ANDGT0                                         CCB003
025160200529     C                     EXSR UPDPTR                                                      CRE083BE
025170200529     C                     COMIT                                          CCB003
025180200529     C/COPY WNCPYSRC,RE3664C003
025190200529     C                     ENDIF                                          CCB003
025200200529      *                                                                   CCB003
025210200529     C                     SETOF                         50
025220200529     C********** ACKEY     SETLLRELINKL1                 50                                   CGL029
025230200529     C           ACKEY2    SETLLRELINKL1                 50                                   CGL029
025240200529     C/COPY WNCPYSRC,RE3664C040
025250200529     C                     MOVE ' '       BADTY
025260200529     C* SET NARRATIVE WNARS
025270200529     C                     MOVE BCNUM     XCNUM
025280200529     C                     MOVE BCCY      XCCY
025290200529     C                     MOVE BACOD     XACOD
025300200529     C                     MOVE BACSQ     XACSQ
025310200529     C                     MOVE BBRCA     XBRCA                           LN0120
025320200529     C                     MOVE BCNUM     ASOC                            080978
025330200529     C                     END                             - E1
025340200529     C*
025350200529     C***********          WRITETOTALS                                    CCB003
025360200529     C***********                                                         CCB003
025370200529     C***DO*NOT*PRODUCE*REPORT*FOR*BRANCH*000*IF*REHISBC*EMPTY      085762CCB003
025380200529     C****PRINT*'NO*DETAILS*TO*REPORT'*IF*FILE*REHISBC*IS*EMPTY***        085762
025390200529     C************                                                        085762
025400200529     C************IN41     IFEQ '1'                                       085762
025410200529     C************         OPEN RE3664P1                                  085762
025420200529     C************         MOVE ZBRCA     BRCA#                     076557085762
025430200529     C************         WRITEHEADP1                                    085762
025440200529     C************         WRITENODET                                     085762
025450200529     C************         CLOSERE3664P1                                  085762
025460200529     C************         END                                            085762
025470200529     C***********                                                         CCB003
025480200529     C****PRINT*'END OF BRANCH' NARRATIVE AT END OF PROGRAM ALSO          CCB003
025490200529     C***********                                                         CCB003
025500200529     C************IN87     IFEQ '1'                                       CCB003
025510200529     C***********          WRITEENDP1                                     CCB003
025520200529     C***********          END                                            CCB003
025530200529     C***********                                                         CCB003
025540200529     C***********          COMIT                                          CCB003
025550200529      *                                                                                     CRE083BE
025560200529      ** Release record lock and close file.                                                CRE083BE
025570200529      *                                                                                     CRE083BE
025580200529     C                     UNLCKACCNTX                                                      CRE083BE
025590200529     C                     UNLCKREHISBC                                                     CRE083BE
025600200529     C                     UNLCKREINTCPD                                                    CRE083BE
025610200529     C                     UNLCKREHISBL                                                     CRE083BE
025620200529     C                     UNLCKREHISL                                                      CRE083BE
025630200529     C                     UNLCKREHISSL                                                     CRE083BE
025640200529     C                     UNLCKACCNT                                                       CRE083BE
025650200529     C                     UNLCKREACR                                                       CRE083BE
025660200529     C                     UNLCKREIAC                                                       CRE083BE
025670200529     C                     UNLCKREINTCPA                                                    CRE083BE
025680200529     C                     UNLCKGLWHTCL0                                                    CRE083BE
025690200529     C                     UNLCKGEICPD                                                      CRE083BE
025700200529     C                     UNLCKREINCXPD                                                    CRE083BE
025710200529     C                     UNLCKSDINPHL2                                                    CRE083BE
025720200529     C                     UNLCKSDCSINLJ                                                    CRE083BE
025730200529      *                                                                                     CRE083BE
025740200529     C           CDL013    IFEQ '1'                                                         CRE083BE
025750200529     C                     CLOSESDSTAAL1                                                    CRE083BE
025760200529     C                     CLOSEGLWHTCL0                                                    CRE083BE
025770200529     C                     CLOSEGLXTAXL0                                                    CRE083BE
025780200529     C                     CLOSEACCNTBY0                                                    CRE083BE
025790200529     C                     CLOSESDACOAL0                                                    CRE083BE
025800200529     C                     ENDIF                                                            CRE083BE
025810200529      *                                                                                     CRE083BE
025820200529     C           CRE008    IFEQ 'Y'                                                         CRE083BE
025830200529     C                     CLOSEREGAHLJ2                                                    CRE083BE
025840200529     C                     CLOSEREZSHLJ2                                                    CRE083BE
025850200529     C                     CLOSERECIEUL2                                                    CRE083BE
025860200529     C                     ENDIF                                                            CRE083BE
025870200529      *                                                                                     CRE083BE
025880200529     C                     CLOSEREINTCPD                                                    CRE083BE
025890200529      *                                                                                     CRE083BE
025900200529     C                     RETRN                                                            CRE083BE
025910200529     C*
025920200529     C*===================================================================
025930200529     C** P R O G R A M     E N D
025940200529     C*===================================================================
025950200529     C/EJECT
025960200529     C********************************************************************
025970200529     C**
025980200529     C** ACCPR subroutine to execute account processing
025990200529     C**
026000200529     C**     Called by       CREPR,DEBPR
026010200529     C**     Calls           GEICPR
026020200529     C**
026030200529      *****************************************************************   CCB003
026040200529     C           ACCPR     BEGSR                           **ACCPR BEGSR**
026050200529     C*
026060200529     C**********           Z-ADDBCNUM     CNUM                                                CSD027
026070200529     C                     MOVE BCNUM     CNUM                                                CSD027
026080200529     C                     MOVE BCCY      CCY
026090200529     C                     Z-ADDBACOD     ACOD
026100200529     C/COPY WNCPYSRC,RE3664C089
026110200529     C                     Z-ADDBACSQ     ACSQ
026120200529     C                     MOVE BBRCA     BRCA
026130200529     C                     MOVE WACNO     ACNO
026140200529     C                     Z-ADDSHISD     VALD
026150200529     C                     Z-ADDSHISD     HISD
026160200529     C                     MOVE '1'       RIND
026170200529     C                     MOVE 'R'       ATYP
026180200529     C***********          Z-ADD*ZEROS    ASOC                            080978
026190200529     C                     EXSR SUBNAR
026200200529     C                     MOVE NARS      PNAR
026210200529     C*
026220200529     C                     EXSR TAXSR
026230200529      *                                                                                       250998
026240200529     C           VALD      IFGT PSTD                                                          250998
026250200529     C           VALD      ANDLTDNWD                                                          250998
026260200529     C           TRAT      ANDEQ91060                                                         250998
026270200529     C           CHGT      ANDNE0                                                             250998
026280200529     C                     EXSR DETPR                                                         250998
026290200529     C                     ENDIF                                                              250998
026300200529      *                                                                   130468
026310200529      * Accumulate CR interest/adj. amount for calculation of BRT         130468
026320200529     C           S01383    IFEQ 'Y'                                       130468
026330200529     C           WDRCR     ANDEQ'1'                                       130468
026340200529     C                     SUB  WPSTA     @WCAIC                          130468
026350200529     C                     END                                            130468
026360200529     C*
026370200529     C** GEICPD FILE PROCESSING
026380200529     C*
026390200529     C                     EXSR GEICPR
026400200529     C/COPY WNCPYSRC,RE3664C196
026410200529     C*
026420200529     C           VALD      IFLE NAPDA                      - B1
026430200529     C           *IN50     ANDEQ'0'
026440200529     C/COPY WNCPYSRC,RE3664C041
026450200529     C*
026460200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
026470200529     C*
026480200529     C***********          Z-ADD28        DBASE                           CRE002
026490200529     C                     Z-ADD006       DBASE            * DB ERROR 006*CRE002
026500200529     C                     MOVE 'N'       REACT                           CCB003
026510200529     C           WCHGA     IFNE 0                                                             250998
026520200529     C                     Z-ADDWCHGA     CHGA                                                250998
026530200529     C                     END                                                                250998
026540200529     C                     WRITEREHPOSPF
026550200529     C                     Z-ADD0         CHGA                                                250998
026560200529     C/COPY WNCPYSRC,RE3664C197
026570200529     C                     Z-ADD*ZEROS    DBASE
026580200529     C*
026590200529     C** ACCESS POSITION RECORD FOR UPDATE OR ADD THEN UPDATE HEADER FIELDS
026600200529     C*
026610200529     C***********          Z-ADD88        DBASE                           CRE002
026620200529     C                     Z-ADD007       DBASE            * DB ERROR 007*CRE002
026630200529     C*
026640200529     C***********          MOVE 'Y'       @REL    1                       NNN
026650200529     C***********          EXCPTHISPD                                     NNN
026660200529     C           R3KEY     CHAINREHISPDF             40
026670200529     C                     Z-ADD*ZEROS    DBASE
026680200529     C           *IN40     IFEQ '1'                        - B1
026690200529     C                     MOVE 'D'       RECI
026700200529     C                     MOVE *BLANK    DLGID
026710200529     C                     Z-ADD*ZERO     VALL
026720200529     C                     MOVE *BLANK    LINK
026730200529     C                     MOVE *BLANK    DICI
026740200529     C                     MOVE *BLANK    CICI
026750200529     C                     MOVE *BLANK    DRCI
026760200529     C                     MOVE *BLANK    CRCI
026770200529     C                     MOVE *BLANK    ALTI
026780200529     C                     Z-ADD*ZERO     DRIR
026790200529     C                     Z-ADD*ZERO     CRIR
026800200529     C                     Z-ADD*ZERO     PDID
026810200529     C                     Z-ADD*ZERO     PCID
026820200529     C                     Z-ADD*ZERO     DICT
026830200529     C                     Z-ADD*ZERO     CICT
026840200529     C                     Z-ADD*ZERO     DRCB
026850200529     C                     Z-ADD*ZERO     CRCB
026860200529     C                     MOVE *BLANK    ADTY
026870200529     C                     Z-ADD*ZERO     MNBL
026880200529     C                     Z-ADD*ZERO     CHGAR
026890200529     C                     Z-ADD*ZERO     TCHGAR
026900200529     C                     Z-ADD*ZERO     CHGAN
026910200529     C                     Z-ADD*ZERO     TCHGAN
026920200529     C           WCHGA     IFNE 0                                                             250998
026930200529     C           REBID     IFEQ 'Y'                                                           250998
026940200529     C                     Z-ADDWCHGA     CHGAR                                               250998
026950200529     C                     Z-ADDWCHGA     TCHGAR                                              250998
026960200529     C                     ELSE                                                               250998
026970200529     C                     Z-ADDWCHGA     CHGAN                                               250998
026980200529     C                     Z-ADDWCHGA     TCHGAN                                              250998
026990200529     C                     END                                                                250998
027000200529     C                     END                                                                250998
027010200529     C                     Z-ADD*ZERO     DMVT
027020200529     C                     Z-ADD*ZERO     CMVT
027030200529     C                     Z-ADD*ZERO     DAID
027040200529     C                     Z-ADD*ZERO     MADI
027050200529     C                     Z-ADD*ZERO     TMADI
027060200529     C                     Z-ADD*ZERO     DMINT
027070200529     C                     Z-ADD*ZERO     CAID
027080200529     C                     Z-ADD*ZERO     MACI
027090200529     C                     Z-ADD*ZERO     TMACI
027100200529     C                     Z-ADD*ZERO     CMINT
027110200529     C                     Z-ADD*ZERO     MNBCP
027120200529     C                     Z-ADD*ZERO     DRCD
027130200529     C                     Z-ADD*ZERO     CRCD
027140200529     C                     Z-ADD*ZERO     VDTC
027150200529     C           DRCR      IFEQ 1                          - B2
027160200529     C                     Z-ADDPSTA      CMVT
027170200529     C                     ELSE                            - X2
027180200529     C                     Z-ADDPSTA      DMVT
027190200529     C                     END                             - E2
027200200529     C/COPY WNCPYSRC,RE3664C209
027210200529     C           SHISB     ADD  DMVT      HISB
027220200529     C                     SUB  CMVT      HISB
027230200529     C                     Z-ADD*ZERO     AODR                            CRE002
027240200529     C                     Z-ADD*ZERO     ODRL                            CRE002
027250200529     C                     MOVE *BLANK    ODLI                            CRE002
027260200529     C                     Z-ADD*ZERO     ODIA                            CRE002
027270200529     C***********          Z-ADD87        DBASE                           CRE002
027280200529     C                     Z-ADD008       DBASE            * DB ERROR 008*CRE002
027290200529     C                     WRITEREHISPDF
027300200529     C                     Z-ADD*ZEROS    DBASE
027310200529     C                     ELSE                            - X1
027320200529     C           DRCR      IFEQ 1                          - B2
027330200529     C                     ADD  PSTA      CMVT
027340200529     C                     ELSE                            - X2
027350200529     C                     ADD  PSTA      DMVT
027360200529     C                     END                             - E2
027370200529     C********** WDRCR     IFEQ '1'                                                   135809 135809R
027380200529     C********** @CRINT    ANDGT*ZERO                                                 135809 135809R
027390200529     C**********           SUB  @CRINT    HISB                                        135809 135809R
027400200529     C**********           END                                                        135809 135809R
027410200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
027420200529     C           WDRCR     IFEQ '1'                                                         AR978914
027430200529     C           @CRINT    ANDGT*ZERO                                                       AR978914
027440200529     C                     SUB  @CRINT    HISB                                              AR978914
027450200529     C                     END                                                              AR978914
027460200529     C                     ENDIF                                                            MD045460
027470200529     C           WCHGA     IFNE 0                                                             250998
027480200529     C           REBID     IFEQ 'Y'                                                           250998
027490200529     C                     ADD  WCHGA     CHGAR                                               250998
027500200529     C                     ADD  WCHGA     TCHGAR                                              250998
027510200529     C                     ELSE                                                               250998
027520200529     C                     ADD  WCHGA     CHGAN                                               250998
027530200529     C                     ADD  WCHGA     TCHGAN                                              250998
027540200529     C                     END                                                                250998
027550200529     C                     END                                                                250998
027560200529     C/COPY WNCPYSRC,RE3664C137
027570200529     C***********          Z-ADD86        DBASE                           CRE002
027580200529     C                     Z-ADD009       DBASE            * DB ERROR 009*CRE002
027590200529     C                     UPDATREHISPDF
027600200529     C                     MOVE 'Y'       FCOMIT                                            MD022410
027610200529     C                     Z-ADD*ZEROS    DBASE
027620200529     C                     END                             - E1
027630200529     C/COPY WNCPYSRC,RE3664C159
027640200529     C*
027650200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
027660200529     C                     MOVE 'Y'       BADTY
027670200529     C           SHISD     IFLT BVDTC
027680200529     C                     MOVE SHISD     BVDTC
027690200529     C                     END
027700200529     C                     END                             - E1
027710200529      *                                                                                       250998
027720200529     C                     Z-ADD0         WCHGA                                               250998
027730200529     C*
027740200529     C* SET UP NARRATIVE FOR OTHER POSTINGS.
027750200529     C                     ENDSR                           **ACCPR ENDSR**
027760200529     C********************************************************************
027770200529     C/EJECT
027780200529     C********************************************************************
027790200529     C**
027800200529     C** ACCSR subroutine for ACCNT    file exception/error handling
027810200529     C**
027820200529     C**     Called by       Input specifications
027830200529     C**     Calls           *PSSR
027840200529     C**
027850200529      *****************************************************************   CCB003
027860200529     C           ACCSR     BEGSR                           **ACCSR BEGSR**
027870200529     C*
027880200529     C           *LOCK     IN   LDA
027890200529     C***********          MOVE 'ACCNT'   DBFILE           ***************CCB003
027900200529     C                     MOVEL'ACCNT'   DBFILE           ***************CCB003
027910200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
027920200529     C                     MOVELSTSACC    DBSTAT           ***************
027930200529     C                     OUT  LDA
027940200529     C                     MOVEA'11'      *IN,88
027950200529     C                     EXSR *PSSR
027960200529     C*
027970200529     C                     ENDSR                           **ACCSR ENDSR**
027980200529     C********************************************************************
027990200529     C/EJECT
028000200529     C********************************************************************
028010200529     C**
028020200529     C** ACXSR subroutine for ACCNTX   file exception/error handling
028030200529     C**
028040200529     C**     Called by       Input specifications
028050200529     C**     Calls           *PSSR
028060200529     C**
028070200529      *****************************************************************   CCB003
028080200529     C           ACXSR     BEGSR                           **ACXSR BEGSR**
028090200529     C*
028100200529     C           *LOCK     IN   LDA
028110200529     C***********          MOVE 'ACCNTX'  DBFILE           ***************CCB003
028120200529     C                     MOVEL'ACCNTX'  DBFILE           ***************CCB003
028130200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
028140200529     C                     MOVELSTSACX    DBSTAT           ***************
028150200529     C                     OUT  LDA
028160200529     C                     MOVEA'11'      *IN,88
028170200529     C                     EXSR *PSSR
028180200529     C*
028190200529     C                     ENDSR                           **ACXSR ENDSR**
028200200529     C********************************************************************
028210200529     C/EJECT
028220200529     C********************************************************************
028230200529     C**
028240200529     C** ACRSR subroutine for REACR    file exception/error handling
028250200529     C**
028260200529     C**     Called by       Input specifications
028270200529     C**     Calls           *PSSR
028280200529     C**
028290200529      *****************************************************************   CCB003
028300200529     C           ACRSR     BEGSR                           **ACRSR BEGSR**
028310200529     C*
028320200529     C           *LOCK     IN   LDA
028330200529     C***********          MOVE 'REACR'   DBFILE           ***************CCB003
028340200529     C                     MOVEL'REACR'   DBFILE           ***************CCB003
028350200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
028360200529     C                     MOVELSTSACR    DBSTAT           ***************
028370200529     C                     OUT  LDA
028380200529     C                     MOVEA'11'      *IN,88
028390200529     C                     EXSR *PSSR
028400200529     C*
028410200529     C                     ENDSR                           **ACRSR ENDSR**
028420200529     C********************************************************************
028430200529     C/EJECT
028440200529     C********************************************************************
028450200529     C**
028460200529     C** ALTPR subroutine to execute alternate processing
028470200529     C**
028480200529     C**     Called by       CHGPR,CREPR,DEBPR
028490200529     C**     Calls           DCIND,GEICPR,SUSPR,POSPR
028500200529     C**
028510200529      *****************************************************************   CCB003
028520200529     C           ALTPR     BEGSR                           **ALTPR BEGSR**
028530200529      *                                                                   CAC001
028540200529      **  Initially set profit centre to be profit centre of main a/c     CAC001
028550200529      *                                                                   CAC001
028560200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
028570200529     C                     MOVE WMPRFC    PRFC                            CAC001
028580200529     C                     ENDIF                                          CAC001
028590200529     C*
028600200529     C** CHECK ON DEBIT/CREDIT INDICATOR
028610200529     C*
028620200529     C           WDRCR     IFEQ '0'                        - B1
028630200529     C                     MOVELSDACP     WALT
028640200529     C***********          MOVELDRBR      WBRCA                           123519
028650200529     C                     MOVELSDRBR     WBRCA                           123519
028660200529     C                     ELSE                            - X1
028670200529     C           WDRCR     IFEQ '1'                        - B2
028680200529     C                     MOVELSCACP     WALT
028690200529     C***********          MOVELCRBR      WBRCA                           123519
028700200529     C                     MOVELSCRBR     WBRCA                           123519
028710200529     C                     ELSE                            - X2
028720200529     C           WDRCR     IFEQ '2'                        - B3
028730200529     C                     MOVELSCHAC     WALT
028740200529     C***********          MOVELCHBR      WBRCA                           123519
028750200529     C                     MOVELSCHBR     WBRCA                           123519
028760200529     C                     END                             - E3
028770200529     C                     END                             - E2
028780200529     C                     END                             - E1
028790200529     C*
028800200529     C           WALT5     IFEQ *BLANKS                    - B1
028810200529     C*
028820200529     C** CHECK IF RETAIL KEY
028830200529     C*
028840200529     C***********          Z-ADD29        DBASE                           CRE002
028850200529     C                     Z-ADD010       DBASE            * DB ERROR 010*CRE002
028860200529     C           WALT10    CHAINACNUM                99
028870200529     C                     Z-ADD*ZEROS    DBASE
028880200529     C*
028890200529     C** ALTERNATE ACCOUNT NOT FOUND POST TO SUSPENS
028900200529     C*
028910200529     C           *IN99     IFEQ '1'                        - B2
028920200529     C*
028930200529     C** CHECKING DEBIT/CREDIT INDICATOR PROCESSING
028940200529     C*
028950200529     C                     EXSR DCIND
028960200529     C*
028970200529     C** SUSPENSE PROCESSING
028980200529     C*
028990200529     C                     EXSR SUSPR
029000200529     C*
029010200529     C                     ELSE                            - X2
029020200529     C*
029030200529     C** ALTERNATE ACCOUNT CLOSED POST TO SUSPENS
029040200529     C*
029050200529     C           RRRECI    IFNE 'D'                        - B3
029060200529     C*
029070200529     C                     MOVE 'P'       RECI
029080200529     C*********************Z-ADDRCNUM     ASOC                            080978
029090200529     C*
029100200529     C** CHECKING DEBIT/CREDIT INDICATOR PROCESSING
029110200529     C*
029120200529     C                     EXSR DCIND
029130200529     C*
029140200529     C** SUSPENSE PROCESSING
029150200529     C*
029160200529     C                     EXSR SUSPR
029170200529     C*
029180200529     C** RETAIL ACCOUNT FOUND FORMAT KEY
029190200529     C*
029200200529     C                     ELSE                            - X3
029210200529      **If*CR*interest*(not*adjustment)*and*a/c*liable*for*withholding**************  135809 135809R
029220200529      **tax,*save*alt.*a/c*details*and*post*gross*interest*to*main*a/c.*************  135809 135809R
029230200529     C********** WDRCR     IFEQ '1'                                                   135809 135809R
029240200529     C********** ATITAX    ANDEQ'Y'                                                   135809 135809R
029250200529     C********** SHISD     ANDEQCNCID                                                 135809 135809R
029260200529     C/COPY WNCPYSRC,REH00456
029270200529     C**********           Z-ADDCAIC      @CRINT                                      135809 135809R
029280200529     C**********           MOVE RBRCA     @CBRCA                                      135809 135809R
029290200529     C**********           Z-ADDRCNUM     @CCNUM                                       135809 CSD027
029300200529     C**********           MOVE RCNUM     @CCNUM                                      CSD027 135809R
029310200529     C**********           MOVE RCCY      @CCCY                                       135809 135809R
029320200529     C**********           Z-ADDRACOD     @CACOD                                      135809 135809R
029330200529     C**********           Z-ADDRACSQ     @CACSQ                                      135809 135809R
029340200529     C**********           Z-ADDWALT10    @CACNO                                      135809 135809R
029350200529     C**********           MOVE 'R'       @CATYP                                      135809 135809R
029360200529     C**********           MOVE *BLANK    @CPRFC                                      135809 135809R
029370200529     C**********           EXSR ACCPR                                                 135809 135809R
029380200529     C**********           ELSE                                                       135809 135809R
029390200529      *                                                                                     AR978914
029400200529      **  If CR interest (not adjustment) and a/c liable for withholding                    AR978914
029410200529      **  tax, save alt. a/c details and post gross interest to main a/c.                   AR978914
029420200529      *                                                                                     AR978914
029430200529     C                     MOVE ' '       ADJUST  1                                         MD040758
029440200529     C           SHISD     IFLT CNCID                                                       MD040758
029450200529     C           CDL013    ANDEQ'1'                                                         MD040758
029460200529     C                     MOVE 'Y'       ADJUST                                            MD040758
029470200529     C                     ENDIF                                                            MD040758
029480200529     C           WDRCR     IFEQ '1'                                                         AR978914
029490200529     C           ATITAX    ANDEQ'Y'                                                         AR978914
029500200529     C           SHISD     ANDEQCNCID                                                       AR978914
029510200529     C           WWHTAL    ANDEQ'N'                                                         MD045460
029520200529     C           WDRCR     OREQ '1'                                                         MD040758
029530200529     C           ATITAX    ANDNE'0'                                                         MD040758
029540200529     C           SHISD     ANDLECNCID                                                       MD040758
029550200529     C           CDL013    ANDEQ'1'                                                         MD040758
029560200529     C           WWHTAL    ANDEQ'N'                                                         MD054559
029570200529     C                     Z-ADDCAIC      @CRINT                                            AR978914
029580200529     C                     MOVE RBRCA     @CBRCA                                            AR978914
029590200529     C                     MOVE RCNUM     @CCNUM                                            AR978914
029600200529     C                     MOVE RCCY      @CCCY                                             AR978914
029610200529     C                     Z-ADDRACOD     @CACOD                                            AR978914
029620200529     C                     Z-ADDRACSQ     @CACSQ                                            AR978914
029630200529     C                     Z-ADDWALT10    @CACNO                                            AR978914
029640200529     C                     MOVE 'R'       @CATYP                                            AR978914
029650200529     C                     MOVE *BLANK    @CPRFC                                            AR978914
029660200529     C                     EXSR ACCPR                                                       AR978914
029670200529     C                     ELSE                                                             AR978914
029680200529     C*
029690200529     C                     MOVE 'P'       RECI
029700200529     C**********           Z-ADDRCNUM     CNUM                                                CSD027
029710200529     C                     MOVE RCNUM     CNUM                                                CSD027
029720200529     C                     MOVE RCCY      CCY
029730200529     C                     Z-ADDRACOD     ACOD
029740200529     C/COPY WNCPYSRC,RE3664C090
029750200529     C                     Z-ADDWALT10    ACNO
029760200529     C                     Z-ADDSHISD     VALD
029770200529     C                     MOVE '1'       RIND
029780200529     C                     MOVE 'R'       ATYP
029790200529     C                     Z-ADDRACSQ     ACSQ
029800200529     C                     MOVE RBRCA     BRCA
029810200529     C                     EXSR SUBNAR
029820200529     C                     MOVE NARS      PNAR
029830200529      *                                                                   S01408
029840200529     C/COPY WNCPYSRC,RE3664CP33                                           S01408
029850200529      *                                                                   S01408
029860200529     C*
029870200529     C                     EXSR TAXSR
029880200529      *                                                                                       250998
029890200529     C           VALD      IFGT PSTD                                                          250998
029900200529     C           VALD      ANDLTDNWD                                                          250998
029910200529     C           TRAT      ANDEQ91060                                                         250998
029920200529     C                     EXSR DETPR                                                         250998
029930200529     C                     ENDIF                                                              250998
029940200529      *                                                                   CAC001
029950200529      **  If Analytical Accounting installed, get profit centre of        CAC001
029960200529      **  the alternate account                                           CAC001
029970200529      *                                                                   CAC001
029980200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
029990200529     C           WALT10    CHAINREACNMF              99                   CAC001
030000200529     C           *IN99     IFEQ '1'                                       CAC001
030010200529     C           *LOCK     IN   LDA                                       CAC001
030020200529     C                     MOVEL'REACNMPD'DBFILE           ************   CAC001
030030200529     C                     MOVELWALT10    DBKEY            * DBER 201 *   CAC001
030040200529     C                     Z-ADD201       DBASE            ************   CAC001
030050200529     C                     OUT  LDA                                       CAC001
030060200529     C                     EXSR *PSSR                                     CAC001
030070200529     C                     ELSE                                           CAC001
030080200529     C                     MOVE TPRFC     PRFC                            CAC001
030090200529      ** Save for possible need of restore                                                  MD022635
030100200529     C                     MOVE TPRFC     WSVPC                                             MD022635
030110200529     C                     ENDIF                                          CAC001
030120200529     C                     ENDIF                                          CAC001
030130200529      *                                                                   130468
030140200529      * Accumulate CR interest/adj. amount for calculation of BRT.        130468
030150200529     C           S01383    IFEQ 'Y'                                       130468
030160200529     C           WDRCR     ANDEQ'1'                                       130468
030170200529     C                     SUB  WPSTA     @WCAIC                          130468
030180200529     C                     END                                            130468
030190200529     C/COPY WNCPYSRC,RE3664C019
030200200529     C*
030210200529     C** GEICPD FILE PROCESSING
030220200529     C*
030230200529     C           BCCY      IFEQ CCY                        - B4
030240200529     C           BRCA      ANDEQBBRCA
030250200529     C/COPY WNCPYSRC,RE3664C020
030260200529     C*
030270200529     C                     EXSR GEICPR
030280200529     C/COPY WNCPYSRC,RE3664C021
030290200529     C*
030300200529     C           VALD      IFLE NAPDA                      - B5
030310200529     C           *IN50     ANDEQ'0'
030320200529     C/COPY WNCPYSRC,RE3664C042
030330200529     C*
030340200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
030350200529     C*
030360200529     C                     Z-ADDVALD      HISD
030370200529     C***********          Z-ADD30        DBASE                           CRE002
030380200529     C                     Z-ADD011       DBASE            * DB ERROR 011*CRE002
030390200529     C                     MOVE 'N'       REACT                           CCB003
030400200529     C           WCHGA     IFNE 0                                                             250998
030410200529     C                     Z-ADDWCHGA     CHGA                                                250998
030420200529     C                     END                                                                250998
030430200529     C                     WRITEREHPOSPF
030440200529     C                     Z-ADD0         CHGA                                                250998
030450200529     C                     Z-ADD*ZEROS    DBASE
030460200529     C*
030470200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
030480200529     C*
030490200529     C                     EXSR POSPR
030500200529     C/COPY WNCPYSRC,RE3664C210
030510200529     C*
030520200529     C                     END                             - E5
030530200529     C*
030540200529     C/COPY WNCPYSRC,RE3664C022
030550200529     C                     ELSE                            - X4
030560200529     C*
030570200529     C** IF DIFFERENT CURRENCY OR BRANCH PROCESS CROSS POSTING
030580200529     C*
030590200529     C                     EXSR CCYSR
030600200529     C                     END                             - E4
030610200529     C**********           END                                                        135809 135809R
030620200529     C                     END                                                              AR978914
030630200529     C*
030640200529     C                     END                             - E3
030650200529     C*
030660200529     C                     END                             - E2
030670200529     C*
030680200529     C                     ELSE                            - X1
030690200529     C*
030700200529     C** CHECK IF ACCOUNT KEY
030710200529     C*
030720200529     C***********          Z-ADD31        DBASE                           CRE002
030730200529     C                     Z-ADD012       DBASE            * DB ERROR 012*CRE002
030740200529     C           WALTK     CHAINACCNT               N99
030750200529     C                     Z-ADD*ZEROS    DBASE
030760200529     C*
030770200529     C** ALTERNATE ACCOUNT NOT FOUND POST TO SUSPENS
030780200529     C           *IN99     IFEQ '1'                        - B2
030790200529     C*
030800200529     C** CHECKING DEBIT/CREDIT INDICATOR PROCESSING
030810200529     C*
030820200529     C                     EXSR DCIND
030830200529     C*
030840200529     C** SUSPENSE PROCESSING
030850200529     C*
030860200529     C                     EXSR SUSPR
030870200529     C*
030880200529     C                     ELSE                            - X2
030890200529     C*
030900200529     C** ALTERNATE ACCOUNT CLOSED POST TO SUSPENS
030910200529     C*
030920200529     C           AARECI    IFEQ 'D'                        - B3
030930200529      **If*CR*interest*(not*adjustment)*and*a/c*liable*for*withholding*************   135809 135809R
030940200529      **tax,*save*alt.*a/c*details*and*post*gross*interest*to*main*a/c.************   135809 135809R
030950200529     C********** WDRCR     IFEQ '1'                                                   135809 135809R
030960200529     C********** ATITAX    ANDEQ'Y'                                                   135809 135809R
030970200529     C********** SHISD     ANDEQCNCID                                                 135809 135809R
030980200529     C/COPY WNCPYSRC,REH00457
030990200529     C**********           Z-ADDCAIC      @CRINT                                      135809 135809R
031000200529     C**********           MOVE AABRCA    @CBRCA                                      135809 135809R
031010200529     C**********           Z-ADDAACNUM    @CCNUM                                       135809 CSD027
031020200529     C**********           MOVE AACNUM    @CCNUM                                      CSD027 135809R
031030200529     C**********           MOVE AACCY     @CCCY                                       135809 135809R
031040200529     C**********           Z-ADDAAACOD    @CACOD                                      135809 135809R
031050200529     C**********           Z-ADDAAACSQ    @CACSQ                                      135809 135809R
031060200529     C**********           Z-ADDAAACNO    @CACNO                                      135809 135809R
031070200529     C**********           MOVE AAATYP    @CATYP                                      135809 135809R
031080200529     C********** AAATYP    IFEQ 'R'                                                   135809 135809R
031090200529     C********** AAATYP    OREQ 'N'                                                   135809 135809R
031100200529     C**********           MOVE AAPRFC    @CPRFC                                      135809 135809R
031110200529     C**********           ELSE                                                       135809 135809R
031120200529     C**********           MOVE *BLANK    @CPRFC                                      135809 135809R
031130200529     C**********           END                                                        135809 135809R
031140200529     C**********           EXSR ACCPR                                                 135809 135809R
031150200529     C**********           ELSE                                                       135809 135809R
031160200529      *                                                                                     AR978914
031170200529      ** If CR interest (not adjustment) and a/c liable for withholding                     AR978914
031180200529      ** tax, save alt. a/c details and post gross interest to main a/c.                    AR978914
031190200529      *                                                                                     AR978914
031200200529     C           WDRCR     IFEQ '1'                                                         AR978914
031210200529     C           ATITAX    ANDEQ'Y'                                                         AR978914
031220200529     C           SHISD     ANDEQCNCID                                                       AR978914
031230200529     C           WWHTAL    ANDEQ'N'                                                         MD045460
031240200529     C           WDRCR     OREQ '1'                                                         MD040758
031250200529     C           ATITAX    ANDNE'0'                                                         MD040758
031260200529     C           SHISD     ANDEQCNCID                                                       MD040758
031270200529     C           CDL013    ANDEQ'1'                                                         MD040758
031280200529     C           WWHTAL    ANDEQ'N'                                                         MD054559
031290200529     C                     Z-ADDCAIC      @CRINT                                            AR978914
031300200529     C                     MOVE AABRCA    @CBRCA                                            AR978914
031310200529     C                     MOVE AACNUM    @CCNUM                                            AR978914
031320200529     C                     MOVE AACCY     @CCCY                                             AR978914
031330200529     C                     Z-ADDAAACOD    @CACOD                                            AR978914
031340200529     C                     Z-ADDAAACSQ    @CACSQ                                            AR978914
031350200529     C                     Z-ADDAAACNO    @CACNO                                            AR978914
031360200529     C                     MOVE AAATYP    @CATYP                                            AR978914
031370200529     C           AAATYP    IFEQ 'R'                                                         AR978914
031380200529     C           AAATYP    OREQ 'N'                                                         AR978914
031390200529     C                     MOVE AAPRFC    @CPRFC                                            AR978914
031400200529     C                     ELSE                                                             AR978914
031410200529     C                     MOVE *BLANK    @CPRFC                                            AR978914
031420200529     C                     END                                                              AR978914
031430200529     C                     EXSR ACCPR                                                       AR978914
031440200529     C                     ELSE                                                             AR978914
031450200529     C*
031460200529     C                     MOVE 'P'       RECI
031470200529     C**********           Z-ADDAACNUM    CNUM                                                CSD027
031480200529     C                     MOVE AACNUM    CNUM                                                CSD027
031490200529     C                     MOVE AACCY     CCY
031500200529     C                     Z-ADDAAACOD    ACOD
031510200529     C/COPY WNCPYSRC,RE3664C091
031520200529     C                     Z-ADDAAACNO    ACNO
031530200529     C                     Z-ADDSHISD     VALD                            112808
031540200529     C                     MOVE AAATYP    ATYP
031550200529     C                     Z-ADDAAACSQ    ACSQ
031560200529     C*********************MOVE ABRCA     BRCA                            049320
031570200529     C                     MOVE AABRCA    BRCA                            049320
031580200529     C                     EXSR SUBNAR
031590200529     C                     MOVE NARS      PNAR
031600200529      *                                                                   S01408
031610200529     C/COPY WNCPYSRC,RE3664CP34                                           S01408
031620200529      *                                                                   S01408
031630200529     C*
031640200529     C                     EXSR TAXSR
031650200529      *                                                                                       250998
031660200529     C           VALD      IFGT PSTD                                                          250998
031670200529     C           VALD      ANDLTDNWD                                                          250998
031680200529     C           TRAT      ANDEQ91060                                                         250998
031690200529     C                     EXSR DETPR                                                         250998
031700200529     C                     ENDIF                                                              250998
031710200529      *                                                                   CAC001
031720200529      **  If Analytical Accounting installed, get profit centre of        CAC001
031730200529      **  the alternate account if it is retail or nostro                 CAC001
031740200529      *                                                                   CAC001
031750200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
031760200529     C           ATYP      IFEQ 'R'                                       CAC001
031770200529     C           ATYP      OREQ 'N'                                       CAC001
031780200529     C                     MOVE AAPRFC    PRFC                            CAC001
031790200529     C                     ENDIF                                          CAC001
031800200529     C                     ENDIF                                          CAC001
031810200529      *                                                                   130468
031820200529      * Accumulate CR interest/adj. amount for calculation of BRT.        130468
031830200529     C           S01383    IFEQ 'Y'                                       130468
031840200529     C           WDRCR     ANDEQ'1'                                       130468
031850200529     C                     SUB  WPSTA     @WCAIC                          130468
031860200529     C                     END                                            130468
031870200529     C*
031880200529     C           ATYP      IFNE 'R'                        - B4
031890200529     C*
031900200529     C                     MOVE '0'       RIND
031910200529     C**********           Z-ADDRUND      VALD                            082592
031920200529     C           VALD      IFEQ *ZEROS                                    100086
031930200529     C                     Z-ADDRUND      VALD                            100086
031940200529     C                     END                                            100086
031950200529     C*
031960200529     C** GEICPD FILE PROCESSING
031970200529     C*
031980200529     C           BCCY      IFEQ CCY
031990200529     C           BRCA      ANDEQBBRCA
032000200529     C/COPY WNCPYSRC,RE3664C023
032010200529     C                     EXSR GEICPR
032020200529     C/COPY WNCPYSRC,RE3664C024
032030200529     C                     ELSE
032040200529     C                     EXSR CCYSR
032050200529     C                     END                              - E5
032060200529     C*
032070200529     C*
032080200529     C                     ELSE                            - X4
032090200529     C*
032100200529     C                     MOVE '1'       RIND
032110200529     C                     Z-ADDSHISD     VALD
032120200529     C/COPY WNCPYSRC,RE3664C025
032130200529     C*
032140200529     C** GEICPD FILE PROCESSING
032150200529     C*
032160200529     C           BCCY      IFEQ CCY                        - B5
032170200529     C           BRCA      ANDEQBBRCA
032180200529     C/COPY WNCPYSRC,RE3664C026
032190200529     C                     EXSR GEICPR
032200200529     C/COPY WNCPYSRC,RE3664C027
032210200529     C*
032220200529     C           VALD      IFLE NAPDA                      - B6
032230200529     C           *IN50     ANDEQ'0'
032240200529     C/COPY WNCPYSRC,RE3664C043
032250200529     C*
032260200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
032270200529     C*
032280200529     C                     Z-ADDVALD      HISD
032290200529     C***********          Z-ADD32        DBASE                           CRE002
032300200529     C                     Z-ADD013       DBASE            * DB ERROR 013*CRE002
032310200529     C                     MOVE 'N'       REACT                           CCB003
032320200529     C           WCHGA     IFNE 0                                                             250998
032330200529     C                     Z-ADDWCHGA     CHGA                                                250998
032340200529     C                     END                                                                250998
032350200529     C                     WRITEREHPOSPF
032360200529     C                     Z-ADD0         CHGA                                                250998
032370200529     C                     Z-ADD*ZEROS    DBASE
032380200529     C*
032390200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
032400200529     C*
032410200529     C                     EXSR POSPR
032420200529     C/COPY WNCPYSRC,RE3664C211
032430200529     C*
032440200529     C                     END                             - E6
032450200529     C*
032460200529     C/COPY WNCPYSRC,RE3664C028
032470200529     C                     ELSE                            - X5
032480200529     C                     EXSR CCYSR
032490200529     C*
032500200529     C                     END                             - E5
032510200529     C*
032520200529     C                     END                             - E4
032530200529     C**********           END                                                        135809 135809R
032540200529     C                     END                                                              AR978914
032550200529     C*
032560200529     C                     ELSE                            - X3
032570200529     C*
032580200529     C                     MOVE 'P'       RECI
032590200529     C*********************Z-ADDAACNUM    ASOC                            080978
032600200529     C*
032610200529     C** CHECKING DEBIT/CREDIT INDICATOR PROCESSING
032620200529     C*
032630200529     C                     EXSR DCIND
032640200529     C*
032650200529     C** SUSPENSE PROCESSING
032660200529     C*
032670200529     C                     EXSR SUSPR
032680200529     C*
032690200529     C                     END                             - E3
032700200529     C*
032710200529     C                     END                             - E2
032720200529     C*
032730200529     C                     END                             - E1
032740200529     C                     MOVE ' '       ADJUST                                            MD040758
032750200529      *                                                                   S01408
032760200529     C/COPY WNCPYSRC,RE3664CP36                                           S01408
032770200529      *                                                                   S01408
032780200529     C*
032790200529     C                     ENDSR                           **ALTPR ENDSR**
032800200529     C********************************************************************
032810200529     C/EJECT
032820200529     C********************************************************************
032830200529     C**
032840200529     C** CCYSR subroutine to execute the capitalisation to an account
032850200529     C**       in different currency
032860200529     C**
032870200529     C**     Called by       ALTPR
032880200529     C**     Calls           -
032890200529     C**
032900200529      *****************************************************************   CCB003
032910200529     C           CCYSR     BEGSR                           **CCYSR BEGSR**
032920200529     C*
032930200529     C** SAVE ACCOUNT OF ALTERNATE
032940200529     C*
032950200529     C                     MOVE CCY       ALCCY
032960200529     C                     MOVE BRCA      ALBRCA
032970200529     C**********           Z-ADDCNUM      ALCNUM                                              CSD027
032980200529     C                     MOVE CNUM      ALCNUM                                              CSD027
032990200529     C                     Z-ADDACOD      ALACOD
033000200529     C                     Z-ADDACSQ      ALACSQ
033010200529     C*
033020200529     C* SAVE ORIGINAL AMOUNT EARLIER.
033030200529     C                     Z-ADDWPSTA     WOPSTA
033040200529     C*
033050200529     C** CHECK IF ALTERNATE CURRENCY EXIST
033060200529     C*
033070200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
033080200529     C           ALCCY     LOKUPACUR,A                   17                                 CRE083BK
033090200529      *                                                                                     CRE083BK
033100200529     C           *IN17     IFEQ '1'                                                         CRE083BK
033110200529     C           A         OCUR SDCURR                                                      CRE083BK
033120200529     C                     ELSE                                                             CRE083BK
033130200529     C           1         OCUR SDCURR                                                      MD021155
033140200529     C                     CALL 'AOCURRR0'
033150200529     C                     PARM '*MSG   ' @RTCD
033160200529     C                     PARM '*KEY   ' @OPTN
033170200529     C                     PARM ALCCY     @CYCD   3
033180200529     C           SDCURR    PARM SDCURR    DSSDY
033190200529     C           @RTCD     IFNE *BLANK
033200200529     C           *LOCK     IN   LDA
033210200529     C                     MOVEL'SDCURRPD'DBFILE           ***************
033220200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 09 *CRE002
033230200529     C***********          Z-ADD009       DBASE            ***************CRE002
033240200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 014*CRE002
033250200529     C                     Z-ADD014       DBASE            ***************CRE002
033260200529     C                     OUT  LDA
033270200529     C***********          WRITEERRP1                                     CCB003
033280200529     C                     EXSR *PSSR
033290200529     C                     END
033300200529     C                     ENDIF                                                            CRE083BK
033310200529     C*
033320200529     C** SAVE PARM FOR CROSS CURRENCY
033330200529     C*
033340200529     C                     Z-ADDCDP       WACDP
033350200529     C                     Z-ADDSPOT      WASPOT
033360200529     C                     MOVE MDIN      WAMDIN
033370200529     C                     MOVE TACC      WATACC
033380200529     C*
033390200529     C**********           MOVE WATACC    KACOD   4                                           CGL029
033400200529     C                     MOVE WATACC    KACOD  10                                           CGL029
033410200529     C*
033420200529     C                     ADD  1         RCSQ                                              CRE083BK
033430200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
033440200529     C                     Z-ADD145       WDBASE                                            CRE083BK
033450200529     C                     EXSR ACDCCH                                                      CRE083BK
033460200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
033470200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
033480200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
033490200529     C**********           PARM KACOD     @ACCD   4                                  CGL029 CRE083BK
033500200529     C********** SDACOD    PARM SDACOD    DSFDY                                      CGL029 CRE083BK
033510200529     C**********           PARM KACOD     @ACCD  10                                  CGL029 CRE083BK
033520200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
033530200529     C*
033540200529     C                     MOVE A5ACTY    WATACT
033550200529     C*
033560200529     C** CALCULATE THE BASE CURRENCY EQUIVALENT AMOUNT
033570200529     C*
033580200529     C                     MOVE BCCY      ZCCYI
033590200529     C                     Z-ADDWOSPOT    ZRATEF
033600200529     C                     MOVE WOCDP     ZCDPI
033610200529     C                     MOVE WOMDIN    ZMDINF
033620200529     C                     MOVE BACCY     ZCCYO
033630200529     C                     Z-ADDWBSPOT    ZRATET
033640200529     C                     MOVE WBCDP     ZCDPO
033650200529     C                     MOVE WBMDIN    ZMDINT
033660200529     C                     Z-ADDWPSTA     ZAMTCI
033670200529     C                     EXSR #CCYCN
033680200529     C                     Z-ADDZAMTCO    WPSTAB
033690200529     C*
033700200529     C           BCCY      IFNE ALCCY
033710200529     C*
033720200529     C** CALCULATE THE ALTERNATE CURRENCY EQUIVALENT AMOUNT
033730200529     C*
033740200529     C                     MOVE BCCY      ZCCYI
033750200529     C                     Z-ADDWOSPOT    ZRATEF
033760200529     C                     MOVE WOCDP     ZCDPI
033770200529     C                     MOVE WOMDIN    ZMDINF
033780200529     C                     MOVE ALCCY     ZCCYO
033790200529     C                     Z-ADDWASPOT    ZRATET
033800200529     C                     MOVE WACDP     ZCDPO
033810200529     C                     MOVE WAMDIN    ZMDINT
033820200529     C                     Z-ADDWPSTA     ZAMTCI
033830200529     C                     EXSR #CCYCN
033840200529     C                     Z-ADDZAMTCO    WPSTAA
033850200529     C*
033860200529     C*
033870200529     C** CALCUL THE EXCHANGE RATE
033880200529     C*
033890200529     C           WPSTAA    DIV  WPSTA     EXRT
033900200529     C*
033910200529     C           WDRCR     IFEQ '0'
033920200529     C                     Z-ADDEXRT      DEXRT
033930200529     C                     ELSE
033940200529     C           WDRCR     IFEQ '1'
033950200529     C                     Z-ADDEXRT      CEXRT
033960200529     C                     ELSE
033970200529     C           WDRCR     IFEQ '2'
033980200529     C                     Z-ADDEXRT      CHXRT
033990200529     C                     END
034000200529     C                     END
034010200529     C                     END
034020200529     C*
034030200529     C                     Z-ADDEXRT      NEXRT
034040200529     C                     Z-ADD4         ZADEC
034050200529     C                     Z-ADD2         ZADIG
034060200529     C                     MOVE NEXRT     ZFIELD
034070200529     C                     EXSR ZEDIT
034080200529     C                     MOVE ZFIELD    AEXRT   7
034090200529     C                     MOVE '%'       AEXRT1  8
034100200529     C                     MOVELAEXRT     AEXRT1
034110200529     C*
034120200529     C                     EXSR SUBNAR
034130200529     C                     MOVE NARS      PNAR
034140200529     C*
034150200529     C                     Z-ADDWPSTAA    WPSTA
034160200529     C*
034170200529     C                     END
034180200529     C*
034190200529     C                     EXSR GEICPR
034200200529     C*
034210200529     C           ATYP      IFEQ 'R'
034220200529     C*
034230200529     C** ALTERNATE IS A RETAIL ACCOUNT
034240200529     C*
034250200529     C           VALD      IFLE NAPDA
034260200529     C           *IN50     ANDEQ'0'
034270200529     C/COPY WNCPYSRC,RE3664C044
034280200529     C*
034290200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
034300200529     C*
034310200529     C                     Z-ADDVALD      HISD
034320200529     C***********          Z-ADD96        DBASE                           CRE002
034330200529     C                     Z-ADD015       DBASE            * DB ERROR 015*CRE002
034340200529     C                     MOVE 'N'       REACT                           CCB003
034350200529     C                     WRITEREHPOSPF
034360200529     C*
034370200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
034380200529     C*
034390200529     C                     EXSR POSPR
034400200529     C*
034410200529     C                     END
034420200529     C*
034430200529     C                     END
034440200529     C*
034450200529     C                     Z-ADD*ZERO     ACNO
034460200529     C*
034470200529     C           BCCY      IFNE ALCCY
034480200529      *                                                                   CAC001
034490200529      **  Check if profit centre can hold FX Position                     CAC001
034500200529      *                                                                   CAC001
034510200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
034520200529     C                     MOVE PRFC      WSVPC   4                       CAC001
034530200529     C                     EXSR SRPRFC                                    CAC001
034540200529     C                     ENDIF                                          CAC001
034550200529     C*
034560200529     C** GENERATE THE POSTING FOR THE SPOT POSITION IN ALTERNATE
034570200529     C** CURRENCY
034580200529     C*
034590200529     C                     Z-SUBWPSTA     WPSTA
034600200529     C                     MOVE BBICN     CNUM
034610200529     C                     MOVE BBRCA     BRCA
034620200529     C                     MOVE SPAC      ACOD
034630200529     C                     MOVE WSPACT    ATYP
034640200529     C/COPY WNCPYSRC,RE3664C098
034650200529     C                     Z-ADD1         ACSQ
034660200529     C/COPY WNCPYSRC,RE3664C099
034670200529     C                     EXSR SUBNAR
034680200529     C                     MOVE NARS      PNAR
034690200529     C*
034700200529     C           ATYP      IFEQ 'R'
034710200529     C*
034720200529     C                     MOVE '1'       RIND
034730200529     C                     Z-ADDSHISD     VALD
034740200529     C*
034750200529     C                     EXSR GEICPR
034760200529     C*
034770200529     C           VALD      IFLE NAPDA
034780200529     C           *IN50     ANDEQ'0'
034790200529     C/COPY WNCPYSRC,RE3664C045
034800200529     C                     Z-ADDVALD      HISD
034810200529     C***********          Z-ADD95        DBASE                           CRE002
034820200529     C                     Z-ADD016       DBASE            * DB ERROR 016*CRE002
034830200529     C                     MOVE 'N'       REACT                           CCB003
034840200529     C                     WRITEREHPOSPF
034850200529     C                     EXSR POSPR
034860200529     C                     END
034870200529     C*
034880200529     C                     ELSE
034890200529     C*
034900200529     C                     MOVE '0'       RIND
034910200529     C*************        Z-ADDRUND      VALD                            082592
034920200529     C           VALD      IFEQ *ZEROS                                    100086
034930200529     C                     Z-ADDRUND      VALD                            100086
034940200529     C                     END                                            100086
034950200529     C*
034960200529     C                     EXSR GEICPR
034970200529     C*
034980200529     C                     END
034990200529     C*
035000200529     C** GENERATE THE POSTING FOR THE SPOT EQUIVALENT ALTERNATE
035010200529     C** INTO BASE CURRENCY
035020200529     C*
035030200529     C                     MOVE BACCY     CCY
035040200529     C                     Z-ADDWPSTAB    WPSTA
035050200529     C                     MOVE WATACC    ACOD
035060200529     C                     MOVE WATACT    ATYP
035070200529     C                     EXSR SUBNAR
035080200529     C                     MOVE NARS      PNAR
035090200529     C*
035100200529     C           ATYP      IFEQ 'R'
035110200529     C                     MOVE '1'       RIND
035120200529     C                     Z-ADDSHISD     VALD
035130200529     C*
035140200529     C                     EXSR GEICPR
035150200529     C*
035160200529     C           VALD      IFLE NAPDA
035170200529     C           *IN50     ANDEQ'0'
035180200529     C/COPY WNCPYSRC,RE3664C046
035190200529     C                     Z-ADDVALD      HISD
035200200529     C***********          Z-ADD94        DBASE                           CRE002
035210200529     C                     Z-ADD017       DBASE            * DB ERROR 017*CRE002
035220200529     C                     MOVE 'N'       REACT                           CCB003
035230200529     C                     WRITEREHPOSPF
035240200529     C                     EXSR POSPR
035250200529     C                     END
035260200529     C*
035270200529     C                     ELSE
035280200529     C*
035290200529     C                     MOVE '0'       RIND
035300200529     C*************        Z-ADDRUND      VALD                            082592
035310200529     C           VALD      IFEQ *ZEROS                                    100086
035320200529     C                     Z-ADDRUND      VALD                            100086
035330200529     C                     END                                            100086
035340200529     C*
035350200529     C                     EXSR GEICPR
035360200529     C*
035370200529     C                     END
035380200529      *                                                                                       228966
035390200529      ** Skip Base Ccy spot and Equivalent postings if the Original                           228966
035400200529      ** Ccy is Base and there is no Base Ccy Equivalent A/c of Base                          228966
035410200529      *                                                                                       228966
035420200529     C           BCCY      IFEQ BACCY                                                         228966
035430200529     C           WOTACC    ANDEQ*BLANKS                                                       228966
035440200529     C                     ELSE                                                               228966
035450200529     C*
035460200529     C** GENERATE THE POSTING FOR THE SPOT EQUIVALENT ORIGINAL
035470200529     C** CURRENCY INTO BASE CURRENCY
035480200529     C*
035490200529     C                     Z-SUBWPSTA     WPSTA
035500200529     C                     MOVE BBRCA     BRCA
035510200529     C                     MOVE BBICN     CNUM
035520200529     C/COPY WNCPYSRC,RE3664C100
035530200529     C                     Z-ADD1         ACSQ
035540200529     C/COPY WNCPYSRC,RE3664C101
035550200529     C                     MOVE WOTACC    ACOD
035560200529     C                     MOVE WOTACT    ATYP
035570200529     C                     EXSR SUBNAR
035580200529     C                     MOVE NARS      PNAR
035590200529     C*
035600200529     C           ATYP      IFEQ 'R'
035610200529     C*
035620200529     C                     MOVE '1'       RIND
035630200529     C                     Z-ADDSHISD     VALD
035640200529     C*
035650200529     C                     EXSR GEICPR
035660200529     C*
035670200529     C           VALD      IFNE NAPDA
035680200529     C           *IN50     ANDEQ'0'
035690200529     C/COPY WNCPYSRC,RE3664C047
035700200529     C                     Z-ADDVALD      HISD
035710200529     C***********          Z-ADD93        DBASE                           CRE002
035720200529     C                     Z-ADD018       DBASE            * DB ERROR 018*CRE002
035730200529     C                     MOVE 'N'       REACT                           CCB003
035740200529     C                     WRITEREHPOSPF
035750200529     C                     EXSR POSPR
035760200529     C                     END
035770200529     C*
035780200529     C                     ELSE
035790200529     C*
035800200529     C                     MOVE '0'       RIND
035810200529     C*************        Z-ADDRUND      VALD                            082592
035820200529     C           VALD      IFEQ *ZEROS                                    100086
035830200529     C                     Z-ADDRUND      VALD                            100086
035840200529     C                     END                                            100086
035850200529     C*
035860200529     C                     EXSR GEICPR
035870200529     C*
035880200529     C                     END
035890200529     C*
035900200529     C** GENERATE THE POSTING FOR THE SPOT POSITION ACCOUNT
035910200529     C** CODE INTO ORIGINAL CURRENCY
035920200529     C*
035930200529     C                     Z-ADDWOPSTA    WPSTA
035940200529     C                     MOVE BCCY      CCY
035950200529     C                     MOVE SPAC      ACOD
035960200529     C                     MOVE WSPACT    ATYP
035970200529     C                     EXSR SUBNAR
035980200529     C                     MOVE NARS      PNAR
035990200529     C*
036000200529     C           ATYP      IFEQ 'R'
036010200529     C                     MOVE '1'       RIND
036020200529     C                     Z-ADDSHISD     VALD
036030200529     C*
036040200529     C                     EXSR GEICPR
036050200529     C*
036060200529     C           VALD      IFLE NAPDA
036070200529     C           *IN50     ANDEQ'0'
036080200529     C/COPY WNCPYSRC,RE3664C048
036090200529     C                     Z-ADDVALD      HISD
036100200529     C***********          Z-ADD92        DBASE                           CRE002
036110200529     C                     Z-ADD019       DBASE            * DB ERROR 019*CRE002
036120200529     C                     MOVE 'N'       REACT                           CCB003
036130200529     C                     WRITEREHPOSPF
036140200529     C                     EXSR POSPR
036150200529     C                     END
036160200529     C*
036170200529     C                     ELSE
036180200529     C*
036190200529     C                     MOVE '0'       RIND
036200200529     C*************        Z-ADDRUND      VALD                            082592
036210200529     C           VALD      IFEQ *ZEROS                                    100086
036220200529     C                     Z-ADDRUND      VALD                            100086
036230200529     C                     END                                            100086
036240200529     C*
036250200529     C                     EXSR GEICPR
036260200529     C*
036270200529     C                     END
036280200529     C                     END                                                                228966
036290200529      *                                                                   CAC001
036300200529      **  Restore saved profit centre                                     CAC001
036310200529      *                                                                   CAC001
036320200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
036330200529     C                     MOVE WSVPC     PRFC                            CAC001
036340200529     C                     ENDIF                                          CAC001
036350200529     C*
036360200529     C                     END
036370200529     C*
036380200529     C** CHECK IF MULTIBRANCH PROCESSING
036390200529     C*                                                       -B0
036400200529     C           MBIN      IFEQ 'Y'
036410200529     C*
036420200529     C** CHECK IF ORIGINAL BRANCH AND ALTERNATE BRANCH ARE THE SAME
036430200529     C*
036440200529     C           BBRCA     IFNE ALBRCA                        -B1
036450200529     C*
036460200529     C** GENERATE THE POSTING FOR THE ALTERNATE INTERBRANCH
036470200529     C*
036480200529      *                                                                   CAC001
036490200529      **  Use Primary Funding Centre for interbranch postings             CAC001
036500200529      *                                                                   CAC001
036510200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
036520200529     C                     MOVE PRFC      WSVPC                           CAC001
036530200529     C                     MOVE FTPRFP    PRFC                            CAC001
036540200529     C                     ENDIF                                          CAC001
036550200529     C*
036560200529     C** ACCESS BRANCH CODES
036570200529     C*
036580200529     C                     Z-ADDCUBRCA    C                                                 CRE083BK
036590200529     C           ALBRCA    LOKUPABRC,C                   16                                 CRE083BK
036600200529      *                                                                                     CRE083BK
036610200529     C           *IN16     IFEQ '1'                                                         CRE083BK
036620200529     C           C         OCUR SDBRCH                                                      CRE083BK
036630200529     C                     ELSE                                                             CRE083BK
036640200529     C**********           CALL 'AOBRCHR0'                                                    CGL029
036650200529     C           1         OCUR SDBRCH                                                      MD021155
036660200529     C                     CALL 'AOBRCHR1'                                                    CGL029
036670200529     C                     PARM '*MSG   ' @RTCD
036680200529     C                     PARM '*KEY   ' @OPTN
036690200529     C                     PARM ALBRCA    @BRCA   3
036700200529     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
036710200529     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
036720200529     C           @RTCD     IFNE *BLANK
036730200529     C           *LOCK     IN   LDA
036740200529     C                     MOVEL'SDBRCHPD'DBFILE           ***************
036750200529     C***********          MOVEL@BRCA     DBKEY            * DB ERROR 24 *CRE002
036760200529     C***********          Z-ADD24        DBASE            ***************CRE002
036770200529     C                     MOVEL@BRCA     DBKEY            * DB ERROR 020*CRE002
036780200529     C                     Z-ADD020       DBASE            ***************CRE002
036790200529     C                     OUT  LDA
036800200529     C***********          WRITEERRP1                                     CCB003
036810200529     C                     EXSR *PSSR
036820200529     C                     END
036830200529     C                     ENDIF                                                            CRE083BK
036840200529     C*
036850200529     C                     MOVE BICN      ALBICN
036860200529     C                     MOVE BBICN     CNUM
036870200529     C           BKIEMB    IFEQ 'Y'
036880200529     C           BKMABR    IFNE BBRCA
036890200529     C           BKMABR    ANDNEALBRCA
036900200529     C                     MOVE BKBICN    CNUM
036910200529     C                     ENDIF
036920200529     C                     ENDIF
036930200529     C/COPY WNCPYSRC,RE3664C102
036940200529     C                     Z-ADD1         ACSQ
036950200529     C/COPY WNCPYSRC,RE3664C103
036960200529     C                     MOVE ALCCY     CCY
036970200529     C           BCCY      IFNE ALCCY
036980200529     C                     Z-SUBWPSTAA    WPSTA
036990200529     C           WPSTAA    IFLT *ZEROS
037000200529     C                     MOVE A8DFAC    ACOD
037010200529     C                     ELSE
037020200529     C                     MOVE NBACB     ACOD
037030200529     C                     ENDIF
037040200529     C                     ELSE
037050200529     C                     Z-SUBWPSTA     WPSTA
037060200529     C           WPSTA     IFGT *ZEROS
037070200529     C                     MOVE A8DFAC    ACOD
037080200529     C                     ELSE
037090200529     C                     MOVE NBACB     ACOD
037100200529     C                     ENDIF
037110200529     C                     ENDIF
037120200529     C                     MOVE ALBRCA    BRCA
037130200529     C                     EXSR SUBNAR
037140200529     C                     MOVE NARS      PNAR
037150200529     C*
037160200529     C** ACCESS ACCOUNT CODES
037170200529     C*
037180200529     C**********           MOVE ACOD      KACOD   4                                           CGL029
037190200529     C                     MOVE ACOD      KACOD                                               CGL029
037200200529     C                     Z-ADD*ZEROS    DBASE
037210200529     C*
037220200529     C                     ADD  1         RCSQ                                              CRE083BK
037230200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
037240200529     C                     Z-ADD021       WDBASE                                            CRE083BK
037250200529     C                     EXSR ACDCCH                                                      CRE083BK
037260200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
037270200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
037280200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
037290200529     C**********           PARM KACOD     @ACCD   4                                  CGL029 CRE083BK
037300200529     C********** SDACOD    PARM SDACOD    DSFDY                                      CGL029 CRE083BK
037310200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
037320200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
037330200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
037340200529     C********** *LOCK     IN   LDA                                                         CRE083BK
037350200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
037360200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 20 *CRE002
037370200529     C***********          Z-ADD020       DBASE            ***************CRE002
037380200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 024*           CRE002 CRE083BK
037390200529     C**********           Z-ADD021       DBASE            ***************           CRE002 CRE083BK
037400200529     C**********           OUT  LDA                                                         CRE083BK
037410200529     C***********          WRITEERRP1                                                CCB003 CRE083BK
037420200529     C**********           EXSR *PSSR                                                       CRE083BK
037430200529     C**********           END                                                              CRE083BK
037440200529     C*
037450200529     C                     MOVE A5ACTY    ATYP
037460200529     C*
037470200529     C           ATYP      IFEQ 'R'
037480200529     C*
037490200529     C                     MOVE '1'       RIND
037500200529     C                     Z-ADDSHISD     VALD
037510200529     C*
037520200529     C                     EXSR GEICPR
037530200529     C*
037540200529     C           VALD      IFLE NAPDA
037550200529     C           *IN50     ANDEQ'0'
037560200529     C/COPY WNCPYSRC,RE3664C049
037570200529     C                     Z-ADDVALD      HISD
037580200529     C***********          Z-ADD91        DBASE                           CRE002
037590200529     C                     Z-ADD022       DBASE            * DB ERROR 022*CRE002
037600200529     C                     MOVE 'N'       REACT                           CCB003
037610200529     C                     WRITEREHPOSPF
037620200529     C                     EXSR POSPR
037630200529     C                     END
037640200529     C*
037650200529     C                     ELSE
037660200529     C*
037670200529     C                     MOVE '0'       RIND
037680200529     C*************        Z-ADDRUND      VALD                            082592
037690200529     C           VALD      IFEQ *ZEROS                                    100086
037700200529     C                     Z-ADDRUND      VALD                            100086
037710200529     C                     END                                            100086
037720200529     C*
037730200529     C                     EXSR GEICPR
037740200529     C*
037750200529     C                     END
037760200529     C*
037770200529     C** GENERATE THE POSTINGS INTER BRANCH ENTRIES VIA MAIN BRANCH
037780200529     C*
037790200529     C           BKIEMB    IFEQ 'Y'
037800200529     C           BKMABR    IFNE BBRCA
037810200529     C           BKMABR    ANDNEALBRCA
037820200529     C*
037830200529     C** ACCESS BRANCH CODES
037840200529     C*
037850200529     C                     Z-ADDCUBRCA    C                                                 CRE083BK
037860200529     C           BKMABR    LOKUPABRC,C                   16                                 CRE083BK
037870200529      *                                                                                     CRE083BK
037880200529     C           *IN16     IFEQ '1'                                                         CRE083BK
037890200529     C           C         OCUR SDBRCH                                                      CRE083BK
037900200529     C                     ELSE                                                             CRE083BK
037910200529     C**********           CALL 'AOBRCHR0'                                                    CGL029
037920200529     C           1         OCUR SDBRCH                                                      MD021155
037930200529     C                     CALL 'AOBRCHR1'                                                    CGL029
037940200529     C                     PARM '*MSG   ' @RTCD
037950200529     C                     PARM '*KEY   ' @OPTN
037960200529     C                     PARM BKMABR    @BRCA   3
037970200529     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
037980200529     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
037990200529     C           @RTCD     IFNE *BLANK
038000200529     C           *LOCK     IN   LDA
038010200529     C                     MOVEL'SDBRCHPD'DBFILE           ***************
038020200529     C***********          MOVEL@BRCA     DBKEY            * DB ERROR 24 *CRE002
038030200529     C***********          Z-ADD24        DBASE            ***************CRE002
038040200529     C                     MOVEL@BRCA     DBKEY            * DB ERROR 023*CRE002
038050200529     C                     Z-ADD023       DBASE            ***************CRE002
038060200529     C                     OUT  LDA
038070200529     C***********          WRITEERRP1                                     CCB003
038080200529     C                     EXSR *PSSR
038090200529     C                     END
038100200529     C                     ENDIF                                                            CRE083BK
038110200529     C*
038120200529     C                     MOVE ALBICN    CNUM
038130200529     C           WPSTAA    IFLT *ZEROS
038140200529     C                     MOVE NBACB     ACOD
038150200529     C                     ELSE
038160200529     C                     MOVE A8DFAC    ACOD
038170200529     C                     ENDIF
038180200529     C/COPY WNCPYSRC,RE3664C104
038190200529     C                     Z-ADD1         ACSQ
038200200529     C/COPY WNCPYSRC,RE3664C105
038210200529     C                     MOVE ALCCY     CCY
038220200529     C                     Z-SUBWPSTA     WPSTA
038230200529     C                     MOVE BKMABR    BRCA
038240200529     C                     EXSR SUBNAR
038250200529     C                     MOVE NARS      PNAR
038260200529     C*
038270200529     C** ACCESS ACCOUNT CODES
038280200529     C*
038290200529     C**********           MOVE ACOD      KACOD   4                                           CGL029
038300200529     C                     MOVE ACOD      KACOD                                               CGL029
038310200529     C                     Z-ADD*ZEROS    DBASE
038320200529     C*
038330200529     C                     ADD  1         RCSQ                                              CRE083BK
038340200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
038350200529     C                     Z-ADD024       WDBASE                                            CRE083BK
038360200529     C                     EXSR ACDCCH                                                      CRE083BK
038370200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
038380200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
038390200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
038400200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
038410200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
038420200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
038430200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
038440200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
038450200529     C********** *LOCK     IN   LDA                                                         CRE083BK
038460200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
038470200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 20 *CRE002
038480200529     C***********          Z-ADD020       DBASE            ***************CRE002
038490200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 024*           CRE002 CRE083BK
038500200529     C**********           Z-ADD024       DBASE            ***************           CRE002 CRE083BK
038510200529     C**********           OUT  LDA                                                         CRE083BK
038520200529     C***********          WRITEERRP1                                     CCB003
038530200529     C**********           EXSR *PSSR                                                       CRE083BK
038540200529     C**********           END                                                              CRE083BK
038550200529     C*
038560200529     C                     MOVE A5ACTY    ATYP
038570200529     C*
038580200529     C           ATYP      IFEQ 'R'
038590200529     C*
038600200529     C                     MOVE '1'       RIND
038610200529     C                     Z-ADDSHISD     VALD
038620200529     C*
038630200529     C                     EXSR GEICPR
038640200529     C*
038650200529     C           VALD      IFLE NAPDA
038660200529     C           *IN50     ANDEQ'0'
038670200529     C/COPY WNCPYSRC,RE3664C050
038680200529     C                     Z-ADDVALD      HISD
038690200529     C***********          Z-ADD91        DBASE                           CRE002
038700200529     C                     Z-ADD025       DBASE            * DB ERROR 025*CRE002
038710200529     C                     MOVE 'N'       REACT                           CCB003
038720200529     C                     WRITEREHPOSPF
038730200529     C                     EXSR POSPR
038740200529     C                     END
038750200529     C*
038760200529     C                     ELSE
038770200529     C*
038780200529     C                     MOVE '0'       RIND
038790200529     C*************        Z-ADDRUND      VALD                            082592
038800200529     C           VALD      IFEQ *ZEROS                                    100086
038810200529     C                     Z-ADDRUND      VALD                            100086
038820200529     C                     END                                            100086
038830200529     C*
038840200529     C                     EXSR GEICPR
038850200529     C*
038860200529     C                     END
038870200529     C*
038880200529     C                     MOVE BBICN     CNUM
038890200529     C           WPSTAA    IFLT *ZEROS
038900200529     C                     MOVE A8DFAC    ACOD
038910200529     C                     ELSE
038920200529     C                     MOVE NBACB     ACOD
038930200529     C                     ENDIF
038940200529     C/COPY WNCPYSRC,RE3664C106
038950200529     C                     Z-ADD1         ACSQ
038960200529     C/COPY WNCPYSRC,RE3664C107
038970200529     C                     MOVE ALCCY     CCY
038980200529     C                     Z-SUBWPSTA     WPSTA
038990200529     C                     MOVE BKMABR    BRCA
039000200529     C                     EXSR SUBNAR
039010200529     C                     MOVE NARS      PNAR
039020200529     C*
039030200529     C** ACCESS ACCOUNT CODES
039040200529     C*
039050200529     C**********           MOVE ACOD      KACOD   4                                           CGL029
039060200529     C                     MOVE ACOD      KACOD                                               CGL029
039070200529     C                     Z-ADD*ZEROS    DBASE
039080200529     C*
039090200529     C                     ADD  1         RCSQ                                              CRE083BK
039100200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
039110200529     C                     Z-ADD026       WDBASE                                            CRE083BK
039120200529     C                     EXSR ACDCCH                                                      CRE083BK
039130200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
039140200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
039150200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
039160200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
039170200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
039180200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
039190200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
039200200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
039210200529     C********** *LOCK     IN   LDA                                                         CRE083BK
039220200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
039230200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 20 *CRE002
039240200529     C***********          Z-ADD020       DBASE            ***************CRE002
039250200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 026*           CRE002 CRE083BK
039260200529     C**********           Z-ADD026       DBASE            ***************           CRE002 CRE083BK
039270200529     C**********           OUT  LDA                                                         CRE083BK
039280200529     C***********          WRITEERRP1                                     CCB003
039290200529     C**********           EXSR *PSSR                                                       CRE083BK
039300200529     C**********           END                                                              CRE083BK
039310200529     C*
039320200529     C                     MOVE A5ACTY    ATYP
039330200529     C*
039340200529     C           ATYP      IFEQ 'R'
039350200529     C*
039360200529     C                     MOVE '1'       RIND
039370200529     C                     Z-ADDSHISD     VALD
039380200529     C*
039390200529     C                     EXSR GEICPR
039400200529     C*
039410200529     C           VALD      IFLE NAPDA
039420200529     C           *IN50     ANDEQ'0'
039430200529     C/COPY WNCPYSRC,RE3664C051
039440200529     C                     Z-ADDVALD      HISD
039450200529     C***********          Z-ADD91        DBASE                           CRE002
039460200529     C                     Z-ADD027       DBASE            * DB ERROR 027*CRE002
039470200529     C                     MOVE 'N'       REACT                           CCB003
039480200529     C                     WRITEREHPOSPF
039490200529     C                     EXSR POSPR
039500200529     C                     END
039510200529     C*
039520200529     C                     ELSE
039530200529     C*
039540200529     C                     MOVE '0'       RIND
039550200529     C*************        Z-ADDRUND      VALD                            082592
039560200529     C           VALD      IFEQ *ZEROS                                    100086
039570200529     C                     Z-ADDRUND      VALD                            100086
039580200529     C                     END                                            100086
039590200529     C*
039600200529     C                     EXSR GEICPR
039610200529     C*
039620200529     C                     END
039630200529     C*
039640200529     C                     ENDIF
039650200529     C*
039660200529     C                     ENDIF
039670200529     C*
039680200529     C** GENERATE THE POSTING FOR THE ORIGINAL INTERBRANCH
039690200529     C*
039700200529     C                     MOVE ALBICN    CNUM
039710200529     C           BKIEMB    IFEQ 'Y'
039720200529     C           BKMABR    IFNE BBRCA
039730200529     C           BKMABR    ANDNEALBRCA
039740200529     C                     MOVE BKBICN    CNUM
039750200529     C                     ENDIF
039760200529     C                     ENDIF
039770200529     C           WPSTA     IFGT *ZEROS
039780200529     C                     MOVE BNBACB    ACOD
039790200529     C                     MOVE BNBACT    ATYP
039800200529     C                     ELSE
039810200529     C                     MOVE BNDFAC    ACOD
039820200529     C                     MOVE BNDFAT    ATYP
039830200529     C                     ENDIF
039840200529     C/COPY WNCPYSRC,RE3664C108
039850200529     C                     Z-ADD1         ACSQ
039860200529     C/COPY WNCPYSRC,RE3664C109
039870200529     C                     MOVE ALCCY     CCY
039880200529     C                     MOVE BBRCA     BRCA
039890200529     C                     Z-SUBWPSTA     WPSTA
039900200529     C                     EXSR SUBNAR
039910200529     C                     MOVE NARS      PNAR
039920200529     C*
039930200529     C           ATYP      IFEQ 'R'
039940200529     C*
039950200529     C                     MOVE '1'       RIND
039960200529     C                     Z-ADDSHISD     VALD
039970200529     C*
039980200529     C                     EXSR GEICPR
039990200529     C*
040000200529     C           VALD      IFLE NAPDA
040010200529     C           *IN50     ANDEQ'0'
040020200529     C/COPY WNCPYSRC,RE3664C052
040030200529     C                     Z-ADDVALD      HISD
040040200529     C***********          Z-ADD90        DBASE                           CRE002
040050200529     C                     Z-ADD028       DBASE            * DB ERROR 028*CRE002
040060200529     C                     MOVE 'N'       REACT                           CCB003
040070200529     C                     WRITEREHPOSPF
040080200529     C                     EXSR POSPR
040090200529     C                     END
040100200529     C*
040110200529     C                     ELSE
040120200529     C*
040130200529     C                     MOVE '0'       RIND
040140200529     C*************        Z-ADDRUND      VALD                            082592
040150200529     C           VALD      IFEQ *ZEROS                                    100086
040160200529     C                     Z-ADDRUND      VALD                            100086
040170200529     C                     END                                            100086
040180200529     C*
040190200529     C                     EXSR GEICPR
040200200529     C*
040210200529     C                     END
040220200529      *                                                                   CAC001
040230200529      **  Restore saved profit centre                                     CAC001
040240200529      *                                                                   CAC001
040250200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
040260200529     C                     MOVE WSVPC     PRFC                            CAC001
040270200529     C                     ENDIF                                          CAC001
040280200529     C*
040290200529     C                     END                             - E1
040300200529     C*
040310200529     C                     END                             - E0
040320200529     C*
040330200529     C                     Z-ADDWOPSTA    WPSTA
040340200529     C*
040350200529     C* RESTORE ORIGINAL ACCOUNT INFO
040360200529     C*
040370200529     C                     MOVE BCCY      CCY
040380200529     C                     MOVE BBRCA     BRCA
040390200529     C                     MOVE WACNO     ACNO
040400200529     C           1         OCUR SDBRCH                                                      MD022379
040410200529     C                     MOVE BBICN     BICN
040420200529     C                     MOVE BNBACB    NBACB
040430200529     C*
040440200529     C                     ENDSR                           **CCYSR ENDSR**
040450200529     C********************************************************************
040460200529     C/EJECT
040470200529     C********************************************************************
040480200529     C**
040490200529     C** CHGPR subroutine to execute charges processing
040500200529     C**
040510200529     C**     Called by       MAIN
040520200529     C**     Calls           -
040530200529     C**
040540200529      *****************************************************************   CCB003
040550200529     C           CHGPR     BEGSR                           **CHGPR BEGSR**
040560200529     C*
040570200529     C                     Z-ADDTRAT      WTRAT
040580200529     C                     Z-ADD91050     TRAT
040590200529     C                     MOVEL'91050'   OTTP
040600200529     C*
040610200529     C                     MOVE '2'       WDRCR
040620200529     C                     Z-ADDCHGP      WPSTA
040630200529     C*********************Z-ADDBCNUM     ASOC                            080978
040640200529     C                     Z-ADDCNCID     CTLDAT
040650200529     C                     MOVELNAR,3     INPNAR
040660200529     C                     MOVELNR16,3    INP16
040670200529     C                     MOVELDN07,3    INP07
040680200529     C                     MOVELMGD,3     ##MGID                          S01522
040690200529     C/COPY WNCPYSRC,RE3664C010
040700200529     C*
040710200529     C** ACCESS RECRG FILE
040720200529     C*
040730200529     C***********          Z-ADD33        DBASE                           CRE002
040740200529     C                     Z-ADD029       DBASE            * DB ERROR 029*CRE002
040750200529     C                     MOVE *BLANK    ZZ001                           095656
040760200529     C           CHKEY     CHAINRECRG                99
040770200529     C                     Z-ADD*ZEROS    DBASE
040780200529     C*
040790200529     C** ERROR IN RECRG
040800200529     C*
040810200529     C           *IN99     IFEQ '1'                        - B1
040820200529     C           *LOCK     IN   LDA
040830200529     C***********          Z-ADD1         DBASE            ***************CRE002
040840200529     C                     Z-ADD030       DBASE                           CRE002
040850200529     C***********          MOVE 'RECRG'   DBFILE           **DB ERROR 01**CCB003
040860200529     C                     MOVEL'RECRG'   DBFILE           **DB ERROR 01**CCB003
040870200529     C                     MOVELCHKEY     DBKEY            ***************
040880200529     C                     OUT  LDA
040890200529     C                     EXSR *PSSR
040900200529     C                     END                             - E1
040910200529     C**********           MOVE CACOD     KACOD   4                                           CGL029
040920200529     C                     MOVE CACOD     KACOD                                               CGL029
040930200529     C*
040940200529     C                     ADD  1         RCSQ                                              CRE083BK
040950200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
040960200529     C                     Z-ADD031       WDBASE                                            CRE083BK
040970200529     C                     EXSR ACDCCH                                                      CRE083BK
040980200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
040990200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
041000200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
041010200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
041020200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
041030200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
041040200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
041050200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
041060200529     C********** *LOCK     IN   LDA                                                         CRE083BK
041070200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
041080200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 25 *CRE002
041090200529     C***********          Z-ADD025       DBASE            ***************CRE002
041100200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 031*           CRE002 CRE083BK
041110200529     C**********           Z-ADD031       DBASE            ***************           CRE002 CRE083BK
041120200529     C**********           OUT  LDA                                                         CRE083BK
041130200529     C***********          WRITEERRP1                                     CCB003
041140200529     C**********           EXSR *PSSR                                                       CRE083BK
041150200529     C**********           END                                                              CRE083BK
041160200529     C*
041170200529     C                     MOVE A5ACTY    WCHGT
041180200529      *                                                                   CAC001
041190200529      **  Initially set profit centre to be profit centre of main a/c     CAC001
041200200529      *                                                                   CAC001
041210200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
041220200529     C                     MOVE WMPRFC    PRFC                            CAC001
041230200529     C                     ENDIF                                          CAC001
041240200529     C*
041250200529     C/COPY WNCPYSRC,RE3664CP12                                           S01408
041260200529     C*
041270200529     C** CHECK ON REFERENCE CHARGES INDICATOR :
041280200529     C** Y OR I = ACCOUNT PROCESSING
041290200529     C** A      = ALTERNATE PROCESSING
041300200529     C*
041310200529     C                     MOVE *BLANK    CSCHGI
041320200529     C           SCHGI     CASEQ'Y'       ACCPR
041330200529     C           SCHGI     CASEQ'I'       ACCPR
041340200529     C           SCHGI     CASEQ'A'       ALTPR
041350200529     C           SCHGI     CASEQ'P'       ALTPR
041360200529     C           SCHGI     CASEQ'Q'       ALTPR
041370200529     C           SCHGI     CASEQ'S'       SUSPR
041380200529     C           SCHGI     CASEQ'L'       ACCPR
041390200529     C           SCHGI     CASEQ'O'       ACCPR
041400200529     C                     END
041410200529     C*
041420200529     C                     Z-ADDCACOD     ACOD
041430200529     C                     MOVE WCHGT     ATYP
041440200529     C                     Z-SUBWPSTA     WPSTA
041450200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
041460200529     C                     MOVELCACOD     OTST                            CRE008
041470200529     C                     MOVE 'CACO'    OTST                            CRE008
041480200529     C**********           ENDIF                                                     261620 MD022635
041490200529     C*
041500200529     C* PROFIT AND LOSS PROCESSING
041510200529     C*
041520200529     C           SCHGI     IFNE ' '
041530200529     C                     EXSR PLPR
041540200529     C                     END
041550200529      *                                                                   CRE008
041560200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
041570200529     C                     MOVEL*BLANK    OTST                            CRE008
041580200529     C**********           ENDIF                                                     261620 MD022635
041590200529     C/COPY WNCPYSRC,RE3664C170
041600200529     C*
041610200529     C* SETUP CAPITALISATION RECORD PROCESSING
041620200529     C*
041630200529     C                     EXSR SSETUP
041640200529     C*
041650200529     C                     Z-ADDWTRAT     TRAT
041660200529     C                     MOVEL'91060'   OTTP
041670200529     C/COPY WNCPYSRC,RE3664C053
041680200529     C                     ENDSR                           **CHGPR ENDSR**
041690200529     C********************************************************************
041700200529     C/EJECT
041710200529     C********************************************************************
041720200529     C**
041730200529     C** CREPR subroutine to execute credit processing
041740200529     C**
041750200529     C**     Called by       MAIN
041760200529     C**     Calls           ACCPR,ALTPR,PLPR,SSETUP,SUSPR
041770200529     C**
041780200529      *****************************************************************   CCB003
041790200529     C           CREPR     BEGSR                           **CREPR BEGSR**
041800200529      *                                                                                     AR831847
041810200529      ** If German Tax is switched on and post net interest is 'Y'                          AR831847
041820200529      ** calculate and post net interest                                                    AR831847
041830200529      *                                                                                     AR831847
041840200529     C           CER048    IFEQ 'Y'                                                         AR831847
041850200529     C           WSV01     ANDEQ'Y'                                                         AR831847
041860200529     C           CAIC      ANDNE0                                                           AR831847
041870200529     C           SHISD     ANDEQCNCID                                                       MD032185
041880200529     C                     Z-ADD*ZERO     WTAOC                                             AR831847
041890200529     C                     Z-ADD*ZERO     WTATC                                             AR831847
041900200529     C                     Z-ADD*ZERO     WTABC                                             AR831847
041910200529     C                     MOVE 'N'       WEUTT                                             AR831847
041920200529      *                                                                                     AR831847
041930200529     C                     Z-ADD*ZEROS    WKSTXO                                            AR831847
041940200529     C                     Z-ADD*ZEROS    WKSTXT                                            AR831847
041950200529     C                     Z-ADD*ZEROS    WKSTXB                                            AR831847
041960200529     C                     Z-ADD*ZEROS    WKTTXO                                            AR831847
041970200529     C                     Z-ADD*ZEROS    WKTTXT                                            AR831847
041980200529     C                     Z-ADD*ZEROS    WKTTXB                                            AR831847
041990200529     C                     Z-ADDRCAIC     SVRCIC                                            AR831847
042000200529     C                     Z-ADDCAIC      RCAIC                                             AR831847
042010200529     C                     MOVE TRAT      SVTRAT                                            AR831847
042020200529     C                     EXSR SRRTAX                                                      AR831847
042030200529     C                     EXSR SREPOS                                                      AR831847
042040200529     C                     MOVE SVTRAT    TRAT                                              AR831847
042050200529     C                     Z-ADDCAIC      SVCAIC                                            AR831847
042060200529     C                     Z-ADDSVRCIC    RCAIC                                             AR831847
042070200529      *                                                                                     AR831847
042080200529     C           WTAOC     IFNE 0                                                           AR831847
042090200529     C           CAIC      IFGT 0                                                           AR831847
042100200529     C                     SUB  WTAOC     CAIC                                              AR831847
042110200529     C                     SUB  WKSTXO    CAIC                                              AR831847
042120200529     C                     SUB  WKTTXO    CAIC                                              AR831847
042130200529     C                     ELSE                                                             AR831847
042140200529     C                     ADD  WTAOC     CAIC                                              AR831847
042150200529     C                     ADD  WKSTXO    CAIC                                              AR831847
042160200529     C                     ADD  WKTTXO    CAIC                                              AR831847
042170200529     C                     ENDIF                                                            AR831847
042180200529     C                     ENDIF                                                            AR831847
042190200529      *                                                                                     AR676495
042200200529     C                     ELSE                                                             AR676495
042210200529      *                                                                                     AR676495
042220200529      ** CALCULATE/POST NET INTEREST OF INTEREST ADJUSTMENTS                                AR676495
042230200529      *                                                                                     AR676495
042240200529     C           CER048    IFEQ 'Y'                                                         AR676495
042250200529     C           WSV01     ANDEQ'Y'                                                         AR676495
042260200529     C           CAIC      ANDNE0                                                           AR676495
042270200529     C           SHISD     ANDLTCNCID                                                       AR676495
042280200529      *                                                                                     AR676495
042290200529     C                     Z-ADD*ZERO     WTAOC                                             AR676495
042300200529     C                     Z-ADD*ZERO     WTATC                                             AR676495
042310200529     C                     Z-ADD*ZERO     WTABC                                             AR676495
042320200529     C                     Z-ADD*ZERO     WKSTXO                                            AR676495
042330200529     C                     Z-ADD*ZERO     WKSTXT                                            AR676495
042340200529     C                     Z-ADD*ZERO     WKSTXB                                            AR676495
042350200529     C                     Z-ADD*ZERO     WKTTXO                                            AR676495
042360200529     C                     Z-ADD*ZERO     WKTTXT                                            AR676495
042370200529     C                     Z-ADD*ZERO     WKTTXB                                            AR676495
042380200529      *                                                                                     AR676495
042390200529     C                     Z-ADDRCAIC     SVRCIC                                            AR676495
042400200529     C                     Z-ADDCAIC      RCAIC                                             AR676495
042410200529     C                     MOVE TRAT      SVTRAT                                            AR676495
042420200529      *                                                                                     AR676495
042430200529     C                     EXSR SRINTA                                                      AR676495
042440200529     C                     EXSR SREPOS                                                      AR676495
042450200529      *                                                                                     AR676495
042460200529     C                     MOVE SVTRAT    TRAT                                              AR676495
042470200529     C                     Z-ADDCAIC      SVCAIC                                            AR676495
042480200529     C                     Z-ADDSVRCIC    RCAIC                                             AR676495
042490200529      *                                                                                     AR676495
042500200529     C           WTAOC     IFNE 0                                                           AR676495
042510200529     C           CAIC      IFGT 0                                                           AR676495
042520200529     C                     SUB  WTAOC     CAIC                                              AR676495
042530200529     C                     SUB  WKSTXO    CAIC                                              AR676495
042540200529     C                     SUB  WKTTXO    CAIC                                              AR676495
042550200529     C                     ELSE                                                             AR676495
042560200529     C           WTAOC     IFLT 0                                                           MD032185
042570200529     C                     SUB  WTAOC     CAIC                                              MD032185
042580200529     C                     SUB  WKSTXO    CAIC                                              MD032185
042590200529     C                     SUB  WKTTXO    CAIC                                              MD032185
042600200529     C                     ELSE                                                             MD032185
042610200529     C                     ADD  WTAOC     CAIC                                              AR676495
042620200529     C                     ADD  WKSTXO    CAIC                                              AR676495
042630200529     C                     ADD  WKTTXO    CAIC                                              AR676495
042640200529     C                     ENDIF                                                            MD032185
042650200529     C                     ENDIF                                                            AR676495
042660200529      *                                                                                     AR676495
042670200529     C                     MOVE '1'       INTAD   1                                         AR676495
042680200529      *                                                                                     AR676495
042690200529     C                     ENDIF                                                            AR676495
042700200529     C                     ENDIF                                                            AR676495
042710200529      *                                                                                     AR676495
042720200529     C                     ENDIF                                                            AR831847
042730200529     C*
042740200529     C/COPY WNCPYSRC,RE3664C138
042750200529     C           ZZ007     IFEQ 'DEB INT'                                                     CER049
042760200529     C                     MOVE *BLANKS   ZZ007                                               CER049
042770200529     C                     END                                                                CER049
042780200529     C                     MOVE '1'       WDRCR
042790200529     C*
042800200529     C/COPY WNCPYSRC,RE3664C160
042810200529     C           CAIC      IFNE 0                          - B0
042820200529     C                     Z-SUBCAIC      WPSTA
042830200529     C                     Z-ADDWPSTA     @WPSTA
042840200529     C*
042850200529     C                     MOVE *ZEROS    BRTAMT
042860200529     C                     MOVE *ZEROS    NETBRT
042870200529     C                     MOVE *ZEROS    STRBRT
042880200529     C                     MOVE *ZEROS    BSEBRT
042890200529      *                                                                   CAC001
042900200529      **  Initially set profit centre to be profit centre of main a/c     CAC001
042910200529      *                                                                   CAC001
042920200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
042930200529     C                     MOVE WMPRFC    PRFC                            CAC001
042940200529     C                     ENDIF                                          CAC001
042950200529     C/COPY WNCPYSRC,RE3664C054
042960200529      *                                                                   179300
042970200529      **  Save the current value of NCID, to use later in BRT             179300
042980200529      **  processing.                                                     179300
042990200529      *                                                                   179300
043000200529     C                     MOVELNCID      NXTCID  50                      179300
043010200529      *                                                                   179300
043020200529     C*
043030200529     C****IF*BRT*SAR INSTALLED,                                           130468
043040200529     C****AND*IF*CREDIT INTEREST IS TO BE POSTED                          130468
043050200529     C*
043060200529     C********** S01383    IFEQ 'Y'                                       130468
043070200529     C********** SHISD     ANDEQCNCID                                     130468
043080200529     C********** S01383    OREQ 'Y'                                089741 130468
043090200529     C********** BDICI     ANDEQ'C'                                089741 130468
043100200529     C********** S01383    OREQ 'Y'                                089741 130468
043110200529     C********** BCICI     ANDEQ'C'                                089741 130468
043120200529     C********** SCCI      IFEQ 'Y'                                       130468
043130200529     C********** SCCI      OREQ 'I'                                       130468
043140200529     C********** WPSTA     ANDLT0
043150200529      *                                                                   CAC001
043160200529      ****Check*if profit centre can hold FX Position and then saveCAC001 130468
043170200529      ****the*FX*Position Profit Centre for later use              CAC001 130468
043180200529      *                                                                   CAC001
043190200529     C********** BGN0ST    IFEQ 'Y'                                CAC001 130468
043200200529     C**********           EXSR SRPRFC                             CAC001 130468
043210200529     C**********           MOVE PRFC      WFXPC   4                CAC001 130468
043220200529     C**********           ENDIF                                   CAC001 130468
043230200529     C**
043240200529     C****DO*BASIC*RATE TAX PROCESSING                                    130468
043250200529     C**
043260200529     C**********           EXSR BRTPRO                                    130468
043270200529     C**
043280200529     C**  OUTPUT BRT HISTORY RECORD IF NOT BRT EXEMPT
043290200529     C**
043300200529     C********** BRTCA     IFNE 'X'                                       130468
043310200529     C**********           EXSR OUTBRT                                    130468
043320200529     C**********           END                                            130468
043330200529     C*
043340200529     C**********           Z-SUBNETBRT    WPSTA                           130468
043350200529      *                                                                   CAC001
043360200529      ****Profit*centre set to main profit centre for subseq proc'gCAC001 130468
043370200529      *                                                                   CAC001
043380200529     C********** BGN0ST    IFEQ 'Y'                                CAC001 130468
043390200529     C**********           MOVE WMPRFC    PRFC                     CAC001 130468
043400200529     C**********           ENDIF                                   CAC001 130468
043410200529     C**********           END                                            130468
043420200529     C**********           END                                            130468
043430200529     C/COPY WNCPYSRC,RE3664C055
043440200529     C*
043450200529     C*********************Z-ADDBCNUM     ASOC                            080978
043460200529     C           CER048    IFEQ 'Y'                                                         AR831847
043470200529     C           WSV01     ANDEQ'Y'                                                         AR831847
043480200529     C                     ADD  SVCAIC    RCAIC                                             AR831847
043490200529     C                     ELSE                                                             AR831847
043500200529     C                     ADD  CAIC      RCAIC
043510200529     C                     ENDIF                                                            AR831847
043520200529     C/COPY WNCPYSRC,RE3664C139
043530200529     C*
043540200529     C           SHISD     IFEQ CNCID                      - B1
043550200529     C/COPY WNCPYSRC,RE3664C217
043560200529      *                                                                   104489
043570200529     C           BDICI     IFNE 'C'                        - B2           104489
043580200529     C                     MOVELNAR,2     INPNAR 30
043590200529     C                     MOVELNR16,2    INP16  16
043600200529     C**********           MOVELDN07,2    INP07   7                                           CGL029
043610200529     C                     MOVELDN07,2    INP07   6                                           CGL029
043620200529     C                     MOVELMGD,2     ##MGID                          S01522
043630200529     C**********           Z-ADD2         @INDX   20                                  135809 135809R
043640200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
043650200529     C                     Z-ADD2         @INDX   20                                        AR978914
043660200529     C                     ENDIF                                                            MD045460
043670200529     C/COPY WNCPYSRC,RE3664C011
043680200529     C*********************ELSE                            - X1           104489
043690200529     C                     END                             - E2           104489
043700200529     C*                                                                   084082
043710200529     C***Default*narrative to 'BRT INTERESTI'                      084082 130468
043720200529     C**********           Z-ADD10        #                        084082 130468
043730200529     C*                                                                   057048
043740200529     C** IF CLOSURE CHANGE NARRATIVE                                      057048
043750200529     C***********BDICI     IFEQ 'C'                                057048 094681
043760200529     C***********BCICI     OREQ 'C'                                057048 094681
043770200529     C           BCICI     IFEQ 'C'                                       094681
043780200529     C           SCICI     ANDEQ'C'                                       094681
043790200529     C***********          MOVELNAR,11    NAR1                      057048087513
043800200529     C***********          Z-ADD11        #                         057048087513
043810200529     C***********          MOVELNR16,#    INP16                     057048087513
043820200529     C***********          MOVELDN07,#    INP07                     057048087513
043830200529     C***********          MOVELNAR,2     INPNAR                    087513088273
043840200529     C***********          MOVELNR16,2    INP16                     087513088273
043850200529     C***********          MOVELDN07,2    INP07                     087513088273
043860200529     C                     Z-ADD11        #                               088273
043870200529     C                     MOVELNAR,#     INPNAR                          088273
043880200529     C                     MOVELNR16,#    INP16                           088273
043890200529     C                     MOVELDN07,#    INP07                           088273
043900200529     C                     MOVELMGD,#     ##MGID                          189038
043910200529     C**********           Z-ADD#         @INDX                                       135809 135809R
043920200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
043930200529     C                     Z-ADD#         @INDX                                             AR978914
043940200529     C                     ENDIF                                                            MD045460
043950200529     C                     END                             - E2           104489
043960200529      *                                                                   104489
043970200529     C                     ELSE                                           057048
043980200529     C***********          MOVELNAR,1     INPNAR                          135401
043990200529     C                     MOVELNAR,12    INPNAR                          135401
044000200529     C***********          MOVELNR16,1    INP16                           135401
044010200529     C*********            MOVELNR16,W    INP16                                        135401 235328
044020200529     C                     MOVELNR16,12   INP16                                               235328
044030200529     C                     MOVELDN07,12   INP07                                             MD022635
044040200529     C**********           MOVELDN07,1    INP07                                             MD022635
044050200529     C***********          MOVELMGD,1     ##MGID                   S01522 135401
044060200529     C                     MOVELMGD,12    ##MGID                          135401
044070200529     C/COPY WNCPYSRC,RE3664C184
044080200529     C**********           Z-ADD12        @INDX                                       135809 135809R
044090200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
044100200529     C                     Z-ADD12        @INDX                                             AR978914
044110200529     C                     ENDIF                                                            MD045460
044120200529     C*
044130200529     C**  IF ADJUST INTEREST THEN SEND ON CHARGE OR PRODUCT
044140200529     C*
044150200529     C*********  SCCI      IFEQ 'S'
044160200529     C*********            MOVE 'L'       SCCI
044170200529     C*********            END
044180200529     C***********          END                                     057048 104489
044190200529     C/COPY WNCPYSRC,RE3664C012
044200200529     C*
044210200529     C                     END                             - E1
044220200529     C*
044230200529     C/COPY WNCPYSRC,RE3664CP13                                           S01408
044240200529      *                                                                   S01408
044250200529     C** CHECK ON REFERENCE CREDIT CAPITALISATION INDICATOR :
044260200529     C** Y OR I = ACCOUNT PROCESSING
044270200529     C** S      = SUSPENSE PROCESSING
044280200529     C** A      = ALTERNATE PROCESSING
044290200529     C*
044300200529     C           WPSTA     IFNE 0
044310200529     C/COPY WNCPYSRC,RE3664C198
044320200529     C           SCCI      CASEQ'Y'       ACCPR
044330200529     C           SCCI      CASEQ'I'       ACCPR
044340200529     C           SCCI      CASEQ'S'       SUSPR
044350200529     C           SCCI      CASEQ'L'       SUSPR
044360200529     C           SCCI      CASEQ'O'       SUSPR
044370200529     C           SCCI      CASEQ'A'       ALTPR
044380200529     C                     END
044390200529     C/COPY WNCPYSRC,RE3664C199
044400200529     C                     END
044410200529     C/COPY WNCPYSRC,RE3664C056
044420200529     C*
044430200529     C********** S01383    IFEQ 'Y'                                       130468
044440200529     C********** BRTAMT    ANDNE0                                         130468
044450200529     C**********           CALL 'AOBRCHR0'
044460200529     C**********           PARM '*MSG   ' @RTCD
044470200529     C**********           PARM '*KEY   ' @OPTN
044480200529     C**********           PARM BBRCA     @BRCA   3
044490200529     C********** SDBRCH    PARM SDBRCH    DSFDY
044500200529     C********** @RTCD     IFNE *BLANK
044510200529     C********** *LOCK     IN   LDA
044520200529     C**********           MOVEL'SDBRCHPD'DBFILE           ***************
044530200529     C**********           MOVEL@BRCA     DBKEY            * DB ERROR 30 *
044540200529     C**********           Z-ADD30        DBASE            ***************
044550200529     C**********           OUT  LDA
044560200529     C**********           WRITEERRP1
044570200529     C**********           EXSR *PSSR
044580200529     C**********           END
044590200529     C****************     MOVE BICN      CNUM
044600200529     C**********           MOVE BBICN     CNUM                            130468
044610200529     C**********           MOVE BCCY      CCY                             130468
044620200529     C*
044630200529     C**********           MOVE 'D'       RECI
044640200529     C********** RECI      CHAINSDBRTDD0             99    (99 = EOF)
044650200529     C***99*****           SETON                     U7LR  ** DB ERROR 98
044660200529     C***99*****           MOVEL'SDBRTDPD'DBFILE
044670200529     C***99*****           MOVELRECI      DBKEY
044680200529     C***99*****           Z-ADD98        DBASE
044690200529     C***99*****           EXSR *PSSR
044700200529     C*
044710200529     C**********           MOVE ACOD1     ACOD                            130468
044720200529     C/COPY WNCPYSRC,RE3664C110
044730200529     C**********           MOVE '01'      ACSQ                            130468
044740200529     C/COPY WNCPYSRC,RE3664C111
044750200529     C**********           Z-ADD0         ACNO                            130468
044760200529     C**********           Z-ADDRUND      PSTD                            130468
044770200529     C**********           Z-ADD91060     TRAT                            130468
044780200529     C**********           MOVEL'BRT '    @PNARX 12
044790200529     C**********           MOVE 'INTEREST'@PNARX
044800200529     C**********           MOVEL@PNARX    NARS
044810200529     C**********           MOVELNAR,#     INPNAR                          130468
044820200529     C**********           MOVELNR16,#    INP16                           130468
044830200529     C**********           MOVELDN07,#    INP07                           130468
044840200529     C**********           MOVELMGD,#     ##MGID                   S01522 130468
044850200529     C*
044860200529     C**********           Z-SUBBRTAMT    WPSTA                           130468
044870200529     C**********           MOVE '1'       DRCR
044880200529     C*********************MOVE BCNUM     ASOC                            080978
044890200529     C**********           Z-ADD0         CHQN                            130468
044900200529     C**********           MOVE ABRCA     BRCA                            130468
044910200529     C**********           Z-ADD0         REJC                            130468
044920200529     C*************        MOVE '000'     DPMT                            105084
044930200529     C**********           MOVE '   '     DPMT                      105084130468
044940200529     C**********           Z-ADD0         RRNM                            130468
044950200529     C**********           MOVE 'P'       RECI
044960200529     C*
044970200529     C**********           MOVE 'C'       GETP                            130468
044980200529     C**********           Z-ADD0         ACUM                            130468
044990200529     C**********           Z-ADD235959    PTIM                            130468
045000200529     C**********           Z-ADD0         VOIN                            130468
045010200529     C**********           Z-ADD0         LTAI                            130468
045020200529     C**********           Z-ADD0         DBCNUM                          130468
045030200529     C**********           MOVEL'91060'   OTTP                            130468
045040200529     C**********           Z-ADD0         SDCB                            130468
045050200529     C**********           Z-ADD0         SDLB                            130468
045060200529     C**********           Z-ADD1         NITMS                           130468
045070200529     C**********           Z-ADD0         CHGA                            130468
045080200529     C*
045090200529     C**********           EXSR PLPR                                      130468
045100200529     C**********           END                                            130468
045110200529     C/COPY WNCPYSRC,RE3664C057
045120200529      *                                                                                     AR831847
045130200529      ** Restore value of CAIC before reduction of taxes                                    AR831847
045140200529      *                                                                                     AR831847
045150200529     C           CER048    IFEQ 'Y'                                                         AR831847
045160200529     C           WSV01     ANDEQ'Y'                                                         AR831847
045170200529     C                     Z-ADDSVCAIC    CAIC                                              AR831847
045180200529     C                     Z-SUBSVCAIC    @WPSTA                                            AR831847
045190200529     C                     ENDIF                                                            AR831847
045200200529      *                                                                                     AR831847
045210200529     C*
045220200529     C           SCCI      IFNE *BLANK                     - B1
045230200529     C/COPY WNCPYSRC,RE3664C224
045240200529     C                     Z-ADDCAPC      ACOD
045250200529     C/COPY WNCPYSRC,RE3664C127
045260200529     C                     MOVE WCAPCT    ATYP
045270200529     C*
045280200529     C* PROFIT AND LOSS PROCESSING
045290200529     C*
045300200529     C**********           Z-ADD@WPSTA    WPSTA
045310200529     C                     Z-SUB@WPSTA    WPSTA
045320200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
045330200529     C                     MOVELCAPC      OTST                            CRE008
045340200529     C                     MOVE 'CAPC'    OTST                            CRE008
045350200529     C**********           ENDIF                                                     261620 MD022635
045360200529     C**********           Z-ADD@INDX     #                                           135809 135809R
045370200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
045380200529     C                     Z-ADD@INDX     #                                                 AR978914
045390200529     C**********           MOVELNAR,2     INPNAR                   071428 135809
045400200529     C**********           MOVELNR16,2    INP16                    071428 135809
045410200529     C**********           MOVELDN07,2    INP07                    071428 135809
045420200529     C**********           MOVELNAR,#     INPNAR                                      135809 135809R
045430200529     C**********           MOVELNR16,#    INP16                                       135809 135809R
045440200529     C                     MOVELNAR,#     INPNAR                                            AR978914
045450200529     C                     MOVELNR16,#    INP16                                             AR978914
045460200529     C**********           MOVELMGD,#     ##MGID                                     189038 AR577206
045470200529     C**********           MOVELDN07,#    INP07                                       135809 135809R
045480200529     C**********           MOVELNAR,2     INPNAR                                    135809R AR978914
045490200529     C**********           MOVELNR16,2    INP16                                     135809R AR978914
045500200529     C**********           MOVELDN07,2    INP07                                     135809R AR978914
045510200529     C                     MOVELDN07,#    INP07                                             AR978914
045520200529     C                     ENDIF                                                            MD045460
045530200529     C**********           MOVELMGD,2     ##MGID                                   AR577206 MD022635
045540200529     C                     MOVELMGD,#     ##MGID                                            MD022635
045550200529     C/COPY WNCPYSRC,RE3664C058
045560200529     C                     MOVE 'Y'       UPDCUS                                            MD027841
045570200529     C                     EXSR PLPR
045580200529     C                     MOVE *BLANKS   UPDCUS                                            MD027841
045590200529      *                                                                   CRE008
045600200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
045610200529     C                     MOVEL*BLANK    OTST                            CRE008
045620200529     C**********           ENDIF                                                     261620 MD022635
045630200529     C                     END                             - E0
045640200529      *                                                                   091680
045650200529     C                     END                             - E1           091680
045660200529     C*
045670200529     C/COPY WNCPYSRC,RE3664CP11                                           S01408
045680200529     C*                                                                   S01408
045690200529     C* SETUP CAPITALISATION RECORD PROCESSING
045700200529     C*
045710200529     C                     EXSR SSETUP
045720200529     C*
045730200529     C***********          END                             - E1           091680
045740200529     C*
045750200529     C/COPY WNCPYSRC,RE3664CCP7                                           S01408
045760200529     C*                                                                   S01408
045770200529     C                     ENDSR                           **CREPR ENDSR**
045780200529     C********************************************************************
045790200529     C/COPY WNCPYSRC,RE3664C128
045800200529     C/EJECT
045810200529     C********************************************************************
045820200529     C**
045830200529     C** ZDATE2  Subroutine to convert day number to date format
045840200529     C**
045850200529     C**       Called by
045860200529     C**
045870200529     C**       Calls       -
045880200529     C**
045890200529     C/COPY ZSRSRC,ZDATE2Z2
045900200529     C*
045910200529     C********************************************************************
045920200529     C/EJECT
045930200529     C********************************************************************
045940200529     C**
045950200529     C** ZDATE1  Subroutine to validate and convert date to a day no.
045960200529     C**
045970200529     C**       Called by
045980200529     C**
045990200529     C**       Calls       -
046000200529     C**
046010200529     C/COPY ZSRSRC,ZDATE1Z2
046020200529     C*
046030200529     C********************************************************************
046040200529     C/EJECT
046050200529     C********************************************************************
046060200529     C**
046070200529     C** ZCHKH  Subroutine to check if holiday
046080200529     C**
046090200529     C**       Called by
046100200529     C**
046110200529     C**       Calls       -
046120200529     C**
046130200529     C/COPY ZSRSRC,ZCHKH
046140200529     C*
046150200529     C********************************************************************
046160200529     C/EJECT
046170200529     C********************************************************************
046180200529     C**
046190200529     C** ZACCH  Access the holiday file
046200200529     C**
046210200529     C**       Called by
046220200529     C**
046230200529     C**       Calls       -
046240200529     C**
046250200529     C/COPY ZSRSRC,ZACCH
046260200529     C*
046270200529     C********************************************************************
046280200529     C/EJECT
046290200529     C********************************************************************
046300200529     C**
046310200529     C** *PSSR subroutine for database error handling
046320200529     C**
046330200529     C**     Called by       FIRST
046340200529     C**     Calls           -
046350200529     C**
046360200529      *****************************************************************   CCB003
046370200529     C           *PSSR     BEGSR                           **PSSR BEGSR**
046380200529     C/COPY WNCPYSRC,RE3664C175
046390200529     C*
046400200529     C                     OPEN RE3664AU                                  CCB003
046410200529     C/COPY WNCPYSRC,RE3664C176
046420200529     C                     WRITEHEADAU                                    CCB003
046430200529      *                                                                   CCB003
046440200529     C           @RUN      IFEQ *BLANKS
046450200529     C                     MOVE 'Y'       @RUN    1
046460200529     C                     DUMP
046470200529     C                     END
046480200529     C                     MOVE '1'       *INU7
046490200529     C                     MOVE '1'       *INU8
046500200529     C                     MOVE '1'       *INLR
046510200529     C                     WRITEERRAU
046520200529      *                                                                   CCB003
046530200529     C                     CLOSERE3664AU                                  CCB003
046540200529     C*
046550200529     C                     RETRN
046560200529     C*
046570200529     C                     ENDSR                           **PSSR ENDSR**
046580200529     C********************************************************************
046590200529     C/EJECT
046600200529     C********************************************************************
046610200529     C**
046620200529     C** DCIND subroutine to execute checking debit/credit indicator
046630200529     C**
046640200529     C**     Called by       ALTPR,SUSPR
046650200529     C**     Calls           -
046660200529     C**
046670200529      *****************************************************************   CCB003
046680200529     C           DCIND     BEGSR                           **DCIND BEGSR**
046690200529     C*
046700200529     C           WDRCR     IFEQ '0'                        - B1
046710200529     C                     MOVE 'S'       SDCI
046720200529     C                     ELSE                            - X1
046730200529     C           WDRCR     IFEQ '1'                        - B2
046740200529     C                     MOVE 'S'       SCCI
046750200529     C                     ELSE                            - X2
046760200529     C           WDRCR     IFEQ '2'                        - B3
046770200529     C                     MOVE 'S'       SCHGI
046780200529     C                     END                             - E3
046790200529     C                     END                             - E2
046800200529     C                     END                             - E1
046810200529     C*
046820200529     C                     ENDSR                           **DCIND ENDSR**
046830200529     C********************************************************************
046840200529     C/EJECT
046850200529     C********************************************************************
046860200529     C**
046870200529     C** DEBPR subroutine to execute debit processing
046880200529     C**
046890200529     C**     Called by       MAIN
046900200529     C**     Calls           ACCPR,ALTPR,PLPR,SSETUP,SUSPR
046910200529     C**
046920200529      *****************************************************************   CCB003
046930200529     C           DEBPR     BEGSR                           **DEBPR BEGSR**
046940200529     C*
046950200529     C                     MOVE '0'       WDRCR
046960200529     C/COPY WNCPYSRC,RE3664C161
046970200529     C           DAIC      IFNE 0                          - B0
046980200529     C                     Z-ADDDAIC      WPSTA
046990200529     C*********************Z-ADDBCNUM     ASOC                            080978
047000200529     C                     ADD  DAIC      RDAIC
047010200529     C/COPY WNCPYSRC,RE3664C129
047020200529     C*
047030200529     C           SHISD     IFEQ CNDID                      - B1
047040200529     C/COPY WNCPYSRC,RE3664C218
047050200529      *                                                                   104489
047060200529     C           BDICI     IFNE 'C'                                       104489
047070200529     C                     ADD  REGLIS    WPSTA
047080200529     C                     ADD  REGLIS    RDAIC
047090200529     C                     MOVELNAR,2     INPNAR
047100200529     C                     MOVELNR16,2    INP16
047110200529     C                     MOVELDN07,2    INP07                           S01522
047120200529     C                     MOVELMGD,2     ##MGID
047130200529     C                     END                             - E2           104489
047140200529     C/COPY WNCPYSRC,RE3664C013
047150200529     C***********          ELSE                            - X1           104489
047160200529     C*                                                                   084082
047170200529     C***Default*narrative to 'BRT INTERESTI'                      084082 130468
047180200529     C**********           Z-ADD10        #                        084082 130468
047190200529     C*                                                                   057048
047200200529     C** IF CLOSURE CHANGE NARRATIVE                                      057048
047210200529     C           BDICI     IFEQ 'C'                                       057048
047220200529     C***********BCICI     OREQ 'C'                                057048 094681
047230200529     C           SDICI     ANDEQ'C'                                       094681
047240200529     C***********          MOVELNAR,11    NAR1                      057048087513
047250200529     C***********          Z-ADD11        #                         057048087513
047260200529     C***********          MOVELNR16,#    INP16                     057048087513
047270200529     C***********          MOVELDN07,#    INP07                     057048087513
047280200529     C***********          MOVELNAR,2     INPNAR                    087513088273
047290200529     C***********          MOVELNR16,2    INP16                     087513088273
047300200529     C***********          MOVELDN07,2    INP07                     087513088273
047310200529     C                     Z-ADD11        #                               088273
047320200529     C                     MOVELNAR,#     INPNAR                          088273
047330200529     C                     MOVELNR16,#    INP16                           088273
047340200529     C                     MOVELDN07,#    INP07                           088273
047350200529     C                     MOVELMGD,#     ##MGID                          189038
047360200529     C/COPY WNCPYSRC,RE3664C185
047370200529     C                     END                                            104489
047380200529      *                                                                   104489
047390200529     C                     ELSE                                           057048
047400200529     C                     MOVELNAR,1     INPNAR
047410200529     C                     MOVELNR16,1    INP16
047420200529     C                     MOVELDN07,1    INP07
047430200529     C                     MOVELMGD,1     ##MGID                          S01522
047440200529     C*
047450200529     C**  IF ADJUST INTEREST THEN SEND ON CHARGE OR PRODUCT
047460200529     C*
047470200529     C           SDCI      IFEQ 'S'
047480200529     C                     MOVE 'L'       SDCI
047490200529     C                     END
047500200529     C***********          END                                     057048 104489
047510200529     C*
047520200529     C/COPY WNCPYSRC,RE3664C014
047530200529     C                     END                             - E1
047540200529     C/COPY WNCPYSRC,RE3664C200
047550200529      *                                                                   CAC001
047560200529      **  Initially set profit centre to be profit centre of main a/c     CAC001
047570200529      *                                                                   CAC001
047580200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
047590200529     C                     MOVE WMPRFC    PRFC                            CAC001
047600200529     C                     ENDIF                                          CAC001
047610200529     C*
047620200529     C/COPY WNCPYSRC,RE3664CP14                                           S01408
047630200529      *                                                                   S01408
047640200529     C           ZZ007     IFEQ *BLANKS                                                       CER049
047650200529     C                     MOVE 'DEB INT' ZZ007                                               CER049
047660200529     C                     END                                                                CER049
047670200529     C** CHECK ON REFERENCE DEBIT CAPITALISATION INDICATOR :
047680200529     C** Y OR I = ACCOUNT PROCESSING
047690200529     C** S      = SUSPENSE PROCESSING
047700200529     C** A      = ALTERNATE PROCESSING
047710200529     C*
047720200529     C           SDCI      CASEQ'Y'       ACCPR
047730200529     C           SDCI      CASEQ'I'       ACCPR
047740200529     C           SDCI      CASEQ'S'       SUSPR
047750200529     C           SDCI      CASEQ'L'       SUSPR
047760200529     C           SDCI      CASEQ'O'       SUSPR
047770200529     C           SDCI      CASEQ'A'       ALTPR
047780200529     C                     END
047790200529     C/COPY WNCPYSRC,RE3664C092
047800200529     C           ZZ007     IFEQ 'DEB INT'                                                     CER049
047810200529     C                     MOVE *BLANKS   ZZ007                                               CER049
047820200529     C                     END                                                                CER049
047830200529     C*
047840200529     C           SDCI      IFNE *BLANK                     - B1
047850200529     C/COPY WNCPYSRC,RE3664C225
047860200529     C                     Z-ADDCAPD      ACOD
047870200529     C/COPY WNCPYSRC,RE3664C130
047880200529     C                     MOVE WCAPDT    ATYP
047890200529     C                     Z-SUBWPSTA     WPSTA
047900200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
047910200529     C                     MOVELCAPD      OTST                            CRE008
047920200529     C                     MOVE 'CAPD'    OTST                            CRE008
047930200529     C**********           ENDIF                                                     261620 MD022635
047940200529     C*
047950200529     C* PROFIT AND LOSS PROCESSING
047960200529     C*
047970200529     C                     MOVE 'Y'       UPDCUS                                            MD027841
047980200529     C                     EXSR PLPR
047990200529     C                     MOVE *BLANKS   UPDCUS                                            MD027841
048000200529     C/COPY WNCPYSRC,RE3664C226
048010200529      *                                                                   CRE008
048020200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
048030200529     C                     MOVEL*BLANK    OTST                            CRE008
048040200529     C**********           ENDIF                                                     261620 MD022635
048050200529     C                     END                             - E0
048060200529      *                                                                   091680
048070200529     C                     END                             - E1           091680
048080200529     C/COPY WNCPYSRC,RE3664C169
048090200529     C*
048100200529     C* SETUP CAPITALISATION RECORD PROCESSING
048110200529     C*
048120200529     C                     EXSR SSETUP
048130200529     C*
048140200529     C***********          END                             - E1           091680
048150200529     C*
048160200529     C/COPY WNCPYSRC,RE3664CCP8                                           S01408
048170200529     C*                                                                   S01408
048180200529     C                     ENDSR                           **DEBPR ENDSR**
048190200529     C********************************************************************
048200200529     C/EJECT
048210200529     C********************************************************************
048220200529     C**
048230200529     C** FIRST subroutine to execute first cycle.
048240200529     C**
048250200529     C**     Called by       S T A R T
048260200529     C**     Calls           *PSSR,INITPR
048270200529     C**
048280200529      *****************************************************************   CCB003
048290200529     C           FIRST     BEGSR                           **FIRST BEGSR**
048300200529     C*
048310200529     C           *NAMVAR   DEFN           LDA
048320200529     C*
048330200529     C           *NAMVAR   DEFN RUNDAT    RUNDT
048340200529     C                     IN   RUNDT
048350200529     C*
048360200529     C/COPY WNCPYSRC,RE3664CP10                                           S01408
048370200529      *                                                                                       CDL013
048380200529      ** Check if CDL013 is installed                                                         CDL013
048390200529     C                     CALL 'AOSARDR0'                                                    CDL013
048400200529     C                     PARM *BLANKS   @RTCD   7                                           CDL013
048410200529     C                     PARM '*VERIFY' @OPTN   7                                           CDL013
048420200529     C                     PARM 'CDL013'  @SARD   6                                           CDL013
048430200529     C                     PARM           DSFDY                                               CDL013
048440200529      *                                                                                       CDL013
048450200529      ** If CDL013 NOT installed, set CAR indicator to '0'                                    CDL013
048460200529     C           @RTCD     IFNE *BLANKS                                                       CDL013
048470200529     C                     MOVE '0'       CDL013  1                                           CDL013
048480200529      *                                                                                       CDL013
048490200529      ** If CDL013 installed                                                                  CDL013
048500200529     C                     ELSE                                                               CDL013
048510200529      *                                                                                       CDL013
048520200529      ** Set CAR indicator to '1' and declare work field to                                   CDL013
048530200529      ** access WHT ICD extension file.                                                       CDL013
048540200529     C                     MOVE '1'       CDL013                                              CDL013
048550200529     C                     MOVEL'RETAIL'  WTYPE  10 P                                         CDL013
048560200529      ***************************************************************                CDL013 CRE083BE
048570200529      ***Open*&*access*WHT*ICD*extension*file*to*retrieve*WHT*rate***                CDL013 CRE083BE
048580200529     C**********           OPEN SDSTAAL1                                             CDL013 CRE083BE
048590200529     C********** WTYPE     CHAINSDSTAAL1             40                              CDL013 CRE083BE
048600200529      ***************************************************************                CDL013 CRE083BE
048610200529      ***If*CHAIN*failed,*terminate*the*program**********************                CDL013 CRE083BE
048620200529     C********** *IN40     IFEQ '1'                                                  CDL013 CRE083BE
048630200529     C********** *LOCK     IN   LDA                                                  CDL013 CRE083BE
048640200529     C**********           MOVEL'SDSTAAL1'DBFILE           ************              CDL013 CRE083BE
048650200529     C**********           MOVELWTYPE     DBKEY            * DBERR 141*              CDL013 CRE083BE
048660200529     C**********           Z-ADD141       DBASE            ************              CDL013 CRE083BE
048670200529     C**********           OUT  LDA                                                  CDL013 CRE083BE
048680200529     C**********           EXSR *PSSR                                                CDL013 CRE083BE
048690200529     C**********           ENDIF                                                     CDL013 CRE083BE
048700200529      ***************************************************************                CDL013 CRE083BE
048710200529      ***Open*WHT*Customer*History*file,*Retail*WHT*Extract*file,****                CDL013 CRE083BE
048720200529      ***Account*Details*Extension*file*&*Account*Code*Extension*file.               CDL013 CRE083BE
048730200529     C**********           OPEN GLWHTCL0                                             CDL013 CRE083BE
048740200529     C**********           OPEN GLXTAXL0                                             CDL013 CRE083BE
048750200529     C**********           OPEN ACCNTBY0                                             CDL013 CRE083BE
048760200529     C**********           OPEN SDACOAL0                                             CDL013 CRE083BE
048770200529      *                                                                                       CDL013
048780200529     C                     ENDIF                                                              CDL013
048790200529     C*                                                                   S01408
048800200529     C** SET UP INDICATOR 98 BASED ON THE DATE FORMAT.
048810200529     C*
048820200529     C           DATF      IFEQ 'M'
048830200529     C                     MOVE '1'       *IN98
048840200529     C                     ELSE
048850200529     C                     MOVE '0'       *IN98
048860200529     C                     END
048870200529     C*
048880200529     C                     SETON                     41
048890200529     C*
048900200529     C** INITIALISE LDA VARIABLES
048910200529     C*
048920200529     C***********          MOVE 'RE3664  'DBPGM                           CCB003
048930200529     C                     MOVEL'RE3664'  DBPGM     P                     CCB003
048940200529     C                     MOVE *BLANKS   DBFILE
048950200529     C                     MOVE *BLANKS   DBKEY
048960200529     C*
048970200529     C           MBIN      IFEQ 'Y'
048980200529     C                     SETON                     79
048990200529     C                     ELSE
049000200529     C                     SETOF                     79
049010200529     C                     END
049020200529     C*
049030200529     C***Ensure*Report*Spool*File*Recorded*by*RCF                         CCB003
049040200529     C***********                                                         CCB003
049050200529     C***********          Z-ADDSFNUMU    ZSNUMU  60                      CCB003
049060200529     C***********          CALL 'ZSFILE'                                  CCB003
049070200529     C***********          PARM *BLANKS   @SEQ    5                       CCB003
049080200529     C***********          PARM BBRCA     SENTY   3                       CCB003
049090200529     C***********          PARM           SFILEU                          CCB003
049100200529     C***********          PARM           ZSNUMU                          CCB003
049110200529     C***********          PARM *BLANKS   ZSERRU  1                       CCB003
049120200529     C***********                                                         CCB003
049130200529     C***Error*During*ZSFILE*Processing,*Return*to*Calling*Program        CCB003
049140200529     C***********                                                         CCB003
049150200529     C***********ZSERRU    IFEQ 'Y'                                       CCB003
049160200529     C***********          MOVE '1'       *INU7                           CCB003
049170200529     C***********          MOVE '1'       *INU8                           CCB003
049180200529     C***********          MOVE '1'       *INLR                           CCB003
049190200529     C************LOCK     IN   LDA                                       CCB003
049200200529     C***********          MOVEL'ZSFILE  'DBFILE           ***************CCB003
049210200529     C***********          MOVELBBRCA     DBKEY            * DB ERROR 36 *CCB003
049220200529     C***********          Z-ADD36        DBASE            ***************CCB003
049230200529     C***********          OUT  LDA                                       CCB003
049240200529     C*********************WRITEERRP1                                     088181
049250200529     C***********          EXSR *PSSR                                     CCB003
049260200529     C***********          RETRN                                          CCB003
049270200529     C***********          END                                            CCB003
049280200529     C*
049290200529     C** ACCESS SDMMODPD  TO CHECK IF CANTONAL TAX IS USED OR NOT
049300200529     C*
049310200529     C                     CALL 'AOMMODR0'
049320200529     C                     PARM *BLANKS   @RTCD   7
049330200529     C                     PARM '*FIRST ' @OPTN   7
049340200529     C           SDMMOD    PARM SDMMOD    DSFDY
049350200529     C           @RTCD     IFNE *BLANK
049360200529     C           *LOCK     IN   LDA
049370200529     C                     MOVEL'SDMMODPD'DBFILE           ***************
049380200529     C***********          MOVEL@OPTN     DBKEY            * DBERROR 083 *CRE002
049390200529     C***********          Z-ADD083       DBASE            ***************CRE002
049400200529     C                     MOVEL@OPTN     DBKEY            * DBERROR 033 *CRE002
049410200529     C                     Z-ADD033       DBASE            ***************CRE002
049420200529     C                     OUT  LDA
049430200529     C                     EXSR *PSSR
049440200529     C                     END
049450200529      *                                                                   CAC001
049460200529      **  Access PF/SDPCACPD for Profit Centre Accounting ICD IF          CAC001
049470200529      **  Analytical Accounting is installed                              CAC001
049480200529      *                                                                   CAC001
049490200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
049500200529      *                                                                   CAC001
049510200529     C                     CALL 'AOPCACR0'                                CAC001
049520200529     C                     PARM '*MSG   ' @RTCD                           CAC001
049530200529     C                     PARM '*FIRST ' @OPTN                           CAC001
049540200529     C           SDPCAC    PARM SDPCAC    DSFDY                           CAC001
049550200529      *                                                                   CAC001
049560200529     C           @RTCD     IFNE *BLANK                                    CAC001
049570200529     C           *LOCK     IN   LDA                                       CAC001
049580200529     C                     MOVEL'SDPCACPD'DBFILE           ************   CAC001
049590200529     C                     MOVEL@OPTN     DBKEY            * DBER 200 *   CAC001
049600200529     C                     Z-ADD200       DBASE            ************   CAC001
049610200529     C                     OUT  LDA                                       CAC001
049620200529     C                     EXSR *PSSR                                     CAC001
049630200529     C                     ENDIF                                          CAC001
049640200529      *                                                                   CAC001
049650200529     C                     ENDIF                                          CAC001
049660200529     C/COPY WNCPYSRC,REH00425
049670200529      *                                                                   S01522
049680200529      * Call SAR prog. for switchable feature                             S01522
049690200529     C           BGN1ST    IFEQ 'Y'                        B1             S01522
049700200529     C/COPY WNCPYSRC,REH00426
049710200529     C                     CALL 'AOSARDR0'                  1             S01522
049720200529     C                     PARM '       ' @RTCD             1             S01522
049730200529     C                     PARM '*VERIFY' @OPTN             1             S01522
049740200529     C                     PARM 'REPNAR'  @SARD   6         1             S01522
049750200529     C           SCSARD    PARM SCSARD    DSFDY             1             S01522
049760200529     C           @RTCD     IFNE *BLANK                     B2             S01522
049770200529     C           @RTCD     ANDNE'*NRF   '                   2             S01522
049780200529     C           *LOCK     IN   LDA                         2             S01522
049790200529     C                     MOVEL'SCSARDPD'DBFILE            ************* S01522
049800200529     C***********          MOVEL'067'     DBASE       *DBERROR 067* S01522CRE002
049810200529     C                     Z-ADD034       DBASE             *DBERROR 034  CRE002
049820200529     C                     MOVEL@SARD     DBKEY             ************* S01522
049830200529     C                     OUT  LDA                                       S01522
049840200529     C                     EXSR *PSSR                       2             S01522
049850200529     C                     END                             E2             S01522
049860200529     C           @RTCD     IFEQ *BLANK                     B2             S01522
049870200529     C                     MOVEL'Y'       REPNAR  1         2             S01522
049880200529     C                     END                             E2             S01522
049890200529     C                     END                             E1             S01522
049900200529     C/COPY WNCPYSRC,REH00168
049910200529     C*
049920200529     C* Tax installed access Tax ICD for rate. Default is ZERO.
049930200529     C*
049940200529     C                     Z-ADD0         TXWTRR
049950200529      *                                                                   CPB001
049960200529      **  If Private Banking Module is installed.                         CPB001
049970200529     C           BGN4ST    IFEQ 'Y'                         Begin BGN4ST  CPB001
049980200529      *                                                                   CPB001
049990200529      **  Set up Replication Processing Work field.                       CPB001
050000200529     C                     MOVE 'Y'       WUREPL  1                       CPB001
050010200529      *                                                                   CPB001
050020200529     C                     ENDIF                            End BGN4ST    CPB001
050030200529     C*                                                                   S01408
050040200529     C/COPY WNCPYSRC,RE3664CCP5                                           S01408
050050200529     C*                                                                   S01408
050060200529     C           BGNTST    IFEQ 'Y'
050070200529     C                     OPEN SDSTAXPD
050080200529     C           1         CHAINSDSTAXPD             93
050090200529     C                     CLOSESDSTAXPD
050100200529     C                     END
050110200529     C*
050120200529     C** ERROR IN SDSTAXPD
050130200529     C*
050140200529     C           *IN93     IFEQ '1'                        - B1
050150200529     C           *LOCK     IN   LDA
050160200529     C***********          Z-ADD84        DBASE            ***************CRE002
050170200529     C                     Z-ADD035       DBASE                           CRE002
050180200529     C***********          MOVE 'SDTAX'   DBFILE           **DB ERROR 84**CCB003
050190200529     C                     MOVEL'SDTAX'   DBFILE           **DB ERROR 84**CCB003
050200200529     C                     MOVEL*BLANKS   DBKEY            ***************
050210200529     C                     OUT  LDA
050220200529     C                     EXSR *PSSR
050230200529     C                     END                             - E1
050240200529     C*
050250200529     C/COPY WNCPYSRC,RE3664CCP4                                           S01408
050260200529     C*                                                                   S01408
050270200529     C** ACCESS BANK DETAILS
050280200529     C*
050290200529     C                     CALL 'AOBANKR0'
050300200529     C                     PARM '*MSG   ' @RTCD   7
050310200529     C                     PARM '*FIRST ' @OPTN   7
050320200529     C           SDBANK    PARM SDBANK    DSFDY
050330200529     C           @RTCD     IFNE *BLANK
050340200529     C           *LOCK     IN   LDA
050350200529     C                     MOVEL'SDBANKPD'DBFILE           ***************
050360200529     C***********          MOVEL@OPTN     DBKEY            * DBERROR 004 *CRE002
050370200529     C***********          Z-ADD004       DBASE            ***************CRE002
050380200529     C                     MOVEL@OPTN     DBKEY            * DB ERROR 036*CRE002
050390200529     C                     Z-ADD036       DBASE            ***************CRE002
050400200529     C                     OUT  LDA
050410200529     C                     EXSR *PSSR
050420200529     C                     END
050430200529      *                                                                   085787
050440200529      ** Setup JOB NAME title to indicate from which COB run of the       085787
050450200529      **  RE3664 this report is received.                                 085787
050460200529      *                                                                   085787
050470200529      ** Excluded from REFERENCE (JBNM1) are standard REC64A/N run        085787
050480200529      *                                                                   085787
050490200529     C                     MOVELPGJBNM    JBNM1  10                       085787
050500200529     C           PGJBNM    IFEQ REC64A                                    085787
050510200529     C           PGJBNM    OREQ REC64N                                    085787
050520200529     C                     MOVE *BLANKS   JBNM1                           085787
050530200529     C                     ENDIF                                          085787
050540200529      *                                                                   085787
050550200529      ** Print 'ALTERNATE A/Cs' if Alt Acc run being executed             085787
050560200529      *                                                                   085787
050570200529     C                     MOVE *BLANKS   JBNM2  14                       085787
050580200529     C           PGJBNM    LOKUPTAB1      TABA           99               085787
050590200529     C           *IN99     IFEQ *ON                                       085787
050600200529     C                     MOVELTABA      JBNM2                           085787
050610200529     C                     ENDIF                                          085787
050620200529     C                     MOVE *OFF      *IN99                           085787
050630200529     C*
050640200529     C/COPY WNCPYSRC,RE3664CCP6                                           S01408
050650200529     C*                                                                   S01408
050660200529     C***OUTPUT*AUDIT*HEADER                                              CCB003
050670200529     C***********                                                         CCB003
050680200529     C***********          WRITEHEADAU                                    CCB003
050690200529     C*
050700200529     C**********           CALL 'AOGELRR0'                                                    CGL029
050710200529     C                     CALL 'AOGELRR1'                                                    CGL029
050720200529     C                     PARM *BLANKS   @RTCD   7
050730200529     C                     PARM '*FIRST ' @OPTN   7
050740200529     C********** SDGELR    PARM SDGELR    DSFDY                                               CGL029
050750200529     C           SDGELR    PARM SDGELR    DSSDY                                               CGL029
050760200529     C/COPY WNCPYSRC,RE3664C207
050770200529     C           @RTCD     IFNE *BLANK
050780200529     C           *LOCK     IN   LDA
050790200529     C                     MOVEL'SDGELRPD'DBFILE           ***************
050800200529     C***********          MOVEL@OPTN     DBKEY            * DBERROR 005 *CRE002
050810200529     C***********          Z-ADD005       DBASE            ***************CRE002
050820200529     C                     MOVEL@OPTN     DBKEY            * DB ERROR 037*CRE002
050830200529     C                     Z-ADD037       DBASE            ***************CRE002
050840200529     C                     OUT  LDA
050850200529     C                     EXSR *PSSR
050860200529     C                     END
050870200529      *                                                                                     CRE083BK
050880200529      ** Full Cache SDCURRPD                                                                CRE083BK
050890200529      *                                                                                     CRE083BK
050900200529     C                     Z-ADD250       A       30                                        CRE083BK
050910200529     C**********           Z-ADD250       F       30                               CRE083BK MD021155
050920200529     C           A         OCUR SDCURR                                                      CRE083BK
050930200529     C********** F         OCUR SDRETR                                             CRE083BK MD021155
050940200529      *                                                                                     CRE083BK
050950200529     C                     OPEN SDCURRL1                                                      CGL165
050960200529     C                     READ SDCURRL1                 13                                 CRE083BK
050970200529      *                                                                                     CRE083BK
050980200529     C           *IN13     DOWEQ*OFF                                                        CRE083BK
050990200529      *          A         ANDGT1                                                           CRE083BK
051000200529     C********** A         ANDGT1                                                 AR1093681 MD021155
051010200529     C           A         ANDGT2                                                           MD021155
051020200529     C                     MOVE A6CYCD    ACUR,A                                            CRE083BK
051030200529     C                     MOVE A6NBDP    CDP                                               CRE083BK
051040200529     C                     MOVE A6SPRT    SPOT                                              CRE083BK
051050200529     C                     MOVE A6MDIN    MDIN                                              CRE083BK
051060200529     C                     MOVE A6ERLC    ERLC                                              CRE083BK
051070200529     C                     MOVE A6TXND    TNOT                                              CRE083BK
051080200529     C                     MOVE A6CYNM    CCNM                                              CRE083BK
051090200529     C                     MOVE A6SPAE    TACC                                              CRE083BK
051100200529     C                     MOVE A6SSNB    SSNO                                              CRE083BK
051110200529     C                     MOVE A6TXCR    TXCR                                              CGL165
051120200529      *                                                                                     CRE083BK
051130200529     C**********           MOVEL'   '     BLNKTR  8                                CRE083BK MD021155
051140200529     C**********           MOVE '91060'   BLNKTR                                   CRE083BK MD021155
051150200529     C**********           MOVELA6CYCD    CCYD    4                                CRE083BK MD021155
051160200529     C**********           MOVE 'D'       CCYD                                     CRE083BK MD021155
051170200529     C**********           MOVELBLNKTR    KEYTRG 12                                CRE083BK MD021155
051180200529     C**********           MOVE CCYD      KEYTRG                                   CRE083BK MD021155
051190200529     C**********           MOVE KEYTRG    ARET,F                                   CRE083BK MD021155
051200200529     C                     SUB  1         A                                                 CRE083BK
051210200529     C**********           SUB  1         F                                        CRE083BK MD021155
051220200529      *                                                                                     CRE083BK
051230200529     C           A         OCUR SDCURR                                                      CRE083BK
051240200529     C                     READ SDCURRL1                 13                                 CRE083BK
051250200529     C********** *IN13     IFEQ *ON                                               CRE083BK AR1096650
051260200529     C**********           ADD  1         A                                       CRE083BK AR1096650
051270200529     C**********           ADD  1         F                                       CRE083BK AR1096650
051280200529     C**********           ENDIF                                                  CRE083BK AR1096650
051290200529     C                     ENDDO                                                            CRE083BK
051300200529      *                                                                                     CRE083BK
051310200529      ** If count less than array size                                                     AR1096650
051320200529      *                                                                                    AR1096650
051330200529     C           *IN13     IFEQ *ON                                                        AR1096650
051340200529     C           A         ANDLT250                                                        AR1096650
051350200529     C                     ADD  1         A                                                AR1096650
051360200529     C**********           ADD  1         F                                       AR1096650 MD021155
051370200529     C                     ENDIF                                                           AR1096650
051380200529      *                                                                                    AR1096650
051390200529      ** If count is at least equal to array size                                          AR1096650
051400200529      *                                                                                    AR1096650
051410200529     C********** A         IFEQ 1                                                 AR1096650 MD021155
051420200529     C           A         IFEQ 2                                                           MD021155
051430200529     C                     MOVE A6CYCD    ACUR,A                                           AR1096650
051440200529     C                     MOVE A6NBDP    CDP                                               MD021155
051450200529     C                     MOVE A6SPRT    SPOT                                              MD021155
051460200529     C                     MOVE A6MDIN    MDIN                                              MD021155
051470200529     C                     MOVE A6ERLC    ERLC                                              MD021155
051480200529     C                     MOVE A6TXND    TNOT                                              MD021155
051490200529     C                     MOVE A6CYNM    CCNM                                              MD021155
051500200529     C                     MOVE A6SPAE    TACC                                              MD021155
051510200529     C                     MOVE A6SSNB    SSNO                                              MD021155
051520200529     C                     MOVE A6TXCR    TXCR                                              CGL165
051530200529      *                                                                                     MD021155
051540200529     C**********           MOVEL'   '     BLNKTR                                  AR1096650 MD021155
051550200529     C**********           MOVE '91060'   BLNKTR                                  AR1096650 MD021155
051560200529     C**********           MOVELA6CYCD    CCYD                                    AR1096650 MD021155
051570200529     C**********           MOVE 'D'       CCYD                                    AR1096650 MD021155
051580200529     C**********           MOVELBLNKTR    KEYTRG                                  AR1096650 MD021155
051590200529     C**********           MOVE CCYD      KEYTRG                                  AR1096650 MD021155
051600200529     C**********           MOVE KEYTRG    ARET,F                                  AR1096650 MD021155
051610200529     C                     ENDIF                                                           AR1096650
051620200529      *                                                                                    AR1096650
051630200529     C                     Z-ADDA         CUCCYA  30                                        CRE083BK
051640200529     C**********           Z-ADDF         CURETR  30                               CRE083BK MD021155
051650200529      *                                                                                     MD021155
051660200529      ** Full Cache RETRGD                                                                  MD021155
051670200529      *                                                                                     MD021155
051680200529     C                     MOVE '91060'   KYSETF  8 P                                       MD021155
051690200529     C                     MOVELKYSETF    KEYSET 12 P                                       MD021155
051700200529     C                     Z-ADD250       F       30                                        MD021155
051710200529     C                     OCUR SDRETR                                                      MD021155
051720200529      *                                                                                     MD021155
051730200529     C           KEYSET    SETLLRETRG                                                       MD021155
051740200529     C                     READ RETRG                    13                                 MD021155
051750200529      *                                                                                     MD021155
051760200529     C           *IN13     DOWEQ*OFF                                                        MD021155
051770200529     C           F         ANDGT2                                                           MD021155
051780200529      *                                                                                     MD021155
051790200529     C                     MOVELKEY       KYRETR                                            MD021155
051800200529      *                                                                                     MD021155
051810200529     C           RETRBK    IFNE '   '                                                       MD021155
051820200529     C           RETRID    ANDNE'91060'                                                     MD021155
051830200529      *                                                                                     MD021155
051840200529     C           F         IFLT 250                                                         MD021155
051850200529     C                     ADD  1         F                                                 MD021155
051860200529     C                     ENDIF                                                            MD021155
051870200529      *                                                                                     MD021155
051880200529     C                     LEAVE                                                            MD021155
051890200529     C                     ENDIF                                                            MD021155
051900200529      *                                                                                     MD021155
051910200529     C           RETRRC    IFEQ 'D'                                                         MD021155
051920200529     C                     MOVE KYRETR    ARET,F                                            MD021155
051930200529     C                     MOVE KEY       KEYD                                              MD021155
051940200529     C                     MOVE LCD       LCDD                                              MD021155
051950200529     C                     MOVE ZZ001     ZZ001D                                            MD021155
051960200529     C                     SUB  1         F                                                 MD021155
051970200529     C                     ENDIF                                                            MD021155
051980200529      *                                                                                     MD021155
051990200529     C           F         OCUR SDRETR                                                      MD021155
052000200529     C                     READ RETRG                    13                                 MD021155
052010200529     C                     ENDDO                                                            MD021155
052020200529      *                                                                                     MD021155
052030200529      ** If count less than array size                                                      MD021155
052040200529      *                                                                                     MD021155
052050200529     C           *IN13     IFEQ *ON                                                         MD021155
052060200529     C           F         ANDLT250                                                         MD021155
052070200529     C                     ADD  1         F                                                 MD021155
052080200529     C                     ENDIF                                                            MD021155
052090200529      *                                                                                     MD021155
052100200529      ** If count is at least equal to array size                                           MD021155
052110200529      *                                                                                     MD021155
052120200529     C           F         IFEQ 2                                                           MD021155
052130200529     C                     MOVELKEY       KYRETR                                            MD021155
052140200529     C           RETRBK    IFEQ '   '                                                       MD021155
052150200529     C           RETRID    ANDEQ'91060'                                                     MD021155
052160200529     C           RETRRC    ANDEQ'D'                                                         MD021155
052170200529     C                     MOVE KYRETR    ARET,F                                            MD021155
052180200529     C                     MOVE KEY       KEYD                                              MD021155
052190200529     C                     MOVE LCD       LCDD                                              MD021155
052200200529     C                     MOVE ZZ001     ZZ001D                                            MD021155
052210200529     C                     ELSE                                                             MD021155
052220200529     C                     ADD  1         F                                                 MD021155
052230200529     C                     ENDIF                                                            MD021155
052240200529     C                     ENDIF                                                            MD021155
052250200529      *                                                                                     MD021155
052260200529     C                     Z-ADDF         CURETR  30                                        MD021155
052270200529      *                                                                                     CRE083BK
052280200529      ** Full Cache SDNARRPD                                                                CRE083BK
052290200529      *                                                                                     CRE083BK
052300200529     C                     Z-ADD300       B       30                                        CRE083BK
052310200529     C           B         OCUR SDNARR                                                      CRE083BK
052320200529      *                                                                                     CRE083BK
052330200529     C                     READ SDNARRL1                 14                                 CRE083BK
052340200529      *                                                                                     CRE083BK
052350200529     C           *IN14     DOWEQ*OFF                                                        CRE083BK
052360200529     C********** B         ANDGT1                                                  CRE083BK MD021155
052370200529     C           B         ANDGT2                                                           MD021155
052380200529     C                     MOVE ALNVCD    ANAR,B                                            CRE083BK
052390200529     C                     MOVE ALDON     NARD                                              CRE083BK
052400200529     C                     SUB  1         B                                                 CRE083BK
052410200529     C           B         OCUR SDNARR                                                      CRE083BK
052420200529     C                     READ SDNARRL1                 14                                 CRE083BK
052430200529     C********** *IN14     IFEQ *ON                                               CRE083BK AR1096650
052440200529     C**********           ADD  1         B                                       CRE083BK AR1096650
052450200529     C**********           ENDIF                                                  CRE083BK AR1096650
052460200529     C                     ENDDO                                                            CRE083BK
052470200529      *                                                                                     CRE083BK
052480200529      ** If count less than array size                                                     AR1096650
052490200529      *                                                                                    AR1096650
052500200529     C           *IN14     IFEQ *ON                                                        AR1096650
052510200529     C           B         ANDLT300                                                        AR1096650
052520200529     C                     ADD  1         B                                                AR1096650
052530200529     C                     ENDIF                                                           AR1096650
052540200529      *                                                                                    AR1096650
052550200529      ** If count is at least equal to array size                                          AR1096650
052560200529      *                                                                                    AR1096650
052570200529     C********** B         IFEQ 1                                                 AR1096650 MD021155
052580200529     C           B         IFEQ 2                                                           MD021155
052590200529     C                     MOVE ALNVCD    ANAR,B                                           AR1096650
052600200529     C                     MOVE ALDON     NARD                                              MD021155
052610200529     C                     ENDIF                                                           AR1096650
052620200529      *                                                                                    AR1096650
052630200529     C                     Z-ADDB         CUNARA  30                                        CRE083BK
052640200529      *                                                                                     CRE083BK
052650200529      ** Full Cache SDBRCHPD                                                                CRE083BK
052660200529      *                                                                                     CRE083BK
052670200529     C                     Z-ADD900       C       30                                        CRE083BK
052680200529     C           C         OCUR SDBRCH                                                      CRE083BK
052690200529      *                                                                                     CRE083BK
052700200529     C                     READ SDBRCHL1                 15                                 CRE083BK
052710200529      *                                                                                     CRE083BK
052720200529     C           *IN15     DOWEQ*OFF                                                        CRE083BK
052730200529     C********** C         ANDGT1                                                  CRE083BK MD021155
052740200529     C           C         ANDGT2                                                           MD021155
052750200529     C                     MOVE A8BRCD    ABRC,C                                            CRE083BK
052760200529     C                     MOVE A8BICN    BICN                                              CRE083BK
052770200529     C                     MOVE A8DTAC    NBACB                                             CRE083BK
052780200529     C                     SUB  1         C                                                 CRE083BK
052790200529     C           C         OCUR SDBRCH                                                      CRE083BK
052800200529     C                     READ SDBRCHL1                 15                                 CRE083BK
052810200529     C********** *IN15     IFEQ *ON                                               CRE083BK AR1096650
052820200529     C**********           ADD  1         C                                       CRE083BK AR1096650
052830200529     C**********           ENDIF                                                  CRE083BK AR1096650
052840200529     C                     ENDDO                                                            CRE083BK
052850200529      *                                                                                     CRE083BK
052860200529      ** If count less than array size                                                     AR1096650
052870200529      *                                                                                    AR1096650
052880200529     C           *IN15     IFEQ *ON                                                        AR1096650
052890200529     C           C         ANDLT900                                                        AR1096650
052900200529     C                     ADD  1         C                                                AR1096650
052910200529     C                     ENDIF                                                           AR1096650
052920200529      *                                                                                    AR1096650
052930200529      ** If count is at least equal to array size                                          AR1096650
052940200529      *                                                                                    AR1096650
052950200529     C********** C         IFEQ 1                                                 AR1096650 MD021155
052960200529     C           C         IFEQ 2                                                           MD021155
052970200529     C                     MOVE A8BRCD    ABRC,C                                           AR1096650
052980200529     C                     MOVE A8BICN    BICN                                              MD021155
052990200529     C                     MOVE A8DTAC    NBACB                                             MD021155
053000200529     C                     ENDIF                                                           AR1096650
053010200529      *                                                                                    AR1096650
053020200529     C                     Z-ADDC         CUBRCA  30                                        CRE083BK
053030200529     C*
053040200529     C           BKIEMB    IFEQ 'Y'
053050200529     C*
053060200529     C** ACCESS BRANCH CODES
053070200529     C*
053080200529     C                     Z-ADDCUBRCA    C                                                 CRE083BK
053090200529     C           BKMABR    LOKUPABRC,C                   16                                 CRE083BK
053100200529      *                                                                                     CRE083BK
053110200529     C           *IN16     IFEQ '1'                                                         CRE083BK
053120200529     C           C         OCUR SDBRCH                                                      CRE083BK
053130200529     C                     ELSE                                                             CRE083BK
053140200529     C**********           CALL 'AOBRCHR0'                                                    CGL029
053150200529     C           1         OCUR SDBRCH                                                      MD021155
053160200529     C                     CALL 'AOBRCHR1'                                                    CGL029
053170200529     C                     PARM '*MSG   ' @RTCD
053180200529     C                     PARM '*KEY   ' @OPTN
053190200529     C                     PARM BKMABR    @BRCA   3
053200200529     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
053210200529     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
053220200529     C           @RTCD     IFNE *BLANK
053230200529     C           *LOCK     IN   LDA
053240200529     C                     MOVEL'SDBRCHPD'DBFILE           ***************
053250200529     C***********          MOVEL@BRCA     DBKEY            * DB ERROR 24 *CRE002
053260200529     C***********          Z-ADD24        DBASE            ***************CRE002
053270200529     C                     MOVEL@BRCA     DBKEY            * DB ERROR 038*CRE002
053280200529     C                     Z-ADD038       DBASE            ***************CRE002
053290200529     C                     OUT  LDA
053300200529     C*********************WRITEERRP1                                     088181
053310200529     C                     EXSR *PSSR
053320200529     C                     END
053330200529     C                     ENDIF                                                            CRE083BK
053340200529     C                     MOVE BICN      BKBICN
053350200529     C                     ENDIF
053360200529     C*
053370200529     C                     CALL 'AORETLR0'
053380200529     C                     PARM *BLANKS   @RTCD   7
053390200529     C                     PARM '*FIRST ' @OPTN   7
053400200529     C           SDRETL    PARM SDRETL    DSFDY
053410200529     C           @RTCD     IFNE *BLANK
053420200529     C           *LOCK     IN   LDA
053430200529     C                     MOVEL'SDRETLPD'DBFILE           ***************
053440200529     C***********          MOVEL@OPTN     DBKEY            * DBERROR 006 *CRE002
053450200529     C***********          Z-ADD006       DBASE            ***************CRE002
053460200529     C                     MOVEL@OPTN     DBKEY            * DBERROR 039 *CRE002
053470200529     C                     Z-ADD039       DBASE            ***************CRE002
053480200529     C                     OUT  LDA
053490200529     C                     EXSR *PSSR
053500200529     C                     END
053510200529      *                                                                   CCB003
053520200529      ** Access data area CBTASKSP for commit block size                  CCB003
053530200529     C           *NAMVAR   DEFN CBTASKSP  CBTASK                          CCB003
053540200529     C                     IN   CBTASK                                    CCB003
053550200529     C**********           MOVE CMTBLK    #OPTIM  60                                 CCB003 MD020687
053560200529     C                     MOVE CMTBLK    #OPTIM 100                                        MD020687
053570200529      *                                                                   CCB003
053580200529      ** Set commit counter to 1                                          CCB003
053590200529     C                     Z-ADD1         #COMIT  60                      CCB003
053600200529     C*
053610200529     C/COPY WNCPYSRC,RE3664CP15                                           S01408
053620200529      *                                                                   S01408
053630200529     C                     CALL 'AOTRADR0'
053640200529     C                     PARM *BLANKS   @RTCD   7
053650200529     C                     PARM '*FIRST ' @OPTN   7
053660200529     C           SDTRAD    PARM SDTRAD    DSFDY
053670200529     C           @RTCD     IFNE *BLANK
053680200529     C           *LOCK     IN   LDA
053690200529     C                     MOVEL'SDTRADPD'DBFILE           ***************
053700200529     C***********          MOVEL@OPTN     DBKEY            * DBERROR 007 *CRE002
053710200529     C***********          Z-ADD007       DBASE            ***************CRE002
053720200529     C                     MOVEL@OPTN     DBKEY            * DBERROR 040 *CRE002
053730200529     C                     Z-ADD040       DBASE            ***************CRE002
053740200529     C                     OUT  LDA
053750200529     C                     EXSR *PSSR
053760200529     C                     END
053770200529     C*
053780200529     C***CHECK*IF*RETAIL*NUMBER*USED                                      CCB003
053790200529     C***********                                                         CCB003
053800200529     C***********RACN      COMP 'Y'                      53               CCB003
053810200529     C*
053820200529     C** ACCESS ACCOUNT CODES
053830200529     C*
053840200529     C**********           MOVE COMS      KACOD   4                                           CGL029
053850200529     C                     MOVE COMS      KACOD                                               CGL029
053860200529     C*
053870200529     C                     ADD  1         RCSQ                                              CRE083BK
053880200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
053890200529     C                     Z-ADD041       WDBASE                                            CRE083BK
053900200529     C                     EXSR ACDCCH                                                      CRE083BK
053910200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
053920200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
053930200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
053940200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
053950200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
053960200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
053970200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
053980200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
053990200529     C********** *LOCK     IN   LDA                                                         CRE083BK
054000200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
054010200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 08 *CRE002
054020200529     C***********          Z-ADD008       DBASE            ***************CRE002
054030200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 041*           CRE002 CRE083BK
054040200529     C**********           Z-ADD041       DBASE            ***************           CRE002 CRE083BK
054050200529     C**********           OUT  LDA                                                         CRE083BK
054060200529     C**********           EXSR *PSSR                                                       CRE083BK
054070200529     C**********           END                                                              CRE083BK
054080200529     C*
054090200529     C                     MOVE A5ACTY    WCOMST
054100200529     C*
054110200529     C*
054120200529     C** ACCESS ACCOUNT CODES
054130200529     C*
054140200529     C**********           MOVE SPAC      KACOD   4                                           CGL029
054150200529     C                     MOVE SPAC      KACOD                                               CGL029
054160200529     C*
054170200529     C                     ADD  1         RCSQ                                              CRE083BK
054180200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
054190200529     C                     Z-ADD042       WDBASE                                            CRE083BK
054200200529     C                     EXSR ACDCCH                                                      CRE083BK
054210200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
054220200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
054230200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
054240200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
054250200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
054260200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
054270200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
054280200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
054290200529     C********** *LOCK     IN   LDA                                                         CRE083BK
054300200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
054310200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 12 *CRE002
054320200529     C***********          Z-ADD012       DBASE            ***************CRE002
054330200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 042*           CRE002 CRE083BK
054340200529     C**********           Z-ADD042       DBASE            ***************           CRE002 CRE083BK
054350200529     C**********           OUT  LDA                                                         CRE083BK
054360200529     C**********           EXSR *PSSR                                                       CRE083BK
054370200529     C**********           END                                                              CRE083BK
054380200529     C*
054390200529     C                     MOVE A5ACTY    WSPACT
054400200529     C*                                                                  052739
054410200529     C** INITIALIZE CONTROL DATE                                         052739
054420200529     C*                                                                  052739
054430200529     C           DNWD      SUB  1         WRK5    50                     052739
054440200529     C           WRK5      IFLE BKAPDT                                   052739
054450200529     C                     Z-ADDWRK5      CTFDAT                         052739
054460200529     C                     ELSE                                          052739
054470200529     C                     Z-ADDBKAPDT    CTFDAT                         052739
054480200529     C                     END                                           052739
054490200529     C           LDAC      IFNE 'Y'                                      052739
054500200529     C                     ADD  1         CTFDAT                         052739
054510200529     C                     END                                           052739
054520200529     C***************************************************************                       CRE083BE
054530200529     C***INITIALIZE*WORK*FIELDS**************************************                       CRE083BE
054540200529     C***************************************************************                       CRE083BE
054550200529     C**********           MOVE *BLANKS   ZZ001                                             CRE083BE
054560200529     C**********           MOVE *BLANKS   ZZ006                                             CRE083BE
054570200529     C**********           MOVE *BLANKS   ZZ009                                             CRE083BE
054580200529     C**********           MOVE *BLANKS   SWCR                                              CRE083BE
054590200529     C**********           MOVE *BLANKS   DLREF                                             CRE083BE
054600200529     C**********           MOVE *BLANKS   REBI                                              CRE083BE
054610200529     C**********           MOVE *BLANKS   FACO                                              CRE083BE
054620200529     C**********           MOVE *BLANKS   PREF                                              CRE083BE
054630200529     C**********           MOVE 'D'       ENDK                                              CRE083BE
054640200529     C**********           MOVE '-'       TIR1                                                CGL029
054650200529     C**********           MOVE '-'       TIR2                                                CGL029
054660200529     C**********           MOVE '-'       TIR3                                                CGL029
054670200529     C**********           MOVE '-'       TIR4                                                CGL029
054680200529     C**********           Z-ADD*ZEROS    NBRREC  50                                        CRE083BE
054690200529     C**********           Z-ADD*ZEROS    DBCNUM                                              CSD027
054700200529     C**********           MOVE *BLANKS   DBCNUM                                     CSD027 CRE083BE
054710200529     C**********           Z-ADD*ZEROS    CHGA                                              CRE083BE
054720200529     C**********           Z-ADD*ZEROS    DRIP                                              CRE083BE
054730200529     C**********           Z-ADD*ZEROS    CRIP                                              CRE083BE
054740200529     C*********            Z-ADD*ZEROS    PAGE                            081545
054750200529     C***********          MOVE '0'       *IN43                           CCB003
054760200529     C***********          MOVE '1'       *IN90                           075073
054770200529     C***********          MOVE '1'       *IN85                     075073081545
054780200529     C***********          MOVE '0'       *IN85                     085787CCB003
054790200529     C**********           MOVEL'91060'   OTTP                                              CRE083BE
054800200529     C***********          Z-ADD0         RECN                            CCB003
054810200529     C**
054820200529     C**   CALCULATE CONTROL DATE
054830200529     C**   ACCRUAL/PROFIT DATE IF NEEDED
054840200529     C           DNWD      SUB  1         NAPDA
054850200529     C**
054860200529     C           BKAPDT    IFLT DNWD                       - B1
054870200529     C                     Z-ADDBKAPDT    NAPDA
054880200529     C                     END                             - E1
054890200529     C*
054900200529     C** READ DEFAULT LANGUAGE CODE (SCUNT)
054910200529     C*
054920200529     C***********          Z-ADD40        DBASE                           CRE002
054930200529     C                     Z-ADD043       DBASE            * DBERROR 043 *CRE002
054940200529     C                     MOVE BJLANG    BJLANG  2
054950200529     C*
054960200529     C**   READ BASIC LANGUAGE CODE FOR BANK
054970200529     C*
054980200529     C                     CALL 'AOBANKR0'
054990200529     C                     PARM '*MSG   ' @RTCD   7
055000200529     C                     PARM '*FIRST ' @OPTN   7
055010200529     C           SDBANK    PARM SDBANK    DSFDY
055020200529     C           @RTCD     IFNE *BLANK
055030200529     C           *LOCK     IN   LDA
055040200529     C                     MOVEL'SDBANKPD'DBFILE           ***************
055050200529     C***********          MOVEL@OPTN     DBKEY            * DBERROR 005 *CRE002
055060200529     C***********          Z-ADD005       DBASE            ***************CRE002
055070200529     C                     MOVEL@OPTN     DBKEY            * DBERROR 044 *CRE002
055080200529     C                     Z-ADD044       DBASE            ***************CRE002
055090200529     C                     OUT  LDA
055100200529     C                     EXSR *PSSR
055110200529     C                     END
055120200529     C*
055130200529     C                     MOVELBJLANG    XCUNT   2
055140200529     C/COPY WNCPYSRC,RE3664C133
055150200529      *                                                                   CRE002
055160200529      ** Check if Overdraft Interest Calculations feature is on           CRE002
055170200529      *                                                                   CRE002
055180200529     C                     MOVE 'N'       CRE002  1                       CRE002
055190200529     C                     MOVE '0'       *IN31                           CRE002
055200200529      *                                                                   CRE002
055210200529     C                     CALL 'AOSARDR0'                                CRE002
055220200529     C                     PARM *BLANKS   @RTCD   7                       CRE002
055230200529     C                     PARM '*VERIFY' @OPTN   7                       CRE002
055240200529     C                     PARM 'CRE002'  @SARD   6                       CRE002
055250200529      *                                                                   CRE002
055260200529     C           @RTCD     IFNE *BLANKS                                   CRE002
055270200529     C           @RTCD     ANDNE'*NRF   '                                 CRE002
055280200529     C                     SETON                     U7U8LR               CRE002
055290200529     C                     MOVEL'CRE002'  DBKEY                           CRE002
055300200529     C                     MOVE 'SCSARDPD'DBFILE           ***************CRE002
055310200529     C                     Z-ADD047       DBASE            * DBERR0R 047 *CRE002
055320200529     C                     EXSR *PSSR                      ***************CRE002
055330200529     C                     END                                            CRE002
055340200529      *                                                                   CRE002
055350200529     C           @RTCD     IFEQ *BLANKS                                   CRE002
055360200529     C                     MOVE 'Y'       CRE002                          CRE002
055370200529     C                     MOVE '1'       *IN31                           CRE002
055380200529     C                     END                                            CRE002
055390200529     C*                                                                   CRE008
055400200529     C** DETERMINE IF CASH MANAGEMENT IS INSTALLED                        CRE008
055410200529     C**                                                                  CRE008
055420200529     C                     CALL 'AOSARDR0'                                CRE008
055430200529     C                     PARM '       ' @RTCD                           CRE008
055440200529     C                     PARM '*VERIFY' @OPTN                           CRE008
055450200529     C                     PARM 'CRE008'  @SARD                           CRE008
055460200529      *                                                                   CRE008
055470200529     C           @RTCD     IFNE *BLANK                                    CRE008
055480200529     C           @RTCD     ANDNE'*NRF   '                                 CRE008
055490200529     C                     SETON                     U7U8LR               CRE008
055500200529     C                     MOVEL@RTCD     DBKEY                           CRE008
055510200529     C                     MOVEL'SCSARDPD'DBFILE           ***************CRE008
055520200529     C                     Z-ADD210       DBASE            * DBERROR 210 *CRE008
055530200529     C                     OUT  LDA                        ***************CRE008
055540200529     C                     EXSR *PSSR                                     CRE008
055550200529     C                     END                                            CRE008
055560200529      *                                                                   CRE008
055570200529     C           @RTCD     IFEQ *BLANK                                    CRE008
055580200529     C                     MOVEL'Y'       CRE008  1                       CRE008
055590200529     C**********           OPEN REGAHLJ2                                             CRE008 CRE083BE
055600200529     C**********           OPEN REZSHLJ2                                             CRE008 CRE083BE
055610200529     C**********           OPEN RECIEUL2                                             217910 CRE083BE
055620200529     C                     END                                            CRE008
055630200529      *                                                                                       CGL031
055640200529      ** Check if CGL031 is enabled.                                                          CGL031
055650200529      *                                                                                       CGL031
055660200529     C                     CALL 'AOSARDR0'                                                    CGL031
055670200529     C                     PARM *BLANKS   PRTCD   7                                           CGL031
055680200529     C                     PARM '*VERIFY' POPTN   7                                           CGL031
055690200529     C                     PARM 'CGL031'  PSARD   6                                           CGL031
055700200529     C           SCSARD    PARM SCSARD    DSFDY                                               CGL031
055710200529      *                                                                                       CGL031
055720200529     C                     MOVE 'N'       CGL031  1                                           CGL031
055730200529      *                                                                                       CGL031
055740200529     C           PRTCD     IFEQ *BLANKS                                                       CGL031
055750200529     C                     MOVE 'Y'       CGL031                                              CGL031
055760200529     C                     ELSE                                                               CGL031
055770200529      *                                                                                       CGL031
055780200529     C           PRTCD     IFNE '*NRF   '                                                     CGL031
055790200529     C           *LOCK     IN   LDA                                                           CGL031
055800200529     C                     MOVEL'SCSARDPD'DBFILE                                              CGL031
055810200529     C                     MOVEL'CGL031'  DBKEY                                               CGL031
055820200529     C                     Z-ADD301       DBASE                                               CGL031
055830200529     C                     OUT  LDA                                                           CGL031
055840200529     C                     EXSR *PSSR                                                         CGL031
055850200529     C                     ENDIF                                                              CGL031
055860200529      *                                                                                       CGL031
055870200529     C                     ENDIF                                                              CGL031
055880200529      *                                                                                       CGL031
055890200529      ** Access the Swiss ICD if necessary.                                                   CGL031
055900200529      *                                                                                       CGL031
055910200529     C           CGL031    IFEQ 'Y'                                                           CGL031
055920200529     C           BGNTST    ANDNE'Y'                                                           CGL031
055930200529      *                                                                                       CGL031
055940200529     C                     OPEN SDSTAXPD                                                      CGL031
055950200529     C           1         CHAINSDSTAXPD             84                                       CGL031
055960200529     C                     CLOSESDSTAXPD                                                      CGL031
055970200529      *                                                                                       CGL031
055980200529     C           *IN84     IFEQ *ON                                                           CGL031
055990200529     C           *LOCK     IN   LDA                                                           CGL031
056000200529     C                     MOVEL'SDSTAXPD'DBFILE                                              CGL031
056010200529     C                     MOVE *BLANKS   DBKEY                                               CGL031
056020200529     C                     Z-ADD302       DBASE                                               CGL031
056030200529     C                     OUT  LDA                                                           CGL031
056040200529     C                     EXSR *PSSR                                                         CGL031
056050200529     C                     ENDIF                                                              CGL031
056060200529      *                                                                                       CGL031
056070200529     C                     ENDIF                                                              CGL031
056080200529     C*
056090200529     C** ACCESS SAR DETAILS FILE TO DETERMINE IF BRT SAR IS INSTALLED
056100200529     C**
056110200529     C                     CALL 'AOSARDR0'
056120200529     C                     PARM '       ' @RTCD
056130200529     C                     PARM '*VERIFY' @OPTN
056140200529     C                     PARM 'S01383'  @SARD   6
056150200529     C           @RTCD     IFNE *BLANK
056160200529     C           @RTCD     ANDNE'*NRF   '
056170200529     C                     SETON                     U7LR  ** DB ERROR 97
056180200529     C           *LOCK     IN   LDA
056190200529     C                     MOVEL'SCSARDPD'DBFILE
056200200529     C                     MOVEL@RTCD     DBKEY
056210200529     C***********          Z-ADD97        DBASE                           CRE002
056220200529     C                     Z-ADD045       DBASE            * DBERROR 045 *CRE002
056230200529     C                     OUT  LDA
056240200529     C                     EXSR *PSSR
056250200529     C                     END
056260200529     C           @RTCD     IFEQ *BLANK
056270200529     C                     MOVEL'Y'       S01383  1
056280200529     C                     END
056290200529     C*
056300200529     C** IF BRT SAR INSTALLED
056310200529     C*
056320200529     C           S01383    IFEQ 'Y'                        B001
056330200529     C*
056340200529     C** ACCESS BRT INSTALLATION CONTROL DATA
056350200529     C*
056360200529     C                     MOVE 'D'       RECI
056370200529     C           RECI      CHAINSDBRTDD0             99    (99 = EOF)
056380200529     C   99      *LOCK     IN   LDA
056390200529     C***99******          SETON                     U7LR  ** DB ERROR 98 CRE002
056400200529     C   99                SETON                     U7LR  ** DB ERROR 046CRE002
056410200529     C   99                MOVEL'SDBRTDPD'DBFILE
056420200529     C   99                MOVELRECI      DBKEY
056430200529     C***99******          Z-ADD98        DBASE                           CRE002
056440200529     C   99                Z-ADD046       DBASE                           CRE002
056450200529     C   99                OUT  LDA
056460200529     C   99                EXSR *PSSR
056470200529     C**
056480200529     C** STORE BASE CURRENCY
056490200529     C**
056500200529     C                     MOVE BACCY     BCCY1   3
056510200529     C**
056520200529     C/COPY WNCPYSRC,RE3664CCP3                                           S01408
056530200529     C*                                                                   S01408
056540200529     C** ACCESS A/C CODES FILE FOR CORRESP. ACCOUNT TYPE
056550200529     C**
056560200529     C**********           MOVE ACOD1     KACOD   4                                           CGL029
056570200529     C                     MOVE ACOD1     KACOD                                               CGL029
056580200529     C                     ADD  1         RCSQ                                              CRE083BK
056590200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
056600200529     C                     Z-ADD048       WDBASE                                            CRE083BK
056610200529     C                     EXSR ACDCCH                                                      CRE083BK
056620200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
056630200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
056640200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
056650200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
056660200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
056670200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
056680200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
056690200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
056700200529     C********** *LOCK     IN   LDA                                                         CRE083BK
056710200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
056720200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 88 *CRE002
056730200529     C***********          Z-ADD088       DBASE            ***************CRE002
056740200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 048*           CRE002 CRE083BK
056750200529     C**********           Z-ADD048       DBASE            ***************           CRE002 CRE083BK
056760200529     C**********           OUT  LDA                                                         CRE083BK
056770200529     C**********           EXSR *PSSR                                                       CRE083BK
056780200529     C**********           END                                                              CRE083BK
056790200529     C**
056800200529     C                     MOVE A5ACTY    ATYP1   3
056810200529     C/COPY WNCPYSRC,RE3664C174
056820200529     C                     MOVE A5ACSC    ASEC1   2
056830200529     C*
056840200529     C                     CALL 'AOTRADR0'
056850200529     C                     PARM *BLANKS   @RTCD   7
056860200529     C                     PARM '*FIRST ' @OPTN   7
056870200529     C           SDTRAD    PARM SDTRAD    DSFDY
056880200529     C           @RTCD     IFNE *BLANK
056890200529     C           *LOCK     IN   LDA
056900200529     C                     MOVEL'SDTRADPD'DBFILE           ***************
056910200529     C***********          MOVEL@OPTN     DBKEY            * DBERROR 089 *CRE002
056920200529     C***********          Z-ADD089       DBASE            ***************CRE002
056930200529     C                     MOVEL@OPTN     DBKEY            * DBERROR 049 *CRE002
056940200529     C                     Z-ADD049       DBASE            ***************CRE002
056950200529     C                     OUT  LDA
056960200529     C                     EXSR *PSSR
056970200529     C                     END
056980200529     C**
056990200529     C** STORE STERLING CURRENCY
057000200529     C**
057010200529     C                     MOVE BLCYCD    STCY1   3
057020200529     C**
057030200529     C** ACCESS CURR. CODES FILE TO FIND FIELD VALUES FOR STERLING
057040200529     C**
057050200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
057060200529     C           STCY1     LOKUPACUR,A                   17                                 CRE083BK
057070200529      *                                                                                     CRE083BK
057080200529     C           *IN17     IFEQ '1'                                                         CRE083BK
057090200529     C           A         OCUR SDCURR                                                      CRE083BK
057100200529     C                     ELSE                                                             CRE083BK
057110200529     C           1         OCUR SDCURR                                                      MD021155
057120200529     C                     CALL 'AOCURRR0'
057130200529     C                     PARM '*MSG   ' @RTCD
057140200529     C                     PARM '*KEY   ' @OPTN
057150200529     C                     PARM STCY1     @CYCD   3
057160200529     C           SDCURR    PARM SDCURR    DSSDY
057170200529     C           @RTCD     IFNE *BLANK
057180200529     C           *LOCK     IN   LDA
057190200529     C                     MOVEL'SDCURRPD'DBFILE           ***************
057200200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 52 *CRE002
057210200529     C***********          Z-ADD052       DBASE            ***************CRE002
057220200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 050*CRE002
057230200529     C                     Z-ADD050       DBASE            ***************CRE002
057240200529     C                     OUT  LDA
057250200529     C                     EXSR *PSSR
057260200529     C                     END
057270200529     C                     ENDIF                                                            CRE083BK
057280200529     C*
057290200529     C**********           MOVE TACC      TACC2   4                                           CGL029
057300200529     C                     MOVE TACC      TACC2  10                                           CGL029
057310200529     C**
057320200529     C**   CHECK IF STERLING A/C CODE EXISTS
057330200529     C**
057340200529     C***********TACC      IFEQ '0000'                                    088181
057350200529     C********** TACC      IFEQ '    '                                                 088181 239314
057360200529     C           TACC      IFEQ *BLANKS                                                       239314
057370200529     C                     SETON                     29
057380200529     C                     ELSE
057390200529     C**********           MOVE TACC      ACODA   4                                           CGL029
057400200529     C                     MOVE TACC      ACODA  10                                           CGL029
057410200529     C                     EXSR ACDCHN
057420200529     C                     MOVE A5ACSC    TSEC2   2
057430200529     C                     END
057440200529     C**
057450200529     C                     MOVE CDP       CDPS    10
057460200529     C                     MOVE SPOT      SPOTS  138
057470200529     C                     MOVE MDIN      MDINS   1
057480200529     C**
057490200529     C** ACCESS CURR. CODES FILE TO FIND FIELD VALUES FOR BASE CCY
057500200529     C**
057510200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
057520200529     C           BCCY1     LOKUPACUR,A                   17                                 CRE083BK
057530200529      *                                                                                     CRE083BK
057540200529     C           *IN17     IFEQ '1'                                                         CRE083BK
057550200529     C           A         OCUR SDCURR                                                      CRE083BK
057560200529     C                     ELSE                                                             CRE083BK
057570200529     C           1         OCUR SDCURR                                                      MD021155
057580200529     C                     CALL 'AOCURRR0'
057590200529     C                     PARM '*MSG   ' @RTCD
057600200529     C                     PARM '*KEY   ' @OPTN
057610200529     C                     PARM BCCY1     @CYCD   3
057620200529     C           SDCURR    PARM SDCURR    DSSDY
057630200529     C           @RTCD     IFNE *BLANK
057640200529     C           *LOCK     IN   LDA
057650200529     C                     MOVEL'SDCURRPD'DBFILE           ***************
057660200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 53 *CRE002
057670200529     C***********          Z-ADD053       DBASE            ***************CRE002
057680200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 051*CRE002
057690200529     C                     Z-ADD051       DBASE            ***************CRE002
057700200529     C                     OUT  LDA
057710200529     C                     EXSR *PSSR
057720200529     C                     END
057730200529     C                     ENDIF                                                            CRE083BK
057740200529     C*                                                                   CAC001
057750200529     C**  Access PF/SDPCACPD for Profit Centre Accounting ICD             CAC001
057760200529     C*                                                                   CAC001
057770200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
057780200529     C*                                                                   CAC001
057790200529     C                     CALL 'AOPCACR0'                                CAC001
057800200529     C                     PARM '*MSG   ' @RTCD                           CAC001
057810200529     C                     PARM '*FIRST ' @OPTN                           CAC001
057820200529     C           SDPCAC    PARM SDPCAC    DSFDY                           CAC001
057830200529     C*                                                                   CAC001
057840200529     C           @RTCD     IFNE *BLANK                                    CAC001
057850200529     C           *LOCK     IN   LDA                                       CAC001
057860200529     C                     MOVEL'SDPCACPD'DBFILE                          CAC001
057870200529     C                     MOVEL@OPTN     DBKEY                           CAC001
057880200529     C                     Z-ADD053       DBASE                           CAC001
057890200529     C                     OUT  LDA                                       CAC001
057900200529     C                     EXSR *PSSR                                     CAC001
057910200529     C                     ENDIF                                          CAC001
057920200529     C*                                                                   CAC001
057930200529     C                     ENDIF                                          CAC001
057940200529     C**
057950200529     C                     MOVE CDP       CDPB    10
057960200529     C                     MOVE SPOT      SPOTB  138
057970200529     C                     MOVE MDIN      MDINB   1
057980200529     C                     END                             E001
057990200529      *                                                                                       CGL020
058000200529     C                     MOVE 'N'       CGL020  1                                           CGL020
058010200529     C                     CALL 'AOSARDR0'                                                    CGL020
058020200529     C                     PARM '       ' @RTCD                                               CGL020
058030200529     C                     PARM '*VERIFY' @OPTN                                               CGL020
058040200529     C                     PARM 'CGL020'  @SARD                                               CGL020
058050200529     C           SCSARD    PARM SCSARD    DSFDY                                               CGL020
058060200529      *                                                                                       CGL020
058070200529     C           @RTCD     IFNE *BLANK                                                        CGL020
058080200529     C           @RTCD     ANDNE'*NRF   '                                                     CGL020
058090200529     C                     MOVEL'RE3664'  DBPGM                                               CGL020
058100200529     C                     MOVEL'SCSARDPD'DBFILE                                              CGL020
058110200529     C                     Z-ADD206       DBASE                                               CGL020
058120200529     C                     MOVEL@SARD     DBKEY                                               CGL020
058130200529     C                     EXSR *PSSR                                                         CGL020
058140200529     C                     ENDIF                                                              CGL020
058150200529      *                                                                                       CGL020
058160200529     C           @RTCD     IFEQ *BLANK                                                        CGL020
058170200529     C                     MOVE 'Y'       CGL020                                              CGL020
058180200529     C                     ENDIF                                                              CGL020
058190200529      *                                                                                       CGL020
058200200529      ** Check if CDL081 is installed                                                         CDL081
058210200529      *                                                                                       CDL081
058220200529     C                     MOVE 'N'       CDL081  1                                           CDL081
058230200529     C                     CALL 'AOSARDR0'                                                    CDL081
058240200529     C                     PARM *BLANKS   PRTCD                                               CDL081
058250200529     C                     PARM '*VERIFY' POPTN                                               CDL081
058260200529     C                     PARM 'CDL081'  PSARD                                               CDL081
058270200529     C           SCSARD    PARM SCSARD    DSFDY                                               CDL081
058280200529      *                                                                                       CDL081
058290200529     C           PRTCD     IFNE *BLANKS                                                       CDL081
058300200529     C           PRTCD     ANDNE'*NRF   '                                                     CDL081
058310200529     C           *LOCK     IN   LDA                                                           CDL081
058320200529     C                     Z-ADD206       DBASE                                               CDL081
058330200529     C                     MOVE 'SCSARDPD'DBFILE                                              CDL081
058340200529     C                     MOVEL'CDL081'  DBKEY                                               CDL081
058350200529     C                     OUT  LDA                                                           CDL081
058360200529     C                     EXSR *PSSR                                                         CDL081
058370200529     C                     END                                                                CDL081
058380200529      *                                                                                       CDL081
058390200529     C           PRTCD     IFEQ *BLANKS                                                       CDL081
058400200529     C                     MOVE 'Y'       CDL081                                              CDL081
058410200529     C                     ENDIF                                                              CDL081
058420200529      *                                                                                       CDL081
058430200529      ** Access withholding tax round down system values if CDL081 is on                      CDL081
058440200529      *                                                                                       CDL081
058450200529     C           CDL081    IFEQ 'Y'                                                           CDL081
058460200529     C                     CALL 'AOSVALR0'                                                    CDL081
058470200529     C                     PARM *BLANKS   PRTCD                                               CDL081
058480200529     C                     PARM C#BASE    SVALK1 20                                           CDL081
058490200529     C                     PARM           SVAL1 200                                           CDL081
058500200529     C                     PARM C#NBAS    SVALK2 20                                           CDL081
058510200529     C                     PARM           SVAL2 200                                           CDL081
058520200529     C                     PARM *BLANK    SVALK3 20                                           CDL081
058530200529     C                     PARM           SVAL3 200                                           CDL081
058540200529     C                     PARM *BLANK    SVALK4 20                                           CDL081
058550200529     C                     PARM           SVAL4 200                                           CDL081
058560200529     C                     PARM *BLANK    SVALK5 20                                           CDL081
058570200529     C                     PARM           SVAL5 200                                           CDL081
058580200529     C                     PARM *BLANK    SVALK6 20                                           CDL081
058590200529     C                     PARM           SVAL6 200                                           CDL081
058600200529     C                     PARM *BLANK    SVALK7 20                                           CDL081
058610200529     C                     PARM           SVAL7 200                                           CDL081
058620200529     C                     PARM *BLANK    SVALK8 20                                           CDL081
058630200529     C                     PARM           SVAL8 200                                           CDL081
058640200529     C                     PARM *BLANK    SVALK9 20                                           CDL081
058650200529     C                     PARM           SVAL9 200                                           CDL081
058660200529     C                     PARM *BLANK    SVALK0 20                                           CDL081
058670200529     C                     PARM           SVAL10200                                           CDL081
058680200529      *                                                                                       CDL081
058690200529     C           PRTCD     IFNE *BLANKS                                                       CDL081
058700200529     C           *LOCK     IN   LDA                                                           CDL081
058710200529     C                     Z-ADD207       DBASE                                               CDL081
058720200529     C                     MOVE 'SDSVALPD'DBFILE                                              CDL081
058730200529     C           SVAL1     IFEQ '*NRF'                                                        CDL081
058740200529     C                     MOVELSVALK1    DBKEY                                               CDL081
058750200529     C                     ENDIF                                                              CDL081
058760200529     C           SVAL2     IFEQ '*NRF'                                                        CDL081
058770200529     C                     MOVELSVALK2    DBKEY                                               CDL081
058780200529     C                     ENDIF                                                              CDL081
058790200529     C                     OUT  LDA                                                           CDL081
058800200529     C                     EXSR *PSSR                                                         CDL081
058810200529     C                     ENDIF                                                              CDL081
058820200529      *                                                                                       CDL081
058830200529      ** Setup tax amount rounding down indicators                                            CDL081
058840200529      *                                                                                       CDL081
058850200529     C                     MOVELSVAL1     W#BSRD  1                                           CDL081
058860200529     C                     MOVELSVAL2     W#NBRD  1                                           CDL081
058870200529     C                     ENDIF                                                              CDL081
058880200529      *                                                                                       CDL081
058890200529      ** Check if CER048 is enabled.                                                          CER048
058900200529      *                                                                                       CER048
058910200529     C                     CALL 'AOSARDR0'                                                    CER048
058920200529     C                     PARM *BLANKS   PRTCD   7                                           CER048
058930200529     C                     PARM '*VERIFY' POPTN   7                                           CER048
058940200529     C                     PARM 'CER048'  PSARD   6                                           CER048
058950200529     C           SCSARD    PARM SCSARD    DSFDY                                               CER048
058960200529      *                                                                                       CER048
058970200529     C                     MOVE 'N'       CER048  1                                           CER048
058980200529      *                                                                                       CER048
058990200529     C           PRTCD     IFEQ *BLANKS                                                       CER048
059000200529     C                     MOVE 'Y'       CER048                                              CER048
059010200529     C                     ELSE                                                               CER048
059020200529      *                                                                                       CER048
059030200529     C           PRTCD     IFNE '*NRF   '                                                     CER048
059040200529     C           *LOCK     IN   LDA                                                           CER048
059050200529     C                     MOVEL'SCSARDPD'DBFILE                                              CER048
059060200529     C                     MOVEL'CER048'  DBKEY                                               CER048
059070200529     C                     Z-ADD320       DBASE                                               CER048
059080200529     C                     OUT  LDA                                                           CER048
059090200529     C                     EXSR *PSSR                                                         CER048
059100200529     C                     ENDIF                                                              CER048
059110200529      *                                                                                       CER048
059120200529     C                     ENDIF                                                              CER048
059130200529      *                                                                                       CER054
059140200529      ** Check if CER054 is enabled.                                                          CER054
059150200529      *                                                                                       CER054
059160200529     C                     CALL 'AOSARDR0'                                                    CER054
059170200529     C                     PARM *BLANKS   PRTCD                                               CER054
059180200529     C                     PARM '*VERIFY' POPTN                                               CER054
059190200529     C                     PARM 'CER054'  PSARD                                               CER054
059200200529     C           SCSARD    PARM SCSARD    DSFDY                                               CER054
059210200529      *                                                                                       CER054
059220200529     C                     MOVE 'N'       CER054  1                                           CER054
059230200529      *                                                                                       CER054
059240200529     C           PRTCD     IFEQ *BLANKS                                                       CER054
059250200529     C                     MOVE 'Y'       CER054                                              CER054
059260200529     C                     ELSE                                                               CER054
059270200529      *                                                                                       CER054
059280200529     C           PRTCD     IFNE '*NRF   '                                                     CER054
059290200529     C           *LOCK     IN   LDA                                                           CER054
059300200529     C                     MOVEL'SCSARDPD'DBFILE                                              CER054
059310200529     C                     MOVEL'CER054'  DBKEY                                               CER054
059320200529     C                     Z-ADD323       DBASE                                               CER054
059330200529     C                     OUT  LDA                                                           CER054
059340200529     C                     EXSR *PSSR                                                         CER054
059350200529     C                     ENDIF                                                              CER054
059360200529      *                                                                                       CER054
059370200529     C                     ENDIF                                                              CER054
059380200529      *                                                                                    BUG23097A
059390200529      ** Check if CER016 is enabled.                                                       BUG23097A
059400200529      *                                                                                    BUG23097A
059410200529     C                     CALL 'AOSARDR0'                                                 BUG23097A
059420200529     C                     PARM *BLANKS   PRTCD   7                                        BUG23097A
059430200529     C                     PARM '*VERIFY' POPTN   7                                        BUG23097A
059440200529     C                     PARM 'CER016'  PSARD   6                                        BUG23097A
059450200529     C           SCSARD    PARM SCSARD    DSFDY                                            BUG23097A
059460200529      *                                                                                    BUG23097A
059470200529     C                     MOVE 'N'       CER016  1                                        BUG23097A
059480200529      *                                                                                    BUG23097A
059490200529     C           PRTCD     IFEQ *BLANKS                                                    BUG23097A
059500200529     C                     MOVE 'Y'       CER016                                           BUG23097A
059510200529     C                     ELSE                                                            BUG23097A
059520200529      *                                                                                    BUG23097A
059530200529     C           PRTCD     IFNE '*NRF   '                                                  BUG23097A
059540200529     C           *LOCK     IN   LDA                                                        BUG23097A
059550200529     C                     MOVEL'SCSARDPD'DBFILE                                           BUG23097A
059560200529     C                     MOVEL'CER016'  DBKEY                                            BUG23097A
059570200529     C                     Z-ADD322       DBASE                                            BUG23097A
059580200529     C                     OUT  LDA                                                        BUG23097A
059590200529     C                     EXSR *PSSR                                                      BUG23097A
059600200529     C                     ENDIF                                                           BUG23097A
059610200529      *                                                                                    BUG23097A
059620200529     C                     ENDIF                                                           BUG23097A
059630200529      *                                                                                       CRE090
059640200529      ** Check if CRE090 is installed                                                         CRE090
059650200529      *                                                                                       CRE090
059660200529     C                     CALL 'AOSARDR0'                                                    CRE090
059670200529     C                     PARM *BLANKS   PRTCD                                               CRE090
059680200529     C                     PARM '*VERIFY' POPTN                                               CRE090
059690200529     C                     PARM 'CRE090'  PSARD                                               CRE090
059700200529     C           SCSARD    PARM SCSARD    DSFDY                                               CRE090
059710200529      *                                                                                       CRE090
059720200529     C           PRTCD     IFEQ *BLANKS                                                       CRE090
059730200529     C                     MOVEL'Y'       CRE090  1                                           CRE090
059740200529     C                     ELSE                                                               CRE090
059750200529     C                     MOVEL'N'       CRE090                                              CRE090
059760200529     C                     ENDIF                                                              CRE090
059770200529     C/COPY OFCPYSRCZ,CRE105_008                                                              CRE105
059780200529      *                                                                                       CGL165
059790200529     C                     CALL 'AOSARDR0'                                                    CGL165
059800200529     C                     PARM *BLANKS   PRTCD                                               CGL165
059810200529     C                     PARM '*VERIFY' POPTN                                               CGL165
059820200529     C                     PARM 'CGL165'  PSARD                                               CGL165
059830200529     C           SCSARD    PARM SCSARD    DSFDY                                               CGL165
059840200529      *                                                                                       CGL165
059850200529     C           PRTCD     IFEQ *BLANKS                                                       CGL165
059860200529     C                     MOVEL'Y'       CGL165  1                                           CGL165
059870200529     C                     ELSE                                                               CGL165
059880200529     C                     MOVEL'N'       CGL165                                              CGL165
059890200529     C                     ENDIF                                                              CGL165
059900200529     C           CDL013    IFEQ '1'                                                         MD053762
059910200529     C                     CALL 'AOSVALR0'                                                  MD053762
059920200529     C                     PARM *BLANKS   PRTCD                                             MD053762
059930200529     C                     PARM C#SCON    SVALK1 20                                         MD053762
059940200529     C                     PARM           SVAL1 200                                         MD053762
059950200529     C                     PARM *BLANKS   SVALK2 20                                         MD053762
059960200529     C                     PARM           SVAL2 200                                         MD053762
059970200529     C                     PARM *BLANKS   SVALK3 20                                         MD053762
059980200529     C                     PARM           SVAL3 200                                         MD053762
059990200529     C                     PARM *BLANKS   SVALK4 20                                         MD053762
060000200529     C                     PARM           SVAL4 200                                         MD053762
060010200529     C                     PARM *BLANKS   SVALK5 20                                         MD053762
060020200529     C                     PARM           SVAL5 200                                         MD053762
060030200529     C                     PARM *BLANKS   SVALK6 20                                         MD053762
060040200529     C                     PARM           SVAL6 200                                         MD053762
060050200529     C                     PARM *BLANKS   SVALK7 20                                         MD053762
060060200529     C                     PARM           SVAL7 200                                         MD053762
060070200529     C                     PARM *BLANKS   SVALK8 20                                         MD053762
060080200529     C                     PARM           SVAL8 200                                         MD053762
060090200529     C                     PARM *BLANKS   SVALK9 20                                         MD053762
060100200529     C                     PARM           SVAL9 200                                         MD053762
060110200529     C                     PARM *BLANKS   SVALK0 20                                         MD053762
060120200529     C                     PARM           SVAL10200                                         MD053762
060130200529      *                                                                                     MD053762
060140200529     C           PRTCD     IFNE *BLANKS                                                     MD053762
060150200529     C           *LOCK     IN   LDA                                                         MD053762
060160200529     C                     MOVEL'201'     DBASE                                             MD053762
060170200529     C                     MOVEL'SDSVALPD'DBFILE                                            MD053762
060180200529     C                     MOVELSVALK1    DBKEY                                             MD053762
060190200529     C                     OUT  LDA                                                         MD053762
060200200529     C                     EXSR *PSSR                                                       MD053762
060210200529     C                     ENDIF                                                            MD053762
060220200529      *                                                                                     MD053762
060230200529      ** Setup Suppress Conversion indicator                                                MD053762
060240200529      *                                                                                     MD053762
060250200529     C                     MOVELSVAL1     W#SCON  1                                         MD053762
060260200529     C                     ENDIF                                                            MD053762
060270200529      *                                                                                     AR831847
060280200529      *                                                                                     AR831847
060290200529      ** Check if Net Interest is to be posted for German Taxes                             AR831847
060300200529      *                                                                                     AR831847
060310200529     C                     MOVE 'N'       WSV01   1                                         AR831847
060320200529     C           CER048    IFEQ 'Y'                                                         AR831847
060330200529      *                                                                                     AR831847
060340200529     C                     CALL 'AOSVALR0'                                                  AR831847
060350200529     C                     PARM *BLANKS   PRTCD                                             AR831847
060360200529     C                     PARM PSNET     PSV01  20                                         AR831847
060370200529     C                     PARM           PCS01 200                                         AR831847
060380200529     C                     PARM           PSV02  20                                         AR831847
060390200529     C                     PARM           PCS02 200                                         AR831847
060400200529     C                     PARM           PSV03  20                                         AR831847
060410200529     C                     PARM           PCS03 200                                         AR831847
060420200529     C                     PARM           PSV04  20                                         AR831847
060430200529     C                     PARM           PCS04 200                                         AR831847
060440200529     C                     PARM           PSV05  20                                         AR831847
060450200529     C                     PARM           PCS05 200                                         AR831847
060460200529     C                     PARM           PSV06  20                                         AR831847
060470200529     C                     PARM           PCS06 200                                         AR831847
060480200529     C                     PARM           PSV07  20                                         AR831847
060490200529     C                     PARM           PCS07 200                                         AR831847
060500200529     C                     PARM           PSV08  20                                         AR831847
060510200529     C                     PARM           PCS08 200                                         AR831847
060520200529     C                     PARM           PSV09  20                                         AR831847
060530200529     C                     PARM           PCS09 200                                         AR831847
060540200529     C                     PARM           PSV10  20                                         AR831847
060550200529     C                     PARM           PCS10 200                                         AR831847
060560200529      *                                                                                     AR831847
060570200529     C           PRTCD     IFEQ *BLANKS                                                     AR831847
060580200529     C                     MOVELPCS01     WSV01                                             AR831847
060590200529     C                     ELSE                                                             AR831847
060600200529      *                                                                                     AR831847
060610200529     C           PRTCD     IFNE '*NRF'                                                      AR831847
060620200529     C           *LOCK     IN   LDA                                                         AR831847
060630200529     C                     MOVEL'SDSVALPD'DBFILE                                            AR831847
060640200529     C                     MOVELPSV01     DBKEY                                             AR831847
060650200529     C                     Z-ADD144       DBASE                                             AR831847
060660200529     C                     OUT  LDA                                                         AR831847
060670200529     C                     EXSR *PSSR                                                       AR831847
060680200529     C                     ENDIF                                                            AR831847
060690200529      *                                                                                     AR831847
060700200529     C                     ENDIF                                                            AR831847
060710200529      *                                                                                     AR831847
060720200529     C                     ENDIF                                                            AR831847
060730200529      *                                                                                     AR831847
060740200529      ** Determine system values whether internal postings for interest                       CRE100
060750200529      ** accruals and charges should be posted at customer level or                           CRE100
060760200529      ** bank level.                                                                          CRE100
060770200529      *                                                                                       CRE100
060780200529     C                     CALL 'AOSVALR0'                                                    CRE100
060790200529     C                     PARM *BLANKS   W0RTCD  7                                           CRE100
060800200529     C                     PARM SVAL,1    PVALK1 20                                           CRE100
060810200529     C                     PARM *BLANKS   PVAL1 200                                           CRE100
060820200529     C                     PARM SVAL,2    PVALK2 20                                           CRE100
060830200529     C                     PARM *BLANKS   PVAL2 200                                           CRE100
060840200529     C**********           PARM *BLANKS   PVALK3 20                                  CRE100 MD034990
060850200529     C                     PARM SVAL,3    PVALK3 20                                         MD034990
060860200529     C                     PARM *BLANKS   PVAL3 200                                           CRE100
060870200529     C**********           PARM *BLANKS   PVALK4 20                                  CRE100 MD045460
060880200529     C                     PARM SVAL,4    PVALK4 20                                         MD045460
060890200529     C                     PARM *BLANKS   PVAL4 200                                           CRE100
060900200529     C                     PARM *BLANKS   PVALK5 20                                           CRE100
060910200529     C                     PARM *BLANKS   PVAL5 200                                           CRE100
060920200529     C                     PARM *BLANKS   PVALK6 20                                           CRE100
060930200529     C                     PARM *BLANKS   PVAL6 200                                           CRE100
060940200529     C                     PARM *BLANKS   PVALK7 20                                           CRE100
060950200529     C                     PARM *BLANKS   PVAL7 200                                           CRE100
060960200529     C                     PARM *BLANKS   PVALK8 20                                           CRE100
060970200529     C                     PARM *BLANKS   PVAL8 200                                           CRE100
060980200529     C                     PARM *BLANKS   PVALK9 20                                           CRE100
060990200529     C                     PARM *BLANKS   PVAL9 200                                           CRE100
061000200529     C                     PARM *BLANKS   PVALK0 20                                           CRE100
061010200529     C                     PARM *BLANKS   PVAL10200                                           CRE100
061020200529      *                                                                                       CRE100
061030200529     C           W0RTCD    IFEQ *BLANKS                                                       CRE100
061040200529      *                                                                                       CRE100
061050200529     C           PVAL1     IFEQ 'Y'                                                           CRE100
061060200529     C                     MOVE 'Y'       WINT    1                                           CRE100
061070200529     C                     ENDIF                                                              CRE100
061080200529      *                                                                                       CRE100
061090200529     C           PVAL2     IFEQ 'Y'                                                           CRE100
061100200529     C                     MOVE 'Y'       WCHRG   1                                           CRE100
061110200529     C                     ENDIF                                                              CRE100
061120200529      *                                                                                       CRE100
061130200529     C           PVAL3     IFEQ 'Y'                                                         MD034990
061140200529     C                     MOVE 'Y'       RETSEQ  1                                         MD034990
061150200529     C                     ENDIF                                                            MD034990
061160200529      *                                                                                     MD034990
061170200529     C                     MOVE 'N'       WWHTAL  1                                         MD045460
061180200529     C           PVAL4     IFEQ 'Y'                                                         MD045460
061190200529     C                     MOVE 'Y'       WWHTAL                                            MD045460
061200200529     C                     ENDIF                                                            MD045460
061210200529      *                                                                                     MD045460
061220200529     C                     ELSE                                                               CRE100
061230200529      *                                                                                       CRE100
061240200529     C           W0RTCD    IFNE '*NRF'                                                        CRE100
061250200529     C           *LOCK     IN   LDA                                                           CRE100
061260200529     C                     Z-ADD146       DBASE                                               CRE100
061270200529     C                     MOVEL'SDSVALPD'DBFILE                                              CRE100
061280200529      *                                                                                       CRE100
061290200529     C           PVAL1     IFEQ '*NRF'                                                        CRE100
061300200529     C                     MOVELPVALK1    DBKEY                                               CRE100
061310200529     C                     ENDIF                                                              CRE100
061320200529      *                                                                                       CRE100
061330200529     C           PVAL2     IFEQ '*NRF'                                                        CRE100
061340200529     C                     MOVELPVALK2    DBKEY                                               CRE100
061350200529     C                     ENDIF                                                              CRE100
061360200529      *                                                                                     MD034990
061370200529     C           PVAL3     IFEQ '*NRF'                                                      MD034990
061380200529     C                     MOVELPVALK3    DBKEY                                             MD034990
061390200529     C                     ENDIF                                                            MD034990
061400200529      *                                                                                     MD045460
061410200529     C           PVAL4     IFEQ '*NRF'                                                      MD045460
061420200529     C                     MOVELPVALK4    DBKEY                                             MD045460
061430200529     C                     ENDIF                                                            MD045460
061440200529      *                                                                                       CRE100
061450200529     C                     OUT  LDA                                                           CRE100
061460200529     C                     EXSR *PSSR                                                         CRE100
061470200529     C                     ENDIF                                                              CRE100
061480200529      *                                                                                       CRE100
061490200529     C                     ENDIF                                                              CRE100
061500200529      *                                                                                       CRE100
061510200529      ** Initialize work variable UPDCUS and set to value 'Y' if                            MD027841
061520200529      ** postings are coming from DEBPR or CREPR subroutines.                               MD027841
061530200529      *                                                                                     MD027841
061540200529     C                     MOVE *BLANKS   UPDCUS  1                                         MD027841
061550200529      *                                                                                     MD027841
061560200529     C/COPY WNCPYSRC,RE3664C131
061570200529     C*
061580200529     C**   INITIALISE FIELDS FOR MANAGEMENT ACCOUNTING
061590200529     C                     Z-ADD0         VOIN    10
061600200529     C                     Z-ADD235959    PTIM    60
061610200529     C*
061620200529     C                     EXSR TOTAL
061630200529     C*
061640200529     C/COPY WNCPYSRC,RE3664C029
061650200529     C                     EXSR INITPR
061660200529     C/COPY WNCPYSRC,RE3664C030
061670200529     C*
061680200529      ** Dummy read for compilation purposes                              CCB003
061690200529     C                     MOVE '0'       *IN37                           CCB003
061700200529     C           *IN37     IFEQ '1'                                       CCB003
061710200529     C                     READ REINCXPD                 37               CCB003
061720200529     C                     ENDIF                                          CCB003
061730200529      *                                                                   CCB003
061740200529     C                     Z-ADD0         WCHGP  257                                          250998
061750200529      *                                                                                       250998
061760200529     C                     CLOSESDCURRL1                                                      CGL165
061770200529     C                     ENDSR                           **FIRST ENDSR**
061780200529     C********************************************************************
061790200529     C/EJECT
061800200529     C********************************************************************
061810200529     C**
061820200529     C** GEICPR subroutine to execute geicpd file processing
061830200529     C**
061840200529     C**     Called by       ACCPR,DCIND,PLPR,SUSPR
061850200529     C**     Calls           -
061860200529     C**
061870200529      *****************************************************************   CCB003
061880200529     C           GEICPR    BEGSR                           **GEICPR BEGSR**
061890200529     C*                                                                   129099
061900200529     C** If Retail Account and Private Banking Module Switched ON         129099
061910200529     C** Split Transaction type '91060' and '91040' accordingly to        129099
061920200529     C** Debit / Credit processing                                        129099
061930200529     C*                                                                   129099
061940200529     C           BGN4ST    IFEQ 'Y'                        - B1           129099
061950200529     C***********ATYP      ANDEQ'R'                                129099 161803
061960200529     C                     MOVELOTTP      OTTPS   50                      161803
061970200529     C*                                                                   129099
061980200529     C** Debit processing                                                 129099
061990200529     C           WDRCR     IFEQ '0'                        - B2           129099
062000200529     C*                                                                   129099
062010200529     C***********TRAT      IFEQ 91060                      - B3    129099 161803
062020200529     C           OTTPS     IFEQ 91060                      - B3           161803
062030200529     C                     Z-ADD91061     TRAT                            129099
062040200529     C                     ENDIF                           - E3           129099
062050200529     C***********TRAT      IFEQ 91040                      - B3    129099 161803
062060200529     C           OTTPS     IFEQ 91040                      - B3           161803
062070200529     C                     Z-ADD91041     TRAT                            129099
062080200529     C                     ENDIF                           - E3           129099
062090200529     C*                                                                   129099
062100200529     C                     ENDIF                           - E2           129099
062110200529     C*                                                                   129099
062120200529     C** Credit processing                                                129099
062130200529     C           WDRCR     IFEQ '1'                        - B2           129099
062140200529     C*                                                                   129099
062150200529     C***********TRAT      IFEQ 91060                      - B3    129099 161803
062160200529     C***********TRAT      OREQ 91061                              150714 162319
062170200529     C           OTTPS     IFEQ 91060                                     162319
062180200529     C                     Z-ADD91062     TRAT                            129099
062190200529     C                     ENDIF                           - E3           129099
062200200529     C***********TRAT      IFEQ 91040                      - B3    129099 161803
062210200529     C***********TRAT      OREQ 91041                              150714 162319
062220200529     C           OTTPS     IFEQ 91040                      - B3           161803
062230200529     C                     Z-ADD91042     TRAT                            129099
062240200529     C                     ENDIF                           - E3           129099
062250200529     C*                                                                   129099
062260200529     C                     ENDIF                           - E2           129099
062270200529     C*                                                                   129099
062280200529     C                     ENDIF                           - E1           129099
062290200529     C*
062300200529     C           WEUTT     IFEQ 'Y'                                                           234003
062310200529     C                     MOVE TXTXTT    TRAT                                                234003
062320200529     C                     ENDIF                                                              234003
062330200529      *                                                                                       234003
062340200529     C           WPSTA     IFGT 0                          - B1
062350200529     C                     Z-ADDWPSTA     PSTA
062360200529     C                     MOVE '0'       DRCR
062370200529     C                     ELSE                            - X1
062380200529     C                     Z-SUBWPSTA     PSTA
062390200529     C                     MOVE '1'       DRCR
062400200529     C                     END                             - E1
062410200529     C*                                                                                       CGL020
062420200529     C           CGL020    IFEQ 'Y'                                                           CGL020
062430200529     C           WDRCR     IFEQ '2'                                                           CGL020
062440200529     C                     MOVE 'F'       FEEFLG                                              CGL020
062450200529     C                     Z-ADDPSTA      FEEVAL                                              CGL020
062460200529     C                     Z-ADD100       FEEPCT                                              CGL020
062470200529     C                     ELSE                                                               CGL020
062480200529     C                     MOVE *BLANKS   FEEFLG                                              CGL020
062490200529     C                     Z-ADD0         FEEVAL                                              CGL020
062500200529     C                     Z-ADD0         FEEPCT                                              CGL020
062510200529     C                     ENDIF                                                              CGL020
062520200529     C                     ENDIF                                                              CGL020
062530200529     C*
062540200529     C**********           MOVE ACOD      KACOD   4                                           CGL029
062550200529     C                     MOVE ACOD      KACOD                                               CGL029
062560200529     C                     ADD  1         RCSQ                                              CRE083BK
062570200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
062580200529     C                     Z-ADD052       WDBASE                                            CRE083BK
062590200529     C**********           EXSR CHKACD                                            CRE083BK AR1089863
062600200529     C                     EXSR ACDCCH                                                     AR1089863
062610200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
062620200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
062630200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
062640200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
062650200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
062660200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
062670200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
062680200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
062690200529     C********** *LOCK     IN   LDA                                                         CRE083BK
062700200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
062710200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 20 *CRE002
062720200529     C***********          Z-ADD020       DBASE            ***************CRE002
062730200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 052*           CRE002 CRE083BK
062740200529     C**********           Z-ADD052       DBASE            ***************           CRE002 CRE083BK
062750200529     C**********           OUT  LDA                                                         CRE083BK
062760200529     C***********          WRITEERRP1                                     CCB003
062770200529     C**********           EXSR *PSSR                                                       CRE083BK
062780200529     C**********           END                                                              CRE083BK
062790200529     C*
062800200529     C** WRITE NEW RECORD IN GEICPD FILE
062810200529     C*
062820200529     C                     MOVE A5ACTY    ATYP
062830200529     C                     MOVE A5ACSC    ACSC
062840200529     C                     MOVE 'P'       RECI
062850200529     C***********          Z-ADD41        DBASE                           CRE002
062860200529     C                     Z-ADD053       DBASE            * DB ERROR 053*CRE002
062870200529     C*
062880200529     C           ATYP      IFEQ 'R'
062890200529     C                     Z-ADD1         RIND
062900200529     C                     ELSE
062910200529     C                     Z-ADD0         RIND
062920200529     C                     END
062930200529     C*
062940200529     C* NOT FOR SECONDARY
062950200529     C*
062960200529     C           *IN50     IFEQ '0'
062970200529      *                                                                   184965
062980200529     C* Use Profit Center of Main Account if PRFC is blank.               184965
062990200529      *                                                                   184965
063000200529     C           PRFC      IFEQ *BLANKS                                   184965
063010200529     C                     MOVE WMPRFC    PRFC                            184965
063020200529     C                     ENDIF                                          184965
063030200529     C*                                                                   184965
063040200529     C* Retrieve Profit Center from Default Matrix if PRFC still blank    184965
063050200529     C*                                                                   184965
063060200529     C                     MOVE TRAT      WTRATA  5                       184965
063070200529     C                     MOVE CNUM      WCNUMA  6                       184965
063080200529     C           PRFC      IFEQ *BLANKS                                   184965
063090200529     C           PCMU      ANDEQ'Y'                                       184965
063100200529     C                     CALL 'AOPRFMR0'                                184965
063110200529     C                     PARM *BLANKS   RTCDPR  1                       184965
063120200529     C                     PARM BOKC      BOOKPR  2                       184965
063130200529     C                     PARM WTRATA    TRTPPR  5                       184965
063140200529     C                     PARM *BLANKS   SUTPPR  2                       184965
063150200529     C**********           PARM BRCA      BRANPR  1                                    184965 211084
063160200529     C                     PARM BRCA      BRANPR  3                                           211084
063170200529     C**********           PARM DPMT      DEPTPR  2                                    184965 211084
063180200529     C                     PARM DPMT      DEPTPR  3                                           211084
063190200529     C**********           PARM *BLANKS   USERPR  5                                    184965 211084
063200200529     C                     PARM *BLANKS   USERPR 10                                           211084
063210200529     C                     PARM *BLANKS   ACOFPR  2                       184965
063220200529     C**********           PARM WCNUMA    CNUMPR  5                                    184965 211084
063230200529     C                     PARM WCNUMA    CNUMPR  6                                           211084
063240200529     C**********           PARM *BLANKS   PRFCPR  2                                    184965 211084
063250200529     C                     PARM *BLANKS   PRFCPR  4                                           211084
063260200529     C*                                                                   184965
063270200529     C           RTCDPR    IFNE '0'                                       184965
063280200529     C                     MOVE *BLANKS   PRFC                            184965
063290200529     C                     ELSE                                           184965
063300200529     C                     MOVE PRFCPR    PRFC                            184965
063310200529     C                     ENDIF                                          184965
063320200529     C                     ENDIF                                          184965
063330200529     C*                                                                   184965
063340200529     C** Blank Profit Center when not used.                               184965
063350200529     C*                                                                   184965
063360200529     C           PCUS      IFNE 'Y'                                       184965
063370200529     C                     MOVE *BLANKS   PRFC                            184965
063380200529     C                     ENDIF                                          184965
063390200529     C*                                                                   S01522
063400200529     C* Retrieve the posting narrative:                                   S01522
063410200529     C*                                                                   S01522
063420200529     C                     EXSR SRPNAR                                    S01522
063430200529     C/COPY WNCPYSRC,REH00026
063440200529     C*                                                                   111921
063450200529     C           VALD      IFEQ *ZEROS                                    111921
063460200529     C                     Z-ADDRUND      VALD                            111921
063470200529     C                     END                                            111921
063480200529     C/COPY WNCPYSRC,REH00431
063490200529      *                                                                   CPB001
063500200529      **  If Replication Processing required.                             CPB001
063510200529     C           WUREPL    IFEQ 'Y'                        Begin WUREPL   CPB001
063520200529      *                                                                   CPB001
063530200529      **  If Transaction is not relating to charges.                      CPB001
063540200529     C           TRAT      IFNE 91050                      Begin TRAT     CPB001
063550200529     C                     EXSR REPLIC                                    CPB001
063560200529      *                                                                   CPB001
063570200529     C                     ENDIF                           End TRAT       CPB001
063580200529      *                                                                   CPB001
063590200529     C                     ENDIF                           End WUREPL     CPB001
063600200529     C*                                                                   S01522
063610200529     C/COPY WNCPYSRC,RE3664C004                                           S01408
063620200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
063630200529     C                     EXSR ACCDET                                    CRE008
063640200529     C**********           ENDIF                                                     261620 MD022635
063650200529     C                     WRITEAPOSTPDF
063660200529     C                     Z-ADD*ZEROS    DBASE
063670200529     C/COPY OFCPYSRCZ,CRE105_009                                                              CRE105
063680200529     C*
063690200529     C/COPY WNCPYSRC,RE3664CP16                                           S01408
063700200529      *                                                                   S01408
063710200529     C** TRAILER PROCESSING
063720200529     C*
063730200529     C                     ADD  1         WNORE
063740200529     C           PSTA      DIV  1000      ZZAMT
063750200529     C/COPY WNCPYSRC,RE3664C031
063760200529     C                     EXSR GLZADD
063770200529     C/COPY WNCPYSRC,RE3664C032
063780200529     C                     END
063790200529     C*
063800200529     C                     ENDSR                           **GEICPR ENDSR**
063810200529     C********************************************************************
063820200529     C/EJECT                                                              CRE008
063830200529     C********************************************************************CRE008
063840200529     C           ACCDET    BEGSR                           **ACCDET BEGSR*CRE008
063850200529      *                                                                   CRE008
063860200529     C                     MOVELXBRCA     ORBR                            CRE008
063870200529     C                     MOVELXCCY      TRCCY                           CRE008
063880200529     C                     MOVEL*BLANK    FACO                            CRE008
063890200529     C                     MOVELXACOD     FACO                            CRE008
063900200529     C                     MOVEL*BLANK    OTRF                            CRE008
063910200529     C                     CAT  XCNUMA:0  OTRF                            CRE008
063920200529     C                     CAT  XACSQA:0  OTRF                            CRE008
063930200529     C                     MOVEL*BLANK    TRST                            CRE008
063940200529     C           CRE008    IFEQ 'Y'                                       CRE008
063950200529     C           CMACKY    CHAINREGAHLJ2             99                   CRE008
063960200529     C        N99          MOVEL'G'       TRST                            CRE008
063970200529     C           CMACKY    CHAINREZSHLJ2             99                   CRE008
063980200529     C        N99          MOVE 'Z'       TRST                            CRE008
063990200529     C                     ENDIF                                          CRE008
064000200529      *                                                                   CRE008
064010200529     C           CMACKY    KLIST                                          CRE008
064020200529     C                     KFLD           XCNUM                           CRE008
064030200529     C                     KFLD           XCCY                            CRE008
064040200529     C                     KFLD           XACOD                           CRE008
064050200529     C                     KFLD           XACSQ                           CRE008
064060200529     C                     KFLD           XBRCA                           CRE008
064070200529      *                                                                   CRE008
064080200529     C                     ENDSR                           **ACCDET ENDSR*CRE008
064090200529     C********************************************************************CRE008
064100200529     C/EJECT                                                              217910
064110200529     C********************************************************************217910
064120200529     C           RTVRE     BEGSR                           **RTVRE  BEGSR*217910
064130200529      *                                                                   217910
064140200529     C                     MOVELWACNO     XACNO  10                       217910
064150200529     C           EUACKY    CHAINRECIEUL2             99                   217910
064160200529     C           *IN99     IFEQ '0'                                       217910
064170200529     C                     MOVELRWEACN    XACNO                           217910
064180200529     C                     ENDIF                                          217910
064190200529      *                                                                   217910
064200200529     C           EUACKY    KLIST                                          217910
064210200529     C                     KFLD           XBRCA                           217910
064220200529     C                     KFLD           XCNUM                           217910
064230200529     C                     KFLD           XCCY                            217910
064240200529     C                     KFLD           XACOD                           217910
064250200529     C                     KFLD           XACSQ                           217910
064260200529      *                                                                   217910
064270200529     C                     ENDSR                           **RTVRE  ENDSR*217910
064280200529     C********************************************************************217910
064290200529     C/EJECT
064300200529     C********************************************************************
064310200529     C/COPY WNCPYSRC,RE3664C005                                           S01408
064320200529     C**
064330200529     C** GEISR subroutine for GEICPD file exception/error handling
064340200529     C**
064350200529     C**     Called by       Input specifications
064360200529     C**     Calls           *PSSR
064370200529     C**
064380200529      *****************************************************************   CCB003
064390200529     C           GEISR     BEGSR                           **GEISR BEGSR**
064400200529     C*
064410200529     C           *LOCK     IN   LDA
064420200529     C***********          MOVE 'GEIC '   DBFILE           ***************CCB003
064430200529     C                     MOVEL'GEIC'    DBFILE           ***************CCB003
064440200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
064450200529     C                     MOVELSTSGEI    DBSTAT           ***************
064460200529     C                     MOVEA'11'      *IN,88
064470200529     C                     OUT  LDA
064480200529     C                     EXSR *PSSR
064490200529     C*
064500200529     C                     ENDSR                           **GEISR ENDSR**
064510200529     C********************************************************************
064520200529     C/COPY OFCPYSRCZ,CRE105_010                                                              CRE105
064530200529     C/EJECT
064540200529     C********************************************************************
064550200529     C**
064560200529     C** IACSR subroutine for REIAC    file exception/error handling
064570200529     C**
064580200529     C**     Called by       Input specifications
064590200529     C**     Calls           *PSSR
064600200529     C**
064610200529      *****************************************************************   CCB003
064620200529     C           IACSR     BEGSR                           **IACSR BEGSR**
064630200529     C*
064640200529     C           *LOCK     IN   LDA
064650200529     C***********          MOVE 'REIAC'   DBFILE           ***************CCB003
064660200529     C                     MOVEL'REIAC'   DBFILE           ***************CCB003
064670200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
064680200529     C                     MOVELSTSIAC    DBSTAT           ***************
064690200529     C                     MOVEA'11'      *IN,88
064700200529     C                     OUT  LDA
064710200529     C                     EXSR *PSSR
064720200529     C*
064730200529     C                     ENDSR                           **IACSR ENDSR**
064740200529     C********************************************************************
064750200529     C/EJECT
064760200529     C********************************************************************
064770200529     C**
064780200529     C** INITPR subroutine to initialize works fields
064790200529     C**
064800200529     C**     Called by       FIRST
064810200529     C**     Calls           -
064820200529     C**
064830200529      *****************************************************************   CCB003
064840200529     C           INITPR    BEGSR                           **INITPR BEGSR*
064850200529     C*
064860200529     C                     MOVE 'P'       RECI
064870200529     C                     Z-ADDRUND      PSTD
064880200529     C                     Z-ADD*ZEROS    CHQN
064890200529     C                     Z-ADD*ZEROS    REJC
064900200529     C                     Z-ADD*ZEROS    RRNM
064910200529     C                     Z-ADD*ZEROS    ACUM
064920200529     C************         MOVE '000'     DPMT                            105084
064930200529     C                     MOVE '   '     DPMT                            105084
064940200529     C                     BITOF'01234567'PRIN
064950200529     C                     MOVE *BLANKS   EXIN
064960200529     C                     MOVE '  GE-IC' SPOS
064970200529     C                     Z-ADD91060     TRAT
064980200529     C                     MOVEL'91060'   OTTP
064990200529     C                     MOVE 'C'       GETP
065000200529     C*
065010200529     C** SET DEFAULT NARRATIVE
065020200529     C*
065030200529     C                     MOVE XCUNT     WLGID
065040200529     C*
065050200529     C** ACCESS ADJUSTEMENT INTEREST NARRATIVE
065060200529     C*
065070200529     C                     MOVE 'R1'      LNARC   2
065080200529     C**********           MOVEL'INT ADJ' DN07,1                                              CGL029
065090200529     C                     MOVEL'INTADJ'  DN07,1                                              CGL029
065100200529     C***********          MOVEL'INTEREST'NR16,1                          135401
065110200529     C***********          MOVE ' ADJ.   'NR16,1                          135401
065120200529     C                     MOVEL'DR INT. 'NR16,1                          135401
065130200529     C                     MOVE 'ADJ.    'NR16,1                          135401
065140200529     C/COPY WNCPYSRC,RE3664C141
065150200529     C*
065160200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
065170200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
065180200529      *                                                                                     CRE083BK
065190200529     C           *IN18     IFEQ '1'                                                         CRE083BK
065200200529     C           B         OCUR SDNARR                                                      CRE083BK
065210200529     C**********           MOVELNARD      NAR,1                                    MD020956 MD022635
065220200529     C                     MOVELNARD      NAR,2                                             MD022635
065230200529     C                     ELSE                                                             CRE083BK
065240200529      *                                                                                     MD021155
065250200529     C           1         OCUR SDNARR                                                      MD021155
065260200529     C                     CALL 'AONARRR0'
065270200529     C                     PARM *BLANKS   @RTCD
065280200529     C                     PARM '*KEY   ' @OPTN
065290200529     C                     PARM LNARC     @NVCD   2
065300200529     C           SDNARR    PARM SDNARR    DSFDY
065310200529     C           @RTCD     IFNE *BLANK
065320200529     C**********           MOVELNR16,1    NAR,1                           183947
065330200529     C                     MOVE *BLANKS   NAR,2                           183947
065340200529     C                     MOVEL'INT.CAP.'NAR,2                           183947
065350200529     C                     ELSE
065360200529     C***********          MOVELNARD      NAR,1                                             MD022635
065370200529     C                     MOVELNARD      NAR,2                                             MD022635
065380200529     C                     END
065390200529     C                     ENDIF                                                            CRE083BK
065400200529      *                                                                   S01522
065410200529      **  Set up Narrative message: rightmost byte blank                  S01522
065420200529     C                     MOVEL'GB0019'  MGD,1     P                     S01522
065430200529     C*                                                                   135401
065440200529     C                     MOVE 'RB'      LNARC                           135401
065450200529     C                     Z-ADD12        W       20                      135401
065460200529     C**********           MOVEL'INT ADJ' DN07,W                                       135809 CGL029
065470200529     C**********           MOVEL'INTADJ'  DN07,W                                      CGL029 135809R
065480200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
065490200529     C                     MOVEL'INTADJ'  DN07,W                                            AR978914
065500200529     C                     ENDIF                                                            MD045460
065510200529     C                     MOVEL'CR INT. 'NR16,W                          135401
065520200529     C                     MOVE 'ADJ.    'NR16,W                          135401
065530200529     C*                                                                   135401
065540200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
065550200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
065560200529      *                                                                                     CRE083BK
065570200529     C           *IN18     IFEQ '1'                                                         CRE083BK
065580200529     C           B         OCUR SDNARR                                                      CRE083BK
065590200529     C                     MOVELNARD      NAR,12                                            MD020956
065600200529     C                     ELSE                                                             CRE083BK
065610200529      *                                                                                     MD021155
065620200529     C           1         OCUR SDNARR                                                      MD021155
065630200529     C                     CALL 'AONARRR0'                                135401
065640200529     C                     PARM *BLANKS   @RTCD                           135401
065650200529     C                     PARM '*KEY   ' @OPTN                           135401
065660200529     C                     PARM LNARC     @NVCD   2                       135401
065670200529     C           SDNARR    PARM SDNARR    DSFDY                           135401
065680200529     C           @RTCD     IFNE *BLANK                                    135401
065690200529     C                     MOVELNR16,W    NAR,12                          135401
065700200529     C                     ELSE                                           135401
065710200529     C                     MOVELNARD      NAR,12                          135401
065720200529     C                     END                                            135401
065730200529     C                     ENDIF                                                            CRE083BK
065740200529     C*                                                                   135401
065750200529     C                     MOVEL'GB00193' MGD,12    P                     135401
065760200529      *                                                                                       234438
065770200529      ** RC - European Taxation of Interest                                                   234438
065780200529      *                                                                                       234438
065790200529     C           CGL031    IFEQ 'Y'                                                           234870
065800200529     C                     MOVE 'RC'      LNARC                                               234438
065810200529     C                     Z-ADD14        W                                                   234438
065820200529     C                     MOVEL'EU TAX'  DN07,W                                              234438
065830200529     C                     MOVEL'EU TAXAT'NR16,W                                              234438
065840200529     C                     MOVE 'ION     'NR16,W                                              234438
065850200529      *                                                                                       234438
065860200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
065870200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
065880200529      *                                                                                     CRE083BK
065890200529     C           *IN18     IFEQ '1'                                                         CRE083BK
065900200529     C           B         OCUR SDNARR                                                      CRE083BK
065910200529     C                     MOVELNARD      NAR,14                                            MD020956
065920200529     C                     ELSE                                                             CRE083BK
065930200529      *                                                                                     MD021155
065940200529     C           1         OCUR SDNARR                                                      MD021155
065950200529     C                     CALL 'AONARRR0'                                                    234438
065960200529     C                     PARM *BLANKS   @RTCD                                               234438
065970200529     C                     PARM '*KEY   ' @OPTN                                               234438
065980200529     C                     PARM LNARC     @NVCD   2                                           234438
065990200529     C           SDNARR    PARM SDNARR    DSFDY                                               234438
066000200529      *                                                                                       234438
066010200529     C           @RTCD     IFNE *BLANK                                                        234438
066020200529     C                     MOVELNR16,W    NAR,14                                              234438
066030200529     C                     ELSE                                                               234438
066040200529     C                     MOVELNARD      NAR,14                                              234438
066050200529     C                     ENDIF                                                              234438
066060200529     C                     ENDIF                                                            CRE083BK
066070200529      *                                                                                       234438
066080200529     C**********           MOVEL'GB00243' MGD,14    P                                  234438 236352
066090200529     C                     MOVEL'GB0054 ' MGD,14    P                                         236352
066100200529     C                     ENDIF                                                              234870
066110200529     C*
066120200529     C** ACCESS INTEREST NARRATIVE
066130200529     C*
066140200529     C                     MOVE 'R2'      LNARC
066150200529     C**********           MOVEL'INT.   ' DN07,2                                              CGL029
066160200529     C                     MOVEL'INT.  '  DN07,2                                              CGL029
066170200529     C***********          MOVEL'INTEREST'NR16,2                          074598
066180200529     C/COPY WNCPYSRC,RE3664C006                                           S01408
066190200529     C                     MOVEL'INT.CAP.'FLD10                           074598
066200200529     C                     MOVE ' -'      FLD10                           074598
066210200529     C                     MOVELFLD10     NR16,2                          074598
066220200529     C/COPY WNCPYSRC,RE3664C007                                           S01408
066230200529     C*
066240200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
066250200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
066260200529      *                                                                                     CRE083BK
066270200529     C           *IN18     IFEQ '1'                                                         CRE083BK
066280200529     C           B         OCUR SDNARR                                                      CRE083BK
066290200529     C**********           MOVELNARD      NAR,2                                    MD020956 MD022635
066300200529     C                     MOVELNARD      NAR,4                                             MD022635
066310200529     C                     ELSE                                                             CRE083BK
066320200529      *                                                                                     MD021155
066330200529     C           1         OCUR SDNARR                                                      MD021155
066340200529     C                     CALL 'AONARRR0'
066350200529     C                     PARM *BLANKS   @RTCD
066360200529     C                     PARM '*KEY   ' @OPTN
066370200529     C                     PARM LNARC     @NVCD   2
066380200529     C           SDNARR    PARM SDNARR    DSFDY
066390200529     C           @RTCD     IFNE *BLANK
066400200529     C           CRE002    IFNE 'Y'                                       183947
066410200529     C**********           MOVELNR16,2    NAR,2                           183947
066420200529     C                     MOVE *BLANKS   NAR,4                           183947
066430200529     C                     MOVEL'INT.CAP.'NAR,4                           183947
066440200529     C                     END                                            183947
066450200529     C                     ELSE
066460200529     C***********          MOVELNARD      NAR,2                                             MD022635
066470200529     C                     MOVELNARD      NAR,4                                             MD022635
066480200529     C                     END
066490200529     C                     ENDIF                                                            CRE083BK
066500200529      *                                                                   S01522
066510200529      **  Set up Narrative message: rightmost byte blank                  S01522
066520200529     C**********           MOVEL'GB0020'  MGD,2     P                                S01522 MD022635
066530200529     C**********           MOVEL'GB0020'  MGD,4     P                              MD022635 MD039001
066540200529     C                     MOVEL'GB0020'  MGD,2     P                                       MD039001
066550200529     C*
066560200529     C** ACCESS CHARGES NARRATIVE
066570200529     C*
066580200529     C                     MOVE 'R3'      LNARC
066590200529     C**********           MOVEL'CHARGES' DN07,3                                              CGL029
066600200529     C                     MOVEL'CHARGE'  DN07,3                                              CGL029
066610200529     C                     MOVEL'CHARGES 'NR16,3
066620200529     C/COPY WNCPYSRC,RE3664C142
066630200529     C*
066640200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
066650200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
066660200529      *                                                                                     CRE083BK
066670200529     C           *IN18     IFEQ '1'                                                         CRE083BK
066680200529     C           B         OCUR SDNARR                                                      CRE083BK
066690200529     C                     MOVELNARD      NAR,3                                             MD020956
066700200529     C                     ELSE                                                             CRE083BK
066710200529      *                                                                                     MD021155
066720200529     C           1         OCUR SDNARR                                                      MD021155
066730200529     C                     CALL 'AONARRR0'
066740200529     C                     PARM *BLANKS   @RTCD
066750200529     C                     PARM '*KEY   ' @OPTN
066760200529     C                     PARM LNARC     @NVCD   2
066770200529     C           SDNARR    PARM SDNARR    DSFDY
066780200529     C           @RTCD     IFNE *BLANK
066790200529     C                     MOVELNR16,3    NAR,3
066800200529     C                     ELSE
066810200529     C                     MOVELNARD      NAR,3
066820200529     C                     END
066830200529     C                     ENDIF                                                            CRE083BK
066840200529      *                                                                   S01522
066850200529      **  Set up Narrative message: rightmost byte blank                  S01522
066860200529     C                     MOVEL'GB0021'  MGD,3     P                     S01522
066870200529     C*
066880200529     C** ACCESS ACCRUAL  NARRATIVE
066890200529     C*
066900200529     C           CRE002    IFEQ 'Y'                        B1             CRE002
066910200529     C                     MOVE 'R6'      LNARC                           CRE002
066920200529     C**********           MOVEL'CAPIT. ' DN07,4                                       CRE002 CGL029
066930200529     C                     MOVEL'CAPIT.'  DN07,4                                              CGL029
066940200529     C                     MOVEL'CAPITAL' NR16P1                          CRE002
066950200529     C                     MOVEL'ISATION' NR16P2                          CRE002
066960200529     C                     MOVELNR16DS    NR16,4                          CRE002
066970200529     C                     ELSE                            X1             CRE002
066980200529     C                     MOVE 'R4'      LNARC
066990200529     C**********           MOVEL'ACCRUAL' DN07,4                                              CGL029
067000200529     C                     MOVEL'ACCR. '  DN07,4                                              CGL029
067010200529     C***********          MOVEL'ACCRUALS'NR16,4                          074598
067020200529     C/COPY WNCPYSRC,RE3664C008                                           S01408
067030200529     C                     MOVEL'ACCR.A/C'FLD10  10                       074598
067040200529     C                     MOVE ' -'      FLD10                           074598
067050200529     C                     MOVELFLD10     NR16,4                          074598
067060200529     C/COPY WNCPYSRC,RE3664C009                                           S01408
067070200529     C                     ENDIF                           E1             CRE002
067080200529     C*
067090200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
067100200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
067110200529      *                                                                                     CRE083BK
067120200529     C           *IN18     IFEQ '1'                                                         CRE083BK
067130200529     C           B         OCUR SDNARR                                                      CRE083BK
067140200529     C                     MOVELNARD      NAR,4                                             MD020956
067150200529     C                     ELSE                                                             CRE083BK
067160200529      *                                                                                     MD021155
067170200529     C           1         OCUR SDNARR                                                      MD021155
067180200529     C                     CALL 'AONARRR0'
067190200529     C                     PARM *BLANKS   @RTCD
067200200529     C                     PARM '*KEY   ' @OPTN
067210200529     C                     PARM LNARC     @NVCD   2
067220200529     C           SDNARR    PARM SDNARR    DSFDY
067230200529     C           @RTCD     IFNE *BLANK
067240200529     C           CRE002    IFNE 'Y'                                       183947
067250200529     C**********           MOVELNR16,4    NAR,4                           183947
067260200529     C                     MOVE *BLANKS   NAR,4                           183947
067270200529     C                     MOVEL'INT.CAP.'NAR,4                           183947
067280200529     C                     END                                            183947
067290200529     C                     ELSE
067300200529     C                     MOVELNARD      NAR,4
067310200529     C                     END
067320200529     C                     ENDIF                                                            CRE083BK
067330200529      *                                                                   S01522
067340200529      **  Set up Narrative message: rightmost byte blank                  S01522
067350200529     C                     MOVEL'GB0022'  MGD,4     P                     S01522
067360200529     C/COPY WNCPYSRC,RE3664C227
067370200529     C*                                                                   057048
067380200529     C** ACCESS CLOSURE INTEREST NARRATIVE                                057048
067390200529     C*                                                                   057048
067400200529     C**********           MOVE 'R5'      LNARC                     057048189038
067410200529     C                     MOVE 'R2'      LNARC                           189038
067420200529     C                     Z-ADD11        #                               057048
067430200529     C***********          MOVEL'CLOSURE' DN07,#                    057048084082
067440200529     C***********          MOVEL'CLOSURE' NR16,#                    057048084082
067450200529     C***********          MOVEL'BRT INT' DN07,#                          088273
067460200529     C***********          MOVEL'BRT INTE'NR16,#                          088273
067470200529     C***********          MOVE 'REST    'NR16,#                          088273
067480200529     C**********           MOVEL'CLOSURE' DN07,#                                       088273 CGL029
067490200529     C                     MOVEL'CLOSUR'  DN07,#                                              CGL029
067500200529     C                     MOVEL'CLOS.INT'NR16,#                          088273
067510200529     C                     MOVE '. -     'NR16,#                          088273
067520200529     C/COPY WNCPYSRC,RE3664C143
067530200529     C*                                                                   057048
067540200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
067550200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
067560200529      *                                                                                     CRE083BK
067570200529     C           *IN18     IFEQ '1'                                                         CRE083BK
067580200529     C           B         OCUR SDNARR                                                      CRE083BK
067590200529     C                     MOVELNARD      NAR,#                           057048            MD020956
067600200529     C                     ELSE                                                             CRE083BK
067610200529      *                                                                                     MD021155
067620200529     C           1         OCUR SDNARR                                                      MD021155
067630200529     C                     CALL 'AONARRR0'                                057048
067640200529     C                     PARM *BLANKS   @RTCD                           057048
067650200529     C                     PARM '*KEY   ' @OPTN                           057048
067660200529     C                     PARM LNARC     @NVCD   2                       057048
067670200529     C           SDNARR    PARM SDNARR    DSFDY                           057048
067680200529     C           @RTCD     IFNE *BLANK                                    057048
067690200529     C                     MOVE '       ' NR16,#                          183947
067700200529     C                     MOVELNR16,#    NAR,#                           057048
067710200529     C                     MOVE '. -     'NR16,#                          183947
067720200529     C                     ELSE                                           057048
067730200529     C                     MOVELNARD      NAR,#                           057048
067740200529     C                     END                                            057048
067750200529     C                     ENDIF                                                            CRE083BK
067760200529      *                                                                   S01522
067770200529      **  Set up Narrative message: rightmost byte blank                  S01522
067780200529     C**********           MOVEL'GB0023'  MGD,11    P                                S01522 MD022635
067790200529     C                     MOVEL'GB0023'  MGD,#     P                                       MD022635
067800200529     C*
067810200529     C** ACCESS TAXES NARRATIVE
067820200529     C*
067830200529     C*                                                                   S01408
067840200529     C/COPY WNCPYSRC,RE3664CP27                                           S01408
067850200529     C*                                                                   S01408
067860200529     C********** TXWTRR    IFNE 0                          - B0                               CDL013
067870200529     C           CDL013    IFEQ '1'                                                           CDL013
067880200529     C           CGL165    OREQ 'Y'                                                           CGL165
067890200529     C           CDL013    OREQ '0'                                                           CDL013
067900200529     C           TXWTRR    ANDNE0                                                             CDL013
067910200529     C*                                                                   S01408
067920200529     C/COPY WNCPYSRC,RE3664CP28                                           S01408
067930200529     C*                                                                   S01408
067940200529     C                     MOVE 'T1'      LNARC
067950200529     C**********           MOVEL'W/TAX  ' DN07,5                                              CGL029
067960200529     C                     MOVEL'W/TAX '  DN07,5                                              CGL029
067970200529     C                     MOVEL'WITHHOLD'NR16,5
067980200529     C                     MOVE 'ING TAX 'NR16,5
067990200529     C*
068000200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
068010200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
068020200529      *                                                                                     CRE083BK
068030200529     C           *IN18     IFEQ '1'                                                         CRE083BK
068040200529     C           B         OCUR SDNARR                                                      CRE083BK
068050200529     C                     MOVELNARD      NAR,5                                             MD020956
068060200529     C                     ELSE                                                             CRE083BK
068070200529      *                                                                                     MD021155
068080200529     C           1         OCUR SDNARR                                                      MD021155
068090200529     C                     CALL 'AONARRR0'
068100200529     C                     PARM *BLANKS   @RTCD
068110200529     C                     PARM '*KEY   ' @OPTN
068120200529     C                     PARM LNARC     @NVCD   2
068130200529     C           SDNARR    PARM SDNARR    DSFDY
068140200529     C           @RTCD     IFNE *BLANK
068150200529     C                     MOVELNR16,5    NAR,5
068160200529     C                     ELSE
068170200529     C                     MOVELNARD      NAR,5
068180200529     C                     END
068190200529     C                     ENDIF                                                            CRE083BK
068200200529      *                                                                   S01522
068210200529      **  Set up Narrative message: rightmost byte blank                  S01522
068220200529     C                     MOVEL'GB0024'  MGD,5     P                     S01522
068230200529     C*
068240200529     C                     END                             - E0
068250200529     C*
068260200529     C           BGNTST    IFEQ 'Y'                        - B0
068270200529     C                     MOVE 'T2'      LNARC
068280200529     C**********           MOVEL'TOT. DR' DN07,6                                              CGL029
068290200529     C                     MOVEL'TOT.DR'  DN07,6                                              CGL029
068300200529     C                     MOVEL'TOTAL DE'NR16,6
068310200529     C                     MOVE 'BIT     'NR16,6
068320200529     C/COPY WNCPYSRC,RE3664C144
068330200529     C*
068340200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
068350200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
068360200529      *                                                                                     CRE083BK
068370200529     C           *IN18     IFEQ '1'                                                         CRE083BK
068380200529     C           B         OCUR SDNARR                                                      CRE083BK
068390200529     C                     MOVELNARD      NAR,6                                             MD020956
068400200529     C                     ELSE                                                             CRE083BK
068410200529      *                                                                                     MD021155
068420200529     C           1         OCUR SDNARR                                                      MD021155
068430200529     C                     CALL 'AONARRR0'
068440200529     C                     PARM *BLANKS   @RTCD
068450200529     C                     PARM '*KEY   ' @OPTN
068460200529     C                     PARM LNARC     @NVCD   2
068470200529     C           SDNARR    PARM SDNARR    DSFDY
068480200529     C           @RTCD     IFNE *BLANK
068490200529     C                     MOVELNR16,6    NAR,6
068500200529     C                     ELSE
068510200529     C                     MOVELNARD      NAR,6
068520200529     C                     END
068530200529     C                     ENDIF                                                            CRE083BK
068540200529      *                                                                   S01522
068550200529      **  Set up Narrative message: rightmost byte blank                  S01522
068560200529     C                     MOVEL'GB0025'  MGD,6     P                     S01522
068570200529     C*
068580200529     C                     MOVE 'T3'      LNARC
068590200529     C                     MOVEL'TOT. CR' DN07,7
068600200529     C                     MOVEL'TOTAL CR'NR16,7
068610200529     C                     MOVE 'EDIT    'NR16,7
068620200529     C/COPY WNCPYSRC,RE3664C145
068630200529     C*
068640200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
068650200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
068660200529      *                                                                                     CRE083BK
068670200529     C           *IN18     IFEQ '1'                                                         CRE083BK
068680200529     C           B         OCUR SDNARR                                                      CRE083BK
068690200529     C                     MOVELNARD      NAR,7                                             MD020956
068700200529     C                     ELSE                                                             CRE083BK
068710200529      *                                                                                     MD021155
068720200529     C           1         OCUR SDNARR                                                      MD021155
068730200529     C                     CALL 'AONARRR0'
068740200529     C                     PARM *BLANKS   @RTCD
068750200529     C                     PARM '*KEY   ' @OPTN
068760200529     C                     PARM LNARC     @NVCD   2
068770200529     C           SDNARR    PARM SDNARR    DSFDY
068780200529     C           @RTCD     IFNE *BLANK
068790200529     C                     MOVELNR16,7    NAR,7
068800200529     C                     ELSE
068810200529     C                     MOVELNARD      NAR,7
068820200529     C                     END
068830200529     C                     ENDIF                                                            CRE083BK
068840200529      *                                                                   S01522
068850200529      **  Set up Narrative message: rightmost byte blank                  S01522
068860200529     C                     MOVEL'GB0026'  MGD,7     P                     S01522
068870200529     C*
068880200529     C                     MOVE 'T4'      LNARC
068890200529     C                     MOVEL'CR SBJ'  DN07,8
068900200529     C                     MOVEL'TOT. CR 'NR16,8
068910200529     C                     MOVE 'SUBJ TAX'NR16,8
068920200529     C/COPY WNCPYSRC,RE3664C146
068930200529     C*
068940200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
068950200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
068960200529      *                                                                                     CRE083BK
068970200529     C           *IN18     IFEQ '1'                                                         CRE083BK
068980200529     C           B         OCUR SDNARR                                                      CRE083BK
068990200529     C                     MOVELNARD      NAR,8                                             MD020956
069000200529     C                     ELSE                                                             CRE083BK
069010200529      *                                                                                     MD021155
069020200529     C           1         OCUR SDNARR                                                      MD021155
069030200529     C                     CALL 'AONARRR0'
069040200529     C                     PARM *BLANKS   @RTCD
069050200529     C                     PARM '*KEY   ' @OPTN
069060200529     C                     PARM LNARC     @NVCD   2
069070200529     C           SDNARR    PARM SDNARR    DSFDY
069080200529     C           @RTCD     IFNE *BLANK
069090200529     C                     MOVELNR16,8    NAR,8
069100200529     C                     ELSE
069110200529     C                     MOVELNARD      NAR,8
069120200529     C                     END
069130200529     C                     ENDIF                                                            CRE083BK
069140200529      *                                                                   S01522
069150200529      **  Set up Narrative message: rightmost byte blank                  S01522
069160200529     C                     MOVEL'GB0027'  MGD,8     P                     S01522
069170200529     C*
069180200529     C                     MOVE 'T5'      LNARC
069190200529     C**********           MOVEL'CR NSBJ' DN07,9                                              CGL029
069200200529     C                     MOVEL'CR NSJ'  DN07,9                                              CGL029
069210200529     C                     MOVEL'TOT. CR 'NR16,9
069220200529     C                     MOVE 'NOT SUBJ'NR16,9
069230200529     C/COPY WNCPYSRC,RE3664C147
069240200529     C*
069250200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
069260200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
069270200529      *                                                                                     CRE083BK
069280200529     C           *IN18     IFEQ '1'                                                         CRE083BK
069290200529     C           B         OCUR SDNARR                                                      CRE083BK
069300200529     C                     MOVELNARD      NAR,9                                             MD020956
069310200529     C                     ELSE                                                             CRE083BK
069320200529      *                                                                                     MD021155
069330200529     C           1         OCUR SDNARR                                                      MD021155
069340200529     C                     CALL 'AONARRR0'
069350200529     C                     PARM *BLANKS   @RTCD
069360200529     C                     PARM '*KEY   ' @OPTN
069370200529     C                     PARM LNARC     @NVCD   2
069380200529     C           SDNARR    PARM SDNARR    DSFDY
069390200529     C           @RTCD     IFNE *BLANK
069400200529     C                     MOVELNR16,9    NAR,9
069410200529     C                     ELSE
069420200529     C                     MOVELNARD      NAR,9
069430200529     C                     END
069440200529     C                     ENDIF                                                            CRE083BK
069450200529      *                                                                   S01522
069460200529      **  Set up Narrative message: rightmost byte blank                  S01522
069470200529     C                     MOVEL'GB0028'  MGD,9     P                     S01522
069480200529      **Set*up*narrative*for*transfer*of*net*interest*to*alt.*a/c******************   135809 135809R
069490200529     C**********           MOVE 'T6'      LNARC                                       135809 135809R
069500200529     C**********           Z-ADD13        #                                           135809 135809R
069510200529     C**********           MOVEL'NET ALT' DN07,#                                       135809 CGL029
069520200529     C**********           MOVEL'NT ALT'  DN07,#                                      CGL029 135809R
069530200529     C**********           MOVEL'NET INT.'NR16,#                                      135809 135809R
069540200529     C**********           MOVE 'TO ALT. 'NR16,#                                      135809 135809R
069550200529     C**********           CALL 'AONARRR0'                                            135809 135809R
069560200529     C**********           PARM *BLANKS   @RTCD                                       135809 135809R
069570200529     C**********           PARM '*KEY   ' @OPTN                                       135809 135809R
069580200529     C**********           PARM LNARC     @NVCD                                       135809 135809R
069590200529     C********** SDNARR    PARM SDNARR    DSFDY                                       135809 135809R
069600200529     C********** @RTCD     IFNE *BLANK                                                135809 135809R
069610200529     C**********           MOVELNR16,#    NAR,#                                       135809 135809R
069620200529     C**********           ELSE                                                       135809 135809R
069630200529     C**********           MOVELNARD      NAR,#                                       135809 135809R
069640200529     C**********           END                                                        135809 135809R
069650200529      ****Set*up*Narrative*message:*rightmost*byte*blank***************************   135809 135809R
069660200529     C**********           MOVEL'GB0051'  MGD,#     P                                 135809 135809R
069670200529     C/COPY WNCPYSRC,REH00432
069680200529      * Set up narrative for transfer of net interest to*alt. a/c                           AR978914
069690200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
069700200529     C                     MOVE 'T6'      LNARC                                             AR978914
069710200529     C                     Z-ADD13        #                                                 AR978914
069720200529     C                     MOVEL'NT ALT'  DN07,#                                            AR978914
069730200529     C                     MOVEL'NET INT.'NR16,#                                            AR978914
069740200529     C                     MOVE 'TO ALT. 'NR16,#                                            AR978914
069750200529      *                                                                                     MD021155
069760200529     C                     Z-ADDCUNARA    B                                                 MD021155
069770200529     C           LNARC     LOKUPANAR,B                   18                                 MD021155
069780200529      *                                                                                     MD021155
069790200529     C           *IN18     IFEQ '1'                                                         MD021155
069800200529     C           B         OCUR SDNARR                                                      MD021155
069810200529     C                     MOVELNARD      NAR,#                                             MD021155
069820200529     C                     ELSE                                                             MD021155
069830200529      *                                                                                     MD021155
069840200529     C           1         OCUR SDNARR                                                      MD021155
069850200529     C                     CALL 'AONARRR0'                                                  AR978914
069860200529     C                     PARM *BLANKS   @RTCD                                             AR978914
069870200529     C                     PARM '*KEY   ' @OPTN                                             AR978914
069880200529     C                     PARM LNARC     @NVCD                                             AR978914
069890200529     C           SDNARR    PARM SDNARR    DSFDY                                             AR978914
069900200529     C           @RTCD     IFNE *BLANK                                                      AR978914
069910200529     C                     MOVELNR16,#    NAR,#                                             AR978914
069920200529     C                     ELSE                                                             AR978914
069930200529     C                     MOVELNARD      NAR,#                                             AR978914
069940200529     C                     END                                                              AR978914
069950200529     C                     ENDIF                                                            MD021155
069960200529      *   Set up Narrative message: rightmost byte blank                                    AR978914
069970200529     C                     MOVEL'GB0051'  MGD,#     P                                       AR978914
069980200529     C                     ENDIF                                                            MD045460
069990200529     C*
070000200529     C                     END                             - E0
070010200529     C*
070020200529     C           S01383    IFEQ 'Y'
070030200529     C                     MOVE 'B1'      LNARC
070040200529     C*
070050200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
070060200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
070070200529      *                                                                                     CRE083BK
070080200529     C           *IN18     IFEQ '1'                                                         CRE083BK
070090200529     C           B         OCUR SDNARR                                                      CRE083BK
070100200529     C                     MOVELNARD      NAR,#                                             MD020956
070110200529     C                     ELSE                                                             CRE083BK
070120200529      *                                                                                     MD021155
070130200529     C           1         OCUR SDNARR                                                      MD021155
070140200529     C                     CALL 'AONARRR0'
070150200529     C                     PARM *BLANKS   @RTCD
070160200529     C                     PARM '*KEY   ' @OPTN
070170200529     C                     PARM LNARC     @NVCD   2
070180200529     C           SDNARR    PARM SDNARR    DSFDY
070190200529     C*
070200200529     C                     Z-ADD10        #       20
070210200529     C**********           MOVEL'BRT INT' DN07,#                                              CGL029
070220200529     C                     MOVEL'BRT IN'  DN07,#                                              CGL029
070230200529     C                     MOVEL'BRT INTE'NR16,#
070240200529     C                     MOVE 'REST    'NR16,#
070250200529     C/COPY WNCPYSRC,RE3664C148
070260200529     C*
070270200529     C           @RTCD     IFNE *BLANK
070280200529     C                     MOVELNR16,#    NAR,#
070290200529     C                     ELSE
070300200529     C                     MOVELNARD      NAR,#
070310200529     C                     END
070320200529     C                     ENDIF                                                            CRE083BK
070330200529      *                                                                   S01522
070340200529      **  Set up Narrative message: rightmost byte blank                  S01522
070350200529     C                     MOVEL'GB0029'  MGD,#     P                     S01522
070360200529     C*
070370200529     C                     END
070380200529     C*
070390200529     C** CHECK IF BASE CURRENCY EXIST
070400200529     C*
070410200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
070420200529     C           BACCY     LOKUPACUR,A                   17                                 CRE083BK
070430200529      *                                                                                     CRE083BK
070440200529     C           *IN17     IFEQ '1'                                                         CRE083BK
070450200529     C           A         OCUR SDCURR                                                      CRE083BK
070460200529     C                     ELSE                                                             CRE083BK
070470200529     C           1         OCUR SDCURR                                                      MD021155
070480200529     C***********          CALL 'AOCURRR0'                                                    CGL165
070490200529     C                     CALL 'AOCURRR1'                                                    CGL165
070500200529     C                     PARM '*MSG   ' @RTCD
070510200529     C                     PARM '*KEY   ' @OPTN
070520200529     C                     PARM BACCY     @CYCD   3
070530200529     C***********SDCURR    PARM SDCURR    DSSDY                                               CGL165
070540200529     C           SDCURR    PARM SDCURR    DSLDY                                               CGL165
070550200529     C           @RTCD     IFNE *BLANK
070560200529     C           *LOCK     IN   LDA
070570200529     C                     MOVEL'SDCURRPD'DBFILE           ***************
070580200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 10 *CRE002
070590200529     C***********          Z-ADD010       DBASE            ***************CRE002
070600200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 054*CRE002
070610200529     C                     Z-ADD054       DBASE            ***************CRE002
070620200529     C                     OUT  LDA
070630200529     C*********************WRITEERRP1                                     088181
070640200529     C                     EXSR *PSSR
070650200529     C                     END
070660200529     C                     ENDIF                                                            CRE083BK
070670200529     C*
070680200529     C** SAVE PARM FOR CROSS CURRENCY
070690200529     C*
070700200529     C                     Z-ADDCDP       WBCDP
070710200529     C                     Z-ADDSPOT      WBSPOT
070720200529     C                     MOVE MDIN      WBMDIN
070730200529     C                     MOVE TACC      WBTACC
070740200529      *                                                                                       CGL165
070750200529      * If CGL165 is On, save Tax Conversion Rate                                             CGL165
070760200529     C           CGL165    IFEQ 'Y'                                                           CGL165
070770200529     C                     Z-ADDTXCR      WBTXCR                                              CGL165
070780200529     C                     ENDIF                                                              CGL165
070790200529     C/COPY WNCPYSRC,RE3664C194
070800200529     C*                                                                                       CGL165
070810200529     C** If CGL165 is On, obtain and Save Local CCY details                                   CGL165
070820200529     C           CGL165    IFEQ 'Y'                                                           CGL165
070830200529     C                     Z-ADDCUCCYA    A                                                   CGL165
070840200529     C           BJLCCY    LOKUPACUR,A                   17                                   CGL165
070850200529      *                                                                                       CGL165
070860200529     C           *IN17     IFEQ '1'                                                           CGL165
070870200529     C           A         OCUR SDCURR                                                        CGL165
070880200529     C                     ELSE                                                               CGL165
070890200529     C           1         OCUR SDCURR                                                        CGL165
070900200529     C                     CALL 'AOCURRR1'                                                    CGL165
070910200529     C                     PARM '*MSG   ' @RTCD                                               CGL165
070920200529     C                     PARM '*KEY   ' @OPTN                                               CGL165
070930200529     C                     PARM BACCY     @CYCD   3                                           CGL165
070940200529     C           SDCURR    PARM SDCURR    DSLDY                                               CGL165
070950200529     C           @RTCD     IFNE *BLANK                                                        CGL165
070960200529     C           *LOCK     IN   LDA                                                           CGL165
070970200529     C                     MOVEL'SDCURRPD'DBFILE           ***************                    CGL165
070980200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 554*                    CGL165
070990200529     C                     Z-ADD554       DBASE            ***************                    CGL165
071000200529     C                     OUT  LDA                                                           CGL165
071010200529     C                     EXSR *PSSR                                                         CGL165
071020200529     C                     END                                                                CGL165
071030200529     C                     ENDIF                                                              CGL165
071040200529     C*                                                                                       CGL165
071050200529     C** SAVE PARM FOR CROSS CURRENCY                                                         CGL165
071060200529     C*                                                                                       CGL165
071070200529     C                     Z-ADDCDP       WLCDP                                               CGL165
071080200529     C                     Z-ADDSPOT      WLSPOT                                              CGL165
071090200529     C                     MOVE MDIN      WLMDIN                                              CGL165
071100200529     C                     MOVE TACC      WLTACC                                              CGL165
071110200529     C*************        Z-ADDTXCR      WBTXCR                                    CGL165 CC-CGL165
071120200529     C                     Z-ADDTXCR      WLTXCR                                           CC-CGL165
071130200529     C                     ENDIF                                                              CGL165
071140200529     C*
071150200529     C** ACCESS ACCOUNT CODES
071160200529     C*
071170200529     C           WBTACC    IFNE *BLANKS                                   088181
071180200529     C**********           MOVE WBTACC    KACOD   4                                           CGL029
071190200529     C                     MOVE WBTACC    KACOD                                               CGL029
071200200529     C*
071210200529     C                     ADD  1         RCSQ                                              CRE083BK
071220200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
071230200529     C                     Z-ADD055       WDBASE                                            CRE083BK
071240200529     C**********           EXSR CHKACD                                            CRE083BK AR1089863
071250200529     C                     EXSR ACDCCH                                                     AR1089863
071260200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
071270200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
071280200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
071290200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
071300200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
071310200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
071320200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
071330200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
071340200529     C********** *LOCK     IN   LDA                                                         CRE083BK
071350200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
071360200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 78 *CRE002
071370200529     C***********          Z-ADD078       DBASE            ***************CRE002
071380200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 055*           CRE002 CRE083BK
071390200529     C**********           Z-ADD055       DBASE            ***************           CRE002 CRE083BK
071400200529     C**********           OUT  LDA                                                         CRE083BK
071410200529     C*********************WRITEERRP1                                     088181
071420200529     C**********           EXSR *PSSR                                                       CRE083BK
071430200529     C**********           END                                                              CRE083BK
071440200529     C*
071450200529     C                     MOVE A5ACTY    WBTACT
071460200529     C                     ENDIF                                          088181
071470200529     C*
071480200529     C           CGL165    IFEQ 'Y'                                                           CGL165
071490200529     C           WLTACC    ANDNE*BLANKS                                                       CGL165
071500200529     C                     MOVE WBTACC    KACOD                                               CGL165
071510200529     C*                                                                                       CGL165
071520200529     C                     ADD  1         RCSQ                                                CGL165
071530200529     C                     MOVE KACOD     KEYACD                                              CGL165
071540200529     C                     Z-ADD555       WDBASE                                              CGL165
071550200529     C                     EXSR ACDCCH                                                        CGL165
071560200529     C*                                                                                       CGL165
071570200529     C                     MOVE A5ACTY    WLTACT                                              CGL165
071580200529     C                     ENDIF                                                              CGL165
071590200529     C/COPY WNCPYSRC,RE3664CCPG                                           S01408
071600200529     C*                                                                   S01408
071610200529     C                     ENDSR                           **INITPR ENDSR*
071620200529     C********************************************************************
071630200529     C/EJECT
071640200529     C********************************************************************
071650200529     C**
071660200529     C** MAIN subroutine to execute main processing.
071670200529     C**
071680200529     C**     Called by       S T A R T
071690200529     C**     Calls           CHGPR,CREPR,*PSSR,DEBPR,SETPR,TOTAC
071700200529     C**
071710200529      *****************************************************************   CCB003
071720200529     C           MAIN      BEGSR                           **MAIN BEGSR**
071730200529     C*
071740200529     C** RESET NEW FIELDS FOR O/P ON BALANCE STATEMENTS
071750200529     C*
071760200529     C                     MOVE ' '       BRTF
071770200529     C                     Z-ADD0         BRTA
071780200529     C/COPY WNCPYSRC,RE3664C187
071790200529     C*
071800200529     C                     SETOF                     2627
071810200529     C**
071820200529     C**  IF BRT SAR INSTALLED
071830200529     C**  ON CHANGE OF CCY - ACCESS ARC FOR SPOT TRADE EQUIV. ACC. CODE
071840200529     C**
071850200529     C           S01383    IFEQ 'Y'                        B001
071860200529     C           BCCY      ANDNECCY#
071870200529     C*
071880200529     C                     MOVE BCCY      CCY#
071890200529     C*
071900200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
071910200529     C           BCCY      LOKUPACUR,A                   17                                 CRE083BK
071920200529      *                                                                                     CRE083BK
071930200529     C           *IN17     IFEQ '1'                                                         CRE083BK
071940200529     C           A         OCUR SDCURR                                                      CRE083BK
071950200529     C                     ELSE                                                             CRE083BK
071960200529     C           1         OCUR SDCURR                                                      MD021155
071970200529     C                     CALL 'AOCURRR0'
071980200529     C                     PARM '*MSG   ' @RTCD
071990200529     C                     PARM '*KEY   ' @OPTN
072000200529     C                     PARM BCCY      @CYCD   3
072010200529     C           SDCURR    PARM SDCURR    DSSDY
072020200529     C           @RTCD     IFNE *BLANK
072030200529     C           *LOCK     IN   LDA
072040200529     C                     MOVEL'SDCURRPD'DBFILE           ***************
072050200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 51 *CRE002
072060200529     C***********          Z-ADD051       DBASE            ***************CRE002
072070200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 56 *CRE002
072080200529     C                     Z-ADD056       DBASE            ***************CRE002
072090200529     C                     OUT  LDA
072100200529     C***********          WRITEERRP1                                     CCB003
072110200529     C                     EXSR *PSSR
072120200529     C                     END
072130200529     C                     ENDIF                                                            CRE083BK
072140200529     C**
072150200529     C**   MOVE ARRAY ELEMENT WITH CCY DETAILS INTO DATA STRUCTURE.
072160200529     C**
072170200529     C                     MOVE TACC      TACC1   4
072180200529     C           CDP       COMP 1                      8081
072190200529     C           CDP       COMP 2                    83  82
072200200529     C                     MOVE TACC      ACODA
072210200529     C           TACC      IFNE *BLANKS                                                       239314
072220200529     C                     EXSR ACDCHN
072230200529     C                     ENDIF                                                              239314
072240200529     C                     MOVE CDP       CDPW    10
072250200529     C                     MOVE SPOT      SPOTW  138
072260200529     C                     MOVE MDIN      MDINW   1
072270200529     C                     MOVE A5ACSC    TSEC1   2
072280200529     C**
072290200529     C                     END                             E001
072300200529     C*
072310200529     C** INITIALIZE WORK FIELDS
072320200529     C*
072330200529     C                     Z-ADD0         WDIWT
072340200529     C                     Z-ADD0         WCIWT
072350200529     C                     Z-ADD0         WTIWT  130
072360200529     C**********           Z-ADD*ZERO     @CRINT                                      135809 135809R
072370200529     C**********           Z-ADD*ZERO     @CRNET                                      135809 135809R
072380200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
072390200529     C                     Z-ADD*ZERO     @CRINT                                            AR978914
072400200529     C                     Z-ADD*ZERO     @CRNET                                            AR978914
072410200529     C                     ENDIF                                                            MD045460
072420200529     C                     Z-ADD*ZERO     @WCAIC                          130468
072430200529     C*
072440200529     C** SET DEFAULT TAX TO APLLY
072450200529     C                     MOVE 'N'       ATITAX
072460200529     C*
072470200529     C                     MOVE '0'       *IN40                           106213
072480200529     C*                                                                   S01408
072490200529     C/COPY WNCPYSRC,RE3664CP29                                           S01408
072500200529     C*                                                                   S01408
072510200529     C*                                                                   106213
072520200529     C           TXWTRR    IFNE 0
072530200529     C           CDL013    ANDNE'1'                                                           CDL013
072540200529      *                                                                                       CDL013
072550200529      ** If CDL013 installed, perform Tiered WHT Instructions.                                CDL013
072560200529      *                                                                                       CDL013
072570200529     C           CDL013    OREQ '1'                                                           CDL013
072580200529     C*                                                                   S01408
072590200529     C/COPY WNCPYSRC,RE3664CP30                                           S01408
072600200529     C*                                                                   S01408
072610200529      ** If CGL165 installed, also ensure to access ACCNTBXC                                  CGL165
072620200529      *                                                                                       CGL165
072630200529     C           CGL165    OREQ 'Y'                                                           CGL165
072640200529     C***********          Z-ADD81        DBASE                           CRE002
072650200529     C                     Z-ADD057       DBASE            * DB ERROR 057*CRE002
072660200529     C           ACKEY1    CHAINACCNTBXC             40
072670200529     C                     MOVE BCNUM     BCNUMA  6
072680200529     C                     Z-ADD*ZEROS    DBASE
072690200529     C                     END
072700200529     C*
072710200529     C** READ ACCNT TO GET RETAIL NUMBER
072720200529     C*
072730200529     C           *IN40     IFEQ '0'
072740200529     C***********          Z-ADD48        DBASE                           CRE002
072750200529     C                     Z-ADD058       DBASE            * DB ERROR 058*CRE002
072760200529     C           ACKEY1    CHAINACCNT               N40
072770200529     C                     Z-ADD*ZEROS    DBASE
072780200529     C                     END
072790200529     C*
072800200529     C/COPY WNCPYSRC,RE3664C162
072810200529     C           *IN40     IFEQ '1'                        - B1
072820200529     C           *LOCK     IN   LDA
072830200529     C***********          Z-ADD03        DBASE            ***************CRE002
072840200529     C                     Z-ADD059       DBASE                           CRE002
072850200529     C***********          MOVE 'ACCNT'   DBFILE           **DB ERROR 03**CCB003
072860200529     C                     MOVEL'ACCNT'   DBFILE           **DB ERROR 03**CCB003
072870200529     C                     MOVELAKEY      DBKEY            ***************
072880200529     C                     OUT  LDA
072890200529     C                     EXSR *PSSR
072900200529     C                     END                             - E1
072910200529      *                                                                   CAC001
072920200529      **  Setup profit centre of main account                             CAC001
072930200529      *                                                                   CAC001
072940200529     C********** BGN0ST    IFEQ 'Y'                                CAC001 184965
072950200529     C                     MOVELAAPRFC    WMPRFC  4                       CAC001
072960200529      ** Save Profit center of main account                                                 MD022635
072970200529     C                     MOVE AAPRFC    WSVPC                                             MD022635
072980200529     C                     MOVE AAPRFC    PRFC                                              MD022635
072990200529     C**********           ENDIF                                   CAC001 184965
073000200529     C*
073010200529     C** SAVE RETAIL NUMBER IF NECESSARY
073020200529     C*
073030200529     C           AAATYP    IFEQ 'R'                        - B1
073040200529     C           RACN      ANDEQ'Y'                        - B1
073050200529     C                     MOVE AAACNO    WACNO
073060200529     C                     ELSE                            - X1
073070200529     C                     MOVE *BLANKS   WACNO
073080200529     C                     END                             - E1
073090200529     C/COPY WNCPYSRC,REH00446
073100200529     C*
073110200529     C***READ*RECORDS COUNTER                                             CCB003
073120200529     C***********                                                         CCB003
073130200529     C***********          ADD  1         RECN                            CCB003
073140200529     C*
073150200529     C** CHECK IF CURRENCY EXIST
073160200529     C*
073170200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
073180200529     C           BCCY      LOKUPACUR,A                   17                                 CRE083BK
073190200529      *                                                                                     CRE083BK
073200200529     C           *IN17     IFEQ '1'                                                         CRE083BK
073210200529     C           A         OCUR SDCURR                                                      CRE083BK
073220200529     C                     ELSE                                                             CRE083BK
073230200529     C           1         OCUR SDCURR                                                      MD021155
073240200529     C                     CALL 'AOCURRR0'
073250200529     C                     PARM '*MSG   ' @RTCD
073260200529     C                     PARM '*KEY   ' @OPTN
073270200529     C                     PARM BCCY      @CYCD   3
073280200529     C           SDCURR    PARM SDCURR    DSSDY
073290200529     C           @RTCD     IFNE *BLANK
073300200529     C           *LOCK     IN   LDA
073310200529     C                     MOVEL'SDCURRPD'DBFILE           ***************
073320200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 11 *CRE002
073330200529     C***********          Z-ADD011       DBASE            ***************CRE002
073340200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 061*CRE002
073350200529     C                     Z-ADD061       DBASE            ***************CRE002
073360200529     C                     OUT  LDA
073370200529     C***********          WRITEERRP1                                     CCB003
073380200529     C                     EXSR *PSSR
073390200529     C                     END
073400200529     C                     ENDIF                                                            CRE083BK
073410200529     C*
073420200529     C** SAVE PARM FOR CROSS CURRENCY
073430200529     C*
073440200529     C                     Z-ADDCDP       WOCDP
073450200529     C                     Z-ADDSPOT      WOSPOT
073460200529     C                     MOVE MDIN      WOMDIN
073470200529     C                     MOVE TACC      WOTACC
073480200529     C                     Z-ADDTXCR      WOTXCR                                              CGL165
073490200529     C/COPY WNCPYSRC,RE3664C195
073500200529     C*
073510200529     C** CHECK NUMBER OF DECIMAL OF CURRENCY
073520200529     C*
073530200529     C                     MOVEA'0000'    *IN,80
073540200529     C*
073550200529     C           CDP       IFEQ 0                          - B1
073560200529     C                     MOVE '1'       *IN80
073570200529     C                     ELSE                            - X1
073580200529     C           CDP       IFEQ 1                          - B2
073590200529     C                     MOVE '1'       *IN81
073600200529     C                     ELSE                            - X2
073610200529     C           CDP       IFEQ 2                          - B3
073620200529     C                     MOVE '1'       *IN82
073630200529     C                     ELSE                            - X3
073640200529     C                     MOVE '1'       *IN83
073650200529     C                     END                             - E3
073660200529     C                     END                             - E2
073670200529     C                     END                             - E1
073680200529     C*
073690200529     C** POSITIONING ON HISTORY FILE (CAPITALISATION RECORDS)
073700200529     C*
073710200529     C                     Z-ADD*ZEROS    PMADI
073720200529     C                     Z-ADD*ZEROS    RGADI
073730200529     C                     Z-ADD*ZEROS    RDAIC
073740200529     C                     Z-ADD*ZEROS    PMACI
073750200529     C                     Z-ADD*ZEROS    RGACI
073760200529     C                     Z-ADD*ZEROS    RCAIC
073770200529     C                     Z-ADD*ZEROS    CHGP
073780200529     C                     Z-ADD*ZEROS    REGLIS
073790200529      *                                                                                     AR676495
073800200529      ** INITIALISE INTEREST ADJUSTMENT INDICATOR                                           AR676495
073810200529      *                                                                                     AR676495
073820200529     C                     MOVE '0'       INTAD                                             AR676495
073830200529     C*
073840200529     C***********          Z-ADD89        DBASE                           CRE002
073850200529     C                     Z-ADD062       DBASE            * DBERROR  062*CRE002
073860200529     C/COPY WNCPYSRC,RE3664C140
073870200529     C********** ACKEY     SETLLREHISSL                  60                                   CGL029
073880200529     C           ACKEY2    SETLLREHISSL                  60                                   CGL029
073890200529     C*
073900200529     C           *IN60     IFEQ '1'                        - B1
073910200529     C*
073920200529     C** CAPITALISATION RECORD FOUND WITH AMOUNT TO BE POSTED
073930200529     C*
073940200529     C***********          Z-ADD49        DBASE                           CRE002
073950200529     C                     Z-ADD063       DBASE            * DBERROR  063*CRE002
073960200529     C********** ACKEY     READEREHISSL                  60                                   CGL029
073970200529     C           ACKEY2    READEREHISSL                  60                                   CGL029
073980200529     C                     Z-ADD*ZEROS    DBASE
073990200529     C*
074000200529     C** SETUP ACCNT WORK FIELDS PROCESSING
074010200529     C*
074020200529     C                     EXSR SETPR
074030200529     C*
074040200529     C** IF RECORD NOT FOUND, TOTAL ACCOUNT PROCESSING
074050200529     C** OTHERWISE, PROCESSING
074060200529     C*
074070200529     C           *IN60     DOWEQ'0'                        - B2
074080200529     C/COPY WNCPYSRC,RE3664C093
074090200529     C*
074100200529     C           BDICI     IFNE ' '                        - B3
074110200529     C           SDICI     IFEQ 'Y'                        - B4
074120200529     C           SDICI     OREQ 'D'
074130200529     C           SDICI     OREQ 'C'
074140200529     C***********          MOVE 'Y'       SDICI                           094681
074150200529     C           DAIC      IFNE 0                          - B5
074160200529     C           SGADI     ORNE 0
074170200529     C           PMADI     ORNE SMADI                                     091680
074180200529     C*
074190200529     C** DEBIT PROCESSING
074200200529     C*
074210200529     C                     EXSR DEBPR
074220200529     C*
074230200529     C                     END                             - E5
074240200529     C***********          MOVE 'Y'       SDICI                     094681098818
074250200529     C                     END                             - E4
074260200529     C                     END                             - E3
074270200529     C*
074280200529     C           BCICI     IFNE ' '                        - B3
074290200529     C           SCICI     IFEQ 'Y'                        - B4
074300200529     C           SCICI     OREQ 'D'
074310200529     C           SCICI     OREQ 'C'
074320200529     C***********          MOVE 'Y'       SCICI                           094681
074330200529     C           CAIC      IFNE 0                          - B5
074340200529     C           SGACI     ORNE 0
074350200529     C           PMACI     ORNE SMACI                                     091680
074360200529     C*
074370200529     C** CREDIT PROCESSING
074380200529     C*
074390200529     C                     EXSR CREPR
074400200529     C/COPY WNCPYSRC,REH00445
074410200529     C*
074420200529     C                     END                             - E5
074430200529     C***********          MOVE 'Y'       SCICI                     094681098818
074440200529     C                     END                             - E4
074450200529     C                     END                             - E3
074460200529     C*
074470200529     C           BCICI     IFNE ' '                        - B3
074480200529     C           SCHGI     ANDNE' '
074490200529     C           CHGP      ANDNE0
074500200529     C*
074510200529     C** CHARGES PROCESSING
074520200529     C*
074530200529     C                     EXSR CHGPR
074540200529     C*
074550200529     C                     END                             - E3
074560200529     C*
074570200529     C** CAPITALISATION RECORD PROCESSING
074580200529     C*
074590200529     C***********          Z-ADD50        DBASE                           CRE002
074600200529     C                     Z-ADD064       DBASE            * DBERROR  064*CRE002
074610200529     C                     MOVE *BLANKS   ZZ001                                             MD024001
074620200529     C                     UPDATREHISPSF
074630200529     C/COPY WNCPYSRC,RE3664C094
074640200529     C***********          Z-ADDDBASE     DBASE
074650200529     C                     Z-ADD0         DBASE
074660200529     C*
074670200529     C***********          Z-ADD51        DBASE                           CRE002
074680200529     C                     Z-ADD065       DBASE            * DBERROR  065*CRE002
074690200529     C********** ACKEY     READEREHISSL                  60                                   CGL029
074700200529     C           ACKEY2    READEREHISSL                  60                                   CGL029
074710200529     C***********          Z-ADDDBASE     DBASE
074720200529     C                     Z-ADD0         DBASE
074730200529     C*
074740200529     C                     END                             - E2
074750200529     C*
074760200529     C                     ELSE
074770200529     C                     EXSR SETPR
074780200529     C                     MOVE BCCY      CCY
074790200529     C                     MOVE BBRCA     BRCA
074800200529     C*
074810200529     C                     END                             - E1
074820200529     C*
074830200529     C** TOTAL ACCOUNT PROCESSING
074840200529     C*
074850200529     C/COPY WNCPYSRC,REH00447
074860200529     C                     EXSR TOTAC
074870200529     C*
074880200529     C                     ENDSR                           **MAIN ENDSR**
074890200529     C********************************************************************
074900200529     C/EJECT
074910200529     C********************************************************************
074920200529     C***********                                                         CCB003
074930200529     C***OVERPR*subroutine for processing overflow on RE3664PR            CCB003
074940200529     C***********                                                         CCB003
074950200529     C*******Called by       PRDR,PRCR,PRCH                               CCB003
074960200529     C***********                                                         CCB003
074970200529     C*******Calls           -                                            CCB003
074980200529     C***********                                                         CCB003
074990200529     C***********OVERPR    BEGSR                           **OVERPR BEGSR*CCB003
075000200529     C***********                                                         CCB003
075010200529     C****CHECK*IF OVERFLOW ON RE3664P1                                   CCB003
075020200529     C***********                                                         CCB003
075030200529     C********** *IN90     IFEQ '1'                        - B1     075073CCB003
075040200529     C************IN85     IFEQ '1'                        - B1     075073CCB003
075050200529     C**********           ADD  1         PAGE                      085787CCB003
075060200529     C***********          WRITEHEADP1                                    CCB003
075070200529     C***********          MOVE '0'       *IN43                           CCB003
075080200529     C***********          MOVE '0'       *IN90                     075073CCB003
075090200529     C***********          MOVE '0'       *IN85                     075073CCB003
075100200529     C***********          END                             - E1           CCB003
075110200529     C***********                                                         CCB003
075120200529     C***********          ENDSR                           **OVERPR ENDSR*CCB003
075130200529     C********************************************************************
075140200529     C/EJECT
075150200529     C********************************************************************
075160200529     C**
075170200529     C** PLPR subroutine to execute profit and loss processing
075180200529     C**
075190200529     C**     Called by       CREPR,DEBPR
075200200529     C**     Calls           GEICPR
075210200529     C**
075220200529      *****************************************************************   CCB003
075230200529     C           PLPR      BEGSR                           **PLPR BEGSR**
075240200529     C*
075250200529     C/COPY WNCPYSRC,RE3664C059
075260200529     C                     MOVE BBICN     CNUM
075270200529     C/COPY WNCPYSRC,RE3664C112
075280200529     C           WCHRG     IFEQ 'Y'                                                           CRE100
075290200529     C           UPDCUS    ANDNE'Y'                                                         MD027841
075300200529     C           WINT      OREQ 'Y'                                                         MD027841
075310200529     C           UPDCUS    ANDEQ'Y'                                                         MD027841
075320200529     C                     MOVE BCNUM     CNUM                                                CRE100
075330200529     C                     ENDIF                                                              CRE100
075340200529     C                     Z-ADD1         ACSQ
075350200529      * Account Sequence                                                                    MD034990
075360200529     C           RETSEQ    IFEQ 'Y'                                                         MD034990
075370200529     C                     MOVE BACSQ     ACSQ                                              MD034990
075380200529     C                     ENDIF                                                            MD034990
075390200529     C/COPY WNCPYSRC,RE3664C113
075400200529     C                     MOVE BBRCA     BRCA
075410200529     C                     Z-ADD*ZEROS    ACNO
075420200529     C**********           Z-ADDBCNUM     ASOC                                         105084 CSD027
075430200529     C                     MOVE BCNUM     ASOC                                                CSD027
075440200529     C           VALD      IFEQ *ZEROS                                    100086
075450200529     C                     Z-ADDRUND      VALD
075460200529     C                     END                                            100086
075470200529     C******************** Z-ADD*ZERO     RIND
075480200529     C                     EXSR SUBNAR
075490200529     C                     MOVE NARS      PNAR
075500200529     C                     Z-ADD*ZERO     RIND
075510200529     C           ATYP      IFEQ 'R'
075520200529     C                     Z-ADD1         RIND
075530200529     C                     END
075540200529     C*
075550200529     C** GEICPD FILE PROCESSING
075560200529     C*
075570200529     C                     EXSR GEICPR
075580200529     C*
075590200529     C           ATYP      IFEQ 'R'
075600200529     C           VALD      ANDLENAPDA
075610200529     C           *IN50     ANDEQ'0'
075620200529     C/COPY WNCPYSRC,RE3664C060
075630200529     C*
075640200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
075650200529     C*
075660200529     C                     Z-ADDVALD      HISD
075670200529     C***********          Z-ADD30        DBASE                           CRE002
075680200529     C                     Z-ADD066       DBASE            * DBERROR  066*CRE002
075690200529     C                     MOVE 'N'       REACT                           CCB003
075700200529     C                     WRITEREHPOSPF
075710200529     C                     Z-ADD*ZEROS    DBASE
075720200529     C*
075730200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
075740200529     C*
075750200529     C                     EXSR POSPR
075760200529     C*
075770200529     C                     END
075780200529     C/COPY WNCPYSRC,RE3664C061
075790200529     C*
075800200529     C                     ENDSR                           **PLPR ENDSR**
075810200529     C********************************************************************
075820200529     C/EJECT
075830200529     C********************************************************************
075840200529     C**
075850200529     C** POSPR subroutine to update position records for alternate account
075860200529     C**
075870200529     C**     Called by       ALTPR
075880200529     C**     Calls           -
075890200529     C**
075900200529      *****************************************************************   CCB003
075910200529     C           POSPR     BEGSR                           **POSPR BEGSR**
075920200529     C*
075930200529     C** ACCESS POSITION RECORD FOR UPDATE OR ADD THEN UPDATE HEADER
075940200529     C*
075950200529     C***********          Z-ADD52        DBASE                           CRE002
075960200529     C                     Z-ADD067       DBASE            * DBERROR  067*CRE002
075970200529     C           R3KEY     CHAINREHISPDF             40
075980200529     C                     Z-ADD*ZEROS    DBASE
075990200529     C           *IN40     IFEQ '1'                        - B1
076000200529     C                     MOVE 'D'       RECI
076010200529     C                     MOVE *BLANK    DLGID
076020200529     C                     Z-ADD*ZERO     VALL
076030200529     C                     MOVE *BLANKS   LINK
076040200529     C                     MOVE *BLANK    DICI
076050200529     C                     MOVE *BLANK    CICI
076060200529     C                     MOVE *BLANK    DRCI
076070200529     C                     MOVE *BLANK    CRCI
076080200529     C                     MOVE *BLANK    ALTI
076090200529     C                     Z-ADD*ZERO     DRIR
076100200529     C                     Z-ADD*ZERO     CRIR
076110200529     C                     Z-ADD*ZERO     PDID
076120200529     C                     Z-ADD*ZERO     PCID
076130200529     C                     Z-ADD*ZERO     DICT
076140200529     C                     Z-ADD*ZERO     CICT
076150200529     C                     Z-ADD*ZERO     DRCB
076160200529     C                     Z-ADD*ZERO     CRCB
076170200529     C                     MOVE *BLANK    ADTY
076180200529     C                     Z-ADD*ZERO     MNBL
076190200529     C                     Z-ADD*ZERO     CHGAR
076200200529     C                     Z-ADD*ZERO     TCHGAR
076210200529     C                     Z-ADD*ZERO     CHGAN
076220200529     C                     Z-ADD*ZERO     TCHGAN
076230200529     C           WCHGA     IFNE 0                                                             250998
076240200529     C           REBID     IFEQ 'Y'                                                           250998
076250200529     C                     Z-ADDWCHGA     CHGAR                                               250998
076260200529     C                     Z-ADDWCHGA     TCHGAR                                              250998
076270200529     C                     ELSE                                                               250998
076280200529     C                     Z-ADDWCHGA     CHGAN                                               250998
076290200529     C                     Z-ADDWCHGA     TCHGAN                                              250998
076300200529     C                     END                                                                250998
076310200529     C                     END                                                                250998
076320200529     C                     Z-ADD*ZERO     DMVT
076330200529     C                     Z-ADD*ZERO     CMVT
076340200529     C                     Z-ADD*ZERO     DAID
076350200529     C                     Z-ADD*ZERO     MADI
076360200529     C                     Z-ADD*ZERO     TMADI
076370200529     C                     Z-ADD*ZERO     DMINT
076380200529     C                     Z-ADD*ZERO     CAID
076390200529     C                     Z-ADD*ZERO     MACI
076400200529     C                     Z-ADD*ZERO     TMACI
076410200529     C                     Z-ADD*ZERO     CMINT
076420200529     C                     Z-ADD*ZERO     MNBCP
076430200529     C                     Z-ADD*ZERO     DRCD
076440200529     C                     Z-ADD*ZERO     CRCD
076450200529     C                     Z-ADD*ZERO     VDTC
076460200529     C           DRCR      IFEQ 1                          - B2
076470200529     C                     Z-ADDPSTA      CMVT
076480200529     C                     ELSE                            - X2
076490200529     C                     Z-ADDPSTA      DMVT
076500200529     C                     END                             - E2
076510200529     C                     Z-ADD*ZERO     AODR                            CRE002
076520200529     C                     Z-ADD*ZERO     ODRL                            CRE002
076530200529     C                     MOVE *BLANK    ODLI                            CRE002
076540200529     C                     Z-ADD*ZERO     ODIA                            CRE002
076550200529     C***********          Z-ADD53        DBASE                           CRE002
076560200529     C                     Z-ADD068       DBASE            * DBERROR  068*CRE002
076570200529     C                     WRITEREHISPDF
076580200529     C                     Z-ADD*ZEROS    DBASE
076590200529     C                     ELSE                            - X1
076600200529     C           DRCR      IFEQ 1                          - B2
076610200529     C                     ADD  PSTA      CMVT
076620200529     C                     SUB  PSTA      HISB
076630200529     C                     ELSE                            - X2
076640200529     C                     ADD  PSTA      DMVT
076650200529     C                     ADD  PSTA      HISB
076660200529     C                     END                             - E2
076670200529     C           WCHGA     IFNE 0                                                             250998
076680200529     C           REBID     IFEQ 'Y'                                                           250998
076690200529     C                     ADD  WCHGA     CHGAR                                               250998
076700200529     C                     ADD  WCHGA     TCHGAR                                              250998
076710200529     C                     ELSE                                                               250998
076720200529     C                     ADD  WCHGA     CHGAN                                               250998
076730200529     C                     ADD  WCHGA     TCHGAN                                              250998
076740200529     C                     END                                                                250998
076750200529     C                     END                                                                250998
076760200529     C***********          Z-ADD54        DBASE                           CRE002
076770200529     C                     Z-ADD069       DBASE            * DBERROR  069*CRE002
076780200529     C                     UPDATREHISPDF
076790200529     C                     MOVE 'Y'       FCOMIT                                            MD022410
076800200529     C                     Z-ADD*ZEROS    DBASE
076810200529     C                     END                             - E1
076820200529      *                                                                                       250998
076830200529     C                     Z-ADD0         WCHGA                                               250998
076840200529     C/COPY WNCPYSRC,RE3664C163
076850200529     C*
076860200529     C** POSITIONING ON HISTORY FILE (HEADER RECORDS)
076870200529     C*
076880200529     C***********          Z-ADD55        DBASE                           CRE002
076890200529     C                     Z-ADD070       DBASE            * DBERROR  070*CRE002
076900200529     C           R2KEY     CHAINREHISPBF             40
076910200529     C                     Z-ADD*ZEROS    DBASE
076920200529     C*
076930200529     C           *IN40     IFEQ '1'                        - B1
076940200529     C*
076950200529     C** HEADER RECORD NOT FOUND
076960200529     C*
076970200529     C           *LOCK     IN   LDA
076980200529     C***********          Z-ADD14        DBASE            ***************CRE002
076990200529     C                     Z-ADD071       DBASE                           CRE002
077000200529     C***********          MOVE 'HISSL'   DBFILE           **DB ERROR 14**CCB003
077010200529     C                     MOVEL'HISSL'   DBFILE           **DB ERROR 14**CCB003
077020200529     C                     MOVELRKEY2     DBKEY            ***************
077030200529     C                     OUT  LDA
077040200529     C                     EXSR *PSSR
077050200529     C*
077060200529     C                     END                             - E1
077070200529     C*
077080200529     C           VDTC      IFGT SHISD                      - B1
077090200529     C                     Z-ADDSHISD     VDTC
077100200529     C                     END                             - E1
077110200529     C***********          MOVE 'Y'       ADTY                            122952
077120200529     C***********          Z-ADD56        DBASE                           CRE002
077130200529     C                     Z-ADD072       DBASE            * DBERROR  072*CRE002
077140200529     C                     UPDATREHISPBF
077150200529     C                     MOVE 'Y'       FCOMIT                                            MD045084
077160200529     C                     Z-ADD*ZEROS    DBASE
077170200529     C*
077180200529     C                     ENDSR                           **POSPR ENDSR**
077190200529     C********************************************************************
077200200529     C/EJECT
077210200529     C********************************************************************
077220200529     C**
077230200529     C** PRCHG subroutine for CHARGES OUTPUT
077240200529     C**
077250200529     C**     Called by       TOTAC
077260200529     C**     Calls           *PSSR, ZDATE2
077270200529     C**
077280200529      *****************************************************************   CCB003
077290200529     C           PRCHG     BEGSR                           **PRCHG BEGSR**
077300200529     C*
077310200529     C                     Z-ADD0         RAINTR           Interest rate  CCB003
077320200529     C                     Z-ADD0         RAMADJ           Manual adj amt CCB003
077330200529     C                     Z-ADD0         RAGADT           General int adjCCB003
077340200529     C**********           Z-ADDBCNUM     RACNUM           Customer number             CCB003 CSD027
077350200529     C                     MOVE BCNUM     RACNUM           Customer number                    CSD027
077360200529     C                     MOVE BCCY      RACCY            Currency       CCB003
077370200529     C                     Z-ADDBACOD     RAACOD           Account Code   CCB003
077380200529     C                     Z-ADDBACSQ     RAACSQ           Account SequencCCB003
077390200529     C                     MOVE BRCA#     RABRCA           Branch         CCB003
077400200529     C                     Z-ADDAACNO     RAACNO           Retail AC No.  CCB003
077410200529     C                     MOVE 'H'       RAPOST           Posting Type   CCB003
077420200529     C*
077430200529     C***********          Z-ADDLPAP      ZDAYNO                          CCB003
077440200529     C                     Z-ADDLPAP      RACPDA           Capital. date  CCB003
077450200529      *                                                                   CCB003
077460200529     C***********          EXSR ZDATE2                                    CCB003
077470200529     C***********                                                         CCB003
077480200529     C************IN99     IFEQ '1'                        - B3           CCB003
077490200529     C************LOCK     IN   LDA                                       CCB003
077500200529     C***********          Z-ADDLPAP      WDATE                           CCB003
077510200529     C***********          Z-ADD15        DBASE                           CCB003
077520200529     C***********          MOVE 'ZDATE2'  DBFILE           ***************CCB003
077530200529     C***********          MOVELWDATE     DBKEY            **DB ERROR 15**CCB003
077540200529     C***********          OUT  LDA                        ***************CCB003
077550200529     C***********          EXSR *PSSR                                     CCB003
077560200529     C***********          END                             - E1           CCB003
077570200529     C*
077580200529     C                     Z-ADDCHGT      RAINTP           Interest type  CCB003
077590200529     C                     Z-ADDCHST      RAINST           Interest SubTypeCB003
077600200529     C***********          Z-ADDCHGP      CHCP0                           CCB003
077610200529     C                     Z-ADDCHGP      RAAIAP           Accrued int adjCCB003
077620200529     C*
077630200529     C           SCHGI     IFEQ 'Y'                        - B1
077640200529     C           SCHGI     OREQ 'I'
077650200529     C***********          MOVE '1'       *IN71                           CCB003
077660200529     C                     MOVE 'Y'       RAPTFL           Posted today   CCB003
077670200529     C                     END                             - E1
077680200529     C*
077690200529     C           SCHGI     IFEQ 'S'                        - B1
077700200529     C***********          MOVE '1'       *IN72                           CCB003
077710200529     C                     MOVE 'S'       RAPTFL           Posted today   CCB003
077720200529     C                     END                             - E1
077730200529     C*
077740200529     C           SCHGI     IFEQ 'L'                        - B1
077750200529     C***********          MOVE '1'       *IN73                           CCB003
077760200529     C                     MOVE 'I'       RAPTFL           Posted today   CCB003
077770200529     C                     END                             - E1
077780200529     C*
077790200529     C           SCHGI     IFEQ 'O'                        - B1
077800200529     C***********          MOVE '1'       *IN74                           CCB003
077810200529     C                     MOVE 'L'       RAPTFL           Posted today   CCB003
077820200529     C                     END                             - E1
077830200529     C*
077840200529     C           SCHGI     IFEQ 'A'                        - B1
077850200529     C           SCHGI     OREQ 'P'
077860200529     C           SCHGI     OREQ 'Q'
077870200529     C***********          MOVE '1'       *IN75                           CCB003
077880200529     C                     MOVE 'A'       RAPTFL           Posted today   CCB003
077890200529     C                     END                             - E1
077900200529     C*                                                             075073085787
077910200529     C* If checks not allowed for against SCHGI false on indicator 61     075073
077920200529     C*                                                             075073085787
077930200529     C***********SCHGI     IFNE 'Y'                                 075073085787
077940200529     C***********SCHGI     ORNE 'I'                                 075073085787
077950200529     C***********SCHGI     ORNE 'S'                                 075073085787
077960200529     C***********SCHGI     ORNE 'L'                                 075073085787
077970200529     C***********SCHGI     ORNE 'O'                                 075073085787
077980200529     C***********SCHGI     ORNE 'A'                                 075073085787
077990200529     C***********SCHGI     ORNE 'P'                                 075073085787
078000200529     C***********SCHGI     ORNE 'Q'                                 075073085787
078010200529     C************IN61     ANDNE'1'                                 085787085787
078020200529     C************IN66     ANDNE'1'                                 085787085787
078030200529     C************IN71     IFEQ *OFF                                085787CCB003
078040200529     C************IN72     ANDEQ*OFF                                085787CCB003
078050200529     C************IN73     ANDEQ*OFF                                085787CCB003
078060200529     C************IN74     ANDEQ*OFF                                085787CCB003
078070200529     C************IN75     ANDEQ*OFF                                085787CCB003
078080200529     C***********          MOVE '1'       *IN71                     075073CCB003
078090200529     C***********          END                                      075073CCB003
078100200529     C*
078110200529     C           RAPTFL    IFEQ *BLANKS                                   CCB003
078120200529     C                     MOVE 'Y'       RAPTFL           Posted today   CCB003
078130200529     C                     ENDIF                                          CCB003
078140200529      *                                                                   CCB003
078150200529     C           OKEY      IFNE AKEY                       - B1
078160200529     C                     MOVE '0'       *IN43
078170200529     C**********           Z-ADDBCNUM     OCNUM                                               CSD027
078180200529     C                     MOVE BCNUM     OCNUM                                               CSD027
078190200529     C                     MOVE BCCY      OCCY
078200200529     C                     Z-ADDBACOD     OACOD
078210200529     C                     Z-ADDBACSQ     OACSQ
078220200529     C                     MOVE BBRCA     OBRCA
078230200529     C                     END                             - E1
078240200529     C*
078250200529     C***********          EXSR OVERPR                                    CCB003
078260200529     C***********                                                         CCB003
078270200529     C***********          Z-ADD57        DBASE                           CCB003
078280200529     C***********          WRITEDETCH                                     CCB003
078290200529     C***********          Z-ADD*ZEROS    DBASE                           CCB003
078300200529     C***********          Z-ADD*ZEROS    CHCP0                           CCB003
078310200529     C***********          MOVE '1'       *IN43                           CCB003
078320200529     C***********          MOVEA'00000'   *IN,71                          CCB003
078330200529      *                                                                   CCB003
078340200529      ** Write record to Audit file                                       CCB003
078350200529     C                     WRITEREINCXD0                                  CCB003
078360200529     C                     CLEARREINCXD0                                  CCB003
078370200529     C*
078380200529     C                     ENDSR                           **PRCHG ENDSR**
078390200529     C********************************************************************
078400200529     C/EJECT
078410200529     C********************************************************************
078420200529     C**
078430200529     C** PRCR  subroutine for CREDIT  OUTPUT
078440200529     C**
078450200529     C**     Called by       TOTAC
078460200529     C**     Calls           *PSSR
078470200529     C**
078480200529      *****************************************************************   CCB003
078490200529     C           PRCR      BEGSR                           **PRCR  BEGSR**
078500200529      *                                                                   CCB003
078510200529     C**********           Z-ADDBCNUM     RACNUM           Customer number             CCB003 CSD027
078520200529     C                     MOVE BCNUM     RACNUM           Customer number                    CSD027
078530200529     C                     MOVE BCCY      RACCY            Currency       CCB003
078540200529     C                     Z-ADDBACOD     RAACOD           Account Code   CCB003
078550200529     C                     Z-ADDBACSQ     RAACSQ           Account SequencCCB003
078560200529     C                     MOVE BRCA#     RABRCA           Branch         CCB003
078570200529     C                     Z-ADDAACNO     RAACNO           Retail AC No.  CCB003
078580200529     C                     MOVE 'C'       RAPOST           Posting Type   CCB003
078590200529     C*
078600200529     C***********          Z-ADDLPAP      ZDAYNO                          CCB003
078610200529     C                     Z-ADDLPAP      RACPDA           Capitalisation CCB003
078620200529      *                                                                   CCB003
078630200529     C***********          EXSR ZDATE2                                    CCB003
078640200529     C***********                                                         CCB003
078650200529     C************IN99     IFEQ '1'                        - B3           CCB003
078660200529     C************LOCK     IN   LDA                                       CCB003
078670200529     C***********          Z-ADDLPAP      WDATE                           CCB003
078680200529     C***********          Z-ADD16        DBASE                           CCB003
078690200529     C***********          MOVE 'ZDATE2'  DBFILE           ***************CCB003
078700200529     C***********          MOVELWDATE     DBKEY            **DB ERROR 16**CCB003
078710200529     C***********          OUT  LDA                        ***************CCB003
078720200529     C***********          EXSR *PSSR                                     CCB003
078730200529     C***********          END                             - E1           CCB003
078740200529     C*
078750200529     C           SCICT     IFEQ *ZEROS                     - B1
078760200529     C           CCST      ANDEQ*ZEROS
078770200529      *                                                                   CCB003
078780200529     C***********CRIB      IFEQ *ZEROS                     - B2           CCB003
078790200529     C***********          Z-ADDACRIS     RATECR                          CCB003
078800200529     C***********          ELSE                            - X2           CCB003
078810200529     C***********          Z-ADDCCIR      RATECR                          CCB003
078820200529     C***********          END                             - E2           CCB003
078830200529     C***********          Z-ADDSCRIR     RATECR                          CCB003
078840200529     C***********          MOVE '0'       *IN36                           CCB003
078850200529      *                                                                   CCB003
078860200529     C                     Z-ADDSCRIR     RAINTR           Interest rate  CCB003
078870200529      *                                                                   CCB003
078880200529     C                     END                             - E1
078890200529     C*
078900200529     C                     Z-ADDACICT     RAINTP           Interest type  CCB003
078910200529     C                     Z-ADDCCST      RAINST           Interest subtypCCB003
078920200529     C                     Z-ADDMACI0     RAMADJ           Manual adj.    CCB003
078930200529     C                     Z-ADDGACI0     RAGADT           Generated      CCB003
078940200529     C                     Z-ADDCRCP0     RAAIAP           Accrued        CCB003
078950200529      *                                                                   CCB003
078960200529     C           SCCI      IFEQ 'Y'                        - B1
078970200529     C           SCCI      OREQ 'I'
078980200529     C***********          MOVE '1'       *IN66                           CCB003
078990200529     C                     MOVE 'Y'       RAPTFL           Posted Today   CCB003
079000200529     C                     END                             - E1
079010200529     C*
079020200529     C           SCCI      IFEQ 'S'                        - B1
079030200529     C***********          MOVE '1'       *IN67                           CCB003
079040200529     C                     MOVE 'S'       RAPTFL           Posted Today   CCB003
079050200529     C                     END                             - E1
079060200529     C*
079070200529     C           SCCI      IFEQ 'L'                        - B1
079080200529     C***********          MOVE '1'       *IN68                           CCB003
079090200529     C                     MOVE 'I'       RAPTFL           Posted Today   CCB003
079100200529     C                     END                             - E1
079110200529     C*
079120200529     C           SCCI      IFEQ 'O'                        - B1
079130200529     C***********          MOVE '1'       *IN69                           CCB003
079140200529     C                     MOVE 'L'       RAPTFL           Posted Today   CCB003
079150200529     C                     END                             - E1
079160200529     C*
079170200529     C           SCCI      IFEQ 'A'                        - B1
079180200529     C***********          MOVE '1'       *IN70                           CCB003
079190200529     C                     MOVE 'A'       RAPTFL           Posted Today   CCB003
079200200529     C                     END                             - E1
079210200529     C*                                                                   075073
079220200529     C* If checks not allowed for against SCCI false on indicator 61      075073
079230200529     C*                                                                   075073
079240200529     C***********SCCI      IFNE 'Y'                                 075073085787
079250200529     C***********SCCI      ORNE 'I'                                 075073085787
079260200529     C***********SCCI      ORNE 'S'                                 075073085787
079270200529     C***********SCCI      ORNE 'L'                                 075073085787
079280200529     C***********SCCI      ORNE 'O'                                 075073085787
079290200529     C***********SCCI      ORNE 'A'                                 075073085787
079300200529     C************IN61     ANDNE'1'                                       085787
079310200529     C************IN71     ANDNE'1'                                       085787
079320200529     C************IN66     IFEQ *OFF                                      085787
079330200529     C************IN67     ANDEQ*OFF                                      085787
079340200529     C************IN68     ANDEQ*OFF                                      085787
079350200529     C************IN69     ANDEQ*OFF                                      085787
079360200529     C************IN70     ANDEQ*OFF                                      085787
079370200529     C***********          MOVE '1'       *IN66                           075073
079380200529     C***********          END                                            075073
079390200529     C*
079400200529     C           RAPTFL    IFEQ *BLANK                                    CCB003
079410200529     C                     MOVE 'Y'       RAPTFL           Posted Today   CCB003
079420200529     C                     ENDIF                                          CCB003
079430200529      *                                                                   CCB003
079440200529     C           OKEY      IFNE AKEY                       - B1
079450200529     C                     MOVE '0'       *IN43
079460200529     C**********           Z-ADDBCNUM     OCNUM                                               CSD027
079470200529     C                     MOVE BCNUM     OCNUM                                               CSD027
079480200529     C                     MOVE BCCY      OCCY
079490200529     C                     Z-ADDBACOD     OACOD
079500200529     C                     Z-ADDBACSQ     OACSQ
079510200529     C                     MOVE BBRCA     OBRCA
079520200529     C                     END                             - E1
079530200529     C*
079540200529      *                                                                   085787
079550200529      * Print details even if accrued interest is zero.                   085787
079560200529     C***********CRCP0     IFNE *ZERO                      - B1           085787
079570200529     C***********MACI0     ORNE *ZERO                                     085787
079580200529     C***********GACI0     ORNE *ZERO                                     085787
079590200529     C***********                                                   085787CCB003
079600200529     C***Reset*posted today indicator if zero interest.             085787CCB003
079610200529     C***********CRCP0     IFEQ *ZERO                      - B1     085787CCB003
079620200529     C***********MACI0     ANDEQ*ZERO                               085787CCB003
079630200529     C***********GACI0     ANDEQ*ZERO                               085787CCB003
079640200529     C***********          MOVEA'00000'   *IN,66                    085787CCB003
079650200529     C***********          END                             - E1     085787CCB003
079660200529     C***********          EXSR OVERPR                                    CCB003
079670200529     C***********                                                         CCB003
079680200529     C/COPY WNCPYSRC,RE3664C083
079690200529     C***********          WRITEDETCR                                     CCB003
079700200529     C************         END                             - E1           085787
079710200529     C                     Z-ADD*ZEROS    MACI0
079720200529     C                     Z-ADD*ZEROS    GACI0
079730200529     C                     Z-ADD*ZEROS    CRCP0
079740200529     C***********          Z-ADD*ZEROS    RATECR                          CCB003
079750200529     C***********          MOVE '1'       *IN36                           CCB003
079760200529     C***********          MOVE '1'       *IN43                           CCB003
079770200529     C***********          MOVEA'00000'   *IN,66                          CCB003
079780200529      *                                                                   CCB003
079790200529      ** Write record to Audit file                                       CCB003
079800200529     C                     WRITEREINCXD0                                  CCB003
079810200529     C                     CLEARREINCXD0                                  CCB003
079820200529     C*
079830200529     C                     ENDSR                           **PRCR  ENDSR**
079840200529     C********************************************************************
079850200529     C/EJECT
079860200529     C********************************************************************
079870200529     C**
079880200529     C** PRDR  subroutine for DEBIT   OUTPUT
079890200529     C**
079900200529     C**     Called by       TOTAC
079910200529     C**     Calls           *PSSR
079920200529     C**
079930200529      *****************************************************************   CCB003
079940200529     C           PRDR      BEGSR                           **PRDR  BEGSR**
079950200529     C*
079960200529     C**********           Z-ADDBCNUM     RACNUM           Customer number             CCB003 CSD027
079970200529     C                     MOVE BCNUM     RACNUM           Customer number                    CSD027
079980200529     C                     MOVE BCCY      RACCY            Currency       CCB003
079990200529     C                     Z-ADDBACOD     RAACOD           Account Code   CCB003
080000200529     C                     Z-ADDBACSQ     RAACSQ           Account SequencCCB003
080010200529     C                     MOVE BRCA#     RABRCA           Branch         CCB003
080020200529     C                     Z-ADDAACNO     RAACNO           Retail AC No.  CCB003
080030200529     C                     MOVE 'D'       RAPOST           Posting type   CCB003
080040200529     C***********          Z-ADDLPAR      ZDAYNO                          CCB003
080050200529     C                     Z-ADDLPAR      RACPDA           Capitalisation CCB003
080060200529      *                                                                   CCB003
080070200529     C***********          EXSR ZDATE2                                    CCB003
080080200529     C***********                                                         CCB003
080090200529     C************IN99     IFEQ '1'                        - B3           CCB003
080100200529     C************LOCK     IN   LDA                                       CCB003
080110200529     C***********          Z-ADDLPAR      WDATE                           CCB003
080120200529     C***********          Z-ADD17        DBASE                           CCB003
080130200529     C***********          MOVE 'ZDATE2'  DBFILE           ***************CCB003
080140200529     C***********          MOVELWDATE     DBKEY            **DB ERROR 17**CCB003
080150200529     C***********          OUT  LDA                        ***************CCB003
080160200529     C***********          EXSR *PSSR                                     CCB003
080170200529     C***********          END                             - E1           CCB003
080180200529     C***********                                                         CCB003
080190200529      *                                                                   CCB003
080200200529     C           SDICT     IFEQ *ZEROS                     - B1
080210200529     C           DCST      ANDEQ*ZEROS
080220200529      *                                                                   CCB003
080230200529     C***********DRIB      IFEQ *ZEROS                     - B2
080240200529     C***********          Z-ADDADRIS     RATEDR
080250200529     C***********          ELSE                            - X2
080260200529     C***********          Z-ADDCDIR      RATEDR
080270200529     C***********          END                             - E2
080280200529     C***********          Z-ADDSDRIR     RATEDR                          CCB003
080290200529     C***********          MOVE '0'       *IN35                           CCB003
080300200529      *                                                                   CCB003
080310200529     C                     Z-ADDSDRIR     RAINTR           Interest rate  CCB003
080320200529      *                                                                   CCB003
080330200529     C                     END                             - E1
080340200529      *                                                                   CCB003
080350200529     C                     Z-ADDADICT     RAINTP           Interest type  CCB003
080360200529     C                     Z-ADDDCST      RAINST           Interest subtypCCB003
080370200529     C                     Z-ADDMADI0     RAMADJ           Manual adj.    CCB003
080380200529     C                     Z-ADDGADI0     RAGADT           Generated      CCB003
080390200529     C                     Z-ADDDRCP0     RAAIAP           Accrued        CCB003
080400200529     C*
080410200529     C           SDCI      IFEQ 'Y'                        - B1
080420200529     C           SDCI      OREQ 'I'
080430200529     C***********          MOVE '1'       *IN61                           CCB003
080440200529     C                     MOVE 'Y'       RAPTFL           Posted Today   CCB003
080450200529     C                     END                             - E1
080460200529     C*
080470200529     C           SDCI      IFEQ 'S'                        - B1
080480200529     C***********          MOVE '1'       *IN62                           CCB003
080490200529     C                     MOVE 'S'       RAPTFL           Posted Today   CCB003
080500200529     C                     END                             - E1
080510200529     C*
080520200529     C           SDCI      IFEQ 'L'                        - B1
080530200529     C***********          MOVE '1'       *IN63                           CCB003
080540200529     C                     MOVE 'I'       RAPTFL           Posted Today   CCB003
080550200529     C                     END                             - E1
080560200529     C*
080570200529     C           SDCI      IFEQ 'O'                        - B1
080580200529     C***********          MOVE '1'       *IN64                           CCB003
080590200529     C                     MOVE 'L'       RAPTFL           Posted Today   CCB003
080600200529     C                     END                             - E1
080610200529     C*
080620200529     C           SDCI      IFEQ 'A'                        - B1
080630200529     C***********          MOVE '1'       *IN65                           CCB003
080640200529     C                     MOVE 'A'       RAPTFL           Posted Today   CCB003
080650200529     C                     END                             - E1
080660200529     C*                                                                   075073
080670200529     C* If checks not allowed for against SDCI false on indicator 61      075073
080680200529     C*                                                                   075073
080690200529     C***********SDCI      IFNE 'Y'                                 075073085787
080700200529     C***********SDCI      ORNE 'I'                                 075073085787
080710200529     C***********SDCI      ORNE 'S'                                 075073085787
080720200529     C***********SDCI      ORNE 'L'                                 075073085787
080730200529     C***********SDCI      ORNE 'O'                                 075073085787
080740200529     C***********SDCI      ORNE 'A'                                 075073085787
080750200529     C************IN66     ANDNE'1'                                 085787085787
080760200529     C************IN71     ANDNE'1'                                 085787085787
080770200529     C************IN61     IFEQ *OFF                                085787CCB003
080780200529     C************IN62     ANDEQ*OFF                                085787CCB003
080790200529     C************IN63     ANDEQ*OFF                                085787CCB003
080800200529     C************IN64     ANDEQ*OFF                                085787CCB003
080810200529     C************IN65     ANDEQ*OFF                                085787CCB003
080820200529     C***********          MOVE '1'       *IN61                     075073CCB003
080830200529     C***********          END                                      075073CCB003
080840200529     C*
080850200529     C           RAPTFL    IFEQ *BLANK                                    CCB003
080860200529     C                     MOVE 'Y'       RAPTFL                          CCB003
080870200529     C                     ENDIF                                          CCB003
080880200529      *                                                                   CCB003
080890200529     C           OKEY      IFNE AKEY                       - B1
080900200529     C                     MOVE '0'       *IN43
080910200529     C**********           Z-ADDBCNUM     OCNUM                                               CSD027
080920200529     C                     MOVE BCNUM     OCNUM                                               CSD027
080930200529     C                     MOVE BCCY      OCCY
080940200529     C                     Z-ADDBACOD     OACOD
080950200529     C                     Z-ADDBACSQ     OACSQ
080960200529     C                     MOVE BBRCA     OBRCA
080970200529     C                     END                             - E1
080980200529      *                                                                   085787
080990200529      * Print details even if accrued interest is zero.                   085787
081000200529     C***********DRCP0     IFNE *ZERO                      - B1           085787
081010200529     C***********MADI0     ORNE *ZERO                                     085787
081020200529     C***********GADI0     ORNE *ZERO                                     085787
081030200529     C***********                                                   085787CCB003
081040200529     C***Reset*posted today indicator field if zero capitalisation  085787CCB003
081050200529     C***********DRCP0     IFEQ *ZERO                      - B1     085787CCB003
081060200529     C***********MADI0     ANDEQ*ZERO                               085787CCB003
081070200529     C***********GADI0     ANDEQ*ZERO                               085787CCB003
081080200529     C***********          MOVEA'00000'   *IN,61                    085787CCB003
081090200529     C***********          END                             - E1     085787CCB003
081100200529     C***********                                                         CCB003
081110200529     C***********          EXSR OVERPR                                    CCB003
081120200529     C***********                                                         CCB003
081130200529     C***********          Z-ADD58        DBASE                           CCB003
081140200529     C/COPY WNCPYSRC,RE3664C084
081150200529     C***********          WRITEDETDR                                     CCB003
081160200529     C***********          Z-ADD*ZEROS    DBASE                           CCB003
081170200529     C************         END                             - E1           085787
081180200529     C                     Z-ADD*ZEROS    MADI0
081190200529     C                     Z-ADD*ZEROS    GADI0
081200200529     C                     Z-ADD*ZEROS    DRCP0
081210200529     C***********          Z-ADD*ZEROS    RATEDR                          CCB003
081220200529     C***********          MOVE '1'       *IN35                           CCB003
081230200529     C***********          MOVE '1'       *IN43                           CCB003
081240200529     C***********          MOVEA'00000'   *IN,61                          CCB003
081250200529      *                                                                   CCB003
081260200529      ** Write record to Audit file                                       CCB003
081270200529     C                     WRITEREINCXD0                                  CCB003
081280200529     C                     CLEARREINCXD0                                  CCB003
081290200529     C*
081300200529     C                     ENDSR                           **PRDR  ENDSR**
081310200529     C********************************************************************
081320200529     C/EJECT
081330200529     C********************************************************************
081340200529     C**
081350200529     C** REBSR subroutine for REHISBL  file exception/error handling
081360200529     C**
081370200529     C**     Called by       Input specifications
081380200529     C**     Calls           *PSSR
081390200529     C**
081400200529      *****************************************************************   CCB003
081410200529     C           REBSR     BEGSR                           **REBSR BEGSR**
081420200529     C*
081430200529     C           *LOCK     IN   LDA
081440200529     C***********          MOVE 'HISB '   DBFILE           ***************CCB003
081450200529     C                     MOVEL'HISB'    DBFILE           ***************CCB003
081460200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
081470200529     C                     MOVELSTSREB    DBSTAT           ***************
081480200529     C                     MOVEA'11'      *IN,88
081490200529     C                     OUT  LDA
081500200529     C                     EXSR *PSSR
081510200529     C*
081520200529     C                     ENDSR                           **REBSR ENDSR**
081530200529     C********************************************************************
081540200529     C/EJECT
081550200529     C********************************************************************
081560200529     C**
081570200529     C***RECSR*subroutine*for*REHISBC**file*exception/error*handling      CCB003
081580200529     C** RECSR subroutine for REINTCPD file exception/error handling      CCB003
081590200529     C**
081600200529     C**     Called by       Input specifications
081610200529     C**     Calls           *PSSR
081620200529     C**
081630200529      *****************************************************************   CCB003
081640200529     C           RECSR     BEGSR                           **RECSR BEGSR**
081650200529     C*
081660200529     C           *LOCK     IN   LDA
081670200529     C***********          MOVE 'HISBC'   DBFILE           ***************CCB003
081680200529     C                     MOVEL'REINTCPD'DBFILE           ***************CCB003
081690200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
081700200529     C                     MOVELSTSREC    DBSTAT           ***************
081710200529     C                     MOVEA'11'      *IN,88
081720200529     C                     OUT  LDA
081730200529     C                     EXSR *PSSR
081740200529     C*
081750200529     C                     ENDSR                           **RECSR ENDSR**
081760200529     C********************************************************************
081770200529     C/EJECT
081780200529     C********************************************************************
081790200529     C**
081800200529     C** RELSR subroutine for REHISL   file exception/error handling
081810200529     C**
081820200529     C**     Called by       Input specifications
081830200529     C**     Calls           *PSSR
081840200529     C**
081850200529      *****************************************************************   CCB003
081860200529     C           RELSR     BEGSR                           **RELSR BEGSR**
081870200529     C*
081880200529     C           *LOCK     IN   LDA
081890200529     C***********          MOVE 'HISL '   DBFILE           ***************CCB003
081900200529     C                     MOVEL'HISL'    DBFILE           ***************CCB003
081910200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
081920200529     C                     MOVELSTSREL    DBSTAT           ***************
081930200529     C                     MOVEA'11'      *IN,88
081940200529     C                     OUT  LDA
081950200529     C                     EXSR *PSSR
081960200529     C*
081970200529     C                     ENDSR                           **RELSR ENDSR**
081980200529     C********************************************************************
081990200529     C/EJECT
082000200529     C********************************************************************
082010200529     C**
082020200529     C** REPSR subroutine for REHPOSPP file exception/error handling
082030200529     C**
082040200529     C**     Called by       Input specifications
082050200529     C**     Calls           *PSSR
082060200529     C**
082070200529      *****************************************************************   CCB003
082080200529     C           REPSR     BEGSR                           **REPSR BEGSR**
082090200529     C*
082100200529     C           *LOCK     IN   LDA
082110200529     C***********          MOVE 'POSPL'   DBFILE           ***************CCB003
082120200529     C                     MOVEL'POSPL'   DBFILE           ***************CCB003
082130200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
082140200529     C                     MOVELSTSREP    DBSTAT           ***************
082150200529     C                     MOVEA'11'      *IN,88
082160200529     C                     OUT  LDA
082170200529     C                     EXSR *PSSR
082180200529     C*
082190200529     C                     ENDSR                           **REPSR ENDSR**
082200200529     C********************************************************************
082210200529     C/EJECT
082220200529     C********************************************************************
082230200529     C**
082240200529     C** RESSR subroutine for REHISSL  file exception/error handling
082250200529     C**
082260200529     C**     Called by       Input specifications
082270200529     C**     Calls           *PSSR
082280200529     C**
082290200529      *****************************************************************   CCB003
082300200529     C           RESSR     BEGSR                           **RESSR BEGSR**
082310200529     C*
082320200529     C           *LOCK     IN   LDA
082330200529     C***********          MOVE 'HISSL'   DBFILE           ***************CCB003
082340200529     C                     MOVEL'HISSL'   DBFILE           ***************CCB003
082350200529     C                     MOVE *BLANKS   DBKEY            **STATUS ERR **
082360200529     C                     MOVELSTSRES    DBSTAT           ***************
082370200529     C                     MOVEA'11'      *IN,88
082380200529     C                     OUT  LDA
082390200529     C                     EXSR *PSSR
082400200529     C*
082410200529     C                     ENDSR                           **RESSR ENDSR**
082420200529     C********************************************************************
082430200529     C/EJECT
082440200529     C********************************************************************
082450200529     C**
082460200529     C** SETPR subroutine to execute setup accnt work fields processing
082470200529     C**
082480200529     C**     Called by       MAIN
082490200529     C**     Calls           -
082500200529     C**
082510200529      *****************************************************************   CCB003
082520200529     C           SETPR     BEGSR                           **SETPR BEGSR**
082530200529     C* If Swiss Taxes installed
082540200529     C*
082550200529     C           BGNTST    IFEQ 'Y'
082560200529     C                     EXSR WPT01
082570200529     C                     END
082580200529     C*
082590200529     C/COPY WNCPYSRC,RE3664CP18                                           S01408
082600200529     C*
082610200529     C** ACCESS ACCOUNT CODES
082620200529     C*
082630200529     C**********           MOVE BACOD     KACOD   4                                           CGL029
082640200529     C                     MOVE BACOD     KACOD                                               CGL029
082650200529     C/COPY WNCPYSRC,RE3664C135
082660200529     C*
082670200529     C                     ADD  1         RCSQ                                              CRE083BK
082680200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
082690200529     C                     Z-ADD078       WDBASE                                            CRE083BK
082700200529     C                     EXSR ACDCCH                                                      CRE083BK
082710200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
082720200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
082730200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
082740200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
082750200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
082760200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
082770200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
082780200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
082790200529     C********** *LOCK     IN   LDA                                                         CRE083BK
082800200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
082810200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 59 *CRE002
082820200529     C***********          Z-ADD059       DBASE            ***************CRE002
082830200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 078*           CRE002 CRE083BK
082840200529     C**********           Z-ADD078       DBASE            ***************           CRE002 CRE083BK
082850200529     C**********           OUT  LDA                                                         CRE083BK
082860200529     C***********          WRITEERRP1                                     CCB003
082870200529     C**********           EXSR *PSSR                                                       CRE083BK
082880200529     C**********           END                                                              CRE083BK
082890200529     C*
082900200529     C                     MOVE A5CIAC    CIAC
082910200529     C                     MOVE A5CIAD    CIAD
082920200529     C                     MOVE A5DIAC    DIAC
082930200529     C                     MOVE A5DIAD    DIAD
082940200529     C                     MOVE A5ICIC    CAPC
082950200529     C                     MOVE A5ICID    CAPD
082960200529     C/COPY WNCPYSRC,RE3664C082
082970200529      *                                                                                       CDL013
082980200529      ** If CDL013 installed, use appropriate account code                                    CDL013
082990200529     C           CDL013    IFEQ '1'                                                           CDL013
083000200529      *                                                                                       CDL013
083010200529     C                     MOVE BACOD     WBACOD 10                                           CDL013
083020200529      *                                                                                       CDL013
083030200529      ** CHAIN to SDACOAL0 to retrieve WHT Account Codes                                      CDL013
083040200529     C           WBACOD    CHAINSDACOAL0             40                                       CDL013
083050200529      *                                                                                       CDL013
083060200529      ** If CHAIN failed, terminate the program                                               CDL013
083070200529     C           *IN40     IFEQ '1'                                                           CDL013
083080200529     C           *LOCK     IN   LDA                                                           CDL013
083090200529     C                     MOVEL'SDACOAL0'DBFILE           ************                       CDL013
083100200529     C                     MOVELWBACOD    DBKEY            * DBERR 142*                       CDL013
083110200529     C                     Z-ADD142       DBASE            ************                       CDL013
083120200529     C                     OUT  LDA                                                           CDL013
083130200529     C                     EXSR *PSSR                                                         CDL013
083140200529     C                     ENDIF                                                              CDL013
083150200529      *                                                                                       CDL013
083160200529      ** Retrieve WHT Account Codes                                                           CDL013
083170200529     C                     MOVE EACRE     WRETAC 100                                          CDL013
083180200529     C                     MOVE EACCO     WCOTAC 100                                          CDL013
083190200529      *                                                                                       CDL013
083200200529     C                     ENDIF                                                              CDL013
083210200529      *                                                                                       CDL013
083220200529     C*
083230200529     C** ACCESS ACCOUNT CODES
083240200529     C*
083250200529     C**********           MOVE CAPD      KACOD   4                                           CGL029
083260200529     C                     MOVE CAPD      KACOD                                               CGL029
083270200529     C*
083280200529     C                     ADD  1         RCSQ                                              CRE083BK
083290200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
083300200529     C                     Z-ADD079       WDBASE                                            CRE083BK
083310200529     C                     EXSR ACDCCH                                                      CRE083BK
083320200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
083330200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
083340200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
083350200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
083360200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
083370200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
083380200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
083390200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
083400200529     C********** *LOCK     IN   LDA                                                         CRE083BK
083410200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
083420200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 60 *CRE002
083430200529     C***********          Z-ADD060       DBASE            ***************CRE002
083440200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 079*           CRE002 CRE083BK
083450200529     C**********           Z-ADD079       DBASE            ***************           CRE002 CRE083BK
083460200529     C**********           OUT  LDA                                                         CRE083BK
083470200529     C***********          WRITEERRP1                                     CCB003
083480200529     C**********           EXSR *PSSR                                                       CRE083BK
083490200529     C**********           END                                                              CRE083BK
083500200529     C*
083510200529     C                     MOVE A5ACTY    WCAPDT
083520200529     C*
083530200529     C           CAPD      IFNE CAPC                       - B1
083540200529     C*
083550200529     C** ACCESS ACCOUNT CODES
083560200529     C*
083570200529     C**********           MOVE CAPC      KACOD   4                                           CGL029
083580200529     C                     MOVE CAPC      KACOD                                               CGL029
083590200529     C*
083600200529     C                     ADD  1         RCSQ                                              CRE083BK
083610200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
083620200529     C                     Z-ADD080       WDBASE                                            CRE083BK
083630200529     C                     EXSR ACDCCH                                                      CRE083BK
083640200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
083650200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
083660200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
083670200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
083680200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
083690200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
083700200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
083710200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
083720200529     C********** *LOCK     IN   LDA                                                         CRE083BK
083730200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
083740200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 61 *CRE002
083750200529     C***********          Z-ADD061       DBASE            ***************CRE002
083760200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 080*           CRE002 CRE083BK
083770200529     C**********           Z-ADD080       DBASE            ***************           CRE002 CRE083BK
083780200529     C**********           OUT  LDA                                                         CRE083BK
083790200529     C***********          WRITEERRP1                                     CCB003
083800200529     C**********           EXSR *PSSR                                                       CRE083BK
083810200529     C**********           END                                                              CRE083BK
083820200529     C*
083830200529     C                     END                             - E1
083840200529     C*
083850200529     C                     MOVE A5ACTY    WCAPCT
083860200529     C*
083870200529     C** ACCESS ACCOUNT CODES
083880200529     C*
083890200529     C**********           MOVE DIAC      KACOD   4                                           CGL029
083900200529     C                     MOVE DIAC      KACOD                                               CGL029
083910200529     C*
083920200529     C                     ADD  1         RCSQ                                              CRE083BK
083930200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
083940200529     C                     Z-ADD081       WDBASE                                            CRE083BK
083950200529     C                     EXSR ACDCCH                                                      CRE083BK
083960200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
083970200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
083980200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
083990200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
084000200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
084010200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
084020200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
084030200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
084040200529     C********** *LOCK     IN   LDA                                                         CRE083BK
084050200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
084060200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 19 *CRE002
084070200529     C***********          Z-ADD019       DBASE            ***************CRE002
084080200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 081*           CRE002 CRE083BK
084090200529     C**********           Z-ADD081       DBASE            ***************           CRE002 CRE083BK
084100200529     C**********           OUT  LDA                                                         CRE083BK
084110200529     C***********          WRITEERRP1                                     CCB003
084120200529     C**********           EXSR *PSSR                                                       CRE083BK
084130200529     C**********           END                                                              CRE083BK
084140200529     C*
084150200529     C                     MOVE A5ACTY    WDIACT
084160200529     C*
084170200529     C** ACCESS ACCOUNT CODES
084180200529     C*
084190200529     C**********           MOVE DIAD      KACOD   4                                           CGL029
084200200529     C                     MOVE DIAD      KACOD                                               CGL029
084210200529     C*
084220200529     C                     ADD  1         RCSQ                                              CRE083BK
084230200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
084240200529     C                     Z-ADD082       WDBASE                                            CRE083BK
084250200529     C                     EXSR ACDCCH                                                      CRE083BK
084260200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
084270200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
084280200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
084290200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
084300200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
084310200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
084320200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
084330200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
084340200529     C********** *LOCK     IN   LDA                                                         CRE083BK
084350200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
084360200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 20 *CRE002
084370200529     C***********          Z-ADD020       DBASE            ***************CRE002
084380200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 082*           CRE002 CRE083BK
084390200529     C**********           Z-ADD082       DBASE            ***************           CRE002 CRE083BK
084400200529     C**********           OUT  LDA                                                         CRE083BK
084410200529     C***********          WRITEERRP1                                     CCB003
084420200529     C**********           EXSR *PSSR                                                       CRE083BK
084430200529     C**********           END                                                              CRE083BK
084440200529     C*
084450200529     C                     MOVE A5ACTY    WDIADT
084460200529     C*
084470200529     C*
084480200529     C** ACCESS ACCOUNT CODES
084490200529     C*
084500200529     C**********           MOVE CIAD      KACOD   4                                           CGL029
084510200529     C                     MOVE CIAD      KACOD                                               CGL029
084520200529     C*
084530200529     C                     ADD  1         RCSQ                                              CRE083BK
084540200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
084550200529     C                     Z-ADD083       WDBASE                                            CRE083BK
084560200529     C                     EXSR ACDCCH                                                      CRE083BK
084570200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
084580200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
084590200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
084600200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
084610200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
084620200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
084630200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
084640200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
084650200529     C********** *LOCK     IN   LDA                                                         CRE083BK
084660200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
084670200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 18 *CRE002
084680200529     C***********          Z-ADD018       DBASE            ***************CRE002
084690200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 083*           CRE002 CRE083BK
084700200529     C**********           Z-ADD083       DBASE            ***************           CRE002 CRE083BK
084710200529     C**********           OUT  LDA                                                         CRE083BK
084720200529     C***********          WRITEERRP1                                     CCB003
084730200529     C**********           EXSR *PSSR                                                       CRE083BK
084740200529     C**********           END                                                              CRE083BK
084750200529     C*
084760200529     C                     MOVE A5ACTY    WCIADT
084770200529     C*
084780200529     C** ACCESS ACCOUNT CODES
084790200529     C*
084800200529     C**********           MOVE CIAC      KACOD   4                                           CGL029
084810200529     C                     MOVE CIAC      KACOD                                               CGL029
084820200529     C*
084830200529     C                     ADD  1         RCSQ                                              CRE083BK
084840200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
084850200529     C                     Z-ADD084       WDBASE                                            CRE083BK
084860200529     C                     EXSR ACDCCH                                                      CRE083BK
084870200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
084880200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
084890200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
084900200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
084910200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
084920200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
084930200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
084940200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
084950200529     C********** *LOCK     IN   LDA                                                         CRE083BK
084960200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
084970200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 21 *CRE002
084980200529     C***********          Z-ADD021       DBASE            ***************CRE002
084990200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 084*           CRE002 CRE083BK
085000200529     C**********           Z-ADD084       DBASE            ***************           CRE002 CRE083BK
085010200529     C**********           OUT  LDA                                                         CRE083BK
085020200529     C***********          WRITEERRP1                                     CCB003
085030200529     C**********           EXSR *PSSR                                                       CRE083BK
085040200529     C**********           END                                                              CRE083BK
085050200529     C*
085060200529     C                     MOVE A5ACTY    WCIACT
085070200529     C/COPY WNCPYSRC,RE3664C228
085080200529     C*
085090200529     C** ACCESS ACCOUNT CODES
085100200529     C*
085110200529     C**********           MOVE WOTACC    KACOD   4                                           CGL029
085120200529      ** For Base Currency, the Equivalent account Code can be Blank                          228966
085130200529      *                                                                                       228966
085140200529     C           WOTACC    IFNE *BLANKS                                                       228966
085150200529     C                     MOVE WOTACC    KACOD                                               CGL029
085160200529     C*
085170200529     C           WOTACC    IFNE *BLANKS                                                       246184
085180200529      *                                                                                       246184
085190200529     C                     ADD  1         RCSQ                                              CRE083BK
085200200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
085210200529     C                     Z-ADD086       WDBASE                                            CRE083BK
085220200529     C                     EXSR ACDCCH                                                      CRE083BK
085230200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
085240200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
085250200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
085260200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
085270200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
085280200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRCGL029
085290200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRCGL029
085300200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
085310200529     C********** *LOCK     IN   LDA                                                         CRE083BK
085320200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
085330200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 22 *CRE002
085340200529     C***********          Z-ADD022       DBASE            ***************CRE002
085350200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 086*           CRE002 CRE083BK
085360200529     C**********           Z-ADD086       DBASE            ***************           CRE002 CRE083BK
085370200529     C**********           OUT  LDA                                                         CRE083BK
085380200529     C***********          WRITEERRP1                                     CCB003
085390200529     C**********           EXSR *PSSR                                                       CRE083BK
085400200529     C**********           END                                                              CRE083BK
085410200529      *                                                                                       246184
085420200529     C                     ENDIF                                                              246184
085430200529     C*
085440200529     C                     MOVE A5ACTY    WOTACT
085450200529     C                     END                                                                228966
085460200529     C*
085470200529     C** ACCESS ACCRACJ FILE
085480200529     C*
085490200529     C***********          Z-ADD62        DBASE                           CRE002
085500200529     C                     Z-ADD087       DBASE            * DB ERROR 087*CRE002
085510200529     C********** ACKEY     CHAINACCRACJ              99                                       CGL029
085520200529     C           ACKEY2    CHAINACCRACJ              99                                       CGL029
085530200529     C*
085540200529     C** ERROR IN ACCRACJ
085550200529     C*
085560200529     C           *IN99     IFEQ '1'                        ***************
085570200529     C           *LOCK     IN   LDA
085580200529     C***********          MOVE 'ACCRA'   DBFILE           **DB ERROR 62**CCB003
085590200529     C                     MOVEL'ACCRA'   DBFILE           **DB ERROR 62**CCB003
085600200529     C                     MOVELAKEY      DBKEY            ***************
085610200529     C                     OUT  LDA
085620200529     C                     EXSR *PSSR
085630200529     C                     END                             - E1
085640200529     C/COPY WNCPYSRC,REH00165
085650200529     C*                                                                   092564
085660200529     C* Daily capitalisation has resulted in errors in ACCNTAB with       092564
085670200529     C* NDID and NCID in the past. This fix ensures the dates catch up.   092564
085680200529     C*                                                                   092564
085690200529     C           DRIF      IFEQ 'D'                                       092564
085700200529     C           NDID      IFLT RUND                                      092564
085710200529     C                     Z-ADDRUND      NDID                            092564
085720200529     C                     END                                            092564
085730200529     C                     END                                            092564
085740200529     C           CRIF      IFEQ 'D'                                       092564
085750200529     C           NCID      IFLT RUND                                      092564
085760200529     C                     Z-ADDRUND      NCID                            092564
085770200529     C                     END                                            092564
085780200529     C                     END                                            092564
085790200529     C*
085800200529     C** CALCULATE CNDID AND CNCID
085810200529     C*
085820200529     C                     Z-ADDNDID      CNDID
085830200529     C                     Z-ADDNCID      CNCID
085840200529     C           BDICI     IFEQ 'D'
085850200529     C           BDICI     OREQ 'C'
085860200529     C           BDICI     OREQ 'M'
085870200529     C                     Z-ADDRUND      CNDID
085880200529     C                     END
085890200529     C           BCICI     IFEQ 'D'
085900200529     C           BCICI     OREQ 'C'
085910200529     C           BCICI     OREQ 'M'
085920200529     C                     Z-ADDRUND      CNCID
085930200529     C                     END
085940200529     C/COPY WNCPYSRC,RE3664C219
085950200529     C           LDAC      IFNE 'Y'
085960200529     C           BDICI     IFNE 'C'                                       106604
085970200529     C                     ADD  1         CNDID
085980200529     C                     END                                            106604
085990200529     C           BCICI     IFNE 'C'                                       106604
086000200529     C                     ADD  1         CNCID
086010200529     C                     END                                            106604
086020200529     C                     END
086030200529     C*
086040200529     C* SETUP TRANSACTION TYPE FOR CLOSURE
086050200529     C*
086060200529     C                     Z-ADD91060     TRAT
086070200529     C                     MOVEL'91060'   OTTP
086080200529     C           BDICI     IFEQ 'C'
086090200529     C           BCICI     OREQ 'C'
086100200529     C                     Z-ADD91040     TRAT
086110200529     C                     MOVEL'91040'   OTTP
086120200529     C                     END
086130200529     C*
086140200529     C** ACCESS BRANCH CODES
086150200529     C*
086160200529     C                     Z-ADDCUBRCA    C                                                 CRE083BK
086170200529     C           BBRCA     LOKUPABRC,C                   16                                 CRE083BK
086180200529      *                                                                                     CRE083BK
086190200529     C           *IN16     IFEQ '1'                                                         CRE083BK
086200200529     C           C         OCUR SDBRCH                                                      CRE083BK
086210200529     C                     ELSE                                                             CRE083BK
086220200529     C**********           CALL 'AOBRCHR0'                                                    CGL029
086230200529     C           1         OCUR SDBRCH                                                      MD021155
086240200529     C                     CALL 'AOBRCHR1'                                                    CGL029
086250200529     C                     PARM '*MSG   ' @RTCD
086260200529     C                     PARM '*KEY   ' @OPTN
086270200529     C                     PARM BBRCA     @BRCA   3
086280200529     C********** SDBRCH    PARM SDBRCH    DSFDY                                               CGL029
086290200529     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
086300200529     C           @RTCD     IFNE *BLANK
086310200529     C           *LOCK     IN   LDA
086320200529     C                     MOVEL'SDBRCHPD'DBFILE           ***************
086330200529     C***********          MOVEL@BRCA     DBKEY            * DB ERROR 22 *CRE002
086340200529     C***********          Z-ADD22        DBASE            ***************CRE002
086350200529     C                     MOVEL@BRCA     DBKEY            * DB ERROR 088*CRE002
086360200529     C                     Z-ADD088       DBASE            ***************CRE002
086370200529     C                     OUT  LDA
086380200529     C***********          WRITEERRP1                                     CCB003
086390200529     C                     EXSR *PSSR
086400200529     C                     END
086410200529     C                     ENDIF                                                            CRE083BK
086420200529     C*
086430200529     C** SAVE BRANCH INTERNAL CUSTOMER OF THE ORIGINAL ACCOUNT
086440200529     C*
086450200529     C                     MOVE BICN      BBICN
086460200529     C/COPY WNCPYSRC,RE3664C114
086470200529     C                     Z-ADD1         ACSQ
086480200529     C/COPY WNCPYSRC,RE3664C115
086490200529     C                     MOVE NBACB     BNBACB
086500200529     C                     MOVE A8DFAC    BNDFAC
086510200529     C*
086520200529     C           MBIN      IFEQ 'Y'
086530200529     C*
086540200529     C**********           MOVE BNBACB    KACOD   4                                           CGL029
086550200529     C                     MOVE BNBACB    KACOD                                               CGL029
086560200529     C*
086570200529     C                     ADD  1         RCSQ                                              CRE083BK
086580200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
086590200529     C                     Z-ADD089       WDBASE                                            CRE083BK
086600200529     C                     EXSR ACDCCH                                                      CRE083BK
086610200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
086620200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
086630200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
086640200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
086650200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
086660200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
086670200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
086680200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
086690200529     C********** *LOCK     IN   LDA                                                         CRE083BK
086700200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
086710200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 23 *CRE002
086720200529     C***********          Z-ADD023       DBASE            ***************CRE002
086730200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 089*           CRE002 CRE083BK
086740200529     C**********           Z-ADD089       DBASE            ***************           CRE002 CRE083BK
086750200529     C**********           OUT  LDA                                                         CRE083BK
086760200529     C***********          WRITEERRP1                                     CCB003
086770200529     C**********           EXSR *PSSR                                                       CRE083BK
086780200529     C**********           END                                                              CRE083BK
086790200529     C*
086800200529     C                     MOVE A5ACTY    BNBACT
086810200529     C*
086820200529     C**********           MOVE BNDFAC    KACOD   4                                           CGL029
086830200529     C                     MOVE BNDFAC    KACOD                                               CGL029
086840200529     C*
086850200529     C                     ADD  1         RCSQ                                              CRE083BK
086860200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
086870200529     C                     Z-ADD090       WDBASE                                            CRE083BK
086880200529     C                     EXSR ACDCCH                                                      CRE083BK
086890200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
086900200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
086910200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
086920200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
086930200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
086940200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
086950200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
086960200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
086970200529     C********** *LOCK     IN   LDA                                                         CRE083BK
086980200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
086990200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 23 *CRE002
087000200529     C***********          Z-ADD023       DBASE            ***************CRE002
087010200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 090*           CRE002 CRE083BK
087020200529     C**********           Z-ADD090       DBASE            ***************           CRE002 CRE083BK
087030200529     C**********           OUT  LDA                                                         CRE083BK
087040200529     C***********          WRITEERRP1                                     CCB003
087050200529     C**********           EXSR *PSSR                                                       CRE083BK
087060200529     C**********           END                                                              CRE083BK
087070200529     C*
087080200529     C                     MOVE A5ACTY    BNDFAT
087090200529     C*
087100200529     C                     END
087110200529     C*
087120200529     C** SET NARRATIVE FOR MULTILANGUAGE FOLLOWING LGID
087130200529     C*
087140200529     C                     MOVE XCUNT     LGID
087150200529     C*
087160200529     C** ACCESS ADJUSTEMENT INTEREST NARRATIVE
087170200529     C*
087180200529     C                     MOVE 'R1'      LNARC
087190200529     C*
087200200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
087210200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
087220200529      *                                                                                     CRE083BK
087230200529     C           *IN18     IFEQ '1'                                                         CRE083BK
087240200529     C           B         OCUR SDNARR                                                      CRE083BK
087250200529     C                     MOVELNARD      NAR,1                                             MD020956
087260200529     C                     ELSE                                                             CRE083BK
087270200529      *                                                                                     MD021155
087280200529     C           1         OCUR SDNARR                                                      MD021155
087290200529     C                     CALL 'AONARRR0'
087300200529     C                     PARM *BLANKS   @RTCD
087310200529     C                     PARM '*KEY   ' @OPTN
087320200529     C                     PARM LNARC     @NVCD   2
087330200529     C           SDNARR    PARM SDNARR    DSFDY
087340200529     C           @RTCD     IFNE *BLANK
087350200529     C                     MOVELNR16,1    NAR,1
087360200529     C                     ELSE
087370200529     C                     MOVELNARD      NAR,1
087380200529     C                     END
087390200529     C                     ENDIF                                                            CRE083BK
087400200529     C*                                                                   135401
087410200529     C                     MOVE 'RB'      LNARC                           135401
087420200529     C*                                                                   135401
087430200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
087440200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
087450200529      *                                                                                     CRE083BK
087460200529     C           *IN18     IFEQ '1'                                                         CRE083BK
087470200529     C           B         OCUR SDNARR                                                      CRE083BK
087480200529     C                     MOVELNARD      NAR,12                                            MD020956
087490200529     C                     ELSE                                                             CRE083BK
087500200529      *                                                                                     MD021155
087510200529     C           1         OCUR SDNARR                                                      MD021155
087520200529     C                     CALL 'AONARRR0'                                135401
087530200529     C                     PARM *BLANKS   @RTCD                           135401
087540200529     C                     PARM '*KEY   ' @OPTN                           135401
087550200529     C                     PARM LNARC     @NVCD   2                       135401
087560200529     C           SDNARR    PARM SDNARR    DSFDY                           135401
087570200529     C           @RTCD     IFNE *BLANK                                    135401
087580200529     C**********           MOVELNR16,W    NAR,12                                       135401 235328
087590200529     C                     MOVELNR16,12   NAR,12                                              235328
087600200529     C                     ELSE                                           135401
087610200529     C                     MOVELNARD      NAR,12                          135401
087620200529     C                     END                                            135401
087630200529     C                     ENDIF                                                            CRE083BK
087640200529     C*
087650200529     C** ACCESS INTEREST NARRATIVE
087660200529     C*
087670200529     C                     MOVE 'R2'      LNARC
087680200529     C*
087690200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
087700200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
087710200529      *                                                                                     CRE083BK
087720200529     C           *IN18     IFEQ '1'                                                         CRE083BK
087730200529     C           B         OCUR SDNARR                                                      CRE083BK
087740200529     C                     MOVELNARD      NAR,2                                             MD020956
087750200529     C                     ELSE                                                             CRE083BK
087760200529      *                                                                                     MD021155
087770200529     C           1         OCUR SDNARR                                                      MD021155
087780200529     C                     CALL 'AONARRR0'
087790200529     C                     PARM *BLANKS   @RTCD
087800200529     C                     PARM '*KEY   ' @OPTN
087810200529     C                     PARM LNARC     @NVCD   2
087820200529     C           SDNARR    PARM SDNARR    DSFDY
087830200529     C           @RTCD     IFNE *BLANK
087840200529     C**********           MOVELNR16,2    NAR,2                           183947
087850200529     C                     MOVE *BLANKS   NAR,2                           183947
087860200529     C                     MOVEL'INT.CAP.'NAR,2                           183947
087870200529     C                     ELSE
087880200529     C                     MOVELNARD      NAR,2
087890200529     C                     END
087900200529     C                     ENDIF                                                            CRE083BK
087910200529     C*
087920200529     C** ACCESS CHARGES NARRATIVE
087930200529     C*
087940200529     C                     MOVE 'R3'      LNARC
087950200529     C*
087960200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
087970200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
087980200529      *                                                                                     CRE083BK
087990200529     C           *IN18     IFEQ '1'                                                         CRE083BK
088000200529     C           B         OCUR SDNARR                                                      CRE083BK
088010200529     C                     MOVELNARD      NAR,3                                             MD020956
088020200529     C                     ELSE                                                             CRE083BK
088030200529      *                                                                                     MD021155
088040200529     C           1         OCUR SDNARR                                                      MD021155
088050200529     C                     CALL 'AONARRR0'
088060200529     C                     PARM *BLANKS   @RTCD
088070200529     C                     PARM '*KEY   ' @OPTN
088080200529     C                     PARM LNARC     @NVCD   2
088090200529     C           SDNARR    PARM SDNARR    DSFDY
088100200529     C           @RTCD     IFNE *BLANK
088110200529     C                     MOVELNR16,3    NAR,3
088120200529     C                     ELSE
088130200529     C                     MOVELNARD      NAR,3
088140200529     C                     END
088150200529     C                     ENDIF                                                            CRE083BK
088160200529     C*                                                                   057048
088170200529     C** ACCESS CLOSURE INTEREST NARRATIVE                                057048
088180200529     C*                                                                   057048
088190200529     C**********           MOVE 'R5'      LNARC                     057048189038
088200200529     C                     MOVE 'R2'      LNARC                           189038
088210200529     C*                                                                   057048
088220200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
088230200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
088240200529      *                                                                                     CRE083BK
088250200529     C           *IN18     IFEQ '1'                                                         CRE083BK
088260200529     C           B         OCUR SDNARR                                                      CRE083BK
088270200529     C                     Z-ADD11        #                                                 MD022635
088280200529     C                     MOVELNARD      NAR,#                                             MD020956
088290200529     C                     ELSE                                                             CRE083BK
088300200529      *                                                                                     MD021155
088310200529     C           1         OCUR SDNARR                                                      MD021155
088320200529     C                     CALL 'AONARRR0'                                057048
088330200529     C                     PARM *BLANKS   @RTCD                           057048
088340200529     C                     PARM '*KEY   ' @OPTN                           057048
088350200529     C                     PARM LNARC     @NVCD   2                       057048
088360200529     C           SDNARR    PARM SDNARR    DSFDY                           057048
088370200529     C                     Z-ADD11        #                               057048
088380200529     C           @RTCD     IFNE *BLANK                                    057048
088390200529     C                     MOVE '       ' NR16,#                          183947
088400200529     C                     MOVELNR16,#    NAR,#                           057048
088410200529     C                     MOVE '. -     'NR16,#                          183947
088420200529     C                     ELSE                                           057048
088430200529     C                     MOVELNARD      NAR,#                           057048
088440200529     C                     END                                            057048
088450200529     C                     ENDIF                                                            CRE083BK
088460200529     C*
088470200529     C*
088480200529     C** ACCESS TAXES NARRATIVE
088490200529     C*
088500200529     C*                                                                   S01408
088510200529     C/COPY WNCPYSRC,RE3664CP31                                           S01408
088520200529     C*                                                                   S01408
088530200529     C           TXWTRR    IFNE 0                          - B0
088540200529     C           CDL013    ANDNE'1'                                                           CDL013
088550200529      *                                                                                       CDL013
088560200529      ** If CDL013 installed, perform Tiered WHT Instructions.                                CDL013
088570200529      *                                                                                       CDL013
088580200529     C           CDL013    OREQ '1'                                                           CDL013
088590200529     C*                                                                   S01408
088600200529     C/COPY WNCPYSRC,RE3664CP32                                           S01408
088610200529     C*                                                                   S01408
088620200529     C                     MOVE 'T1'      LNARC
088630200529     C*
088640200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
088650200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
088660200529      *                                                                                     CRE083BK
088670200529     C           *IN18     IFEQ '1'                                                         CRE083BK
088680200529     C           B         OCUR SDNARR                                                      CRE083BK
088690200529     C                     MOVELNARD      NAR,5                                             MD020956
088700200529     C                     ELSE                                                             CRE083BK
088710200529      *                                                                                     MD021155
088720200529     C           1         OCUR SDNARR                                                      MD021155
088730200529     C                     CALL 'AONARRR0'
088740200529     C                     PARM *BLANKS   @RTCD
088750200529     C                     PARM '*KEY   ' @OPTN
088760200529     C                     PARM LNARC     @NVCD   2
088770200529     C           SDNARR    PARM SDNARR    DSFDY
088780200529     C           @RTCD     IFNE *BLANK
088790200529     C                     MOVELNR16,5    NAR,5
088800200529     C                     ELSE
088810200529     C                     MOVELNARD      NAR,5
088820200529     C                     END
088830200529     C                     ENDIF                                                            CRE083BK
088840200529     C*
088850200529     C                     END                             - E0
088860200529     C*
088870200529     C           BGNTST    IFEQ 'Y'                        - B0
088880200529     C                     MOVE 'T2'      LNARC
088890200529     C*
088900200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
088910200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
088920200529      *                                                                                     CRE083BK
088930200529     C           *IN18     IFEQ '1'                                                         CRE083BK
088940200529     C           B         OCUR SDNARR                                                      CRE083BK
088950200529     C                     MOVELNARD      NAR,6                                             MD020956
088960200529     C                     ELSE                                                             CRE083BK
088970200529      *                                                                                     MD021155
088980200529     C           1         OCUR SDNARR                                                      MD021155
088990200529     C                     CALL 'AONARRR0'
089000200529     C                     PARM *BLANKS   @RTCD
089010200529     C                     PARM '*KEY   ' @OPTN
089020200529     C                     PARM LNARC     @NVCD   2
089030200529     C           SDNARR    PARM SDNARR    DSFDY
089040200529     C           @RTCD     IFNE *BLANK
089050200529     C                     MOVELNR16,6    NAR,6
089060200529     C                     ELSE
089070200529     C                     MOVELNARD      NAR,6
089080200529     C                     END
089090200529     C                     ENDIF                                                            CRE083BK
089100200529     C*
089110200529     C                     MOVE 'T3'      LNARC
089120200529     C*
089130200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
089140200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
089150200529      *                                                                                     CRE083BK
089160200529     C           *IN18     IFEQ '1'                                                         CRE083BK
089170200529     C           B         OCUR SDNARR                                                      CRE083BK
089180200529     C                     MOVELNARD      NAR,7                                             MD020956
089190200529     C                     ELSE                                                             CRE083BK
089200200529      *                                                                                     MD021155
089210200529     C           1         OCUR SDNARR                                                      MD021155
089220200529     C                     CALL 'AONARRR0'
089230200529     C                     PARM *BLANKS   @RTCD
089240200529     C                     PARM '*KEY   ' @OPTN
089250200529     C                     PARM LNARC     @NVCD   2
089260200529     C           SDNARR    PARM SDNARR    DSFDY
089270200529     C           @RTCD     IFNE *BLANK
089280200529     C                     MOVELNR16,7    NAR,7
089290200529     C                     ELSE
089300200529     C                     MOVELNARD      NAR,7
089310200529     C                     END
089320200529     C                     ENDIF                                                            CRE083BK
089330200529      *                                                                   S01522
089340200529      **  Set up Narrative message: rightmost byte blank                  S01522
089350200529     C                     MOVEL'GB0026'  MGD,7     P                     S01522
089360200529     C*
089370200529     C                     MOVE 'T4'      LNARC
089380200529     C*
089390200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
089400200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
089410200529      *                                                                                     CRE083BK
089420200529     C           *IN18     IFEQ '1'                                                         CRE083BK
089430200529     C           B         OCUR SDNARR                                                      CRE083BK
089440200529     C                     MOVELNARD      NAR,8                                             MD020956
089450200529     C                     ELSE                                                             CRE083BK
089460200529      *                                                                                     MD021155
089470200529     C           1         OCUR SDNARR                                                      MD021155
089480200529     C                     CALL 'AONARRR0'
089490200529     C                     PARM *BLANKS   @RTCD
089500200529     C                     PARM '*KEY   ' @OPTN
089510200529     C                     PARM LNARC     @NVCD   2
089520200529     C           SDNARR    PARM SDNARR    DSFDY
089530200529     C           @RTCD     IFNE *BLANK
089540200529     C                     MOVELNR16,8    NAR,8
089550200529     C                     ELSE
089560200529     C                     MOVELNARD      NAR,8
089570200529     C                     END
089580200529     C                     ENDIF                                                            CRE083BK
089590200529      *                                                                   S01522
089600200529      **  Set up Narrative message: rightmost byte blank                  S01522
089610200529     C                     MOVEL'GB0027'  MGD,8     P                     S01522
089620200529     C*
089630200529     C                     MOVE 'T5'      LNARC
089640200529     C*
089650200529     C                     Z-ADDCUNARA    B                                                 CRE083BK
089660200529     C           LNARC     LOKUPANAR,B                   18                                 CRE083BK
089670200529      *                                                                                     CRE083BK
089680200529     C           *IN18     IFEQ '1'                                                         CRE083BK
089690200529     C           B         OCUR SDNARR                                                      CRE083BK
089700200529     C                     MOVELNARD      NAR,9                                             MD020956
089710200529     C                     ELSE                                                             CRE083BK
089720200529      *                                                                                     MD021155
089730200529     C           1         OCUR SDNARR                                                      MD021155
089740200529     C                     CALL 'AONARRR0'
089750200529     C                     PARM *BLANKS   @RTCD
089760200529     C                     PARM '*KEY   ' @OPTN
089770200529     C                     PARM LNARC     @NVCD   2
089780200529     C           SDNARR    PARM SDNARR    DSFDY
089790200529     C           @RTCD     IFNE *BLANK
089800200529     C                     MOVELNR16,9    NAR,9
089810200529     C                     ELSE
089820200529     C                     MOVELNARD      NAR,9
089830200529     C                     END
089840200529     C                     ENDIF                                                            CRE083BK
089850200529      *                                                                   S01522
089860200529      **  Set up Narrative message: rightmost byte blank                  S01522
089870200529     C                     MOVEL'GB0028'  MGD,9     P                     S01522
089880200529     C/COPY WNCPYSRC,REH00433
089890200529     C*
089900200529     C                     END                             - E0
089910200529     C                     ENDSR                           **SETPR ENDSR**
089920200529     C********************************************************************
089930200529     C/EJECT
089940200529     C********************************************************************
089950200529     C**
089960200529     C** SSETUP subroutine to execute setup capitalisation record processing
089970200529     C**
089980200529     C**     Called by       CREPR,DEBPR
089990200529     C**     Calls           -
090000200529     C**
090010200529      *****************************************************************   CCB003
090020200529     C           SSETUP    BEGSR                           **SSETUP BEGSR**
090030200529     C*
090040200529     C** CHECK ON DEBIT/CREDIT INDICATOR
090050200529     C*
090060200529     C           WDRCR     IFEQ '0'                        - B1
090070200529     C/COPY WNCPYSRC,RE3664C171
090080200529     C*
090090200529     C           SDCI      IFEQ 'S'                        - B2
090100200529     C           SDCI      OREQ 'L'                        - B2
090110200529     C           SDCI      OREQ 'O'                        - B2
090120200529     C           DAIC      ADD  DRIS      DRIS
090130200529     C                     ADD  PMADI     DRIS
090140200529     C                     SUB  SMADI     DRIS
090150200529     C                     ELSE                            - X2
090160200529     C           DAIC      ADD  DRIP      DRIP
090170200529     C                     ADD  PMADI     DRIP
090180200529     C                     SUB  SMADI     DRIP
090190200529     C                     END                             - E2
090200200529     C*
090210200529     C           SHISD     IFEQ CNDID                      - B2
090220200529     C                     Z-ADDREGLIS    TEGLIS
090230200529     C                     END                             - E2
090240200529     C*
090250200529     C                     Z-ADDSMADI     PMADI
090260200529     C                     Z-ADD*ZEROS    SGADI
090270200529     C                     Z-ADD*ZEROS    DAIC
090280200529     C/COPY WNCPYSRC,RE3664C095
090290200529     C                     END                             - E1
090300200529     C*
090310200529     C           WDRCR     IFEQ '1'                        - B1
090320200529     C/COPY WNCPYSRC,RE3664C172
090330200529     C*
090340200529     C           SCCI      IFEQ 'S'                        - B2
090350200529     C           SCCI      OREQ 'L'                        - B2
090360200529     C           SCCI      OREQ 'O'                        - B2
090370200529     C           CAIC      ADD  CRIS      CRIS
090380200529     C                     ADD  PMACI     CRIS
090390200529     C                     SUB  SMACI     CRIS
090400200529     C                     ELSE                            - X2
090410200529     C           CAIC      ADD  CRIP      CRIP
090420200529     C                     ADD  PMACI     CRIP
090430200529     C                     SUB  SMACI     CRIP
090440200529     C                     END                             - E2
090450200529     C*
090460200529     C                     Z-ADDSMACI     PMACI
090470200529     C                     Z-ADD*ZEROS    SGACI
090480200529     C                     Z-ADD*ZEROS    CAIC
090490200529     C/COPY WNCPYSRC,RE3664C096
090500200529     C                     END                             - E1
090510200529     C*
090520200529     C           WDRCR     IFEQ '2'                        - B1
090530200529     C*
090540200529     C                     MOVE SCHGI     CSCHGI  1
090550200529     C                     MOVE *BLANK    SCHGI
090560200529     C*
090570200529     C           SHISD     IFEQ CNCID                      - B2
090580200529     C                     Z-ADDSCHGAR    PCHGAR
090590200529     C                     Z-ADDSCHGAN    PCHGAN
090600200529     C                     Z-ADD*ZEROS    SCHGAR
090610200529     C                     Z-ADD*ZEROS    SCHGAN
090620200529     C                     END                             - E2
090630200529     C                     END                             - E1
090640200529     C*
090650200529     C                     ENDSR                           **SSETUP ENDSR**
090660200529     C********************************************************************
090670200529     C/EJECT
090680200529     C********************************************************************
090690200529     C**
090700200529     C** SUSPR subroutine to execute suspense processing
090710200529     C**
090720200529     C**     Called by       ALTPR, REPR,DEBPR
090730200529     C**     Calls           DCIND,GEICPR
090740200529     C**
090750200529      *****************************************************************   CCB003
090760200529     C           SUSPR     BEGSR                           **SUSPR BEGSR**
090770200529     C*
090780200529     C                     MOVE BBICN     CNUM
090790200529     C                     MOVE COMS      ACOD
090800200529     C/COPY WNCPYSRC,RE3664C097
090810200529     C                     Z-ADD1         ACSQ
090820200529     C/COPY WNCPYSRC,RE3664C116
090830200529     C                     MOVE BCCY      CCY
090840200529     C                     MOVE BBRCA     BRCA
090850200529     C                     Z-ADD*ZEROS    ACNO
090860200529     C*********            Z-ADDRUND      VALD                            082592
090870200529     C           VALD      IFEQ *ZEROS                                    120254
090880200529     C                     Z-ADDRUND      VALD                            120254
090890200529     C                     END                                            120254
090900200529     C                     Z-ADD*ZERO     RIND
090910200529     C                     MOVE WCOMST    ATYP
090920200529     C                     Z-ADD*ZERO     RIND
090930200529     C           ATYP      IFEQ 'R'
090940200529     C                     Z-ADD1         RIND
090950200529     C                     END
090960200529     C*
090970200529      *                                                                   S01408
090980200529     C/COPY WNCPYSRC,RE3664CP35                                           S01408
090990200529      *                                                                   S01408
091000200529     C*
091010200529     C                     EXSR SUBNAR
091020200529     C                     MOVE NARS      PNAR
091030200529     C** CHECKING DEBIT/CREDIT INDICATOR PROCESSING
091040200529     C*
091050200529     C                     EXSR DCIND
091060200529      *                                                                   CAC001
091070200529      **  Use Primary Funding Profit Centre for Suspense Accounts         CAC001
091080200529      *                                                                   CAC001
091090200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
091100200529     C                     MOVE PRFC      WSVPC   4                       CAC001
091110200529     C                     MOVE FTPRFP    PRFC                            CAC001
091120200529     C                     ENDIF                                          CAC001
091130200529     C*
091140200529     C** GEICPD FILE PROCESSING
091150200529     C*
091160200529     C                     EXSR GEICPR
091170200529      *                                                                   CAC001
091180200529      **  Restore saved profit centre                                     CAC001
091190200529      *                                                                   CAC001
091200200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
091210200529     C                     MOVE WSVPC     PRFC                            CAC001
091220200529     C                     ENDIF                                          CAC001
091230200529     C*
091240200529     C           ATYP      IFEQ 'R'
091250200529     C           VALD      ANDLENAPDA
091260200529     C           *IN50     ANDEQ'0'
091270200529     C/COPY WNCPYSRC,RE3664C062
091280200529     C*
091290200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
091300200529     C*
091310200529     C                     Z-ADDVALD      HISD
091320200529     C***********          Z-ADD30        DBASE                           CRE002
091330200529     C                     Z-ADD091       DBASE            * DB ERROR 091*CRE002
091340200529     C                     MOVE 'N'       REACT                           CCB003
091350200529     C                     WRITEREHPOSPF
091360200529     C                     Z-ADD*ZEROS    DBASE
091370200529     C*
091380200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
091390200529     C*
091400200529     C                     EXSR POSPR
091410200529     C*
091420200529     C                     END
091430200529     C*
091440200529     C                     ENDSR                           **SUSPR ENDSR**
091450200529     C********************************************************************
091460200529     C/EJECT
091470200529     C********************************************************************
091480200529     C**
091490200529     C** DACPR subroutine to execute DEBIT ACCRUAL processing
091500200529     C**
091510200529     C**     Called by       TOTAC
091520200529     C**     Calls           DCIND,GEICPR
091530200529     C**
091540200529      *****************************************************************   CCB003
091550200529     C           DACPR     BEGSR                           **DACPR BEGSR**
091560200529     C*
091570200529     C/COPY WNCPYSRC,RE3664C164
091580200529     C           CRE002    IFEQ 'Y'                        B1             CRE002
091590200529     C                     Z-ADDDIIE      WPSTA                           CRE002
091600200529     C                     ELSE                            X1             CRE002
091610200529     C           CRE090    IFEQ 'Y'                                                           CRE090
091620200529     C           NDID      ANDLTBJRDNB                                                        CRE090
091630200529     C           NDID      ANDNE0                                                             CRE090
091640200529     C           DAIC1     SUB  DIIE      WPSTA                                               CRE090
091650200529     C                     ADD  GADI      WPSTA                                             MD027245
091660200529     C                     ELSE                                                               CRE090
091670200529     C           RDAIC     SUB  DIIE      WPSTA
091680200529     C                     ENDIF                                                              CRE090
091690200529     C                     ENDIF                           E1             CRE002
091700200529     C*
091710200529     C* TEG IS NOW INCLUDED IN RDAIC
091720200529     C*
091730200529     C           WPSTA     IFNE 0
091740200529     C*
091750200529     C* POSTING TO INCOME ACCOUNT - CR IF INTEREST IS DEBIT
091760200529     C*
091770200529     C           CRE002    IFNE 'Y'                        B.2            CRE002
091780200529     C                     Z-SUBWPSTA     WPSTA
091790200529     C                     ENDIF                           E.2            CRE002
091800200529     C*
091810200529     C                     MOVELNAR,4     INPNAR
091820200529     C                     MOVELNR16,4    INP16
091830200529     C                     MOVELDN07,4    INP07
091840200529     C                     MOVELMGD,4     ##MGID                          S01522
091850200529     C/COPY WNCPYSRC,RE3664C186
091860200529     C*
091870200529     C***********          Z-ADDBICN      CNUM                            049320
091880200529     C                     MOVELBBICN     CNUM                            049320
091890200529     C                     MOVELBBRCA     BRCA                            049320
091900200529     C                     MOVELBCCY      CCY                             049320
091910200529     C                     Z-ADDDIAC      ACOD
091920200529     C/COPY WNCPYSRC,RE3664C117
091930200529     C           WINT      IFEQ 'Y'                                                           CRE100
091940200529     C                     MOVE BCNUM     CNUM                                                CRE100
091950200529     C                     ENDIF                                                              CRE100
091960200529     C                     Z-ADD1         ACSQ
091970200529      * Account Sequence                                                                    MD034990
091980200529     C           RETSEQ    IFEQ 'Y'                                                         MD034990
091990200529     C                     MOVE BACSQ     ACSQ                                              MD034990
092000200529     C                     ENDIF                                                            MD034990
092010200529     C/COPY WNCPYSRC,RE3664C118
092020200529     C                     Z-ADD*ZEROS    ACNO
092030200529     C                     Z-ADDRUND      VALD
092040200529     C                     Z-ADD*ZERO     RIND
092050200529     C**********           Z-ADDBCNUM     ASOC                                         105084 CSD027
092060200529     C                     MOVE BCNUM     ASOC                                                CSD027
092070200529     C                     MOVE WDIACT    ATYP
092080200529     C                     EXSR SUBNAR
092090200529     C                     MOVE NARS      PNAR
092100200529     C                     MOVELDIAC      OTST                            CMX001
092110200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
092120200529     C                     MOVE 'DIAC'    OTST                            CRE008
092130200529     C**********           ENDIF                                                     261620 MD022635
092140200529     C*
092150200529     C** GEICPD FILE PROCESSING
092160200529     C*
092170200529     C                     EXSR GEICPR
092180200529     C*
092190200529     C* POSTING TO A.T.RECEIVABLE - DR IF INTEREST IS DEBIT
092200200529     C*
092210200529     C/COPY WNCPYSRC,RE3664C229
092220200529     C                     Z-SUBWPSTA     WPSTA
092230200529     C                     Z-ADDDIAD      ACOD
092240200529     C                     MOVE WDIADT    ATYP
092250200529     C                     MOVELDIAD      OTST                            CMX001
092260200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
092270200529     C                     MOVE 'DIAD'    OTST                            CRE008
092280200529     C**********           ENDIF                                                     261620 MD022635
092290200529     C*
092300200529     C** GEICPD FILE PROCESSING
092310200529     C*
092320200529     C                     EXSR GEICPR
092330200529     C                     MOVEL*BLANK    OTST                            CMX001
092340200529     C                     END
092350200529     C/COPY WNCPYSRC,RE3664C165
092360200529     C*
092370200529     C                     ENDSR                           **DACPR ENDSR**
092380200529     C********************************************************************
092390200529     C/EJECT
092400200529     C********************************************************************
092410200529     C**
092420200529     C** CACPR subroutine to execute CREDIT ACCRUAL processing
092430200529     C**
092440200529     C**     Called by       TOTAC
092450200529     C**     Calls           GEICPR
092460200529     C**
092470200529      *****************************************************************   CCB003
092480200529     C           CACPR     BEGSR                           **CACPR BEGSR**
092490200529     C*
092500200529      *                                                                                     MD040758
092510200529     C                     MOVE ' '       ADJUST                                            MD040758
092520200529     C           SHISD     IFLT CNCID                                                       MD040758
092530200529     C           CDL013    ANDEQ'1'                                                         MD040758
092540200529     C                     MOVE 'Y'       ADJUST                                            MD040758
092550200529     C                     ENDIF                                                            MD040758
092560200529      *                                                                                     MD040758
092570200529     C/COPY WNCPYSRC,RE3664C166
092580200529     C           CRE002    IFEQ 'Y'                        B1             CRE002
092590200529     C                     Z-ADDCIIE      WPSTA                           CRE002
092600200529     C                     ELSE                            X1             CRE002
092610200529     C           CRE090    IFEQ 'Y'                                                           CRE090
092620200529     C           NCID      ANDLTBJRDNB                                                        CRE090
092630200529     C           NCID      ANDNE0                                                             CRE090
092640200529     C           CAIC1     SUB  CIIE      WPSTA                                               CRE090
092650200529     C                     ADD  GACI      WPSTA                                             MD027245
092660200529     C                     ELSE                                                               CRE090
092670200529     C           RCAIC     SUB  CIIE      WPSTA
092680200529     C                     ENDIF                                                              CRE090
092690200529     C                     ENDIF                           E1             CRE002
092700200529     C*                                                                   CRE002
092710200529     C           WPSTA     IFNE 0
092720200529     C*
092730200529     C* POSTING TO INCOME ACCOUNT - DR IF INTEREST IS CREDIT
092740200529     C*
092750200529     C           CRE002    IFEQ 'Y'                        B.2            CRE002
092760200529     C                     Z-SUBWPSTA     WPSTA                           CRE002
092770200529     C                     ENDIF                           E.2            CRE002
092780200529     C*                                                                   CRE002
092790200529     C           ADJUST    IFEQ 'Y'                                                         MD040758
092800200529     C                     MOVELNAR,12    INPNAR                                            MD040758
092810200529     C                     MOVELNR16,12   INP16                                             MD040758
092820200529     C                     MOVELDN07,12   INP07                                             MD040758
092830200529     C                     MOVELMGD,12    ##MGID                                            MD040758
092840200529     C                     ELSE                                                             MD040758
092850200529     C                     MOVELNAR,4     INPNAR
092860200529     C                     MOVELNR16,4    INP16
092870200529     C                     MOVELDN07,4    INP07
092880200529     C                     MOVELMGD,4     ##MGID                          189038
092890200529     C                     ENDIF                                                            MD040758
092900200529     C/COPY WNCPYSRC,RE3664C149
092910200529     C*
092920200529     C***********          Z-ADDBICN      CNUM                            049320
092930200529     C                     MOVELBBICN     CNUM                            049320
092940200529     C                     MOVELBBRCA     BRCA                            049320
092950200529     C                     MOVELBCCY      CCY                             049320
092960200529     C                     Z-ADDCIAD      ACOD
092970200529     C/COPY WNCPYSRC,RE3664C119
092980200529     C           WINT      IFEQ 'Y'                                                           CRE100
092990200529     C                     MOVE BCNUM     CNUM                                                CRE100
093000200529     C                     ENDIF                                                              CRE100
093010200529     C                     Z-ADD1         ACSQ
093020200529      * Account Sequence                                                                    MD034990
093030200529     C           RETSEQ    IFEQ 'Y'                                                         MD034990
093040200529     C                     MOVE BACSQ     ACSQ                                              MD034990
093050200529     C                     ENDIF                                                            MD034990
093060200529     C/COPY WNCPYSRC,RE3664C120
093070200529     C                     Z-ADD*ZEROS    ACNO
093080200529     C                     Z-ADDRUND      VALD
093090200529     C                     Z-ADD*ZERO     RIND
093100200529     C                     MOVE WCIADT    ATYP
093110200529     C**********           Z-ADDBCNUM     ASOC                                         105084 CSD027
093120200529     C                     MOVE BCNUM     ASOC                                                CSD027
093130200529     C                     EXSR SUBNAR
093140200529     C                     MOVE NARS      PNAR
093150200529     C                     MOVELCIAD      OTST                            CMX001
093160200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
093170200529     C                     MOVE 'CIAD'    OTST                            CRE008
093180200529     C**********           ENDIF                                                     261620 MD022635
093190200529     C*
093200200529     C** GEICPD FILE PROCESSING
093210200529     C*
093220200529     C                     EXSR GEICPR
093230200529     C*
093240200529     C* POSTING TO A.T.RECEIVABLE - CR IF INTEREST IS CREDIT
093250200529     C*
093260200529     C/COPY WNCPYSRC,RE3664C230
093270200529     C                     Z-SUBWPSTA     WPSTA
093280200529     C                     Z-ADDCIAC      ACOD
093290200529     C                     MOVE WCIACT    ATYP
093300200529     C                     MOVELCIAC      OTST                            CMX001
093310200529     C********** CRE008    IFEQ 'Y'                                                  261620 MD022635
093320200529     C                     MOVE 'CIAC'    OTST                            CRE008
093330200529     C**********           ENDIF                                                     261620 MD022635
093340200529     C*
093350200529     C** GEICPD FILE PROCESSING
093360200529     C*
093370200529     C                     EXSR GEICPR
093380200529     C                     MOVEL*BLANK    OTST                            CMX001
093390200529     C                     END
093400200529     C                     MOVE ' '       ADJUST                                            MD040758
093410200529     C/COPY WNCPYSRC,RE3664C167
093420200529     C*
093430200529     C                     ENDSR                           **CACPR ENDSR**
093440200529     C********************************************************************
093450200529     C/EJECT
093460200529     C********************************************************************
093470200529     C*
093480200529     C** TAXSR subroutine
093490200529     C*
093500200529     C**     Called by       ACCPR,ALTPR
093510200529     C**     Calls           -
093520200529     C*
093530200529      *****************************************************************   CCB003
093540200529     C           TAXSR     BEGSR                           **TAXSR BEGSR**
093550200529     C*
093560200529     C** IF FROM DEBIT
093570200529     C           WDRCR     IFEQ '0'
093580200529     C*
093590200529     C** IF AMOUNT  IS DEBIT
093600200529     C                     ADD  WPSTA     WDIWT
093610200529     C                     END
093620200529     C*
093630200529     C** IF FROM CREDIT
093640200529     C           WDRCR     IFEQ '1'
093650200529     C*
093660200529     C** IF AMOUNT  IS CREDIT
093670200529     C                     SUB  WPSTA     WCIWT
093680200529     C                     END
093690200529     C/COPY WNCPYSRC,RE3664C188
093700200529     C*
093710200529     C                     ENDSR                           **TAXSR ENDSR**
093720200529     C********************************************************************
093730200529     C/EJECT
093740200529     C********************************************************************
093750200529     C**
093760200529     C** TOTAC subroutine to execute total account processing
093770200529     C**
093780200529     C**     Called by       MAIN
093790200529     C**     Calls           -
093800200529     C**
093810200529      *****************************************************************   CCB003
093820200529     C           TOTAC     BEGSR                           **TOTAC BEGSR**
093830200529     C*
093840200529     C** ACCESS AND UPDATE FILE REACR
093850200529     C*
093860200529     C***********          Z-ADD69        DBASE                           CRE002
093870200529     C                     Z-ADD092       DBASE            * DB ERROR 092*CRE002
093880200529     C           ACKEY1    CHAINREACR                40
093890200529     C                     Z-ADD*ZEROS    DBASE
093900200529     C*
093910200529     C           *IN40     IFEQ '1'                        - B1
093920200529     C*
093930200529     C** REACR RECORD NOT FOUND
093940200529     C*
093950200529     C           *LOCK     IN   LDA
093960200529     C***********          Z-ADD23        DBASE            ***************CRE002
093970200529     C                     Z-ADD093       DBASE                           CRE002
093980200529     C***********          MOVE 'REACR'   DBFILE           **DB ERROR 23**CCB003
093990200529     C                     MOVEL'REACR'   DBFILE           **DB ERROR 23**CCB003
094000200529     C                     MOVELAKEY      DBKEY            ***************
094010200529     C                     OUT  LDA
094020200529     C                     EXSR *PSSR
094030200529     C*
094040200529     C                     END                             - E1
094050200529     C*
094060200529     C** ACCESS AND UPDATE FILE ACCNT
094070200529     C*
094080200529     C***********          Z-ADD70        DBASE                           CRE002
094090200529     C                     Z-ADD094       DBASE            * DB ERROR 094*CRE002
094100200529     C           ACKEY1    CHAINACCNT                40
094110200529     C                     Z-ADD*ZEROS    DBASE
094120200529     C*
094130200529     C           *IN40     IFEQ '1'                        - B1
094140200529     C*
094150200529     C** ACCNT RECORD NOT FOUND
094160200529     C*
094170200529     C           *LOCK     IN   LDA
094180200529     C***********          Z-ADD24        DBASE            ***************CRE002
094190200529     C                     Z-ADD095       DBASE                           CRE002
094200200529     C***********          MOVE 'ACCNT'   DBFILE           **DB ERROR 24**CCB003
094210200529     C                     MOVEL'ACCNT'   DBFILE           **DB ERROR 24**CCB003
094220200529     C                     MOVELAKEY      DBKEY            ***************
094230200529     C                     OUT  LDA
094240200529     C                     EXSR *PSSR
094250200529     C*
094260200529     C                     END                             - E1
094270200529      *                                                                   CAC001
094280200529      **  Initially set profit centre to be profit centre of main a/c     CAC001
094290200529      *                                                                   CAC001
094300200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
094310200529     C                     MOVE WMPRFC    PRFC                            CAC001
094320200529     C                     ENDIF                                          CAC001
094330200529     C*
094340200529     C/COPY WNCPYSRC,RE3664C063
094350200529     C* PREPARE UPDATED FIELD
094360200529     C*
094370200529     C*
094380200529     C* PREPARE UPDATED DEBIT FIELDS
094390200529     C*
094400200529     C           BDICI     IFNE ' '                        - B1
094410200529     C*
094420200529     C                     Z-ADDMADI      MADI0
094430200529     C                     Z-ADDGADI      GADI0
094440200529     C           RDAIC     SUB  MADI      DRCP0
094450200529     C                     SUB  GADI      DRCP0
094460200529     C*
094470200529     C*
094480200529     C* PROCESS ACCRUAL THIS MONTH DEBIT
094490200529     C*
094500200529     C/COPY WNCPYSRC,RE3664C064
094510200529     C                     EXSR DACPR
094520200529     C/COPY WNCPYSRC,RE3664C065
094530200529     C*
094540200529     C                     SUB  DRCP0     DAIC1
094550200529     C                     Z-ADD*ZERO     GADI
094560200529     C                     Z-ADD*ZERO     MADI
094570200529     C           CRE090    IFEQ 'Y'                                                           CRE090
094580200529     C           NDID      ANDLTBJRDNB                                                        CRE090
094590200529     C           NDID      ANDNE0                                                             CRE090
094600200529     C                     Z-ADDDAIC1     DIIE                                                CRE090
094610200529     C                     ELSE                                                               CRE090
094620200529     C                     Z-ADD*ZERO     DIIE
094630200529     C                     ENDIF                                                              CRE090
094640200529     C                     Z-ADDRDAIC     LDIA
094650200529     C*
094660200529     C* CALCULATE CAPITALISATION DATES
094670200529     C*
094680200529     C/COPY WNCPYSRC,RE3664C220
094690200529     C           BDICI     IFEQ 'C'                        - B2
094700200529     C           BDICI     OREQ 'D'
094710200529     C                     Z-ADDRUND      LDID
094720200529     C           NDID      IFLE LDID                       - B3
094730200529     C                     Z-ADDNDID      ZDAYNO
094740200529     C                     Z-ADDDRDY      ZMDAY
094750200529     C***********          MOVE BCCY      ZCCY                            092564
094760200529     C                     MOVE BJLCCY    ZCCY                            092564
094770200529     C                     MOVE BJSLCD    ZLOC                                                252356
094780200529     C/COPY WNCPYSRC,RE3664C203
094790200529     C                     MOVE DRIF      ZFREQ
094800200529     C           ZFREQ     IFNE 'Z'                                       069558
094810200529      *                                                                   164975
094820200529     C           ZFREQ     IFEQ 'W'                                       164975
094830200529     C           ZFREQ     OREQ 'F'                                       164975
094840200529     C           ZFREQ     OREQ 'S'                                       164975
094850200529     C           ZDAYNO    DOWLTDNWD                                      164975
094860200529     C                     EXSR ZFRQA                                     164975
094870200529     C                     ENDDO                                          164975
094880200529      *                                                                   164975
094890200529     C                     ELSE                                           164975
094900200529     C                     EXSR ZFRQA
094910200529     C                     ENDIF                                          164975
094920200529      *                                                                   164975
094930200529     C/COPY WNCPYSRC,RE3664C085
094940200529     C                     END                                            069558
094950200529     C           ZFREQ     IFEQ 'Z'
094960200529     C                     Z-ADD*ZERO     ZDAYNO
094970200529     C                     END
094980200529     C                     Z-ADDZDAYNO    NDID
094990200529     C                     END                             - E3
095000200529     C                     ELSE                            - X2
095010200529     C                     Z-ADDNDID      LDID
095020200529     C                     Z-ADDNDID      ZDAYNO
095030200529     C                     Z-ADDDRDY      ZMDAY
095040200529     C***********          MOVE BCCY      ZCCY                            092564
095050200529     C                     MOVE BJLCCY    ZCCY                            092564
095060200529     C                     MOVE BJSLCD    ZLOC                                                252356
095070200529     C/COPY WNCPYSRC,RE3664C204
095080200529     C                     MOVE DRIF      ZFREQ
095090200529     C           ZFREQ     IFNE 'Z'                                       069558
095100200529      *                                                                   164975
095110200529     C           ZFREQ     IFEQ 'W'                                       164975
095120200529     C           ZFREQ     OREQ 'F'                                       164975
095130200529     C           ZFREQ     OREQ 'S'                                       164975
095140200529     C           ZDAYNO    DOWLTDNWD                                      164975
095150200529     C                     EXSR ZFRQA                                     164975
095160200529     C                     ENDDO                                          164975
095170200529      *                                                                   164975
095180200529     C                     ELSE                                           164975
095190200529     C                     EXSR ZFRQA
095200200529     C                     ENDIF                                          164975
095210200529      *                                                                   164975
095220200529     C/COPY WNCPYSRC,RE3664C086
095230200529     C                     END                                            069558
095240200529     C           ZFREQ     IFEQ 'Z'
095250200529     C                     Z-ADD*ZERO     ZDAYNO
095260200529     C                     END
095270200529     C                     Z-ADDZDAYNO    NDID
095280200529      *                                                                                      BUG9030
095290200529      ** If Capitalisation Frequency is 'A', calculate the next accrual                      BUG9030
095300200529      ** profit date and make that as the next interest capitalisation                       BUG9030
095310200529      ** date.                                                                               BUG9030
095320200529      *                                                                                      BUG9030
095330200529     C           ZFREQ     IFEQ 'A'                                                          BUG9030
095340200529     C                     MOVE BKAPFQ    ZFREQ                                              BUG9030
095350200529     C                     MOVE BJLCCY    ZCCY                                               BUG9030
095360200529     C                     MOVE BKAPFD    ZMDAY                                              BUG9030
095370200529     C                     MOVE BKAPDT    ZDAYNO                                             BUG9030
095380200529     C                     EXSR ZFRQA                                                        BUG9030
095390200529     C                     Z-ADDZDAYNO    NDID                                               BUG9030
095400200529     C                     ENDIF                                                             BUG9030
095410200529      *                                                                                      BUG9030
095420200529     C                     END                             - E2
095430200529     C/COPY WNCPYSRC,RE3664C221
095440200529     C                     Z-ADDLDID      LPAR
095450200529     C           MADI0     IFNE *ZEROS                     - B2
095460200529     C           GADI0     ORNE *ZEROS
095470200529     C           DRCP0     ORNE *ZEROS
095480200529     C           *IN50     IFEQ '0'                                       156767
095490200529     C                     EXSR PRDR
095500200529     C                     ENDIF                                          156767
095510200529     C                     END                             - E2
095520200529     C                     END                             - E1
095530200529     C/COPY WNCPYSRC,RE3664C173
095540200529     C*
095550200529     C           BCICI     IFNE ' '                        - B1
095560200529     C*
095570200529     C                     Z-SUBMACI      MACI0
095580200529     C                     Z-SUBGACI      GACI0
095590200529     C           RCAIC     SUB  MACI      CRCP0
095600200529     C                     SUB  GACI      CRCP0
095610200529     C*
095620200529     C* PROCESS ACCRUAL THIS MONTH CREDIT
095630200529     C*
095640200529     C/COPY WNCPYSRC,RE3664C066
095650200529     C                     EXSR CACPR
095660200529     C/COPY WNCPYSRC,RE3664C067
095670200529     C*
095680200529     C                     SUB  CRCP0     CAIC1
095690200529     C                     Z-ADD*ZERO     GACI
095700200529     C                     Z-ADD*ZERO     MACI
095710200529     C           CRE090    IFEQ 'Y'                                                           CRE090
095720200529     C           NCID      ANDLTBJRDNB                                                        CRE090
095730200529     C           NCID      ANDNE0                                                             CRE090
095740200529     C                     Z-ADDCAIC1     CIIE                                                CRE090
095750200529     C                     ELSE                                                               CRE090
095760200529     C                     Z-ADD*ZERO     CIIE
095770200529     C                     ENDIF                                                              CRE090
095780200529     C                     Z-ADDRCAIC     LCIA
095790200529     C                     Z-SUBCRCP0     CRCP0
095800200529     C*
095810200529     C* CALCULATE CAPITALISATION DATES
095820200529     C*
095830200529     C/COPY WNCPYSRC,RE3664C222
095840200529     C           BCICI     IFEQ 'C'                        - B2
095850200529     C           BCICI     OREQ 'D'
095860200529     C                     Z-ADDRUND      LCID
095870200529     C           NCID      IFLE LCID                       - B3
095880200529     C                     Z-ADDNCID      ZDAYNO
095890200529     C                     Z-ADDCRDY      ZMDAY
095900200529     C***********          MOVE BCCY      ZCCY                            092564
095910200529     C                     MOVE BJLCCY    ZCCY                            092564
095920200529     C                     MOVE BJSLCD    ZLOC                                                252356
095930200529     C/COPY WNCPYSRC,RE3664C205
095940200529     C                     MOVE CRIF      ZFREQ
095950200529     C           ZFREQ     IFNE 'Z'                                       069558
095960200529      *                                                                   164975
095970200529     C           ZFREQ     IFEQ 'W'                                       164975
095980200529     C           ZFREQ     OREQ 'F'                                       164975
095990200529     C           ZFREQ     OREQ 'S'                                       164975
096000200529     C           ZDAYNO    DOWLTDNWD                                      164975
096010200529     C                     EXSR ZFRQA                                     164975
096020200529     C                     ENDDO                                          164975
096030200529      *                                                                   164975
096040200529     C                     ELSE                                           164975
096050200529     C                     EXSR ZFRQA
096060200529     C                     ENDIF                                          164975
096070200529      *                                                                   164975
096080200529     C/COPY WNCPYSRC,RE3664C087
096090200529     C                     END                                            069558
096100200529     C           ZFREQ     IFEQ 'Z'
096110200529     C                     Z-ADD*ZERO     ZDAYNO
096120200529     C                     END
096130200529     C                     Z-ADDZDAYNO    NCID
096140200529     C                     END                             - E3
096150200529     C                     ELSE                            - X2
096160200529     C                     Z-ADDNCID      LCID
096170200529     C                     Z-ADDNCID      ZDAYNO
096180200529     C                     Z-ADDCRDY      ZMDAY
096190200529     C***********          MOVE BCCY      ZCCY                            092564
096200200529     C                     MOVE BJLCCY    ZCCY                            092564
096210200529     C                     MOVE BJSLCD    ZLOC                                                252356
096220200529     C/COPY WNCPYSRC,RE3664C206
096230200529     C                     MOVE CRIF      ZFREQ
096240200529     C           ZFREQ     IFNE 'Z'                                       069558
096250200529      *                                                                   164975
096260200529     C           ZFREQ     IFEQ 'W'                                       164975
096270200529     C           ZFREQ     OREQ 'F'                                       164975
096280200529     C           ZFREQ     OREQ 'S'                                       164975
096290200529     C           ZDAYNO    DOWLTDNWD                                      164975
096300200529     C                     EXSR ZFRQA                                     164975
096310200529     C                     ENDDO                                          164975
096320200529      *                                                                   164975
096330200529     C                     ELSE                                           164975
096340200529     C                     EXSR ZFRQA
096350200529     C                     ENDIF                                          164975
096360200529      *                                                                   164975
096370200529     C/COPY WNCPYSRC,RE3664C088
096380200529     C                     END                                            069558
096390200529     C           ZFREQ     IFEQ 'Z'
096400200529     C                     Z-ADD*ZERO     ZDAYNO
096410200529     C                     END
096420200529     C                     Z-ADDZDAYNO    NCID
096430200529      *                                                                                      BUG9030
096440200529      ** If Capitalisation Frequency is 'A', calculate the next accrual                      BUG9030
096450200529      ** profit date and make that as the next interest capitalisation                       BUG9030
096460200529      ** date.                                                                               BUG9030
096470200529      *                                                                                      BUG9030
096480200529     C           ZFREQ     IFEQ 'A'                                                          BUG9030
096490200529     C                     MOVE BKAPFQ    ZFREQ                                              BUG9030
096500200529     C                     MOVE BJLCCY    ZCCY                                               BUG9030
096510200529     C                     MOVE BKAPFD    ZMDAY                                              BUG9030
096520200529     C                     MOVE BKAPDT    ZDAYNO                                             BUG9030
096530200529     C                     EXSR ZFRQA                                                        BUG9030
096540200529     C                     Z-ADDZDAYNO    NCID                                               BUG9030
096550200529     C                     ENDIF                                                             BUG9030
096560200529      *                                                                                      BUG9030
096570200529     C                     END                             - E2
096580200529     C/COPY WNCPYSRC,RE3664C223
096590200529     C                     Z-ADDLCID      LPAP
096600200529     C           MACI0     IFNE *ZEROS                     - B2
096610200529     C           GACI0     ORNE *ZEROS
096620200529     C           CRCP0     ORNE *ZEROS
096630200529     C           *IN50     IFEQ '0'                                       156767
096640200529     C                     EXSR PRCR
096650200529     C                     ENDIF                                          156767
096660200529     C                     END                             - E2
096670200529     C           CSCHGI    IFNE ' '                        - B2
096680200529     C           CHGP      ANDNE0
096690200529     C           *IN50     ANDNE'1'                                       156767
096700200529     C*
096710200529     C                     EXSR PRCHG
096720200529     C*
096730200529     C                     ADD  CHGP      LCIA
096740200529     C*
096750200529     C** ACCESS AND UPDATE FILE REIAC IF CHARGES APPLY
096760200529     C*
096770200529     C***********          Z-ADD71        DBASE                           CRE002
096780200529     C                     Z-ADD096       DBASE            * DB ERROR 096*CRE002
096790200529     C           ACKEY1    CHAINREIAC                40
096800200529     C                     Z-ADD*ZEROS    DBASE
096810200529     C*
096820200529     C           *IN40     IFEQ '1'                        - B3
096830200529     C*
096840200529     C** REIAC RECORD NOT FOUND
096850200529     C*
096860200529     C           *LOCK     IN   LDA
096870200529     C***********          Z-ADD25        DBASE            ***************CRE002
096880200529     C                     Z-ADD097       DBASE                           CRE002
096890200529     C***********          MOVE 'REIAC'   DBFILE           **DB ERROR 25**CCB003
096900200529     C                     MOVEL'REIAC'   DBFILE           **DB ERROR 25**CCB003
096910200529     C                     MOVELAKEY      DBKEY            ***************
096920200529     C                     OUT  LDA
096930200529     C                     EXSR *PSSR
096940200529     C*
096950200529     C                     END                             - E3
096960200529     C*
096970200529     C                     Z-ADDTCHO      WTCHO                                               250998
096980200529     C                     SUB  PCHGAN    NRCA
096990200529     C                     SUB  PCHGAR    RCA
097000200529     C***********          Z-ADD72        DBASE                           CRE002
097010200529     C                     Z-ADD098       DBASE            * DB ERROR 098*CRE002
097020200529     C                     UPDATREIACDF
097030200529     C                     Z-ADD*ZEROS    DBASE
097040200529     C*
097050200529     C                     END                             - E2
097060200529     C*
097070200529     C                     END                             - E1
097080200529     C*
097090200529     C                     Z-ADD*ZERO     CINW
097100200529     C/COPY WNCPYSRC,RE3664C068
097110200529      *                                                                   101656
097120200529     C                     Z-ADD74        DBASE                           101656
097130200529     C                     UPDATACCNTABF                                  101656
097140200529     C                     Z-ADD*ZEROS    DBASE                           101656
097150200529      *                                                                                     AR813717
097160200529     C                     Z-ADDBJRDNB    KRDNB                                             AR813717
097170200529     C                     MOVE 'G'       KMODI                                             AR813717
097180200529     C********** CACP      IFEQ *BLANKS                                           AR851468 AR851468A
097190200529     C                     MOVE BCNUM     KCUST                                             AR813717
097200200529     C                     MOVE BCNUM     KJOIN                                             AR813717
097210200529     C                     MOVE BCCY      KSCCY                                             AR813717
097220200529     C                     Z-ADDBACOD     KACDE                                             AR813717
097230200529     C                     Z-ADDBACSQ     KACSQ                                             AR813717
097240200529     C                     MOVE BBRCA     KBRCA                                             AR813717
097250200529     C                     MOVE BCNUM     KJANO                                             AR813717
097260200529     C**********           ELSE                                                   AR851468 AR851468A
097270200529     C**********           EXSR BRTALT                                            AR851468 AR851468A
097280200529     C**********           MOVE @CCNUM    KCUST                                   AR851468 AR851468A
097290200529     C**********           MOVE @CCNUM    KJOIN                                   AR851468 AR851468A
097300200529     C**********           MOVE @CCCY     KSCCY                                   AR851468 AR851468A
097310200529     C**********           Z-ADD@CACOD    KACDE                                   AR851468 AR851468A
097320200529     C**********           Z-ADD@CACSQ    KACSQ                                   AR851468 AR851468A
097330200529     C**********           MOVE @CBRCA    KBRCA                                   AR851468 AR851468A
097340200529     C**********           MOVE @CCNUM    KJANO                                   AR851468 AR851468A
097350200529     C**********           ENDIF                                                  AR851468 AR851468A
097360200529     C           KJANO     CHAINSDJACCL1             84                                     AR813717
097370200529      *                                                                                     AR813717
097380200529     C                     MOVE 'N'       WJACC                                             AR813717
097390200529     C           *IN84     IFEQ *OFF                                                        AR813717
097400200529     C                     MOVE 'Y'       WJACC                                             AR813717
097410200529     C                     ENDIF                                                            AR813717
097420200529      *                                                                                     AR813717
097430200529     C           WJACC     IFEQ 'Y'                                                         AR813717
097440200529     C           KCILC     SETLLSDCSINLC                                                    AR813717
097450200529     C           KCILC     READESDCSINLC                 84                                 AR813717
097460200529     C                     ELSE                                                             AR813717
097470200529     C           KCIL7     SETLLSDCSINL7                                                    AR813717
097480200529     C           KCIL7     READESDCSINL7                 84                                 AR813717
097490200529     C                     ENDIF                                                            AR813717
097500200529      *                                                                                     AR813717
097510200529     C                     MOVE 'N'       WCSIN   1                                         AR813717
097520200529     C           *IN84     IFEQ *OFF                                                        AR813717
097530200529     C                     MOVE 'Y'       WCSIN                                             AR813717
097540200529     C                     ENDIF                                                            AR813717
097550200529      *                                                                                       CDL013
097560200529     C           CDL013    IFEQ '1'                                                           CDL013
097570200529     C           ATITAX    ANDNE'0'                                                           CDL013
097580200529     C           ATITAX    ANDNE'Y'                                                           CDL013
097590200529     C                     EXSR TOTTAX                                                        CDL013
097600200529     C                     ENDIF                                                              CDL013
097610200529     C*
097620200529     C/COPY WNCPYSRC,RE3664CP25                                           S01408
097630200529     C*                                                                   S01408
097640200529     C           ATITAX    IFEQ 'Y'                                       101656
097650200529     C/COPY WNCPYSRC,RE3664C192
097660200529     C                     EXSR TOTTAX                                    101656
097670200529     C/COPY WNCPYSRC,RE3664C193
097680200529     C                     END                                            101656
097690200529      *                                                                   101656
097700200529     C           BGNTST    IFEQ 'Y'                                       101656
097710200529     C**********           Z-ADDHISB      @RHISB                                      135809 135809R
097720200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
097730200529     C                     Z-ADDHISB      @RHISB                                            AR978914
097740200529     C                     ENDIF                                                            MD045460
097750200529     C           CGL031    IFEQ 'N'                                                        AR851468B
097760200529     C                     EXSR TDISR                                     101656
097770200529     C           WCSIN     IFEQ 'N'                                                         AR813717
097780200529     C                     EXSR TCISR                                     101656
097790200529     C                     ENDIF                                                            AR813717
097800200529     C                     ENDIF                                                           AR851468B
097810200529     C**********           Z-ADD@RHISB    HISB                                        135809 135809R
097820200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
097830200529     C                     Z-ADD@RHISB    HISB                                              AR978914
097840200529     C                     ENDIF                                                            MD045460
097850200529     C                     END                                            101656
097860200529      *                                                                   101656
097870200529     C***********          Z-ADD73        DBASE                           CRE002
097880200529     C                     Z-ADD099       DBASE            * DB ERROR 099*CRE002
097890200529     C*
097900200529     C                     Z-ADDCTFDAT    RELCD
097910200529     C*
097920200529     C                     UPDATREACRDF
097930200529     C                     Z-ADD*ZEROS    DBASE
097940200529     C**********           Z-ADD74        DBASE                           101656
097950200529     C**********           UPDATACCNTABF                                  101656
097960200529     C**********           Z-ADD*ZEROS    DBASE                           101656
097970200529     C***********          MOVE *BLANK    BDICI                           091896
097980200529     C***********          MOVE *BLANK    BCICI                           091896
097990200529     C***********          Z-ADD75        DBASE                           CRE002
098000200529     C                     Z-ADD101       DBASE            * DB ERROR 101*CRE002
098010200529     C*
098020200529     C/COPY WNCPYSRC,RE3664CCP9                                           S01408
098030200529     C*                                                                   S01408
098040200529     C***********ATITAX    IFEQ 'Y'                                       101656
098050200529     C***********          EXSR TOTTAX                                    101656
098060200529     C***********          END                                            101656
098070200529     C*
098080200529     C***********BGNTST    IFEQ 'Y'                                       101656
098090200529     C***********          EXSR TDISR                                     101656
098100200529     C***********          EXSR TCISR                                     101656
098110200529     C***********          END                                            101656
098120200529      *                                                                   130468
098130200529      * If required calculate BRT on total CR interest & adjs. for a/c    130468
098140200529      * and output the relevant postings.                                 130468
098150200529     C           S01383    IFEQ 'Y'                                       130468
098160200529     C           @WCAIC    ANDGT*ZERO                                     130468
098170200529      *                                                                   130468
098180200529      * If a/c currently uses an alternative a/c to post CR interest,     130468
098190200529      * BRT is posted to that a/c; check it exists and is live as this    130468
098200200529      * may not have been done if int. for current cap. period is zero.   130468
098210200529     C           CACP      IFNE *BLANKS                                   130468
098220200529     C                     EXSR BRTALT                                    130468
098230200529     C                     END                                            130468
098240200529      *                                                                   130468
098250200529     C           @WCAIC    IFGT *ZERO                                     130468
098260200529      *                                                                   130468
098270200529      * Set profit centre to that of a/c or alt. a/c and retrieve FX      130468
098280200529      * position profit centre.                                           130468
098290200529     C           BGN0ST    IFEQ 'Y'                                       130468
098300200529     C           CACP      IFEQ *BLANKS                                   130468
098310200529     C                     MOVE WMPRFC    PRFC                            130468
098320200529     C                     ELSE                                           130468
098330200529     C                     MOVE @CPRFC    PRFC                            130468
098340200529     C                     END                                            130468
098350200529     C                     MOVE PRFC      WSVPC                           130468
098360200529     C                     EXSR SRPRFC                                    130468
098370200529     C                     MOVE PRFC      WFXPC                           130468
098380200529     C                     MOVE WSVPC     PRFC                            130468
098390200529     C                     END                                            130468
098400200529      *                                                                   130468
098410200529     C                     EXSR BRTPRO                                    130468
098420200529      *                                                                   130468
098430200529     C           BRTCA     IFNE 'X'                                       130468
098440200529     C                     EXSR OUTBRT                                    130468
098450200529     C                     END                                            130468
098460200529      *                                                                   130468
098470200529     C           BGN0ST    IFEQ 'Y'                                       130468
098480200529     C                     MOVE WMPRFC    PRFC                            130468
098490200529     C                     END                                            130468
098500200529      *                                                                   130468
098510200529     C                     END                                            130468
098520200529     C                     END                                            130468
098530200529      *                                                                   130468
098540200529     C                     Z-ADD*ZERO     WTAOC                                               234870
098550200529     C                     Z-ADD*ZERO     WTATC                                               234870
098560200529     C                     Z-ADD*ZERO     WTABC                                               234870
098570200529     C                     MOVE 'N'       WEUTT                                               234870
098580200529      *                                                                                       234870
098590200529     C                     Z-ADD*ZEROS    WKSTXO                                              CER048
098600200529     C                     Z-ADD*ZEROS    WKSTXT                                              CER048
098610200529     C                     Z-ADD*ZEROS    WKSTXB                                              CER048
098620200529     C                     Z-ADD*ZEROS    WKTTXO                                              CER054
098630200529     C                     Z-ADD*ZEROS    WKTTXT                                              CER054
098640200529     C                     Z-ADD*ZEROS    WKTTXB                                              CER054
098650200529      *                                                                                       CER048
098660200529      ** If required calculate EU withholding tax on total CR interest                        CGL031
098670200529      ** & adjs. for a/c and output the relevant postings.                                    CGL031
098680200529      *                                                                                       CGL031
098690200529     C           CGL031    IFEQ 'Y'                                                           CGL031
098700200529     C********** @WCAIC    ANDGT*ZERO                                                  CGL031 233720
098710200529     C********** RCAIC     ANDGT*ZERO                                                  233720 235875
098720200529     C           RCAIC     ANDNE*ZERO                                                         235875
098730200529      *                                                                                       CGL031
098740200529      ** If a/c currently uses an alternative a/c to post CR interest,                        CGL031
098750200529      ** tax is posted to that a/c; check if it exists and is live as this                    CGL031
098760200529      ** may not have been done if int. for current cap. period is zero.                      CGL031
098770200529      *                                                                                       CGL031
098780200529     C           CACP      IFNE *BLANKS                                                       CGL031
098790200529     C                     EXSR BRTALT                                                        CGL031
098800200529     C                     ENDIF                                                              CGL031
098810200529      *                                                                                       CGL031
098820200529     C********** @WCAIC    IFGT *ZERO                                                  CGL031 233720
098830200529     C********** RCAIC     IFGT *ZERO                                                  233720 235875
098840200529     C           RCAIC     IFNE *ZERO                                                         235875
098850200529      *                                                                                       CGL031
098860200529      ** Set profit centre to that of a/c or alt. a/c and retrieve FX                         CGL031
098870200529      ** position profit centre.                                                              CGL031
098880200529      *                                                                                       CGL031
098890200529     C           BGN0ST    IFEQ 'Y'                                                           CGL031
098900200529     C           CACP      IFEQ *BLANKS                                                       CGL031
098910200529     C                     MOVE WMPRFC    PRFC                                                CGL031
098920200529     C                     ELSE                                                               CGL031
098930200529     C                     MOVE @CPRFC    PRFC                                                CGL031
098940200529     C                     ENDIF                                                              CGL031
098950200529     C                     MOVE PRFC      WSVPC                                               CGL031
098960200529     C                     EXSR SRPRFC                                                        CGL031
098970200529     C                     MOVE PRFC      WFXPC                                               CGL031
098980200529     C                     MOVE WSVPC     PRFC                                                CGL031
098990200529     C                     ENDIF                                                              CGL031
099000200529      *                                                                                       CGL031
099010200529      ** Retrieve tax amount & generate postings.                                             CGL031
099020200529      *                                                                                       CGL031
099030200529     C           WSV01     IFEQ 'N'                                                         AR831847
099040200529     C                     EXSR SRRTAX                                                        CGL031
099050200529     C                     EXSR SRGPOS                                                        CGL031
099060200529     C                     ENDIF                                                            AR831847
099070200529      *                                                                                       CGL031
099080200529     C           BGN0ST    IFEQ 'Y'                                                           CGL031
099090200529     C                     MOVE WMPRFC    PRFC                                                CGL031
099100200529     C                     ENDIF                                                              CGL031
099110200529      *                                                                                       CGL031
099120200529     C                     ENDIF                                                              CGL031
099130200529     C                     ENDIF                                                              CGL031
099140200529      *                                                                                       CGL031
099150200529     C                     MOVE *BLANK    BDICI                           091896
099160200529     C                     MOVE *BLANK    BCICI                           091896
099170200529     C*                                                                   S01408
099180200529     C** Rename duplicate hook name RE3664CCP4 to RE3664CP17              S01408
099190200529     C*COPY*WNCPYSRC,RE3664CCP4***                                        S01408
099200200529     C/COPY WNCPYSRC,RE3664CP17                                           S01408
099210200529     C*                                                                   S01408
099220200529      ***Access*information*from*REHISBC*****************************                CCB003 CRE083BE
099230200529     C********** KKEY01    CHAINREHISBC              38                              CCB003 CRE083BE
099240200529      *                                                                   CCB003
099250200529     C********** *IN38     IFEQ '1'                                                  CCB003 CRE083BE
099260200529     C********** *LOCK     IN   LDA                                                  CCB003 CRE083BE
099270200529     C**********           MOVEL'REHISBC' DBFILE           ************              CCB003 CRE083BE
099280200529     C**********           MOVELRKEY      DBKEY            * DBERR 41 *              122952 CRE083BE
099290200529     C***********          MOVEL'*NRF'    DBKEY            *********CCB003122952
099300200529     C**********           Z-ADD41        DBASE            ************              CCB003 CRE083BE
099310200529     C**********           MOVEL'RE3664'  DBPGM                                      122952 CRE083BE
099320200529     C**********           OUT  LDA                                                  CCB003 CRE083BE
099330200529     C**********           EXSR *PSSR                                                CCB003 CRE083BE
099340200529     C**********           ENDIF                                                     CCB003 CRE083BE
099350200529      ***************************************************************                CCB003 CRE083BE
099360200529      ***Copy*data*from*REINTCPD*to*REHISBC**************************                CCB003 CRE083BE
099370200529     C**********           EXSR SRMOV                                                CCB003 CRE083BE
099380200529      *                                                                   CCB003
099390200529     C**********           UPDATREHISBP1                                             CCB003 CRE083BE
099400200529     C*
099410200529     C***********          UPDATREHISPPF                                  CCB003
099420200529     C                     MOVE 'Y'       FCOMIT                                            MD045084
099430200529     C                     UPDATREHISPPF                                                    CRE083BE
099440200529     C                     Z-ADD*ZEROS    DBASE
099450200529     C*
099460200529     C* INCREMENT TRAILER AFTER BEFORE EACH COMMITMENT
099470200529     C*
099480200529     C                     EXSR TOTAL
099490200529     C*
099500200529     C***********          COMIT                                          CCB003
099510200529     C*
099520200529     C                     ENDSR                           **TOTAC ENDSR**
099530200529      *****************************************************************   CCB003
099540200529     C/EJECT                                                              CCB003
099550200529      *****************************************************************   CCB003
099560200529      *                                                               *   CCB003
099570200529      * SRMOV - Copy data from REINTCPD to REHISBC                    *   CCB003
099580200529      *                                                               *   CCB003
099590200529      *****************************************************************   CCB003
099600200529     C           SRMOV     BEGSR                                          CCB003
099610200529      *                                                                   CCB003
099620200529     C**********           MOVE BRECI     NRECI                                      CCB003 CRE083BE
099630200529     C                     MOVE BBRCA     NBRCA                           CCB003
099640200529     C**********           Z-ADDBCNUM     NCNUM                                        CCB003 CSD027
099650200529     C                     MOVE BCNUM     NCNUM                                               CSD027
099660200529     C                     MOVE BCCY      NCCY                            CCB003
099670200529     C                     Z-ADDBACOD     NACOD                           CCB003
099680200529     C                     Z-ADDBACSQ     NACSQ                           CCB003
099690200529     C**********           Z-ADDBHISD     NHISD                                      CCB003 CRE083BE
099700200529     C**********           Z-ADDBHISB     NHISB                                      CCB003 CRE083BE
099710200529     C**********           Z-ADDBMNBL     NMNBL                                      CCB003 CRE083BE
099720200529     C**********           Z-ADDBCHGAR    NCHGAR                                     CCB003 CRE083BE
099730200529     C**********           Z-ADDBTHGAR    NTHGAR                                     CCB003 CRE083BE
099740200529     C**********           Z-ADDBCHGAN    NCHGAN                                     CCB003 CRE083BE
099750200529     C**********           Z-ADDBTHGAN    NTHGAN                                     CCB003 CRE083BE
099760200529     C**********           Z-ADDBDMVT     NDMVT                                      CCB003 CRE083BE
099770200529     C**********           Z-ADDBDICT     NDICT                                      CCB003 CRE083BE
099780200529     C**********           Z-ADDBDRCB     NDRCB                                      CCB003 CRE083BE
099790200529     C**********           Z-ADDBDRIR     NDRIR                                      CCB003 CRE083BE
099800200529     C**********           Z-ADDBDRCD     NDRCD                                      CCB003 CRE083BE
099810200529     C**********           Z-ADDBDAID     NDAID                                      CCB003 CRE083BE
099820200529     C**********           Z-ADDBMADI     NMADI                                      CCB003 CRE083BE
099830200529     C**********           Z-ADDBTMADI    NTMADI                                     CCB003 CRE083BE
099840200529     C**********           Z-ADDBPDID     NPDID                                      CCB003 CRE083BE
099850200529     C**********           Z-ADDBDMINT    NDMINT                                     CCB003 CRE083BE
099860200529     C**********           Z-ADDBCMVT     NCMVT                                      CCB003 CRE083BE
099870200529     C**********           Z-ADDBCICT     NCICT                                      CCB003 CRE083BE
099880200529     C**********           Z-ADDBCRCB     NCRCB                                      CCB003 CRE083BE
099890200529     C**********           Z-ADDBCRIR     NCRIR                                      CCB003 CRE083BE
099900200529     C**********           Z-ADDBCRCD     NCRCD                                      CCB003 CRE083BE
099910200529     C**********           Z-ADDBCAID     NCAID                                      CCB003 CRE083BE
099920200529     C**********           Z-ADDBMACI     NMACI                                      CCB003 CRE083BE
099930200529     C**********           Z-ADDBTMACI    NTMACI                                     CCB003 CRE083BE
099940200529     C**********           Z-ADDBPCID     NPCID                                      CCB003 CRE083BE
099950200529     C**********           Z-ADDBCMINT    NCMINT                                     CCB003 CRE083BE
099960200529     C**********           MOVE BDICI     NDICI                                      CCB003 CRE083BE
099970200529     C**********           MOVE BCICI     NCICI                                      CCB003 CRE083BE
099980200529     C**********           MOVE BDRCI     NDRCI                                      CCB003 CRE083BE
099990200529     C**********           MOVE BCRCI     NCRCI                                      CCB003 CRE083BE
100000200529     C**********           Z-ADDBVDTC     NVDTC                                      CCB003 CRE083BE
100010200529     C**********           MOVE BADTY     NADTY                                      CCB003 CRE083BE
100020200529     C**********           MOVE BALTI     NALTI                                      CCB003 CRE083BE
100030200529     C**********           Z-ADDBMNBCP    NMNBCP                                     CCB003 CRE083BE
100040200529     C                     MOVE BLGID     NLGID                           CCB003
100050200529     C**********           Z-ADDBVALL     NVALL                                      CCB003 CRE083BE
100060200529     C**********           MOVE BLINK     NLINK                                      CCB003 CRE083BE
100070200529      *                                                                   CCB003
100080200529     C                     ENDSR                                          CCB003
100090200529     C********************************************************************
100100200529     C/EJECT                                                              130468
100110200529     C********************************************************************130468
100120200529     C**                                                                  130468
100130200529     C**   BRTALT SR: if BRT to be posted to alt. a/c, check a/c valid.   130468
100140200529     C**                                                                  130468
100150200529     C********************************************************************130468
100160200529      *                                                                   130468
100170200529     C           BRTALT    BEGSR                           ** BRTALT SR **130468
100180200529      *                                                                   130468
100190200529     C                     MOVELCACP      WALT                            130468
100200200529      *                                                                   130468
100210200529      * Alt. a/c is a RE a/c no.                                          130468
100220200529     C           WALT5     IFEQ *BLANKS                                   130468
100230200529     C           WALT10    CHAINACNUM                99                   130468
100240200529     C           *IN99     IFEQ '1'                                       130468
100250200529     C           RRRECI    OREQ 'C'                                       130468
100260200529     C                     Z-ADD*ZERO     @WCAIC                          130468
100270200529     C                     ELSE                                           130468
100280200529     C                     MOVE RBRCA     @CBRCA                          130468
100290200529     C**********           Z-ADDRCNUM     @CCNUM                                       130468 CSD027
100300200529     C                     MOVE RCNUM     @CCNUM                                              CSD027
100310200529     C                     MOVE RCCY      @CCCY                           130468
100320200529     C                     Z-ADDRACOD     @CACOD                          130468
100330200529     C                     Z-ADDRACSQ     @CACSQ                          130468
100340200529     C                     Z-ADDRACNO     @CACNO                          130468
100350200529      *                                                                   130468
100360200529      * Get profit centre of alt. a/c                                     130468
100370200529     C           BGN0ST    IFEQ 'Y'                                       130468
100380200529     C           WALT10    CHAINREACNMF              99                   130468
100390200529     C           *IN99     IFEQ '1'                                       130468
100400200529     C           *LOCK     IN   LDA                                       130468
100410200529     C                     MOVEL'REACNML0'DBFILE                          130468
100420200529     C                     MOVELWALT10    DBKEY                           130468
100430200529     C                     Z-ADD138       DBASE                           130468
100440200529     C                     OUT  LDA                                       130468
100450200529     C                     EXSR *PSSR                                     130468
100460200529     C                     ELSE                                           130468
100470200529     C                     MOVE TPRFC     @CPRFC                          130468
100480200529     C                     END                                            130468
100490200529     C                     END                                            130468
100500200529     C                     END                                            130468
100510200529      *                                                                   130468
100520200529     C                     ELSE                                           130468
100530200529      *                                                                   130468
100540200529      * Alt. a/c is a GL a/c no.                                          130468
100550200529     C                     MOVE CRBR      WBRCA                           130468
100560200529     C           WALTK     CHAINACCNT               N99                   130468
100570200529     C           *IN99     IFEQ '1'                                       130468
100580200529     C           AARECI    OREQ 'C'                                       130468
100590200529     C                     Z-ADD*ZERO     @WCAIC                          130468
100600200529     C                     ELSE                                           130468
100610200529     C                     MOVE ABRCA     @CBRCA                          130468
100620200529     C**********           Z-ADDAACNUM    @CCNUM                                       130468 CSD027
100630200529     C                     MOVE AACNUM    @CCNUM                                              CSD027
100640200529     C                     MOVE AACCY     @CCCY                           130468
100650200529     C                     Z-ADDAAACOD    @CACOD                          130468
100660200529     C                     Z-ADDAAACSQ    @CACSQ                          130468
100670200529     C                     Z-ADDAAACNO    @CACNO                          130468
100680200529      *                                                                   130468
100690200529      * Set profit centre if alt. a/c is retail/nostro                    130468
100700200529     C           BGN0ST    IFEQ 'Y'                                       130468
100710200529     C           AAATYP    IFEQ 'R'                                       130468
100720200529     C           AAATYP    OREQ 'N'                                       130468
100730200529     C                     MOVE AAPRFC    @CPRFC                          130468
100740200529     C                     ELSE                                           130468
100750200529     C                     MOVE WMPRFC    @CPRFC                          130468
100760200529     C                     END                                            130468
100770200529     C                     END                                            130468
100780200529     C                     END                                            130468
100790200529      *                                                                   130468
100800200529     C                     END                                            130468
100810200529      *                                                                   130468
100820200529     C                     ENDSR                                          130468
100830200529     C********************************************************************130468
100840200529     C/EJECT
100850200529     C********************************************************************
100860200529     C**
100870200529     C**   BRTPRO SR. TO PERFORM EXTRA PROCESSING FOR BRT
100880200529     C**   - CHECKS BRT LIABLE INDICATOR:  CALLS CALBRT & OUTBRT IF ON
100890200529     C**
100900200529     C********************************************************************
100910200529     C**
100920200529     C           BRTPRO    BEGSR                           ** BRTPRO SR **
100930200529     C**
100940200529     C**  INITIALISE OUTPUT AMOUNT FIELDS FOR BRT
100950200529     C**
100960200529     C                     Z-ADD0         BRTAMT
100970200529     C                     Z-ADD0         NETBRT
100980200529     C                     Z-ADD0         PACR1                           092064
100990200529     C                     Z-ADD0         BRTAM2                          130468
101000200529      *                                                                   130468
101010200529      * Use transaction type 91070 for BRT postings                       130468
101020200529     C                     MOVE TRAT      WTRAT                           130468
101030200529     C                     Z-ADD91070     TRAT                            130468
101040200529     C                     MOVEL'91070'   OTTP                            130468
101050200529      *                                                                   130468
101060200529      * Set up BRT narrative                                              130468
101070200529     C                     Z-ADD10        #                               130468
101080200529     C                     MOVELNAR,#     INPNAR                          130468
101090200529     C                     MOVELNR16,#    INP16                           130468
101100200529     C                     MOVELDN07,#    INP07                           130468
101110200529     C                     MOVELMGD,#     ##MGID                          130468
101120200529     C*
101130200529     C* ACCESS BRT CATEGORY & NEW ACCOUNT SIGNAL FROM ACCNTX
101140200529     C* (FIELDS BRTCA AND NACSG, ALL OTHERS PREFIXED # TO BE IGNORED)
101150200529     C*
101160200529     C           ACKEY1    CHAINACCNTX               99
101170200529     C*
101180200529     C      99             SETON                     U7LR  ** DB ERROR 99
101190200529     C      99             MOVEL'ACCNTX'  DBFILE
101200200529     C      99             MOVELAKEY      DBKEY
101210200529     C******99***          Z-ADD99        DBASE                           CRE002
101220200529     C      99             Z-ADD102       DBASE            * DB ERROR 102*CRE002
101230200529     C      99             GOTO ENDBRT
101240200529     C*
101250200529     C* CHECK IF BRT LIABLE OR PART LIABLE
101260200529     C*
101270200529     C           BRTCA     IFEQ 'L'
101280200529     C           BRTCA     OREQ 'P'
101290200529     C                     SETON                     26
101300200529     C                     END
101310200529     C*
101320200529     C           *IN26     IFEQ '1'
101330200529     C*
101340200529     C*  IF SO, CALCULATE BRT AMOUNT
101350200529      *  and output BRT postings                                          130468
101360200529     C*
101370200529     C                     EXSR CALBRT
101380200529     C*
101390200529     C*  ADD 1 TO RECORD COUNT FOR BRT POSTING
101400200529     C*
101410200529     C                     ADD  1         NBRREC
101420200529     C*
101430200529     C*  ELSE INTEREST NET OF BRT IS FULL POSTING AMOUNT.
101440200529     C*
101450200529     C                     ELSE
101460200529     C**********           Z-SUBWPSTA     NETBRT                          130468
101470200529     C                     Z-ADD@WCAIC    NETBRT                          130468
101480200529     C*                                                                   092064
101490200529     C* SET UP FIELD PACR1                                                092064
101500200529     C**********           Z-SUBWPSTA     PACR1                    092064 130468
101510200529     C                     Z-ADD@WCAIC    PACR1                           130468
101520200529     C*
101530200529     C                     END
101540200529     C*
101550200529     C* CHECK NEW A/C SIGNAL FROM ACCNT & UPDATE IF THIS IS A NEW ACCOUNT
101560200529     C*
101570200529     C           BRTCA     IFNE 'X'                        B1
101580200529     C           NACSG     ANDEQ' '
101590200529     C                     MOVEL'Y'       NACSG            (FOR INTPSDD)
101600200529     C                     UPDATACCNTXF
101610200529     C*
101620200529     C                     ELSE                            X1
101630200529     C                     EXCPTRACNTX
101640200529     C*
101650200529     C                     END                             E1
101660200529     C* ENSURE FILES UPDATED WITH CORRECT A/C DETAILS                     080978
101670200529     C*                                                                   080978
101680200529     C                     MOVE BBRCA     BRCA                            080978
101690200529     C**********           Z-ADDBCNUM     CNUM                                         080978 CSD027
101700200529     C                     MOVE BCNUM     CNUM                                                CSD027
101710200529     C                     MOVE BCCY      CCY                             080978
101720200529     C                     Z-ADDBACOD     ACOD                            080978
101730200529     C                     Z-ADDBACSQ     ACSQ                            080978
101740200529      *                                                                   130468
101750200529      * Reset transaction type                                            130468
101760200529     C                     Z-ADDWTRAT     TRAT                            130468
101770200529     C                     MOVELWTRAT     OTTP                            130468
101780200529     C*
101790200529     C           ENDBRT    ENDSR
101800200529     C**
101810200529     C********************************************************************
101820200529     C/EJECT
101830200529     C********************************************************************
101840200529     C**
101850200529     C**   CALBRT SR. TO CALCULATE BRT CURRENCY AMOUNT
101860200529     C**              AND OUTPUT BRT POSTINGS TO RETAIL A/C & BRT A/C     130468
101870200529     C**
101880200529     C**
101890200529     C**   IF BRT CATEGORY = 'L'
101900200529     C**
101910200529     C**          BRT =  GROSS X BRT RATE
101920200529     C**                 ----------------
101930200529     C**                      100
101940200529     C**
101950200529     C**   IF BRT CATEGORY = 'P'
101960200529     C**
101970200529     C**          BRT =  GROSS X (BRT RATE X 0.5)
101980200529     C**                 ------------------------
101990200529     C**                      100
102000200529     C**
102010200529     C**   CALLS 'FRNBRT' IF NOT IN STERLING OR BASE CURRENCY NOT STG
102020200529     C**
102030200529     C** **************************************************************
102040200529     C*
102050200529     C           CALBRT    BEGSR                           ** CALBRT SR **
102060200529     C/COPY WNCPYSRC,RE3664C213
102070200529     C*
102080200529     C* IF DATE IS BEFORE 'DEFF' ON SDBRTDPD - USE PREV BRT RATE
102090200529     C* OTHERWISE - USE CURRENT BRT RATE.
102100200529     C*
102110200529     C           BCICI     IFEQ 'D'
102120200529     C           BCICI     OREQ 'M'
102130200529     C                     MOVE '1'       *IN30
102140200529     C                     ELSE
102150200529     C                     MOVE '0'       *IN30
102160200529     C                     END
102170200529     C*
102180200529     C           LDAC      IFEQ 'Y'
102190200529     C*
102200200529     C           *IN30     IFEQ '1'
102210200529     C           RUND      IFLE DEFF
102220200529     C                     Z-ADDPBRTR     WRKRAT 135
102230200529     C                     ELSE
102240200529     C                     Z-ADDBRTR      WRKRAT
102250200529     C                     END
102260200529     C                     END
102270200529     C*
102280200529     C           BCICI     IFEQ 'C'
102290200529     C           RUND      IFLT DEFF
102300200529     C                     Z-ADDPBRTR     WRKRAT
102310200529     C                     ELSE
102320200529     C                     Z-ADDBRTR      WRKRAT
102330200529     C                     END
102340200529     C                     END
102350200529     C*
102360200529     C           *IN30     IFEQ '0'
102370200529     C           BCICI     ANDNE'C'
102380200529     C           NCID      IFLE DEFF
102390200529     C                     Z-ADDPBRTR     WRKRAT
102400200529     C                     ELSE
102410200529     C                     Z-ADDBRTR      WRKRAT
102420200529     C                     END
102430200529     C                     END
102440200529     C*
102450200529     C                     ELSE
102460200529     C*
102470200529     C           *IN30     IFEQ '1'
102480200529     C           BCICI     OREQ 'C'
102490200529     C           RUND      IFLT DEFF
102500200529     C                     Z-ADDPBRTR     WRKRAT
102510200529     C                     ELSE
102520200529     C                     Z-ADDBRTR      WRKRAT
102530200529     C                     END
102540200529     C                     END
102550200529     C*
102560200529     C           *IN30     IFEQ '0'
102570200529     C           BCICI     ANDNE'C'
102580200529     C           NCID      IFLT DEFF
102590200529     C                     Z-ADDPBRTR     WRKRAT
102600200529     C                     ELSE
102610200529     C                     Z-ADDBRTR      WRKRAT
102620200529     C                     END
102630200529     C                     END
102640200529     C*
102650200529     C                     END
102660200529     C*
102670200529     C           BRTCA     IFEQ 'P'
102680200529     C           WRKRAT    MULT 0.5       WRKRAT
102690200529     C                     END
102700200529     C*
102710200529     C*  ('PACR1' IS THE GROSS CREDIT AMOUNT TO BE POSTED)
102720200529     C*
102730200529     C********** WPSTA     IFLT 0                                         130468
102740200529     C**********           Z-SUBWPSTA     PACR1                           130468
102750200529     C**********           END                                            130468
102760200529     C                     Z-ADD@WCAIC    PACR1                           130468
102770200529     C*
102780200529     C           PACR1     DIV  100       WPACR1 112H
102790200529     C*
102800200529     C           WPACR1    MULT WRKRAT    WRKBRT 156H
102810200529     C*
102820200529     C*  ('BRTAMT' IS THE BRT CURRENCY AMOUNT)
102830200529     C*
102840200529     C                     Z-ADDWRKBRT    BRTAMT 130H
102850200529     C*
102860200529     C*  ('NETBRT' IS THE NET AMOUNT TO BE POSTED TO CUSTOMER A/C.)
102870200529     C*
102880200529     C           PACR1     SUB  BRTAMT    NETBRT 130
102890200529      *                                                                   130468
102900200529     C           BRTAMT    IFGT *ZERO                                     130468
102910200529     C                     Z-ADDBRTAMT    BRTAM2                          130468
102920200529      *                                                                   130468
102930200529      * If alternative a/c in different ccy convert BRT amount.           130468
102940200529     C           CACP      IFNE *BLANKS                                   130468
102950200529     C           @CCCY     IFNE BCCY                                      130468
102960200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
102970200529     C           @CCCY     LOKUPACUR,A                   17                                 CRE083BK
102980200529      *                                                                                     CRE083BK
102990200529     C           *IN17     IFEQ '1'                                                         CRE083BK
103000200529     C           A         OCUR SDCURR                                                      CRE083BK
103010200529     C                     ELSE                                                             CRE083BK
103020200529     C           1         OCUR SDCURR                                                      MD021155
103030200529     C                     CALL 'AOCURRR0'                                130468
103040200529     C                     PARM '*MSG   ' @RTCD                           130468
103050200529     C                     PARM '*KEY   ' @OPTN                           130468
103060200529     C                     PARM @CCCY     @CYCD                           130468
103070200529     C           SDCURR    PARM SDCURR    DSSDY                           130468
103080200529     C           @RTCD     IFNE *BLANK                                    130468
103090200529     C           *LOCK     IN   LDA                                       130468
103100200529     C                     MOVEL'SDCURRPD'DBFILE           ***************130468
103110200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 35 *130468
103120200529     C                     Z-ADD140       DBASE            ***************130468
103130200529     C                     OUT  LDA                                       130468
103140200529     C                     SETON                     U7U8LR               130468
103150200529     C                     EXSR *PSSR                                     130468
103160200529     C                     END                                            130468
103170200529     C                     ENDIF                                                            CRE083BK
103180200529      *                                                                   130468
103190200529     C                     Z-ADDBRTAMT    XAMNT1                          130468
103200200529     C                     Z-ADD*ZERO     XAMNT3                          130468
103210200529     C                     MOVE SPOTW     XSPOT1                          130468
103220200529     C                     MOVE MDINW     XMDIN1                          130468
103230200529     C                     Z-ADDCDPW      XCDP1                           130468
103240200529     C                     Z-ADD0         XAMNT2                          130468
103250200529     C                     Z-ADD0         XAMNT4                          130468
103260200529     C                     Z-ADDSPOT      XSPOT2                          130468
103270200529     C                     MOVE MDIN      XMDIN2                          130468
103280200529     C                     Z-ADDCDP       XCDP2                           130468
103290200529     C                     EXSR CNVERT                                    130468
103300200529     C                     Z-ADDXAMNT2    BRTAM2                          130468
103310200529     C                     END                                            130468
103320200529      *                                                                   130468
103330200529      * If alternative a/c in different branch, get branch details.       130468
103340200529     C                     MOVE BBICN     @CBICN                          130468
103350200529     C           @CBRCA    IFNE BBRCA                                     130468
103360200529     C                     Z-ADDCUBRCA    C                                                 CRE083BK
103370200529     C           @CBRCA    LOKUPABRC,C                   16                                 CRE083BK
103380200529      *                                                                                     CRE083BK
103390200529     C           *IN16     IFEQ '1'                                                         CRE083BK
103400200529     C           C         OCUR SDBRCH                                                      CRE083BK
103410200529     C                     ELSE                                                             CRE083BK
103420200529     C**********           CALL 'AOBRCHR0'                                130468              CGL029
103430200529     C           1         OCUR SDBRCH                                                      MD021155
103440200529     C                     CALL 'AOBRCHR1'                                                    CGL029
103450200529     C                     PARM '*MSG   ' @RTCD                           130468
103460200529     C                     PARM '*KEY   ' @OPTN                           130468
103470200529     C                     PARM @CBRCA    @BRCA   3                       130468
103480200529     C********** SDBRCH    PARM SDBRCH    DSFDY                           130468              CGL029
103490200529     C           SDBRCH    PARM SDBRCH    DSSDY                                               CGL029
103500200529     C           @RTCD     IFNE *BLANK                                    130468
103510200529     C           *LOCK     IN   LDA                                       130468
103520200529     C                     MOVEL'SDBRCHPD'DBFILE           ***************130468
103530200529     C                     MOVEL@BRCA     DBKEY            * DB ERROR 36 *130468
103540200529     C                     Z-ADD136       DBASE            ***************130468
103550200529     C                     OUT  LDA                                       130468
103560200529     C                     SETON                     U7U8LR               130468
103570200529     C                     EXSR *PSSR                                     130468
103580200529     C                     END                                            130468
103590200529     C                     ENDIF                                                            CRE083BK
103600200529     C                     MOVE BICN      @CBICN                          130468
103610200529     C                     END                                            130468
103620200529     C                     END                                            130468
103630200529      *                                                                   130468
103640200529      * Output BRT as a DR to the retail a/c                              130468
103650200529     C           BRTAM2    IFGT *ZERO                                     130468
103660200529     C           CACP      IFEQ *BLANKS                                   130468
103670200529     C                     MOVE BBRCA     BRCA                            130468
103680200529     C**********           Z-ADDBCNUM     CNUM                                         130468 CSD027
103690200529     C                     MOVE BCNUM     CNUM                                                CSD027
103700200529     C                     MOVE BCCY      CCY                             130468
103710200529     C                     Z-ADDBACOD     ACOD                            130468
103720200529     C                     Z-ADDBACSQ     ACSQ                            130468
103730200529     C                     MOVE WACNO     ACNO                            130468
103740200529     C                     ELSE                                           130468
103750200529     C                     MOVE @CBRCA    BRCA                            130468
103760200529     C**********           Z-ADD@CCNUM    CNUM                                         130468 CSD027
103770200529     C                     MOVE @CCNUM    CNUM                                                CSD027
103780200529     C                     MOVE @CCCY     CCY                             130468
103790200529     C                     Z-ADD@CACOD    ACOD                            130468
103800200529     C                     Z-ADD@CACSQ    ACSQ                            130468
103810200529     C                     MOVE @CACNO    ACNO                            130468
103820200529     C                     END                                            130468
103830200529     C                     Z-ADDRUND      PSTD                            130468
103840200529     C                     Z-ADDCNCID     VALD                            130468
103850200529     C                     Z-ADDCNCID     HISD                            130468
103860200529     C                     Z-ADDBRTAM2    WPSTA                           130468
103870200529     C                     Z-ADD*ZERO     RRNM                            130468
103880200529     C                     EXSR SUBNAR                                    130468
103890200529     C                     MOVE NARS      PNAR                            130468
103900200529     C/COPY WNCPYSRC,REH00169
103910200529     C                     EXSR GEICPR                                    130468
103920200529      *                                                                   130468
103930200529      * Update history if required                                        130468
103940200529     C           ATYP      IFEQ 'R'                                       130468
103950200529     C           VALD      ANDLENAPDA                                     130468
103960200529     C           *IN50     ANDEQ'0'                                       130468
103970200529     C                     Z-ADD137       DBASE                           130468
103980200529     C                     MOVE 'N'       REACT                           130468
103990200529     C                     WRITEREHPOSPF                                  130468
104000200529      *                                                                   130468
104010200529     C           CACP      IFEQ *BLANKS                                   130468
104020200529      *                                                                   130468
104030200529     C           R3KEY     CHAINREHISPDF             40                   130468
104040200529     C           *IN40     IFEQ '1'                                       130468
104050200529     C                     MOVE 'D'       RECI                            130468
104060200529     C                     MOVE *BLANK    DLGID                           130468
104070200529     C                     Z-ADD*ZERO     VALL                            130468
104080200529     C                     MOVE *BLANK    LINK                            130468
104090200529     C                     MOVE *BLANK    DICI                            130468
104100200529     C                     MOVE *BLANK    CICI                            130468
104110200529     C                     MOVE *BLANK    DRCI                            130468
104120200529     C                     MOVE *BLANK    CRCI                            130468
104130200529     C                     MOVE *BLANK    ALTI                            130468
104140200529     C                     Z-ADD*ZERO     DRIR                            130468
104150200529     C                     Z-ADD*ZERO     CRIR                            130468
104160200529     C                     Z-ADD*ZERO     PDID                            130468
104170200529     C                     Z-ADD*ZERO     PCID                            130468
104180200529     C                     Z-ADD*ZERO     DICT                            130468
104190200529     C                     Z-ADD*ZERO     CICT                            130468
104200200529     C                     Z-ADD*ZERO     DRCB                            130468
104210200529     C                     Z-ADD*ZERO     CRCB                            130468
104220200529     C                     MOVE *BLANK    ADTY                            130468
104230200529     C                     Z-ADD*ZERO     MNBL                            130468
104240200529     C                     Z-ADD*ZERO     CHGAR                           130468
104250200529     C                     Z-ADD*ZERO     TCHGAR                          130468
104260200529     C                     Z-ADD*ZERO     CHGAN                           130468
104270200529     C                     Z-ADD*ZERO     TCHGAN                          130468
104280200529     C                     Z-ADD*ZERO     DMVT                            130468
104290200529     C                     Z-ADD*ZERO     CMVT                            130468
104300200529     C                     Z-ADD*ZERO     DAID                            130468
104310200529     C                     Z-ADD*ZERO     MADI                            130468
104320200529     C                     Z-ADD*ZERO     TMADI                           130468
104330200529     C                     Z-ADD*ZERO     DMINT                           130468
104340200529     C                     Z-ADD*ZERO     CAID                            130468
104350200529     C                     Z-ADD*ZERO     MACI                            130468
104360200529     C                     Z-ADD*ZERO     TMACI                           130468
104370200529     C                     Z-ADD*ZERO     CMINT                           130468
104380200529     C                     Z-ADD*ZERO     MNBCP                           130468
104390200529     C                     Z-ADD*ZERO     DRCD                            130468
104400200529     C                     Z-ADD*ZERO     CRCD                            130468
104410200529     C                     Z-ADD*ZERO     VDTC                            130468
104420200529     C           DRCR      IFEQ 1                                         130468
104430200529     C                     Z-ADDPSTA      CMVT                            130468
104440200529     C                     ELSE                                           130468
104450200529     C                     Z-ADDPSTA      DMVT                            130468
104460200529     C                     END                                            130468
104470200529     C                     Z-ADDDMVT      HISB                            130468
104480200529     C                     SUB  CMVT      HISB                            130468
104490200529     C                     Z-ADD139       DBASE                           130468
104500200529     C                     WRITEREHISPDF                                  130468
104510200529     C                     Z-ADD*ZEROS    DBASE                           130468
104520200529     C                     ELSE                                           130468
104530200529      *                                                                   130468
104540200529     C           DRCR      IFEQ 1                                         130468
104550200529     C                     ADD  PSTA      CMVT                            130468
104560200529     C                     ELSE                                           130468
104570200529     C                     ADD  PSTA      DMVT                            130468
104580200529     C                     END                                            130468
104590200529     C                     Z-ADD139       DBASE                           130468
104600200529     C                     UPDATREHISPDF                                  130468
104610200529     C                     MOVE 'Y'       FCOMIT                                            MD022410
104620200529     C                     Z-ADD*ZEROS    DBASE                           130468
104630200529     C                     END                                            130468
104640200529      *                                                                   130468
104650200529     C                     ELSE                                           130468
104660200529     C                     EXSR POSPR                                     130468
104670200529     C                     END                                            130468
104680200529     C                     END                                            130468
104690200529      *                                                                   130468
104700200529      * Output BRT as a CR to the internal BRT a/c in the RE a/c ccy.     130468
104710200529     C           CACP      IFEQ *BLANKS                                   130468
104720200529     C                     MOVE BBRCA     BRCA                            130468
104730200529     C                     MOVE BBICN     CNUM                            130468
104740200529     C                     MOVE BCCY      CCY                             130468
104750200529     C                     ELSE                                           130468
104760200529     C                     MOVE @CBRCA    BRCA                            130468
104770200529     C                     MOVE @CBICN    CNUM                            130468
104780200529     C                     MOVE @CCCY     CCY                             130468
104790200529     C                     END                                            130468
104800200529     C                     MOVE ACOD1     ACOD                            130468
104810200529     C                     Z-ADD01        ACSQ                            130468
104820200529     C                     Z-ADD*ZERO     ACNO                            130468
104830200529     C                     Z-ADDRUND      VALD                            130468
104840200529     C                     Z-SUBBRTAM2    WPSTA                           130468
104850200529     C/COPY WNCPYSRC,RE3664C212
104860200529     C                     EXSR SUBNAR                                    130468
104870200529     C                     MOVE NARS      PNAR                            130468
104880200529     C                     EXSR GEICPR                                    130468
104890200529      *                                                                   130468
104900200529      * Update history if required                                        130468
104910200529     C           ATYP      IFEQ 'R'                                       130468
104920200529     C           VALD      ANDLENAPDA                                     130468
104930200529     C           *IN50     ANDEQ'0'                                       130468
104940200529     C                     Z-ADD137       DBASE                           130468
104950200529     C                     MOVE 'N'       REACT                           130468
104960200529     C                     WRITEREHPOSPF                                  130468
104970200529     C                     EXSR POSPR                                     130468
104980200529     C                     END                                            130468
104990200529      *                                                                   130468
105000200529     C                     END                                            130468
105010200529     C*
105020200529     C*  IF NOT IN STERLING - CALL FRNBRT (FOREIGN POSTINGS)
105030200529     C*  ALSO IF BASE CCY NOT STERLING
105040200529     C*
105050200529     C***********CCY       IFNE STCY1                                     085054
105060200529     C           BCCY      IFNE STCY1                                     085054
105070200529     C           BCCY1     ORNE STCY1
105080200529     C           CACP      ORNE *BLANKS                                   130468
105090200529     C           @CCCY     ANDNEBCCY                                      130468
105100200529     C                     EXSR FRNBRT
105110200529     C           STRGRO    SUB  STRBRT    STRNET 130
105120200529     C           BSEGRO    SUB  BSEBRT    BSENET 130
105130200529     C                     ELSE
105140200529     C                     Z-ADDBRTAMT    STRBRT
105150200529     C                     Z-ADDPACR1     STRGRO
105160200529     C                     Z-ADDNETBRT    STRNET
105170200529     C*
105180200529     C                     Z-ADDBRTAMT    BSEBRT
105190200529     C                     Z-ADDPACR1     BSEGRO
105200200529     C                     Z-ADDNETBRT    BSENET
105210200529     C                     END
105220200529     C*
105230200529     C** SET UP NEW FIELDS FOR O/P ON BALANCE STATEMENTS
105240200529     C*
105250200529     C                     MOVE 'Y'       BRTF    1
105260200529     C                     Z-ADDBRTAMT    BRTA   150
105270200529      *                                                                   130468
105280200529     C                     END                                            130468
105290200529     C*
105300200529     C                     ENDSR                           **CALBRT ENDSR*
105310200529     C********************************************************************
105320200529     C/EJECT
105330200529     C********************************************************************
105340200529     C**
105350200529     C**   OUTBRT SR. TO OUTPUT A INTPSDD REC. FOR CREDIT INTEREST
105360200529     C**
105370200529     C**
105380200529     C**   CALLED BY:  CRFILL
105390200529     C**
105400200529     C** **************************************************************
105410200529     C*
105420200529     C           OUTBRT    BEGSR                           ** OUTBRT SR **
105430200529     C**
105440200529     C**  OUTPUT A HISTORY REC. TO INTPSDD.
105450200529     C**
105460200529     C                     MOVE 'D'       RECI
105470200529     C*
105480200529     C** RETRIEVE CRNM
105490200529     C*
105500200529     C                     MOVELBCNUM     CNUM#  10
105510200529     C                     CALL 'AOCUSTR0'
105520200529     C                     PARM '*MSG   ' @RTCD
105530200529     C                     PARM '*KEY   ' @OPTN
105540200529     C                     PARM CNUM#     @CNUM  10
105550200529     C                     PARM           @KYST   7
105560200529     C           SDCUST    PARM SDCUST    DSSDY
105570200529     C           @RTCD     IFNE *BLANK
105580200529     C           *LOCK     IN   LDA
105590200529     C                     MOVEL'SDCUSTPD'DBFILE           ***************
105600200529     C***********          MOVEL@CNUM     DBKEY            * DB ERROR 54 *CRE002
105610200529     C***********          Z-ADD054       DBASE            ***************CRE002
105620200529     C                     MOVEL@CNUM     DBKEY            * DB ERROR 103*CRE002
105630200529     C                     Z-ADD103       DBASE            ***************CRE002
105640200529     C                     OUT  LDA
105650200529     C***********          WRITEERRP1                                     CCB003
105660200529     C                     EXSR *PSSR
105670200529     C                     END
105680200529     C*
105690200529     C                     Z-ADD0         DLNO
105700200529     C*
105710200529     C** IF CAPITALISATION ON DEMAND OR ACCOUNT CLOSURE USE RUN DATE
105720200529     C*
105730200529     C           *IN30     IFEQ '1'
105740200529     C           BCICI     OREQ 'C'
105750200529     C                     Z-ADDRUND      IPDT
105760200529     C                     ELSE
105770200529     C** ELSE STORE CAPITALISATION DATE AS INTEREST PAYMENT DATE
105780200529     C***********          Z-ADDNCID      IPDT                            179300
105790200529      *                                                                   179300
105800200529      **  Use saved value of NCID, to ensure than the correct value is    179300
105810200529      **  taken.                                                          179300
105820200529      *                                                                   179300
105830200529     C                     Z-ADDNXTCID    IPDT                            179300
105840200529      *                                                                   179300
105850200529     C                     END
105860200529     C                     MOVE BRTCA     BRTCAT
105870200529     C*
105880200529     C** IF CUSTOMER NOT LIABLE FOR BRT, CALCULATE STG AND BCE GROSS
105890200529     C** INTEREST AMOUNTS
105900200529     C*
105910200529     C           *IN26     IFEQ '0'
105920200529     C/COPY WNCPYSRC,RE3664C216
105930200529     C                     Z-ADD0         BRTAMT
105940200529     C                     EXSR FRNBRT
105950200529     C                     END
105960200529     C*
105970200529     C                     Z-ADDPACR1     CCYGRI
105980200529     C                     Z-ADDSTRGRO    STGGRI
105990200529     C                     Z-ADDBSEGRO    BCEGRI
106000200529     C*
106010200529     C   26                Z-ADDBRTAMT    CCYBRT
106020200529     C  N26                Z-ADD0         CCYBRT
106030200529     C   26                Z-ADDBSEBRT    BCEBRT
106040200529     C  N26                Z-ADD0         BCEBRT
106050200529     C   26                Z-ADDSTRBRT    STGBRT
106060200529     C  N26                Z-ADD0         STGBRT
106070200529     C*
106080200529     C   26                Z-ADDNETBRT    CCYNTI
106090200529     C  N26                Z-ADDPACR1     CCYNTI
106100200529     C/COPY WNCPYSRC,RE3664C132
106110200529     C   26                Z-ADDSTRNET    STGNTI
106120200529     C  N26                Z-ADDSTRGRO    STGNTI
106130200529     C   26                Z-ADDBSENET    BCENTI
106140200529     C  N26                Z-ADDBSEGRO    BCENTI
106150200529     C*
106160200529     C** OUTPUT EXCHANGE RATE  (A/C CCY : STERLING)
106170200529     C*
106180200529     C           BCCY      IFEQ STCY1
106190200529     C                     Z-ADD1         EXRATE
106200200529     C*
106210200529     C                     ELSE
106220200529     C           BCCY1     IFEQ STCY1
106230200529     C                     MOVE SPOTW     EXRATE
106240200529     C*
106250200529     C                     ELSE
106260200529     C* CALCULATE GROSS RATE
106270200529     C                     MOVE MDINW     @@MDI1  1
106280200529     C                     MOVE MDINS     @@MDI2  1
106290200529     C                     MOVE SPOTW     @@RAT1 138
106300200529     C                     MOVE SPOTS     @@RAT2 138
106310200529     C                     EXSR ZA0900
106320200529     C                     MOVE @@CSRT    EXRATE
106330200529     C*
106340200529     C                     END
106350200529     C*
106360200529     C                     END
106370200529     C*
106380200529     C**********           Z-ADDBCNUM     CNUMK   60                                          CSD027
106390200529     C                     MOVE BCNUM     CNUMK   6                                           CSD027
106400200529     C           CNUMK     CHAINSDCBRTL1             99
106410200529     C           *IN99     IFEQ '1'                        B*2
106420200529     C                     MOVEL'SDCBRTPD'DBFILE
106430200529     C                     MOVELCNUM      DBKEY
106440200529     C***********          Z-ADD68        DBASE                           CRE002
106450200529     C                     Z-ADD104       DBASE            * DB ERROR 104*CRE002
106460200529     C                     SETON                     U7LR  ** DB ERROR 91
106470200529     C                     GOTO ENDTAG
106480200529     C                     END                             E*2
106490200529     C*
106500200529     C           BRTCA     IFEQ 'P'                        B*2
106510200529     C           H1BRTL    IFEQ 'Y'                        B**3
106520200529     C                     Z-ADDH1SEQN    LIAPTY
106530200529     C                     END                             E**3
106540200529     C           H2BRTL    IFEQ 'Y'                        B**3
106550200529     C                     Z-ADDH2SEQN    LIAPTY
106560200529     C                     END                             E**3
106570200529     C                     END                             E*2
106580200529     C*
106590200529     C           BRTCA     IFNE 'P'
106600200529     C                     Z-ADD0         LIAPTY
106610200529     C                     END
106620200529     C*
106630200529     C                     MOVE 'N'       S352RI
106640200529     C                     Z-ADD0         CRBRTS
106650200529     C                     Z-ADD0         CRBRTC
106660200529     C                     Z-ADD0         CRBRTE
106670200529     C*                                                                   087842
106680200529     C*  WRITE OUT DETAILS WITH CORRECT ACCOUNT DETAILS                   087842
106690200529     C*                                                                   087842
106700200529     C                     MOVE BBRCA     BRCA                            087842
106710200529     C                     MOVE BCNUM     CNUM                            087842
106720200529     C                     MOVE BCCY      CCY                             087842
106730200529     C                     MOVE BACOD     ACOD                            087842
106740200529     C                     MOVE BACSQ     ACSQ                            087842
106750200529     C*
106760200529     C*  IF CATEGORY NOT A BANK AND NOT CORPORATE CUSTOMER
106770200529     C*  AND NOT A REPORTABLE NON-RESIDENT.                               CRE007
106780200529     C*
106790200529     C           BRTCA     IFNE 'C'                        B1
106800200529     C           BRTCA     ANDNE'B'
106810200529     C           BRTCA     ANDNE'R'                                       CRE007
106820200529     C                     MOVE 'A'       RTYP
106830200529     C                     MOVE PSTR      PSTR1                           CRE007
106840200529     C                     WRITEINTPSDDF
106850200529     C                     ELSE                            X1
106860200529     C*                                                                   CRE007
106870200529     C*  IF CATEGORY IS REPORTABLE NON-RESIDENT                           CRE007
106880200529     C*                                                                   CRE007
106890200529     C           BRTCA     IFEQ 'R'                        B2             CRE007
106900200529     C                     MOVE 'R'       RTYP                            CRE007
106910200529     C                     MOVE PSTR      PSTR1                           CRE007
106920200529      *                                                                   CRE007
106930200529      **  Access Country Details to retrieve ISO Country code             CRE007
106940200529     C                     MOVE BBCOLC    @LCTR                           CRE007
106950200529     C                     CALL 'AOCTRYR0'                                CRE007
106960200529     C                     PARM *BLANKS   @RTCD                           CRE007
106970200529     C                     PARM '*KEY    '@OPTN                           CRE007
106980200529     C                     PARM           @LCTR   2                       CRE007
106990200529     C           SDCTRY    PARM SDCTRY    DSFDY                           CRE007
107000200529      *                                                                   CRE007
107010200529     C           A4ISOC    CHAINSDFRCTL0             99                   CRE007
107020200529     C           *IN99     IFEQ *OFF                       B3             CRE007
107030200529      *                                                                   CRE007
107040200529     C           F0FRDT    IFLE BJRDNB                     B4             CRE007
107050200529     C                     WRITEINTPSDDF                                  CRE007
107060200529     C                     ENDIF                           E4             CRE007
107070200529      *                                                                   CRE007
107080200529     C                     ELSE                                           CRE007
107090200529     C                     WRITEINTPSDDF                                  CRE007
107100200529     C                     ENDIF                           E3             CRE007
107110200529     C                     ENDIF                           E2             CRE007
107120200529     C*
107130200529     C*  IF CATEGORY IS A BANK AND BANKS INCLUDED IS YES
107140200529     C*
107150200529     C           BRTCA     IFEQ 'B'                        B2
107160200529     C           BTHY      ANDEQ'Y'
107170200529     C                     MOVE 'B'       RTYP
107180200529     C                     WRITECOINTDDF
107190200529     C                     END                             E2
107200200529     C*
107210200529     C*  IF CATEGORY IS A CORPORATE CUSTOMER
107220200529     C*
107230200529     C           BRTCA     IFEQ 'C'                        B2
107240200529     C                     MOVE 'C'       RTYP
107250200529     C                     WRITECOINTDDF
107260200529     C                     END                             E2
107270200529     C                     END                             E1
107280200529     C*
107290200529     C           ENDTAG    TAG
107300200529     C                     ENDSR                           **OUTBRT ENDSR*
107310200529     C********************************************************************
107320200529     C/EJECT
107330200529     C********************************************************************
107340200529     C**
107350200529     C**   FRNBRT SR. TO OUTPUT FOREIGN BRT POSTINGS
107360200529     C**
107370200529     C**   OUTPUT DEBIT CCY WITHHOLDING TAX A/C
107380200529     C**   OUTPUT CREDIT CCY SPOT POSITION
107390200529     C**   OUTPUT CREDIT BASE CCY EQUIV. A/C
107400200529     C**   OUTPUT DEBIT BASE CCY EQUIV. A/C
107410200529     C**   OUTPUT STERLING CCY WITHHOLDING TAX A/C
107420200529     C**   OUTPUT STERLING CCY SPOT POSITION A/C
107430200529     C**
107440200529     C*****************************************************************
107450200529     C**
107460200529     C           FRNBRT    BEGSR                           ** FRNBRT SR **
107470200529     C*
107480200529     C           *IN26     IFEQ '1'
107490200529     C*
107500200529     C*   SETON INDICATOR TO OUTPUT:
107510200529     C*                      -   DEBIT  CCY TAX HELD A/C.
107520200529     C*                      -   CREDIT CCY SPOT POSITION A/C.
107530200529     C*                      -   CREDIT BASE CCY EQUIV. A/C - LOCAL CCY
107540200529     C*                      -   DEBIT  BASE CCY EQUIV. A/C - CURRENCY
107550200529     C*                      -   CREDIT LOCAL CCY TAX HELD A/C
107560200529     C*                      -   DEBIT  LOCAL CCY SPOT POSITION A/C
107570200529     C*
107580200529     C                     SETON                     27
107590200529     C                     Z-ADD10        #                               071428
107600200529     C*
107610200529     C*  ADD 6 TO RECORD COUNT FOR THESE EXTRA POSTINGS
107620200529     C*
107630200529     C  N29                ADD  6         NBRREC
107640200529     C   29                ADD  4         NBRREC
107650200529     C*
107660200529     C                     END
107670200529     C*
107680200529     C**  CONVERT BRT AMT. TO BASE CCY (BRTAMT -> BSEBRT)
107690200529     C**  CONVERT GROSS AMT. TO BASE CCY (PACR1 -> BSEGRO)
107700200529     C*   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
107710200529     C*   FROM VALUES
107720200529     C*
107730200529     C                     Z-ADDBRTAMT    XAMNT1
107740200529     C                     Z-ADDPACR1     XAMNT3
107750200529     C                     MOVE SPOTW     XSPOT1
107760200529     C                     MOVE MDINW     XMDIN1
107770200529     C                     Z-ADDCDPW      XCDP1
107780200529     C*
107790200529     C*   TO VALUES
107800200529     C*
107810200529     C                     Z-ADD0         XAMNT2
107820200529     C                     Z-ADD0         XAMNT4
107830200529     C                     Z-ADDSPOTB     XSPOT2
107840200529     C                     MOVE MDINB     XMDIN2
107850200529     C                     Z-ADDCDPB      XCDP2
107860200529     C*
107870200529     C                     EXSR CNVERT
107880200529     C*
107890200529     C*   PUT CONVERTED AMOUNT INTO 'BASE BRT AMOUNT' FIELD FOR OUTPUT.
107900200529     C*
107910200529     C                     Z-ADDXAMNT2    BSEBRT 130
107920200529     C                     Z-ADDXAMNT4    BSEGRO 130
107930200529     C*
107940200529     C** CONVERT BRT AMT. TO STERLING CCY
107950200529     C*  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
107960200529     C***********CCY       IFNE STCY1                                     071427
107970200529     C           BCCY      IFNE STCY1                                     071427
107980200529     C*
107990200529     C*  TO VALUES
108000200529     C*
108010200529     C                     Z-ADD0         XAMNT2
108020200529     C                     Z-ADD0         XAMNT4
108030200529     C                     Z-ADDSPOTS     XSPOT2
108040200529     C                     MOVE MDINS     XMDIN2
108050200529     C                     Z-ADDCDPS      XCDP2
108060200529     C*
108070200529     C                     EXSR CNVERT
108080200529     C*
108090200529     C*   PUT CONVERTED AMOUNT INTO 'STERLING AMOUNT' FIELD FOR O/P
108100200529     C*
108110200529     C                     Z-ADDXAMNT2    STRBRT 130
108120200529     C                     Z-ADDXAMNT4    STRGRO 130
108130200529     C*
108140200529     C                     ELSE
108150200529     C                     Z-ADDBRTAMT    STRBRT
108160200529     C                     Z-ADDPACR1     STRGRO
108170200529     C                     END
108180200529      *                                                                   130468
108190200529      * If alt. a/c use the relevant BICN, branch & ccy.                  130468
108200200529     C           CACP      IFNE *BLANKS                                   130468
108210200529     C                     MOVE BBICN     @SBICN                          130468
108220200529     C                     MOVE BBRCA     @SBRCA                          130468
108230200529     C                     MOVE BCCY      @SCCY                           130468
108240200529     C                     MOVE @CBICN    BBICN                           130468
108250200529     C                     MOVE @CBRCA    BBRCA                           130468
108260200529     C                     MOVE @CCCY     BCCY                            130468
108270200529     C                     END                                            130468
108280200529     C*
108290200529     C** OUTPUT POSTINGS IF STERLING SPOT TRADE A/C EQUIV. CODE IS
108300200529     C** NOT ZERO, EXECUTE 'PLPR' SUBROUTINE 6 TIMES
108310200529     C*
108320200529     C**  If Analytical Accounting is installed:                          CAC001
108330200529     C**    - If Posting to spot trade or trade equivalent account,       CAC001
108340200529     C**      use FX Position Profit Centre (already setup in SR/CREPR)   CAC001
108350200529     C**    - Otherwise, use profit centre of the main account            CAC001
108360200529     C*                                                                   CAC001
108370200529     C           *IN29     IFEQ '0'
108380200529     C*
108390200529     C**********           CALL 'AOBRCHR0'
108400200529     C**********           PARM '*MSG   ' @RTCD
108410200529     C**********           PARM '*KEY   ' @OPTN
108420200529     C**********           PARM BBRCA     @BRCA   3
108430200529     C********** SDBRCH    PARM SDBRCH    DSFDY
108440200529     C********** @RTCD     IFNE *BLANK
108450200529     C********** *LOCK     IN   LDA
108460200529     C**********           MOVEL'SDBRCHPD'DBFILE           ***************
108470200529     C**********           MOVEL@BRCA     DBKEY            * DB ERROR 32 *
108480200529     C**********           Z-ADD32        DBASE            ***************
108490200529     C**********           OUT  LDA
108500200529     C**********           WRITEERRP1
108510200529     C**********           EXSR *PSSR
108520200529     C**********           END
108530200529     C**********           MOVE BICN      CNUM
108540200529     C*
108550200529     C********** BRTAMT    IFNE 0                                         130468
108560200529     C           BRTAM2    IFNE 0                                         130468
108570200529     C                     MOVE BCCY      CCY
108580200529     C*
108590200529     C**********           MOVE 'D'       RECI
108600200529     C********** RECI      CHAINSDBRTDD0             99    (99 = EOF)
108610200529     C***99*****           SETON                     U7LR  ** DB ERROR 98
108620200529     C***99*****           MOVEL'SDBRTDPD'DBFILE
108630200529     C***99*****           MOVELRECI      DBKEY
108640200529     C***99*****           Z-ADD98        DBASE
108650200529     C***99*****           EXSR *PSSR
108660200529     C*
108670200529     C                     MOVE ACOD1     ACOD
108680200529     C********** BGN0ST    IFEQ 'Y'                                CAC001 130468
108690200529     C**********           MOVE WMPRFC    PRFC                     CAC001 130468
108700200529     C**********           ENDIF                                   CAC001 130468
108710200529     C**********           MOVE 'P'       RECI
108720200529     C                     MOVE *BLANKS   IPDN
108730200529     C**********           Z-ADD91060     TRAT                            130468
108740200529     C**********           MOVEL'BRT '    @PNARX 12
108750200529     C**********           MOVE 'INTEREST'@PNARX
108760200529     C**********           MOVEL@PNARX    NARS
108770200529     C**********           MOVELNAR,#     INPNAR                          130468
108780200529     C**********           MOVELNR16,#    INP16                           130468
108790200529     C**********           MOVELDN07,#    INP07                           130468
108800200529     C**********           MOVELMGD,#     ##MGID                   S01522 130468
108810200529     C/COPY WNCPYSRC,RE3664C150
108820200529     C*
108830200529     C**********           Z-ADDBRTAMT    WPSTA                           130468
108840200529     C                     Z-ADDBRTAM2    WPSTA                           130468
108850200529     C**********           MOVE '0'       DRCR
108860200529     C*********************MOVE BCNUM     ASOC                            080978
108870200529     C**********           MOVE ABRCA     BRCA
108880200529     C                     MOVE *BLANKS   MGTT
108890200529     C                     Z-ADD0         LTAI
108900200529     C                     MOVE *BLANKS   RINO
108910200529     C                     MOVE *BLANKS   SWCR
108920200529     C                     MOVE *BLANKS   DLREF
108930200529     C                     MOVE *BLANKS   FACO
108940200529     C**********           Z-ADD0         DBCNUM                                              CSD027
108950200529     C                     MOVE *BLANKS   DBCNUM                                              CSD027
108960200529     C                     MOVE *BLANKS   PREF
108970200529     C                     MOVE *BLANKS   OTRF
108980200529     C                     MOVE *BLANKS   OTST
108990200529     C**********           MOVEL'91060'   OTTP                            130468
109000200529     C                     Z-ADD0         SDCB
109010200529     C                     Z-ADD0         SDLB
109020200529     C                     MOVE *BLANKS   BOKC
109030200529     C                     Z-ADD1         NITMS
109040200529     C                     MOVE *BLANKS   REBI
109050200529     C                     Z-ADD0         CHGA
109060200529     C                     EXSR PLPR
109070200529     C*
109080200529     C**********           CALL 'AOTRADR0'
109090200529     C**********           PARM *BLANKS   @RTCD   7
109100200529     C**********           PARM '*FIRST ' @OPTN   7
109110200529     C********** SDTRAD    PARM SDTRAD    DSFDY
109120200529     C********** @RTCD     IFNE *BLANK
109130200529     C********** *LOCK     IN   LDA
109140200529     C**********           MOVEL'SDTRADPD'DBFILE           ***************
109150200529     C**********           MOVEL@OPTN     DBKEY            * DBERROR 007 *
109160200529     C**********           Z-ADD007       DBASE            ***************
109170200529     C**********           OUT  LDA
109180200529     C**********           EXSR *PSSR
109190200529     C**********           END
109200200529     C                     MOVE SPAC      ACOD
109210200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
109220200529     C                     MOVE WFXPC     PRFC                            CAC001
109230200529     C                     ENDIF                                          CAC001
109240200529     C**********           Z-SUBBRTAMT    WPSTA                           130468
109250200529     C                     Z-SUBBRTAM2    WPSTA                           130468
109260200529     C**********           Z-ADD1         DRCR
109270200529     C                     EXSR PLPR
109280200529     C                     END
109290200529     C*
109300200529     C           BSEBRT    IFNE 0
109310200529     C                     MOVE BACCY     CCY
109320200529     C*
109330200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
109340200529     C           STCY1     LOKUPACUR,A                   17                                 CRE083BK
109350200529      *                                                                                     CRE083BK
109360200529     C           *IN17     IFEQ '1'                                                         CRE083BK
109370200529     C           A         OCUR SDCURR                                                      CRE083BK
109380200529     C                     ELSE                                                             CRE083BK
109390200529     C           1         OCUR SDCURR                                                      MD021155
109400200529     C                     CALL 'AOCURRR0'
109410200529     C                     PARM '*MSG   ' @RTCD
109420200529     C                     PARM '*KEY   ' @OPTN
109430200529     C                     PARM STCY1     @CYCD   3
109440200529     C           SDCURR    PARM SDCURR    DSSDY
109450200529     C           @RTCD     IFNE *BLANK
109460200529     C           *LOCK     IN   LDA
109470200529     C                     MOVEL'SDCURRPD'DBFILE           ***************
109480200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 10 *CRE002
109490200529     C***********          Z-ADD010       DBASE            ***************CRE002
109500200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 105*CRE002
109510200529     C                     Z-ADD105       DBASE            ***************CRE002
109520200529     C                     OUT  LDA
109530200529     C***********          WRITEERRP1                                     CCB003
109540200529     C                     EXSR *PSSR
109550200529     C                     END
109560200529     C                     ENDIF                                                            CRE083BK
109570200529     C                     MOVE TACC      ACOD
109580200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
109590200529     C                     MOVE WFXPC     PRFC                            CAC001
109600200529     C                     ENDIF                                          CAC001
109610200529     C                     Z-SUBBSEBRT    WPSTA
109620200529     C                     EXSR PLPR
109630200529     C*
109640200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
109650200529     C           BCCY      LOKUPACUR,A                   17                                 CRE083BK
109660200529      *                                                                                     CRE083BK
109670200529     C           *IN17     IFEQ '1'                                                         CRE083BK
109680200529     C           A         OCUR SDCURR                                                      CRE083BK
109690200529     C                     ELSE                                                             CRE083BK
109700200529     C           1         OCUR SDCURR                                                      MD021155
109710200529     C                     CALL 'AOCURRR0'
109720200529     C                     PARM '*MSG   ' @RTCD
109730200529     C                     PARM '*KEY   ' @OPTN
109740200529     C                     PARM BCCY      @CYCD   3
109750200529     C           SDCURR    PARM SDCURR    DSSDY
109760200529     C           @RTCD     IFNE *BLANK
109770200529     C           *LOCK     IN   LDA
109780200529     C                     MOVEL'SDCURRPD'DBFILE           ***************
109790200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 10 *CRE002
109800200529     C***********          Z-ADD010       DBASE            ***************CRE002
109810200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 106*CRE002
109820200529     C                     Z-ADD106       DBASE            ***************CRE002
109830200529     C                     OUT  LDA
109840200529     C***********          WRITEERRP1                                     CCB003
109850200529     C                     EXSR *PSSR
109860200529     C                     END
109870200529     C                     ENDIF                                                            CRE083BK
109880200529     C                     MOVE TACC      ACOD
109890200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
109900200529     C                     MOVE WFXPC     PRFC                            CAC001
109910200529     C                     ENDIF                                          CAC001
109920200529     C                     Z-ADDBSEBRT    WPSTA
109930200529     C*********            Z-ADD0         DRCR
109940200529     C                     EXSR PLPR
109950200529     C                     END
109960200529     C*
109970200529     C           STRBRT    IFNE 0
109980200529     C                     MOVE STCY1     CCY
109990200529     C*
110000200529     C*****                MOVE 'D'       RECI
110010200529     C*****      RECI      CHAINSDBRTDD0             99    (99 = EOF)
110020200529     C   99      *LOCK     IN   LDA
110030200529     C***99                SETON                     U7LR  ** DB ERROR 98
110040200529     C***99                MOVEL'SDBRTDPD'DBFILE
110050200529     C***99                MOVELRECI      DBKEY
110060200529     C***99                Z-ADD98        DBASE
110070200529     C   99                OUT  LDA
110080200529     C***99                EXSR *PSSR
110090200529     C*
110100200529     C                     MOVE ACOD1     ACOD
110110200529     C/COPY WNCPYSRC,RE3664C214
110120200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
110130200529     C**********           MOVE WMPRFC    PRFC                     CAC001 130468
110140200529     C                     MOVE WSVPC     PRFC                            130468
110150200529     C                     ENDIF                                          CAC001
110160200529     C******               MOVE 'P'       RECI
110170200529     C                     Z-SUBSTRBRT    WPSTA
110180200529     C******               Z-ADD1         DRCR
110190200529     C                     EXSR PLPR
110200200529     C*
110210200529     C*****                CALL 'AOTRADR0'
110220200529     C*****                PARM *BLANKS   @RTCD   7
110230200529     C****                 PARM '*FIRST ' @OPTN   7
110240200529     C***        SDTRAD    PARM SDTRAD    DSFDY
110250200529     C***        @RTCD     IFNE *BLANK
110260200529     C***        *LOCK     IN   LDA
110270200529     C***                  MOVEL'SDTRADPD'DBFILE           ***************
110280200529     C***                  MOVEL@OPTN     DBKEY            * DBERROR 007 *
110290200529     C***                  Z-ADD007       DBASE            ***************
110300200529     C***                  OUT  LDA
110310200529     C***                  EXSR *PSSR
110320200529     C***                  END
110330200529     C                     MOVE SPAC      ACOD
110340200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
110350200529     C                     MOVE WFXPC     PRFC                            CAC001
110360200529     C                     ENDIF                                          CAC001
110370200529     C                     Z-ADDSTRBRT    WPSTA
110380200529     C*****                Z-ADD0         DRCR
110390200529     C                     EXSR PLPR
110400200529     C                     END
110410200529     C*
110420200529     C                     ELSE
110430200529     C*
110440200529     C*****                CALL 'AOBRCHR0'
110450200529     C*****                PARM '*MSG   ' @RTCD
110460200529     C*****                PARM '*KEY   ' @OPTN
110470200529     C*****                PARM BBRCA     @BRCA   3
110480200529     C*****      SDBRCH    PARM SDBRCH    DSFDY
110490200529     C*****      @RTCD     IFNE *BLANK
110500200529     C*****      *LOCK     IN   LDA
110510200529     C*****                MOVEL'SDBRCHPD'DBFILE           ***************
110520200529     C****                 MOVEL@BRCA     DBKEY            * DB ERROR 42 *
110530200529     C****                 Z-ADD42        DBASE            ***************
110540200529     C*****                OUT  LDA
110550200529     C*****                WRITEERRP1
110560200529     C*****                EXSR *PSSR
110570200529     C*****                END
110580200529     C*****                MOVE BICN      CNUM
110590200529     C*
110600200529     C********** BRTAMT    IFNE 0                                         130468
110610200529     C           BRTAM2    IFNE 0                                         130468
110620200529     C                     MOVE BCCY      CCY
110630200529     C*
110640200529     C****                 MOVE 'D'       RECI
110650200529     C****       RECI      CHAINSDBRTDD0             99    (99 = EOF)
110660200529     C   99      *LOCK     IN   LDA
110670200529     C***99                SETON                     U7LR  ** DB ERROR 98
110680200529     C***99                MOVEL'SDBRTDPD'DBFILE
110690200529     C***99                MOVELRECI      DBKEY
110700200529     C***99                Z-ADD98        DBASE
110710200529     C   99                OUT  LDA
110720200529     C***99                EXSR *PSSR
110730200529     C*
110740200529     C                     MOVE ACOD1     ACOD
110750200529     C********** BGN0ST    IFEQ 'Y'                                CAC001 130468
110760200529     C**********           MOVE WMPRFC    PRFC                     CAC001 130468
110770200529     C**********           ENDIF                                   CAC001 130468
110780200529     C*****                MOVE 'P'       RECI
110790200529     C                     MOVE *BLANKS   IPDN
110800200529     C**********           Z-ADD91060     TRAT                            130468
110810200529     C*********            MOVEL'BRT '    @PNARX 12
110820200529     C*********            MOVE 'INTEREST'@PNARX
110830200529     C*********            MOVEL@PNARX    NARS
110840200529     C**********           MOVELNAR,#     INPNAR                          130468
110850200529     C**********           MOVELNR16,#    INP16                           130468
110860200529     C**********           MOVELDN07,#    INP07                           130468
110870200529     C**********           MOVELMGD,#     ##MGID                   S01522 130468
110880200529     C/COPY WNCPYSRC,RE3664C151
110890200529     C*
110900200529     C**********           Z-ADDBRTAMT    WPSTA                           130468
110910200529     C                     Z-ADDBRTAM2    WPSTA                           130468
110920200529     C**********           MOVE '0'       DRCR
110930200529     C*********************MOVE BCNUM     ASOC                            080978
110940200529     C                     MOVE ABRCA     BRCA
110950200529     C                     MOVE *BLANKS   MGTT
110960200529     C                     Z-ADD0         LTAI
110970200529     C                     MOVE *BLANKS   RINO
110980200529     C                     MOVE *BLANKS   SWCR
110990200529     C                     MOVE *BLANKS   DLREF
111000200529     C                     MOVE *BLANKS   FACO
111010200529     C**********           Z-ADD0         DBCNUM                                              CSD027
111020200529     C                     MOVE *BLANKS   DBCNUM                                              CSD027
111030200529     C                     MOVE *BLANKS   PREF
111040200529     C                     MOVE *BLANKS   OTRF
111050200529     C                     MOVE *BLANKS   OTST
111060200529     C**********           MOVEL'91060'   OTTP                            130468
111070200529     C                     Z-ADD0         SDCB
111080200529     C                     Z-ADD0         SDLB
111090200529     C                     MOVE *BLANKS   BOKC
111100200529     C                     Z-ADD1         NITMS
111110200529     C                     MOVE *BLANKS   REBI
111120200529     C                     Z-ADD0         CHGA
111130200529     C                     EXSR PLPR
111140200529     C*
111150200529     C*******              CALL 'AOTRADR0'
111160200529     C******               PARM *BLANKS   @RTCD   7
111170200529     C******               PARM '*FIRST ' @OPTN   7
111180200529     C****       SDTRAD    PARM SDTRAD    DSFDY
111190200529     C****       @RTCD     IFNE *BLANK
111200200529     C****       *LOCK     IN   LDA
111210200529     C****                 MOVEL'SDTRADPD'DBFILE           ***************
111220200529     C****                 MOVEL@OPTN     DBKEY            * DBERROR 007 *
111230200529     C****                 Z-ADD007       DBASE            ***************
111240200529     C****                 OUT  LDA
111250200529     C****                 EXSR *PSSR
111260200529     C****                 END
111270200529     C                     MOVE SPAC      ACOD
111280200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
111290200529     C                     MOVE WFXPC     PRFC                            CAC001
111300200529     C                     ENDIF                                          CAC001
111310200529     C**********           Z-SUBBRTAMT    WPSTA                           130468
111320200529     C                     Z-SUBBRTAM2    WPSTA                           130468
111330200529     C****                 Z-ADD1         DRCR
111340200529     C                     EXSR PLPR
111350200529     C                     END
111360200529     C*
111370200529     C           BSEBRT    IFNE 0
111380200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
111390200529     C           BCCY      LOKUPACUR,A                   17                                 CRE083BK
111400200529      *                                                                                     CRE083BK
111410200529     C           *IN17     IFEQ '1'                                                         CRE083BK
111420200529     C           A         OCUR SDCURR                                                      CRE083BK
111430200529     C                     ELSE                                                             CRE083BK
111440200529     C           1         OCUR SDCURR                                                      MD021155
111450200529     C                     CALL 'AOCURRR0'
111460200529     C                     PARM '*MSG   ' @RTCD
111470200529     C                     PARM '*KEY   ' @OPTN
111480200529     C                     PARM BCCY      @CYCD   3
111490200529     C           SDCURR    PARM SDCURR    DSSDY
111500200529     C           @RTCD     IFNE *BLANK
111510200529     C           *LOCK     IN   LDA
111520200529     C                     MOVEL'SDCURRPD'DBFILE           ***************
111530200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 10 *CRE002
111540200529     C***********          Z-ADD010       DBASE            ***************CRE002
111550200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 107*CRE002
111560200529     C                     Z-ADD107       DBASE            ***************CRE002
111570200529     C                     OUT  LDA
111580200529     C***********          WRITEERRP1                                     CCB003
111590200529     C                     EXSR *PSSR
111600200529     C                     END
111610200529     C                     ENDIF                                                            CRE083BK
111620200529     C                     MOVE TACC      ACOD
111630200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
111640200529     C                     MOVE WFXPC     PRFC                            CAC001
111650200529     C                     ENDIF                                          CAC001
111660200529     C*****                Z-ADD0         DRCR
111670200529     C                     MOVE BACCY     CCY
111680200529     C                     Z-ADDBSEBRT    WPSTA
111690200529     C                     EXSR PLPR
111700200529     C                     END
111710200529     C*
111720200529     C           STRBRT    IFNE 0
111730200529     C                     MOVE STCY1     CCY
111740200529     C*
111750200529     C******               MOVE 'D'       RECI
111760200529     C******     RECI      CHAINSDBRTDD0             99    (99 = EOF)
111770200529     C   99      *LOCK     IN   LDA
111780200529     C***99                SETON                     U7LR  ** DB ERROR 98
111790200529     C***99                MOVEL'SDBRTDPD'DBFILE
111800200529     C***99                MOVELRECI      DBKEY
111810200529     C***99                Z-ADD98        DBASE
111820200529     C   99                OUT  LDA
111830200529     C***99                EXSR *PSSR
111840200529     C*
111850200529     C                     MOVE ACOD1     ACOD
111860200529     C/COPY WNCPYSRC,RE3664C215
111870200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
111880200529     C**********           MOVE WMPRFC    PRFC                     CAC001 130468
111890200529     C                     MOVE WSVPC     PRFC                            130468
111900200529     C                     ENDIF                                          CAC001
111910200529     C*******              MOVE 'P'       RECI
111920200529     C                     Z-SUBSTRBRT    WPSTA
111930200529     C*****                Z-ADD1         DRCR
111940200529     C                     EXSR PLPR
111950200529     C                     END
111960200529     C*
111970200529     C                     END
111980200529      *                                                                   130468
111990200529      * If alt. a/c restore the BICN, branch & ccy for the original a/c   130468
112000200529     C           CACP      IFNE *BLANKS                                   130468
112010200529     C                     MOVE @SBICN    BBICN                           130468
112020200529     C                     MOVE @SBRCA    BBRCA                           130468
112030200529     C                     MOVE @SCCY     BCCY                            130468
112040200529     C                     END                                            130468
112050200529     C*
112060200529     C                     ENDSR
112070200529     C**
112080200529     C********************************************************************
112090200529     C/EJECT
112100200529     C********************************************************************
112110200529     C**
112120200529     C**   CNVERT SR. TO CONVERT CURRENCY BRT AMOUNT
112130200529     C**
112140200529     C**
112150200529     C*****************************************************************
112160200529     C**
112170200529     C           CNVERT    BEGSR                           ** CNVERT SR **
112180200529     C*
112190200529     C*  SETUP 'FROM CURRENCY' VALUES
112200200529     C*
112210200529     C                     Z-ADDXAMNT1    XAMNT1 130
112220200529     C                     Z-ADDXAMNT3    XAMNT3 130
112230200529     C                     Z-ADDXSPOT1    XSPOT1 138
112240200529     C                     MOVELXMDIN1    XMDIN1  1
112250200529     C                     Z-ADDXCDP1     XCDP1   10
112260200529     C*
112270200529     C*  SETUP 'TO CURRENCY' VALUES
112280200529     C*
112290200529     C                     Z-ADDXAMNT2    XAMNT2 130
112300200529     C                     Z-ADDXAMNT4    XAMNT4 130
112310200529     C                     Z-ADDXSPOT2    XSPOT2 138
112320200529     C                     MOVELXMDIN2    XMDIN2  1
112330200529     C                     Z-ADDXCDP2     XCDP2   10
112340200529     C*
112350200529     C*
112360200529     C*  CALCULATE SCALING FACTOR (CDP DIFFERENCE)
112370200529     C*
112380200529     C           XCDP2     SUB  XCDP1     Z       10
112390200529     C                     ADD  4         Z
112400200529     C*
112410200529     C           XMDIN1    IFNE XMDIN2
112420200529     C           XSPOT1    MULT XSPOT2    XSPOT  138
112430200529     C                     END
112440200529     C*
112450200529     C           XMDIN1    IFEQ XMDIN2
112460200529     C           XSPOT1    DIV  XSPOT2    XSPOT  138
112470200529     C                     END
112480200529     C*
112490200529     C*
112500200529     C*  ADJUST CONVERSION RATE FOR NO. DECIMAL PLACES
112510200529     C*
112520200529     C           XMDIN1    IFEQ 'D'
112530200529     C           POWER,Z   DIV  XSPOT     XRATE  159
112540200529     C                     ELSE
112550200529     C           POWER,Z   MULT XSPOT     XRATE  159
112560200529     C                     END
112570200529     C*
112580200529     C*
112590200529     C*  CALCULATE NEW AMOUNT
112600200529     C*
112610200529     C           XAMNT1    MULT XRATE     XAMNT2    H
112620200529     C           XAMNT3    MULT XRATE     XAMNT4    H
112630200529     C                     ENDSR                           **CNVERT ENDSR*
112640200529     C**
112650200529     C********************************************************************
112660200529     C/EJECT
112670200529     C********************************************************************S01522
112680200529     C**  Subroutine SRPNAR determines the required narrative.          **S01522
112690200529     C********************************************************************S01522
112700200529     C           SRPNAR    BEGSR                           * S R P N A R *S01522
112710200529     C*                                                                   S01522
112720200529     C* Define the data structure parameter:                              S01522
112730200529     C*                                                                   S01522
112740200529     C           *LIKE     DEFN CGPNAR    ##PNAR                          S01522
112750200529     C*                                                                   S01522
112760200529     C* If the facility is switched off or unavailable,                   S01522
112770200529     C*  or UDC is not installed, exit this subroutine:                   S01522
112780200529     C*                                                                   S01522
112790200529     C           REPNAR    IFNE 'Y'                                       S01522
112800200529     C                     GOTO EXPNAR                                    S01522
112810200529     C                     ENDIF                                          S01522
112820200529     C*                                                                   S01522
112830200529     C* Determine the customer's name:                                    S01522
112840200529     C*                                                                   S01522
112850200529     C                     MOVELXCNUM     ##KEY     P                     S01522
112860200529     C*                                                                   S01522
112870200529     C                     CALL 'AOCUSTR0'                                S01522
112880200529     C                     PARM           ##RTN   7                       S01522
112890200529     C                     PARM '*KEY   ' ##OPT   7                       S01522
112900200529     C                     PARM           ##KEY  10                       S01522
112910200529     C                     PARM           ##STS   7                       S01522
112920200529     C           SDCUST    PARM SDCUST    DSSDY                           S01522
112930200529     C*                                                                   S01522
112940200529     C           ##RTN     IFNE *BLANKS                                   S01522
112950200529     C                     MOVEL'SDCUSTPD'DBFILE             *************S01522
112960200529     C***********          MOVEL'101'     DBASE        * DBERR 101 *S01522CRE002
112970200529     C                     Z-ADD108       DBASE              * DBERR 108 *CRE002
112980200529     C                     MOVEL##KEY     DBKEY              *************S01522
112990200529     C                     EXSR *PSSR                                     S01522
113000200529     C                     ENDIF                                          S01522
113010200529     C*...................................................................S01522
113020200529     C/EJECT                                                              S01522
113030200529     C*...................................................................S01522
113040200529     C* Determine the value for the narrative using AOPNARR0:             S01522
113050200529     C*                                                                   S01522
113060200529     C                     CLEARCGPNAR                                    S01522
113070200529     C                     CLEAR##PRM1                                    086125
113080200529     C                     MOVE 'RE'      MNMODI                          S01522
113090200529     C                     MOVE XBRCA     MNBRCA                          S01522
113100200529     C/COPY WNCPYSRC,REH00448
113110200529     C                     MOVE XCNUM     MNCUST                          S01522
113120200529     C/COPY WNCPYSRC,REH00449
113130200529     C                     MOVE XCCY      MNCYCD                          S01522
113140200529     C                     MOVE XACOD     MNACCD                          S01522
113150200529     C                     MOVE XACSQ     MNACSQ                          S01522
113160200529     C                     MOVE CRNM      MNCRNM                          S01522
113170200529     C                     MOVELPNAR      MNNARR    P                     S01522
113180200529     C                     MOVELASOC      MNASOC                          S01522
113190200529     C                     MOVELWACNO     MNRACN                          S01522
113200200529     C/COPY WNCPYSRC,REH00427
113210200529     C*                                                                   S01522
113220200529     C                     CALL 'AOPNARR0'                                S01522
113230200529     C                     PARM           ##RTN                           S01522
113240200529     C                     PARM           ##MGID  7                       S01522
113250200529     C                     PARM           ##PRM1                          086125
113260200529     C           CGPNAR    PARM CGPNAR    ##PNAR                          S01522
113270200529     C                     PARM           ##NARR 50                       S01522
113280200529     C/COPY WNCPYSRC,REH00428
113290200529     C*                                                                   S01522
113300200529     C           ##RTN     IFNE *BLANKS                                   S01522
113310200529     C                     MOVEL'CGPNARPD'DBFILE             *************S01522
113320200529     C***********          MOVEL'102'     DBASE        * DBERR 102 *S01522CRE002
113330200529     C                     Z-ADD109       DBASE              * DBERR 109 *CRE002
113340200529     C                     MOVELMNCUST    DBKEY              *************S01522
113350200529     C                     EXSR *PSSR                                     S01522
113360200529     C                     ENDIF                                          S01522
113370200529     C*                                                                   S01522
113380200529     C                     MOVEL##NARR    PNAR      P                     S01522
113390200529     C*                                                                   S01522
113400200529     C           EXPNAR    TAG                             < EXPNAR       S01522
113410200529     C*                                                                   S01522
113420200529     C                     ENDSR                                          S01522
113430200529     C********************************************************************S01522
113440200529     C/EJECT
113450200529     C********************************************************************
113460200529     C           ZA0900    BEGSR
113470200529     C*
113480200529     C           @@RAT1    IFEQ *ZERO
113490200529     C                     Z-ADD1         @@RAT1
113500200529     C                     END
113510200529     C*
113520200529     C           @@RAT2    IFEQ *ZERO
113530200529     C                     Z-ADD1         @@RAT2
113540200529     C                     END
113550200529     C*
113560200529     C** IF THE FIRST RATE M/D INDICATOR IS '1' MULTIPLY, ELSE DIVIDE
113570200529     C*
113580200529     C           @@MDI1    IFEQ 'M'
113590200529     C                     Z-ADD@@RAT1    @@CSRT 138
113600200529     C                     ELSE
113610200529     C           1         DIV  @@RAT1    @@CSRT    H
113620200529     C                     END
113630200529     C*
113640200529     C** IF THE SECOND RATE M/D INDICATOR IS '0' MULTIPLY, ELSE DIVIDE
113650200529     C*
113660200529     C           @@MDI2    IFEQ 'D'
113670200529     C           @@CSRT    MULT @@RAT2    @@CSRT
113680200529     C                     ELSE
113690200529     C           @@CSRT    DIV  @@RAT2    @@CSRT    H
113700200529     C                     END
113710200529     C*
113720200529     C** SET FIRST CCY MULTIPLY/DIVIDE *IN TO MULTIPLY
113730200529     C*
113740200529     C                     MOVE 'M'       @@FCMD  1
113750200529     C*
113760200529     C                     ENDSR                           **ZA0900 ENDSR*
113770200529     C********************************************************************
113780200529     C/EJECT
113790200529     C********************************************************************
113800200529     C*
113810200529     C*                 ACDCHN SUBROUTINE
113820200529     C*
113830200529     C*  SUBR TO PICK UP ACCOUNT CODE DETAILS FOR POSTINGS
113840200529     C*
113850200529      *****************************************************************   CCB003
113860200529     C           ACDCHN    BEGSR
113870200529     C*
113880200529     C*  ACCESS SDACODPD USING PASSED ACCOUNT CODE
113890200529     C*
113900200529     C                     ADD  1         RCSQ                                              CRE083BK
113910200529     C                     MOVE ACODA     KEYACD                                            CRE083BK
113920200529     C                     Z-ADD110       WDBASE                                            CRE083BK
113930200529     C                     EXSR ACDCCH                                                      CRE083BK
113940200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
113950200529     C**********           PARM '*MSG   ' @RTCD   7                                         CRE083BK
113960200529     C**********           PARM '*KEY   ' @OPTN   7                                         CRE083BK
113970200529     C**********           PARM ACODA     @AFNB   4                                           CGL029
113980200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
113990200529     C**********           PARM ACODA     @AFNB  10                                  CGL029 CRE083BK
114000200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
114010200529     C****************************************************************                      CRE083BK
114020200529     C*****IF*-*NOT*A*VALID*RECORD************************************                      CRE083BK
114030200529     C****************************************************************                      CRE083BK
114040200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
114050200529     C********** *LOCK     IN   LDA                                                         CRE083BK
114060200529     C***********          Z-ADD5         DBASE                           CRE002
114070200529     C**********           Z-ADD110       DBASE                                      CRE002 CRE083BK
114080200529     C**********           MOVEL'SDACODPD'DBFILE           * DBERR 110*              CRE002 CRE083BK
114090200529     C***********          MOVEL'SDACODPD'DBFILE           * DBERR 05 *   CRE002
114100200529     C**********           MOVEL@AFNB     DBKEY                                             CRE083BK
114110200529     C**********           OUT  LDA                                                         CRE083BK
114120200529     C**********           SETON                     U7U8LR                                 CRE083BK
114130200529     C**********           EXSR *PSSR                                                       CRE083BK
114140200529     C**********           END                                                              CRE083BK
114150200529     C*
114160200529     C                     ENDSR                           **ACDCHN ENDSR*
114170200529     C********************************************************************
114180200529     C/EJECT
114190200529     C********************************************************************
114200200529     C**
114210200529     C** TOTAL subroutine to execute end processing.
114220200529     C**
114230200529     C**     Called by       S T A R T
114240200529     C**     Calls           -
114250200529     C**
114260200529      *****************************************************************   CCB003
114270200529     C           TOTAL     BEGSR                           **TOTAL BEGSR**
114280200529     C*
114290200529     C***ACCESS*GEICZZ*TO*UPDATE*OR*CREATE                                CCB003
114300200529     C** ACCESS REINTCPA TO UPDATE OR CREATE                              CCB003
114310200529     C*
114320200529     C***********          OPEN GEICZZ                                    CCB003
114330200529     C***********          READ GEICZZ                   99               CCB003
114340200529     C                     OPEN REINTCPA                                  CCB003
114350200529     C                     READ REINTCPA                 99               CCB003
114360200529     C                     Z-ADD*ZEROS    DBASE
114370200529     C           *IN99     IFEQ '1'                        - B1
114380200529     C***********WNORE     ADD  2         NORE1                           CCB003
114390200529     C                     Z-ADDWNORE     NORE1                           CCB003
114400200529     C/COPY WNCPYSRC,RE3664C033
114410200529     C                     Z-ADDZZTOTD    HRDC
114420200529     C                     Z-ADDZZTOTI    HRWN
114430200529     C/COPY WNCPYSRC,RE3664C034
114440200529     C                     MOVE 'T'       RECI
114450200529     C                     WRITEAPOSTZZF
114460200529     C                     ELSE                            - X1
114470200529     C                     ADD  WNORE     NORE1
114480200529     C                     Z-ADDHRDC      ZZAMTD
114490200529     C                     Z-ADDHRWN      ZZAMTI
114500200529     C/COPY WNCPYSRC,RE3664C035
114510200529     C                     EXSR GLZSUM
114520200529     C                     Z-ADDZZTOTD    HRDC
114530200529     C                     Z-ADDZZTOTI    HRWN
114540200529     C***********          Z-ADD79        DBASE                           CRE002
114550200529     C                     Z-ADD111       DBASE            * DB ERROR 111*CRE002
114560200529     C                     UPDATAPOSTZZF
114570200529     C                     Z-ADD*ZEROS    DBASE
114580200529     C                     END                             - E1
114590200529     C                     Z-ADD*ZERO     WNORE
114600200529     C                     Z-ADD*ZERO     ZZTOTI
114610200529     C                     Z-ADD*ZERO     ZZTOTD
114620200529     C/COPY WNCPYSRC,RE3664C036
114630200529     C***********          Z-ADD80        DBASE                           CRE002
114640200529     C                     Z-ADD112       DBASE            * DB ERROR 112*CRE002
114650200529     C***********          CLOSEGEICZZ                                    CCB003
114660200529     C                     CLOSEREINTCPA                                  CCB003
114670200529     C                     Z-ADD*ZEROS    DBASE
114680200529     C*
114690200529     C/COPY WNCPYSRC,RE3664C037
114700200529     C***OUTPUT*AUDIT DETAIL                                              CCB003
114710200529     C***********                                                         CCB003
114720200529     C************INLR     IFEQ '1'                                       CCB003
114730200529     C***********          WRITETOTALS                                    CCB003
114740200529     C***********                                                         CCB003
114750200529     C***OUTPUT*AUDIT END                                                 CCB003
114760200529     C***********                                                         CCB003
114770200529     C***********          END                                            CCB003
114780200529     C*
114790200529     C                     ENDSR                           **TOTAL ENDSR**
114800200529     C********************************************************************
114810200529     C/EJECT
114820200529     C********************************************************************
114830200529     C**
114840200529     C** TOTTAX subroutine
114850200529     C*
114860200529     C**     Called by       TOTAC
114870200529     C**     Calls           -
114880200529     C*
114890200529      *****************************************************************   CCB003
114900200529     C           TOTTAX    BEGSR
114910200529     C*
114920200529     C** CAPITALISATION CREDIT TODAY
114930200529     C*
114940200529     C           BCICI     IFEQ 'Y'
114950200529     C           BCICI     OREQ 'D'
114960200529     C           BCICI     OREQ 'C'
114970200529     C*
114980200529     C** WITHHOLDING TAX ON GROSS AMOUNT
114990200529     C*
115000200529     C           TXWNDI    IFNE 'Y'
115010200529     C                     Z-ADDWCIWT     WTIWT
115020200529     C*
115030200529     C** RESET DEBIT INTEREST CUMULATOR
115040200529     C*
115050200529     C                     Z-ADD*ZERO     DINW
115060200529     C*
115070200529     C           TXWNDI    IFEQ 'S'
115080200529     C                     SUB  WDIWT     WTIWT
115090200529     C                     END
115100200529     C*
115110200529     C** WITHHOLDING TAX ON NET AMOUNT
115120200529     C*
115130200529     C                     ELSE
115140200529     C*
115150200529     C           WCIWT     SUB  DINW      WTIWT
115160200529     C/COPY WNCPYSRC,REH00434
115170200529     C*
115180200529     C** INTEREST DEBIT CUMULATOR FOR NEW PERIOD
115190200529     C*
115200200529     C                     Z-ADDWDIWT     DINW
115210200529     C*
115220200529     C** DEBIT CAPITALISATION INCLUDED IN CREDIT PERIOD
115230200529     C*
115240200529     C           BDICI     IFEQ 'Y'
115250200529     C           BDICI     OREQ 'D'
115260200529     C           BDICI     OREQ 'C'
115270200529     C           LDID      ANDLELCID
115280200529     C                     SUB  WDIWT     WTIWT
115290200529     C                     Z-ADD*ZERO     DINW
115300200529     C*
115310200529     C                     END
115320200529     C                     END
115330200529     C*
115340200529     C** PROCESS TAX CALCULATION
115350200529     C*
115360200529     C/COPY WNCPYSRC,RE3664C069
115370200529     C                     Z-ADD0         CINW                                              AR813717
115380200529     C           WCSIN     IFEQ 'N'                                                         AR813717
115390200529     C                     EXSR TAXPOS
115400200529     C                     ENDIF                                                            AR813717
115410200529     C/COPY WNCPYSRC,RE3664C070
115420200529     C*
115430200529     C                     ELSE
115440200529     C*
115450200529     C** DEBIT CAPITALISATION ONLY
115460200529     C*
115470200529     C           BDICI     IFEQ 'Y'
115480200529     C           BDICI     OREQ 'D'
115490200529     C           BDICI     OREQ 'C'
115500200529     C*
115510200529     C** DEBIT INTEREST CUMULATOR
115520200529     C*
115530200529     C                     ADD  WDIWT     DINW
115540200529     C*
115550200529     C                     END
115560200529     C                     END
115570200529     C*
115580200529     C                     ENDSR                           **TOTAX ENDSR**
115590200529     C********************************************************************
115600200529     C/EJECT
115610200529     C********************************************************************
115620200529     C*
115630200529     C** TAXPOS subroutine
115640200529     C*
115650200529     C**     Called by       - TOTTAX
115660200529     C**     Calls           -
115670200529     C*
115680200529      *****************************************************************   CCB003
115690200529     C           TAXPOS    BEGSR
115700200529      **Save*history balance*******************************************               135809 135809R
115710200529     C**********           Z-ADDHISB      @RHISB                                      135809 135809R
115720200529      * Save history balance                                                                AR978914
115730200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
115740200529     C                     Z-ADDHISB      @RHISB                                            AR978914
115750200529     C                     ENDIF                                                            MD045460
115760200529     C*
115770200529     C** INITIALIZE TOTAL FIELD
115780200529     C*
115790200529     C                     Z-ADD*ZERO     BCINW
115800200529     C*
115810200529     C** PROCESS ONLY IF TOTAL INTEREST IS CREDIT
115820200529     C*
115830200529     C/COPY WNCPYSRC,RE3664C189
115840200529      *                                                                                     MD040758
115850200529     C                     MOVE ' '       ADJUST                                            MD040758
115860200529     C           SHISD     IFLT CNCID                                                       MD040758
115870200529     C           CDL013    ANDEQ'1'                                                         MD040758
115880200529     C                     MOVE 'Y'       ADJUST                                            MD040758
115890200529     C                     ENDIF                                                            MD040758
115900200529      *                                                                                     MD040758
115910200529      ** The WTIWT should be postive for interest adjustment.                               MD040758
115920200529      *                                                                                     MD040758
115930200529     C           WTIWT     IFLT *ZERO                                                       MD040758
115940200529     C           ADJUST    ANDEQ'Y'                                                         MD040758
115950200529     C                     Z-SUBWTIWT     WTIWT                                             MD040758
115960200529     C                     ENDIF                                                            MD040758
115970200529      *                                                                                     MD040758
115980200529     C           WTIWT     IFLT *ZERO                      * B1
115990200529     C                     Z-ADD*ZERO     WTIWT            *
116000200529     C                     END                             * E1
116010200529     C/COPY WNCPYSRC,RE3664C190
116020200529     C*
116030200529     C           WTIWT     IFGT *ZERO                      * B1
116040200529     C/COPY WNCPYSRC,REH00435
116050200529     C*                                                    *
116060200529     C** CALCULATE THE TAX AMOUNT IN ACCOUNT CURRENCY      *
116070200529     C*                                                    *
116080200529      *                                                                                       CDL013
116090200529      ** If CDL013 installed, calculate WHT amount                                            CDL013
116100200529     C           CDL013    IFEQ '1'                                                           CDL013
116110200529      *                                                                                       CDL013
116120200529      ** Access account details extension file                                                CDL013
116130200529     C           ACKEY1    CHAINACCNTBY0             40                                       CDL013
116140200529      *                                                                                       CDL013
116150200529      ** If CHAIN failed, terminate the program                                               CDL013
116160200529     C           *IN40     IFEQ '1'                                                           CDL013
116170200529     C           *LOCK     IN   LDA                                                           CDL013
116180200529     C                     MOVEL'ACCNTBY0'DBFILE           ************                       CDL013
116190200529     C                     MOVELAKEY      DBKEY            * DBERR 143*                       CDL013
116200200529     C                     Z-ADD143       DBASE            ************                       CDL013
116210200529     C                     OUT  LDA                                                           CDL013
116220200529     C                     EXSR *PSSR                                                         CDL013
116230200529     C                     ENDIF                                                              CDL013
116240200529     C/COPY WNCPYSRC,REH00015
116250200529      *                                                                                       CDL013
116260200529      ** Set WHT rate                                                                         CDL013
116270200529     C                     SELEC                                                              CDL013
116280200529     C           ATITAX    WHEQ '0'                                                           CDL013
116290200529     C                     Z-ADD0         WRATE   52                                          CDL013
116300200529     C           ATITAX    WHEQ '1'                                                           CDL013
116310200529     C                     Z-ADDETXR1     WRATE                                               CDL013
116320200529     C           ATITAX    WHEQ '2'                                                           CDL013
116330200529     C                     Z-ADDETXR2     WRATE                                               CDL013
116340200529     C           ATITAX    WHEQ '3'                                                           CDL013
116350200529     C                     Z-ADDETXR3     WRATE                                               CDL013
116360200529     C           ATITAX    WHEQ '4'                                                           CDL013
116370200529     C                     Z-ADDETXR4     WRATE                                               CDL013
116380200529     C           ATITAX    WHEQ '5'                                                           CDL013
116390200529     C                     Z-ADDETXR5     WRATE                                               CDL013
116400200529     C           ATITAX    WHEQ '6'                                                           CDL013
116410200529     C                     Z-ADDETXR6     WRATE                                               CDL013
116420200529     C           ATITAX    WHEQ '7'                                                           CDL013
116430200529     C                     Z-ADDETXR7     WRATE                                               CDL013
116440200529     C           ATITAX    WHEQ '8'                                                           CDL013
116450200529     C                     Z-ADDETXR8     WRATE                                               CDL013
116460200529     C           ATITAX    WHEQ '9'                                                           CDL013
116470200529     C                     Z-ADDETXR9     WRATE                                               CDL013
116480200529     C                     ENDSL                                                              CDL013
116490200529     C/COPY WNCPYSRC,REH00016
116500200529      *                                                                                       CDL013
116510200529      ** If WHT rate is 0, set Tax amount to 0                                                CDL013
116520200529     C           WRATE     IFEQ 0                                                             CDL013
116530200529     C                     Z-ADD0         CINW                                                CDL013
116540200529      *                                                                                       CDL013
116550200529      ** Otherwise, calculate WHT                                                             CDL013
116560200529     C                     ELSE                                                               CDL013
116570200529      *                                                                                       CDL013
116580200529      ** If Ccy is equal to Base Ccy                                                          CDL013
116590200529      ** and CDL081 is off                                                                    CDL081
116600200529      *                                                                                       CDL081
116610200529     C           BCCY      IFEQ BACCY                                                         CDL013
116620200529     C           CDL081    ANDEQ'N'                                                           CDL081
116630200529      *                                                                                       CDL013
116640200529      ** Set work adjustment field according to decimal places.                               CDL013
116650200529     C           *IN80     IFEQ '1'                                                           CDL013
116660200529     C                     Z-ADD1         WADJ    40                                          CDL013
116670200529     C                     ENDIF                                                              CDL013
116680200529     C           *IN81     IFEQ '1'                                                           CDL013
116690200529     C                     Z-ADD10        WADJ                                                CDL013
116700200529     C                     ENDIF                                                              CDL013
116710200529     C           *IN82     IFEQ '1'                                                           CDL013
116720200529     C                     Z-ADD100       WADJ                                                CDL013
116730200529     C                     ENDIF                                                              CDL013
116740200529     C           *IN83     IFEQ '1'                                                           CDL013
116750200529     C                     Z-ADD1000      WADJ                                                CDL013
116760200529     C                     ENDIF                                                              CDL013
116770200529     C/COPY WNCPYSRC,REH00024
116780200529      *                                                                                       CDL013
116790200529      ** Round down Interest amount                                                           CDL013
116800200529     C           WTIWT     DIV  WADJ      BWTIWT 130                                          CDL013
116810200529     C                     MULT WADJ      BWTIWT                                              CDL013
116820200529     C/COPY WNCPYSRC,REH00025
116830200529      *                                                                                       CDL013
116840200529      ** Calculate WHT                                                                        CDL013
116850200529     C           BWTIWT    MULT WRATE     CINW                                                CDL013
116860200529     C                     DIV  100       CINW                                                CDL013
116870200529     C/COPY WNCPYSRC,REH00017
116880200529      *                                                                                       CDL013
116890200529      ** Round down WHT                                                                       CDL013
116900200529     C                     DIV  WADJ      CINW                                                CDL013
116910200529     C                     MULT WADJ      CINW                                                CDL013
116920200529     C/COPY WNCPYSRC,REH00018
116930200529      *                                                                                       CDL013
116940200529      ** If Ccy is NOT equal to Base Ccy                                                      CDL013
116950200529     C                     ELSE                                                               CDL013
116960200529      *                                                                                       CDL013
116970200529      ** Calculate WHT without rounding down.                                                 CDL013
116980200529     C           WTIWT     MULT WRATE     CINW                                                CDL013
116990200529      *                                                                                       CDL081
117000200529      ** Check if tax amount is to be rounded down                                            CDL081
117010200529      *                                                                                       CDL081
117020200529     C           BCCY      IFEQ BACCY                                                         CDL081
117030200529     C           CDL081    ANDEQ'Y'                                                           CDL081
117040200529     C           W#BSRD    ANDEQ'Y'                                                           CDL081
117050200529     C           BCCY      ORNE BACCY                                                         CDL081
117060200529     C           CDL081    ANDEQ'Y'                                                           CDL081
117070200529     C           W#NBRD    ANDEQ'Y'                                                           CDL081
117080200529     C                     DIV  100       CINW                                                CDL081
117090200529     C                     ELSE                                                               CDL081
117100200529     C                     DIV  100       CINW      H                                         CDL013
117110200529     C                     ENDIF                                                              CDL081
117120200529      *                                                                                       CDL013
117130200529     C                     ENDIF                                                              CDL013
117140200529      *                                                                                       CDL013
117150200529     C                     ENDIF                                                              CDL013
117160200529      *                                                                                       CDL013
117170200529     C/COPY WNCPYSRC,REH00147
117180200529      *                                                                                       CDL013
117190200529      ** If CDL013 NOT installed                                                              CDL013
117200200529     C                     ELSE                                                               CDL013
117210200529     C/COPY WNCPYSRC,RE3664CP19                                           S01408
117220200529     C*                                                                   S01408
117230200529     C           CGL165    IFEQ 'Y'                                                           CGL165
117240200529     C*                                                                                       CGL165
117250200529      * Zeroise Secondary Tax Amount, Secondary Tax Amount in Base CCY                        CGL165
117260200529      * and Main and Secondary Tax Amounts in Local CCY                                       CGL165
117270200529     C                     Z-ADD*ZERO     CINS   150                                          CGL165
117280200529     C                     Z-ADD*ZERO     BCINS  150                                          CGL165
117290200529     C                     Z-ADD*ZERO     LCINS  150                                          CGL165
117300200529     C                     Z-ADD*ZERO     LCINW  150                                          CGL165
117310200529      *                                                                                       CGL165
117320200529     C                     Z-ADDWTIWT     PINTA                                               CGL165
117330200529     C                     MOVELAACNO     PACNO                                               CGL165
117340200529     C**********           MOVELACOD      PACOD                                      CGL165 MD034383
117350200529     C                     MOVELAACOD     PACOD                                             MD034383
117360200529      *                                                                                       CGL165
117370200529     C                     CALL 'GL024000'                                                    CGL165
117380200529     C                     PARM           PRCOD1  1                                           CGL165
117390200529     C                     PARM 'RE3664'  PCPGM   6                                           CGL165
117400200529     C**********           PARM BRCA      PBRCA   3                                  CGL165 MD034383
117410200529     C**********           PARM CNUM      PCUST   6                                  CGL165 MD034383
117420200529     C                     PARM ABRCA     PBRCA   3                                         MD034383
117430200529     C                     PARM ACCNUM    PCUST   6                                         MD034383
117440200529     C                     PARM           PACNO  10                                           CGL165
117450200529     C                     PARM CCY       PCCY    3                                           CGL165
117460200529     C                     PARM           PINTA  150                                          CGL165
117470200529     C                     PARM ATTXC1    PTXC1   2                                           CGL165
117480200529     C                     PARM ATTXC2    PTXC2   2                                           CGL165
117490200529     C                     PARM *ZEROS    PCPDT   50                                          CGL165
117500200529     C                     PARM *ZEROS    PVDAT   50                                          CGL165
117510200529     C                     PARM *ZEROS    PMDAT   50                                          CGL165
117520200529     C                     PARM *ZEROS    PINTR  117                                          CGL165
117530200529     C                     PARM *BLANKS   PDTYP   2                                           CGL165
117540200529     C                     PARM *ZEROS    PPCPL  150                                          CGL165
117550200529     C                     PARM           PACOD  10                                           CGL165
117560200529     C                     PARM AACSQ     PACSQ   20                                          CGL165
117570200529     C                     PARM           PWTXA  150                                          CGL165
117580200529     C                     PARM           PSTXA  150                                          CGL165
117590200529      *                                                                                       CGL165
117600200529     C                     Z-ADDPWTXA     CINW                                                CGL165
117610200529     C                     Z-ADDPSTXA     CINS                                                CGL165
117620200529      *                                                                                       CGL165
117630200529     C                     ELSE                                                               CGL165
117640200529      *                                                                                       CGL165
117650200529     C           WTIWT     MULT TXWTRR    CINW             *
117660200529     C           CINW      DIV  100       CINW      H      *
117670200529      *                                                                                       CDL013
117680200529     C/COPY WNCPYSRC,REH00458
117690200529     C                     ENDIF                                                              CGL165
117700200529     C                     ENDIF                                                              CDL013
117710200529     C*                                                    *
117720200529     C/COPY WNCPYSRC,RE3664CP20                                           S01408
117730200529     C*                                                                   S01408
117740200529     C** CALCULATE THE TAX AMOUNT IN BASE CURRENCY         *
117750200529     C*                                                    *
117760200529     C           BCCY      IFEQ BACCY                      ** B2
117770200529     C                     Z-ADDCINW      BCINW            **
117780200529     C/COPY WNCPYSRC,REH00436
117790200529     C*                                                    **
117800200529     C                     ELSE                            ** X2
117810200529     C*                                                    **
117820200529     C** CALCULATE THE BCCY EQUIVALENT ONLY IF DIFFERENT CURRENCY
117830200529     C*                                                    **
117840200529     C                     MOVE BCCY      ZCCYI            **
117850200529     C                     Z-ADDWOSPOT    ZRATEF           **
117860200529     C           CGL165    IFEQ 'Y'                                                           CGL165
117870200529     C                     Z-ADDWOTXCR    ZRATEF                                              CGL165
117880200529     C                     ENDIF                                                              CGL165
117890200529     C/COPY WNCPYSRC,REH00148
117900200529     C                     MOVE WOCDP     ZCDPI            **
117910200529     C                     MOVE WOMDIN    ZMDINF           **
117920200529     C                     MOVE BACCY     ZCCYO            **
117930200529     C                     Z-ADDWBSPOT    ZRATET           **
117940200529      *                                                                                       CGL165
117950200529      * If CGL165 is On, use Tax Conversion Rate                                              CGL165
117960200529     C           CGL165    IFEQ 'Y'                                                           CGL165
117970200529     C                     Z-ADDWBTXCR    ZRATET                                              CGL165
117980200529     C                     ENDIF                                                              CGL165
117990200529     C/COPY WNCPYSRC,REH00151
118000200529     C                     MOVE WBCDP     ZCDPO            **
118010200529     C                     MOVE WBMDIN    ZMDINT           **
118020200529     C                     Z-ADDCINW      ZAMTCI           **
118030200529      *                                                                                       CDL081
118040200529      ** Set withholding tax conversion flag                                                  CDL081
118050200529      *                                                                                       CDL081
118060200529     C                     MOVE 'Y'       @WHTF   1                                           CDL081
118070200529     C*                                                    **
118080200529     C                     EXSR #CCYCN                     **
118090200529      *                                                                                       CDL081
118100200529     C                     MOVE *BLANK    @WHTF                                               CDL081
118110200529     C*                                                    **
118120200529     C                     Z-ADDZAMTCO    BCINW            **
118130200529     C/COPY WNCPYSRC,REH00437
118140200529     C*                                                    **
118150200529     C                     END                             ** E2
118160200529     C           CGL165    IFEQ 'Y'                        ** B2                              CGL165
118170200529     C** CALCULATE THE SECONDARY TAX AMOUNT IN BASE CURRENCY         *                        CGL165
118180200529     C*                                                    *                                  CGL165
118190200529     C           BCCY      IFEQ BACCY                      ** B3                              CGL165
118200200529     C                     Z-ADDCINS      BCINS            **                                 CGL165
118210200529     C/COPY WNCPYSRC,REH00436                                                                 CGL165
118220200529     C*                                                    **                                 CGL165
118230200529     C                     ELSE                            ** X3                              CGL165
118240200529     C*                                                    **                                 CGL165
118250200529     C** CALCULATE THE BCCY EQUIVALENT ONLY IF DIFFERENT CURRENCY                             CGL165
118260200529     C*                                                    **                                 CGL165
118270200529     C                     MOVE BCCY      ZCCYI            **                                 CGL165
118280200529     C                     Z-ADDWOSPOT    ZRATEF           **                                 CGL165
118290200529     C                     Z-ADDWOTXCR    ZRATEF                                              CGL165
118300200529     C                     MOVE WOCDP     ZCDPI            **                                 CGL165
118310200529     C                     MOVE WOMDIN    ZMDINF           **                                 CGL165
118320200529     C                     MOVE BACCY     ZCCYO            **                                 CGL165
118330200529     C                     Z-ADDWBTXCR    ZRATET           **                                 CGL165
118340200529     C                     MOVE WBCDP     ZCDPO            **                                 CGL165
118350200529     C                     MOVE WBMDIN    ZMDINT           **                                 CGL165
118360200529     C                     Z-ADDCINS      ZAMTCI           **                                 CGL165
118370200529      *                                                                                       CGL165
118380200529      ** Set withholding tax conversion flag                                                  CGL165
118390200529      *                                                                                       CGL165
118400200529     C                     MOVE 'Y'       @WHTF   1                                           CGL165
118410200529     C*                                                    **                                 CGL165
118420200529     C                     EXSR #CCYCN                     **                                 CGL165
118430200529      *                                                                                       CGL165
118440200529     C                     MOVE *BLANK    @WHTF                                               CGL165
118450200529     C*                                                    **                                 CGL165
118460200529     C                     Z-ADDZAMTCO    BCINS            **                                 CGL165
118470200529     C*                                                    **                                 CGL165
118480200529     C                     END                             ** E3                              CGL165
118490200529     C                     END                             ** E2                              CGL165
118500200529      *                                                                                       CGL165
118510200529      * If A/C Currency is Local Currency set Local Amount = A/C CCY                          CGL165
118520200529      * Amount,                                                                               CGL165
118530200529     C           CGL165    IFEQ 'Y'                                                           CGL165
118540200529     C           BCCY      ANDEQBJLCCY                                                        CGL165
118550200529     C                     Z-ADDCINW      LCINW                                               CGL165
118560200529     C                     Z-ADDCINS      LCINS                                               CGL165
118570200529     C                     ENDIF                                                              CGL165
118580200529      *                                                                                       CGL165
118590200529      * If CGL165 is On, also need the Tax Amounts in Local Currency                          CGL165
118600200529      * if Account CCY <> Local CCY                                                           CGL165
118610200529     C           CGL165    IFEQ 'Y'                                                           CGL165
118620200529     C           BCCY      ANDNEBJLCCY                                                        CGL165
118630200529      *                                                                                       CGL165
118640200529      * If Base Currency is Local Currency set Local Amount = Base                            CGL165
118650200529      * Amount, else convert Base Currency Amount to Local Currency                           CGL165
118660200529     C           BJLCCY    IFEQ BACCY                                                         CGL165
118670200529     C                     Z-ADDBCINW     LCINW                                               CGL165
118680200529     C                     Z-ADDBCINS     LCINS                                               CGL165
118690200529     C                     ELSE                                                               CGL165
118700200529      *                                                                                       CGL165
118710200529      * Convert Main Tax                                                                      CGL165
118720200529     C                     MOVE BACCY     ZCCYI            **                                 CGL165
118730200529     C                     Z-ADDWBTXCR    ZRATEF           **                                 CGL165
118740200529     C                     MOVE WBCDP     ZCDPI            **                                 CGL165
118750200529     C                     MOVE WBMDIN    ZMDINF           **                                 CGL165
118760200529     C                     MOVE BJLCCY    ZCCYO            **                                 CGL165
118770200529     C                     Z-ADDWLTXCR    ZRATET           **                                 CGL165
118780200529     C                     MOVE WLCDP     ZCDPO            **                                 CGL165
118790200529     C                     MOVE WLMDIN    ZMDINT           **                                 CGL165
118800200529     C                     Z-ADDBCINW     ZAMTCI           **                                 CGL165
118810200529      *                                                                                       CGL165
118820200529      ** Set withholding tax conversion flag                                                  CGL165
118830200529      *                                                                                       CGL165
118840200529     C                     MOVE 'Y'       @WHTF   1                                           CGL165
118850200529     C*                                                    **                                 CGL165
118860200529     C                     EXSR #CCYCN                     **                                 CGL165
118870200529      *                                                                                       CGL165
118880200529     C                     MOVE *BLANK    @WHTF                                               CGL165
118890200529     C*                                                    **                                 CGL165
118900200529     C                     Z-ADDZAMTCO    LCINW            **                                 CGL165
118910200529      * Convert Secondary Tax                                                                 CGL165
118920200529     C                     MOVE BACCY     ZCCYI            **                                 CGL165
118930200529     C                     Z-ADDWBTXCR    ZRATEF           **                                 CGL165
118940200529     C                     MOVE WBCDP     ZCDPI            **                                 CGL165
118950200529     C                     MOVE WBMDIN    ZMDINF           **                                 CGL165
118960200529     C                     MOVE BJLCCY    ZCCYO            **                                 CGL165
118970200529     C                     Z-ADDWLTXCR    ZRATET           **                                 CGL165
118980200529     C                     MOVE WLCDP     ZCDPO            **                                 CGL165
118990200529     C                     MOVE WLMDIN    ZMDINT           **                                 CGL165
119000200529     C                     Z-ADDBCINS     ZAMTCI           **                                 CGL165
119010200529      *                                                                                       CGL165
119020200529      ** Set withholding tax conversion flag                                                  CGL165
119030200529      *                                                                                       CGL165
119040200529     C                     MOVE 'Y'       @WHTF   1                                           CGL165
119050200529     C*                                                    **                                 CGL165
119060200529     C                     EXSR #CCYCN                     **                                 CGL165
119070200529      *                                                                                       CGL165
119080200529     C                     MOVE *BLANK    @WHTF                                               CGL165
119090200529     C*                                                    **                                 CGL165
119100200529     C                     Z-ADDZAMTCO    LCINS            **                                 CGL165
119110200529     C                     ENDIF                                                              CGL165
119120200529      *                                                                                       CGL165
119130200529     C                     ENDIF                                                              CGL165
119140200529      *                                                                                       CGL165
119150200529     C*                                                    *
119160200529     C** IF BELOW MINIMUM NO TAX TO BE POSTED              *
119170200529     C*                                                    *
119180200529     C/COPY WNCPYSRC,RE3664CP21                                           S01408
119190200529     C*                                                                   S01408
119200200529      *                                                                                       CDL013
119210200529      ** If CDL013 installed, calculate Minimum WHT to be posted                              CDL013
119220200529     C           CDL013    IFEQ '1'                                                           CDL013
119230200529     C           ATITAX    ANDNE'0'                                                           CDL013
119240200529      *                                                                                       CDL013
119250200529      ** Calculate Minimum WHT                                                                CDL013
119260200529     C           WMISU     MULT WRATE     WKMISU                                              CDL013
119270200529      *                                                                                       CDL081
119280200529      ** Check if tax amount is to be rounded down                                            CDL081
119290200529      *                                                                                       CDL081
119300200529     C           BCCY      IFEQ BACCY                                                         CDL081
119310200529     C           CDL081    ANDEQ'Y'                                                           CDL081
119320200529     C           W#BSRD    ANDEQ'Y'                                                           CDL081
119330200529     C                     DIV  100       WKMISU                                              CDL081
119340200529     C                     ELSE                                                               CDL081
119350200529     C                     DIV  100       WKMISU    H                                         CDL013
119360200529     C                     ENDIF                                                              CDL081
119370200529     C/COPY WNCPYSRC,REH00019
119380200529      *                                                                                       CDL013
119390200529      ** If CDL013 NOT installed                                                              CDL013
119400200529     C                     ELSE                                                               CDL013
119410200529     C           WMISU     MULT TXWTRR    WKMISU 150       **
119420200529     C           WKMISU    DIV  100       WKMISU    H      **             091906
119430200529     C***********WMISU     DIV  100       WKMISU    H      **             091906
119440200529      *                                                                                       CDL013
119450200529     C                     ENDIF                                                              CDL013
119460200529     C*                                                    *
119470200529     C/COPY WNCPYSRC,RE3664CP22                                           S01408
119480200529     C*                                                                   S01408
119490200529     C           BCINW     IFLT WKMISU                     **
119500200529     C                     Z-ADD*ZERO     BCINW            **
119510200529     C                     Z-ADD*ZERO     WTIWT            **
119520200529     C                     Z-ADD*ZERO     CINW             **
119530200529     C*                                                    **
119540200529     C                     END                             ** E2
119550200529     C/COPY WNCPYSRC,RE3664C191
119560200529     C                     END                             * E1
119570200529     C/COPY WNCPYSRC,REH00438
119580200529     C/COPY OFCPYSRCZ,CRE105_011                                                              CRE105
119590200529     C*
119600200529     C** TILL NOW TAX IS TO BE POSTED
119610200529     C*
119620200529     C********** BCINW     IFGT *ZERO                      * B1           135809
119630200529     C********** BCINW     IFGT *ZERO                                               135809R AR978914
119640200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
119650200529     C*                                                    *
119660200529     C** CHECK FOR ALTERNATE ACCOUNT                       *
119670200529     C*                                                    *
119680200529      **If*alt.*a/c*and*CR*interest*for*this*cap.,*transfer*net********************   135809 135809R
119690200529      **interest*to*alt.*a/c.******************************************************   135809 135809R
119700200529      * If alt. a/c and CR interest for this cap., transfer net                             AR978914
119710200529      * interest to alt. a/c.                                                               AR978914
119720200529      *                                                                                     MD040758
119730200529     C           @CRINT    IFLT *ZERO                                                       MD040758
119740200529     C           ADJUST    ANDEQ'Y'                                                         MD040758
119750200529     C                     Z-SUB@CRINT    @CRINT                                            MD040758
119760200529     C                     ENDIF                                                            MD040758
119770200529      *                                                                                     MD040758
119780200529     C           CACP      IFNE *BLANKS                    ** B2
119790200529     C********** @CRINT    ANDNE*ZERO                                                 135809 135809R
119800200529     C********** @CRINT    SUB  CINW      @CRNET                                      135809 135809R
119810200529     C********** @CRNET    IFGT *ZERO                                                 135809 135809R
119820200529      **Debit*main*a/c*with*net*interest*******************************************   135809 135809R
119830200529     C**********           MOVE BBRCA     BRCA                                        135809 135809R
119840200529     C**********           Z-ADDBCNUM     CNUM                                         135809 CSD027
119850200529     C**********           MOVE BCNUM     CNUM                                        CSD027 135809R
119860200529     C**********           MOVE BCCY      CCY                                         135809 135809R
119870200529     C**********           Z-ADDBACOD     ACOD                                        135809 135809R
119880200529     C**********           Z-ADDBACSQ     ACSQ                                        135809 135809R
119890200529     C**********           MOVE WACNO     ACNO                                        135809 135809R
119900200529     C**********           Z-ADDCNCID     VALD                                        135809 135809R
119910200529     C**********           Z-ADDCNCID     HISD                                        135809 135809R
119920200529     C**********           MOVE '1'       RIND                                        135809 135809R
119930200529     C**********           MOVE 'R'       ATYP                                        135809 135809R
119940200529     C**********           Z-ADD@CRNET    WPSTA                                       135809 135809R
119950200529     C**********           Z-ADD13        #                                           135809 135809R
119960200529     C**********           MOVELNAR,#     INPNAR                                      135809 135809R
119970200529     C**********           MOVELNR16,#    INP16                                       135809 135809R
119980200529     C**********           MOVELDN07,#    INP07                                       135809 135809R
119990200529     C**********           MOVELMGD,#     ##MGID                                      135809 135809R
120000200529     C**********           EXSR SUBNAR                                                135809 135809R
120010200529     C**********           MOVELNARS      PNAR                                        135809 135809R
120020200529     C********** BGN0ST    IFEQ 'Y'                                                   135809 135809R
120030200529     C**********           MOVE WMPRFC    PRFC                                        135809 135809R
120040200529     C**********           END                                                        135809 135809R
120050200529     C**********           EXSR GEICPR                                                135809 135809R
120060200529     C********** VALD      IFLE NAPDA                                                 135809 135809R
120070200529     C********** *IN50     ANDEQ'0'                                                   135809 135809R
120080200529     C**********           Z-ADDVALD      HISD                                        135809 135809R
120090200529     C**********           Z-ADD141       DBASE                                       135809 135809R
120100200529     C**********           MOVE 'N'       REACT                                       135809 135809R
120110200529     C**********           WRITEREHPOSPF                                              135809 135809R
120120200529     C**********           Z-ADD142       DBASE                                       135809 135809R
120130200529     C********** R3KEY     CHAINREHISPDF             40                               135809 135809R
120140200529     C********** *IN40     IFEQ '0'                                                   135809 135809R
120150200529     C********** DRCR      IFEQ 1                                                     135809 135809R
120160200529     C**********           ADD  PSTA      CMVT                                        135809 135809R
120170200529     C**********           SUB  PSTA      HISB                                        135809 135809R
120180200529     C**********           ELSE                                                       135809 135809R
120190200529     C**********           ADD  PSTA      DMVT                                        135809 135809R
120200200529     C**********           ADD  PSTA      HISB                                        135809 135809R
120210200529     C**********           END                                                        135809 135809R
120220200529     C**********           UPDATREHISPDF                                              135809 135809R
120230200529      **Save*updated*history*balance***********************************************   135809 135809R
120240200529     C**********           Z-ADDHISB      @RHISB                                      135809 135809R
120250200529     C**********           Z-ADD*ZERO     DBASE                                       135809 135809R
120260200529     C**********           END                                                        135809 135809R
120270200529     C**********           END                                                        135809 135809R
120280200529     C           @CRINT    ANDNE*ZERO                                                       AR978914
120290200529     C           @CRINT    SUB  CINW      @CRNET                                            AR978914
120300200529     C           CGL165    IFEQ 'Y'                                                           CGL165
120310200529     C           CINS      ANDNE0                                                             CGL165
120320200529     C           @CRNET    SUB  CINS      @CRNET                                              CGL165
120330200529     C                     ENDIF                                                              CGL165
120340200529     C           @CRNET    IFGT *ZERO                                                       AR978914
120350200529      * Debit main a/c with net interest                                                    AR978914
120360200529     C                     MOVE BBRCA     BRCA                                              AR978914
120370200529     C                     MOVE BCNUM     CNUM                                              AR978914
120380200529     C                     MOVE BCCY      CCY                                               AR978914
120390200529     C                     Z-ADDBACOD     ACOD                                              AR978914
120400200529     C                     Z-ADDBACSQ     ACSQ                                              AR978914
120410200529     C                     MOVE WACNO     ACNO                                              AR978914
120420200529     C                     Z-ADDCNCID     VALD                                              AR978914
120430200529     C                     Z-ADDCNCID     HISD                                              AR978914
120440200529     C                     MOVE '1'       RIND                                              AR978914
120450200529     C                     MOVE 'R'       ATYP                                              AR978914
120460200529     C           CDL013    IFEQ '1'                                                         MD040758
120470200529     C           ADJUST    ANDEQ'Y'                                                         MD040758
120480200529     C                     Z-SUB@CRNET    @CRNET                                            MD040758
120490200529     C                     ENDIF                                                            MD040758
120500200529     C                     Z-ADD@CRNET    WPSTA                                             AR978914
120510200529      *                                                                                     MD040758
120520200529     C           CDL013    IFEQ '1'                                                         MD040758
120530200529     C           ADJUST    ANDEQ'Y'                                                         MD040758
120540200529     C                     Z-ADD12        #                                                 MD040758
120550200529     C                     ELSE                                                             MD040758
120560200529     C                     Z-ADD13        #                                                 AR978914
120570200529     C                     ENDIF                                                            MD040758
120580200529     C                     MOVELNAR,#     INPNAR                                            AR978914
120590200529     C                     MOVELNR16,#    INP16                                             AR978914
120600200529     C                     MOVELDN07,#    INP07                                             AR978914
120610200529     C                     MOVELMGD,#     ##MGID                                            AR978914
120620200529     C                     EXSR SUBNAR                                                      AR978914
120630200529     C                     MOVELNARS      PNAR                                              AR978914
120640200529     C           BGN0ST    IFEQ 'Y'                                                         AR978914
120650200529     C                     MOVE WMPRFC    PRFC                                              AR978914
120660200529     C                     END                                                              AR978914
120670200529     C                     EXSR GEICPR                                                      AR978914
120680200529     C           VALD      IFLE NAPDA                                                       AR978914
120690200529     C           *IN50     ANDEQ'0'                                                         AR978914
120700200529     C                     Z-ADDVALD      HISD                                              AR978914
120710200529     C                     Z-ADD141       DBASE                                             AR978914
120720200529     C                     MOVE 'N'       REACT                                             AR978914
120730200529     C                     WRITEREHPOSPF                                                    AR978914
120740200529     C                     Z-ADD142       DBASE                                             AR978914
120750200529     C           R3KEY     CHAINREHISPDF             40                                     AR978914
120760200529     C           *IN40     IFEQ '0'                                                         AR978914
120770200529     C           DRCR      IFEQ 1                                                           AR978914
120780200529     C                     ADD  PSTA      CMVT                                              AR978914
120790200529     C                     SUB  PSTA      HISB                                              AR978914
120800200529     C                     ELSE                                                             AR978914
120810200529     C                     ADD  PSTA      DMVT                                              AR978914
120820200529     C                     ADD  PSTA      HISB                                              AR978914
120830200529     C                     END                                                              AR978914
120840200529     C                     UPDATREHISPDF                                                    AR978914
120850200529     C                     MOVE 'Y'       FCOMIT                                            MD022410
120860200529      * Save updated history balance                                                        AR978914
120870200529     C                     Z-ADDHISB      @RHISB                                            AR978914
120880200529     C                     Z-ADD*ZERO     DBASE                                             AR978914
120890200529     C                     END                                                              AR978914
120900200529     C                     END                                                              AR978914
120910200529     C***********          MOVE CACP      WALT             **             101861
120920200529     C**********           MOVELCACP      WALT             **      101861 135809
120930200529     C**********           MOVELCACP      WALT                                      135809R AR978914
120940200529     C*                                                    **
120950200529     C***RETAIL*NUMBER*ENTERED******************************************* 135809
120960200529     C*                                                    **
120970200529     C********** WALT5     IFEQ *BLANKS                    *** B3         135809
120980200529     C********** WALT10    CHAINACNUM                99    ***            135809
120990200529     C********** WALT5     IFEQ *BLANKS                                             135809R AR978914
121000200529     C********** WALT10    CHAINACNUM                99                             135809R AR978914
121010200529     C*                                                    ***
121020200529     C***ALTERNATE*DOES*NOT*EXIST*OR*IS*CLOSED*DO*NOT*POST*TAX*********** 135809
121030200529     C*                                                    ***
121040200529     C********** *IN99     IFEQ '1'                        **** B4        135809
121050200529     C********** RRRECI    OREQ 'C'                        ****           135809
121060200529     C**********           Z-ADD*ZERO     BCINW            ****           135809
121070200529     C**********           Z-ADD*ZERO     CINW             ****           135809
121080200529     C**********           Z-ADD*ZERO     WTIWT            ****           135809
121090200529     C********** *IN99     IFEQ '1'                        **** B4                  135809R AR978914
121100200529     C********** RRRECI    OREQ 'C'                        ****                     135809R AR978914
121110200529     C**********           Z-ADD*ZERO     BCINW            ****                     135809R AR978914
121120200529     C**********           Z-ADD*ZERO     CINW             ****                     135809R AR978914
121130200529     C**********           Z-ADD*ZERO     WTIWT            ****                     135809R AR978914
121140200529     C*                                                    ****
121150200529     C***ALTERNATE*ACCOUNT*IS*LIVE*************************************** 135809
121160200529     C*                                                    ****
121170200529     C**********           ELSE                            **** X4        135809
121180200529     C**********           ELSE                            **** X4                  135809R AR978914
121190200529      * Credit the alt. a/c with net interest (a/c already verified)      135809
121200200529     C*                                                    ****
121210200529     C** SET UP FIELDS TO POST                             ****
121220200529     C*                                                    ****
121230200529     C**********           Z-ADDRCNUM     CNUM             ****           135809
121240200529     C**********           MOVE RCCY      CCY              ****           135809
121250200529     C**********           Z-ADD@CCNUM    CNUM             ****                        135809 CSD027
121260200529     C**********           MOVE @CCNUM    CNUM             ****                       CSD027 135809R
121270200529     C**********           MOVE RCNUM     CNUM             ****                     135809R AR978914
121280200529     C**********           MOVE RCCY      CCY              ****                     135809R AR978914
121290200529     C                     MOVE @CCNUM    CNUM             ****                             AR978914
121300200529     C**********           MOVE @CCCY     CCY              ****                       135809 135809R
121310200529     C                     MOVE @CCCY     CCY              ****                             AR978914
121320200529     C                     MOVE 'P'       RECI             ****
121330200529     C**********           Z-ADDRACOD     ACOD             ****           135809
121340200529     C**********           Z-ADDWALT10    ACNO             ****           135809
121350200529     C**********           Z-ADDRACOD     ACOD             ****                     135809R AR978914
121360200529     C**********           Z-ADDWALT10    ACNO             ****                     135809R AR978914
121370200529     C**********           Z-ADD@CACOD    ACOD             ****                       135809 135809R
121380200529     C**********           Z-ADD@CACNO    ACNO             ****                       135809 135809R
121390200529     C                     Z-ADD@CACOD    ACOD             ****                             AR978914
121400200529     C                     Z-ADD@CACNO    ACNO             ****                             AR978914
121410200529     C***********          Z-ADDLCID      VALD             ****           060828
121420200529     C***********          Z-ADDLCID      HISD             ****           060828
121430200529     C********** @CATYP    IFEQ 'R'                                                   135809 135809R
121440200529     C           @CATYP    IFEQ 'R'                                                         AR978914
121450200529     C                     Z-ADDCNCID     VALD             ****           060828
121460200529     C                     Z-ADDCNCID     HISD             ****           060828
121470200529     C*********************EXSR WVALD                      ****     LN0106093582
121480200529     C                     MOVE '1'       RIND             ****
121490200529     C**********           MOVE 'R'       ATYP             ****           135809
121500200529     C**********           MOVE 'R'       ATYP             ****                     135809R AR978914
121510200529     C**********           ELSE                                                       135809 135809R
121520200529     C**********           Z-ADDRUND      VALD                                        135809 135809R
121530200529     C**********           Z-ADDRUND      HISD                                        135809 135809R
121540200529     C**********           MOVE '0'       RIND             ****                       135809 135809R
121550200529     C**********           END                                                        135809 135809R
121560200529     C**********           MOVE @CATYP    ATYP                                        135809 135809R
121570200529     C                     ELSE                                                             AR978914
121580200529     C                     Z-ADDRUND      VALD                                              AR978914
121590200529     C                     Z-ADDRUND      HISD                                              AR978914
121600200529     C                     MOVE '0'       RIND             ****                             AR978914
121610200529     C                     END                                                              AR978914
121620200529     C                     MOVE @CATYP    ATYP                                              AR978914
121630200529     C**********           Z-ADDRACSQ     ACSQ             ****           135809
121640200529     C**********           MOVE RBRCA     BRCA             ****           135809
121650200529     C**********           Z-ADDRACSQ     ACSQ             ****                     135809R AR978914
121660200529     C**********           MOVE RBRCA     BRCA             ****                     135809R AR978914
121670200529     C**********           Z-ADD@CACSQ    ACSQ             ****                       135809 135809R
121680200529     C**********           MOVE @CBRCA    BRCA             ****                       135809 135809R
121690200529     C                     Z-ADD@CACSQ    ACSQ             ****                             AR978914
121700200529     C                     MOVE @CBRCA    BRCA             ****                             AR978914
121710200529      *                                                                   CAC001
121720200529      **  If Analytical Accounting installed, get profit centre of        CAC001
121730200529      **  the alternate account                                           CAC001
121740200529     C********** @CPRFC    IFEQ *BLANKS                                               135809 135809R
121750200529     C********** @CACNO    IFNE *ZERO                                                 135809 135809R
121760200529     C           @CPRFC    IFEQ *BLANKS                                                     AR978914
121770200529     C           @CACNO    IFNE *ZERO                                                       AR978914
121780200529      *                                                                   CAC001
121790200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
121800200529     C********** WALT10    CHAINREACNMF              99            CAC001 135809
121810200529     C********** WALT10    CHAINREACNMF              99                             135809R AR978914
121820200529     C********** @CACNO    CHAINREACNMF              99                               135809 135809R
121830200529     C           @CACNO    CHAINREACNMF              99                                     AR978914
121840200529     C           *IN99     IFEQ '1'                                       CAC001
121850200529     C           *LOCK     IN   LDA                                       CAC001
121860200529     C                     MOVEL'REACNMPD'DBFILE           ************   CAC001
121870200529     C                     MOVELWALT10    DBKEY            * DBER 202 *   CAC001
121880200529     C                     Z-ADD202       DBASE            ************   CAC001
121890200529     C                     OUT  LDA                                       CAC001
121900200529     C                     EXSR *PSSR                                     CAC001
121910200529     C                     ELSE                                           CAC001
121920200529     C                     MOVE TPRFC     PRFC                            CAC001
121930200529     C                     ENDIF                                          CAC001
121940200529     C                     ENDIF                                          CAC001
121950200529      *                                                                   CAC001
121960200529     C**********           END                                                        135809 135809R
121970200529     C**********           ELSE                                                       135809 135809R
121980200529     C**********           MOVE @CPRFC    PRFC                                        135809 135809R
121990200529     C**********           END                                                        135809 135809R
122000200529     C**********           MOVELNAR,2     INPNAR                                      135809 135809R
122010200529     C**********           MOVELNR16,2    INP16                                       135809 135809R
122020200529     C**********           MOVELDN07,2    INP07                                       135809 135809R
122030200529     C**********           MOVELMGD,2     ##MGID                                      135809 135809R
122040200529     C**********           EXSR SUBNAR                                                135809 135809R
122050200529     C**********           MOVELNARS      PNAR                                        135809 135809R
122060200529     C**********           Z-SUB@CRNET    WPSTA                                       135809 135809R
122070200529     C********** BCCY      IFEQ CCY                                                   135809 135809R
122080200529     C********** BBRCA     ANDEQBRCA                                                  135809 135809R
122090200529     C**********           EXSR GEICPR                                                135809 135809R
122100200529     C********** ATYP      IFEQ 'R'                                                   135809 135809R
122110200529     C********** VALD      ANDLENAPDA                                                 135809 135809R
122120200529     C********** *IN50     ANDEQ'0'                                                   135809 135809R
122130200529     C**********           Z-ADDVALD      HISD                                        135809 135809R
122140200529     C**********           Z-ADD143       DBASE                                       135809 135809R
122150200529     C**********           MOVE 'N'       REACT                                       135809 135809R
122160200529     C**********           WRITEREHPOSPF                                              135809 135809R
122170200529     C**********           Z-ADD*ZERO     DBASE                                       135809 135809R
122180200529     C**********           EXSR POSPR                                                 135809 135809R
122190200529     C**********           END                                                        135809 135809R
122200200529     C**********           ELSE                                                       135809 135809R
122210200529      **If*alt.*a/c*has*a*different*ccy*and/or*branch*to*the*main*a/c,************    135809 135809R
122220200529      **cross*ccy*and/or*interbranch*postings*are*required.***********************    135809 135809R
122230200529     C**********           EXSR CCYSR                                                 135809 135809R
122240200529     C**********           END                                                        135809 135809R
122250200529     C**********           END                                                        135809 135809R
122260200529     C**********           END                                                        135809 135809R
122270200529     C                     END                                                              AR978914
122280200529     C                     ELSE                                                             AR978914
122290200529     C                     MOVE @CPRFC    PRFC                                              AR978914
122300200529     C                     END                                                              AR978914
122310200529      *                                                                                     MD040758
122320200529     C           CDL013    IFEQ '1'                                                         MD040758
122330200529     C           ADJUST    ANDEQ'Y'                                                         MD040758
122340200529     C                     MOVELNAR,12    INPNAR                                            MD040758
122350200529     C                     MOVELNR16,12   INP16                                             MD040758
122360200529     C                     MOVELDN07,12   INP07                                             MD040758
122370200529     C                     MOVELMGD,12    ##MGID                                            MD040758
122380200529     C                     ELSE                                                             MD040758
122390200529     C                     MOVELNAR,2     INPNAR                                            AR978914
122400200529     C                     MOVELNR16,2    INP16                                             AR978914
122410200529     C                     MOVELDN07,2    INP07                                             AR978914
122420200529     C                     MOVELMGD,2     ##MGID                                            AR978914
122430200529     C                     ENDIF                                                            MD040758
122440200529     C                     EXSR SUBNAR                                                      AR978914
122450200529     C                     MOVELNARS      PNAR                                              AR978914
122460200529     C                     Z-SUB@CRNET    WPSTA                                             AR978914
122470200529     C           BCCY      IFEQ CCY                                                         AR978914
122480200529     C           BBRCA     ANDEQBRCA                                                        AR978914
122490200529     C                     EXSR GEICPR                                                      AR978914
122500200529     C           ATYP      IFEQ 'R'                                                         AR978914
122510200529     C           VALD      ANDLENAPDA                                                       AR978914
122520200529     C           *IN50     ANDEQ'0'                                                         AR978914
122530200529     C                     Z-ADDVALD      HISD                                              AR978914
122540200529     C                     Z-ADD143       DBASE                                             AR978914
122550200529     C                     MOVE 'N'       REACT                                             AR978914
122560200529     C                     WRITEREHPOSPF                                                    AR978914
122570200529     C                     Z-ADD*ZERO     DBASE                                             AR978914
122580200529     C                     EXSR POSPR                                                       AR978914
122590200529     C                     END                                                              AR978914
122600200529     C                     ELSE                                                             AR978914
122610200529      * If alt. a/c has a different ccy and/or branch to the main a/c,                      AR978914
122620200529      * cross ccy and/or interbranch postings are required.                                 AR978914
122630200529     C                     EXSR CCYSR                                                       AR978914
122640200529     C                     END                                                              AR978914
122650200529     C                     END                                                              AR978914
122660200529     C                     END                                                              AR978914
122670200529     C**********           END                             **** E4        135809
122680200529     C**********           END                             **** E4                  135809R AR978914
122690200529     C*                                                    ***
122700200529     C**********           ELSE                            ***  X3        135809
122710200529     C**********           ELSE                            ***  X3                  135809R AR978914
122720200529     C*                                                    ***
122730200529     C***ACCOUNT*NUMBER*USED*FOR*ALTERNATE******************************* 135809
122740200529     C*                                                    ***
122750200529     C********** WALTK     CHAINACCNT               N99    ***            135809
122760200529     C********** WALTK     CHAINACCNT               N99    ***                      135809R AR978914
122770200529     C*                                                    ***
122780200529     C***ALTERNATE*DOES*NOT*EXIST*OR*IS*CLOSED*DO*NOT*POST*TAX*********** 135809
122790200529     C*                                                    ***
122800200529     C********** *IN99     IFEQ '1'                        **** B4        135809
122810200529     C********** AARECI    OREQ 'C'                        ****           135809
122820200529     C**********           Z-ADD*ZERO     BCINW            ****           135809
122830200529     C**********           Z-ADD*ZERO     CINW             ****           135809
122840200529     C**********           Z-ADD*ZERO     WTIWT            ****           135809
122850200529     C********** *IN99     IFEQ '1'                        **** B4                  135809R AR978914
122860200529     C********** AARECI    OREQ 'C'                        ****                     135809R AR978914
122870200529     C**********           Z-ADD*ZERO     BCINW            ****                     135809R AR978914
122880200529     C**********           Z-ADD*ZERO     CINW             ****                     135809R AR978914
122890200529     C**********           Z-ADD*ZERO     WTIWT            ****                     135809R AR978914
122900200529     C*                                                    ****
122910200529     C***ALTERNATE*ACCOUNT*IS*LIVE*************************************** 135809
122920200529     C*                                                    ****
122930200529     C**********           ELSE                            **** X4        135809
122940200529     C**********           ELSE                            **** X4                  135809R AR978914
122950200529     C*                                                    ****
122960200529     C***SET*UP*FIELDS*TO*POST******************************************* 135809
122970200529     C*                                                    ****
122980200529     C**********           Z-ADDAACNUM    CNUM             ****           135809
122990200529     C**********           MOVE AACCY     CCY              ****           135809
123000200529     C**********           MOVE 'P'       RECI             ****           135809
123010200529     C**********           Z-ADDAAACOD    ACOD             ****           135809
123020200529     C**********           Z-ADDAAACNO    ACNO             ****           135809
123030200529     C**********           MOVE AAATYP    ATYP             ****           135809
123040200529     C**********           Z-ADDAAACSQ    ACSQ             ****           135809
123050200529     C**********           MOVE ABRCA     BRCA             ****           135809
123060200529      ****If*Analytical*Accounting*installed,*get*profit*centre*of CAC001 135809
123070200529      ****the*alternate*account*if*it*is*retail*or*nostro********* CAC001 135809
123080200529     C********** BGN0ST    IFEQ 'Y'                                CAC001 135809
123090200529     C********** ATYP      IFEQ 'R'                                CAC001 135809
123100200529     C********** ATYP      OREQ 'N'                                CAC001 135809
123110200529     C**********           MOVE AAPRFC    PRFC                     CAC001 135809
123120200529     C**********           ENDIF                                   CAC001 135809
123130200529     C**********           ENDIF                                   CAC001 135809
123140200529     C********** ATYP      IFEQ 'R'                        ***** B5       135809
123150200529     C**********           MOVE '1'       RIND             *****          135809
123160200529     C**********           Z-ADDAACNUM    CNUM             ****                              135809R
123170200529     C**********           MOVE AACNUM    CNUM             ****                      CSD031 AR978914
123180200529     C**********           MOVE AACCY     CCY              ****                     135809R AR978914
123190200529     C**********           MOVE 'P'       RECI             ****                     135809R AR978914
123200200529     C**********           Z-ADDAAACOD    ACOD             ****                     135809R AR978914
123210200529     C**********           Z-ADDAAACNO    ACNO             ****                     135809R AR978914
123220200529     C**********           MOVE AAATYP    ATYP             ****                     135809R AR978914
123230200529     C**********           Z-ADDAAACSQ    ACSQ             ****                     135809R AR978914
123240200529     C**********           MOVE ABRCA     BRCA             ****                     135809R AR978914
123250200529      ****If*Analytical*Accounting*installed,*get*profit*centre*of*****             135809R AR978914
123260200529      ****the*alternate*account*if*it*is*retail*or*nostro**************             135809R AR978914
123270200529     C********** BGN0ST    IFEQ 'Y'                                                 135809R AR978914
123280200529     C********** ATYP      IFEQ 'R'                                                 135809R AR978914
123290200529     C********** ATYP      OREQ 'N'                                                 135809R AR978914
123300200529     C**********           MOVE AAPRFC    PRFC                                      135809R AR978914
123310200529     C**********           ENDIF                                                    135809R AR978914
123320200529     C**********           ENDIF                                                    135809R AR978914
123330200529     C********** ATYP      IFEQ 'R'                        ***** B5                 135809R AR978914
123340200529     C**********           MOVE '1'       RIND             *****                    135809R AR978914
123350200529     C***********          Z-ADDLCID      VALD             ***            060828
123360200529     C***********          Z-ADDLCID      HISD             ****           060828
123370200529     C**********           Z-ADDCNCID     VALD             ****    060828 135809
123380200529     C**********           Z-ADDCNCID     HISD             ****    060828 135809
123390200529     C**********           Z-ADDCNCID     VALD                                      135809R AR978914
123400200529     C**********           Z-ADDCNCID     HISD                                      135809R AR978914
123410200529     C*********************EXSR WVALD                      ****     LN0106093582
123420200529     C*                                                    *****
123430200529     C***ACCOUNT*IS*NOT*RETAIL******************************************* 135809
123440200529     C*                                                    *****
123450200529     C**********           ELSE                            ***** X5       135809
123460200529     C**********           ELSE                            ***** X5                 135809R AR978914
123470200529     C*                                                    *****
123480200529     C**********           Z-ADD*ZEROS    ACNO             *****          135809
123490200529     C**********           MOVE *ZERO     RIND             *****          135809
123500200529     C**********           Z-ADDRUND      VALD             *****          135809
123510200529     C**********           Z-ADDRUND      HISD             *****          135809
123520200529     C**********           END                             ***** E5       135809
123530200529     C**********           END                             **** E4        135809
123540200529     C**********           END                             *** E3         135809
123550200529     C**********           Z-ADD*ZEROS    ACNO             *****                    135809R AR978914
123560200529     C**********           MOVE *ZERO     RIND             *****                    135809R AR978914
123570200529     C**********           Z-ADDRUND      VALD             *****                    135809R AR978914
123580200529     C**********           Z-ADDRUND      HISD             *****                    135809R AR978914
123590200529     C**********           END                             ***** E5                 135809R AR978914
123600200529     C**********           END                             **** E4                  135809R AR978914
123610200529     C**********           END                             *** E3                   135809R AR978914
123620200529     C***INITIALIZE*ACCOUNT*AMOUNT*TO*BE*POSTED************************** 135809
123630200529     C********** BCINW     IFGT 0                          *** B3         135809
123640200529     C********** CCY       IFEQ BCCY                       *** B4         135809
123650200529     C**********           Z-ADDCINW      WPSTA            ***            135809
123660200529     C**********           MOVE WOTACC    WTACC            ***            135809
123670200529     C**********           MOVE WOTACT    WATYP            ***            135809
123680200529     C**********           ELSE                            *** X4         135809
123690200529     C********** CCY       IFEQ BACCY                      **** B5        135809
123700200529     C**********           Z-ADDBCINW     WPSTA            ****           135809
123710200529     C**********           MOVE WBTACC    WTACC            ****           135809
123720200529     C**********           MOVE WBTACT    WATYP            ****           135809
123730200529     C**********           ELSE                            **** X5        135809
123740200529     C********** BCINW     IFGT 0                          *** B3                   135809R AR978914
123750200529     C********** CCY       IFEQ BCCY                       *** B4                   135809R AR978914
123760200529     C**********           Z-ADDCINW      WPSTA            ***                      135809R AR978914
123770200529     C**********           MOVE WOTACC    WTACC            ***                      135809R AR978914
123780200529     C**********           MOVE WOTACT    WATYP            ***                      135809R AR978914
123790200529     C**********           ELSE                            *** X4                   135809R AR978914
123800200529     C********** CCY       IFEQ BACCY                      **** B5                  135809R AR978914
123810200529     C**********           Z-ADDBCINW     WPSTA            ****                     135809R AR978914
123820200529     C**********           MOVE WBTACC    WTACC            ****                     135809R AR978914
123830200529     C**********           MOVE WBTACT    WATYP            ****                     135809R AR978914
123840200529     C**********           ELSE                            **** X5                  135809R AR978914
123850200529     C*                                                    ****
123860200529     C***CHECK*IF*ALTERNATE*CURRENCY*EXIST******************************* 135809
123870200529     C*                                                    ****
123880200529     C**********           CALL 'AOCURRR0'                                135809
123890200529     C**********           PARM '*MSG   ' @RTCD                           135809
123900200529     C**********           PARM '*KEY   ' @OPTN                           135809
123910200529     C**********           PARM CCY       @CYCD   3                       135809
123920200529     C********** SDCURR    PARM SDCURR    DSSDY                           135809
123930200529     C********** @RTCD     IFNE *BLANK                                    135809
123940200529     C********** *LOCK     IN   LDA                                       135809
123950200529     C**********           MOVEL'SDCURRPD'DBFILE           ***************135809
123960200529     C***********          MOVEL@CYCD     DBKEY            * DB ERROR 12 *CRE002
123970200529     C***********          Z-ADD012       DBASE            ***************CRE002
123980200529     C**********           MOVEL@CYCD     DBKEY     * DB ERROR 113*CRE002 135809
123990200529     C**********           Z-ADD113       DBASE     ***************CRE002 135809
124000200529     C**********           OUT  LDA                                       135809
124010200529     C***********          WRITEERRP1                                     CCB003
124020200529     C**********           EXSR *PSSR                                     135809
124030200529     C**********           END                                            135809
124040200529     C**********           CALL 'AOCURRR0'                                          135809R AR978914
124050200529     C**********           PARM '*MSG   ' @RTCD                                     135809R AR978914
124060200529     C**********           PARM '*KEY   ' @OPTN                                     135809R AR978914
124070200529     C**********           PARM CCY       @CYCD   3                                 135809R AR978914
124080200529     C********** SDCURR    PARM SDCURR    DSSDY                                     135809R AR978914
124090200529     C********** @RTCD     IFNE *BLANK                                              135809R AR978914
124100200529     C********** *LOCK     IN   LDA                                                 135809R AR978914
124110200529     C**********           MOVEL'SDCURRPD'DBFILE           **************           135809R AR978914
124120200529     C**********           MOVEL@CYCD     DBKEY            *DB ERROR 113*           135809R AR978914
124130200529     C**********           Z-ADD113       DBASE            **************           135809R AR978914
124140200529     C**********           OUT  LDA                                                 135809R AR978914
124150200529     C**********           EXSR *PSSR                                               135809R AR978914
124160200529     C**********           END                                                      135809R AR978914
124170200529     C*                                                    ****
124180200529     C***SAVE*PARM*FOR*CROSS*CURRENCY************************************ 135809
124190200529     C*                                                    ****
124200200529     C**********           Z-ADDCDP       WACDP            ****           135809
124210200529     C**********           Z-ADDSPOT      WASPOT           ****           135809
124220200529     C**********           MOVE MDIN      WAMDIN           ****           135809
124230200529     C**********           MOVE TACC      WATACC           ****           135809
124240200529     C**********           Z-ADDCDP       WACDP            ****                     135809R AR978914
124250200529     C**********           Z-ADDSPOT      WASPOT           ****                     135809R AR978914
124260200529     C/COPY WNCPYSRC,REH00149
124270200529     C**********           MOVE MDIN      WAMDIN           ****                     135809R AR978914
124280200529     C**********           MOVE TACC      WATACC           ****                     135809R AR978914
124290200529     C*                                                    ****
124300200529     C***ACCESS*ACCOUNT*CODES******************************************** 135809
124310200529     C*                                                    ****
124320200529     C**********           MOVELWATACC    KACOD            ****           135809
124330200529     C**********           CALL 'AOACODR0'                                135809
124340200529     C**********           PARM '*MSG   ' @RTCD                           135809
124350200529     C**********           PARM '*KEY   ' @OPTN                           135809
124360200529     C**********           PARM KACOD     @ACCD   4                       135809
124370200529     C********** SDACOD    PARM SDACOD    DSFDY                           135809
124380200529     C********** @RTCD     IFNE *BLANK                                    135809
124390200529     C********** *LOCK     IN   LDA                                       135809
124400200529     C**********           MOVEL'SDACODPD'DBFILE           ***************135809
124410200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 78 *CRE002
124420200529     C***********          Z-ADD078       DBASE            ***************CRE002
124430200529     C**********           MOVEL@ACCD     DBKEY     * DB ERROR 114*CRE002 135809
124440200529     C**********           Z-ADD114       DBASE     ***************CRE002 135809
124450200529     C**********           OUT  LDA                                       135809
124460200529     C***********          WRITEERRP1                                     CCB003
124470200529     C**********           EXSR *PSSR                                     135809
124480200529     C**********           END                                            135809
124490200529     C**********           MOVELWATACC    KACOD            ****                     135809R AR978914
124500200529     C**********           CALL 'AOACODR0'                                          135809R AR978914
124510200529     C**********           PARM '*MSG   ' @RTCD                                     135809R AR978914
124520200529     C**********           PARM '*KEY   ' @OPTN                                     135809R AR978914
124530200529     C**********           PARM KACOD     @ACCD  10                                 135809R AR978914
124540200529     C********** SDACOD    PARM SDACOD    DSFDY                                     135809R AR978914
124550200529     C********** @RTCD     IFNE *BLANK                                              135809R AR978914
124560200529     C********** *LOCK     IN   LDA                                                 135809R AR978914
124570200529     C**********           MOVEL'SDACODPD'DBFILE           ***************          135809R AR978914
124580200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 114*          135809R AR978914
124590200529     C**********           Z-ADD114       DBASE            ***************          135809R AR978914
124600200529     C**********           OUT  LDA                                                 135809R AR978914
124610200529     C**********           EXSR *PSSR                                               135809R AR978914
124620200529     C**********           END                                                      135809R AR978914
124630200529     C*                                                    ****
124640200529     C**********           MOVE A5ACTY    WATACT           ****           135809
124650200529     C**********           MOVE A5ACTY    WATACT           ****                     135809R AR978914
124660200529     C*                                                    ****
124670200529     C*                                                    ****
124680200529     C***CALCULATE*THE*BCCY*EQUIVALENT*ONLY*IF*DIFFERENT*CURRENCY******** 135809
124690200529     C*                                                    ****
124700200529     C**********           MOVE BCCY      ZCCYI            ****           135809
124710200529     C**********           Z-ADDWOSPOT    ZRATEF           ****           135809
124720200529     C**********           MOVE WOCDP     ZCDPI            ****           135809
124730200529     C**********           MOVE WOMDIN    ZMDINF           ****           135809
124740200529     C**********           MOVE CCY       ZCCYO            ****           135809
124750200529     C**********           Z-ADDWASPOT    ZRATET           ****           135809
124760200529     C**********           MOVE WACDP     ZCDPO            ****           135809
124770200529     C**********           MOVE WAMDIN    ZMDINT           ****           135809
124780200529     C**********           Z-ADDCINW      ZAMTCI           ****           135809
124790200529     C**********           MOVE BCCY      ZCCYI            ****                     135809R AR978914
124800200529     C**********           Z-ADDWOSPOT    ZRATEF           ****                     135809R AR978914
124810200529     C**********           MOVE WOCDP     ZCDPI            ****                     135809R AR978914
124820200529     C**********           MOVE WOMDIN    ZMDINF           ****                     135809R AR978914
124830200529     C**********           MOVE CCY       ZCCYO            ****                     135809R AR978914
124840200529     C**********           Z-ADDWASPOT    ZRATET           ****                     135809R AR978914
124850200529     C**********           MOVE WACDP     ZCDPO            ****                     135809R AR978914
124860200529     C**********           MOVE WAMDIN    ZMDINT           ****                     135809R AR978914
124870200529     C**********           Z-ADDCINW      ZAMTCI           ****                     135809R AR978914
124880200529      *                                                                                       CDL081
124890200529      ** Set withholding tax conversion flag                                                  CDL081
124900200529      *                                                                                       CDL081
124910200529     C                     MOVE 'Y'       @WHTF                                               CDL081
124920200529     C*                                                    ****
124930200529     C**********           EXSR #CCYCN                     ****           135809
124940200529     C**********           EXSR #CCYCN                     ****                     135809R AR978914
124950200529      *                                                                                       CDL081
124960200529     C                     MOVE *BLANK    @WHTF                                               CDL081
124970200529     C*                                                    ****
124980200529     C**********           Z-ADDZAMTCO    WPSTA            ****           135809
124990200529     C**********           MOVE WATACC    WTACC            ****           135809
125000200529     C**********           MOVE WATACT    WATYP            ****           135809
125010200529     C**********           Z-ADDZAMTCO    WPSTA            ****                     135809R AR978914
125020200529     C**********           MOVE WATACC    WTACC            ****                     135809R AR978914
125030200529     C**********           MOVE WATACT    WATYP            ****                     135809R AR978914
125040200529     C*                                                    ****
125050200529     C**********           END                             **** E5        135809
125060200529     C**********           END                             *** E4         135809
125070200529     C**********           END                             *** E3         135809
125080200529     C**********           END                             **** E5                  135809R AR978914
125090200529     C**********           END                             *** E4                   135809R AR978914
125100200529     C**********           END                             *** E3                   135809R AR978914
125110200529     C*                                                    **
125120200529     C***PROCESS*FOR*MULTIBRANCH***************************************** 135809
125130200529     C*                                                    **
125140200529     C********** BBRCA     IFEQ BRCA                       *** B3         135809
125150200529     C**********           MOVE BBICN     WBICN            ***            135809
125160200529     C**********           ELSE                            *** X3         135809
125170200529     C********** BBRCA     IFEQ BRCA                       *** B3                   135809R AR978914
125180200529     C**********           MOVE BBICN     WBICN            ***                      135809R AR978914
125190200529     C**********           ELSE                            *** X3                   135809R AR978914
125200200529     C*                                                    ***
125210200529     C***ACCESS*BRANCH*CODES********************************************* 135809
125220200529     C**********           CALL 'AOBRCHR0'                                135809
125230200529     C**********           PARM '*MSG   ' @RTCD                           135809
125240200529     C**********           PARM '*KEY   ' @OPTN                           135809
125250200529     C**********           PARM BRCA      @BRCA   3                       135809
125260200529     C********** SDBRCH    PARM SDBRCH    DSFDY                           135809
125270200529     C********** @RTCD     IFNE *BLANK                                    135809
125280200529     C********** *LOCK     IN   LDA                                       135809
125290200529     C**********           MOVEL'SDBRCHPD'DBFILE           ***************135809
125300200529     C***********          MOVEL@BRCA     DBKEY            * DB ERROR 25 *CRE002
125310200529     C***********          Z-ADD25        DBASE            ***************CRE002
125320200529     C**********           MOVEL@BRCA     DBKEY     * DB ERROR 115*CRE002 135809
125330200529     C**********           Z-ADD115       DBASE     ***************CRE002 135809
125340200529     C**********           OUT  LDA                                       135809
125350200529     C***********          WRITEERRP1                                     CCB003
125360200529     C**********           EXSR *PSSR                                     135809
125370200529     C**********           END                                            135809
125380200529     C**********           CALL 'AOBRCHR0'                                          135809R AR978914
125390200529     C**********           PARM '*MSG   ' @RTCD                                     135809R AR978914
125400200529     C**********           PARM '*KEY   ' @OPTN                                     135809R AR978914
125410200529     C**********           PARM BRCA      @BRCA   3                                 135809R AR978914
125420200529     C********** SDBRCH    PARM SDBRCH    DSFDY                                     135809R AR978914
125430200529     C********** @RTCD     IFNE *BLANK                                              135809R AR978914
125440200529     C********** *LOCK     IN   LDA                                                 135809R AR978914
125450200529     C**********           MOVEL'SDBRCHPD'DBFILE           ***************          135809R AR978914
125460200529     C**********           MOVEL@BRCA     DBKEY            * DB ERROR 115*          135809R AR978914
125470200529     C**********           Z-ADD115       DBASE            ***************          135809R AR978914
125480200529     C**********           OUT  LDA                                                 135809R AR978914
125490200529     C**********           EXSR *PSSR                                               135809R AR978914
125500200529     C**********           END                                                      135809R AR978914
125510200529     C*                                                    ***
125520200529     C**********           MOVE BICN      WBICN            ***            135809
125530200529     C**********           MOVE BICN      WBICN            ***                      135809R AR978914
125540200529     C*                                                    ***
125550200529     C**********           END                             *** E3         135809
125560200529     C**********           ELSE                            ** X2          135809
125570200529     C**********           END                             *** E3                   135809R AR978914
125580200529     C**********           ELSE                            ** X2                    135809R AR978914
125590200529     C*                                                    **
125600200529     C***NO*ALTERNATE*ACCOUNT*USED*************************************** 135809
125610200529      * Withholding tax is always posted to the main a/c                  135809
125620200529     C********** CINW      IFGT *ZERO                                                 135809 135809R
125630200529     C********** BGN0ST    IFEQ 'Y'                                                   135809 135809R
125640200529     C**********           MOVE WMPRFC    PRFC                                        135809 135809R
125650200529     C**********           END                                                               135809R
125660200529     C           CINW      IFGT *ZERO                                                       AR978914
125670200529     C           BGN0ST    IFEQ 'Y'                                                         AR978914
125680200529     C                     MOVE WMPRFC    PRFC                                              AR978914
125690200529     C                     END                                                              AR978914
125700200529     C*                                                    **
125710200529     C** SET UP FIELDS TO POST                             **
125720200529     C*                                                    **
125730200529     C**********           Z-ADDBCNUM     CNUM             **                                 CSD027
125740200529     C                     MOVE BCNUM     CNUM             **                                 CSD027
125750200529     C                     MOVE BCCY      CCY              **
125760200529     C                     MOVE 'P'       RECI             **
125770200529     C                     Z-ADDBACOD     ACOD             **
125780200529     C                     MOVE WACNO     ACNO             **
125790200529     C                     MOVE 'R'       ATYP             **
125800200529     C                     Z-ADDBACSQ     ACSQ             **
125810200529     C                     MOVE BBRCA     BRCA             **
125820200529     C                     MOVE '1'       RIND             **
125830200529     C*********************Z-ADDLCID      VALD             ****           060828
125840200529     C*********************Z-ADDLCID      HISD             ****           060828
125850200529     C                     Z-ADDCNCID     VALD             ****           060828
125860200529     C                     Z-ADDCNCID     HISD             ****           060828
125870200529     C*********************EXSR WVALD                      ****     LN0106093582
125880200529     C           CDL013    IFEQ '1'                                                         MD040758
125890200529     C           ADJUST    ANDEQ'Y'                                                         MD040758
125900200529     C                     Z-SUBCINW      CINW                                              MD040758
125910200529     C                     ENDIF                                                            MD040758
125920200529     C                     Z-ADDCINW      WPSTA            **
125930200529     C                     MOVE WOTACC    WTACC            **
125940200529     C                     MOVE WOTACT    WATYP            **
125950200529     C                     MOVE BBICN     WBICN            **
125960200529     C*                                                    **
125970200529     C                     END                             ** E2
125980200529     C**********           END                             * E1           135809
125990200529     C**********           END                             * E1                     135809R AR978914
126000200529     C                     ELSE                                                             MD045460
126010200529      *                                                                                     MD045460
126020200529      ** Check for the main account                                                         MD045460
126030200529      *                                                                                     MD045460
126040200529     C           BCINW     IFGT *ZERO                                                       MD045460
126050200529     C           CACP      IFNE *BLANKS                                                     MD045460
126060200529     C           CGL165    IFEQ 'Y'                                                         MD045460
126070200529     C           CINS      ANDNE0                                                           MD045460
126080200529     C           @CRNET    SUB  CINS      @CRNET                                            MD045460
126090200529     C                     ENDIF                                                            MD045460
126100200529     C                     MOVELCACP      WALT                                              MD045460
126110200529     C           WALT5     IFEQ *BLANKS                                                     MD045460
126120200529     C           WALT10    CHAINACNUM                99                                     MD045460
126130200529      *                                                                                     MD045460
126140200529      ** If account does not exist or closed, do not post tax                               MD045460
126150200529      *                                                                                     MD045460
126160200529     C           *IN99     IFEQ '1'                                                         MD045460
126170200529     C           RRRECI    OREQ 'C'                                                         MD045460
126180200529     C                     Z-ADD*ZERO     BCINW                                             MD045460
126190200529     C                     Z-ADD*ZERO     CINW                                              MD045460
126200200529     C                     Z-ADD*ZERO     WTIWT                                             MD045460
126210200529      *                                                                                     MD045460
126220200529     C                     ELSE                                                             MD045460
126230200529      *                                                                                     MD045460
126240200529      ** Else if account is live, set up fields to post                                     MD045460
126250200529      *                                                                                     MD045460
126260200529     C                     MOVE RCNUM     CNUM                                              MD045460
126270200529     C                     MOVE RCCY      CCY                                               MD045460
126280200529     C                     MOVE 'P'       RECI                                              MD045460
126290200529     C                     Z-ADDRACOD     ACOD                                              MD045460
126300200529     C                     Z-ADDWALT10    ACNO                                              MD045460
126310200529     C                     Z-ADDCNCID     VALD                                              MD045460
126320200529     C                     Z-ADDCNCID     HISD                                              MD045460
126330200529     C                     MOVE 'R'       ATYP                                              MD045460
126340200529     C                     Z-ADDRACSQ     ACSQ                                              MD045460
126350200529     C                     MOVE RBRCA     BRCA                                              MD045460
126360200529      *                                                                                     MD045460
126370200529      ** If Analytical Accounting installed, get profit centre of                           MD045460
126380200529      ** the alternate account                                                              MD045460
126390200529      *                                                                                     MD045460
126400200529     C           BGN0ST    IFEQ 'Y'                                                         MD045460
126410200529     C           WALT10    CHAINREACNMF              99                                     MD045460
126420200529     C           *IN99     IFEQ '1'                                                         MD045460
126430200529     C           *LOCK     IN   LDA                                                         MD045460
126440200529     C                     MOVEL'REACNMPD'DBFILE           ************                     MD045460
126450200529     C                     MOVELWALT10    DBKEY            * DBER 202 *                     MD045460
126460200529     C                     Z-ADD202       DBASE            ************                     MD045460
126470200529     C                     OUT  LDA                                                         MD045460
126480200529     C                     EXSR *PSSR                                                       MD045460
126490200529     C                     ELSE                                                             MD045460
126500200529     C                     MOVE TPRFC     PRFC                                              MD045460
126510200529     C                     ENDIF                                                            MD045460
126520200529     C                     ENDIF                                                            MD045460
126530200529      *                                                                                     MD045460
126540200529     C                     ENDIF                                                            MD045460
126550200529      *                                                                                     MD045460
126560200529     C                     ELSE                                                             MD045460
126570200529      *                                                                                     MD045460
126580200529      ** Check for the alternate account                                                    MD045460
126590200529      *                                                                                     MD045460
126600200529     C           WALTK     CHAINACCNT               N99                                     MD045460
126610200529      *                                                                                     MD045460
126620200529      ** If account does not exist or closed, do not post tax                               MD045460
126630200529      *                                                                                     MD045460
126640200529     C           *IN99     IFEQ '1'                                                         MD045460
126650200529     C           AARECI    OREQ 'C'                                                         MD045460
126660200529     C                     Z-ADD*ZERO     BCINW                                             MD045460
126670200529     C                     Z-ADD*ZERO     CINW                                              MD045460
126680200529     C                     Z-ADD*ZERO     WTIWT                                             MD045460
126690200529     C                     ELSE                                                             MD045460
126700200529      *                                                                                     MD045460
126710200529      ** Else if account is live, set up fields to post                                     MD045460
126720200529      *                                                                                     MD045460
126730200529     C                     MOVE AACNUM    CNUM                                              MD045460
126740200529     C                     MOVE AACCY     CCY                                               MD045460
126750200529     C                     MOVE 'P'       RECI                                              MD045460
126760200529     C                     Z-ADDAAACOD    ACOD                                              MD045460
126770200529     C                     Z-ADDAAACNO    ACNO                                              MD045460
126780200529     C                     MOVE AAATYP    ATYP                                              MD045460
126790200529     C                     Z-ADDAAACSQ    ACSQ                                              MD045460
126800200529     C                     MOVE ABRCA     BRCA                                              MD045460
126810200529      *                                                                                     MD045460
126820200529      ** If Analytical Accounting installed, get profit centre of                           MD045460
126830200529      ** the alternate account                                                              MD045460
126840200529      *                                                                                     MD045460
126850200529     C           BGN0ST    IFEQ 'Y'                                                         MD045460
126860200529     C           ATYP      IFEQ 'R'                                                         MD045460
126870200529     C           ATYP      OREQ 'N'                                                         MD045460
126880200529     C                     MOVE AAPRFC    PRFC                                              MD045460
126890200529     C                     ENDIF                                                            MD045460
126900200529     C                     ENDIF                                                            MD045460
126910200529     C           ATYP      IFEQ 'R'                                                         MD045460
126920200529     C                     MOVE '1'       RIND                                              MD045460
126930200529     C                     Z-ADDCNCID     VALD                                              MD045460
126940200529     C                     Z-ADDCNCID     HISD                                              MD045460
126950200529     C                     ELSE                                                             MD045460
126960200529     C*                                                                                     MD045460
126970200529     C                     Z-ADD*ZEROS    ACNO                                              MD045460
126980200529     C                     MOVE *ZERO     RIND                                              MD045460
126990200529     C                     Z-ADDRUND      VALD                                              MD045460
127000200529     C                     Z-ADDRUND      HISD                                              MD045460
127010200529     C                     ENDIF                                                            MD045460
127020200529      *                                                                                     MD045460
127030200529     C                     ENDIF                                                            MD045460
127040200529      *                                                                                     MD045460
127050200529     C                     ENDIF                                                            MD045460
127060200529      *                                                                                     MD045460
127070200529      ** Initialise account amount to be posted                                             MD045460
127080200529      *                                                                                     MD045460
127090200529     C           BCINW     IFGT 0                                                           MD045460
127100200529     C           CCY       IFEQ BCCY                                                        MD045460
127110200529     C                     Z-ADDCINW      WPSTA                                             MD045460
127120200529     C                     MOVE WOTACC    WTACC                                             MD045460
127130200529     C                     MOVE WOTACT    WATYP                                             MD045460
127140200529     C                     ELSE                                                             MD045460
127150200529     C           CCY       IFEQ BACCY                                                       MD045460
127160200529     C                     Z-ADDBCINW     WPSTA                                             MD045460
127170200529     C                     MOVE WBTACC    WTACC                                             MD045460
127180200529     C                     MOVE WBTACT    WATYP                                             MD045460
127190200529     C                     ELSE                                                             MD045460
127200200529     C                     CALL 'AOCURRR0'                                                  MD045460
127210200529     C                     PARM '*MSG   ' @RTCD                                             MD045460
127220200529     C                     PARM '*KEY   ' @OPTN                                             MD045460
127230200529     C                     PARM CCY       @CYCD   3                                         MD045460
127240200529     C           SDCURR    PARM SDCURR    DSSDY                                             MD045460
127250200529     C           @RTCD     IFNE *BLANK                                                      MD045460
127260200529     C           *LOCK     IN   LDA                                                         MD045460
127270200529     C                     MOVEL'SDCURRPD'DBFILE           **************                   MD045460
127280200529     C                     MOVEL@CYCD     DBKEY            *DB ERROR 113*                   MD045460
127290200529     C                     Z-ADD113       DBASE            **************                   MD045460
127300200529     C                     OUT  LDA                                                         MD045460
127310200529     C                     EXSR *PSSR                                                       MD045460
127320200529     C                     ENDIF                                                            MD045460
127330200529     C                     Z-ADDCDP       WACDP                                             MD045460
127340200529     C                     Z-ADDSPOT      WASPOT                                            MD045460
127350200529     C/COPY WNCPYSRC,REH00149                                                               MD045460
127360200529     C                     MOVE MDIN      WAMDIN                                            MD045460
127370200529     C                     MOVE TACC      WATACC                                            MD045460
127380200529     C                     MOVELWATACC    KACOD                                             MD045460
127390200529     C                     CALL 'AOACODR0'                                                  MD045460
127400200529     C                     PARM '*MSG   ' @RTCD                                             MD045460
127410200529     C                     PARM '*KEY   ' @OPTN                                             MD045460
127420200529     C                     PARM KACOD     @ACCD  10                                         MD045460
127430200529     C           SDACOD    PARM SDACOD    DSFDY                                             MD045460
127440200529     C           @RTCD     IFNE *BLANK                                                      MD045460
127450200529     C           *LOCK     IN   LDA                                                         MD045460
127460200529     C                     MOVEL'SDACODPD'DBFILE           ***************                  MD045460
127470200529     C                     MOVEL@ACCD     DBKEY            * DB ERROR 114*                  MD045460
127480200529     C                     Z-ADD114       DBASE            ***************                  MD045460
127490200529     C                     OUT  LDA                                                         MD045460
127500200529     C                     EXSR *PSSR                                                       MD045460
127510200529     C                     ENDIF                                                            MD045460
127520200529     C                     MOVE A5ACTY    WATACT                                            MD045460
127530200529     C                     MOVE BCCY      ZCCYI                                             MD045460
127540200529     C                     Z-ADDWOSPOT    ZRATEF                                            MD045460
127550200529     C                     MOVE WOCDP     ZCDPI                                             MD045460
127560200529     C                     MOVE WOMDIN    ZMDINF                                            MD045460
127570200529     C                     MOVE CCY       ZCCYO                                             MD045460
127580200529     C                     Z-ADDWASPOT    ZRATET                                            MD045460
127590200529     C                     MOVE WACDP     ZCDPO                                             MD045460
127600200529     C                     MOVE WAMDIN    ZMDINT                                            MD045460
127610200529     C                     Z-ADDCINW      ZAMTCI                                            MD045460
127620200529      *                                                                                     MD045460
127630200529      ** Set withholding tax conversion flag                                                MD045460
127640200529      *                                                                                     MD045460
127650200529     C                     MOVE 'Y'       @WHTF                                             MD045460
127660200529     C*                                                                                     MD045460
127670200529     C                     EXSR #CCYCN                                                      MD045460
127680200529      *                                                                                     MD045460
127690200529     C                     MOVE *BLANK    @WHTF                                             MD045460
127700200529     C*                                                                                     MD045460
127710200529     C                     Z-ADDZAMTCO    WPSTA                                             MD045460
127720200529     C                     MOVE WATACC    WTACC                                             MD045460
127730200529     C                     MOVE WATACT    WATYP                                             MD045460
127740200529     C*                                                                                     MD045460
127750200529     C                     ENDIF                                                            MD045460
127760200529     C                     ENDIF                                                            MD045460
127770200529     C                     ENDIF                                                            MD045460
127780200529     C           BBRCA     IFEQ BRCA                                                        MD045460
127790200529     C                     MOVE BBICN     WBICN                                             MD045460
127800200529     C                     ELSE                                                             MD045460
127810200529      *                                                                                     MD045460
127820200529     C                     Z-ADDCUBRCA    C                                                 MD045460
127830200529     C           BRCA      LOKUPABRC,C                   16                                 MD045460
127840200529     C           *IN16     IFEQ '1'                                                         MD045460
127850200529     C           C         OCUR SDBRCH                                                      MD045460
127860200529     C                     ELSE                                                             MD045460
127870200529     C                     CALL 'AOBRCHR0'                                                  MD045460
127880200529     C                     PARM '*MSG   ' @RTCD                                             MD045460
127890200529     C                     PARM '*KEY   ' @OPTN                                             MD045460
127900200529     C                     PARM BRCA      @BRCA   3                                         MD045460
127910200529     C           SDBRCH    PARM SDBRCH    DSFDY                                             MD045460
127920200529     C           @RTCD     IFNE *BLANK                                                      MD045460
127930200529     C           *LOCK     IN   LDA                                                         MD045460
127940200529     C                     MOVEL'SDBRCHPD'DBFILE           ***************                  MD045460
127950200529     C                     MOVEL@BRCA     DBKEY            * DB ERROR 115*                  MD045460
127960200529     C                     Z-ADD115       DBASE            ***************                  MD045460
127970200529     C                     OUT  LDA                                                         MD045460
127980200529     C                     EXSR *PSSR                                                       MD045460
127990200529     C                     ENDIF                                                            MD045460
128000200529     C                     ENDIF                                                            MD045460
128010200529     C                     MOVE BICN      WBICN                                             MD045460
128020200529     C                     ENDIF                                                            MD045460
128030200529      *                                                                                     MD045460
128040200529     C                     ELSE                                                             MD045460
128050200529     C                     MOVE BCNUM     CNUM                                              MD045460
128060200529     C                     MOVE BCCY      CCY                                               MD045460
128070200529     C                     MOVE 'P'       RECI                                              MD045460
128080200529     C                     Z-ADDBACOD     ACOD                                              MD045460
128090200529     C                     MOVE WACNO     ACNO                                              MD045460
128100200529     C                     MOVE 'R'       ATYP                                              MD045460
128110200529     C                     Z-ADDBACSQ     ACSQ                                              MD045460
128120200529     C                     MOVE BBRCA     BRCA                                              MD045460
128130200529     C                     MOVE '1'       RIND                                              MD045460
128140200529     C                     Z-ADDCNCID     VALD                                              MD045460
128150200529     C                     Z-ADDCNCID     HISD                                              MD045460
128160200529     C                     Z-ADDCINW      WPSTA                                             MD045460
128170200529     C                     MOVE WOTACC    WTACC                                             MD045460
128180200529     C                     MOVE WOTACT    WATYP                                             MD045460
128190200529     C                     MOVE BBICN     WBICN                                             MD045460
128200200529     C                     ENDIF                                                            MD045460
128210200529     C                     ENDIF                                                            MD045460
128220200529     C                     ENDIF                                                            MD045460
128230200529     C/COPY WNCPYSRC,REH00439
128240200529     C*
128250200529     C* IF STILL AMOUNT TO BE POSTED PROCESS OUTPUT.
128260200529     C*
128270200529     C********** BCINW     IFGT *ZERO                                                         260545
128280200529     C           CINW      IFGT *ZERO                                                         260545
128290200529     C/COPY WNCPYSRC,REH00440
128300200529     C*
128310200529     C           CDL013    IFEQ '1'                                                         MD040758
128320200529     C           ADJUST    ANDEQ'Y'                                                         MD040758
128330200529     C                     MOVELNAR,12    INPNAR                                            MD040758
128340200529     C                     MOVELNR16,12   INP16                                             MD040758
128350200529     C                     MOVELDN07,12   INP07                                             MD040758
128360200529     C                     MOVELMGD,12    ##MGID                                            MD040758
128370200529     C                     ELSE                                                             MD040758
128380200529     C                     MOVELNAR,5     INPNAR
128390200529     C                     MOVELNR16,5    INP16
128400200529     C                     MOVELDN07,5    INP07
128410200529     C                     MOVELMGD,5     ##MGID                          S01522
128420200529     C                     ENDIF                                                            MD040758
128430200529     C/COPY WNCPYSRC,RE3664C152
128440200529     C*
128450200529     C*
128460200529     C                     EXSR SUBNAR
128470200529     C                     MOVELNARS      PNAR
128480200529     C/COPY WNCPYSRC,RE3664C177
128490200529     C                     MOVE 'W'       WSTAX   1                                           CGL165
128500200529     C                     EXSR OUTTAX
128510200529     C                     MOVE ' '       WSTAX   1                                           CGL165
128520200529     C                     END
128530200529      *                                                                                       CGL165
128540200529      * If Secondary Tax <> 0 then call OUTTAX to generate all postings                       CGL165
128550200529      * separately for the Secondary Tax Amount                                               CGL165
128560200529     C           CGL165    IFEQ 'Y'                                                           CGL165
128570200529     C           BCINS     ANDNE0                                                             CGL165
128580200529      *                                                                                       CGL165
128590200529     C                     MOVE BCNUM     CNUM             **                                 CGL165
128600200529     C                     MOVE BCCY      CCY              **                                 CGL165
128610200529     C                     MOVE 'P'       RECI             **                                 CGL165
128620200529     C                     Z-ADDBACOD     ACOD             **                                 CGL165
128630200529     C                     MOVE WACNO     ACNO             **                                 CGL165
128640200529     C                     MOVE 'R'       ATYP             **                                 CGL165
128650200529     C                     Z-ADDBACSQ     ACSQ             **                                 CGL165
128660200529     C                     MOVE BBRCA     BRCA             **                                 CGL165
128670200529     C                     MOVE '1'       RIND             **                                 CGL165
128680200529     C                     Z-ADDCNCID     VALD             ****                               CGL165
128690200529     C                     Z-ADDCNCID     HISD             ****                               CGL165
128700200529     C                     Z-ADDCINS      WPSTA            **                                 CGL165
128710200529     C                     MOVE WOTACC    WTACC            **                                 CGL165
128720200529     C                     MOVE WOTACT    WATYP            **                                 CGL165
128730200529     C                     MOVE BBICN     WBICN            **                                 CGL165
128740200529     C                     Z-ADDCINS      CINW                                                CGL165
128750200529     C                     Z-ADDBCINS     BCINW                                               CGL165
128760200529     C                     Z-ADDLCINS     LCINW                                               CGL165
128770200529      *                                                                                       CGL165
128780200529     C                     MOVE 'S'       WSTAX   1                                           CGL165
128790200529     C                     MOVELNAR,5     INPNAR                                              CGL165
128800200529     C                     MOVELNR16,5    INP16                                               CGL165
128810200529     C                     MOVELDN07,5    INP07                                               CGL165
128820200529     C                     MOVELMGD,5     ##MGID                                              CGL165
128830200529     C                     EXSR SUBNAR                                                        CGL165
128840200529     C                     MOVELNARS      PNAR                                                CGL165
128850200529     C                     EXSR OUTTAX                                                        CGL165
128860200529     C                     MOVE ' '       WSTAX   1                                           CGL165
128870200529     C                     ENDIF                                                              CGL165
128880200529      *                                                                                       CGL165
128890200529      * Restore history balance                                           135809
128900200529     C**********           Z-ADD@RHISB    HISB                                        135809 135809R
128910200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
128920200529     C                     Z-ADD@RHISB    HISB                                              AR978914
128930200529     C                     ENDIF                                                            MD045460
128940200529     C                     MOVE ' '       ADJUST                                            MD040758
128950200529     C                     ENDSR
128960200529     C********************************************************************
128970200529     C/EJECT
128980200529     C*******************************************************************
128990200529     C*
129000200529     C** OUTTAX subroutine to post witholding taxes
129010200529     C*
129020200529     C**     Called by       - TOTTAX
129030200529     C**     Calls           -
129040200529     C*
129050200529      *****************************************************************   CCB003
129060200529     C           OUTTAX    BEGSR
129070200529     C*
129080200529     C** IF SAME CURRENCY ONLY TWO POSTINGS
129090200529     C** IF NOT USE TRADE ACCOUNT AND TRADE EQUIVALENT ACCOUNT CODE
129100200529     C*
129110200529     C** FIRST POST TO ACCOUNT ON DEBIT SIDE
129120200529     C*
129130200529     C/COPY WNCPYSRC,RE3664C015
129140200529     C*                                                                   218393
129150200529     C                     MOVE 'WTAX'    OTST                            218393
129160200529     C*                                                                   218393
129170200529     C/COPY WNCPYSRC,REH00450
129180200529     C                     EXSR GEICPR
129190200529     C/COPY WNCPYSRC,REH00451
129200200529     C*                                                                   218393
129210200529     C                     MOVEL*BLANK    OTST                            218393
129220200529     C*
129230200529     C           ATYP      IFEQ 'R'
129240200529     C           VALD      ANDLENAPDA                      - B1
129250200529     C/COPY WNCPYSRC,RE3664C071
129260200529     C*
129270200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
129280200529     C*
129290200529     C                     Z-ADDVALD      HISD
129300200529     C***********          Z-ADD30        DBASE                           CRE002
129310200529     C                     Z-ADD116       DBASE            * DB ERROR 116*CRE002
129320200529     C                     MOVE 'N'       REACT                           CCB003
129330200529     C                     WRITEREHPOSPF
129340200529     C/COPY WNCPYSRC,RE3664C178
129350200529     C                     Z-ADD*ZEROS    DBASE
129360200529     C********** CACP      IFEQ *BLANKS                                   135809
129370200529     C********** CACP      IFEQ *BLANKS                                             135809R AR978914
129380200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
129390200529     C           WWHTAL    OREQ 'Y'                                                         MD045460
129400200529     C           CACP      ANDEQ*BLANKS                                                     MD045460
129410200529     C*
129420200529     C** ACCESS POSITION RECORD FOR UPDATE OR ADD THEN UPDATE HEADER FIELD
129430200529     C*
129440200529     C***********          Z-ADD88        DBASE                           CRE002
129450200529     C                     Z-ADD117       DBASE            * DB ERROR 117*CRE002
129460200529     C           R3KEY     CHAINREHISPDF             40
129470200529     C                     Z-ADD*ZEROS    DBASE
129480200529     C           *IN40     IFEQ '1'                        - B1
129490200529     C                     MOVE 'D'       RECI
129500200529     C                     MOVE *BLANK    DLGID
129510200529     C                     Z-ADD*ZERO     VALL
129520200529     C                     MOVE *BLANKS   LINK
129530200529     C                     MOVE *BLANK    DICI
129540200529     C                     MOVE *BLANK    CICI
129550200529     C                     MOVE *BLANK    DRCI
129560200529     C                     MOVE *BLANK    CRCI
129570200529     C                     MOVE *BLANK    ALTI
129580200529     C                     Z-ADD*ZERO     DRIR
129590200529     C                     Z-ADD*ZERO     CRIR
129600200529     C                     Z-ADD*ZERO     PDID
129610200529     C                     Z-ADD*ZERO     PCID
129620200529     C                     Z-ADD*ZERO     DICT
129630200529     C                     Z-ADD*ZERO     CICT
129640200529     C                     Z-ADD*ZERO     DRCB
129650200529     C                     Z-ADD*ZERO     CRCB
129660200529     C                     MOVE *BLANK    ADTY
129670200529     C                     Z-ADD*ZERO     MNBL
129680200529     C                     Z-ADD*ZERO     CHGAR
129690200529     C                     Z-ADD*ZERO     TCHGAR
129700200529     C                     Z-ADD*ZERO     CHGAN
129710200529     C                     Z-ADD*ZERO     TCHGAN
129720200529     C                     Z-ADD*ZERO     DMVT
129730200529     C                     Z-ADD*ZERO     CMVT
129740200529     C                     Z-ADD*ZERO     DAID
129750200529     C                     Z-ADD*ZERO     MADI
129760200529     C                     Z-ADD*ZERO     TMADI
129770200529     C                     Z-ADD*ZERO     DMINT
129780200529     C                     Z-ADD*ZERO     CAID
129790200529     C                     Z-ADD*ZERO     MACI
129800200529     C                     Z-ADD*ZERO     TMACI
129810200529     C                     Z-ADD*ZERO     CMINT
129820200529     C                     Z-ADD*ZERO     MNBCP
129830200529     C                     Z-ADD*ZERO     DRCD
129840200529     C                     Z-ADD*ZERO     CRCD
129850200529     C                     Z-ADD*ZERO     VDTC
129860200529     C           DRCR      IFEQ 1                          - B2
129870200529     C                     Z-ADDPSTA      CMVT
129880200529     C                     ELSE                            - X2
129890200529     C                     Z-ADDPSTA      DMVT
129900200529     C                     END                             - E2
129910200529     C           SHISB     ADD  DMVT      HISB
129920200529     C                     SUB  CMVT      HISB
129930200529     C                     Z-ADD*ZERO     AODR                            CRE002
129940200529     C                     Z-ADD*ZERO     ODRL                            CRE002
129950200529     C                     MOVE *BLANK    ODLI                            CRE002
129960200529     C                     Z-ADD*ZERO     ODIA                            CRE002
129970200529     C***********          Z-ADD87        DBASE                           CRE002
129980200529     C                     Z-ADD118       DBASE            * DB ERROR 118*CRE002
129990200529     C                     WRITEREHISPDF
130000200529     C                     Z-ADD*ZEROS    DBASE
130010200529     C                     ELSE                            - X1
130020200529     C           DRCR      IFEQ 1                          - B2
130030200529     C                     ADD  PSTA      CMVT
130040200529     C**********           SUB  PSTA      HISB                                       048430 AR666241
130050200529     C                     ELSE                            - X2
130060200529     C                     ADD  PSTA      DMVT
130070200529     C**********           ADD  PSTA      HISB                                       048430 AR666241
130080200529     C                     END                             - E2
130090200529     C***********          Z-ADD86        DBASE                           CRE002
130100200529     C                     Z-ADD119       DBASE            * DB ERROR 119*CRE002
130110200529     C                     UPDATREHISPDF
130120200529     C                     MOVE 'Y'       FCOMIT                                            MD022410
130130200529     C                     Z-ADD*ZEROS    DBASE
130140200529     C                     END                             - E1
130150200529     C/COPY WNCPYSRC,RE3664C168
130160200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
130170200529     C                     MOVE 'Y'       BADTY
130180200529     C           SHISD     IFLT BVDTC
130190200529     C                     MOVE SHISD     BVDTC
130200200529     C                     END
130210200529      * Save updated history balance                                      135809
130220200529     C/COPY WNCPYSRC,REH00452
130230200529     C**********           Z-ADDHISB      @RHISB                                      135809 135809R
130240200529     C           WWHTAL    IFEQ 'N'                                                         MD045460
130250200529     C                     Z-ADDHISB      @RHISB                                            AR978914
130260200529     C                     ENDIF                                                            MD045460
130270200529     C/COPY WNCPYSRC,REH00453
130280200529     C**********           ELSE                                           135809
130290200529     C***UPDATE*POSITION*RECORD*FOR*ALTERNATE*ACCOUNT*PROCESSING********* 135809
130300200529     C**********           EXSR POSPR                                     135809
130310200529     C**********           END                             - E1           135809
130320200529     C**********           ELSE                                                     135809R AR978914
130330200529     C**********           EXSR POSPR                                               135809R AR978914
130340200529     C**********           END                             - E1                     135809R AR978914
130350200529     C                     ENDIF                                                            MD045460
130360200529     C*
130370200529     C                     END                             - E1
130380200529     C/COPY WNCPYSRC,REH00454
130390200529     C*
130400200529     C                     MOVE WBICN     CNUM
130410200529     C/COPY WNCPYSRC,RE3664C121
130420200529     C                     Z-ADD1         ACSQ
130430200529     C/COPY WNCPYSRC,RE3664C122
130440200529     C                     Z-SUBWPSTA     WPSTA
130450200529     C                     EXSR SUBNAR
130460200529     C                     MOVELNARS      PNAR                            B8200
130470200529     C*
130480200529     C           CCY       IFNE BACCY                      - B1
130490200529     C           CGL165    ANDNE'Y'                                                           CGL165
130500200529     C           CCY       ORNE BJLCCY                                                        CGL165
130510200529     C           CGL165    ANDEQ'Y'                                                           CGL165
130520200529     C/COPY WNCPYSRC,RE3664C016
130530200529      * Do not convert tax amount if SuppressFCCYWHTConv is 'Y'                             MD053762
130540200529     C           CDL013    IFEQ '1'                                                         MD053762
130550200529     C           W#SCON    ANDEQ'Y'                                                         MD053762
130560200529     C                     ELSE                                                             MD053762
130570200529      *                                                                   CAC001
130580200529      **  Check if profit centre can hold FX Position                     CAC001
130590200529      *                                                                   CAC001
130600200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
130610200529     C                     MOVE PRFC      WSVPC   4                       CAC001
130620200529     C                     EXSR SRPRFC                                    CAC001
130630200529     C                     ENDIF                                          CAC001
130640200529     C*
130650200529     C** POST TO SPOT TRADE ACCOUNT IN ACCOUNT CURRENCY CREDIT SIDE
130660200529     C*
130670200529      *                                                                                       239314
130680200529      ** Do not generate posting for Spot Trade Account of Base CCY                           239314
130690200529      ** if there is no Base CCY Spot Trade Account Equivalent                                239314
130700200529      *                                                                                       239314
130710200529     C           WBTACC    IFNE *BLANKS                                                       239314
130720200529     C                     MOVE SPAC      ACOD
130730200529     C                     MOVE WSPACT    ATYP
130740200529     C*
130750200529     C           ATYP      IFEQ 'R'                        ***** B2
130760200529     C                     MOVE '1'       RIND             *****
130770200529     C                     Z-ADDLCID      VALD             *****
130780200529     C***********          Z-ADDLCID      VALD             ****           060828
130790200529     C***********          Z-ADDLCID      HISD             ****           060828
130800200529     C                     Z-ADDCNCID     VALD             ****           060828
130810200529     C                     Z-ADDCNCID     HISD             ****           060828
130820200529     C*********************Z-ADDLCID      HISD             *****          093582
130830200529     C*********************EXSR WVALD                      *****    LN0106093582
130840200529     C*                                                    *****
130850200529     C** ACCOUNT IS NOT RETAIL                             *****
130860200529     C*                                                    *****
130870200529     C                     ELSE                            ***** X2
130880200529     C*                                                    *****
130890200529     C                     Z-ADD*ZEROS    ACNO             *****
130900200529     C                     MOVE *ZERO     RIND             *****
130910200529     C                     Z-ADDRUND      VALD             *****
130920200529     C                     Z-ADDRUND      HISD             *****
130930200529     C                     END                             ***** E2
130940200529     C*
130950200529     C                     EXSR GEICPR
130960200529     C*
130970200529     C           ATYP      IFEQ 'R'                        ***** B2
130980200529     C*
130990200529     C           VALD      IFLE NAPDA                      - B3
131000200529     C           *IN50     ANDEQ'0'
131010200529     C/COPY WNCPYSRC,RE3664C072
131020200529     C*
131030200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
131040200529     C*
131050200529     C                     Z-ADDVALD      HISD
131060200529     C***********          Z-ADD30        DBASE                           CRE002
131070200529     C                     Z-ADD120       DBASE            * DB ERROR 120*CRE002
131080200529     C                     MOVE 'N'       REACT                           CCB003
131090200529     C                     WRITEREHPOSPF
131100200529     C/COPY WNCPYSRC,RE3664C179
131110200529     C                     Z-ADD*ZEROS    DBASE
131120200529     C*
131130200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
131140200529     C*
131150200529     C                     EXSR POSPR
131160200529     C*
131170200529     C                     END                             - E3
131180200529     C                     END                             - E2
131190200529     C                     END                                                                239314
131200200529     C*
131210200529     C** POST TO SPOT TRADE ACCOUNT IN BASE CURRENCY DEBIT SIDE
131220200529     C*
131230200529     C                     Z-ADDBCINW     WPSTA
131240200529     C                     MOVELCCY       WWCCY   3
131250200529     C                     MOVELBACCY     CCY
131260200529      *                                                                                       CGL165
131270200529      * If CGL165 is On, this posting should be to the Spot Trade                             CGL165
131280200529      * Account in Local Currency and using the amount converted                              CGL165
131290200529      * to Local Currency so replace values                                                   CGL165
131300200529     C           CGL165    IFEQ 'Y'                                                           CGL165
131310200529     C                     Z-ADDLCINW     WPSTA                                               CGL165
131320200529     C                     MOVELBJLCCY    CCY                                                 CGL165
131330200529     C                     ENDIF                                                              CGL165
131340200529     C*
131350200529     C                     EXSR GEICPR
131360200529     C                     MOVELWWCCY     CCY
131370200529     C*
131380200529     C           ATYP      IFEQ 'R'                        ***** B2
131390200529     C*
131400200529     C           VALD      IFLE NAPDA                      - B3
131410200529     C           *IN50     ANDEQ'0'
131420200529     C/COPY WNCPYSRC,RE3664C073
131430200529     C*
131440200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
131450200529     C*
131460200529     C                     Z-ADDVALD      HISD
131470200529     C***********          Z-ADD30        DBASE                           CRE002
131480200529     C                     Z-ADD121       DBASE            * DB ERROR 121*CRE002
131490200529     C                     MOVE 'N'       REACT                           CCB003
131500200529     C                     WRITEREHPOSPF
131510200529     C/COPY WNCPYSRC,RE3664C180
131520200529     C                     Z-ADD*ZEROS    DBASE
131530200529     C*
131540200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
131550200529     C*
131560200529     C                     EXSR POSPR
131570200529     C*
131580200529     C                     END                             - E3
131590200529     C                     END                             - E2
131600200529     C*
131610200529     C** POST TO SPOT TRADE EQUIVALENT OF ACCOUNT CURRENCY DEBIT SIDE
131620200529     C*
131630200529      * If CGL165 is on,then restore Tax amount in Base Currency                              CGL165
131640200529     C           CGL165    IFEQ 'Y'                                                           CGL165
131650200529     C                     Z-ADDBCINW     WPSTA                                               CGL165
131660200529     C                     ENDIF                                                              CGL165
131670200529      *                                                                                       CGL165
131680200529     C                     MOVE WTACC     ACOD
131690200529     C                     MOVE WATYP     ATYP
131700200529     C                     MOVELCCY       WWCCY
131710200529     C                     MOVELBACCY     CCY
131720200529     C*
131730200529     C           ATYP      IFEQ 'R'                        ***** B2
131740200529     C                     MOVE '1'       RIND             *****
131750200529     C***********          Z-ADDLCID      VALD             ****           060828
131760200529     C***********          Z-ADDLCID      HISD             ****           060828
131770200529     C                     Z-ADDCNCID     VALD             ****           060828
131780200529     C                     Z-ADDCNCID     HISD             ****           060828
131790200529     C*********************EXSR WVALD                      *****    LN0106093582
131800200529     C*                                                    *****
131810200529     C** ACCOUNT IS NOT RETAIL                             *****
131820200529     C*                                                    *****
131830200529     C                     ELSE                            ***** X2
131840200529     C*                                                    *****
131850200529     C                     Z-ADD*ZEROS    ACNO             *****
131860200529     C                     MOVE *ZERO     RIND             *****
131870200529     C                     Z-ADDRUND      VALD             *****
131880200529     C                     Z-ADDRUND      HISD             *****
131890200529     C                     END                             ***** E2
131900200529     C*
131910200529     C                     EXSR GEICPR
131920200529     C                     MOVELWWCCY     CCY
131930200529     C*
131940200529     C           ATYP      IFEQ 'R'                        ***** B2
131950200529     C*
131960200529     C           VALD      IFLE NAPDA                      - B3
131970200529     C           *IN50     ANDEQ'0'
131980200529     C/COPY WNCPYSRC,RE3664C074
131990200529     C*
132000200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
132010200529     C*
132020200529     C                     Z-ADDVALD      HISD
132030200529     C***********          Z-ADD30        DBASE                           CRE002
132040200529     C                     Z-ADD122       DBASE            * DB ERROR 122*CRE002
132050200529     C                     MOVE 'N'       REACT                           CCB003
132060200529     C                     WRITEREHPOSPF
132070200529     C/COPY WNCPYSRC,RE3664C181
132080200529     C                     Z-ADD*ZEROS    DBASE
132090200529     C*
132100200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
132110200529     C*
132120200529     C                     EXSR POSPR
132130200529     C*
132140200529     C                     END                             - E3
132150200529     C                     END                             - E2
132160200529     C*
132170200529     C** POST TO SPOT TRADE EQUIVALENT OF BASE CURRENCY CREDIT SIDE
132180200529     C*
132190200529      *                                                                                       239314
132200200529      ** Do not generate posting for Spot Trade Equivalent of Base CCY                        239314
132210200529      ** if there is no Base CCY Spot Trade Account Equivalent                                239314
132220200529      *                                                                                       239314
132230200529     C           WBTACC    IFNE *BLANKS                                                       239314
132240200529     C                     MOVE WBTACC    ACOD
132250200529     C                     MOVE WBTACT    ATYP
132260200529     C                     Z-SUBWPSTA     WPSTA
132270200529     C                     MOVELCCY       WWCCY
132280200529     C                     MOVELBACCY     CCY
132290200529     C*
132300200529      * If CGL165 is On, this posting should be to the Spot Trade                             CGL165
132310200529      * Equivalent of Local Currency so replace values                                        CGL165
132320200529     C           CGL165    IFEQ 'Y'                                                           CGL165
132330200529     C                     MOVE WLTACC    ACOD                                                CGL165
132340200529     C                     MOVE WLTACT    ATYP                                                CGL165
132350200529     C                     Z-SUBBCINW     WPSTA                                               CGL165
132360200529     C                     ENDIF                                                              CGL165
132370200529     C/COPY WNCPYSRC,RE3664CP23                                           S01408
132380200529     C*                                                                   S01408
132390200529     C           ATYP      IFEQ 'R'                        ***** B2
132400200529     C                     MOVE '1'       RIND             *****
132410200529     C***********          Z-ADDLCID      VALD             ****           060828
132420200529     C***********          Z-ADDLCID      HISD             ****           060828
132430200529     C                     Z-ADDCNCID     VALD             ****           060828
132440200529     C                     Z-ADDCNCID     HISD             ****           060828
132450200529     C*********************EXSR WVALD                      *****    LN0106093582
132460200529     C*                                                    *****
132470200529     C** ACCOUNT IS NOT RETAIL                             *****
132480200529     C*                                                    *****
132490200529     C                     ELSE                            ***** X2
132500200529     C*                                                    *****
132510200529     C                     Z-ADD*ZEROS    ACNO             *****
132520200529     C                     MOVE *ZERO     RIND             *****
132530200529     C                     Z-ADDRUND      VALD             *****
132540200529     C                     Z-ADDRUND      HISD             *****
132550200529     C                     END                             ***** E2
132560200529     C*
132570200529     C                     EXSR GEICPR
132580200529     C                     END                                                                239314
132590200529     C                     MOVELWWCCY     CCY
132600200529     C*
132610200529     C           ATYP      IFEQ 'R'                        ***** B2
132620200529     C*
132630200529     C           VALD      IFLE NAPDA                      - B3
132640200529     C           *IN50     ANDEQ'0'
132650200529     C/COPY WNCPYSRC,RE3664C075
132660200529     C*
132670200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
132680200529     C*
132690200529     C                     Z-ADDVALD      HISD
132700200529     C***********          Z-ADD30        DBASE                           CRE002
132710200529     C                     Z-ADD123       DBASE            * DB ERROR 123*CRE002
132720200529     C                     MOVE 'N'       REACT                           CCB003
132730200529     C                     WRITEREHPOSPF
132740200529     C/COPY WNCPYSRC,RE3664C182
132750200529     C                     Z-ADD*ZEROS    DBASE
132760200529     C*
132770200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
132780200529     C*
132790200529     C                     EXSR POSPR
132800200529     C*
132810200529     C                     END                             - E3
132820200529     C                     END                             - E2
132830200529      *                                                                   CAC001
132840200529      **  Restore saved profit centre                                     CAC001
132850200529      *                                                                   CAC001
132860200529     C           BGN0ST    IFEQ 'Y'                                       CAC001
132870200529     C                     MOVE WSVPC     PRFC                            CAC001
132880200529     C                     ENDIF                                          CAC001
132890200529     C                     ENDIF                                                            MD053762
132900200529     C                     END                             - E1
132910200529     C*
132920200529     C** POST TO WITHOLDING TAX ACCOUNT IN BASE CURRENCY CREDIT SIDE
132930200529     C*
132940200529     C/COPY WNCPYSRC,RE3664C134
132950200529     C                     MOVE WWTAC     ACOD
132960200529     C                     MOVE WTWTAC    ATYP
132970200529     C                     MOVELCCY       WWCCY
132980200529     C/COPY WNCPYSRC,REH00455
132990200529      * Post tax in account currency if SuppressFCCYWHTConv is 'Y'                          MD053762
133000200529     C           CDL013    IFEQ '1'                                                         MD053762
133010200529     C           W#SCON    ANDEQ'Y'                                                         MD053762
133020200529     C                     ELSE                                                             MD053762
133030200529     C                     MOVELBACCY     CCY                                               MD053762
133040200529     C                     ENDIF                                                            MD053762
133050200529     C/COPY WNCPYSRC,RE3664C017
133060200529      * If CGL165 is On, set up correct internal tax account to post tax to                   CGL165
133070200529     C           CGL165    IFEQ 'Y'                                                           CGL165
133080200529      *                                                                                       CGL165
133090200529     C           WSTAX     IFEQ 'W'                                                           CGL165
133100200529     C           ATTXC1    CHAINSDWTRCL0             99                                       CGL165
133110200529     C           *IN99     IFEQ *OFF                                                          CGL165
133120200529     C                     MOVELRITAC     ACOD                                                CGL165
133130200529     C                     ENDIF                                                              CGL165
133140200529     C                     ELSE                                                               CGL165
133150200529     C           ATTXC2    CHAINSDWTRCL0             99                                       CGL165
133160200529     C           *IN99     IFEQ *OFF                                                          CGL165
133170200529     C                     MOVELRITAC     ACOD                                                CGL165
133180200529     C                     ENDIF                                                              CGL165
133190200529     C                     ENDIF                                                              CGL165
133200200529      *                                                                                       CGL165
133210200529      * Replace amount with Local Currency Amount and Currency with Local                     CGL165
133220200529      * Currency                                                                              CGL165
133230200529     C                     Z-SUBLCINW     WPSTA                                               CGL165
133240200529     C                     MOVELCCY       WWCCY                                               CGL165
133250200529     C                     MOVELBJLCCY    CCY                                                 CGL165
133260200529     C                     ENDIF                                                              CGL165
133270200529      *                                                                                       CDL013
133280200529      ** If CDL013 installed, check the Acc Type & update WHT Acc Code                        CDL013
133290200529     C           CDL013    IFEQ '1'                                                           CDL013
133300200529      *                                                                                       CDL013
133310200529     C           BBCSTY    IFEQ 'R'                                                           CDL013
133320200529     C                     MOVE WRETAC    ACOD                                                CDL013
133330200529     C                     ENDIF                                                              CDL013
133340200529      *                                                                                       CDL013
133350200529     C           BBCSTY    IFEQ 'C'                                                           CDL013
133360200529     C                     MOVE WCOTAC    ACOD                                                CDL013
133370200529     C                     ENDIF                                                              CDL013
133380200529      *                                                                                       CDL013
133390200529     C                     ENDIF                                                              CDL013
133400200529     C*
133410200529     C           ATYP      IFEQ 'R'                        ***** B1
133420200529     C                     MOVE '1'       RIND             *****
133430200529     C***********          Z-ADDLCID      VALD             ****           060828
133440200529     C***********          Z-ADDLCID      HISD             ****           060828
133450200529     C                     Z-ADDCNCID     VALD             ****           060828
133460200529     C                     Z-ADDCNCID     HISD             ****           060828
133470200529     C*********************EXSR WVALD                      ****           106604
133480200529     C*                                                    *****
133490200529     C** ACCOUNT IS NOT RETAIL                             *****
133500200529     C*                                                    *****
133510200529     C                     ELSE                            ***** X1
133520200529     C*                                                    *****
133530200529     C                     Z-ADD*ZEROS    ACNO             *****
133540200529     C                     MOVE *ZERO     RIND             *****
133550200529     C                     Z-ADDRUND      VALD             *****
133560200529     C                     Z-ADDRUND      HISD             *****
133570200529     C                     END                             ***** E1
133580200529     C*
133590200529     C                     EXSR GEICPR
133600200529     C/COPY WNCPYSRC,REH00020
133610200529     C                     MOVELWWCCY     CCY
133620200529     C*
133630200529     C           ATYP      IFEQ 'R'                        ***** B1
133640200529     C*
133650200529     C           VALD      IFLE NAPDA                      - B2
133660200529     C           *IN50     ANDEQ'0'
133670200529     C/COPY WNCPYSRC,RE3664C076
133680200529     C*
133690200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
133700200529     C*
133710200529     C                     Z-ADDVALD      HISD
133720200529     C***********          Z-ADD30        DBASE                           CRE002
133730200529     C                     Z-ADD124       DBASE            * DB ERROR 124*CRE002
133740200529     C                     MOVE 'N'       REACT                           CCB003
133750200529     C/COPY WNCPYSRC,REH00021
133760200529     C                     WRITEREHPOSPF
133770200529     C/COPY WNCPYSRC,RE3664C183
133780200529     C                     Z-ADD*ZEROS    DBASE
133790200529     C*
133800200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
133810200529     C*
133820200529     C                     EXSR POSPR
133830200529     C*
133840200529     C                     END                             - E2
133850200529     C                     END                             - E1
133860200529      *                                                                                       CDL013
133870200529      ** If CDL013 installed, update WHT files                                                CDL013
133880200529     C           CDL013    IFEQ '1'                                                           CDL013
133890200529      *                                                                                       CDL013
133900200529      ** Set the key fields for WHT by Customer history file                                  CDL013
133910200529     C                     MOVE BCNUM     ECUST                                               CDL013
133920200529     C                     Z-ADDAAACNO    EDLAC                                               CDL013
133930200529     C                     MOVE 'R'       EDAIN                                               CDL013
133940200529      *                                                                                       CDL013
133950200529      ** Access WHT by Customer history file                                                  CDL013
133960200529     C           HISKEY    CHAINGLWHTCL0             40                                       CDL013
133970200529      *                                                                                       CDL013
133980200529      ** If record NOT found                                                                  CDL013
133990200529     C           *IN40     IFEQ '1'                                                           CDL013
134000200529      *                                                                                       CDL013
134010200529      ** Set up the fields to write a new record                                              CDL013
134020200529     C                     MOVE BBRCA     EBRCA                                               CDL013
134030200529     C                     MOVE BCCY      ECURR                                               CDL013
134040200529     C                     Z-ADDWTIWT     ECRTM                                               CDL013
134050200529     C                     Z-ADDCINW      EWTTM                                               CDL013
134060200529     C                     Z-ADDWTIWT     ECRYD                                               CDL013
134070200529     C                     Z-ADDCINW      EWTYD                                               CDL013
134080200529     C                     Z-ADDWTIWT     ECRTO                                               CDL013
134090200529     C                     Z-ADDCINW      EWTTO                                               CDL013
134100200529     C                     Z-ADDWRATE     EWTRT                                               CDL013
134110200529     C/COPY WNCPYSRC,REH00022
134120200529      *                                                                                       CDL013
134130200529      ** Write a new record                                                                   CDL013
134140200529     C                     WRITEGLWHTCD0                                                      CDL013
134150200529      *                                                                                       CDL013
134160200529      *                                                                                       CDL013
134170200529      ** If record found, update Interest & WHT fields                                        CDL013
134180200529     C                     ELSE                                                               CDL013
134190200529      *                                                                                       CDL013
134200200529     C                     ADD  WTIWT     ECRTM                                               CDL013
134210200529     C                     ADD  CINW      EWTTM                                               CDL013
134220200529     C                     ADD  WTIWT     ECRYD                                               CDL013
134230200529     C                     ADD  CINW      EWTYD                                               CDL013
134240200529     C                     ADD  WTIWT     ECRTO                                               CDL013
134250200529     C                     ADD  CINW      EWTTO                                               CDL013
134260200529     C/COPY WNCPYSRC,REH00023
134270200529      *                                                                                       CDL013
134280200529      ** Update the record                                                                    CDL013
134290200529     C                     UPDATGLWHTCD0                                                      CDL013
134300200529     C                     ENDIF                                                              CDL013
134310200529     C/COPY WNCPYSRC,REH00150
134320200529      *----------------------------------------------------------------                       CDL013
134330200529      *                                                                                       CDL013
134340200529      ** If Retail Account for non-base Ccy                                                   CDL013
134350200529     C           AAATYP    IFEQ 'R'                                                           CDL013
134360200529     C           BCCY      ANDNEBACCY                                                         CDL013
134370200529      *                                                                                       CDL013
134380200529      ** Set up the fields to write a new record to the                                       CDL013
134390200529      ** Dealing/Retail Tax Details extract file                                              CDL013
134400200529     C                     MOVE BCNUM     ECUST                                               CDL013
134410200529     C                     Z-ADDAAACNO    EDLAC                                               CDL013
134420200529     C                     MOVE 'R'       EDAIN                                               CDL013
134430200529     C                     MOVE BBRCA     EBRCA                                               CDL013
134440200529     C                     MOVE BCCY      ECURR                                               CDL013
134450200529     C                     MOVE BACOD     EACCD                                               CDL013
134460200529     C                     Z-ADDBACSQ     EACSQ                                               CDL013
134470200529     C                     Z-ADDCINW      ETAXA                                               CDL013
134480200529     C                     Z-ADDCNCID     EVDAT                                               CDL013
134490200529      *                                                                                       CDL013
134500200529      ** Write a record                                                                       CDL013
134510200529     C                     WRITEGLXTAXD0                                                      CDL013
134520200529      *                                                                                       CDL013
134530200529     C                     ENDIF                                                              CDL013
134540200529     C                     ENDIF                                                              CDL013
134550200529      *                                                                                       CDL013
134560200529      *                                                                                       CDL013
134570200529     C*                                                                   S01408
134580200529     C/COPY WNCPYSRC,RE3664CP24                                           S01408
134590200529     C*                                                                   S01408
134600200529     C                     ENDSR
134610200529     C*******************************************************************
134620200529     C/EJECT                                                              LN0106
134630200529     C******************************************************************* LN0106
134640200529     C*                                                                   LN0106
134650200529     C** WVALD subroutine for Withholding Tax Value date                  LN0106
134660200529     C*                                                                   LN0106
134670200529     C**     Called by       - TAXPOS, OUTTAX                             LN0106
134680200529     C**     Calls           -                                            LN0106
134690200529     C*                                                                   LN0106
134700200529      *****************************************************************   CCB003
134710200529     C           WVALD     BEGSR                                          LN0106
134720200529     C*                                                                   LN0106
134730200529     C           LDAC      IFNE 'Y'                                       LN0106
134740200529     C                     ADD  1         VALD                            LN0106
134750200529     C                     ADD  1         HISD                            LN0106
134760200529     C                     END                                            LN0106
134770200529     C*                                                                   LN0106
134780200529     C                     ENDSR                                          LN0106
134790200529     C******************************************************************* LN0106
134800200529     C/EJECT
134810200529     C/COPY WNCPYSRC,REH00441
134820200529     C*******************************************************************
134830200529     C*
134840200529     C** TDISR subroutine to post total debit interest
134850200529     C*
134860200529     C**     Called by       - TOTTAX
134870200529     C**     Calls           -
134880200529     C*
134890200529      *****************************************************************   CCB003
134900200529     C           TDISR     BEGSR
134910200529     C*
134920200529     C           WDIWT     IFNE 0                          - B1
134930200529     C* If Withholding tax account codes are the same then suppress       131825
134940200529     C* postings as net amout will be zero to the same account.           131825
134950200529     C           WDIPD     ANDNEWDIPC                                     131825
134960200529     C*
134970200529     C** POST TO DEBIT INTEREST PAYMENT DEBIT ACCOUNT CODE DEBIT SIDE
134980200529     C*
134990200529     C                     MOVELNAR,6     INPNAR
135000200529     C                     MOVELNR16,6    INP16
135010200529     C                     MOVELDN07,6    INP07
135020200529     C                     MOVELMGD,6     ##MGID                          S01522
135030200529     C/COPY WNCPYSRC,RE3664C153
135040200529     C*
135050200529     C                     Z-ADDWDIWT     WPSTA
135060200529     C                     MOVE WDIPD     ACOD
135070200529     C                     MOVE WTDIPD    ATYP
135080200529     C                     MOVE BBRCA     BRCA
135090200529     C                     MOVE BBICN     CNUM
135100200529     C/COPY WNCPYSRC,RE3664C123
135110200529     C           WINT      IFEQ 'Y'                                                           CRE100
135120200529     C                     MOVE BCNUM     CNUM                                                CRE100
135130200529     C                     ENDIF                                                              CRE100
135140200529     C                     Z-ADD1         ACSQ
135150200529      * Account Sequence                                                                    MD034990
135160200529     C           RETSEQ    IFEQ 'Y'                                                         MD034990
135170200529     C                     MOVE BACSQ     ACSQ                                              MD034990
135180200529     C                     ENDIF                                                            MD034990
135190200529     C/COPY WNCPYSRC,RE3664C124
135200200529     C*
135210200529     C           ATYP      IFEQ 'R'                        ***** B2
135220200529     C                     MOVE '1'       RIND             *****
135230200529     C***********          Z-ADDLCID      VALD             ****           060828
135240200529     C***********          Z-ADDLCID      HISD             ****           060828
135250200529     C                     Z-ADDCNCID     VALD             ****           060828
135260200529     C                     Z-ADDCNCID     HISD             ****           060828
135270200529     C*                                                    *****
135280200529     C** ACCOUNT IS NOT RETAIL                             *****
135290200529     C*                                                    *****
135300200529     C                     ELSE                            ***** X2
135310200529     C*                                                    *****
135320200529     C                     Z-ADD*ZEROS    ACNO
135330200529     C                     MOVE *ZERO     RIND             *****
135340200529     C                     Z-ADDRUND      VALD             *****
135350200529     C                     Z-ADDRUND      HISD             *****
135360200529     C                     END                             ***** E2
135370200529     C*
135380200529     C                     EXSR SUBNAR
135390200529     C                     MOVE NARS      PNAR
135400200529     C/COPY WNCPYSRC,RE3664C154
135410200529     C           ATYP      IFEQ 'R'                                                           CER049
135420200529     C                     MOVE 'DEB INT' ZZ007                                               CER049
135430200529     C                     END                                                                CER049
135440200529     C                     EXSR GEICPR
135450200529     C*
135460200529     C           ATYP      IFEQ 'R'                        ***** B2
135470200529     C*
135480200529     C           VALD      IFLE NAPDA                      - B3
135490200529     C           *IN50     ANDEQ'0'
135500200529     C/COPY WNCPYSRC,RE3664C077
135510200529     C*
135520200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
135530200529     C*
135540200529     C                     Z-ADDVALD      HISD
135550200529     C***********          Z-ADD30        DBASE                           CRE002
135560200529     C                     Z-ADD125       DBASE            * DB ERROR 125*CRE002
135570200529     C                     MOVE 'N'       REACT                           CCB003
135580200529     C                     WRITEREHPOSPF
135590200529     C                     Z-ADD*ZEROS    DBASE
135600200529     C*
135610200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
135620200529     C*
135630200529     C                     EXSR POSPR
135640200529     C*
135650200529     C                     END                             - E3
135660200529     C                     END                             - E2
135670200529     C*
135680200529     C** POST TO DEBIT INTEREST PAYMENT CREDIT ACCOUNT CODE
135690200529     C*
135700200529     C                     Z-SUBWPSTA     WPSTA
135710200529     C                     MOVE WDIPC     ACOD
135720200529     C                     MOVE WTDIPC    ATYP
135730200529     C*
135740200529     C           ATYP      IFEQ 'R'                        ***** B2
135750200529     C                     MOVE '1'       RIND             *****
135760200529     C***********          Z-ADDLCID      VALD             ****           060828
135770200529     C***********          Z-ADDLCID      HISD             ****           060828
135780200529     C                     Z-ADDCNCID     VALD             ****           060828
135790200529     C                     Z-ADDCNCID     HISD             ****           060828
135800200529     C*                                                    *****
135810200529     C** ACCOUNT IS NOT RETAIL                             *****
135820200529     C*                                                    *****
135830200529     C                     ELSE                            ***** X2
135840200529     C*                                                    *****
135850200529     C                     Z-ADD*ZEROS    ACNO
135860200529     C                     MOVE *ZERO     RIND             *****
135870200529     C                     Z-ADDRUND      VALD             *****
135880200529     C                     Z-ADDRUND      HISD             *****
135890200529     C                     END                             ***** E2
135900200529     C*
135910200529     C/COPY WNCPYSRC,RE3664C208
135920200529     C           ZZ007     IFEQ 'DEB INT'                                                     CER049
135930200529     C                     MOVE *BLANKS   ZZ007                                               CER049
135940200529     C                     END                                                                CER049
135950200529     C                     EXSR GEICPR
135960200529     C*
135970200529     C           ATYP      IFEQ 'R'                        ***** B2
135980200529     C*
135990200529     C           VALD      IFLE NAPDA                      - B3
136000200529     C           *IN50     ANDEQ'0'
136010200529     C/COPY WNCPYSRC,RE3664C078
136020200529     C*
136030200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
136040200529     C*
136050200529     C                     Z-ADDVALD      HISD
136060200529     C***********          Z-ADD30        DBASE                           CRE002
136070200529     C                     Z-ADD126       DBASE            * DB ERROR 126*CRE002
136080200529     C                     MOVE 'N'       REACT                           CCB003
136090200529     C                     WRITEREHPOSPF
136100200529     C                     Z-ADD*ZEROS    DBASE
136110200529     C*
136120200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
136130200529     C*
136140200529     C                     EXSR POSPR
136150200529     C*
136160200529     C                     END                             - E3
136170200529     C                     END                             - E2
136180200529     C                     END                             - E1
136190200529     C                     ENDSR
136200200529     C*******************************************************************
136210200529     C/EJECT
136220200529     C*******************************************************************
136230200529     C*
136240200529     C** TCISR subroutine to post total credit interest
136250200529     C*
136260200529     C**     Called by       - TOTTAC
136270200529     C**     Calls           -
136280200529     C*
136290200529      *****************************************************************   CCB003
136300200529     C           TCISR     BEGSR
136310200529     C*
136320200529     C                     MOVE BBRCA     BRCA
136330200529     C                     MOVE BBICN     CNUM
136340200529     C/COPY WNCPYSRC,RE3664C125
136350200529     C           WINT      IFEQ 'Y'                                                           CRE100
136360200529     C                     MOVE BCNUM     CNUM                                                CRE100
136370200529     C                     ENDIF                                                              CRE100
136380200529     C                     Z-ADD1         ACSQ
136390200529      * Account Sequence                                                                    MD034990
136400200529     C           RETSEQ    IFEQ 'Y'                                                         MD034990
136410200529     C                     MOVE BACSQ     ACSQ                                              MD034990
136420200529     C                     ENDIF                                                            MD034990
136430200529     C/COPY WNCPYSRC,RE3664C126
136440200529     C* If Withholding tax account codes are the same then suppress       131825
136450200529     C* postings as net amout will be zero to the same account.           131825
136460200529     C           WCIPC     IFNE WCISU                                     131825
136470200529     C           WCIPC     ANDNEWCINS                                     131825
136480200529     C*
136490200529     C           WCIWT     IFNE 0                          - B1
136500200529     C*
136510200529     C** POST TO CREDIT INTEREST PAYMENT CREDIT ACCOUNT CODE CREDIT SIDE
136520200529     C*
136530200529     C                     MOVELNAR,7     INPNAR
136540200529     C                     MOVELNR16,7    INP16
136550200529     C                     MOVELDN07,7    INP07
136560200529     C                     MOVELMGD,7     ##MGID                          S01522
136570200529     C/COPY WNCPYSRC,RE3664C155
136580200529     C*
136590200529     C                     Z-SUBWCIWT     WPSTA
136600200529     C                     MOVE WCIPC     ACOD
136610200529     C                     MOVE WTCIPC    ATYP
136620200529     C*
136630200529     C           ATYP      IFEQ 'R'                        ***** B2
136640200529     C                     MOVE '1'       RIND             *****
136650200529     C***********          Z-ADDLCID      VALD             ****           060828
136660200529     C***********          Z-ADDLCID      HISD             ****           060828
136670200529     C                     Z-ADDCNCID     VALD             ****           060828
136680200529     C                     Z-ADDCNCID     HISD             ****           060828
136690200529     C*                                                    *****
136700200529     C** ACCOUNT IS NOT RETAIL                             *****
136710200529     C*                                                    *****
136720200529     C                     ELSE                            ***** X2
136730200529     C*                                                    *****
136740200529     C                     Z-ADD*ZEROS    ACNO
136750200529     C                     MOVE *ZERO     RIND             *****
136760200529     C                     Z-ADDRUND      VALD             *****
136770200529     C                     Z-ADDRUND      HISD             *****
136780200529     C                     END                             ***** E2
136790200529     C*
136800200529     C                     EXSR SUBNAR
136810200529     C                     MOVELNARS      PNAR
136820200529     C                     EXSR GEICPR
136830200529     C*
136840200529     C           ATYP      IFEQ 'R'                        ***** B2
136850200529     C*
136860200529     C           VALD      IFLE NAPDA                      - B3
136870200529     C           *IN50     ANDEQ'0'
136880200529     C/COPY WNCPYSRC,RE3664C079
136890200529     C*
136900200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
136910200529     C*
136920200529     C                     Z-ADDVALD      HISD
136930200529     C***********          Z-ADD30        DBASE                           CRE002
136940200529     C                     Z-ADD127       DBASE            * DB ERROR 127*CRE002
136950200529     C                     MOVE 'N'       REACT                           CCB003
136960200529     C                     WRITEREHPOSPF
136970200529     C                     Z-ADD*ZEROS    DBASE
136980200529     C*
136990200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
137000200529     C*
137010200529     C                     EXSR POSPR
137020200529     C*
137030200529     C                     END                             - E3
137040200529     C                     END                             - E2
137050200529     C                     END                             - E1
137060200529     C*
137070200529     C           WCIWT     SUB  WTIWT     WPSTA
137080200529     C*
137090200529     C** POST TO CREDIT INTEREST PAYMENT DEBIT NOT SUBJECT TO TAX
137100200529     C*
137110200529     C           WPSTA     IFNE 0                          - B1
137120200529     C                     MOVELNAR,9     INPNAR
137130200529     C                     MOVELNR16,9    INP16
137140200529     C                     MOVELDN07,9    INP07
137150200529     C                     MOVELMGD,9     ##MGID                          S01522
137160200529     C/COPY WNCPYSRC,RE3664C156
137170200529     C*
137180200529     C                     MOVE WCINS     ACOD
137190200529     C                     MOVE WTCINS    ATYP
137200200529     C*
137210200529     C           ATYP      IFEQ 'R'                        ***** B2
137220200529     C                     MOVE '1'       RIND             *****
137230200529     C***********          Z-ADDLCID      VALD             ****           060828
137240200529     C***********          Z-ADDLCID      HISD             ****           060828
137250200529     C                     Z-ADDCNCID     VALD             ****           060828
137260200529     C                     Z-ADDCNCID     HISD             ****           060828
137270200529     C*                                                    *****
137280200529     C** ACCOUNT IS NOT RETAIL                             *****
137290200529     C*                                                    *****
137300200529     C                     ELSE                            ***** X2
137310200529     C*                                                    *****
137320200529     C                     Z-ADD*ZEROS    ACNO
137330200529     C                     MOVE *ZERO     RIND             *****
137340200529     C                     Z-ADDRUND      VALD             *****
137350200529     C                     Z-ADDRUND      HISD             *****
137360200529     C                     END                             ***** E2
137370200529     C*
137380200529     C                     EXSR SUBNAR
137390200529     C                     MOVELNARS      PNAR
137400200529     C                     EXSR GEICPR
137410200529     C*
137420200529     C           ATYP      IFEQ 'R'                        ***** B2
137430200529     C*
137440200529     C           VALD      IFLE NAPDA                      - B3
137450200529     C           *IN50     ANDEQ'0'
137460200529     C/COPY WNCPYSRC,RE3664C080
137470200529     C*
137480200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
137490200529     C*
137500200529     C                     Z-ADDVALD      HISD
137510200529     C***********          Z-ADD30        DBASE                           CRE002
137520200529     C                     Z-ADD128       DBASE            * DB ERROR 128*CRE002
137530200529     C                     MOVE 'N'       REACT                           CCB003
137540200529     C                     WRITEREHPOSPF
137550200529     C                     Z-ADD*ZEROS    DBASE
137560200529     C*
137570200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
137580200529     C*
137590200529     C                     EXSR POSPR
137600200529     C*
137610200529     C                     END                             - E3
137620200529     C                     END                             - E2
137630200529     C                     END                             - E1
137640200529     C*
137650200529     C** POST TO CREDIT INTEREST PAYMENT DEBIT SUBJECT TO TAX
137660200529     C*
137670200529     C           WTIWT     IFNE 0                          - B1
137680200529     C                     MOVELNAR,8     INPNAR
137690200529     C                     MOVELNR16,8    INP16
137700200529     C                     MOVELDN07,8    INP07
137710200529     C                     MOVELMGD,8     ##MGID                          S01522
137720200529     C/COPY WNCPYSRC,RE3664C157
137730200529     C*
137740200529     C                     MOVE WCISU     ACOD
137750200529     C                     Z-ADDWTIWT     WPSTA
137760200529     C                     MOVE WTCISU    ATYP
137770200529     C*
137780200529     C           ATYP      IFEQ 'R'                        ***** B2
137790200529     C                     MOVE '1'       RIND             *****
137800200529     C***********          Z-ADDLCID      VALD             ****           060828
137810200529     C***********          Z-ADDLCID      HISD             ****           060828
137820200529     C                     Z-ADDCNCID     VALD             ****           060828
137830200529     C                     Z-ADDCNCID     HISD             ****           060828
137840200529     C*                                                    *****
137850200529     C** ACCOUNT IS NOT RETAIL                             *****
137860200529     C*                                                    *****
137870200529     C                     ELSE                            ***** X2
137880200529     C*                                                    *****
137890200529     C                     Z-ADD*ZEROS    ACNO
137900200529     C                     MOVE *ZERO     RIND             *****
137910200529     C                     Z-ADDRUND      VALD             *****
137920200529     C                     Z-ADDRUND      HISD             *****
137930200529     C                     END                             ***** E2
137940200529     C*
137950200529     C                     EXSR SUBNAR
137960200529     C                     MOVELNARS      PNAR
137970200529     C                     EXSR GEICPR
137980200529     C*
137990200529     C           ATYP      IFEQ 'R'                        ***** B2
138000200529     C*
138010200529     C           VALD      IFLE NAPDA                      - B3
138020200529     C           *IN50     ANDEQ'0'
138030200529     C/COPY WNCPYSRC,RE3664C081
138040200529     C*
138050200529     C** WRITE NEW RECORD IN RETAIL HISTORY FILE - POSTINGS
138060200529     C*
138070200529     C                     Z-ADDVALD      HISD
138080200529     C***********          Z-ADD30        DBASE                           CRE002
138090200529     C                     Z-ADD129       DBASE            * DB ERROR 129*CRE002
138100200529     C                     MOVE 'N'       REACT                           CCB003
138110200529     C                     WRITEREHPOSPF
138120200529     C                     Z-ADD*ZEROS    DBASE
138130200529     C*
138140200529     C** UPDATE POSITION RECORD FOR ALTERNATE ACCOUNT PROCESSING
138150200529     C*
138160200529     C                     EXSR POSPR
138170200529     C*
138180200529     C                     END                             - E3
138190200529     C                     END                             - E2
138200200529     C                     END                             - E1
138210200529     C                     END                                            131825
138220200529     C                     ENDSR
138230200529     C********************************************************************
138240200529      /EJECT                                                              CAC001
138250200529      *****************************************************************   CAC001
138260200529      **                                                              *   CAC001
138270200529      **   SRPRFC - Subroutine to determine if Profit Centre can      *   CAC001
138280200529      **            hold FX Position                                  *   CAC001
138290200529      **                                                              *   CAC001
138300200529      **   Called by: CCYSR, CREPR, OUTTAX                            *   CAC001
138310200529      **                                                              *   CAC001
138320200529      **   Calls    : *PSSR                                           *   CAC001
138330200529      **                                                              *   CAC001
138340200529      *****************************************************************   CAC001
138350200529     C           SRPRFC    BEGSR                                          CAC001
138360200529      *                                                                   CAC001
138370200529      **  Access Profit Centre details via access object                  CAC001
138380200529      *                                                                   CAC001
138390200529     C                     CALL 'AOPRFCR0'                                CAC001
138400200529     C                     PARM *BLANKS   WRTCD   7                       CAC001
138410200529     C                     PARM '*KEY   ' WOPTN   7                       CAC001
138420200529     C                     PARM PRFC      WPRFC   4                       CAC001
138430200529     C           SDPRFC    PARM SDPRFC    DSFDY                           CAC001
138440200529      *                                                                   CAC001
138450200529      **  Database error if not found                                     CAC001
138460200529      *                                                                   CAC001
138470200529     C           WRTCD     IFNE *BLANKS                                   CAC001
138480200529     C           *LOCK     IN   LDA                                       CAC001
138490200529     C                     Z-ADD203       DBASE            ************   CAC001
138500200529     C                     MOVELPRFC      DBKEY            * DBER 203 *   CAC001
138510200529     C                     MOVEL'SDPRFCPD'DBFILE           ************   CAC001
138520200529     C                     OUT  LDA                                       CAC001
138530200529     C                     EXSR *PSSR                                     CAC001
138540200529     C                     ELSE                                           CAC001
138550200529      *                                                                   CAC001
138560200529      **  Use FX Position Profit Centre if it is not blank                CAC001
138570200529      *                                                                   CAC001
138580200529     C           DSFPPC    IFNE *BLANK                                    CAC001
138590200529     C                     MOVE DSFPPC    PRFC                            CAC001
138600200529     C                     ENDIF                                          CAC001
138610200529     C                     ENDIF                                          CAC001
138620200529      *                                                                   CAC001
138630200529     C                     ENDSR                                          CAC001
138640200529      ********************************************************************CAC001
138650200529     C* SUBROUTINE TO ADD AN AMOUNT (ZZAMT) TO THE TOTAL (ZZTOTI,ZZTOTD)
138660200529     C*   IND '99' IS SET BY AN OVERFLOW ERROR
138670200529     C*
138680200529     CSR         GLZADD    BEGSR                           *** GLZADD ****
138690200529     C*
138700200529     CSR                   Z-ADDZZAMT     ZZAMT  153     91-DEFINE ZZAMT
138710200529     CSR 91                GOTO ZZAEND                     AMT = 0.BYPASS
138720200529     C*
138730200529     C* SPLIT ZZAMT INTO INTEGER AND DECIMAL FIELDS
138740200529     CSR                   Z-ADDZZAMT     ZZAMTI 150       INTEGER FIELD
138750200529     CSR                   MOVE ZZAMT     ZZAMTD  30       DECIMAL FIELD
138760200529     C* BOTH ZZAMTI AND ZZAMTD CONTAIN A 'SIGN' ZONE NOW
138770200529     C*
138780200529     CSR                   EXSR GLZSUM
138790200529     CSR         ZZAEND    ENDSR                           ** ZZAEND TAG *
138800200529     C*
138810200529     C********************************************************************
138820200529     C* SUBROUTINE TO CARRY OUT THE ADDITION FOR SUBROUTINES -
138830200529     C*                        GLZADD, GLZSUB, GLZCMP.
138840200529     C*          PARAMETERS PASSED -
138850200529     C*                     I/P ZZAMTI ZZAMTD
138860200529     C*                     O/P ZZTOTI ZZTOTD ZZNEGD IND 96 IND 99.
138870200529     C*
138880200529     CSR         GLZSUM    BEGSR                           *** GLZSUM ****
138890200529     C*
138900200529     CSR                   Z-ADDZZTOTI    ZZTOTI 150       DEFINE ZZTOTI
138910200529     CSR                   Z-ADDZZTOTD    ZZTOTD  30       DEFINE ZZTOTD
138920200529     CSR                   SETOF                     919293
138930200529     CSR                   SETOF                     949599
138940200529     C*
138950200529     C*    DETERMINE SIGN OF ZZAMTI & D,   92 IF NEG
138960200529     CSR         ZZAMTI    COMP 0                      9293
138970200529     CSR 93      ZZAMTD    COMP 0                      9293
138980200529     CSR 93                GOTO ZZSEND                     ZERO BYPASS
138990200529     C*
139000200529     C*    DETERMINE SIGN OF ZZTOTI & D, 91 IF NEG.
139010200529     CSR         ZZTOTI    COMP 0                      9193
139020200529     CSR 93      ZZTOTD    COMP 0                      9193
139030200529     C*
139040200529     C*    IF ZZTOTAL IS ZERO, RETURN ZZAMOUNT.
139050200529     CSR 93                Z-ADDZZAMTI    ZZTOTI
139060200529     CSR 93                Z-ADDZZAMTD    ZZTOTD
139070200529     CSR 93                GOTO ZZSEND                     ZERO BYPASS
139080200529     C*    IF SIGNS DIFFER BYPASS OVERFLOW CHECKS.
139090200529     CSR 91N92
139100200529     CORN91 92             GOTO ZZOFPS
139110200529     C*
139120200529     CSR         ZZAMTD    ADD  ZZTOTD    ZZWK2   40
139130200529     CSR         ZZWK2     COMP 999                  93    '93' = CARRY
139140200529     CSRN93      ZZWK2     COMP -999                   93    INTO INTEGER.
139150200529     C*
139160200529     CSR 93N92   ZZAMTI    ADD  1         ZZWK3  150       ADD 'CARRY' +VE
139170200529     CSR    93 92ZZAMTI    SUB  1         ZZWK3            SUB 'CARRY' -VE
139180200529     CSR 93      ZZTOTI    ADD  ZZWK3     ZZWK3
139190200529     CSRN93      ZZTOTI    ADD  ZZAMTI    ZZWK3
139200200529     C*
139210200529     C* IF THE MODULUS OF ZZWK3 IS LT MOD. ZZTOTI THEN O/F HAS OCCURED
139220200529     CSRN92      ZZWK3     COMP ZZTOTI                 99  -92 MEANS NOS.
139230200529     CSR 92      ZZWK3     COMP ZZTOTI               99     NEGATIVE
139240200529     CSRN99                Z-ADDZZWK2     ZZTOTD
139250200529     CSRN99                Z-ADDZZWK3     ZZTOTI
139260200529     C*
139270200529     C* IF O/F ZEROIZE ZZAMT , IND '99' SET AND ZZTOT FIELDS LEFT INTACT.
139280200529     CSR 99                Z-ADD0         ZZAMT  153
139290200529     CSR                   GOTO ZZSEND
139300200529     C*
139310200529     C* THE 'SIGNS' ARE DIFFERENT
139320200529     CSR         ZZOFPS    TAG                             ** ZZOFPS TAG**
139330200529     C* IF ZZAMT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZTOT
139340200529     C*
139350200529     CSR 92                Z-SUBZZAMTI    ZZAMTI 150
139360200529     CSR 92                Z-SUBZZAMTD    ZZAMTD  30
139370200529     C*
139380200529     C* IF ZZTOT WAS NEGATIVE, MAKE IT POS. TO COMP WITH ZZAMT.
139390200529     C*
139400200529     CSR 91                Z-SUBZZTOTI    ZZTOTI
139410200529     CSR 91                Z-SUBZZTOTD    ZZTOTD
139420200529     C* BOTH ZZAMT AND ZZTOT ARE NOW POSITIVE.
139430200529     C*
139440200529     CSR         ZZTOTI    COMP ZZAMTI               93  95
139450200529     CSR 95      ZZTOTD    COMP ZZAMTD               93  95
139460200529     C*
139470200529     C* IF ZZTOT EQ. ZZAMT RETURN ZERO.
139480200529     CSR 95                Z-ADD0         ZZTOTI
139490200529     CSR 95                Z-ADD0         ZZTOTD
139500200529     CSR 95                GOTO ZZSEND
139510200529     C*
139520200529     C* IF ZZTOT GT. ZZAMT.
139530200529     CSR 93      ZZAMTD    COMP ZZTOTD               94
139540200529     CSR 93 94   ZZTOTI    SUB  1         ZZTOTI
139550200529     CSR 93 94   ZZTOTD    ADD  1000      ZZWK2
139560200529     CSR 93      ZZTOTI    SUB  ZZAMTI    ZZTOTI
139570200529     CSR 93 94   ZZWK2     SUB  ZZAMTD    ZZTOTD
139580200529     CSR 93N94   ZZTOTD    SUB  ZZAMTD    ZZTOTD
139590200529     C*
139600200529     C*
139610200529     C* IF ZZAMT GT. ZZTOT.
139620200529     CSRN93      ZZTOTD    COMP ZZAMTD               94
139630200529     CSRN93 94   ZZAMTI    SUB  1         ZZWK3  150
139640200529     CSRN93 94   ZZAMTD    ADD  1000      ZZWK2
139650200529     CSRN93 94   ZZWK3     SUB  ZZTOTI    ZZTOTI
139660200529     CSRN93N94   ZZAMTI    SUB  ZZTOTI    ZZTOTI
139670200529     CSRN93 94   ZZWK2     SUB  ZZTOTD    ZZTOTD
139680200529     CSRN93N94   ZZAMTD    SUB  ZZTOTD    ZZTOTD
139690200529     C*
139700200529     C* REVERSE SIGN OF ZZTOT IF LARGER I/P FIELDS WERE NEGATIVE
139710200529     CSR                   SETOF                     94
139720200529     CSR 93 91
139730200529     CORN93 92             SETON                     94
139740200529     CSR 94                Z-SUBZZTOTI    ZZTOTI
139750200529     CSR 94                Z-SUBZZTOTD    ZZTOTD
139760200529     C**
139770200529     C**   RESTORE SIGN OF ZZAMTI & ZZAMTD IF IT WAS REVERSED.
139780200529     CSR 92                Z-SUBZZAMTI    ZZAMTI
139790200529     CSR 92                Z-SUBZZAMTD    ZZAMTD
139800200529     CSR         ZZSEND    TAG                             ** ZZSEND TAG *
139810200529     C**
139820200529     C**   IF ZZTOTD IS ZERO, AND ZZTOTI IS NEG. SET UP ZZNEGD.
139830200529     CSR                   SETOF                     96
139840200529     CSR         ZZTOTD    COMP 0                        91
139850200529     CSR 91      ZZTOTI    COMP 0                      96
139860200529     CSR 96                MOVE '.000-'   ZZNEGD  5
139870200529     CSR                   ENDSR                             ** ENDSR **
139880200529     C********************************************************************
139890200529     C/EJECT
139900200529     C********************************************************************
139910200529     C*                                                                        *
139920200529     C*  #CCYCN SR. TO CONVERT AN AMOUNT IN ONE CURRENCY TO ANOTHER            *
139930200529     C*  CURRENCY USING THE SPOT RATES FOR THE TWO CURRENCIES                  *
139940200529     C*
139950200529     C*                                                                        *
139960200529     C*                                                                        *
139970200529     C*  INPUT  FIELDS                                                         *
139980200529     C*       ZAMTCI 150     AMOUNT IN 'FROM' CURRENCY                         *
139990200529     C*       ZCCYI   3A     FROM CURRENCY                                     *
140000200529     C*       ZCCYO   3A     TO CURRENCY                                       *
140010200529     C*       ZRATEF 138     SPOT RATE FOR 'FROM' CURRENCY                     *
140020200529     C*       ZRATET 138     SPOT RATE FOR 'TO' CURRENCY                       *
140030200529     C*       ZMDINF  1A     MULTIPLY/DIVIDE INDICATOR FOR 'FROM' CURRENCY     *
140040200529     C*       ZMDINT  1A     MULTIPLY/DIVIDE INDICATOR FOR 'TO' CURRENCY       *
140050200529     C*       ZCDPI   10     CURRENCY DECIMAL PLACES FOR 'FROM' CURRENCY       *
140060200529     C*       ZCDPO   10     CURRENCY DECIMAL PLACES FOR 'TO' CURRENCY         *
140070200529     C*                                                                        *
140080200529     C*  OUTPUT  FIELDS                                                        *
140090200529     C*       ZAMTCO 150     AMOUNT IN 'TO' CURRENCY (IE. CONVERTED AMOUNT)    *
140100200529     C*       ZEXCH  138     CROSS EXCHANGE RATE                               *
140110200529     C*       ZMD     1A     CROSS RATE MULTIPLY/DIVIDE INDICATOR              *
140120200529     C*                                                                        *
140130200529     C*                                                                        *
140140200529     C*  CALLED BY:                                                            *
140150200529     C*                                                                        *
140160200529     C**************************************************************************
140170200529     C*
140180200529     C           #CCYCN    BEGSR                           *** CCYCN * **
140190200529     C*
140200200529     C** DEFINE ALL FIELDS
140210200529     C                     Z-ADDZAMTCI    ZAMTCI 150
140220200529     C                     MOVE ZCCYI     ZCCYI   3
140230200529     C                     MOVE ZCCYO     ZCCYO   3
140240200529     C                     Z-ADDZRATEF    ZRATEF 138
140250200529     C                     Z-ADDZRATET    ZRATET 138
140260200529     C                     MOVE ZMDINF    ZMDINF  1
140270200529     C                     MOVE ZMDINT    ZMDINT  1
140280200529     C                     Z-ADDZCDPI     ZCDPI   10
140290200529     C                     Z-ADDZCDPO     ZCDPO   10
140300200529     C                     Z-ADDZAMTCO    ZAMTCO 150
140310200529     C                     Z-ADDZEXCH     ZEXCH  138
140320200529     C                     MOVE ZMD       ZMD     1
140330200529     C*
140340200529     C** IF 'FROM' CURRENCY EQUAL TO 'TO' CURRENCY SET AMOUNT IN 'TO' CURRENCY
140350200529     C** EQUAL TO AMOUNT IN 'FROM' CURRENCY
140360200529     C           ZCCYI     IFEQ ZCCYO
140370200529     C                     Z-ADDZAMTCI    ZAMTCO
140380200529     C                     Z-ADD1         ZEXCH
140390200529     C                     MOVE 'M'       ZMD
140400200529     C                     GOTO CCYEND
140410200529     C                     END
140420200529     C*
140430200529     C** INITIALIZE CROSS EXCHANGE RATE (ZCRSSRT) TO ZERO
140440200529     C                     Z-ADD*ZEROS    ZEXCH
140450200529     C*
140460200529     C** IF MULT/DIV INDIC. FOR 'FROM' IS = MULT/DIV INDIC FOR 'TO' INDIC
140470200529     C**   AND SPOT RATE FOR 'TO' CURRENCY (ZRATET) IS NOT = ZERO
140480200529     C           ZMDINF    IFEQ ZMDINT
140490200529     C           ZRATET    ANDNE*ZEROS
140500200529     C           ZRATEF    DIV  ZRATET    ZEXCH
140510200529     C*
140520200529     C** IF MULT/DIV INDIC FOR 'FROM' IS NOT= MULT/DIV INDIC FOR 'TO' INDIC
140530200529     C** OR  SPOT RATE FOR 'TO' CURRENCY (ZRATET) IS  = ZERO
140540200529     C                     ELSE
140550200529     C           ZRATEF    MULT ZRATET    ZEXCH
140560200529     C                     END
140570200529     C*
140580200529     C** MOVE MULT/DIV INDIC FOR 'FROM' CURRENCY TO CROSS RATE MULT/DIV
140590200529     C** INDICATOR (ZMD)
140600200529     C*
140610200529     C                     MOVE ZMDINF    ZMD                             101847
140620200529     C*
140630200529     C** EXECUTE   SR ZCONV
140640200529     C*                                                                                       CDL081
140650200529     C           CDL081    IFEQ 'Y'                                                           CDL081
140660200529     C           W#BSRD    ANDEQ'Y'                                                           CDL081
140670200529     C           @WHTF     ANDEQ'Y'                                                           CDL081
140680200529      *                                                                                       CDL081
140690200529      ** Convert in base currency without half adjust rounding                                CDL081
140700200529      *                                                                                       CDL081
140710200529     C                     EXSR WCONV                                                         CDL081
140720200529      *                                                                                       CDL081
140730200529     C                     ELSE                                                               CDL081
140740200529      *                                                                                       CDL081
140750200529     C                     EXSR ZCONV
140760200529      *                                                                                       CDL081
140770200529     C                     ENDIF                                                              CDL081
140780200529      *                                                                                       CDL081
140790200529     C           CCYEND    ENDSR
140800200529     C********************************************************************
140810200529     C/EJECT
140820200529     C********************************************************************
140830200529     C/COPY ZSRSRC,ZFRQAZ2
140840200529     C********************************************************************
140850200529     C/EJECT
140860200529     C********************************************************************
140870200529     C/COPY ZSRSRC,ZCONVZ1
140880200529     C********************************************************************
140890200529     C/EJECT
140900200529     C********************************************************************
140910200529     C*
140920200529     C** WPT01 subroutine Save Witholding tax information
140930200529     C**
140940200529     C**     Called by       SETPR
140950200529     C**     Calls           -
140960200529     C**
140970200529      *****************************************************************   CCB003
140980200529     C           WPT01     BEGSR                           **WPT01 BEGSR**
140990200529     C*
141000200529     C***********          Z-ADD82        DBASE                           CRE002
141010200529     C                     Z-ADD130       DBASE            * DB ERROR 130*CRE002
141020200529     C*
141030200529     C** ACCESS SDACODX0
141040200529     C** ACCOUNT CODES USED ARE THESE DEFINE FOR THE ORIGINAL ACCOUNT
141050200529     C** EVEN IF AN ALTERNATE ACCOUNT EXIST
141060200529     C*
141070200529     C                     MOVELBACOD     KACOD
141080200529     C/COPY WNCPYSRC,RE3664C136
141090200529     C*
141100200529     C                     ADD  1         RCSQ                                              CRE083BK
141110200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
141120200529     C                     Z-ADD131       WDBASE                                            CRE083BK
141130200529     C                     EXSR ACDCCH                                                      CRE083BK
141140200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
141150200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
141160200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
141170200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
141180200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
141190200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
141200200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
141210200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
141220200529     C********** *LOCK     IN   LDA                                                         CRE083BK
141230200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
141240200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 13 *CRE002
141250200529     C***********          Z-ADD013       DBASE            ***************CRE002
141260200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 131*           CRE002 CRE083BK
141270200529     C**********           Z-ADD131       DBASE            ***************           CRE002 CRE083BK
141280200529     C**********           OUT  LDA                                                         CRE083BK
141290200529     C***********          WRITEERRP1                                     CCB003
141300200529     C**********           EXSR *PSSR                                                       CRE083BK
141310200529     C**********           END                                                              CRE083BK
141320200529     C*
141330200529     C                     MOVE A5DIPD    WDIPD
141340200529     C                     MOVE A5DIPC    WDIPC
141350200529     C                     MOVE A5CIPC    WCIPC
141360200529     C                     MOVE A5CISU    WCISU
141370200529     C                     MOVE A5CINS    WCINS
141380200529     C                     MOVE A5WTAC    WWTAC
141390200529     C                     Z-ADDA5MISU    WMISU
141400200529     C*
141410200529     C** ACCESS SDACODL0
141420200529     C*
141430200529     C                     MOVELWDIPD     KACOD
141440200529     C*
141450200529     C                     ADD  1         RCSQ                                              CRE083BK
141460200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
141470200529     C                     Z-ADD028       WDBASE                                            CRE083BK
141480200529     C                     EXSR ACDCCH                                                      CRE083BK
141490200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
141500200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
141510200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
141520200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
141530200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
141540200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
141550200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
141560200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
141570200529     C********** *LOCK     IN   LDA                                                         CRE083BK
141580200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
141590200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 28 *                  CRE083BK
141600200529     C**********           Z-ADD028       DBASE            ***************                  CRE083BK
141610200529     C**********           OUT  LDA                                                         CRE083BK
141620200529     C***********          WRITEERRP1                                     CCB003
141630200529     C**********           EXSR *PSSR                                                       CRE083BK
141640200529     C**********           END                                                              CRE083BK
141650200529     C                     MOVE A5ACTY    WTDIPD
141660200529     C*
141670200529     C           WDIPC     IFNE WDIPD                      - B1
141680200529     C*
141690200529     C                     MOVELWDIPC     KACOD
141700200529     C*
141710200529     C                     ADD  1         RCSQ                                              CRE083BK
141720200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
141730200529     C                     Z-ADD133       WDBASE                                            CRE083BK
141740200529     C                     EXSR ACDCCH                                                      CRE083BK
141750200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
141760200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
141770200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
141780200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
141790200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
141800200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
141810200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
141820200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
141830200529     C********** *LOCK     IN   LDA                                                         CRE083BK
141840200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
141850200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 29 *CRE002
141860200529     C***********          Z-ADD029       DBASE            ***************CRE002
141870200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 133*           CRE002 CRE083BK
141880200529     C**********           Z-ADD133       DBASE            ***************           CRE002 CRE083BK
141890200529     C**********           OUT  LDA                                                         CRE083BK
141900200529     C***********          WRITEERRP1                                     CCB003
141910200529     C**********           EXSR *PSSR                                                       CRE083BK
141920200529     C**********           END                                                              CRE083BK
141930200529     C                     END                             - E1
141940200529     C                     MOVE A5ACTY    WTDIPC
141950200529     C*
141960200529     C                     ADD  1         RCSQ                                              CRE083BK
141970200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
141980200529     C                     Z-ADD134       WDBASE                                            CRE083BK
141990200529     C                     EXSR ACDCCH                                                      CRE083BK
142000200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
142010200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
142020200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
142030200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
142040200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
142050200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
142060200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
142070200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
142080200529     C********** *LOCK     IN   LDA                                                         CRE083BK
142090200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
142100200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 30 *CRE002
142110200529     C***********          Z-ADD030       DBASE            ***************CRE002
142120200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 134*           CRE002 CRE083BK
142130200529     C**********           Z-ADD134       DBASE            ***************           CRE002 CRE083BK
142140200529     C**********           OUT  LDA                                                         CRE083BK
142150200529     C***********          WRITEERRP1                                     CCB003
142160200529     C**********           EXSR *PSSR                                                       CRE083BK
142170200529     C**********           END                                                              CRE083BK
142180200529     C*
142190200529     C                     MOVE A5ACTY    WTCIPC
142200200529     C*
142210200529     C           WCISU     IFNE WCIPC                      - B1
142220200529     C                     MOVELWCISU     KACOD
142230200529     C*
142240200529     C                     ADD  1         RCSQ                                              CRE083BK
142250200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
142260200529     C                     Z-ADD135       WDBASE                                            CRE083BK
142270200529     C                     EXSR ACDCCH                                                      CRE083BK
142280200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
142290200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
142300200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
142310200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
142320200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
142330200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
142340200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
142350200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
142360200529     C********** *LOCK     IN   LDA                                                         CRE083BK
142370200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
142380200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 31 *CRE002
142390200529     C***********          Z-ADD031       DBASE            ***************CRE002
142400200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 135*           CRE002 CRE083BK
142410200529     C**********           Z-ADD135       DBASE            ***************           CRE002 CRE083BK
142420200529     C**********           OUT  LDA                                                         CRE083BK
142430200529     C***********          WRITEERRP1                                     CCB003
142440200529     C**********           EXSR *PSSR                                                       CRE083BK
142450200529     C**********           END                                                              CRE083BK
142460200529     C                     END                             - E1
142470200529     C                     MOVE A5ACTY    WTCISU
142480200529     C*
142490200529     C           WCINS     IFNE WCISU                      - B1
142500200529     C                     MOVELWCINS     KACOD
142510200529     C*
142520200529     C                     ADD  1         RCSQ                                              CRE083BK
142530200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
142540200529     C                     Z-ADD060       WDBASE                                            CRE083BK
142550200529     C                     EXSR ACDCCH                                                      CRE083BK
142560200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
142570200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
142580200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
142590200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
142600200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
142610200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
142620200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
142630200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
142640200529     C********** *LOCK     IN   LDA                                                         CRE083BK
142650200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
142660200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 32 *CRE002
142670200529     C***********          Z-ADD032       DBASE            ***************CRE002
142680200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 060*           CRE002 CRE083BK
142690200529     C**********           Z-ADD060       DBASE            ***************           CRE002 CRE083BK
142700200529     C**********           OUT  LDA                                                         CRE083BK
142710200529     C***********          WRITEERRP1                                     CCB003
142720200529     C**********           EXSR *PSSR                                                       CRE083BK
142730200529     C**********           END                                                              CRE083BK
142740200529     C                     END                             - E1
142750200529     C                     MOVE A5ACTY    WTCINS
142760200529     C*
142770200529     C                     MOVELWWTAC     KACOD
142780200529     C*
142790200529     C                     ADD  1         RCSQ                                              CRE083BK
142800200529     C                     MOVE KACOD     KEYACD                                            CRE083BK
142810200529     C                     Z-ADD085       WDBASE                                            CRE083BK
142820200529     C                     EXSR ACDCCH                                                      CRE083BK
142830200529     C**********           CALL 'AOACODR0'                                                  CRE083BK
142840200529     C**********           PARM '*MSG   ' @RTCD                                             CRE083BK
142850200529     C**********           PARM '*KEY   ' @OPTN                                             CRE083BK
142860200529     C**********           PARM KACOD     @ACCD   4                                           CGL029
142870200529     C********** SDACOD    PARM SDACOD    DSFDY                                               CGL029
142880200529     C**********           PARM KACOD     @ACCD                                      CGL029 CRE083BK
142890200529     C********** SDACOD    PARM SDACOD    DSSDY                                      CGL029 CRE083BK
142900200529     C********** @RTCD     IFNE *BLANK                                                      CRE083BK
142910200529     C********** *LOCK     IN   LDA                                                         CRE083BK
142920200529     C**********           MOVEL'SDACODPD'DBFILE           ***************                  CRE083BK
142930200529     C***********          MOVEL@ACCD     DBKEY            * DB ERROR 33 *CRE002
142940200529     C***********          Z-ADD033       DBASE            ***************CRE002
142950200529     C**********           MOVEL@ACCD     DBKEY            * DB ERROR 085*           CRE002 CRE083BK
142960200529     C**********           Z-ADD085       DBASE            ***************           CRE002 CRE083BK
142970200529     C**********           OUT  LDA                                                         CRE083BK
142980200529     C***********          WRITEERRP1                                     CCB003
142990200529     C**********           EXSR *PSSR                                                       CRE083BK
143000200529     C**********           END                                                              CRE083BK
143010200529     C                     MOVE A5ACTY    WTWTAC
143020200529     C*
143030200529     C/COPY WNCPYSRC,RE3664CCP1                                           S01408
143040200529     C*                                                                   S01408
143050200529     C                     ENDSR                           ** WPT01 ENDSR*
143060200529     C********************************************************************
143070200529     C/EJECT
143080200529     C********************************************************************
143090200529     C*                                                                  *
143100200529     C*  SUBNAR - Subroutine to standardised posting narratives.         *
143110200529     C*           If posted to the Retail Account, all 30 char. for      *
143120200529     C*           narrative is available. If posted to suspense, or      *
143130200529     C*           alternative account, or the Contra entry and Retail    *
143140200529     C*           no. is used then 19 char. is available and 10 char     *
143150200529     C*           is for the Retail no. otherwise only 7 char. for       *
143160200529     C*           narrative is available and the rest is for the         *
143170200529     C*           Midas account number.                                  *
143180200529     C*
143190200529     C*  Called by
143200200529     C*  Calls           -
143210200529     C*
143220200529     C********************************************************************
143230200529     C           SUBNAR    BEGSR                           *SUBNAR BEGSR*
143240200529      *                                                                   130468
143250200529     C                     MOVE *BLANKS   NARS                            130468
143260200529     C*
143270200529     C           BRCA      IFEQ XBRCA
143280200529     C           CNUM      ANDEQXCNUM
143290200529     C           CCY       ANDEQXCCY
143300200529     C           ACOD      ANDEQXACOD
143310200529     C           ACSQ      ANDEQXACSQ
143320200529     C                     MOVELINPNAR    NARS
143330200529      *                                                                   S01522
143340200529      **  Set up final character of MSGID according to Narrative Type     S01522
143350200529     C                     MOVE '0'       ##MGID                          S01522
143360200529     C                     ELSE
143370200529     C*
143380200529     C           RACN      IFEQ 'Y'
143390200529     C***********AAACNO    ANDNE0                                                      198082 231617
143400200529     C           WACN0     ANDNE0                                                             231617
143410200529     C                     MOVELINP16     NARS
143420200529     C***********          MOVE WACNO     NARS                            074598
143430200529     C                     MOVELWACNO     FLD15  15                       074598
143440200529     C           CRE008    IFEQ 'Y'                                       217910
143450200529     C           WACN0     ANDEQ0                                         217910
143460200529     C                     EXSR RTVRE                                     217910
143470200529     C                     MOVELXACNO     FLD15                           217910
143480200529     C                     ENDIF                                          217910
143490200529     C                     MOVE FLD15     NARS                            074598
143500200529      *                                                                   S01522
143510200529      **  Set up final character of MSGID according to Narrative Type     S01522
143520200529     C                     MOVE '1'       ##MGID                          S01522
143530200529     C                     ELSE
143540200529     C                     MOVELINP07     NARS
143550200529     C                     MOVE WNARS     NARS
143560200529      *                                                                   S01522
143570200529      **  Set up final character of MSGID according to Narrative Type     S01522
143580200529     C                     MOVE '2'       ##MGID                          S01522
143590200529     C                     END
143600200529     C*
143610200529     C                     END
143620200529     C/COPY WNCPYSRC,RE3664C158
143630200529     C*
143640200529     C                     ENDSR                           **SUBNAR ENDSR*
143650200529     C********************************************************************
143660200529     C/EJECT
143670200529     C********************************************************************
143680200529     C**                                                                 *
143690200529     C**  ZEDIT SUBROUTINE TO INSERT A DECIMAL POINT INTO A NUMERIC FIELD*
143700200529     C**  AND TO BLANK OUT LEADING ZEROES.                               *
143710200529     C**      INPUT FIELDS:   ZFIELD 16/                                 *
143720200529     C*                       ZADEC                                      *
143730200529     C*                       ZADIG - NOT ACTUALLY USED                  *
143740200529     C*                                                                  *
143750200529     C*       ARRAYS    ZA1 ,ZA2   BOTH 16 ELEMENTS, EACH ONE BYTE LONG. *
143760200529     C*                                                                  *
143770200529     C*       OUTPUT FIELD   ZFIELD                                      *
143780200529     C*                                                                  *
143790200529     C/COPY ZSRSRC,ZEDITZ2
143800200529      *****************************************************************   CPB001
143810200529      /EJECT                                                              CPB001
143820200529      *****************************************************************   CPB001
143830200529      *                                                               *   CPB001
143840200529      *  REPLIC - Subroutine to write a posting in PB End of Day      *   CPB001
143850200529      *            Interest Postings File RPEODIPD.                   *   CPB001
143860200529      *                                                               *   CPB001
143870200529      *  Called by : GEICPR                                           *   CPB001
143880200529      *                                                               *   CPB001
143890200529      *  Calls     : None                                             *   CPB001
143900200529      *                                                               *   CPB001
143910200529      *****************************************************************   CPB001
143920200529     C           REPLIC    BEGSR                           ** REPLIC SR **CPB001
143930200529      *                                                                   CPB001
143940200529      **  Access Original Account Customer Details by using Access        CPB001
143950200529      **  Object, to retrieve Private Banking Customer Indicator.         CPB001
143960200529     C                     MOVE *BLANKS   @CNUM                           CPB001
143970200529     C                     MOVELBCNUM     @CNUM                           CPB001
143980200529     C                     CALL 'AOCUSTR1'                                CPB001
143990200529     C                     PARM '*MSG   ' @RTCD                           CPB001
144000200529     C                     PARM '*KEY   ' @OPTN                           CPB001
144010200529     C                     PARM           @CNUM  10                       CPB001
144020200529     C                     PARM           @KYST   7                       CPB001
144030200529     C           SDCUST    PARM SDCUST    DSLDY                           CPB001
144040200529      *                                                                   CPB001
144050200529      **  If Customer Details do not exist, handle Database Error.        CPB001
144060200529     C           @RTCD     IFEQ *ON                        Begin @RTCD    CPB001
144070200529     C           *LOCK     IN   LDA                                       CPB001
144080200529     C                     MOVEL'SDCUSTPD'DBFILE           ***************CPB001
144090200529     C                     Z-ADD204       DBASE            * DB ERRO 204 *CPB001
144100200529     C                     MOVEL@CNUM     DBKEY            ***************CPB001
144110200529     C                     OUT  LDA                                       CPB001
144120200529     C                     EXSR *PSSR                                     CPB001
144130200529      *                                                                   CPB001
144140200529     C                     ENDIF                           End @RTCD      CPB001
144150200529      *                                                                   CPB001
144160200529      **  If Original Account Customer is not a Private Banking Customer. CPB001
144170200529     C           BBPRBA    IFNE 'Y'                        Begin BBPRBA   CPB001
144180200529      *                                                                   CPB001
144190200529      **  Access Posting Account Customer Details by using Access         CPB001
144200200529      **  Object, to retrieve Private Banking Customer Indicator.         CPB001
144210200529     C                     MOVE *BLANKS   @CNUM                           CPB001
144220200529     C                     MOVELCNUM      @CNUM                           CPB001
144230200529     C                     CALL 'AOCUSTR1'                                CPB001
144240200529     C                     PARM '*MSG   ' @RTCD                           CPB001
144250200529     C                     PARM '*KEY   ' @OPTN                           CPB001
144260200529     C                     PARM           @CNUM  10                       CPB001
144270200529     C                     PARM           @KYST   7                       CPB001
144280200529     C           SDCUST    PARM SDCUST    DSLDY                           CPB001
144290200529      *                                                                   CPB001
144300200529      **  If Customer Details do not exist, handle Database Error.        CPB001
144310200529     C           @RTCD     IFEQ *ON                        Begin @RTCD    CPB001
144320200529     C           *LOCK     IN   LDA                                       CPB001
144330200529     C                     MOVEL'SDCUSTPD'DBFILE           ***************CPB001
144340200529     C                     Z-ADD205       DBASE            * DB ERRO 205 *CPB001
144350200529     C                     MOVEL@CNUM     DBKEY            ***************CPB001
144360200529     C                     OUT  LDA                                       CPB001
144370200529     C                     EXSR *PSSR                                     CPB001
144380200529      *                                                                   CPB001
144390200529     C                     ENDIF                           End @RTCD      CPB001
144400200529      *                                                                   CPB001
144410200529     C                     ENDIF                           End BBPRBA     CPB001
144420200529      *                                                                   CPB001
144430200529      **  If either the Original Account Customer or the Posting          CPB001
144440200529      **  Account Customer is a Private Banking Customer.                 CPB001
144450200529     C           BBPRBA    IFEQ 'Y'                        Begin BBPRBA   CPB001
144460200529      *                                                                   162319
144470200529      ** If internal posting,                                             162319
144480200529      ** not suspense account posting, don't write to TOF Interface files 162319
144490200529     C                     MOVELCNUM      BCNUMA                          162319
144500200529     C           BCNUMA    IFEQ BBICN                                     162319
144510200529     C**********           MOVE ACOD      TOCOMS  4                                    162319 CGL029
144520200529     C                     MOVE ACOD      TOCOMS 10                                           CGL029
144530200529     C           TOCOMS    CABNECOMS      BYP                             162319
144540200529     C                     ENDIF                                          162319
144550200529      *                                                                   CPB001
144560200529      **  Execute subroutine to set up Private Banking EOD Interest       CPB001
144570200529      **  Posting record fields.                                          CPB001
144580200529     C                     EXSR RPEODI                                    CPB001
144590200529      *                                                                   CPB001
144600200529      **  Write a new record in RPEODIPD.                                 CPB001
144610200529     C                     WRITERPEODID0                                  CPB001
144620200529      *                                                                   CPB001
144630200529     C           BYP       TAG                                            162319
144640200529     C                     ENDIF                           End BBPRBA     CPB001
144650200529      *                                                                   CPB001
144660200529     C                     ENDSR                                          CPB001
144670200529      ********************************************************************                    250998
144680200529      /EJECT                                                                                  250998
144690200529      ********************************************************************                    250998
144700200529      **                                                                                      250998
144710200529     C           DETPR     BEGSR                           **DETPR BEGSR**                    250998
144720200529      *                                                                                       250998
144730200529      ** If transaction charge overide is non zero then use this field                        250998
144740200529      *                                                                                       250998
144750200529     C                     Z-ADD0         WCHGP                                               250998
144760200529     C*                                                                                       250998
144770200529     C                     Z-ADD0         WCHGA                                               250998
144780200529     C*                                                                                       250998
144790200529     C           WPSTA     IFGT 0                          - B1                               250998
144800200529     C                     Z-ADDWPSTA     WPSTA2                                              250998
144810200529     C                     ELSE                            - X1                               250998
144820200529     C                     Z-SUBWPSTA     WPSTA2                                              250998
144830200529     C                     END                             - E1                               250998
144840200529     C*                                                                                       250998
144850200529     C**********           MOVE *BLANKS   BLNKS                                      250998 CRE083BK
144860200529     C**********           Z-ADD91060     DTRTY                                      250998 CRE083BK
144870200529     C**********           MOVELCCY       DCCY                                       250998 CRE083BK
144880200529     C**********           MOVEL'D'       D                                          250998 CRE083BK
144890200529     C                     MOVE *BLANKS   BLNKS                                             MD021155
144900200529     C                     MOVE '91060'   DTRTY                                             MD021155
144910200529     C                     MOVELCCY       DCCY                                              MD021155
144920200529     C                     MOVEL'D'       D                                                 MD021155
144930200529     C********** TRGDS     CHAINRETRGDF              99                              250998 CRE083BK
144940200529     C********** *IN99     IFEQ *OFF                                                 250998 CRE083BK
144950200529      *                                                                                       250998
144960200529     C                     Z-ADDCURETR    F                                                 CRE083BK
144970200529     C********** *LOVAL    SETLLRETRG                                              CRE083BK MD021155
144980200529     C**********           READ RETRG                    89                        CRE083BK MD021155
144990200529     C           TRGDS     LOKUPARET,F                   99                                 CRE083BK
145000200529     C********** *IN89     DOWNE*OFF                                               CRE083BK MD021155
145010200529     C********** *IN99     ORNE *ON                                                CRE083BK MD021155
145020200529     C**********           READ RETRG                    89                        CRE083BK MD021155
145030200529     C********** TRGDS     LOKUPARET,F                   99                        CRE083BK MD021155
145040200529     C**********           ENDDO                                                   CRE083BK MD021155
145050200529      *                                                                                     CRE083BK
145060200529     C********** F         OCUR SDRETR                                             CRE083BK MD021155
145070200529     C           *IN99     IFEQ *ON                                                         CRE083BK
145080200529     C           F         OCUR SDRETR                                             CRE083BK MD021155
145090200529     C                     MOVE KEYD      KEY                                               MD021155
145100200529     C                     MOVE LCDD      LCD                                               MD021155
145110200529     C                     MOVE ZZ001D    ZZ001                                             MD021155
145120200529     C           WTCHO     IFNE *ZEROS                     - B1                               250998
145130200529     C           DCAM      IFEQ 'C'                        - B2                               250998
145140200529     C           DCPC      OREQ 'C'                                                           250998
145150200529     C                     Z-SUBWTCHO     WCHGA                                               250998
145160200529     C                     ELSE                            - X2                               250998
145170200529     C                     Z-ADDWTCHO     WCHGA                                               250998
145180200529     C                     END                             - E2                               250998
145190200529      *                                                                                       250998
145200200529     C                     ELSE                                                               250998
145210200529      *                                                                                       250998
145220200529      ** Verify if Charge Amount > zero                                                       250998
145230200529      *                                                                                       250998
145240200529     C           CHAM      IFGT 0                          - B2                               250998
145250200529      *                                                                                       250998
145260200529      ** Test if Debit or Credit Amount                                                       250998
145270200529      *                                                                                       250998
145280200529     C           DCAM      IFEQ 'C'                        - B3                               250998
145290200529     C                     Z-SUBCHAM      WCHGA                                               250998
145300200529     C                     ELSE                            - X3                               250998
145310200529     C                     Z-ADDCHAM      WCHGA                                               250998
145320200529     C                     END                             - E3                               250998
145330200529      *                                                                                       250998
145340200529      ** Charge amount less or equal zero                                                     250998
145350200529      *                                                                                       250998
145360200529     C                     ELSE                            - X2                               250998
145370200529     C                     Z-ADD0         WCHGA                                               250998
145380200529     C                     END                             - E2                               250998
145390200529      *                                                                                       250998
145400200529      ** Test if Charge Percentage > 0                                                        250998
145410200529      *                                                                                       250998
145420200529     C           CHPC      IFGT 0                          - B2                               250998
145430200529     C           WPSTA2    MULT CHPC      WCHGP                                               250998
145440200529     C           WCHGP     DIV  100       WCHGP     H                                         250998
145450200529      *                                                                                       250998
145460200529      ** Test if Debit or credit Percentage                                                   250998
145470200529      *                                                                                       250998
145480200529     C           DCPC      IFEQ 'C'                        - B3                               250998
145490200529     C                     Z-SUBWCHGP     WCHGA                                               250998
145500200529     C                     ELSE                            - X3                               250998
145510200529     C                     Z-ADDWCHGP     WCHGA                                               250998
145520200529     C                     END                             - E3                               250998
145530200529      *                                                                                       250998
145540200529     C                     END                             - E2                               250998
145550200529      *                                                                                       250998
145560200529     C                     END                             - E1                               250998
145570200529      *                                                                                       250998
145580200529     C                     END                                                                250998
145590200529      *                                                                                       250998
145600200529     C                     ENDSR                           **DETPR ENDSR**                    250998
145610200529      *****************************************************************   CPB001
145620200529      /EJECT                                                              CPB001
145630200529      *****************************************************************   CPB001
145640200529      *                                                               *   CPB001
145650200529      *  RPEODI - Subroutine to set up Private Banking EOD Interest   *   CPB001
145660200529      *           Posting record fields.                              *   CPB001
145670200529      *                                                               *   CPB001
145680200529      *  Called by : REPLIC                                           *   CPB001
145690200529      *                                                               *   CPB001
145700200529      *  Calls     : None                                             *   CPB001
145710200529      *                                                               *   CPB001
145720200529      *****************************************************************   CPB001
145730200529     C           RPEODI    BEGSR                           ** RPEODI SR **CPB001
145740200529      *                                                                   CPB001
145750200529     C                     MOVE 'P'       PIRECI           Record Id      CPB001
145760200529     C**********           Z-ADDCNUM      PICNUM           Customer Number             CPB001 CSD027
145770200529     C                     MOVE CNUM      PICNUM           Customer Number                    CSD027
145780200529     C                     MOVE CCY       PICCY            Currency Code  CPB001
145790200529     C                     Z-ADDACOD      PIACOD           Account Code   CPB001
145800200529     C                     Z-ADDACSQ      PIACSQ           Account Seq.   CPB001
145810200529     C                     MOVE IPDN      PIIPDN           Input Document CPB001
145820200529     C                     Z-ADDACNO      PIACNO           Retail Account CPB001
145830200529     C                     Z-ADDPSTD      PIPSTD           Posting Date   CPB001
145840200529     C                     Z-ADDVALD      PIVALD           Value Date     CPB001
145850200529     C                     Z-ADDTRAT      PITRAT           Transact. Type CPB001
145860200529     C                     MOVE PNAR      PIPNAR           Posting Narr.  CPB001
145870200529     C                     Z-ADDPSTA      PIPSTA           Posting Amount CPB001
145880200529     C                     Z-ADDDRCR      PIDRCR           Deb/Cred. Ind. CPB001
145890200529     C**********           Z-ADDASOC      PIASOC           Associat. Cust.             CPB001 CSD027
145900200529     C                     MOVE ASOC      PIASOC           Associat. Cust.                    CSD027
145910200529     C                     Z-ADDCHQN      PICHQN           Cheque Number  CPB001
145920200529     C                     MOVE SPOS      PISPOS           Source Posting CPB001
145930200529     C                     MOVE BRCA      PIBRCA           Branch Code    CPB001
145940200529     C                     Z-ADDRIND      PIRIND           Retail Ind.    CPB001
145950200529     C                     Z-ADDREJC      PIREJC           Reject Code    CPB001
145960200529     C                     MOVE DPMT      PIDPMT           Department CodeCPB001
145970200529     C                     Z-ADDRRNM      PIRRNM           Relative Rec NoCPB001
145980200529     C                     MOVE *BLANKS   PIZZ09           Filler         CPB001
145990200529     C                     MOVE ATYP      PIATYP           Account Type   CPB001
146000200529     C                     MOVE *BLANKS   PIZZ02           Filler         CPB001
146010200529     C                     MOVE EXIN      PIEXIN           Extract Ind    CPB001
146020200529     C                     MOVE PRIN      PIPRIN           Pay/Receive IndCPB001
146030200529     C                     MOVE GETP      PIGETP           Gen. Entry TypeCPB001
146040200529     C                     Z-ADDACUM      PIACUM           Accumulator    CPB001
146050200529     C                     MOVE PRFC      PIPRFC           Profit Ccentre CPB001
146060200529     C                     Z-ADDPTIM      PIPTIM           Postingg Time  CPB001
146070200529     C                     Z-ADDVOIN      PIVOIN           Void Indicator CPB001
146080200529     C                     MOVE MGTT      PIMGTT           Msg Gen. Trans.CPB001
146090200529     C                     MOVE ACSC      PIACSC           Account SectionCPB001
146100200529     C                     Z-ADDLTAI      PILTAI           Late Accr. Ind.CPB001
146110200529     C                     MOVE *BLANKS   PIZZ07           Filler         CPB001
146120200529     C                     MOVE RINO      PIRINO           Retail Input NoCPB001
146130200529     C                     MOVE SWCR      PISWCR           Swift Comm. RefCPB001
146140200529     C                     MOVE DLREF     PIDLRF           Deal/Loan Ref. CPB001
146150200529     C                     MOVE FACO      PIFACO           For Account Of CPB001
146160200529     C**********           Z-ADDDBCNUM    PIDBCN           Dealt/Borr. Cus             CPB001 CSD027
146170200529     C                     MOVE DBCNUM    PIDBCN           Dealt/Borr. Cus                    CSD027
146180200529     C                     MOVELPREF      PIPREF           Tot. No. Post. CPB001
146190200529     C                     MOVE OTRF      PIOTRF           Original Trans.CPB001
146200200529     C                     MOVE OTST      PIOTST           Or. Trans. Ref.CPB001
146210200529     C                     MOVE OTTP      PIOTTP           Or. Trans. SubtCPB001
146220200529     C                     Z-ADDSDCB      PISDCB           Start Day ClBL CPB001
146230200529     C                     Z-ADDSDLB      PISDLB           Start Day LDBL CPB001
146240200529     C                     MOVE BOKC      PIBOKC           Book Code      CPB001
146250200529     C                     Z-ADDNITMS     PINITM           Number of ItemsCPB001
146260200529     C                     MOVE REBI      PIREBI           Rebatable Ind. CPB001
146270200529     C                     Z-ADDCHGA      PICHGA           Charge Amount  CPB001
146280200529     C                     MOVE *BLANKS   PIZZ19           Filler         CPB001
146290200529     C                     MOVE TLIN      PITLIN           Gen.-purp. Ind.CPB001
146300200529     C                     MOVE TCCY      PITCCY           Trans. CurrencyCPB001
146310200529     C                     MOVE STYP      PISTYP           Account SubtypeCPB001
146320200529     C                     MOVE CQRI      PICQRI           Cheq. Ind/ReverCPB001
146330200529     C                     MOVE PBTT      PIPBTT           Passbook TransaCPB001
146340200529     C                     MOVE ORBR      PIORBR           Origin. Branch CPB001
146350200529     C**********           MOVE ORAMT     PIORAM           Midas Amounts               CPB001 233719
146360200529     C**********           MOVE WTAOC     PIORAM                                       233719 234661
146370200529     C           CGL031    IFEQ 'Y'                                                           234661
146380200529     C           WEUTT     ANDEQ'Y'                                                           234661
146390200529     C                     MOVE WPSTA     PIORAM                                              234661
146400200529     C                     ELSE                                                               234661
146410200529     C                     MOVE ORAMT     PIORAM                                              234661
146420200529     C                     ENDIF                                                              234661
146430200529      *                                                                   CPB001
146440200529     C                     MOVE *BLANKS   PIOCCY           Original CurrenCPB001
146450200529     C                     Z-ADD*ZEROS    PIOAMT           Original AmountCPB001
146460200529      *                                                                   CPB001
146470200529     C**********           Z-ADDBCNUM     PIORCU           Origin. Cust.               CPB001 CSD027
146480200529     C                     MOVE BCNUM     PIORCU           Origin. Cust.                      CSD027
146490200529     C                     MOVE BCCY      PIORCY           Origin. Curr.  CPB001
146500200529     C                     Z-ADDBACOD     PIORAC           Origin. Acc. CoCPB001
146510200529     C                     Z-ADDBACSQ     PIORSE           Origin. Acc. SeCPB001
146520200529     C                     MOVE BBRCA     PIORBA           Origin. Branch CPB001
146530200529      *                                                                   CPB001
146540200529     C                     ENDSR                                          CPB001
146550200529      *****************************************************************                       CGL031
146560200529      /EJECT                                                                                  CGL031
146570200529      *****************************************************************                       CGL031
146580200529      *                                                               *                       CGL031
146590200529      *  SRRTAX - Retrieves tax amount for EU withholding tax         *                       CGL031
146600200529      *           accounting.                                         *                       CGL031
146610200529      *                                                               *                       CGL031
146620200529      *****************************************************************                       CGL031
146630200529     C           SRRTAX    BEGSR                                                              CGL031
146640200529      *                                                                                       CGL031
146650200529      ** Initialise relevant variables.                                                       CGL031
146660200529      *                                                                                       CGL031
146670200529     C                     Z-ADD*ZERO     WTAOC  130                                          CGL031
146680200529     C                     Z-ADD*ZERO     WTATC  130                                          CGL031
146690200529     C                     Z-ADD*ZERO     WTABC  130                                          CGL031
146700200529     C**********           Z-ADD*ZERO     WIAOC  130                                   CGL031 232543
146710200529     C**********           Z-ADD*ZERO     WIATC  130                                   CGL031 232543
146720200529     C**********           Z-ADD*ZERO     WIABC  130                                   CGL031 232543
146730200529     C                     Z-ADD*ZEROS    WKSTXO 150                                          CER048
146740200529     C                     Z-ADD*ZEROS    WKSTXT 150                                          CER048
146750200529     C                     Z-ADD*ZEROS    WKSTXB 150                                          CER048
146760200529     C                     Z-ADD*ZEROS    WKTTXO 150                                          CER054
146770200529     C                     Z-ADD*ZEROS    WKTTXT 150                                          CER054
146780200529     C                     Z-ADD*ZEROS    WKTTXB 150                                          CER054
146790200529     C**********           MOVEL'N'       WSATH   1                                  CER048 BUG23587
146800200529     C                     MOVEL'N'       WARTH   1                                           CER048
146810200529      *                                                                                       235174
146820200529      ** Save Transaction Type.                                                               235174
146830200529      *                                                                                       235174
146840200529     C                     Z-ADDTRAT      WTRAT                                               235174
146850200529     C                     MOVE TXTXTT    TRAT                                                235174
146860200529     C                     MOVE 'Y'       WEUTT   1                                           235174
146870200529      *                                                                                       235174
146880200529      ** Set up the narrative.                                                                235174
146890200529      *                                                                                       235174
146900200529     C                     MOVELNAR,14    INPNAR                                              235174
146910200529     C                     MOVELNR16,14   INP16                                               235174
146920200529     C                     MOVELDN07,14   INP07                                               235174
146930200529     C                     MOVELMGD,14    ##MGID                                              235174
146940200529      *                                                                                       235174
146950200529     C                     MOVE BBRCA     BRCA                                                235174
146960200529     C**********           Z-ADDBCNUM     CNUM                                        235174 CSD027A
146970200529     C                     MOVE BCNUM     CNUM                                               CSD027A
146980200529     C                     MOVE BCCY      CCY                                                 235174
146990200529     C                     Z-ADDBACOD     ACOD                                                235174
147000200529     C                     Z-ADDBACSQ     ACSQ                                                235174
147010200529     C                     MOVE WACNO     ACNO                                                235174
147020200529      *                                                                                       CGL031
147030200529      ** Check if the customer is actually a Joint A/c.                                       232543
147040200529      *                                                                                       232543
147050200529     C                     MOVE BCNUM     KJANO   6                                           232543
147060200529     C           KJANO     CHAINSDJACCL1             84                                       232543
147070200529      *                                                                                       232543
147080200529     C                     MOVE 'N'       WJACC   1                                           232543
147090200529     C           *IN84     IFEQ *OFF                                                          232543
147100200529     C                     MOVE 'Y'       WJACC                                               232543
147110200529     C                     ENDIF                                                              232543
147120200529      *                                                                                       CER048
147130200529      ** Check for the swithable feature                                                      CER048
147140200529      *                                                                                       CER048
147150200529     C           CER048    IFEQ 'Y'                                                           CER048
147160200529      *                                                                                       CER048
147170200529      ** Access branch details                                                                CER048
147180200529      *                                                                                       CER048
147190200529     C                     Z-ADDCUBRCA    C                                                 CRE083BK
147200200529     C           BBRCA     LOKUPABRC,C                   16                                 CRE083BK
147210200529      *                                                                                     CRE083BK
147220200529     C           *IN16     IFEQ '1'                                                         CRE083BK
147230200529     C           C         OCUR SDBRCH                                                      CRE083BK
147240200529     C                     ELSE                                                             CRE083BK
147250200529     C           1         OCUR SDBRCH                                                      MD021155
147260200529     C                     CALL 'AOBRCHR0'                                                    CER048
147270200529     C                     PARM '*MSG   ' PRTCD                                               CER048
147280200529     C                     PARM '*KEY   ' POPTN                                               CER048
147290200529     C                     PARM BBRCA     PBRCA   3                                           CER048
147300200529     C           SDBRCH    PARM SDBRCH    DSFDY                                               CER048
147310200529      *                                                                                       CER048
147320200529     C           PRTCD     IFNE *BLANKS                                                       CER048
147330200529      *                                                                                       CER048
147340200529     C           *LOCK     IN   LDA                                                           CER048
147350200529     C                     MOVEL'RE3664'  DBPGM                                               CER048
147360200529     C                     MOVEL'SDBRCHPD'DBFILE                                              CER048
147370200529     C                     MOVELPBRCA     DBKEY                                               CER048
147380200529     C                     Z-ADD306       DBASE                                               CER048
147390200529     C                     OUT  LDA                                                           CER048
147400200529     C                     EXSR *PSSR                                                         CER048
147410200529      *                                                                                       CER048
147420200529     C                     ENDIF                                                              CER048
147430200529     C                     ENDIF                                                            CRE083BK
147440200529      *                                                                                       CER048
147450200529      ** Access location details                                                              CER048
147460200529      *                                                                                       CER048
147470200529     C                     CALL 'AOLOCNR0'                                                    CER048
147480200529     C                     PARM *BLANKS   PRTCD                                               CER048
147490200529     C                     PARM '*KEY   ' POPTN                                               CER048
147500200529     C                     PARM A8LCCD    PLOCN   3                                           CER048
147510200529     C           SDLOCN    PARM SDLOCN    DSFDY                                               CER048
147520200529      *                                                                                       CER048
147530200529     C           PRTCD     IFNE *BLANKS                                                       CER048
147540200529      *                                                                                       CER048
147550200529     C           *LOCK     IN   LDA                                                           CER048
147560200529     C                     MOVEL'RE3664'  DBPGM                                               CER048
147570200529     C                     MOVEL'SDLOCNPD'DBFILE                                              CER048
147580200529     C                     MOVELPLOCN     DBKEY                                               CER048
147590200529     C                     Z-ADD307       DBASE                                               CER048
147600200529     C                     OUT  LDA                                                           CER048
147610200529     C                     EXSR *PSSR                                                         CER048
147620200529     C                     ENDIF                                                              CER048
147630200529      *                                                                                       CER048
147640200529      ** Access customer details                                                              CER048
147650200529      *                                                                                       CER048
147660200529     C                     MOVELBCNUM     PCNUM                                               CER048
147670200529      *                                                                                       CER048
147680200529     C                     CALL 'AOCUSTR0'                                                    CER048
147690200529     C                     PARM *BLANKS   PRTCD   7                                           CER048
147700200529     C                     PARM '*KEY   ' POPTN   7                                           CER048
147710200529     C                     PARM           PCNUM  10                                           CER048
147720200529     C                     PARM *BLANKS   PCNST   7                                           CER048
147730200529     C           SDCUST    PARM SDCUST    DSSDY                                               CER048
147740200529      *                                                                                       CER048
147750200529     C           PRTCD     IFNE *BLANKS                                                       CER048
147760200529     C           *LOCK     IN   LDA                                                           CER048
147770200529      *                                                                                       CER048
147780200529     C                     MOVEL'SDCUSTPD'DBFILE                                              CER048
147790200529     C                     MOVELPCNUM     DBKEY                                               CER048
147800200529     C                     Z-ADD308       DBASE                                               CER048
147810200529     C                     OUT  LDA                                                           CER048
147820200529     C                     EXSR *PSSR                                                         CER048
147830200529      *                                                                                       CER048
147840200529     C                     ENDIF                                                              CER048
147850200529      *                                                                                       CER048
147860200529      ** Access country of tax details                                                        CER048
147870200529      *                                                                                       CER048
147880200529     C                     CALL 'AOCTTXR0'                                                    CER048
147890200529     C                     PARM *BLANKS   PRTCD                                               CER048
147900200529     C                     PARM '*KEY   ' POPTN                                               CER048
147910200529     C                     PARM DVCNCD    PCTRT   2                                           CER048
147920200529     C                     PARM BBCOLC    PCTRR   2                                           CER048
147930200529     C           SDCTTX    PARM SDCTTX    DSFDY                                               CER048
147940200529      *                                                                                       CER048
147950200529     C           PRTCD     IFEQ '*NRF   '                                                     CER048
147960200529      *                                                                                       CER048
147970200529     C                     CALL 'AOCTTXR0'                                                    CER048
147980200529     C                     PARM *BLANKS   PRTCD                                               CER048
147990200529     C                     PARM '*KEY   ' POPTN                                               CER048
148000200529     C                     PARM DVCNCD    PCTRT   2                                           CER048
148010200529     C                     PARM *BLANKS   PCTRR   2                                           CER048
148020200529     C           SDCTTX    PARM SDCTTX    DSFDY                                               CER048
148030200529      *                                                                                       CER048
148040200529     C           PRTCD     IFNE *BLANKS                                                       CER048
148050200529      *                                                                                       CER048
148060200529     C           *LOCK     IN   LDA                                                           CER048
148070200529     C                     MOVEL'SDCTTXPD'DBFILE                                              CER048
148080200529     C                     MOVEL@BRCA     DBKEY                                               CER048
148090200529     C                     Z-ADD309       DBASE                                               CER048
148100200529     C                     OUT  LDA                                                           CER048
148110200529     C                     EXSR *PSSR                                                         CER048
148120200529      *                                                                                       CER048
148130200529     C                     ENDIF                                                              CER048
148140200529      *                                                                                       CER048
148150200529     C                     ENDIF                                                              CER048
148160200529      *                                                                                       CER048
148170200529      ** Check if the tax is done using Threshold                                             CER048
148180200529      *                                                                                       CER048
148190200529     C           EWTHMD    IFEQ 'Y'                                                           CER048
148200200529      *                                                                                       CER048
148210200529      ***Check*the*savings*threshold*for*accounts*that*accrue*credit                 CER048 BUG23587
148220200529      ***interest*yearly                                                             CER048 BUG23587
148230200529      **********                                                                     CER048 BUG23587
148240200529     C********** CRIF      IFEQ 'Y'                                                  CER048 BUG23587
148250200529      **********                                                                     CER048 BUG23587
148260200529      ***Access*Country*Codes                                                        CER048 BUG23587
148270200529      **********                                                                     CER048 BUG23587
148280200529     C**********           CALL 'AOCTRYR0'                                           CER048 BUG23587
148290200529     C**********           PARM *BLANKS   PRTCD                                      CER048 BUG23587
148300200529     C**********           PARM '*KEY   ' POPTN                                      CER048 BUG23587
148310200529     C**********           PARM DVCNCD    PLCTR   2                                  CER048 BUG23587
148320200529     C********** SDCTRY    PARM SDCTRY    DSFDY                                      CER048 BUG23587
148330200529      **********                                                                     CER048 BUG23587
148340200529     C********** PRTCD     IFNE *BLANKS                                              CER048 BUG23587
148350200529      **********                                                                     CER048 BUG23587
148360200529     C********** *LOCK     IN   LDA                                                  CER048 BUG23587
148370200529     C**********           MOVE PLCTR     DBKEY                                      CER048 BUG23587
148380200529     C**********           MOVE 'SDCTRYPD'DBFILE                                     CER048 BUG23587
148390200529     C**********           MOVE 319       DBASE                                      CER048 BUG23587
148400200529     C**********           OUT  LDA                                                  CER048 BUG23587
148410200529     C**********           EXSR *PSSR                                                CER048 BUG23587
148420200529      **********                                                                     CER048 BUG23587
148430200529     C**********           ENDIF                                                     CER048 BUG23587
148440200529      **********                                                                     CER048 BUG23587
148450200529     C********** 2         SUBSTBJMRDT:6  WXX     2                                  CER048 BUG23587
148460200529     C**********           MOVE WXX       WDT     20                                 CER048 BUG23587
148470200529     C********** WDT       SUB  1         WDT                                        CER048 BUG23587
148480200529     C**********           MOVE WDT       WY1     2                                  CER048 BUG23587
148490200529      **********                                                                     CER048 BUG23587
148500200529     C********** A4ETXY    IFEQ *ZERO                                                CER048 BUG23587
148510200529      **********                                                                     CER048 BUG23587
148520200529     C********** BJDFIN    IFEQ 'M'                                                  CER048 BUG23587
148530200529     C********** '1231'    CAT  WY1       WZZ                                        CER048 BUG23587
148540200529     C**********           ELSE                                                      CER048 BUG23587
148550200529     C********** '3112'    CAT  WY1       WZZ     6                                  CER048 BUG23587
148560200529     C**********           ENDIF                                                     CER048 BUG23587
148570200529      **********                                                                     CER048 BUG23587
148580200529     C**********           ELSE                                                      CER048 BUG23587
148590200529     C**********           MOVE A4ETXY    WETXY   4                                  CER048 BUG23587
148600200529     C********** WETXY     CAT  WY1       WZZ                                        CER048 BUG23587
148610200529     C**********           ENDIF                                                     CER048 BUG23587
148620200529      **********                                                                     CER048 BUG23587
148630200529     C**********           MOVE WZZ       ZDATE                                      CER048 BUG23587
148640200529      **********                                                                     CER048 BUG23587
148650200529     C**********           EXSR ZDATE1                                               CER048 BUG23587
148660200529      **********                                                                     CER048 BUG23587
148670200529      ***Verify*if*error                                                             CER048 BUG23587
148680200529      **********                                                                     CER048 BUG23587
148690200529     C********** *IN99     IFEQ '1'                                                  CER048 BUG23587
148700200529     C********** *LOCK     IN   LDA                                                  CER048 BUG23587
148710200529     C**********           Z-ADD318       DBASE                                      CER048 BUG23587
148720200529     C**********           MOVE 'ZDATE1'  DBFILE                                     CER048 BUG23587
148730200529     C**********           MOVE *BLANKS   DBKEY                                      CER048 BUG23587
148740200529     C**********           OUT  LDA                                                  CER048 BUG23587
148750200529     C**********           EXSR *PSSR                                                CER048 BUG23587
148760200529     C**********           ENDIF                                                     CER048 BUG23587
148770200529      **********                                                                     CER048 BUG23587
148780200529     C**********           Z-ADDZDAYNO    WSEDAT                                     CER048 BUG23587
148790200529      **********                                                                     CER048 BUG23587
148800200529      ***Last*capitalisation*date,*is*before*or*same*as*previous*tax                 CER048 BUG23587
148810200529      ***year-end*date*Or*Last*Capitalisation*Date,*is*same*as*date                  CER048 BUG23587
148820200529      ***account*opened                                                              CER048 BUG23587
148830200529      **********                                                                     CER048 BUG23587
148840200529     C********** LCID      IFLE WSEDAT                                               CER048 BUG23587
148850200529     C********** LCID      OREQ DACO                                                 CER048 BUG23587
148860200529      **********                                                                     CER048 BUG23587
148870200529     C**********           Z-ADDBJRDNB    KRDNB                                      CER048 BUG23587
148880200529     C**********           MOVE 'G'       KMODI                                      CER048 BUG23587
148890200529     C**********           MOVE BCNUM     KCUST                                      CER048 BUG23587
148900200529     C**********           MOVE BCNUM     KJOIN                                      CER048 BUG23587
148910200529     C**********           MOVE BCCY      KSCCY                                      CER048 BUG23587
148920200529     C**********           Z-ADDBACOD     KACDE                                      CER048 BUG23587
148930200529     C**********           Z-ADDBACSQ     KACSQ                                      CER048 BUG23587
148940200529     C**********           MOVE BBRCA     KBRCA                                      CER048 BUG23587
148950200529      **********                                                                     CER048 BUG23587
148960200529     C********** WJACC     IFEQ 'Y'                                                  CER048 BUG23587
148970200529     C********** KCILC     SETLLSDCSINLC                                             CER048 BUG23587
148980200529     C********** KCILC     READESDCSINLC                 84                          CER048 BUG23587
148990200529     C**********           ELSE                                                      CER048 BUG23587
149000200529     C********** KCIL7     SETLLSDCSINL7                                             CER048 BUG23587
149010200529     C********** KCIL7     READESDCSINL7                 84                          CER048 BUG23587
149020200529     C**********           ENDIF                                                     CER048 BUG23587
149030200529      **********                                                                     CER048 BUG23587
149040200529     C********** BCCY      IFEQ TSTXCY                                               CER048 BUG23587
149050200529      **********                                                                     CER048 BUG23587
149060200529     C********** RCAIC     IFLT EWSATH                                               CER048 BUG23587
149070200529     C**********           MOVE 'Y'       WSATH                                      CER048 BUG23587
149080200529     C**********           ENDIF                                                     CER048 BUG23587
149090200529      **********                                                                     CER048 BUG23587
149100200529     C**********           ELSE                                                      CER048 BUG23587
149110200529      **********                                                                     CER048 BUG23587
149120200529     C**********           MOVELRCAIC     XAMNT1                                     CER048 BUG23587
149130200529      **********                                                                     CER048 BUG23587
149140200529      ***Access*account*currency*details                                             CER048 BUG23587
149150200529      **********                                                                     CER048 BUG23587
149160200529     C**********           CALL 'AOCURRR0'                                           CER048 BUG23587
149170200529     C**********           PARM *BLANKS   PRTCD                                      CER048 BUG23587
149180200529     C**********           PARM '*KEY  '  POPTN                                      CER048 BUG23587
149190200529     C**********           PARM BCCY      PCYCD   3                                  CER048 BUG23587
149200200529     C********** SDCURR    PARM SDCURR    DSSDY                                      CER048 BUG23587
149210200529      **********                                                                     CER048 BUG23587
149220200529     C********** PRTCD     IFNE *BLANKS                                              CER048 BUG23587
149230200529     C********** *LOCK     IN   LDA                                                  CER048 BUG23587
149240200529     C**********           MOVEL'SDCURRPD'DBFILE                                     CER048 BUG23587
149250200529     C**********           MOVELPCYCD     DBKEY                                      CER048 BUG23587
149260200529     C**********           Z-ADD310       DBASE                                      CER048 BUG23587
149270200529     C**********           OUT  LDA                                                  CER048 BUG23587
149280200529     C**********           EXSR *PSSR                                                CER048 BUG23587
149290200529     C**********           ENDIF                                                     CER048 BUG23587
149300200529      **********                                                                     CER048 BUG23587
149310200529     C**********           Z-ADDCDP       XCDP1                                      CER048 BUG23587
149320200529     C**********           Z-ADDSPOT      XSPOT1                                     CER048 BUG23587
149330200529     C**********           MOVELMDIN      XMDIN1                                     CER048 BUG23587
149340200529      **********                                                                     CER048 BUG23587
149350200529      ***Check*if*margin*points*for*conversion*rate,*is*'Y'                          CER048 BUG23587
149360200529      **********                                                                     CER048 BUG23587
149370200529     C********** EWMPCR    IFEQ 'Y'                                                  CER048 BUG23587
149380200529      **********                                                                     CER048 BUG23587
149390200529     C********** MDIN      IFEQ 'M'                                                  CER048 BUG23587
149400200529     C********** SPOT      SUB  A6TCMP    XSPOT1                                     CER048 BUG23587
149410200529     C**********           ENDIF                                                     CER048 BUG23587
149420200529      **********                                                                     CER048 BUG23587
149430200529     C**********           ENDIF                                                     CER048 BUG23587
149440200529      **********                                                                     CER048 BUG23587
149450200529      ***Access*Tax*Currency                                                         CER048 BUG23587
149460200529      **********                                                                     CER048 BUG23587
149470200529     C**********           CALL 'AOCURRR0'                                           CER048 BUG23587
149480200529     C**********           PARM *BLANKS   PRTCD                                      CER048 BUG23587
149490200529     C**********           PARM '*KEY  '  POPTN                                      CER048 BUG23587
149500200529     C**********           PARM TSTXCY    PCYCD   3                                  CER048 BUG23587
149510200529     C********** SDCURR    PARM SDCURR    DSSDY                                      CER048 BUG23587
149520200529      **********                                                                     CER048 BUG23587
149530200529     C********** PRTCD     IFNE *BLANKS                                              CER048 BUG23587
149540200529     C********** *LOCK     IN   LDA                                                  CER048 BUG23587
149550200529     C**********           MOVEL'SDCURRPD'DBFILE                                     CER048 BUG23587
149560200529     C**********           MOVELPCYCD     DBKEY                                      CER048 BUG23587
149570200529     C**********           Z-ADD311       DBASE                                      CER048 BUG23587
149580200529     C**********           OUT  LDA                                                  CER048 BUG23587
149590200529     C**********           EXSR *PSSR                                                CER048 BUG23587
149600200529     C**********           ENDIF                                                     CER048 BUG23587
149610200529      **********                                                                     CER048 BUG23587
149620200529     C**********           Z-ADDCDP       XCDP2                                      CER048 BUG23587
149630200529     C**********           MOVELMDIN      XMDIN2                                     CER048 BUG23587
149640200529     C**********           Z-ADDSPOT      XSPOT2                                     CER048 BUG23587
149650200529      **********                                                                     CER048 BUG23587
149660200529     C********** EWMPCR    IFEQ 'Y'                                                  CER048 BUG23587
149670200529      **********                                                                     CER048 BUG23587
149680200529     C********** MDIN      IFEQ 'M'                                                  CER048 BUG23587
149690200529     C********** SPOT      SUB  A6TCMP    XSPOT2                                     CER048 BUG23587
149700200529     C**********           ENDIF                                                     CER048 BUG23587
149710200529      **********                                                                     CER048 BUG23587
149720200529     C**********           ENDIF                                                     CER048 BUG23587
149730200529      **********                                                                     CER048 BUG23587
149740200529     C**********           EXSR CNVERT                                               CER048 BUG23587
149750200529      **********                                                                     CER048 BUG23587
149760200529     C********** XAMNT2    IFLE EWSATH                                               CER048 BUG23587
149770200529     C**********           MOVEL'Y'       WSATH                                      CER048 BUG23587
149780200529     C**********           ENDIF                                                     CER048 BUG23587
149790200529      **********                                                                     CER048 BUG23587
149800200529     C**********           ENDIF                                                     CER048 BUG23587
149810200529     C**********           ENDIF                                                     CER048 BUG23587
149820200529     C**********           ENDIF                                                     CER048 BUG23587
149830200529      *                                                                                       CER048
149840200529      ** Check the average rate threshold                                                     CER048
149850200529      *                                                                                       CER048
149860200529     C           SHISD     IFEQ CNCID                                                         CER048
149870200529      *                                                                                       CER048
149880200529      ** Work credit interest number                                                          CER048
149890200529      *                                                                                       CER048
149900200529     C                     Z-ADD*ZEROS    WCRIN  150                                          CER048
149910200529      *                                                                                       CER048
149920200529      ** Work credit interest                                                                 CER048
149930200529      *                                                                                       CER048
149940200529     C                     MOVEL'N'       WCRIT   1                                           CER048
149950200529      *                                                                                       CER048
149960200529      ** Work date                                                                            CER048
149970200529      *                                                                                       CER048
149980200529     C                     MOVELSPCID     WDATE                                               CER048
149990200529      *                                                                                       CER048
150000200529      ** Work capitalisation date                                                             CER048
150010200529      *                                                                                       CER048
150020200529     C                     MOVELSHISD     WCDAT                                               CER048
150030200529      *                                                                                       CER048
150040200529      ** Work balance                                                                         CER048
150050200529      *                                                                                       CER048
150060200529     C                     MOVELSHISB     WHISB                                               CER048
150070200529      *                                                                                       CER048
150080200529      ** Access account currency details                                                      CER048
150090200529      *                                                                                       CER048
150100200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
150110200529     C           BCCY      LOKUPACUR,A                   17                                 CRE083BK
150120200529      *                                                                                     CRE083BK
150130200529     C           *IN17     IFEQ '1'                                                         CRE083BK
150140200529     C           A         OCUR SDCURR                                                      CRE083BK
150150200529     C                     ELSE                                                             CRE083BK
150160200529     C           1         OCUR SDCURR                                                      MD021155
150170200529     C                     CALL 'AOCURRR0'                                                    CER048
150180200529     C                     PARM *BLANKS   PRTCD                                               CER048
150190200529     C                     PARM '*KEY  '  POPTN                                               CER048
150200200529     C                     PARM BCCY      PCYCD   3                                           CER048
150210200529     C           SDCURR    PARM SDCURR    DSSDY                                               CER048
150220200529      *                                                                                       CER048
150230200529     C           @RTCD     IFNE *BLANKS                                                       CER048
150240200529     C           *LOCK     IN   LDA                                                           CER048
150250200529     C                     MOVEL'SDCURRPD'DBFILE                                              CER048
150260200529     C                     MOVELPCYCD     DBKEY                                               CER048
150270200529     C                     Z-ADD312       DBASE                                               CER048
150280200529     C                     OUT  LDA                                                           CER048
150290200529     C                     EXSR *PSSR                                                         CER048
150300200529     C                     ENDIF                                                              CER048
150310200529     C                     ENDIF                                                            CRE083BK
150320200529      *                                                                                       CER048
150330200529     C           4         ADD  CDP       FD      10                                          CER048
150340200529      *                                                                                       CER048
150350200529      ** Read previous history record to ensure include previous end                          CER048
150360200529      ** of month balance record                                                              CER048
150370200529      *                                                                                       CER048
150380200529     C                     MOVE BBRCA     BRCA                                                CER048
150390200529     C**********           Z-ADDBCNUM     CNUM                                         CER048 CER059
150400200529     C                     MOVE BCNUM     CNUM                                                CER059
150410200529     C                     MOVE BCCY      CCY                                                 CER048
150420200529     C                     Z-ADDBACOD     ACOD                                                CER048
150430200529     C                     Z-ADDBACSQ     ACSQ                                                CER048
150440200529     C                     Z-ADDWDATE     HISD                                                CER048
150450200529      *                                                                                       CER048
150460200529      ** Read previous history record                                                         CER048
150470200529      *                                                                                       CER048
150480200529     C           R3KEY     SETLLREHISL                                                        CER048
150490200529     C********** R3KEYA    READEREHISL                   40                          CER048 MD024557
150500200529     C           R3KEYA    READEREHISL              N    40                                 MD024557
150510200529      *                                                                                       CER048
150520200529     C           *IN40     DOUEQ*ON                                                           CER048
150530200529      *                                                                                       CER048
150540200529     C           *IN40     IFEQ *OFF                                                          CER048
150550200529      *                                                                                       CER048
150560200529     C           HISD      IFGT WCDAT                                                         CER048
150570200529     C                     LEAVE                                                              CER048
150580200529     C                     ENDIF                                                              CER048
150590200529      *                                                                                       CER048
150600200529     C                     MOVELHISD      ZIEND                                               CER048
150610200529      *                                                                                       CER048
150620200529     C           CRCI      IFEQ 'Y'                                                           CER048
150630200529     C           HISD      ANDGTPCID                                                          CER048
150640200529     C           HISD      ANDLTWCDAT                                                         CER048
150650200529     C                     MOVEL'Y'       WCRIT                                               CER048
150660200529     C                     ENDIF                                                              CER048
150670200529      *                                                                                       CER048
150680200529     C                     ELSE                                                               CER048
150690200529      *                                                                                       CER048
150700200529     C                     MOVELWCDAT     ZIEND                                               CER048
150710200529      *                                                                                       CER048
150720200529     C                     ENDIF                                                              CER048
150730200529      *                                                                                       CER048
150740200529     C                     MOVELWDATE     ZIBEG                                               CER048
150750200529      *                                                                                       CER048
150760200529     C           ZIBEG     IFLT ZIEND                                                         CER048
150770200529      *                                                                                       CER048
150780200529     C                     Z-ADDCRCB      ZICALC                                              CER048
150790200529      *                                                                                       CER048
150800200529     C                     EXSR ZICD                                                          CER048
150810200529      *                                                                                       CER048
150820200529     C           WHISB     MULT ZDAYN2    WINUM  150                                          CER048
150830200529     C           WINUM     DIV  100       WINUM                                               CER048
150840200529     C           WINUM     DIV  POWER,FD  WINUM                                               CER048
150850200529      *                                                                                       CER048
150860200529      ** If work balance is less than zero                                                    CER048
150870200529      *                                                                                       CER048
150880200529     C           WHISB     IFLT *ZERO                                                         CER048
150890200529     C                     ADD  WINUM     WCRIN                                               CER048
150900200529     C                     ENDIF                                                              CER048
150910200529      *                                                                                       CER048
150920200529     C                     ENDIF                                                              CER048
150930200529      *                                                                                       CER048
150940200529     C                     Z-ADDHISB      WHISB                                               CER048
150950200529     C                     Z-ADDHISD      WDATE                                               CER048
150960200529      *                                                                                       CER048
150970200529     C           HISD      IFEQ WCDAT                                                         CER048
150980200529     C           RECI      ANDEQ'S'                                                           CER048
150990200529     C                     LEAVE                                                              CER048
151000200529     C                     ENDIF                                                              CER048
151010200529      *                                                                                       CER048
151020200529     C********** R3KEYA    READEREHISL                   40                          CER048 MD024557
151030200529     C           R3KEYA    READEREHISL              N    40                                 MD024557
151040200529      *                                                                                       CER048
151050200529     C                     ENDDO                                                              CER048
151060200529      *                                                                                       CER048
151070200529      ** Check threshold                                                                      CER048
151080200529      *                                                                                       CER048
151090200529     C           CRCB      IFEQ 1                                                             CER048
151100200529     C           CRCB      OREQ 4                                                             CER048
151110200529      *                                                                                       CER048
151120200529     C                     Z-ADD365       WNDYR   30                                          CER048
151130200529      *                                                                                       CER048
151140200529     C                     ELSE                                                               CER048
151150200529      *                                                                                       CER048
151160200529     C           CRCB      IFEQ 6                                                             CER048
151170200529     C                     Z-ADD365       WNDYR                                               CER048
151180200529     C                     ELSE                                                               CER048
151190200529     C                     Z-ADD360       WNDYR                                               CER048
151200200529      *                                                                                       CER048
151210200529     C                     ENDIF                                                              CER048
151220200529      *                                                                                       CER048
151230200529     C                     ENDIF                                                              CER048
151240200529      *                                                                                       CER048
151250200529      ** If work credit interest number is not zero                                           CER048
151260200529      *                                                                                       CER048
151270200529     C           WCRIN     IFNE *ZEROS                                                        CER048
151280200529      *                                                                                       CER048
151290200529     C           RCAIC     MULT WNDYR     WCTOT  180                                          CER048
151300200529     C           WCTOT     DIV  WCRIN     AVRT   235                                          CER048
151310200529      *                                                                                       CER048
151320200529      ** Only calculate average rate to 2 decimals                                            CER048
151330200529      *                                                                                       CER048
151340200529     C           AVRT      DIV  POWER,FD  WAVRT  232H                                         CER048
151350200529     C                     Z-ADDWAVRT     AVRT                                                CER048
151360200529      *                                                                                       CER048
151370200529     C           AVRT      IFLT *ZEROS                                                        CER048
151380200529     C                     MULT -1        AVRT                                                CER048
151390200529     C                     ENDIF                                                              CER048
151400200529      *                                                                                       CER048
151410200529     C           WCRIT     IFNE 'Y'                                                           CER048
151420200529     C           SCICT     ANDEQ*ZEROS                                                        CER048
151430200529     C                     Z-ADDAVRT      SCRIR                                               CER048
151440200529     C                     ENDIF                                                              CER048
151450200529      *                                                                                       CER048
151460200529     C                     ELSE                                                               CER048
151470200529     C                     Z-ADD*ZEROS    AVRT                                                CER048
151480200529     C                     ENDIF                                                              CER048
151490200529      *                                                                                       CER048
151500200529     C           SHISD     IFGE EWRAED                                                        CER048
151510200529     C                     Z-ADDEWRARL    WLEVEL                                              CER048
151520200529     C                     ELSE                                                               CER048
151530200529     C                     Z-ADDEWPARL    WLEVEL                                              CER048
151540200529     C                     ENDIF                                                              CER048
151550200529      *                                                                                       CER048
151560200529     C           AVRT      IFLE WLEVEL                                                        CER048
151570200529     C                     MOVEL'Y'       WARTH                                               CER048
151580200529     C                     ENDIF                                                              CER048
151590200529      *                                                                                       CER048
151600200529     C                     ENDIF                                                              CER048
151610200529     C                     ENDIF                                                              CER048
151620200529      *                                                                                       CER048
151630200529     C                     ENDIF                                                              CER048
151640200529      *                                                                                       CER048
151650200529     C           WARTH     IFEQ 'Y'                                                         BUG23347
151660200529      *                                                                                     BUG23347
151670200529     C**********           Z-ADDBJRDNB    KRDNB                                    BUG23347 BUG24114
151680200529     C                     MOVE 'G'       KMODI                                             BUG23347
151690200529     C                     MOVE BCNUM     KCUST                                             BUG23347
151700200529     C                     MOVE BCCY      KSCCY                                             BUG23347
151710200529     C                     Z-ADDBACOD     KACDE                                             BUG23347
151720200529     C                     Z-ADDBACSQ     KACSQ                                             BUG23347
151730200529     C                     MOVE BBRCA     KBRCA                                             BUG23347
151740200529     C                     Z-ADDLCID      KRDNB                                             BUG24114
151750200529      *                                                                                     BUG24114
151760200529     C                     Z-ADD*ZEROS    WNIBC  150                                        BUG24114
151770200529     C                     Z-ADD*ZEROS    WPTBC  150                                        BUG24114
151780200529     C                     Z-ADD*ZEROS    WTTAX  150                                        BUG24114
151790200529      *                                                                                     BUG23347
151800200529     C********** KCIL7     SETLLSDCSINL7                                           BUG23347 BUG24114
151810200529     C********** KCIL7     READESDCSINL7                 70                        BUG23347 BUG24114
151820200529     C           INTAD     IFEQ '1'                                                         AR676495
151830200529     C                     MOVE '0'       INTAD                                             AR676495
151840200529     C                     ELSE                                                             AR676495
151850200529     C           KCILJ     SETLLSDCSINLJ                                                    BUG24114
151860200529     C                     ENDIF                                                            AR676495
151870200529     C           KCILJ     READESDCSINLJ                 70                                 BUG24114
151880200529      *                                                                                     BUG23347
151890200529     C           *IN70     DOWEQ*OFF                                                        BUG23347
151900200529      *                                                                                     BUG23347
151910200529     C**********           MOVE TSNINB    WNIBC  150                               BUG23347 BUG24114
151920200529     C**********           MOVE TSPTHU    WPTBC  150                               BUG23347 BUG24114
151930200529     C                     ADD  TSNINB    WNIBC                                             BUG24114
151940200529     C                     ADD  TSPTHU    WPTBC                                             BUG24114
151950200529     C                     ADD  TSTXSB    WTTAX                                             BUG24114
151960200529     C                     ADD  TSSTDB    WTTAX                                             BUG24114
151970200529     C                     ADD  TSTTDB    WTTAX                                             BUG25295
151980200529      *                                                                                     BUG23347
151990200529     C                     MOVE *ZEROS    TSTXSR                                            BUG23347
152000200529     C                     MOVE *ZEROS    TSTXSS                                            BUG23347
152010200529     C                     MOVE *ZEROS    TSTXSC                                            BUG23347
152020200529     C                     MOVE *ZEROS    TSTXSB                                            BUG23347
152030200529     C                     MOVE *ZEROS    TSSTDO                                            BUG23347
152040200529     C                     MOVE *ZEROS    TSSTDS                                            BUG23347
152050200529     C                     MOVE *ZEROS    TSSTDT                                            BUG23347
152060200529     C                     MOVE *ZEROS    TSSTDB                                            BUG23347
152070200529     C                     MOVE *ZEROS    TSPTHU                                            BUG24114
152080200529     C                     MOVE *ZEROS    TSTTDO                                            BUG25295
152090200529     C                     MOVE *ZEROS    TSTTDS                                            BUG25295
152100200529     C                     MOVE *ZEROS    TSTTDT                                            BUG25295
152110200529     C                     MOVE *ZEROS    TSTTDB                                            BUG25295
152120200529      *                                                                                     BUG23347
152130200529     C                     MOVE TSGINT    TSNINT                                            BUG23347
152140200529     C                     MOVE TSGINS    TSNINS                                            BUG23347
152150200529     C                     MOVE TSGINC    TSNINC                                            BUG23347
152160200529     C                     MOVE TSGINB    TSNINB                                            BUG23347
152170200529      *                                                                                     BUG24114
152180200529     C                     UPDATSDCSINDJ                                                    BUG24114
152190200529      *                                                                                     BUG23347
152200200529     C********** KCIL7     READESDCSINL7                 70                        BUG23347 BUG24114
152210200529     C           KCILJ     READESDCSINLJ                 70                                 BUG24114
152220200529      *                                                                                     BUG23347
152230200529     C                     ENDDO                                                            BUG23347
152240200529      *                                                                                     BUG23347
152250200529     C                     MOVE TSCUST    KCNUM                                             BUG23347
152260200529     C                     MOVE TSBRCA    KBRCH                                             BUG23347
152270200529      *                                                                                     BUG23347
152280200529     C           R3KEYB    SETLLSDINPHL2                                                    BUG23347
152290200529     C           R3KEYB    READESDINPHL2                 71                                 BUG23347
152300200529      *                                                                                     BUG23347
152310200529     C           *IN71     IFEQ *OFF                                                        BUG23681
152320200529     C           TITOUT    SUB  WNIBC     TITOUT                                            BUG23347
152330200529     C           TIUTTH    SUB  WPTBC     TIUTTH                                            BUG23347
152340200529     C           TITTAX    SUB  WTTAX     TITTAX                                            BUG24114
152350200529      *                                                                                     BUG23347
152360200529     C                     UPDATSDINPHD0                                                    BUG23347
152370200529     C                     ENDIF                                                            BUG23681
152380200529      *                                                                                     BUG23347
152390200529     C           ACKEY1    CHAINREACR                40                                    BUG23309A
152400200529      *                                                                                    BUG23309A
152410200529      ** REACR Record not found                                                            BUG23309A
152420200529      *                                                                                    BUG23309A
152430200529     C           *IN40     IFEQ '1'                                                        BUG23309A
152440200529     C           *LOCK     IN   LDA                                                        BUG23309A
152450200529     C                     Z-ADD03        DBASE                                            BUG23309A
152460200529     C                     MOVEL'REACR'   DBFILE                                           BUG23309A
152470200529     C                     MOVELAKEY      DBKEY                                            BUG23309A
152480200529     C                     OUT  LDA                                                        BUG23309A
152490200529     C                     EXSR *PSSR                                                      BUG23309A
152500200529     C                     END                                                             BUG23309A
152510200529      *                                                                                    BUG23309A
152520200529     C           HISB      IFLE *ZEROS                                                     BUG23309A
152530200529     C           HISB      SUB  WTTAX     HISB                                             BUG23309A
152540200529     C                     ELSE                                                            BUG23309A
152550200529     C           HISB      ADD  WTTAX     HISB                                             BUG23309A
152560200529     C**********           UPDATREACRDF                                          BUG23309A BUG23309B
152570200529     C                     ENDIF                                                           BUG23309A
152580200529      *                                                                                    BUG23309A
152590200529     C                     UPDATREACRDF                                                    BUG23309B
152600200529      *                                                                                    BUG23309B
152610200529     C                     ENDIF                                                            BUG23347
152620200529      *                                                                                     BUG23347
152630200529     C           WARTH     IFEQ 'Y'                                                           CER048
152640200529     C********** WSATH     OREQ 'Y'                                                  CER048 BUG23587
152650200529     C                     ELSE                                                               CER048
152660200529      *                                                                                       CER048
152670200529      *                                                                                       232543
152680200529      ** Read customer income records.                                                        CGL031
152690200529      *                                                                                       CGL031
152700200529     C                     Z-ADDBJRDNB    KRDNB                                               CGL031
152710200529     C                     MOVE 'G'       KMODI                                               CGL031
152720200529     C                     MOVE BCNUM     KCUST                                               CGL031
152730200529     C                     MOVE BCNUM     KJOIN                                               232543
152740200529     C                     MOVE BCCY      KSCCY                                               CGL031
152750200529     C                     Z-ADDBACOD     KACDE                                               CGL031
152760200529     C                     Z-ADDBACSQ     KACSQ                                               CGL031
152770200529     C                     MOVE BBRCA     KBRCA                                               CGL031
152780200529      *                                                                                       CGL031
152790200529     C********** KCSIN     SETLLSDCSINL7                                               CGL031 232543
152800200529     C********** KCSIN     READESDCSINL7                 84                            CGL031 232543
152810200529      *                                                                                       CGL031
152820200529     C           WJACC     IFEQ 'Y'                                                           232543
152830200529     C           INTAD     IFEQ '1'                                                         AR676495
152840200529     C                     MOVE '0'       INTAD                                             AR676495
152850200529     C                     ELSE                                                             AR676495
152860200529     C           KCILC     SETLLSDCSINLC                                                      232543
152870200529     C                     ENDIF                                                            AR676495
152880200529     C           KCILC     READESDCSINLC                 84                                   232543
152890200529     C                     ELSE                                                               232543
152900200529     C           INTAD     IFEQ '1'                                                         AR676495
152910200529     C                     MOVE '0'       INTAD                                             AR676495
152920200529     C                     ELSE                                                             AR676495
152930200529     C           KCIL7     SETLLSDCSINL7                                                      232543
152940200529     C                     ENDIF                                                            AR676495
152950200529     C           KCIL7     READESDCSINL7                 84                                   232543
152960200529     C                     ENDIF                                                              232543
152970200529      *                                                                                       232543
152980200529     C           *IN84     DOWEQ*OFF                                                          CGL031
152990200529     C           TSSTAT    ANDEQ'T'                                                           CGL031
153000200529      *
153010200529      ***This*will*only*calculate*tax*with*tax*calc*date*equal*to*run*date         AR762246 AR813717
153020200529     C********** TSEDAT    IFEQ WDATE                                              AR762246 AR813717
153030200529      *                                                                                     BUG26900
153040200529      ** For non-joint account accumulate only if TSJOIN is zero                            BUG26900
153050200529     C           WJACC     IFEQ 'Y'                                                         BUG26900
153060200529     C           WJACC     OREQ 'N'                                                         BUG26900
153070200529     C********** TSJOIN    ANDEQ*ZERO                                              BUG26900 AR744480
153080200529     C           TSJOIN    ANDEQ*BLANKS                                                     AR744480
153090200529      *                                                                                       CGL031
153100200529      ** If original ccy is equal to tax ccy, accumulate tax amount in                        CGL031
153110200529      ** original ccy. Otherwise, accumulate tax amount and gross interest                    CGL031
153120200529      ** amount in original, tax, and base currencies.                                        CGL031
153130200529      *                                                                                       CGL031
153140200529     C           TSOCCY    IFEQ TSTXCY                                                        CGL031
153150200529     C           CER048    IFEQ 'Y'                                                           CER048
153160200529     C                     ADD  TSSTDO    WKSTXO                                              CER048
153170200529     C                     ENDIF                                                              CER048
153180200529     C           CER054    IFEQ 'Y'                                                           CER054
153190200529     C                     ADD  TSTTDO    WKTTXO                                              CER054
153200200529     C                     ENDIF                                                              CER054
153210200529     C                     ADD  TSTXSR    WTAOC                                               CGL031
153220200529     C                     ELSE                                                               CGL031
153230200529     C                     ADD  TSTXSR    WTAOC                                               CGL031
153240200529     C                     ADD  TSTXSC    WTATC                                               CGL031
153250200529     C                     ADD  TSTXSB    WTABC                                               CGL031
153260200529     C**********           ADD  TSGINT    WIAOC                                        CGL031 232543
153270200529     C**********           ADD  TSGINC    WIATC                                        CGL031 232543
153280200529     C**********           ADD  TSGINB    WIABC                                        CGL031 232543
153290200529     C           CER048    IFEQ 'Y'                                                           CER048
153300200529     C                     ADD  TSSTDO    WKSTXO                                              CER048
153310200529     C                     ADD  TSSTDT    WKSTXT                                              CER048
153320200529     C                     ADD  TSSTDB    WKSTXB                                              CER048
153330200529     C                     ENDIF                                                              CER048
153340200529     C           CER054    IFEQ 'Y'                                                           CER054
153350200529     C                     ADD  TSTTDO    WKTTXO                                              CER054
153360200529     C                     ADD  TSTTDT    WKTTXT                                              CER054
153370200529     C                     ADD  TSTTDB    WKTTXB                                              CER054
153380200529     C                     ENDIF                                                              CER054
153390200529     C                     ENDIF                                                              CGL031
153400200529      *                                                                                       CGL031
153410200529     C********** KCSIN     READESDCSINL7                 84                            CGL031 232543
153420200529     C                     MOVE TSWTAC    WEWTA                                               235174
153430200529     C           CER048    IFEQ 'Y'                                                           CER048
153440200529     C                     MOVE TSSTAC    WSTAC                                               CER048
153450200529     C                     ENDIF                                                              CER054
153460200529     C           CER054    IFEQ 'Y'                                                           CER054
153470200529     C                     MOVE TSTTAC    WTTAC                                               CER054
153480200529     C                     ENDIF                                                              CER048
153490200529      *                                                                                     BUG26900
153500200529      ** TSJOIN is zero                                                                     BUG26900
153510200529     C                     ENDIF                                                            BUG26900
153520200529      *                                                                                     AR762246
153530200529     C**********           ENDIF                                                   AR762246 AR813717
153540200529      *                                                                                       232543
153550200529     C           WJACC     IFEQ 'Y'                                                           232543
153560200529      *                                                                                       235174
153570200529      ** Generate EU a/c keys for tax amount.                                                 235174
153580200529      *                                                                                       235174
153590200529     C                     EXSR SREATA                                                        235174
153600200529      *                                                                                       235174
153610200529     C           KCILC     READESDCSINLC                 84                                   232543
153620200529     C                     ELSE                                                               232543
153630200529     C           KCIL7     READESDCSINL7                 84                                   232543
153640200529     C                     ENDIF                                                              232543
153650200529      *                                                                                       232543
153660200529     C                     ENDDO                                                              CGL031
153670200529      *                                                                                       CGL031
153680200529     C                     ENDIF                                                              CER048
153690200529     C**********           Z-ADD*ZERO     BRTAMT                                       CGL031 232543
153700200529     C**********           Z-ADD*ZERO     NETBRT                                       CGL031 232543
153710200529     C**********           Z-ADD*ZERO     PACR1                                        CGL031 232543
153720200529     C**********           Z-ADD*ZERO     BRTAM2                                       CGL031 232543
153730200529      *                                                                                       CGL031
153740200529     C**********           Z-ADDTRAT      WTRAT                                        CGL031 232543
153750200529     C**********           MOVE TXTXTT    TRAT                                         CGL031 232543
153760200529      *                                                                                       CGL031
153770200529      ** Set up the narrative.                                                                CGL031
153780200529      *                                                                                       CGL031
153790200529     C**********           Z-ADD6         #                                            CGL031 235174
153800200529     C**********           MOVELNAR,#     INPNAR                                       CGL031 235174
153810200529     C**********           MOVELNR16,#    INP16                                        CGL031 235174
153820200529     C**********           MOVELDN07,#    INP07                                        CGL031 235174
153830200529     C**********           MOVELMGD,#     ##MGID                                       CGL031 235174
153840200529      *                                                                                       CGL031
153850200529     C**********           MOVE BBRCA     BRCA                                         CGL031 235174
153860200529     C**********           Z-ADDBCNUM     CNUM                                         CGL031 235174
153870200529     C**********           MOVE BCCY      CCY                                          CGL031 235174
153880200529     C**********           Z-ADDBACOD     ACOD                                         CGL031 235174
153890200529     C**********           Z-ADDBACSQ     ACSQ                                         CGL031 235174
153900200529     C**********           MOVE WACNO     ACNO                                         CGL031 235174
153910200529      *                                                                                       CGL031
153920200529     C**********           MOVE TSWTAC    WEWTA                                        232543 235174
153930200529      *                                                                                       232543
153940200529      ***Reset*transaction type.                                                       CGL031 232543
153950200529      ***********                                                                      CGL031 232543
153960200529     C***********          Z-ADDWTRAT     TRAT                                         CGL031 232543
153970200529     C***********          MOVELWTRAT     OTTP                                         CGL031 232543
153980200529      *                                                                                       CGL031
153990200529     C                     ENDSR                                                              CGL031
154000200529      *****************************************************************                       CGL031
154010200529      /EJECT                                                                                  CGL031
154020200529      *****************************************************************                       CGL031
154030200529      *                                                               *                       CGL031
154040200529      *  SRGPOS - Generates postings for EU withholding tax           *                       CGL031
154050200529      *           accounting.                                         *                       CGL031
154060200529      *                                                               *                       CGL031
154070200529      *****************************************************************                       CGL031
154080200529     C           SRGPOS    BEGSR                                                              CGL031
154090200529      *                                                                                       CGL031
154100200529      ** Save Transaction Type.                                                               232543
154110200529      *                                                                                       232543
154120200529     C                     Z-ADDTRAT      WTRAT                                               232543
154130200529     C                     MOVE TXTXTT    TRAT                                                232543
154140200529     C                     MOVE 'Y'       WEUTT   1                                           234003
154150200529      *                                                                                       234438
154160200529     C                     MOVELNAR,14    INPNAR                                              234438
154170200529     C                     MOVELNR16,14   INP16                                               234438
154180200529     C                     MOVELDN07,14   INP07                                               234438
154190200529     C                     MOVELMGD,14    ##MGID                                              234438
154200200529      *                                                                                       232543
154210200529     C********** WTAOC     IFGT *ZERO                                                  232543 235875
154220200529     C           WTAOC     IFNE *ZERO                                                         235875
154230200529      *                                                                                       CGL031
154240200529      ** Output EU Withholding Tax as a DR to the retail a/c.                                 CGL031
154250200529      *                                                                                       CGL031
154260200529     C           CACP      IFEQ *BLANKS                                                     AR851468
154270200529     C                     MOVE BBRCA     BRCA                                                235917
154280200529     C**********           Z-ADDBCNUM     CNUM                                        235917 CSD027A
154290200529     C                     MOVE BCNUM     CNUM                                               CSD027A
154300200529     C                     MOVE BCCY      CCY                                                 235917
154310200529     C                     Z-ADDBACOD     ACOD                                                235917
154320200529     C                     Z-ADDBACSQ     ACSQ                                                235917
154330200529     C                     MOVE WACNO     ACNO                                                235917
154340200529     C                     ELSE                                                             AR851468
154350200529     C                     MOVE @CBRCA    BRCA                                              AR851468
154360200529     C                     MOVE @CCNUM    CNUM                                              AR851468
154370200529     C                     MOVE @CCCY     CCY                                               AR851468
154380200529     C                     Z-ADD@CACOD    ACOD                                              AR851468
154390200529     C                     Z-ADD@CACSQ    ACSQ                                              AR851468
154400200529     C                     MOVE @CACNO    ACNO                                              AR851468
154410200529     C                     Z-ADDWTAOC     WAMTCO 150                                        MD039280
154420200529     C           BCCY      IFNE CCY                                                         MD039280
154430200529     C                     EXSR CVTAMT                                                      MD039280
154440200529     C                     ENDIF                                                            MD039280
154450200529     C                     ENDIF                                                            AR851468
154460200529      *                                                                                       235917
154470200529      ***PACR1*is the gross credit amount to be posted.                                CGL031 232543
154480200529      **********                                                                       CGL031 232543
154490200529     C**********           Z-ADD@WCAIC    PACR1                                        CGL031 232543
154500200529      **********                                                                       CGL031 232543
154510200529      ***BRTAMT*is the accumulated tax amount in original ccy.                         CGL031 232543
154520200529      **********                                                                       CGL031 232543
154530200529     C**********           Z-ADDWTAOC     BRTAMT    H                                  CGL031 232543
154540200529     C**********           SUB  BRTAMT    PACR1                                        CGL031 232543
154550200529      **********                                                                       CGL031 232543
154560200529     C********** BRTAMT    IFGT *ZERO                                                  CGL031 232543
154570200529     C**********           Z-ADDBRTAMT    BRTAM2                                       CGL031 232543
154580200529     C                     Z-ADDRUND      PSTD                                                CGL031
154590200529     C**********           Z-ADDCNCID     VALD                                         CGL031 234870
154600200529     C**********           Z-ADDCNCID     HISD                                         CGL031 234870
154610200529     C**********           Z-ADDNXTCID    VALD                                         234870 235368
154620200529     C**********           Z-ADDNXTCID    HISD                                         234870 235368
154630200529     C**********           Z-ADDSHISD     VALD                                      235368 BUG23097A
154640200529     C**********           Z-ADDSHISD     HISD                                      235368 BUG23097A
154650200529     C                     Z-ADDCNCID     VALD                                             BUG23097A
154660200529     C                     Z-ADDCNCID     HISD                                             BUG23097A
154670200529     C**********           Z-ADDBRTAM2    WPSTA                                        CGL031 232543
154680200529     C           BCCY      IFNE CCY                                                         MD039280
154690200529     C                     Z-ADDWPSTAA    WPSTA                                             MD039280
154700200529     C                     ELSE                                                             MD039280
154710200529     C                     Z-ADDWTAOC     WPSTA                                               232543
154720200529     C                     ENDIF                                                            MD039280
154730200529     C                     Z-ADD*ZERO     RRNM                                                CGL031
154740200529     C                     EXSR SUBNAR                                                        CGL031
154750200529      ** Main Tax                                                                          BUG23163A
154760200529      *                                                                                    BUG23163A
154770200529     C           CER048    IFEQ 'Y'                                                        BUG23163A
154780200529     C           NARS      ANDEQEUTAXN                                                     BUG23163A
154790200529     C           CER048    OREQ 'Y'                                                         AR851468
154800200529     C           CACP      ANDNE*BLANK                                                      AR851468
154810200529     C           CER048    OREQ 'Y'                                                         AR318139
154820200529     C           NARS      ANDEQEUTXN2,1                                                    AR318139
154830200529     C           REPNAR    IFNE 'Y'                                                         AR318139
154840200529     C                     MOVELCPRITX    NARS      P                                      BUG23163A
154850200529     C                     ELSE                                                             AR318139
154860200529     C                     MOVE 'GB00543' ##MGID                                            AR318139
154870200529     C                     ENDIF                                                            AR318139
154880200529     C                     ENDIF                                                           BUG23163A
154890200529      *                                                                                    BUG23163A
154900200529     C                     MOVE NARS      PNAR                                                CGL031
154910200529     C                     EXSR GEICPR                                                        CGL031
154920200529      *                                                                                       CGL031
154930200529      ** Update history if required (first time).                                             CGL031
154940200529      *                                                                                       CGL031
154950200529     C           ATYP      IFEQ 'R'                                                           CGL031
154960200529     C           VALD      ANDLENAPDA                                                         CGL031
154970200529     C           *IN50     ANDEQ*OFF                                                          CGL031
154980200529      *                                                                                       CGL031
154990200529     C                     Z-ADD137       DBASE                                               CGL031
155000200529     C                     MOVE 'N'       REACT                                               CGL031
155010200529     C                     WRITEREHPOSPF                                                      CGL031
155020200529      *                                                                                       CGL031
155030200529     C           CACP      IFEQ *BLANKS                                                       CGL031
155040200529      *                                                                                       CGL031
155050200529     C           R3KEY     CHAINREHISPDF             40                                       CGL031
155060200529      *                                                                                       CGL031
155070200529     C           *IN40     IFEQ *ON                                                           CGL031
155080200529     C                     MOVE 'D'       RECI                                                CGL031
155090200529     C                     MOVE *BLANKS   DLGID                                               CGL031
155100200529     C                     Z-ADD*ZERO     VALL                                                CGL031
155110200529     C                     MOVE *BLANK    LINK                                                CGL031
155120200529     C                     MOVE *BLANK    DICI                                                CGL031
155130200529     C                     MOVE *BLANK    CICI                                                CGL031
155140200529     C                     MOVE *BLANK    DRCI                                                CGL031
155150200529     C                     MOVE *BLANK    CRCI                                                CGL031
155160200529     C                     MOVE *BLANK    ALTI                                                CGL031
155170200529     C                     Z-ADD*ZERO     DRIR                                                CGL031
155180200529     C                     Z-ADD*ZERO     CRIR                                                CGL031
155190200529     C                     Z-ADD*ZERO     PDID                                                CGL031
155200200529     C                     Z-ADD*ZERO     PCID                                                CGL031
155210200529     C                     Z-ADD*ZERO     DICT                                                CGL031
155220200529     C                     Z-ADD*ZERO     CICT                                                CGL031
155230200529     C                     Z-ADD*ZERO     DRCB                                                CGL031
155240200529     C                     Z-ADD*ZERO     CRCB                                                CGL031
155250200529     C                     MOVE *BLANK    ADTY                                                CGL031
155260200529     C                     Z-ADD*ZERO     MNBL                                                CGL031
155270200529     C                     Z-ADD*ZERO     CHGAR                                               CGL031
155280200529     C                     Z-ADD*ZERO     TCHGAR                                              CGL031
155290200529     C                     Z-ADD*ZERO     CHGAN                                               CGL031
155300200529     C                     Z-ADD*ZERO     TCHGAN                                              CGL031
155310200529     C                     Z-ADD*ZERO     DMVT                                                CGL031
155320200529     C                     Z-ADD*ZERO     CMVT                                                CGL031
155330200529     C                     Z-ADD*ZERO     DAID                                                CGL031
155340200529     C                     Z-ADD*ZERO     MADI                                                CGL031
155350200529     C                     Z-ADD*ZERO     TMADI                                               CGL031
155360200529     C                     Z-ADD*ZERO     DMINT                                               CGL031
155370200529     C                     Z-ADD*ZERO     CAID                                                CGL031
155380200529     C                     Z-ADD*ZERO     MACI                                                CGL031
155390200529     C                     Z-ADD*ZERO     TMACI                                               CGL031
155400200529     C                     Z-ADD*ZERO     CMINT                                               CGL031
155410200529     C                     Z-ADD*ZERO     MNBCP                                               CGL031
155420200529     C                     Z-ADD*ZERO     DRCD                                                CGL031
155430200529     C                     Z-ADD*ZERO     CRCD                                                CGL031
155440200529     C                     Z-ADD*ZERO     VDTC                                                CGL031
155450200529      *                                                                                       CGL031
155460200529     C           DRCR      IFEQ 1                                                             CGL031
155470200529     C                     Z-ADDPSTA      CMVT                                                CGL031
155480200529     C                     ELSE                                                               CGL031
155490200529     C                     Z-ADDPSTA      DMVT                                                CGL031
155500200529     C                     ENDIF                                                              CGL031
155510200529      *                                                                                       CGL031
155520200529     C           SHISB     ADD  DMVT      HISB                                             BUG23097A
155530200529     C**********           Z-ADDDMVT      HISB                                      CGL031 BUG23097A
155540200529     C                     SUB  CMVT      HISB                                                CGL031
155550200529     C                     Z-ADD139       DBASE                                               CGL031
155560200529     C                     WRITEREHISPDF                                                      CGL031
155570200529     C                     Z-ADD*ZEROS    DBASE                                               CGL031
155580200529     C                     ELSE                                                               CGL031
155590200529      *                                                                                       CGL031
155600200529     C           DRCR      IFEQ 1                                                             CGL031
155610200529     C                     ADD  PSTA      CMVT                                                CGL031
155620200529     C                     ELSE                                                               CGL031
155630200529     C                     ADD  PSTA      DMVT                                                CGL031
155640200529     C                     ENDIF                                                              CGL031
155650200529      *                                                                                       CGL031
155660200529     C                     Z-ADD139       DBASE                                               CGL031
155670200529     C                     UPDATREHISPDF                                                      CGL031
155680200529     C                     MOVE 'Y'       FCOMIT                                            MD022410
155690200529     C                     Z-ADD*ZEROS    DBASE                                               CGL031
155700200529     C                     ENDIF                                                              CGL031
155710200529      *                                                                                       CGL031
155720200529     C                     ELSE                                                               CGL031
155730200529     C                     EXSR POSPR                                                         CGL031
155740200529     C                     ENDIF                                                              CGL031
155750200529     C                     ENDIF                                                              CGL031
155760200529      *                                                                                       CGL031
155770200529      ** Output EU withholding tax as a CR to the internal tax a/c in                         CGL031
155780200529      ***retail*a/c*currency.                                                          CGL031 232543
155790200529      ** retail a/c currency only if Tax Ccy = A/c Ccy.                                       232543
155800200529      *                                                                                       CGL031
155810200529     C           TSTXCY    IFEQ BCCY                                                          232543
155820200529     C           CACP      ANDEQ*BLANKS                                                    MD039280A
155830200529     C           TSTXCY    OREQ CCY                                                        MD039280A
155840200529     C           CACP      ANDNE*BLANKS                                                    MD039280A
155850200529      *                                                                                       232543
155860200529     C           CACP      IFEQ *BLANKS                                                    MD039280A
155870200529     C           BCCY      OREQ CCY                                                        MD039280A
155880200529     C                     Z-SUBWTAOC     WPSTA                                               232543
155890200529     C                     ELSE                                                            MD039280A
155900200529     C                     Z-SUBWPSTAA    WPSTA                                            MD039280A
155910200529     C                     ENDIF                                                           MD039280A
155920200529     C                     MOVE BBICN     CNUM                                                CGL031
155930200529     C**********           Z-ADDTSWTAC    ACOD                                         CGL031 232543
155940200529     C                     Z-ADDWEWTA     ACOD                                                232543
155950200529     C                     Z-ADD1         ACSQ                                                CGL031
155960200529     C                     Z-ADD*ZERO     ACNO                                                CGL031
155970200529     C                     Z-ADDRUND      VALD                                                CGL031
155980200529     C                     EXSR SUBNAR                                                        CGL031
155990200529     C                     MOVE NARS      PNAR                                                CGL031
156000200529      *                                                                                       235174
156010200529      ** EU tax postings are written by subroutine SREATA per Joint A/c                       235174
156020200529      ** member given a Joint A/c.                                                            235174
156030200529      *                                                                                       235174
156040200529     C           WJACC     IFNE 'Y'                                                           235174
156050200529     C                     EXSR GEICPR                                                        CGL031
156060200529      *                                                                                       CGL031
156070200529      ** Update history if required (second time).                                            CGL031
156080200529      *                                                                                       CGL031
156090200529     C           ATYP      IFEQ 'R'                                                           CGL031
156100200529     C           VALD      ANDLENAPDA                                                         CGL031
156110200529     C           *IN50     ANDEQ*OFF                                                          CGL031
156120200529     C                     Z-ADD137       DBASE                                               CGL031
156130200529     C                     MOVE 'N'       REACT                                               CGL031
156140200529     C                     WRITEREHPOSPF                                                      CGL031
156150200529     C                     EXSR POSPR                                                         CGL031
156160200529     C                     ENDIF                                                              CGL031
156170200529     C                     ENDIF                                                              235174
156180200529      *                                                                                       CGL031
156190200529     C                     ENDIF                                                              232543
156200200529      *                                                                                       232543
156210200529     C                     ENDIF                                                              232543
156220200529      *                                                                                       232543
156230200529      ***If*original ccy is not equal to tax ccy, generate postings in                 CGL031 232543
156240200529      ***foreign*ccy.                                                                  CGL031 232543
156250200529      **********                                                                       CGL031 232543
156260200529     C********** TSOCCY    IFNE TSTXCY                                                 CGL031 232543
156270200529      *                                                                                       232543
156280200529      ** Output additional postings if Tax Ccy <> A/c Ccy.                                    232543
156290200529      *                                                                                       232543
156300200529     C           TSTXCY    IFNE BCCY                                                          232543
156310200529     C           CACP      ANDEQ*BLANKS                                                    MD039280A
156320200529     C           TSTXCY    ORNE CCY                                                        MD039280A
156330200529     C           CACP      ANDNE*BLANKS                                                    MD039280A
156340200529     C           WTAOC     ANDNE*ZERO                                                      MD039280A
156350200529      *                                                                                    MD039280A
156360200529     C                     Z-ADD*ZEROS    TMPWT2 150                                       MD039280A
156370200529     C           CER048    IFEQ 'Y'                                                        MD039280A
156380200529     C           WTAOC     ANDNE*ZEROS                                                     MD039280A
156390200529     C           WKSTXO    ANDNE*ZEROS                                                     MD039280A
156400200529     C           CACP      ANDNE*BLANKS                                                    MD039280A
156410200529     C           BCCY      ANDNECCY                                                        MD039280A
156420200529     C                     Z-ADDWKSTXO    WAMTCO                                           MD039280A
156430200529     C                     EXSR CVTAMT                                                     MD039280A
156440200529     C                     Z-ADDWKSTXO    TMPWT2                                           MD039280A
156450200529     C                     Z-ADDWPSTAA    WKSTXO                                           MD039280A
156460200529     C           WKSTXT    IFEQ *ZEROS                                                     MD039280A
156470200529     C                     Z-ADDTSSTDT    WKSTXT                                           MD039280A
156480200529     C                     ENDIF                                                           MD039280A
156490200529     C           WKSTXB    IFEQ *ZEROS                                                     MD039280A
156500200529     C                     ADD  TSSTDB    WKSTXB                                           MD039280A
156510200529     C                     ENDIF                                                           MD039280A
156520200529     C                     ENDIF                                                           MD039280A
156530200529      *                                                                                    MD039280A
156540200529     C           CACP      IFNE *BLANKS                                                    MD039280A
156550200529     C                     MOVE BCCY      TMPCCY  3                                        MD039280A
156560200529     C                     MOVE CCY       BCCY                                             MD039280A
156570200529     C                     Z-ADDWTAOC     TMPWTA 130                                       MD039280A
156580200529     C                     Z-ADDWPSTA     WTAOC                                            MD039280A
156590200529     C           WTABC     IFEQ *ZEROS                                                     MD039280A
156600200529     C                     ADD  TSTXSB    WTABC                                            MD039280A
156610200529     C                     ENDIF                                                           MD039280A
156620200529     C           WTATC     IFEQ *ZEROS                                                     MD039280A
156630200529     C                     ADD  TSTXSC    WTATC                                            MD039280A
156640200529     C                     ENDIF                                                           MD039280A
156650200529     C                     ENDIF                                                           MD039280A
156660200529      *                                                                                    MD039280A
156670200529     C                     EXSR SRFPOS                                                        CGL031
156680200529      *                                                                                    MD039280A
156690200529     C           CACP      IFNE *BLANKS                                                    MD039280A
156700200529     C                     MOVE TMPCCY    BCCY                                             MD039280A
156710200529     C                     Z-ADDTMPWTA    WTAOC                                            MD039280A
156720200529     C           TMPWT2    IFNE *ZEROS                                                     MD039280A
156730200529     C                     Z-ADDTMPWT2    WKSTXO                                           MD039280A
156740200529     C                     ENDIF                                                           MD039280A
156750200529     C                     ENDIF                                                           MD039280A
156760200529      *                                                                                    MD039280A
156770200529     C                     ENDIF                                                              232543
156780200529      *                                                                                       232543
156790200529     C********** STRGRO    SUB  STRBRT    STRNET                                       CGL031 232543
156800200529     C********** BSEGRO    SUB  BSEBRT    BSENET                                       CGL031 232543
156810200529     C**********           ELSE                                                        CGL031 232543
156820200529     C**********           Z-ADDBRTAMT    STRBRT                                       CGL031 232543
156830200529     C**********           Z-ADDPACR1     STRGRO                                       CGL031 232543
156840200529     C**********           Z-ADDNETBRT    STRNET                                       CGL031 232543
156850200529      *                                                                                       CGL031
156860200529     C**********           Z-ADDBRTAMT    BSEBRT                                       CGL031 232543
156870200529     C**********           Z-ADDPACR1     BSEGRO                                       CGL031 232543
156880200529     C**********           Z-ADDNETBRT    BSENET                                       CGL031 232543
156890200529     C**********           ENDIF                                                       CGL031 232543
156900200529      *                                                                                       232543
156910200529      ** Reset Transaction Type.                                                              232543
156920200529      *                                                                                       232543
156930200529     C                     Z-ADDWTRAT     TRAT                                                232543
156940200529     C                     MOVE 'N'       WEUTT                                               234003
156950200529      *                                                                                       CER048
156960200529     C           CER048    IFEQ 'Y'                                                           CER048
156970200529      *                                                                                       CER048
156980200529     C           WTAOC     IFNE *ZEROS                                                        CER048
156990200529     C           WKSTXO    ANDNE*ZEROS                                                        CER048
157000200529      *                                                                                       CER048
157010200529     C                     MOVELWKSTXO    WPSTA                                               CER048
157020200529     C           CACP      IFEQ *BLANKS                                                     AR851468
157030200529     C                     MOVELBBRCA     BRCA                                                CER048
157040200529     C                     MOVELBCNUM     CNUM                                                CER048
157050200529     C                     MOVELBCCY      CCY                                                 CER048
157060200529     C                     MOVELBACOD     ACOD                                                CER048
157070200529     C                     MOVELBACSQ     ACSQ                                                CER048
157080200529     C                     MOVELWACNO     ACNO                                                CER048
157090200529     C                     ELSE                                                             AR851468
157100200529     C                     MOVE @CBRCA    BRCA                                              AR851468
157110200529     C                     MOVE @CCNUM    CNUM                                              AR851468
157120200529     C                     MOVE @CCCY     CCY                                               AR851468
157130200529     C                     Z-ADD@CACOD    ACOD                                              AR851468
157140200529     C                     Z-ADD@CACSQ    ACSQ                                              AR851468
157150200529     C                     MOVE @CACNO    ACNO                                              AR851468
157160200529     C                     Z-ADDWKSTXO    WAMTCO                                            MD039280
157170200529     C           BCCY      IFNE CCY                                                         MD039280
157180200529     C                     EXSR CVTAMT                                                      MD039280
157190200529     C                     Z-ADDWPSTAA    WKSTXO                                            MD039280
157200200529     C                     MOVELWKSTXO    WPSTA                                             MD039280
157210200529     C                     ENDIF                                                            MD039280
157220200529     C                     ENDIF                                                            AR851468
157230200529     C                     MOVELRUND      PSTD                                                CER048
157240200529     C**********           MOVELSHISD     VALD                                      CER048 BUG23097A
157250200529     C**********           MOVELSHISD     HISD                                      CER048 BUG23097A
157260200529     C                     Z-ADDCNCID     VALD                                              BUG25530
157270200529     C                     Z-ADDCNCID     HISD                                              BUG25530
157280200529     C                     Z-ADD0         RRNM                                                CER048
157290200529      *                                                                                       CER048
157300200529     C                     EXSR SUBNAR                                                        CER048
157310200529      ** Secondary Tax                                                                     BUG23163A
157320200529      *                                                                                    BUG23163A
157330200529     C           NARS      IFEQ EUTAXN                                                     BUG23163A
157340200529     C           CACP      ORNE *BLANK                                                      AR851468
157350200529     C           NARS      OREQ EUTXN2,1                                                    AR318139
157360200529     C           REPNAR    IFNE 'Y'                                                         AR318139
157370200529     C                     MOVELC2NDTX    NARS      P                                      BUG23163A
157380200529     C                     ELSE                                                             AR318139
157390200529     C                     MOVE 'GB00544' ##MGID                                            AR318139
157400200529     C                     ENDIF                                                            AR318139
157410200529     C                     ENDIF                                                           BUG23163A
157420200529      *                                                                                    BUG23163A
157430200529     C                     MOVELNARS      PNAR                                                CER048
157440200529     C                     EXSR GEICPR                                                        CER048
157450200529      *                                                                                       CER048
157460200529      ** Update history if required (Third time)                                              CER048
157470200529      ** for the posting amount for the secondary tax.                                        CER048
157480200529      *                                                                                       CER048
157490200529     C           ATYP      IFEQ 'R'                                                           CER048
157500200529     C           VALD      ANDLENAPDA                                                         CER048
157510200529     C           *IN50     ANDEQ*OFF                                                          CER048
157520200529     C                     Z-ADD313       DBASE                                               CER048
157530200529     C                     MOVE 'N'       REACT                                               CER048
157540200529     C                     WRITEREHPOSPF                                                      CER048
157550200529     C           CACP      IFEQ *BLANKS                                                    BUG23097A
157560200529      *                                                                                    BUG23097A
157570200529     C           R3KEY     CHAINREHISPDF             40                                    BUG23097A
157580200529      *                                                                                    BUG23097A
157590200529     C           *IN40     IFEQ *ON                                                        BUG23097A
157600200529     C                     MOVE 'D'       RECI                                             BUG23097A
157610200529     C                     MOVE *BLANKS   DLGID                                            BUG23097A
157620200529     C                     Z-ADD*ZERO     VALL                                             BUG23097A
157630200529     C                     MOVE *BLANK    LINK                                             BUG23097A
157640200529     C                     MOVE *BLANK    DICI                                             BUG23097A
157650200529     C                     MOVE *BLANK    CICI                                             BUG23097A
157660200529     C                     MOVE *BLANK    DRCI                                             BUG23097A
157670200529     C                     MOVE *BLANK    CRCI                                             BUG23097A
157680200529     C                     MOVE *BLANK    ALTI                                             BUG23097A
157690200529     C                     Z-ADD*ZERO     DRIR                                             BUG23097A
157700200529     C                     Z-ADD*ZERO     CRIR                                             BUG23097A
157710200529     C                     Z-ADD*ZERO     PDID                                             BUG23097A
157720200529     C                     Z-ADD*ZERO     PCID                                             BUG23097A
157730200529     C                     Z-ADD*ZERO     DICT                                             BUG23097A
157740200529     C                     Z-ADD*ZERO     CICT                                             BUG23097A
157750200529     C                     Z-ADD*ZERO     DRCB                                             BUG23097A
157760200529     C                     Z-ADD*ZERO     CRCB                                             BUG23097A
157770200529     C                     MOVE *BLANK    ADTY                                             BUG23097A
157780200529     C                     Z-ADD*ZERO     MNBL                                             BUG23097A
157790200529     C                     Z-ADD*ZERO     CHGAR                                            BUG23097A
157800200529     C                     Z-ADD*ZERO     TCHGAR                                           BUG23097A
157810200529     C                     Z-ADD*ZERO     CHGAN                                            BUG23097A
157820200529     C                     Z-ADD*ZERO     TCHGAN                                           BUG23097A
157830200529     C                     Z-ADD*ZERO     DMVT                                             BUG23097A
157840200529     C                     Z-ADD*ZERO     CMVT                                             BUG23097A
157850200529     C                     Z-ADD*ZERO     DAID                                             BUG23097A
157860200529     C                     Z-ADD*ZERO     MADI                                             BUG23097A
157870200529     C                     Z-ADD*ZERO     TMADI                                            BUG23097A
157880200529     C                     Z-ADD*ZERO     DMINT                                            BUG23097A
157890200529     C                     Z-ADD*ZERO     CAID                                             BUG23097A
157900200529     C                     Z-ADD*ZERO     MACI                                             BUG23097A
157910200529     C                     Z-ADD*ZERO     TMACI                                            BUG23097A
157920200529     C                     Z-ADD*ZERO     CMINT                                            BUG23097A
157930200529     C                     Z-ADD*ZERO     MNBCP                                            BUG23097A
157940200529     C                     Z-ADD*ZERO     DRCD                                             BUG23097A
157950200529     C                     Z-ADD*ZERO     CRCD                                             BUG23097A
157960200529     C                     Z-ADD*ZERO     VDTC                                             BUG23097A
157970200529      *                                                                                    BUG23097A
157980200529     C           DRCR      IFEQ 1                                                          BUG23097A
157990200529     C                     Z-ADDPSTA      CMVT                                             BUG23097A
158000200529     C                     ELSE                                                            BUG23097A
158010200529     C                     Z-ADDPSTA      DMVT                                             BUG23097A
158020200529     C                     ENDIF                                                           BUG23097A
158030200529      *                                                                                    BUG23097A
158040200529     C           SHISB     ADD  DMVT      HISB                                             BUG23097A
158050200529     C                     SUB  CMVT      HISB                                             BUG23097A
158060200529     C                     Z-ADD321       DBASE                                            BUG23097A
158070200529     C                     WRITEREHISPDF                                                   BUG23097A
158080200529     C                     Z-ADD*ZEROS    DBASE                                            BUG23097A
158090200529     C                     ELSE                                                            BUG23097A
158100200529      *                                                                                    BUG23097A
158110200529     C           DRCR      IFEQ 1                                                          BUG23097A
158120200529     C                     ADD  PSTA      CMVT                                             BUG23097A
158130200529     C                     ELSE                                                            BUG23097A
158140200529     C                     ADD  PSTA      DMVT                                             BUG23097A
158150200529     C                     ENDIF                                                           BUG23097A
158160200529      *                                                                                    BUG23097A
158170200529     C                     Z-ADD321       DBASE                                            BUG23097A
158180200529     C                     UPDATREHISPDF                                                   BUG23097A
158190200529     C                     MOVE 'Y'       FCOMIT                                            MD022410
158200200529     C                     Z-ADD*ZEROS    DBASE                                            BUG23097A
158210200529     C                     ENDIF                                                           BUG23097A
158220200529      *                                                                                    BUG23097A
158230200529     C                     ELSE                                                            BUG23097A
158240200529     C                     EXSR POSPR                                                         CER048
158250200529     C                     ENDIF                                                              CER048
158260200529      *                                                                                       CER048
158270200529     C                     ENDIF                                                              CER048
158280200529      *                                                                                       CER048
158290200529     C           TSTXCY    IFEQ BCCY                                                          CER048
158300200529     C           CACP      ANDEQ*BLANKS                                                    MD039280A
158310200529     C           TSTXCY    OREQ CCY                                                        MD039280A
158320200529     C           CACP      ANDNE*BLANKS                                                    MD039280A
158330200529      *                                                                                       CER048
158340200529     C**********           MOVELWKSTXB    WPSTA                                     CER048 BUG23097A
158350200529     C                     Z-SUBWKSTXO    WPSTA                                            BUG23097A
158360200529     C                     MOVELBBICN     CNUM                                                CER048
158370200529     C                     MOVELTSSTAC    ACOD                                                CER048
158380200529     C                     Z-ADD1         ACSQ                                                CER048
158390200529     C                     Z-ADD0         ACNO                                                CER048
158400200529     C                     MOVELRUND      VALD                                                CER048
158410200529      *                                                                                       CER048
158420200529     C                     EXSR SUBNAR                                                        CER048
158430200529     C                     MOVELNARS      PNAR                                                CER048
158440200529      *                                                                                       CER048
158450200529     C           WJACC     IFNE 'Y'                                                           CER048
158460200529     C                     EXSR GEICPR                                                        CER048
158470200529      *                                                                                       CER048
158480200529      ** Update history if required (Fourth time)                                             CER048
158490200529      ** for the posting amount for the secondary tax.                                        CER048
158500200529      *                                                                                       CER048
158510200529     C           ATYP      IFEQ 'R'                                                           CER048
158520200529     C           VALD      ANDLENAPDA                                                         CER048
158530200529     C           *IN50     ANDEQ*OFF                                                          CER048
158540200529     C                     Z-ADD314       DBASE                                               CER048
158550200529     C                     MOVE 'N'       REACT                                               CER048
158560200529     C                     WRITEREHPOSPF                                                      CER048
158570200529     C                     EXSR POSPR                                                         CER048
158580200529     C                     ENDIF                                                              CER048
158590200529      *                                                                                       CER048
158600200529     C                     ENDIF                                                              CER048
158610200529      *                                                                                       CER048
158620200529     C                     ENDIF                                                              CER048
158630200529      *                                                                                       CER048
158640200529     C                     ENDIF                                                              CER048
158650200529      *                                                                                       CER054
158660200529     C           CER054    IFEQ 'Y'                                                           CER054
158670200529      *                                                                                       CER054
158680200529     C           WTAOC     IFNE *ZEROS                                                        CER054
158690200529     C           WKTTXO    ANDNE*ZEROS                                                        CER054
158700200529      *                                                                                       CER054
158710200529     C                     MOVELWKTTXO    WPSTA                                               CER054
158720200529     C           CACP      IFEQ *BLANKS                                                     AR851468
158730200529     C                     MOVELBBRCA     BRCA                                                CER054
158740200529     C                     MOVELBCNUM     CNUM                                                CER054
158750200529     C                     MOVELBCCY      CCY                                                 CER054
158760200529     C                     MOVELBACOD     ACOD                                                CER054
158770200529     C                     MOVELBACSQ     ACSQ                                                CER054
158780200529     C                     MOVELWACNO     ACNO                                                CER054
158790200529     C                     ELSE                                                             AR851468
158800200529     C                     MOVE @CBRCA    BRCA                                              AR851468
158810200529     C                     MOVE @CCNUM    CNUM                                              AR851468
158820200529     C                     MOVE @CCCY     CCY                                               AR851468
158830200529     C                     Z-ADD@CACOD    ACOD                                              AR851468
158840200529     C                     Z-ADD@CACSQ    ACSQ                                              AR851468
158850200529     C                     MOVE @CACNO    ACNO                                              AR851468
158860200529     C                     Z-ADDWKTTXO    WAMTCO                                            MD039280
158870200529     C           BCCY      IFNE CCY                                                         MD039280
158880200529     C                     EXSR CVTAMT                                                      MD039280
158890200529     C                     Z-ADDWPSTAA    WKTTXO                                            MD039280
158900200529     C                     MOVELWKTTXO    WPSTA                                             MD039280
158910200529     C                     ENDIF                                                            MD039280
158920200529     C                     ENDIF                                                            AR851468
158930200529     C                     MOVELRUND      PSTD                                                CER054
158940200529     C                     Z-ADDCNCID     VALD                                              BUG25530
158950200529     C                     Z-ADDCNCID     HISD                                              BUG25530
158960200529     C                     Z-ADD0         RRNM                                                CER054
158970200529      *                                                                                       CER054
158980200529     C                     EXSR SUBNAR                                                        CER054
158990200529      ** Third Tax                                                                          BUG24341
159000200529      *                                                                                     BUG24341
159010200529     C           NARS      IFEQ EUTAXN                                                      BUG24341
159020200529     C           CACP      ORNE *BLANK                                                      AR851468
159030200529     C                     MOVELC3RDTX    NARS      P                                       BUG24341
159040200529     C                     ENDIF                                                            BUG24341
159050200529      *                                                                                     BUG24341
159060200529     C                     MOVELNARS      PNAR                                                CER054
159070200529     C                     EXSR GEICPR                                                        CER054
159080200529      *                                                                                       CER054
159090200529      ** Update history if required                                                           CER054
159100200529      ** for the posting amount for the third tax.                                            CER054
159110200529      *                                                                                       CER054
159120200529     C           ATYP      IFEQ 'R'                                                           CER054
159130200529     C           VALD      ANDLENAPDA                                                         CER054
159140200529     C           *IN50     ANDEQ*OFF                                                          CER054
159150200529     C                     Z-ADD313       DBASE                                               CER054
159160200529     C                     MOVE 'N'       REACT                                               CER054
159170200529     C                     WRITEREHPOSPF                                                      CER054
159180200529     C           CACP      IFEQ *BLANKS                                                       CER054
159190200529      *                                                                                       CER054
159200200529     C           R3KEY     CHAINREHISPDF             40                                       CER054
159210200529      *                                                                                       CER054
159220200529     C           *IN40     IFEQ *ON                                                           CER054
159230200529     C                     MOVE 'D'       RECI                                                CER054
159240200529     C                     MOVE *BLANKS   DLGID                                               CER054
159250200529     C                     Z-ADD*ZERO     VALL                                                CER054
159260200529     C                     MOVE *BLANK    LINK                                                CER054
159270200529     C                     MOVE *BLANK    DICI                                                CER054
159280200529     C                     MOVE *BLANK    CICI                                                CER054
159290200529     C                     MOVE *BLANK    DRCI                                                CER054
159300200529     C                     MOVE *BLANK    CRCI                                                CER054
159310200529     C                     MOVE *BLANK    ALTI                                                CER054
159320200529     C                     Z-ADD*ZERO     DRIR                                                CER054
159330200529     C                     Z-ADD*ZERO     CRIR                                                CER054
159340200529     C                     Z-ADD*ZERO     PDID                                                CER054
159350200529     C                     Z-ADD*ZERO     PCID                                                CER054
159360200529     C                     Z-ADD*ZERO     DICT                                                CER054
159370200529     C                     Z-ADD*ZERO     CICT                                                CER054
159380200529     C                     Z-ADD*ZERO     DRCB                                                CER054
159390200529     C                     Z-ADD*ZERO     CRCB                                                CER054
159400200529     C                     MOVE *BLANK    ADTY                                                CER054
159410200529     C                     Z-ADD*ZERO     MNBL                                                CER054
159420200529     C                     Z-ADD*ZERO     CHGAR                                               CER054
159430200529     C                     Z-ADD*ZERO     TCHGAR                                              CER054
159440200529     C                     Z-ADD*ZERO     CHGAN                                               CER054
159450200529     C                     Z-ADD*ZERO     TCHGAN                                              CER054
159460200529     C                     Z-ADD*ZERO     DMVT                                                CER054
159470200529     C                     Z-ADD*ZERO     CMVT                                                CER054
159480200529     C                     Z-ADD*ZERO     DAID                                                CER054
159490200529     C                     Z-ADD*ZERO     MADI                                                CER054
159500200529     C                     Z-ADD*ZERO     TMADI                                               CER054
159510200529     C                     Z-ADD*ZERO     DMINT                                               CER054
159520200529     C                     Z-ADD*ZERO     CAID                                                CER054
159530200529     C                     Z-ADD*ZERO     MACI                                                CER054
159540200529     C                     Z-ADD*ZERO     TMACI                                               CER054
159550200529     C                     Z-ADD*ZERO     CMINT                                               CER054
159560200529     C                     Z-ADD*ZERO     MNBCP                                               CER054
159570200529     C                     Z-ADD*ZERO     DRCD                                                CER054
159580200529     C                     Z-ADD*ZERO     CRCD                                                CER054
159590200529     C                     Z-ADD*ZERO     VDTC                                                CER054
159600200529      *                                                                                       CER054
159610200529     C           DRCR      IFEQ 1                                                             CER054
159620200529     C                     Z-ADDPSTA      CMVT                                                CER054
159630200529     C                     ELSE                                                               CER054
159640200529     C                     Z-ADDPSTA      DMVT                                                CER054
159650200529     C                     ENDIF                                                              CER054
159660200529      *                                                                                       CER054
159670200529     C           SHISB     ADD  DMVT      HISB                                                CER054
159680200529     C                     SUB  CMVT      HISB                                                CER054
159690200529     C                     Z-ADD321       DBASE                                               CER054
159700200529     C                     WRITEREHISPDF                                                      CER054
159710200529     C                     Z-ADD*ZEROS    DBASE                                               CER054
159720200529     C                     ELSE                                                               CER054
159730200529      *                                                                                       CER054
159740200529     C           DRCR      IFEQ 1                                                             CER054
159750200529     C                     ADD  PSTA      CMVT                                                CER054
159760200529     C                     ELSE                                                               CER054
159770200529     C                     ADD  PSTA      DMVT                                                CER054
159780200529     C                     ENDIF                                                              CER054
159790200529      *                                                                                       CER054
159800200529     C                     Z-ADD321       DBASE                                               CER054
159810200529     C                     UPDATREHISPDF                                                      CER054
159820200529     C                     MOVE 'Y'       FCOMIT                                            MD022410
159830200529     C                     Z-ADD*ZEROS    DBASE                                               CER054
159840200529     C                     ENDIF                                                              CER054
159850200529      *                                                                                       CER054
159860200529     C                     ELSE                                                               CER054
159870200529     C                     EXSR POSPR                                                         CER054
159880200529     C                     ENDIF                                                              CER054
159890200529      *                                                                                       CER054
159900200529     C                     ENDIF                                                              CER054
159910200529      *                                                                                       CER054
159920200529     C           TSTXCY    IFEQ BCCY                                                          CER054
159930200529     C           CACP      ANDEQ*BLANKS                                                    MD039280A
159940200529     C           TSTXCY    OREQ CCY                                                        MD039280A
159950200529     C           CACP      ANDNE*BLANKS                                                    MD039280A
159960200529      *                                                                                       CER054
159970200529     C**********           Z-SUBWKTTXB    WPSTA                                      CER054 BUG25343
159980200529     C                     Z-SUBWKTTXO    WPSTA                                             BUG25343
159990200529     C                     MOVELBBICN     CNUM                                                CER054
160000200529     C                     MOVELTSTTAC    ACOD                                                CER054
160010200529     C                     Z-ADD1         ACSQ                                                CER054
160020200529     C                     Z-ADD0         ACNO                                                CER054
160030200529     C                     MOVELRUND      PSTD                                                CER054
160040200529      *                                                                                       CER054
160050200529     C                     EXSR SUBNAR                                                        CER054
160060200529     C                     MOVELNARS      PNAR                                                CER054
160070200529      *                                                                                       CER054
160080200529     C           WJACC     IFNE 'Y'                                                           CER054
160090200529     C                     EXSR GEICPR                                                        CER054
160100200529      *                                                                                       CER054
160110200529      ** Update history if required                                                           CER054
160120200529      ** for the posting amount for the third tax.                                            CER054
160130200529      *                                                                                       CER054
160140200529     C           ATYP      IFEQ 'R'                                                           CER054
160150200529     C           VALD      ANDLENAPDA                                                         CER054
160160200529     C           *IN50     ANDEQ*OFF                                                          CER054
160170200529     C                     Z-ADD314       DBASE                                               CER054
160180200529     C                     MOVE 'N'       REACT                                               CER054
160190200529     C                     WRITEREHPOSPF                                                      CER054
160200200529     C                     EXSR POSPR                                                         CER054
160210200529     C                     ENDIF                                                              CER054
160220200529      *                                                                                       CER054
160230200529     C                     ENDIF                                                              CER054
160240200529      *                                                                                       CER054
160250200529     C                     ENDIF                                                              CER054
160260200529      *                                                                                       CER054
160270200529     C                     ENDIF                                                              CER054
160280200529     C                     ENDIF                                                              CER054
160290200529     C                     ENDIF                                                           BUG23097A
160300200529      *                                                                                       CGL031
160310200529     C                     ENDSR                                                              CGL031
160320200529      *****************************************************************                     MD039280
160330200529      /EJECT                                                                                MD039280
160340200529      *****************************************************************                     MD039280
160350200529      *                                                               *                     MD039280
160360200529      *  CVTAMT - Convert amount for Alternate AC not equal to        *                     MD039280
160370200529      *           Main retail AC currency.                            *                     MD039280
160380200529      *                                                               *                     MD039280
160390200529      *****************************************************************                     MD039280
160400200529     C           CVTAMT    BEGSR                                                            MD039280
160410200529      *                                                                                     MD039280
160420200529      ** Save account of alternate.                                                         MD039280
160430200529      *                                                                                     MD039280
160440200529     C                     MOVE CCY       ALCCY                                             MD039280
160450200529     C                     MOVE BRCA      ALBRCA                                            MD039280
160460200529     C                     MOVE CNUM      ALCNUM                                            MD039280
160470200529     C                     Z-ADDACOD      ALACOD                                            MD039280
160480200529     C                     Z-ADDACSQ      ALACSQ                                            MD039280
160490200529      *                                                                                     MD039280
160500200529      ** Check if alternate currency exist.                                                 MD039280
160510200529      *                                                                                     MD039280
160520200529     C                     Z-ADDCUCCYA    A                                                 MD039280
160530200529     C           ALCCY     LOKUPACUR,A                   17                                 MD039280
160540200529      *                                                                                     MD039280
160550200529     C           *IN17     IFEQ '1'                                                         MD039280
160560200529     C           A         OCUR SDCURR                                                      MD039280
160570200529     C                     ELSE                                                             MD039280
160580200529     C           1         OCUR SDCURR                                                      MD039280
160590200529     C                     CALL 'AOCURRR0'                                                  MD039280
160600200529     C                     PARM '*MSG   ' @RTCD                                             MD039280
160610200529     C                     PARM '*KEY   ' @OPTN                                             MD039280
160620200529     C                     PARM ALCCY     @CYCD   3                                         MD039280
160630200529     C           SDCURR    PARM SDCURR    DSSDY                                             MD039280
160640200529     C           @RTCD     IFNE *BLANK                                                      MD039280
160650200529     C           *LOCK     IN   LDA                                                         MD039280
160660200529     C                     MOVEL'SDCURRPD'DBFILE           ***************                  MD039280
160670200529     C                     MOVEL@CYCD     DBKEY            * DB ERROR 014*                  MD039280
160680200529     C                     Z-ADD014       DBASE            ***************                  MD039280
160690200529     C                     OUT  LDA                                                         MD039280
160700200529     C                     EXSR *PSSR                                                       MD039280
160710200529     C                     END                                                              MD039280
160720200529     C                     ENDIF                                                            MD039280
160730200529      *                                                                                     MD039280
160740200529      ** Save parm for cross currency.                                                      MD039280
160750200529      *                                                                                     MD039280
160760200529     C                     Z-ADDCDP       WACDP                                             MD039280
160770200529     C                     Z-ADDSPOT      WASPOT                                            MD039280
160780200529     C                     MOVE MDIN      WAMDIN                                            MD039280
160790200529     C                     MOVE TACC      WATACC                                            MD039280
160800200529      *                                                                                     MD039280
160810200529     C                     MOVE WATACC    KACOD  10                                         MD039280
160820200529      *                                                                                     MD039280
160830200529     C                     ADD  1         RCSQ                                              MD039280
160840200529     C                     MOVE KACOD     KEYACD                                            MD039280
160850200529     C                     Z-ADD145       WDBASE                                            MD039280
160860200529     C                     EXSR ACDCCH                                                      MD039280
160870200529      *                                                                                     MD039280
160880200529     C                     MOVE A5ACTY    WATACT                                            MD039280
160890200529      *                                                                                     MD039280
160900200529      *                                                                                     MD039280
160910200529      ** Calculate the alternate currency equivalent amount.                                MD039280
160920200529      *                                                                                     MD039280
160930200529     C                     MOVE BCCY      ZCCYI                                             MD039280
160940200529     C                     Z-ADDWOSPOT    ZRATEF                                            MD039280
160950200529     C                     MOVE WOCDP     ZCDPI                                             MD039280
160960200529     C                     MOVE WOMDIN    ZMDINF                                            MD039280
160970200529     C                     MOVE ALCCY     ZCCYO                                             MD039280
160980200529     C                     Z-ADDWASPOT    ZRATET                                            MD039280
160990200529     C                     MOVE WACDP     ZCDPO                                             MD039280
161000200529     C                     MOVE WAMDIN    ZMDINT                                            MD039280
161010200529     C                     Z-ADDWAMTCO    ZAMTCI                                            MD039280
161020200529     C                     EXSR #CCYCN                                                      MD039280
161030200529     C                     Z-ADDZAMTCO    WPSTAA                                            MD039280
161040200529      *                                                                                     MD039280
161050200529     C                     ENDSR                                                            MD039280
161060200529      *****************************************************************                       CGL031
161070200529      /EJECT                                                                                  CGL031
161080200529      *****************************************************************                       CGL031
161090200529      *                                                               *                       CGL031
161100200529      *  SRFPOS - Generates foreign postings for EU withholding tax   *                       CGL031
161110200529      *           accounting.                                         *                       CGL031
161120200529      *                                                               *                       CGL031
161130200529      *****************************************************************                       CGL031
161140200529     C           SRFPOS    BEGSR                                                              CGL031
161150200529      *                                                                                       232543
161160200529     C********** *IN26     IFEQ *ON                                                    CGL031 232543
161170200529      **********                                                                       CGL031 232543
161180200529      ***Set*on*indicator to output:                                                   CGL031 232543
161190200529      ***-*DR*Ccy Tax Held A/C                                                         CGL031 232543
161200200529      ***-*CR*Ccy Spot Position A/C                                                    CGL031 232543
161210200529      ***-*CR*Base Ccy Equiv. A/C - Local Ccy                                          CGL031 232543
161220200529      ***-*DR*Base Ccy Equiv. A/C - Ccy                                                CGL031 232543
161230200529      ***-*CR*Local Ccy Tax Held A/C                                                   CGL031 232543
161240200529      ***-*DR*Local Ccy Spot Position A/C                                              CGL031 232543
161250200529      **********                                                                       CGL031 232543
161260200529     C**********           MOVE *ON       *IN27                                        CGL031 232543
161270200529     C**********           Z-ADD10        #                                            CGL031 232543
161280200529      **********                                                                       CGL031 232543
161290200529      ***Add*6*to record count for these extra postings.                               CGL031 232543
161300200529      **********                                                                       CGL031 232543
161310200529     C********** *IN29     IFEQ *OFF                                                   CGL031 232543
161320200529     C**********           ADD  6         NBRREC                                       CGL031 232543
161330200529     C**********           ELSE                                                        CGL031 232543
161340200529     C**********           ADD  4         NBRREC                                       CGL031 232543
161350200529     C**********           ENDIF                                                       CGL031 232543
161360200529      **********                                                                       CGL031 232543
161370200529     C**********           ENDIF                                                       CGL031 232543
161380200529      **********                                                                       CGL031 232543
161390200529      ***Put*accumulated amounts into Base BRT Amount & Sterling Amount                CGL031 232543
161400200529      ***for*output.                                                                   CGL031 232543
161410200529      **********                                                                       CGL031 232543
161420200529     C**********           Z-ADDWTABC     BSEBRT                                       CGL031 232543
161430200529     C**********           Z-ADDWIABC     BSEGRO                                       CGL031 232543
161440200529     C**********           Z-ADDWTATC     STRBRT                                       CGL031 232543
161450200529     C**********           Z-ADDWIATC     STRGRO                                       CGL031 232543
161460200529      **********                                                                       CGL031 232543
161470200529      ***Output*postings if Sterling Spot Trade A/C Equiv. Code is                     CGL031 232543
161480200529      ***not*zero. Execute SR/PLPR 6 times.                                            CGL031 232543
161490200529      **********                                                                       CGL031 232543
161500200529      ****If*Analytical Accounting is enabled:                                         CGL031 232543
161510200529      ****-*If*posting to spot trade or trade equivalent account,                      CGL031 232543
161520200529      ******use*FX Position Profit Centre (already setup in SR/CREPR).                 CGL031 232543
161530200529      ****-*Otherwise, use profit centre of the main account.                          CGL031 232543
161540200529      **********                                                                       CGL031 232543
161550200529     C********** *IN29     IFEQ *OFF                                                   CGL031 232543
161560200529      **********                                                                       CGL031 232543
161570200529     C********** BRTAM2    IFNE *ZERO                                                  CGL031 232543
161580200529     C**********           MOVE BCCY      CCY                                          CGL031 232543
161590200529     C**********           MOVE ACOD1     ACOD                                         CGL031 232543
161600200529     C**********           MOVE *BLANKS   IPDN                                         CGL031 232543
161610200529     C**********           Z-ADDBRTAM2    WPSTA                                        CGL031 232543
161620200529     C**********           MOVE *BLANKS   MGTT                                         CGL031 232543
161630200529     C**********           Z-ADD*ZERO     LTAI                                         CGL031 232543
161640200529     C**********           MOVE *BLANKS   RINO                                         CGL031 232543
161650200529     C**********           MOVE *BLANKS   SWCR                                         CGL031 232543
161660200529     C**********           MOVE *BLANKS   DLREF                                        CGL031 232543
161670200529     C**********           MOVE *BLANKS   FACO                                         CGL031 232543
161680200529     C**********           Z-ADD*ZERO     DBCNUM                                       CGL031 232543
161690200529     C**********           MOVE *BLANKS   PREF                                         CGL031 232543
161700200529     C**********           MOVE *BLANKS   OTRF                                         CGL031 232543
161710200529     C**********           MOVE *BLANKS   OTST                                         CGL031 232543
161720200529     C**********           Z-ADD*ZERO     SDCB                                         CGL031 232543
161730200529     C**********           Z-ADD*ZERO     SDLB                                         CGL031 232543
161740200529     C**********           MOVE *BLANKS   BOKC                                         CGL031 232543
161750200529     C**********           Z-ADD1         NITMS                                        CGL031 232543
161760200529     C**********           MOVE *BLANKS   REBI                                         CGL031 232543
161770200529     C**********           Z-ADD*ZERO     CHGA                                         CGL031 232543
161780200529     C**********           EXSR PLPR                                                   CGL031 232543
161790200529      **********                                                                       CGL031 232543
161800200529     C**********           MOVE SPAC      ACOD                                         CGL031 232543
161810200529      **********                                                                       CGL031 232543
161820200529     C********** BGN0ST    IFEQ 'Y'                                                    CGL031 232543
161830200529     C**********           MOVE WFXPC     PRFC                                         CGL031 232543
161840200529     C**********           ENDIF                                                       CGL031 232543
161850200529      **********                                                                       CGL031 232543
161860200529     C**********           Z-SUBBRTAM2    WPSTA                                        CGL031 232543
161870200529     C**********           EXSR PLPR                                                   CGL031 232543
161880200529     C**********           ENDIF                                                       CGL031 232543
161890200529     C**********                                                                       CGL031 232543
161900200529     C********** BSEBRT    IFNE *ZERO                                                  CGL031 232543
161910200529     C**********           MOVE BACCY     CCY                                          CGL031 232543
161920200529     C**********                                                                       CGL031 232543
161930200529     C**********           CALL 'AOCURRR0'                                             CGL031 232543
161940200529     C**********           PARM '*MSG   ' PRTCD                                        CGL031 232543
161950200529     C**********           PARM '*KEY   ' POPTN                                        CGL031 232543
161960200529     C**********           PARM TSTXCY    PCYCD   3                                    CGL031 232543
161970200529     C********** SDCURR    PARM SDCURR    DSSDY                                        CGL031 232543
161980200529      **********                                                                       CGL031 232543
161990200529     C********** PRTCD     IFNE *BLANKS                                                CGL031 232543
162000200529     C********** *LOCK     IN   LDA                                                    CGL031 232543
162010200529     C**********           MOVEL'SDCURRPD'DBFILE                                       CGL031 232543
162020200529     C**********           MOVELPCYCD     DBKEY                                        CGL031 232543
162030200529     C**********           Z-ADD303       DBASE                                        CGL031 232543
162040200529     C**********           OUT  LDA                                                    CGL031 232543
162050200529     C**********           EXSR *PSSR                                                  CGL031 232543
162060200529     C**********           ENDIF                                                       CGL031 232543
162070200529      **********                                                                       CGL031 232543
162080200529     C**********           MOVE TACC      ACOD                                         CGL031 232543
162090200529      **********                                                                       CGL031 232543
162100200529     C********** BGN0ST    IFEQ 'Y'                                                    CGL031 232543
162110200529     C**********           MOVE WFXPC     PRFC                                         CGL031 232543
162120200529     C**********           ENDIF                                                       CGL031 232543
162130200529      **********                                                                       CGL031 232543
162140200529     C**********           Z-SUBBSEBRT    WPSTA                                        CGL031 232543
162150200529     C**********           EXSR PLPR                                                   CGL031 232543
162160200529      **********                                                                       CGL031 232543
162170200529     C**********           CALL 'AOCURRR0'                                             CGL031 232543
162180200529     C**********           PARM '*MSG   ' PRTCD                                        CGL031 232543
162190200529     C**********           PARM '*KEY   ' POPTN                                        CGL031 232543
162200200529     C**********           PARM BCCY      PCYCD                                        CGL031 232543
162210200529     C********** SDCURR    PARM SDCURR    DSSDY                                        CGL031 232543
162220200529      **********                                                                       CGL031 232543
162230200529     C********** PRTCD     IFNE *BLANKS                                                CGL031 232543
162240200529     C********** *LOCK     IN   LDA                                                    CGL031 232543
162250200529     C**********           MOVEL'SDCURRPD'DBFILE                                       CGL031 232543
162260200529     C**********           MOVELPCYCD     DBKEY                                        CGL031 232543
162270200529     C**********           Z-ADD304       DBASE                                        CGL031 232543
162280200529     C**********           OUT  LDA                                                    CGL031 232543
162290200529     C**********           EXSR *PSSR                                                  CGL031 232543
162300200529     C**********           ENDIF                                                       CGL031 232543
162310200529      **********                                                                       CGL031 232543
162320200529     C**********           MOVE TACC      ACOD                                         CGL031 232543
162330200529      **********                                                                       CGL031 232543
162340200529     C********** BGN0ST    IFEQ 'Y'                                                    CGL031 232543
162350200529     C**********           MOVE WFXPC     PRFC                                         CGL031 232543
162360200529     C**********           ENDIF                                                       CGL031 232543
162370200529      **********                                                                       CGL031 232543
162380200529     C**********           Z-ADDBSEBRT    WPSTA                                        CGL031 232543
162390200529     C**********           EXSR PLPR                                                   CGL031 232543
162400200529     C**********           ENDIF                                                       CGL031 232543
162410200529      **********                                                                       CGL031 232543
162420200529     C********** STRBRT    IFNE *ZERO                                                  CGL031 232543
162430200529     C**********           MOVE TSTXCY    CCY                                          CGL031 232543
162440200529     C**********           MOVE ACOD1     ACOD                                         CGL031 232543
162450200529      **********                                                                       CGL031 232543
162460200529     C********** BGN0ST    IFEQ 'Y'                                                    CGL031 232543
162470200529     C**********           MOVE WSVPC     PRFC                                         CGL031 232543
162480200529     C**********           ENDIF                                                       CGL031 232543
162490200529      **********                                                                       CGL031 232543
162500200529     C**********           Z-SUBSTRBRT    WPSTA                                        CGL031 232543
162510200529     C**********           EXSR PLPR                                                   CGL031 232543
162520200529     C**********           MOVE SPAC      ACOD                                         CGL031 232543
162530200529      **********                                                                       CGL031 232543
162540200529     C********** BGN0ST    IFEQ 'Y'                                                    CGL031 232543
162550200529     C**********           MOVE WFXPC     PRFC                                         CGL031 232543
162560200529     C**********           ENDIF                                                       CGL031 232543
162570200529      **********                                                                       CGL031 232543
162580200529     C**********           Z-ADDSTRBRT    WPSTA                                        CGL031 232543
162590200529     C**********           EXSR PLPR                                                   CGL031 232543
162600200529     C**********           ENDIF                                                       CGL031 232543
162610200529      **********                                                                       CGL031 232543
162620200529     C**********           ELSE                                                        CGL031 232543
162630200529      **********                                                                       CGL031 232543
162640200529     C********** BRTAM2    IFNE *ZERO                                                  CGL031 232543
162650200529     C**********           MOVE BCCY      CCY                                          CGL031 232543
162660200529     C**********           MOVE ACOD1     ACOD                                         CGL031 232543
162670200529     C**********           MOVE *BLANKS   IPDN                                         CGL031 232543
162680200529     C**********           Z-ADDBRTAM2    WPSTA                                        CGL031 232543
162690200529     C**********           MOVE ABRCA     BRCA                                         CGL031 232543
162700200529     C**********           MOVE *BLANKS   MGTT                                         CGL031 232543
162710200529     C**********           Z-ADD*ZERO     LTAI                                         CGL031 232543
162720200529     C**********           MOVE *BLANKS   RINO                                         CGL031 232543
162730200529     C**********           MOVE *BLANKS   SWCR                                         CGL031 232543
162740200529     C**********           MOVE *BLANKS   DLREF                                        CGL031 232543
162750200529     C**********           MOVE *BLANKS   FACO                                         CGL031 232543
162760200529     C**********           Z-ADD*ZERO     DBCNUM                                       CGL031 232543
162770200529     C**********           MOVE *BLANKS   PREF                                         CGL031 232543
162780200529     C**********           MOVE *BLANKS   OTRF                                         CGL031 232543
162790200529     C**********           MOVE *BLANKS   OTST                                         CGL031 232543
162800200529     C**********           Z-ADD*ZERO     SDCB                                         CGL031 232543
162810200529     C**********           Z-ADD*ZERO     SDLB                                         CGL031 232543
162820200529     C**********           MOVE *BLANKS   BOKC                                         CGL031 232543
162830200529     C**********           Z-ADD1         NITMS                                        CGL031 232543
162840200529     C**********           MOVE *BLANKS   REBI                                         CGL031 232543
162850200529     C**********           Z-ADD*ZERO     CHGA                                         CGL031 232543
162860200529     C**********           EXSR PLPR                                                   CGL031 232543
162870200529      **********                                                                       CGL031 232543
162880200529     C**********           MOVE SPAC      ACOD                                         CGL031 232543
162890200529      **********                                                                       CGL031 232543
162900200529     C********** BGN0ST    IFEQ 'Y'                                                    CGL031 232543
162910200529     C**********           MOVE WFXPC     PRFC                                         CGL031 232543
162920200529     C**********           ENDIF                                                       CGL031 232543
162930200529      **********                                                                       CGL031 232543
162940200529     C**********           Z-SUBBRTAM2    WPSTA                                        CGL031 232543
162950200529     C**********           EXSR PLPR                                                   CGL031 232543
162960200529     C**********           ENDIF                                                       CGL031 232543
162970200529      **********                                                                       CGL031 232543
162980200529     C********** BSEBRT    IFNE *ZERO                                                  CGL031 232543
162990200529     C**********           CALL 'AOCURRR0'                                             CGL031 232543
163000200529     C**********           PARM '*MSG   ' PRTCD                                        CGL031 232543
163010200529     C**********           PARM '*KEY   ' POPTN                                        CGL031 232543
163020200529     C**********           PARM BCCY      PCYCD                                        CGL031 232543
163030200529     C********** SDCURR    PARM SDCURR    DSSDY                                        CGL031 232543
163040200529      **********                                                                       CGL031 232543
163050200529     C********** PRTCD     IFNE *BLANKS                                                CGL031 232543
163060200529     C********** *LOCK     IN   LDA                                                    CGL031 232543
163070200529     C**********           MOVEL'SDCURRPD'DBFILE                                       CGL031 232543
163080200529     C**********           MOVELPCYCD     DBKEY                                        CGL031 232543
163090200529     C**********           Z-ADD305       DBASE                                        CGL031 232543
163100200529     C**********           OUT  LDA                                                    CGL031 232543
163110200529     C**********           EXSR *PSSR                                                  CGL031 232543
163120200529     C**********           ENDIF                                                       CGL031 232543
163130200529      **********                                                                       CGL031 232543
163140200529     C**********           MOVE TACC      ACOD                                         CGL031 232543
163150200529      **********                                                                       CGL031 232543
163160200529     C********** BGN0ST    IFEQ 'Y'                                                    CGL031 232543
163170200529     C**********           MOVE WFXPC     PRFC                                         CGL031 232543
163180200529     C**********           ENDIF                                                       CGL031 232543
163190200529      **********                                                                       CGL031 232543
163200200529     C**********           MOVE BACCY     CCY                                          CGL031 232543
163210200529     C**********           Z-ADDBSEBRT    WPSTA                                        CGL031 232543
163220200529     C**********           EXSR PLPR                                                   CGL031 232543
163230200529     C**********           ENDIF                                                       CGL031 232543
163240200529      **********                                                                       CGL031 232543
163250200529     C********** STRBRT    IFNE *ZERO                                                  CGL031 232543
163260200529     C**********           MOVE TSTXCY    CCY                                          CGL031 232543
163270200529      **********                                                                       CGL031 232543
163280200529     C**********           MOVE ACOD1     ACOD                                         CGL031 232543
163290200529      **********                                                                       CGL031 232543
163300200529     C********** BGN0ST    IFEQ 'Y'                                                    CGL031 232543
163310200529     C**********           MOVE WSVPC     PRFC                                         CGL031 232543
163320200529     C**********           ENDIF                                                       CGL031 232543
163330200529      **********                                                                       CGL031 232543
163340200529     C**********           Z-SUBSTRBRT    WPSTA                                        CGL031 232543
163350200529     C**********           EXSR PLPR                                                   CGL031 232543
163360200529     C**********           ENDIF                                                       CGL031 232543
163370200529      **********                                                                       CGL031 232543
163380200529     C**********           ENDIF                                                       CGL031 232543
163390200529      **********                                                                       CGL031 232543
163400200529      *                                                                                       232543
163410200529      ** Initialise relevant fields.                                                          232543
163420200529      *                                                                                       232543
163430200529     C                     ADD  4         NBRREC                                              232543
163440200529     C                     MOVE *BLANKS   IPDN                                                232543
163450200529     C                     MOVE *BLANKS   MGTT                                                232543
163460200529     C                     Z-ADD*ZERO     LTAI                                                232543
163470200529     C                     MOVE *BLANKS   RINO                                                232543
163480200529     C                     MOVE *BLANKS   SWCR                                                232543
163490200529     C                     MOVE *BLANKS   DLREF                                               232543
163500200529     C                     MOVE *BLANKS   FACO                                                232543
163510200529     C**********           Z-ADD*ZERO     DBCNUM                                      232543 CSD027A
163520200529     C                     MOVE *BLANKS   DBCNUM                                             CSD027A
163530200529     C                     MOVE *BLANKS   PREF                                                232543
163540200529     C                     MOVE *BLANKS   OTRF                                                232543
163550200529     C                     MOVE *BLANKS   OTST                                                232543
163560200529     C                     Z-ADD*ZERO     SDCB                                                232543
163570200529     C                     Z-ADD*ZERO     SDLB                                                232543
163580200529     C                     MOVE *BLANKS   BOKC                                                232543
163590200529     C                     MOVE *BLANKS   REBI                                                232543
163600200529     C                     Z-ADD*ZERO     CHGA                                                232543
163610200529     C                     Z-ADD1         NITMS                                               232543
163620200529      *                                                                                       232543
163630200529      ** CR A/c Ccy Spot Trade                                                                232543
163640200529      ***DR*A/c*Ccy*EU*Withholding*Tax                                                 232543 235307
163650200529      *                                                                                       232543
163660200529     C           WTAOC     IFNE *ZERO                                                         232543
163670200529     C                     MOVE BCCY      CCY                                                 232543
163680200529      *                                                                                       232543
163690200529      ** Use the FX Position Profit Centre if posting to Spot Trade or Trade Equiv.           232543
163700200529      ** A/c. Use the Profit Centre of the main a/c otherwise.                                232543
163710200529      *                                                                                       232543
163720200529     C           BGN0ST    IFEQ 'Y'                                                           232543
163730200529     C                     MOVE WFXPC     PRFC                                                232543
163740200529     C                     ENDIF                                                              232543
163750200529      *                                                                                       232543
163760200529     C                     MOVE SPAC      ACOD                                                232543
163770200529     C                     Z-SUBWTAOC     WPSTA                                               232543
163780200529     C                     EXSR PLPR                                                          232543
163790200529      *                                                                                       232543
163800200529     C                     MOVE *BLANKS   PRFC                                                232543
163810200529      *                                                                                       232543
163820200529     C***********          MOVE WEWTA     ACOD                                         232543 235307
163830200529     C***********          Z-ADDWTAOC     WPSTA                                        232543 235307
163840200529     C***********          EXSR PLPR                                                   232543 235307
163850200529     C                     ENDIF                                                              232543
163860200529      *                                                                                       232543
163870200529      ** Get Base Ccy details.                                                                232543
163880200529      *                                                                                       232543
163890200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
163900200529     C           BACCY     LOKUPACUR,A                   17                                 CRE083BK
163910200529      *                                                                                     CRE083BK
163920200529     C           *IN17     IFEQ '1'                                                         CRE083BK
163930200529     C           A         OCUR SDCURR                                                      CRE083BK
163940200529     C                     ELSE                                                             CRE083BK
163950200529     C           1         OCUR SDCURR                                                      MD021155
163960200529     C                     CALL 'AOCURRR0'                                                    232543
163970200529     C                     PARM *BLANKS   PRTCD                                               232543
163980200529     C                     PARM '*KEY   ' POPTN                                               232543
163990200529     C                     PARM BACCY     PCCY    3                                           232543
164000200529     C           SDCURR    PARM SDCURR    DSSDY                                               232543
164010200529      *                                                                                       232543
164020200529     C           PRTCD     IFNE *BLANKS                                                       232543
164030200529     C           *LOCK     IN   LDA                                                           232543
164040200529     C                     MOVEL'SDCURRPD'DBFILE                                              232543
164050200529     C                     MOVELPCCY      DBKEY                                               232543
164060200529     C                     Z-ADD303       DBASE                                               232543
164070200529     C                     OUT  LDA                                                           232543
164080200529     C                     EXSR *PSSR                                                         232543
164090200529     C                     ENDIF                                                              232543
164100200529     C                     ENDIF                                                            CRE083BK
164110200529      *                                                                                       232543
164120200529      ** Generate Spot Trade Equiv. postings if necessary.                                    232543
164130200529      *                                                                                       232543
164140200529     C           BCCY      IFNE BACCY                                                         232543
164150200529     C           WTABC     ANDNE*ZERO                                                         232543
164160200529     C           BCCY      OREQ BACCY                                                         232543
164170200529     C           TACC      ANDNE*BLANKS                                                       232543
164180200529     C           WTABC     ANDNE*ZERO                                                         232543
164190200529      *                                                                                       232543
164200200529      ** DR Base Ccy Spot Trade Equiv. A/c Ccy                                                232543
164210200529      ** CR Base Ccy Spot Trade Equiv. Tax Ccy                                                232543
164220200529      *                                                                                       232543
164230200529     C           BGN0ST    IFEQ 'Y'                                                           232543
164240200529     C                     MOVE WFXPC     PRFC                                                232543
164250200529     C                     ENDIF                                                              232543
164260200529      *                                                                                       232543
164270200529     C                     ADD  2         NBRREC                                              232543
164280200529     C                     MOVE BACCY     CCY                                                 232543
164290200529      *                                                                                       232543
164300200529      ** Get A/c Ccy details.                                                                 232543
164310200529      *                                                                                       232543
164320200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
164330200529     C           BCCY      LOKUPACUR,A                   17                                 CRE083BK
164340200529      *                                                                                     CRE083BK
164350200529     C           *IN17     IFEQ '1'                                                         CRE083BK
164360200529     C           A         OCUR SDCURR                                                      CRE083BK
164370200529     C                     ELSE                                                             CRE083BK
164380200529     C           1         OCUR SDCURR                                                      MD021155
164390200529     C                     CALL 'AOCURRR0'                                                    232543
164400200529     C                     PARM *BLANKS   PRTCD                                               232543
164410200529     C                     PARM '*KEY   ' POPTN                                               232543
164420200529     C                     PARM BCCY      PCCY                                                232543
164430200529     C           SDCURR    PARM SDCURR    DSSDY                                               232543
164440200529      *                                                                                       232543
164450200529     C           PRTCD     IFNE *BLANKS                                                       232543
164460200529     C           *LOCK     IN   LDA                                                           232543
164470200529     C                     MOVEL'SDCURRPD'DBFILE                                              232543
164480200529     C                     MOVELPCCY      DBKEY                                               232543
164490200529     C                     Z-ADD304       DBASE                                               232543
164500200529     C                     OUT  LDA                                                           232543
164510200529     C                     EXSR *PSSR                                                         232543
164520200529     C                     ENDIF                                                              232543
164530200529     C                     ENDIF                                                            CRE083BK
164540200529      *                                                                                       232543
164550200529     C                     MOVE TACC      ACOD                                                232543
164560200529     C                     Z-ADDWTABC     WPSTA                                               232543
164570200529     C                     EXSR PLPR                                                          232543
164580200529      *                                                                                       232543
164590200529      ** Get Tax Ccy details.                                                                 232543
164600200529      *                                                                                       232543
164610200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
164620200529     C           TSTXCY    LOKUPACUR,A                   17                                 CRE083BK
164630200529      *                                                                                     CRE083BK
164640200529     C           *IN17     IFEQ '1'                                                         CRE083BK
164650200529     C           A         OCUR SDCURR                                                      CRE083BK
164660200529     C                     ELSE                                                             CRE083BK
164670200529     C           1         OCUR SDCURR                                                      MD021155
164680200529     C                     CALL 'AOCURRR0'                                                    232543
164690200529     C                     PARM *BLANKS   PRTCD                                               232543
164700200529     C                     PARM '*KEY   ' POPTN                                               232543
164710200529     C                     PARM TSTXCY    PCCY                                                232543
164720200529     C           SDCURR    PARM SDCURR    DSSDY                                               232543
164730200529      *                                                                                       232543
164740200529     C           PRTCD     IFNE *BLANKS                                                       232543
164750200529     C           *LOCK     IN   LDA                                                           232543
164760200529     C                     MOVEL'SDCURRPD'DBFILE                                              232543
164770200529     C                     MOVELPCCY      DBKEY                                               232543
164780200529     C                     Z-ADD305       DBASE                                               232543
164790200529     C                     OUT  LDA                                                           232543
164800200529     C                     EXSR *PSSR                                                         232543
164810200529     C                     ENDIF                                                              232543
164820200529     C                     ENDIF                                                            CRE083BK
164830200529      *                                                                                       232543
164840200529     C                     MOVE TACC      ACOD                                                232543
164850200529     C                     Z-SUBWTABC     WPSTA                                               232543
164860200529     C                     EXSR PLPR                                                          232543
164870200529      *                                                                                       232543
164880200529     C                     ENDIF                                                              232543
164890200529      *                                                                                       232543
164900200529      ** DR Tax Ccy Spot Trade A/c                                                            232543
164910200529      ** CR Tax Ccy EU Witholding Tax A/c                                                     232543
164920200529      *                                                                                       232543
164930200529     C           WTATC     IFNE *ZERO                                                         232543
164940200529     C                     MOVE TSTXCY    CCY                                                 232543
164950200529      *                                                                                       232543
164960200529     C                     MOVE SPAC      ACOD                                                232543
164970200529     C                     Z-ADDWTATC     WPSTA                                               232543
164980200529     C                     EXSR PLPR                                                          232543
164990200529      *                                                                                       232543
165000200529      ** EU tax postings are written by subroutine SREATA per Joint A/c                       235174
165010200529      ** member given a Joint A/c.                                                            235174
165020200529      *                                                                                       235174
165030200529     C           WJACC     IFNE 'Y'                                                           235174
165040200529     C                     MOVE WEWTA     ACOD                                                232543
165050200529     C                     Z-SUBWTATC     WPSTA                                               232543
165060200529     C                     EXSR PLPR                                                          232543
165070200529     C                     ENDIF                                                              235174
165080200529     C                     ENDIF                                                              232543
165090200529      *                                                                                       CER048
165100200529     C           CER048    IFEQ 'Y'                                                           CER048
165110200529      *                                                                                       CER048
165120200529     C           WKSTXO    IFNE *ZEROS                                                        CER048
165130200529     C                     MOVELBCCY      CCY                                                 CER048
165140200529      *                                                                                       CER048
165150200529     C           BGN0ST    IFEQ 'Y'                                                           CER048
165160200529     C                     MOVELWFXPC     PRFC                                                CER048
165170200529     C                     ENDIF                                                              CER048
165180200529      *                                                                                       CER048
165190200529     C                     MOVELSPAC      ACOD                                                CER048
165200200529     C**********           MOVELWKSTXO    WPSTA                                     CER048 BUG23097A
165210200529     C                     Z-SUBWKSTXO    WPSTA                                            BUG23097A
165220200529      *                                                                                       CER048
165230200529     C                     EXSR PLPR                                                          CER048
165240200529     C                     MOVEL*BLANKS   PRFC                                                CER048
165250200529      *                                                                                       CER048
165260200529     C                     ENDIF                                                              CER048
165270200529      *                                                                                       CER048
165280200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
165290200529     C           BACCY     LOKUPACUR,A                   17                                 CRE083BK
165300200529      *                                                                                     CRE083BK
165310200529     C           *IN17     IFEQ '1'                                                         CRE083BK
165320200529     C           A         OCUR SDCURR                                                      CRE083BK
165330200529     C                     ELSE                                                             CRE083BK
165340200529     C           1         OCUR SDCURR                                                      MD021155
165350200529     C                     CALL 'AOCURRR0'                                                    CER048
165360200529     C                     PARM '*MSG   ' @RTCD                                               CER048
165370200529     C                     PARM '*KEY   ' @OPTN                                               CER048
165380200529     C                     PARM BACCY     @CYCD                                               CER048
165390200529     C           SDCURR    PARM SDCURR    DSSDY                                               CER048
165400200529     C                     ENDIF                                                            CRE083BK
165410200529      *                                                                                       CER048
165420200529     C           BCCY      IFNE BACCY                                                         CER048
165430200529     C           WKSTXB    ANDNE*ZEROS                                                        CER048
165440200529     C           BCCY      OREQ BACCY                                                         CER048
165450200529     C           TACC      ANDNE*BLANKS                                                       CER048
165460200529     C           WKSTXB    ANDNE*ZEROS                                                        CER048
165470200529      *                                                                                       CER048
165480200529     C           BGN0ST    IFEQ 'Y'                                                           CER048
165490200529     C                     MOVELWFXPC     PRFC                                                CER048
165500200529     C                     ENDIF                                                              CER048
165510200529      *                                                                                       CER048
165520200529     C                     Z-ADD2         NBRREC                                              CER048
165530200529     C                     MOVELBACCY     CCY                                                 CER048
165540200529      *                                                                                       CER048
165550200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
165560200529     C           BCCY      LOKUPACUR,A                   17                                 CRE083BK
165570200529      *                                                                                     CRE083BK
165580200529     C           *IN17     IFEQ '1'                                                         CRE083BK
165590200529     C           A         OCUR SDCURR                                                      CRE083BK
165600200529     C                     ELSE                                                             CRE083BK
165610200529     C           1         OCUR SDCURR                                                      MD021155
165620200529     C                     CALL 'AOCURRR0'                                                    CER048
165630200529     C                     PARM '*MSG   ' @RTCD                                               CER048
165640200529     C                     PARM '*KEY   ' @OPTN                                               CER048
165650200529     C                     PARM BCCY      @CYCD                                               CER048
165660200529     C           SDCURR    PARM SDCURR    DSSDY                                               CER048
165670200529     C                     ENDIF                                                            CRE083BK
165680200529      *                                                                                       CER048
165690200529     C                     MOVELTACC      ACOD                                                CER048
165700200529     C**********           MOVELWKSTXB    WPSTA                                     CER048 BUG23097A
165710200529     C                     Z-ADDWKSTXB    WPSTA                                            BUG23097A
165720200529      *                                                                                       CER048
165730200529     C                     EXSR PLPR                                                          CER048
165740200529      *                                                                                       CER048
165750200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
165760200529     C           TSTXCY    LOKUPACUR,A                   17                                 CRE083BK
165770200529      *                                                                                     CRE083BK
165780200529     C           *IN17     IFEQ '1'                                                         CRE083BK
165790200529     C           A         OCUR SDCURR                                                      CRE083BK
165800200529     C                     ELSE                                                             CRE083BK
165810200529     C           1         OCUR SDCURR                                                      MD021155
165820200529     C                     CALL 'AOCURRR0'                                                    CER048
165830200529     C                     PARM '*MSG   ' @RTCD                                               CER048
165840200529     C                     PARM '*KEY   ' @OPTN                                               CER048
165850200529     C                     PARM TSTXCY    @CYCD                                               CER048
165860200529     C           SDCURR    PARM SDCURR    DSSDY                                               CER048
165870200529     C                     ENDIF                                                            CRE083BK
165880200529      *                                                                                       CER048
165890200529     C                     MOVELTACC      ACOD                                                CER048
165900200529     C**********           MOVELWKSTXB    WPSTA                                     CER048 BUG23097A
165910200529     C                     Z-SUBWKSTXB    WPSTA                                            BUG23097A
165920200529     C                     EXSR PLPR                                                          CER048
165930200529      *                                                                                       CER048
165940200529     C                     ENDIF                                                              CER048
165950200529      *                                                                                       CER048
165960200529     C           WKSTXT    IFNE *ZEROS                                                        CER048
165970200529      *                                                                                       CER048
165980200529     C                     MOVELTSTXCY    CCY                                                 CER048
165990200529     C                     MOVELSPAC      ACOD                                                CER048
166000200529     C**********           MOVELWKSTXT    WPSTA                                     CER048 BUG23097A
166010200529     C                     Z-ADDWKSTXT    WPSTA                                            BUG23097A
166020200529     C                     EXSR PLPR                                                          CER048
166030200529      *                                                                                       CER048
166040200529     C           WJACC     IFNE 'Y'                                                           CER048
166050200529      *                                                                                       CER048
166060200529     C                     MOVELWSTAC     ACOD                                                CER048
166070200529     C**********           MOVELWKSTXT    WPSTA                                     CER048 BUG23097A
166080200529     C                     Z-SUBWKSTXT    WPSTA                                            BUG23097A
166090200529     C                     EXSR PLPR                                                          CER048
166100200529      *                                                                                       CER048
166110200529     C                     ENDIF                                                              CER048
166120200529      *                                                                                       CER048
166130200529     C                     ENDIF                                                              CER048
166140200529      *                                                                                       CER048
166150200529     C                     ENDIF                                                              CER048
166160200529      *                                                                                       CER054
166170200529     C           CER054    IFEQ 'Y'                                                           CER054
166180200529      *                                                                                       CER054
166190200529     C           WKTTXO    IFNE *ZEROS                                                        CER054
166200200529     C                     MOVELBCCY      CCY                                                 CER054
166210200529      *                                                                                       CER054
166220200529     C           BGN0ST    IFEQ 'Y'                                                           CER054
166230200529     C                     MOVELWFXPC     PRFC                                                CER054
166240200529     C                     ENDIF                                                              CER054
166250200529      *                                                                                       CER054
166260200529     C                     MOVELSPAC      ACOD                                                CER054
166270200529     C                     Z-SUBWKTTXO    WPSTA                                               CER054
166280200529      *                                                                                       CER054
166290200529     C                     EXSR PLPR                                                          CER054
166300200529     C                     MOVEL*BLANKS   PRFC                                                CER054
166310200529      *                                                                                       CER054
166320200529     C                     ENDIF                                                              CER054
166330200529      *                                                                                       CER054
166340200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
166350200529     C           BACCY     LOKUPACUR,A                   17                                 CRE083BK
166360200529      *                                                                                     CRE083BK
166370200529     C           *IN17     IFEQ '1'                                                         CRE083BK
166380200529     C           A         OCUR SDCURR                                                      CRE083BK
166390200529     C                     ELSE                                                             CRE083BK
166400200529     C           1         OCUR SDCURR                                                      MD021155
166410200529     C                     CALL 'AOCURRR0'                                                    CER054
166420200529     C                     PARM '*MSG   ' @RTCD                                               CER054
166430200529     C                     PARM '*KEY   ' @OPTN                                               CER054
166440200529     C                     PARM BACCY     @CYCD                                               CER054
166450200529     C           SDCURR    PARM SDCURR    DSSDY                                               CER054
166460200529     C                     ENDIF                                                            CRE083BK
166470200529      *                                                                                       CER054
166480200529     C           BCCY      IFNE BACCY                                                         CER054
166490200529     C           WKTTXB    ANDNE*ZEROS                                                        CER054
166500200529     C           BCCY      OREQ BACCY                                                         CER054
166510200529     C           TACC      ANDNE*BLANKS                                                       CER054
166520200529     C           WKTTXB    ANDNE*ZEROS                                                        CER054
166530200529      *                                                                                       CER054
166540200529     C           BGN0ST    IFEQ 'Y'                                                           CER054
166550200529     C                     MOVELWFXPC     PRFC                                                CER054
166560200529     C                     ENDIF                                                              CER054
166570200529      *                                                                                       CER054
166580200529     C                     Z-ADD2         NBRREC                                              CER054
166590200529     C                     MOVELBACCY     CCY                                                 CER054
166600200529      *                                                                                       CER054
166610200529     C                     Z-ADDCUCCYA    A                                                 CRE083BK
166620200529     C           BCCY      LOKUPACUR,A                   17                                 CRE083BK
166630200529      *                                                                                     CRE083BK
166640200529     C           *IN17     IFEQ '1'                                                         CRE083BK
166650200529     C           A         OCUR SDCURR                                                      CRE083BK
166660200529     C                     ELSE                                                             CRE083BK
166670200529     C           1         OCUR SDCURR                                                      MD021155
166680200529     C                     CALL 'AOCURRR0'                                                    CER054
166690200529     C                     PARM '*MSG   ' @RTCD                                               CER054
166700200529     C                     PARM '*KEY   ' @OPTN                                               CER054
166710200529     C                     PARM BCCY      @CYCD                                               CER054
166720200529     C           SDCURR    PARM SDCURR    DSSDY                                               CER054
166730200529     C                     ENDIF                                                            CRE083BK
166740200529      *                                                                                       CER054
166750200529     C                     MOVELTACC      ACOD                                                CER054
166760200529     C                     Z-ADDWKTTXB    WPSTA                                               CER054
166770200529      *                                                                                       CER054
166780200529     C                     EXSR PLPR                                                          CER054
166790200529      *                                                                                       CER054
166800200529     C                     Z-ADDCUCCYA    A                                                 MD021155
166810200529     C           BCCY      LOKUPACUR,A                   17                                 MD021155
166820200529      *                                                                                     MD021155
166830200529     C           *IN17     IFEQ '1'                                                         MD021155
166840200529     C           A         OCUR SDCURR                                                      MD021155
166850200529     C                     ELSE                                                             MD021155
166860200529     C           1         OCUR SDCURR                                                      MD021155
166870200529     C                     CALL 'AOCURRR0'                                                    CER054
166880200529     C                     PARM '*MSG   ' @RTCD                                               CER054
166890200529     C                     PARM '*KEY   ' @OPTN                                               CER054
166900200529     C                     PARM TSTXCY    @CYCD                                               CER054
166910200529     C           SDCURR    PARM SDCURR    DSSDY                                               CER054
166920200529     C                     ENDIF                                                            MD021155
166930200529      *                                                                                       CER054
166940200529     C                     MOVELTACC      ACOD                                                CER054
166950200529     C                     Z-SUBWKTTXB    WPSTA                                               CER054
166960200529     C                     EXSR PLPR                                                          CER054
166970200529      *                                                                                       CER054
166980200529     C                     ENDIF                                                              CER054
166990200529      *                                                                                       CER054
167000200529     C           WKTTXT    IFNE *ZEROS                                                        CER054
167010200529      *                                                                                       CER054
167020200529     C                     MOVELTSTXCY    CCY                                                 CER054
167030200529     C                     MOVELSPAC      ACOD                                                CER054
167040200529     C                     Z-ADDWKTTXT    WPSTA                                               CER054
167050200529     C                     EXSR PLPR                                                          CER054
167060200529      *                                                                                       CER054
167070200529     C           WJACC     IFNE 'Y'                                                           CER054
167080200529      *                                                                                       CER054
167090200529     C                     MOVELWSTAC     ACOD                                                CER054
167100200529     C                     Z-SUBWKTTXT    WPSTA                                               CER054
167110200529     C                     EXSR PLPR                                                          CER054
167120200529      *                                                                                       CER054
167130200529     C                     ENDIF                                                              CER054
167140200529      *                                                                                       CER054
167150200529     C                     ENDIF                                                              CER054
167160200529      *                                                                                       CER054
167170200529     C                     ENDIF                                                              CER054
167180200529      *                                                                                       232543
167190200529     C                     ENDSR                                                              CGL031
167200200529      *****************************************************************                       235174
167210200529      /EJECT                                                                                  235174
167220200529      *****************************************************************                       235174
167230200529      *                                                               *                       235174
167240200529      *  SREATA - EU a/c key generation for tax amount (Joint A/c).   *                       235174
167250200529      *                                                               *                       235174
167260200529      *****************************************************************                       235174
167270200529     C           SREATA    BEGSR                                                              235174
167280200529      *                                                                                       235174
167290200529     C********** TSTXSR    IFGT *ZERO                                                  235174 235875
167300200529     C           TSTXSR    IFNE *ZERO                                                         235875
167310200529     C           TSTXCY    IFEQ BCCY                                                          235174
167320200529      *                                                                                       235174
167330200529     C                     Z-SUBTSTXSR    WPSTA                                               235174
167340200529      *                                                                                     MD026742
167350200529      ** For Negative Cr. Int. Adj. with negative tax.                                      MD026742
167360200529      *                                                                                     MD026742
167370200529     C           CAIC      IFLT 0                                                           MD026742
167380200529     C           TSTXSR    ANDLT0                                                           MD026742
167390200529     C                     Z-ADDTSTXSR    WPSTA                                             MD026742
167400200529     C                     ENDIF                                                            MD026742
167410200529      *                                                                                     MD026742
167420200529     C                     MOVE BBICN     CNUM                                                235174
167430200529     C                     Z-ADDWEWTA     ACOD                                                235174
167440200529     C                     Z-ADD1         ACSQ                                                235174
167450200529     C                     Z-ADD*ZERO     ACNO                                                235174
167460200529     C                     Z-ADDRUND      VALD                                                235174
167470200529     C                     EXSR SUBNAR                                                        235174
167480200529      *                                                                                     BUG23163
167490200529     C           CER048    IFEQ 'Y'                                                         BUG23163
167500200529     C                     MOVELCPRITX    NARS      P                                       BUG23163
167510200529     C                     ENDIF                                                            BUG23163
167520200529      *                                                                                     BUG23163
167530200529     C                     MOVE NARS      PNAR                                                235174
167540200529     C                     EXSR GEICPR                                                        235174
167550200529      *                                                                                       235174
167560200529      ** Update history if required (second time).                                            235174
167570200529      *                                                                                       235174
167580200529     C           ATYP      IFEQ 'R'                                                           235174
167590200529     C           VALD      ANDLENAPDA                                                         235174
167600200529     C           *IN50     ANDEQ*OFF                                                          235174
167610200529     C                     Z-ADD137       DBASE                                               235174
167620200529     C                     MOVE 'N'       REACT                                               235174
167630200529     C                     WRITEREHPOSPF                                                      235174
167640200529     C                     EXSR POSPR                                                         235174
167650200529     C                     ENDIF                                                              235174
167660200529      *                                                                                       235174
167670200529     C                     ENDIF                                                              235174
167680200529     C                     ENDIF                                                              235174
167690200529      *                                                                                       235174
167700200529     C           TSTXSC    IFNE *ZERO                                                         235174
167710200529     C           TSTXCY    IFNE BCCY                                                          235917
167720200529     C                     MOVE TSTXCY    CCY                                                 235174
167730200529     C                     MOVE WEWTA     ACOD                                                235174
167740200529     C                     Z-SUBTSTXSC    WPSTA                                               235174
167750200529     C                     MOVE BBICN     CNUM                                                235917
167760200529     C                     Z-ADD1         ACSQ                                                235917
167770200529     C                     Z-ADD*ZERO     ACNO                                                235917
167780200529     C                     Z-ADDRUND      VALD                                                235917
167790200529     C                     EXSR PLPR                                                          235174
167800200529     C                     ENDIF                                                              235917
167810200529     C                     ENDIF                                                              235174
167820200529      *                                                                                       CER048
167830200529      ** Set up the account keys for secondary tax                                            CER048
167840200529      *                                                                                       CER048
167850200529     C           CER048    IFEQ 'Y'                                                           CER048
167860200529      *                                                                                       CER048
167870200529     C           TSTXSR    IFNE *ZEROS                                                        CER048
167880200529     C           TSSTDO    ANDNE*ZEROS                                                        CER048
167890200529      *                                                                                       CER048
167900200529     C           TSTXCY    IFEQ BCCY                                                          CER048
167910200529      *                                                                                       CER048
167920200529     C                     MOVELBCCY      CCY                                                 CER048
167930200529     C**********           MOVELTSSTDO    WPSTA                                     CER048 BUG23097A
167940200529     C                     Z-SUBTSSTDO    WPSTA                                            BUG23097A
167950200529      *                                                                                     MD026742
167960200529      ** For Negative Cr. Int. Adj. with negative tax.                                      MD026742
167970200529      *                                                                                     MD026742
167980200529     C           CAIC      IFLT 0                                                           MD026742
167990200529     C           TSTXSR    ANDLT0                                                           MD026742
168000200529     C           TSSTDO    ANDLT0                                                           MD026742
168010200529     C                     Z-ADDTSSTDO    WPSTA                                             MD026742
168020200529     C                     ENDIF                                                            MD026742
168030200529      *                                                                                     MD026742
168040200529     C                     MOVELBBICN     CNUM                                                CER048
168050200529     C                     MOVELTSSTAC    ACOD                                                CER048
168060200529     C                     Z-ADD1         ACSQ                                                CER048
168070200529     C                     Z-ADD0         ACNO                                                CER048
168080200529     C                     MOVELRUND      VALD                                                CER048
168090200529      *                                                                                       CER048
168100200529     C                     EXSR SUBNAR                                                        CER048
168110200529      *                                                                                       CER048
168120200529     C**********           MOVELPNAR      NARS                                       CER048 BUG23163
168130200529     C                     MOVELC2NDTX    NARS      P                                       BUG23163
168140200529     C                     MOVELNARS      PNAR                                              BUG23163
168150200529      *                                                                                       CER048
168160200529     C                     EXSR GEICPR                                                        CER048
168170200529      *                                                                                       CER048
168180200529      ** Update history if required (Third time)                                              CER048
168190200529      ** for the posting amount for the secondary tax.                                        CER048
168200200529      *                                                                                       CER048
168210200529     C           ATYP      IFEQ 'R'                                                           CER048
168220200529     C           VALD      ANDLENAPDA                                                         CER048
168230200529     C           *IN50     ANDEQ*OFF                                                          CER048
168240200529     C                     Z-ADD315       DBASE                                               CER048
168250200529     C                     MOVE 'N'       REACT                                               CER048
168260200529     C                     WRITEREHPOSPF                                                      CER048
168270200529     C                     EXSR POSPR                                                         CER048
168280200529     C                     ENDIF                                                              CER048
168290200529      *                                                                                       CER048
168300200529     C                     ENDIF                                                              CER048
168310200529      *                                                                                       CER048
168320200529     C                     ENDIF                                                              CER048
168330200529      *                                                                                       CER048
168340200529     C           TSTXSC    IFNE *ZEROS                                                        CER048
168350200529     C********** TSSTDB    ANDNE*ZEROS                                              CER048 BUG23097A
168360200529     C           TSSTDT    ANDNE*ZEROS                                                     BUG23097A
168370200529      *                                                                                       CER048
168380200529     C           TSTXCY    IFNE BCCY                                                          CER048
168390200529      *                                                                                       CER048
168400200529     C                     MOVELTSTXCY    CCY                                                 CER048
168410200529     C**********           MOVELTSSTDB    WPSTA                                     CER048 BUG23097A
168420200529     C                     Z-SUBTSSTDT    WPSTA                                            BUG23097A
168430200529     C                     MOVELBBICN     CNUM                                                CER048
168440200529     C                     MOVELTSSTAC    ACOD                                                CER048
168450200529     C                     Z-ADD1         ACSQ                                                CER048
168460200529     C                     Z-ADD0         ACNO                                                CER048
168470200529     C                     MOVELRUND      VALD                                                CER048
168480200529      *                                                                                       CER048
168490200529     C                     EXSR PLPR                                                          CER048
168500200529      *                                                                                       CER048
168510200529     C                     ENDIF                                                              CER048
168520200529      *                                                                                       CER048
168530200529     C                     ENDIF                                                              CER048
168540200529      *                                                                                       CER048
168550200529     C                     ENDIF                                                              CER048
168560200529      *                                                                                       CER054
168570200529      ** Set up the account keys for third tax                                                CER054
168580200529      *                                                                                       CER054
168590200529     C           CER054    IFEQ 'Y'                                                           CER054
168600200529      *                                                                                       CER054
168610200529     C           TSTXSR    IFNE *ZEROS                                                        CER054
168620200529     C           TSSTDO    ANDNE*ZEROS                                                        CER054
168630200529     C           TSTTDO    ANDNE*ZEROS                                                        CER054
168640200529      *                                                                                       CER054
168650200529     C           TSTXCY    IFEQ BCCY                                                          CER054
168660200529      *                                                                                       CER054
168670200529     C                     MOVELBCCY      CCY                                                 CER054
168680200529     C                     Z-SUBTSTTDO    WPSTA                                               CER054
168690200529      *                                                                                     MD026742
168700200529      ** For Negative Cr. Int. Adj. with negative tax.                                      MD026742
168710200529      *                                                                                     MD026742
168720200529     C           CAIC      IFLT 0                                                           MD026742
168730200529     C           TSTXSR    ANDLT0                                                           MD026742
168740200529     C           TSSTDO    ANDLT0                                                           MD026742
168750200529     C           TSTTDO    ANDLT0                                                           MD026742
168760200529     C                     Z-ADDTSTTDO    WPSTA                                             MD026742
168770200529     C                     ENDIF                                                            MD026742
168780200529      *                                                                                     MD026742
168790200529     C                     MOVELBBICN     CNUM                                                CER054
168800200529     C                     MOVELTSTTAC    ACOD                                                CER054
168810200529     C                     Z-ADD1         ACSQ                                                CER054
168820200529     C                     Z-ADD0         ACNO                                                CER054
168830200529     C                     MOVELRUND      VALD                                                CER054
168840200529      *                                                                                       CER054
168850200529     C                     EXSR SUBNAR                                                        CER054
168860200529      *                                                                                       CER054
168870200529     C**********           MOVELPNAR      NARS                                       CER054 BUG24341
168880200529     C                     MOVELC3RDTX    NARS      P                                       BUG24341
168890200529     C                     MOVELNARS      PNAR                                              BUG24341
168900200529      *                                                                                       CER054
168910200529     C                     EXSR GEICPR                                                        CER054
168920200529      *                                                                                       CER054
168930200529      ** Update history if required                                                           CER054
168940200529      ** for the posting amount for the third tax.                                            CER054
168950200529      *                                                                                       CER054
168960200529     C           ATYP      IFEQ 'R'                                                           CER054
168970200529     C           VALD      ANDLENAPDA                                                         CER054
168980200529     C           *IN50     ANDEQ*OFF                                                          CER054
168990200529     C                     Z-ADD315       DBASE                                               CER054
169000200529     C                     MOVE 'N'       REACT                                               CER054
169010200529     C                     WRITEREHPOSPF                                                      CER054
169020200529     C                     EXSR POSPR                                                         CER054
169030200529     C                     ENDIF                                                              CER054
169040200529      *                                                                                       CER054
169050200529     C                     ENDIF                                                              CER054
169060200529      *                                                                                       CER054
169070200529     C                     ENDIF                                                              CER054
169080200529      *                                                                                       CER054
169090200529     C           TSTXSC    IFNE *ZEROS                                                        CER054
169100200529     C********** TSSTDB    ANDNE*ZEROS                                               CER054 BUG25343
169110200529     C********** TSTTDB    ANDNE*ZEROS                                               CER054 BUG25343
169120200529     C           TSSTDT    ANDNE*ZEROS                                                      BUG25343
169130200529     C           TSTTDT    ANDNE*ZEROS                                                      BUG25343
169140200529      *                                                                                       CER054
169150200529     C           TSTXCY    IFNE BCCY                                                          CER054
169160200529      *                                                                                       CER054
169170200529     C                     MOVELTSTXCY    CCY                                                 CER054
169180200529     C**********           Z-SUBTSTTDB    WPSTA                                      CER054 BUG25343
169190200529     C                     Z-SUBTSTTDT    WPSTA                                             BUG25343
169200200529     C                     MOVELBBICN     CNUM                                                CER054
169210200529     C                     MOVELTSTTAC    ACOD                                                CER054
169220200529     C                     Z-ADD1         ACSQ                                                CER054
169230200529     C                     Z-ADD0         ACNO                                                CER054
169240200529     C                     MOVELRUND      VALD                                                CER054
169250200529      *                                                                                       CER054
169260200529     C                     EXSR PLPR                                                          CER054
169270200529      *                                                                                       CER054
169280200529     C                     ENDIF                                                              CER054
169290200529      *                                                                                       CER054
169300200529     C                     ENDIF                                                              CER054
169310200529      *                                                                                       CER054
169320200529     C                     ENDIF                                                              CER054
169330200529      *                                                                                       235174
169340200529     C                     ENDSR                                                              235174
169350200529      *****************************************************************                       CDL081
169360200529      /EJECT                                                                                  CDL081
169370200529      *****************************************************************                       CDL081
169380200529      *                                                               *                       CDL081
169390200529      *  WCONV - Convert Amount from One Currency to Another          *                       CDL081
169400200529      *                                                               *                       CDL081
169410200529      *****************************************************************                       CDL081
169420200529      **##########################################################                            CDL081
169430200529      **##                                                      ##                            CDL081
169440200529      **## THIS ROUTINE IS A COPY OF ZSRSRC/ZCONVZ1             ##                            CDL081
169450200529      **## BUT THE HALF ADJUST ROUNDING HAS BEEN REMOVED.       ##                            CDL081
169460200529      **##                                                      ##                            CDL081
169470200529      **##  *** Changes done to ZCONVZ1 may need to be   ***    ##                            CDL081
169480200529      **##  *** applied in this sub-routine too.         ***    ##                            CDL081
169490200529      **##                                                      ##                            CDL081
169500200529      **##########################################################                            CDL081
169510200529      *                                                                                       CDL081
169520200529      **   INPUT  - ZAMTCI (15,0) Amount input                                                CDL081
169530200529      **            ZEXCH  (13,8) Exchange rate                                               CDL081
169540200529      **            ZMD    (1)    Multiply/divide indicator                                   CDL081
169550200529      **            ZCCYI  (3)    Currency input                                              CDL081
169560200529      **            ZCCYO  (3)    Currency to be converted to                                 CDL081
169570200529      **            POWER   -     Compile time array must be included                         CDL081
169580200529      **                          in the program source                                       CDL081
169590200529      **            ZCDPI  (1,0)  (FROM) Currency decimal places                              CDL081
169600200529      **            ZCDPO  (1,0)  (TO) Currency decimal places                                CDL081
169610200529      **                                                                                      CDL081
169620200529      **  OUTPUT -  ZAMTCO (15,0) Amount output                                               CDL081
169630200529      **                                                                                      CDL081
169640200529      *****************************************************************                       CDL081
169650200529     C           WCONV     BEGSR                                                              CDL081
169660200529      *                                                                                       CDL081
169670200529      ** Define input and output fields                                                       CDL081
169680200529      *                                                                                       CDL081
169690200529     C                     MOVE ZCCYI     ZCCYI   3                                           CDL081
169700200529     C                     MOVE ZCCYO     ZCCYO   3                                           CDL081
169710200529     C                     Z-ADDZCDPI     ZCDPI   10                                          CDL081
169720200529     C                     Z-ADDZCDPO     ZCDPO   10                                          CDL081
169730200529     C                     Z-ADDZAMTCI    ZAMTCI 150                                          CDL081
169740200529     C                     Z-ADD0         ZAMTCO 150                                          CDL081
169750200529     C                     Z-ADDZEXCH     ZEXCH  138                                          CDL081
169760200529     C                     MOVE ZMD       ZMD     1                                           CDL081
169770200529      *                                                                                       CDL081
169780200529      ** If exchange rate is 0 - output currency amount is zero                               CDL081
169790200529      *                                                                                       CDL081
169800200529     C           ZEXCH     IFEQ 0                                                             CDL081
169810200529     C                     Z-ADD0         ZAMTCO                                              CDL081
169820200529     C                     GOTO EWCONV                                                        CDL081
169830200529     C                     END                                                                CDL081
169840200529      *                                                                                       CDL081
169850200529      ** If decimal places are the same for both currencies                                   CDL081
169860200529      *                                                                                       CDL081
169870200529     C           ZCDPI     IFEQ ZCDPO                                                         CDL081
169880200529      *                                                                                       CDL081
169890200529      ** Calculate output currency amount by dividing exchange rate into                      CDL081
169900200529      ** or multiplying exchange rate by currency amount input depending                      CDL081
169910200529      ** on indicator                                                                         CDL081
169920200529      *                                                                                       CDL081
169930200529      ** When converting from base ccy back to EUR , inverted value of                        CDL081
169940200529      ** MDIN should be used. Check for unique field WUFLAG to validate                       CDL081
169950200529      ** it has been called from DL0410 .                                                     CDL081
169960200529      *                                                                                       CDL081
169970200529      ** Define new fields lengths                                                            CDL081
169980200529      *                                                                                       CDL081
169990200529     C                     MOVE WBINCY    WBINCY  1                                           CDL081
170000200529     C                     MOVE WUFLAG    WUFLAG  1                                           CDL081
170010200529     C           WUFLAG    IFEQ 'Y'                                                           CDL081
170020200529     C           WBINCY    ANDNE'Y'                                                           CDL081
170030200529      *                                                                                       CDL081
170040200529     C           ZMD       IFEQ 'D'                                                           CDL081
170050200529     C           ZAMTCI    MULT ZEXCH     ZAMTCO                                              CDL081
170060200529     C                     ELSE                                                               CDL081
170070200529     C           ZAMTCI    DIV  ZEXCH     ZAMTCO                                              CDL081
170080200529     C                     END                                                                CDL081
170090200529      *                                                                                       CDL081
170100200529     C                     ELSE                                                               CDL081
170110200529     C           ZMD       IFEQ 'D'                                                           CDL081
170120200529     C           ZAMTCI    DIV  ZEXCH     ZAMTCO                                              CDL081
170130200529     C                     ELSE                                                               CDL081
170140200529     C           ZAMTCI    MULT ZEXCH     ZAMTCO                                              CDL081
170150200529     C                     END                                                                CDL081
170160200529     C*                                                                                       CDL081
170170200529     C                     END                                                                CDL081
170180200529      *                                                                                       CDL081
170190200529     C                     ELSE                                                               CDL081
170200200529      *                                                                                       CDL081
170210200529      ** If decimal places differ -                                                           CDL081
170220200529      ** Calculate difference in decimal places to use as power index                         CDL081
170230200529      *                                                                                       CDL081
170240200529     C           ZCDPO     SUB  ZCDPI     ZPX     10                                          CDL081
170250200529     C                     ADD  4         ZPX                                                 CDL081
170260200529      *                                                                                       CDL081
170270200529      ** Calculate currency amount output by multiplying input amount by                      CDL081
170280200529      ** power array entry and then multiplying result by exchange rate                       CDL081
170290200529      ** depending on indicator                                                               CDL081
170300200529      *                                                                                       CDL081
170310200529     C           POWER,ZPX IFLT 1                                                             CDL081
170320200529     C           ZAMTCI    MULT POWER,ZPX Z15#3  153                                          CDL081
170330200529      *                                                                                       CDL081
170340200529      ** Do the same procedure if converting from base ccy back to EUR                        CDL081
170350200529      *                                                                                       CDL081
170360200529     C           WUFLAG    IFEQ 'Y'                                                           CDL081
170370200529     C           WBINCY    ANDNE'Y'                                                           CDL081
170380200529      *                                                                                       CDL081
170390200529     C           ZMD       IFEQ 'D'                                                           CDL081
170400200529     C           Z15#3     MULT ZEXCH     ZAMTCO                                              CDL081
170410200529     C                     ELSE                                                               CDL081
170420200529     C           Z15#3     DIV  ZEXCH     ZAMTCO                                              CDL081
170430200529     C                     END                                                                CDL081
170440200529      *                                                                                       CDL081
170450200529     C                     ELSE                                                               CDL081
170460200529      *                                                                                       CDL081
170470200529     C           ZMD       IFEQ 'D'                                                           CDL081
170480200529     C           Z15#3     DIV  ZEXCH     ZAMTCO                                              CDL081
170490200529     C                     ELSE                                                               CDL081
170500200529     C           Z15#3     MULT ZEXCH     ZAMTCO                                              CDL081
170510200529     C                     END                                                                CDL081
170520200529      *                                                                                       CDL081
170530200529     C                     END                                                                CDL081
170540200529      *                                                                                       CDL081
170550200529     C                     ELSE                                                               CDL081
170560200529     C           ZAMTCI    MULT POWER,ZPX ZAMTCI                                              CDL081
170570200529      *                                                                                       CDL081
170580200529     C           WUFLAG    IFEQ 'Y'                                                           CDL081
170590200529     C           WBINCY    ANDNE'Y'                                                           CDL081
170600200529      *                                                                                       CDL081
170610200529     C           ZMD       IFEQ 'D'                                                           CDL081
170620200529     C           ZAMTCI    MULT ZEXCH     ZAMTCO                                              CDL081
170630200529     C                     ELSE                                                               CDL081
170640200529     C           ZAMTCI    DIV  ZEXCH     ZAMTCO                                              CDL081
170650200529     C                     END                                                                CDL081
170660200529      *                                                                                       CDL081
170670200529     C                     ELSE                                                               CDL081
170680200529      *                                                                                       CDL081
170690200529     C           ZMD       IFEQ 'D'                                                           CDL081
170700200529     C           ZAMTCI    DIV  ZEXCH     ZAMTCO                                              CDL081
170710200529     C                     ELSE                                                               CDL081
170720200529     C           ZAMTCI    MULT ZEXCH     ZAMTCO                                              CDL081
170730200529     C                     END                                                                CDL081
170740200529      *                                                                                       CDL081
170750200529     C                     END                                                                CDL081
170760200529      *                                                                                       CDL081
170770200529     C                     END                                                                CDL081
170780200529      *                                                                                       CDL081
170790200529     C                     END                                                                CDL081
170800200529      *                                                                                       CDL081
170810200529     C           EWCONV    ENDSR                                                              CDL081
170820200529      *                                                                                       CER048
170830200529      *****************************************************************                       CER048
170840200529      /EJECT                                                                                  CER048
170850200529      *****************************************************************                       CER048
170860200529      *                                                               *                       CER048
170870200529      *  ZICD - Subroutine to find number of days to calculate        *                       CER048
170880200529      *         interest according to calculation basis               *                       CER048
170890200529      *                                                               *                       CER048
170900200529      *  Called by: SRRTAX                                            *                       CER048
170910200529      *  Calls: None                                                  *                       CER048
170920200529      *                                                               *                       CER048
170930200529      *****************************************************************                       CER048
170940200529     C           ZICD      BEGSR                                                              CER048
170950200529      *                                                                                       CER048
170960200529      ** To determine number of days interest to be calculated                                CER048
170970200529      *                                                                                       CER048
170980200529     C           ZIEND     SUB  ZIBEG     ZDAYN2  94                                          CER048
170990200529      *                                                                                       CER048
171000200529      ** Check for interest calculation basis                                                 CER048
171010200529      *                                                                                       CER048
171020200529     C           ZICALC    IFEQ 3                                                             CER048
171030200529     C           ZICALC    OREQ 0                                                          BUG23097A
171040200529     C           ZIEND     IFGT ZIBEG                                                         CER048
171050200529      *                                                                                       CER048
171060200529      ** Calculating date from day number (beginning date)                                    CER048
171070200529      *                                                                                       CER048
171080200529     C                     Z-ADDZIBEG     ZDAYNO                                              CER048
171090200529      *                                                                                       CER048
171100200529      ** *IN99 set off as ZDATE2Z2 does not reset. ZDATE2Z4 not used.                         CER048
171110200529      *                                                                                       CER048
171120200529     C                     SETOF                     99                                       CER048
171130200529     C                     EXSR ZDATE2                                                        CER048
171140200529      *                                                                                       CER048
171150200529      ** Verify if error                                                                      CER048
171160200529      *                                                                                       CER048
171170200529     C           *IN99     IFEQ '1'                                                           CER048
171180200529     C           *LOCK     IN   LDA                                                           CER048
171190200529     C                     Z-ADD316       DBASE                                               CER048
171200200529     C                     MOVE 'ZDATE2'  DBFILE                                              CER048
171210200529     C                     MOVE *BLANKS   DBKEY                                               CER048
171220200529     C                     OUT  LDA                                                           CER048
171230200529     C                     EXSR *PSSR                                                         CER048
171240200529     C                     ENDIF                                                              CER048
171250200529      *                                                                                       CER048
171260200529     C           *IN98     IFEQ '0'                                                           CER048
171270200529     C                     Z-ADDZDATE     SRES                                                CER048
171280200529     C                     ELSE                                                               CER048
171290200529     C                     Z-ADDZDATE     SRESX                                               CER048
171300200529     C                     Z-ADDZISDX     ZISD                                                CER048
171310200529     C                     Z-ADDZISMX     ZISM                                                CER048
171320200529     C                     Z-ADDZISYX     ZISY                                                CER048
171330200529     C                     ENDIF                                                              CER048
171340200529      *                                                                                       CER048
171350200529      ** Calculating date from day number (finishing date)                                    CER048
171360200529      *                                                                                       CER048
171370200529     C                     Z-ADDZIEND     ZDAYNO                                              CER048
171380200529      *                                                                                       CER048
171390200529      ** *IN99 set off as ZDATE2Z2 does not reset. ZDATE2Z4 not used                          CER048
171400200529      *                                                                                       CER048
171410200529     C                     SETOF                     99                                       CER048
171420200529     C                     EXSR ZDATE2                                                        CER048
171430200529      *                                                                                       CER048
171440200529      ** Verify if error                                                                      CER048
171450200529      *                                                                                       CER048
171460200529     C           *IN99     IFEQ '1'                                                           CER048
171470200529     C           *LOCK     IN   LDA                                                           CER048
171480200529     C                     Z-ADD317       DBASE                                               CER048
171490200529     C                     MOVE 'ZDATE2'  DBFILE                                              CER048
171500200529     C                     MOVE *BLANKS   DBKEY                                               CER048
171510200529     C                     OUT  LDA                                                           CER048
171520200529     C                     EXSR *PSSR                                                         CER048
171530200529     C                     ENDIF                                                              CER048
171540200529      *                                                                                       CER048
171550200529     C           *IN98     IFEQ '0'                                                           CER048
171560200529     C                     Z-ADDZDATE     FRES                                                CER048
171570200529     C                     ELSE                                                               CER048
171580200529     C                     Z-ADDZDATE     FRESX                                               CER048
171590200529     C                     Z-ADDZIFDX     ZIFD                                                CER048
171600200529     C                     Z-ADDZIFMX     ZIFM                                                CER048
171610200529     C                     Z-ADDZIFYX     ZIFY                                                CER048
171620200529     C                     ENDIF                                                              CER048
171630200529      *                                                                                       CER048
171640200529      ** In order for the finish year to be less than the start year                          CER048
171650200529      ** if ziend is greater than zibeg, then the date ziend must                             CER048
171660200529      ** be in a different century to zibeg. if so add 100 years to it                        CER048
171670200529      *                                                                                       CER048
171680200529     C           ZIFY      IFLT ZISY                                                          CER048
171690200529     C           ZIFY      ADD  100       ZIFY2                                               CER048
171700200529     C                     ELSE                                                               CER048
171710200529     C                     Z-ADDZIFY      ZIFY2                                               CER048
171720200529     C                     ENDIF                                                              CER048
171730200529      *                                                                                       CER048
171740200529     C                     Z-ADDZISY      ZISY2                                               CER048
171750200529      *                                                                                       CER048
171760200529      ** Determine whether start year is a leap year and if start                             CER048
171770200529      ** month is february then consider last day of february as date                         CER048
171780200529      ** 30nd. of the month                                                                   CER048
171790200529      *                                                                                       CER048
171800200529     C/COPY WNCPYSRC,RE3662C076                                                               CER048
171810200529      *                                                                                       CER048
171820200529     C           ZICALC    IFEQ 3                                                          BUG23097A
171830200529     C           ZICALC    OREQ 0                                                          BUG23097A
171840200529     C           CER016    ANDEQ'N'                                                        BUG23097A
171850200529     C           ZISM      IFEQ 2                                                             CER048
171860200529      *                                                                                       CER048
171870200529     C           ZISY2     ADD  1900      ZLYCHK                                              CER048
171880200529     C           ZLYCHK    DIV  4         ZLYCHK                                              CER048
171890200529     C                     MVR            ZLYREM                                              CER048
171900200529      *                                                                                       CER048
171910200529     C           ZLYREM    IFEQ 0                                                             CER048
171920200529      *                                                                                       CER048
171930200529     C           ZISD      IFEQ 29                                                            CER048
171940200529     C                     Z-ADD30        ZISD                                                CER048
171950200529     C                     ENDIF                                                              CER048
171960200529      *                                                                                       CER048
171970200529     C                     ELSE                                                               CER048
171980200529      *                                                                                       CER048
171990200529     C           ZISD      IFEQ 28                                                            CER048
172000200529     C                     Z-ADD30        ZISD                                                CER048
172010200529     C                     ENDIF                                                              CER048
172020200529      *                                                                                       CER048
172030200529     C                     ENDIF                                                              CER048
172040200529      *                                                                                       CER048
172050200529     C                     ENDIF                                                              CER048
172060200529      *                                                                                       CER048
172070200529     C                     ENDIF                                                           BUG23097A
172080200529      *                                                                                    BUG23097A
172090200529     C/COPY WNCPYSRC,RE3662C077                                                               CER048
172100200529      *                                                                                       CER048
172110200529     C           30        SUB  ZISD      ZID1                                                CER048
172120200529      *                                                                                       CER048
172130200529     C           ZID1      IFLT 0                                                             CER048
172140200529     C                     Z-ADD*ZEROS    ZID1                                                CER048
172150200529     C                     ENDIF                                                              CER048
172160200529      *                                                                                       CER048
172170200529     C           ZISM      IFEQ 12                                                            CER048
172180200529     C                     Z-ADD*ZEROS    ZISM                                                CER048
172190200529     C                     ADD  1         ZISY                                                CER048
172200200529     C                     ADD  1         ZISY2                                               CER048
172210200529     C                     ENDIF                                                              CER048
172220200529      *                                                                                       CER048
172230200529      ** Determine whether end year is a leap year and                                        CER048
172240200529      ** if end month is february                                                             CER048
172250200529      *                                                                                       CER048
172260200529     C/COPY WNCPYSRC,RE3662C078                                                               CER048
172270200529     C           ZICALC    IFEQ 3                                                          BUG23097A
172280200529     C           ZICALC    OREQ 0                                                          BUG23097A
172290200529     C           CER016    ANDEQ'N'                                                        BUG23097A
172300200529     C           ZIFM      IFEQ 2                                                             CER048
172310200529      *                                                                                       CER048
172320200529     C           ZIFY2     ADD  1900      ZLYCHK                                              CER048
172330200529     C           ZLYCHK    DIV  4         ZLYCHK                                              CER048
172340200529     C                     MVR            ZLYREM                                              CER048
172350200529      *                                                                                       CER048
172360200529     C           ZLYREM    IFEQ 0                                                             CER048
172370200529      *                                                                                       CER048
172380200529     C           ZIFD      IFEQ 29                                                            CER048
172390200529     C                     Z-ADD30        ZIFD                                                CER048
172400200529     C                     ENDIF                                                              CER048
172410200529      *                                                                                       CER048
172420200529     C                     ELSE                                                               CER048
172430200529      *                                                                                       CER048
172440200529     C           ZIFD      IFEQ 28                                                            CER048
172450200529     C                     Z-ADD30        ZIFD                                                CER048
172460200529     C                     ENDIF                                                              CER048
172470200529      *                                                                                       CER048
172480200529     C                     ENDIF                                                              CER048
172490200529      *                                                                                       CER048
172500200529     C                     ENDIF                                                              CER048
172510200529      *                                                                                    BUG23097A
172520200529     C                     ENDIF                                                           BUG23097A
172530200529     C/COPY WNCPYSRC,RE3662C079                                                               CER048
172540200529      *                                                                                       CER048
172550200529     C           ZIFD      IFEQ 31                                                            CER048
172560200529     C                     ADD  30        ZID1                                                CER048
172570200529     C                     ELSE                                                               CER048
172580200529     C                     ADD  ZIFD      ZID1                                                CER048
172590200529     C                     ENDIF                                                              CER048
172600200529      *                                                                                       CER048
172610200529     C                     SUB  1         ZIFM                                                CER048
172620200529      *                                                                                       CER048
172630200529     C           ZISY      IFEQ ZIFY                                                          CER048
172640200529     C           ZIFM      SUB  ZISM      ZINOM                                               CER048
172650200529     C                     ELSE                                                               CER048
172660200529     C           12        SUB  ZISM      ZIM1                                                CER048
172670200529     C                     Z-ADD1         ZISM                                                CER048
172680200529      *                                                                                       CER048
172690200529      ** Use enlarge fields that can handle 1999 onwards                                      CER048
172700200529      *                                                                                       CER048
172710200529     C                     ADD  1         ZISY2                                               CER048
172720200529     C           ZIFY2     SUB  ZISY2     ZIY1                                                CER048
172730200529     C           ZIY1      MULT 12        ZIM2                                                CER048
172740200529     C           ZIM2      ADD  ZIFM      ZIM2                                                CER048
172750200529     C           ZIM2      ADD  ZIM1      ZINOM                                               CER048
172760200529      *                                                                                       CER048
172770200529     C                     ENDIF                                                              CER048
172780200529      *                                                                                       CER048
172790200529     C           ZINOM     MULT 30        ZID2                                                CER048
172800200529     C           ZID2      ADD  ZID1      ZDAYN2                                              CER048
172810200529      *                                                                                       CER048
172820200529     C                     ENDIF                                                              CER048
172830200529      *                                                                                       CER048
172840200529     C                     ENDIF                                                              CER048
172850200529      *                                                                                       CER048
172860200529     C           ZICALC    IFEQ 4                                                             CER048
172870200529     C           ZICALC    OREQ 5                                                             CER048
172880200529      *                                                                                       CER048
172890200529      ** One day is subtracted from ZDAYN2 for each occurance of                              CER048
172900200529      ** 29 feb in the interest calculation period inclusive of                               CER048
172910200529      ** ZIBEG and ZIEND                                                                      CER048
172920200529      *                                                                                       CER048
172930200529      ** Find no of four year periods between dates                                           CER048
172940200529      *                                                                                       CER048
172950200529     C           ZDAYN2    DIV  1461      ZIMAN                                               CER048
172960200529     C                     MVR            ZIREM                                               CER048
172970200529      *                                                                                       CER048
172980200529      ** Find next 29 feb day no. on or after zibeg                                           CER048
172990200529      *                                                                                       CER048
173000200529     C           ZIBEG     SUB  60        ZIBW1                                               CER048
173010200529     C           ZIBW1     DIV  1461      ZIDW1                                               CER048
173020200529     C                     MVR            ZIDREM                                              CER048
173030200529      *                                                                                       CER048
173040200529     C           ZIDREM    IFEQ 0                                                             CER048
173050200529     C                     Z-ADDZIBEG     ZIDW2                                               CER048
173060200529     C                     ENDIF                                                              CER048
173070200529      *                                                                                       CER048
173080200529      ** Round up result                                                                      CER048
173090200529      *                                                                                       CER048
173100200529     C           ZIDW1     ADD  1         ZIDW2                                               CER048
173110200529      *                                                                                       CER048
173120200529      ** Calculate next 29 Feb.                                                               CER048
173130200529      *                                                                                       CER048
173140200529     C           ZIDW2     MULT 1461      ZIDW2                                               CER048
173150200529     C           ZIDW2     ADD  60        ZIDW2                                               CER048
173160200529      *                                                                                       CER048
173170200529      ** If this next 29 feb. dayno - ZIBEG is greater or equal to                            CER048
173180200529      ** ZIREM then  add 1 to ZIMAN                                                           CER048
173190200529      *                                                                                       CER048
173200200529     C           ZIDW2     SUB  ZIBEG     ZILPCP                                              CER048
173210200529      *                                                                                       CER048
173220200529     C           ZIREM     IFGE ZILPCP                                                        CER048
173230200529     C                     ADD  1         ZIMAN                                               CER048
173240200529     C                     ENDIF                                                              CER048
173250200529      *                                                                                       CER048
173260200529      ** Subtract ZIMAN from ZDAYN2 to give value of ZDAYN2 required                          CER048
173270200529      ** for this interest calculation                                                        CER048
173280200529      *                                                                                       CER048
173290200529     C           ZDAYN2    SUB  ZIMAN     ZDAYN2                                              CER048
173300200529      *                                                                                       CER048
173310200529     C                     ENDIF                                                              CER048
173320200529      *                                                                                       CER048
173330200529     C                     ENDSR                                                              CER048
173340200529      *                                                                                       CER048
173350200529      *****************************************************************                     AR831847
173360200529      /EJECT                                                                                AR831847
173370200529      *****************************************************************                     AR831847
173380200529      *                                                               *                     AR831847
173390200529      *  SREPOS - Generates postings for EU withholding tax           *                     AR831847
173400200529      *           accounting. Credit retail account only              *                     AR831847
173410200529      *                                                               *                     AR831847
173420200529      *****************************************************************                     AR831847
173430200529     C           SREPOS    BEGSR                                                            AR831847
173440200529      *                                                                                     AR831847
173450200529      ** Save Transaction Type.                                                             AR831847
173460200529      *                                                                                     AR831847
173470200529     C                     Z-ADDTRAT      WTRAT                                             AR831847
173480200529     C                     MOVE TXTXTT    TRAT                                              AR831847
173490200529     C                     MOVE 'Y'       WEUTT                                             AR831847
173500200529      *                                                                                     AR831847
173510200529     C                     MOVELNAR,14    INPNAR                                            AR831847
173520200529     C                     MOVELNR16,14   INP16                                             AR831847
173530200529     C                     MOVELDN07,14   INP07                                             AR831847
173540200529     C                     MOVELMGD,14    ##MGID                                            AR831847
173550200529     C           WTAOC     IFNE *ZERO                                                       AR831847
173560200529      *                                                                                     AR831847
173570200529      ** Output EU withholding tax as a CR to the internal tax a/c in                       AR831847
173580200529      ** retail a/c currency only if Tax Ccy = A/c Ccy.                                     AR831847
173590200529      *                                                                                     AR831847
173600200529     C           TSTXCY    IFEQ BCCY                                                        AR831847
173610200529      *                                                                                     AR831847
173620200529     C                     Z-SUBWTAOC     WPSTA                                             AR831847
173630200529     C                     MOVE BBICN     CNUM                                              AR831847
173640200529     C                     Z-ADDWEWTA     ACOD                                              AR831847
173650200529     C                     Z-ADD1         ACSQ                                              AR831847
173660200529     C                     Z-ADD*ZERO     ACNO                                              AR831847
173670200529     C                     Z-ADDRUND      VALD                                              AR831847
173680200529     C                     EXSR SUBNAR                                                      AR831847
173690200529     C                     MOVE NARS      PNAR                                              AR831847
173700200529      *                                                                                     AR831847
173710200529      ** EU tax postings are written by subroutine SREATA per Joint A/c                     AR831847
173720200529      ** member given a Joint A/c.                                                          AR831847
173730200529      *                                                                                     AR831847
173740200529     C           WJACC     IFNE 'Y'                                                         AR831847
173750200529     C                     EXSR GEICPR                                                      AR831847
173760200529      *                                                                                     AR831847
173770200529      ** Update history if required                                                         AR831847
173780200529      *                                                                                     AR831847
173790200529     C           ATYP      IFEQ 'R'                                                         AR831847
173800200529     C           VALD      ANDLENAPDA                                                       AR831847
173810200529     C           *IN50     ANDEQ*OFF                                                        AR831847
173820200529     C                     Z-ADD148       DBASE                                             AR831847
173830200529     C                     MOVE 'N'       REACT                                             AR831847
173840200529     C                     WRITEREHPOSPF                                                    AR831847
173850200529     C                     EXSR POSPR                                                       AR831847
173860200529     C                     ENDIF                                                            AR831847
173870200529     C                     ENDIF                                                            AR831847
173880200529      *                                                                                     AR831847
173890200529     C                     ENDIF                                                            AR831847
173900200529      *                                                                                     AR831847
173910200529     C                     ENDIF                                                            AR831847
173920200529      *                                                                                     AR831847
173930200529      ** Output additional postings if Tax Ccy <> A/c Ccy.                                  AR831847
173940200529      *                                                                                     AR831847
173950200529     C           TSTXCY    IFNE BCCY                                                        AR831847
173960200529     C                     EXSR SRFPOS                                                      AR831847
173970200529     C                     ENDIF                                                            AR831847
173980200529      *                                                                                     AR831847
173990200529      ** Reset Transaction Type.                                                            AR831847
174000200529      *                                                                                     AR831847
174010200529     C                     Z-ADDWTRAT     TRAT                                              AR831847
174020200529     C                     MOVE 'N'       WEUTT                                             AR831847
174030200529      *                                                                                     AR831847
174040200529     C           CER048    IFEQ 'Y'                                                         AR831847
174050200529      *                                                                                     AR831847
174060200529     C           WTAOC     IFNE *ZEROS                                                      AR831847
174070200529     C           WKSTXO    ANDNE*ZEROS                                                      AR831847
174080200529      *                                                                                     AR831847
174090200529     C           TSTXCY    IFEQ BCCY                                                        AR831847
174100200529      *                                                                                     AR831847
174110200529     C                     Z-SUBWKSTXO    WPSTA                                             AR831847
174120200529     C                     MOVELBBICN     CNUM                                              AR831847
174130200529     C                     MOVELTSSTAC    ACOD                                              AR831847
174140200529     C                     Z-ADD1         ACSQ                                              AR831847
174150200529     C                     Z-ADD0         ACNO                                              AR831847
174160200529     C                     MOVELRUND      VALD                                              AR831847
174170200529      *                                                                                     AR831847
174180200529     C                     EXSR SUBNAR                                                      AR831847
174190200529     C                     MOVELNARS      PNAR                                              AR831847
174200200529      *                                                                                     AR831847
174210200529     C           WJACC     IFNE 'Y'                                                         AR831847
174220200529     C                     EXSR GEICPR                                                      AR831847
174230200529      *                                                                                     AR831847
174240200529      ** Update history if required                                                         AR831847
174250200529      ** for the posting amount for the secondary tax.                                      AR831847
174260200529      *                                                                                     AR831847
174270200529     C           ATYP      IFEQ 'R'                                                         AR831847
174280200529     C           VALD      ANDLENAPDA                                                       AR831847
174290200529     C           *IN50     ANDEQ*OFF                                                        AR831847
174300200529     C                     Z-ADD152       DBASE                                             AR831847
174310200529     C                     MOVE 'N'       REACT                                             AR831847
174320200529     C                     WRITEREHPOSPF                                                    AR831847
174330200529     C                     EXSR POSPR                                                       AR831847
174340200529     C                     ENDIF                                                            AR831847
174350200529      *                                                                                     AR831847
174360200529     C                     ENDIF                                                            AR831847
174370200529      *                                                                                     AR831847
174380200529     C                     ENDIF                                                            AR831847
174390200529      *                                                                                     AR831847
174400200529     C                     ENDIF                                                            AR831847
174410200529      *                                                                                     AR831847
174420200529     C           CER054    IFEQ 'Y'                                                         AR831847
174430200529      *                                                                                     AR831847
174440200529     C           WTAOC     IFNE *ZEROS                                                      AR831847
174450200529     C           WKTTXO    ANDNE*ZEROS                                                      AR831847
174460200529      *                                                                                     AR831847
174470200529     C           TSTXCY    IFEQ BCCY                                                        AR831847
174480200529      *                                                                                     AR831847
174490200529     C                     Z-SUBWKTTXO    WPSTA                                             AR831847
174500200529     C                     MOVELBBICN     CNUM                                              AR831847
174510200529     C                     MOVELTSTTAC    ACOD                                              AR831847
174520200529     C                     Z-ADD1         ACSQ                                              AR831847
174530200529     C                     Z-ADD0         ACNO                                              AR831847
174540200529     C                     MOVELRUND      PSTD                                              AR831847
174550200529      *                                                                                     AR831847
174560200529     C                     EXSR SUBNAR                                                      AR831847
174570200529     C                     MOVELNARS      PNAR                                              AR831847
174580200529      *                                                                                     AR831847
174590200529     C           WJACC     IFNE 'Y'                                                         AR831847
174600200529     C                     EXSR GEICPR                                                      AR831847
174610200529      *                                                                                     AR831847
174620200529      ** Update history if required                                                         AR831847
174630200529      ** for the posting amount for the third tax.                                          AR831847
174640200529      *                                                                                     AR831847
174650200529     C           ATYP      IFEQ 'R'                                                         AR831847
174660200529     C           VALD      ANDLENAPDA                                                       AR831847
174670200529     C           *IN50     ANDEQ*OFF                                                        AR831847
174680200529     C                     Z-ADD314       DBASE                                             AR831847
174690200529     C                     MOVE 'N'       REACT                                             AR831847
174700200529     C                     WRITEREHPOSPF                                                    AR831847
174710200529     C                     EXSR POSPR                                                       AR831847
174720200529     C                     ENDIF                                                            AR831847
174730200529      *                                                                                     AR831847
174740200529     C                     ENDIF                                                            AR831847
174750200529      *                                                                                     AR831847
174760200529     C                     ENDIF                                                            AR831847
174770200529      *                                                                                     AR831847
174780200529     C                     ENDIF                                                            AR831847
174790200529     C                     ENDIF                                                            AR831847
174800200529     C                     ENDIF                                                            AR831847
174810200529      *                                                                                     AR831847
174820200529     C                     ENDSR                                                            AR831847
174830200529     C*****************************************************************                     CRE083BE
174840200529     C**                                                              *                     CRE083BE
174850200529     C**  UPDPTR subroutine updates REFIXCPD with Start Key.          *                     CRE083BE
174860200529     C**                                                              *                     CRE083BE
174870200529     C**  Called By:  Mainline code.                                  *                     CRE083BE
174880200529     C**  Calls:      -                                               *                     CRE083BE
174890200529     C**                                                              *                     CRE083BE
174900200529     C**  Indicators: -                                               *                     CRE083BE
174910200529     C**                                                              *                     CRE083BE
174920200529     C**  Arrays:     -                                               *                     CRE083BE
174930200529     C**                                                              *                     CRE083BE
174940200529     C**  Fields:                                                     *                     CRE083BE
174950200529     C**                                                              *                     CRE083BE
174960200529      *****************************************************************                     CRE083BE
174970200529     C           UPDPTR    BEGSR                                                            CRE083BE
174980200529      *                                                                                     CRE083BE
174990200529     C                     MOVE 'A'       IXCKEY                                            CRE083BE
175000200529     C                     MOVE NXTKEY    LSTKEY                                            CRE083BE
175010200529     C           IXCKEY    CHAINREINTCPD             38                                     CRE083BE
175020200529     C           *IN38     IFEQ *OFF                                                        CRE083BE
175030200529     C                     MOVE LSTKEY    NXTKEY                                            CRE083BE
175040200529     C                     MOVE LLGID     NLGID                                             CRE083BE
175050200529     C                     MOVE LBRCA     NBRCA                                             CRE083BE
175060200529     C                     MOVE LCNUM     NCNUM                                             CRE083BE
175070200529     C                     MOVE LCCY      NCCY                                              CRE083BE
175080200529     C                     MOVE LACOD     NACOD                                             CRE083BE
175090200529     C                     MOVE LACSQ     NACSQ                                             CRE083BE
175100200529     C                     MOVE 'C'       PROT                                              CRE083BE
175110200529     C                     UPDATREHISBP1                                                    CRE083BE
175120200529     C                     END                                                              CRE083BE
175130200529      *                                                                                     CRE083BE
175140200529     C                     ENDSR                                                            CRE083BE
175150200529      *****************************************************************                     CRE083BK
175160200529      *                                                               *                     CRE083BK
175170200529      *  CHKACD - Check Account Code details in array                 *                     CRE083BK
175180200529      *                                                               *                     CRE083BK
175190200529      *****************************************************************                     CRE083BK
175200200529     C           CHKACD    BEGSR                                                            CRE083BK
175210200529      *                                                                                     CRE083BK
175220200529     C                     MOVEL*BLANK    ACFIC                                             CRE083BK
175230200529     C                     SETOF                         42                                 CRE083BK
175240200529     C           KEYACD    IFNE 0                                                           CRE083BK
175250200529     C                     Z-ADDPIDX      E                                                 CRE083BK
175260200529     C           E         IFEQ 0                                                           CRE083BK
175270200529     C                     Z-ADDTIDX      E                                                 CRE083BK
175280200529     C                     ENDIF                                                            CRE083BK
175290200529      *                                                                                     CRE083BK
175300200529     C           KEYACD    IFEQ CDAC,E                                                      CRE083BK
175310200529     C                     SETON                         42                                 CRE083BK
175320200529     C                     ELSE                                                             CRE083BK
175330200529      *                                                                                     CRE083BK
175340200529     C           TIDX      IFEQ 0                                                           CRE083BK
175350200529     C                     Z-ADD1         E                                                 CRE083BK
175360200529     C                     ELSE                                                             CRE083BK
175370200529     C                     Z-ADDTIDX      E                                                 CRE083BK
175380200529     C                     ENDIF                                                            CRE083BK
175390200529      *                                                                                     CRE083BK
175400200529     C           KEYACD    LOKUPCDAC,E                   42                                 CRE083BK
175410200529     C                     ENDIF                                                            CRE083BK
175420200529      *                                                                                     CRE083BK
175430200529     C           *IN42     IFEQ *ON                                                         CRE083BK
175440200529     C                     MOVE RCSQ      LRUA,E                                            CRE083BK
175450200529     C                     Z-ADDE         PIDX                                              CRE083BK
175460200529     C                     MOVEL'Y'       ACFIC                                             CRE083BK
175470200529     C                     ENDIF                                                            CRE083BK
175480200529     C                     ENDIF                                                            CRE083BK
175490200529      *                                                                                     CRE083BK
175500200529     C                     ENDSR                                                            CRE083BK
175510200529      *****************************************************************                     CRE083BK
175520200529      *                                                               *                     CRE083BK
175530200529      *  ACDCCH - Account Code Cache Processing                       *                     CRE083BK
175540200529      *                                                               *                     CRE083BK
175550200529      *****************************************************************                     CRE083BK
175560200529     C           ACDCCH    BEGSR                                                            CRE083BK
175570200529     C                     EXSR CHKACD                                                      CRE083BK
175580200529     C           ACFIC     IFEQ 'Y'                                                         CRE083BK
175590200529     C           E         OCUR SDACOD                                                      CRE083BK
175600200529     C**********           SETON                     70                           CRE083BK AR1096650
175610200529     C                     ELSE                                                             CRE083BK
175620200529     C           TIDX      IFNE 0                                                           CRE083BK
175630200529     C                     Z-ADDTIDX      E                                                 CRE083BK
175640200529     C                     ELSE                                                             CRE083BK
175650200529     C                     Z-ADD1         E                                                 CRE083BK
175660200529     C                     MOVEALRUA      LRUS                                              CRE083BK
175670200529     C                     SORTALRUS                                                        CRE083BK
175680200529     C                     Z-ADDLRUS,1    LEASTE                                            CRE083BK
175690200529     C           LEASTE    LOKUPLRUA,E                   42                                 CRE083BK
175700200529     C                     ENDIF                                                            CRE083BK
175710200529     C           E         OCUR SDACOD                                                      CRE083BK
175720200529     C                     MOVE KEYACD    ACDALP                                            CRE083BK
175730200529     C                     CALL 'AOACODR0'                                                  CRE083BK
175740200529     C                     PARM '*MSG   ' @RTCD                                             CRE083BK
175750200529     C                     PARM '*KEY   ' @OPTN                                             CRE083BK
175760200529     C                     PARM           ACDALP                                            CRE083BK
175770200529     C           SDACOD    PARM SDACOD    DSSDY                                             CRE083BK
175780200529      *                                                                                     CRE083BK
175790200529     C           @RTCD     IFNE *BLANK                                                      CRE083BK
175800200529     C           *LOCK     IN   LDA                                                         CRE083BK
175810200529     C                     Z-ADDWDBASE    DBASE                                             CRE083BK
175820200529     C                     MOVEL'SDACODPD'DBFILE                                            CRE083BK
175830200529     C                     MOVELACDALP    DBKEY                                             CRE083BK
175840200529     C                     OUT  LDA                                                         CRE083BK
175850200529     C                     SETON                     U7U8LR                                 CRE083BK
175860200529     C                     EXSR *PSSR                                                       CRE083BK
175870200529     C                     ELSE                                                             CRE083BK
175880200529     C                     EXSR ADDACD                                                      CRE083BK
175890200529     C                     END                                                              CRE083BK
175900200529     C                     ENDIF                                                            CRE083BK
175910200529      *                                                                                     CRE083BK
175920200529     C                     ENDSR                                                            CRE083BK
175930200529      *****************************************************************                     CRE083BK
175940200529      *                                                               *                     CRE083BK
175950200529      *  ADDACD - Add account code details to array                   *                     CRE083BK
175960200529      *                                                               *                     CRE083BK
175970200529      *****************************************************************                     CRE083BK
175980200529     C           ADDACD    BEGSR                                                            CRE083BK
175990200529      *                                                                                     CRE083BK
176000200529     C           TIDX      IFNE 0                                                           CRE083BK
176010200529     C                     SUB  1         TIDX                                              CRE083BK
176020200529     C                     ENDIF                                                            CRE083BK
176030200529      *                                                                                     CRE083BK
176040200529     C**********           MOVELACOD      CDAC,E                                  CRE083BK AR1089863
176050200529     C                     MOVELKEYACD    CDAC,E                                           AR1089863
176060200529     C                     MOVE RCSQ      LRUA,E                                            CRE083BK
176070200529      *                                                                                     CRE083BK
176080200529     C                     Z-ADDE         PIDX                                              CRE083BK
176090200529      *                                                                                     CRE083BK
176100200529     C                     ENDSR                                                            CRE083BK
176110200529      *****************************************************************                     AR676495
176120200529      /EJECT                                                                                AR676495
176130200529      *****************************************************************                     AR676495
176140200529      *                                                               *                     AR676495
176150200529      *  SRINTA - SUBROUTINE FOR INTEREST ADJUSTMENT POSTINGS         *                     AR676495
176160200529      *           CREDIT RETAIL ACCOUNT ONLY                          *                     AR676495
176170200529      *                                                               *                     AR676495
176180200529      *  CALLED BY: CREPR                                             *                     AR676495
176190200529      *                                                               *                     AR676495
176200200529      *  CALLS: *PSSR                                                 *                     AR676495
176210200529      *                                                               *                     AR676495
176220200529      *****************************************************************                     AR676495
176230200529     C           SRINTA    BEGSR                                                            AR676495
176240200529      *                                                                                     AR676495
176250200529      ** RESET THE FIELD/INDICATOR.                                                         AR676495
176260200529      *                                                                                     AR676495
176270200529     C                     MOVEL'N'       WARTH   1                                         AR676495
176280200529      *                                                                                     AR676495
176290200529      ** Save Transaction Type.                                                             AR676495
176300200529      *                                                                                     AR676495
176310200529     C                     Z-ADDTRAT      WTRAT                                             AR676495
176320200529     C                     MOVE TXTXTT    TRAT                                              AR676495
176330200529     C                     MOVE 'Y'       WEUTT   1                                         AR676495
176340200529      *                                                                                     AR676495
176350200529      ** SET UP THE NARRATIVE.                                                              AR676495
176360200529      *                                                                                     AR676495
176370200529     C                     MOVELNAR,14    INPNAR                                            AR676495
176380200529     C                     MOVELNR16,14   INP16                                             AR676495
176390200529     C                     MOVELDN07,14   INP07                                             AR676495
176400200529     C                     MOVELMGD,14    ##MGID                                            AR676495
176410200529      *                                                                                     AR676495
176420200529     C                     MOVE BBRCA     BRCA                                              AR676495
176430200529     C                     MOVE BCNUM     CNUM                                              AR676495
176440200529     C                     MOVE BCCY      CCY                                               AR676495
176450200529     C                     Z-ADDBACOD     ACOD                                              AR676495
176460200529     C                     Z-ADDBACSQ     ACSQ                                              AR676495
176470200529     C                     MOVE WACNO     ACNO                                              AR676495
176480200529      *                                                                                     AR676495
176490200529      ** Check if the customer is actually a Joint A/c.                                     AR676495
176500200529      *                                                                                     AR676495
176510200529     C                     MOVE BCNUM     KJANO   6                                         AR676495
176520200529     C           KJANO     CHAINSDJACCL1             84                                     AR676495
176530200529      *                                                                                     AR676495
176540200529     C                     MOVE 'N'       WJACC   1                                         AR676495
176550200529     C           *IN84     IFEQ *OFF                                                        AR676495
176560200529     C                     MOVE 'Y'       WJACC                                             AR676495
176570200529     C                     ENDIF                                                            AR676495
176580200529      *                                                                                     AR676495
176590200529      ** CHECK FOR THE SwITHABLE FEATURE                                                    AR676495
176600200529      *                                                                                     AR676495
176610200529     C           CER048    IFEQ 'Y'                                                         AR676495
176620200529      *                                                                                     AR676495
176630200529      ** ACCESS BRANCH DETAILS                                                              AR676495
176640200529      *                                                                                     AR676495
176650200529     C                     Z-ADDCUBRCA    C                                                 MD032185
176660200529     C           BBRCA     LOKUPABRC,C                   16                                 MD032185
176670200529      *                                                                                     MD032185
176680200529     C           *IN16     IFEQ '1'                                                         MD032185
176690200529     C           C         OCUR SDBRCH                                                      MD032185
176700200529     C                     ELSE                                                             MD032185
176710200529     C                     CALL 'AOBRCHR1'                                                  AR676495
176720200529     C                     PARM '*MSG   ' PRTCD                                             AR676495
176730200529     C                     PARM '*KEY   ' POPTN                                             AR676495
176740200529     C                     PARM BBRCA     PBRCA   3                                         AR676495
176750200529     C           SDBRCH    PARM SDBRCH    DSSDY                                             AR676495
176760200529      *                                                                                     AR676495
176770200529     C           PRTCD     IFNE *BLANKS                                                     AR676495
176780200529      *                                                                                     AR676495
176790200529     C           *LOCK     IN   LDA                                                         AR676495
176800200529     C                     MOVEL'RE3664'  DBPGM                                             AR676495
176810200529     C                     MOVEL'SDBRCHPD'DBFILE                                            AR676495
176820200529     C                     MOVELPBRCA     DBKEY                                             AR676495
176830200529     C                     Z-ADD330       DBASE                                             AR676495
176840200529     C                     OUT  LDA                                                         AR676495
176850200529     C                     EXSR *PSSR                                                       AR676495
176860200529      *                                                                                     AR676495
176870200529     C                     ENDIF                                                            AR676495
176880200529     C                     ENDIF                                                            MD032185
176890200529      *                                                                                     AR676495
176900200529      ** ACCESS LOCATION DETAILS                                                            AR676495
176910200529      *                                                                                     AR676495
176920200529     C                     CALL 'AOLOCNR0'                                                  AR676495
176930200529     C                     PARM *BLANKS   PRTCD                                             AR676495
176940200529     C                     PARM '*KEY   ' POPTN                                             AR676495
176950200529     C                     PARM A8LCCD    PLOCN   3                                         AR676495
176960200529     C           SDLOCN    PARM SDLOCN    DSFDY                                             AR676495
176970200529      *                                                                                     AR676495
176980200529     C           PRTCD     IFNE *BLANKS                                                     AR676495
176990200529      *                                                                                     AR676495
177000200529     C           *LOCK     IN   LDA                                                         AR676495
177010200529     C                     MOVEL'RE3664'  DBPGM                                             AR676495
177020200529     C                     MOVEL'SDLOCNPD'DBFILE                                            AR676495
177030200529     C                     MOVELPLOCN     DBKEY                                             AR676495
177040200529     C                     Z-ADD331       DBASE                                             AR676495
177050200529     C                     OUT  LDA                                                         AR676495
177060200529     C                     EXSR *PSSR                                                       AR676495
177070200529     C                     ENDIF                                                            AR676495
177080200529      *                                                                                     AR676495
177090200529      ** Access customer details                                                            AR676495
177100200529      *                                                                                     AR676495
177110200529     C                     MOVELBCNUM     PCNUM                                             AR676495
177120200529      *                                                                                     AR676495
177130200529     C                     CALL 'AOCUSTR0'                                                  AR676495
177140200529     C                     PARM *BLANKS   PRTCD   7                                         AR676495
177150200529     C                     PARM '*KEY   ' POPTN   7                                         AR676495
177160200529     C                     PARM           PCNUM  10                                         AR676495
177170200529     C                     PARM *BLANKS   PCNST   7                                         AR676495
177180200529     C           SDCUST    PARM SDCUST    DSSDY                                             AR676495
177190200529      *                                                                                     AR676495
177200200529     C           PRTCD     IFNE *BLANKS                                                     AR676495
177210200529     C           *LOCK     IN   LDA                                                         AR676495
177220200529      *                                                                                     AR676495
177230200529     C                     MOVEL'SDCUSTPD'DBFILE                                            AR676495
177240200529     C                     MOVELPCNUM     DBKEY                                             AR676495
177250200529     C                     Z-ADD332       DBASE                                             AR676495
177260200529     C                     OUT  LDA                                                         AR676495
177270200529     C                     EXSR *PSSR                                                       AR676495
177280200529      *                                                                                     AR676495
177290200529     C                     ENDIF                                                            AR676495
177300200529      *                                                                                     AR676495
177310200529      ** ACCESS COUNTRY OF TAX DETAILS                                                      AR676495
177320200529      *                                                                                     AR676495
177330200529     C                     CALL 'AOCTTXR0'                                                  AR676495
177340200529     C                     PARM *BLANKS   PRTCD                                             AR676495
177350200529     C                     PARM '*KEY   ' POPTN                                             AR676495
177360200529     C                     PARM DVCNCD    PCTRT   2                                         AR676495
177370200529     C                     PARM BBCOLC    PCTRR   2                                         AR676495
177380200529     C           SDCTTX    PARM SDCTTX    DSFDY                                             AR676495
177390200529      *                                                                                     AR676495
177400200529     C           PRTCD     IFEQ '*NRF   '                                                   AR676495
177410200529      *                                                                                     AR676495
177420200529     C                     CALL 'AOCTTXR0'                                                  AR676495
177430200529     C                     PARM *BLANKS   PRTCD                                             AR676495
177440200529     C                     PARM '*KEY   ' POPTN                                             AR676495
177450200529     C                     PARM DVCNCD    PCTRT   2                                         AR676495
177460200529     C                     PARM *BLANKS   PCTRR   2                                         AR676495
177470200529     C           SDCTTX    PARM SDCTTX    DSFDY                                             AR676495
177480200529      *                                                                                     AR676495
177490200529     C           PRTCD     IFNE *BLANKS                                                     AR676495
177500200529      *                                                                                     AR676495
177510200529     C           *LOCK     IN   LDA                                                         AR676495
177520200529     C                     MOVEL'SDCTTXPD'DBFILE                                            AR676495
177530200529     C                     MOVEL@BRCA     DBKEY                                             AR676495
177540200529     C                     Z-ADD333       DBASE                                             AR676495
177550200529     C                     OUT  LDA                                                         AR676495
177560200529     C                     EXSR *PSSR                                                       AR676495
177570200529      *                                                                                     AR676495
177580200529     C                     ENDIF                                                            AR676495
177590200529      *                                                                                     AR676495
177600200529     C                     ENDIF                                                            AR676495
177610200529      *                                                                                     AR676495
177620200529      ** CHECK IF THE tAx IS DONE USING THRESHOLD                                           AR676495
177630200529      *                                                                                     AR676495
177640200529     C           EWTHMD    IFEQ 'Y'                                                         AR676495
177650200529     C           CER054    ANDNE'Y'                                                        AR676495A
177660200529      *                                                                                     AR676495
177670200529      ** WORK CREDIT INTEREST NUMBER                                                        AR676495
177680200529      *                                                                                     AR676495
177690200529     C                     Z-ADD*ZEROS    WCRIN  150                                        AR676495
177700200529      *                                                                                     AR676495
177710200529      ** WORK CREDIT INTEREST                                                               AR676495
177720200529      *                                                                                     AR676495
177730200529     C                     MOVEL'N'       WCRIT   1                                         AR676495
177740200529      *                                                                                     AR676495
177750200529      ** WORK DATE                                                                          AR676495
177760200529      *                                                                                     AR676495
177770200529     C                     MOVELSPCID     WDATE                                             AR676495
177780200529      *                                                                                     AR676495
177790200529      ** WORK CAPITALISATION DATE                                                           AR676495
177800200529      *                                                                                     AR676495
177810200529     C                     MOVELSHISD     WCDAT                                             AR676495
177820200529      *                                                                                     AR676495
177830200529      ** WORK BALANCE                                                                       AR676495
177840200529      *                                                                                     AR676495
177850200529     C                     MOVELSHISB     WHISB                                             AR676495
177860200529      *                                                                                     AR676495
177870200529      ** ACCESS ACCOUNT CURRENCY DETAILS                                                    AR676495
177880200529      *                                                                                     AR676495
177890200529     C                     CALL 'AOCURRR0'                                                  AR676495
177900200529     C                     PARM *BLANKS   PRTCD                                             AR676495
177910200529     C                     PARM '*KEY  '  POPTN                                             AR676495
177920200529     C                     PARM BCCY      PCYCD   3                                         AR676495
177930200529     C           SDCURR    PARM SDCURR    DSSDY                                             AR676495
177940200529      *                                                                                     AR676495
177950200529     C           @RTCD     IFNE *BLANKS                                                     AR676495
177960200529     C           *LOCK     IN   LDA                                                         AR676495
177970200529     C                     MOVEL'SDCURRPD'DBFILE                                            AR676495
177980200529     C                     MOVELPCYCD     DBKEY                                             AR676495
177990200529     C                     Z-ADD334       DBASE                                             AR676495
178000200529     C                     OUT  LDA                                                         AR676495
178010200529     C                     EXSR *PSSR                                                       AR676495
178020200529     C                     ENDIF                                                            AR676495
178030200529      *                                                                                     AR676495
178040200529     C           4         ADD  CDP       FD      10                                        AR676495
178050200529      *                                                                                     AR676495
178060200529      ** READ PREVIOUS HISTORY RECORD TO ENSURE INCLUDE PREVIOus end                        AR676495
178070200529      ** OF MONTH BALANCE RECORD                                                            AR676495
178080200529      *                                                                                     AR676495
178090200529     C                     MOVE BBRCA     BRCA                                              AR676495
178100200529     C                     MOVE BCNUM     CNUM                                              AR676495
178110200529     C                     MOVE BCCY      CCY                                               AR676495
178120200529     C                     Z-ADDBACOD     ACOD                                              AR676495
178130200529     C                     Z-ADDBACSQ     ACSQ                                              AR676495
178140200529     C                     Z-ADDWDATE     HISD                                              AR676495
178150200529      *                                                                                     AR676495
178160200529      ** READ PREVIOUS HISTORY RECORD                                                       AR676495
178170200529      *                                                                                     AR676495
178180200529     C           R3KEY     SETLLREHISL                                                      AR676495
178190200529     C           R3KEYA    READEREHISL                   40                                 AR676495
178200200529      *                                                                                     AR676495
178210200529     C           *IN40     DOUEQ*ON                                                         AR676495
178220200529      *                                                                                     AR676495
178230200529     C           *IN40     IFEQ *OFF                                                        AR676495
178240200529      *                                                                                     AR676495
178250200529     C           HISD      IFGT WCDAT                                                       AR676495
178260200529     C                     LEAVE                                                            AR676495
178270200529     C                     ENDIF                                                            AR676495
178280200529      *                                                                                     AR676495
178290200529     C                     MOVELHISD      ZIEND                                             AR676495
178300200529      *                                                                                     AR676495
178310200529     C           CRCI      IFEQ 'Y'                                                         AR676495
178320200529     C           HISD      ANDGTPCID                                                        AR676495
178330200529     C           HISD      ANDLTWCDAT                                                       AR676495
178340200529     C                     MOVEL'Y'       WCRIT                                             AR676495
178350200529     C                     ENDIF                                                            AR676495
178360200529      *                                                                                     AR676495
178370200529     C                     ELSE                                                             AR676495
178380200529      *                                                                                     AR676495
178390200529     C                     MOVELWCDAT     ZIEND                                             AR676495
178400200529      *                                                                                     AR676495
178410200529     C                     ENDIF                                                            AR676495
178420200529      *                                                                                     AR676495
178430200529     C                     MOVELWDATE     ZIBEG                                             AR676495
178440200529      *                                                                                     AR676495
178450200529     C           ZIBEG     IFLT ZIEND                                                       AR676495
178460200529      *                                                                                     AR676495
178470200529     C                     Z-ADDCRCB      ZICALC                                            AR676495
178480200529      *                                                                                     AR676495
178490200529     C                     EXSR ZICD                                                        AR676495
178500200529      *                                                                                     AR676495
178510200529     C           WHISB     MULT ZDAYN2    WINUM  150                                        AR676495
178520200529     C           WINUM     DIV  100       WINUM                                             AR676495
178530200529     C           WINUM     DIV  POWER,FD  WINUM                                             AR676495
178540200529      *                                                                                     AR676495
178550200529      ** IF WORK BALANCE IS LESS THAN ZERO                                                  AR676495
178560200529      *                                                                                     AR676495
178570200529     C           WHISB     IFLT *ZERO                                                       AR676495
178580200529     C                     ADD  WINUM     WCRIN                                             AR676495
178590200529     C                     ENDIF                                                            AR676495
178600200529      *                                                                                     AR676495
178610200529     C                     ENDIF                                                            AR676495
178620200529      *                                                                                     AR676495
178630200529     C                     Z-ADDHISB      WHISB                                             AR676495
178640200529     C                     Z-ADDHISD      WDATE                                             AR676495
178650200529      *                                                                                     AR676495
178660200529     C           HISD      IFEQ WCDAT                                                       AR676495
178670200529     C           RECI      ANDEQ'S'                                                         AR676495
178680200529     C                     LEAVE                                                            AR676495
178690200529     C                     ENDIF                                                            AR676495
178700200529      *                                                                                     AR676495
178710200529     C           R3KEYA    READEREHISL                   40                                 AR676495
178720200529      *                                                                                     AR676495
178730200529     C                     ENDDO                                                            AR676495
178740200529      *                                                                                     AR676495
178750200529      ** CHECK THRESHOlD                                                                    AR676495
178760200529      *                                                                                     AR676495
178770200529     C           CRCB      IFEQ 1                                                           AR676495
178780200529     C           CRCB      OREQ 4                                                           AR676495
178790200529      *                                                                                     AR676495
178800200529     C                     Z-ADD365       WNDYR   30                                        AR676495
178810200529      *                                                                                     AR676495
178820200529     C                     ELSE                                                             AR676495
178830200529      *                                                                                     AR676495
178840200529     C           CRCB      IFEQ 6                                                           AR676495
178850200529     C                     Z-ADD365       WNDYR                                             AR676495
178860200529     C                     ELSE                                                             AR676495
178870200529     C                     Z-ADD360       WNDYR                                             AR676495
178880200529      *                                                                                     AR676495
178890200529     C                     ENDIF                                                            AR676495
178900200529      *                                                                                     AR676495
178910200529     C                     ENDIF                                                            AR676495
178920200529      *                                                                                     AR676495
178930200529      ** IF WORK CREDIT INTEREST NUMBER IS NOT ZERO                                         AR676495
178940200529      *                                                                                     AR676495
178950200529     C           WCRIN     IFNE *ZEROS                                                      AR676495
178960200529      *                                                                                     AR676495
178970200529     C           RCAIC     MULT WNDYR     WCTOT  180                                        AR676495
178980200529     C           WCTOT     DIV  WCRIN     AVRT   235                                        AR676495
178990200529      *                                                                                     AR676495
179000200529      ** ONLY CALCULATE AVERAGE RATE TO 2 DECIMALS                                          AR676495
179010200529      *                                                                                     AR676495
179020200529     C           AVRT      DIV  POWER,FD  WAVRT  232H                                       AR676495
179030200529     C                     Z-ADDWAVRT     AVRT                                              AR676495
179040200529      *                                                                                     AR676495
179050200529     C           AVRT      IFLT *ZEROS                                                      AR676495
179060200529     C                     MULT -1        AVRT                                              AR676495
179070200529     C                     ENDIF                                                            AR676495
179080200529      *                                                                                     AR676495
179090200529     C           WCRIT     IFNE 'Y'                                                         AR676495
179100200529     C           SCICT     ANDEQ*ZEROS                                                      AR676495
179110200529     C                     Z-ADDAVRT      SCRIR                                             AR676495
179120200529     C                     ENDIF                                                            AR676495
179130200529      *                                                                                     AR676495
179140200529     C                     ELSE                                                             AR676495
179150200529     C                     Z-ADD*ZEROS    AVRT                                              AR676495
179160200529     C                     ENDIF                                                            AR676495
179170200529      *                                                                                     AR676495
179180200529     C           SHISD     IFGE EWRAED                                                      AR676495
179190200529     C                     Z-ADDEWRARL    WLEVEL                                            AR676495
179200200529     C                     ELSE                                                             AR676495
179210200529     C                     Z-ADDEWPARL    WLEVEL                                            AR676495
179220200529     C                     ENDIF                                                            AR676495
179230200529      *                                                                                     AR676495
179240200529     C           AVRT      IFLE WLEVEL                                                      AR676495
179250200529     C                     MOVEL'Y'       WARTH                                             AR676495
179260200529     C                     ENDIF                                                            AR676495
179270200529      *                                                                                     AR676495
179280200529     C                     ENDIF                                                            AR676495
179290200529     C                     ENDIF                                                            AR676495
179300200529      *                                                                                     AR676495
179310200529      ** CHECK FOR AVErAgE RATE THRESHOLD                                                   AR676495
179320200529      *                                                                                     AR676495
179330200529     C           WARTH     IFEQ 'Y'                                                         AR676495
179340200529      *                                                                                     AR676495
179350200529     C                     MOVE 'G'       KMODI                                             AR676495
179360200529     C                     MOVE BCNUM     KCUST                                             AR676495
179370200529     C                     MOVE BCCY      KSCCY                                             AR676495
179380200529     C                     Z-ADDBACOD     KACDE                                             AR676495
179390200529     C                     Z-ADDBACSQ     KACSQ                                             AR676495
179400200529     C                     MOVE BBRCA     KBRCA                                             AR676495
179410200529     C                     Z-ADDLCID      KRDNB                                             AR676495
179420200529      *                                                                                     AR676495
179430200529     C                     Z-ADD*ZEROS    WNIBC  150                                        AR676495
179440200529     C                     Z-ADD*ZEROS    WPTBC  150                                        AR676495
179450200529     C                     Z-ADD*ZEROS    WTTAX  150                                        AR676495
179460200529      *                                                                                     AR676495
179470200529     C           INTAD     IFNE '1'                                                         AR676495
179480200529     C           KCILJ     SETLLSDCSINLJ                                                    AR676495
179490200529     C                     ENDIF                                                            AR676495
179500200529     C           KCILJ     READESDCSINLJ                 70                                 AR676495
179510200529      *                                                                                     AR676495
179520200529     C           *IN70     IFEQ *OFF                                                        AR676495
179530200529      *                                                                                     AR676495
179540200529     C                     ADD  TSNINB    WNIBC                                             AR676495
179550200529     C                     ADD  TSPTHU    WPTBC                                             AR676495
179560200529     C                     ADD  TSTXSB    WTTAX                                             AR676495
179570200529     C                     ADD  TSSTDB    WTTAX                                             AR676495
179580200529     C                     ADD  TSTTDB    WTTAX                                             AR676495
179590200529      *                                                                                     AR676495
179600200529     C                     MOVE *ZEROS    TSTXSR                                            AR676495
179610200529     C                     MOVE *ZEROS    TSTXSS                                            AR676495
179620200529     C                     MOVE *ZEROS    TSTXSC                                            AR676495
179630200529     C                     MOVE *ZEROS    TSTXSB                                            AR676495
179640200529     C                     MOVE *ZEROS    TSSTDO                                            AR676495
179650200529     C                     MOVE *ZEROS    TSSTDS                                            AR676495
179660200529     C                     MOVE *ZEROS    TSSTDT                                            AR676495
179670200529     C                     MOVE *ZEROS    TSSTDB                                            AR676495
179680200529     C                     MOVE *ZEROS    TSPTHU                                            AR676495
179690200529     C                     MOVE *ZEROS    TSTTDO                                            AR676495
179700200529     C                     MOVE *ZEROS    TSTTDS                                            AR676495
179710200529     C                     MOVE *ZEROS    TSTTDT                                            AR676495
179720200529     C                     MOVE *ZEROS    TSTTDB                                            AR676495
179730200529      *                                                                                     AR676495
179740200529     C                     MOVE TSGINT    TSNINT                                            AR676495
179750200529     C                     MOVE TSGINS    TSNINS                                            AR676495
179760200529     C                     MOVE TSGINC    TSNINC                                            AR676495
179770200529     C                     MOVE TSGINB    TSNINB                                            AR676495
179780200529      *                                                                                     AR676495
179790200529     C                     UPDATSDCSINDJ                                                    AR676495
179800200529      *                                                                                     AR676495
179810200529     C                     ENDIF                                                            AR676495
179820200529      *                                                                                     AR676495
179830200529     C                     MOVE TSCUST    KCNUM                                             AR676495
179840200529     C                     MOVE TSBRCA    KBRCH                                             AR676495
179850200529      *                                                                                     AR676495
179860200529     C           R3KEYB    SETLLSDINPHL2                                                    AR676495
179870200529     C           R3KEYB    READESDINPHL2                 71                                 AR676495
179880200529      *                                                                                     AR676495
179890200529     C           *IN71     IFEQ *OFF                                                        AR676495
179900200529     C           TITOUT    SUB  WNIBC     TITOUT                                            AR676495
179910200529     C           TIUTTH    SUB  WPTBC     TIUTTH                                            AR676495
179920200529     C           TITTAX    SUB  WTTAX     TITTAX                                            AR676495
179930200529      *                                                                                     AR676495
179940200529     C                     UPDATSDINPHD0                                                    AR676495
179950200529     C                     ENDIF                                                            AR676495
179960200529      *                                                                                     AR676495
179970200529     C           ACKEY1    CHAINREACR                40                                     AR676495
179980200529      *                                                                                     AR676495
179990200529      ** REACR RECORD NOT FOUND                                                             AR676495
180000200529      *                                                                                     AR676495
180010200529     C           *IN40     IFEQ '1'                                                         AR676495
180020200529     C           *LOCK     IN   LDA                                                         AR676495
180030200529     C                     Z-ADD335       DBASE                                             AR676495
180040200529     C                     MOVEL'REACR'   DBFILE                                            AR676495
180050200529     C                     MOVELAKEY      DBKEY                                             AR676495
180060200529     C                     OUT  LDA                                                         AR676495
180070200529     C                     EXSR *PSSR                                                       AR676495
180080200529     C                     END                                                              AR676495
180090200529      *                                                                                     AR676495
180100200529     C           HISB      IFLE *ZEROS                                                      AR676495
180110200529     C           HISB      SUB  WTTAX     HISB                                              AR676495
180120200529     C                     ELSE                                                             AR676495
180130200529     C           HISB      ADD  WTTAX     HISB                                              AR676495
180140200529     C                     ENDIF                                                            AR676495
180150200529      *                                                                                     AR676495
180160200529     C                     UPDATREACRDF                                                     AR676495
180170200529      *                                                                                     AR676495
180180200529     C                     ELSE                                                             AR676495
180190200529      *                                                                                     AR676495
180200200529     C                     Z-ADDBJRDNB    KRDNB                                             AR676495
180210200529     C                     MOVE 'G'       KMODI                                             AR676495
180220200529     C                     MOVE BCNUM     KCUST                                             AR676495
180230200529     C                     MOVE BCNUM     KJOIN                                             AR676495
180240200529     C                     MOVE BCCY      KSCCY                                             AR676495
180250200529     C                     Z-ADDBACOD     KACDE                                             AR676495
180260200529     C                     Z-ADDBACSQ     KACSQ                                             AR676495
180270200529     C                     MOVE BBRCA     KBRCA                                             AR676495
180280200529      *                                                                                     AR676495
180290200529      ** Read customer income file                                                          AR676495
180300200529      ** DO NOT SETLL IF A PREVIOUS INTEREST ADJUSTMENT OCCURED                             AR676495
180310200529      *                                                                                     AR676495
180320200529     C           WJACC     IFEQ 'Y'                                                         AR676495
180330200529     C           INTAD     IFNE '1'                                                         AR676495
180340200529     C           KCILC     SETLLSDCSINLC                                                    AR676495
180350200529     C                     ENDIF                                                            AR676495
180360200529     C           KCILC     READESDCSINLC                 84                                 AR676495
180370200529     C                     ELSE                                                             AR676495
180380200529     C           INTAD     IFNE '1'                                                         AR676495
180390200529     C           KCIL7     SETLLSDCSINL7                                                    AR676495
180400200529     C                     ENDIF                                                            AR676495
180410200529     C           KCIL7     READESDCSINL7                 84                                 AR676495
180420200529     C                     ENDIF                                                            AR676495
180430200529      *                                                                                     AR676495
180440200529      ** COMPUTE NET INTEREST FOR INTEREST ADJUSTMENT                                       AR676495
180450200529      *                                                                                     AR676495
180460200529     C           *IN84     IFEQ *OFF                                                        AR676495
180470200529     C           TSSTAT    ANDEQ'T'                                                         AR676495
180480200529     C           TSEDAT    ANDLTTSRDNB                                                      AR676495
180490200529     C           TSOCCY    IFEQ TSTXCY                                                      AR676495
180500200529     C           CER048    IFEQ 'Y'                                                         AR676495
180510200529     C                     ADD  TSSTDO    WKSTXO                                            AR676495
180520200529     C                     ENDIF                                                            AR676495
180530200529     C           CER054    IFEQ 'Y'                                                         AR676495
180540200529     C                     ADD  TSTTDO    WKTTXO                                            AR676495
180550200529     C                     ENDIF                                                            AR676495
180560200529     C                     ADD  TSTXSR    WTAOC                                             AR676495
180570200529     C                     ELSE                                                             AR676495
180580200529     C                     ADD  TSTXSR    WTAOC                                             AR676495
180590200529     C                     ADD  TSTXSC    WTATC                                             AR676495
180600200529     C                     ADD  TSTXSB    WTABC                                             AR676495
180610200529     C           CER048    IFEQ 'Y'                                                         AR676495
180620200529     C                     ADD  TSSTDO    WKSTXO                                            AR676495
180630200529     C                     ADD  TSSTDT    WKSTXT                                            AR676495
180640200529     C                     ADD  TSSTDB    WKSTXB                                            AR676495
180650200529     C                     ENDIF                                                            AR676495
180660200529     C           CER054    IFEQ 'Y'                                                         AR676495
180670200529     C                     ADD  TSTTDO    WKTTXO                                            AR676495
180680200529     C                     ADD  TSTTDT    WKTTXT                                            AR676495
180690200529     C                     ADD  TSTTDB    WKTTXB                                            AR676495
180700200529     C                     ENDIF                                                            AR676495
180710200529     C                     ENDIF                                                            AR676495
180720200529     C                     ENDIF                                                            AR676495
180730200529      *                                                                                     AR676495
180740200529     C                     MOVE TSWTAC    WEWTA                                             AR676495
180750200529     C           CER048    IFEQ 'Y'                                                         AR676495
180760200529     C                     MOVE TSSTAC    WSTAC                                             AR676495
180770200529     C                     ENDIF                                                            AR676495
180780200529     C           CER054    IFEQ 'Y'                                                         AR676495
180790200529     C                     MOVE TSTTAC    WTTAC                                             AR676495
180800200529     C                     ENDIF                                                            AR676495
180810200529     C           WJACC     IFEQ 'Y'                                                         AR676495
180820200529      *                                                                                     AR676495
180830200529      ** GENERATE EU A/C KEYS FOR TAX AMOUNT.                                               AR676495
180840200529      *                                                                                     AR676495
180850200529     C                     EXSR SREATA                                                      AR676495
180860200529     C                     ENDIF                                                            AR676495
180870200529     C                     ENDIF                                                            AR676495
180880200529     C                     ENDSR                                                            AR676495
180890200529      *****************************************************************   CPB001
180900200529      /EJECT                                                              CPB001
180910200529     C*                                                                   S01408
180920200529     C/COPY WNCPYSRC,RE3664CCP2                                           S01408
180930200529     C*                                                                   S01408
180940200529     C********************************************************************
180950200529     O*********REHISPPFE                HISPD
180960200529     OACCNTXF E                RACNTX
180970200529     O/COPY WNCPYSRC,RE3664O001
180980200529     O*****************************************************************
180990200529      /COPY ZSRSRC,ZDATE2Z3
181000200529**  CPY@  OBJECT COPYRIGHT
181010200529(c) Finastra International Limited 2001
181020200529**  ZFMD
181030200529312831303130313130313031
181040200529**  POWER - ARRAY OF POWERS FOR CURRENCY CONVERSION
1810502005290000001
1810602005290000010
1810702005290000100
1810802005290001000
1810902005290010000
1811002005290100000
1811102005291000000
181120200529**  TAB1= JOB NAME,  TABA= ALTERNATE A/Cs  (14A)                          085787
181130200529REC64A    ALTERNATE A/Cs
181140200529REC64AD   ALTERNATE A/Cs
181150200529**  EUTXN2                                                                                  AR318139
181160200529European Taxation of Interest
181170200529**  SVAL  -  System Values Array                                                              CRE100
181180200529RET_INTAC_CUST_LVL                                                                            CRE100
181190200529RET_CHG_CUST_LVL                                                                              CRE100
181200200529RET_SEQ_CUST_LVL                                                                            MD034990
181210200529GrossIntWHTaxAltAcct                                                                        MD045460
